(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function FRe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wL={exports:{}},wb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fH;function BRe(){if(fH)return wb;fH=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(i,n,a){var o=null;if(a!==void 0&&(o=""+a),n.key!==void 0&&(o=""+n.key),"key"in n){a={};for(var l in n)l!=="key"&&(a[l]=n[l])}else a=n;return n=a.ref,{$$typeof:t,type:i,key:o,ref:n!==void 0?n:null,props:a}}return wb.Fragment=e,wb.jsx=r,wb.jsxs=r,wb}var mH;function zRe(){return mH||(mH=1,wL.exports=BRe()),wL.exports}var Lr=zRe(),AL={exports:{}},qi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gH;function URe(){if(gH)return qi;gH=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function y(ee){return ee===null||typeof ee!="object"?null:(ee=m&&ee[m]||ee["@@iterator"],typeof ee=="function"?ee:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function M(ee,le,K){this.props=ee,this.context=le,this.refs=E,this.updater=K||v}M.prototype.isReactComponent={},M.prototype.setState=function(ee,le){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,le,"setState")},M.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function I(){}I.prototype=M.prototype;function P(ee,le,K){this.props=ee,this.context=le,this.refs=E,this.updater=K||v}var C=P.prototype=new I;C.constructor=P,w(C,M.prototype),C.isPureReactComponent=!0;var T=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},F=Object.prototype.hasOwnProperty;function k(ee,le,K,ce,te,ne){return K=ne.ref,{$$typeof:t,type:ee,key:le,ref:K!==void 0?K:null,props:ne}}function B(ee,le){return k(ee.type,le,void 0,void 0,void 0,ee.props)}function U(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function z(ee){var le={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(K){return le[K]})}var q=/\/+/g;function W(ee,le){return typeof ee=="object"&&ee!==null&&ee.key!=null?z(""+ee.key):le.toString(36)}function J(){}function V(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(J,J):(ee.status="pending",ee.then(function(le){ee.status==="pending"&&(ee.status="fulfilled",ee.value=le)},function(le){ee.status==="pending"&&(ee.status="rejected",ee.reason=le)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function oe(ee,le,K,ce,te){var ne=typeof ee;(ne==="undefined"||ne==="boolean")&&(ee=null);var pe=!1;if(ee===null)pe=!0;else switch(ne){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(ee.$$typeof){case t:case e:pe=!0;break;case p:return pe=ee._init,oe(pe(ee._payload),le,K,ce,te)}}if(pe)return te=te(ee),pe=ce===""?"."+W(ee,0):ce,T(te)?(K="",pe!=null&&(K=pe.replace(q,"$&/")+"/"),oe(te,le,K,"",function(fe){return fe})):te!=null&&(U(te)&&(te=B(te,K+(te.key==null||ee&&ee.key===te.key?"":(""+te.key).replace(q,"$&/")+"/")+pe)),le.push(te)),1;pe=0;var xe=ce===""?".":ce+":";if(T(ee))for(var Te=0;Te<ee.length;Te++)ce=ee[Te],ne=xe+W(ce,Te),pe+=oe(ce,le,K,ne,te);else if(Te=y(ee),typeof Te=="function")for(ee=Te.call(ee),Te=0;!(ce=ee.next()).done;)ce=ce.value,ne=xe+W(ce,Te++),pe+=oe(ce,le,K,ne,te);else if(ne==="object"){if(typeof ee.then=="function")return oe(V(ee),le,K,ce,te);throw le=String(ee),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return pe}function Y(ee,le,K){if(ee==null)return ee;var ce=[],te=0;return oe(ee,ce,"","",function(ne){return le.call(K,ne,te++)}),ce}function he(ee){if(ee._status===-1){var le=ee._result;le=le(),le.then(function(K){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=K)},function(K){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=K)}),ee._status===-1&&(ee._status=0,ee._result=le)}if(ee._status===1)return ee._result.default;throw ee._result}var Q=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)};function ae(){}return qi.Children={map:Y,forEach:function(ee,le,K){Y(ee,function(){le.apply(this,arguments)},K)},count:function(ee){var le=0;return Y(ee,function(){le++}),le},toArray:function(ee){return Y(ee,function(le){return le})||[]},only:function(ee){if(!U(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},qi.Component=M,qi.Fragment=r,qi.Profiler=n,qi.PureComponent=P,qi.StrictMode=i,qi.Suspense=u,qi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,qi.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return O.H.useMemoCache(ee)}},qi.cache=function(ee){return function(){return ee.apply(null,arguments)}},qi.cloneElement=function(ee,le,K){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var ce=w({},ee.props),te=ee.key,ne=void 0;if(le!=null)for(pe in le.ref!==void 0&&(ne=void 0),le.key!==void 0&&(te=""+le.key),le)!F.call(le,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&le.ref===void 0||(ce[pe]=le[pe]);var pe=arguments.length-2;if(pe===1)ce.children=K;else if(1<pe){for(var xe=Array(pe),Te=0;Te<pe;Te++)xe[Te]=arguments[Te+2];ce.children=xe}return k(ee.type,te,void 0,void 0,ne,ce)},qi.createContext=function(ee){return ee={$$typeof:o,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:a,_context:ee},ee},qi.createElement=function(ee,le,K){var ce,te={},ne=null;if(le!=null)for(ce in le.key!==void 0&&(ne=""+le.key),le)F.call(le,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(te[ce]=le[ce]);var pe=arguments.length-2;if(pe===1)te.children=K;else if(1<pe){for(var xe=Array(pe),Te=0;Te<pe;Te++)xe[Te]=arguments[Te+2];te.children=xe}if(ee&&ee.defaultProps)for(ce in pe=ee.defaultProps,pe)te[ce]===void 0&&(te[ce]=pe[ce]);return k(ee,ne,void 0,void 0,null,te)},qi.createRef=function(){return{current:null}},qi.forwardRef=function(ee){return{$$typeof:l,render:ee}},qi.isValidElement=U,qi.lazy=function(ee){return{$$typeof:p,_payload:{_status:-1,_result:ee},_init:he}},qi.memo=function(ee,le){return{$$typeof:c,type:ee,compare:le===void 0?null:le}},qi.startTransition=function(ee){var le=O.T,K={};O.T=K;try{var ce=ee(),te=O.S;te!==null&&te(K,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(ae,Q)}catch(ne){Q(ne)}finally{O.T=le}},qi.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},qi.use=function(ee){return O.H.use(ee)},qi.useActionState=function(ee,le,K){return O.H.useActionState(ee,le,K)},qi.useCallback=function(ee,le){return O.H.useCallback(ee,le)},qi.useContext=function(ee){return O.H.useContext(ee)},qi.useDebugValue=function(){},qi.useDeferredValue=function(ee,le){return O.H.useDeferredValue(ee,le)},qi.useEffect=function(ee,le,K){var ce=O.H;if(typeof K=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ce.useEffect(ee,le)},qi.useId=function(){return O.H.useId()},qi.useImperativeHandle=function(ee,le,K){return O.H.useImperativeHandle(ee,le,K)},qi.useInsertionEffect=function(ee,le){return O.H.useInsertionEffect(ee,le)},qi.useLayoutEffect=function(ee,le){return O.H.useLayoutEffect(ee,le)},qi.useMemo=function(ee,le){return O.H.useMemo(ee,le)},qi.useOptimistic=function(ee,le){return O.H.useOptimistic(ee,le)},qi.useReducer=function(ee,le,K){return O.H.useReducer(ee,le,K)},qi.useRef=function(ee){return O.H.useRef(ee)},qi.useState=function(ee){return O.H.useState(ee)},qi.useSyncExternalStore=function(ee,le,K){return O.H.useSyncExternalStore(ee,le,K)},qi.useTransition=function(){return O.H.useTransition()},qi.version="19.1.0",qi}var yH;function _9(){return yH||(yH=1,AL.exports=URe()),AL.exports}var Dr=_9();const qb=FRe(Dr);var SL={exports:{}},Ab={},ML={exports:{}},EL={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vH;function VRe(){return vH||(vH=1,function(t){function e(Y,he){var Q=Y.length;Y.push(he);e:for(;0<Q;){var ae=Q-1>>>1,ee=Y[ae];if(0<n(ee,he))Y[ae]=he,Y[Q]=ee,Q=ae;else break e}}function r(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var he=Y[0],Q=Y.pop();if(Q!==he){Y[0]=Q;e:for(var ae=0,ee=Y.length,le=ee>>>1;ae<le;){var K=2*(ae+1)-1,ce=Y[K],te=K+1,ne=Y[te];if(0>n(ce,Q))te<ee&&0>n(ne,ce)?(Y[ae]=ne,Y[te]=Q,ae=te):(Y[ae]=ce,Y[K]=Q,ae=K);else if(te<ee&&0>n(ne,Q))Y[ae]=ne,Y[te]=Q,ae=te;else break e}}return he}function n(Y,he){var Q=Y.sortIndex-he.sortIndex;return Q!==0?Q:Y.id-he.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],p=1,m=null,y=3,v=!1,w=!1,E=!1,M=!1,I=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function T(Y){for(var he=r(c);he!==null;){if(he.callback===null)i(c);else if(he.startTime<=Y)i(c),he.sortIndex=he.expirationTime,e(u,he);else break;he=r(c)}}function O(Y){if(E=!1,T(Y),!w)if(r(u)!==null)w=!0,F||(F=!0,W());else{var he=r(c);he!==null&&oe(O,he.startTime-Y)}}var F=!1,k=-1,B=5,U=-1;function z(){return M?!0:!(t.unstable_now()-U<B)}function q(){if(M=!1,F){var Y=t.unstable_now();U=Y;var he=!0;try{e:{w=!1,E&&(E=!1,P(k),k=-1),v=!0;var Q=y;try{t:{for(T(Y),m=r(u);m!==null&&!(m.expirationTime>Y&&z());){var ae=m.callback;if(typeof ae=="function"){m.callback=null,y=m.priorityLevel;var ee=ae(m.expirationTime<=Y);if(Y=t.unstable_now(),typeof ee=="function"){m.callback=ee,T(Y),he=!0;break t}m===r(u)&&i(u),T(Y)}else i(u);m=r(u)}if(m!==null)he=!0;else{var le=r(c);le!==null&&oe(O,le.startTime-Y),he=!1}}break e}finally{m=null,y=Q,v=!1}he=void 0}}finally{he?W():F=!1}}}var W;if(typeof C=="function")W=function(){C(q)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,V=J.port2;J.port1.onmessage=q,W=function(){V.postMessage(null)}}else W=function(){I(q,0)};function oe(Y,he){k=I(function(){Y(t.unstable_now())},he)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(Y){switch(y){case 1:case 2:case 3:var he=3;break;default:he=y}var Q=y;y=he;try{return Y()}finally{y=Q}},t.unstable_requestPaint=function(){M=!0},t.unstable_runWithPriority=function(Y,he){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Q=y;y=Y;try{return he()}finally{y=Q}},t.unstable_scheduleCallback=function(Y,he,Q){var ae=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ae+Q:ae):Q=ae,Y){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Q+ee,Y={id:p++,callback:he,priorityLevel:Y,startTime:Q,expirationTime:ee,sortIndex:-1},Q>ae?(Y.sortIndex=Q,e(c,Y),r(u)===null&&Y===r(c)&&(E?(P(k),k=-1):E=!0,oe(O,Q-ae))):(Y.sortIndex=ee,e(u,Y),w||v||(w=!0,F||(F=!0,W()))),Y},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(Y){var he=y;return function(){var Q=y;y=he;try{return Y.apply(this,arguments)}finally{y=Q}}}}(EL)),EL}var _H;function jRe(){return _H||(_H=1,ML.exports=VRe()),ML.exports}var CL={exports:{}},_l={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xH;function $Re(){if(xH)return _l;xH=1;var t=_9();function e(u){var c="https://react.dev/errors/"+u;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function a(u,c,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:m==null?null:""+m,children:u,containerInfo:c,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,c){if(u==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return _l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,_l.createPortal=function(u,c){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return a(u,c,null,p)},_l.flushSync=function(u){var c=o.T,p=i.p;try{if(o.T=null,i.p=2,u)return u()}finally{o.T=c,i.p=p,i.d.f()}},_l.preconnect=function(u,c){typeof u=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(u,c))},_l.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},_l.preinit=function(u,c){if(typeof u=="string"&&c&&typeof c.as=="string"){var p=c.as,m=l(p,c.crossOrigin),y=typeof c.integrity=="string"?c.integrity:void 0,v=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;p==="style"?i.d.S(u,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:v}):p==="script"&&i.d.X(u,{crossOrigin:m,integrity:y,fetchPriority:v,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},_l.preinitModule=function(u,c){if(typeof u=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var p=l(c.as,c.crossOrigin);i.d.M(u,{crossOrigin:p,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(u)},_l.preload=function(u,c){if(typeof u=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var p=c.as,m=l(p,c.crossOrigin);i.d.L(u,p,{crossOrigin:m,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},_l.preloadModule=function(u,c){if(typeof u=="string")if(c){var p=l(c.as,c.crossOrigin);i.d.m(u,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:p,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(u)},_l.requestFormReset=function(u){i.d.r(u)},_l.unstable_batchedUpdates=function(u,c){return u(c)},_l.useFormState=function(u,c,p){return o.H.useFormState(u,c,p)},_l.useFormStatus=function(){return o.H.useHostTransitionStatus()},_l.version="19.1.0",_l}var bH;function YX(){if(bH)return CL.exports;bH=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),CL.exports=$Re(),CL.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wH;function GRe(){if(wH)return Ab;wH=1;var t=jRe(),e=_9(),r=YX();function i(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)g+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var g=d,x=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,(g.flags&4098)!==0&&(x=g.return),d=g.return;while(d)}return g.tag===3?x:null}function o(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function l(d){if(a(d)!==d)throw Error(i(188))}function u(d){var g=d.alternate;if(!g){if(g=a(d),g===null)throw Error(i(188));return g!==d?null:d}for(var x=d,L=g;;){var G=x.return;if(G===null)break;var X=G.alternate;if(X===null){if(L=G.return,L!==null){x=L;continue}break}if(G.child===X.child){for(X=G.child;X;){if(X===x)return l(G),d;if(X===L)return l(G),g;X=X.sibling}throw Error(i(188))}if(x.return!==L.return)x=G,L=X;else{for(var ye=!1,De=G.child;De;){if(De===x){ye=!0,x=G,L=X;break}if(De===L){ye=!0,L=G,x=X;break}De=De.sibling}if(!ye){for(De=X.child;De;){if(De===x){ye=!0,x=X,L=G;break}if(De===L){ye=!0,L=X,x=G;break}De=De.sibling}if(!ye)throw Error(i(189))}}if(x.alternate!==L)throw Error(i(190))}if(x.tag!==3)throw Error(i(188));return x.stateNode.current===x?d:g}function c(d){var g=d.tag;if(g===5||g===26||g===27||g===6)return d;for(d=d.child;d!==null;){if(g=c(d),g!==null)return g;d=d.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),P=Symbol.for("react.consumer"),C=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function W(d){return d===null||typeof d!="object"?null:(d=q&&d[q]||d["@@iterator"],typeof d=="function"?d:null)}var J=Symbol.for("react.client.reference");function V(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===J?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case w:return"Fragment";case M:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case F:return"SuspenseList";case U:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case v:return"Portal";case C:return(d.displayName||"Context")+".Provider";case P:return(d._context.displayName||"Context")+".Consumer";case T:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case k:return g=d.displayName||null,g!==null?g:V(d.type)||"Memo";case B:g=d._payload,d=d._init;try{return V(d(g))}catch{}}return null}var oe=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},ae=[],ee=-1;function le(d){return{current:d}}function K(d){0>ee||(d.current=ae[ee],ae[ee]=null,ee--)}function ce(d,g){ee++,ae[ee]=d.current,d.current=g}var te=le(null),ne=le(null),pe=le(null),xe=le(null);function Te(d,g){switch(ce(pe,g),ce(ne,d),ce(te,null),g.nodeType){case 9:case 11:d=(d=g.documentElement)&&(d=d.namespaceURI)?jG(d):0;break;default:if(d=g.tagName,g=g.namespaceURI)g=jG(g),d=$G(g,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}K(te),ce(te,d)}function fe(){K(te),K(ne),K(pe)}function Pe(d){d.memoizedState!==null&&ce(xe,d);var g=te.current,x=$G(g,d.type);g!==x&&(ce(ne,d),ce(te,x))}function me(d){ne.current===d&&(K(te),K(ne)),xe.current===d&&(K(xe),yb._currentValue=Q)}var Ae=Object.prototype.hasOwnProperty,Ue=t.unstable_scheduleCallback,_e=t.unstable_cancelCallback,lt=t.unstable_shouldYield,tt=t.unstable_requestPaint,We=t.unstable_now,at=t.unstable_getCurrentPriorityLevel,Lt=t.unstable_ImmediatePriority,dt=t.unstable_UserBlockingPriority,Me=t.unstable_NormalPriority,ve=t.unstable_LowPriority,Ze=t.unstable_IdlePriority,It=t.log,Rt=t.unstable_setDisableYieldValue,Et=null,pt=null;function Yt(d){if(typeof It=="function"&&Rt(d),pt&&typeof pt.setStrictMode=="function")try{pt.setStrictMode(Et,d)}catch{}}var Kt=Math.clz32?Math.clz32:Nt,$t=Math.log,jt=Math.LN2;function Nt(d){return d>>>=0,d===0?32:31-($t(d)/jt|0)|0}var Fe=256,Xe=4194304;function ht(d){var g=d&42;if(g!==0)return g;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function rr(d,g,x){var L=d.pendingLanes;if(L===0)return 0;var G=0,X=d.suspendedLanes,ye=d.pingedLanes;d=d.warmLanes;var De=L&134217727;return De!==0?(L=De&~X,L!==0?G=ht(L):(ye&=De,ye!==0?G=ht(ye):x||(x=De&~d,x!==0&&(G=ht(x))))):(De=L&~X,De!==0?G=ht(De):ye!==0?G=ht(ye):x||(x=L&~d,x!==0&&(G=ht(x)))),G===0?0:g!==0&&g!==G&&(g&X)===0&&(X=G&-G,x=g&-g,X>=x||X===32&&(x&4194048)!==0)?g:G}function ar(d,g){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&g)===0}function Vr(d,g){switch(d){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qe(){var d=Fe;return Fe<<=1,(Fe&4194048)===0&&(Fe=256),d}function er(){var d=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),d}function Oe(d){for(var g=[],x=0;31>x;x++)g.push(d);return g}function se(d,g){d.pendingLanes|=g,g!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function ue(d,g,x,L,G,X){var ye=d.pendingLanes;d.pendingLanes=x,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=x,d.entangledLanes&=x,d.errorRecoveryDisabledLanes&=x,d.shellSuspendCounter=0;var De=d.entanglements,Ke=d.expirationTimes,Ct=d.hiddenUpdates;for(x=ye&~x;0<x;){var Xt=31-Kt(x),tr=1<<Xt;De[Xt]=0,Ke[Xt]=-1;var Dt=Ct[Xt];if(Dt!==null)for(Ct[Xt]=null,Xt=0;Xt<Dt.length;Xt++){var Ot=Dt[Xt];Ot!==null&&(Ot.lane&=-536870913)}x&=~tr}L!==0&&Se(d,L,0),X!==0&&G===0&&d.tag!==0&&(d.suspendedLanes|=X&~(ye&~g))}function Se(d,g,x){d.pendingLanes|=g,d.suspendedLanes&=~g;var L=31-Kt(g);d.entangledLanes|=g,d.entanglements[L]=d.entanglements[L]|1073741824|x&4194090}function ze(d,g){var x=d.entangledLanes|=g;for(d=d.entanglements;x;){var L=31-Kt(x),G=1<<L;G&g|d[L]&g&&(d[L]|=g),x&=~G}}function Re(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function yt(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function st(){var d=he.p;return d!==0?d:(d=window.event,d===void 0?32:lH(d.type))}function kt(d,g){var x=he.p;try{return he.p=d,g()}finally{he.p=x}}var mt=Math.random().toString(36).slice(2),Gt="__reactFiber$"+mt,ke="__reactProps$"+mt,$e="__reactContainer$"+mt,ot="__reactEvents$"+mt,Ft="__reactListeners$"+mt,Ht="__reactHandles$"+mt,fr="__reactResources$"+mt,nr="__reactMarker$"+mt;function Kr(d){delete d[Gt],delete d[ke],delete d[ot],delete d[Ft],delete d[Ht]}function ai(d){var g=d[Gt];if(g)return g;for(var x=d.parentNode;x;){if(g=x[$e]||x[Gt]){if(x=g.alternate,g.child!==null||x!==null&&x.child!==null)for(d=WG(d);d!==null;){if(x=d[Gt])return x;d=WG(d)}return g}d=x,x=d.parentNode}return null}function Jr(d){if(d=d[Gt]||d[$e]){var g=d.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return d}return null}function Cr(d){var g=d.tag;if(g===5||g===26||g===27||g===6)return d.stateNode;throw Error(i(33))}function Ei(d){var g=d[fr];return g||(g=d[fr]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Hr(d){d[nr]=!0}var en=new Set,Hi={};function En(d,g){Ie(d,g),Ie(d+"Capture",g)}function Ie(d,g){for(Hi[d]=g,d=0;d<g.length;d++)en.add(g[d])}var Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wt={},ft={};function rt(d){return Ae.call(ft,d)?!0:Ae.call(wt,d)?!1:Je.test(d)?ft[d]=!0:(wt[d]=!0,!1)}function zt(d,g,x){if(rt(g))if(x===null)d.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":d.removeAttribute(g);return;case"boolean":var L=g.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){d.removeAttribute(g);return}}d.setAttribute(g,""+x)}}function cr(d,g,x){if(x===null)d.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(g);return}d.setAttribute(g,""+x)}}function ur(d,g,x,L){if(L===null)d.removeAttribute(x);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(x);return}d.setAttributeNS(g,x,""+L)}}var Ar,Fr;function Xr(d){if(Ar===void 0)try{throw Error()}catch(x){var g=x.stack.trim().match(/\n( *(at )?)/);Ar=g&&g[1]||"",Fr=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ar+d+Fr}var Zr=!1;function _i(d,g){if(!d||Zr)return"";Zr=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(g){var tr=function(){throw Error()};if(Object.defineProperty(tr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(tr,[])}catch(Ot){var Dt=Ot}Reflect.construct(d,[],tr)}else{try{tr.call()}catch(Ot){Dt=Ot}d.call(tr.prototype)}}else{try{throw Error()}catch(Ot){Dt=Ot}(tr=d())&&typeof tr.catch=="function"&&tr.catch(function(){})}}catch(Ot){if(Ot&&Dt&&typeof Ot.stack=="string")return[Ot.stack,Dt.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var G=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");G&&G.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var X=L.DetermineComponentFrameRoot(),ye=X[0],De=X[1];if(ye&&De){var Ke=ye.split(`
`),Ct=De.split(`
`);for(G=L=0;L<Ke.length&&!Ke[L].includes("DetermineComponentFrameRoot");)L++;for(;G<Ct.length&&!Ct[G].includes("DetermineComponentFrameRoot");)G++;if(L===Ke.length||G===Ct.length)for(L=Ke.length-1,G=Ct.length-1;1<=L&&0<=G&&Ke[L]!==Ct[G];)G--;for(;1<=L&&0<=G;L--,G--)if(Ke[L]!==Ct[G]){if(L!==1||G!==1)do if(L--,G--,0>G||Ke[L]!==Ct[G]){var Xt=`
`+Ke[L].replace(" at new "," at ");return d.displayName&&Xt.includes("<anonymous>")&&(Xt=Xt.replace("<anonymous>",d.displayName)),Xt}while(1<=L&&0<=G);break}}}finally{Zr=!1,Error.prepareStackTrace=x}return(x=d?d.displayName||d.name:"")?Xr(x):""}function Di(d){switch(d.tag){case 26:case 27:case 5:return Xr(d.type);case 16:return Xr("Lazy");case 13:return Xr("Suspense");case 19:return Xr("SuspenseList");case 0:case 15:return _i(d.type,!1);case 11:return _i(d.type.render,!1);case 1:return _i(d.type,!0);case 31:return Xr("Activity");default:return""}}function jr(d){try{var g="";do g+=Di(d),d=d.return;while(d);return g}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}function vi(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function wi(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Yr(d){var g=wi(d)?"checked":"value",x=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),L=""+d[g];if(!d.hasOwnProperty(g)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var G=x.get,X=x.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return G.call(this)},set:function(ye){L=""+ye,X.call(this,ye)}}),Object.defineProperty(d,g,{enumerable:x.enumerable}),{getValue:function(){return L},setValue:function(ye){L=""+ye},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function $r(d){d._valueTracker||(d._valueTracker=Yr(d))}function li(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var x=g.getValue(),L="";return d&&(L=wi(d)?d.checked?"true":"false":d.value),d=L,d!==x?(g.setValue(d),!0):!1}function sa(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ta=/[\n"\\]/g;function Vi(d){return d.replace(ta,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function qr(d,g,x,L,G,X,ye,De){d.name="",ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"?d.type=ye:d.removeAttribute("type"),g!=null?ye==="number"?(g===0&&d.value===""||d.value!=g)&&(d.value=""+vi(g)):d.value!==""+vi(g)&&(d.value=""+vi(g)):ye!=="submit"&&ye!=="reset"||d.removeAttribute("value"),g!=null?R(d,ye,vi(g)):x!=null?R(d,ye,vi(x)):L!=null&&d.removeAttribute("value"),G==null&&X!=null&&(d.defaultChecked=!!X),G!=null&&(d.checked=G&&typeof G!="function"&&typeof G!="symbol"),De!=null&&typeof De!="function"&&typeof De!="symbol"&&typeof De!="boolean"?d.name=""+vi(De):d.removeAttribute("name")}function S(d,g,x,L,G,X,ye,De){if(X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(d.type=X),g!=null||x!=null){if(!(X!=="submit"&&X!=="reset"||g!=null))return;x=x!=null?""+vi(x):"",g=g!=null?""+vi(g):x,De||g===d.value||(d.value=g),d.defaultValue=g}L=L??G,L=typeof L!="function"&&typeof L!="symbol"&&!!L,d.checked=De?d.checked:!!L,d.defaultChecked=!!L,ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"&&(d.name=ye)}function R(d,g,x){g==="number"&&sa(d.ownerDocument)===d||d.defaultValue===""+x||(d.defaultValue=""+x)}function j(d,g,x,L){if(d=d.options,g){g={};for(var G=0;G<x.length;G++)g["$"+x[G]]=!0;for(x=0;x<d.length;x++)G=g.hasOwnProperty("$"+d[x].value),d[x].selected!==G&&(d[x].selected=G),G&&L&&(d[x].defaultSelected=!0)}else{for(x=""+vi(x),g=null,G=0;G<d.length;G++){if(d[G].value===x){d[G].selected=!0,L&&(d[G].defaultSelected=!0);return}g!==null||d[G].disabled||(g=d[G])}g!==null&&(g.selected=!0)}}function Z(d,g,x){if(g!=null&&(g=""+vi(g),g!==d.value&&(d.value=g),x==null)){d.defaultValue!==g&&(d.defaultValue=g);return}d.defaultValue=x!=null?""+vi(x):""}function ie(d,g,x,L){if(g==null){if(L!=null){if(x!=null)throw Error(i(92));if(oe(L)){if(1<L.length)throw Error(i(93));L=L[0]}x=L}x==null&&(x=""),g=x}x=vi(g),d.defaultValue=x,L=d.textContent,L===x&&L!==""&&L!==null&&(d.value=L)}function we(d,g){if(g){var x=d.firstChild;if(x&&x===d.lastChild&&x.nodeType===3){x.nodeValue=g;return}}d.textContent=g}var Ce=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Le(d,g,x){var L=g.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?L?d.setProperty(g,""):g==="float"?d.cssFloat="":d[g]="":L?d.setProperty(g,x):typeof x!="number"||x===0||Ce.has(g)?g==="float"?d.cssFloat=x:d[g]=(""+x).trim():d[g]=x+"px"}function ct(d,g,x){if(g!=null&&typeof g!="object")throw Error(i(62));if(d=d.style,x!=null){for(var L in x)!x.hasOwnProperty(L)||g!=null&&g.hasOwnProperty(L)||(L.indexOf("--")===0?d.setProperty(L,""):L==="float"?d.cssFloat="":d[L]="");for(var G in g)L=g[G],g.hasOwnProperty(G)&&x[G]!==L&&Le(d,G,L)}else for(var X in g)g.hasOwnProperty(X)&&Le(d,X,g[X])}function _t(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),sr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mr(d){return sr.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var xr=null;function lr(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Er=null,sn=null;function ra(d){var g=Jr(d);if(g&&(d=g.stateNode)){var x=d[ke]||null;e:switch(d=g.stateNode,g.type){case"input":if(qr(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),g=x.name,x.type==="radio"&&g!=null){for(x=d;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+Vi(""+g)+'"][type="radio"]'),g=0;g<x.length;g++){var L=x[g];if(L!==d&&L.form===d.form){var G=L[ke]||null;if(!G)throw Error(i(90));qr(L,G.value,G.defaultValue,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name)}}for(g=0;g<x.length;g++)L=x[g],L.form===d.form&&li(L)}break e;case"textarea":Z(d,x.value,x.defaultValue);break e;case"select":g=x.value,g!=null&&j(d,!!x.multiple,g,!1)}}}var ln=!1;function zl(d,g,x){if(ln)return d(g,x);ln=!0;try{var L=d(g);return L}finally{if(ln=!1,(Er!==null||sn!==null)&&(QS(),Er&&(g=Er,d=sn,sn=Er=null,ra(g),d)))for(g=0;g<d.length;g++)ra(d[g])}}function la(d,g){var x=d.stateNode;if(x===null)return null;var L=x[ke]||null;if(L===null)return null;x=L[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(d=d.type,L=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!L;break e;default:d=!1}if(d)return null;if(x&&typeof x!="function")throw Error(i(231,g,typeof x));return x}var ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_o=!1;if(ui)try{var Ni={};Object.defineProperty(Ni,"passive",{get:function(){_o=!0}}),window.addEventListener("test",Ni,Ni),window.removeEventListener("test",Ni,Ni)}catch{_o=!1}var xo=null,pl=null,un=null;function Ta(){if(un)return un;var d,g=pl,x=g.length,L,G="value"in xo?xo.value:xo.textContent,X=G.length;for(d=0;d<x&&g[d]===G[d];d++);var ye=x-d;for(L=1;L<=ye&&g[x-L]===G[X-L];L++);return un=G.slice(d,1<L?1-L:void 0)}function Ul(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function ka(){return!0}function ys(){return!1}function Wn(d){function g(x,L,G,X,ye){this._reactName=x,this._targetInst=G,this.type=L,this.nativeEvent=X,this.target=ye,this.currentTarget=null;for(var De in d)d.hasOwnProperty(De)&&(x=d[De],this[De]=x?x(X):X[De]);return this.isDefaultPrevented=(X.defaultPrevented!=null?X.defaultPrevented:X.returnValue===!1)?ka:ys,this.isPropagationStopped=ys,this}return p(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=ka)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=ka)},persist:function(){},isPersistent:ka}),g}var Ve={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},et=Wn(Ve),be=p({},Ve,{view:0,detail:0}),Ge=Wn(be),nt,Wt,Br,Or=p({},be,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ic,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Br&&(Br&&d.type==="mousemove"?(nt=d.screenX-Br.screenX,Wt=d.screenY-Br.screenY):Wt=nt=0,Br=d),nt)},movementY:function(d){return"movementY"in d?d.movementY:Wt}}),ci=Wn(Or),gi=p({},Or,{dataTransfer:0}),Fi=Wn(gi),cn=p({},be,{relatedTarget:0}),Vn=Wn(cn),Xn=p({},Ve,{animationName:0,elapsedTime:0,pseudoElement:0}),dl=Wn(Xn),Ws=p({},Ve,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),ip=Wn(Ws),wa=p({},Ve,{data:0}),Gr=Wn(wa),bS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ts={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function su(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=Ts[d])?!!g[d]:!1}function Ic(){return su}var bg=p({},be,{key:function(d){if(d.key){var g=bS[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=Ul(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?xg[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ic,charCode:function(d){return d.type==="keypress"?Ul(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Ul(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),jx=Wn(bg),wS=p({},Or,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xi=Wn(wS),Tc=p({},be,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ic}),ua=Wn(Tc),wg=p({},Ve,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xs=Wn(wg),AS=p({},Or,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Bi=Wn(AS),cd=p({},Ve,{newState:0,oldState:0}),jn=Wn(cd),Ag=[9,13,27,32],Lo=ui&&"CompositionEvent"in window,Wu=null;ui&&"documentMode"in document&&(Wu=document.documentMode);var SS=ui&&"TextEvent"in window&&!Wu,sh=ui&&(!Lo||Wu&&8<Wu&&11>=Wu),Zi=" ",Zs=!1;function hd(d,g){switch(d){case"keyup":return Ag.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lu(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var bo=!1;function Do(d,g){switch(d){case"compositionend":return lu(g);case"keypress":return g.which!==32?null:(Zs=!0,Zi);case"textInput":return d=g.data,d===Zi&&Zs?null:d;default:return null}}function K5(d,g){if(bo)return d==="compositionend"||!Lo&&hd(d,g)?(d=Ta(),un=pl=xo=null,bo=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return sh&&g.locale!=="ko"?null:g.data;default:return null}}var MS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pc(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!MS[d.type]:g==="textarea"}function fl(d,g,x,L){Er?sn?sn.push(L):sn=[L]:Er=L,g=aM(g,"onChange"),0<g.length&&(x=new et("onChange","change",null,x,L),d.push({event:x,listeners:g}))}var uu=null,Ro=null;function cu(d){FG(d,0)}function ml(d){var g=Cr(d);if(li(g))return d}function lh(d,g){if(d==="change")return g}var Xu=!1;if(ui){var Xa;if(ui){var Dv="oninput"in document;if(!Dv){var Sg=document.createElement("div");Sg.setAttribute("oninput","return;"),Dv=typeof Sg.oninput=="function"}Xa=Dv}else Xa=!1;Xu=Xa&&(!document.documentMode||9<document.documentMode)}function Oo(){uu&&(uu.detachEvent("onpropertychange",Lc),Ro=uu=null)}function Lc(d){if(d.propertyName==="value"&&ml(Ro)){var g=[];fl(g,Ro,d,lr(d)),zl(cu,g)}}function hu(d,g,x){d==="focusin"?(Oo(),uu=g,Ro=x,uu.attachEvent("onpropertychange",Lc)):d==="focusout"&&Oo()}function ES(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ml(Ro)}function vs(d,g){if(d==="click")return ml(g)}function CS(d,g){if(d==="input"||d==="change")return ml(g)}function Mg(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var es=typeof Object.is=="function"?Object.is:Mg;function Df(d,g){if(es(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var x=Object.keys(d),L=Object.keys(g);if(x.length!==L.length)return!1;for(L=0;L<x.length;L++){var G=x[L];if(!Ae.call(g,G)||!es(d[G],g[G]))return!1}return!0}function $x(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function np(d,g){var x=$x(d);d=0;for(var L;x;){if(x.nodeType===3){if(L=d+x.textContent.length,d<=g&&L>=g)return{node:x,offset:g-d};d=L}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=$x(x)}}function pu(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?pu(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function so(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var g=sa(d.document);g instanceof d.HTMLIFrameElement;){try{var x=typeof g.contentWindow.location.href=="string"}catch{x=!1}if(x)d=g.contentWindow;else break;g=sa(d.document)}return g}function ap(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}var ts=ui&&"documentMode"in document&&11>=document.documentMode,Ps=null,Dc=null,pd=null,uh=!1;function Rc(d,g,x){var L=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;uh||Ps==null||Ps!==sa(L)||(L=Ps,"selectionStart"in L&&ap(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),pd&&Df(pd,L)||(pd=L,L=aM(Dc,"onSelect"),0<L.length&&(g=new et("onSelect","select",null,g,x),d.push({event:g,listeners:L}),g.target=Ps)))}function Ls(d,g){var x={};return x[d.toLowerCase()]=g.toLowerCase(),x["Webkit"+d]="webkit"+g,x["Moz"+d]="moz"+g,x}var Aa={animationend:Ls("Animation","AnimationEnd"),animationiteration:Ls("Animation","AnimationIteration"),animationstart:Ls("Animation","AnimationStart"),transitionrun:Ls("Transition","TransitionRun"),transitionstart:Ls("Transition","TransitionStart"),transitioncancel:Ls("Transition","TransitionCancel"),transitionend:Ls("Transition","TransitionEnd")},Ys={},ko={};ui&&(ko=document.createElement("div").style,"AnimationEvent"in window||(delete Aa.animationend.animation,delete Aa.animationiteration.animation,delete Aa.animationstart.animation),"TransitionEvent"in window||delete Aa.transitionend.transition);function op(d){if(Ys[d])return Ys[d];if(!Aa[d])return d;var g=Aa[d],x;for(x in g)if(g.hasOwnProperty(x)&&x in ko)return Ys[d]=g[x];return d}var Oc=op("animationend"),sp=op("animationiteration"),lo=op("animationstart"),No=op("transitionrun"),du=op("transitionstart"),gl=op("transitioncancel"),Rv=op("transitionend"),lp=new Map,Zu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zu.push("scrollEnd");function ca(d,g){lp.set(d,g),En(g,[d])}var Ov=new WeakMap;function Ln(d,g){if(typeof d=="object"&&d!==null){var x=Ov.get(d);return x!==void 0?x:(g={value:d,source:g,stack:jr(g)},Ov.set(d,g),g)}return{value:d,source:g,stack:jr(g)}}var yl=[],_s=0,Na=0;function Ds(){for(var d=_s,g=Na=_s=0;g<d;){var x=yl[g];yl[g++]=null;var L=yl[g];yl[g++]=null;var G=yl[g];yl[g++]=null;var X=yl[g];if(yl[g++]=null,L!==null&&G!==null){var ye=L.pending;ye===null?G.next=G:(G.next=ye.next,ye.next=G),L.pending=G}X!==0&&up(x,G,X)}}function Yu(d,g,x,L){yl[_s++]=d,yl[_s++]=g,yl[_s++]=x,yl[_s++]=L,Na|=L,d.lanes|=L,d=d.alternate,d!==null&&(d.lanes|=L)}function ch(d,g,x,L){return Yu(d,g,x,L),wo(d)}function xs(d,g){return Yu(d,null,null,g),wo(d)}function up(d,g,x){d.lanes|=x;var L=d.alternate;L!==null&&(L.lanes|=x);for(var G=!1,X=d.return;X!==null;)X.childLanes|=x,L=X.alternate,L!==null&&(L.childLanes|=x),X.tag===22&&(d=X.stateNode,d===null||d._visibility&1||(G=!0)),d=X,X=X.return;return d.tag===3?(X=d.stateNode,G&&g!==null&&(G=31-Kt(x),d=X.hiddenUpdates,L=d[G],L===null?d[G]=[g]:L.push(g),g.lane=x|536870912),X):null}function wo(d){if(50<ub)throw ub=0,q4=null,Error(i(185));for(var g=d.return;g!==null;)d=g,g=d.return;return d.tag===3?d.stateNode:null}var Rs={};function Sa(d,g,x,L){this.tag=d,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vl(d,g,x,L){return new Sa(d,g,x,L)}function kv(d){return d=d.prototype,!(!d||!d.isReactComponent)}function ha(d,g){var x=d.alternate;return x===null?(x=vl(d.tag,g,d.key,d.mode),x.elementType=d.elementType,x.type=d.type,x.stateNode=d.stateNode,x.alternate=d,d.alternate=x):(x.pendingProps=g,x.type=d.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=d.flags&65011712,x.childLanes=d.childLanes,x.lanes=d.lanes,x.child=d.child,x.memoizedProps=d.memoizedProps,x.memoizedState=d.memoizedState,x.updateQueue=d.updateQueue,g=d.dependencies,x.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},x.sibling=d.sibling,x.index=d.index,x.ref=d.ref,x.refCleanup=d.refCleanup,x}function kc(d,g){d.flags&=65011714;var x=d.alternate;return x===null?(d.childLanes=0,d.lanes=g,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=x.childLanes,d.lanes=x.lanes,d.child=x.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=x.memoizedProps,d.memoizedState=x.memoizedState,d.updateQueue=x.updateQueue,d.type=x.type,g=x.dependencies,d.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),d}function Rf(d,g,x,L,G,X){var ye=0;if(L=d,typeof d=="function")kv(d)&&(ye=1);else if(typeof d=="string")ye=SRe(d,x,te.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case U:return d=vl(31,x,g,G),d.elementType=U,d.lanes=X,d;case w:return Vl(x.children,G,X,g);case E:ye=8,G|=24;break;case M:return d=vl(12,x,g,G|2),d.elementType=M,d.lanes=X,d;case O:return d=vl(13,x,g,G),d.elementType=O,d.lanes=X,d;case F:return d=vl(19,x,g,G),d.elementType=F,d.lanes=X,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case I:case C:ye=10;break e;case P:ye=9;break e;case T:ye=11;break e;case k:ye=14;break e;case B:ye=16,L=null;break e}ye=29,x=Error(i(130,d===null?"null":typeof d,"")),L=null}return g=vl(ye,x,g,G),g.elementType=d,g.type=L,g.lanes=X,g}function Vl(d,g,x,L){return d=vl(7,d,L,g),d.lanes=x,d}function Ku(d,g,x){return d=vl(6,d,null,g),d.lanes=x,d}function Fa(d,g,x){return g=vl(4,d.children!==null?d.children:[],d.key,g),g.lanes=x,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}var Ba=[],Nc=0,Fo=null,Of=0,Ks=[],Dn=0,dd=null,Bo=1,Fc="";function Ju(d,g){Ba[Nc++]=Of,Ba[Nc++]=Fo,Fo=d,Of=g}function IS(d,g,x){Ks[Dn++]=Bo,Ks[Dn++]=Fc,Ks[Dn++]=dd,dd=d;var L=Bo;d=Fc;var G=32-Kt(L)-1;L&=~(1<<G),x+=1;var X=32-Kt(g)+G;if(30<X){var ye=G-G%5;X=(L&(1<<ye)-1).toString(32),L>>=ye,G-=ye,Bo=1<<32-Kt(g)+G|x<<G|L,Fc=X+d}else Bo=1<<X|x<<G|L,Fc=d}function Gx(d){d.return!==null&&(Ju(d,1),IS(d,1,0))}function jl(d){for(;d===Fo;)Fo=Ba[--Nc],Ba[Nc]=null,Of=Ba[--Nc],Ba[Nc]=null;for(;d===dd;)dd=Ks[--Dn],Ks[Dn]=null,Fc=Ks[--Dn],Ks[Dn]=null,Bo=Ks[--Dn],Ks[Dn]=null}var Ao=null,ia=null,bn=!1,fu=null,bs=!1,fd=Error(i(519));function mu(d){var g=Error(i(418,""));throw zo(Ln(g,d)),fd}function hh(d){var g=d.stateNode,x=d.type,L=d.memoizedProps;switch(g[Gt]=d,g[ke]=L,x){case"dialog":mn("cancel",g),mn("close",g);break;case"iframe":case"object":case"embed":mn("load",g);break;case"video":case"audio":for(x=0;x<hb.length;x++)mn(hb[x],g);break;case"source":mn("error",g);break;case"img":case"image":case"link":mn("error",g),mn("load",g);break;case"details":mn("toggle",g);break;case"input":mn("invalid",g),S(g,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),$r(g);break;case"select":mn("invalid",g);break;case"textarea":mn("invalid",g),ie(g,L.value,L.defaultValue,L.children),$r(g)}x=L.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||g.textContent===""+x||L.suppressHydrationWarning===!0||VG(g.textContent,x)?(L.popover!=null&&(mn("beforetoggle",g),mn("toggle",g)),L.onScroll!=null&&mn("scroll",g),L.onScrollEnd!=null&&mn("scrollend",g),L.onClick!=null&&(g.onclick=oM),g=!0):g=!1,g||mu(d)}function mi(d){for(Ao=d.return;Ao;)switch(Ao.tag){case 5:case 13:bs=!1;return;case 27:case 3:bs=!0;return;default:Ao=Ao.return}}function $l(d){if(d!==Ao)return!1;if(!bn)return mi(d),bn=!0,!1;var g=d.tag,x;if((x=g!==3&&g!==27)&&((x=g===5)&&(x=d.type,x=!(x!=="form"&&x!=="button")||lL(d.type,d.memoizedProps)),x=!x),x&&ia&&mu(d),mi(d),g===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8)if(x=d.data,x==="/$"){if(g===0){ia=gh(d.nextSibling);break e}g--}else x!=="$"&&x!=="$!"&&x!=="$?"||g++;d=d.nextSibling}ia=null}}else g===27?(g=ia,Zf(d.type)?(d=pL,pL=null,ia=d):ia=g):ia=Ao?gh(d.stateNode.nextSibling):null;return!0}function Bc(){ia=Ao=null,bn=!1}function ph(){var d=fu;return d!==null&&(_u===null?_u=d:_u.push.apply(_u,d),fu=null),d}function zo(d){fu===null?fu=[d]:fu.push(d)}var Nv=le(null),uo=null,Cn=null;function dh(d,g,x){ce(Nv,g._currentValue),g._currentValue=x}function Gl(d){d._currentValue=Nv.current,K(Nv)}function h(d,g,x){for(;d!==null;){var L=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,L!==null&&(L.childLanes|=g)):L!==null&&(L.childLanes&g)!==g&&(L.childLanes|=g),d===x)break;d=d.return}}function f(d,g,x,L){var G=d.child;for(G!==null&&(G.return=d);G!==null;){var X=G.dependencies;if(X!==null){var ye=G.child;X=X.firstContext;e:for(;X!==null;){var De=X;X=G;for(var Ke=0;Ke<g.length;Ke++)if(De.context===g[Ke]){X.lanes|=x,De=X.alternate,De!==null&&(De.lanes|=x),h(X.return,x,d),L||(ye=null);break e}X=De.next}}else if(G.tag===18){if(ye=G.return,ye===null)throw Error(i(341));ye.lanes|=x,X=ye.alternate,X!==null&&(X.lanes|=x),h(ye,x,d),ye=null}else ye=G.child;if(ye!==null)ye.return=G;else for(ye=G;ye!==null;){if(ye===d){ye=null;break}if(G=ye.sibling,G!==null){G.return=ye.return,ye=G;break}ye=ye.return}G=ye}}function _(d,g,x,L){d=null;for(var G=g,X=!1;G!==null;){if(!X){if((G.flags&524288)!==0)X=!0;else if((G.flags&262144)!==0)break}if(G.tag===10){var ye=G.alternate;if(ye===null)throw Error(i(387));if(ye=ye.memoizedProps,ye!==null){var De=G.type;es(G.pendingProps.value,ye.value)||(d!==null?d.push(De):d=[De])}}else if(G===xe.current){if(ye=G.alternate,ye===null)throw Error(i(387));ye.memoizedState.memoizedState!==G.memoizedState.memoizedState&&(d!==null?d.push(yb):d=[yb])}G=G.return}d!==null&&f(g,d,x,L),g.flags|=262144}function A(d){for(d=d.firstContext;d!==null;){if(!es(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function D(d){uo=d,Cn=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function H(d){return ge(uo,d)}function re(d,g){return uo===null&&D(d),ge(d,g)}function ge(d,g){var x=g._currentValue;if(g={context:g,memoizedValue:x,next:null},Cn===null){if(d===null)throw Error(i(308));Cn=g,d.dependencies={lanes:0,firstContext:g},d.flags|=524288}else Cn=Cn.next=g;return x}var Ne=typeof AbortController<"u"?AbortController:function(){var d=[],g=this.signal={aborted:!1,addEventListener:function(x,L){d.push(L)}};this.abort=function(){g.aborted=!0,d.forEach(function(x){return x()})}},Ye=t.unstable_scheduleCallback,Mt=t.unstable_NormalPriority,At={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hr(){return{controller:new Ne,data:new Map,refCount:0}}function gr(d){d.refCount--,d.refCount===0&&Ye(Mt,function(){d.controller.abort()})}var Sr=null,Qr=0,ji=0,$n=null;function rs(d,g){if(Sr===null){var x=Sr=[];Qr=0,ji=Q4(),$n={status:"pending",value:void 0,then:function(L){x.push(L)}}}return Qr++,g.then(gu,gu),g}function gu(){if(--Qr===0&&Sr!==null){$n!==null&&($n.status="fulfilled");var d=Sr;Sr=null,ji=0,$n=null;for(var g=0;g<d.length;g++)(0,d[g])()}}function fh(d,g){var x=[],L={status:"pending",value:null,reason:null,then:function(G){x.push(G)}};return d.then(function(){L.status="fulfilled",L.value=g;for(var G=0;G<x.length;G++)(0,x[G])(g)},function(G){for(L.status="rejected",L.reason=G,G=0;G<x.length;G++)(0,x[G])(void 0)}),L}var Fv=Y.S;Y.S=function(d,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&rs(d,g),Fv!==null&&Fv(d,g)};var Eg=le(null);function J5(){var d=Eg.current;return d!==null?d:Pa.pooledCache}function TS(d,g){g===null?ce(Eg,Eg.current):ce(Eg,g.pool)}function Pj(){var d=J5();return d===null?null:{parent:At._currentValue,pool:d}}var Hx=Error(i(460)),Lj=Error(i(474)),PS=Error(i(542)),Q5={then:function(){}};function Dj(d){return d=d.status,d==="fulfilled"||d==="rejected"}function LS(){}function Rj(d,g,x){switch(x=d[x],x===void 0?d.push(g):x!==g&&(g.then(LS,LS),g=x),g.status){case"fulfilled":return g.value;case"rejected":throw d=g.reason,kj(d),d;default:if(typeof g.status=="string")g.then(LS,LS);else{if(d=Pa,d!==null&&100<d.shellSuspendCounter)throw Error(i(482));d=g,d.status="pending",d.then(function(L){if(g.status==="pending"){var G=g;G.status="fulfilled",G.value=L}},function(L){if(g.status==="pending"){var G=g;G.status="rejected",G.reason=L}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw d=g.reason,kj(d),d}throw qx=g,Hx}}var qx=null;function Oj(){if(qx===null)throw Error(i(459));var d=qx;return qx=null,d}function kj(d){if(d===Hx||d===PS)throw Error(i(483))}var kf=!1;function e4(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function t4(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Nf(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function Ff(d,g,x){var L=d.updateQueue;if(L===null)return null;if(L=L.shared,(na&2)!==0){var G=L.pending;return G===null?g.next=g:(g.next=G.next,G.next=g),L.pending=g,g=wo(d),up(d,null,x),g}return Yu(d,L,g,x),wo(d)}function Wx(d,g,x){if(g=g.updateQueue,g!==null&&(g=g.shared,(x&4194048)!==0)){var L=g.lanes;L&=d.pendingLanes,x|=L,g.lanes=x,ze(d,x)}}function r4(d,g){var x=d.updateQueue,L=d.alternate;if(L!==null&&(L=L.updateQueue,x===L)){var G=null,X=null;if(x=x.firstBaseUpdate,x!==null){do{var ye={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};X===null?G=X=ye:X=X.next=ye,x=x.next}while(x!==null);X===null?G=X=g:X=X.next=g}else G=X=g;x={baseState:L.baseState,firstBaseUpdate:G,lastBaseUpdate:X,shared:L.shared,callbacks:L.callbacks},d.updateQueue=x;return}d=x.lastBaseUpdate,d===null?x.firstBaseUpdate=g:d.next=g,x.lastBaseUpdate=g}var i4=!1;function Xx(){if(i4){var d=$n;if(d!==null)throw d}}function Zx(d,g,x,L){i4=!1;var G=d.updateQueue;kf=!1;var X=G.firstBaseUpdate,ye=G.lastBaseUpdate,De=G.shared.pending;if(De!==null){G.shared.pending=null;var Ke=De,Ct=Ke.next;Ke.next=null,ye===null?X=Ct:ye.next=Ct,ye=Ke;var Xt=d.alternate;Xt!==null&&(Xt=Xt.updateQueue,De=Xt.lastBaseUpdate,De!==ye&&(De===null?Xt.firstBaseUpdate=Ct:De.next=Ct,Xt.lastBaseUpdate=Ke))}if(X!==null){var tr=G.baseState;ye=0,Xt=Ct=Ke=null,De=X;do{var Dt=De.lane&-536870913,Ot=Dt!==De.lane;if(Ot?(In&Dt)===Dt:(L&Dt)===Dt){Dt!==0&&Dt===ji&&(i4=!0),Xt!==null&&(Xt=Xt.next={lane:0,tag:De.tag,payload:De.payload,callback:null,next:null});e:{var Ci=d,xi=De;Dt=g;var fa=x;switch(xi.tag){case 1:if(Ci=xi.payload,typeof Ci=="function"){tr=Ci.call(fa,tr,Dt);break e}tr=Ci;break e;case 3:Ci.flags=Ci.flags&-65537|128;case 0:if(Ci=xi.payload,Dt=typeof Ci=="function"?Ci.call(fa,tr,Dt):Ci,Dt==null)break e;tr=p({},tr,Dt);break e;case 2:kf=!0}}Dt=De.callback,Dt!==null&&(d.flags|=64,Ot&&(d.flags|=8192),Ot=G.callbacks,Ot===null?G.callbacks=[Dt]:Ot.push(Dt))}else Ot={lane:Dt,tag:De.tag,payload:De.payload,callback:De.callback,next:null},Xt===null?(Ct=Xt=Ot,Ke=tr):Xt=Xt.next=Ot,ye|=Dt;if(De=De.next,De===null){if(De=G.shared.pending,De===null)break;Ot=De,De=Ot.next,Ot.next=null,G.lastBaseUpdate=Ot,G.shared.pending=null}}while(!0);Xt===null&&(Ke=tr),G.baseState=Ke,G.firstBaseUpdate=Ct,G.lastBaseUpdate=Xt,X===null&&(G.shared.lanes=0),Hf|=ye,d.lanes=ye,d.memoizedState=tr}}function Nj(d,g){if(typeof d!="function")throw Error(i(191,d));d.call(g)}function Fj(d,g){var x=d.callbacks;if(x!==null)for(d.callbacks=null,d=0;d<x.length;d++)Nj(x[d],g)}var Bv=le(null),DS=le(0);function Bj(d,g){d=bd,ce(DS,d),ce(Bv,g),bd=d|g.baseLanes}function n4(){ce(DS,bd),ce(Bv,Bv.current)}function a4(){bd=DS.current,K(Bv),K(DS)}var Bf=0,tn=null,pa=null,is=null,RS=!1,zv=!1,Cg=!1,OS=0,Yx=0,Uv=null,IDe=0;function Uo(){throw Error(i(321))}function o4(d,g){if(g===null)return!1;for(var x=0;x<g.length&&x<d.length;x++)if(!es(d[x],g[x]))return!1;return!0}function s4(d,g,x,L,G,X){return Bf=X,tn=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Y.H=d===null||d.memoizedState===null?b$:w$,Cg=!1,X=x(L,G),Cg=!1,zv&&(X=Uj(g,x,L,G)),zj(d),X}function zj(d){Y.H=US;var g=pa!==null&&pa.next!==null;if(Bf=0,is=pa=tn=null,RS=!1,Yx=0,Uv=null,g)throw Error(i(300));d===null||Os||(d=d.dependencies,d!==null&&A(d)&&(Os=!0))}function Uj(d,g,x,L){tn=d;var G=0;do{if(zv&&(Uv=null),Yx=0,zv=!1,25<=G)throw Error(i(301));if(G+=1,is=pa=null,d.updateQueue!=null){var X=d.updateQueue;X.lastEffect=null,X.events=null,X.stores=null,X.memoCache!=null&&(X.memoCache.index=0)}Y.H=kDe,X=g(x,L)}while(zv);return X}function TDe(){var d=Y.H,g=d.useState()[0];return g=typeof g.then=="function"?Kx(g):g,d=d.useState()[0],(pa!==null?pa.memoizedState:null)!==d&&(tn.flags|=1024),g}function l4(){var d=OS!==0;return OS=0,d}function u4(d,g,x){g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~x}function c4(d){if(RS){for(d=d.memoizedState;d!==null;){var g=d.queue;g!==null&&(g.pending=null),d=d.next}RS=!1}Bf=0,is=pa=tn=null,zv=!1,Yx=OS=0,Uv=null}function yu(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?tn.memoizedState=is=d:is=is.next=d,is}function ns(){if(pa===null){var d=tn.alternate;d=d!==null?d.memoizedState:null}else d=pa.next;var g=is===null?tn.memoizedState:is.next;if(g!==null)is=g,pa=d;else{if(d===null)throw tn.alternate===null?Error(i(467)):Error(i(310));pa=d,d={memoizedState:pa.memoizedState,baseState:pa.baseState,baseQueue:pa.baseQueue,queue:pa.queue,next:null},is===null?tn.memoizedState=is=d:is=is.next=d}return is}function h4(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kx(d){var g=Yx;return Yx+=1,Uv===null&&(Uv=[]),d=Rj(Uv,d,g),g=tn,(is===null?g.memoizedState:is.next)===null&&(g=g.alternate,Y.H=g===null||g.memoizedState===null?b$:w$),d}function kS(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Kx(d);if(d.$$typeof===C)return H(d)}throw Error(i(438,String(d)))}function p4(d){var g=null,x=tn.updateQueue;if(x!==null&&(g=x.memoCache),g==null){var L=tn.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(g={data:L.data.map(function(G){return G.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),x===null&&(x=h4(),tn.updateQueue=x),x.memoCache=g,x=g.data[g.index],x===void 0)for(x=g.data[g.index]=Array(d),L=0;L<d;L++)x[L]=z;return g.index++,x}function md(d,g){return typeof g=="function"?g(d):g}function NS(d){var g=ns();return d4(g,pa,d)}function d4(d,g,x){var L=d.queue;if(L===null)throw Error(i(311));L.lastRenderedReducer=x;var G=d.baseQueue,X=L.pending;if(X!==null){if(G!==null){var ye=G.next;G.next=X.next,X.next=ye}g.baseQueue=G=X,L.pending=null}if(X=d.baseState,G===null)d.memoizedState=X;else{g=G.next;var De=ye=null,Ke=null,Ct=g,Xt=!1;do{var tr=Ct.lane&-536870913;if(tr!==Ct.lane?(In&tr)===tr:(Bf&tr)===tr){var Dt=Ct.revertLane;if(Dt===0)Ke!==null&&(Ke=Ke.next={lane:0,revertLane:0,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null}),tr===ji&&(Xt=!0);else if((Bf&Dt)===Dt){Ct=Ct.next,Dt===ji&&(Xt=!0);continue}else tr={lane:0,revertLane:Ct.revertLane,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null},Ke===null?(De=Ke=tr,ye=X):Ke=Ke.next=tr,tn.lanes|=Dt,Hf|=Dt;tr=Ct.action,Cg&&x(X,tr),X=Ct.hasEagerState?Ct.eagerState:x(X,tr)}else Dt={lane:tr,revertLane:Ct.revertLane,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null},Ke===null?(De=Ke=Dt,ye=X):Ke=Ke.next=Dt,tn.lanes|=tr,Hf|=tr;Ct=Ct.next}while(Ct!==null&&Ct!==g);if(Ke===null?ye=X:Ke.next=De,!es(X,d.memoizedState)&&(Os=!0,Xt&&(x=$n,x!==null)))throw x;d.memoizedState=X,d.baseState=ye,d.baseQueue=Ke,L.lastRenderedState=X}return G===null&&(L.lanes=0),[d.memoizedState,L.dispatch]}function f4(d){var g=ns(),x=g.queue;if(x===null)throw Error(i(311));x.lastRenderedReducer=d;var L=x.dispatch,G=x.pending,X=g.memoizedState;if(G!==null){x.pending=null;var ye=G=G.next;do X=d(X,ye.action),ye=ye.next;while(ye!==G);es(X,g.memoizedState)||(Os=!0),g.memoizedState=X,g.baseQueue===null&&(g.baseState=X),x.lastRenderedState=X}return[X,L]}function Vj(d,g,x){var L=tn,G=ns(),X=bn;if(X){if(x===void 0)throw Error(i(407));x=x()}else x=g();var ye=!es((pa||G).memoizedState,x);ye&&(G.memoizedState=x,Os=!0),G=G.queue;var De=Gj.bind(null,L,G,d);if(Jx(2048,8,De,[d]),G.getSnapshot!==g||ye||is!==null&&is.memoizedState.tag&1){if(L.flags|=2048,Vv(9,FS(),$j.bind(null,L,G,x,g),null),Pa===null)throw Error(i(349));X||(Bf&124)!==0||jj(L,g,x)}return x}function jj(d,g,x){d.flags|=16384,d={getSnapshot:g,value:x},g=tn.updateQueue,g===null?(g=h4(),tn.updateQueue=g,g.stores=[d]):(x=g.stores,x===null?g.stores=[d]:x.push(d))}function $j(d,g,x,L){g.value=x,g.getSnapshot=L,Hj(g)&&qj(d)}function Gj(d,g,x){return x(function(){Hj(g)&&qj(d)})}function Hj(d){var g=d.getSnapshot;d=d.value;try{var x=g();return!es(d,x)}catch{return!0}}function qj(d){var g=xs(d,2);g!==null&&ic(g,d,2)}function m4(d){var g=yu();if(typeof d=="function"){var x=d;if(d=x(),Cg){Yt(!0);try{x()}finally{Yt(!1)}}}return g.memoizedState=g.baseState=d,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:d},g}function Wj(d,g,x,L){return d.baseState=x,d4(d,pa,typeof L=="function"?L:md)}function PDe(d,g,x,L,G){if(zS(d))throw Error(i(485));if(d=g.action,d!==null){var X={payload:G,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ye){X.listeners.push(ye)}};Y.T!==null?x(!0):X.isTransition=!1,L(X),x=g.pending,x===null?(X.next=g.pending=X,Xj(g,X)):(X.next=x.next,g.pending=x.next=X)}}function Xj(d,g){var x=g.action,L=g.payload,G=d.state;if(g.isTransition){var X=Y.T,ye={};Y.T=ye;try{var De=x(G,L),Ke=Y.S;Ke!==null&&Ke(ye,De),Zj(d,g,De)}catch(Ct){g4(d,g,Ct)}finally{Y.T=X}}else try{X=x(G,L),Zj(d,g,X)}catch(Ct){g4(d,g,Ct)}}function Zj(d,g,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(L){Yj(d,g,L)},function(L){return g4(d,g,L)}):Yj(d,g,x)}function Yj(d,g,x){g.status="fulfilled",g.value=x,Kj(g),d.state=x,g=d.pending,g!==null&&(x=g.next,x===g?d.pending=null:(x=x.next,g.next=x,Xj(d,x)))}function g4(d,g,x){var L=d.pending;if(d.pending=null,L!==null){L=L.next;do g.status="rejected",g.reason=x,Kj(g),g=g.next;while(g!==L)}d.action=null}function Kj(d){d=d.listeners;for(var g=0;g<d.length;g++)(0,d[g])()}function Jj(d,g){return g}function Qj(d,g){if(bn){var x=Pa.formState;if(x!==null){e:{var L=tn;if(bn){if(ia){t:{for(var G=ia,X=bs;G.nodeType!==8;){if(!X){G=null;break t}if(G=gh(G.nextSibling),G===null){G=null;break t}}X=G.data,G=X==="F!"||X==="F"?G:null}if(G){ia=gh(G.nextSibling),L=G.data==="F!";break e}}mu(L)}L=!1}L&&(g=x[0])}}return x=yu(),x.memoizedState=x.baseState=g,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jj,lastRenderedState:g},x.queue=L,x=v$.bind(null,tn,L),L.dispatch=x,L=m4(!1),X=b4.bind(null,tn,!1,L.queue),L=yu(),G={state:g,dispatch:null,action:d,pending:null},L.queue=G,x=PDe.bind(null,tn,G,X,x),G.dispatch=x,L.memoizedState=d,[g,x,!1]}function e$(d){var g=ns();return t$(g,pa,d)}function t$(d,g,x){if(g=d4(d,g,Jj)[0],d=NS(md)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var L=Kx(g)}catch(ye){throw ye===Hx?PS:ye}else L=g;g=ns();var G=g.queue,X=G.dispatch;return x!==g.memoizedState&&(tn.flags|=2048,Vv(9,FS(),LDe.bind(null,G,x),null)),[L,X,d]}function LDe(d,g){d.action=g}function r$(d){var g=ns(),x=pa;if(x!==null)return t$(g,x,d);ns(),g=g.memoizedState,x=ns();var L=x.queue.dispatch;return x.memoizedState=d,[g,L,!1]}function Vv(d,g,x,L){return d={tag:d,create:x,deps:L,inst:g,next:null},g=tn.updateQueue,g===null&&(g=h4(),tn.updateQueue=g),x=g.lastEffect,x===null?g.lastEffect=d.next=d:(L=x.next,x.next=d,d.next=L,g.lastEffect=d),d}function FS(){return{destroy:void 0,resource:void 0}}function i$(){return ns().memoizedState}function BS(d,g,x,L){var G=yu();L=L===void 0?null:L,tn.flags|=d,G.memoizedState=Vv(1|g,FS(),x,L)}function Jx(d,g,x,L){var G=ns();L=L===void 0?null:L;var X=G.memoizedState.inst;pa!==null&&L!==null&&o4(L,pa.memoizedState.deps)?G.memoizedState=Vv(g,X,x,L):(tn.flags|=d,G.memoizedState=Vv(1|g,X,x,L))}function n$(d,g){BS(8390656,8,d,g)}function a$(d,g){Jx(2048,8,d,g)}function o$(d,g){return Jx(4,2,d,g)}function s$(d,g){return Jx(4,4,d,g)}function l$(d,g){if(typeof g=="function"){d=d();var x=g(d);return function(){typeof x=="function"?x():g(null)}}if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function u$(d,g,x){x=x!=null?x.concat([d]):null,Jx(4,4,l$.bind(null,g,d),x)}function y4(){}function c$(d,g){var x=ns();g=g===void 0?null:g;var L=x.memoizedState;return g!==null&&o4(g,L[1])?L[0]:(x.memoizedState=[d,g],d)}function h$(d,g){var x=ns();g=g===void 0?null:g;var L=x.memoizedState;if(g!==null&&o4(g,L[1]))return L[0];if(L=d(),Cg){Yt(!0);try{d()}finally{Yt(!1)}}return x.memoizedState=[L,g],L}function v4(d,g,x){return x===void 0||(Bf&1073741824)!==0?d.memoizedState=g:(d.memoizedState=x,d=fG(),tn.lanes|=d,Hf|=d,x)}function p$(d,g,x,L){return es(x,g)?x:Bv.current!==null?(d=v4(d,x,L),es(d,g)||(Os=!0),d):(Bf&42)===0?(Os=!0,d.memoizedState=x):(d=fG(),tn.lanes|=d,Hf|=d,g)}function d$(d,g,x,L,G){var X=he.p;he.p=X!==0&&8>X?X:8;var ye=Y.T,De={};Y.T=De,b4(d,!1,g,x);try{var Ke=G(),Ct=Y.S;if(Ct!==null&&Ct(De,Ke),Ke!==null&&typeof Ke=="object"&&typeof Ke.then=="function"){var Xt=fh(Ke,L);Qx(d,g,Xt,rc(d))}else Qx(d,g,L,rc(d))}catch(tr){Qx(d,g,{then:function(){},status:"rejected",reason:tr},rc())}finally{he.p=X,Y.T=ye}}function DDe(){}function _4(d,g,x,L){if(d.tag!==5)throw Error(i(476));var G=f$(d).queue;d$(d,G,g,Q,x===null?DDe:function(){return m$(d),x(L)})}function f$(d){var g=d.memoizedState;if(g!==null)return g;g={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:Q},next:null};var x={};return g.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:x},next:null},d.memoizedState=g,d=d.alternate,d!==null&&(d.memoizedState=g),g}function m$(d){var g=f$(d).next.queue;Qx(d,g,{},rc())}function x4(){return H(yb)}function g$(){return ns().memoizedState}function y$(){return ns().memoizedState}function RDe(d){for(var g=d.return;g!==null;){switch(g.tag){case 24:case 3:var x=rc();d=Nf(x);var L=Ff(g,d,x);L!==null&&(ic(L,g,x),Wx(L,g,x)),g={cache:hr()},d.payload=g;return}g=g.return}}function ODe(d,g,x){var L=rc();x={lane:L,revertLane:0,action:x,hasEagerState:!1,eagerState:null,next:null},zS(d)?_$(g,x):(x=ch(d,g,x,L),x!==null&&(ic(x,d,L),x$(x,g,L)))}function v$(d,g,x){var L=rc();Qx(d,g,x,L)}function Qx(d,g,x,L){var G={lane:L,revertLane:0,action:x,hasEagerState:!1,eagerState:null,next:null};if(zS(d))_$(g,G);else{var X=d.alternate;if(d.lanes===0&&(X===null||X.lanes===0)&&(X=g.lastRenderedReducer,X!==null))try{var ye=g.lastRenderedState,De=X(ye,x);if(G.hasEagerState=!0,G.eagerState=De,es(De,ye))return Yu(d,g,G,0),Pa===null&&Ds(),!1}catch{}finally{}if(x=ch(d,g,G,L),x!==null)return ic(x,d,L),x$(x,g,L),!0}return!1}function b4(d,g,x,L){if(L={lane:2,revertLane:Q4(),action:L,hasEagerState:!1,eagerState:null,next:null},zS(d)){if(g)throw Error(i(479))}else g=ch(d,x,L,2),g!==null&&ic(g,d,2)}function zS(d){var g=d.alternate;return d===tn||g!==null&&g===tn}function _$(d,g){zv=RS=!0;var x=d.pending;x===null?g.next=g:(g.next=x.next,x.next=g),d.pending=g}function x$(d,g,x){if((x&4194048)!==0){var L=g.lanes;L&=d.pendingLanes,x|=L,g.lanes=x,ze(d,x)}}var US={readContext:H,use:kS,useCallback:Uo,useContext:Uo,useEffect:Uo,useImperativeHandle:Uo,useLayoutEffect:Uo,useInsertionEffect:Uo,useMemo:Uo,useReducer:Uo,useRef:Uo,useState:Uo,useDebugValue:Uo,useDeferredValue:Uo,useTransition:Uo,useSyncExternalStore:Uo,useId:Uo,useHostTransitionStatus:Uo,useFormState:Uo,useActionState:Uo,useOptimistic:Uo,useMemoCache:Uo,useCacheRefresh:Uo},b$={readContext:H,use:kS,useCallback:function(d,g){return yu().memoizedState=[d,g===void 0?null:g],d},useContext:H,useEffect:n$,useImperativeHandle:function(d,g,x){x=x!=null?x.concat([d]):null,BS(4194308,4,l$.bind(null,g,d),x)},useLayoutEffect:function(d,g){return BS(4194308,4,d,g)},useInsertionEffect:function(d,g){BS(4,2,d,g)},useMemo:function(d,g){var x=yu();g=g===void 0?null:g;var L=d();if(Cg){Yt(!0);try{d()}finally{Yt(!1)}}return x.memoizedState=[L,g],L},useReducer:function(d,g,x){var L=yu();if(x!==void 0){var G=x(g);if(Cg){Yt(!0);try{x(g)}finally{Yt(!1)}}}else G=g;return L.memoizedState=L.baseState=G,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:G},L.queue=d,d=d.dispatch=ODe.bind(null,tn,d),[L.memoizedState,d]},useRef:function(d){var g=yu();return d={current:d},g.memoizedState=d},useState:function(d){d=m4(d);var g=d.queue,x=v$.bind(null,tn,g);return g.dispatch=x,[d.memoizedState,x]},useDebugValue:y4,useDeferredValue:function(d,g){var x=yu();return v4(x,d,g)},useTransition:function(){var d=m4(!1);return d=d$.bind(null,tn,d.queue,!0,!1),yu().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,g,x){var L=tn,G=yu();if(bn){if(x===void 0)throw Error(i(407));x=x()}else{if(x=g(),Pa===null)throw Error(i(349));(In&124)!==0||jj(L,g,x)}G.memoizedState=x;var X={value:x,getSnapshot:g};return G.queue=X,n$(Gj.bind(null,L,X,d),[d]),L.flags|=2048,Vv(9,FS(),$j.bind(null,L,X,x,g),null),x},useId:function(){var d=yu(),g=Pa.identifierPrefix;if(bn){var x=Fc,L=Bo;x=(L&~(1<<32-Kt(L)-1)).toString(32)+x,g=""+g+"R"+x,x=OS++,0<x&&(g+="H"+x.toString(32)),g+=""}else x=IDe++,g=""+g+"r"+x.toString(32)+"";return d.memoizedState=g},useHostTransitionStatus:x4,useFormState:Qj,useActionState:Qj,useOptimistic:function(d){var g=yu();g.memoizedState=g.baseState=d;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=x,g=b4.bind(null,tn,!0,x),x.dispatch=g,[d,g]},useMemoCache:p4,useCacheRefresh:function(){return yu().memoizedState=RDe.bind(null,tn)}},w$={readContext:H,use:kS,useCallback:c$,useContext:H,useEffect:a$,useImperativeHandle:u$,useInsertionEffect:o$,useLayoutEffect:s$,useMemo:h$,useReducer:NS,useRef:i$,useState:function(){return NS(md)},useDebugValue:y4,useDeferredValue:function(d,g){var x=ns();return p$(x,pa.memoizedState,d,g)},useTransition:function(){var d=NS(md)[0],g=ns().memoizedState;return[typeof d=="boolean"?d:Kx(d),g]},useSyncExternalStore:Vj,useId:g$,useHostTransitionStatus:x4,useFormState:e$,useActionState:e$,useOptimistic:function(d,g){var x=ns();return Wj(x,pa,d,g)},useMemoCache:p4,useCacheRefresh:y$},kDe={readContext:H,use:kS,useCallback:c$,useContext:H,useEffect:a$,useImperativeHandle:u$,useInsertionEffect:o$,useLayoutEffect:s$,useMemo:h$,useReducer:f4,useRef:i$,useState:function(){return f4(md)},useDebugValue:y4,useDeferredValue:function(d,g){var x=ns();return pa===null?v4(x,d,g):p$(x,pa.memoizedState,d,g)},useTransition:function(){var d=f4(md)[0],g=ns().memoizedState;return[typeof d=="boolean"?d:Kx(d),g]},useSyncExternalStore:Vj,useId:g$,useHostTransitionStatus:x4,useFormState:r$,useActionState:r$,useOptimistic:function(d,g){var x=ns();return pa!==null?Wj(x,pa,d,g):(x.baseState=d,[d,x.queue.dispatch])},useMemoCache:p4,useCacheRefresh:y$},jv=null,eb=0;function VS(d){var g=eb;return eb+=1,jv===null&&(jv=[]),Rj(jv,d,g)}function tb(d,g){g=g.props.ref,d.ref=g!==void 0?g:null}function jS(d,g){throw g.$$typeof===m?Error(i(525)):(d=Object.prototype.toString.call(g),Error(i(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d)))}function A$(d){var g=d._init;return g(d._payload)}function S$(d){function g(gt,ut){if(d){var St=gt.deletions;St===null?(gt.deletions=[ut],gt.flags|=16):St.push(ut)}}function x(gt,ut){if(!d)return null;for(;ut!==null;)g(gt,ut),ut=ut.sibling;return null}function L(gt){for(var ut=new Map;gt!==null;)gt.key!==null?ut.set(gt.key,gt):ut.set(gt.index,gt),gt=gt.sibling;return ut}function G(gt,ut){return gt=ha(gt,ut),gt.index=0,gt.sibling=null,gt}function X(gt,ut,St){return gt.index=St,d?(St=gt.alternate,St!==null?(St=St.index,St<ut?(gt.flags|=67108866,ut):St):(gt.flags|=67108866,ut)):(gt.flags|=1048576,ut)}function ye(gt){return d&&gt.alternate===null&&(gt.flags|=67108866),gt}function De(gt,ut,St,Qt){return ut===null||ut.tag!==6?(ut=Ku(St,gt.mode,Qt),ut.return=gt,ut):(ut=G(ut,St),ut.return=gt,ut)}function Ke(gt,ut,St,Qt){var ti=St.type;return ti===w?Xt(gt,ut,St.props.children,Qt,St.key):ut!==null&&(ut.elementType===ti||typeof ti=="object"&&ti!==null&&ti.$$typeof===B&&A$(ti)===ut.type)?(ut=G(ut,St.props),tb(ut,St),ut.return=gt,ut):(ut=Rf(St.type,St.key,St.props,null,gt.mode,Qt),tb(ut,St),ut.return=gt,ut)}function Ct(gt,ut,St,Qt){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==St.containerInfo||ut.stateNode.implementation!==St.implementation?(ut=Fa(St,gt.mode,Qt),ut.return=gt,ut):(ut=G(ut,St.children||[]),ut.return=gt,ut)}function Xt(gt,ut,St,Qt,ti){return ut===null||ut.tag!==7?(ut=Vl(St,gt.mode,Qt,ti),ut.return=gt,ut):(ut=G(ut,St),ut.return=gt,ut)}function tr(gt,ut,St){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return ut=Ku(""+ut,gt.mode,St),ut.return=gt,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case y:return St=Rf(ut.type,ut.key,ut.props,null,gt.mode,St),tb(St,ut),St.return=gt,St;case v:return ut=Fa(ut,gt.mode,St),ut.return=gt,ut;case B:var Qt=ut._init;return ut=Qt(ut._payload),tr(gt,ut,St)}if(oe(ut)||W(ut))return ut=Vl(ut,gt.mode,St,null),ut.return=gt,ut;if(typeof ut.then=="function")return tr(gt,VS(ut),St);if(ut.$$typeof===C)return tr(gt,re(gt,ut),St);jS(gt,ut)}return null}function Dt(gt,ut,St,Qt){var ti=ut!==null?ut.key:null;if(typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint")return ti!==null?null:De(gt,ut,""+St,Qt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case y:return St.key===ti?Ke(gt,ut,St,Qt):null;case v:return St.key===ti?Ct(gt,ut,St,Qt):null;case B:return ti=St._init,St=ti(St._payload),Dt(gt,ut,St,Qt)}if(oe(St)||W(St))return ti!==null?null:Xt(gt,ut,St,Qt,null);if(typeof St.then=="function")return Dt(gt,ut,VS(St),Qt);if(St.$$typeof===C)return Dt(gt,ut,re(gt,St),Qt);jS(gt,St)}return null}function Ot(gt,ut,St,Qt,ti){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint")return gt=gt.get(St)||null,De(ut,gt,""+Qt,ti);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case y:return gt=gt.get(Qt.key===null?St:Qt.key)||null,Ke(ut,gt,Qt,ti);case v:return gt=gt.get(Qt.key===null?St:Qt.key)||null,Ct(ut,gt,Qt,ti);case B:var hn=Qt._init;return Qt=hn(Qt._payload),Ot(gt,ut,St,Qt,ti)}if(oe(Qt)||W(Qt))return gt=gt.get(St)||null,Xt(ut,gt,Qt,ti,null);if(typeof Qt.then=="function")return Ot(gt,ut,St,VS(Qt),ti);if(Qt.$$typeof===C)return Ot(gt,ut,St,re(ut,Qt),ti);jS(ut,Qt)}return null}function Ci(gt,ut,St,Qt){for(var ti=null,hn=null,pi=ut,Ai=ut=0,Ns=null;pi!==null&&Ai<St.length;Ai++){pi.index>Ai?(Ns=pi,pi=null):Ns=pi.sibling;var Fn=Dt(gt,pi,St[Ai],Qt);if(Fn===null){pi===null&&(pi=Ns);break}d&&pi&&Fn.alternate===null&&g(gt,pi),ut=X(Fn,ut,Ai),hn===null?ti=Fn:hn.sibling=Fn,hn=Fn,pi=Ns}if(Ai===St.length)return x(gt,pi),bn&&Ju(gt,Ai),ti;if(pi===null){for(;Ai<St.length;Ai++)pi=tr(gt,St[Ai],Qt),pi!==null&&(ut=X(pi,ut,Ai),hn===null?ti=pi:hn.sibling=pi,hn=pi);return bn&&Ju(gt,Ai),ti}for(pi=L(pi);Ai<St.length;Ai++)Ns=Ot(pi,gt,Ai,St[Ai],Qt),Ns!==null&&(d&&Ns.alternate!==null&&pi.delete(Ns.key===null?Ai:Ns.key),ut=X(Ns,ut,Ai),hn===null?ti=Ns:hn.sibling=Ns,hn=Ns);return d&&pi.forEach(function(em){return g(gt,em)}),bn&&Ju(gt,Ai),ti}function xi(gt,ut,St,Qt){if(St==null)throw Error(i(151));for(var ti=null,hn=null,pi=ut,Ai=ut=0,Ns=null,Fn=St.next();pi!==null&&!Fn.done;Ai++,Fn=St.next()){pi.index>Ai?(Ns=pi,pi=null):Ns=pi.sibling;var em=Dt(gt,pi,Fn.value,Qt);if(em===null){pi===null&&(pi=Ns);break}d&&pi&&em.alternate===null&&g(gt,pi),ut=X(em,ut,Ai),hn===null?ti=em:hn.sibling=em,hn=em,pi=Ns}if(Fn.done)return x(gt,pi),bn&&Ju(gt,Ai),ti;if(pi===null){for(;!Fn.done;Ai++,Fn=St.next())Fn=tr(gt,Fn.value,Qt),Fn!==null&&(ut=X(Fn,ut,Ai),hn===null?ti=Fn:hn.sibling=Fn,hn=Fn);return bn&&Ju(gt,Ai),ti}for(pi=L(pi);!Fn.done;Ai++,Fn=St.next())Fn=Ot(pi,gt,Ai,Fn.value,Qt),Fn!==null&&(d&&Fn.alternate!==null&&pi.delete(Fn.key===null?Ai:Fn.key),ut=X(Fn,ut,Ai),hn===null?ti=Fn:hn.sibling=Fn,hn=Fn);return d&&pi.forEach(function(NRe){return g(gt,NRe)}),bn&&Ju(gt,Ai),ti}function fa(gt,ut,St,Qt){if(typeof St=="object"&&St!==null&&St.type===w&&St.key===null&&(St=St.props.children),typeof St=="object"&&St!==null){switch(St.$$typeof){case y:e:{for(var ti=St.key;ut!==null;){if(ut.key===ti){if(ti=St.type,ti===w){if(ut.tag===7){x(gt,ut.sibling),Qt=G(ut,St.props.children),Qt.return=gt,gt=Qt;break e}}else if(ut.elementType===ti||typeof ti=="object"&&ti!==null&&ti.$$typeof===B&&A$(ti)===ut.type){x(gt,ut.sibling),Qt=G(ut,St.props),tb(Qt,St),Qt.return=gt,gt=Qt;break e}x(gt,ut);break}else g(gt,ut);ut=ut.sibling}St.type===w?(Qt=Vl(St.props.children,gt.mode,Qt,St.key),Qt.return=gt,gt=Qt):(Qt=Rf(St.type,St.key,St.props,null,gt.mode,Qt),tb(Qt,St),Qt.return=gt,gt=Qt)}return ye(gt);case v:e:{for(ti=St.key;ut!==null;){if(ut.key===ti)if(ut.tag===4&&ut.stateNode.containerInfo===St.containerInfo&&ut.stateNode.implementation===St.implementation){x(gt,ut.sibling),Qt=G(ut,St.children||[]),Qt.return=gt,gt=Qt;break e}else{x(gt,ut);break}else g(gt,ut);ut=ut.sibling}Qt=Fa(St,gt.mode,Qt),Qt.return=gt,gt=Qt}return ye(gt);case B:return ti=St._init,St=ti(St._payload),fa(gt,ut,St,Qt)}if(oe(St))return Ci(gt,ut,St,Qt);if(W(St)){if(ti=W(St),typeof ti!="function")throw Error(i(150));return St=ti.call(St),xi(gt,ut,St,Qt)}if(typeof St.then=="function")return fa(gt,ut,VS(St),Qt);if(St.$$typeof===C)return fa(gt,ut,re(gt,St),Qt);jS(gt,St)}return typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint"?(St=""+St,ut!==null&&ut.tag===6?(x(gt,ut.sibling),Qt=G(ut,St),Qt.return=gt,gt=Qt):(x(gt,ut),Qt=Ku(St,gt.mode,Qt),Qt.return=gt,gt=Qt),ye(gt)):x(gt,ut)}return function(gt,ut,St,Qt){try{eb=0;var ti=fa(gt,ut,St,Qt);return jv=null,ti}catch(pi){if(pi===Hx||pi===PS)throw pi;var hn=vl(29,pi,null,gt.mode);return hn.lanes=Qt,hn.return=gt,hn}finally{}}}var $v=S$(!0),M$=S$(!1),zc=le(null),cp=null;function zf(d){var g=d.alternate;ce(ws,ws.current&1),ce(zc,d),cp===null&&(g===null||Bv.current!==null||g.memoizedState!==null)&&(cp=d)}function E$(d){if(d.tag===22){if(ce(ws,ws.current),ce(zc,d),cp===null){var g=d.alternate;g!==null&&g.memoizedState!==null&&(cp=d)}}else Uf()}function Uf(){ce(ws,ws.current),ce(zc,zc.current)}function gd(d){K(zc),cp===d&&(cp=null),K(ws)}var ws=le(0);function $S(d){for(var g=d;g!==null;){if(g.tag===13){var x=g.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||hL(x)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function w4(d,g,x,L){g=d.memoizedState,x=x(L,g),x=x==null?g:p({},g,x),d.memoizedState=x,d.lanes===0&&(d.updateQueue.baseState=x)}var A4={enqueueSetState:function(d,g,x){d=d._reactInternals;var L=rc(),G=Nf(L);G.payload=g,x!=null&&(G.callback=x),g=Ff(d,G,L),g!==null&&(ic(g,d,L),Wx(g,d,L))},enqueueReplaceState:function(d,g,x){d=d._reactInternals;var L=rc(),G=Nf(L);G.tag=1,G.payload=g,x!=null&&(G.callback=x),g=Ff(d,G,L),g!==null&&(ic(g,d,L),Wx(g,d,L))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var x=rc(),L=Nf(x);L.tag=2,g!=null&&(L.callback=g),g=Ff(d,L,x),g!==null&&(ic(g,d,x),Wx(g,d,x))}};function C$(d,g,x,L,G,X,ye){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(L,X,ye):g.prototype&&g.prototype.isPureReactComponent?!Df(x,L)||!Df(G,X):!0}function I$(d,g,x,L){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(x,L),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(x,L),g.state!==d&&A4.enqueueReplaceState(g,g.state,null)}function Ig(d,g){var x=g;if("ref"in g){x={};for(var L in g)L!=="ref"&&(x[L]=g[L])}if(d=d.defaultProps){x===g&&(x=p({},x));for(var G in d)x[G]===void 0&&(x[G]=d[G])}return x}var GS=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function T$(d){GS(d)}function P$(d){console.error(d)}function L$(d){GS(d)}function HS(d,g){try{var x=d.onUncaughtError;x(g.value,{componentStack:g.stack})}catch(L){setTimeout(function(){throw L})}}function D$(d,g,x){try{var L=d.onCaughtError;L(x.value,{componentStack:x.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(G){setTimeout(function(){throw G})}}function S4(d,g,x){return x=Nf(x),x.tag=3,x.payload={element:null},x.callback=function(){HS(d,g)},x}function R$(d){return d=Nf(d),d.tag=3,d}function O$(d,g,x,L){var G=x.type.getDerivedStateFromError;if(typeof G=="function"){var X=L.value;d.payload=function(){return G(X)},d.callback=function(){D$(g,x,L)}}var ye=x.stateNode;ye!==null&&typeof ye.componentDidCatch=="function"&&(d.callback=function(){D$(g,x,L),typeof G!="function"&&(qf===null?qf=new Set([this]):qf.add(this));var De=L.stack;this.componentDidCatch(L.value,{componentStack:De!==null?De:""})})}function NDe(d,g,x,L,G){if(x.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(g=x.alternate,g!==null&&_(g,x,G,!0),x=zc.current,x!==null){switch(x.tag){case 13:return cp===null?X4():x.alternate===null&&So===0&&(So=3),x.flags&=-257,x.flags|=65536,x.lanes=G,L===Q5?x.flags|=16384:(g=x.updateQueue,g===null?x.updateQueue=new Set([L]):g.add(L),Y4(d,L,G)),!1;case 22:return x.flags|=65536,L===Q5?x.flags|=16384:(g=x.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([L])},x.updateQueue=g):(x=g.retryQueue,x===null?g.retryQueue=new Set([L]):x.add(L)),Y4(d,L,G)),!1}throw Error(i(435,x.tag))}return Y4(d,L,G),X4(),!1}if(bn)return g=zc.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=G,L!==fd&&(d=Error(i(422),{cause:L}),zo(Ln(d,x)))):(L!==fd&&(g=Error(i(423),{cause:L}),zo(Ln(g,x))),d=d.current.alternate,d.flags|=65536,G&=-G,d.lanes|=G,L=Ln(L,x),G=S4(d.stateNode,L,G),r4(d,G),So!==4&&(So=2)),!1;var X=Error(i(520),{cause:L});if(X=Ln(X,x),lb===null?lb=[X]:lb.push(X),So!==4&&(So=2),g===null)return!0;L=Ln(L,x),x=g;do{switch(x.tag){case 3:return x.flags|=65536,d=G&-G,x.lanes|=d,d=S4(x.stateNode,L,d),r4(x,d),!1;case 1:if(g=x.type,X=x.stateNode,(x.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(qf===null||!qf.has(X))))return x.flags|=65536,G&=-G,x.lanes|=G,G=R$(G),O$(G,d,x,L),r4(x,G),!1}x=x.return}while(x!==null);return!1}var k$=Error(i(461)),Os=!1;function Js(d,g,x,L){g.child=d===null?M$(g,null,x,L):$v(g,d.child,x,L)}function N$(d,g,x,L,G){x=x.render;var X=g.ref;if("ref"in L){var ye={};for(var De in L)De!=="ref"&&(ye[De]=L[De])}else ye=L;return D(g),L=s4(d,g,x,ye,X,G),De=l4(),d!==null&&!Os?(u4(d,g,G),yd(d,g,G)):(bn&&De&&Gx(g),g.flags|=1,Js(d,g,L,G),g.child)}function F$(d,g,x,L,G){if(d===null){var X=x.type;return typeof X=="function"&&!kv(X)&&X.defaultProps===void 0&&x.compare===null?(g.tag=15,g.type=X,B$(d,g,X,L,G)):(d=Rf(x.type,null,L,g,g.mode,G),d.ref=g.ref,d.return=g,g.child=d)}if(X=d.child,!D4(d,G)){var ye=X.memoizedProps;if(x=x.compare,x=x!==null?x:Df,x(ye,L)&&d.ref===g.ref)return yd(d,g,G)}return g.flags|=1,d=ha(X,L),d.ref=g.ref,d.return=g,g.child=d}function B$(d,g,x,L,G){if(d!==null){var X=d.memoizedProps;if(Df(X,L)&&d.ref===g.ref)if(Os=!1,g.pendingProps=L=X,D4(d,G))(d.flags&131072)!==0&&(Os=!0);else return g.lanes=d.lanes,yd(d,g,G)}return M4(d,g,x,L,G)}function z$(d,g,x){var L=g.pendingProps,G=L.children,X=d!==null?d.memoizedState:null;if(L.mode==="hidden"){if((g.flags&128)!==0){if(L=X!==null?X.baseLanes|x:x,d!==null){for(G=g.child=d.child,X=0;G!==null;)X=X|G.lanes|G.childLanes,G=G.sibling;g.childLanes=X&~L}else g.childLanes=0,g.child=null;return U$(d,g,L,x)}if((x&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},d!==null&&TS(g,X!==null?X.cachePool:null),X!==null?Bj(g,X):n4(),E$(g);else return g.lanes=g.childLanes=536870912,U$(d,g,X!==null?X.baseLanes|x:x,x)}else X!==null?(TS(g,X.cachePool),Bj(g,X),Uf(),g.memoizedState=null):(d!==null&&TS(g,null),n4(),Uf());return Js(d,g,G,x),g.child}function U$(d,g,x,L){var G=J5();return G=G===null?null:{parent:At._currentValue,pool:G},g.memoizedState={baseLanes:x,cachePool:G},d!==null&&TS(g,null),n4(),E$(g),d!==null&&_(d,g,L,!0),null}function qS(d,g){var x=g.ref;if(x===null)d!==null&&d.ref!==null&&(g.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(i(284));(d===null||d.ref!==x)&&(g.flags|=4194816)}}function M4(d,g,x,L,G){return D(g),x=s4(d,g,x,L,void 0,G),L=l4(),d!==null&&!Os?(u4(d,g,G),yd(d,g,G)):(bn&&L&&Gx(g),g.flags|=1,Js(d,g,x,G),g.child)}function V$(d,g,x,L,G,X){return D(g),g.updateQueue=null,x=Uj(g,L,x,G),zj(d),L=l4(),d!==null&&!Os?(u4(d,g,X),yd(d,g,X)):(bn&&L&&Gx(g),g.flags|=1,Js(d,g,x,X),g.child)}function j$(d,g,x,L,G){if(D(g),g.stateNode===null){var X=Rs,ye=x.contextType;typeof ye=="object"&&ye!==null&&(X=H(ye)),X=new x(L,X),g.memoizedState=X.state!==null&&X.state!==void 0?X.state:null,X.updater=A4,g.stateNode=X,X._reactInternals=g,X=g.stateNode,X.props=L,X.state=g.memoizedState,X.refs={},e4(g),ye=x.contextType,X.context=typeof ye=="object"&&ye!==null?H(ye):Rs,X.state=g.memoizedState,ye=x.getDerivedStateFromProps,typeof ye=="function"&&(w4(g,x,ye,L),X.state=g.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof X.getSnapshotBeforeUpdate=="function"||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(ye=X.state,typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount(),ye!==X.state&&A4.enqueueReplaceState(X,X.state,null),Zx(g,L,X,G),Xx(),X.state=g.memoizedState),typeof X.componentDidMount=="function"&&(g.flags|=4194308),L=!0}else if(d===null){X=g.stateNode;var De=g.memoizedProps,Ke=Ig(x,De);X.props=Ke;var Ct=X.context,Xt=x.contextType;ye=Rs,typeof Xt=="object"&&Xt!==null&&(ye=H(Xt));var tr=x.getDerivedStateFromProps;Xt=typeof tr=="function"||typeof X.getSnapshotBeforeUpdate=="function",De=g.pendingProps!==De,Xt||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(De||Ct!==ye)&&I$(g,X,L,ye),kf=!1;var Dt=g.memoizedState;X.state=Dt,Zx(g,L,X,G),Xx(),Ct=g.memoizedState,De||Dt!==Ct||kf?(typeof tr=="function"&&(w4(g,x,tr,L),Ct=g.memoizedState),(Ke=kf||C$(g,x,Ke,L,Dt,Ct,ye))?(Xt||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(g.flags|=4194308)):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=L,g.memoizedState=Ct),X.props=L,X.state=Ct,X.context=ye,L=Ke):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),L=!1)}else{X=g.stateNode,t4(d,g),ye=g.memoizedProps,Xt=Ig(x,ye),X.props=Xt,tr=g.pendingProps,Dt=X.context,Ct=x.contextType,Ke=Rs,typeof Ct=="object"&&Ct!==null&&(Ke=H(Ct)),De=x.getDerivedStateFromProps,(Ct=typeof De=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(ye!==tr||Dt!==Ke)&&I$(g,X,L,Ke),kf=!1,Dt=g.memoizedState,X.state=Dt,Zx(g,L,X,G),Xx();var Ot=g.memoizedState;ye!==tr||Dt!==Ot||kf||d!==null&&d.dependencies!==null&&A(d.dependencies)?(typeof De=="function"&&(w4(g,x,De,L),Ot=g.memoizedState),(Xt=kf||C$(g,x,Xt,L,Dt,Ot,Ke)||d!==null&&d.dependencies!==null&&A(d.dependencies))?(Ct||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(L,Ot,Ke),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(L,Ot,Ke)),typeof X.componentDidUpdate=="function"&&(g.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof X.componentDidUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=1024),g.memoizedProps=L,g.memoizedState=Ot),X.props=L,X.state=Ot,X.context=Ke,L=Xt):(typeof X.componentDidUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=1024),L=!1)}return X=L,qS(d,g),L=(g.flags&128)!==0,X||L?(X=g.stateNode,x=L&&typeof x.getDerivedStateFromError!="function"?null:X.render(),g.flags|=1,d!==null&&L?(g.child=$v(g,d.child,null,G),g.child=$v(g,null,x,G)):Js(d,g,x,G),g.memoizedState=X.state,d=g.child):d=yd(d,g,G),d}function $$(d,g,x,L){return Bc(),g.flags|=256,Js(d,g,x,L),g.child}var E4={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function C4(d){return{baseLanes:d,cachePool:Pj()}}function I4(d,g,x){return d=d!==null?d.childLanes&~x:0,g&&(d|=Uc),d}function G$(d,g,x){var L=g.pendingProps,G=!1,X=(g.flags&128)!==0,ye;if((ye=X)||(ye=d!==null&&d.memoizedState===null?!1:(ws.current&2)!==0),ye&&(G=!0,g.flags&=-129),ye=(g.flags&32)!==0,g.flags&=-33,d===null){if(bn){if(G?zf(g):Uf(),bn){var De=ia,Ke;if(Ke=De){e:{for(Ke=De,De=bs;Ke.nodeType!==8;){if(!De){De=null;break e}if(Ke=gh(Ke.nextSibling),Ke===null){De=null;break e}}De=Ke}De!==null?(g.memoizedState={dehydrated:De,treeContext:dd!==null?{id:Bo,overflow:Fc}:null,retryLane:536870912,hydrationErrors:null},Ke=vl(18,null,null,0),Ke.stateNode=De,Ke.return=g,g.child=Ke,Ao=g,ia=null,Ke=!0):Ke=!1}Ke||mu(g)}if(De=g.memoizedState,De!==null&&(De=De.dehydrated,De!==null))return hL(De)?g.lanes=32:g.lanes=536870912,null;gd(g)}return De=L.children,L=L.fallback,G?(Uf(),G=g.mode,De=WS({mode:"hidden",children:De},G),L=Vl(L,G,x,null),De.return=g,L.return=g,De.sibling=L,g.child=De,G=g.child,G.memoizedState=C4(x),G.childLanes=I4(d,ye,x),g.memoizedState=E4,L):(zf(g),T4(g,De))}if(Ke=d.memoizedState,Ke!==null&&(De=Ke.dehydrated,De!==null)){if(X)g.flags&256?(zf(g),g.flags&=-257,g=P4(d,g,x)):g.memoizedState!==null?(Uf(),g.child=d.child,g.flags|=128,g=null):(Uf(),G=L.fallback,De=g.mode,L=WS({mode:"visible",children:L.children},De),G=Vl(G,De,x,null),G.flags|=2,L.return=g,G.return=g,L.sibling=G,g.child=L,$v(g,d.child,null,x),L=g.child,L.memoizedState=C4(x),L.childLanes=I4(d,ye,x),g.memoizedState=E4,g=G);else if(zf(g),hL(De)){if(ye=De.nextSibling&&De.nextSibling.dataset,ye)var Ct=ye.dgst;ye=Ct,L=Error(i(419)),L.stack="",L.digest=ye,zo({value:L,source:null,stack:null}),g=P4(d,g,x)}else if(Os||_(d,g,x,!1),ye=(x&d.childLanes)!==0,Os||ye){if(ye=Pa,ye!==null&&(L=x&-x,L=(L&42)!==0?1:Re(L),L=(L&(ye.suspendedLanes|x))!==0?0:L,L!==0&&L!==Ke.retryLane))throw Ke.retryLane=L,xs(d,L),ic(ye,d,L),k$;De.data==="$?"||X4(),g=P4(d,g,x)}else De.data==="$?"?(g.flags|=192,g.child=d.child,g=null):(d=Ke.treeContext,ia=gh(De.nextSibling),Ao=g,bn=!0,fu=null,bs=!1,d!==null&&(Ks[Dn++]=Bo,Ks[Dn++]=Fc,Ks[Dn++]=dd,Bo=d.id,Fc=d.overflow,dd=g),g=T4(g,L.children),g.flags|=4096);return g}return G?(Uf(),G=L.fallback,De=g.mode,Ke=d.child,Ct=Ke.sibling,L=ha(Ke,{mode:"hidden",children:L.children}),L.subtreeFlags=Ke.subtreeFlags&65011712,Ct!==null?G=ha(Ct,G):(G=Vl(G,De,x,null),G.flags|=2),G.return=g,L.return=g,L.sibling=G,g.child=L,L=G,G=g.child,De=d.child.memoizedState,De===null?De=C4(x):(Ke=De.cachePool,Ke!==null?(Ct=At._currentValue,Ke=Ke.parent!==Ct?{parent:Ct,pool:Ct}:Ke):Ke=Pj(),De={baseLanes:De.baseLanes|x,cachePool:Ke}),G.memoizedState=De,G.childLanes=I4(d,ye,x),g.memoizedState=E4,L):(zf(g),x=d.child,d=x.sibling,x=ha(x,{mode:"visible",children:L.children}),x.return=g,x.sibling=null,d!==null&&(ye=g.deletions,ye===null?(g.deletions=[d],g.flags|=16):ye.push(d)),g.child=x,g.memoizedState=null,x)}function T4(d,g){return g=WS({mode:"visible",children:g},d.mode),g.return=d,d.child=g}function WS(d,g){return d=vl(22,d,null,g),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function P4(d,g,x){return $v(g,d.child,null,x),d=T4(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function H$(d,g,x){d.lanes|=g;var L=d.alternate;L!==null&&(L.lanes|=g),h(d.return,g,x)}function L4(d,g,x,L,G){var X=d.memoizedState;X===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:L,tail:x,tailMode:G}:(X.isBackwards=g,X.rendering=null,X.renderingStartTime=0,X.last=L,X.tail=x,X.tailMode=G)}function q$(d,g,x){var L=g.pendingProps,G=L.revealOrder,X=L.tail;if(Js(d,g,L.children,x),L=ws.current,(L&2)!==0)L=L&1|2,g.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&H$(d,x,g);else if(d.tag===19)H$(d,x,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}L&=1}switch(ce(ws,L),G){case"forwards":for(x=g.child,G=null;x!==null;)d=x.alternate,d!==null&&$S(d)===null&&(G=x),x=x.sibling;x=G,x===null?(G=g.child,g.child=null):(G=x.sibling,x.sibling=null),L4(g,!1,G,x,X);break;case"backwards":for(x=null,G=g.child,g.child=null;G!==null;){if(d=G.alternate,d!==null&&$S(d)===null){g.child=G;break}d=G.sibling,G.sibling=x,x=G,G=d}L4(g,!0,x,null,X);break;case"together":L4(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function yd(d,g,x){if(d!==null&&(g.dependencies=d.dependencies),Hf|=g.lanes,(x&g.childLanes)===0)if(d!==null){if(_(d,g,x,!1),(x&g.childLanes)===0)return null}else return null;if(d!==null&&g.child!==d.child)throw Error(i(153));if(g.child!==null){for(d=g.child,x=ha(d,d.pendingProps),g.child=x,x.return=g;d.sibling!==null;)d=d.sibling,x=x.sibling=ha(d,d.pendingProps),x.return=g;x.sibling=null}return g.child}function D4(d,g){return(d.lanes&g)!==0?!0:(d=d.dependencies,!!(d!==null&&A(d)))}function FDe(d,g,x){switch(g.tag){case 3:Te(g,g.stateNode.containerInfo),dh(g,At,d.memoizedState.cache),Bc();break;case 27:case 5:Pe(g);break;case 4:Te(g,g.stateNode.containerInfo);break;case 10:dh(g,g.type,g.memoizedProps.value);break;case 13:var L=g.memoizedState;if(L!==null)return L.dehydrated!==null?(zf(g),g.flags|=128,null):(x&g.child.childLanes)!==0?G$(d,g,x):(zf(g),d=yd(d,g,x),d!==null?d.sibling:null);zf(g);break;case 19:var G=(d.flags&128)!==0;if(L=(x&g.childLanes)!==0,L||(_(d,g,x,!1),L=(x&g.childLanes)!==0),G){if(L)return q$(d,g,x);g.flags|=128}if(G=g.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),ce(ws,ws.current),L)break;return null;case 22:case 23:return g.lanes=0,z$(d,g,x);case 24:dh(g,At,d.memoizedState.cache)}return yd(d,g,x)}function W$(d,g,x){if(d!==null)if(d.memoizedProps!==g.pendingProps)Os=!0;else{if(!D4(d,x)&&(g.flags&128)===0)return Os=!1,FDe(d,g,x);Os=(d.flags&131072)!==0}else Os=!1,bn&&(g.flags&1048576)!==0&&IS(g,Of,g.index);switch(g.lanes=0,g.tag){case 16:e:{d=g.pendingProps;var L=g.elementType,G=L._init;if(L=G(L._payload),g.type=L,typeof L=="function")kv(L)?(d=Ig(L,d),g.tag=1,g=j$(null,g,L,d,x)):(g.tag=0,g=M4(null,g,L,d,x));else{if(L!=null){if(G=L.$$typeof,G===T){g.tag=11,g=N$(null,g,L,d,x);break e}else if(G===k){g.tag=14,g=F$(null,g,L,d,x);break e}}throw g=V(L)||L,Error(i(306,g,""))}}return g;case 0:return M4(d,g,g.type,g.pendingProps,x);case 1:return L=g.type,G=Ig(L,g.pendingProps),j$(d,g,L,G,x);case 3:e:{if(Te(g,g.stateNode.containerInfo),d===null)throw Error(i(387));L=g.pendingProps;var X=g.memoizedState;G=X.element,t4(d,g),Zx(g,L,null,x);var ye=g.memoizedState;if(L=ye.cache,dh(g,At,L),L!==X.cache&&f(g,[At],x,!0),Xx(),L=ye.element,X.isDehydrated)if(X={element:L,isDehydrated:!1,cache:ye.cache},g.updateQueue.baseState=X,g.memoizedState=X,g.flags&256){g=$$(d,g,L,x);break e}else if(L!==G){G=Ln(Error(i(424)),g),zo(G),g=$$(d,g,L,x);break e}else{switch(d=g.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(ia=gh(d.firstChild),Ao=g,bn=!0,fu=null,bs=!0,x=M$(g,null,L,x),g.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling}else{if(Bc(),L===G){g=yd(d,g,x);break e}Js(d,g,L,x)}g=g.child}return g;case 26:return qS(d,g),d===null?(x=KG(g.type,null,g.pendingProps,null))?g.memoizedState=x:bn||(x=g.type,d=g.pendingProps,L=sM(pe.current).createElement(x),L[Gt]=g,L[ke]=d,el(L,x,d),Hr(L),g.stateNode=L):g.memoizedState=KG(g.type,d.memoizedProps,g.pendingProps,d.memoizedState),null;case 27:return Pe(g),d===null&&bn&&(L=g.stateNode=XG(g.type,g.pendingProps,pe.current),Ao=g,bs=!0,G=ia,Zf(g.type)?(pL=G,ia=gh(L.firstChild)):ia=G),Js(d,g,g.pendingProps.children,x),qS(d,g),d===null&&(g.flags|=4194304),g.child;case 5:return d===null&&bn&&((G=L=ia)&&(L=hRe(L,g.type,g.pendingProps,bs),L!==null?(g.stateNode=L,Ao=g,ia=gh(L.firstChild),bs=!1,G=!0):G=!1),G||mu(g)),Pe(g),G=g.type,X=g.pendingProps,ye=d!==null?d.memoizedProps:null,L=X.children,lL(G,X)?L=null:ye!==null&&lL(G,ye)&&(g.flags|=32),g.memoizedState!==null&&(G=s4(d,g,TDe,null,null,x),yb._currentValue=G),qS(d,g),Js(d,g,L,x),g.child;case 6:return d===null&&bn&&((d=x=ia)&&(x=pRe(x,g.pendingProps,bs),x!==null?(g.stateNode=x,Ao=g,ia=null,d=!0):d=!1),d||mu(g)),null;case 13:return G$(d,g,x);case 4:return Te(g,g.stateNode.containerInfo),L=g.pendingProps,d===null?g.child=$v(g,null,L,x):Js(d,g,L,x),g.child;case 11:return N$(d,g,g.type,g.pendingProps,x);case 7:return Js(d,g,g.pendingProps,x),g.child;case 8:return Js(d,g,g.pendingProps.children,x),g.child;case 12:return Js(d,g,g.pendingProps.children,x),g.child;case 10:return L=g.pendingProps,dh(g,g.type,L.value),Js(d,g,L.children,x),g.child;case 9:return G=g.type._context,L=g.pendingProps.children,D(g),G=H(G),L=L(G),g.flags|=1,Js(d,g,L,x),g.child;case 14:return F$(d,g,g.type,g.pendingProps,x);case 15:return B$(d,g,g.type,g.pendingProps,x);case 19:return q$(d,g,x);case 31:return L=g.pendingProps,x=g.mode,L={mode:L.mode,children:L.children},d===null?(x=WS(L,x),x.ref=g.ref,g.child=x,x.return=g,g=x):(x=ha(d.child,L),x.ref=g.ref,g.child=x,x.return=g,g=x),g;case 22:return z$(d,g,x);case 24:return D(g),L=H(At),d===null?(G=J5(),G===null&&(G=Pa,X=hr(),G.pooledCache=X,X.refCount++,X!==null&&(G.pooledCacheLanes|=x),G=X),g.memoizedState={parent:L,cache:G},e4(g),dh(g,At,G)):((d.lanes&x)!==0&&(t4(d,g),Zx(g,null,null,x),Xx()),G=d.memoizedState,X=g.memoizedState,G.parent!==L?(G={parent:L,cache:L},g.memoizedState=G,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=G),dh(g,At,L)):(L=X.cache,dh(g,At,L),L!==G.cache&&f(g,[At],x,!0))),Js(d,g,g.pendingProps.children,x),g.child;case 29:throw g.pendingProps}throw Error(i(156,g.tag))}function vd(d){d.flags|=4}function X$(d,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!rH(g)){if(g=zc.current,g!==null&&((In&4194048)===In?cp!==null:(In&62914560)!==In&&(In&536870912)===0||g!==cp))throw qx=Q5,Lj;d.flags|=8192}}function XS(d,g){g!==null&&(d.flags|=4),d.flags&16384&&(g=d.tag!==22?er():536870912,d.lanes|=g,Wv|=g)}function rb(d,g){if(!bn)switch(d.tailMode){case"hidden":g=d.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?d.tail=null:x.sibling=null;break;case"collapsed":x=d.tail;for(var L=null;x!==null;)x.alternate!==null&&(L=x),x=x.sibling;L===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:L.sibling=null}}function co(d){var g=d.alternate!==null&&d.alternate.child===d.child,x=0,L=0;if(g)for(var G=d.child;G!==null;)x|=G.lanes|G.childLanes,L|=G.subtreeFlags&65011712,L|=G.flags&65011712,G.return=d,G=G.sibling;else for(G=d.child;G!==null;)x|=G.lanes|G.childLanes,L|=G.subtreeFlags,L|=G.flags,G.return=d,G=G.sibling;return d.subtreeFlags|=L,d.childLanes=x,g}function BDe(d,g,x){var L=g.pendingProps;switch(jl(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return co(g),null;case 1:return co(g),null;case 3:return x=g.stateNode,L=null,d!==null&&(L=d.memoizedState.cache),g.memoizedState.cache!==L&&(g.flags|=2048),Gl(At),fe(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(d===null||d.child===null)&&($l(g)?vd(g):d===null||d.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,ph())),co(g),null;case 26:return x=g.memoizedState,d===null?(vd(g),x!==null?(co(g),X$(g,x)):(co(g),g.flags&=-16777217)):x?x!==d.memoizedState?(vd(g),co(g),X$(g,x)):(co(g),g.flags&=-16777217):(d.memoizedProps!==L&&vd(g),co(g),g.flags&=-16777217),null;case 27:me(g),x=pe.current;var G=g.type;if(d!==null&&g.stateNode!=null)d.memoizedProps!==L&&vd(g);else{if(!L){if(g.stateNode===null)throw Error(i(166));return co(g),null}d=te.current,$l(g)?hh(g):(d=XG(G,L,x),g.stateNode=d,vd(g))}return co(g),null;case 5:if(me(g),x=g.type,d!==null&&g.stateNode!=null)d.memoizedProps!==L&&vd(g);else{if(!L){if(g.stateNode===null)throw Error(i(166));return co(g),null}if(d=te.current,$l(g))hh(g);else{switch(G=sM(pe.current),d){case 1:d=G.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:d=G.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":d=G.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":d=G.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":d=G.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof L.is=="string"?G.createElement("select",{is:L.is}):G.createElement("select"),L.multiple?d.multiple=!0:L.size&&(d.size=L.size);break;default:d=typeof L.is=="string"?G.createElement(x,{is:L.is}):G.createElement(x)}}d[Gt]=g,d[ke]=L;e:for(G=g.child;G!==null;){if(G.tag===5||G.tag===6)d.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===g)break e;for(;G.sibling===null;){if(G.return===null||G.return===g)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}g.stateNode=d;e:switch(el(d,x,L),x){case"button":case"input":case"select":case"textarea":d=!!L.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&vd(g)}}return co(g),g.flags&=-16777217,null;case 6:if(d&&g.stateNode!=null)d.memoizedProps!==L&&vd(g);else{if(typeof L!="string"&&g.stateNode===null)throw Error(i(166));if(d=pe.current,$l(g)){if(d=g.stateNode,x=g.memoizedProps,L=null,G=Ao,G!==null)switch(G.tag){case 27:case 5:L=G.memoizedProps}d[Gt]=g,d=!!(d.nodeValue===x||L!==null&&L.suppressHydrationWarning===!0||VG(d.nodeValue,x)),d||mu(g)}else d=sM(d).createTextNode(L),d[Gt]=g,g.stateNode=d}return co(g),null;case 13:if(L=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(G=$l(g),L!==null&&L.dehydrated!==null){if(d===null){if(!G)throw Error(i(318));if(G=g.memoizedState,G=G!==null?G.dehydrated:null,!G)throw Error(i(317));G[Gt]=g}else Bc(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;co(g),G=!1}else G=ph(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=G),G=!0;if(!G)return g.flags&256?(gd(g),g):(gd(g),null)}if(gd(g),(g.flags&128)!==0)return g.lanes=x,g;if(x=L!==null,d=d!==null&&d.memoizedState!==null,x){L=g.child,G=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(G=L.alternate.memoizedState.cachePool.pool);var X=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(X=L.memoizedState.cachePool.pool),X!==G&&(L.flags|=2048)}return x!==d&&x&&(g.child.flags|=8192),XS(g,g.updateQueue),co(g),null;case 4:return fe(),d===null&&iL(g.stateNode.containerInfo),co(g),null;case 10:return Gl(g.type),co(g),null;case 19:if(K(ws),G=g.memoizedState,G===null)return co(g),null;if(L=(g.flags&128)!==0,X=G.rendering,X===null)if(L)rb(G,!1);else{if(So!==0||d!==null&&(d.flags&128)!==0)for(d=g.child;d!==null;){if(X=$S(d),X!==null){for(g.flags|=128,rb(G,!1),d=X.updateQueue,g.updateQueue=d,XS(g,d),g.subtreeFlags=0,d=x,x=g.child;x!==null;)kc(x,d),x=x.sibling;return ce(ws,ws.current&1|2),g.child}d=d.sibling}G.tail!==null&&We()>KS&&(g.flags|=128,L=!0,rb(G,!1),g.lanes=4194304)}else{if(!L)if(d=$S(X),d!==null){if(g.flags|=128,L=!0,d=d.updateQueue,g.updateQueue=d,XS(g,d),rb(G,!0),G.tail===null&&G.tailMode==="hidden"&&!X.alternate&&!bn)return co(g),null}else 2*We()-G.renderingStartTime>KS&&x!==536870912&&(g.flags|=128,L=!0,rb(G,!1),g.lanes=4194304);G.isBackwards?(X.sibling=g.child,g.child=X):(d=G.last,d!==null?d.sibling=X:g.child=X,G.last=X)}return G.tail!==null?(g=G.tail,G.rendering=g,G.tail=g.sibling,G.renderingStartTime=We(),g.sibling=null,d=ws.current,ce(ws,L?d&1|2:d&1),g):(co(g),null);case 22:case 23:return gd(g),a4(),L=g.memoizedState!==null,d!==null?d.memoizedState!==null!==L&&(g.flags|=8192):L&&(g.flags|=8192),L?(x&536870912)!==0&&(g.flags&128)===0&&(co(g),g.subtreeFlags&6&&(g.flags|=8192)):co(g),x=g.updateQueue,x!==null&&XS(g,x.retryQueue),x=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),L=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(L=g.memoizedState.cachePool.pool),L!==x&&(g.flags|=2048),d!==null&&K(Eg),null;case 24:return x=null,d!==null&&(x=d.memoizedState.cache),g.memoizedState.cache!==x&&(g.flags|=2048),Gl(At),co(g),null;case 25:return null;case 30:return null}throw Error(i(156,g.tag))}function zDe(d,g){switch(jl(g),g.tag){case 1:return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return Gl(At),fe(),d=g.flags,(d&65536)!==0&&(d&128)===0?(g.flags=d&-65537|128,g):null;case 26:case 27:case 5:return me(g),null;case 13:if(gd(g),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(i(340));Bc()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return K(ws),null;case 4:return fe(),null;case 10:return Gl(g.type),null;case 22:case 23:return gd(g),a4(),d!==null&&K(Eg),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 24:return Gl(At),null;case 25:return null;default:return null}}function Z$(d,g){switch(jl(g),g.tag){case 3:Gl(At),fe();break;case 26:case 27:case 5:me(g);break;case 4:fe();break;case 13:gd(g);break;case 19:K(ws);break;case 10:Gl(g.type);break;case 22:case 23:gd(g),a4(),d!==null&&K(Eg);break;case 24:Gl(At)}}function ib(d,g){try{var x=g.updateQueue,L=x!==null?x.lastEffect:null;if(L!==null){var G=L.next;x=G;do{if((x.tag&d)===d){L=void 0;var X=x.create,ye=x.inst;L=X(),ye.destroy=L}x=x.next}while(x!==G)}}catch(De){Ma(g,g.return,De)}}function Vf(d,g,x){try{var L=g.updateQueue,G=L!==null?L.lastEffect:null;if(G!==null){var X=G.next;L=X;do{if((L.tag&d)===d){var ye=L.inst,De=ye.destroy;if(De!==void 0){ye.destroy=void 0,G=g;var Ke=x,Ct=De;try{Ct()}catch(Xt){Ma(G,Ke,Xt)}}}L=L.next}while(L!==X)}}catch(Xt){Ma(g,g.return,Xt)}}function Y$(d){var g=d.updateQueue;if(g!==null){var x=d.stateNode;try{Fj(g,x)}catch(L){Ma(d,d.return,L)}}}function K$(d,g,x){x.props=Ig(d.type,d.memoizedProps),x.state=d.memoizedState;try{x.componentWillUnmount()}catch(L){Ma(d,g,L)}}function nb(d,g){try{var x=d.ref;if(x!==null){switch(d.tag){case 26:case 27:case 5:var L=d.stateNode;break;case 30:L=d.stateNode;break;default:L=d.stateNode}typeof x=="function"?d.refCleanup=x(L):x.current=L}}catch(G){Ma(d,g,G)}}function hp(d,g){var x=d.ref,L=d.refCleanup;if(x!==null)if(typeof L=="function")try{L()}catch(G){Ma(d,g,G)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(G){Ma(d,g,G)}else x.current=null}function J$(d){var g=d.type,x=d.memoizedProps,L=d.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":x.autoFocus&&L.focus();break e;case"img":x.src?L.src=x.src:x.srcSet&&(L.srcset=x.srcSet)}}catch(G){Ma(d,d.return,G)}}function R4(d,g,x){try{var L=d.stateNode;oRe(L,d.type,x,g),L[ke]=g}catch(G){Ma(d,d.return,G)}}function Q$(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Zf(d.type)||d.tag===4}function O4(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Q$(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Zf(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function k4(d,g,x){var L=d.tag;if(L===5||L===6)d=d.stateNode,g?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(d,g):(g=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,g.appendChild(d),x=x._reactRootContainer,x!=null||g.onclick!==null||(g.onclick=oM));else if(L!==4&&(L===27&&Zf(d.type)&&(x=d.stateNode,g=null),d=d.child,d!==null))for(k4(d,g,x),d=d.sibling;d!==null;)k4(d,g,x),d=d.sibling}function ZS(d,g,x){var L=d.tag;if(L===5||L===6)d=d.stateNode,g?x.insertBefore(d,g):x.appendChild(d);else if(L!==4&&(L===27&&Zf(d.type)&&(x=d.stateNode),d=d.child,d!==null))for(ZS(d,g,x),d=d.sibling;d!==null;)ZS(d,g,x),d=d.sibling}function eG(d){var g=d.stateNode,x=d.memoizedProps;try{for(var L=d.type,G=g.attributes;G.length;)g.removeAttributeNode(G[0]);el(g,L,x),g[Gt]=d,g[ke]=x}catch(X){Ma(d,d.return,X)}}var _d=!1,Vo=!1,N4=!1,tG=typeof WeakSet=="function"?WeakSet:Set,ks=null;function UDe(d,g){if(d=d.containerInfo,oL=dM,d=so(d),ap(d)){if("selectionStart"in d)var x={start:d.selectionStart,end:d.selectionEnd};else e:{x=(x=d.ownerDocument)&&x.defaultView||window;var L=x.getSelection&&x.getSelection();if(L&&L.rangeCount!==0){x=L.anchorNode;var G=L.anchorOffset,X=L.focusNode;L=L.focusOffset;try{x.nodeType,X.nodeType}catch{x=null;break e}var ye=0,De=-1,Ke=-1,Ct=0,Xt=0,tr=d,Dt=null;t:for(;;){for(var Ot;tr!==x||G!==0&&tr.nodeType!==3||(De=ye+G),tr!==X||L!==0&&tr.nodeType!==3||(Ke=ye+L),tr.nodeType===3&&(ye+=tr.nodeValue.length),(Ot=tr.firstChild)!==null;)Dt=tr,tr=Ot;for(;;){if(tr===d)break t;if(Dt===x&&++Ct===G&&(De=ye),Dt===X&&++Xt===L&&(Ke=ye),(Ot=tr.nextSibling)!==null)break;tr=Dt,Dt=tr.parentNode}tr=Ot}x=De===-1||Ke===-1?null:{start:De,end:Ke}}else x=null}x=x||{start:0,end:0}}else x=null;for(sL={focusedElem:d,selectionRange:x},dM=!1,ks=g;ks!==null;)if(g=ks,d=g.child,(g.subtreeFlags&1024)!==0&&d!==null)d.return=g,ks=d;else for(;ks!==null;){switch(g=ks,X=g.alternate,d=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&X!==null){d=void 0,x=g,G=X.memoizedProps,X=X.memoizedState,L=x.stateNode;try{var Ci=Ig(x.type,G,x.elementType===x.type);d=L.getSnapshotBeforeUpdate(Ci,X),L.__reactInternalSnapshotBeforeUpdate=d}catch(xi){Ma(x,x.return,xi)}}break;case 3:if((d&1024)!==0){if(d=g.stateNode.containerInfo,x=d.nodeType,x===9)cL(d);else if(x===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":cL(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(i(163))}if(d=g.sibling,d!==null){d.return=g.return,ks=d;break}ks=g.return}}function rG(d,g,x){var L=x.flags;switch(x.tag){case 0:case 11:case 15:jf(d,x),L&4&&ib(5,x);break;case 1:if(jf(d,x),L&4)if(d=x.stateNode,g===null)try{d.componentDidMount()}catch(ye){Ma(x,x.return,ye)}else{var G=Ig(x.type,g.memoizedProps);g=g.memoizedState;try{d.componentDidUpdate(G,g,d.__reactInternalSnapshotBeforeUpdate)}catch(ye){Ma(x,x.return,ye)}}L&64&&Y$(x),L&512&&nb(x,x.return);break;case 3:if(jf(d,x),L&64&&(d=x.updateQueue,d!==null)){if(g=null,x.child!==null)switch(x.child.tag){case 27:case 5:g=x.child.stateNode;break;case 1:g=x.child.stateNode}try{Fj(d,g)}catch(ye){Ma(x,x.return,ye)}}break;case 27:g===null&&L&4&&eG(x);case 26:case 5:jf(d,x),g===null&&L&4&&J$(x),L&512&&nb(x,x.return);break;case 12:jf(d,x);break;case 13:jf(d,x),L&4&&aG(d,x),L&64&&(d=x.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(x=ZDe.bind(null,x),dRe(d,x))));break;case 22:if(L=x.memoizedState!==null||_d,!L){g=g!==null&&g.memoizedState!==null||Vo,G=_d;var X=Vo;_d=L,(Vo=g)&&!X?$f(d,x,(x.subtreeFlags&8772)!==0):jf(d,x),_d=G,Vo=X}break;case 30:break;default:jf(d,x)}}function iG(d){var g=d.alternate;g!==null&&(d.alternate=null,iG(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&Kr(g)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Za=null,vu=!1;function xd(d,g,x){for(x=x.child;x!==null;)nG(d,g,x),x=x.sibling}function nG(d,g,x){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(Et,x)}catch{}switch(x.tag){case 26:Vo||hp(x,g),xd(d,g,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:Vo||hp(x,g);var L=Za,G=vu;Zf(x.type)&&(Za=x.stateNode,vu=!1),xd(d,g,x),db(x.stateNode),Za=L,vu=G;break;case 5:Vo||hp(x,g);case 6:if(L=Za,G=vu,Za=null,xd(d,g,x),Za=L,vu=G,Za!==null)if(vu)try{(Za.nodeType===9?Za.body:Za.nodeName==="HTML"?Za.ownerDocument.body:Za).removeChild(x.stateNode)}catch(X){Ma(x,g,X)}else try{Za.removeChild(x.stateNode)}catch(X){Ma(x,g,X)}break;case 18:Za!==null&&(vu?(d=Za,qG(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,x.stateNode),bb(d)):qG(Za,x.stateNode));break;case 4:L=Za,G=vu,Za=x.stateNode.containerInfo,vu=!0,xd(d,g,x),Za=L,vu=G;break;case 0:case 11:case 14:case 15:Vo||Vf(2,x,g),Vo||Vf(4,x,g),xd(d,g,x);break;case 1:Vo||(hp(x,g),L=x.stateNode,typeof L.componentWillUnmount=="function"&&K$(x,g,L)),xd(d,g,x);break;case 21:xd(d,g,x);break;case 22:Vo=(L=Vo)||x.memoizedState!==null,xd(d,g,x),Vo=L;break;default:xd(d,g,x)}}function aG(d,g){if(g.memoizedState===null&&(d=g.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{bb(d)}catch(x){Ma(g,g.return,x)}}function VDe(d){switch(d.tag){case 13:case 19:var g=d.stateNode;return g===null&&(g=d.stateNode=new tG),g;case 22:return d=d.stateNode,g=d._retryCache,g===null&&(g=d._retryCache=new tG),g;default:throw Error(i(435,d.tag))}}function F4(d,g){var x=VDe(d);g.forEach(function(L){var G=YDe.bind(null,d,L);x.has(L)||(x.add(L),L.then(G,G))})}function Qu(d,g){var x=g.deletions;if(x!==null)for(var L=0;L<x.length;L++){var G=x[L],X=d,ye=g,De=ye;e:for(;De!==null;){switch(De.tag){case 27:if(Zf(De.type)){Za=De.stateNode,vu=!1;break e}break;case 5:Za=De.stateNode,vu=!1;break e;case 3:case 4:Za=De.stateNode.containerInfo,vu=!0;break e}De=De.return}if(Za===null)throw Error(i(160));nG(X,ye,G),Za=null,vu=!1,X=G.alternate,X!==null&&(X.return=null),G.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)oG(g,d),g=g.sibling}var mh=null;function oG(d,g){var x=d.alternate,L=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Qu(g,d),ec(d),L&4&&(Vf(3,d,d.return),ib(3,d),Vf(5,d,d.return));break;case 1:Qu(g,d),ec(d),L&512&&(Vo||x===null||hp(x,x.return)),L&64&&_d&&(d=d.updateQueue,d!==null&&(L=d.callbacks,L!==null&&(x=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=x===null?L:x.concat(L))));break;case 26:var G=mh;if(Qu(g,d),ec(d),L&512&&(Vo||x===null||hp(x,x.return)),L&4){var X=x!==null?x.memoizedState:null;if(L=d.memoizedState,x===null)if(L===null)if(d.stateNode===null){e:{L=d.type,x=d.memoizedProps,G=G.ownerDocument||G;t:switch(L){case"title":X=G.getElementsByTagName("title")[0],(!X||X[nr]||X[Gt]||X.namespaceURI==="http://www.w3.org/2000/svg"||X.hasAttribute("itemprop"))&&(X=G.createElement(L),G.head.insertBefore(X,G.querySelector("head > title"))),el(X,L,x),X[Gt]=d,Hr(X),L=X;break e;case"link":var ye=eH("link","href",G).get(L+(x.href||""));if(ye){for(var De=0;De<ye.length;De++)if(X=ye[De],X.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&X.getAttribute("rel")===(x.rel==null?null:x.rel)&&X.getAttribute("title")===(x.title==null?null:x.title)&&X.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){ye.splice(De,1);break t}}X=G.createElement(L),el(X,L,x),G.head.appendChild(X);break;case"meta":if(ye=eH("meta","content",G).get(L+(x.content||""))){for(De=0;De<ye.length;De++)if(X=ye[De],X.getAttribute("content")===(x.content==null?null:""+x.content)&&X.getAttribute("name")===(x.name==null?null:x.name)&&X.getAttribute("property")===(x.property==null?null:x.property)&&X.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&X.getAttribute("charset")===(x.charSet==null?null:x.charSet)){ye.splice(De,1);break t}}X=G.createElement(L),el(X,L,x),G.head.appendChild(X);break;default:throw Error(i(468,L))}X[Gt]=d,Hr(X),L=X}d.stateNode=L}else tH(G,d.type,d.stateNode);else d.stateNode=QG(G,L,d.memoizedProps);else X!==L?(X===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):X.count--,L===null?tH(G,d.type,d.stateNode):QG(G,L,d.memoizedProps)):L===null&&d.stateNode!==null&&R4(d,d.memoizedProps,x.memoizedProps)}break;case 27:Qu(g,d),ec(d),L&512&&(Vo||x===null||hp(x,x.return)),x!==null&&L&4&&R4(d,d.memoizedProps,x.memoizedProps);break;case 5:if(Qu(g,d),ec(d),L&512&&(Vo||x===null||hp(x,x.return)),d.flags&32){G=d.stateNode;try{we(G,"")}catch(Ot){Ma(d,d.return,Ot)}}L&4&&d.stateNode!=null&&(G=d.memoizedProps,R4(d,G,x!==null?x.memoizedProps:G)),L&1024&&(N4=!0);break;case 6:if(Qu(g,d),ec(d),L&4){if(d.stateNode===null)throw Error(i(162));L=d.memoizedProps,x=d.stateNode;try{x.nodeValue=L}catch(Ot){Ma(d,d.return,Ot)}}break;case 3:if(cM=null,G=mh,mh=lM(g.containerInfo),Qu(g,d),mh=G,ec(d),L&4&&x!==null&&x.memoizedState.isDehydrated)try{bb(g.containerInfo)}catch(Ot){Ma(d,d.return,Ot)}N4&&(N4=!1,sG(d));break;case 4:L=mh,mh=lM(d.stateNode.containerInfo),Qu(g,d),ec(d),mh=L;break;case 12:Qu(g,d),ec(d);break;case 13:Qu(g,d),ec(d),d.child.flags&8192&&d.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&($4=We()),L&4&&(L=d.updateQueue,L!==null&&(d.updateQueue=null,F4(d,L)));break;case 22:G=d.memoizedState!==null;var Ke=x!==null&&x.memoizedState!==null,Ct=_d,Xt=Vo;if(_d=Ct||G,Vo=Xt||Ke,Qu(g,d),Vo=Xt,_d=Ct,ec(d),L&8192)e:for(g=d.stateNode,g._visibility=G?g._visibility&-2:g._visibility|1,G&&(x===null||Ke||_d||Vo||Tg(d)),x=null,g=d;;){if(g.tag===5||g.tag===26){if(x===null){Ke=x=g;try{if(X=Ke.stateNode,G)ye=X.style,typeof ye.setProperty=="function"?ye.setProperty("display","none","important"):ye.display="none";else{De=Ke.stateNode;var tr=Ke.memoizedProps.style,Dt=tr!=null&&tr.hasOwnProperty("display")?tr.display:null;De.style.display=Dt==null||typeof Dt=="boolean"?"":(""+Dt).trim()}}catch(Ot){Ma(Ke,Ke.return,Ot)}}}else if(g.tag===6){if(x===null){Ke=g;try{Ke.stateNode.nodeValue=G?"":Ke.memoizedProps}catch(Ot){Ma(Ke,Ke.return,Ot)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===d)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break e;for(;g.sibling===null;){if(g.return===null||g.return===d)break e;x===g&&(x=null),g=g.return}x===g&&(x=null),g.sibling.return=g.return,g=g.sibling}L&4&&(L=d.updateQueue,L!==null&&(x=L.retryQueue,x!==null&&(L.retryQueue=null,F4(d,x))));break;case 19:Qu(g,d),ec(d),L&4&&(L=d.updateQueue,L!==null&&(d.updateQueue=null,F4(d,L)));break;case 30:break;case 21:break;default:Qu(g,d),ec(d)}}function ec(d){var g=d.flags;if(g&2){try{for(var x,L=d.return;L!==null;){if(Q$(L)){x=L;break}L=L.return}if(x==null)throw Error(i(160));switch(x.tag){case 27:var G=x.stateNode,X=O4(d);ZS(d,X,G);break;case 5:var ye=x.stateNode;x.flags&32&&(we(ye,""),x.flags&=-33);var De=O4(d);ZS(d,De,ye);break;case 3:case 4:var Ke=x.stateNode.containerInfo,Ct=O4(d);k4(d,Ct,Ke);break;default:throw Error(i(161))}}catch(Xt){Ma(d,d.return,Xt)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function sG(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var g=d;sG(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),d=d.sibling}}function jf(d,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)rG(d,g.alternate,g),g=g.sibling}function Tg(d){for(d=d.child;d!==null;){var g=d;switch(g.tag){case 0:case 11:case 14:case 15:Vf(4,g,g.return),Tg(g);break;case 1:hp(g,g.return);var x=g.stateNode;typeof x.componentWillUnmount=="function"&&K$(g,g.return,x),Tg(g);break;case 27:db(g.stateNode);case 26:case 5:hp(g,g.return),Tg(g);break;case 22:g.memoizedState===null&&Tg(g);break;case 30:Tg(g);break;default:Tg(g)}d=d.sibling}}function $f(d,g,x){for(x=x&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var L=g.alternate,G=d,X=g,ye=X.flags;switch(X.tag){case 0:case 11:case 15:$f(G,X,x),ib(4,X);break;case 1:if($f(G,X,x),L=X,G=L.stateNode,typeof G.componentDidMount=="function")try{G.componentDidMount()}catch(Ct){Ma(L,L.return,Ct)}if(L=X,G=L.updateQueue,G!==null){var De=L.stateNode;try{var Ke=G.shared.hiddenCallbacks;if(Ke!==null)for(G.shared.hiddenCallbacks=null,G=0;G<Ke.length;G++)Nj(Ke[G],De)}catch(Ct){Ma(L,L.return,Ct)}}x&&ye&64&&Y$(X),nb(X,X.return);break;case 27:eG(X);case 26:case 5:$f(G,X,x),x&&L===null&&ye&4&&J$(X),nb(X,X.return);break;case 12:$f(G,X,x);break;case 13:$f(G,X,x),x&&ye&4&&aG(G,X);break;case 22:X.memoizedState===null&&$f(G,X,x),nb(X,X.return);break;case 30:break;default:$f(G,X,x)}g=g.sibling}}function B4(d,g){var x=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),d=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(d=g.memoizedState.cachePool.pool),d!==x&&(d!=null&&d.refCount++,x!=null&&gr(x))}function z4(d,g){d=null,g.alternate!==null&&(d=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==d&&(g.refCount++,d!=null&&gr(d))}function pp(d,g,x,L){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)lG(d,g,x,L),g=g.sibling}function lG(d,g,x,L){var G=g.flags;switch(g.tag){case 0:case 11:case 15:pp(d,g,x,L),G&2048&&ib(9,g);break;case 1:pp(d,g,x,L);break;case 3:pp(d,g,x,L),G&2048&&(d=null,g.alternate!==null&&(d=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==d&&(g.refCount++,d!=null&&gr(d)));break;case 12:if(G&2048){pp(d,g,x,L),d=g.stateNode;try{var X=g.memoizedProps,ye=X.id,De=X.onPostCommit;typeof De=="function"&&De(ye,g.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Ke){Ma(g,g.return,Ke)}}else pp(d,g,x,L);break;case 13:pp(d,g,x,L);break;case 23:break;case 22:X=g.stateNode,ye=g.alternate,g.memoizedState!==null?X._visibility&2?pp(d,g,x,L):ab(d,g):X._visibility&2?pp(d,g,x,L):(X._visibility|=2,Gv(d,g,x,L,(g.subtreeFlags&10256)!==0)),G&2048&&B4(ye,g);break;case 24:pp(d,g,x,L),G&2048&&z4(g.alternate,g);break;default:pp(d,g,x,L)}}function Gv(d,g,x,L,G){for(G=G&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var X=d,ye=g,De=x,Ke=L,Ct=ye.flags;switch(ye.tag){case 0:case 11:case 15:Gv(X,ye,De,Ke,G),ib(8,ye);break;case 23:break;case 22:var Xt=ye.stateNode;ye.memoizedState!==null?Xt._visibility&2?Gv(X,ye,De,Ke,G):ab(X,ye):(Xt._visibility|=2,Gv(X,ye,De,Ke,G)),G&&Ct&2048&&B4(ye.alternate,ye);break;case 24:Gv(X,ye,De,Ke,G),G&&Ct&2048&&z4(ye.alternate,ye);break;default:Gv(X,ye,De,Ke,G)}g=g.sibling}}function ab(d,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var x=d,L=g,G=L.flags;switch(L.tag){case 22:ab(x,L),G&2048&&B4(L.alternate,L);break;case 24:ab(x,L),G&2048&&z4(L.alternate,L);break;default:ab(x,L)}g=g.sibling}}var ob=8192;function Hv(d){if(d.subtreeFlags&ob)for(d=d.child;d!==null;)uG(d),d=d.sibling}function uG(d){switch(d.tag){case 26:Hv(d),d.flags&ob&&d.memoizedState!==null&&ERe(mh,d.memoizedState,d.memoizedProps);break;case 5:Hv(d);break;case 3:case 4:var g=mh;mh=lM(d.stateNode.containerInfo),Hv(d),mh=g;break;case 22:d.memoizedState===null&&(g=d.alternate,g!==null&&g.memoizedState!==null?(g=ob,ob=16777216,Hv(d),ob=g):Hv(d));break;default:Hv(d)}}function cG(d){var g=d.alternate;if(g!==null&&(d=g.child,d!==null)){g.child=null;do g=d.sibling,d.sibling=null,d=g;while(d!==null)}}function sb(d){var g=d.deletions;if((d.flags&16)!==0){if(g!==null)for(var x=0;x<g.length;x++){var L=g[x];ks=L,pG(L,d)}cG(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)hG(d),d=d.sibling}function hG(d){switch(d.tag){case 0:case 11:case 15:sb(d),d.flags&2048&&Vf(9,d,d.return);break;case 3:sb(d);break;case 12:sb(d);break;case 22:var g=d.stateNode;d.memoizedState!==null&&g._visibility&2&&(d.return===null||d.return.tag!==13)?(g._visibility&=-3,YS(d)):sb(d);break;default:sb(d)}}function YS(d){var g=d.deletions;if((d.flags&16)!==0){if(g!==null)for(var x=0;x<g.length;x++){var L=g[x];ks=L,pG(L,d)}cG(d)}for(d=d.child;d!==null;){switch(g=d,g.tag){case 0:case 11:case 15:Vf(8,g,g.return),YS(g);break;case 22:x=g.stateNode,x._visibility&2&&(x._visibility&=-3,YS(g));break;default:YS(g)}d=d.sibling}}function pG(d,g){for(;ks!==null;){var x=ks;switch(x.tag){case 0:case 11:case 15:Vf(8,x,g);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var L=x.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:gr(x.memoizedState.cache)}if(L=x.child,L!==null)L.return=x,ks=L;else e:for(x=d;ks!==null;){L=ks;var G=L.sibling,X=L.return;if(iG(L),L===x){ks=null;break e}if(G!==null){G.return=X,ks=G;break e}ks=X}}}var jDe={getCacheForType:function(d){var g=H(At),x=g.data.get(d);return x===void 0&&(x=d(),g.data.set(d,x)),x}},$De=typeof WeakMap=="function"?WeakMap:Map,na=0,Pa=null,fn=null,In=0,aa=0,tc=null,Gf=!1,qv=!1,U4=!1,bd=0,So=0,Hf=0,Pg=0,V4=0,Uc=0,Wv=0,lb=null,_u=null,j4=!1,$4=0,KS=1/0,JS=null,qf=null,Qs=0,Wf=null,Xv=null,Zv=0,G4=0,H4=null,dG=null,ub=0,q4=null;function rc(){if((na&2)!==0&&In!==0)return In&-In;if(Y.T!==null){var d=ji;return d!==0?d:Q4()}return st()}function fG(){Uc===0&&(Uc=(In&536870912)===0||bn?Qe():536870912);var d=zc.current;return d!==null&&(d.flags|=32),Uc}function ic(d,g,x){(d===Pa&&(aa===2||aa===9)||d.cancelPendingCommit!==null)&&(Yv(d,0),Xf(d,In,Uc,!1)),se(d,x),((na&2)===0||d!==Pa)&&(d===Pa&&((na&2)===0&&(Pg|=x),So===4&&Xf(d,In,Uc,!1)),dp(d))}function mG(d,g,x){if((na&6)!==0)throw Error(i(327));var L=!x&&(g&124)===0&&(g&d.expiredLanes)===0||ar(d,g),G=L?qDe(d,g):Z4(d,g,!0),X=L;do{if(G===0){qv&&!L&&Xf(d,g,0,!1);break}else{if(x=d.current.alternate,X&&!GDe(x)){G=Z4(d,g,!1),X=!1;continue}if(G===2){if(X=g,d.errorRecoveryDisabledLanes&X)var ye=0;else ye=d.pendingLanes&-536870913,ye=ye!==0?ye:ye&536870912?536870912:0;if(ye!==0){g=ye;e:{var De=d;G=lb;var Ke=De.current.memoizedState.isDehydrated;if(Ke&&(Yv(De,ye).flags|=256),ye=Z4(De,ye,!1),ye!==2){if(U4&&!Ke){De.errorRecoveryDisabledLanes|=X,Pg|=X,G=4;break e}X=_u,_u=G,X!==null&&(_u===null?_u=X:_u.push.apply(_u,X))}G=ye}if(X=!1,G!==2)continue}}if(G===1){Yv(d,0),Xf(d,g,0,!0);break}e:{switch(L=d,X=G,X){case 0:case 1:throw Error(i(345));case 4:if((g&4194048)!==g)break;case 6:Xf(L,g,Uc,!Gf);break e;case 2:_u=null;break;case 3:case 5:break;default:throw Error(i(329))}if((g&62914560)===g&&(G=$4+300-We(),10<G)){if(Xf(L,g,Uc,!Gf),rr(L,0,!0)!==0)break e;L.timeoutHandle=GG(gG.bind(null,L,x,_u,JS,j4,g,Uc,Pg,Wv,Gf,X,2,-0,0),G);break e}gG(L,x,_u,JS,j4,g,Uc,Pg,Wv,Gf,X,0,-0,0)}}break}while(!0);dp(d)}function gG(d,g,x,L,G,X,ye,De,Ke,Ct,Xt,tr,Dt,Ot){if(d.timeoutHandle=-1,tr=g.subtreeFlags,(tr&8192||(tr&16785408)===16785408)&&(gb={stylesheets:null,count:0,unsuspend:MRe},uG(g),tr=CRe(),tr!==null)){d.cancelPendingCommit=tr(AG.bind(null,d,g,X,x,L,G,ye,De,Ke,Xt,1,Dt,Ot)),Xf(d,X,ye,!Ct);return}AG(d,g,X,x,L,G,ye,De,Ke)}function GDe(d){for(var g=d;;){var x=g.tag;if((x===0||x===11||x===15)&&g.flags&16384&&(x=g.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var L=0;L<x.length;L++){var G=x[L],X=G.getSnapshot;G=G.value;try{if(!es(X(),G))return!1}catch{return!1}}if(x=g.child,g.subtreeFlags&16384&&x!==null)x.return=g,g=x;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Xf(d,g,x,L){g&=~V4,g&=~Pg,d.suspendedLanes|=g,d.pingedLanes&=~g,L&&(d.warmLanes|=g),L=d.expirationTimes;for(var G=g;0<G;){var X=31-Kt(G),ye=1<<X;L[X]=-1,G&=~ye}x!==0&&Se(d,x,g)}function QS(){return(na&6)===0?(cb(0),!1):!0}function W4(){if(fn!==null){if(aa===0)var d=fn.return;else d=fn,Cn=uo=null,c4(d),jv=null,eb=0,d=fn;for(;d!==null;)Z$(d.alternate,d),d=d.return;fn=null}}function Yv(d,g){var x=d.timeoutHandle;x!==-1&&(d.timeoutHandle=-1,lRe(x)),x=d.cancelPendingCommit,x!==null&&(d.cancelPendingCommit=null,x()),W4(),Pa=d,fn=x=ha(d.current,null),In=g,aa=0,tc=null,Gf=!1,qv=ar(d,g),U4=!1,Wv=Uc=V4=Pg=Hf=So=0,_u=lb=null,j4=!1,(g&8)!==0&&(g|=g&32);var L=d.entangledLanes;if(L!==0)for(d=d.entanglements,L&=g;0<L;){var G=31-Kt(L),X=1<<G;g|=d[G],L&=~X}return bd=g,Ds(),x}function yG(d,g){tn=null,Y.H=US,g===Hx||g===PS?(g=Oj(),aa=3):g===Lj?(g=Oj(),aa=4):aa=g===k$?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,tc=g,fn===null&&(So=1,HS(d,Ln(g,d.current)))}function vG(){var d=Y.H;return Y.H=US,d===null?US:d}function _G(){var d=Y.A;return Y.A=jDe,d}function X4(){So=4,Gf||(In&4194048)!==In&&zc.current!==null||(qv=!0),(Hf&134217727)===0&&(Pg&134217727)===0||Pa===null||Xf(Pa,In,Uc,!1)}function Z4(d,g,x){var L=na;na|=2;var G=vG(),X=_G();(Pa!==d||In!==g)&&(JS=null,Yv(d,g)),g=!1;var ye=So;e:do try{if(aa!==0&&fn!==null){var De=fn,Ke=tc;switch(aa){case 8:W4(),ye=6;break e;case 3:case 2:case 9:case 6:zc.current===null&&(g=!0);var Ct=aa;if(aa=0,tc=null,Kv(d,De,Ke,Ct),x&&qv){ye=0;break e}break;default:Ct=aa,aa=0,tc=null,Kv(d,De,Ke,Ct)}}HDe(),ye=So;break}catch(Xt){yG(d,Xt)}while(!0);return g&&d.shellSuspendCounter++,Cn=uo=null,na=L,Y.H=G,Y.A=X,fn===null&&(Pa=null,In=0,Ds()),ye}function HDe(){for(;fn!==null;)xG(fn)}function qDe(d,g){var x=na;na|=2;var L=vG(),G=_G();Pa!==d||In!==g?(JS=null,KS=We()+500,Yv(d,g)):qv=ar(d,g);e:do try{if(aa!==0&&fn!==null){g=fn;var X=tc;t:switch(aa){case 1:aa=0,tc=null,Kv(d,g,X,1);break;case 2:case 9:if(Dj(X)){aa=0,tc=null,bG(g);break}g=function(){aa!==2&&aa!==9||Pa!==d||(aa=7),dp(d)},X.then(g,g);break e;case 3:aa=7;break e;case 4:aa=5;break e;case 7:Dj(X)?(aa=0,tc=null,bG(g)):(aa=0,tc=null,Kv(d,g,X,7));break;case 5:var ye=null;switch(fn.tag){case 26:ye=fn.memoizedState;case 5:case 27:var De=fn;if(!ye||rH(ye)){aa=0,tc=null;var Ke=De.sibling;if(Ke!==null)fn=Ke;else{var Ct=De.return;Ct!==null?(fn=Ct,eM(Ct)):fn=null}break t}}aa=0,tc=null,Kv(d,g,X,5);break;case 6:aa=0,tc=null,Kv(d,g,X,6);break;case 8:W4(),So=6;break e;default:throw Error(i(462))}}WDe();break}catch(Xt){yG(d,Xt)}while(!0);return Cn=uo=null,Y.H=L,Y.A=G,na=x,fn!==null?0:(Pa=null,In=0,Ds(),So)}function WDe(){for(;fn!==null&&!lt();)xG(fn)}function xG(d){var g=W$(d.alternate,d,bd);d.memoizedProps=d.pendingProps,g===null?eM(d):fn=g}function bG(d){var g=d,x=g.alternate;switch(g.tag){case 15:case 0:g=V$(x,g,g.pendingProps,g.type,void 0,In);break;case 11:g=V$(x,g,g.pendingProps,g.type.render,g.ref,In);break;case 5:c4(g);default:Z$(x,g),g=fn=kc(g,bd),g=W$(x,g,bd)}d.memoizedProps=d.pendingProps,g===null?eM(d):fn=g}function Kv(d,g,x,L){Cn=uo=null,c4(g),jv=null,eb=0;var G=g.return;try{if(NDe(d,G,g,x,In)){So=1,HS(d,Ln(x,d.current)),fn=null;return}}catch(X){if(G!==null)throw fn=G,X;So=1,HS(d,Ln(x,d.current)),fn=null;return}g.flags&32768?(bn||L===1?d=!0:qv||(In&536870912)!==0?d=!1:(Gf=d=!0,(L===2||L===9||L===3||L===6)&&(L=zc.current,L!==null&&L.tag===13&&(L.flags|=16384))),wG(g,d)):eM(g)}function eM(d){var g=d;do{if((g.flags&32768)!==0){wG(g,Gf);return}d=g.return;var x=BDe(g.alternate,g,bd);if(x!==null){fn=x;return}if(g=g.sibling,g!==null){fn=g;return}fn=g=d}while(g!==null);So===0&&(So=5)}function wG(d,g){do{var x=zDe(d.alternate,d);if(x!==null){x.flags&=32767,fn=x;return}if(x=d.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!g&&(d=d.sibling,d!==null)){fn=d;return}fn=d=x}while(d!==null);So=6,fn=null}function AG(d,g,x,L,G,X,ye,De,Ke){d.cancelPendingCommit=null;do tM();while(Qs!==0);if((na&6)!==0)throw Error(i(327));if(g!==null){if(g===d.current)throw Error(i(177));if(X=g.lanes|g.childLanes,X|=Na,ue(d,x,X,ye,De,Ke),d===Pa&&(fn=Pa=null,In=0),Xv=g,Wf=d,Zv=x,G4=X,H4=G,dG=L,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,KDe(Me,function(){return IG(),null})):(d.callbackNode=null,d.callbackPriority=0),L=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||L){L=Y.T,Y.T=null,G=he.p,he.p=2,ye=na,na|=4;try{UDe(d,g,x)}finally{na=ye,he.p=G,Y.T=L}}Qs=1,SG(),MG(),EG()}}function SG(){if(Qs===1){Qs=0;var d=Wf,g=Xv,x=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||x){x=Y.T,Y.T=null;var L=he.p;he.p=2;var G=na;na|=4;try{oG(g,d);var X=sL,ye=so(d.containerInfo),De=X.focusedElem,Ke=X.selectionRange;if(ye!==De&&De&&De.ownerDocument&&pu(De.ownerDocument.documentElement,De)){if(Ke!==null&&ap(De)){var Ct=Ke.start,Xt=Ke.end;if(Xt===void 0&&(Xt=Ct),"selectionStart"in De)De.selectionStart=Ct,De.selectionEnd=Math.min(Xt,De.value.length);else{var tr=De.ownerDocument||document,Dt=tr&&tr.defaultView||window;if(Dt.getSelection){var Ot=Dt.getSelection(),Ci=De.textContent.length,xi=Math.min(Ke.start,Ci),fa=Ke.end===void 0?xi:Math.min(Ke.end,Ci);!Ot.extend&&xi>fa&&(ye=fa,fa=xi,xi=ye);var gt=np(De,xi),ut=np(De,fa);if(gt&&ut&&(Ot.rangeCount!==1||Ot.anchorNode!==gt.node||Ot.anchorOffset!==gt.offset||Ot.focusNode!==ut.node||Ot.focusOffset!==ut.offset)){var St=tr.createRange();St.setStart(gt.node,gt.offset),Ot.removeAllRanges(),xi>fa?(Ot.addRange(St),Ot.extend(ut.node,ut.offset)):(St.setEnd(ut.node,ut.offset),Ot.addRange(St))}}}}for(tr=[],Ot=De;Ot=Ot.parentNode;)Ot.nodeType===1&&tr.push({element:Ot,left:Ot.scrollLeft,top:Ot.scrollTop});for(typeof De.focus=="function"&&De.focus(),De=0;De<tr.length;De++){var Qt=tr[De];Qt.element.scrollLeft=Qt.left,Qt.element.scrollTop=Qt.top}}dM=!!oL,sL=oL=null}finally{na=G,he.p=L,Y.T=x}}d.current=g,Qs=2}}function MG(){if(Qs===2){Qs=0;var d=Wf,g=Xv,x=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||x){x=Y.T,Y.T=null;var L=he.p;he.p=2;var G=na;na|=4;try{rG(d,g.alternate,g)}finally{na=G,he.p=L,Y.T=x}}Qs=3}}function EG(){if(Qs===4||Qs===3){Qs=0,tt();var d=Wf,g=Xv,x=Zv,L=dG;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?Qs=5:(Qs=0,Xv=Wf=null,CG(d,d.pendingLanes));var G=d.pendingLanes;if(G===0&&(qf=null),yt(x),g=g.stateNode,pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(Et,g,void 0,(g.current.flags&128)===128)}catch{}if(L!==null){g=Y.T,G=he.p,he.p=2,Y.T=null;try{for(var X=d.onRecoverableError,ye=0;ye<L.length;ye++){var De=L[ye];X(De.value,{componentStack:De.stack})}}finally{Y.T=g,he.p=G}}(Zv&3)!==0&&tM(),dp(d),G=d.pendingLanes,(x&4194090)!==0&&(G&42)!==0?d===q4?ub++:(ub=0,q4=d):ub=0,cb(0)}}function CG(d,g){(d.pooledCacheLanes&=g)===0&&(g=d.pooledCache,g!=null&&(d.pooledCache=null,gr(g)))}function tM(d){return SG(),MG(),EG(),IG()}function IG(){if(Qs!==5)return!1;var d=Wf,g=G4;G4=0;var x=yt(Zv),L=Y.T,G=he.p;try{he.p=32>x?32:x,Y.T=null,x=H4,H4=null;var X=Wf,ye=Zv;if(Qs=0,Xv=Wf=null,Zv=0,(na&6)!==0)throw Error(i(331));var De=na;if(na|=4,hG(X.current),lG(X,X.current,ye,x),na=De,cb(0,!1),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(Et,X)}catch{}return!0}finally{he.p=G,Y.T=L,CG(d,g)}}function TG(d,g,x){g=Ln(x,g),g=S4(d.stateNode,g,2),d=Ff(d,g,2),d!==null&&(se(d,2),dp(d))}function Ma(d,g,x){if(d.tag===3)TG(d,d,x);else for(;g!==null;){if(g.tag===3){TG(g,d,x);break}else if(g.tag===1){var L=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(qf===null||!qf.has(L))){d=Ln(x,d),x=R$(2),L=Ff(g,x,2),L!==null&&(O$(x,L,g,d),se(L,2),dp(L));break}}g=g.return}}function Y4(d,g,x){var L=d.pingCache;if(L===null){L=d.pingCache=new $De;var G=new Set;L.set(g,G)}else G=L.get(g),G===void 0&&(G=new Set,L.set(g,G));G.has(x)||(U4=!0,G.add(x),d=XDe.bind(null,d,g,x),g.then(d,d))}function XDe(d,g,x){var L=d.pingCache;L!==null&&L.delete(g),d.pingedLanes|=d.suspendedLanes&x,d.warmLanes&=~x,Pa===d&&(In&x)===x&&(So===4||So===3&&(In&62914560)===In&&300>We()-$4?(na&2)===0&&Yv(d,0):V4|=x,Wv===In&&(Wv=0)),dp(d)}function PG(d,g){g===0&&(g=er()),d=xs(d,g),d!==null&&(se(d,g),dp(d))}function ZDe(d){var g=d.memoizedState,x=0;g!==null&&(x=g.retryLane),PG(d,x)}function YDe(d,g){var x=0;switch(d.tag){case 13:var L=d.stateNode,G=d.memoizedState;G!==null&&(x=G.retryLane);break;case 19:L=d.stateNode;break;case 22:L=d.stateNode._retryCache;break;default:throw Error(i(314))}L!==null&&L.delete(g),PG(d,x)}function KDe(d,g){return Ue(d,g)}var rM=null,Jv=null,K4=!1,iM=!1,J4=!1,Lg=0;function dp(d){d!==Jv&&d.next===null&&(Jv===null?rM=Jv=d:Jv=Jv.next=d),iM=!0,K4||(K4=!0,QDe())}function cb(d,g){if(!J4&&iM){J4=!0;do for(var x=!1,L=rM;L!==null;){if(d!==0){var G=L.pendingLanes;if(G===0)var X=0;else{var ye=L.suspendedLanes,De=L.pingedLanes;X=(1<<31-Kt(42|d)+1)-1,X&=G&~(ye&~De),X=X&201326741?X&201326741|1:X?X|2:0}X!==0&&(x=!0,OG(L,X))}else X=In,X=rr(L,L===Pa?X:0,L.cancelPendingCommit!==null||L.timeoutHandle!==-1),(X&3)===0||ar(L,X)||(x=!0,OG(L,X));L=L.next}while(x);J4=!1}}function JDe(){LG()}function LG(){iM=K4=!1;var d=0;Lg!==0&&(sRe()&&(d=Lg),Lg=0);for(var g=We(),x=null,L=rM;L!==null;){var G=L.next,X=DG(L,g);X===0?(L.next=null,x===null?rM=G:x.next=G,G===null&&(Jv=x)):(x=L,(d!==0||(X&3)!==0)&&(iM=!0)),L=G}cb(d)}function DG(d,g){for(var x=d.suspendedLanes,L=d.pingedLanes,G=d.expirationTimes,X=d.pendingLanes&-62914561;0<X;){var ye=31-Kt(X),De=1<<ye,Ke=G[ye];Ke===-1?((De&x)===0||(De&L)!==0)&&(G[ye]=Vr(De,g)):Ke<=g&&(d.expiredLanes|=De),X&=~De}if(g=Pa,x=In,x=rr(d,d===g?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),L=d.callbackNode,x===0||d===g&&(aa===2||aa===9)||d.cancelPendingCommit!==null)return L!==null&&L!==null&&_e(L),d.callbackNode=null,d.callbackPriority=0;if((x&3)===0||ar(d,x)){if(g=x&-x,g===d.callbackPriority)return g;switch(L!==null&&_e(L),yt(x)){case 2:case 8:x=dt;break;case 32:x=Me;break;case 268435456:x=Ze;break;default:x=Me}return L=RG.bind(null,d),x=Ue(x,L),d.callbackPriority=g,d.callbackNode=x,g}return L!==null&&L!==null&&_e(L),d.callbackPriority=2,d.callbackNode=null,2}function RG(d,g){if(Qs!==0&&Qs!==5)return d.callbackNode=null,d.callbackPriority=0,null;var x=d.callbackNode;if(tM()&&d.callbackNode!==x)return null;var L=In;return L=rr(d,d===Pa?L:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),L===0?null:(mG(d,L,g),DG(d,We()),d.callbackNode!=null&&d.callbackNode===x?RG.bind(null,d):null)}function OG(d,g){if(tM())return null;mG(d,g,!0)}function QDe(){uRe(function(){(na&6)!==0?Ue(Lt,JDe):LG()})}function Q4(){return Lg===0&&(Lg=Qe()),Lg}function kG(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:mr(""+d)}function NG(d,g){var x=g.ownerDocument.createElement("input");return x.name=g.name,x.value=g.value,d.id&&x.setAttribute("form",d.id),g.parentNode.insertBefore(x,g),d=new FormData(d),x.parentNode.removeChild(x),d}function eRe(d,g,x,L,G){if(g==="submit"&&x&&x.stateNode===G){var X=kG((G[ke]||null).action),ye=L.submitter;ye&&(g=(g=ye[ke]||null)?kG(g.formAction):ye.getAttribute("formAction"),g!==null&&(X=g,ye=null));var De=new et("action","action",null,L,G);d.push({event:De,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(Lg!==0){var Ke=ye?NG(G,ye):new FormData(G);_4(x,{pending:!0,data:Ke,method:G.method,action:X},null,Ke)}}else typeof X=="function"&&(De.preventDefault(),Ke=ye?NG(G,ye):new FormData(G),_4(x,{pending:!0,data:Ke,method:G.method,action:X},X,Ke))},currentTarget:G}]})}}for(var eL=0;eL<Zu.length;eL++){var tL=Zu[eL],tRe=tL.toLowerCase(),rRe=tL[0].toUpperCase()+tL.slice(1);ca(tRe,"on"+rRe)}ca(Oc,"onAnimationEnd"),ca(sp,"onAnimationIteration"),ca(lo,"onAnimationStart"),ca("dblclick","onDoubleClick"),ca("focusin","onFocus"),ca("focusout","onBlur"),ca(No,"onTransitionRun"),ca(du,"onTransitionStart"),ca(gl,"onTransitionCancel"),ca(Rv,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),En("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),En("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),En("onBeforeInput",["compositionend","keypress","textInput","paste"]),En("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),En("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),En("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iRe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hb));function FG(d,g){g=(g&4)!==0;for(var x=0;x<d.length;x++){var L=d[x],G=L.event;L=L.listeners;e:{var X=void 0;if(g)for(var ye=L.length-1;0<=ye;ye--){var De=L[ye],Ke=De.instance,Ct=De.currentTarget;if(De=De.listener,Ke!==X&&G.isPropagationStopped())break e;X=De,G.currentTarget=Ct;try{X(G)}catch(Xt){GS(Xt)}G.currentTarget=null,X=Ke}else for(ye=0;ye<L.length;ye++){if(De=L[ye],Ke=De.instance,Ct=De.currentTarget,De=De.listener,Ke!==X&&G.isPropagationStopped())break e;X=De,G.currentTarget=Ct;try{X(G)}catch(Xt){GS(Xt)}G.currentTarget=null,X=Ke}}}}function mn(d,g){var x=g[ot];x===void 0&&(x=g[ot]=new Set);var L=d+"__bubble";x.has(L)||(BG(g,d,2,!1),x.add(L))}function rL(d,g,x){var L=0;g&&(L|=4),BG(x,d,L,g)}var nM="_reactListening"+Math.random().toString(36).slice(2);function iL(d){if(!d[nM]){d[nM]=!0,en.forEach(function(x){x!=="selectionchange"&&(iRe.has(x)||rL(x,!1,d),rL(x,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[nM]||(g[nM]=!0,rL("selectionchange",!1,g))}}function BG(d,g,x,L){switch(lH(g)){case 2:var G=PRe;break;case 8:G=LRe;break;default:G=yL}x=G.bind(null,g,x,d),G=void 0,!_o||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(G=!0),L?G!==void 0?d.addEventListener(g,x,{capture:!0,passive:G}):d.addEventListener(g,x,!0):G!==void 0?d.addEventListener(g,x,{passive:G}):d.addEventListener(g,x,!1)}function nL(d,g,x,L,G){var X=L;if((g&1)===0&&(g&2)===0&&L!==null)e:for(;;){if(L===null)return;var ye=L.tag;if(ye===3||ye===4){var De=L.stateNode.containerInfo;if(De===G)break;if(ye===4)for(ye=L.return;ye!==null;){var Ke=ye.tag;if((Ke===3||Ke===4)&&ye.stateNode.containerInfo===G)return;ye=ye.return}for(;De!==null;){if(ye=ai(De),ye===null)return;if(Ke=ye.tag,Ke===5||Ke===6||Ke===26||Ke===27){L=X=ye;continue e}De=De.parentNode}}L=L.return}zl(function(){var Ct=X,Xt=lr(x),tr=[];e:{var Dt=lp.get(d);if(Dt!==void 0){var Ot=et,Ci=d;switch(d){case"keypress":if(Ul(x)===0)break e;case"keydown":case"keyup":Ot=jx;break;case"focusin":Ci="focus",Ot=Vn;break;case"focusout":Ci="blur",Ot=Vn;break;case"beforeblur":case"afterblur":Ot=Vn;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ot=ci;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ot=Fi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ot=ua;break;case Oc:case sp:case lo:Ot=dl;break;case Rv:Ot=Xs;break;case"scroll":case"scrollend":Ot=Ge;break;case"wheel":Ot=Bi;break;case"copy":case"cut":case"paste":Ot=ip;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ot=Xi;break;case"toggle":case"beforetoggle":Ot=jn}var xi=(g&4)!==0,fa=!xi&&(d==="scroll"||d==="scrollend"),gt=xi?Dt!==null?Dt+"Capture":null:Dt;xi=[];for(var ut=Ct,St;ut!==null;){var Qt=ut;if(St=Qt.stateNode,Qt=Qt.tag,Qt!==5&&Qt!==26&&Qt!==27||St===null||gt===null||(Qt=la(ut,gt),Qt!=null&&xi.push(pb(ut,Qt,St))),fa)break;ut=ut.return}0<xi.length&&(Dt=new Ot(Dt,Ci,null,x,Xt),tr.push({event:Dt,listeners:xi}))}}if((g&7)===0){e:{if(Dt=d==="mouseover"||d==="pointerover",Ot=d==="mouseout"||d==="pointerout",Dt&&x!==xr&&(Ci=x.relatedTarget||x.fromElement)&&(ai(Ci)||Ci[$e]))break e;if((Ot||Dt)&&(Dt=Xt.window===Xt?Xt:(Dt=Xt.ownerDocument)?Dt.defaultView||Dt.parentWindow:window,Ot?(Ci=x.relatedTarget||x.toElement,Ot=Ct,Ci=Ci?ai(Ci):null,Ci!==null&&(fa=a(Ci),xi=Ci.tag,Ci!==fa||xi!==5&&xi!==27&&xi!==6)&&(Ci=null)):(Ot=null,Ci=Ct),Ot!==Ci)){if(xi=ci,Qt="onMouseLeave",gt="onMouseEnter",ut="mouse",(d==="pointerout"||d==="pointerover")&&(xi=Xi,Qt="onPointerLeave",gt="onPointerEnter",ut="pointer"),fa=Ot==null?Dt:Cr(Ot),St=Ci==null?Dt:Cr(Ci),Dt=new xi(Qt,ut+"leave",Ot,x,Xt),Dt.target=fa,Dt.relatedTarget=St,Qt=null,ai(Xt)===Ct&&(xi=new xi(gt,ut+"enter",Ci,x,Xt),xi.target=St,xi.relatedTarget=fa,Qt=xi),fa=Qt,Ot&&Ci)t:{for(xi=Ot,gt=Ci,ut=0,St=xi;St;St=Qv(St))ut++;for(St=0,Qt=gt;Qt;Qt=Qv(Qt))St++;for(;0<ut-St;)xi=Qv(xi),ut--;for(;0<St-ut;)gt=Qv(gt),St--;for(;ut--;){if(xi===gt||gt!==null&&xi===gt.alternate)break t;xi=Qv(xi),gt=Qv(gt)}xi=null}else xi=null;Ot!==null&&zG(tr,Dt,Ot,xi,!1),Ci!==null&&fa!==null&&zG(tr,fa,Ci,xi,!0)}}e:{if(Dt=Ct?Cr(Ct):window,Ot=Dt.nodeName&&Dt.nodeName.toLowerCase(),Ot==="select"||Ot==="input"&&Dt.type==="file")var ti=lh;else if(Pc(Dt))if(Xu)ti=CS;else{ti=ES;var hn=hu}else Ot=Dt.nodeName,!Ot||Ot.toLowerCase()!=="input"||Dt.type!=="checkbox"&&Dt.type!=="radio"?Ct&&_t(Ct.elementType)&&(ti=lh):ti=vs;if(ti&&(ti=ti(d,Ct))){fl(tr,ti,x,Xt);break e}hn&&hn(d,Dt,Ct),d==="focusout"&&Ct&&Dt.type==="number"&&Ct.memoizedProps.value!=null&&R(Dt,"number",Dt.value)}switch(hn=Ct?Cr(Ct):window,d){case"focusin":(Pc(hn)||hn.contentEditable==="true")&&(Ps=hn,Dc=Ct,pd=null);break;case"focusout":pd=Dc=Ps=null;break;case"mousedown":uh=!0;break;case"contextmenu":case"mouseup":case"dragend":uh=!1,Rc(tr,x,Xt);break;case"selectionchange":if(ts)break;case"keydown":case"keyup":Rc(tr,x,Xt)}var pi;if(Lo)e:{switch(d){case"compositionstart":var Ai="onCompositionStart";break e;case"compositionend":Ai="onCompositionEnd";break e;case"compositionupdate":Ai="onCompositionUpdate";break e}Ai=void 0}else bo?hd(d,x)&&(Ai="onCompositionEnd"):d==="keydown"&&x.keyCode===229&&(Ai="onCompositionStart");Ai&&(sh&&x.locale!=="ko"&&(bo||Ai!=="onCompositionStart"?Ai==="onCompositionEnd"&&bo&&(pi=Ta()):(xo=Xt,pl="value"in xo?xo.value:xo.textContent,bo=!0)),hn=aM(Ct,Ai),0<hn.length&&(Ai=new Gr(Ai,d,null,x,Xt),tr.push({event:Ai,listeners:hn}),pi?Ai.data=pi:(pi=lu(x),pi!==null&&(Ai.data=pi)))),(pi=SS?Do(d,x):K5(d,x))&&(Ai=aM(Ct,"onBeforeInput"),0<Ai.length&&(hn=new Gr("onBeforeInput","beforeinput",null,x,Xt),tr.push({event:hn,listeners:Ai}),hn.data=pi)),eRe(tr,d,Ct,x,Xt)}FG(tr,g)})}function pb(d,g,x){return{instance:d,listener:g,currentTarget:x}}function aM(d,g){for(var x=g+"Capture",L=[];d!==null;){var G=d,X=G.stateNode;if(G=G.tag,G!==5&&G!==26&&G!==27||X===null||(G=la(d,x),G!=null&&L.unshift(pb(d,G,X)),G=la(d,g),G!=null&&L.push(pb(d,G,X))),d.tag===3)return L;d=d.return}return[]}function Qv(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function zG(d,g,x,L,G){for(var X=g._reactName,ye=[];x!==null&&x!==L;){var De=x,Ke=De.alternate,Ct=De.stateNode;if(De=De.tag,Ke!==null&&Ke===L)break;De!==5&&De!==26&&De!==27||Ct===null||(Ke=Ct,G?(Ct=la(x,X),Ct!=null&&ye.unshift(pb(x,Ct,Ke))):G||(Ct=la(x,X),Ct!=null&&ye.push(pb(x,Ct,Ke)))),x=x.return}ye.length!==0&&d.push({event:g,listeners:ye})}var nRe=/\r\n?/g,aRe=/\u0000|\uFFFD/g;function UG(d){return(typeof d=="string"?d:""+d).replace(nRe,`
`).replace(aRe,"")}function VG(d,g){return g=UG(g),UG(d)===g}function oM(){}function da(d,g,x,L,G,X){switch(x){case"children":typeof L=="string"?g==="body"||g==="textarea"&&L===""||we(d,L):(typeof L=="number"||typeof L=="bigint")&&g!=="body"&&we(d,""+L);break;case"className":cr(d,"class",L);break;case"tabIndex":cr(d,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":cr(d,x,L);break;case"style":ct(d,L,X);break;case"data":if(g!=="object"){cr(d,"data",L);break}case"src":case"href":if(L===""&&(g!=="a"||x!=="href")){d.removeAttribute(x);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){d.removeAttribute(x);break}L=mr(""+L),d.setAttribute(x,L);break;case"action":case"formAction":if(typeof L=="function"){d.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof X=="function"&&(x==="formAction"?(g!=="input"&&da(d,g,"name",G.name,G,null),da(d,g,"formEncType",G.formEncType,G,null),da(d,g,"formMethod",G.formMethod,G,null),da(d,g,"formTarget",G.formTarget,G,null)):(da(d,g,"encType",G.encType,G,null),da(d,g,"method",G.method,G,null),da(d,g,"target",G.target,G,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){d.removeAttribute(x);break}L=mr(""+L),d.setAttribute(x,L);break;case"onClick":L!=null&&(d.onclick=oM);break;case"onScroll":L!=null&&mn("scroll",d);break;case"onScrollEnd":L!=null&&mn("scrollend",d);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(i(61));if(x=L.__html,x!=null){if(G.children!=null)throw Error(i(60));d.innerHTML=x}}break;case"multiple":d.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":d.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){d.removeAttribute("xlink:href");break}x=mr(""+L),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?d.setAttribute(x,""+L):d.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?d.setAttribute(x,""):d.removeAttribute(x);break;case"capture":case"download":L===!0?d.setAttribute(x,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?d.setAttribute(x,L):d.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?d.setAttribute(x,L):d.removeAttribute(x);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?d.removeAttribute(x):d.setAttribute(x,L);break;case"popover":mn("beforetoggle",d),mn("toggle",d),zt(d,"popover",L);break;case"xlinkActuate":ur(d,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":ur(d,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":ur(d,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":ur(d,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":ur(d,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":ur(d,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":ur(d,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":ur(d,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":ur(d,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":zt(d,"is",L);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=qt.get(x)||x,zt(d,x,L))}}function aL(d,g,x,L,G,X){switch(x){case"style":ct(d,L,X);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(i(61));if(x=L.__html,x!=null){if(G.children!=null)throw Error(i(60));d.innerHTML=x}}break;case"children":typeof L=="string"?we(d,L):(typeof L=="number"||typeof L=="bigint")&&we(d,""+L);break;case"onScroll":L!=null&&mn("scroll",d);break;case"onScrollEnd":L!=null&&mn("scrollend",d);break;case"onClick":L!=null&&(d.onclick=oM);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hi.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(G=x.endsWith("Capture"),g=x.slice(2,G?x.length-7:void 0),X=d[ke]||null,X=X!=null?X[x]:null,typeof X=="function"&&d.removeEventListener(g,X,G),typeof L=="function")){typeof X!="function"&&X!==null&&(x in d?d[x]=null:d.hasAttribute(x)&&d.removeAttribute(x)),d.addEventListener(g,L,G);break e}x in d?d[x]=L:L===!0?d.setAttribute(x,""):zt(d,x,L)}}}function el(d,g,x){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mn("error",d),mn("load",d);var L=!1,G=!1,X;for(X in x)if(x.hasOwnProperty(X)){var ye=x[X];if(ye!=null)switch(X){case"src":L=!0;break;case"srcSet":G=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:da(d,g,X,ye,x,null)}}G&&da(d,g,"srcSet",x.srcSet,x,null),L&&da(d,g,"src",x.src,x,null);return;case"input":mn("invalid",d);var De=X=ye=G=null,Ke=null,Ct=null;for(L in x)if(x.hasOwnProperty(L)){var Xt=x[L];if(Xt!=null)switch(L){case"name":G=Xt;break;case"type":ye=Xt;break;case"checked":Ke=Xt;break;case"defaultChecked":Ct=Xt;break;case"value":X=Xt;break;case"defaultValue":De=Xt;break;case"children":case"dangerouslySetInnerHTML":if(Xt!=null)throw Error(i(137,g));break;default:da(d,g,L,Xt,x,null)}}S(d,X,De,Ke,Ct,ye,G,!1),$r(d);return;case"select":mn("invalid",d),L=ye=X=null;for(G in x)if(x.hasOwnProperty(G)&&(De=x[G],De!=null))switch(G){case"value":X=De;break;case"defaultValue":ye=De;break;case"multiple":L=De;default:da(d,g,G,De,x,null)}g=X,x=ye,d.multiple=!!L,g!=null?j(d,!!L,g,!1):x!=null&&j(d,!!L,x,!0);return;case"textarea":mn("invalid",d),X=G=L=null;for(ye in x)if(x.hasOwnProperty(ye)&&(De=x[ye],De!=null))switch(ye){case"value":L=De;break;case"defaultValue":G=De;break;case"children":X=De;break;case"dangerouslySetInnerHTML":if(De!=null)throw Error(i(91));break;default:da(d,g,ye,De,x,null)}ie(d,L,G,X),$r(d);return;case"option":for(Ke in x)if(x.hasOwnProperty(Ke)&&(L=x[Ke],L!=null))switch(Ke){case"selected":d.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:da(d,g,Ke,L,x,null)}return;case"dialog":mn("beforetoggle",d),mn("toggle",d),mn("cancel",d),mn("close",d);break;case"iframe":case"object":mn("load",d);break;case"video":case"audio":for(L=0;L<hb.length;L++)mn(hb[L],d);break;case"image":mn("error",d),mn("load",d);break;case"details":mn("toggle",d);break;case"embed":case"source":case"link":mn("error",d),mn("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ct in x)if(x.hasOwnProperty(Ct)&&(L=x[Ct],L!=null))switch(Ct){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:da(d,g,Ct,L,x,null)}return;default:if(_t(g)){for(Xt in x)x.hasOwnProperty(Xt)&&(L=x[Xt],L!==void 0&&aL(d,g,Xt,L,x,void 0));return}}for(De in x)x.hasOwnProperty(De)&&(L=x[De],L!=null&&da(d,g,De,L,x,null))}function oRe(d,g,x,L){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var G=null,X=null,ye=null,De=null,Ke=null,Ct=null,Xt=null;for(Ot in x){var tr=x[Ot];if(x.hasOwnProperty(Ot)&&tr!=null)switch(Ot){case"checked":break;case"value":break;case"defaultValue":Ke=tr;default:L.hasOwnProperty(Ot)||da(d,g,Ot,null,L,tr)}}for(var Dt in L){var Ot=L[Dt];if(tr=x[Dt],L.hasOwnProperty(Dt)&&(Ot!=null||tr!=null))switch(Dt){case"type":X=Ot;break;case"name":G=Ot;break;case"checked":Ct=Ot;break;case"defaultChecked":Xt=Ot;break;case"value":ye=Ot;break;case"defaultValue":De=Ot;break;case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(i(137,g));break;default:Ot!==tr&&da(d,g,Dt,Ot,L,tr)}}qr(d,ye,De,Ke,Ct,Xt,X,G);return;case"select":Ot=ye=De=Dt=null;for(X in x)if(Ke=x[X],x.hasOwnProperty(X)&&Ke!=null)switch(X){case"value":break;case"multiple":Ot=Ke;default:L.hasOwnProperty(X)||da(d,g,X,null,L,Ke)}for(G in L)if(X=L[G],Ke=x[G],L.hasOwnProperty(G)&&(X!=null||Ke!=null))switch(G){case"value":Dt=X;break;case"defaultValue":De=X;break;case"multiple":ye=X;default:X!==Ke&&da(d,g,G,X,L,Ke)}g=De,x=ye,L=Ot,Dt!=null?j(d,!!x,Dt,!1):!!L!=!!x&&(g!=null?j(d,!!x,g,!0):j(d,!!x,x?[]:"",!1));return;case"textarea":Ot=Dt=null;for(De in x)if(G=x[De],x.hasOwnProperty(De)&&G!=null&&!L.hasOwnProperty(De))switch(De){case"value":break;case"children":break;default:da(d,g,De,null,L,G)}for(ye in L)if(G=L[ye],X=x[ye],L.hasOwnProperty(ye)&&(G!=null||X!=null))switch(ye){case"value":Dt=G;break;case"defaultValue":Ot=G;break;case"children":break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(91));break;default:G!==X&&da(d,g,ye,G,L,X)}Z(d,Dt,Ot);return;case"option":for(var Ci in x)if(Dt=x[Ci],x.hasOwnProperty(Ci)&&Dt!=null&&!L.hasOwnProperty(Ci))switch(Ci){case"selected":d.selected=!1;break;default:da(d,g,Ci,null,L,Dt)}for(Ke in L)if(Dt=L[Ke],Ot=x[Ke],L.hasOwnProperty(Ke)&&Dt!==Ot&&(Dt!=null||Ot!=null))switch(Ke){case"selected":d.selected=Dt&&typeof Dt!="function"&&typeof Dt!="symbol";break;default:da(d,g,Ke,Dt,L,Ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xi in x)Dt=x[xi],x.hasOwnProperty(xi)&&Dt!=null&&!L.hasOwnProperty(xi)&&da(d,g,xi,null,L,Dt);for(Ct in L)if(Dt=L[Ct],Ot=x[Ct],L.hasOwnProperty(Ct)&&Dt!==Ot&&(Dt!=null||Ot!=null))switch(Ct){case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(i(137,g));break;default:da(d,g,Ct,Dt,L,Ot)}return;default:if(_t(g)){for(var fa in x)Dt=x[fa],x.hasOwnProperty(fa)&&Dt!==void 0&&!L.hasOwnProperty(fa)&&aL(d,g,fa,void 0,L,Dt);for(Xt in L)Dt=L[Xt],Ot=x[Xt],!L.hasOwnProperty(Xt)||Dt===Ot||Dt===void 0&&Ot===void 0||aL(d,g,Xt,Dt,L,Ot);return}}for(var gt in x)Dt=x[gt],x.hasOwnProperty(gt)&&Dt!=null&&!L.hasOwnProperty(gt)&&da(d,g,gt,null,L,Dt);for(tr in L)Dt=L[tr],Ot=x[tr],!L.hasOwnProperty(tr)||Dt===Ot||Dt==null&&Ot==null||da(d,g,tr,Dt,L,Ot)}var oL=null,sL=null;function sM(d){return d.nodeType===9?d:d.ownerDocument}function jG(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $G(d,g){if(d===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&g==="foreignObject"?0:d}function lL(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var uL=null;function sRe(){var d=window.event;return d&&d.type==="popstate"?d===uL?!1:(uL=d,!0):(uL=null,!1)}var GG=typeof setTimeout=="function"?setTimeout:void 0,lRe=typeof clearTimeout=="function"?clearTimeout:void 0,HG=typeof Promise=="function"?Promise:void 0,uRe=typeof queueMicrotask=="function"?queueMicrotask:typeof HG<"u"?function(d){return HG.resolve(null).then(d).catch(cRe)}:GG;function cRe(d){setTimeout(function(){throw d})}function Zf(d){return d==="head"}function qG(d,g){var x=g,L=0,G=0;do{var X=x.nextSibling;if(d.removeChild(x),X&&X.nodeType===8)if(x=X.data,x==="/$"){if(0<L&&8>L){x=L;var ye=d.ownerDocument;if(x&1&&db(ye.documentElement),x&2&&db(ye.body),x&4)for(x=ye.head,db(x),ye=x.firstChild;ye;){var De=ye.nextSibling,Ke=ye.nodeName;ye[nr]||Ke==="SCRIPT"||Ke==="STYLE"||Ke==="LINK"&&ye.rel.toLowerCase()==="stylesheet"||x.removeChild(ye),ye=De}}if(G===0){d.removeChild(X),bb(g);return}G--}else x==="$"||x==="$?"||x==="$!"?G++:L=x.charCodeAt(0)-48;else L=0;x=X}while(x);bb(g)}function cL(d){var g=d.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var x=g;switch(g=g.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":cL(x),Kr(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}d.removeChild(x)}}function hRe(d,g,x,L){for(;d.nodeType===1;){var G=x;if(d.nodeName.toLowerCase()!==g.toLowerCase()){if(!L&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(L){if(!d[nr])switch(g){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(X=d.getAttribute("rel"),X==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(X!==G.rel||d.getAttribute("href")!==(G.href==null||G.href===""?null:G.href)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin)||d.getAttribute("title")!==(G.title==null?null:G.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(X=d.getAttribute("src"),(X!==(G.src==null?null:G.src)||d.getAttribute("type")!==(G.type==null?null:G.type)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin))&&X&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(g==="input"&&d.type==="hidden"){var X=G.name==null?null:""+G.name;if(G.type==="hidden"&&d.getAttribute("name")===X)return d}else return d;if(d=gh(d.nextSibling),d===null)break}return null}function pRe(d,g,x){if(g==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!x||(d=gh(d.nextSibling),d===null))return null;return d}function hL(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function dRe(d,g){var x=d.ownerDocument;if(d.data!=="$?"||x.readyState==="complete")g();else{var L=function(){g(),x.removeEventListener("DOMContentLoaded",L)};x.addEventListener("DOMContentLoaded",L),d._reactRetry=L}}function gh(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return d}var pL=null;function WG(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var x=d.data;if(x==="$"||x==="$!"||x==="$?"){if(g===0)return d;g--}else x==="/$"&&g++}d=d.previousSibling}return null}function XG(d,g,x){switch(g=sM(x),d){case"html":if(d=g.documentElement,!d)throw Error(i(452));return d;case"head":if(d=g.head,!d)throw Error(i(453));return d;case"body":if(d=g.body,!d)throw Error(i(454));return d;default:throw Error(i(451))}}function db(d){for(var g=d.attributes;g.length;)d.removeAttributeNode(g[0]);Kr(d)}var Vc=new Map,ZG=new Set;function lM(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var wd=he.d;he.d={f:fRe,r:mRe,D:gRe,C:yRe,L:vRe,m:_Re,X:bRe,S:xRe,M:wRe};function fRe(){var d=wd.f(),g=QS();return d||g}function mRe(d){var g=Jr(d);g!==null&&g.tag===5&&g.type==="form"?m$(g):wd.r(d)}var e0=typeof document>"u"?null:document;function YG(d,g,x){var L=e0;if(L&&typeof g=="string"&&g){var G=Vi(g);G='link[rel="'+d+'"][href="'+G+'"]',typeof x=="string"&&(G+='[crossorigin="'+x+'"]'),ZG.has(G)||(ZG.add(G),d={rel:d,crossOrigin:x,href:g},L.querySelector(G)===null&&(g=L.createElement("link"),el(g,"link",d),Hr(g),L.head.appendChild(g)))}}function gRe(d){wd.D(d),YG("dns-prefetch",d,null)}function yRe(d,g){wd.C(d,g),YG("preconnect",d,g)}function vRe(d,g,x){wd.L(d,g,x);var L=e0;if(L&&d&&g){var G='link[rel="preload"][as="'+Vi(g)+'"]';g==="image"&&x&&x.imageSrcSet?(G+='[imagesrcset="'+Vi(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(G+='[imagesizes="'+Vi(x.imageSizes)+'"]')):G+='[href="'+Vi(d)+'"]';var X=G;switch(g){case"style":X=t0(d);break;case"script":X=r0(d)}Vc.has(X)||(d=p({rel:"preload",href:g==="image"&&x&&x.imageSrcSet?void 0:d,as:g},x),Vc.set(X,d),L.querySelector(G)!==null||g==="style"&&L.querySelector(fb(X))||g==="script"&&L.querySelector(mb(X))||(g=L.createElement("link"),el(g,"link",d),Hr(g),L.head.appendChild(g)))}}function _Re(d,g){wd.m(d,g);var x=e0;if(x&&d){var L=g&&typeof g.as=="string"?g.as:"script",G='link[rel="modulepreload"][as="'+Vi(L)+'"][href="'+Vi(d)+'"]',X=G;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":X=r0(d)}if(!Vc.has(X)&&(d=p({rel:"modulepreload",href:d},g),Vc.set(X,d),x.querySelector(G)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(mb(X)))return}L=x.createElement("link"),el(L,"link",d),Hr(L),x.head.appendChild(L)}}}function xRe(d,g,x){wd.S(d,g,x);var L=e0;if(L&&d){var G=Ei(L).hoistableStyles,X=t0(d);g=g||"default";var ye=G.get(X);if(!ye){var De={loading:0,preload:null};if(ye=L.querySelector(fb(X)))De.loading=5;else{d=p({rel:"stylesheet",href:d,"data-precedence":g},x),(x=Vc.get(X))&&dL(d,x);var Ke=ye=L.createElement("link");Hr(Ke),el(Ke,"link",d),Ke._p=new Promise(function(Ct,Xt){Ke.onload=Ct,Ke.onerror=Xt}),Ke.addEventListener("load",function(){De.loading|=1}),Ke.addEventListener("error",function(){De.loading|=2}),De.loading|=4,uM(ye,g,L)}ye={type:"stylesheet",instance:ye,count:1,state:De},G.set(X,ye)}}}function bRe(d,g){wd.X(d,g);var x=e0;if(x&&d){var L=Ei(x).hoistableScripts,G=r0(d),X=L.get(G);X||(X=x.querySelector(mb(G)),X||(d=p({src:d,async:!0},g),(g=Vc.get(G))&&fL(d,g),X=x.createElement("script"),Hr(X),el(X,"link",d),x.head.appendChild(X)),X={type:"script",instance:X,count:1,state:null},L.set(G,X))}}function wRe(d,g){wd.M(d,g);var x=e0;if(x&&d){var L=Ei(x).hoistableScripts,G=r0(d),X=L.get(G);X||(X=x.querySelector(mb(G)),X||(d=p({src:d,async:!0,type:"module"},g),(g=Vc.get(G))&&fL(d,g),X=x.createElement("script"),Hr(X),el(X,"link",d),x.head.appendChild(X)),X={type:"script",instance:X,count:1,state:null},L.set(G,X))}}function KG(d,g,x,L){var G=(G=pe.current)?lM(G):null;if(!G)throw Error(i(446));switch(d){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(g=t0(x.href),x=Ei(G).hoistableStyles,L=x.get(g),L||(L={type:"style",instance:null,count:0,state:null},x.set(g,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){d=t0(x.href);var X=Ei(G).hoistableStyles,ye=X.get(d);if(ye||(G=G.ownerDocument||G,ye={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},X.set(d,ye),(X=G.querySelector(fb(d)))&&!X._p&&(ye.instance=X,ye.state.loading=5),Vc.has(d)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},Vc.set(d,x),X||ARe(G,d,x,ye.state))),g&&L===null)throw Error(i(528,""));return ye}if(g&&L!==null)throw Error(i(529,""));return null;case"script":return g=x.async,x=x.src,typeof x=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=r0(x),x=Ei(G).hoistableScripts,L=x.get(g),L||(L={type:"script",instance:null,count:0,state:null},x.set(g,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,d))}}function t0(d){return'href="'+Vi(d)+'"'}function fb(d){return'link[rel="stylesheet"]['+d+"]"}function JG(d){return p({},d,{"data-precedence":d.precedence,precedence:null})}function ARe(d,g,x,L){d.querySelector('link[rel="preload"][as="style"]['+g+"]")?L.loading=1:(g=d.createElement("link"),L.preload=g,g.addEventListener("load",function(){return L.loading|=1}),g.addEventListener("error",function(){return L.loading|=2}),el(g,"link",x),Hr(g),d.head.appendChild(g))}function r0(d){return'[src="'+Vi(d)+'"]'}function mb(d){return"script[async]"+d}function QG(d,g,x){if(g.count++,g.instance===null)switch(g.type){case"style":var L=d.querySelector('style[data-href~="'+Vi(x.href)+'"]');if(L)return g.instance=L,Hr(L),L;var G=p({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return L=(d.ownerDocument||d).createElement("style"),Hr(L),el(L,"style",G),uM(L,x.precedence,d),g.instance=L;case"stylesheet":G=t0(x.href);var X=d.querySelector(fb(G));if(X)return g.state.loading|=4,g.instance=X,Hr(X),X;L=JG(x),(G=Vc.get(G))&&dL(L,G),X=(d.ownerDocument||d).createElement("link"),Hr(X);var ye=X;return ye._p=new Promise(function(De,Ke){ye.onload=De,ye.onerror=Ke}),el(X,"link",L),g.state.loading|=4,uM(X,x.precedence,d),g.instance=X;case"script":return X=r0(x.src),(G=d.querySelector(mb(X)))?(g.instance=G,Hr(G),G):(L=x,(G=Vc.get(X))&&(L=p({},x),fL(L,G)),d=d.ownerDocument||d,G=d.createElement("script"),Hr(G),el(G,"link",L),d.head.appendChild(G),g.instance=G);case"void":return null;default:throw Error(i(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(L=g.instance,g.state.loading|=4,uM(L,x.precedence,d));return g.instance}function uM(d,g,x){for(var L=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),G=L.length?L[L.length-1]:null,X=G,ye=0;ye<L.length;ye++){var De=L[ye];if(De.dataset.precedence===g)X=De;else if(X!==G)break}X?X.parentNode.insertBefore(d,X.nextSibling):(g=x.nodeType===9?x.head:x,g.insertBefore(d,g.firstChild))}function dL(d,g){d.crossOrigin==null&&(d.crossOrigin=g.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=g.referrerPolicy),d.title==null&&(d.title=g.title)}function fL(d,g){d.crossOrigin==null&&(d.crossOrigin=g.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=g.referrerPolicy),d.integrity==null&&(d.integrity=g.integrity)}var cM=null;function eH(d,g,x){if(cM===null){var L=new Map,G=cM=new Map;G.set(x,L)}else G=cM,L=G.get(x),L||(L=new Map,G.set(x,L));if(L.has(d))return L;for(L.set(d,null),x=x.getElementsByTagName(d),G=0;G<x.length;G++){var X=x[G];if(!(X[nr]||X[Gt]||d==="link"&&X.getAttribute("rel")==="stylesheet")&&X.namespaceURI!=="http://www.w3.org/2000/svg"){var ye=X.getAttribute(g)||"";ye=d+ye;var De=L.get(ye);De?De.push(X):L.set(ye,[X])}}return L}function tH(d,g,x){d=d.ownerDocument||d,d.head.insertBefore(x,g==="title"?d.querySelector("head > title"):null)}function SRe(d,g,x){if(x===1||g.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return d=g.disabled,typeof g.precedence=="string"&&d==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function rH(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var gb=null;function MRe(){}function ERe(d,g,x){if(gb===null)throw Error(i(475));var L=gb;if(g.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var G=t0(x.href),X=d.querySelector(fb(G));if(X){d=X._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(L.count++,L=hM.bind(L),d.then(L,L)),g.state.loading|=4,g.instance=X,Hr(X);return}X=d.ownerDocument||d,x=JG(x),(G=Vc.get(G))&&dL(x,G),X=X.createElement("link"),Hr(X);var ye=X;ye._p=new Promise(function(De,Ke){ye.onload=De,ye.onerror=Ke}),el(X,"link",x),g.instance=X}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(g,d),(d=g.state.preload)&&(g.state.loading&3)===0&&(L.count++,g=hM.bind(L),d.addEventListener("load",g),d.addEventListener("error",g))}}function CRe(){if(gb===null)throw Error(i(475));var d=gb;return d.stylesheets&&d.count===0&&mL(d,d.stylesheets),0<d.count?function(g){var x=setTimeout(function(){if(d.stylesheets&&mL(d,d.stylesheets),d.unsuspend){var L=d.unsuspend;d.unsuspend=null,L()}},6e4);return d.unsuspend=g,function(){d.unsuspend=null,clearTimeout(x)}}:null}function hM(){if(this.count--,this.count===0){if(this.stylesheets)mL(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var pM=null;function mL(d,g){d.stylesheets=null,d.unsuspend!==null&&(d.count++,pM=new Map,g.forEach(IRe,d),pM=null,hM.call(d))}function IRe(d,g){if(!(g.state.loading&4)){var x=pM.get(d);if(x)var L=x.get(null);else{x=new Map,pM.set(d,x);for(var G=d.querySelectorAll("link[data-precedence],style[data-precedence]"),X=0;X<G.length;X++){var ye=G[X];(ye.nodeName==="LINK"||ye.getAttribute("media")!=="not all")&&(x.set(ye.dataset.precedence,ye),L=ye)}L&&x.set(null,L)}G=g.instance,ye=G.getAttribute("data-precedence"),X=x.get(ye)||L,X===L&&x.set(null,G),x.set(ye,G),this.count++,L=hM.bind(this),G.addEventListener("load",L),G.addEventListener("error",L),X?X.parentNode.insertBefore(G,X.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(G,d.firstChild)),g.state.loading|=4}}var yb={$$typeof:C,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function TRe(d,g,x,L,G,X,ye,De){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.hiddenUpdates=Oe(null),this.identifierPrefix=L,this.onUncaughtError=G,this.onCaughtError=X,this.onRecoverableError=ye,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function iH(d,g,x,L,G,X,ye,De,Ke,Ct,Xt,tr){return d=new TRe(d,g,x,ye,De,Ke,Ct,tr),g=1,X===!0&&(g|=24),X=vl(3,null,null,g),d.current=X,X.stateNode=d,g=hr(),g.refCount++,d.pooledCache=g,g.refCount++,X.memoizedState={element:L,isDehydrated:x,cache:g},e4(X),d}function nH(d){return d?(d=Rs,d):Rs}function aH(d,g,x,L,G,X){G=nH(G),L.context===null?L.context=G:L.pendingContext=G,L=Nf(g),L.payload={element:x},X=X===void 0?null:X,X!==null&&(L.callback=X),x=Ff(d,L,g),x!==null&&(ic(x,d,g),Wx(x,d,g))}function oH(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var x=d.retryLane;d.retryLane=x!==0&&x<g?x:g}}function gL(d,g){oH(d,g),(d=d.alternate)&&oH(d,g)}function sH(d){if(d.tag===13){var g=xs(d,67108864);g!==null&&ic(g,d,67108864),gL(d,67108864)}}var dM=!0;function PRe(d,g,x,L){var G=Y.T;Y.T=null;var X=he.p;try{he.p=2,yL(d,g,x,L)}finally{he.p=X,Y.T=G}}function LRe(d,g,x,L){var G=Y.T;Y.T=null;var X=he.p;try{he.p=8,yL(d,g,x,L)}finally{he.p=X,Y.T=G}}function yL(d,g,x,L){if(dM){var G=vL(L);if(G===null)nL(d,g,L,fM,x),uH(d,L);else if(RRe(G,d,g,x,L))L.stopPropagation();else if(uH(d,L),g&4&&-1<DRe.indexOf(d)){for(;G!==null;){var X=Jr(G);if(X!==null)switch(X.tag){case 3:if(X=X.stateNode,X.current.memoizedState.isDehydrated){var ye=ht(X.pendingLanes);if(ye!==0){var De=X;for(De.pendingLanes|=2,De.entangledLanes|=2;ye;){var Ke=1<<31-Kt(ye);De.entanglements[1]|=Ke,ye&=~Ke}dp(X),(na&6)===0&&(KS=We()+500,cb(0))}}break;case 13:De=xs(X,2),De!==null&&ic(De,X,2),QS(),gL(X,2)}if(X=vL(L),X===null&&nL(d,g,L,fM,x),X===G)break;G=X}G!==null&&L.stopPropagation()}else nL(d,g,L,null,x)}}function vL(d){return d=lr(d),_L(d)}var fM=null;function _L(d){if(fM=null,d=ai(d),d!==null){var g=a(d);if(g===null)d=null;else{var x=g.tag;if(x===13){if(d=o(g),d!==null)return d;d=null}else if(x===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null)}}return fM=d,null}function lH(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(at()){case Lt:return 2;case dt:return 8;case Me:case ve:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var xL=!1,Yf=null,Kf=null,Jf=null,vb=new Map,_b=new Map,Qf=[],DRe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uH(d,g){switch(d){case"focusin":case"focusout":Yf=null;break;case"dragenter":case"dragleave":Kf=null;break;case"mouseover":case"mouseout":Jf=null;break;case"pointerover":case"pointerout":vb.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":_b.delete(g.pointerId)}}function xb(d,g,x,L,G,X){return d===null||d.nativeEvent!==X?(d={blockedOn:g,domEventName:x,eventSystemFlags:L,nativeEvent:X,targetContainers:[G]},g!==null&&(g=Jr(g),g!==null&&sH(g)),d):(d.eventSystemFlags|=L,g=d.targetContainers,G!==null&&g.indexOf(G)===-1&&g.push(G),d)}function RRe(d,g,x,L,G){switch(g){case"focusin":return Yf=xb(Yf,d,g,x,L,G),!0;case"dragenter":return Kf=xb(Kf,d,g,x,L,G),!0;case"mouseover":return Jf=xb(Jf,d,g,x,L,G),!0;case"pointerover":var X=G.pointerId;return vb.set(X,xb(vb.get(X)||null,d,g,x,L,G)),!0;case"gotpointercapture":return X=G.pointerId,_b.set(X,xb(_b.get(X)||null,d,g,x,L,G)),!0}return!1}function cH(d){var g=ai(d.target);if(g!==null){var x=a(g);if(x!==null){if(g=x.tag,g===13){if(g=o(x),g!==null){d.blockedOn=g,kt(d.priority,function(){if(x.tag===13){var L=rc();L=Re(L);var G=xs(x,L);G!==null&&ic(G,x,L),gL(x,L)}});return}}else if(g===3&&x.stateNode.current.memoizedState.isDehydrated){d.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}d.blockedOn=null}function mM(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var x=vL(d.nativeEvent);if(x===null){x=d.nativeEvent;var L=new x.constructor(x.type,x);xr=L,x.target.dispatchEvent(L),xr=null}else return g=Jr(x),g!==null&&sH(g),d.blockedOn=x,!1;g.shift()}return!0}function hH(d,g,x){mM(d)&&x.delete(g)}function ORe(){xL=!1,Yf!==null&&mM(Yf)&&(Yf=null),Kf!==null&&mM(Kf)&&(Kf=null),Jf!==null&&mM(Jf)&&(Jf=null),vb.forEach(hH),_b.forEach(hH)}function gM(d,g){d.blockedOn===g&&(d.blockedOn=null,xL||(xL=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ORe)))}var yM=null;function pH(d){yM!==d&&(yM=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){yM===d&&(yM=null);for(var g=0;g<d.length;g+=3){var x=d[g],L=d[g+1],G=d[g+2];if(typeof L!="function"){if(_L(L||x)===null)continue;break}var X=Jr(x);X!==null&&(d.splice(g,3),g-=3,_4(X,{pending:!0,data:G,method:x.method,action:L},L,G))}}))}function bb(d){function g(Ke){return gM(Ke,d)}Yf!==null&&gM(Yf,d),Kf!==null&&gM(Kf,d),Jf!==null&&gM(Jf,d),vb.forEach(g),_b.forEach(g);for(var x=0;x<Qf.length;x++){var L=Qf[x];L.blockedOn===d&&(L.blockedOn=null)}for(;0<Qf.length&&(x=Qf[0],x.blockedOn===null);)cH(x),x.blockedOn===null&&Qf.shift();if(x=(d.ownerDocument||d).$$reactFormReplay,x!=null)for(L=0;L<x.length;L+=3){var G=x[L],X=x[L+1],ye=G[ke]||null;if(typeof X=="function")ye||pH(x);else if(ye){var De=null;if(X&&X.hasAttribute("formAction")){if(G=X,ye=X[ke]||null)De=ye.formAction;else if(_L(G)!==null)continue}else De=ye.action;typeof De=="function"?x[L+1]=De:(x.splice(L,3),L-=3),pH(x)}}}function bL(d){this._internalRoot=d}vM.prototype.render=bL.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(i(409));var x=g.current,L=rc();aH(x,L,d,g,null,null)},vM.prototype.unmount=bL.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;aH(d.current,2,null,d,null,null),QS(),g[$e]=null}};function vM(d){this._internalRoot=d}vM.prototype.unstable_scheduleHydration=function(d){if(d){var g=st();d={blockedOn:null,target:d,priority:g};for(var x=0;x<Qf.length&&g!==0&&g<Qf[x].priority;x++);Qf.splice(x,0,d),x===0&&cH(d)}};var dH=e.version;if(dH!=="19.1.0")throw Error(i(527,dH,"19.1.0"));he.findDOMNode=function(d){var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(i(188)):(d=Object.keys(d).join(","),Error(i(268,d)));return d=u(g),d=d!==null?c(d):null,d=d===null?null:d.stateNode,d};var kRe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _M=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_M.isDisabled&&_M.supportsFiber)try{Et=_M.inject(kRe),pt=_M}catch{}}return Ab.createRoot=function(d,g){if(!n(d))throw Error(i(299));var x=!1,L="",G=T$,X=P$,ye=L$,De=null;return g!=null&&(g.unstable_strictMode===!0&&(x=!0),g.identifierPrefix!==void 0&&(L=g.identifierPrefix),g.onUncaughtError!==void 0&&(G=g.onUncaughtError),g.onCaughtError!==void 0&&(X=g.onCaughtError),g.onRecoverableError!==void 0&&(ye=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(De=g.unstable_transitionCallbacks)),g=iH(d,1,!1,null,null,x,L,G,X,ye,De,null),d[$e]=g.current,iL(d),new bL(g)},Ab.hydrateRoot=function(d,g,x){if(!n(d))throw Error(i(299));var L=!1,G="",X=T$,ye=P$,De=L$,Ke=null,Ct=null;return x!=null&&(x.unstable_strictMode===!0&&(L=!0),x.identifierPrefix!==void 0&&(G=x.identifierPrefix),x.onUncaughtError!==void 0&&(X=x.onUncaughtError),x.onCaughtError!==void 0&&(ye=x.onCaughtError),x.onRecoverableError!==void 0&&(De=x.onRecoverableError),x.unstable_transitionCallbacks!==void 0&&(Ke=x.unstable_transitionCallbacks),x.formState!==void 0&&(Ct=x.formState)),g=iH(d,1,!0,g,x??null,L,G,X,ye,De,Ke,Ct),g.context=nH(null),x=g.current,L=rc(),L=Re(L),G=Nf(L),G.callback=null,Ff(x,G,L),x=L,g.current.lanes=x,se(g,x),dp(g),d[$e]=g.current,iL(d),new vM(g)},Ab.version="19.1.0",Ab}var AH;function HRe(){if(AH)return SL.exports;AH=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),SL.exports=GRe(),SL.exports}var qRe=HRe();const WRe="modulepreload",XRe=function(t){return"/Mappedin-demo/"+t},SH={},ag=function(e,r,i){let n=Promise.resolve();if(r&&r.length>0){let o=function(c){return Promise.all(c.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=o(r.map(c=>{if(c=XRe(c),c in SH)return;SH[c]=!0;const p=c.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":WRe,p||(y.as="script"),y.crossOrigin="",y.href=c,u&&y.setAttribute("nonce",u),document.head.appendChild(y),p)return new Promise((v,w)=>{y.addEventListener("load",v),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};var ZRe=Object.create,MH=Object.freeze,rx=Object.defineProperty,YRe=Object.defineProperties,KRe=Object.getOwnPropertyDescriptor,JRe=Object.getOwnPropertyDescriptors,QRe=Object.getOwnPropertyNames,x3=Object.getOwnPropertySymbols,eOe=Object.getPrototypeOf,x9=Object.prototype.hasOwnProperty,KX=Object.prototype.propertyIsEnumerable,ME=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),b9=t=>{throw TypeError(t)},K6=(t,e,r)=>e in t?rx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ee=(t,e)=>{for(var r in e||(e={}))x9.call(e,r)&&K6(t,r,e[r]);if(x3)for(var r of x3(e))KX.call(e,r)&&K6(t,r,e[r]);return t},vt=(t,e)=>YRe(t,JRe(e)),s=(t,e)=>rx(t,"name",{value:e,configurable:!0}),JX=t=>typeof t=="symbol"?t:t+"",Nh=(t,e)=>{var r={};for(var i in t)x9.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&x3)for(var i of x3(t))e.indexOf(i)<0&&KX.call(t,i)&&(r[i]=t[i]);return r},tOe=(t,e)=>()=>(t&&(e=t(t=0)),e),bt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Nl=(t,e)=>{for(var r in e)rx(t,r,{get:e[r],enumerable:!0})},rOe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of QRe(e))!x9.call(t,n)&&n!==r&&rx(t,n,{get:()=>e[n],enumerable:!(i=KRe(e,n))||i.enumerable});return t},kr=(t,e,r)=>(r=t!=null?ZRe(eOe(t)):{},rOe(e||!t||!t.__esModule?rx(r,"default",{value:t,enumerable:!0}):r,t)),$=(t,e,r)=>K6(t,typeof e!="symbol"?e+"":e,r),w9=(t,e,r)=>e.has(t)||b9("Cannot "+r),b=(t,e,r)=>(w9(t,e,"read from private field"),r?r.call(t):e.get(t)),Be=(t,e,r)=>e.has(t)?b9("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),He=(t,e,r,i)=>(w9(t,e,"write to private field"),e.set(t,r),r),dr=(t,e,r)=>(w9(t,e,"access private method"),r),je=(t,e)=>MH(rx(t,"raw",{value:MH(e||t.slice())})),QX=function(t,e){this[0]=t,this[1]=e},iOe=(t,e,r)=>{var i=(o,l,u,c)=>{try{var p=r[o](l),m=(l=p.value)instanceof QX,y=p.done;Promise.resolve(m?l[0]:l).then(v=>m?i(o==="return"?o:"next",l[1]?{done:v.done,value:v.value}:v,u,c):u({value:v,done:y})).catch(v=>i("throw",v,u,c))}catch(v){c(v)}},n=o=>a[o]=l=>new Promise((u,c)=>i(o,l,u,c)),a={};return r=r.apply(t,e),a[ME("asyncIterator")]=()=>a,n("next"),n("throw"),n("return"),a},vr=t=>{var e=t[ME("asyncIterator")],r=!1,i,n={};return e==null?(e=t[ME("iterator")](),i=a=>n[a]=o=>e[a](o)):(e=e.call(t),i=a=>n[a]=o=>{if(r){if(r=!1,a==="throw")throw o;return o}return r=!0,{done:!1,value:new QX(new Promise(l=>{var u=e[a](o);u instanceof Object||b9("Object expected"),l(u)}),1)}}),n[ME("iterator")]=()=>n,i("next"),"throw"in e?i("throw"):n.throw=a=>{throw a},"return"in e&&i("return"),n},$a,N=tOe(()=>{$a={env:{NODE_ENV:"production",npm_package_version:"6.0.1-beta.48"}}}),Nn=bt((t,e)=>{N(),e.exports=r;function r(i,n){this.x=i,this.y=n}s(r,"Point"),r.prototype={clone:s(function(){return new r(this.x,this.y)},"clone"),add:s(function(i){return this.clone()._add(i)},"add"),sub:s(function(i){return this.clone()._sub(i)},"sub"),multByPoint:s(function(i){return this.clone()._multByPoint(i)},"multByPoint"),divByPoint:s(function(i){return this.clone()._divByPoint(i)},"divByPoint"),mult:s(function(i){return this.clone()._mult(i)},"mult"),div:s(function(i){return this.clone()._div(i)},"div"),rotate:s(function(i){return this.clone()._rotate(i)},"rotate"),rotateAround:s(function(i,n){return this.clone()._rotateAround(i,n)},"rotateAround"),matMult:s(function(i){return this.clone()._matMult(i)},"matMult"),unit:s(function(){return this.clone()._unit()},"unit"),perp:s(function(){return this.clone()._perp()},"perp"),round:s(function(){return this.clone()._round()},"round"),mag:s(function(){return Math.sqrt(this.x*this.x+this.y*this.y)},"mag"),equals:s(function(i){return this.x===i.x&&this.y===i.y},"equals"),dist:s(function(i){return Math.sqrt(this.distSqr(i))},"dist"),distSqr:s(function(i){var n=i.x-this.x,a=i.y-this.y;return n*n+a*a},"distSqr"),angle:s(function(){return Math.atan2(this.y,this.x)},"angle"),angleTo:s(function(i){return Math.atan2(this.y-i.y,this.x-i.x)},"angleTo"),angleWith:s(function(i){return this.angleWithSep(i.x,i.y)},"angleWith"),angleWithSep:s(function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},"angleWithSep"),_matMult:s(function(i){var n=i[0]*this.x+i[1]*this.y,a=i[2]*this.x+i[3]*this.y;return this.x=n,this.y=a,this},"_matMult"),_add:s(function(i){return this.x+=i.x,this.y+=i.y,this},"_add"),_sub:s(function(i){return this.x-=i.x,this.y-=i.y,this},"_sub"),_mult:s(function(i){return this.x*=i,this.y*=i,this},"_mult"),_div:s(function(i){return this.x/=i,this.y/=i,this},"_div"),_multByPoint:s(function(i){return this.x*=i.x,this.y*=i.y,this},"_multByPoint"),_divByPoint:s(function(i){return this.x/=i.x,this.y/=i.y,this},"_divByPoint"),_unit:s(function(){return this._div(this.mag()),this},"_unit"),_perp:s(function(){var i=this.y;return this.y=this.x,this.x=-i,this},"_perp"),_rotate:s(function(i){var n=Math.cos(i),a=Math.sin(i),o=n*this.x-a*this.y,l=a*this.x+n*this.y;return this.x=o,this.y=l,this},"_rotate"),_rotateAround:s(function(i,n){var a=Math.cos(i),o=Math.sin(i),l=n.x+a*(this.x-n.x)-o*(this.y-n.y),u=n.y+o*(this.x-n.x)+a*(this.y-n.y);return this.x=l,this.y=u,this},"_rotateAround"),_round:s(function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},"_round")},r.convert=function(i){return i instanceof r?i:Array.isArray(i)?new r(i[0],i[1]):i}}),nOe=bt((t,e)=>{N(),e.exports=r;function r(i,n,a,o){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(o-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=a,this.p2y=o}s(r,"UnitBezier"),r.prototype={sampleCurveX:s(function(i){return((this.ax*i+this.bx)*i+this.cx)*i},"sampleCurveX"),sampleCurveY:s(function(i){return((this.ay*i+this.by)*i+this.cy)*i},"sampleCurveY"),sampleCurveDerivativeX:s(function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},"sampleCurveDerivativeX"),solveCurveX:s(function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,o=0;o<8;o++){var l=this.sampleCurveX(a)-i;if(Math.abs(l)<n)return a;var u=this.sampleCurveDerivativeX(a);if(Math.abs(u)<1e-6)break;a=a-l/u}var c=0,p=1;for(a=i,o=0;o<20&&(l=this.sampleCurveX(a),!(Math.abs(l-i)<n));o++)i>l?c=a:p=a,a=(p-c)*.5+c;return a},"solveCurveX"),solve:s(function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))},"solve")}}),aOe=bt((t,e)=>{N();function r(i,n){var a,o,l,u,c,p,m,y;for(a=i.length&3,o=i.length-a,l=n,c=3432918353,p=461845907,y=0;y<o;)m=i.charCodeAt(y)&255|(i.charCodeAt(++y)&255)<<8|(i.charCodeAt(++y)&255)<<16|(i.charCodeAt(++y)&255)<<24,++y,m=(m&65535)*c+(((m>>>16)*c&65535)<<16)&4294967295,m=m<<15|m>>>17,m=(m&65535)*p+(((m>>>16)*p&65535)<<16)&4294967295,l^=m,l=l<<13|l>>>19,u=(l&65535)*5+(((l>>>16)*5&65535)<<16)&4294967295,l=(u&65535)+27492+(((u>>>16)+58964&65535)<<16);switch(m=0,a){case 3:m^=(i.charCodeAt(y+2)&255)<<16;case 2:m^=(i.charCodeAt(y+1)&255)<<8;case 1:m^=i.charCodeAt(y)&255,m=(m&65535)*c+(((m>>>16)*c&65535)<<16)&4294967295,m=m<<15|m>>>17,m=(m&65535)*p+(((m>>>16)*p&65535)<<16)&4294967295,l^=m}return l^=i.length,l^=l>>>16,l=(l&65535)*2246822507+(((l>>>16)*2246822507&65535)<<16)&4294967295,l^=l>>>13,l=(l&65535)*3266489909+(((l>>>16)*3266489909&65535)<<16)&4294967295,l^=l>>>16,l>>>0}s(r,"murmurhash3_32_gc"),typeof e<"u"&&(e.exports=r)}),oOe=bt((t,e)=>{N();function r(i,n){for(var a=i.length,o=n^a,l=0,u;a>=4;)u=i.charCodeAt(l)&255|(i.charCodeAt(++l)&255)<<8|(i.charCodeAt(++l)&255)<<16|(i.charCodeAt(++l)&255)<<24,u=(u&65535)*1540483477+(((u>>>16)*1540483477&65535)<<16),u^=u>>>24,u=(u&65535)*1540483477+(((u>>>16)*1540483477&65535)<<16),o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)^u,a-=4,++l;switch(a){case 3:o^=(i.charCodeAt(l+2)&255)<<16;case 2:o^=(i.charCodeAt(l+1)&255)<<8;case 1:o^=i.charCodeAt(l)&255,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)}return o^=o>>>13,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>15,o>>>0}s(r,"murmurhash2_32_gc"),typeof e!==void 0&&(e.exports=r)}),eZ=bt((t,e)=>{N();var r=aOe(),i=oOe();e.exports=r,e.exports.murmur3=r,e.exports.murmur2=i}),A9=bt((t,e)=>{N(),e.exports=r,e.exports.default=r;function r(Q,ae,ee){ee=ee||2;var le=ae&&ae.length,K=le?ae[0]*ee:Q.length,ce=i(Q,0,K,ee,!0),te=[];if(!ce||ce.next===ce.prev)return te;var ne,pe,xe,Te,fe,Pe,me;if(le&&(ce=p(Q,ae,ce,ee)),Q.length>80*ee){ne=xe=Q[0],pe=Te=Q[1];for(var Ae=ee;Ae<K;Ae+=ee)fe=Q[Ae],Pe=Q[Ae+1],fe<ne&&(ne=fe),Pe<pe&&(pe=Pe),fe>xe&&(xe=fe),Pe>Te&&(Te=Pe);me=Math.max(xe-ne,Te-pe),me=me!==0?32767/me:0}return a(ce,te,ee,ne,pe,me,0),te}s(r,"earcut");function i(Q,ae,ee,le,K){var ce,te;if(K===he(Q,ae,ee,le)>0)for(ce=ae;ce<ee;ce+=le)te=V(ce,Q[ce],Q[ce+1],te);else for(ce=ee-le;ce>=ae;ce-=le)te=V(ce,Q[ce],Q[ce+1],te);return te&&F(te,te.next)&&(oe(te),te=te.next),te}s(i,"linkedList");function n(Q,ae){if(!Q)return Q;ae||(ae=Q);var ee=Q,le;do if(le=!1,!ee.steiner&&(F(ee,ee.next)||O(ee.prev,ee,ee.next)===0)){if(oe(ee),ee=ae=ee.prev,ee===ee.next)break;le=!0}else ee=ee.next;while(le||ee!==ae);return ae}s(n,"filterPoints");function a(Q,ae,ee,le,K,ce,te){if(Q){!te&&ce&&E(Q,le,K,ce);for(var ne=Q,pe,xe;Q.prev!==Q.next;){if(pe=Q.prev,xe=Q.next,ce?l(Q,le,K,ce):o(Q)){ae.push(pe.i/ee|0),ae.push(Q.i/ee|0),ae.push(xe.i/ee|0),oe(Q),Q=xe.next,ne=xe.next;continue}if(Q=xe,Q===ne){te?te===1?(Q=u(n(Q),ae,ee),a(Q,ae,ee,le,K,ce,2)):te===2&&c(Q,ae,ee,le,K,ce):a(n(Q),ae,ee,le,K,ce,1);break}}}}s(a,"earcutLinked");function o(Q){var ae=Q.prev,ee=Q,le=Q.next;if(O(ae,ee,le)>=0)return!1;for(var K=ae.x,ce=ee.x,te=le.x,ne=ae.y,pe=ee.y,xe=le.y,Te=K<ce?K<te?K:te:ce<te?ce:te,fe=ne<pe?ne<xe?ne:xe:pe<xe?pe:xe,Pe=K>ce?K>te?K:te:ce>te?ce:te,me=ne>pe?ne>xe?ne:xe:pe>xe?pe:xe,Ae=le.next;Ae!==ae;){if(Ae.x>=Te&&Ae.x<=Pe&&Ae.y>=fe&&Ae.y<=me&&C(K,ne,ce,pe,te,xe,Ae.x,Ae.y)&&O(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.next}return!0}s(o,"isEar");function l(Q,ae,ee,le){var K=Q.prev,ce=Q,te=Q.next;if(O(K,ce,te)>=0)return!1;for(var ne=K.x,pe=ce.x,xe=te.x,Te=K.y,fe=ce.y,Pe=te.y,me=ne<pe?ne<xe?ne:xe:pe<xe?pe:xe,Ae=Te<fe?Te<Pe?Te:Pe:fe<Pe?fe:Pe,Ue=ne>pe?ne>xe?ne:xe:pe>xe?pe:xe,_e=Te>fe?Te>Pe?Te:Pe:fe>Pe?fe:Pe,lt=I(me,Ae,ae,ee,le),tt=I(Ue,_e,ae,ee,le),We=Q.prevZ,at=Q.nextZ;We&&We.z>=lt&&at&&at.z<=tt;){if(We.x>=me&&We.x<=Ue&&We.y>=Ae&&We.y<=_e&&We!==K&&We!==te&&C(ne,Te,pe,fe,xe,Pe,We.x,We.y)&&O(We.prev,We,We.next)>=0||(We=We.prevZ,at.x>=me&&at.x<=Ue&&at.y>=Ae&&at.y<=_e&&at!==K&&at!==te&&C(ne,Te,pe,fe,xe,Pe,at.x,at.y)&&O(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;We&&We.z>=lt;){if(We.x>=me&&We.x<=Ue&&We.y>=Ae&&We.y<=_e&&We!==K&&We!==te&&C(ne,Te,pe,fe,xe,Pe,We.x,We.y)&&O(We.prev,We,We.next)>=0)return!1;We=We.prevZ}for(;at&&at.z<=tt;){if(at.x>=me&&at.x<=Ue&&at.y>=Ae&&at.y<=_e&&at!==K&&at!==te&&C(ne,Te,pe,fe,xe,Pe,at.x,at.y)&&O(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}s(l,"isEarHashed");function u(Q,ae,ee){var le=Q;do{var K=le.prev,ce=le.next.next;!F(K,ce)&&k(K,le,le.next,ce)&&q(K,ce)&&q(ce,K)&&(ae.push(K.i/ee|0),ae.push(le.i/ee|0),ae.push(ce.i/ee|0),oe(le),oe(le.next),le=Q=ce),le=le.next}while(le!==Q);return n(le)}s(u,"cureLocalIntersections");function c(Q,ae,ee,le,K,ce){var te=Q;do{for(var ne=te.next.next;ne!==te.prev;){if(te.i!==ne.i&&T(te,ne)){var pe=J(te,ne);te=n(te,te.next),pe=n(pe,pe.next),a(te,ae,ee,le,K,ce,0),a(pe,ae,ee,le,K,ce,0);return}ne=ne.next}te=te.next}while(te!==Q)}s(c,"splitEarcut");function p(Q,ae,ee,le){var K=[],ce,te,ne,pe,xe;for(ce=0,te=ae.length;ce<te;ce++)ne=ae[ce]*le,pe=ce<te-1?ae[ce+1]*le:Q.length,xe=i(Q,ne,pe,le,!1),xe===xe.next&&(xe.steiner=!0),K.push(P(xe));for(K.sort(m),ce=0;ce<K.length;ce++)ee=y(K[ce],ee);return ee}s(p,"eliminateHoles");function m(Q,ae){return Q.x-ae.x}s(m,"compareX");function y(Q,ae){var ee=v(Q,ae);if(!ee)return ae;var le=J(ee,Q);return n(le,le.next),n(ee,ee.next)}s(y,"eliminateHole");function v(Q,ae){var ee=ae,le=Q.x,K=Q.y,ce=-1/0,te;do{if(K<=ee.y&&K>=ee.next.y&&ee.next.y!==ee.y){var ne=ee.x+(K-ee.y)*(ee.next.x-ee.x)/(ee.next.y-ee.y);if(ne<=le&&ne>ce&&(ce=ne,te=ee.x<ee.next.x?ee:ee.next,ne===le))return te}ee=ee.next}while(ee!==ae);if(!te)return null;var pe=te,xe=te.x,Te=te.y,fe=1/0,Pe;ee=te;do le>=ee.x&&ee.x>=xe&&le!==ee.x&&C(K<Te?le:ce,K,xe,Te,K<Te?ce:le,K,ee.x,ee.y)&&(Pe=Math.abs(K-ee.y)/(le-ee.x),q(ee,Q)&&(Pe<fe||Pe===fe&&(ee.x>te.x||ee.x===te.x&&w(te,ee)))&&(te=ee,fe=Pe)),ee=ee.next;while(ee!==pe);return te}s(v,"findHoleBridge");function w(Q,ae){return O(Q.prev,Q,ae.prev)<0&&O(ae.next,Q,Q.next)<0}s(w,"sectorContainsSector");function E(Q,ae,ee,le){var K=Q;do K.z===0&&(K.z=I(K.x,K.y,ae,ee,le)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==Q);K.prevZ.nextZ=null,K.prevZ=null,M(K)}s(E,"indexCurve");function M(Q){var ae,ee,le,K,ce,te,ne,pe,xe=1;do{for(ee=Q,Q=null,ce=null,te=0;ee;){for(te++,le=ee,ne=0,ae=0;ae<xe&&(ne++,le=le.nextZ,!!le);ae++);for(pe=xe;ne>0||pe>0&&le;)ne!==0&&(pe===0||!le||ee.z<=le.z)?(K=ee,ee=ee.nextZ,ne--):(K=le,le=le.nextZ,pe--),ce?ce.nextZ=K:Q=K,K.prevZ=ce,ce=K;ee=le}ce.nextZ=null,xe*=2}while(te>1);return Q}s(M,"sortLinked");function I(Q,ae,ee,le,K){return Q=(Q-ee)*K|0,ae=(ae-le)*K|0,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,ae=(ae|ae<<8)&16711935,ae=(ae|ae<<4)&252645135,ae=(ae|ae<<2)&858993459,ae=(ae|ae<<1)&1431655765,Q|ae<<1}s(I,"zOrder");function P(Q){var ae=Q,ee=Q;do(ae.x<ee.x||ae.x===ee.x&&ae.y<ee.y)&&(ee=ae),ae=ae.next;while(ae!==Q);return ee}s(P,"getLeftmost");function C(Q,ae,ee,le,K,ce,te,ne){return(K-te)*(ae-ne)>=(Q-te)*(ce-ne)&&(Q-te)*(le-ne)>=(ee-te)*(ae-ne)&&(ee-te)*(ce-ne)>=(K-te)*(le-ne)}s(C,"pointInTriangle");function T(Q,ae){return Q.next.i!==ae.i&&Q.prev.i!==ae.i&&!z(Q,ae)&&(q(Q,ae)&&q(ae,Q)&&W(Q,ae)&&(O(Q.prev,Q,ae.prev)||O(Q,ae.prev,ae))||F(Q,ae)&&O(Q.prev,Q,Q.next)>0&&O(ae.prev,ae,ae.next)>0)}s(T,"isValidDiagonal");function O(Q,ae,ee){return(ae.y-Q.y)*(ee.x-ae.x)-(ae.x-Q.x)*(ee.y-ae.y)}s(O,"area");function F(Q,ae){return Q.x===ae.x&&Q.y===ae.y}s(F,"equals");function k(Q,ae,ee,le){var K=U(O(Q,ae,ee)),ce=U(O(Q,ae,le)),te=U(O(ee,le,Q)),ne=U(O(ee,le,ae));return!!(K!==ce&&te!==ne||K===0&&B(Q,ee,ae)||ce===0&&B(Q,le,ae)||te===0&&B(ee,Q,le)||ne===0&&B(ee,ae,le))}s(k,"intersects");function B(Q,ae,ee){return ae.x<=Math.max(Q.x,ee.x)&&ae.x>=Math.min(Q.x,ee.x)&&ae.y<=Math.max(Q.y,ee.y)&&ae.y>=Math.min(Q.y,ee.y)}s(B,"onSegment");function U(Q){return Q>0?1:Q<0?-1:0}s(U,"sign");function z(Q,ae){var ee=Q;do{if(ee.i!==Q.i&&ee.next.i!==Q.i&&ee.i!==ae.i&&ee.next.i!==ae.i&&k(ee,ee.next,Q,ae))return!0;ee=ee.next}while(ee!==Q);return!1}s(z,"intersectsPolygon");function q(Q,ae){return O(Q.prev,Q,Q.next)<0?O(Q,ae,Q.next)>=0&&O(Q,Q.prev,ae)>=0:O(Q,ae,Q.prev)<0||O(Q,Q.next,ae)<0}s(q,"locallyInside");function W(Q,ae){var ee=Q,le=!1,K=(Q.x+ae.x)/2,ce=(Q.y+ae.y)/2;do ee.y>ce!=ee.next.y>ce&&ee.next.y!==ee.y&&K<(ee.next.x-ee.x)*(ce-ee.y)/(ee.next.y-ee.y)+ee.x&&(le=!le),ee=ee.next;while(ee!==Q);return le}s(W,"middleInside");function J(Q,ae){var ee=new Y(Q.i,Q.x,Q.y),le=new Y(ae.i,ae.x,ae.y),K=Q.next,ce=ae.prev;return Q.next=ae,ae.prev=Q,ee.next=K,K.prev=ee,le.next=ee,ee.prev=le,ce.next=le,le.prev=ce,le}s(J,"splitPolygon");function V(Q,ae,ee,le){var K=new Y(Q,ae,ee);return le?(K.next=le.next,K.prev=le,le.next.prev=K,le.next=K):(K.prev=K,K.next=K),K}s(V,"insertNode");function oe(Q){Q.next.prev=Q.prev,Q.prev.next=Q.next,Q.prevZ&&(Q.prevZ.nextZ=Q.nextZ),Q.nextZ&&(Q.nextZ.prevZ=Q.prevZ)}s(oe,"removeNode");function Y(Q,ae,ee){this.i=Q,this.x=ae,this.y=ee,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}s(Y,"Node"),r.deviation=function(Q,ae,ee,le){var K=ae&&ae.length,ce=K?ae[0]*ee:Q.length,te=Math.abs(he(Q,0,ce,ee));if(K)for(var ne=0,pe=ae.length;ne<pe;ne++){var xe=ae[ne]*ee,Te=ne<pe-1?ae[ne+1]*ee:Q.length;te-=Math.abs(he(Q,xe,Te,ee))}var fe=0;for(ne=0;ne<le.length;ne+=3){var Pe=le[ne]*ee,me=le[ne+1]*ee,Ae=le[ne+2]*ee;fe+=Math.abs((Q[Pe]-Q[Ae])*(Q[me+1]-Q[Pe+1])-(Q[Pe]-Q[me])*(Q[Ae+1]-Q[Pe+1]))}return te===0&&fe===0?0:Math.abs((fe-te)/te)};function he(Q,ae,ee,le){for(var K=0,ce=ae,te=ee-le;ce<ee;ce+=le)K+=(Q[te]-Q[ce])*(Q[ce+1]+Q[te+1]),te=ce;return K}s(he,"signedArea"),r.flatten=function(Q){for(var ae=Q[0][0].length,ee={vertices:[],holes:[],dimensions:ae},le=0,K=0;K<Q.length;K++){for(var ce=0;ce<Q[K].length;ce++)for(var te=0;te<ae;te++)ee.vertices.push(Q[K][ce][te]);K>0&&(le+=Q[K-1].length,ee.holes.push(le))}return ee}}),tZ=bt((t,e)=>{N();var r=Nn();e.exports=i;function i(u,c,p,m,y){this.properties={},this.extent=p,this.type=0,this._pbf=u,this._geometry=-1,this._keys=m,this._values=y,u.readFields(n,this,c)}s(i,"VectorTileFeature");function n(u,c,p){u==1?c.id=p.readVarint():u==2?a(p,c):u==3?c.type=p.readVarint():u==4&&(c._geometry=p.pos)}s(n,"readFeature");function a(u,c){for(var p=u.readVarint()+u.pos;u.pos<p;){var m=c._keys[u.readVarint()],y=c._values[u.readVarint()];c.properties[m]=y}}s(a,"readTag"),i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,p=1,m=0,y=0,v=0,w=[],E;u.pos<c;){if(m<=0){var M=u.readVarint();p=M&7,m=M>>3}if(m--,p===1||p===2)y+=u.readSVarint(),v+=u.readSVarint(),p===1&&(E&&w.push(E),E=[]),E.push(new r(y,v));else if(p===7)E&&E.push(E[0].clone());else throw new Error("unknown command "+p)}return E&&w.push(E),w},i.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,p=1,m=0,y=0,v=0,w=1/0,E=-1/0,M=1/0,I=-1/0;u.pos<c;){if(m<=0){var P=u.readVarint();p=P&7,m=P>>3}if(m--,p===1||p===2)y+=u.readSVarint(),v+=u.readSVarint(),y<w&&(w=y),y>E&&(E=y),v<M&&(M=v),v>I&&(I=v);else if(p!==7)throw new Error("unknown command "+p)}return[w,M,E,I]},i.prototype.toGeoJSON=function(u,c,p){var m=this.extent*Math.pow(2,p),y=this.extent*u,v=this.extent*c,w=this.loadGeometry(),E=i.types[this.type],M,I;function P(O){for(var F=0;F<O.length;F++){var k=O[F],B=180-(k.y+v)*360/m;O[F]=[(k.x+y)*360/m-180,360/Math.PI*Math.atan(Math.exp(B*Math.PI/180))-90]}}switch(s(P,"project"),this.type){case 1:var C=[];for(M=0;M<w.length;M++)C[M]=w[M][0];w=C,P(w);break;case 2:for(M=0;M<w.length;M++)P(w[M]);break;case 3:for(w=o(w),M=0;M<w.length;M++)for(I=0;I<w[M].length;I++)P(w[M][I]);break}w.length===1?w=w[0]:E="Multi"+E;var T={type:"Feature",geometry:{type:E,coordinates:w},properties:this.properties};return"id"in this&&(T.id=this.id),T};function o(u){var c=u.length;if(c<=1)return[u];for(var p=[],m,y,v=0;v<c;v++){var w=l(u[v]);w!==0&&(y===void 0&&(y=w<0),y===w<0?(m&&p.push(m),m=[u[v]]):m.push(u[v]))}return m&&p.push(m),p}s(o,"classifyRings");function l(u){for(var c=0,p=0,m=u.length,y=m-1,v,w;p<m;y=p++)v=u[p],w=u[y],c+=(w.x-v.x)*(v.y+w.y);return c}s(l,"signedArea")}),rZ=bt((t,e)=>{N();var r=tZ();e.exports=i;function i(o,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,l),this.length=this._features.length}s(i,"VectorTileLayer");function n(o,l,u){o===15?l.version=u.readVarint():o===1?l.name=u.readString():o===5?l.extent=u.readVarint():o===2?l._features.push(u.pos):o===3?l._keys.push(u.readString()):o===4&&l._values.push(a(u))}s(n,"readLayer");function a(o){for(var l=null,u=o.readVarint()+o.pos;o.pos<u;){var c=o.readVarint()>>3;l=c===1?o.readString():c===2?o.readFloat():c===3?o.readDouble():c===4?o.readVarint64():c===5?o.readVarint():c===6?o.readSVarint():c===7?o.readBoolean():null}return l}s(a,"readValueMessage"),i.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var l=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,l,this.extent,this._keys,this._values)}}),sOe=bt((t,e)=>{N();var r=rZ();e.exports=i;function i(a,o){this.layers=a.readFields(n,{},o)}s(i,"VectorTile");function n(a,o,l){if(a===3){var u=new r(l,l.readVarint()+l.pos);u.length&&(o[u.name]=u)}}s(n,"readTile")}),WT=bt((t,e)=>{N(),e.exports.VectorTile=sOe(),e.exports.VectorTileFeature=tZ(),e.exports.VectorTileLayer=rZ()}),lOe=bt(t=>{N(),t.read=function(e,r,i,n,a){var o,l,u=a*8-n-1,c=(1<<u)-1,p=c>>1,m=-7,y=i?a-1:0,v=i?-1:1,w=e[r+y];for(y+=v,o=w&(1<<-m)-1,w>>=-m,m+=u;m>0;o=o*256+e[r+y],y+=v,m-=8);for(l=o&(1<<-m)-1,o>>=-m,m+=n;m>0;l=l*256+e[r+y],y+=v,m-=8);if(o===0)o=1-p;else{if(o===c)return l?NaN:(w?-1:1)*(1/0);l=l+Math.pow(2,n),o=o-p}return(w?-1:1)*l*Math.pow(2,o-n)},t.write=function(e,r,i,n,a,o){var l,u,c,p=o*8-a-1,m=(1<<p)-1,y=m>>1,v=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:o-1,E=n?1:-1,M=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(u=isNaN(r)?1:0,l=m):(l=Math.floor(Math.log(r)/Math.LN2),r*(c=Math.pow(2,-l))<1&&(l--,c*=2),l+y>=1?r+=v/c:r+=v*Math.pow(2,1-y),r*c>=2&&(l++,c/=2),l+y>=m?(u=0,l=m):l+y>=1?(u=(r*c-1)*Math.pow(2,a),l=l+y):(u=r*Math.pow(2,y-1)*Math.pow(2,a),l=0));a>=8;e[i+w]=u&255,w+=E,u/=256,a-=8);for(l=l<<a|u,p+=a;p>0;e[i+w]=l&255,w+=E,l/=256,p-=8);e[i+w-E]|=M*128}}),iZ=bt((t,e)=>{N(),e.exports=i;var r=lOe();function i(V){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(V)?V:new Uint8Array(V||0),this.pos=0,this.type=0,this.length=this.buf.length}s(i,"Pbf"),i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var n=65536*65536,a=1/n,o=12,l=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");i.prototype={destroy:s(function(){this.buf=null},"destroy"),readFields:s(function(V,oe,Y){for(Y=Y||this.length;this.pos<Y;){var he=this.readVarint(),Q=he>>3,ae=this.pos;this.type=he&7,V(Q,oe,this),this.pos===ae&&this.skip(he)}return oe},"readFields"),readMessage:s(function(V,oe){return this.readFields(V,oe,this.readVarint()+this.pos)},"readMessage"),readFixed32:s(function(){var V=B(this.buf,this.pos);return this.pos+=4,V},"readFixed32"),readSFixed32:s(function(){var V=z(this.buf,this.pos);return this.pos+=4,V},"readSFixed32"),readFixed64:s(function(){var V=B(this.buf,this.pos)+B(this.buf,this.pos+4)*n;return this.pos+=8,V},"readFixed64"),readSFixed64:s(function(){var V=B(this.buf,this.pos)+z(this.buf,this.pos+4)*n;return this.pos+=8,V},"readSFixed64"),readFloat:s(function(){var V=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,V},"readFloat"),readDouble:s(function(){var V=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,V},"readDouble"),readVarint:s(function(V){var oe=this.buf,Y,he;return he=oe[this.pos++],Y=he&127,he<128||(he=oe[this.pos++],Y|=(he&127)<<7,he<128)||(he=oe[this.pos++],Y|=(he&127)<<14,he<128)||(he=oe[this.pos++],Y|=(he&127)<<21,he<128)?Y:(he=oe[this.pos],Y|=(he&15)<<28,u(Y,V,this))},"readVarint"),readVarint64:s(function(){return this.readVarint(!0)},"readVarint64"),readSVarint:s(function(){var V=this.readVarint();return V%2===1?(V+1)/-2:V/2},"readSVarint"),readBoolean:s(function(){return!!this.readVarint()},"readBoolean"),readString:s(function(){var V=this.readVarint()+this.pos,oe=this.pos;return this.pos=V,V-oe>=o&&l?W(this.buf,oe,V):q(this.buf,oe,V)},"readString"),readBytes:s(function(){var V=this.readVarint()+this.pos,oe=this.buf.subarray(this.pos,V);return this.pos=V,oe},"readBytes"),readPackedVarint:s(function(V,oe){if(this.type!==i.Bytes)return V.push(this.readVarint(oe));var Y=c(this);for(V=V||[];this.pos<Y;)V.push(this.readVarint(oe));return V},"readPackedVarint"),readPackedSVarint:s(function(V){if(this.type!==i.Bytes)return V.push(this.readSVarint());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readSVarint());return V},"readPackedSVarint"),readPackedBoolean:s(function(V){if(this.type!==i.Bytes)return V.push(this.readBoolean());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readBoolean());return V},"readPackedBoolean"),readPackedFloat:s(function(V){if(this.type!==i.Bytes)return V.push(this.readFloat());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readFloat());return V},"readPackedFloat"),readPackedDouble:s(function(V){if(this.type!==i.Bytes)return V.push(this.readDouble());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readDouble());return V},"readPackedDouble"),readPackedFixed32:s(function(V){if(this.type!==i.Bytes)return V.push(this.readFixed32());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readFixed32());return V},"readPackedFixed32"),readPackedSFixed32:s(function(V){if(this.type!==i.Bytes)return V.push(this.readSFixed32());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readSFixed32());return V},"readPackedSFixed32"),readPackedFixed64:s(function(V){if(this.type!==i.Bytes)return V.push(this.readFixed64());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readFixed64());return V},"readPackedFixed64"),readPackedSFixed64:s(function(V){if(this.type!==i.Bytes)return V.push(this.readSFixed64());var oe=c(this);for(V=V||[];this.pos<oe;)V.push(this.readSFixed64());return V},"readPackedSFixed64"),skip:s(function(V){var oe=V&7;if(oe===i.Varint)for(;this.buf[this.pos++]>127;);else if(oe===i.Bytes)this.pos=this.readVarint()+this.pos;else if(oe===i.Fixed32)this.pos+=4;else if(oe===i.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+oe)},"skip"),writeTag:s(function(V,oe){this.writeVarint(V<<3|oe)},"writeTag"),realloc:s(function(V){for(var oe=this.length||16;oe<this.pos+V;)oe*=2;if(oe!==this.length){var Y=new Uint8Array(oe);Y.set(this.buf),this.buf=Y,this.length=oe}},"realloc"),finish:s(function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},"finish"),writeFixed32:s(function(V){this.realloc(4),U(this.buf,V,this.pos),this.pos+=4},"writeFixed32"),writeSFixed32:s(function(V){this.realloc(4),U(this.buf,V,this.pos),this.pos+=4},"writeSFixed32"),writeFixed64:s(function(V){this.realloc(8),U(this.buf,V&-1,this.pos),U(this.buf,Math.floor(V*a),this.pos+4),this.pos+=8},"writeFixed64"),writeSFixed64:s(function(V){this.realloc(8),U(this.buf,V&-1,this.pos),U(this.buf,Math.floor(V*a),this.pos+4),this.pos+=8},"writeSFixed64"),writeVarint:s(function(V){if(V=+V||0,V>268435455||V<0){m(V,this);return}this.realloc(4),this.buf[this.pos++]=V&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=(V>>>=7)&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=(V>>>=7)&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=V>>>7&127)))},"writeVarint"),writeSVarint:s(function(V){this.writeVarint(V<0?-V*2-1:V*2)},"writeSVarint"),writeBoolean:s(function(V){this.writeVarint(!!V)},"writeBoolean"),writeString:s(function(V){V=String(V),this.realloc(V.length*4),this.pos++;var oe=this.pos;this.pos=J(this.buf,V,this.pos);var Y=this.pos-oe;Y>=128&&w(oe,Y,this),this.pos=oe-1,this.writeVarint(Y),this.pos+=Y},"writeString"),writeFloat:s(function(V){this.realloc(4),r.write(this.buf,V,this.pos,!0,23,4),this.pos+=4},"writeFloat"),writeDouble:s(function(V){this.realloc(8),r.write(this.buf,V,this.pos,!0,52,8),this.pos+=8},"writeDouble"),writeBytes:s(function(V){var oe=V.length;this.writeVarint(oe),this.realloc(oe);for(var Y=0;Y<oe;Y++)this.buf[this.pos++]=V[Y]},"writeBytes"),writeRawMessage:s(function(V,oe){this.pos++;var Y=this.pos;V(oe,this);var he=this.pos-Y;he>=128&&w(Y,he,this),this.pos=Y-1,this.writeVarint(he),this.pos+=he},"writeRawMessage"),writeMessage:s(function(V,oe,Y){this.writeTag(V,i.Bytes),this.writeRawMessage(oe,Y)},"writeMessage"),writePackedVarint:s(function(V,oe){oe.length&&this.writeMessage(V,E,oe)},"writePackedVarint"),writePackedSVarint:s(function(V,oe){oe.length&&this.writeMessage(V,M,oe)},"writePackedSVarint"),writePackedBoolean:s(function(V,oe){oe.length&&this.writeMessage(V,C,oe)},"writePackedBoolean"),writePackedFloat:s(function(V,oe){oe.length&&this.writeMessage(V,I,oe)},"writePackedFloat"),writePackedDouble:s(function(V,oe){oe.length&&this.writeMessage(V,P,oe)},"writePackedDouble"),writePackedFixed32:s(function(V,oe){oe.length&&this.writeMessage(V,T,oe)},"writePackedFixed32"),writePackedSFixed32:s(function(V,oe){oe.length&&this.writeMessage(V,O,oe)},"writePackedSFixed32"),writePackedFixed64:s(function(V,oe){oe.length&&this.writeMessage(V,F,oe)},"writePackedFixed64"),writePackedSFixed64:s(function(V,oe){oe.length&&this.writeMessage(V,k,oe)},"writePackedSFixed64"),writeBytesField:s(function(V,oe){this.writeTag(V,i.Bytes),this.writeBytes(oe)},"writeBytesField"),writeFixed32Field:s(function(V,oe){this.writeTag(V,i.Fixed32),this.writeFixed32(oe)},"writeFixed32Field"),writeSFixed32Field:s(function(V,oe){this.writeTag(V,i.Fixed32),this.writeSFixed32(oe)},"writeSFixed32Field"),writeFixed64Field:s(function(V,oe){this.writeTag(V,i.Fixed64),this.writeFixed64(oe)},"writeFixed64Field"),writeSFixed64Field:s(function(V,oe){this.writeTag(V,i.Fixed64),this.writeSFixed64(oe)},"writeSFixed64Field"),writeVarintField:s(function(V,oe){this.writeTag(V,i.Varint),this.writeVarint(oe)},"writeVarintField"),writeSVarintField:s(function(V,oe){this.writeTag(V,i.Varint),this.writeSVarint(oe)},"writeSVarintField"),writeStringField:s(function(V,oe){this.writeTag(V,i.Bytes),this.writeString(oe)},"writeStringField"),writeFloatField:s(function(V,oe){this.writeTag(V,i.Fixed32),this.writeFloat(oe)},"writeFloatField"),writeDoubleField:s(function(V,oe){this.writeTag(V,i.Fixed64),this.writeDouble(oe)},"writeDoubleField"),writeBooleanField:s(function(V,oe){this.writeVarintField(V,!!oe)},"writeBooleanField")};function u(V,oe,Y){var he=Y.buf,Q,ae;if(ae=he[Y.pos++],Q=(ae&112)>>4,ae<128||(ae=he[Y.pos++],Q|=(ae&127)<<3,ae<128)||(ae=he[Y.pos++],Q|=(ae&127)<<10,ae<128)||(ae=he[Y.pos++],Q|=(ae&127)<<17,ae<128)||(ae=he[Y.pos++],Q|=(ae&127)<<24,ae<128)||(ae=he[Y.pos++],Q|=(ae&1)<<31,ae<128))return p(V,Q,oe);throw new Error("Expected varint not more than 10 bytes")}s(u,"readVarintRemainder");function c(V){return V.type===i.Bytes?V.readVarint()+V.pos:V.pos+1}s(c,"readPackedEnd");function p(V,oe,Y){return Y?oe*4294967296+(V>>>0):(oe>>>0)*4294967296+(V>>>0)}s(p,"toNum");function m(V,oe){var Y,he;if(V>=0?(Y=V%4294967296|0,he=V/4294967296|0):(Y=~(-V%4294967296),he=~(-V/4294967296),Y^4294967295?Y=Y+1|0:(Y=0,he=he+1|0)),V>=18446744073709552e3||V<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");oe.realloc(10),y(Y,he,oe),v(he,oe)}s(m,"writeBigVarint");function y(V,oe,Y){Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos]=V&127}s(y,"writeBigVarintLow");function v(V,oe){var Y=(V&7)<<4;oe.buf[oe.pos++]|=Y|((V>>>=3)?128:0),V&&(oe.buf[oe.pos++]=V&127|((V>>>=7)?128:0),V&&(oe.buf[oe.pos++]=V&127|((V>>>=7)?128:0),V&&(oe.buf[oe.pos++]=V&127|((V>>>=7)?128:0),V&&(oe.buf[oe.pos++]=V&127|((V>>>=7)?128:0),V&&(oe.buf[oe.pos++]=V&127)))))}s(v,"writeBigVarintHigh");function w(V,oe,Y){var he=oe<=16383?1:oe<=2097151?2:oe<=268435455?3:Math.floor(Math.log(oe)/(Math.LN2*7));Y.realloc(he);for(var Q=Y.pos-1;Q>=V;Q--)Y.buf[Q+he]=Y.buf[Q]}s(w,"makeRoomForExtraLength");function E(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeVarint(V[Y])}s(E,"writePackedVarint");function M(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeSVarint(V[Y])}s(M,"writePackedSVarint");function I(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeFloat(V[Y])}s(I,"writePackedFloat");function P(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeDouble(V[Y])}s(P,"writePackedDouble");function C(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeBoolean(V[Y])}s(C,"writePackedBoolean");function T(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeFixed32(V[Y])}s(T,"writePackedFixed32");function O(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeSFixed32(V[Y])}s(O,"writePackedSFixed32");function F(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeFixed64(V[Y])}s(F,"writePackedFixed64");function k(V,oe){for(var Y=0;Y<V.length;Y++)oe.writeSFixed64(V[Y])}s(k,"writePackedSFixed64");function B(V,oe){return(V[oe]|V[oe+1]<<8|V[oe+2]<<16)+V[oe+3]*16777216}s(B,"readUInt32");function U(V,oe,Y){V[Y]=oe,V[Y+1]=oe>>>8,V[Y+2]=oe>>>16,V[Y+3]=oe>>>24}s(U,"writeInt32");function z(V,oe){return(V[oe]|V[oe+1]<<8|V[oe+2]<<16)+(V[oe+3]<<24)}s(z,"readInt32");function q(V,oe,Y){for(var he="",Q=oe;Q<Y;){var ae=V[Q],ee=null,le=ae>239?4:ae>223?3:ae>191?2:1;if(Q+le>Y)break;var K,ce,te;le===1?ae<128&&(ee=ae):le===2?(K=V[Q+1],(K&192)===128&&(ee=(ae&31)<<6|K&63,ee<=127&&(ee=null))):le===3?(K=V[Q+1],ce=V[Q+2],(K&192)===128&&(ce&192)===128&&(ee=(ae&15)<<12|(K&63)<<6|ce&63,(ee<=2047||ee>=55296&&ee<=57343)&&(ee=null))):le===4&&(K=V[Q+1],ce=V[Q+2],te=V[Q+3],(K&192)===128&&(ce&192)===128&&(te&192)===128&&(ee=(ae&15)<<18|(K&63)<<12|(ce&63)<<6|te&63,(ee<=65535||ee>=1114112)&&(ee=null))),ee===null?(ee=65533,le=1):ee>65535&&(ee-=65536,he+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|ee&1023),he+=String.fromCharCode(ee),Q+=le}return he}s(q,"readUtf8");function W(V,oe,Y){return l.decode(V.subarray(oe,Y))}s(W,"readUtf8TextDecoder");function J(V,oe,Y){for(var he=0,Q,ae;he<oe.length;he++){if(Q=oe.charCodeAt(he),Q>55295&&Q<57344)if(ae)if(Q<56320){V[Y++]=239,V[Y++]=191,V[Y++]=189,ae=Q;continue}else Q=ae-55296<<10|Q-56320|65536,ae=null;else{Q>56319||he+1===oe.length?(V[Y++]=239,V[Y++]=191,V[Y++]=189):ae=Q;continue}else ae&&(V[Y++]=239,V[Y++]=191,V[Y++]=189,ae=null);Q<128?V[Y++]=Q:(Q<2048?V[Y++]=Q>>6|192:(Q<65536?V[Y++]=Q>>12|224:(V[Y++]=Q>>18|240,V[Y++]=Q>>12&63|128),V[Y++]=Q>>6&63|128),V[Y++]=Q&63|128)}return Y}s(J,"writeUtf8")}),S9=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())}(t,function(){var r=s(function(n,a){if(n===void 0&&(n=[]),a===void 0&&(a=i),this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)},"TinyQueue");r.prototype.push=s(function(n){this.data.push(n),this.length++,this._up(this.length-1)},"push"),r.prototype.pop=s(function(){if(this.length!==0){var n=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),n}},"pop"),r.prototype.peek=s(function(){return this.data[0]},"peek"),r.prototype._up=s(function(n){for(var a=this,o=a.data,l=a.compare,u=o[n];n>0;){var c=n-1>>1,p=o[c];if(l(u,p)>=0)break;o[n]=p,n=c}o[n]=u},"_up"),r.prototype._down=s(function(n){for(var a=this,o=a.data,l=a.compare,u=this.length>>1,c=o[n];n<u;){var p=(n<<1)+1,m=o[p],y=p+1;if(y<this.length&&l(o[y],m)<0&&(p=y,m=o[y]),l(m,c)>=0)break;o[n]=m,n=p}o[n]=c},"_down");function i(n,a){return n<a?-1:n>a?1:0}return s(i,"defaultCompare"),r})});N();var nZ={version:"6.0.1-beta.48"};N();N();var uOe=kr(Nn(),1),cOe=kr(nOe(),1);N();N();var IL;function M9(){return IL==null&&(IL=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),IL}s(M9,"offscreenCanvasSupported");var xM;function aZ(){if(xM==null&&(xM=!1,M9())){let t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let r=0;r<5*5;r++){let i=r*4;t.fillStyle="rgb(".concat(i,",").concat(i+1,",").concat(i+2,")"),t.fillRect(r%5,Math.floor(r/5),1,1)}let e=t.getImageData(0,0,5,5).data;for(let r=0;r<5*5*4;r++)if(r%4!==3&&e[r]!==r){xM=!0;break}}}return xM||!1}s(aZ,"isOffscreenCanvasDistorted");function oZ(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}s(oZ,"easeCubicInOut");function XT(t,e,r,i){let n=new cOe.default(t,e,r,i);return function(a){return n.solve(a)}}s(XT,"bezier");var J6=XT(.25,.1,.25,1);function ps(t,e,r){return Math.min(r,Math.max(e,t))}s(ps,"clamp");function Ay(t,e,r){let i=r-e,n=((t-e)%i+i)%i+e;return n===e?r:n}s(Ay,"wrap");function sZ(t,e){let r=[];for(let i in t)i in e||r.push(i);return r}s(sZ,"keysDifference");function zr(t,...e){for(let r of e)for(let i in r)t[i]=r[i];return t}s(zr,"extend");function fA(t,e){let r={};for(let i=0;i<e.length;i++){let n=e[i];n in t&&(r[n]=t[n])}return r}s(fA,"pick");var hOe=1;function E9(){return hOe++}s(E9,"uniqueId");function lZ(t){return Math.log(t)/Math.LN2%1===0}s(lZ,"isPowerOfTwo");function uZ(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}s(uZ,"nextPowerOfTwo");function ZT(t,e,r){let i={};for(let n in t)i[n]=e.call(r||this,t[n],n,t);return i}s(ZT,"mapObject");function C9(t,e,r){let i={};for(let n in t)e.call(r||this,t[n],n,t)&&(i[n]=t[n]);return i}s(C9,"filterObject");function zm(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!zm(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!zm(t[r],e[r]))return!1;return!0}return t===e}s(zm,"deepEqual");function mc(t){return Array.isArray(t)?t.map(mc):typeof t=="object"&&t?ZT(t,mc):t}s(mc,"clone");function cZ(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}s(cZ,"arraysIntersect");var EH={};function kl(t){EH[t]||(typeof console<"u"&&console.warn(t),EH[t]=!0)}s(kl,"warnOnce");function of(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}s(of,"isCounterClockwise");function hZ(t,e,r,i){let n=e.y-t.y,a=e.x-t.x,o=i.y-r.y,l=i.x-r.x,u=o*a-l*n;if(u===0)return null;let c=t.y-r.y,p=t.x-r.x,m=(l*c-o*p)/u;return new uOe.default(t.x+m*a,t.y+m*n)}s(hZ,"findLineIntersection");function pZ(t){let e=0;for(let r=0,i=t.length,n=i-1,a,o;r<i;n=r++)a=t[r],o=t[n],e+=(o.x-a.x)*(a.y+o.y);return e}s(pZ,"calculateSignedArea");function dZ([t,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(r),y:t*Math.sin(e)*Math.sin(r),z:t*Math.cos(r)}}s(dZ,"sphericalToCartesian");function Vy(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}s(Vy,"isWorker");function fZ(t){let e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,r={};if(t.replace(e,(i,n,a,o)=>{let l=a||o;return r[n]=l?l.toLowerCase():!0,""}),r["max-age"]){let i=parseInt(r["max-age"],10);isNaN(i)?delete r["max-age"]:r["max-age"]=i}return r}s(fZ,"parseCacheControl");var TL=null;function mZ(t){if(TL==null){let e=t.navigator?t.navigator.userAgent:null;TL=!!t.safari||!!(e&&(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return TL}s(mZ,"isSafari");function Gp(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}s(Gp,"isImageBitmap");var pOe=s(async t=>{if(t.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(t)],{type:"image/png"});try{return createImageBitmap(e)}catch(r){throw new Error("Could not load image because of ".concat(r.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}},"arrayBufferToImageBitmap"),CH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",dOe=s(t=>new Promise((e,r)=>{let i=new Image;i.onload=()=>{e(i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame(()=>{i.src=CH})},i.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let n=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(n):CH}),"arrayBufferToImage");function gZ(t,e,r,i,n){let a=Math.max(-e,0)*4,o=(Math.max(0,r)-r)*i*4+a,l=i*4,u=Math.max(0,e),c=Math.max(0,r),p=Math.min(t.width,e+i),m=Math.min(t.height,r+n);return{rect:{x:u,y:c,width:p-u,height:m-c},layout:[{offset:o,stride:l}]}}s(gZ,"computeVideoFrameParameters");async function yZ(t,e,r,i,n){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let a=new VideoFrame(t,{timestamp:0});try{let o=a==null?void 0:a.format;if(!o||!(o.startsWith("BGR")||o.startsWith("RGB")))throw new Error("Unrecognized format ".concat(o));let l=o.startsWith("BGR"),u=new Uint8ClampedArray(i*n*4);if(await a.copyTo(u,gZ(t,e,r,i,n)),l)for(let c=0;c<u.length;c+=4){let p=u[c];u[c]=u[c+2],u[c+2]=p}return u}finally{a.close()}}s(yZ,"readImageUsingVideoFrame");function vZ(t,e,r,i){return t.addEventListener(e,r,i),{unsubscribe:s(()=>{t.removeEventListener(e,r,i)},"unsubscribe")}}s(vZ,"subscribe");function Q6(t){return t*Math.PI/180}s(Q6,"degreesToRadians");N();N();var fOe="AbortError";function mA(){return new Error(fOe)}s(mA,"createAbortError");var mOe=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),bM,PL,vn={now:mOe,frameAsync(t){return new Promise((e,r)=>{let i=requestAnimationFrame(e);t.signal.addEventListener("abort",()=>{cancelAnimationFrame(i),r(mA())})})},getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){let e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0,t.width,t.height),r},resolveURL(t){return bM||(bM=document.createElement("a")),bM.href=t,bM.href},hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return matchMedia?(PL==null&&(PL=matchMedia("(prefers-reduced-motion: reduce)")),PL.matches):!1}};N();var gOe=kr(Nn(),1),jg=class ho{static testProp(e){if(!ho.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in ho.docStyle)return e[r];return e[0]}static create(e,r,i){let n=window.document.createElement(e);return r!==void 0&&(n.className=r),i&&i.appendChild(n),n}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){ho.docStyle&&ho.selectProp&&(ho.userSelect=ho.docStyle[ho.selectProp],ho.docStyle[ho.selectProp]="none")}static enableDrag(){ho.docStyle&&ho.selectProp&&(ho.docStyle[ho.selectProp]=ho.userSelect)}static setTransform(e,r){e.style[ho.transformProp]=r}static addEventListener(e,r,i,n={}){"passive"in n?e.addEventListener(r,i,n):e.addEventListener(r,i,n.capture)}static removeEventListener(e,r,i,n={}){"passive"in n?e.removeEventListener(r,i,n):e.removeEventListener(r,i,n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ho.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ho.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ho.suppressClickInternal,!0)},0)}static getScale(e){let r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,i){let n=r.boundingClientRect;return new gOe.default((i.clientX-n.left)/r.x-e.clientLeft,(i.clientY-n.top)/r.y-e.clientTop)}static mousePos(e,r){let i=ho.getScale(e);return ho.getPoint(e,i,r)}static touchPos(e,r){let i=[],n=ho.getScale(e);for(let a=0;a<r.length;a++)i.push(ho.getPoint(e,n,r[a]));return i}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}};s(jg,"DOM"),jg.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,jg.selectProp=jg.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),jg.transformProp=jg.testProp(["transform","WebkitTransform"]);var or=jg;N();N();N();var wc={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function I9(t){return wc.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}s(I9,"getProtocol");function yOe(t,e){wc.REGISTERED_PROTOCOLS[t]=e}s(yOe,"addProtocol");function vOe(t){delete wc.REGISTERED_PROTOCOLS[t]}s(vOe,"removeProtocol");N();var eD="global-dispatcher",_Z=class extends Error{constructor(e,r,i,n){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(i)),this.status=e,this.statusText=r,this.url=i,this.body=n}};s(_Z,"AJAXError");var T9=_Z,P9=s(()=>Vy(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,"getReferrer"),_Oe=s(t=>/^file:/.test(t)||/^file:/.test(P9())&&!/^\w+:/.test(t),"isFileURL");async function xZ(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:P9(),signal:e.signal});t.type==="json"&&r.headers.set("Accept","application/json");let i=await fetch(r);if(!i.ok){let o=await i.blob();throw new T9(i.status,i.statusText,t.url,o)}let n;t.type==="arrayBuffer"||t.type==="image"?n=i.arrayBuffer():t.type==="json"?n=i.json():n=i.text();let a=await n;if(e.signal.aborted)throw mA();return{data:a,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}}s(xZ,"makeFetchRequest");function bZ(t,e){return new Promise((r,i)=>{let n=new XMLHttpRequest;n.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(n.responseType="arraybuffer");for(let a in t.headers)n.setRequestHeader(a,t.headers[a]);t.type==="json"&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials=t.credentials==="include",n.onerror=()=>{i(new Error(n.statusText))},n.onload=()=>{if(!e.signal.aborted)if((n.status>=200&&n.status<300||n.status===0)&&n.response!==null){let a=n.response;if(t.type==="json")try{a=JSON.parse(n.response)}catch(o){i(o);return}r({data:a,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")})}else{let a=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});i(new T9(n.status,n.statusText,t.url,a))}},e.signal.addEventListener("abort",()=>{n.abort(),i(mA())}),n.send(t.body)})}s(bZ,"makeXMLHttpRequest");var YT=s(function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=I9(t.url);if(r)return r(t,e);if(Vy(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:eD},e)}if(!_Oe(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return xZ(t,e);if(Vy(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:eD},e)}return bZ(t,e)},"makeRequest"),KT=s((t,e)=>YT(zr(t,{type:"json"}),e),"getJSON"),xOe=s((t,e)=>YT(zr(t,{type:"arrayBuffer"}),e),"getArrayBuffer");function L9(t){if(!t||t.indexOf("://")<=0||t.indexOf("data:image/")===0||t.indexOf("blob:")===0)return!0;let e=new URL(t),r=window.location;return e.protocol===r.protocol&&e.host===r.host}s(L9,"sameOrigin");var bOe=s(t=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(r=>{e.onloadstart=()=>{r(e)};for(let i of t){let n=window.document.createElement("source");L9(i)||(e.crossOrigin="Anonymous"),n.src=i,e.appendChild(n)}})},"getVideo");N();N();var D9={supported:!1,testSupport:AZ},Wb,R9=!1,D1,wZ=!1;typeof document<"u"&&(D1=document.createElement("img"),D1.onload=function(){Wb&&O9(Wb),Wb=null,wZ=!0},D1.onerror=function(){R9=!0,Wb=null},D1.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function AZ(t){R9||!D1||(wZ?O9(t):Wb=t)}s(AZ,"testSupport");function O9(t){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,D1),t.isContextLost())return;D9.supported=!0}catch{}t.deleteTexture(e),R9=!0}s(O9,"testWebpTextureUpload");var Hp;(t=>{let e,r,i,n;t.resetRequestQueue=s(()=>{e=[],r=0,i=0,n={}},"resetRequestQueue"),t.addThrottleControl=s(p=>{let m=i++;return n[m]=p,m},"addThrottleControl"),t.removeThrottleControl=s(p=>{delete n[p],u()},"removeThrottleControl");let a=s(()=>{for(let p of Object.keys(n))if(n[p]())return!0;return!1},"isThrottled");t.getImage=s((p,m,y=!0)=>new Promise((v,w)=>{D9.supported&&(p.headers||(p.headers={}),p.headers.accept="image/webp,*/*"),zr(p,{type:"image"});let E={abortController:m,requestParameters:p,supportImageRefresh:y,state:"queued",onError:s(M=>{w(M)},"onError"),onSuccess:s(M=>{v(M)},"onSuccess")};e.push(E),u()}),"getImage");let o=s(p=>typeof createImageBitmap=="function"?pOe(p):dOe(p),"arrayBufferToCanvasImageSource"),l=s(async p=>{p.state="running";let{requestParameters:m,supportImageRefresh:y,onError:v,onSuccess:w,abortController:E}=p,M=y===!1&&!Vy(self)&&!I9(m.url)&&(!m.headers||Object.keys(m.headers).reduce((P,C)=>P&&C==="accept",!0));r++;let I=M?c(m,E):YT(m,E);try{let P=await I;if(delete p.abortController,p.state="completed",P.data instanceof HTMLImageElement||Gp(P.data))w(P);else if(P.data){let C=await o(P.data);w({data:C,cacheControl:P.cacheControl,expires:P.expires})}}catch(P){delete p.abortController,v(P)}finally{r--,u()}},"doImageRequest"),u=s(()=>{let p=a()?wc.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:wc.MAX_PARALLEL_IMAGE_REQUESTS;for(let m=r;m<p&&e.length>0;m++){let y=e.shift();if(y.abortController.signal.aborted){m--;continue}l(y)}},"processQueue"),c=s((p,m)=>new Promise((y,v)=>{let w=new Image,E=p.url,M=p.credentials;M&&M==="include"?w.crossOrigin="use-credentials":(M&&M==="same-origin"||!L9(E))&&(w.crossOrigin="anonymous"),m.signal.addEventListener("abort",()=>{w.src="",v(mA())}),w.fetchPriority="high",w.onload=()=>{w.onerror=w.onload=null,y({data:w})},w.onerror=()=>{w.onerror=w.onload=null,!m.signal.aborted&&v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},w.src=E}),"getImageUsingHtmlImage")})(Hp||(Hp={}));Hp.resetRequestQueue();N();var SZ=class{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn?this._transformRequestFn(e,r)||{url:e}:{url:e}}normalizeSpriteURL(e,r,i){let n=MZ(e);return n.path+="".concat(r).concat(i),EZ(n)}setTransformRequest(e){this._transformRequestFn=e}};s(SZ,"RequestManager");var wOe=SZ,AOe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function MZ(t){let e=t.match(AOe);if(!e)throw new Error('Unable to parse URL "'.concat(t,'"'));return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}s(MZ,"parseUrl");function EZ(t){let e=t.params.length?"?".concat(t.params.join("&")):"";return"".concat(t.protocol,"://").concat(t.authority).concat(t.path).concat(e)}s(EZ,"formatUrl");N();N();function tD(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}s(tD,"_addEventListener");function EE(t,e,r){if(r&&r[t]){let i=r[t].indexOf(e);i!==-1&&r[t].splice(i,1)}}s(EE,"_removeEventListener");var CZ=class{constructor(e,r={}){zr(this,r),this.type=e}};s(CZ,"Event");var pr=CZ,IZ=class extends pr{constructor(e,r={}){super("error",zr({error:e},r))}};s(IZ,"ErrorEvent");var fi=IZ,TZ=class{on(e,r){return this._listeners=this._listeners||{},tD(e,r,this._listeners),this}off(e,r){return EE(e,r,this._listeners),EE(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},tD(e,r,this._oneTimeListeners),this):new Promise(i=>this.once(e,i))}fire(e,r){typeof e=="string"&&(e=new pr(e,r||{}));let i=e.type;if(this.listens(i)){e.target=this;let n=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(let l of n)l.call(this,e);let a=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(let l of a)EE(i,l,this._oneTimeListeners),l.call(this,e);let o=this._eventedParent;o&&(zr(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof fi&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};s(TZ,"Evented");var Fl=TZ;N();N();N();N();var SOe=8,MOe={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},EOe={"*":{type:"source"}},COe=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],IOe={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},TOe={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},POe={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},LOe={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},DOe={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},ROe={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},OOe={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},kOe=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],NOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},FOe={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},BOe={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},zOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},UOe={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},VOe={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},$Oe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},GOe={type:"array",value:"*"},HOe={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},qOe={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},WOe={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},XOe={type:"array",value:"*",minimum:1},ZOe={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},YOe={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},KOe={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},JOe={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},QOe=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],eke={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},tke={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},rke={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},ike={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},nke={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ake={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},oke={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ske={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},lke={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},uke={"*":{type:"string"}},Ut={$version:SOe,$root:MOe,sources:EOe,source:COe,source_vector:IOe,source_raster:TOe,source_raster_dem:POe,source_geojson:LOe,source_video:DOe,source_image:ROe,layer:OOe,layout:kOe,layout_background:NOe,layout_fill:FOe,layout_circle:BOe,layout_heatmap:zOe,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:UOe,layout_symbol:VOe,layout_raster:jOe,layout_hillshade:$Oe,filter:GOe,filter_operator:HOe,geometry_type:qOe,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:WOe,expression:XOe,light:ZOe,sky:YOe,terrain:KOe,projection:JOe,paint:QOe,paint_fill:eke,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:tke,paint_circle:rke,paint_heatmap:ike,paint_symbol:nke,paint_raster:ake,paint_hillshade:oke,paint_background:ske,transition:lke,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:uke},cke=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function PZ(t,e){let r={};for(let i in t)i!=="ref"&&(r[i]=t[i]);return cke.forEach(i=>{i in e&&(r[i]=e[i])}),r}s(PZ,"deref");function rD(t){t=t.slice();let e=Object.create(null);for(let r=0;r<t.length;r++)e[t[r].id]=t[r];for(let r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=PZ(t[r],e[t[r].ref]));return t}s(rD,"derefLayers");function Jn(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Jn(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!Jn(t[r],e[r]))return!1;return!0}return t===e}s(Jn,"deepEqual");function uc(t,e){t.push(e)}s(uc,"addCommand");function k9(t,e,r){uc(r,{command:"addSource",args:[t,e[t]]})}s(k9,"addSource");function N9(t,e,r){uc(e,{command:"removeSource",args:[t]}),r[t]=!0}s(N9,"removeSource");function LZ(t,e,r,i){N9(t,r,i),k9(t,e,r)}s(LZ,"updateSource");function DZ(t,e,r){let i;for(i in t[r])if(Object.prototype.hasOwnProperty.call(t[r],i)&&i!=="data"&&!Jn(t[r][i],e[r][i]))return!1;for(i in e[r])if(Object.prototype.hasOwnProperty.call(e[r],i)&&i!=="data"&&!Jn(t[r][i],e[r][i]))return!1;return!0}s(DZ,"canUpdateGeoJSON");function RZ(t,e,r,i){t=t||{},e=e||{};let n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)||N9(n,r,i));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(t,n)?Jn(t[n],e[n])||(t[n].type==="geojson"&&e[n].type==="geojson"&&DZ(t,e,n)?uc(r,{command:"setGeoJSONSourceData",args:[n,e[n].data]}):LZ(n,e,r,i)):k9(n,e,r))}s(RZ,"diffSources");function Xb(t,e,r,i,n,a){t=t||{},e=e||{};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Jn(t[o],e[o])||r.push({command:a,args:[i,o,e[o],n]}));for(let o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(t,o)||Jn(t[o],e[o])||r.push({command:a,args:[i,o,e[o],n]})}s(Xb,"diffLayerPropertyChanges");function iD(t){return t.id}s(iD,"pluckId");function nD(t,e){return t[e.id]=e,t}s(nD,"indexById");function OZ(t,e,r){t=t||[],e=e||[];let i=t.map(iD),n=e.map(iD),a=t.reduce(nD,{}),o=e.reduce(nD,{}),l=i.slice(),u=Object.create(null),c,p,m,y,v;for(let w=0,E=0;w<i.length;w++)c=i[w],Object.prototype.hasOwnProperty.call(o,c)?E++:(uc(r,{command:"removeLayer",args:[c]}),l.splice(l.indexOf(c,E),1));for(let w=0,E=0;w<n.length;w++)c=n[n.length-1-w],l[l.length-1-w]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(uc(r,{command:"removeLayer",args:[c]}),l.splice(l.lastIndexOf(c,l.length-E),1)):E++,y=l[l.length-w],uc(r,{command:"addLayer",args:[o[c],y]}),l.splice(l.length-w,0,c),u[c]=!0);for(let w=0;w<n.length;w++)if(c=n[w],p=a[c],m=o[c],!(u[c]||Jn(p,m))){if(!Jn(p.source,m.source)||!Jn(p["source-layer"],m["source-layer"])||!Jn(p.type,m.type)){uc(r,{command:"removeLayer",args:[c]}),y=l[l.lastIndexOf(c)+1],uc(r,{command:"addLayer",args:[m,y]});continue}Xb(p.layout,m.layout,r,c,null,"setLayoutProperty"),Xb(p.paint,m.paint,r,c,null,"setPaintProperty"),Jn(p.filter,m.filter)||uc(r,{command:"setFilter",args:[c,m.filter]}),(!Jn(p.minzoom,m.minzoom)||!Jn(p.maxzoom,m.maxzoom))&&uc(r,{command:"setLayerZoomRange",args:[c,m.minzoom,m.maxzoom]});for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&(v==="layout"||v==="paint"||v==="filter"||v==="metadata"||v==="minzoom"||v==="maxzoom"||(v.indexOf("paint.")===0?Xb(p[v],m[v],r,c,v.slice(6),"setPaintProperty"):Jn(p[v],m[v])||uc(r,{command:"setLayerProperty",args:[c,v,m[v]]})));for(v in m)!Object.prototype.hasOwnProperty.call(m,v)||Object.prototype.hasOwnProperty.call(p,v)||v==="layout"||v==="paint"||v==="filter"||v==="metadata"||v==="minzoom"||v==="maxzoom"||(v.indexOf("paint.")===0?Xb(p[v],m[v],r,c,v.slice(6),"setPaintProperty"):Jn(p[v],m[v])||uc(r,{command:"setLayerProperty",args:[c,v,m[v]]}))}}s(OZ,"diffLayers");function kZ(t,e){if(!t)return[{command:"setStyle",args:[e]}];let r=[];try{if(!Jn(t.version,e.version))return[{command:"setStyle",args:[e]}];Jn(t.center,e.center)||r.push({command:"setCenter",args:[e.center]}),Jn(t.zoom,e.zoom)||r.push({command:"setZoom",args:[e.zoom]}),Jn(t.bearing,e.bearing)||r.push({command:"setBearing",args:[e.bearing]}),Jn(t.pitch,e.pitch)||r.push({command:"setPitch",args:[e.pitch]}),Jn(t.roll,e.roll)||r.push({command:"setRoll",args:[e.roll]}),Jn(t.sprite,e.sprite)||r.push({command:"setSprite",args:[e.sprite]}),Jn(t.glyphs,e.glyphs)||r.push({command:"setGlyphs",args:[e.glyphs]}),Jn(t.transition,e.transition)||r.push({command:"setTransition",args:[e.transition]}),Jn(t.light,e.light)||r.push({command:"setLight",args:[e.light]}),Jn(t.terrain,e.terrain)||r.push({command:"setTerrain",args:[e.terrain]}),Jn(t.sky,e.sky)||r.push({command:"setSky",args:[e.sky]}),Jn(t.projection,e.projection)||r.push({command:"setProjection",args:[e.projection]});let i={},n=[];RZ(t.sources,e.sources,n,i);let a=[];t.layers&&t.layers.forEach(o=>{"source"in o&&i[o.source]?r.push({command:"removeLayer",args:[o.id]}):a.push(o)}),r=r.concat(n),OZ(a,e.layers,r)}catch(i){console.warn("Unable to compute style diff:",i),r=[{command:"setStyle",args:[e]}]}return r}s(kZ,"diffStyles");var NZ=class{constructor(e,r,i,n){this.message=(e?"".concat(e,": "):"")+i,n&&(this.identifier=n),r!=null&&r.__line__&&(this.line=r.__line__)}};s(NZ,"ValidationError");var _r=NZ;function jy(t,...e){for(let r of e)for(let i in r)t[i]=r[i];return t}s(jy,"extendBy");var FZ=class extends Error{constructor(e,r){super(r),this.message=r,this.key=e}};s(FZ,"ExpressionParsingError");var Fp=FZ,BZ=class zZ{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[i,n]of r)this.bindings[i]=n}concat(e){return new zZ(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}};s(BZ,"Scope");var hke=BZ,gA={kind:"null"},wr={kind:"number"},rn={kind:"string"},$i={kind:"boolean"},zh={kind:"color"},W1={kind:"object"},Gi={kind:"value"},pke={kind:"error"},JT={kind:"collator"},yA={kind:"formatted"},QT={kind:"padding"},vA={kind:"resolvedImage"},eP={kind:"variableAnchorOffsetCollection"};function Tu(t,e){return{kind:"array",itemType:t,N:e}}s(Tu,"array$1");function Ga(t){if(t.kind==="array"){let e=Ga(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}s(Ga,"toString$1");var dke=[gA,wr,rn,$i,zh,yA,W1,Tu(Gi),QT,vA,eP];function m_(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!m_(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of dke)if(!m_(r,e))return null}}return"Expected ".concat(Ga(t)," but found ").concat(Ga(e)," instead.")}s(m_,"checkSubtype");function tP(t,e){return e.some(r=>r.kind===t.kind)}s(tP,"isValidType");function jm(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}s(jm,"isValidNativeType");function b0(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}s(b0,"verifyType");var UZ=.96422,VZ=1,jZ=.82521,$Z=4/29,X1=6/29,GZ=3*X1*X1,fke=X1*X1*X1,mke=Math.PI/180,gke=180/Math.PI;function F9(t){return t=t%360,t<0&&(t+=360),t}s(F9,"constrainAngle");function B9([t,e,r,i]){t=CE(t),e=CE(e),r=CE(r);let n,a,o=IE((.2225045*t+.7168786*e+.0606169*r)/VZ);t===e&&e===r?n=a=o:(n=IE((.4360747*t+.3850649*e+.1430804*r)/UZ),a=IE((.0139322*t+.0971045*e+.7141733*r)/jZ));let l=116*o-16;return[l<0?0:l,500*(n-o),200*(o-a),i]}s(B9,"rgbToLab");function CE(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}s(CE,"rgb2xyz");function IE(t){return t>fke?Math.pow(t,1/3):t/GZ+$Z}s(IE,"xyz2lab");function z9([t,e,r,i]){let n=(t+16)/116,a=isNaN(e)?n:n+e/500,o=isNaN(r)?n:n-r/200;return n=VZ*PE(n),a=UZ*PE(a),o=jZ*PE(o),[TE(3.1338561*a-1.6168667*n-.4906146*o),TE(-.9787684*a+1.9161415*n+.033454*o),TE(.0719453*a-.2289914*n+1.4052427*o),i]}s(z9,"labToRgb");function TE(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}s(TE,"xyz2rgb");function PE(t){return t>X1?t*t*t:GZ*(t-$Z)}s(PE,"lab2xyz");function HZ(t){let[e,r,i,n]=B9(t),a=Math.sqrt(r*r+i*i);return[Math.round(a*1e4)?F9(Math.atan2(i,r)*gke):NaN,a,e,n]}s(HZ,"rgbToHcl");function qZ([t,e,r,i]){return t=isNaN(t)?0:t*mke,z9([r,Math.cos(t)*e,Math.sin(t)*e,i])}s(qZ,"hclToRgb");function WZ([t,e,r,i]){t=F9(t),e/=100,r/=100;function n(a){let o=(a+t/30)%12,l=e*Math.min(r,1-r);return r-l*Math.max(-1,Math.min(o-3,9-o,1))}return s(n,"f"),[n(0),n(8),n(4),i]}s(WZ,"hslToRgb");function XZ(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=yke[t];if(e){let[n,a,o]=e;return[n/255,a/255,o/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let n=t.length<6?1:2,a=1;return[Zb(t.slice(a,a+=n)),Zb(t.slice(a,a+=n)),Zb(t.slice(a,a+=n)),Zb(t.slice(a,a+n)||"ff")]}if(t.startsWith("rgb")){let n=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=t.match(n);if(a){let[o,l,u,c,p,m,y,v,w,E,M,I]=a,P=[c||" ",y||" ",E].join("");if(P==="  "||P==="  /"||P===",,"||P===",,,"){let C=[u,m,w].join(""),T=C==="%%%"?100:C===""?255:0;if(T){let O=[hy(+l/T,0,1),hy(+p/T,0,1),hy(+v/T,0,1),M?aD(+M,I):1];if(oD(O))return O}}return}}let r=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,i=t.match(r);if(i){let[n,a,o,l,u,c,p,m,y]=i,v=[o||" ",u||" ",p].join("");if(v==="  "||v==="  /"||v===",,"||v===",,,"){let w=[+a,hy(+l,0,100),hy(+c,0,100),m?aD(+m,y):1];if(oD(w))return WZ(w)}}}s(XZ,"parseCssColor");function Zb(t){return parseInt(t.padEnd(2,t),16)/255}s(Zb,"parseHex");function aD(t,e){return hy(e?t/100:t,0,1)}s(aD,"parseAlpha");function hy(t,e,r){return Math.min(Math.max(e,t),r)}s(hy,"clamp");function oD(t){return!t.some(Number.isNaN)}s(oD,"validateNumbers");var yke={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ZZ=class sD{constructor(e,r,i,n=1,a=!0){this.r=e,this.g=r,this.b=i,this.a=n,a||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,r,i,n]))}static parse(e){if(e instanceof sD)return e;if(typeof e!="string")return;let r=XZ(e);if(r)return new sD(...r,!1)}get rgb(){let{r:e,g:r,b:i,a:n}=this,a=n||1/0;return this.overwriteGetter("rgb",[e/a,r/a,i/a,n])}get hcl(){return this.overwriteGetter("hcl",HZ(this.rgb))}get lab(){return this.overwriteGetter("lab",B9(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,i,n]=this.rgb;return"rgba(".concat([e,r,i].map(a=>Math.round(a*255)).join(","),",").concat(n,")")}};s(ZZ,"Color");var Li=ZZ;Li.black=new Li(0,0,0,1);Li.white=new Li(1,1,1,1);Li.transparent=new Li(0,0,0,0);Li.red=new Li(1,0,0,1);var YZ=class{constructor(e,r,i){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}};s(YZ,"Collator");var U9=YZ,KZ=class{constructor(e,r,i,n,a){this.text=e,this.image=r,this.scale=i,this.fontStack=n,this.textColor=a}};s(KZ,"FormattedSection");var lD=KZ,JZ=class LE{constructor(e){this.sections=e}static fromString(e){return new LE([new lD(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof LE?e:LE.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}};s(JZ,"Formatted");var df=JZ,QZ=class DE{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof DE)return e;if(typeof e=="number")return new DE([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new DE(e)}}toString(){return JSON.stringify(this.values)}};s(QZ,"Padding");var Af=QZ,vke=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),eY=class uD{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof uD)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let i=e[r],n=e[r+1];if(typeof i!="string"||!vke.has(i)||!Array.isArray(n)||n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")return}return new uD(e)}}toString(){return JSON.stringify(this.values)}};s(eY,"VariableAnchorOffsetCollection");var ov=eY,tY=class rY{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new rY({name:e,available:!1}):null}};s(tY,"ResolvedImage");var Kp=tY;function V9(t,e,r,i){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let n=typeof i=="number"?[t,e,r,i]:[t,e,r];return"Invalid rgba value [".concat(n.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof i>"u"||typeof i=="number"&&i>=0&&i<=1?null:"Invalid rgba value [".concat([t,e,r,i].join(", "),"]: 'a' must be between 0 and 1.")}s(V9,"validateRGBA");function g_(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Li||t instanceof U9||t instanceof df||t instanceof Af||t instanceof ov||t instanceof Kp)return!0;if(Array.isArray(t)){for(let e of t)if(!g_(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!g_(t[e]))return!1;return!0}else return!1}s(g_,"isValue");function Xo(t){if(t===null)return gA;if(typeof t=="string")return rn;if(typeof t=="boolean")return $i;if(typeof t=="number")return wr;if(t instanceof Li)return zh;if(t instanceof U9)return JT;if(t instanceof df)return yA;if(t instanceof Af)return QT;if(t instanceof ov)return eP;if(t instanceof Kp)return vA;if(Array.isArray(t)){let e=t.length,r;for(let i of t){let n=Xo(i);if(!r)r=n;else{if(r===n)continue;r=Gi;break}}return Tu(r||Gi,e)}else return W1}s(Xo,"typeOf");function Z1(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Li||t instanceof df||t instanceof Af||t instanceof ov||t instanceof Kp?t.toString():JSON.stringify(t)}s(Z1,"toString");var iY=class nY{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!g_(e[1]))return r.error("invalid value");let i=e[1],n=Xo(i),a=r.expectedType;return n.kind==="array"&&n.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(n=a),new nY(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}};s(iY,"Literal");var gw=iY,aY=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};s(aY,"RuntimeError");var Zo=aY,wM={string:rn,number:wr,boolean:$i,object:W1},oY=class sY{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=1,n,a=e[0];if(a==="array"){let l;if(e.length>2){let c=e[1];if(typeof c!="string"||!(c in wM)||c==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);l=wM[c],i++}else l=Gi;let u;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);u=e[2],i++}n=Tu(l,u)}else{if(!wM[a])throw new Error("Types doesn't contain name = ".concat(a));n=wM[a]}let o=[];for(;i<e.length;i++){let l=r.parse(e[i],i,Gi);if(!l)return null;o.push(l)}return new sY(n,o)}evaluate(e){for(let r=0;r<this.args.length;r++){let i=this.args[r].evaluate(e);if(m_(this.type,Xo(i))){if(r===this.args.length-1)throw new Zo("Expected value to be of type ".concat(Ga(this.type),", but found ").concat(Ga(Xo(i))," instead."))}else return i}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};s(oY,"Assertion");var rf=oY,IH={"to-boolean":$i,"to-color":zh,"to-number":wr,"to-string":rn},lY=class uY{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=e[0];if(!IH[i])throw new Error("Can't parse ".concat(i," as it is not part of the known types"));if((i==="to-boolean"||i==="to-string")&&e.length!==2)return r.error("Expected one argument.");let n=IH[i],a=[];for(let o=1;o<e.length;o++){let l=r.parse(e[o],o,Gi);if(!l)return null;a.push(l)}return new uY(n,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,i;for(let n of this.args){if(r=n.evaluate(e),i=null,r instanceof Li)return r;if(typeof r=="string"){let a=e.parseColor(r);if(a)return a}else if(Array.isArray(r)&&(r.length<3||r.length>4?i="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):i=V9(r[0],r[1],r[2],r[3]),!i))return new Li(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Zo(i||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let i of this.args){r=i.evaluate(e);let n=Af.parse(r);if(n)return n}throw new Zo("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let i of this.args){r=i.evaluate(e);let n=ov.parse(r);if(n)return n}throw new Zo("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let i of this.args){if(r=i.evaluate(e),r===null)return 0;let n=Number(r);if(!isNaN(n))return n}throw new Zo("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return df.fromString(Z1(this.args[0].evaluate(e)));case"resolvedImage":return Kp.fromString(Z1(this.args[0].evaluate(e)));default:return Z1(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};s(lY,"Coercion");var R1=lY,_ke=["Unknown","Point","LineString","Polygon"],cY=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_ke[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=Li.parse(e)),r}};s(cY,"EvaluationContext");var hY=cY,pY=class dY{constructor(e,r,i=[],n,a=new hke,o=[]){this.registry=e,this.path=i,this.key=i.map(l=>"[".concat(l,"]")).join(""),this.scope=a,this.errors=o,this.expectedType=n,this._isConstant=r}parse(e,r,i,n,a={}){return r?this.concat(r,i,n)._parse(e,a):this._parse(e,a)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function i(n,a,o){return o==="assert"?new rf(a,[n]):o==="coerce"?new R1(a,[n]):n}if(s(i,"annotate"),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let n=e[0];if(typeof n!="string")return this.error("Expression name must be a string, but found ".concat(typeof n,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let a=this.registry[n];if(a){let o=a.parse(e,this);if(!o)return null;if(this.expectedType){let l=this.expectedType,u=o.type;if((l.kind==="string"||l.kind==="number"||l.kind==="boolean"||l.kind==="object"||l.kind==="array")&&u.kind==="value")o=i(o,l,r.typeAnnotation||"assert");else if((l.kind==="color"||l.kind==="formatted"||l.kind==="resolvedImage")&&(u.kind==="value"||u.kind==="string"))o=i(o,l,r.typeAnnotation||"coerce");else if(l.kind==="padding"&&(u.kind==="value"||u.kind==="number"||u.kind==="array"))o=i(o,l,r.typeAnnotation||"coerce");else if(l.kind==="variableAnchorOffsetCollection"&&(u.kind==="value"||u.kind==="array"))o=i(o,l,r.typeAnnotation||"coerce");else if(this.checkSubtype(l,u))return null}if(!(o instanceof gw)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){let l=new hY;try{o=new gw(o.type,o.evaluate(l))}catch(u){return this.error(u.message),null}}return o}return this.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,i){let n=typeof e=="number"?this.path.concat(e):this.path,a=i?this.scope.concat(i):this.scope;return new dY(this.registry,this._isConstant,n,r||null,a,this.errors)}error(e,...r){let i="".concat(this.key).concat(r.map(n=>"[".concat(n,"]")).join(""));this.errors.push(new Fp(i,e))}checkSubtype(e,r){let i=m_(e,r);return i&&this.error(i),i}};s(pY,"ParsingContext");var fY=pY,mY=class gY{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let i=[];for(let a=1;a<e.length-1;a+=2){let o=e[a];if(typeof o!="string")return r.error("Expected string, but found ".concat(typeof o," instead."),a);if(/[^a-zA-Z0-9_]/.test(o))return r.error("Variable names must contain only alphanumeric characters or '_'.",a);let l=r.parse(e[a+1],a+1);if(!l)return null;i.push([o,l])}let n=r.parse(e[e.length-1],e.length-1,r.expectedType,i);return n?new gY(i,n):null}outputDefined(){return this.result.outputDefined()}};s(mY,"Let");var yY=mY,vY=class _Y{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let i=e[1];return r.scope.has(i)?new _Y(i,r.scope.get(i)):r.error('Unknown variable "'.concat(i,'". Make sure "').concat(i,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}};s(vY,"Var");var xY=vY,bY=class wY{constructor(e,r,i){this.type=e,this.index=r,this.input=i}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,wr),n=r.parse(e[2],2,Tu(r.expectedType||Gi));if(!i||!n)return null;let a=n.type;return new wY(a.itemType,i,n)}evaluate(e){let r=this.index.evaluate(e),i=this.input.evaluate(e);if(r<0)throw new Zo("Array index out of bounds: ".concat(r," < 0."));if(r>=i.length)throw new Zo("Array index out of bounds: ".concat(r," > ").concat(i.length-1,"."));if(r!==Math.floor(r))throw new Zo("Array index must be an integer, but found ".concat(r," instead."));return i[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};s(bY,"At");var xke=bY,AY=class SY{constructor(e,r){this.type=$i,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,Gi),n=r.parse(e[2],2,Gi);return!i||!n?null:tP(i.type,[$i,rn,wr,gA,Gi])?new SY(i,n):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(Ga(i.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!jm(r,["boolean","string","number","null"]))throw new Zo("Expected first argument to be of type boolean, string, number or null, but found ".concat(Ga(Xo(r))," instead."));if(!jm(i,["string","array"]))throw new Zo("Expected second argument to be of type array or string, but found ".concat(Ga(Xo(i))," instead."));return i.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}};s(AY,"In");var bke=AY,MY=class cD{constructor(e,r,i){this.type=wr,this.needle=e,this.haystack=r,this.fromIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,Gi),n=r.parse(e[2],2,Gi);if(!i||!n)return null;if(!tP(i.type,[$i,rn,wr,gA,Gi]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(Ga(i.type)," instead"));if(e.length===4){let a=r.parse(e[3],3,wr);return a?new cD(i,n,a):null}else return new cD(i,n)}evaluate(e){let r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!jm(r,["boolean","string","number","null"]))throw new Zo("Expected first argument to be of type boolean, string, number or null, but found ".concat(Ga(Xo(r))," instead."));let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),jm(i,["string"])){let a=i.indexOf(r,n);return a===-1?-1:[...i.slice(0,a)].length}else{if(jm(i,["array"]))return i.indexOf(r,n);throw new Zo("Expected second argument to be of type array or string, but found ".concat(Ga(Xo(i))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}};s(MY,"IndexOf");var wke=MY,EY=class CY{constructor(e,r,i,n,a,o){this.inputType=e,this.type=r,this.input=i,this.cases=n,this.outputs=a,this.otherwise=o}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let i,n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let a={},o=[];for(let c=2;c<e.length-1;c+=2){let p=e[c],m=e[c+1];Array.isArray(p)||(p=[p]);let y=r.concat(c);if(p.length===0)return y.error("Expected at least one branch label.");for(let w of p){if(typeof w!="number"&&typeof w!="string")return y.error("Branch labels must be numbers or strings.");if(typeof w=="number"&&Math.abs(w)>Number.MAX_SAFE_INTEGER)return y.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof w=="number"&&Math.floor(w)!==w)return y.error("Numeric branch labels must be integer values.");if(!i)i=Xo(w);else if(y.checkSubtype(i,Xo(w)))return null;if(typeof a[String(w)]<"u")return y.error("Branch labels must be unique.");a[String(w)]=o.length}let v=r.parse(m,c,n);if(!v)return null;n=n||v.type,o.push(v)}let l=r.parse(e[1],1,Gi);if(!l)return null;let u=r.parse(e[e.length-1],e.length-1,n);return!u||l.type.kind!=="value"&&r.concat(1).checkSubtype(i,l.type)?null:new CY(i,n,l,a,o,u)}evaluate(e){let r=this.input.evaluate(e);return(Xo(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}};s(EY,"Match");var Ake=EY,IY=class TY{constructor(e,r,i){this.type=e,this.branches=r,this.otherwise=i}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let n=[];for(let o=1;o<e.length-1;o+=2){let l=r.parse(e[o],o,$i);if(!l)return null;let u=r.parse(e[o+1],o+1,i);if(!u)return null;n.push([l,u]),i=i||u.type}let a=r.parse(e[e.length-1],e.length-1,i);if(!a)return null;if(!i)throw new Error("Can't infer output type");return new TY(i,n,a)}evaluate(e){for(let[r,i]of this.branches)if(r.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,i]of this.branches)e(r),e(i);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}};s(IY,"Case");var Ske=IY,PY=class hD{constructor(e,r,i,n){this.type=e,this.input=r,this.beginIndex=i,this.endIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,Gi),n=r.parse(e[2],2,wr);if(!i||!n)return null;if(!tP(i.type,[Tu(Gi),rn,Gi]))return r.error("Expected first argument to be of type array or string, but found ".concat(Ga(i.type)," instead"));if(e.length===4){let a=r.parse(e[3],3,wr);return a?new hD(i.type,i,n,a):null}else return new hD(i.type,i,n)}evaluate(e){let r=this.input.evaluate(e),i=this.beginIndex.evaluate(e),n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),jm(r,["string"]))return[...r].slice(i,n).join("");if(jm(r,["array"]))return r.slice(i,n);throw new Zo("Expected first argument to be of type array or string, but found ".concat(Ga(Xo(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};s(PY,"Slice");var Mke=PY;function _A(t,e){let r=t.length-1,i=0,n=r,a=0,o,l;for(;i<=n;)if(a=Math.floor((i+n)/2),o=t[a],l=t[a+1],o<=e){if(a===r||e<l)return a;i=a+1}else if(o>e)n=a-1;else throw new Zo("Input is not a number.");return 0}s(_A,"findStopLessThanOrEqualTo");var LY=class DY{constructor(e,r,i){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[n,a]of i)this.labels.push(n),this.outputs.push(a)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let i=r.parse(e[1],1,wr);if(!i)return null;let n=[],a=null;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);for(let o=1;o<e.length;o+=2){let l=o===1?-1/0:e[o],u=e[o+1],c=o,p=o+1;if(typeof l!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(n.length&&n[n.length-1][0]>=l)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',c);let m=r.parse(u,p,a);if(!m)return null;a=a||m.type,n.push([l,m])}return new DY(a,i,n)}evaluate(e){let r=this.labels,i=this.outputs;if(r.length===1)return i[0].evaluate(e);let n=this.input.evaluate(e);if(n<=r[0])return i[0].evaluate(e);let a=r.length;if(n>=r[a-1])return i[a-1].evaluate(e);let o=_A(r,n);return i[o].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};s(LY,"Step");var j9=LY;function RY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}s(RY,"getDefaultExportFromCjs");var LL,TH;function OY(){if(TH)return LL;TH=1,LL=t;function t(e,r,i,n){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(n-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=i,this.p2y=n}return s(t,"UnitBezier"),t.prototype={sampleCurveX:s(function(e){return((this.ax*e+this.bx)*e+this.cx)*e},"sampleCurveX"),sampleCurveY:s(function(e){return((this.ay*e+this.by)*e+this.cy)*e},"sampleCurveY"),sampleCurveDerivativeX:s(function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},"sampleCurveDerivativeX"),solveCurveX:s(function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var i=e,n=0;n<8;n++){var a=this.sampleCurveX(i)-e;if(Math.abs(a)<r)return i;var o=this.sampleCurveDerivativeX(i);if(Math.abs(o)<1e-6)break;i=i-a/o}var l=0,u=1;for(i=e,n=0;n<20&&(a=this.sampleCurveX(i),!(Math.abs(a-e)<r));n++)e>a?l=i:u=i,i=(u-l)*.5+l;return i},"solveCurveX"),solve:s(function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))},"solve")},LL}s(OY,"requireUnitbezier");var Eke=OY(),Cke=RY(Eke);function kY(t){return t==="rgb"||t==="hcl"||t==="lab"}s(kY,"isSupportedInterpolationColorSpace");function $m(t,e,r){return t+r*(e-t)}s($m,"number");function NY(t,e,r,i="rgb"){switch(i){case"rgb":{let[n,a,o,l]=yw(t.rgb,e.rgb,r);return new Li(n,a,o,l,!1)}case"hcl":{let[n,a,o,l]=t.hcl,[u,c,p,m]=e.hcl,y,v;if(!isNaN(n)&&!isNaN(u)){let P=u-n;u>n&&P>180?P-=360:u<n&&n-u>180&&(P+=360),y=n+r*P}else isNaN(n)?isNaN(u)?y=NaN:(y=u,(o===1||o===0)&&(v=c)):(y=n,(p===1||p===0)&&(v=a));let[w,E,M,I]=qZ([y,v??$m(a,c,r),$m(o,p,r),$m(l,m,r)]);return new Li(w,E,M,I,!1)}case"lab":{let[n,a,o,l]=z9(yw(t.lab,e.lab,r));return new Li(n,a,o,l,!1)}}}s(NY,"color");function yw(t,e,r){return t.map((i,n)=>$m(i,e[n],r))}s(yw,"array");function FY(t,e,r){return new Af(yw(t.values,e.values,r))}s(FY,"padding");function BY(t,e,r){let i=t.values,n=e.values;if(i.length!==n.length)throw new Zo("Cannot interpolate values of different length. from: ".concat(t.toString(),", to: ").concat(e.toString()));let a=[];for(let o=0;o<i.length;o+=2){if(i[o]!==n[o])throw new Zo("Cannot interpolate values containing mismatched anchors. from[".concat(o,"]: ").concat(i[o],", to[").concat(o,"]: ").concat(n[o]));a.push(i[o]);let[l,u]=i[o+1],[c,p]=n[o+1];a.push([$m(l,c,r),$m(u,p,r)])}return new ov(a)}s(BY,"variableAnchorOffsetCollection");var Ka={number:$m,color:NY,array:yw,padding:FY,variableAnchorOffsetCollection:BY},zY=class pD{constructor(e,r,i,n,a){this.type=e,this.operator=r,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(let[o,l]of a)this.labels.push(o),this.outputs.push(l)}static interpolationFactor(e,r,i,n){let a=0;if(e.name==="exponential")a=RE(r,e.base,i,n);else if(e.name==="linear")a=RE(r,1,i,n);else if(e.name==="cubic-bezier"){let o=e.controlPoints;a=new Cke(o[0],o[1],o[2],o[3]).solve(RE(r,1,i,n))}return a}static parse(e,r){let[i,n,a,...o]=e;if(!Array.isArray(n)||n.length===0)return r.error("Expected an interpolation type expression.",1);if(n[0]==="linear")n={name:"linear"};else if(n[0]==="exponential"){let c=n[1];if(typeof c!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:c}}else if(n[0]==="cubic-bezier"){let c=n.slice(1);if(c.length!==4||c.some(p=>typeof p!="number"||p<0||p>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:c}}else return r.error("Unknown interpolation type ".concat(String(n[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(a=r.parse(a,2,wr),!a)return null;let l=[],u=null;i==="interpolate-hcl"||i==="interpolate-lab"?u=zh:r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);for(let c=0;c<o.length;c+=2){let p=o[c],m=o[c+1],y=c+3,v=c+4;if(typeof p!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',y);if(l.length&&l[l.length-1][0]>=p)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',y);let w=r.parse(m,v,u);if(!w)return null;u=u||w.type,l.push([p,w])}return!b0(u,wr)&&!b0(u,zh)&&!b0(u,QT)&&!b0(u,eP)&&!b0(u,Tu(wr))?r.error("Type ".concat(Ga(u)," is not interpolatable.")):new pD(u,i,n,a,l)}evaluate(e){let r=this.labels,i=this.outputs;if(r.length===1)return i[0].evaluate(e);let n=this.input.evaluate(e);if(n<=r[0])return i[0].evaluate(e);let a=r.length;if(n>=r[a-1])return i[a-1].evaluate(e);let o=_A(r,n),l=r[o],u=r[o+1],c=pD.interpolationFactor(this.interpolation,n,l,u),p=i[o].evaluate(e),m=i[o+1].evaluate(e);switch(this.operator){case"interpolate":return Ka[this.type.kind](p,m,c);case"interpolate-hcl":return Ka.color(p,m,c,"hcl");case"interpolate-lab":return Ka.color(p,m,c,"lab")}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};s(zY,"Interpolate");var qp=zY;function RE(t,e,r,i){let n=i-r,a=t-r;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}s(RE,"exponentialInterpolation");var UY=class dD{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=null,n=r.expectedType;n&&n.kind!=="value"&&(i=n);let a=[];for(let o of e.slice(1)){let l=r.parse(o,1+a.length,i,void 0,{typeAnnotation:"omit"});if(!l)return null;i=i||l.type,a.push(l)}if(!i)throw new Error("No output type");return n&&a.some(o=>m_(n,o.type))?new dD(Gi,a):new dD(i,a)}evaluate(e){let r=null,i=0,n;for(let a of this.args)if(i++,r=a.evaluate(e),r&&r instanceof Kp&&!r.available&&(n||(n=r.name),r=null,i===this.args.length&&(r=n)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};s(UY,"Coalesce");var VY=UY;function fD(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}s(fD,"isComparableType");function jY(t,e,r){return e===r}s(jY,"eq");function $Y(t,e,r){return e!==r}s($Y,"neq");function GY(t,e,r){return e<r}s(GY,"lt");function HY(t,e,r){return e>r}s(HY,"gt");function qY(t,e,r){return e<=r}s(qY,"lteq");function WY(t,e,r){return e>=r}s(WY,"gteq");function $9(t,e,r,i){return i.compare(e,r)===0}s($9,"eqCollate");function XY(t,e,r,i){return!$9(t,e,r,i)}s(XY,"neqCollate");function ZY(t,e,r,i){return i.compare(e,r)<0}s(ZY,"ltCollate");function YY(t,e,r,i){return i.compare(e,r)>0}s(YY,"gtCollate");function KY(t,e,r,i){return i.compare(e,r)<=0}s(KY,"lteqCollate");function JY(t,e,r,i){return i.compare(e,r)>=0}s(JY,"gteqCollate");function sv(t,e,r){var i;let n=t!=="=="&&t!=="!=";return i=class{constructor(a,o,l){this.type=$i,this.lhs=a,this.rhs=o,this.collator=l,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}static parse(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");let l=a[0],u=o.parse(a[1],1,Gi);if(!u)return null;if(!fD(l,u.type))return o.concat(1).error('"'.concat(l,`" comparisons are not supported for type '`).concat(Ga(u.type),"'."));let c=o.parse(a[2],2,Gi);if(!c)return null;if(!fD(l,c.type))return o.concat(2).error('"'.concat(l,`" comparisons are not supported for type '`).concat(Ga(c.type),"'."));if(u.type.kind!==c.type.kind&&u.type.kind!=="value"&&c.type.kind!=="value")return o.error("Cannot compare types '".concat(Ga(u.type),"' and '").concat(Ga(c.type),"'."));n&&(u.type.kind==="value"&&c.type.kind!=="value"?u=new rf(c.type,[u]):u.type.kind!=="value"&&c.type.kind==="value"&&(c=new rf(u.type,[c])));let p=null;if(a.length===4){if(u.type.kind!=="string"&&c.type.kind!=="string"&&u.type.kind!=="value"&&c.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(p=o.parse(a[3],3,JT),!p)return null}return new i(u,c,p)}evaluate(a){let o=this.lhs.evaluate(a),l=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){let u=Xo(o),c=Xo(l);if(u.kind!==c.kind||!(u.kind==="string"||u.kind==="number"))throw new Zo('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(u.kind,", ").concat(c.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let u=Xo(o),c=Xo(l);if(u.kind!=="string"||c.kind!=="string")return e(a,o,l)}return this.collator?r(a,o,l,this.collator.evaluate(a)):e(a,o,l)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}},s(i,"Comparison"),i}s(sv,"makeComparison");var Ike=sv("==",jY,$9),Tke=sv("!=",$Y,XY),Pke=sv("<",GY,ZY),Lke=sv(">",HY,YY),Dke=sv("<=",qY,KY),Rke=sv(">=",WY,JY),QY=class eK{constructor(e,r,i){this.type=JT,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let i=e[1];if(typeof i!="object"||Array.isArray(i))return r.error("Collator options argument must be an object.");let n=r.parse(i["case-sensitive"]===void 0?!1:i["case-sensitive"],1,$i);if(!n)return null;let a=r.parse(i["diacritic-sensitive"]===void 0?!1:i["diacritic-sensitive"],1,$i);if(!a)return null;let o=null;return i.locale&&(o=r.parse(i.locale,1,rn),!o)?null:new eK(n,a,o)}evaluate(e){return new U9(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}};s(QY,"CollatorExpression");var tK=QY,rK=class iK{constructor(e,r,i,n,a){this.type=rn,this.number=e,this.locale=r,this.currency=i,this.minFractionDigits=n,this.maxFractionDigits=a}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let i=r.parse(e[1],1,wr);if(!i)return null;let n=e[2];if(typeof n!="object"||Array.isArray(n))return r.error("NumberFormat options argument must be an object.");let a=null;if(n.locale&&(a=r.parse(n.locale,1,rn),!a))return null;let o=null;if(n.currency&&(o=r.parse(n.currency,1,rn),!o))return null;let l=null;if(n["min-fraction-digits"]&&(l=r.parse(n["min-fraction-digits"],1,wr),!l))return null;let u=null;return n["max-fraction-digits"]&&(u=r.parse(n["max-fraction-digits"],1,wr),!u)?null:new iK(i,a,o,l,u)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}};s(rK,"NumberFormat");var Oke=rK,nK=class aK{constructor(e){this.type=yA,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=e[1];if(!Array.isArray(i)&&typeof i=="object")return r.error("First argument must be an image or text section.");let n=[],a=!1;for(let o=1;o<=e.length-1;++o){let l=e[o];if(a&&typeof l=="object"&&!Array.isArray(l)){a=!1;let u=null;if(l["font-scale"]&&(u=r.parse(l["font-scale"],1,wr),!u))return null;let c=null;if(l["text-font"]&&(c=r.parse(l["text-font"],1,Tu(rn)),!c))return null;let p=null;if(l["text-color"]&&(p=r.parse(l["text-color"],1,zh),!p))return null;let m=n[n.length-1];m.scale=u,m.font=c,m.textColor=p}else{let u=r.parse(e[o],1,Gi);if(!u)return null;let c=u.type.kind;if(c!=="string"&&c!=="value"&&c!=="null"&&c!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,n.push({content:u,scale:null,font:null,textColor:null})}}return new aK(n)}evaluate(e){let r=s(i=>{let n=i.content.evaluate(e);return Xo(n)===vA?new lD("",n,null,null,null):new lD(Z1(n),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)},"evaluateSection");return new df(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}};s(nK,"FormatExpression");var oK=nK,sK=class lK{constructor(e){this.type=vA,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let i=r.parse(e[1],1,rn);return i?new lK(i):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),i=Kp.fromString(r);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(r)>-1),i}eachChild(e){e(this.input)}outputDefined(){return!1}};s(sK,"ImageExpression");var kke=sK,uK=class cK{constructor(e){this.type=wr,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat(Ga(i.type)," instead.")):new cK(i):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Zo("Expected value to be of type string or array, but found ".concat(Ga(Xo(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}};s(uK,"Length");var Nke=uK,Wp=8192;function hK(t,e){let r=pK(t[0]),i=fK(t[1]),n=Math.pow(2,e.z);return[Math.round(r*n*Wp),Math.round(i*n*Wp)]}s(hK,"getTileCoordinates");function rP(t,e){let r=Math.pow(2,e.z),i=(t[0]/Wp+e.x)/r,n=(t[1]/Wp+e.y)/r;return[dK(i),mK(n)]}s(rP,"getLngLatFromTileCoord");function pK(t){return(180+t)/360}s(pK,"mercatorXfromLng");function dK(t){return t*360-180}s(dK,"lngFromMercatorXfromLng");function fK(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}s(fK,"mercatorYfromLat");function mK(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}s(mK,"latFromMercatorY");function ix(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}s(ix,"updateBBox");function y_(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}s(y_,"boxWithinBox");function gK(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}s(gK,"rayIntersect");function yK(t,e,r){let i=t[0]-e[0],n=t[1]-e[1],a=t[0]-r[0],o=t[1]-r[1];return i*o-a*n===0&&i*a<=0&&n*o<=0}s(yK,"pointOnBoundary");function xA(t,e,r,i){let n=[e[0]-t[0],e[1]-t[1]],a=[i[0]-r[0],i[1]-r[1]];return bK(a,n)===0?!1:!!(mD(t,e,r,i)&&mD(r,i,t,e))}s(xA,"segmentIntersectSegment");function vK(t,e,r){for(let i of r)for(let n=0;n<i.length-1;++n)if(xA(t,e,i[n],i[n+1]))return!0;return!1}s(vK,"lineIntersectPolygon");function lv(t,e,r=!1){let i=!1;for(let n of e)for(let a=0;a<n.length-1;a++){if(yK(t,n[a],n[a+1]))return r;gK(t,n[a],n[a+1])&&(i=!i)}return i}s(lv,"pointWithinPolygon");function _K(t,e){for(let r of e)if(lv(t,r))return!0;return!1}s(_K,"pointWithinPolygons");function G9(t,e){for(let r of t)if(!lv(r,e))return!1;for(let r=0;r<t.length-1;++r)if(vK(t[r],t[r+1],e))return!1;return!0}s(G9,"lineStringWithinPolygon");function xK(t,e){for(let r of e)if(G9(t,r))return!0;return!1}s(xK,"lineStringWithinPolygons");function bK(t,e){return t[0]*e[1]-t[1]*e[0]}s(bK,"perp");function mD(t,e,r,i){let n=t[0]-r[0],a=t[1]-r[1],o=e[0]-r[0],l=e[1]-r[1],u=i[0]-r[0],c=i[1]-r[1],p=n*c-u*a,m=o*c-u*l;return p>0&&m<0||p<0&&m>0}s(mD,"twoSided");function iP(t,e,r){let i=[];for(let n=0;n<t.length;n++){let a=[];for(let o=0;o<t[n].length;o++){let l=hK(t[n][o],r);ix(e,l),a.push(l)}i.push(a)}return i}s(iP,"getTilePolygon");function H9(t,e,r){let i=[];for(let n=0;n<t.length;n++){let a=iP(t[n],e,r);i.push(a)}return i}s(H9,"getTilePolygons");function q9(t,e,r,i){if(t[0]<r[0]||t[0]>r[2]){let n=i*.5,a=t[0]-r[0]>n?-i:r[0]-t[0]>n?i:0;a===0&&(a=t[0]-r[2]>n?-i:r[2]-t[0]>n?i:0),t[0]+=a}ix(e,t)}s(q9,"updatePoint");function wK(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}s(wK,"resetBBox");function gD(t,e,r,i){let n=Math.pow(2,i.z)*Wp,a=[i.x*Wp,i.y*Wp],o=[];for(let l of t)for(let u of l){let c=[u.x+a[0],u.y+a[1]];q9(c,e,r,n),o.push(c)}return o}s(gD,"getTilePoints");function yD(t,e,r,i){let n=Math.pow(2,i.z)*Wp,a=[i.x*Wp,i.y*Wp],o=[];for(let l of t){let u=[];for(let c of l){let p=[c.x+a[0],c.y+a[1]];ix(e,p),u.push(p)}o.push(u)}if(e[2]-e[0]<=n/2){wK(e);for(let l of o)for(let u of l)q9(u,e,r,n)}return o}s(yD,"getTileLines");function AK(t,e){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if(e.type==="Polygon"){let a=iP(e.coordinates,i,n),o=gD(t.geometry(),r,i,n);if(!y_(r,i))return!1;for(let l of o)if(!lv(l,a))return!1}if(e.type==="MultiPolygon"){let a=H9(e.coordinates,i,n),o=gD(t.geometry(),r,i,n);if(!y_(r,i))return!1;for(let l of o)if(!_K(l,a))return!1}return!0}s(AK,"pointsWithinPolygons");function SK(t,e){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if(e.type==="Polygon"){let a=iP(e.coordinates,i,n),o=yD(t.geometry(),r,i,n);if(!y_(r,i))return!1;for(let l of o)if(!G9(l,a))return!1}if(e.type==="MultiPolygon"){let a=H9(e.coordinates,i,n),o=yD(t.geometry(),r,i,n);if(!y_(r,i))return!1;for(let l of o)if(!xK(l,a))return!1}return!0}s(SK,"linesWithinPolygons");var MK=class OE{constructor(e,r){this.type=$i,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(g_(e[1])){let i=e[1];if(i.type==="FeatureCollection"){let n=[];for(let a of i.features){let{type:o,coordinates:l}=a.geometry;o==="Polygon"&&n.push(l),o==="MultiPolygon"&&n.push(...l)}if(n.length){let a={type:"MultiPolygon",coordinates:n};return new OE(i,a)}}else if(i.type==="Feature"){let n=i.geometry.type;if(n==="Polygon"||n==="MultiPolygon")return new OE(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new OE(i,i)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return AK(e,this.geometries);if(e.geometryType()==="LineString")return SK(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}};s(MK,"Within");var W9=MK,EK=class{constructor(e=[],r=(i,n)=>i<n?-1:i>n?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:i}=this,n=r[e];for(;e>0;){let a=e-1>>1,o=r[a];if(i(n,o)>=0)break;r[e]=o,e=a}r[e]=n}_down(e){let{data:r,compare:i}=this,n=this.length>>1,a=r[e];for(;e<n;){let o=(e<<1)+1,l=o+1;if(l<this.length&&i(r[l],r[o])<0&&(o=l),i(r[o],a)>=0)break;r[e]=r[o],e=o}r[e]=a}};s(EK,"TinyQueue");var CK=EK;function IK(t,e,r,i,n){X9(t,e,r,i||t.length-1,n||TK)}s(IK,"quickselect");function X9(t,e,r,i,n){for(;i>r;){if(i-r>600){var a=i-r+1,o=e-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(o-a/2<0?-1:1),p=Math.max(r,Math.floor(e-o*u/a+c)),m=Math.min(i,Math.floor(e+(a-o)*u/a+c));X9(t,e,p,m,n)}var y=t[e],v=r,w=i;for(w0(t,r,e),n(t[i],y)>0&&w0(t,r,i);v<w;){for(w0(t,v,w),v++,w--;n(t[v],y)<0;)v++;for(;n(t[w],y)>0;)w--}n(t[r],y)===0?w0(t,r,w):(w++,w0(t,w,i)),w<=e&&(r=w+1),e<=w&&(i=w-1)}}s(X9,"quickselectStep");function w0(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}s(w0,"swap");function TK(t,e){return t<e?-1:t>e?1:0}s(TK,"defaultCompare");function PK(t,e){if(t.length<=1)return[t];let r=[],i,n;for(let a of t){let o=DK(a);o!==0&&(a.area=Math.abs(o),n===void 0&&(n=o<0),n===o<0?(i&&r.push(i),i=[a]):i.push(a))}if(i&&r.push(i),e>1)for(let a=0;a<r.length;a++)r[a].length<=e||(IK(r[a],e,1,r[a].length-1,LK),r[a]=r[a].slice(0,e));return r}s(PK,"classifyRings");function LK(t,e){return e.area-t.area}s(LK,"compareAreas");function DK(t){let e=0;for(let r=0,i=t.length,n=i-1,a,o;r<i;n=r++)a=t[r],o=t[n],e+=(o.x-a.x)*(a.y+o.y);return e}s(DK,"calculateSignedArea");var Fke=6378.137,PH=1/298.257223563,LH=PH*(2-PH),DH=Math.PI/180,RK=class{constructor(e){let r=DH*Fke*1e3,i=Math.cos(e*DH),n=1/(1-LH*(1-i*i)),a=Math.sqrt(n);this.kx=r*a*i,this.ky=r*a*n*(1-LH)}distance(e,r){let i=this.wrap(e[0]-r[0])*this.kx,n=(e[1]-r[1])*this.ky;return Math.sqrt(i*i+n*n)}pointOnLine(e,r){let i=1/0,n,a,o,l;for(let u=0;u<e.length-1;u++){let c=e[u][0],p=e[u][1],m=this.wrap(e[u+1][0]-c)*this.kx,y=(e[u+1][1]-p)*this.ky,v=0;(m!==0||y!==0)&&(v=(this.wrap(r[0]-c)*this.kx*m+(r[1]-p)*this.ky*y)/(m*m+y*y),v>1?(c=e[u+1][0],p=e[u+1][1]):v>0&&(c+=m/this.kx*v,p+=y/this.ky*v)),m=this.wrap(r[0]-c)*this.kx,y=(r[1]-p)*this.ky;let w=m*m+y*y;w<i&&(i=w,n=c,a=p,o=u,l=v)}return{point:[n,a],index:o,t:Math.max(0,Math.min(1,l))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}};s(RK,"CheapRuler");var Z9=RK,vD=100,_D=50;function Y9(t,e){return e[0]-t[0]}s(Y9,"compareDistPair");function vw(t){return t[1]-t[0]+1}s(vw,"getRangeSize");function Jp(t,e){return t[1]>=t[0]&&t[1]<e}s(Jp,"isRangeSafe");function b3(t,e){if(t[0]>t[1])return[null,null];let r=vw(t);if(e){if(r===2)return[t,null];let n=Math.floor(r/2);return[[t[0],t[0]+n],[t[0]+n,t[1]]]}if(r===1)return[t,null];let i=Math.floor(r/2)-1;return[[t[0],t[0]+i],[t[0]+i+1,t[1]]]}s(b3,"splitRange");function w3(t,e){if(!Jp(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let i=e[0];i<=e[1];++i)ix(r,t[i]);return r}s(w3,"getBBox");function A3(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let i of r)ix(e,i);return e}s(A3,"getPolygonBBox");function xD(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}s(xD,"isValidBBox");function nP(t,e,r){if(!xD(t)||!xD(e))return NaN;let i=0,n=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(n=t[1]-e[3]),t[3]<e[1]&&(n=e[1]-t[3]),r.distance([0,0],[i,n])}s(nP,"bboxToBBoxDistance");function Um(t,e,r){let i=r.pointOnLine(e,t);return r.distance(t,i.point)}s(Um,"pointToLineDistance");function aP(t,e,r,i,n){let a=Math.min(Um(t,[r,i],n),Um(e,[r,i],n)),o=Math.min(Um(r,[t,e],n),Um(i,[t,e],n));return Math.min(a,o)}s(aP,"segmentToSegmentDistance");function OK(t,e,r,i,n){if(!(Jp(e,t.length)&&Jp(i,r.length)))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){let l=t[o],u=t[o+1];for(let c=i[0];c<i[1];++c){let p=r[c],m=r[c+1];if(xA(l,u,p,m))return 0;a=Math.min(a,aP(l,u,p,m,n))}}return a}s(OK,"lineToLineDistance");function kK(t,e,r,i,n){if(!(Jp(e,t.length)&&Jp(i,r.length)))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let l=i[0];l<=i[1];++l)if(a=Math.min(a,n.distance(t[o],r[l])),a===0)return a;return a}s(kK,"pointsToPointsDistance");function NK(t,e,r){if(lv(t,e,!0))return 0;let i=1/0;for(let n of e){let a=n[0],o=n[n.length-1];if(a!==o&&(i=Math.min(i,Um(t,[o,a],r)),i===0))return i;let l=r.pointOnLine(n,t);if(i=Math.min(i,r.distance(t,l.point)),i===0)return i}return i}s(NK,"pointToPolygonDistance");function FK(t,e,r,i){if(!Jp(e,t.length))return NaN;for(let a=e[0];a<=e[1];++a)if(lv(t[a],r,!0))return 0;let n=1/0;for(let a=e[0];a<e[1];++a){let o=t[a],l=t[a+1];for(let u of r)for(let c=0,p=u.length,m=p-1;c<p;m=c++){let y=u[m],v=u[c];if(xA(o,l,y,v))return 0;n=Math.min(n,aP(o,l,y,v,i))}}return n}s(FK,"lineToPolygonDistance");function bD(t,e){for(let r of t)for(let i of r)if(lv(i,e,!0))return!0;return!1}s(bD,"polygonIntersect");function BK(t,e,r,i=1/0){let n=A3(t),a=A3(e);if(i!==1/0&&nP(n,a,r)>=i)return i;if(y_(n,a)){if(bD(t,e))return 0}else if(bD(e,t))return 0;let o=1/0;for(let l of t)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let m=l[p],y=l[u];for(let v of e)for(let w=0,E=v.length,M=E-1;w<E;M=w++){let I=v[M],P=v[w];if(xA(m,y,I,P))return 0;o=Math.min(o,aP(m,y,I,P,r))}}return o}s(BK,"polygonToPolygonDistance");function wD(t,e,r,i,n,a){if(!a)return;let o=nP(w3(i,a),n,r);o<e&&t.push([o,a,[0,0]])}s(wD,"updateQueue");function Yb(t,e,r,i,n,a,o){if(!a||!o)return;let l=nP(w3(i,a),w3(n,o),r);l<e&&t.push([l,a,o])}s(Yb,"updateQueueTwoSets");function _w(t,e,r,i,n=1/0){let a=Math.min(i.distance(t[0],r[0][0]),n);if(a===0)return a;let o=new CK([[0,[0,t.length-1],[0,0]]],Y9),l=A3(r);for(;o.length>0;){let u=o.pop();if(u[0]>=a)continue;let c=u[1],p=e?_D:vD;if(vw(c)<=p){if(!Jp(c,t.length))return NaN;if(e){let m=FK(t,c,r,i);if(isNaN(m)||m===0)return m;a=Math.min(a,m)}else for(let m=c[0];m<=c[1];++m){let y=NK(t[m],r,i);if(a=Math.min(a,y),a===0)return 0}}else{let m=b3(c,e);wD(o,a,i,t,l,m[0]),wD(o,a,i,t,l,m[1])}}return a}s(_w,"pointsToPolygonDistance");function xw(t,e,r,i,n,a=1/0){let o=Math.min(a,n.distance(t[0],r[0]));if(o===0)return o;let l=new CK([[0,[0,t.length-1],[0,r.length-1]]],Y9);for(;l.length>0;){let u=l.pop();if(u[0]>=o)continue;let c=u[1],p=u[2],m=e?_D:vD,y=i?_D:vD;if(vw(c)<=m&&vw(p)<=y){if(!Jp(c,t.length)&&Jp(p,r.length))return NaN;let v;if(e&&i)v=OK(t,c,r,p,n),o=Math.min(o,v);else if(e&&!i){let w=t.slice(c[0],c[1]+1);for(let E=p[0];E<=p[1];++E)if(v=Um(r[E],w,n),o=Math.min(o,v),o===0)return o}else if(!e&&i){let w=r.slice(p[0],p[1]+1);for(let E=c[0];E<=c[1];++E)if(v=Um(t[E],w,n),o=Math.min(o,v),o===0)return o}else v=kK(t,c,r,p,n),o=Math.min(o,v)}else{let v=b3(c,e),w=b3(p,i);Yb(l,o,n,t,r,v[0],w[0]),Yb(l,o,n,t,r,v[0],w[1]),Yb(l,o,n,t,r,v[1],w[0]),Yb(l,o,n,t,r,v[1],w[1])}}return o}s(xw,"pointSetToPointSetDistance");function zK(t,e){let r=t.geometry(),i=r.flat().map(o=>rP([o.x,o.y],t.canonical));if(r.length===0)return NaN;let n=new Z9(i[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,xw(i,!1,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,xw(i,!1,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,_w(i,!1,o.coordinates,n,a));break}if(a===0)return a}return a}s(zK,"pointToGeometryDistance");function UK(t,e){let r=t.geometry(),i=r.flat().map(o=>rP([o.x,o.y],t.canonical));if(r.length===0)return NaN;let n=new Z9(i[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,xw(i,!0,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,xw(i,!0,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,_w(i,!0,o.coordinates,n,a));break}if(a===0)return a}return a}s(UK,"lineStringToGeometryDistance");function VK(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let i=PK(r,0).map(o=>o.map(l=>l.map(u=>rP([u.x,u.y],t.canonical)))),n=new Z9(i[0][0][0][1]),a=1/0;for(let o of e)for(let l of i){switch(o.type){case"Point":a=Math.min(a,_w([o.coordinates],!1,l,n,a));break;case"LineString":a=Math.min(a,_w(o.coordinates,!0,l,n,a));break;case"Polygon":a=Math.min(a,BK(l,o.coordinates,n,a));break}if(a===0)return a}return a}s(VK,"polygonToGeometryDistance");function kE(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}s(kE,"toSimpleGeometry");var jK=class NE{constructor(e,r){this.type=wr,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(g_(e[1])){let i=e[1];if(i.type==="FeatureCollection")return new NE(i,i.features.map(n=>kE(n.geometry)).flat());if(i.type==="Feature")return new NE(i,kE(i.geometry));if("type"in i&&"coordinates"in i)return new NE(i,kE(i))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return zK(e,this.geometries);if(e.geometryType()==="LineString")return UK(e,this.geometries);if(e.geometryType()==="Polygon")return VK(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}};s(jK,"Distance");var K9=jK,Y1={"==":Ike,"!=":Tke,">":Lke,"<":Pke,">=":Rke,"<=":Dke,array:rf,at:xke,boolean:rf,case:Ske,coalesce:VY,collator:tK,format:oK,image:kke,in:bke,"index-of":wke,interpolate:qp,"interpolate-hcl":qp,"interpolate-lab":qp,length:Nke,let:yY,literal:gw,match:Ake,number:rf,"number-format":Oke,object:rf,slice:Mke,step:j9,string:rf,"to-boolean":R1,"to-color":R1,"to-number":R1,"to-string":R1,var:xY,within:W9,distance:K9},$K=class Kb{constructor(e,r,i,n){this.name=e,this.type=r,this._evaluate=i,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let i=e[0],n=Kb.definitions[i];if(!n)return r.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0);let a=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,l=o.filter(([c])=>!Array.isArray(c)||c.length===e.length-1),u=null;for(let[c,p]of l){u=new fY(r.registry,bw,r.path,null,r.scope);let m=[],y=!1;for(let v=1;v<e.length;v++){let w=e[v],E=Array.isArray(c)?c[v-1]:c.type,M=u.parse(w,1+m.length,E);if(!M){y=!0;break}m.push(M)}if(!y){if(Array.isArray(c)&&c.length!==m.length){u.error("Expected ".concat(c.length," arguments, but found ").concat(m.length," instead."));continue}for(let v=0;v<m.length;v++){let w=Array.isArray(c)?c[v]:c.type,E=m[v];u.concat(v+1).checkSubtype(w,E.type)}if(u.errors.length===0)return new Kb(i,a,p,m)}}if(l.length===1)r.errors.push(...u.errors);else{let c=(l.length?l:o).map(([m])=>HK(m)).join(" | "),p=[];for(let m=1;m<e.length;m++){let y=r.parse(e[m],1+p.length);if(!y)return null;p.push(Ga(y.type))}r.error("Expected arguments of type ".concat(c,", but found (").concat(p.join(", "),") instead."))}return null}static register(e,r){Kb.definitions=r;for(let i in r)e[i]=Kb}};s($K,"CompoundExpression");var uv=$K;function AD(t,[e,r,i,n]){e=e.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);let a=n?n.evaluate(t):1,o=V9(e,r,i,a);if(o)throw new Zo(o);return new Li(e/255,r/255,i/255,a,!1)}s(AD,"rgba");function SD(t,e){return t in e}s(SD,"has");function FE(t,e){let r=e[t];return typeof r>"u"?null:r}s(FE,"get");function GK(t,e,r,i){for(;r<=i;){let n=r+i>>1;if(e[n]===t)return!0;e[n]>t?i=n-1:r=n+1}return!1}s(GK,"binarySearch");function cm(t){return{type:t}}s(cm,"varargs");uv.register(Y1,{error:[pke,[rn],(t,[e])=>{throw new Zo(e.evaluate(t))}],typeof:[rn,[Gi],(t,[e])=>Ga(Xo(e.evaluate(t)))],"to-rgba":[Tu(wr,4),[zh],(t,[e])=>{let[r,i,n,a]=e.evaluate(t).rgb;return[r*255,i*255,n*255,a]}],rgb:[zh,[wr,wr,wr],AD],rgba:[zh,[wr,wr,wr,wr],AD],has:{type:$i,overloads:[[[rn],(t,[e])=>SD(e.evaluate(t),t.properties())],[[rn,W1],(t,[e,r])=>SD(e.evaluate(t),r.evaluate(t))]]},get:{type:Gi,overloads:[[[rn],(t,[e])=>FE(e.evaluate(t),t.properties())],[[rn,W1],(t,[e,r])=>FE(e.evaluate(t),r.evaluate(t))]]},"feature-state":[Gi,[rn],(t,[e])=>FE(e.evaluate(t),t.featureState||{})],properties:[W1,[],t=>t.properties()],"geometry-type":[rn,[],t=>t.geometryType()],id:[Gi,[],t=>t.id()],zoom:[wr,[],t=>t.globals.zoom],"heatmap-density":[wr,[],t=>t.globals.heatmapDensity||0],"line-progress":[wr,[],t=>t.globals.lineProgress||0],accumulated:[Gi,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[wr,cm(wr),(t,e)=>{let r=0;for(let i of e)r+=i.evaluate(t);return r}],"*":[wr,cm(wr),(t,e)=>{let r=1;for(let i of e)r*=i.evaluate(t);return r}],"-":{type:wr,overloads:[[[wr,wr],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[wr],(t,[e])=>-e.evaluate(t)]]},"/":[wr,[wr,wr],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[wr,[wr,wr],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[wr,[],()=>Math.LN2],pi:[wr,[],()=>Math.PI],e:[wr,[],()=>Math.E],"^":[wr,[wr,wr],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[wr,[wr],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[wr,[wr],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[wr,[wr],(t,[e])=>Math.log(e.evaluate(t))],log2:[wr,[wr],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[wr,[wr],(t,[e])=>Math.sin(e.evaluate(t))],cos:[wr,[wr],(t,[e])=>Math.cos(e.evaluate(t))],tan:[wr,[wr],(t,[e])=>Math.tan(e.evaluate(t))],asin:[wr,[wr],(t,[e])=>Math.asin(e.evaluate(t))],acos:[wr,[wr],(t,[e])=>Math.acos(e.evaluate(t))],atan:[wr,[wr],(t,[e])=>Math.atan(e.evaluate(t))],min:[wr,cm(wr),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[wr,cm(wr),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[wr,[wr],(t,[e])=>Math.abs(e.evaluate(t))],round:[wr,[wr],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[wr,[wr],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[wr,[wr],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[$i,[rn,Gi],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[$i,[Gi],(t,[e])=>t.id()===e.value],"filter-type-==":[$i,[rn],(t,[e])=>t.geometryType()===e.value],"filter-<":[$i,[rn,Gi],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i<n}],"filter-id-<":[$i,[Gi],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r<i}],"filter->":[$i,[rn,Gi],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i>n}],"filter-id->":[$i,[Gi],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r>i}],"filter-<=":[$i,[rn,Gi],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i<=n}],"filter-id-<=":[$i,[Gi],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r<=i}],"filter->=":[$i,[rn,Gi],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i>=n}],"filter-id->=":[$i,[Gi],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r>=i}],"filter-has":[$i,[Gi],(t,[e])=>e.value in t.properties()],"filter-has-id":[$i,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[$i,[Tu(rn)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[$i,[Tu(Gi)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[$i,[rn,Tu(Gi)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[$i,[rn,Tu(Gi)],(t,[e,r])=>GK(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:$i,overloads:[[[$i,$i],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[cm($i),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:$i,overloads:[[[$i,$i],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[cm($i),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[$i,[$i],(t,[e])=>!e.evaluate(t)],"is-supported-script":[$i,[rn],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[rn,[rn],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[rn,[rn],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[rn,cm(Gi),(t,e)=>e.map(r=>Z1(r.evaluate(t))).join("")],"resolved-locale":[rn,[JT],(t,[e])=>e.evaluate(t).resolvedLocale()]});function HK(t){return Array.isArray(t)?"(".concat(t.map(Ga).join(", "),")"):"(".concat(Ga(t.type),"...)")}s(HK,"stringifySignature");function bw(t){if(t instanceof xY)return bw(t.boundExpression);if(t instanceof uv&&t.name==="error"||t instanceof tK||t instanceof W9||t instanceof K9)return!1;let e=t instanceof R1||t instanceof rf,r=!0;return t.eachChild(i=>{e?r=r&&bw(i):r=r&&i instanceof gw}),r?bA(t)&&wA(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}s(bw,"isExpressionConstant");function bA(t){if(t instanceof uv&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof W9||t instanceof K9)return!1;let e=!0;return t.eachChild(r=>{e&&!bA(r)&&(e=!1)}),e}s(bA,"isFeatureConstant");function v_(t){if(t instanceof uv&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!v_(r)&&(e=!1)}),e}s(v_,"isStateConstant");function wA(t,e){if(t instanceof uv&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(i=>{r&&!wA(i,e)&&(r=!1)}),r}s(wA,"isGlobalPropertyConstant");function S3(t){return{result:"success",value:t}}s(S3,"success");function py(t){return{result:"error",value:t}}s(py,"error");function $y(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}s($y,"supportsPropertyExpression");function J9(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}s(J9,"supportsZoomExpression");function oP(t){return!!t.expression&&t.expression.interpolated}s(oP,"supportsInterpolation");function An(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}s(An,"getType");function AA(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}s(AA,"isFunction$1");function qK(t){return t}s(qK,"identityFunction");function Q9(t,e){let r=e.type==="color",i=t.stops&&typeof t.stops[0][0]=="object",n=i||t.property!==void 0,a=i||!n,o=t.type||(oP(e)?"exponential":"interval");if(r||e.type==="padding"){let p=r?Li.parse:Af.parse;t=jy({},t),t.stops&&(t.stops=t.stops.map(m=>[m[0],p(m[1])])),t.default?t.default=p(t.default):t.default=p(e.default)}if(t.colorSpace&&!kY(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let l,u,c;if(o==="exponential")l=MD;else if(o==="interval")l=XK;else if(o==="categorical"){l=WK,u=Object.create(null);for(let p of t.stops)u[p[0]]=p[1];c=typeof t.stops[0][0]}else if(o==="identity")l=ZK;else throw new Error('Unknown function type "'.concat(o,'"'));if(i){let p={},m=[];for(let w=0;w<t.stops.length;w++){let E=t.stops[w],M=E[0].zoom;p[M]===void 0&&(p[M]={zoom:M,type:t.type,property:t.property,default:t.default,stops:[]},m.push(M)),p[M].stops.push([E[0].value,E[1]])}let y=[];for(let w of m)y.push([p[w].zoom,Q9(p[w],e)]);let v={name:"linear"};return{kind:"composite",interpolationType:v,interpolationFactor:qp.interpolationFactor.bind(void 0,v),zoomStops:y.map(w=>w[0]),evaluate({zoom:w},E){return MD({stops:y,base:t.base},e,w).evaluate(w,E)}}}else if(a){let p=o==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:p,interpolationFactor:qp.interpolationFactor.bind(void 0,p),zoomStops:t.stops.map(m=>m[0]),evaluate:s(({zoom:m})=>l(t,e,m,u,c),"evaluate")}}else return{kind:"source",evaluate(p,m){let y=m&&m.properties?m.properties[t.property]:void 0;return y===void 0?nx(t.default,e.default):l(t,e,y,u,c)}}}s(Q9,"createFunction");function nx(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}s(nx,"coalesce$1");function WK(t,e,r,i,n){let a=typeof r===n?i[r]:void 0;return nx(a,t.default,e.default)}s(WK,"evaluateCategoricalFunction");function XK(t,e,r){if(An(r)!=="number")return nx(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let n=_A(t.stops.map(a=>a[0]),r);return t.stops[n][1]}s(XK,"evaluateIntervalFunction");function MD(t,e,r){let i=t.base!==void 0?t.base:1;if(An(r)!=="number")return nx(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let a=_A(t.stops.map(p=>p[0]),r),o=YK(r,i,t.stops[a][0],t.stops[a+1][0]),l=t.stops[a][1],u=t.stops[a+1][1],c=Ka[e.type]||qK;return typeof l.evaluate=="function"?{evaluate(...p){let m=l.evaluate.apply(void 0,p),y=u.evaluate.apply(void 0,p);if(!(m===void 0||y===void 0))return c(m,y,o,t.colorSpace)}}:c(l,u,o,t.colorSpace)}s(MD,"evaluateExponentialFunction");function ZK(t,e,r){switch(e.type){case"color":r=Li.parse(r);break;case"formatted":r=df.fromString(r.toString());break;case"resolvedImage":r=Kp.fromString(r.toString());break;case"padding":r=Af.parse(r);break;default:An(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return nx(r,t.default,e.default)}s(ZK,"evaluateIdentityFunction");function YK(t,e,r,i){let n=i-r,a=t-r;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}s(YK,"interpolationFactor");var KK=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new hY,this._defaultValue=r?aJ(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,i,n,a,o){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=i,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,r,i,n,a,o){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null;try{let l=this.expression.evaluate(this._evaluator);if(l==null||typeof l=="number"&&l!==l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new Zo("Expected value to be one of ".concat(Object.keys(this._enumValues).map(u=>JSON.stringify(u)).join(", "),", but found ").concat(JSON.stringify(l)," instead."));return l}catch(l){return this._warningHistory[l.message]||(this._warningHistory[l.message]=!0,typeof console<"u"&&console.warn(l.message)),this._defaultValue}}};s(KK,"StyleExpression");var e7=KK;function ax(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Y1}s(ax,"isExpression");function sP(t,e){let r=new fY(Y1,bw,[],e?nJ(e):void 0),i=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return i?S3(new e7(i,e)):py(r.errors)}s(sP,"createExpression");var JK=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!v_(r.expression)}evaluateWithoutErrorHandling(e,r,i,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,r,i,n,a,o)}evaluate(e,r,i,n,a,o){return this._styleExpression.evaluate(e,r,i,n,a,o)}};s(JK,"ZoomConstantExpression");var M3=JK,QK=class{constructor(e,r,i,n){this.kind=e,this.zoomStops=i,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!v_(r.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,r,i,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,r,i,n,a,o)}evaluate(e,r,i,n,a,o){return this._styleExpression.evaluate(e,r,i,n,a,o)}interpolationFactor(e,r,i){return this.interpolationType?qp.interpolationFactor(this.interpolationType,e,r,i):0}};s(QK,"ZoomDependentExpression");var E3=QK;function t7(t,e){let r=sP(t,e);if(r.result==="error")return r;let i=r.value.expression,n=bA(i);if(!n&&!$y(e))return py([new Fp("","data expressions not supported")]);let a=wA(i,["zoom"]);if(!a&&!J9(e))return py([new Fp("","zoom expressions not supported")]);let o=ow(i);if(!o&&!a)return py([new Fp("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Fp)return py([o]);if(o instanceof qp&&!oP(e))return py([new Fp("",'"interpolate" expressions cannot be used with this property')]);if(!o)return S3(n?new M3("constant",r.value):new M3("source",r.value));let l=o instanceof qp?o.interpolation:void 0;return S3(n?new E3("camera",r.value,o.labels,l):new E3("composite",r.value,o.labels,l))}s(t7,"createPropertyExpression");var eJ=class tJ{constructor(e,r){this._parameters=e,this._specification=r,jy(this,Q9(this._parameters,this._specification))}static deserialize(e){return new tJ(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};s(eJ,"StylePropertyFunction");var rJ=eJ;function iJ(t,e){if(AA(t))return new rJ(t,e);if(ax(t)){let r=t7(t,e);if(r.result==="error")throw new Error(r.value.map(i=>"".concat(i.key,": ").concat(i.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=Li.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Af.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)&&(r=ov.parse(t)),{kind:"constant",evaluate:s(()=>r,"evaluate")}}}s(iJ,"normalizePropertyExpression");function ow(t){let e=null;if(t instanceof yY)e=ow(t.result);else if(t instanceof VY){for(let r of t.args)if(e=ow(r),e)break}else(t instanceof j9||t instanceof qp)&&t.input instanceof uv&&t.input.name==="zoom"&&(e=t);return e instanceof Fp||t.eachChild(r=>{let i=ow(r);i instanceof Fp?e=i:!e&&i?e=new Fp("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new Fp("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}s(ow,"findZoomCurve");function nJ(t){let e={color:zh,string:rn,number:wr,enum:rn,boolean:$i,formatted:yA,padding:QT,resolvedImage:vA,variableAnchorOffsetCollection:eP};return t.type==="array"?Tu(e[t.value]||Gi,t.length):e[t.type]}s(nJ,"getExpectedType");function aJ(t){return t.type==="color"&&AA(t.default)?new Li(0,0,0,0):t.type==="color"?Li.parse(t.default)||null:t.type==="padding"?Af.parse(t.default)||null:t.type==="variableAnchorOffsetCollection"?ov.parse(t.default)||null:t.default===void 0?null:t.default}s(aJ,"getDefaultValue");function lP(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!lP(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}s(lP,"isExpressionFilter");var Bke={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function C3(t){if(t==null)return{filter:s(()=>!0,"filter"),needGeometry:!1};lP(t)||(t=ww(t));let e=sP(t,Bke);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=r7(t);return{filter:s((i,n,a)=>e.value.evaluate(i,n,{},a),"filter"),needGeometry:r}}}s(C3,"createFilter");function oJ(t,e){return t<e?-1:t>e?1:0}s(oJ,"compare");function r7(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(r7(t[e]))return!0;return!1}s(r7,"geometryNeeded");function ww(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?BE(t[1],t[2],"=="):e==="!="?Jb(BE(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?BE(t[1],t[2],e):e==="any"?sJ(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(ww)):e==="none"?["all"].concat(t.slice(1).map(ww).map(Jb)):e==="in"?ED(t[1],t.slice(2)):e==="!in"?Jb(ED(t[1],t.slice(2))):e==="has"?CD(t[1]):e==="!has"?Jb(CD(t[1])):!0}s(ww,"convertFilter$1");function BE(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}s(BE,"convertComparisonOp$1");function sJ(t){return["any"].concat(t.map(ww))}s(sJ,"convertDisjunctionOp");function ED(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(oJ)]]:["filter-in-small",t,["literal",e]]}}s(ED,"convertInOp$1");function CD(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}s(CD,"convertHasOp$1");function Jb(t){return["!",t]}s(Jb,"convertNegation");function lJ(){let t={},e=Ut.$version;for(let r in Ut.$root){let i=Ut.$root[r];if(i.required){let n=null;r==="version"?n=e:i.type==="array"?n=[]:n={},n!=null&&(t[r]=n)}}return t}s(lJ,"emptyStyle");function i7(t){let e=t.key,r=t.value;return r?[new _r(e,r,"constants have been deprecated as of v8")]:[]}s(i7,"validateConstants");function mo(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}s(mo,"unbundle");function Zm(t){if(Array.isArray(t))return t.map(Zm);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Zm(t[r]);return e}return mo(t)}s(Zm,"deepUnbundle");function gc(t){let e=t.key,r=t.value,i=t.valueSpec||{},n=t.objectElementValidators||{},a=t.style,o=t.styleSpec,l=t.validateSpec,u=[],c=An(r);if(c!=="object")return[new _r(e,r,"object expected, ".concat(c," found"))];for(let p in r){let m=p.split(".")[0],y=i[m]||i["*"],v;if(n[m])v=n[m];else if(i[m])v=l;else if(n["*"])v=n["*"];else if(i["*"])v=l;else{u.push(new _r(e,r[p],'unknown property "'.concat(p,'"')));continue}u=u.concat(v({key:(e&&"".concat(e,"."))+p,value:r[p],valueSpec:y,style:a,styleSpec:o,object:r,objectKey:p,validateSpec:l},r))}for(let p in i)n[p]||i[p].required&&i[p].default===void 0&&r[p]===void 0&&u.push(new _r(e,r,'missing required property "'.concat(p,'"')));return u}s(gc,"validateObject");function uP(t){let e=t.value,r=t.valueSpec,i=t.validateSpec,n=t.style,a=t.styleSpec,o=t.key,l=t.arrayElementValidator||i;if(An(e)!=="array")return[new _r(o,e,"array expected, ".concat(An(e)," found"))];if(r.length&&e.length!==r.length)return[new _r(o,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new _r(o,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let u={type:r.value,values:r.values};a.$version<7&&(u.function=r.function),An(r.value)==="object"&&(u=r.value);let c=[];for(let p=0;p<e.length;p++)c=c.concat(l({array:e,arrayIndex:p,value:e[p],valueSpec:u,validateSpec:t.validateSpec,style:n,styleSpec:a,key:"".concat(o,"[").concat(p,"]")}));return c}s(uP,"validateArray");function cP(t){let e=t.key,r=t.value,i=t.valueSpec,n=An(r);return n==="number"&&r!==r&&(n="NaN"),n!=="number"?[new _r(e,r,"number expected, ".concat(n," found"))]:"minimum"in i&&r<i.minimum?[new _r(e,r,"".concat(r," is less than the minimum value ").concat(i.minimum))]:"maximum"in i&&r>i.maximum?[new _r(e,r,"".concat(r," is greater than the maximum value ").concat(i.maximum))]:[]}s(cP,"validateNumber");function n7(t){let e=t.valueSpec,r=mo(t.value.type),i,n={},a,o,l=r!=="categorical"&&t.value.property===void 0,u=!l,c=An(t.value.stops)==="array"&&An(t.value.stops[0])==="array"&&An(t.value.stops[0][0])==="object",p=gc({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:m,default:w}});return r==="identity"&&l&&p.push(new _r(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&p.push(new _r(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!oP(t.valueSpec)&&p.push(new _r(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!$y(t.valueSpec)?p.push(new _r(t.key,t.value,"property functions not supported")):l&&!J9(t.valueSpec)&&p.push(new _r(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||c)&&t.value.property===void 0&&p.push(new _r(t.key,t.value,'"property" property is required')),p;function m(E){if(r==="identity")return[new _r(E.key,E.value,'identity function may not have a "stops" property')];let M=[],I=E.value;return M=M.concat(uP({key:E.key,value:I,valueSpec:E.valueSpec,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec,arrayElementValidator:y})),An(I)==="array"&&I.length===0&&M.push(new _r(E.key,I,"array must have at least one stop")),M}function y(E){let M=[],I=E.value,P=E.key;if(An(I)!=="array")return[new _r(P,I,"array expected, ".concat(An(I)," found"))];if(I.length!==2)return[new _r(P,I,"array length 2 expected, length ".concat(I.length," found"))];if(c){if(An(I[0])!=="object")return[new _r(P,I,"object expected, ".concat(An(I[0])," found"))];if(I[0].zoom===void 0)return[new _r(P,I,"object stop key must have zoom")];if(I[0].value===void 0)return[new _r(P,I,"object stop key must have value")];if(o&&o>mo(I[0].zoom))return[new _r(P,I[0].zoom,"stop zoom values must appear in ascending order")];mo(I[0].zoom)!==o&&(o=mo(I[0].zoom),a=void 0,n={}),M=M.concat(gc({key:"".concat(P,"[0]"),value:I[0],valueSpec:{zoom:{}},validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{zoom:cP,value:v}}))}else M=M.concat(v({key:"".concat(P,"[0]"),value:I[0],validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec},I));return ax(Zm(I[1]))?M.concat([new _r("".concat(P,"[1]"),I[1],"expressions are not allowed in function stops.")]):M.concat(E.validateSpec({key:"".concat(P,"[1]"),value:I[1],valueSpec:e,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec}))}function v(E,M){let I=An(E.value),P=mo(E.value),C=E.value!==null?E.value:M;if(!i)i=I;else if(I!==i)return[new _r(E.key,C,"".concat(I," stop domain type must match previous stop domain type ").concat(i))];if(I!=="number"&&I!=="string"&&I!=="boolean")return[new _r(E.key,C,"stop domain value must be a number, string, or boolean")];if(I!=="number"&&r!=="categorical"){let T="number expected, ".concat(I," found");return $y(e)&&r===void 0&&(T+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _r(E.key,C,T)]}return r==="categorical"&&I==="number"&&(!isFinite(P)||Math.floor(P)!==P)?[new _r(E.key,C,"integer expected, found ".concat(P))]:r!=="categorical"&&I==="number"&&a!==void 0&&P<a?[new _r(E.key,C,"stop domain values must appear in ascending order")]:(a=P,r==="categorical"&&P in n?[new _r(E.key,C,"stop domain values must be unique")]:(n[P]=!0,[]))}function w(E){return E.validateSpec({key:E.key,value:E.value,valueSpec:e,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec})}}s(n7,"validateFunction");function Gy(t){let e=(t.expressionContext==="property"?t7:sP)(Zm(t.value),t.valueSpec);if(e.result==="error")return e.value.map(i=>new _r("".concat(t.key).concat(i.key),t.value,i.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new _r(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!v_(r))return[new _r(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!v_(r))return[new _r(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!wA(r,["zoom","feature-state"]))return[new _r(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!bA(r))return[new _r(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}s(Gy,"validateExpression");function uJ(t){let e=t.value,r=t.key,i=An(e);return i!=="boolean"?[new _r(r,e,"boolean expected, ".concat(i," found"))]:[]}s(uJ,"validateBoolean");function cJ(t){let e=t.key,r=t.value,i=An(r);return i!=="string"?[new _r(e,r,"color expected, ".concat(i," found"))]:Li.parse(String(r))?[]:[new _r(e,r,'color expected, "'.concat(r,'" found'))]}s(cJ,"validateColor");function __(t){let e=t.key,r=t.value,i=t.valueSpec,n=[];return Array.isArray(i.values)?i.values.indexOf(mo(r))===-1&&n.push(new _r(e,r,"expected one of [".concat(i.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(i.values).indexOf(mo(r))===-1&&n.push(new _r(e,r,"expected one of [".concat(Object.keys(i.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),n}s(__,"validateEnum");function hP(t){return lP(Zm(t.value))?Gy(jy({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):a7(t)}s(hP,"validateFilter");function a7(t){let e=t.value,r=t.key;if(An(e)!=="array")return[new _r(r,e,"array expected, ".concat(An(e)," found"))];let i=t.styleSpec,n,a=[];if(e.length<1)return[new _r(r,e,"filter array must have at least 1 element")];switch(a=a.concat(__({key:"".concat(r,"[0]"),value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),mo(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&mo(e[1])==="$type"&&a.push(new _r(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&a.push(new _r(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(n=An(e[1]),n!=="string"&&a.push(new _r("".concat(r,"[1]"),e[1],"string expected, ".concat(n," found"))));for(let o=2;o<e.length;o++)n=An(e[o]),mo(e[1])==="$type"?a=a.concat(__({key:"".concat(r,"[").concat(o,"]"),value:e[o],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):n!=="string"&&n!=="number"&&n!=="boolean"&&a.push(new _r("".concat(r,"[").concat(o,"]"),e[o],"string, number, or boolean expected, ".concat(n," found")));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)a=a.concat(a7({key:"".concat(r,"[").concat(o,"]"),value:e[o],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":n=An(e[1]),e.length!==2?a.push(new _r(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):n!=="string"&&a.push(new _r("".concat(r,"[1]"),e[1],"string expected, ".concat(n," found")));break}return a}s(a7,"validateNonExpressionFilter");function o7(t,e){let r=t.key,i=t.validateSpec,n=t.style,a=t.styleSpec,o=t.value,l=t.objectKey,u=a["".concat(e,"_").concat(t.layerType)];if(!u)return[];let c=l.match(/^(.*)-transition$/);if(e==="paint"&&c&&u[c[1]]&&u[c[1]].transition)return i({key:r,value:o,valueSpec:a.transition,style:n,styleSpec:a});let p=t.valueSpec||u[l];if(!p)return[new _r(r,o,'unknown property "'.concat(l,'"'))];let m;if(An(o)==="string"&&$y(p)&&!p.tokens&&(m=/^{([^}]+)}$/.exec(o)))return[new _r(r,o,'"'.concat(l,`" does not support interpolation syntax
`)+'Use an identity property function instead: `{ "type": "identity", "property": '.concat(JSON.stringify(m[1])," }`."))];let y=[];return t.layerType==="symbol"&&(l==="text-field"&&n&&!n.glyphs&&y.push(new _r(r,o,'use of "text-field" requires a style "glyphs" property')),l==="text-font"&&AA(Zm(o))&&mo(o.type)==="identity"&&y.push(new _r(r,o,'"text-font" does not support identity functions'))),y.concat(i({key:t.key,value:o,valueSpec:p,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:l}))}s(o7,"validateProperty");function s7(t){return o7(t,"paint")}s(s7,"validatePaintProperty");function l7(t){return o7(t,"layout")}s(l7,"validateLayoutProperty");function u7(t){let e=[],r=t.value,i=t.key,n=t.style,a=t.styleSpec;!r.type&&!r.ref&&e.push(new _r(i,r,'either "type" or "ref" is required'));let o=mo(r.type),l=mo(r.ref);if(r.id){let u=mo(r.id);for(let c=0;c<t.arrayIndex;c++){let p=n.layers[c];mo(p.id)===u&&e.push(new _r(i,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(p.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(c=>{c in r&&e.push(new _r(i,r[c],'"'.concat(c,'" is prohibited for ref layers')))});let u;n.layers.forEach(c=>{mo(c.id)===l&&(u=c)}),u?u.ref?e.push(new _r(i,r.ref,"ref cannot reference another ref layer")):o=mo(u.type):e.push(new _r(i,r.ref,'ref layer "'.concat(l,'" not found')))}else if(o!=="background")if(!r.source)e.push(new _r(i,r,'missing required property "source"'));else{let u=n.sources&&n.sources[r.source],c=u&&mo(u.type);u?c==="vector"&&o==="raster"?e.push(new _r(i,r.source,'layer "'.concat(r.id,'" requires a raster source'))):c!=="raster-dem"&&o==="hillshade"?e.push(new _r(i,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):c==="raster"&&o!=="raster"?e.push(new _r(i,r.source,'layer "'.concat(r.id,'" requires a vector source'))):c==="vector"&&!r["source-layer"]?e.push(new _r(i,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):c==="raster-dem"&&o!=="hillshade"?e.push(new _r(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):o==="line"&&r.paint&&r.paint["line-gradient"]&&(c!=="geojson"||!u.lineMetrics)&&e.push(new _r(i,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new _r(i,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(gc({key:i,value:r,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(i,".type"),value:r.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:hP,layout(u){return gc({layer:r,key:u.key,value:u.value,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*"(c){return l7(jy({layerType:o},c))}}})},paint(u){return gc({layer:r,key:u.key,value:u.value,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*"(c){return s7(jy({layerType:o},c))}}})}}})),e}s(u7,"validateLayer");function Ym(t){let e=t.value,r=t.key,i=An(e);return i!=="string"?[new _r(r,e,"string expected, ".concat(i," found"))]:[]}s(Ym,"validateString");function hJ(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",i=t.value,n=t.styleSpec,a=n.source_raster_dem,o=t.style,l=[],u=An(i);if(i===void 0)return l;if(u!=="object")return l.push(new _r("source_raster_dem",i,"object expected, ".concat(u," found"))),l;let c=mo(i.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],m=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let y in i)!c&&p.includes(y)?l.push(new _r(y,i[y],'In "'.concat(r,'": "').concat(y,'" is only valid when "encoding" is set to "custom". ').concat(m," encoding found"))):a[y]?l=l.concat(t.validateSpec({key:y,value:i[y],valueSpec:a[y],validateSpec:t.validateSpec,style:o,styleSpec:n})):l.push(new _r(y,i[y],'unknown property "'.concat(y,'"')));return l}s(hJ,"validateRasterDEMSource");var RH={promoteId:pJ};function c7(t){let e=t.value,r=t.key,i=t.styleSpec,n=t.style,a=t.validateSpec;if(!e.type)return[new _r(r,e,'"type" is required')];let o=mo(e.type),l;switch(o){case"vector":case"raster":return l=gc({key:r,value:e,valueSpec:i["source_".concat(o.replace("-","_"))],style:t.style,styleSpec:i,objectElementValidators:RH,validateSpec:a}),l;case"raster-dem":return l=hJ({sourceName:r,value:e,style:t.style,styleSpec:i,validateSpec:a}),l;case"geojson":if(l=gc({key:r,value:e,valueSpec:i.source_geojson,style:n,styleSpec:i,validateSpec:a,objectElementValidators:RH}),e.cluster)for(let u in e.clusterProperties){let[c,p]=e.clusterProperties[u],m=typeof c=="string"?[c,["accumulated"],["get",u]]:c;l.push(...Gy({key:"".concat(r,".").concat(u,".map"),value:p,expressionContext:"cluster-map"})),l.push(...Gy({key:"".concat(r,".").concat(u,".reduce"),value:m,expressionContext:"cluster-reduce"}))}return l;case"video":return gc({key:r,value:e,valueSpec:i.source_video,style:n,validateSpec:a,styleSpec:i});case"image":return gc({key:r,value:e,valueSpec:i.source_image,style:n,validateSpec:a,styleSpec:i});case"canvas":return[new _r(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return __({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}s(c7,"validateSource");function pJ({key:t,value:e}){if(An(e)==="string")return Ym({key:t,value:e});{let r=[];for(let i in e)r.push(...Ym({key:"".concat(t,".").concat(i),value:e[i]}));return r}}s(pJ,"validatePromoteId");function h7(t){let e=t.value,r=t.styleSpec,i=r.light,n=t.style,a=[],o=An(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new _r("light",e,"object expected, ".concat(o," found"))]),a;for(let l in e){let u=l.match(/^(.*)-transition$/);u&&i[u[1]]&&i[u[1]].transition?a=a.concat(t.validateSpec({key:l,value:e[l],valueSpec:r.transition,validateSpec:t.validateSpec,style:n,styleSpec:r})):i[l]?a=a.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],validateSpec:t.validateSpec,style:n,styleSpec:r})):a=a.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))])}return a}s(h7,"validateLight");function p7(t){let e=t.value,r=t.styleSpec,i=r.sky,n=t.style,a=An(e);if(e===void 0)return[];if(a!=="object")return[new _r("sky",e,"object expected, ".concat(a," found"))];let o=[];for(let l in e)i[l]?o=o.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],style:n,styleSpec:r})):o=o.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))]);return o}s(p7,"validateSky");function d7(t){let e=t.value,r=t.styleSpec,i=r.terrain,n=t.style,a=[],o=An(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new _r("terrain",e,"object expected, ".concat(o," found"))]),a;for(let l in e)i[l]?a=a.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],validateSpec:t.validateSpec,style:n,styleSpec:r})):a=a.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))]);return a}s(d7,"validateTerrain");function dJ(t){return Ym(t).length===0?[]:Gy(t)}s(dJ,"validateFormatted");function fJ(t){return Ym(t).length===0?[]:Gy(t)}s(fJ,"validateImage");function mJ(t){let e=t.key,r=t.value;if(An(r)==="array"){if(r.length<1||r.length>4)return[new _r(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},n=[];for(let a=0;a<r.length;a++)n=n.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return n}else return cP({key:e,value:r,valueSpec:{}})}s(mJ,"validatePadding");function gJ(t){let e=t.key,r=t.value,i=An(r),n=t.styleSpec;if(i!=="array"||r.length<1||r.length%2!==0)return[new _r(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<r.length;o+=2)a=a.concat(__({key:"".concat(e,"[").concat(o,"]"),value:r[o],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(uP({key:"".concat(e,"[").concat(o+1,"]"),value:r[o+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:n}));return a}s(gJ,"validateVariableAnchorOffsetCollection");function f7(t){let e=[],r=t.value,i=t.key;if(Array.isArray(r)){let n=[],a=[];for(let o in r){r[o].id&&n.includes(r[o].id)&&e.push(new _r(i,r,"all the sprites' ids must be unique, but ".concat(r[o].id," is duplicated"))),n.push(r[o].id),r[o].url&&a.includes(r[o].url)&&e.push(new _r(i,r,"all the sprites' URLs must be unique, but ".concat(r[o].url," is duplicated"))),a.push(r[o].url);let l={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(gc({key:"".concat(i,"[").concat(o,"]"),value:r[o],valueSpec:l,validateSpec:t.validateSpec}))}return e}else return Ym({key:i,value:r})}s(f7,"validateSprite");function yJ(t){let e=t.value,r=t.styleSpec,i=r.projection,n=t.style,a=An(e);if(e===void 0)return[];if(a!=="object")return[new _r("projection",e,"object expected, ".concat(a," found"))];let o=[];for(let l in e)i[l]?o=o.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],style:n,styleSpec:r})):o=o.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))]);return o}s(yJ,"validateProjection");var OH={"*"(){return[]},array:uP,boolean:uJ,number:cP,color:cJ,constants:i7,enum:__,filter:hP,function:n7,layer:u7,object:gc,source:c7,light:h7,sky:p7,terrain:d7,projection:yJ,string:Ym,formatted:dJ,resolvedImage:fJ,padding:mJ,variableAnchorOffsetCollection:gJ,sprite:f7};function Aw(t){let e=t.value,r=t.valueSpec,i=t.styleSpec;return t.validateSpec=Aw,r.expression&&AA(mo(e))?n7(t):r.expression&&ax(Zm(e))?Gy(t):r.type&&OH[r.type]?OH[r.type](t):gc(jy({},t,{valueSpec:r.type?i[r.type]:r}))}s(Aw,"validate");function m7(t){let e=t.value,r=t.key,i=Ym(t);return i.length||(e.indexOf("{fontstack}")===-1&&i.push(new _r(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&i.push(new _r(r,e,'"glyphs" url must include a "{range}" token'))),i}s(m7,"validateGlyphsUrl");function ah(t,e=Ut){let r=[];return r=r.concat(Aw({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Aw,objectElementValidators:{glyphs:m7,"*"(){return[]}}})),t.constants&&(r=r.concat(i7({key:"constants",value:t.constants}))),g7(r)}s(ah,"validateStyleMin");ah.source=Yh(Zh(c7));ah.sprite=Yh(Zh(f7));ah.glyphs=Yh(Zh(m7));ah.light=Yh(Zh(h7));ah.sky=Yh(Zh(p7));ah.terrain=Yh(Zh(d7));ah.layer=Yh(Zh(u7));ah.filter=Yh(Zh(hP));ah.paintProperty=Yh(Zh(s7));ah.layoutProperty=Yh(Zh(l7));function Zh(t){return function(e){return t(vt(Ee({},e),{validateSpec:Aw}))}}s(Zh,"injectValidateSpec");function g7(t){return[].concat(t).sort((e,r)=>e.line-r.line)}s(g7,"sortErrors");function Yh(t){return function(...e){return g7(t.apply(this,e))}}s(Yh,"wrapCleanErrors");N();var Ms=ah;Ms.source;var zke=Ms.light;Ms.terrain;Ms.filter;var Uke=Ms.paintProperty,Vke=Ms.layoutProperty;function pP(t,e){let r=!1;if(e&&e.length)for(let i of e)t.fire(new fi(new Error(i.message))),r=!0;return r}s(pP,"emitValidationErrors");N();N();N();var vJ=class _J{constructor(e,r,i){let n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let o=new Int32Array(this.arrayBuffer);e=o[0],r=o[1],i=o[2],this.d=r+2*i;for(let c=0;c<this.d*this.d;c++){let p=o[3+c],m=o[3+c+1];n.push(p===m?null:o.subarray(p,m))}let l=o[3+n.length],u=o[3+n.length+1];this.keys=o.subarray(l,u),this.bboxes=o.subarray(u),this.insert=this._insertReadonly}else{this.d=r+2*i;for(let o=0;o<this.d*this.d;o++)n.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=i,this.scale=r/e,this.uid=0;let a=i/r*e;this.min=-a,this.max=e+a}insert(e,r,i,n,a){this._forEachCell(r,i,n,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(a)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,i,n,a,o){this.cells[a].push(o)}query(e,r,i,n,a){let o=this.min,l=this.max;if(e<=o&&r<=o&&l<=i&&l<=n&&!a)return Array.prototype.slice.call(this.keys);{let u=[],c={};return this._forEachCell(e,r,i,n,this._queryCell,u,c,a),u}}_queryCell(e,r,i,n,a,o,l,u){let c=this.cells[a];if(c!==null){let p=this.keys,m=this.bboxes;for(let y=0;y<c.length;y++){let v=c[y];if(l[v]===void 0){let w=v*4;(u?u(m[w+0],m[w+1],m[w+2],m[w+3]):e<=m[w+2]&&r<=m[w+3]&&i>=m[w+0]&&n>=m[w+1])?(l[v]=!0,o.push(p[v])):l[v]=!1}}}}_forEachCell(e,r,i,n,a,o,l,u){let c=this._convertToCellCoord(e),p=this._convertToCellCoord(r),m=this._convertToCellCoord(i),y=this._convertToCellCoord(n);for(let v=c;v<=m;v++)for(let w=p;w<=y;w++){let E=this.d*w+v;if(!(u&&!u(this._convertFromCellCoord(v),this._convertFromCellCoord(w),this._convertFromCellCoord(v+1),this._convertFromCellCoord(w+1)))&&a.call(this,e,r,i,n,E,o,l,u))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,i=0;for(let o=0;o<this.cells.length;o++)i+=this.cells[o].length;let n=new Int32Array(r+i+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let a=r;for(let o=0;o<e.length;o++){let l=e[o];n[3+o]=a,n.set(l,a),a+=l.length}return n[3+e.length]=a,n.set(this.keys,a),a+=this.keys.length,n[3+e.length+1]=a,n.set(this.bboxes,a),a+=this.bboxes.length,n.buffer}static serialize(e,r){let i=e.toArrayBuffer();return r&&r.push(i),{buffer:i}}static deserialize(e){return new _J(e.buffer)}};s(vJ,"TransferableGridIndex");var ID=vJ,Gm={};function Rr(t,e,r={}){if(Gm[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Gm[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}s(Rr,"register");Rr("Object",Object);Rr("TransferableGridIndex",ID);Rr("Color",Li);Rr("Error",Error);Rr("AJAXError",T9);Rr("ResolvedImage",Kp);Rr("StylePropertyFunction",rJ);Rr("StyleExpression",e7,{omit:["_evaluator"]});Rr("ZoomDependentExpression",E3);Rr("ZoomConstantExpression",M3);Rr("CompoundExpression",uv,{omit:["_evaluate"]});for(let t in Y1)Y1[t]._classRegistryKey||Rr("Expression_".concat(t),Y1[t]);function y7(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}s(y7,"isArrayBuffer");function K1(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(y7(t)||Gp(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){let r=t;return e&&e.push(r.buffer),r}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){let r=[];for(let i of t)r.push(K1(i,e));return r}if(typeof t=="object"){let r=t.constructor,i=r._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class ".concat(r.name));if(!Gm[i])throw new Error("".concat(i," is not registered."));let n=r.serialize?r.serialize(t,e):{};if(r.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let a in t){if(!t.hasOwnProperty(a)||Gm[i].omit.indexOf(a)>=0)continue;let o=t[a];n[a]=Gm[i].shallow.indexOf(a)>=0?o:K1(o,e)}t instanceof Error&&(n.message=t.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(n.$name=i),n}throw new Error("can't serialize object of type ".concat(typeof t))}s(K1,"serialize");function J1(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||y7(t)||Gp(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(J1);if(typeof t=="object"){let e=t.$name||"Object";if(!Gm[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=Gm[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let i=Object.create(r.prototype);for(let n of Object.keys(t)){if(n==="$name")continue;let a=t[n];i[n]=Gm[e].shallow.indexOf(n)>=0?a:J1(a)}return i}throw new Error("can't deserialize object of type ".concat(typeof t))}s(J1,"deserialize");N();N();var xJ=class{constructor(){this.first=!0}update(e,r){let i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=i,!0):!1)}};s(xJ,"ZoomHistory");var bJ=xJ;N();N();var gn={"Latin-1 Supplement":s(t=>t>=128&&t<=255,"Latin-1 Supplement"),Arabic:s(t=>t>=1536&&t<=1791,"Arabic"),"Arabic Supplement":s(t=>t>=1872&&t<=1919,"Arabic Supplement"),"Arabic Extended-A":s(t=>t>=2208&&t<=2303,"Arabic Extended-A"),"Hangul Jamo":s(t=>t>=4352&&t<=4607,"Hangul Jamo"),"Unified Canadian Aboriginal Syllabics":s(t=>t>=5120&&t<=5759,"Unified Canadian Aboriginal Syllabics"),Khmer:s(t=>t>=6016&&t<=6143,"Khmer"),"Unified Canadian Aboriginal Syllabics Extended":s(t=>t>=6320&&t<=6399,"Unified Canadian Aboriginal Syllabics Extended"),"General Punctuation":s(t=>t>=8192&&t<=8303,"General Punctuation"),"Letterlike Symbols":s(t=>t>=8448&&t<=8527,"Letterlike Symbols"),"Number Forms":s(t=>t>=8528&&t<=8591,"Number Forms"),"Miscellaneous Technical":s(t=>t>=8960&&t<=9215,"Miscellaneous Technical"),"Control Pictures":s(t=>t>=9216&&t<=9279,"Control Pictures"),"Optical Character Recognition":s(t=>t>=9280&&t<=9311,"Optical Character Recognition"),"Enclosed Alphanumerics":s(t=>t>=9312&&t<=9471,"Enclosed Alphanumerics"),"Geometric Shapes":s(t=>t>=9632&&t<=9727,"Geometric Shapes"),"Miscellaneous Symbols":s(t=>t>=9728&&t<=9983,"Miscellaneous Symbols"),"Miscellaneous Symbols and Arrows":s(t=>t>=11008&&t<=11263,"Miscellaneous Symbols and Arrows"),"CJK Radicals Supplement":s(t=>t>=11904&&t<=12031,"CJK Radicals Supplement"),"Kangxi Radicals":s(t=>t>=12032&&t<=12255,"Kangxi Radicals"),"Ideographic Description Characters":s(t=>t>=12272&&t<=12287,"Ideographic Description Characters"),"CJK Symbols and Punctuation":s(t=>t>=12288&&t<=12351,"CJK Symbols and Punctuation"),Hiragana:s(t=>t>=12352&&t<=12447,"Hiragana"),Katakana:s(t=>t>=12448&&t<=12543,"Katakana"),Bopomofo:s(t=>t>=12544&&t<=12591,"Bopomofo"),"Hangul Compatibility Jamo":s(t=>t>=12592&&t<=12687,"Hangul Compatibility Jamo"),Kanbun:s(t=>t>=12688&&t<=12703,"Kanbun"),"Bopomofo Extended":s(t=>t>=12704&&t<=12735,"Bopomofo Extended"),"CJK Strokes":s(t=>t>=12736&&t<=12783,"CJK Strokes"),"Katakana Phonetic Extensions":s(t=>t>=12784&&t<=12799,"Katakana Phonetic Extensions"),"Enclosed CJK Letters and Months":s(t=>t>=12800&&t<=13055,"Enclosed CJK Letters and Months"),"CJK Compatibility":s(t=>t>=13056&&t<=13311,"CJK Compatibility"),"CJK Unified Ideographs Extension A":s(t=>t>=13312&&t<=19903,"CJK Unified Ideographs Extension A"),"Yijing Hexagram Symbols":s(t=>t>=19904&&t<=19967,"Yijing Hexagram Symbols"),"CJK Unified Ideographs":s(t=>t>=19968&&t<=40959,"CJK Unified Ideographs"),"Yi Syllables":s(t=>t>=40960&&t<=42127,"Yi Syllables"),"Yi Radicals":s(t=>t>=42128&&t<=42191,"Yi Radicals"),"Hangul Jamo Extended-A":s(t=>t>=43360&&t<=43391,"Hangul Jamo Extended-A"),"Hangul Syllables":s(t=>t>=44032&&t<=55215,"Hangul Syllables"),"Hangul Jamo Extended-B":s(t=>t>=55216&&t<=55295,"Hangul Jamo Extended-B"),"Private Use Area":s(t=>t>=57344&&t<=63743,"Private Use Area"),"CJK Compatibility Ideographs":s(t=>t>=63744&&t<=64255,"CJK Compatibility Ideographs"),"Arabic Presentation Forms-A":s(t=>t>=64336&&t<=65023,"Arabic Presentation Forms-A"),"Vertical Forms":s(t=>t>=65040&&t<=65055,"Vertical Forms"),"CJK Compatibility Forms":s(t=>t>=65072&&t<=65103,"CJK Compatibility Forms"),"Small Form Variants":s(t=>t>=65104&&t<=65135,"Small Form Variants"),"Arabic Presentation Forms-B":s(t=>t>=65136&&t<=65279,"Arabic Presentation Forms-B"),"Halfwidth and Fullwidth Forms":s(t=>t>=65280&&t<=65519,"Halfwidth and Fullwidth Forms")};function wJ(t){for(let e of t)if(AJ(e.charCodeAt(0)))return!0;return!1}s(wJ,"allowsVerticalWritingMode");function AJ(t){return t===746||t===747?!0:t<4352?!1:!!(gn["Bopomofo Extended"](t)||gn.Bopomofo(t)||gn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||gn["CJK Compatibility Ideographs"](t)||gn["CJK Compatibility"](t)||gn["CJK Radicals Supplement"](t)||gn["CJK Strokes"](t)||gn["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||gn["CJK Unified Ideographs Extension A"](t)||gn["CJK Unified Ideographs"](t)||gn["Enclosed CJK Letters and Months"](t)||gn["Hangul Compatibility Jamo"](t)||gn["Hangul Jamo Extended-A"](t)||gn["Hangul Jamo Extended-B"](t)||gn["Hangul Jamo"](t)||gn["Hangul Syllables"](t)||gn.Hiragana(t)||gn["Ideographic Description Characters"](t)||gn.Kanbun(t)||gn["Kangxi Radicals"](t)||gn["Katakana Phonetic Extensions"](t)||gn.Katakana(t)&&t!==12540||gn["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||gn["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||gn["Unified Canadian Aboriginal Syllabics"](t)||gn["Unified Canadian Aboriginal Syllabics Extended"](t)||gn["Vertical Forms"](t)||gn["Yijing Hexagram Symbols"](t)||gn["Yi Syllables"](t)||gn["Yi Radicals"](t))}s(AJ,"charHasUprightVerticalOrientation");function v7(t){return t>=1424&&t<=2303||gn["Arabic Presentation Forms-A"](t)||gn["Arabic Presentation Forms-B"](t)}s(v7,"charInRTLScript");function SJ(t,e){return!(!e&&v7(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||gn.Khmer(t))}s(SJ,"charInSupportedScript");function MJ(t){for(let e of t)if(v7(e.charCodeAt(0)))return!0;return!1}s(MJ,"stringContainsRTLText");function EJ(t,e){for(let r of t)if(!SJ(r.charCodeAt(0),e))return!1;return!0}s(EJ,"isStringInSupportedScript");N();var CJ=class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};s(CJ,"RTLWorkerPlugin");var jke=CJ,Sw=new jke,IJ=class{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new bJ,this.transition={})}isSupportedScript(e){return EJ(e,Sw.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*r}}};s(IJ,"EvaluationParameters");var fs=IJ,TJ=class{constructor(e,r){this.property=e,this.value=r,this.expression=iJ(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,i){return this.property.possiblyEvaluate(this,e,r,i)}};s(TJ,"PropertyValue");var dP=TJ,PJ=class{constructor(e){this.property=e,this.value=new dP(e,void 0)}transitioned(e,r){return new kH(this.property,this.value,r,zr({},e.transition,this.transition),e.now)}untransitioned(){return new kH(this.property,this.value,null,{},0)}};s(PJ,"TransitionablePropertyValue");var TD=PJ,LJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return mc(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new TD(this._values[e].property)),this._values[e].value=new dP(this._values[e].property,r===null?void 0:mc(r))}getTransition(e){return mc(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new TD(this._values[e].property)),this._values[e].transition=mc(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let i=this.getValue(r);i!==void 0&&(e[r]=i);let n=this.getTransition(r);n!==void 0&&(e["".concat(r,"-transition")]=n)}return e}transitioned(e,r){let i=new NH(this._properties);for(let n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(e,r._values[n]);return i}untransitioned(){let e=new NH(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}};s(LJ,"Transitionable");var DJ=LJ,RJ=class{constructor(e,r,i,n,a){this.property=e,this.value=r,this.begin=a+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(e,r,i){let n=e.now||0,a=this.value.possiblyEvaluate(e,r,i),o=this.prior;if(o){if(n>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(n<this.begin)return o.possiblyEvaluate(e,r,i);{let l=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,r,i),a,oZ(l))}}else return a}};s(RJ,"TransitioningPropertyValue");var kH=RJ,OJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,i){let n=new fP(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,r,i);return n}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}};s(OJ,"Transitioning");var NH=OJ,kJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return mc(this._values[e].value)}setValue(e,r){this._values[e]=new dP(this._values[e].property,r===null?void 0:mc(r))}serialize(){let e={};for(let r of Object.keys(this._values)){let i=this.getValue(r);i!==void 0&&(e[r]=i)}return e}possiblyEvaluate(e,r,i){let n=new fP(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,r,i);return n}};s(kJ,"Layout");var $ke=kJ,NJ=class{constructor(e,r,i){this.property=e,this.value=r,this.parameters=i}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,i,n){return this.property.evaluate(this.value,this.parameters,e,r,i,n)}};s(NJ,"PossiblyEvaluatedPropertyValue");var Fh=NJ,FJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}};s(FJ,"PossiblyEvaluated");var fP=FJ,BJ=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,i){let n=this.specification.type,a=Ka[n];return a?a(e,r,i):e}};s(BJ,"DataConstantProperty");var Wr=BJ,zJ=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,i,n){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Fh(this,{kind:"constant",value:e.expression.evaluate(r,null,{},i,n)},r):new Fh(this,e.expression,r)}interpolate(e,r,i){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Fh(this,{kind:"constant",value:void 0},e.parameters);let n=this.specification.type,a=Ka[n];if(a){let o=a(e.value.value,r.value.value,i);return new Fh(this,{kind:"constant",value:o},e.parameters)}else return e}evaluate(e,r,i,n,a,o){return e.kind==="constant"?e.value:e.evaluate(r,i,n,a,o)}};s(zJ,"DataDrivenProperty");var di=zJ,UJ=class extends di{possiblyEvaluate(e,r,i,n){if(e.value===void 0)return new Fh(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){let a=e.expression.evaluate(r,null,{},i,n),o=e.property.specification.type==="resolvedImage"&&typeof a!="string"?a.name:a,l=this._calculate(o,o,o,r);return new Fh(this,{kind:"constant",value:l},r)}else if(e.expression.kind==="camera"){let a=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new Fh(this,{kind:"constant",value:a},r)}else return new Fh(this,e.expression,r)}evaluate(e,r,i,n,a,o){if(e.kind==="source"){let l=e.evaluate(r,i,n,a,o);return this._calculate(l,l,l,r)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},i,n),e.evaluate({zoom:Math.floor(r.zoom)},i,n),e.evaluate({zoom:Math.floor(r.zoom)+1},i,n),r):e.value}_calculate(e,r,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:i,to:r}}interpolate(e){return e}};s(UJ,"CrossFadedDataDrivenProperty");var mP=UJ,VJ=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,i,n){if(e.value!==void 0)if(e.expression.kind==="constant"){let a=e.expression.evaluate(r,null,{},i,n);return this._calculate(a,a,a,r)}else return this._calculate(e.expression.evaluate(new fs(Math.floor(r.zoom-1),r)),e.expression.evaluate(new fs(Math.floor(r.zoom),r)),e.expression.evaluate(new fs(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:i,to:r}}interpolate(e){return e}};s(VJ,"CrossFadedProperty");var _7=VJ,jJ=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,i,n){return!!e.expression.evaluate(r,null,{},i,n)}interpolate(){return!1}};s(jJ,"ColorRampProperty");var x7=jJ,$J=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let i=e[r];i.specification.overridable&&this.overridableProperties.push(r);let n=this.defaultPropertyValues[r]=new dP(i,void 0),a=this.defaultTransitionablePropertyValues[r]=new TD(i);this.defaultTransitioningPropertyValues[r]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=n.possiblyEvaluate({})}}};s($J,"Properties");var $u=$J;Rr("DataDrivenProperty",di);Rr("DataConstantProperty",Wr);Rr("CrossFadedDataDrivenProperty",mP);Rr("CrossFadedProperty",_7);Rr("ColorRampProperty",x7);var AM="-transition",GJ=class extends Fl{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:s(()=>!0,"filter"),needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new $ke(r.layout)),r.paint)){this._transitionablePaint=new DJ(r.paint);for(let i in e.paint)this.setPaintProperty(i,e.paint[i],{validate:!1});for(let i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fP(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,i={}){if(r!=null){let n="layers.".concat(this.id,".layout.").concat(e);if(this._validate(Vke,n,e,r,i))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(AM)?this._transitionablePaint.getTransition(e.slice(0,-AM.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,i={}){if(r!=null){let n="layers.".concat(this.id,".paint.").concat(e);if(this._validate(Uke,n,e,r,i))return!1}if(e.endsWith(AM))return this._transitionablePaint.setTransition(e.slice(0,-AM.length),r||void 0),!1;{let n=this._transitionablePaint._values[e],a=n.property.specification["property-type"]==="cross-faded-data-driven",o=n.value.isDataDriven(),l=n.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let u=this._transitionablePaint._values[e].value;return u.isDataDriven()||o||a||this._handleOverridablePaintPropertyUpdate(e,l,u)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,i){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),C9(e,(r,i)=>r!==void 0&&!(i==="layout"&&!Object.keys(r).length)&&!(i==="paint"&&!Object.keys(r).length))}_validate(e,r,i,n,a={}){return a&&a.validate===!1?!1:pP(this,e.call(Ms,{key:r,layerType:this.type,objectKey:i,value:n,styleSpec:Ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof Fh)||!$y(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};s(GJ,"StyleLayer");var id=GJ;N();N();N();var Gke={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},HJ=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}};s(HJ,"Struct");var SA=HJ,Hke=128,qke=5,qJ=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*qke),Hke),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};s(qJ,"StructArray");var vo=qJ;function ao(t,e=1){let r=0,i=0,n=t.map(o=>{let l=WJ(o.type),u=r=PD(r,Math.max(e,l)),c=o.components||1;return i=Math.max(i,l),r+=l*c,{name:o.name,type:o.type,components:c,offset:u}}),a=PD(r,Math.max(i,e));return{members:n,size:a,alignment:e}}s(ao,"createLayout");function WJ(t){return Gke[t].BYTES_PER_ELEMENT}s(WJ,"sizeOf");function PD(t,e){return Math.ceil(t/e)*e}s(PD,"align");var Wke=kr(Nn(),1),XJ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){let n=e*2;return this.int16[n+0]=r,this.int16[n+1]=i,e}};s(XJ,"StructArrayLayout2i4");var MA=XJ;MA.prototype.bytesPerElement=4;Rr("StructArrayLayout2i4",MA);var ZJ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*3;return this.int16[a+0]=r,this.int16[a+1]=i,this.int16[a+2]=n,e}};s(ZJ,"StructArrayLayout3i6");var gP=ZJ;gP.prototype.bytesPerElement=6;Rr("StructArrayLayout3i6",gP);var YJ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,i,n)}emplace(e,r,i,n,a){let o=e*4;return this.int16[o+0]=r,this.int16[o+1]=i,this.int16[o+2]=n,this.int16[o+3]=a,e}};s(YJ,"StructArrayLayout4i8");var b7=YJ;b7.prototype.bytesPerElement=8;Rr("StructArrayLayout4i8",b7);var KJ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o){let l=this.length;return this.resize(l+1),this.emplace(l,e,r,i,n,a,o)}emplace(e,r,i,n,a,o,l){let u=e*6;return this.int16[u+0]=r,this.int16[u+1]=i,this.int16[u+2]=n,this.int16[u+3]=a,this.int16[u+4]=o,this.int16[u+5]=l,e}};s(KJ,"StructArrayLayout2i4i12");var w7=KJ;w7.prototype.bytesPerElement=12;Rr("StructArrayLayout2i4i12",w7);var JJ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o){let l=this.length;return this.resize(l+1),this.emplace(l,e,r,i,n,a,o)}emplace(e,r,i,n,a,o,l){let u=e*4,c=e*8;return this.int16[u+0]=r,this.int16[u+1]=i,this.uint8[c+4]=n,this.uint8[c+5]=a,this.uint8[c+6]=o,this.uint8[c+7]=l,e}};s(JJ,"StructArrayLayout2i4ub8");var A7=JJ;A7.prototype.bytesPerElement=8;Rr("StructArrayLayout2i4ub8",A7);var QJ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){let n=e*2;return this.float32[n+0]=r,this.float32[n+1]=i,e}};s(QJ,"StructArrayLayout2f8");var Mw=QJ;Mw.prototype.bytesPerElement=8;Rr("StructArrayLayout2f8",Mw);var eQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p){let m=this.length;return this.resize(m+1),this.emplace(m,e,r,i,n,a,o,l,u,c,p)}emplace(e,r,i,n,a,o,l,u,c,p,m){let y=e*10;return this.uint16[y+0]=r,this.uint16[y+1]=i,this.uint16[y+2]=n,this.uint16[y+3]=a,this.uint16[y+4]=o,this.uint16[y+5]=l,this.uint16[y+6]=u,this.uint16[y+7]=c,this.uint16[y+8]=p,this.uint16[y+9]=m,e}};s(eQ,"StructArrayLayout10ui20");var S7=eQ;S7.prototype.bytesPerElement=20;Rr("StructArrayLayout10ui20",S7);var tQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p,m,y){let v=this.length;return this.resize(v+1),this.emplace(v,e,r,i,n,a,o,l,u,c,p,m,y)}emplace(e,r,i,n,a,o,l,u,c,p,m,y,v){let w=e*12;return this.int16[w+0]=r,this.int16[w+1]=i,this.int16[w+2]=n,this.int16[w+3]=a,this.uint16[w+4]=o,this.uint16[w+5]=l,this.uint16[w+6]=u,this.uint16[w+7]=c,this.int16[w+8]=p,this.int16[w+9]=m,this.int16[w+10]=y,this.int16[w+11]=v,e}};s(tQ,"StructArrayLayout4i4ui4i24");var M7=tQ;M7.prototype.bytesPerElement=24;Rr("StructArrayLayout4i4ui4i24",M7);var rQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*3;return this.float32[a+0]=r,this.float32[a+1]=i,this.float32[a+2]=n,e}};s(rQ,"StructArrayLayout3f12");var E7=rQ;E7.prototype.bytesPerElement=12;Rr("StructArrayLayout3f12",E7);var iQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let i=e*1;return this.uint32[i+0]=r,e}};s(iQ,"StructArrayLayout1ul4");var C7=iQ;C7.prototype.bytesPerElement=4;Rr("StructArrayLayout1ul4",C7);var nQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,i,n,a,o,l,u,c)}emplace(e,r,i,n,a,o,l,u,c,p){let m=e*10,y=e*5;return this.int16[m+0]=r,this.int16[m+1]=i,this.int16[m+2]=n,this.int16[m+3]=a,this.int16[m+4]=o,this.int16[m+5]=l,this.uint32[y+3]=u,this.uint16[m+8]=c,this.uint16[m+9]=p,e}};s(nQ,"StructArrayLayout6i1ul2ui20");var I7=nQ;I7.prototype.bytesPerElement=20;Rr("StructArrayLayout6i1ul2ui20",I7);var aQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o){let l=this.length;return this.resize(l+1),this.emplace(l,e,r,i,n,a,o)}emplace(e,r,i,n,a,o,l){let u=e*6;return this.int16[u+0]=r,this.int16[u+1]=i,this.int16[u+2]=n,this.int16[u+3]=a,this.int16[u+4]=o,this.int16[u+5]=l,e}};s(aQ,"StructArrayLayout2i2i2i12");var T7=aQ;T7.prototype.bytesPerElement=12;Rr("StructArrayLayout2i2i2i12",T7);var oQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,i,n,a)}emplace(e,r,i,n,a,o){let l=e*4,u=e*8;return this.float32[l+0]=r,this.float32[l+1]=i,this.float32[l+2]=n,this.int16[u+6]=a,this.int16[u+7]=o,e}};s(oQ,"StructArrayLayout2f1f2i16");var P7=oQ;P7.prototype.bytesPerElement=16;Rr("StructArrayLayout2f1f2i16",P7);var sQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,i,n)}emplace(e,r,i,n,a){let o=e*12,l=e*3;return this.uint8[o+0]=r,this.uint8[o+1]=i,this.float32[l+1]=n,this.float32[l+2]=a,e}};s(sQ,"StructArrayLayout2ub2f12");var L7=sQ;L7.prototype.bytesPerElement=12;Rr("StructArrayLayout2ub2f12",L7);var lQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*3;return this.uint16[a+0]=r,this.uint16[a+1]=i,this.uint16[a+2]=n,e}};s(lQ,"StructArrayLayout3ui6");var yP=lQ;yP.prototype.bytesPerElement=6;Rr("StructArrayLayout3ui6",yP);var uQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I){let P=this.length;return this.resize(P+1),this.emplace(P,e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I)}emplace(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P){let C=e*24,T=e*12,O=e*48;return this.int16[C+0]=r,this.int16[C+1]=i,this.uint16[C+2]=n,this.uint16[C+3]=a,this.uint32[T+2]=o,this.uint32[T+3]=l,this.uint32[T+4]=u,this.uint16[C+10]=c,this.uint16[C+11]=p,this.uint16[C+12]=m,this.float32[T+7]=y,this.float32[T+8]=v,this.uint8[O+36]=w,this.uint8[O+37]=E,this.uint8[O+38]=M,this.uint32[T+10]=I,this.int16[C+22]=P,e}};s(uQ,"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48");var D7=uQ;D7.prototype.bytesPerElement=48;Rr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",D7);var cQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T,O,F,k,B,U,z,q,W){let J=this.length;return this.resize(J+1),this.emplace(J,e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T,O,F,k,B,U,z,q,W)}emplace(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T,O,F,k,B,U,z,q,W,J){let V=e*32,oe=e*16;return this.int16[V+0]=r,this.int16[V+1]=i,this.int16[V+2]=n,this.int16[V+3]=a,this.int16[V+4]=o,this.int16[V+5]=l,this.int16[V+6]=u,this.int16[V+7]=c,this.uint16[V+8]=p,this.uint16[V+9]=m,this.uint16[V+10]=y,this.uint16[V+11]=v,this.uint16[V+12]=w,this.uint16[V+13]=E,this.uint16[V+14]=M,this.uint16[V+15]=I,this.uint16[V+16]=P,this.uint16[V+17]=C,this.uint16[V+18]=T,this.uint16[V+19]=O,this.uint16[V+20]=F,this.uint16[V+21]=k,this.uint16[V+22]=B,this.uint32[oe+12]=U,this.float32[oe+13]=z,this.float32[oe+14]=q,this.uint16[V+30]=W,this.uint16[V+31]=J,e}};s(cQ,"StructArrayLayout8i15ui1ul2f2ui64");var R7=cQ;R7.prototype.bytesPerElement=64;Rr("StructArrayLayout8i15ui1ul2f2ui64",R7);var hQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let i=e*1;return this.float32[i+0]=r,e}};s(hQ,"StructArrayLayout1f4");var vP=hQ;vP.prototype.bytesPerElement=4;Rr("StructArrayLayout1f4",vP);var pQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*6,o=e*3;return this.uint16[a+0]=r,this.float32[o+1]=i,this.float32[o+2]=n,e}};s(pQ,"StructArrayLayout1ui2f12");var O7=pQ;O7.prototype.bytesPerElement=12;Rr("StructArrayLayout1ui2f12",O7);var dQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*2,o=e*4;return this.uint32[a+0]=r,this.uint16[o+2]=i,this.uint16[o+3]=n,e}};s(dQ,"StructArrayLayout1ul2ui8");var k7=dQ;k7.prototype.bytesPerElement=8;Rr("StructArrayLayout1ul2ui8",k7);var fQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){let n=e*2;return this.uint16[n+0]=r,this.uint16[n+1]=i,e}};s(fQ,"StructArrayLayout2ui4");var N7=fQ;N7.prototype.bytesPerElement=4;Rr("StructArrayLayout2ui4",N7);var mQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let i=e*1;return this.uint16[i+0]=r,e}};s(mQ,"StructArrayLayout1ui2");var F7=mQ;F7.prototype.bytesPerElement=2;Rr("StructArrayLayout1ui2",F7);var gQ=class extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,i,n)}emplace(e,r,i,n,a){let o=e*4;return this.float32[o+0]=r,this.float32[o+1]=i,this.float32[o+2]=n,this.float32[o+3]=a,e}};s(gQ,"StructArrayLayout4f16");var B7=gQ;B7.prototype.bytesPerElement=16;Rr("StructArrayLayout4f16",B7);var yQ=class extends SA{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Wke.default(this.anchorPointX,this.anchorPointY)}};s(yQ,"CollisionBoxStruct");var vQ=yQ;vQ.prototype.size=20;var _Q=class extends I7{get(e){return new vQ(this,e)}};s(_Q,"CollisionBoxArray");var xQ=_Q;Rr("CollisionBoxArray",xQ);var bQ=class extends SA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};s(bQ,"PlacedSymbolStruct");var wQ=bQ;wQ.prototype.size=48;var AQ=class extends D7{get(e){return new wQ(this,e)}};s(AQ,"PlacedSymbolArray");var SQ=AQ;Rr("PlacedSymbolArray",SQ);var MQ=class extends SA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};s(MQ,"SymbolInstanceStruct");var EQ=MQ;EQ.prototype.size=64;var CQ=class extends R7{get(e){return new EQ(this,e)}};s(CQ,"SymbolInstanceArray");var IQ=CQ;Rr("SymbolInstanceArray",IQ);var TQ=class extends vP{getoffsetX(e){return this.float32[e*1+0]}};s(TQ,"GlyphOffsetArray");var PQ=TQ;Rr("GlyphOffsetArray",PQ);var LQ=class extends gP{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};s(LQ,"SymbolLineVertexArray");var DQ=LQ;Rr("SymbolLineVertexArray",DQ);var RQ=class extends SA{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};s(RQ,"TextAnchorOffsetStruct");var OQ=RQ;OQ.prototype.size=12;var kQ=class extends O7{get(e){return new OQ(this,e)}};s(kQ,"TextAnchorOffsetArray");var NQ=kQ;Rr("TextAnchorOffsetArray",NQ);var FQ=class extends SA{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};s(FQ,"FeatureIndexStruct");var BQ=FQ;BQ.prototype.size=8;var zQ=class extends k7{get(e){return new BQ(this,e)}};s(zQ,"FeatureIndexArray");var UQ=zQ;Rr("FeatureIndexArray",UQ);var VQ=class extends MA{};s(VQ,"PosArray");var zE=VQ,jQ=class extends gP{};s(jQ,"Pos3dArray");var Xke=jQ,$Q=class extends b7{};s($Q,"RasterBoundsArray");var GQ=$Q,HQ=class extends MA{};s(HQ,"CircleLayoutArray");var Zke=HQ,qQ=class extends MA{};s(qQ,"FillLayoutArray");var Yke=qQ,WQ=class extends w7{};s(WQ,"FillExtrusionLayoutArray");var Kke=WQ,XQ=class extends A7{};s(XQ,"LineLayoutArray");var Jke=XQ,ZQ=class extends Mw{};s(ZQ,"LineExtLayoutArray");var Qke=ZQ,YQ=class extends S7{};s(YQ,"PatternLayoutArray");var i0=YQ,KQ=class extends M7{};s(KQ,"SymbolLayoutArray");var e8e=KQ,JQ=class extends E7{};s(JQ,"SymbolDynamicLayoutArray");var t8e=JQ,QQ=class extends C7{};s(QQ,"SymbolOpacityArray");var r8e=QQ,eee=class extends T7{};s(eee,"CollisionBoxLayoutArray");var FH=eee,tee=class extends P7{};s(tee,"CollisionCircleLayoutArray");var i8e=tee,ree=class extends L7{};s(ree,"CollisionVertexArray");var n8e=ree,iee=class extends yP{};s(iee,"QuadTriangleArray");var a8e=iee,nee=class extends yP{};s(nee,"TriangleIndexArray");var cv=nee,aee=class extends N7{};s(aee,"LineIndexArray");var LD=aee,oee=class extends F7{};s(oee,"LineStripIndexArray");var o8e=oee;N();var s8e=ao([{name:"a_pos",components:2,type:"Int16"}],4),{members:l8e,size:Eat,alignment:Cat}=s8e;N();var see=class Qb{constructor(e=[]){this.segments=e}prepareSegment(e,r,i,n){let a=this.segments[this.segments.length-1];return e>Qb.MAX_VERTEX_ARRAY_LENGTH&&kl("Max vertices per segment is ".concat(Qb.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!a||a.vertexLength+e>Qb.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==n)&&(a={vertexOffset:r.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},n!==void 0&&(a.sortKey=n),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,i,n){return new Qb([{vertexOffset:e,primitiveOffset:r,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}};s(see,"SegmentVector");var To=see;To.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;Rr("SegmentVector",To);N();N();function DD(t,e){return t=ps(Math.floor(t),0,255),e=ps(Math.floor(e),0,255),256*t+e}s(DD,"packUint8ToFloat");N();var I3=ao([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);N();var u8e=kr(eZ(),1),lee=class uee{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,i,n){this.ids.push(RD(e)),this.positions.push(r,i,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=RD(e),i=0,n=this.ids.length-1;for(;i<n;){let o=i+n>>1;this.ids[o]>=r?n=o:i=o+1}let a=[];for(;this.ids[i]===r;){let o=this.positions[3*i],l=this.positions[3*i+1],u=this.positions[3*i+2];a.push({index:o,start:l,end:u}),i++}return a}static serialize(e,r){let i=new Float64Array(e.ids),n=new Uint32Array(e.positions);return T3(i,n,0,i.length-1),r&&r.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(e){let r=new uee;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};s(lee,"FeaturePositionMap");var cee=lee;function RD(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,u8e.default)(String(t))}s(RD,"getNumericId");function T3(t,e,r,i){for(;r<i;){let n=t[r+i>>1],a=r-1,o=i+1;for(;;){do a++;while(t[a]<n);do o--;while(t[o]>n);if(a>=o)break;e2(t,a,o),e2(e,3*a,3*o),e2(e,3*a+1,3*o+1),e2(e,3*a+2,3*o+2)}o-r<i-o?(T3(t,e,r,o),r=o+1):(T3(t,e,o+1,i),i=o)}}s(T3,"sort");function e2(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}s(e2,"swap");Rr("FeaturePositionMap",cee);N();var hee=class{constructor(e,r){this.gl=e.gl,this.location=r}};s(hee,"Uniform");var hv=hee,pee=class extends hv{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}};s(pee,"Uniform1i");var Wi=pee,dee=class extends hv{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};s(dee,"Uniform1f");var Mr=dee,fee=class extends hv{constructor(e,r){super(e,r),this.current=[0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1])&&(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}};s(fee,"Uniform2f");var an=fee,mee=class extends hv{constructor(e,r){super(e,r),this.current=[0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2])&&(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}};s(mee,"Uniform3f");var cf=mee,gee=class extends hv{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}};s(gee,"Uniform4f");var z7=gee,yee=class extends hv{constructor(e,r){super(e,r),this.current=Li.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};s(yee,"UniformColor");var Q1=yee,c8e=new Float32Array(16),vee=class extends hv{constructor(e,r){super(e,r),this.current=c8e}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);return}for(let r=1;r<16;r++)if(e[r]!==this.current[r]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}};s(vee,"UniformMatrix4f");var _n=vee;function P3(t){return[DD(255*t.r,255*t.g),DD(255*t.b,255*t.a)]}s(P3,"packColor");var _ee=class{constructor(e,r,i){this.value=e,this.uniformNames=r.map(n=>"u_".concat(n)),this.type=i}setUniform(e,r,i){e.set(i.constantOr(this.value))}getBinding(e,r,i){return this.type==="color"?new Q1(e,r):new Mr(e,r)}};s(_ee,"ConstantBinder");var t2=_ee,xee=class{constructor(e,r){this.uniformNames=r.map(i=>"u_".concat(i)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,i,n){let a=n==="u_pattern_to"?this.patternTo:n==="u_pattern_from"?this.patternFrom:n==="u_pixel_ratio_to"?this.pixelRatioTo:n==="u_pixel_ratio_from"?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,r,i){return i.substr(0,9)==="u_pattern"?new z7(e,r):new Mr(e,r)}};s(xee,"CrossFadedConstantBinder");var A0=xee,bee=class{constructor(e,r,i,n){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=r.map(a=>({name:"a_".concat(a),type:"Float32",components:i==="color"?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,r,i,n,a){let o=this.paintVertexArray.length,l=this.expression.evaluate(new fs(0),r,{},n,[],a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,l)}updatePaintArray(e,r,i,n){let a=this.expression.evaluate({zoom:0},i,n);this._setPaintValue(e,r,a)}_setPaintValue(e,r,i){if(this.type==="color"){let n=P3(i);for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,n[0],n[1])}else{for(let n=e;n<r;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}};s(bee,"SourceExpressionBinder");var Dd=bee,wee=class{constructor(e,r,i,n,a,o){this.expression=e,this.uniformNames=r.map(l=>"u_".concat(l,"_t")),this.type=i,this.useIntegerZoom=n,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=r.map(l=>({name:"a_".concat(l),type:"Float32",components:i==="color"?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(e,r,i,n,a){let o=this.expression.evaluate(new fs(this.zoom),r,{},n,[],a),l=this.expression.evaluate(new fs(this.zoom+1),r,{},n,[],a),u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(u,e,o,l)}updatePaintArray(e,r,i,n){let a=this.expression.evaluate({zoom:this.zoom},i,n),o=this.expression.evaluate({zoom:this.zoom+1},i,n);this._setPaintValue(e,r,a,o)}_setPaintValue(e,r,i,n){if(this.type==="color"){let a=P3(i),o=P3(n);for(let l=e;l<r;l++)this.paintVertexArray.emplace(l,a[0],a[1],o[0],o[1])}else{for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){let i=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,n=ps(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,r,i){return new Mr(e,r)}};s(wee,"CompositeExpressionBinder");var xh=wee,Aee=class{constructor(e,r,i,n,a,o){this.expression=e,this.type=r,this.useIntegerZoom=i,this.zoom=n,this.layerId=o,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,r,i){let n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,r.patterns&&r.patterns[this.layerId],i)}updatePaintArray(e,r,i,n,a){this._setPaintValues(e,r,i.patterns&&i.patterns[this.layerId],a)}_setPaintValues(e,r,i,n){if(!n||!i)return;let{min:a,mid:o,max:l}=i,u=n[a],c=n[o],p=n[l];if(!(!u||!c||!p))for(let m=e;m<r;m++)this.zoomInPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],c.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],c.pixelRatio,p.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,I3.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,I3.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}};s(Aee,"CrossFadedCompositeBinder");var hm=Aee,See=class{constructor(e,r,i){this.binders={},this._buffers=[];let n=[];for(let a in e.paint._values){if(!i(a))continue;let o=e.paint.get(a);if(!(o instanceof Fh)||!$y(o.property.specification))continue;let l=Cee(a,e.type),u=o.value,c=o.property.specification.type,p=o.property.useIntegerZoom,m=o.property.specification["property-type"],y=m==="cross-faded"||m==="cross-faded-data-driven";if(u.kind==="constant")this.binders[a]=y?new A0(u.value,l):new t2(u.value,l,c),n.push("/u_".concat(a));else if(u.kind==="source"||y){let v=OD(a,c,"source");this.binders[a]=y?new hm(u,c,p,r,v,e.id):new Dd(u,l,c,v),n.push("/a_".concat(a))}else{let v=OD(a,c,"composite");this.binders[a]=new xh(u,l,c,p,r,v),n.push("/z_".concat(a))}}this.cacheKey=n.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof Dd||r instanceof xh?r.maxValue:0}populatePaintArrays(e,r,i,n,a){for(let o in this.binders){let l=this.binders[o];(l instanceof Dd||l instanceof xh||l instanceof hm)&&l.populatePaintArray(e,r,i,n,a)}}setConstantPatternPositions(e,r){for(let i in this.binders){let n=this.binders[i];n instanceof A0&&n.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,i,n,a){let o=!1;for(let l in e){let u=r.getPositions(l);for(let c of u){let p=i.feature(c.index);for(let m in this.binders){let y=this.binders[m];if((y instanceof Dd||y instanceof xh||y instanceof hm)&&y.expression.isStateDependent===!0){let v=n.paint.get(m);y.expression=v.value,y.updatePaintArray(c.start,c.end,p,e[l],a),o=!0}}}}return o}defines(){let e=[];for(let r in this.binders){let i=this.binders[r];(i instanceof t2||i instanceof A0)&&e.push(...i.uniformNames.map(n=>"#define HAS_UNIFORM_".concat(n)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let i=this.binders[r];if(i instanceof Dd||i instanceof xh)for(let n=0;n<i.paintVertexAttributes.length;n++)e.push(i.paintVertexAttributes[n].name);else if(i instanceof hm)for(let n=0;n<I3.members.length;n++)e.push(I3.members[n].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let i=this.binders[r];if(i instanceof t2||i instanceof A0||i instanceof xh)for(let n of i.uniformNames)e.push(n)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let i=[];for(let n in this.binders){let a=this.binders[n];if(a instanceof t2||a instanceof A0||a instanceof xh){for(let o of a.uniformNames)if(r[o]){let l=a.getBinding(e,r[o],o);i.push({name:o,property:n,binding:l})}}}return i}setUniforms(e,r,i,n){for(let{name:a,property:o,binding:l}of r)this.binders[o].setUniform(l,n,i.get(o),a)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let i=this.binders[r];if(e&&i instanceof hm){let n=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(i instanceof Dd||i instanceof xh)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(let r in this.binders){let i=this.binders[r];(i instanceof Dd||i instanceof xh||i instanceof hm)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof Dd||r instanceof xh||r instanceof hm)&&r.destroy()}}};s(See,"ProgramConfiguration");var Mee=See,Eee=class{constructor(e,r,i=()=>!0){this.programConfigurations={};for(let n of e)this.programConfigurations[n.id]=new Mee(n,r,i);this.needsUpload=!1,this._featureMap=new cee,this._bufferOffset=0}populatePaintArrays(e,r,i,n,a,o){for(let l in this.programConfigurations)this.programConfigurations[l].populatePaintArrays(e,r,n,a,o);r.id!==void 0&&this._featureMap.add(r.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,i,n){for(let a of i)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,r,a,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};s(Eee,"ProgramConfigurationSet");var Hy=Eee;function Cee(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}s(Cee,"paintAttributeNames");function Iee(t){return{"line-pattern":{source:i0,composite:i0},"fill-pattern":{source:i0,composite:i0},"fill-extrusion-pattern":{source:i0,composite:i0}}[t]}s(Iee,"getLayoutException");function OD(t,e,r){let i={color:{source:Mw,composite:B7},number:{source:vP,composite:Mw}},n=Iee(t);return n&&n[r]||i[e][r]}s(OD,"layoutType");Rr("ConstantBinder",t2);Rr("CrossFadedConstantBinder",A0);Rr("SourceExpressionBinder",Dd);Rr("CrossFadedCompositeBinder",hm);Rr("CompositeExpressionBinder",xh);Rr("ProgramConfiguration",Mee,{omit:["_buffers"]});Rr("ProgramConfigurationSet",Hy);N();N();N();var h8e=15,kD=Math.pow(2,h8e-1)-1,BH=-kD-1;function og(t){let e=8192/t.extent,r=t.loadGeometry();for(let i=0;i<r.length;i++){let n=r[i];for(let a=0;a<n.length;a++){let o=n[a],l=Math.round(o.x*e),u=Math.round(o.y*e);o.x=ps(l,BH,kD),o.y=ps(u,BH,kD),(l<o.x||l>o.x+1||u<o.y||u>o.y+1)&&kl("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}s(og,"loadGeometry");N();function sg(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?og(t):[]}}s(sg,"toEvaluationFeature");function r2(t,e,r,i,n){t.emplaceBack(e*2+(i+1)/2,r*2+(n+1)/2)}s(r2,"addCircleVertex");var Tee=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Zke,this.indexArray=new cv,this.segments=new To,this.programConfigurations=new Hy(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){let n=this.layers[0],a=[],o=null,l=!1;n.type==="circle"&&(o=n.layout.get("circle-sort-key"),l=!o.isConstant());for(let{feature:u,id:c,index:p,sourceLayerIndex:m}of e){let y=this.layers[0]._featureFilter.needGeometry,v=sg(u,y);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),v,i))continue;let w=l?o.evaluate(v,{},i):void 0,E={id:c,properties:u.properties,type:u.type,sourceLayerIndex:m,index:p,geometry:y?v.geometry:og(u),patterns:{},sortKey:w};a.push(E)}l&&a.sort((u,c)=>u.sortKey-c.sortKey);for(let u of a){let{geometry:c,index:p,sourceLayerIndex:m}=u,y=e[p].feature;this.addFeature(u,c,p,i),r.featureIndex.insert(y,c,p,m,this.index)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,l8e),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,i,n){for(let a of r)for(let o of a){let l=o.x,u=o.y;if(l<0||l>=8192||u<0||u>=8192)continue;let c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),p=c.vertexLength;r2(this.layoutVertexArray,l,u,-1,-1),r2(this.layoutVertexArray,l,u,1,-1),r2(this.layoutVertexArray,l,u,1,1),r2(this.layoutVertexArray,l,u,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),c.vertexLength+=4,c.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},n)}};s(Tee,"CircleBucket");var U7=Tee;Rr("CircleBucket",U7,{omit:["layers"]});N();var SM=kr(Nn(),1);function V7(t,e){for(let r=0;r<t.length;r++)if(qy(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(qy(t,e[r]))return!0;return!!_P(t,e)}s(V7,"polygonIntersectsPolygon");function Pee(t,e,r){return!!(qy(t,e)||L3(e,t,r))}s(Pee,"polygonIntersectsBufferedPoint");function j7(t,e){if(t.length===1)return ND(e,t[0]);for(let r=0;r<e.length;r++){let i=e[r];for(let n=0;n<i.length;n++)if(qy(t,i[n]))return!0}for(let r=0;r<t.length;r++)if(ND(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(_P(t,e[r]))return!0;return!1}s(j7,"polygonIntersectsMultiPolygon");function Lee(t,e,r){for(let i=0;i<e.length;i++){let n=e[i];if(t.length>=3){for(let a=0;a<n.length;a++)if(qy(t,n[a]))return!0}if(Dee(t,n,r))return!0}return!1}s(Lee,"polygonIntersectsBufferedMultiLine");function Dee(t,e,r){if(t.length>1){if(_P(t,e))return!0;for(let i=0;i<e.length;i++)if(L3(e[i],t,r))return!0}for(let i=0;i<t.length;i++)if(L3(t[i],e,r))return!0;return!1}s(Dee,"lineIntersectsBufferedLine");function _P(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let i=t[r],n=t[r+1];for(let a=0;a<e.length-1;a++){let o=e[a],l=e[a+1];if(Ree(i,n,o,l))return!0}}return!1}s(_P,"lineIntersectsLine");function Ree(t,e,r,i){return of(t,r,i)!==of(e,r,i)&&of(t,e,r)!==of(t,e,i)}s(Ree,"lineSegmentIntersectsLineSegment");function L3(t,e,r){let i=r*r;if(e.length===1)return t.distSqr(e[0])<i;for(let n=1;n<e.length;n++){let a=e[n-1],o=e[n];if(Oee(t,a,o)<i)return!0}return!1}s(L3,"pointIntersectsBufferedLine");function Oee(t,e,r){let i=e.distSqr(r);if(i===0)return t.distSqr(e);let n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return n<0?t.distSqr(e):n>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(n)._add(e))}s(Oee,"distToSegmentSquared");function ND(t,e){let r=!1,i,n,a;for(let o=0;o<t.length;o++){i=t[o];for(let l=0,u=i.length-1;l<i.length;u=l++)n=i[l],a=i[u],n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(r=!r)}return r}s(ND,"multiPolygonContainsPoint");function qy(t,e){let r=!1;for(let i=0,n=t.length-1;i<t.length;n=i++){let a=t[i],o=t[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}s(qy,"polygonContainsPoint");function kee(t,e,r,i,n){for(let o of t)if(e<=o.x&&r<=o.y&&i>=o.x&&n>=o.y)return!0;let a=[new SM.default(e,r),new SM.default(e,n),new SM.default(i,n),new SM.default(i,r)];if(t.length>2){for(let o of a)if(qy(t,o))return!0}for(let o=0;o<t.length-1;o++){let l=t[o],u=t[o+1];if(Nee(l,u,a))return!0}return!1}s(kee,"polygonIntersectsBox");function Nee(t,e,r){let i=r[0],n=r[2];if(t.x<i.x&&e.x<i.x||t.x>n.x&&e.x>n.x||t.y<i.y&&e.y<i.y||t.y>n.y&&e.y>n.y)return!1;let a=of(t,e,r[0]);return a!==of(t,e,r[1])||a!==of(t,e,r[2])||a!==of(t,e,r[3])}s(Nee,"edgeIntersectsBox");N();var FD=kr(Nn(),1);function e_(t,e,r){let i=e.paint.get(t).value;return i.kind==="constant"?i.value:r.programConfigurations.get(e.id).getMaxValue(t)}s(e_,"getMaximumPaintValue");function EA(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}s(EA,"translateDistance");function CA(t,e,r,i,n){if(!e[0]&&!e[1])return t;let a=FD.default.convert(e)._mult(n);r==="viewport"&&a._rotate(-i);let o=[];for(let l=0;l<t.length;l++){let u=t[l];o.push(u.sub(a))}return o}s(CA,"translate");function Fee(t,e){let r=[];for(let i=0;i<t.length;i++){let n=t[i],a=[];for(let o=0;o<n.length;o++){let l=n[o-1],u=n[o],c=n[o+1],p=o===0?new FD.default(0,0):u.sub(l)._unit()._perp(),m=o===n.length-1?new FD.default(0,0):c.sub(u)._unit()._perp(),y=p._add(m)._unit(),v=y.x*m.x+y.y*m.y;v!==0&&y._mult(1/v),a.push(y._mult(e)._add(u))}r.push(a)}return r}s(Fee,"offsetLine");N();var zH,p8e=s(()=>zH=zH||new $u({"circle-sort-key":new di(Ut.layout_circle["circle-sort-key"])}),"getLayout"),UH,d8e=s(()=>UH=UH||new $u({"circle-radius":new di(Ut.paint_circle["circle-radius"]),"circle-color":new di(Ut.paint_circle["circle-color"]),"circle-blur":new di(Ut.paint_circle["circle-blur"]),"circle-opacity":new di(Ut.paint_circle["circle-opacity"]),"circle-translate":new Wr(Ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Wr(Ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wr(Ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wr(Ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new di(Ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new di(Ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new di(Ut.paint_circle["circle-stroke-opacity"])}),"getPaint"),f8e={get paint(){return d8e()},get layout(){return p8e()}};N();N();var zi=1e-6,Oa=typeof Float32Array<"u"?Float32Array:Array,Sy=Math.random;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var BD={};Nl(BD,{LDU:()=>ete,add:()=>tte,adjoint:()=>qee,clone:()=>zee,copy:()=>Uee,create:()=>Bee,determinant:()=>Wee,equals:()=>ite,exactEquals:()=>rte,frob:()=>Qee,fromRotation:()=>Yee,fromScaling:()=>Kee,fromValues:()=>jee,identity:()=>Vee,invert:()=>Hee,mul:()=>m8e,multiply:()=>$7,multiplyScalar:()=>nte,multiplyScalarAndAdd:()=>ate,rotate:()=>Xee,scale:()=>Zee,set:()=>$ee,str:()=>Jee,sub:()=>g8e,subtract:()=>G7,transpose:()=>Gee});N();function Bee(){var t=new Oa(4);return Oa!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}s(Bee,"create");function zee(t){var e=new Oa(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}s(zee,"clone");function Uee(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}s(Uee,"copy");function Vee(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}s(Vee,"identity");function jee(t,e,r,i){var n=new Oa(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}s(jee,"fromValues");function $ee(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}s($ee,"set");function Gee(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}s(Gee,"transpose");function Hee(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r*a-n*i;return o?(o=1/o,t[0]=a*o,t[1]=-i*o,t[2]=-n*o,t[3]=r*o,t):null}s(Hee,"invert");function qee(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}s(qee,"adjoint");function Wee(t){return t[0]*t[3]-t[2]*t[1]}s(Wee,"determinant");function $7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=r[0],u=r[1],c=r[2],p=r[3];return t[0]=i*l+a*u,t[1]=n*l+o*u,t[2]=i*c+a*p,t[3]=n*c+o*p,t}s($7,"multiply");function Xee(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=Math.sin(r),u=Math.cos(r);return t[0]=i*u+a*l,t[1]=n*u+o*l,t[2]=i*-l+a*u,t[3]=n*-l+o*u,t}s(Xee,"rotate");function Zee(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=r[0],u=r[1];return t[0]=i*l,t[1]=n*l,t[2]=a*u,t[3]=o*u,t}s(Zee,"scale");function Yee(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t}s(Yee,"fromRotation");function Kee(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}s(Kee,"fromScaling");function Jee(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}s(Jee,"str");function Qee(t){return Math.hypot(t[0],t[1],t[2],t[3])}s(Qee,"frob");function ete(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]}s(ete,"LDU");function tte(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}s(tte,"add");function G7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}s(G7,"subtract");function rte(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}s(rte,"exactEquals");function ite(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=zi*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=zi*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=zi*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-c)<=zi*Math.max(1,Math.abs(a),Math.abs(c))}s(ite,"equals");function nte(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}s(nte,"multiplyScalar");function ate(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}s(ate,"multiplyScalarAndAdd");var m8e=$7,g8e=G7,zD={};Nl(zD,{add:()=>Tte,adjoint:()=>mte,clone:()=>lte,copy:()=>ute,create:()=>ote,determinant:()=>gte,equals:()=>Rte,exactEquals:()=>Dte,frob:()=>Ite,fromMat2d:()=>Ate,fromMat4:()=>ste,fromQuat:()=>Ste,fromRotation:()=>bte,fromScaling:()=>wte,fromTranslation:()=>xte,fromValues:()=>cte,identity:()=>pte,invert:()=>fte,mul:()=>y8e,multiply:()=>H7,multiplyScalar:()=>Pte,multiplyScalarAndAdd:()=>Lte,normalFromMat4:()=>Mte,projection:()=>Ete,rotate:()=>vte,scale:()=>_te,set:()=>hte,str:()=>Cte,sub:()=>v8e,subtract:()=>q7,translate:()=>yte,transpose:()=>dte});N();function ote(){var t=new Oa(9);return Oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}s(ote,"create");function ste(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}s(ste,"fromMat4");function lte(t){var e=new Oa(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}s(lte,"clone");function ute(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}s(ute,"copy");function cte(t,e,r,i,n,a,o,l,u){var c=new Oa(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=i,c[4]=n,c[5]=a,c[6]=o,c[7]=l,c[8]=u,c}s(cte,"fromValues");function hte(t,e,r,i,n,a,o,l,u,c){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=o,t[6]=l,t[7]=u,t[8]=c,t}s(hte,"set");function pte(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}s(pte,"identity");function dte(t,e){if(t===e){var r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}s(dte,"transpose");function fte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=p*o-l*c,y=-p*a+l*u,v=c*a-o*u,w=r*m+i*y+n*v;return w?(w=1/w,t[0]=m*w,t[1]=(-p*i+n*c)*w,t[2]=(l*i-n*o)*w,t[3]=y*w,t[4]=(p*r-n*u)*w,t[5]=(-l*r+n*a)*w,t[6]=v*w,t[7]=(-c*r+i*u)*w,t[8]=(o*r-i*a)*w,t):null}s(fte,"invert");function mte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8];return t[0]=o*p-l*c,t[1]=n*c-i*p,t[2]=i*l-n*o,t[3]=l*u-a*p,t[4]=r*p-n*u,t[5]=n*a-r*l,t[6]=a*c-o*u,t[7]=i*u-r*c,t[8]=r*o-i*a,t}s(mte,"adjoint");function gte(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8];return e*(c*a-o*u)+r*(-c*n+o*l)+i*(u*n-a*l)}s(gte,"determinant");function H7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=r[0],v=r[1],w=r[2],E=r[3],M=r[4],I=r[5],P=r[6],C=r[7],T=r[8];return t[0]=y*i+v*o+w*c,t[1]=y*n+v*l+w*p,t[2]=y*a+v*u+w*m,t[3]=E*i+M*o+I*c,t[4]=E*n+M*l+I*p,t[5]=E*a+M*u+I*m,t[6]=P*i+C*o+T*c,t[7]=P*n+C*l+T*p,t[8]=P*a+C*u+T*m,t}s(H7,"multiply");function yte(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=r[0],v=r[1];return t[0]=i,t[1]=n,t[2]=a,t[3]=o,t[4]=l,t[5]=u,t[6]=y*i+v*o+c,t[7]=y*n+v*l+p,t[8]=y*a+v*u+m,t}s(yte,"translate");function vte(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=Math.sin(r),v=Math.cos(r);return t[0]=v*i+y*o,t[1]=v*n+y*l,t[2]=v*a+y*u,t[3]=v*o-y*i,t[4]=v*l-y*n,t[5]=v*u-y*a,t[6]=c,t[7]=p,t[8]=m,t}s(vte,"rotate");function _te(t,e,r){var i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}s(_te,"scale");function xte(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}s(xte,"fromTranslation");function bte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}s(bte,"fromRotation");function wte(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}s(wte,"fromScaling");function Ate(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}s(Ate,"fromMat2d");function Ste(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,l=i+i,u=n+n,c=r*o,p=i*o,m=i*l,y=n*o,v=n*l,w=n*u,E=a*o,M=a*l,I=a*u;return t[0]=1-m-w,t[3]=p-I,t[6]=y+M,t[1]=p+I,t[4]=1-c-w,t[7]=v-E,t[2]=y-M,t[5]=v+E,t[8]=1-c-m,t}s(Ste,"fromQuat");function Mte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],w=e[12],E=e[13],M=e[14],I=e[15],P=r*l-i*o,C=r*u-n*o,T=r*c-a*o,O=i*u-n*l,F=i*c-a*l,k=n*c-a*u,B=p*E-m*w,U=p*M-y*w,z=p*I-v*w,q=m*M-y*E,W=m*I-v*E,J=y*I-v*M,V=P*J-C*W+T*q+O*z-F*U+k*B;return V?(V=1/V,t[0]=(l*J-u*W+c*q)*V,t[1]=(u*z-o*J-c*U)*V,t[2]=(o*W-l*z+c*B)*V,t[3]=(n*W-i*J-a*q)*V,t[4]=(r*J-n*z+a*U)*V,t[5]=(i*z-r*W-a*B)*V,t[6]=(E*k-M*F+I*O)*V,t[7]=(M*T-w*k-I*C)*V,t[8]=(w*F-E*T+I*P)*V,t):null}s(Mte,"normalFromMat4");function Ete(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}s(Ete,"projection");function Cte(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}s(Cte,"str");function Ite(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}s(Ite,"frob");function Tte(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}s(Tte,"add");function q7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}s(q7,"subtract");function Pte(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}s(Pte,"multiplyScalar");function Lte(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t}s(Lte,"multiplyScalarAndAdd");function Dte(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}s(Dte,"exactEquals");function Rte(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7],p=t[8],m=e[0],y=e[1],v=e[2],w=e[3],E=e[4],M=e[5],I=e[6],P=e[7],C=e[8];return Math.abs(r-m)<=zi*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(i-y)<=zi*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(n-v)<=zi*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-w)<=zi*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-E)<=zi*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(l-M)<=zi*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-I)<=zi*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-P)<=zi*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(p-C)<=zi*Math.max(1,Math.abs(p),Math.abs(C))}s(Rte,"equals");var y8e=H7,v8e=q7,Nr={};Nl(Nr,{add:()=>mre,adjoint:()=>Vte,clone:()=>kte,copy:()=>Nte,create:()=>Ote,determinant:()=>jte,equals:()=>_re,exactEquals:()=>vre,frob:()=>fre,fromQuat:()=>ore,fromQuat2:()=>tre,fromRotation:()=>Kte,fromRotationTranslation:()=>Z7,fromRotationTranslationScale:()=>nre,fromRotationTranslationScaleOrigin:()=>are,fromScaling:()=>Yte,fromTranslation:()=>Zte,fromValues:()=>Fte,fromXRotation:()=>Jte,fromYRotation:()=>Qte,fromZRotation:()=>ere,frustum:()=>sre,getRotation:()=>ire,getScaling:()=>Y7,getTranslation:()=>rre,identity:()=>W7,invert:()=>Ute,lookAt:()=>hre,mul:()=>b8e,multiply:()=>X7,multiplyScalar:()=>gre,multiplyScalarAndAdd:()=>yre,ortho:()=>x8e,orthoNO:()=>J7,orthoZO:()=>cre,perspective:()=>_8e,perspectiveFromFieldOfView:()=>ure,perspectiveNO:()=>K7,perspectiveZO:()=>lre,rotate:()=>Hte,rotateX:()=>qte,rotateY:()=>Wte,rotateZ:()=>Xte,scale:()=>Gte,set:()=>Bte,str:()=>dre,sub:()=>w8e,subtract:()=>Q7,targetTo:()=>pre,translate:()=>$te,transpose:()=>zte});N();function Ote(){var t=new Oa(16);return Oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}s(Ote,"create");function kte(t){var e=new Oa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}s(kte,"clone");function Nte(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}s(Nte,"copy");function Fte(t,e,r,i,n,a,o,l,u,c,p,m,y,v,w,E){var M=new Oa(16);return M[0]=t,M[1]=e,M[2]=r,M[3]=i,M[4]=n,M[5]=a,M[6]=o,M[7]=l,M[8]=u,M[9]=c,M[10]=p,M[11]=m,M[12]=y,M[13]=v,M[14]=w,M[15]=E,M}s(Fte,"fromValues");function Bte(t,e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=o,t[6]=l,t[7]=u,t[8]=c,t[9]=p,t[10]=m,t[11]=y,t[12]=v,t[13]=w,t[14]=E,t[15]=M,t}s(Bte,"set");function W7(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(W7,"identity");function zte(t,e){if(t===e){var r=e[1],i=e[2],n=e[3],a=e[6],o=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=n,t[13]=o,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}s(zte,"transpose");function Ute(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],w=e[12],E=e[13],M=e[14],I=e[15],P=r*l-i*o,C=r*u-n*o,T=r*c-a*o,O=i*u-n*l,F=i*c-a*l,k=n*c-a*u,B=p*E-m*w,U=p*M-y*w,z=p*I-v*w,q=m*M-y*E,W=m*I-v*E,J=y*I-v*M,V=P*J-C*W+T*q+O*z-F*U+k*B;return V?(V=1/V,t[0]=(l*J-u*W+c*q)*V,t[1]=(n*W-i*J-a*q)*V,t[2]=(E*k-M*F+I*O)*V,t[3]=(y*F-m*k-v*O)*V,t[4]=(u*z-o*J-c*U)*V,t[5]=(r*J-n*z+a*U)*V,t[6]=(M*T-w*k-I*C)*V,t[7]=(p*k-y*T+v*C)*V,t[8]=(o*W-l*z+c*B)*V,t[9]=(i*z-r*W-a*B)*V,t[10]=(w*F-E*T+I*P)*V,t[11]=(m*T-p*F-v*P)*V,t[12]=(l*U-o*q-u*B)*V,t[13]=(r*q-i*U+n*B)*V,t[14]=(E*C-w*O-M*P)*V,t[15]=(p*O-m*C+y*P)*V,t):null}s(Ute,"invert");function Vte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],w=e[12],E=e[13],M=e[14],I=e[15];return t[0]=l*(y*I-v*M)-m*(u*I-c*M)+E*(u*v-c*y),t[1]=-(i*(y*I-v*M)-m*(n*I-a*M)+E*(n*v-a*y)),t[2]=i*(u*I-c*M)-l*(n*I-a*M)+E*(n*c-a*u),t[3]=-(i*(u*v-c*y)-l*(n*v-a*y)+m*(n*c-a*u)),t[4]=-(o*(y*I-v*M)-p*(u*I-c*M)+w*(u*v-c*y)),t[5]=r*(y*I-v*M)-p*(n*I-a*M)+w*(n*v-a*y),t[6]=-(r*(u*I-c*M)-o*(n*I-a*M)+w*(n*c-a*u)),t[7]=r*(u*v-c*y)-o*(n*v-a*y)+p*(n*c-a*u),t[8]=o*(m*I-v*E)-p*(l*I-c*E)+w*(l*v-c*m),t[9]=-(r*(m*I-v*E)-p*(i*I-a*E)+w*(i*v-a*m)),t[10]=r*(l*I-c*E)-o*(i*I-a*E)+w*(i*c-a*l),t[11]=-(r*(l*v-c*m)-o*(i*v-a*m)+p*(i*c-a*l)),t[12]=-(o*(m*M-y*E)-p*(l*M-u*E)+w*(l*y-u*m)),t[13]=r*(m*M-y*E)-p*(i*M-n*E)+w*(i*y-n*m),t[14]=-(r*(l*M-u*E)-o*(i*M-n*E)+w*(i*u-n*l)),t[15]=r*(l*y-u*m)-o*(i*y-n*m)+p*(i*u-n*l),t}s(Vte,"adjoint");function jte(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8],p=t[9],m=t[10],y=t[11],v=t[12],w=t[13],E=t[14],M=t[15],I=e*o-r*a,P=e*l-i*a,C=e*u-n*a,T=r*l-i*o,O=r*u-n*o,F=i*u-n*l,k=c*w-p*v,B=c*E-m*v,U=c*M-y*v,z=p*E-m*w,q=p*M-y*w,W=m*M-y*E;return I*W-P*q+C*z+T*U-O*B+F*k}s(jte,"determinant");function X7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=e[9],v=e[10],w=e[11],E=e[12],M=e[13],I=e[14],P=e[15],C=r[0],T=r[1],O=r[2],F=r[3];return t[0]=C*i+T*l+O*m+F*E,t[1]=C*n+T*u+O*y+F*M,t[2]=C*a+T*c+O*v+F*I,t[3]=C*o+T*p+O*w+F*P,C=r[4],T=r[5],O=r[6],F=r[7],t[4]=C*i+T*l+O*m+F*E,t[5]=C*n+T*u+O*y+F*M,t[6]=C*a+T*c+O*v+F*I,t[7]=C*o+T*p+O*w+F*P,C=r[8],T=r[9],O=r[10],F=r[11],t[8]=C*i+T*l+O*m+F*E,t[9]=C*n+T*u+O*y+F*M,t[10]=C*a+T*c+O*v+F*I,t[11]=C*o+T*p+O*w+F*P,C=r[12],T=r[13],O=r[14],F=r[15],t[12]=C*i+T*l+O*m+F*E,t[13]=C*n+T*u+O*y+F*M,t[14]=C*a+T*c+O*v+F*I,t[15]=C*o+T*p+O*w+F*P,t}s(X7,"multiply");function $te(t,e,r){var i=r[0],n=r[1],a=r[2],o,l,u,c,p,m,y,v,w,E,M,I;return e===t?(t[12]=e[0]*i+e[4]*n+e[8]*a+e[12],t[13]=e[1]*i+e[5]*n+e[9]*a+e[13],t[14]=e[2]*i+e[6]*n+e[10]*a+e[14],t[15]=e[3]*i+e[7]*n+e[11]*a+e[15]):(o=e[0],l=e[1],u=e[2],c=e[3],p=e[4],m=e[5],y=e[6],v=e[7],w=e[8],E=e[9],M=e[10],I=e[11],t[0]=o,t[1]=l,t[2]=u,t[3]=c,t[4]=p,t[5]=m,t[6]=y,t[7]=v,t[8]=w,t[9]=E,t[10]=M,t[11]=I,t[12]=o*i+p*n+w*a+e[12],t[13]=l*i+m*n+E*a+e[13],t[14]=u*i+y*n+M*a+e[14],t[15]=c*i+v*n+I*a+e[15]),t}s($te,"translate");function Gte(t,e,r){var i=r[0],n=r[1],a=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}s(Gte,"scale");function Hte(t,e,r,i){var n=i[0],a=i[1],o=i[2],l=Math.hypot(n,a,o),u,c,p,m,y,v,w,E,M,I,P,C,T,O,F,k,B,U,z,q,W,J,V,oe;return l<zi?null:(l=1/l,n*=l,a*=l,o*=l,u=Math.sin(r),c=Math.cos(r),p=1-c,m=e[0],y=e[1],v=e[2],w=e[3],E=e[4],M=e[5],I=e[6],P=e[7],C=e[8],T=e[9],O=e[10],F=e[11],k=n*n*p+c,B=a*n*p+o*u,U=o*n*p-a*u,z=n*a*p-o*u,q=a*a*p+c,W=o*a*p+n*u,J=n*o*p+a*u,V=a*o*p-n*u,oe=o*o*p+c,t[0]=m*k+E*B+C*U,t[1]=y*k+M*B+T*U,t[2]=v*k+I*B+O*U,t[3]=w*k+P*B+F*U,t[4]=m*z+E*q+C*W,t[5]=y*z+M*q+T*W,t[6]=v*z+I*q+O*W,t[7]=w*z+P*q+F*W,t[8]=m*J+E*V+C*oe,t[9]=y*J+M*V+T*oe,t[10]=v*J+I*V+O*oe,t[11]=w*J+P*V+F*oe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}s(Hte,"rotate");function qte(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],p=e[9],m=e[10],y=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+c*i,t[5]=o*n+p*i,t[6]=l*n+m*i,t[7]=u*n+y*i,t[8]=c*n-a*i,t[9]=p*n-o*i,t[10]=m*n-l*i,t[11]=y*n-u*i,t}s(qte,"rotateX");function Wte(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],o=e[1],l=e[2],u=e[3],c=e[8],p=e[9],m=e[10],y=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n-c*i,t[1]=o*n-p*i,t[2]=l*n-m*i,t[3]=u*n-y*i,t[8]=a*i+c*n,t[9]=o*i+p*n,t[10]=l*i+m*n,t[11]=u*i+y*n,t}s(Wte,"rotateY");function Xte(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],o=e[1],l=e[2],u=e[3],c=e[4],p=e[5],m=e[6],y=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+c*i,t[1]=o*n+p*i,t[2]=l*n+m*i,t[3]=u*n+y*i,t[4]=c*n-a*i,t[5]=p*n-o*i,t[6]=m*n-l*i,t[7]=y*n-u*i,t}s(Xte,"rotateZ");function Zte(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}s(Zte,"fromTranslation");function Yte(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Yte,"fromScaling");function Kte(t,e,r){var i=r[0],n=r[1],a=r[2],o=Math.hypot(i,n,a),l,u,c;return o<zi?null:(o=1/o,i*=o,n*=o,a*=o,l=Math.sin(e),u=Math.cos(e),c=1-u,t[0]=i*i*c+u,t[1]=n*i*c+a*l,t[2]=a*i*c-n*l,t[3]=0,t[4]=i*n*c-a*l,t[5]=n*n*c+u,t[6]=a*n*c+i*l,t[7]=0,t[8]=i*a*c+n*l,t[9]=n*a*c-i*l,t[10]=a*a*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}s(Kte,"fromRotation");function Jte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Jte,"fromXRotation");function Qte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Qte,"fromYRotation");function ere(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(ere,"fromZRotation");function Z7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=i+i,u=n+n,c=a+a,p=i*l,m=i*u,y=i*c,v=n*u,w=n*c,E=a*c,M=o*l,I=o*u,P=o*c;return t[0]=1-(v+E),t[1]=m+P,t[2]=y-I,t[3]=0,t[4]=m-P,t[5]=1-(p+E),t[6]=w+M,t[7]=0,t[8]=y+I,t[9]=w-M,t[10]=1-(p+v),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}s(Z7,"fromRotationTranslation");function tre(t,e){var r=new Oa(3),i=-e[0],n=-e[1],a=-e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=i*i+n*n+a*a+o*o;return m>0?(r[0]=(l*o+p*i+u*a-c*n)*2/m,r[1]=(u*o+p*n+c*i-l*a)*2/m,r[2]=(c*o+p*a+l*n-u*i)*2/m):(r[0]=(l*o+p*i+u*a-c*n)*2,r[1]=(u*o+p*n+c*i-l*a)*2,r[2]=(c*o+p*a+l*n-u*i)*2),Z7(t,e,r),t}s(tre,"fromQuat2");function rre(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}s(rre,"getTranslation");function Y7(t,e){var r=e[0],i=e[1],n=e[2],a=e[4],o=e[5],l=e[6],u=e[8],c=e[9],p=e[10];return t[0]=Math.hypot(r,i,n),t[1]=Math.hypot(a,o,l),t[2]=Math.hypot(u,c,p),t}s(Y7,"getScaling");function ire(t,e){var r=new Oa(3);Y7(r,e);var i=1/r[0],n=1/r[1],a=1/r[2],o=e[0]*i,l=e[1]*n,u=e[2]*a,c=e[4]*i,p=e[5]*n,m=e[6]*a,y=e[8]*i,v=e[9]*n,w=e[10]*a,E=o+p+w,M=0;return E>0?(M=Math.sqrt(E+1)*2,t[3]=.25*M,t[0]=(m-v)/M,t[1]=(y-u)/M,t[2]=(l-c)/M):o>p&&o>w?(M=Math.sqrt(1+o-p-w)*2,t[3]=(m-v)/M,t[0]=.25*M,t[1]=(l+c)/M,t[2]=(y+u)/M):p>w?(M=Math.sqrt(1+p-o-w)*2,t[3]=(y-u)/M,t[0]=(l+c)/M,t[1]=.25*M,t[2]=(m+v)/M):(M=Math.sqrt(1+w-o-p)*2,t[3]=(l-c)/M,t[0]=(y+u)/M,t[1]=(m+v)/M,t[2]=.25*M),t}s(ire,"getRotation");function nre(t,e,r,i){var n=e[0],a=e[1],o=e[2],l=e[3],u=n+n,c=a+a,p=o+o,m=n*u,y=n*c,v=n*p,w=a*c,E=a*p,M=o*p,I=l*u,P=l*c,C=l*p,T=i[0],O=i[1],F=i[2];return t[0]=(1-(w+M))*T,t[1]=(y+C)*T,t[2]=(v-P)*T,t[3]=0,t[4]=(y-C)*O,t[5]=(1-(m+M))*O,t[6]=(E+I)*O,t[7]=0,t[8]=(v+P)*F,t[9]=(E-I)*F,t[10]=(1-(m+w))*F,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}s(nre,"fromRotationTranslationScale");function are(t,e,r,i,n){var a=e[0],o=e[1],l=e[2],u=e[3],c=a+a,p=o+o,m=l+l,y=a*c,v=a*p,w=a*m,E=o*p,M=o*m,I=l*m,P=u*c,C=u*p,T=u*m,O=i[0],F=i[1],k=i[2],B=n[0],U=n[1],z=n[2],q=(1-(E+I))*O,W=(v+T)*O,J=(w-C)*O,V=(v-T)*F,oe=(1-(y+I))*F,Y=(M+P)*F,he=(w+C)*k,Q=(M-P)*k,ae=(1-(y+E))*k;return t[0]=q,t[1]=W,t[2]=J,t[3]=0,t[4]=V,t[5]=oe,t[6]=Y,t[7]=0,t[8]=he,t[9]=Q,t[10]=ae,t[11]=0,t[12]=r[0]+B-(q*B+V*U+he*z),t[13]=r[1]+U-(W*B+oe*U+Q*z),t[14]=r[2]+z-(J*B+Y*U+ae*z),t[15]=1,t}s(are,"fromRotationTranslationScaleOrigin");function ore(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,l=i+i,u=n+n,c=r*o,p=i*o,m=i*l,y=n*o,v=n*l,w=n*u,E=a*o,M=a*l,I=a*u;return t[0]=1-m-w,t[1]=p+I,t[2]=y-M,t[3]=0,t[4]=p-I,t[5]=1-c-w,t[6]=v+E,t[7]=0,t[8]=y+M,t[9]=v-E,t[10]=1-c-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(ore,"fromQuat");function sre(t,e,r,i,n,a,o){var l=1/(r-e),u=1/(n-i),c=1/(a-o);return t[0]=a*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*u,t[6]=0,t[7]=0,t[8]=(r+e)*l,t[9]=(n+i)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}s(sre,"frustum");function K7(t,e,r,i,n){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(i-n),t[10]=(n+i)*o,t[14]=2*n*i*o):(t[10]=-1,t[14]=-2*i),t}s(K7,"perspectiveNO");var _8e=K7;function lre(t,e,r,i,n){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(i-n),t[10]=n*o,t[14]=n*i*o):(t[10]=-1,t[14]=-i),t}s(lre,"perspectiveZO");function ure(t,e,r,i){var n=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),l=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+l),c=2/(n+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((o-l)*u*.5),t[9]=(n-a)*c*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}s(ure,"perspectiveFromFieldOfView");function J7(t,e,r,i,n,a,o){var l=1/(e-r),u=1/(i-n),c=1/(a-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*l,t[13]=(n+i)*u,t[14]=(o+a)*c,t[15]=1,t}s(J7,"orthoNO");var x8e=J7;function cre(t,e,r,i,n,a,o){var l=1/(e-r),u=1/(i-n),c=1/(a-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*l,t[13]=(n+i)*u,t[14]=a*c,t[15]=1,t}s(cre,"orthoZO");function hre(t,e,r,i){var n,a,o,l,u,c,p,m,y,v,w=e[0],E=e[1],M=e[2],I=i[0],P=i[1],C=i[2],T=r[0],O=r[1],F=r[2];return Math.abs(w-T)<zi&&Math.abs(E-O)<zi&&Math.abs(M-F)<zi?W7(t):(p=w-T,m=E-O,y=M-F,v=1/Math.hypot(p,m,y),p*=v,m*=v,y*=v,n=P*y-C*m,a=C*p-I*y,o=I*m-P*p,v=Math.hypot(n,a,o),v?(v=1/v,n*=v,a*=v,o*=v):(n=0,a=0,o=0),l=m*o-y*a,u=y*n-p*o,c=p*a-m*n,v=Math.hypot(l,u,c),v?(v=1/v,l*=v,u*=v,c*=v):(l=0,u=0,c=0),t[0]=n,t[1]=l,t[2]=p,t[3]=0,t[4]=a,t[5]=u,t[6]=m,t[7]=0,t[8]=o,t[9]=c,t[10]=y,t[11]=0,t[12]=-(n*w+a*E+o*M),t[13]=-(l*w+u*E+c*M),t[14]=-(p*w+m*E+y*M),t[15]=1,t)}s(hre,"lookAt");function pre(t,e,r,i){var n=e[0],a=e[1],o=e[2],l=i[0],u=i[1],c=i[2],p=n-r[0],m=a-r[1],y=o-r[2],v=p*p+m*m+y*y;v>0&&(v=1/Math.sqrt(v),p*=v,m*=v,y*=v);var w=u*y-c*m,E=c*p-l*y,M=l*m-u*p;return v=w*w+E*E+M*M,v>0&&(v=1/Math.sqrt(v),w*=v,E*=v,M*=v),t[0]=w,t[1]=E,t[2]=M,t[3]=0,t[4]=m*M-y*E,t[5]=y*w-p*M,t[6]=p*E-m*w,t[7]=0,t[8]=p,t[9]=m,t[10]=y,t[11]=0,t[12]=n,t[13]=a,t[14]=o,t[15]=1,t}s(pre,"targetTo");function dre(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}s(dre,"str");function fre(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}s(fre,"frob");function mre(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}s(mre,"add");function Q7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}s(Q7,"subtract");function gre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}s(gre,"multiplyScalar");function yre(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}s(yre,"multiplyScalarAndAdd");function vre(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}s(vre,"exactEquals");function _re(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7],p=t[8],m=t[9],y=t[10],v=t[11],w=t[12],E=t[13],M=t[14],I=t[15],P=e[0],C=e[1],T=e[2],O=e[3],F=e[4],k=e[5],B=e[6],U=e[7],z=e[8],q=e[9],W=e[10],J=e[11],V=e[12],oe=e[13],Y=e[14],he=e[15];return Math.abs(r-P)<=zi*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(i-C)<=zi*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(n-T)<=zi*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(a-O)<=zi*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(o-F)<=zi*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(l-k)<=zi*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-B)<=zi*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(c-U)<=zi*Math.max(1,Math.abs(c),Math.abs(U))&&Math.abs(p-z)<=zi*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(m-q)<=zi*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(y-W)<=zi*Math.max(1,Math.abs(y),Math.abs(W))&&Math.abs(v-J)<=zi*Math.max(1,Math.abs(v),Math.abs(J))&&Math.abs(w-V)<=zi*Math.max(1,Math.abs(w),Math.abs(V))&&Math.abs(E-oe)<=zi*Math.max(1,Math.abs(E),Math.abs(oe))&&Math.abs(M-Y)<=zi*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(I-he)<=zi*Math.max(1,Math.abs(I),Math.abs(he))}s(_re,"equals");var b8e=X7,w8e=Q7,kh={};Nl(kh,{add:()=>Sre,angle:()=>qre,bezier:()=>Bre,ceil:()=>Mre,clone:()=>xre,copy:()=>wre,create:()=>eF,cross:()=>kre,dist:()=>E8e,distance:()=>aF,div:()=>M8e,divide:()=>nF,dot:()=>lF,equals:()=>Yre,exactEquals:()=>Zre,floor:()=>Ere,forEach:()=>P8e,fromValues:()=>bre,hermite:()=>Fre,inverse:()=>Rre,len:()=>I8e,length:()=>tF,lerp:()=>Nre,max:()=>Ire,min:()=>Cre,mul:()=>S8e,multiply:()=>iF,negate:()=>Dre,normalize:()=>Ore,random:()=>zre,rotateX:()=>$re,rotateY:()=>Gre,rotateZ:()=>Hre,round:()=>Tre,scale:()=>Pre,scaleAndAdd:()=>Lre,set:()=>Are,sqrDist:()=>C8e,sqrLen:()=>T8e,squaredDistance:()=>oF,squaredLength:()=>sF,str:()=>Xre,sub:()=>A8e,subtract:()=>rF,transformMat3:()=>Vre,transformMat4:()=>Ure,transformQuat:()=>jre,zero:()=>Wre});N();function eF(){var t=new Oa(3);return Oa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}s(eF,"create");function xre(t){var e=new Oa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}s(xre,"clone");function tF(t){var e=t[0],r=t[1],i=t[2];return Math.hypot(e,r,i)}s(tF,"length");function bre(t,e,r){var i=new Oa(3);return i[0]=t,i[1]=e,i[2]=r,i}s(bre,"fromValues");function wre(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}s(wre,"copy");function Are(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}s(Are,"set");function Sre(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}s(Sre,"add");function rF(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}s(rF,"subtract");function iF(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}s(iF,"multiply");function nF(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}s(nF,"divide");function Mre(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}s(Mre,"ceil");function Ere(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}s(Ere,"floor");function Cre(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}s(Cre,"min");function Ire(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}s(Ire,"max");function Tre(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}s(Tre,"round");function Pre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}s(Pre,"scale");function Lre(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}s(Lre,"scaleAndAdd");function aF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.hypot(r,i,n)}s(aF,"distance");function oF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n}s(oF,"squaredDistance");function sF(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}s(sF,"squaredLength");function Dre(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}s(Dre,"negate");function Rre(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}s(Rre,"inverse");function Ore(t,e){var r=e[0],i=e[1],n=e[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}s(Ore,"normalize");function lF(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}s(lF,"dot");function kre(t,e,r){var i=e[0],n=e[1],a=e[2],o=r[0],l=r[1],u=r[2];return t[0]=n*u-a*l,t[1]=a*o-i*u,t[2]=i*l-n*o,t}s(kre,"cross");function Nre(t,e,r,i){var n=e[0],a=e[1],o=e[2];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=o+i*(r[2]-o),t}s(Nre,"lerp");function Fre(t,e,r,i,n,a){var o=a*a,l=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),p=o*(3-2*a);return t[0]=e[0]*l+r[0]*u+i[0]*c+n[0]*p,t[1]=e[1]*l+r[1]*u+i[1]*c+n[1]*p,t[2]=e[2]*l+r[2]*u+i[2]*c+n[2]*p,t}s(Fre,"hermite");function Bre(t,e,r,i,n,a){var o=1-a,l=o*o,u=a*a,c=l*o,p=3*a*l,m=3*u*o,y=u*a;return t[0]=e[0]*c+r[0]*p+i[0]*m+n[0]*y,t[1]=e[1]*c+r[1]*p+i[1]*m+n[1]*y,t[2]=e[2]*c+r[2]*p+i[2]*m+n[2]*y,t}s(Bre,"bezier");function zre(t,e){e=e||1;var r=Sy()*2*Math.PI,i=Sy()*2-1,n=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t[2]=i*e,t}s(zre,"random");function Ure(t,e,r){var i=e[0],n=e[1],a=e[2],o=r[3]*i+r[7]*n+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/o,t[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/o,t[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/o,t}s(Ure,"transformMat4");function Vre(t,e,r){var i=e[0],n=e[1],a=e[2];return t[0]=i*r[0]+n*r[3]+a*r[6],t[1]=i*r[1]+n*r[4]+a*r[7],t[2]=i*r[2]+n*r[5]+a*r[8],t}s(Vre,"transformMat3");function jre(t,e,r){var i=r[0],n=r[1],a=r[2],o=r[3],l=e[0],u=e[1],c=e[2],p=n*c-a*u,m=a*l-i*c,y=i*u-n*l,v=n*y-a*m,w=a*p-i*y,E=i*m-n*p,M=o*2;return p*=M,m*=M,y*=M,v*=2,w*=2,E*=2,t[0]=l+p+v,t[1]=u+m+w,t[2]=c+y+E,t}s(jre,"transformQuat");function $re(t,e,r,i){var n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}s($re,"rotateX");function Gre(t,e,r,i){var n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}s(Gre,"rotateY");function Hre(t,e,r,i){var n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}s(Hre,"rotateZ");function qre(t,e){var r=t[0],i=t[1],n=t[2],a=e[0],o=e[1],l=e[2],u=Math.sqrt(r*r+i*i+n*n),c=Math.sqrt(a*a+o*o+l*l),p=u*c,m=p&&lF(t,e)/p;return Math.acos(Math.min(Math.max(m,-1),1))}s(qre,"angle");function Wre(t){return t[0]=0,t[1]=0,t[2]=0,t}s(Wre,"zero");function Xre(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}s(Xre,"str");function Zre(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}s(Zre,"exactEquals");function Yre(t,e){var r=t[0],i=t[1],n=t[2],a=e[0],o=e[1],l=e[2];return Math.abs(r-a)<=zi*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=zi*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=zi*Math.max(1,Math.abs(n),Math.abs(l))}s(Yre,"equals");var A8e=rF,S8e=iF,M8e=nF,E8e=aF,C8e=oF,I8e=tF,T8e=sF,P8e=function(){var t=eF();return function(e,r,i,n,a,o){var l,u;for(r||(r=3),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,l=i;l<u;l+=r)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,o),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}}(),Jl={};Nl(Jl,{add:()=>tie,ceil:()=>rie,clone:()=>Kre,copy:()=>Qre,create:()=>uF,cross:()=>die,dist:()=>O8e,distance:()=>dF,div:()=>R8e,divide:()=>pF,dot:()=>pie,equals:()=>bie,exactEquals:()=>xie,floor:()=>iie,forEach:()=>B8e,fromValues:()=>Jre,inverse:()=>cie,len:()=>N8e,length:()=>mF,lerp:()=>fie,max:()=>aie,min:()=>nie,mul:()=>D8e,multiply:()=>hF,negate:()=>uie,normalize:()=>hie,random:()=>mie,round:()=>oie,scale:()=>sie,scaleAndAdd:()=>lie,set:()=>eie,sqrDist:()=>k8e,sqrLen:()=>F8e,squaredDistance:()=>fF,squaredLength:()=>gF,str:()=>_ie,sub:()=>L8e,subtract:()=>cF,transformMat4:()=>gie,transformQuat:()=>yie,zero:()=>vie});N();function uF(){var t=new Oa(4);return Oa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}s(uF,"create");function Kre(t){var e=new Oa(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}s(Kre,"clone");function Jre(t,e,r,i){var n=new Oa(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}s(Jre,"fromValues");function Qre(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}s(Qre,"copy");function eie(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}s(eie,"set");function tie(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}s(tie,"add");function cF(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}s(cF,"subtract");function hF(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}s(hF,"multiply");function pF(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}s(pF,"divide");function rie(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}s(rie,"ceil");function iie(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}s(iie,"floor");function nie(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}s(nie,"min");function aie(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}s(aie,"max");function oie(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}s(oie,"round");function sie(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}s(sie,"scale");function lie(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}s(lie,"scaleAndAdd");function dF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return Math.hypot(r,i,n,a)}s(dF,"distance");function fF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return r*r+i*i+n*n+a*a}s(fF,"squaredDistance");function mF(t){var e=t[0],r=t[1],i=t[2],n=t[3];return Math.hypot(e,r,i,n)}s(mF,"length");function gF(t){var e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n}s(gF,"squaredLength");function uie(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}s(uie,"negate");function cie(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}s(cie,"inverse");function hie(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r*r+i*i+n*n+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=i*o,t[2]=n*o,t[3]=a*o,t}s(hie,"normalize");function pie(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}s(pie,"dot");function die(t,e,r,i){var n=r[0]*i[1]-r[1]*i[0],a=r[0]*i[2]-r[2]*i[0],o=r[0]*i[3]-r[3]*i[0],l=r[1]*i[2]-r[2]*i[1],u=r[1]*i[3]-r[3]*i[1],c=r[2]*i[3]-r[3]*i[2],p=e[0],m=e[1],y=e[2],v=e[3];return t[0]=m*c-y*u+v*l,t[1]=-(p*c)+y*o-v*a,t[2]=p*u-m*o+v*n,t[3]=-(p*l)+m*a-y*n,t}s(die,"cross");function fie(t,e,r,i){var n=e[0],a=e[1],o=e[2],l=e[3];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=o+i*(r[2]-o),t[3]=l+i*(r[3]-l),t}s(fie,"lerp");function mie(t,e){e=e||1;var r,i,n,a,o,l;do r=Sy()*2-1,i=Sy()*2-1,o=r*r+i*i;while(o>=1);do n=Sy()*2-1,a=Sy()*2-1,l=n*n+a*a;while(l>=1);var u=Math.sqrt((1-o)/l);return t[0]=e*r,t[1]=e*i,t[2]=e*n*u,t[3]=e*a*u,t}s(mie,"random");function gie(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*o,t[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*o,t[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*o,t[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*o,t}s(gie,"transformMat4");function yie(t,e,r){var i=e[0],n=e[1],a=e[2],o=r[0],l=r[1],u=r[2],c=r[3],p=c*i+l*a-u*n,m=c*n+u*i-o*a,y=c*a+o*n-l*i,v=-o*i-l*n-u*a;return t[0]=p*c+v*-o+m*-u-y*-l,t[1]=m*c+v*-l+y*-o-p*-u,t[2]=y*c+v*-u+p*-l-m*-o,t[3]=e[3],t}s(yie,"transformQuat");function vie(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}s(vie,"zero");function _ie(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}s(_ie,"str");function xie(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}s(xie,"exactEquals");function bie(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=zi*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=zi*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=zi*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-c)<=zi*Math.max(1,Math.abs(a),Math.abs(c))}s(bie,"equals");var L8e=cF,D8e=hF,R8e=pF,O8e=dF,k8e=fF,N8e=mF,F8e=gF,B8e=function(){var t=uF();return function(e,r,i,n,a,o){var l,u;for(r||(r=4),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,l=i;l<u;l+=r)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,o),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}}(),yF={};Nl(yF,{add:()=>Eie,angle:()=>qie,ceil:()=>Cie,clone:()=>wie,copy:()=>Sie,create:()=>vF,cross:()=>Bie,dist:()=>$8e,distance:()=>wF,div:()=>j8e,divide:()=>bF,dot:()=>Fie,equals:()=>Yie,exactEquals:()=>Zie,floor:()=>Iie,forEach:()=>q8e,fromValues:()=>Aie,inverse:()=>kie,len:()=>z8e,length:()=>SF,lerp:()=>zie,max:()=>Pie,min:()=>Tie,mul:()=>V8e,multiply:()=>xF,negate:()=>Oie,normalize:()=>Nie,random:()=>Uie,rotate:()=>Hie,round:()=>Lie,scale:()=>Die,scaleAndAdd:()=>Rie,set:()=>Mie,sqrDist:()=>G8e,sqrLen:()=>H8e,squaredDistance:()=>AF,squaredLength:()=>MF,str:()=>Xie,sub:()=>U8e,subtract:()=>_F,transformMat2:()=>Vie,transformMat2d:()=>jie,transformMat3:()=>$ie,transformMat4:()=>Gie,zero:()=>Wie});N();function vF(){var t=new Oa(2);return Oa!=Float32Array&&(t[0]=0,t[1]=0),t}s(vF,"create");function wie(t){var e=new Oa(2);return e[0]=t[0],e[1]=t[1],e}s(wie,"clone");function Aie(t,e){var r=new Oa(2);return r[0]=t,r[1]=e,r}s(Aie,"fromValues");function Sie(t,e){return t[0]=e[0],t[1]=e[1],t}s(Sie,"copy");function Mie(t,e,r){return t[0]=e,t[1]=r,t}s(Mie,"set");function Eie(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}s(Eie,"add");function _F(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}s(_F,"subtract");function xF(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}s(xF,"multiply");function bF(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}s(bF,"divide");function Cie(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}s(Cie,"ceil");function Iie(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}s(Iie,"floor");function Tie(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}s(Tie,"min");function Pie(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}s(Pie,"max");function Lie(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}s(Lie,"round");function Die(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}s(Die,"scale");function Rie(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}s(Rie,"scaleAndAdd");function wF(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.hypot(r,i)}s(wF,"distance");function AF(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}s(AF,"squaredDistance");function SF(t){var e=t[0],r=t[1];return Math.hypot(e,r)}s(SF,"length");function MF(t){var e=t[0],r=t[1];return e*e+r*r}s(MF,"squaredLength");function Oie(t,e){return t[0]=-e[0],t[1]=-e[1],t}s(Oie,"negate");function kie(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}s(kie,"inverse");function Nie(t,e){var r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t}s(Nie,"normalize");function Fie(t,e){return t[0]*e[0]+t[1]*e[1]}s(Fie,"dot");function Bie(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}s(Bie,"cross");function zie(t,e,r,i){var n=e[0],a=e[1];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t}s(zie,"lerp");function Uie(t,e){e=e||1;var r=Sy()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}s(Uie,"random");function Vie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t}s(Vie,"transformMat2");function jie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t}s(jie,"transformMat2d");function $ie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t}s($ie,"transformMat3");function Gie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t}s(Gie,"transformMat4");function Hie(t,e,r,i){var n=e[0]-r[0],a=e[1]-r[1],o=Math.sin(i),l=Math.cos(i);return t[0]=n*l-a*o+r[0],t[1]=n*o+a*l+r[1],t}s(Hie,"rotate");function qie(t,e){var r=t[0],i=t[1],n=e[0],a=e[1],o=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+a*a),l=o&&(r*n+i*a)/o;return Math.acos(Math.min(Math.max(l,-1),1))}s(qie,"angle");function Wie(t){return t[0]=0,t[1]=0,t}s(Wie,"zero");function Xie(t){return"vec2("+t[0]+", "+t[1]+")"}s(Xie,"str");function Zie(t,e){return t[0]===e[0]&&t[1]===e[1]}s(Zie,"exactEquals");function Yie(t,e){var r=t[0],i=t[1],n=e[0],a=e[1];return Math.abs(r-n)<=zi*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-a)<=zi*Math.max(1,Math.abs(i),Math.abs(a))}s(Yie,"equals");var z8e=SF,U8e=_F,V8e=xF,j8e=bF,$8e=wF,G8e=AF,H8e=MF,q8e=function(){var t=vF();return function(e,r,i,n,a,o){var l,u;for(r||(r=2),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,l=i;l<u;l+=r)t[0]=e[l],t[1]=e[l+1],a(t,t,o),e[l]=t[0],e[l+1]=t[1];return e}}(),W8e=kr(Nn(),1),Kie=class extends id{constructor(e){super(e,f8e)}createBucket(e){return new U7(e)}queryRadius(e){let r=e;return e_("circle-radius",this,r)+e_("circle-stroke-width",this,r)+EA(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,i,n,a,o,l,u){let c=CA(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,l),p=this.paint.get("circle-radius").evaluate(r,i),m=this.paint.get("circle-stroke-width").evaluate(r,i),y=p+m,v=this.paint.get("circle-pitch-alignment")==="map",w=v?c:Jie(c,u),E=v?y*l:y;for(let M of n)for(let I of M){let P=v?I:EF(I,u),C=E,T=Jl.transformMat4([],[I.x,I.y,0,1],u);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?C*=T[3]/o.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(C*=o.cameraToCenterDistance/T[3]),Pee(w,P,C))return!0}return!1}};s(Kie,"CircleStyleLayer");var X8e=Kie;function EF(t,e){let r=Jl.transformMat4([],[t.x,t.y,0,1],e);return new W8e.default(r[0]/r[3],r[1]/r[3])}s(EF,"projectPoint");function Jie(t,e){return t.map(r=>EF(r,e))}s(Jie,"projectQueryGeometry");N();N();var Qie=class extends U7{};s(Qie,"HeatmapBucket");var ene=Qie;Rr("HeatmapBucket",ene,{omit:["layers"]});N();var VH,Z8e=s(()=>VH=VH||new $u({"heatmap-radius":new di(Ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new di(Ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wr(Ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new x7(Ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wr(Ut.paint_heatmap["heatmap-opacity"])}),"getPaint"),Y8e={get paint(){return Z8e()}};N();N();function xP(t,{width:e,height:r},i,n){if(!n)n=new Uint8Array(e*r*i);else if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*r*i)throw new RangeError("mismatched image size. expected: ".concat(n.length," but got: ").concat(e*r*i));return t.width=e,t.height=r,t.data=n,t}s(xP,"createImage");function CF(t,{width:e,height:r},i){if(e===t.width&&r===t.height)return;let n=xP({},{width:e,height:r},i);bP(t,n,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},i),t.width=e,t.height=r,t.data=n.data}s(CF,"resizeImage");function bP(t,e,r,i,n,a){if(n.width===0||n.height===0)return e;if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||i.x>e.width-n.width||i.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");let o=t.data,l=e.data;if(o===l)throw new Error("srcData equals dstData, so image is already copied");for(let u=0;u<n.height;u++){let c=((r.y+u)*t.width+r.x)*a,p=((i.y+u)*e.width+i.x)*a;for(let m=0;m<n.width*a;m++)l[p+m]=o[c+m]}return e}s(bP,"copyImage");var tne=class rne{constructor(e,r){xP(this,e,1,r)}resize(e){CF(this,e,1)}clone(){return new rne({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,i,n,a){bP(e,r,i,n,a,1)}};s(tne,"AlphaImage");var IF=tne,ine=class nne{constructor(e,r){xP(this,e,4,r)}resize(e){CF(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new nne({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,i,n,a){bP(e,r,i,n,a,4)}};s(ine,"RGBAImage");var go=ine;Rr("AlphaImage",IF);Rr("RGBAImage",go);function TF(t){let e={},r=t.resolution||256,i=t.clips?t.clips.length:1,n=t.image||new go({width:r,height:i});if(!lZ(r))throw new Error("width is not a power of 2 - ".concat(r));let a=s((o,l,u)=>{e[t.evaluationKey]=u;let c=t.expression.evaluate(e);n.data[o+l+0]=Math.floor(c.r*255/c.a),n.data[o+l+1]=Math.floor(c.g*255/c.a),n.data[o+l+2]=Math.floor(c.b*255/c.a),n.data[o+l+3]=Math.floor(c.a*255)},"renderPixel");if(t.clips)for(let o=0,l=0;o<i;++o,l+=r*4)for(let u=0,c=0;u<r;u++,c+=4){let p=u/(r-1),{start:m,end:y}=t.clips[o],v=m*(1-p)+y*p;a(l,c,v)}else for(let o=0,l=0;o<r;o++,l+=4){let u=o/(r-1);a(0,l,u)}return n}s(TF,"renderColorRamp");var ane=class extends id{createBucket(e){return new ene(e)}constructor(e){super(e,Y8e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=TF({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};s(ane,"HeatmapStyleLayer");var K8e=ane;N();N();var jH,J8e=s(()=>jH=jH||new $u({"hillshade-illumination-direction":new Wr(Ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wr(Ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wr(Ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wr(Ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wr(Ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wr(Ut.paint_hillshade["hillshade-accent-color"])}),"getPaint"),Q8e={get paint(){return J8e()}},one=class extends id{constructor(e){super(e,Q8e)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};s(one,"HillshadeStyleLayer");var eNe=one;N();N();N();var tNe=ao([{name:"a_pos",components:2,type:"Int16"}],4),{members:rNe,size:Xat,alignment:Zat}=tNe,iNe=kr(A9(),1);N();N();function sne(t,e,r,i,n){PF(t,e,r||0,i||t.length-1,n||lne)}s(sne,"quickselect");function PF(t,e,r,i,n){for(;i>r;){if(i-r>600){var a=i-r+1,o=e-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(o-a/2<0?-1:1),p=Math.max(r,Math.floor(e-o*u/a+c)),m=Math.min(i,Math.floor(e+(a-o)*u/a+c));PF(t,e,p,m,n)}var y=t[e],v=r,w=i;for(S0(t,r,e),n(t[i],y)>0&&S0(t,r,i);v<w;){for(S0(t,v,w),v++,w--;n(t[v],y)<0;)v++;for(;n(t[w],y)>0;)w--}n(t[r],y)===0?S0(t,r,w):(w++,S0(t,w,i)),w<=e&&(r=w+1),e<=w&&(i=w-1)}}s(PF,"quickselectStep");function S0(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}s(S0,"swap");function lne(t,e){return t<e?-1:t>e?1:0}s(lne,"defaultCompare");function LF(t,e){let r=t.length;if(r<=1)return[t];let i=[],n,a;for(let o=0;o<r;o++){let l=pZ(t[o]);l!==0&&(t[o].area=Math.abs(l),a===void 0&&(a=l<0),a===l<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}if(n&&i.push(n),e>1)for(let o=0;o<i.length;o++)i[o].length<=e||(sne(i[o],e,1,i[o].length-1,une),i[o]=i[o].slice(0,e));return i}s(LF,"classifyRings");function une(t,e){return e.area-t.area}s(une,"compareAreas");N();function wP(t,e,r){let i=r.patternDependencies,n=!1;for(let a of e){let o=a.paint.get("".concat(t,"-pattern"));o.isConstant()||(n=!0);let l=o.constantOr(null);l&&(n=!0,i[l.to]=!0,i[l.from]=!0)}return n}s(wP,"hasPattern");function AP(t,e,r,i,n){let a=n.patternDependencies;for(let o of e){let l=o.paint.get("".concat(t,"-pattern")).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:i-1},r,{},n.availableImages),c=l.evaluate({zoom:i},r,{},n.availableImages),p=l.evaluate({zoom:i+1},r,{},n.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,a[u]=!0,a[c]=!0,a[p]=!0,r.patterns[o.id]={min:u,mid:c,max:p}}}return r}s(AP,"addPatternDependencies");var nNe=500,cne=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yke,this.indexArray=new cv,this.indexArray2=new LD,this.programConfigurations=new Hy(e.layers,e.zoom),this.segments=new To,this.segments2=new To,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){this.hasPattern=wP("fill",this.layers,r);let n=this.layers[0].layout.get("fill-sort-key"),a=!n.isConstant(),o=[];for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let m=this.layers[0]._featureFilter.needGeometry,y=sg(l,m);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),y,i))continue;let v=a?n.evaluate(y,{},i,r.availableImages):void 0,w={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:m?y.geometry:og(l),patterns:{},sortKey:v};o.push(w)}a&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l;if(this.hasPattern){let y=AP("fill",this.layers,l,this.zoom,r);this.patternFeatures.push(y)}else this.addFeature(l,u,c,i,{});let m=e[c].feature;r.featureIndex.insert(m,u,c,p,this.index)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}addFeatures(e,r,i){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,r,i)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,rNe),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,i,n,a){for(let o of LF(r,nNe)){let l=0;for(let v of o)l+=v.length;let u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),c=u.vertexLength,p=[],m=[];for(let v of o){if(v.length===0)continue;v!==o[0]&&m.push(p.length/2);let w=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),E=w.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(E+v.length-1,E),p.push(v[0].x),p.push(v[0].y);for(let M=1;M<v.length;M++)this.layoutVertexArray.emplaceBack(v[M].x,v[M].y),this.indexArray2.emplaceBack(E+M-1,E+M),p.push(v[M].x),p.push(v[M].y);w.vertexLength+=v.length,w.primitiveLength+=v.length}let y=(0,iNe.default)(p,m);for(let v=0;v<y.length;v+=3)this.indexArray.emplaceBack(c+y[v],c+y[v+1],c+y[v+2]);u.vertexLength+=l,u.primitiveLength+=y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,a,n)}};s(cne,"FillBucket");var hne=cne;Rr("FillBucket",hne,{omit:["layers","patternFeatures"]});N();var $H,aNe=s(()=>$H=$H||new $u({"fill-sort-key":new di(Ut.layout_fill["fill-sort-key"])}),"getLayout"),GH,oNe=s(()=>GH=GH||new $u({"fill-antialias":new Wr(Ut.paint_fill["fill-antialias"]),"fill-opacity":new di(Ut.paint_fill["fill-opacity"]),"fill-color":new di(Ut.paint_fill["fill-color"]),"fill-outline-color":new di(Ut.paint_fill["fill-outline-color"]),"fill-translate":new Wr(Ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Wr(Ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new mP(Ut.paint_fill["fill-pattern"])}),"getPaint"),sNe={get paint(){return oNe()},get layout(){return aNe()}},pne=class extends id{constructor(e){super(e,sNe)}recalculate(e,r){super.recalculate(e,r);let i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new hne(e)}queryRadius(){return EA(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,i,n,a,o,l){let u=CA(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,l);return j7(u,n)}isTileClipped(){return!0}};s(pne,"FillStyleLayer");var lNe=pne;N();N();N();var uNe=ao([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),cNe=ao([{name:"a_centroid",components:2,type:"Int16"}],4),{members:hNe,size:Jat,alignment:Qat}=uNe,pNe=kr(A9(),1),dNe=kr(WT(),1),fNe=dNe.default.VectorTileFeature.types,mNe=500,DL=Math.pow(2,13);function M0(t,e,r,i,n,a,o,l){t.emplaceBack(e,r,Math.floor(i*DL)*2+o,n*DL*2,a*DL*2,Math.round(l))}s(M0,"addVertex");var dne=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Kke,this.centroidVertexArray=new zE,this.indexArray=new cv,this.programConfigurations=new Hy(e.layers,e.zoom),this.segments=new To,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){this.features=[],this.hasPattern=wP("fill-extrusion",this.layers,r);for(let{feature:n,id:a,index:o,sourceLayerIndex:l}of e){let u=this.layers[0]._featureFilter.needGeometry,c=sg(n,u);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),c,i))continue;let p={id:a,sourceLayerIndex:l,index:o,geometry:u?c.geometry:og(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(AP("fill-extrusion",this.layers,p,this.zoom,r)):this.addFeature(p,p.geometry,o,i,{}),r.featureIndex.insert(n,p.geometry,o,l,this.index,!0)}}addFeatures(e,r,i){for(let n of this.features){let{geometry:a}=n;this.addFeature(n,a,n.index,r,i)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hNe),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,cNe.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,i,n,a){let o={x:0,y:0,vertexCount:0};for(let l of LF(r,mNe)){let u=0;for(let w of l)u+=w.length;let c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let w of l){if(w.length===0||gne(w))continue;let E=0;for(let M=0;M<w.length;M++){let I=w[M];if(M>=1){let P=w[M-1];if(!mne(I,P)){c.vertexLength+4>To.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let C=I.sub(P)._perp()._unit(),T=P.dist(I);E+T>32768&&(E=0),M0(this.layoutVertexArray,I.x,I.y,C.x,C.y,0,0,E),M0(this.layoutVertexArray,I.x,I.y,C.x,C.y,0,1,E),o.x+=2*I.x,o.y+=2*I.y,o.vertexCount+=2,E+=T,M0(this.layoutVertexArray,P.x,P.y,C.x,C.y,0,0,E),M0(this.layoutVertexArray,P.x,P.y,C.x,C.y,0,1,E),o.x+=2*P.x,o.y+=2*P.y,o.vertexCount+=2;let O=c.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),c.vertexLength+=4,c.primitiveLength+=2}}}}if(c.vertexLength+u>To.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),fNe[e.type]!=="Polygon")continue;let p=[],m=[],y=c.vertexLength;for(let w of l)if(w.length!==0){w!==l[0]&&m.push(p.length/2);for(let E=0;E<w.length;E++){let M=w[E];M0(this.layoutVertexArray,M.x,M.y,0,0,1,1,0),o.x+=M.x,o.y+=M.y,o.vertexCount+=1,p.push(M.x),p.push(M.y)}}let v=(0,pNe.default)(p,m);for(let w=0;w<v.length;w+=3)this.indexArray.emplaceBack(y+v[w],y+v[w+2],y+v[w+1]);c.primitiveLength+=v.length/3,c.vertexLength+=u}for(let l=0;l<o.vertexCount;l++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,a,n)}};s(dne,"FillExtrusionBucket");var fne=dne;Rr("FillExtrusionBucket",fne,{omit:["layers","features"]});function mne(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}s(mne,"isBoundaryEdge");function gne(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}s(gne,"isEntirelyOutside");N();var HH,gNe=s(()=>HH=HH||new $u({"fill-extrusion-opacity":new Wr(Ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new di(Ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wr(Ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wr(Ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new mP(Ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new di(Ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new di(Ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Wr(Ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),"getPaint"),yNe={get paint(){return gNe()}},UD=kr(Nn(),1),yne=class extends id{constructor(e){super(e,yNe)}createBucket(e){return new fne(e)}queryRadius(){return EA(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,i,n,a,o,l,u){let c=CA(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,l),p=this.paint.get("fill-extrusion-height").evaluate(r,i),m=this.paint.get("fill-extrusion-base").evaluate(r,i),y=xne(c,u,o,0),v=_ne(n,m,p,u),w=v[0],E=v[1];return vne(w,E,y)}};s(yne,"FillExtrusionStyleLayer");var vNe=yne;function E0(t,e){return t.x*e.x+t.y*e.y}s(E0,"dot");function VD(t,e){if(t.length===1){let r=0,i=e[r++],n;for(;!n||i.equals(n);)if(n=e[r++],!n)return 1/0;for(;r<e.length;r++){let a=e[r],o=t[0],l=n.sub(i),u=a.sub(i),c=o.sub(i),p=E0(l,l),m=E0(l,u),y=E0(u,u),v=E0(c,l),w=E0(c,u),E=p*y-m*m,M=(y*v-m*w)/E,I=(p*w-m*v)/E,P=1-M-I,C=i.z*P+n.z*M+a.z*I;if(isFinite(C))return C}return 1/0}else{let r=1/0;for(let i of e)r=Math.min(r,i.z);return r}}s(VD,"getIntersectionDistance");function vne(t,e,r){let i=1/0;j7(r,e)&&(i=VD(r,e[0]));for(let n=0;n<e.length;n++){let a=e[n],o=t[n];for(let l=0;l<a.length-1;l++){let u=a[l],c=a[l+1],p=o[l],m=o[l+1],y=[u,c,m,p,u];V7(r,y)&&(i=Math.min(i,VD(r,y)))}}return i===1/0?!1:i}s(vne,"checkIntersection");function _ne(t,e,r,i){let n=[],a=[],o=i[8]*e,l=i[9]*e,u=i[10]*e,c=i[11]*e,p=i[8]*r,m=i[9]*r,y=i[10]*r,v=i[11]*r;for(let w of t){let E=[],M=[];for(let I of w){let P=I.x,C=I.y,T=i[0]*P+i[4]*C+i[12],O=i[1]*P+i[5]*C+i[13],F=i[2]*P+i[6]*C+i[14],k=i[3]*P+i[7]*C+i[15],B=T+o,U=O+l,z=F+u,q=k+c,W=T+p,J=O+m,V=F+y,oe=k+v,Y=new UD.default(B/q,U/q);Y.z=z/q,E.push(Y);let he=new UD.default(W/oe,J/oe);he.z=V/oe,M.push(he)}n.push(E),a.push(M)}return[n,a]}s(_ne,"projectExtrusion");function xne(t,e,r,i){let n=[];for(let a of t){let o=[a.x,a.y,i,1];Jl.transformMat4(o,o,e),n.push(new UD.default(o[0]/o[3],o[1]/o[3]))}return n}s(xne,"projectQueryGeometry");N();N();N();var _Ne=ao([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:xNe,size:rot,alignment:iot}=_Ne;N();var bNe=ao([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:wNe,size:not,alignment:aot}=bNe,ANe=kr(WT(),1),SNe=ANe.default.VectorTileFeature.types,qH=63,MNe=Math.cos(75/2*(Math.PI/180)),ENe=15,CNe=20,INe=15,bne=1/2,WH=Math.pow(2,INe-1)/bne,wne=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Jke,this.layoutVertexArray2=new Qke,this.indexArray=new cv,this.programConfigurations=new Hy(e.layers,e.zoom),this.segments=new To,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){this.hasPattern=wP("line",this.layers,r);let n=this.layers[0].layout.get("line-sort-key"),a=!n.isConstant(),o=[];for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let m=this.layers[0]._featureFilter.needGeometry,y=sg(l,m);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),y,i))continue;let v=a?n.evaluate(y,{},i):void 0,w={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:m?y.geometry:og(l),patterns:{},sortKey:v};o.push(w)}a&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l;if(this.hasPattern){let y=AP("line",this.layers,l,this.zoom,r);this.patternFeatures.push(y)}else this.addFeature(l,u,c,i,{});let m=e[c].feature;r.featureIndex.insert(m,u,c,p,this.index)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}addFeatures(e,r,i){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,r,i)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,wNe)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xNe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,i=+e.properties.mapbox_clip_end;return{start:r,end:i}}}addFeature(e,r,i,n,a){let o=this.layers[0].layout,l=o.get("line-join").evaluate(e,{}),u=o.get("line-cap"),c=o.get("line-miter-limit"),p=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let m of r)this.addLine(m,e,l,u,c,p);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,a,n)}addLine(e,r,i,n,a,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let I=0;I<e.length-1;I++)this.totalDistance+=e[I].dist(e[I+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let l=SNe[r.type]==="Polygon",u=e.length;for(;u>=2&&e[u-1].equals(e[u-2]);)u--;let c=0;for(;c<u-1&&e[c].equals(e[c+1]);)c++;if(u<(l?3:2))return;i==="bevel"&&(a=1.05);let p=this.overscaling<=16?ENe*8192/(512*this.overscaling):0,m=this.segments.prepareSegment(u*10,this.layoutVertexArray,this.indexArray),y,v,w,E,M;this.e1=this.e2=-1,l&&(y=e[u-2],M=e[c].sub(y)._unit()._perp());for(let I=c;I<u;I++){if(w=I===u-1?l?e[c+1]:void 0:e[I+1],w&&e[I].equals(w))continue;M&&(E=M),y&&(v=y),y=e[I],M=w?w.sub(y)._unit()._perp():E,E=E||M;let P=E.add(M);(P.x!==0||P.y!==0)&&P._unit();let C=E.x*M.x+E.y*M.y,T=P.x*M.x+P.y*M.y,O=T!==0?1/T:1/0,F=2*Math.sqrt(2-2*T),k=T<MNe&&v&&w,B=E.x*M.y-E.y*M.x>0;if(k&&I>c){let q=y.dist(v);if(q>2*p){let W=y.sub(y.sub(v)._mult(p/q)._round());this.updateDistance(v,W),this.addCurrentVertex(W,E,0,0,m),v=W}}let U=v&&w,z=U?i:l?"butt":n;if(U&&z==="round"&&(O<o?z="miter":O<=2&&(z="fakeround")),z==="miter"&&O>a&&(z="bevel"),z==="bevel"&&(O>2&&(z="flipbevel"),O<a&&(z="miter")),v&&this.updateDistance(v,y),z==="miter")P._mult(O),this.addCurrentVertex(y,P,0,0,m);else if(z==="flipbevel"){if(O>100)P=M.mult(-1);else{let q=O*E.add(M).mag()/E.sub(M).mag();P._perp()._mult(q*(B?-1:1))}this.addCurrentVertex(y,P,0,0,m),this.addCurrentVertex(y,P.mult(-1),0,0,m)}else if(z==="bevel"||z==="fakeround"){let q=-Math.sqrt(O*O-1),W=B?q:0,J=B?0:q;if(v&&this.addCurrentVertex(y,E,W,J,m),z==="fakeround"){let V=Math.round(F*180/Math.PI/CNe);for(let oe=1;oe<V;oe++){let Y=oe/V;if(Y!==.5){let Q=Y-.5,ae=1.0904+C*(-3.2452+C*(3.55645-C*1.43519)),ee=.848013+C*(-1.06021+C*.215638);Y=Y+Y*Q*(Y-1)*(ae*Q*Q+ee)}let he=M.sub(E)._mult(Y)._add(E)._unit()._mult(B?-1:1);this.addHalfVertex(y,he.x,he.y,!1,B,0,m)}}w&&this.addCurrentVertex(y,M,-W,-J,m)}else if(z==="butt")this.addCurrentVertex(y,P,0,0,m);else if(z==="square"){let q=v?1:-1;this.addCurrentVertex(y,P,q,q,m)}else z==="round"&&(v&&(this.addCurrentVertex(y,E,0,0,m),this.addCurrentVertex(y,E,1,1,m,!0)),w&&(this.addCurrentVertex(y,M,-1,-1,m,!0),this.addCurrentVertex(y,M,0,0,m)));if(k&&I<u-1){let q=y.dist(w);if(q>2*p){let W=y.add(w.sub(y)._mult(p/q)._round());this.updateDistance(y,W),this.addCurrentVertex(W,M,0,0,m),y=W}}}}addCurrentVertex(e,r,i,n,a,o=!1){let l=r.x+r.y*i,u=r.y-r.x*i,c=-r.x+r.y*n,p=-r.y-r.x*n;this.addHalfVertex(e,l,u,o,!1,i,a),this.addHalfVertex(e,c,p,o,!0,-n,a),this.distance>WH/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,i,n,a,o))}addHalfVertex({x:e,y:r},i,n,a,o,l,u){let c=(this.lineClips?this.scaledDistance*(WH-1):this.scaledDistance)*bne;if(this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(r<<1)+(o?1:0),Math.round(qH*i)+128,Math.round(qH*n)+128,(l===0?0:l<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let m=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,v=m/y;this.layoutVertexArray2.emplaceBack(v,this.lineClipsArray.length)}let p=u.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),u.primitiveLength++),o?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};s(wne,"LineBucket");var Ane=wne;Rr("LineBucket",Ane,{omit:["layers","patternFeatures"]});N();var XH,TNe=s(()=>XH=XH||new $u({"line-cap":new Wr(Ut.layout_line["line-cap"]),"line-join":new di(Ut.layout_line["line-join"]),"line-miter-limit":new Wr(Ut.layout_line["line-miter-limit"]),"line-round-limit":new Wr(Ut.layout_line["line-round-limit"]),"line-sort-key":new di(Ut.layout_line["line-sort-key"])}),"getLayout"),ZH,PNe=s(()=>ZH=ZH||new $u({"line-opacity":new di(Ut.paint_line["line-opacity"]),"line-color":new di(Ut.paint_line["line-color"]),"line-translate":new Wr(Ut.paint_line["line-translate"]),"line-translate-anchor":new Wr(Ut.paint_line["line-translate-anchor"]),"line-width":new di(Ut.paint_line["line-width"]),"line-gap-width":new di(Ut.paint_line["line-gap-width"]),"line-offset":new di(Ut.paint_line["line-offset"]),"line-blur":new di(Ut.paint_line["line-blur"]),"line-dasharray":new _7(Ut.paint_line["line-dasharray"]),"line-pattern":new mP(Ut.paint_line["line-pattern"]),"line-gradient":new x7(Ut.paint_line["line-gradient"])}),"getPaint"),YH={get paint(){return PNe()},get layout(){return TNe()}},Sne=class extends di{possiblyEvaluate(e,r){return r=new fs(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,i,n){return r=zr({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,i,n)}};s(Sne,"LineFloorwidthProperty");var LNe=Sne,MM,Mne=class extends id{constructor(e){super(e,YH),this.gradientVersion=0,MM||(MM=new LNe(YH.paint.properties["line-width"].specification),MM.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();ax(r)?this.stepInterpolant=r._styleExpression.expression instanceof j9:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=MM.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Ane(e)}queryRadius(e){let r=e,i=jD(e_("line-width",this,r),e_("line-gap-width",this,r)),n=e_("line-offset",this,r);return i/2+Math.abs(n)+EA(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,i,n,a,o,l){let u=CA(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,l),c=l/2*jD(this.paint.get("line-width").evaluate(r,i),this.paint.get("line-gap-width").evaluate(r,i)),p=this.paint.get("line-offset").evaluate(r,i);return p&&(n=Fee(n,p*l)),Lee(u,n,c)}isTileClipped(){return!0}};s(Mne,"LineStyleLayer");var DNe=Mne;function jD(t,e){return e>0?e+2*t:t}s(jD,"getLineWidth");N();N();N();var RNe=ao([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ONe=ao([{name:"a_projected_pos",components:3,type:"Float32"}],4);ao([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var kNe=ao([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ao([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var KH=ao([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),NNe=ao([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ao([{name:"triangle",components:3,type:"Uint16"}]);ao([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);ao([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);ao([{type:"Float32",name:"offsetX"}]);ao([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);ao([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var EM=kr(Nn(),1);N();function Ene(t,e,r){let i=e.layout.get("text-transform").evaluate(r,{});return i==="uppercase"?t=t.toLocaleUpperCase():i==="lowercase"&&(t=t.toLocaleLowerCase()),Sw.applyArabicShaping&&(t=Sw.applyArabicShaping(t)),t}s(Ene,"transformTextInternal");function Cne(t,e,r){return t.sections.forEach(i=>{i.text=Ene(i.text,e,r)}),t}s(Cne,"transformText");N();function Ine(t){let e={},r={},i=[],n=0;function a(c){i.push(t[c]),n++}s(a,"add");function o(c,p,m){let y=r[c];return delete r[c],r[p]=y,i[y].geometry[0].pop(),i[y].geometry[0]=i[y].geometry[0].concat(m[0]),y}s(o,"mergeFromRight");function l(c,p,m){let y=e[p];return delete e[p],e[c]=y,i[y].geometry[0].shift(),i[y].geometry[0]=m[0].concat(i[y].geometry[0]),y}s(l,"mergeFromLeft");function u(c,p,m){let y=m?p[0][p[0].length-1]:p[0][0];return"".concat(c,":").concat(y.x,":").concat(y.y)}s(u,"getKey");for(let c=0;c<t.length;c++){let p=t[c],m=p.geometry,y=p.text?p.text.toString():null;if(!y){a(c);continue}let v=u(y,m),w=u(y,m,!0);if(v in r&&w in e&&r[v]!==e[w]){let E=l(v,w,m),M=o(v,w,i[E].geometry);delete e[v],delete r[w],r[u(y,i[M].geometry,!0)]=M,i[E].geometry=null}else v in r?o(v,w,m):w in e?l(v,w,m):(a(c),e[v]=n-1,r[w]=n-1)}return i.filter(c=>c.geometry)}s(Ine,"mergeLines");N();N();var FNe={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};N();var Tne=24;N();var BNe=kr(iZ(),1),JH=3;function Pne(t,e,r){t===1&&r.readMessage(Lne,e)}s(Pne,"readFontstacks");function Lne(t,e,r){if(t===3){let{id:i,bitmap:n,width:a,height:o,left:l,top:u,advance:c}=r.readMessage(Dne,{});e.push({id:i,bitmap:new IF({width:a+2*JH,height:o+2*JH},n),metrics:{width:a,height:o,left:l,top:u,advance:c}})}}s(Lne,"readFontstack");function Dne(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}s(Dne,"readGlyph");function Rne(t){return new BNe.default(t).readFields(Pne,[])}s(Rne,"parseGlyphPbf");N();N();function DF(t){let e=0,r=0;for(let o of t)e+=o.w*o.h,r=Math.max(r,o.w);t.sort((o,l)=>l.h-o.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],n=0,a=0;for(let o of t)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(o.w>u.w||o.h>u.h)){if(o.x=u.x,o.y=u.y,a=Math.max(a,o.y+o.h),n=Math.max(n,o.x+o.w),o.w===u.w&&o.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else o.h===u.h?(u.x+=o.w,u.w-=o.w):o.w===u.w?(u.y+=o.h,u.h-=o.h):(i.push({x:u.x+o.w,y:u.y,w:u.w-o.w,h:o.h}),u.y+=o.h,u.h-=o.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}s(DF,"potpack");var Yc=1,One=class{constructor(e,{pixelRatio:r,version:i,stretchX:n,stretchY:a,content:o}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=n,this.stretchY=a,this.content=o,this.version=i}get tl(){return[this.paddedRect.x+Yc,this.paddedRect.y+Yc]}get br(){return[this.paddedRect.x+this.paddedRect.w-Yc,this.paddedRect.y+this.paddedRect.h-Yc]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-Yc*2)/this.pixelRatio,(this.paddedRect.h-Yc*2)/this.pixelRatio]}};s(One,"ImagePosition");var RF=One,kne=class{constructor(e,r){let i={},n={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,i,a),this.addImages(r,n,a);let{w:o,h:l}=DF(a),u=new go({width:o||1,height:l||1});for(let c in e){let p=e[c],m=i[c].paddedRect;go.copy(p.data,u,{x:0,y:0},{x:m.x+Yc,y:m.y+Yc},p.data)}for(let c in r){let p=r[c],m=n[c].paddedRect,y=m.x+Yc,v=m.y+Yc,w=p.data.width,E=p.data.height;go.copy(p.data,u,{x:0,y:0},{x:y,y:v},p.data),go.copy(p.data,u,{x:0,y:E-1},{x:y,y:v-1},{width:w,height:1}),go.copy(p.data,u,{x:0,y:0},{x:y,y:v+E},{width:w,height:1}),go.copy(p.data,u,{x:w-1,y:0},{x:y-1,y:v},{width:1,height:E}),go.copy(p.data,u,{x:0,y:0},{x:y+w,y:v},{width:1,height:E})}this.image=u,this.iconPositions=i,this.patternPositions=n}addImages(e,r,i){for(let n in e){let a=e[n],o={x:0,y:0,w:a.data.width+2*Yc,h:a.data.height+2*Yc};i.push(o),r[n]=new RF(o,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let i in e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),r),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),r)}patchUpdatedImage(e,r,i){if(!e||!r||e.version===r.version)return;e.version=r.version;let[n,a]=e.tl;i.update(r.data,void 0,{x:n,y:a})}};s(kne,"ImageAtlas");var zNe=kne;Rr("ImagePosition",RF);Rr("ImageAtlas",zNe);var Nne=(t=>(t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.horizontalOnly=3]="horizontalOnly",t))(Nne||{});function OF(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}s(OF,"getAnchorAlignment");var UNe=kr(WT(),1);N();var VNe=255,UE=128,QH=VNe*UE;function $D(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new fs(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:i,interpolationType:n}=r,a=0;for(;a<i.length&&i[a]<=t;)a++;a=Math.max(0,a-1);let o=a;for(;o<i.length&&i[o]<t+1;)o++;o=Math.min(i.length-1,o);let l=i[a],u=i[o];if(r.kind==="composite")return{kind:"composite",minZoom:l,maxZoom:u,interpolationType:n};let c=r.evaluate(new fs(l)),p=r.evaluate(new fs(u));return{kind:"camera",minZoom:l,maxZoom:u,minSize:c,maxSize:p,interpolationType:n}}}s($D,"getSizeData");function SP(t,{uSize:e,uSizeT:r},{lowerSize:i,upperSize:n}){return t.kind==="source"?i/UE:t.kind==="composite"?Ka.number(i/UE,n/UE,r):e}s(SP,"evaluateSizeForFeature");function IA(t,e){let r=0,i=0;if(t.kind==="constant")i=t.layoutSize;else if(t.kind!=="source"){let{interpolationType:n,minZoom:a,maxZoom:o}=t,l=n?ps(qp.interpolationFactor(n,e,a,o),0,1):0;t.kind==="camera"?i=Ka.number(t.minSize,t.maxSize,l):r=l}return{uSizeT:r,uSize:i}}s(IA,"evaluateSizeForZoom");N();function Ew(t,e,r){let i="never",n=t.get(e);return n?i=n:t.get(r)&&(i="always"),i}s(Ew,"getOverlapMode");var jNe=UNe.default.VectorTileFeature.types,$Ne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function i2(t,e,r,i,n,a,o,l,u,c,p,m,y){let v=l?Math.min(QH,Math.round(l[0])):0,w=l?Math.min(QH,Math.round(l[1])):0;t.emplaceBack(e,r,Math.round(i*32),Math.round(n*32),a,o,(v<<1)+(u?1:0),w,c*16,p*16,m*256,y*256)}s(i2,"addVertex");function x_(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}s(x_,"addDynamicAttributes");function Fne(t){for(let e of t.sections)if(MJ(e.text))return!0;return!1}s(Fne,"containsRTLText");var Bne=class{constructor(e){this.layoutVertexArray=new e8e,this.indexArray=new cv,this.programConfigurations=e,this.segments=new To,this.dynamicLayoutVertexArray=new t8e,this.opacityVertexArray=new r8e,this.hasVisibleVertices=!1,this.placedSymbolArray=new SQ}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,RNe.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ONe.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,$Ne,!0),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};s(Bne,"SymbolBuffers");var GD=Bne;Rr("SymbolBuffers",GD);var zne=class{constructor(e,r,i){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new i,this.segments=new To,this.collisionVertexArray=new n8e}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,kNe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};s(zne,"CollisionBuffers");var HD=zne;Rr("CollisionBuffers",HD);var Une=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Nr.identity([]),this.placementViewportMatrix=Nr.identity([]);let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$D(this.zoom,r["text-size"]),this.iconSizeData=$D(this.zoom,r["icon-size"]);let i=this.layers[0].layout,n=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=Ew(i,"text-overlap","text-allow-overlap")!=="never"||Ew(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!n.isConstant();let o=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>Nne[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=e.sourceID}createArrays(){this.text=new GD(new Hy(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new GD(new Hy(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new PQ,this.lineVertexArray=new DQ,this.symbolInstances=new IQ,this.textAnchorOffsets=new NQ}calculateGlyphDependencies(e,r,i,n,a){for(let o=0;o<e.length;o++)if(r[e.charCodeAt(o)]=!0,(i||n)&&a){let l=FNe[e.charAt(o)];l&&(r[l.charCodeAt(0)]=!0)}}populate(e,r,i){let n=this.layers[0],a=n.layout,o=a.get("text-font"),l=a.get("text-field"),u=a.get("icon-image"),c=(l.value.kind!=="constant"||l.value.value instanceof df&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0),p=u.value.kind!=="constant"||!!u.value.value||Object.keys(u.parameters).length>0,m=a.get("symbol-sort-key");if(this.features=[],!c&&!p)return;let y=r.iconDependencies,v=r.glyphDependencies,w=r.availableImages,E=new fs(this.zoom);for(let{feature:M,id:I,index:P,sourceLayerIndex:C}of e){let T=n._featureFilter.needGeometry,O=sg(M,T);if(!n._featureFilter.filter(E,O,i))continue;T||(O.geometry=og(M));let F;if(c){let z=n.getValueAndResolveTokens("text-field",O,i,w),q=df.factory(z),W=this.hasRTLText=this.hasRTLText||Fne(q);(!W||Sw.getRTLTextPluginStatus()==="unavailable"||W&&Sw.isParsed())&&(F=Cne(q,n,O))}let k;if(p){let z=n.getValueAndResolveTokens("icon-image",O,i,w);z instanceof Kp?k=z:k=Kp.fromString(z)}if(!F&&!k)continue;let B=this.sortFeaturesByKey?m.evaluate(O,{},i):void 0,U={id:I,text:F,icon:k,index:P,sourceLayerIndex:C,geometry:O.geometry,properties:M.properties,type:jNe[M.type],sortKey:B};if(this.features.push(U),k&&(y[k.name]=!0),F){let z=o.evaluate(O,{},i).join(","),q=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let W of F.sections)if(W.image)y[W.image.name]=!0;else{let J=wJ(F.toString()),V=W.fontStack||z,oe=v[V]=v[V]||{};this.calculateGlyphDependencies(W.text,oe,q,this.allowVerticalPlacement,J)}}}a.get("symbol-placement")==="line"&&(this.features=Ine(this.features)),this.sortFeaturesByKey&&this.features.sort((M,I)=>M.sortKey-I.sortKey)}update(e,r,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,i))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let i=this.lineVertexArray.length;if(e.segment!==void 0){let n=e.dist(r[e.segment+1]),a=e.dist(r[e.segment]),o={};for(let l=e.segment+1;l<r.length;l++)o[l]={x:r[l].x,y:r[l].y,tileUnitDistanceFromAnchor:n},l<r.length-1&&(n+=r[l+1].dist(r[l]));for(let l=e.segment||0;l>=0;l--)o[l]={x:r[l].x,y:r[l].y,tileUnitDistanceFromAnchor:a},l>0&&(a+=r[l-1].dist(r[l]));for(let l=0;l<r.length;l++){let u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,r,i,n,a,o,l,u,c,p,m,y){let v=e.indexArray,w=e.layoutVertexArray,E=e.segments.prepareSegment(4*r.length,w,v,this.canOverlap?o.sortKey:void 0),M=this.glyphOffsetArray.length,I=E.vertexLength,P=this.allowVerticalPlacement&&l===2?Math.PI/2:0,C=o.text&&o.text.sections;for(let T=0;T<r.length;T++){let{tl:O,tr:F,bl:k,br:B,tex:U,pixelOffsetTL:z,pixelOffsetBR:q,minFontScaleX:W,minFontScaleY:J,glyphOffset:V,isSDF:oe,sectionIndex:Y}=r[T],he=E.vertexLength,Q=V[1];i2(w,u.x,u.y,O.x,Q+O.y,U.x,U.y,i,oe,z.x,z.y,W,J),i2(w,u.x,u.y,F.x,Q+F.y,U.x+U.w,U.y,i,oe,q.x,z.y,W,J),i2(w,u.x,u.y,k.x,Q+k.y,U.x,U.y+U.h,i,oe,z.x,q.y,W,J),i2(w,u.x,u.y,B.x,Q+B.y,U.x+U.w,U.y+U.h,i,oe,q.x,q.y,W,J),x_(e.dynamicLayoutVertexArray,u,P),v.emplaceBack(he,he+1,he+2),v.emplaceBack(he+1,he+2,he+3),E.vertexLength+=4,E.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(V[0]),(T===r.length-1||Y!==r[T+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(w.length,o,o.index,{},y,C&&C[Y])}e.placedSymbolArray.emplaceBack(u.x,u.y,M,this.glyphOffsetArray.length-M,I,c,p,u.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],l,0,!1,0,m)}_addCollisionDebugVertex(e,r,i,n,a,o){return r.emplaceBack(0,0),e.emplaceBack(i.x,i.y,n,a,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,r,i,n,a,o,l){let u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),c=u.vertexLength,p=a.layoutVertexArray,m=a.collisionVertexArray,y=l.anchorX,v=l.anchorY;this._addCollisionDebugVertex(p,m,o,y,v,new EM.default(e,r)),this._addCollisionDebugVertex(p,m,o,y,v,new EM.default(i,r)),this._addCollisionDebugVertex(p,m,o,y,v,new EM.default(i,n)),this._addCollisionDebugVertex(p,m,o,y,v,new EM.default(e,n)),u.vertexLength+=4;let w=a.indexArray;w.emplaceBack(c,c+1),w.emplaceBack(c+1,c+2),w.emplaceBack(c+2,c+3),w.emplaceBack(c+3,c),u.primitiveLength+=4}addDebugCollisionBoxes(e,r,i,n){for(let a=e;a<r;a++){let o=this.collisionBoxArray.get(a),l=o.x1,u=o.y1,c=o.x2,p=o.y2;this.addCollisionDebugVertices(l,u,c,p,n?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new HD(FH,KH.members,LD),this.iconCollisionBox=new HD(FH,KH.members,LD);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,i,n,a,o,l,u,c){let p={};for(let m=r;m<i;m++){let y=e.get(m);p.textBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.textFeatureIndex=y.featureIndex;break}for(let m=n;m<a;m++){let y=e.get(m);p.verticalTextBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.verticalTextFeatureIndex=y.featureIndex;break}for(let m=o;m<l;m++){let y=e.get(m);p.iconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.iconFeatureIndex=y.featureIndex;break}for(let m=u;m<c;m++){let y=e.get(m);p.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.verticalIconFeatureIndex=y.featureIndex;break}return p}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let i=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let i=e.placedSymbolArray.get(r),n=i.vertexStartIndex+i.numGlyphs*4;for(let a=i.vertexStartIndex;a<n;a+=4)e.indexArray.emplaceBack(a,a+1,a+2),e.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),i=Math.cos(e),n=[],a=[],o=[];for(let l=0;l<this.symbolInstances.length;++l){o.push(l);let u=this.symbolInstances.get(l);n.push(Math.round(r*u.anchorX+i*u.anchorY)|0),a.push(u.featureIndex)}return o.sort((l,u)=>n[l]-n[u]||a[u]-a[l]),o}addToSortKeyRanges(e,r){let i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===r?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let i=this.symbolInstances.get(r);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((n,a,o)=>{n>=0&&o.indexOf(n)===a&&this.addIndicesForPlacedSymbol(this.text,n)}),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};s(Une,"SymbolBucket");var b_=Une;Rr("SymbolBucket",b_,{omit:["layers","collisionBoxArray","features","compareText"]});b_.MAX_GLYPHS=65535;b_.addDynamicAttributes=x_;N();function Vne(t,e){return e.replace(/{([^{}]+)}/g,(r,i)=>t&&i in t?String(t[i]):"")}s(Vne,"resolveTokens");N();var eq,GNe=s(()=>eq=eq||new $u({"symbol-placement":new Wr(Ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Wr(Ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wr(Ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new di(Ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wr(Ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Wr(Ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Wr(Ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Wr(Ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wr(Ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wr(Ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new di(Ut.layout_symbol["icon-size"]),"icon-text-fit":new Wr(Ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Wr(Ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new di(Ut.layout_symbol["icon-image"]),"icon-rotate":new di(Ut.layout_symbol["icon-rotate"]),"icon-padding":new di(Ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Wr(Ut.layout_symbol["icon-keep-upright"]),"icon-offset":new di(Ut.layout_symbol["icon-offset"]),"icon-anchor":new di(Ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wr(Ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wr(Ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wr(Ut.layout_symbol["text-rotation-alignment"]),"text-field":new di(Ut.layout_symbol["text-field"]),"text-font":new di(Ut.layout_symbol["text-font"]),"text-size":new di(Ut.layout_symbol["text-size"]),"text-max-width":new di(Ut.layout_symbol["text-max-width"]),"text-line-height":new Wr(Ut.layout_symbol["text-line-height"]),"text-letter-spacing":new di(Ut.layout_symbol["text-letter-spacing"]),"text-justify":new di(Ut.layout_symbol["text-justify"]),"text-radial-offset":new di(Ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wr(Ut.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new di(Ut.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new di(Ut.layout_symbol["text-anchor"]),"text-max-angle":new Wr(Ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Wr(Ut.layout_symbol["text-writing-mode"]),"text-rotate":new di(Ut.layout_symbol["text-rotate"]),"text-padding":new Wr(Ut.layout_symbol["text-padding"]),"text-keep-upright":new Wr(Ut.layout_symbol["text-keep-upright"]),"text-transform":new di(Ut.layout_symbol["text-transform"]),"text-offset":new di(Ut.layout_symbol["text-offset"]),"text-allow-overlap":new Wr(Ut.layout_symbol["text-allow-overlap"]),"text-overlap":new Wr(Ut.layout_symbol["text-overlap"]),"text-ignore-placement":new Wr(Ut.layout_symbol["text-ignore-placement"]),"text-optional":new Wr(Ut.layout_symbol["text-optional"])}),"getLayout"),tq,HNe=s(()=>tq=tq||new $u({"icon-opacity":new di(Ut.paint_symbol["icon-opacity"]),"icon-color":new di(Ut.paint_symbol["icon-color"]),"icon-halo-color":new di(Ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new di(Ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new di(Ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Wr(Ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wr(Ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new di(Ut.paint_symbol["text-opacity"]),"text-color":new di(Ut.paint_symbol["text-color"],{runtimeType:zh,getOverride:s(t=>t.textColor,"getOverride"),hasOverride:s(t=>!!t.textColor,"hasOverride")}),"text-halo-color":new di(Ut.paint_symbol["text-halo-color"]),"text-halo-width":new di(Ut.paint_symbol["text-halo-width"]),"text-halo-blur":new di(Ut.paint_symbol["text-halo-blur"]),"text-translate":new Wr(Ut.paint_symbol["text-translate"]),"text-translate-anchor":new Wr(Ut.paint_symbol["text-translate-anchor"])}),"getPaint"),RL={get paint(){return HNe()},get layout(){return GNe()}};N();var jne=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:gA,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};s(jne,"FormatSectionOverride");var $ne=jne;Rr("FormatSectionOverride",$ne,{omit:["defaultValue"]});var Gne=class qD extends id{constructor(e){super(e,RL)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let i=this.layout.get("text-writing-mode");if(i){let n=[];for(let a of i)n.indexOf(a)<0&&n.push(a);this.layout._values["text-writing-mode"]=n}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,i,n){let a=this.layout.get(e).evaluate(r,{},i,n),o=this._unevaluatedLayout._values[e];return!o.isDataDriven()&&!ax(o.value)&&a?Vne(r.properties,a):a}createBucket(e){return new b_(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of RL.paint.overridableProperties){if(!qD.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),i=new $ne(r),n=new e7(i,r.property.specification),a=null;r.value.kind==="constant"||r.value.kind==="source"?a=new M3("source",n):a=new E3("composite",n,r.value.zoomStops),this.paint._values[e]=new Fh(r.property,a,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,i){return!this.layout||r.isDataDriven()||i.isDataDriven()?!1:qD.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let i=e.get("text-field"),n=RL.paint.properties[r],a=!1,o=s(l=>{for(let u of l)if(n.overrides&&n.overrides.hasOverride(u)){a=!0;return}},"checkSections");if(i.value.kind==="constant"&&i.value.value instanceof df)o(i.value.value.sections);else if(i.value.kind==="source"){let l=s(c=>{if(!a)if(c instanceof gw&&Xo(c.value)===yA){let p=c.value;o(p.sections)}else c instanceof oK?o(c.sections):c.eachChild(l)},"checkExpression"),u=i.value;u._styleExpression&&l(u._styleExpression.expression)}return a}};s(Gne,"SymbolStyleLayer");var qNe=Gne;N();N();var rq,WNe=s(()=>rq=rq||new $u({"background-color":new Wr(Ut.paint_background["background-color"]),"background-pattern":new _7(Ut.paint_background["background-pattern"]),"background-opacity":new Wr(Ut.paint_background["background-opacity"])}),"getPaint"),XNe={get paint(){return WNe()}},Hne=class extends id{constructor(e){super(e,XNe)}};s(Hne,"BackgroundStyleLayer");var ZNe=Hne;N();N();var iq,YNe=s(()=>iq=iq||new $u({"raster-opacity":new Wr(Ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new Wr(Ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wr(Ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wr(Ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Wr(Ut.paint_raster["raster-saturation"]),"raster-contrast":new Wr(Ut.paint_raster["raster-contrast"]),"raster-resampling":new Wr(Ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Wr(Ut.paint_raster["raster-fade-duration"])}),"getPaint"),KNe={get paint(){return YNe()}},qne=class extends id{constructor(e){super(e,KNe)}};s(qne,"RasterStyleLayer");var JNe=qne;N();function Wne(t){let e=[],r=t.id;return r===void 0&&e.push({message:"layers.".concat(r,': missing required property "id"')}),t.render===void 0&&e.push({message:"layers.".concat(r,': missing required method "render"')}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers.".concat(r,': property "renderingMode" must be either "2d" or "3d"')}),e}s(Wne,"validateCustomStyleLayer");var Xne=class extends id{constructor(e){super(e,{}),this.onAdd=s(r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},"onAdd"),this.onRemove=s(r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},"onRemove"),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};s(Xne,"CustomStyleLayer");var QNe=Xne;function VE(t){if(t.type==="custom")return new QNe(t);switch(t.type){case"background":return new ZNe(t);case"circle":return new X8e(t);case"fill":return new lNe(t);case"fill-extrusion":return new vNe(t);case"heatmap":return new K8e(t);case"hillshade":return new eNe(t);case"line":return new DNe(t);case"raster":return new JNe(t);case"symbol":return new qNe(t)}}s(VE,"createStyleLayer");N();N();function sw(t){let e=[];if(typeof t=="string")e.push({id:"default",url:t});else if(t&&t.length>0){let r=[];for(let{id:i,url:n}of t){let a="".concat(i).concat(n);r.indexOf(a)===-1&&(r.push(a),e.push({id:i,url:n}))}}return e}s(sw,"coerceSpriteToArray");async function Zne(t,e,r,i){let n=sw(t),a=r>1?"@2x":"",o={},l={};for(let{id:u,url:c}of n){let p=e.transformRequest(e.normalizeSpriteURL(c,a,".json"),"SpriteJSON");o[u]=KT(p,i);let m=e.transformRequest(e.normalizeSpriteURL(c,a,".png"),"SpriteImage");l[u]=Hp.getImage(m,i)}return await Promise.all([...Object.values(o),...Object.values(l)]),Yne(o,l)}s(Zne,"loadSprite");async function Yne(t,e){let r={};for(let i in t){r[i]={};let n=vn.getImageCanvasContext((await e[i]).data),a=(await t[i]).data;for(let o in a){let{width:l,height:u,x:c,y:p,sdf:m,pixelRatio:y,stretchX:v,stretchY:w,content:E}=a[o],M={width:l,height:u,x:c,y:p,context:n};r[i][o]={data:null,pixelRatio:y,sdf:m,stretchX:v,stretchY:w,content:E,spriteData:M}}}return r}s(Yne,"doOnceCompleted");N();N();var Kne=class{constructor(e,r,i,n){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(r,n)}update(e,r,i){let{width:n,height:a}=e,o=(!this.size||this.size[0]!==n||this.size[1]!==a)&&!i,{context:l}=this,{gl:u}=l;if(this.useMipmap=!!(r&&r.useMipmap),u.bindTexture(u.TEXTURE_2D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(this.format===u.RGBA&&(!r||r.premultiply!==!1)),o)this.size=[n,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Gp(e)?u.texImage2D(u.TEXTURE_2D,0,this.format,this.format,u.UNSIGNED_BYTE,e):u.texImage2D(u.TEXTURE_2D,0,this.format,n,a,0,this.format,u.UNSIGNED_BYTE,e.data);else{let{x:c,y:p}=i||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Gp(e)?u.texSubImage2D(u.TEXTURE_2D,0,c,p,u.RGBA,u.UNSIGNED_BYTE,e):u.texSubImage2D(u.TEXTURE_2D,0,c,p,n,a,u.RGBA,u.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&u.generateMipmap(u.TEXTURE_2D)}bind(e,r,i){let{context:n}=this,{gl:a}=n;a.bindTexture(a.TEXTURE_2D,this.texture),i===a.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(i=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,i||e),this.filter=e),r!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};s(Kne,"Texture");var Es=Kne;N();function Jne(t){let{userImage:e}=t;return e&&e.render&&e.render()?(t.data.replace(new Uint8Array(e.data.buffer)),!0):!1}s(Jne,"renderStyleImage");var CM=1,Qne=class extends Fl{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new go({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:r,promiseResolve:i}of this.requestors)i(this._getImagesForIds(r));this.requestors=[]}}getImage(e){let r=this.images[e];if(r&&!r.data&&r.spriteData){let i=r.spriteData;r.data=new go({width:i.width,height:i.height},i.context.getImageData(i.x,i.y,i.width,i.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error("Image id ".concat(e," already exist, use updateImage instead"));this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let i=!0,n=r.data||r.spriteData;return this._validateStretch(r.stretchX,n&&n.width)||(this.fire(new fi(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),i=!1),this._validateStretch(r.stretchY,n&&n.height)||(this.fire(new fi(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),i=!1),this._validateContent(r.content,r)||(this.fire(new fi(new Error('Image "'.concat(e,'" has invalid "content" value')))),i=!1),i}_validateStretch(e,r){if(!e)return!0;let i=0;for(let n of e){if(n[0]<i||n[1]<n[0]||r<n[1])return!1;i=n[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;let i=r.spriteData,n=i&&i.width||r.data.width,a=i&&i.height||r.data.height;return!(e[0]<0||n<e[0]||e[1]<0||a<e[1]||e[2]<0||n<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,i=!0){let n=this.getImage(e);if(i&&(n.data.width!==r.data.width||n.data.height!==r.data.height))throw new Error("size mismatch between old image (".concat(n.data.width,"x").concat(n.data.height,") and new image (").concat(r.data.width,"x").concat(r.data.height,")."));r.version=n.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){let r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,i)=>{let n=!0;if(!this.isLoaded())for(let a of e)this.images[a]||(n=!1);this.isLoaded()||n?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){let r={};for(let i of e){let n=this.getImage(i);n||(this.fire(new pr("styleimagemissing",{id:i})),n=this.getImage(i)),n?r[i]={data:n.data.clone(),pixelRatio:n.pixelRatio,sdf:n.sdf,version:n.version,stretchX:n.stretchX,stretchY:n.stretchY,content:n.content,hasRenderCallback:!!(n.userImage&&n.userImage.render)}:kl('Image "'.concat(i,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}return r}getPixelSize(){let{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){let r=this.patterns[e],i=this.getImage(e);if(!i)return null;if(r&&r.position.version===i.version)return r.position;if(r)r.position.version=i.version;else{let n=i.data.width+CM*2,a=i.data.height+CM*2,o={w:n,h:a,x:0,y:0},l=new RF(o,i);this.patterns[e]={bin:o,position:l}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Es(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let a in this.patterns)e.push(this.patterns[a].bin);let{w:r,h:i}=DF(e),n=this.atlasImage;n.resize({width:r||1,height:i||1});for(let a in this.patterns){let{bin:o}=this.patterns[a],l=o.x+CM,u=o.y+CM,c=this.getImage(a).data,p=c.width,m=c.height;go.copy(c,n,{x:0,y:0},{x:l,y:u},{width:p,height:m}),go.copy(c,n,{x:0,y:m-1},{x:l,y:u-1},{width:p,height:1}),go.copy(c,n,{x:0,y:0},{x:l,y:u+m},{width:p,height:1}),go.copy(c,n,{x:p-1,y:0},{x:l-1,y:u},{width:1,height:m}),go.copy(c,n,{x:0,y:0},{x:l+p,y:u},{width:1,height:m})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;let i=this.getImage(r);i||kl('Image with ID: "'.concat(r,'" was not found')),Jne(i)&&this.updateImage(r,i)}}};s(Qne,"ImageManager");var e9e=Qne;N();N();async function eae(t,e,r,i){let n=e*256,a=n+255,o=i.transformRequest(r.replace("{fontstack}",t).replace("{range}","".concat(n,"-").concat(a)),"Glyphs"),l=await xOe(o,new AbortController);if(!l||!l.data)throw new Error("Could not load glyph range. range: ".concat(e,", ").concat(n,"-").concat(a));let u={};for(let c of Rne(l.data))u[c.id]=c;return u}s(eae,"loadGlyphRange");N();var tae=class{constructor({fontSize:e=24,buffer:r=3,radius:i=8,cutoff:n=.25,fontFamily:a="sans-serif",fontWeight:o="normal",fontStyle:l="normal"}={}){this.buffer=r,this.cutoff=n,this.radius=i;let u=this.size=e+r*4,c=this._createCanvas(u),p=this.ctx=c.getContext("2d",{willReadFrequently:!0});p.font="".concat(l," ").concat(o," ").concat(e,"px ").concat(a),p.textBaseline="alphabetic",p.textAlign="left",p.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(e){let r=document.createElement("canvas");return r.width=r.height=e,r}draw(e){let{width:r,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:a,actualBoundingBoxRight:o}=this.ctx.measureText(e),l=Math.ceil(i),u=0,c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),p=Math.min(this.size-this.buffer,l+Math.ceil(n)),m=c+2*this.buffer,y=p+2*this.buffer,v=Math.max(m*y,0),w=new Uint8ClampedArray(v),E={data:w,width:m,height:y,glyphWidth:c,glyphHeight:p,glyphTop:l,glyphLeft:u,glyphAdvance:r};if(c===0||p===0)return E;let{ctx:M,buffer:I,gridInner:P,gridOuter:C}=this;M.clearRect(I,I,c,p),M.fillText(e,I,I+l);let T=M.getImageData(I,I,c,p);C.fill(1e20,0,v),P.fill(0,0,v);for(let O=0;O<p;O++)for(let F=0;F<c;F++){let k=T.data[4*(O*c+F)+3]/255;if(k===0)continue;let B=(O+I)*m+F+I;if(k===1)C[B]=0,P[B]=1e20;else{let U=.5-k;C[B]=U>0?U*U:0,P[B]=U<0?U*U:0}}WD(C,0,0,m,y,m,this.f,this.v,this.z),WD(P,I,I,c,p,m,this.f,this.v,this.z);for(let O=0;O<v;O++){let F=Math.sqrt(C[O])-Math.sqrt(P[O]);w[O]=Math.round(255-255*(F/this.radius+this.cutoff))}return E}};s(tae,"TinySDF");var t9e=tae;function WD(t,e,r,i,n,a,o,l,u){for(let c=e;c<e+i;c++)XD(t,r*a+c,a,n,o,l,u);for(let c=r;c<r+n;c++)XD(t,c*a+e,1,i,o,l,u)}s(WD,"edt");function XD(t,e,r,i,n,a,o){a[0]=0,o[0]=-1e20,o[1]=1e20,n[0]=t[e];for(let l=1,u=0,c=0;l<i;l++){n[l]=t[e+l*r];let p=l*l;do{let m=a[u];c=(n[l]-n[m]+p-m*m)/(l-m)/2}while(c<=o[u]&&--u>-1);u++,a[u]=l,o[u]=c,o[u+1]=1e20}for(let l=0,u=0;l<i;l++){for(;o[u+1]<l;)u++;let c=a[u],p=l-c;t[e+l*r]=n[c]+p*p}}s(XD,"edt1d");var jE=class ZD{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}async getGlyphs(e){let r=[];for(let a in e)for(let o of e[a])r.push(this._getAndCacheGlyphsPromise(a,o));let i=await Promise.all(r),n={};for(let{stack:a,id:o,glyph:l}of i)n[a]||(n[a]={}),n[a][o]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};return n}async _getAndCacheGlyphsPromise(e,r){let i=this.entries[e];i||(i=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=i.glyphs[r];if(n!==void 0)return{stack:e,id:r,glyph:n};if(n=this._tinySDF(i,e,r),n)return i.glyphs[r]=n,{stack:e,id:r,glyph:n};let a=Math.floor(r/256);if(a*256>65535)throw new Error("glyphs > 65535 not supported");if(i.ranges[a])return{stack:e,id:r,glyph:n};if(!this.url)throw new Error("glyphsUrl is not set");if(!i.requests[a]){let l=ZD.loadGlyphRange(e,a,this.url,this.requestManager);i.requests[a]=l}let o=await i.requests[a];for(let l in o)this._doesCharSupportLocalGlyph(+l)||(i.glyphs[+l]=o[+l]);return i.ranges[a]=!0,{stack:e,id:r,glyph:o[r]||null}}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(gn["CJK Unified Ideographs"](e)||gn["Hangul Syllables"](e)||gn.Hiragana(e)||gn.Katakana(e))}_tinySDF(e,r,i){let n=this.localIdeographFontFamily;if(!n||!this._doesCharSupportLocalGlyph(i))return;let a=2,o=e.tinySDF;if(!o){let u="400";/bold/i.test(r)?u="900":/medium/i.test(r)?u="500":/light/i.test(r)&&(u="200"),o=e.tinySDF=new ZD.TinySDF({fontSize:24*a,buffer:3*a,radius:8*a,cutoff:.25,fontFamily:n,fontWeight:u})}let l=o.draw(String.fromCharCode(i));return{id:i,bitmap:new IF({width:l.width||30*a,height:l.height||30*a},l.data),metrics:{width:l.glyphWidth/a||24,height:l.glyphHeight/a||24,left:l.glyphLeft/a+.5||0,top:l.glyphTop/a-27.5||-8,advance:l.glyphAdvance/a||24,isDoubleResolution:!0}}}};s(jE,"GlyphManager"),jE.loadGlyphRange=eae,jE.TinySDF=t9e;var r9e=jE;N();var rae=class{constructor(){this.specification=Ut.light.position}possiblyEvaluate(e,r){return dZ(e.expression.evaluate(r))}interpolate(e,r,i){return{x:Ka.number(e.x,r.x,i),y:Ka.number(e.y,r.y,i),z:Ka.number(e.z,r.z,i)}}};s(rae,"LightPositionProperty");var i9e=rae,nq="-transition",OL,iae=class extends Fl{constructor(e){super(),OL=OL||new $u({anchor:new Wr(Ut.light.anchor),position:new i9e,color:new Wr(Ut.light.color),intensity:new Wr(Ut.light.intensity)}),this._transitionable=new DJ(OL),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(zke,e,r))for(let i in e){let n=e[i];i.endsWith(nq)?this._transitionable.setTransition(i.slice(0,-nq.length),n):this._transitionable.setValue(i,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,i){return i&&i.validate===!1?!1:pP(this,e.call(Ms,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:Ut}))}};s(iae,"Light");var n9e=iae;N();var nae=class{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){let i=e.join(",")+String(r);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(e,r)),this.dashEntry[i]}getDashRanges(e,r,i){let n=e.length%2===1,a=[],o=n?-e[e.length-1]*i:0,l=e[0]*i,u=!0;a.push({left:o,right:l,isDash:u,zeroLength:e[0]===0});let c=e[0];for(let p=1;p<e.length;p++){u=!u;let m=e[p];o=c*i,c+=m,l=c*i,a.push({left:o,right:l,isDash:u,zeroLength:m===0})}return a}addRoundDash(e,r,i){let n=r/2;for(let a=-i;a<=i;a++){let o=this.nextRow+i+a,l=this.width*o,u=0,c=e[u];for(let p=0;p<this.width;p++){p/c.right>1&&(c=e[++u]);let m=Math.abs(p-c.left),y=Math.abs(p-c.right),v=Math.min(m,y),w,E=a/i*(n+1);if(c.isDash){let M=n-Math.abs(E);w=Math.sqrt(v*v+M*M)}else w=n-Math.sqrt(v*v+E*E);this.data[l+p]=Math.max(0,Math.min(255,w+128))}}}addRegularDash(e){for(let l=e.length-1;l>=0;--l){let u=e[l],c=e[l+1];u.zeroLength?e.splice(l,1):c&&c.isDash===u.isDash&&(c.left=u.left,e.splice(l,1))}let r=e[0],i=e[e.length-1];r.isDash===i.isDash&&(r.left=i.left-this.width,i.right=r.right+this.width);let n=this.width*this.nextRow,a=0,o=e[a];for(let l=0;l<this.width;l++){l/o.right>1&&(o=e[++a]);let u=Math.abs(l-o.left),c=Math.abs(l-o.right),p=Math.min(u,c),m=o.isDash?p:-p;this.data[n+l]=Math.max(0,Math.min(255,m+128))}}addDash(e,r){let i=r?7:0,n=2*i+1;if(this.nextRow+n>this.height)return kl("LineAtlas out of space"),null;let a=0;for(let l=0;l<e.length;l++)a+=e[l];if(a!==0){let l=this.width/a,u=this.getDashRanges(e,this.width,l);r?this.addRoundDash(u,l,i):this.addRegularDash(u)}let o={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:a};return this.nextRow+=n,this.dirty=!0,o}bind(e){let r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}};s(nae,"LineAtlas");var a9e=nae;N();N();N();var aae=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};s(aae,"ThrottledInvoker");var o9e=aae,oae=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new o9e(()=>this.process()),this.subscription=vZ(this.target,"message",i=>this.receive(i),!1),this.globalScope=Vy(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((i,n)=>{let a=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[a]={resolve:i,reject:n},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[a];let u={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(u)},{once:!0});let o=[],l=vt(Ee({},e),{id:a,sourceMapId:this.mapId,origin:location.origin,data:K1(e.data,o)});this.target.postMessage(l,{transfer:o})})}receive(e){let r=e.data,i=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[i];let n=this.abortControllers[i];delete this.abortControllers[i],n&&n.abort();return}if(Vy(self)||r.mustQueue){this.tasks[i]=r,this.taskQueue.push(i),this.invoker.trigger();return}this.processTask(i,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let a=this.resolveRejects[e];if(delete this.resolveRejects[e],!a)return;r.error?a.reject(J1(r.error)):a.resolve(J1(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let i=J1(r.data),n=new AbortController;this.abortControllers[e]=n;try{let a=await this.messageHandlers[r.type](r.sourceMapId,i,n);this.completeTask(e,null,a)}catch(a){this.completeTask(e,a)}}completeTask(e,r,i){let n=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?K1(r):null,data:K1(i,n)};this.target.postMessage(a,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};s(oae,"Actor");var s9e=oae;N();N();N();N();var l9e=`(()=>{var _y=Object.create;var Ti=Object.defineProperty,Iy=Object.defineProperties,Ty=Object.getOwnPropertyDescriptor,Cy=Object.getOwnPropertyDescriptors,ky=Object.getOwnPropertyNames,Bl=Object.getOwnPropertySymbols,My=Object.getPrototypeOf,Rl=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable;var zl=(t,e,r)=>e in t?Ti(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dt=(t,e)=>{for(var r in e||(e={}))Rl.call(e,r)&&zl(t,r,e[r]);if(Bl)for(var r of Bl(e))Ey.call(e,r)&&zl(t,r,e[r]);return t},Ci=(t,e)=>Iy(t,Cy(e));var Ae=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ol=(t,e)=>{for(var r in e)Ti(t,r,{get:e[r],enumerable:!0})},Fy=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ky(e))!Rl.call(t,i)&&i!==r&&Ti(t,i,{get:()=>e[i],enumerable:!(n=Ty(e,i))||n.enumerable});return t};var Z=(t,e,r)=>(r=t!=null?_y(My(t)):{},Fy(e||!t||!t.__esModule?Ti(r,"default",{value:t,enumerable:!0}):r,t));var he=Ae((d0,Nl)=>{"use strict";Nl.exports=sr;function sr(t,e){this.x=t,this.y=e}sr.prototype={clone:function(){return new sr(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};sr.convert=function(t){return t instanceof sr?t:Array.isArray(t)?new sr(t[0],t[1]):t}});var Gl=Ae((g0,$l)=>{"use strict";$l.exports=Ul;function Ul(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=n}Ul.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,n=0;n<8;n++){var i=this.sampleCurveX(r)-t;if(Math.abs(i)<e)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=t,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-t)<e));n++)t>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}}});var Mc=Ae((Yv,Ts)=>{function hd(t,e){var r,n,i,o,a,s,l,u,c,p;for(r=t.length&3,n=t.length-r,i=e,a=3432918353,l=461845907,p=0;p<n;)c=t.charCodeAt(p)&255|(t.charCodeAt(++p)&255)<<8|(t.charCodeAt(++p)&255)<<16|(t.charCodeAt(++p)&255)<<24,++p,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,o=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(c=0,r){case 3:c^=(t.charCodeAt(p+2)&255)<<16;case 2:c^=(t.charCodeAt(p+1)&255)<<8;case 1:c^=t.charCodeAt(p)&255,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c}return i^=t.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}typeof Ts<"u"&&(Ts.exports=hd)});var Ec=Ae((Qv,Cs)=>{function dd(t,e){for(var r=t.length,n=e^r,i=0,o;r>=4;)o=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)^o,r-=4,++i;switch(r){case 3:n^=(t.charCodeAt(i+2)&255)<<16;case 2:n^=(t.charCodeAt(i+1)&255)<<8;case 1:n^=t.charCodeAt(i)&255,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)}return n^=n>>>13,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16),n^=n>>>15,n>>>0}typeof Cs!==void 0&&(Cs.exports=dd)});var ks=Ae((e1,Lo)=>{var Fc=Mc(),gd=Ec();Lo.exports=Fc;Lo.exports.murmur3=Fc;Lo.exports.murmur2=gd});var $s=Ae((JP,Us)=>{"use strict";Us.exports=Jo;Us.exports.default=Jo;function Jo(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,o=xp(t,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;var s,l,u,c,p,f,y;if(n&&(o=nx(t,e,o,r)),t.length>80*r){s=u=t[0],l=c=t[1];for(var m=r;m<i;m+=r)p=t[m],f=t[m+1],p<s&&(s=p),f<l&&(l=f),p>u&&(u=p),f>c&&(c=f);y=Math.max(u-s,c-l),y=y!==0?32767/y:0}return Wn(o,a,r,s,l,y,0),a}function xp(t,e,r,n,i){var o,a;if(i===Ns(t,e,r,n)>0)for(o=e;o<r;o+=n)a=gp(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=gp(o,t[o],t[o+1],a);return a&&Zo(a,a.next)&&(Xn(a),a=a.next),a}function tr(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Zo(r,r.next)||oe(r.prev,r,r.next)===0)){if(Xn(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function Wn(t,e,r,n,i,o,a){if(t){!a&&o&&lx(t,n,i,o);for(var s=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,o?ex(t,n,i,o):Qg(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),Xn(t),t=u.next,s=u.next;continue}if(t=u,t===s){a?a===1?(t=tx(tr(t),e,r),Wn(t,e,r,n,i,o,2)):a===2&&rx(t,e,r,n,i,o):Wn(tr(t),e,r,n,i,o,1);break}}}}function Qg(t){var e=t.prev,r=t,n=t.next;if(oe(e,r,n)>=0)return!1;for(var i=e.x,o=r.x,a=n.x,s=e.y,l=r.y,u=n.y,c=i<o?i<a?i:a:o<a?o:a,p=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,y=s>l?s>u?s:u:l>u?l:u,m=n.next;m!==e;){if(m.x>=c&&m.x<=f&&m.y>=p&&m.y<=y&&Ir(i,s,o,l,a,u,m.x,m.y)&&oe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function ex(t,e,r,n){var i=t.prev,o=t,a=t.next;if(oe(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,p=o.y,f=a.y,y=s<l?s<u?s:u:l<u?l:u,m=c<p?c<f?c:f:p<f?p:f,h=s>l?s>u?s:u:l>u?l:u,d=c>p?c>f?c:f:p>f?p:f,g=Rs(y,m,e,r,n),b=Rs(h,d,e,r,n),x=t.prevZ,v=t.nextZ;x&&x.z>=g&&v&&v.z<=b;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ir(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ir(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=g;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ir(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=b;){if(v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ir(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function tx(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!Zo(i,o)&&bp(i,n,n.next,o)&&Hn(i,o)&&Hn(o,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(o.i/r|0),Xn(n),Xn(n.next),n=t=o),n=n.next}while(n!==t);return tr(n)}function rx(t,e,r,n,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&px(a,s)){var l=vp(a,s);a=tr(a,a.next),l=tr(l,l.next),Wn(a,e,r,n,i,o,0),Wn(l,e,r,n,i,o,0);return}s=s.next}a=a.next}while(a!==t)}function nx(t,e,r,n){var i=[],o,a,s,l,u;for(o=0,a=e.length;o<a;o++)s=e[o]*n,l=o<a-1?e[o+1]*n:t.length,u=xp(t,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(cx(u));for(i.sort(ix),o=0;o<i.length;o++)r=ox(i[o],r);return r}function ix(t,e){return t.x-e.x}function ox(t,e){var r=ax(t,e);if(!r)return e;var n=vp(r,t);return tr(n,n.next),tr(r,r.next)}function ax(t,e){var r=e,n=t.x,i=t.y,o=-1/0,a;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o&&(o=s,a=r.x<r.next.x?r:r.next,s===n))return a}r=r.next}while(r!==e);if(!a)return null;var l=a,u=a.x,c=a.y,p=1/0,f;r=a;do n>=r.x&&r.x>=u&&n!==r.x&&Ir(i<c?n:o,i,u,c,i<c?o:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),Hn(r,t)&&(f<p||f===p&&(r.x>a.x||r.x===a.x&&sx(a,r)))&&(a=r,p=f)),r=r.next;while(r!==l);return a}function sx(t,e){return oe(t.prev,t,e.prev)<0&&oe(e.next,t,t.next)<0}function lx(t,e,r,n){var i=t;do i.z===0&&(i.z=Rs(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,ux(i)}function ux(t){var e,r,n,i,o,a,s,l,u=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ,!!n);e++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1);return t}function Rs(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function cx(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Ir(t,e,r,n,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(n-s)>=(r-a)*(e-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function px(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!fx(t,e)&&(Hn(t,e)&&Hn(e,t)&&yx(t,e)&&(oe(t.prev,t,e.prev)||oe(t,e.prev,e))||Zo(t,e)&&oe(t.prev,t,t.next)>0&&oe(e.prev,e,e.next)>0)}function oe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Zo(t,e){return t.x===e.x&&t.y===e.y}function bp(t,e,r,n){var i=jo(oe(t,e,r)),o=jo(oe(t,e,n)),a=jo(oe(r,n,t)),s=jo(oe(r,n,e));return!!(i!==o&&a!==s||i===0&&qo(t,r,e)||o===0&&qo(t,n,e)||a===0&&qo(r,t,n)||s===0&&qo(r,e,n))}function qo(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function jo(t){return t>0?1:t<0?-1:0}function fx(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&bp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Hn(t,e){return oe(t.prev,t,t.next)<0?oe(t,e,t.next)>=0&&oe(t,t.prev,e)>=0:oe(t,e,t.prev)<0||oe(t,t.next,e)<0}function yx(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function vp(t,e){var r=new Os(t.i,t.x,t.y),n=new Os(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function gp(t,e,r,n){var i=new Os(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Xn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Os(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jo.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(Ns(t,0,o,r));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;a-=Math.abs(Ns(t,u,c,r))}var p=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,y=n[s+1]*r,m=n[s+2]*r;p+=Math.abs((t[f]-t[m])*(t[y+1]-t[f+1])-(t[f]-t[y])*(t[m+1]-t[f+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function Ns(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}Jo.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}});var qs=Ae((kS,Cp)=>{"use strict";var vx=he();Cp.exports=Mr;function Mr(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(Px,this,e)}function Px(t,e,r){t==1?e.id=r.readVarint():t==2?Sx(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function Sx(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}Mr.types=["Unknown","Point","LineString","Polygon"];Mr.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=[],s;t.pos<e;){if(n<=0){var l=t.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),r===1&&(s&&a.push(s),s=[]),s.push(new vx(i,o));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&a.push(s),a};Mr.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(r!==7)throw new Error("unknown command "+r)}return[a,l,s,u]};Mr.prototype.toGeoJSON=function(t,e,r){var n=this.extent*Math.pow(2,r),i=this.extent*t,o=this.extent*e,a=this.loadGeometry(),s=Mr.types[this.type],l,u;function c(y){for(var m=0;m<y.length;m++){var h=y[m],d=180-(h.y+o)*360/n;y[m]=[(h.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(l=0;l<a.length;l++)p[l]=a[l][0];a=p,c(a);break;case 2:for(l=0;l<a.length;l++)c(a[l]);break;case 3:for(a=wx(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)c(a[l][u]);break}a.length===1?a=a[0]:s="Multi"+s;var f={type:"Feature",geometry:{type:s,coordinates:a},properties:this.properties};return"id"in this&&(f.id=this.id),f};function wx(t){var e=t.length;if(e<=1)return[t];for(var r=[],n,i,o=0;o<e;o++){var a=Ax(t[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}function Ax(t){for(var e=0,r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}});var js=Ae((MS,Mp)=>{"use strict";var _x=qs();Mp.exports=kp;function kp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ix,this,e),this.length=this._features.length}function Ix(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(Tx(r))}function Tx(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null}return e}kp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new _x(this._pbf,e,this.extent,this._keys,this._values)}});var Fp=Ae((ES,Ep)=>{"use strict";var Cx=js();Ep.exports=kx;function kx(t,e){this.layers=t.readFields(Mx,{},e)}function Mx(t,e,r){if(t===3){var n=new Cx(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}});var Tt=Ae((FS,Ho)=>{Ho.exports.VectorTile=Fp();Ho.exports.VectorTileFeature=qs();Ho.exports.VectorTileLayer=js()});var Qp=Ae(Xs=>{Xs.read=function(t,e,r,n,i){var o,a,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,f=r?-1:1,y=t[e+p];for(p+=f,o=y&(1<<-c)-1,y>>=-c,c+=s;c>0;o=o*256+t[e+p],p+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=a*256+t[e+p],p+=f,c-=8);if(o===0)o=1-u;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-u}return(y?-1:1)*a*Math.pow(2,o-n)};Xs.write=function(t,e,r,n,i,o){var a,s,l,u=o*8-i-1,c=(1<<u)-1,p=c>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,m=n?1:-1,h=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+p>=1?e+=f/l:e+=f*Math.pow(2,1-p),e*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(e*l-1)*Math.pow(2,i),a=a+p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[r+y]=s&255,y+=m,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+y]=a&255,y+=m,a/=256,u-=8);t[r+y-m]|=h*128}});var ei=Ae((m2,of)=>{"use strict";of.exports=J;var ea=Qp();function J(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}J.Varint=0;J.Fixed64=1;J.Bytes=2;J.Fixed32=5;var Ks=65536*65536,ef=1/Ks,Hx=12,nf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");J.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ta(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=rf(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ta(this.buf,this.pos)+ta(this.buf,this.pos+4)*Ks;return this.pos+=8,t},readSFixed64:function(){var t=ta(this.buf,this.pos)+rf(this.buf,this.pos+4)*Ks;return this.pos+=8,t},readFloat:function(){var t=ea.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ea.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r,n;return n=e[this.pos++],r=n&127,n<128||(n=e[this.pos++],r|=(n&127)<<7,n<128)||(n=e[this.pos++],r|=(n&127)<<14,n<128)||(n=e[this.pos++],r|=(n&127)<<21,n<128)?r:(n=e[this.pos],r|=(n&15)<<28,Xx(r,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=Hx&&nf?cb(this.buf,e,t):ub(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==J.Bytes)return t.push(this.readVarint(e));var r=ct(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==J.Bytes)return t.push(this.readSVarint());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==J.Bytes)return t.push(this.readBoolean());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==J.Bytes)return t.push(this.readFloat());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==J.Bytes)return t.push(this.readDouble());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed32());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed32());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed64());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed64());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===J.Varint)for(;this.buf[this.pos++]>127;);else if(e===J.Bytes)this.pos=this.readVarint()+this.pos;else if(e===J.Fixed32)this.pos+=4;else if(e===J.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Lr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Lr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Lr(this.buf,t&-1,this.pos),Lr(this.buf,Math.floor(t*ef),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Lr(this.buf,t&-1,this.pos),Lr(this.buf,Math.floor(t*ef),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){Kx(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=pb(this.buf,t,this.pos);var r=this.pos-e;r>=128&&tf(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),ea.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ea.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&tf(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,J.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,eb,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,tb,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ib,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,rb,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,nb,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,ob,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ab,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,sb,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,lb,e)},writeBytesField:function(t,e){this.writeTag(t,J.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,J.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,J.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,J.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function Xx(t,e,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return Fr(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function ct(t){return t.type===J.Bytes?t.readVarint()+t.pos:t.pos+1}function Fr(t,e,r){return r?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function Kx(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(r=~(-t%4294967296),n=~(-t/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),Yx(r,n,e),Qx(n,e)}function Yx(t,e,r){r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos]=t&127}function Qx(t,e){var r=(t&7)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function tf(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function eb(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function tb(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function rb(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function nb(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function ib(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function ob(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function ab(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function sb(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function lb(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ta(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Lr(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function rf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ub(t,e,r){for(var n="",i=e;i<r;){var o=t[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var l,u,c;s===1?o<128&&(a=o):s===2?(l=t[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=t[i+1],u=t[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=t[i+1],u=t[i+2],c=t[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function cb(t,e,r){return nf.decode(t.subarray(e,r))}function pb(t,e,r){for(var n=0,i,o;n<e.length;n++){if(i=e.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):o=i;continue}else o&&(t[r++]=239,t[r++]=191,t[r++]=189,o=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=i&63|128)}return r}});var ey=Ae((pT,Qf)=>{Qf.exports=Aa;function Aa(t,e){var r=t&&t.type,n;if(r==="FeatureCollection")for(n=0;n<t.features.length;n++)Aa(t.features[n],e);else if(r==="GeometryCollection")for(n=0;n<t.geometries.length;n++)Aa(t.geometries[n],e);else if(r==="Feature")Aa(t.geometry,e);else if(r==="Polygon")Kf(t.coordinates,e);else if(r==="MultiPolygon")for(n=0;n<t.coordinates.length;n++)Kf(t.coordinates[n],e);return t}function Kf(t,e){if(t.length!==0){Yf(t[0],e);for(var r=1;r<t.length;r++)Yf(t[r],!e)}}function Yf(t,e){for(var r=0,n=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!e&&t.reverse()}});var iy=Ae((mT,ny)=>{"use strict";var Zb=he(),Wb=Tt().VectorTileFeature;ny.exports=ry;function ry(t,e){this.options=e||{},this.features=t,this.length=t.length}ry.prototype.feature=function(t){return new Ia(this.features[t],this.options.extent)};function Ia(t,e){this.id=typeof t.id=="number"?t.id:void 0,this.type=t.type,this.rawGeometry=t.type===1?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Ia.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],n=[],i=0;i<r.length;i++)n.push(new Zb(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry};Ia.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[e,n,r,i]};Ia.prototype.toGeoJSON=Wb.prototype.toGeoJSON});var sy=Ae((hT,gi)=>{var Hb=ei(),ay=iy();gi.exports=dl;gi.exports.fromVectorTileJs=dl;gi.exports.fromGeojsonVt=Xb;gi.exports.GeoJSONWrapper=ay;function dl(t){var e=new Hb;return Kb(t,e),e.finish()}function Xb(t,e){e=e||{};var r={};for(var n in t)r[n]=new ay(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return dl({layers:r})}function Kb(t,e){for(var r in t.layers)e.writeMessage(3,Yb,t.layers[r])}function Yb(t,e){e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,Qb,n);var i=n.keys;for(r=0;r<i.length;r++)e.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)e.writeMessage(4,r0,o[r])}function Qb(t,e){var r=t.feature;r.id!==void 0&&e.writeVarintField(1,r.id),e.writeMessage(2,e0,t),e.writeVarintField(3,r.type),e.writeMessage(4,t0,r)}function e0(t,e){var r=t.feature,n=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=r.properties[s],u=o[s];if(l!==null){typeof u>"u"&&(n.push(s),u=n.length-1,o[s]=u),e.writeVarint(u);var c=typeof l;c!=="string"&&c!=="boolean"&&c!=="number"&&(l=JSON.stringify(l));var p=c+":"+l,f=a[p];typeof f>"u"&&(i.push(l),f=i.length-1,a[p]=f),e.writeVarint(f)}}}function hl(t,e){return(e<<3)+(t&7)}function oy(t){return t<<1^t>>31}function t0(t,e){for(var r=t.loadGeometry(),n=t.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;n===1&&(u=l.length),e.writeVarint(hl(1,u));for(var c=n===3?l.length-1:l.length,p=0;p<c;p++){p===1&&n!==1&&e.writeVarint(hl(2,c-1));var f=l[p].x-i,y=l[p].y-o;e.writeVarint(oy(f)),e.writeVarint(oy(y)),i+=f,o+=y}n===3&&e.writeVarint(hl(7,1))}}function r0(t,e){var r=typeof t;r==="string"?e.writeStringField(1,t):r==="boolean"?e.writeBooleanField(7,t):r==="number"&&(t%1!==0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}});var Ly=Z(he(),1),Zl=Z(Gl(),1);var Oa;function ql(){return Oa==null&&(Oa=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Oa}var ki;function jl(){if(ki==null&&(ki=!1,ql())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let i=0;i<5*5;i++){let o=i*4;r.fillStyle="rgb(".concat(o,",").concat(o+1,",").concat(o+2,")"),r.fillRect(i%5,Math.floor(i/5),1,1)}let n=r.getImageData(0,0,5,5).data;for(let i=0;i<5*5*4;i++)if(i%4!==3&&n[i]!==i){ki=!0;break}}}return ki||!1}function Wl(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function Dy(t,e,r,n){let i=new Zl.default(t,e,r,n);return function(o){return i.solve(o)}}var S0=Dy(.25,.1,.25,1);function it(t,e,r){return Math.min(r,Math.max(e,t))}function Hl(t,e,r){let n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i}function Pe(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}function Xl(t){return Math.log(t)/Math.LN2%1===0}function jr(t,e,r){let n={};for(let i in t)n[i]=e.call(r||this,t[i],i,t);return n}function Kl(t,e,r){let n={};for(let i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function nt(t){return Array.isArray(t)?t.map(nt):typeof t=="object"&&t?jr(t,nt):t}function Yl(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}var Jl={};function fe(t){Jl[t]||(typeof console<"u"&&console.warn(t),Jl[t]=!0)}function ot(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function Ql(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}function at(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}function Jr(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}function Vy(t,e,r,n,i){let o=Math.max(-e,0)*4,l=(Math.max(0,r)-r)*n*4+o,u=n*4,c=Math.max(0,e),p=Math.max(0,r),f=Math.min(t.width,e+n),y=Math.min(t.height,r+i);return{rect:{x:c,y:p,width:f-c,height:y-p},layout:[{offset:l,stride:u}]}}async function By(t,e,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let o=new VideoFrame(t,{timestamp:0});try{let a=o==null?void 0:o.format;if(!a||!(a.startsWith("BGR")||a.startsWith("RGB")))throw new Error("Unrecognized format ".concat(a));let s=a.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await o.copyTo(l,Vy(t,e,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{o.close()}}var Gr,qr;function zy(t,e,r,n,i){let o=t.width,a=t.height;(!Gr||!qr)&&(Gr=new OffscreenCanvas(o,a),qr=Gr.getContext("2d",{willReadFrequently:!0})),Gr.width=o,Gr.height=a,qr.drawImage(t,0,0,o,a);let s=qr.getImageData(e,r,n,i);return qr.clearRect(0,0,o,a),s.data}async function eu(t,e,r,n,i){if(jl())try{return await By(t,e,r,n,i)}catch(o){}return zy(t,e,r,n,i)}function tu(t,e,r,n){return t.addEventListener(e,r,n),{unsubscribe:()=>{t.removeEventListener(e,r,n)}}}var Vt=class t{constructor(e,r,n){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let a=new Int32Array(this.arrayBuffer);e=a[0],r=a[1],n=a[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=a[3+u],p=a[3+u+1];i.push(c===p?null:a.subarray(c,p))}let s=a[3+i.length],l=a[3+i.length+1];this.keys=a.subarray(s,l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let a=0;a<this.d*this.d;a++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=n,this.scale=r/e,this.uid=0;let o=n/r*e;this.min=-o,this.max=e+o}insert(e,r,n,i,o){this._forEachCell(r,n,i,o,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,n,i,o,a){this.cells[o].push(a)}query(e,r,n,i,o){let a=this.min,s=this.max;if(e<=a&&r<=a&&s<=n&&s<=i&&!o)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,r,n,i,this._queryCell,l,u,o),l}}_queryCell(e,r,n,i,o,a,s,l){let u=this.cells[o];if(u!==null){let c=this.keys,p=this.bboxes;for(let f=0;f<u.length;f++){let y=u[f];if(s[y]===void 0){let m=y*4;(l?l(p[m+0],p[m+1],p[m+2],p[m+3]):e<=p[m+2]&&r<=p[m+3]&&n>=p[m+0]&&i>=p[m+1])?(s[y]=!0,a.push(c[y])):s[y]=!1}}}}_forEachCell(e,r,n,i,o,a,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),p=this._convertToCellCoord(n),f=this._convertToCellCoord(i);for(let y=u;y<=p;y++)for(let m=c;m<=f;m++){let h=this.d*m+y;if(!(l&&!l(this._convertFromCellCoord(y),this._convertFromCellCoord(m),this._convertFromCellCoord(y+1),this._convertFromCellCoord(m+1)))&&o.call(this,e,r,n,i,h,a,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let o=r;for(let a=0;a<e.length;a++){let s=e[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+e.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+e.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}static serialize(e,r){let n=e.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(e){return new t(e.buffer)}};var Ry=8,Oy={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Ny={"*":{type:"source"}},Uy=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],$y={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Gy={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},qy={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},jy={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Jy={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Zy={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Wy={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Hy=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Xy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ky={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yy={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Qy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},em={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},tm={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},rm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},nm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},im={type:"array",value:"*"},om={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},am={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},sm={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},lm={type:"array",value:"*",minimum:1},um={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},cm={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},pm={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},fm={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},ym=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],mm={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},hm={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},dm={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},gm={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},xm={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},bm={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},vm={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Pm={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Sm={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},wm={"*":{type:"string"}},S={$version:Ry,$root:Oy,sources:Ny,source:Uy,source_vector:$y,source_raster:Gy,source_raster_dem:qy,source_geojson:jy,source_video:Jy,source_image:Zy,layer:Wy,layout:Hy,layout_background:Xy,layout_fill:Ky,layout_circle:Yy,layout_heatmap:Qy,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:em,layout_symbol:tm,layout_raster:rm,layout_hillshade:nm,filter:im,filter_operator:om,geometry_type:am,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:sm,expression:lm,light:um,sky:cm,terrain:pm,projection:fm,paint:ym,paint_fill:mm,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:hm,paint_circle:dm,paint_heatmap:gm,paint_symbol:xm,paint_raster:bm,paint_hillshade:vm,paint_background:Pm,transition:Sm,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:wm},Am=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var M=class{constructor(e,r,n,i){this.message=(e?"".concat(e,": "):"")+n,i&&(this.identifier=i),r!=null&&r.__line__&&(this.line=r.__line__)}};function fr(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}var Be=class extends Error{constructor(e,r){super(r),this.message=r,this.key=e}},Ha=class t{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(e){return new t(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}},hr={kind:"null"},L={kind:"number"},G={kind:"string"},U={kind:"boolean"},Re={kind:"color"},cr={kind:"object"},$={kind:"value"},_m={kind:"error"},Wi={kind:"collator"},dr={kind:"formatted"},Hi={kind:"padding"},cn={kind:"resolvedImage"},Xi={kind:"variableAnchorOffsetCollection"};function Ee(t,e){return{kind:"array",itemType:t,N:e}}function te(t){if(t.kind==="array"){let e=te(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}var Im=[hr,L,G,U,Re,dr,cr,Ee($),Hi,cn,Xi];function Kr(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Kr(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of Im)if(!Kr(r,e))return null}}return"Expected ".concat(te(t)," but found ").concat(te(e)," instead.")}function fs(t,e){return e.some(r=>r.kind===t.kind)}function Rt(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}function Zr(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}var wu=.96422,Au=1,_u=.82521,Iu=4/29,pr=6/29,Tu=3*pr*pr,Tm=pr*pr*pr,Cm=Math.PI/180,km=180/Math.PI;function Cu(t){return t=t%360,t<0&&(t+=360),t}function ku([t,e,r,n]){t=Na(t),e=Na(e),r=Na(r);let i,o,a=Ua((.2225045*t+.7168786*e+.0606169*r)/Au);t===e&&e===r?i=o=a:(i=Ua((.4360747*t+.3850649*e+.1430804*r)/wu),o=Ua((.0139322*t+.0971045*e+.7141733*r)/_u));let s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function Na(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ua(t){return t>Tm?Math.pow(t,1/3):t/Tu+Iu}function Mu([t,e,r,n]){let i=(t+16)/116,o=isNaN(e)?i:i+e/500,a=isNaN(r)?i:i-r/200;return i=Au*Ga(i),o=wu*Ga(o),a=_u*Ga(a),[$a(3.1338561*o-1.6168667*i-.4906146*a),$a(-.9787684*o+1.9161415*i+.033454*a),$a(.0719453*o-.2289914*i+1.4052427*a),n]}function $a(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}function Ga(t){return t>pr?t*t*t:Tu*(t-Iu)}function Mm(t){let[e,r,n,i]=ku(t),o=Math.sqrt(r*r+n*n);return[Math.round(o*1e4)?Cu(Math.atan2(n,r)*km):NaN,o,e,i]}function Em([t,e,r,n]){return t=isNaN(t)?0:t*Cm,Mu([r,Math.cos(t)*e,Math.sin(t)*e,n])}function Fm([t,e,r,n]){t=Cu(t),e/=100,r/=100;function i(o){let a=(o+t/30)%12,s=e*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return[i(0),i(8),i(4),n]}function Lm(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=Dm[t];if(e){let[i,o,a]=e;return[i/255,o/255,a/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let o=t.length<6?1:2,a=1;return[Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+o)||"ff")]}if(t.startsWith("rgb")){let i=/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,o=t.match(i);if(o){let[a,s,l,u,c,p,f,y,m,h,d,g]=o,b=[u||" ",f||" ",h].join("");if(b==="  "||b==="  /"||b===",,"||b===",,,"){let x=[l,p,m].join(""),v=x==="%%%"?100:x===""?255:0;if(v){let P=[lr(+s/v,0,1),lr(+c/v,0,1),lr(+y/v,0,1),d?ru(+d,g):1];if(nu(P))return P}}return}}let r=/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,n=t.match(r);if(n){let[i,o,a,s,l,u,c,p,f]=n,y=[a||" ",l||" ",c].join("");if(y==="  "||y==="  /"||y===",,"||y===",,,"){let m=[+o,lr(+s,0,100),lr(+u,0,100),p?ru(+p,f):1];if(nu(m))return Fm(m)}}}function Mi(t){return parseInt(t.padEnd(2,t),16)/255}function ru(t,e){return lr(e?t/100:t,0,1)}function lr(t,e,r){return Math.min(Math.max(e,t),r)}function nu(t){return!t.some(Number.isNaN)}var Dm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},W=class t{constructor(e,r,n,i=1,o=!0){this.r=e,this.g=r,this.b=n,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,r,n,i]))}static parse(e){if(e instanceof t)return e;if(typeof e!="string")return;let r=Lm(e);if(r)return new t(...r,!1)}get rgb(){let{r:e,g:r,b:n,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[e/o,r/o,n/o,i])}get hcl(){return this.overwriteGetter("hcl",Mm(this.rgb))}get lab(){return this.overwriteGetter("lab",ku(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,n,i]=this.rgb;return"rgba(".concat([e,r,n].map(o=>Math.round(o*255)).join(","),",").concat(i,")")}};W.black=new W(0,0,0,1);W.white=new W(1,1,1,1);W.transparent=new W(0,0,0,0);W.red=new W(1,0,0,1);var Yr=class{constructor(e,r,n){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},Qr=class{constructor(e,r,n,i,o){this.text=e,this.image=r,this.scale=n,this.fontStack=i,this.textColor=o}},Fe=class t{constructor(e){this.sections=e}static fromString(e){return new t([new Qr(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof t?e:t.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}},Ze=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(typeof e=="number")return new t([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new t(e)}}toString(){return JSON.stringify(this.values)}},Vm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),Ne=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let n=e[r],i=e[r+1];if(typeof n!="string"||!Vm.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new t(e)}}toString(){return JSON.stringify(this.values)}},Te=class t{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new t({name:e,available:!1}):null}};function Eu(t,e,r,n){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let i=typeof n=="number"?[t,e,r,n]:[t,e,r];return"Invalid rgba value [".concat(i.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value [".concat([t,e,r,n].join(", "),"]: 'a' must be between 0 and 1.")}function en(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof W||t instanceof Yr||t instanceof Fe||t instanceof Ze||t instanceof Ne||t instanceof Te)return!0;if(Array.isArray(t)){for(let e of t)if(!en(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!en(t[e]))return!1;return!0}else return!1}function ue(t){if(t===null)return hr;if(typeof t=="string")return G;if(typeof t=="boolean")return U;if(typeof t=="number")return L;if(t instanceof W)return Re;if(t instanceof Yr)return Wi;if(t instanceof Fe)return dr;if(t instanceof Ze)return Hi;if(t instanceof Ne)return Xi;if(t instanceof Te)return cn;if(Array.isArray(t)){let e=t.length,r;for(let n of t){let i=ue(n);if(!r)r=i;else{if(r===i)continue;r=$;break}}return Ee(r||$,e)}else return cr}function Hr(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof W||t instanceof Fe||t instanceof Ze||t instanceof Ne||t instanceof Te?t.toString():JSON.stringify(t)}var mt=class t{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!en(e[1]))return r.error("invalid value");let n=e[1],i=ue(n),o=r.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new t(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},ie=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}},Ei={string:G,number:L,boolean:U,object:cr},je=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=1,i,o=e[0];if(o==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in Ei)||u==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);s=Ei[u],n++}else s=$;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);l=e[2],n++}i=Ee(s,l)}else{if(!Ei[o])throw new Error("Types doesn't contain name = ".concat(o));i=Ei[o]}let a=[];for(;n<e.length;n++){let s=r.parse(e[n],n,$);if(!s)return null;a.push(s)}return new t(i,a)}evaluate(e){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(e);if(Kr(this.type,ue(n))){if(r===this.args.length-1)throw new ie("Expected value to be of type ".concat(te(this.type),", but found ").concat(te(ue(n))," instead."))}else return n}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},iu={"to-boolean":U,"to-color":Re,"to-number":L,"to-string":G},yt=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[0];if(!iu[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");let i=iu[n],o=[];for(let a=1;a<e.length;a++){let s=r.parse(e[a],a,$);if(!s)return null;o.push(s)}return new t(i,o)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(e),n=null,r instanceof W)return r;if(typeof r=="string"){let o=e.parseColor(r);if(o)return o}else if(Array.isArray(r)&&(r.length<3||r.length>4?n="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):n=Eu(r[0],r[1],r[2],r[3]),!n))return new W(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ie(n||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ze.parse(r);if(i)return i}throw new ie("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ne.parse(r);if(i)return i}throw new ie("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(e),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new ie("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return Fe.fromString(Hr(this.args[0].evaluate(e)));case"resolvedImage":return Te.fromString(Hr(this.args[0].evaluate(e)));default:return Hr(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Bm=["Unknown","Point","LineString","Polygon"],Vi=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Bm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=W.parse(e)),r}},Bi=class t{constructor(e,r,n=[],i,o=new Ha,a=[]){this.registry=e,this.path=n,this.key=n.map(s=>"[".concat(s,"]")).join(""),this.scope=o,this.errors=a,this.expectedType=i,this._isConstant=r}parse(e,r,n,i,o={}){return r?this.concat(r,n,i)._parse(e,o):this._parse(e,o)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(i,o,a){return a==="assert"?new je(o,[i]):a==="coerce"?new yt(o,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if(typeof i!="string")return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let o=this.registry[i];if(o){let a=o.parse(e,this);if(!a)return null;if(this.expectedType){let s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,r.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof mt)&&a.type.kind!=="resolvedImage"&&this._isConstant(a)){let s=new Vi;try{a=new mt(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,n){let i=typeof e=="number"?this.path.concat(e):this.path,o=n?this.scope.concat(n):this.scope;return new t(this.registry,this._isConstant,i,r||null,o,this.errors)}error(e,...r){let n="".concat(this.key).concat(r.map(i=>"[".concat(i,"]")).join(""));this.errors.push(new Be(n,e))}checkSubtype(e,r){let n=Kr(e,r);return n&&this.error(n),n}},zi=class t{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let n=[];for(let o=1;o<e.length-1;o+=2){let a=e[o];if(typeof a!="string")return r.error("Expected string, but found ".concat(typeof a," instead."),o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or '_'.",o);let s=r.parse(e[o+1],o+1);if(!s)return null;n.push([a,s])}let i=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return i?new t(n,i):null}outputDefined(){return this.result.outputDefined()}},Ri=class t{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let n=e[1];return r.scope.has(n)?new t(n,r.scope.get(n)):r.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}},Xa=class t{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,L),i=r.parse(e[2],2,Ee(r.expectedType||$));if(!n||!i)return null;let o=i.type;return new t(o.itemType,n,i)}evaluate(e){let r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new ie("Array index out of bounds: ".concat(r," < 0."));if(r>=n.length)throw new ie("Array index out of bounds: ".concat(r," > ").concat(n.length-1,"."));if(r!==Math.floor(r))throw new ie("Array index must be an integer, but found ".concat(r," instead."));return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},Ka=class t{constructor(e,r){this.type=U,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,$);return!n||!i?null:fs(n.type,[U,G,L,hr,$])?new t(n,i):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(n.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Rt(r,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(ue(r))," instead."));if(!Rt(n,["string","array"]))throw new ie("Expected second argument to be of type array or string, but found ".concat(te(ue(n))," instead."));return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},Ya=class t{constructor(e,r,n){this.type=L,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,$);if(!n||!i)return null;if(!fs(n.type,[U,G,L,hr,$]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,L);return o?new t(n,i,o):null}else return new t(n,i)}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Rt(r,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(ue(r))," instead."));let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(e)),Rt(n,["string"])){let o=n.indexOf(r,i);return o===-1?-1:[...n.slice(0,o)].length}else{if(Rt(n,["array"]))return n.indexOf(r,i);throw new ie("Expected second argument to be of type array or string, but found ".concat(te(ue(n))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},Qa=class t{constructor(e,r,n,i,o,a){this.inputType=e,this.type=r,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let o={},a=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],p=e[u+1];Array.isArray(c)||(c=[c]);let f=r.concat(u);if(c.length===0)return f.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return f.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof m=="number"&&Math.floor(m)!==m)return f.error("Numeric branch labels must be integer values.");if(!n)n=ue(m);else if(f.checkSubtype(n,ue(m)))return null;if(typeof o[String(m)]<"u")return f.error("Branch labels must be unique.");o[String(m)]=a.length}let y=r.parse(p,u,i);if(!y)return null;i=i||y.type,a.push(y)}let s=r.parse(e[1],1,$);if(!s)return null;let l=r.parse(e[e.length-1],e.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new t(n,i,s,o,a,l)}evaluate(e){let r=this.input.evaluate(e);return(ue(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}},es=class t{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let a=1;a<e.length-1;a+=2){let s=r.parse(e[a],a,U);if(!s)return null;let l=r.parse(e[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let o=r.parse(e[e.length-1],e.length-1,n);if(!o)return null;if(!n)throw new Error("Can't infer output type");return new t(n,i,o)}evaluate(e){for(let[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},ts=class t{constructor(e,r,n,i){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,L);if(!n||!i)return null;if(!fs(n.type,[Ee($),G,$]))return r.error("Expected first argument to be of type array or string, but found ".concat(te(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,L);return o?new t(n.type,n,i,o):null}else return new t(n.type,n,i)}evaluate(e){let r=this.input.evaluate(e),n=this.beginIndex.evaluate(e),i;if(this.endIndex&&(i=this.endIndex.evaluate(e)),Rt(r,["string"]))return[...r].slice(n,i).join("");if(Rt(r,["array"]))return r.slice(n,i);throw new ie("Expected first argument to be of type array or string, but found ".concat(te(ue(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};function Ki(t,e){let r=t.length-1,n=0,i=r,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=t[o],s=t[o+1],a<=e){if(o===r||e<s)return o;n=o+1}else if(a>e)i=o-1;else throw new ie("Input is not a number.");return 0}var yr=class t{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(e[1],1,L);if(!n)return null;let i=[],o=null;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);for(let a=1;a<e.length;a+=2){let s=a===1?-1/0:e[a],l=e[a+1],u=a,c=a+1;if(typeof s!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let p=r.parse(l,c,o);if(!p)return null;o=o||p.type,i.push([s,p])}return new t(o,n,i)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=Ki(r,i);return n[a].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function zm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qa,ou;function Rm(){if(ou)return qa;ou=1,qa=t;function t(e,r,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(i-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=i}return t.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var o=this.sampleCurveX(n)-e;if(Math.abs(o)<r)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n=n-o/a}var s=0,l=1;for(n=e,i=0;i<20&&(o=this.sampleCurveX(n),!(Math.abs(o-e)<r));i++)e>o?s=n:l=n,n=(l-s)*.5+s;return n},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},qa}var Om=Rm(),Nm=zm(Om);function Um(t){return t==="rgb"||t==="hcl"||t==="lab"}function Ot(t,e,r){return t+r*(e-t)}function $m(t,e,r,n="rgb"){switch(n){case"rgb":{let[i,o,a,s]=Oi(t.rgb,e.rgb,r);return new W(i,o,a,s,!1)}case"hcl":{let[i,o,a,s]=t.hcl,[l,u,c,p]=e.hcl,f,y;if(!isNaN(i)&&!isNaN(l)){let b=l-i;l>i&&b>180?b-=360:l<i&&i-l>180&&(b+=360),f=i+r*b}else isNaN(i)?isNaN(l)?f=NaN:(f=l,(a===1||a===0)&&(y=u)):(f=i,(c===1||c===0)&&(y=o));let[m,h,d,g]=Em([f,y!=null?y:Ot(o,u,r),Ot(a,c,r),Ot(s,p,r)]);return new W(m,h,d,g,!1)}case"lab":{let[i,o,a,s]=Mu(Oi(t.lab,e.lab,r));return new W(i,o,a,s,!1)}}}function Oi(t,e,r){return t.map((n,i)=>Ot(n,e[i],r))}function Gm(t,e,r){return new Ze(Oi(t.values,e.values,r))}function qm(t,e,r){let n=t.values,i=e.values;if(n.length!==i.length)throw new ie("Cannot interpolate values of different length. from: ".concat(t.toString(),", to: ").concat(e.toString()));let o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==i[a])throw new ie("Cannot interpolate values containing mismatched anchors. from[".concat(a,"]: ").concat(n[a],", to[").concat(a,"]: ").concat(i[a]));o.push(n[a]);let[s,l]=n[a+1],[u,c]=i[a+1];o.push([Ot(s,u,r),Ot(l,c,r)])}return new Ne(o)}var Oe={number:Ot,color:$m,array:Oi,padding:Gm,variableAnchorOffsetCollection:qm},Je=class t{constructor(e,r,n,i,o){this.type=e,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(e,r,n,i){let o=0;if(e.name==="exponential")o=ja(r,e.base,n,i);else if(e.name==="linear")o=ja(r,1,n,i);else if(e.name==="cubic-bezier"){let a=e.controlPoints;o=new Nm(a[0],a[1],a[2],a[3]).solve(ja(r,1,n,i))}return o}static parse(e,r){let[n,i,o,...a]=e;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error("Unknown interpolation type ".concat(String(i[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(o=r.parse(o,2,L),!o)return null;let s=[],l=null;n==="interpolate-hcl"||n==="interpolate-lab"?l=Re:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<a.length;u+=2){let c=a[u],p=a[u+1],f=u+3,y=u+4;if(typeof c!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(s.length&&s[s.length-1][0]>=c)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);let m=r.parse(p,y,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!Zr(l,L)&&!Zr(l,Re)&&!Zr(l,Hi)&&!Zr(l,Xi)&&!Zr(l,Ee(L))?r.error("Type ".concat(te(l)," is not interpolatable.")):new t(l,n,i,o,s)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=Ki(r,i),s=r[a],l=r[a+1],u=t.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(e),p=n[a+1].evaluate(e);switch(this.operator){case"interpolate":return Oe[this.type.kind](c,p,u);case"interpolate-hcl":return Oe.color(c,p,u,"hcl");case"interpolate-lab":return Oe.color(c,p,u,"lab")}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function ja(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Ni=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let o=[];for(let s of e.slice(1)){let l=r.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}if(!n)throw new Error("No output type");return i&&o.some(s=>Kr(i,s.type))?new t($,o):new t(n,o)}evaluate(e){let r=null,n=0,i;for(let o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof Te&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};function au(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function jm(t,e,r){return e===r}function Jm(t,e,r){return e!==r}function Zm(t,e,r){return e<r}function Wm(t,e,r){return e>r}function Hm(t,e,r){return e<=r}function Xm(t,e,r){return e>=r}function Fu(t,e,r,n){return n.compare(e,r)===0}function Km(t,e,r,n){return!Fu(t,e,r,n)}function Ym(t,e,r,n){return n.compare(e,r)<0}function Qm(t,e,r,n){return n.compare(e,r)>0}function eh(t,e,r,n){return n.compare(e,r)<=0}function th(t,e,r,n){return n.compare(e,r)>=0}function gr(t,e,r){let n=t!=="=="&&t!=="!=";return class Lu{constructor(o,a,s){this.type=U,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");let s=o[0],l=a.parse(o[1],1,$);if(!l)return null;if(!au(s,l.type))return a.concat(1).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(te(l.type),"'."));let u=a.parse(o[2],2,$);if(!u)return null;if(!au(s,u.type))return a.concat(2).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(te(u.type),"'."));if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot compare types '".concat(te(l.type),"' and '").concat(te(u.type),"'."));n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new je(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new je(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,Wi),!c)return null}return new Lu(l,u,c)}evaluate(o){let a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new ie('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(l.kind,", ").concat(u.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!=="string"||u.kind!=="string")return e(o,a,s)}return this.collator?r(o,a,s,this.collator.evaluate(o)):e(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var rh=gr("==",jm,Fu),nh=gr("!=",Jm,Km),ih=gr("<",Zm,Ym),oh=gr(">",Wm,Qm),ah=gr("<=",Hm,eh),sh=gr(">=",Xm,th),Ui=class t{constructor(e,r,n){this.type=Wi,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,U);if(!i)return null;let o=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,U);if(!o)return null;let a=null;return n.locale&&(a=r.parse(n.locale,1,G),!a)?null:new t(i,o,a)}evaluate(e){return new Yr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}},rs=class t{constructor(e,r,n,i,o){this.type=G,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let n=r.parse(e[1],1,L);if(!n)return null;let i=e[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=r.parse(i.locale,1,G),!o))return null;let a=null;if(i.currency&&(a=r.parse(i.currency,1,G),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,L),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,L),!l)?null:new t(n,o,a,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},tn=class t{constructor(e){this.type=dr,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],o=!1;for(let a=1;a<=e.length-1;++a){let s=e[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,L),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,Ee(G)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,Re),!c))return null;let p=i[i.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=r.parse(e[a],1,$);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null})}}return new t(i)}evaluate(e){let r=n=>{let i=n.content.evaluate(e);return ue(i)===cn?new Qr("",i,null,null,null):new Qr(Hr(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)};return new Fe(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}},ns=class t{constructor(e){this.type=cn,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let n=r.parse(e[1],1,G);return n?new t(n):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),n=Te.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}},is=class t{constructor(e){this.type=L,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat(te(n.type)," instead.")):new t(n):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new ie("Expected value to be of type string or array, but found ".concat(te(ue(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}},Xe=8192;function lh(t,e){let r=uh(t[0]),n=ph(t[1]),i=Math.pow(2,e.z);return[Math.round(r*i*Xe),Math.round(n*i*Xe)]}function ys(t,e){let r=Math.pow(2,e.z),n=(t[0]/Xe+e.x)/r,i=(t[1]/Xe+e.y)/r;return[ch(n),fh(i)]}function uh(t){return(180+t)/360}function ch(t){return t*360-180}function ph(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function fh(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}function pn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function rn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function yh(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function mh(t,e,r){let n=t[0]-e[0],i=t[1]-e[1],o=t[0]-r[0],a=t[1]-r[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function Yi(t,e,r,n){let i=[e[0]-t[0],e[1]-t[1]],o=[n[0]-r[0],n[1]-r[1]];return xh(o,i)===0?!1:!!(su(t,e,r,n)&&su(r,n,t,e))}function hh(t,e,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(Yi(t,e,n[i],n[i+1]))return!0;return!1}function xr(t,e,r=!1){let n=!1;for(let i of e)for(let o=0;o<i.length-1;o++){if(mh(t,i[o],i[o+1]))return r;yh(t,i[o],i[o+1])&&(n=!n)}return n}function dh(t,e){for(let r of e)if(xr(t,r))return!0;return!1}function Du(t,e){for(let r of t)if(!xr(r,e))return!1;for(let r=0;r<t.length-1;++r)if(hh(t[r],t[r+1],e))return!1;return!0}function gh(t,e){for(let r of e)if(Du(t,r))return!0;return!1}function xh(t,e){return t[0]*e[1]-t[1]*e[0]}function su(t,e,r,n){let i=t[0]-r[0],o=t[1]-r[1],a=e[0]-r[0],s=e[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function ms(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=[];for(let a=0;a<t[i].length;a++){let s=lh(t[i][a],r);pn(e,s),o.push(s)}n.push(o)}return n}function Vu(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=ms(t[i],e,r);n.push(o)}return n}function Bu(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){let i=n*.5,o=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;o===0&&(o=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=o}pn(e,t)}function bh(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}function lu(t,e,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of t)for(let l of s){let u=[l.x+o[0],l.y+o[1]];Bu(u,e,r,i),a.push(u)}return a}function uu(t,e,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of t){let l=[];for(let u of s){let c=[u.x+o[0],u.y+o[1]];pn(e,c),l.push(c)}a.push(l)}if(e[2]-e[0]<=i/2){bh(e);for(let s of a)for(let l of s)Bu(l,e,r,i)}return a}function vh(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=ms(e.coordinates,n,i),a=lu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!xr(s,o))return!1}if(e.type==="MultiPolygon"){let o=Vu(e.coordinates,n,i),a=lu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!dh(s,o))return!1}return!0}function Ph(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=ms(e.coordinates,n,i),a=uu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!Du(s,o))return!1}if(e.type==="MultiPolygon"){let o=Vu(e.coordinates,n,i),a=uu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!gh(s,o))return!1}return!0}var nn=class t{constructor(e,r){this.type=U,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(en(e[1])){let n=e[1];if(n.type==="FeatureCollection"){let i=[];for(let o of n.features){let{type:a,coordinates:s}=o.geometry;a==="Polygon"&&i.push(s),a==="MultiPolygon"&&i.push(...s)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new t(n,o)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new t(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new t(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return vh(e,this.geometries);if(e.geometryType()==="LineString")return Ph(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},$i=class{constructor(e=[],r=(n,i)=>n<i?-1:n>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=a+1;if(s<this.length&&n(r[s],r[a])<0&&(a=s),n(r[a],o)>=0)break;r[e]=r[a],e=a}r[e]=o}};function Sh(t,e,r,n,i){zu(t,e,r,n||t.length-1,i||wh)}function zu(t,e,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(e-a*l/o+u)),p=Math.min(n,Math.floor(e+(o-a)*l/o+u));zu(t,e,c,p,i)}var f=t[e],y=r,m=n;for(Wr(t,r,e),i(t[n],f)>0&&Wr(t,r,n);y<m;){for(Wr(t,y,m),y++,m--;i(t[y],f)<0;)y++;for(;i(t[m],f)>0;)m--}i(t[r],f)===0?Wr(t,r,m):(m++,Wr(t,m,n)),m<=e&&(r=m+1),e<=m&&(n=m-1)}}function Wr(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function wh(t,e){return t<e?-1:t>e?1:0}function Ah(t,e){if(t.length<=1)return[t];let n=[],i,o;for(let a of t){let s=Ih(a);s!==0&&(a.area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(Sh(n[a],e,1,n[a].length-1,_h),n[a]=n[a].slice(0,e));return n}function _h(t,e){return e.area-t.area}function Ih(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}var Th=6378.137,cu=1/298.257223563,pu=cu*(2-cu),fu=Math.PI/180,on=class{constructor(e){let r=fu*Th*1e3,n=Math.cos(e*fu),i=1/(1-pu*(1-n*n)),o=Math.sqrt(i);this.kx=r*o*n,this.ky=r*o*i*(1-pu)}distance(e,r){let n=this.wrap(e[0]-r[0])*this.kx,i=(e[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(e,r){let n=1/0,i,o,a,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],p=this.wrap(e[l+1][0]-u)*this.kx,f=(e[l+1][1]-c)*this.ky,y=0;(p!==0||f!==0)&&(y=(this.wrap(r[0]-u)*this.kx*p+(r[1]-c)*this.ky*f)/(p*p+f*f),y>1?(u=e[l+1][0],c=e[l+1][1]):y>0&&(u+=p/this.kx*y,c+=f/this.ky*y)),p=this.wrap(r[0]-u)*this.kx,f=(r[1]-c)*this.ky;let m=p*p+f*f;m<n&&(n=m,i=u,o=c,a=l,s=y)}return{point:[i,o],index:a,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}},os=100,as=50;function Ru(t,e){return e[0]-t[0]}function Gi(t){return t[1]-t[0]+1}function st(t,e){return t[1]>=t[0]&&t[1]<e}function ss(t,e){if(t[0]>t[1])return[null,null];let r=Gi(t);if(e){if(r===2)return[t,null];let i=Math.floor(r/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}if(r===1)return[t,null];let n=Math.floor(r/2)-1;return[[t[0],t[0]+n],[t[0]+n+1,t[1]]]}function ls(t,e){if(!st(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=e[0];n<=e[1];++n)pn(r,t[n]);return r}function us(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let n of r)pn(e,n);return e}function yu(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function hs(t,e,r){if(!yu(t)||!yu(e))return NaN;let n=0,i=0;return t[2]<e[0]&&(n=e[0]-t[2]),t[0]>e[2]&&(n=t[0]-e[2]),t[1]>e[3]&&(i=t[1]-e[3]),t[3]<e[1]&&(i=e[1]-t[3]),r.distance([0,0],[n,i])}function zt(t,e,r){let n=r.pointOnLine(e,t);return r.distance(t,n.point)}function ds(t,e,r,n,i){let o=Math.min(zt(t,[r,n],i),zt(e,[r,n],i)),a=Math.min(zt(r,[t,e],i),zt(n,[t,e],i));return Math.min(o,a)}function Ch(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return 1/0;let a=1/0;for(let s=e[0];s<e[1];++s){let l=t[s],u=t[s+1];for(let c=n[0];c<n[1];++c){let p=r[c],f=r[c+1];if(Yi(l,u,p,f))return 0;a=Math.min(a,ds(l,u,p,f,i))}}return a}function kh(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return NaN;let a=1/0;for(let s=e[0];s<=e[1];++s)for(let l=n[0];l<=n[1];++l)if(a=Math.min(a,i.distance(t[s],r[l])),a===0)return a;return a}function Mh(t,e,r){if(xr(t,e,!0))return 0;let n=1/0;for(let i of e){let o=i[0],a=i[i.length-1];if(o!==a&&(n=Math.min(n,zt(t,[a,o],r)),n===0))return n;let s=r.pointOnLine(i,t);if(n=Math.min(n,r.distance(t,s.point)),n===0)return n}return n}function Eh(t,e,r,n){if(!st(e,t.length))return NaN;for(let o=e[0];o<=e[1];++o)if(xr(t[o],r,!0))return 0;let i=1/0;for(let o=e[0];o<e[1];++o){let a=t[o],s=t[o+1];for(let l of r)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let f=l[p],y=l[u];if(Yi(a,s,f,y))return 0;i=Math.min(i,ds(a,s,f,y,n))}}return i}function mu(t,e){for(let r of t)for(let n of r)if(xr(n,e,!0))return!0;return!1}function Fh(t,e,r,n=1/0){let i=us(t),o=us(e);if(n!==1/0&&hs(i,o,r)>=n)return n;if(rn(i,o)){if(mu(t,e))return 0}else if(mu(e,t))return 0;let a=1/0;for(let s of t)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],f=s[l];for(let y of e)for(let m=0,h=y.length,d=h-1;m<h;d=m++){let g=y[d],b=y[m];if(Yi(p,f,g,b))return 0;a=Math.min(a,ds(p,f,g,b,r))}}return a}function hu(t,e,r,n,i,o){if(!o)return;let a=hs(ls(n,o),i,r);a<e&&t.push([a,o,[0,0]])}function Fi(t,e,r,n,i,o,a){if(!o||!a)return;let s=hs(ls(n,o),ls(i,a),r);s<e&&t.push([s,o,a])}function qi(t,e,r,n,i=1/0){let o=Math.min(n.distance(t[0],r[0][0]),i);if(o===0)return o;let a=new $i([[0,[0,t.length-1],[0,0]]],Ru),s=us(r);for(;a.length>0;){let l=a.pop();if(l[0]>=o)continue;let u=l[1],c=e?as:os;if(Gi(u)<=c){if(!st(u,t.length))return NaN;if(e){let p=Eh(t,u,r,n);if(isNaN(p)||p===0)return p;o=Math.min(o,p)}else for(let p=u[0];p<=u[1];++p){let f=Mh(t[p],r,n);if(o=Math.min(o,f),o===0)return 0}}else{let p=ss(u,e);hu(a,o,n,t,s,p[0]),hu(a,o,n,t,s,p[1])}}return o}function ji(t,e,r,n,i,o=1/0){let a=Math.min(o,i.distance(t[0],r[0]));if(a===0)return a;let s=new $i([[0,[0,t.length-1],[0,r.length-1]]],Ru);for(;s.length>0;){let l=s.pop();if(l[0]>=a)continue;let u=l[1],c=l[2],p=e?as:os,f=n?as:os;if(Gi(u)<=p&&Gi(c)<=f){if(!st(u,t.length)&&st(c,r.length))return NaN;let y;if(e&&n)y=Ch(t,u,r,c,i),a=Math.min(a,y);else if(e&&!n){let m=t.slice(u[0],u[1]+1);for(let h=c[0];h<=c[1];++h)if(y=zt(r[h],m,i),a=Math.min(a,y),a===0)return a}else if(!e&&n){let m=r.slice(c[0],c[1]+1);for(let h=u[0];h<=u[1];++h)if(y=zt(t[h],m,i),a=Math.min(a,y),a===0)return a}else y=kh(t,u,r,c,i),a=Math.min(a,y)}else{let y=ss(u,e),m=ss(c,n);Fi(s,a,i,t,r,y[0],m[0]),Fi(s,a,i,t,r,y[0],m[1]),Fi(s,a,i,t,r,y[1],m[0]),Fi(s,a,i,t,r,y[1],m[1])}}return a}function Lh(t,e){let r=t.geometry(),n=r.flat().map(a=>ys([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new on(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,ji(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,ji(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,qi(n,!1,a.coordinates,i,o));break}if(o===0)return o}return o}function Dh(t,e){let r=t.geometry(),n=r.flat().map(a=>ys([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new on(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,ji(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,ji(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,qi(n,!0,a.coordinates,i,o));break}if(o===0)return o}return o}function Vh(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let n=Ah(r,0).map(a=>a.map(s=>s.map(l=>ys([l.x,l.y],t.canonical)))),i=new on(n[0][0][0][1]),o=1/0;for(let a of e)for(let s of n){switch(a.type){case"Point":o=Math.min(o,qi([a.coordinates],!1,s,i,o));break;case"LineString":o=Math.min(o,qi(a.coordinates,!0,s,i,o));break;case"Polygon":o=Math.min(o,Fh(s,a.coordinates,i,o));break}if(o===0)return o}return o}function Ja(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}var an=class t{constructor(e,r){this.type=L,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(en(e[1])){let n=e[1];if(n.type==="FeatureCollection")return new t(n,n.features.map(i=>Ja(i.geometry)).flat());if(n.type==="Feature")return new t(n,Ja(n.geometry));if("type"in n&&"coordinates"in n)return new t(n,Ja(n))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Lh(e,this.geometries);if(e.geometryType()==="LineString")return Dh(e,this.geometries);if(e.geometryType()==="Polygon")return Vh(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},Gt={"==":rh,"!=":nh,">":oh,"<":ih,">=":sh,"<=":ah,array:je,at:Xa,boolean:je,case:es,coalesce:Ni,collator:Ui,format:tn,image:ns,in:Ka,"index-of":Ya,interpolate:Je,"interpolate-hcl":Je,"interpolate-lab":Je,length:is,let:zi,literal:mt,match:Qa,number:je,"number-format":rs,object:je,slice:ts,step:yr,string:je,"to-boolean":yt,"to-color":yt,"to-number":yt,"to-string":yt,var:Ri,within:nn,distance:an},Ke=class t{constructor(e,r,n,i){this.name=e,this.type=r,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let n=e[0],i=t.definitions[n];if(!i)return r.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);let o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new Bi(r.registry,Ji,r.path,null,r.scope);let p=[],f=!1;for(let y=1;y<e.length;y++){let m=e[y],h=Array.isArray(u)?u[y-1]:u.type,d=l.parse(m,1+p.length,h);if(!d){f=!0;break}p.push(d)}if(!f){if(Array.isArray(u)&&u.length!==p.length){l.error("Expected ".concat(u.length," arguments, but found ").concat(p.length," instead."));continue}for(let y=0;y<p.length;y++){let m=Array.isArray(u)?u[y]:u.type,h=p[y];l.concat(y+1).checkSubtype(m,h.type)}if(l.errors.length===0)return new t(n,o,c,p)}}if(s.length===1)r.errors.push(...l.errors);else{let c=(s.length?s:a).map(([f])=>zh(f)).join(" | "),p=[];for(let f=1;f<e.length;f++){let y=r.parse(e[f],1+p.length);if(!y)return null;p.push(te(y.type))}r.error("Expected arguments of type ".concat(c,", but found (").concat(p.join(", "),") instead."))}return null}static register(e,r){t.definitions=r;for(let n in r)e[n]=t}};function du(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);let o=i?i.evaluate(t):1,a=Eu(e,r,n,o);if(a)throw new ie(a);return new W(e/255,r/255,n/255,o,!1)}function gu(t,e){return t in e}function Za(t,e){let r=e[t];return typeof r>"u"?null:r}function Bh(t,e,r,n){for(;r<=n;){let i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}function Bt(t){return{type:t}}Ke.register(Gt,{error:[_m,[G],(t,[e])=>{throw new ie(e.evaluate(t))}],typeof:[G,[$],(t,[e])=>te(ue(e.evaluate(t)))],"to-rgba":[Ee(L,4),[Re],(t,[e])=>{let[r,n,i,o]=e.evaluate(t).rgb;return[r*255,n*255,i*255,o]}],rgb:[Re,[L,L,L],du],rgba:[Re,[L,L,L,L],du],has:{type:U,overloads:[[[G],(t,[e])=>gu(e.evaluate(t),t.properties())],[[G,cr],(t,[e,r])=>gu(e.evaluate(t),r.evaluate(t))]]},get:{type:$,overloads:[[[G],(t,[e])=>Za(e.evaluate(t),t.properties())],[[G,cr],(t,[e,r])=>Za(e.evaluate(t),r.evaluate(t))]]},"feature-state":[$,[G],(t,[e])=>Za(e.evaluate(t),t.featureState||{})],properties:[cr,[],t=>t.properties()],"geometry-type":[G,[],t=>t.geometryType()],id:[$,[],t=>t.id()],zoom:[L,[],t=>t.globals.zoom],"heatmap-density":[L,[],t=>t.globals.heatmapDensity||0],"line-progress":[L,[],t=>t.globals.lineProgress||0],accumulated:[$,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[L,Bt(L),(t,e)=>{let r=0;for(let n of e)r+=n.evaluate(t);return r}],"*":[L,Bt(L),(t,e)=>{let r=1;for(let n of e)r*=n.evaluate(t);return r}],"-":{type:L,overloads:[[[L,L],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[L],(t,[e])=>-e.evaluate(t)]]},"/":[L,[L,L],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[L,[L,L],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[L,[],()=>Math.LN2],pi:[L,[],()=>Math.PI],e:[L,[],()=>Math.E],"^":[L,[L,L],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[L,[L],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[L,[L],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[L,[L],(t,[e])=>Math.log(e.evaluate(t))],log2:[L,[L],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[L,[L],(t,[e])=>Math.sin(e.evaluate(t))],cos:[L,[L],(t,[e])=>Math.cos(e.evaluate(t))],tan:[L,[L],(t,[e])=>Math.tan(e.evaluate(t))],asin:[L,[L],(t,[e])=>Math.asin(e.evaluate(t))],acos:[L,[L],(t,[e])=>Math.acos(e.evaluate(t))],atan:[L,[L],(t,[e])=>Math.atan(e.evaluate(t))],min:[L,Bt(L),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[L,Bt(L),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[L,[L],(t,[e])=>Math.abs(e.evaluate(t))],round:[L,[L],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[L,[L],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[L,[L],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[U,[G,$],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[U,[$],(t,[e])=>t.id()===e.value],"filter-type-==":[U,[G],(t,[e])=>t.geometryType()===e.value],"filter-<":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[U,[$],(t,[e])=>e.value in t.properties()],"filter-has-id":[U,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[U,[Ee(G)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[U,[Ee($)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[U,[G,Ee($)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[U,[G,Ee($)],(t,[e,r])=>Bh(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Bt(U),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Bt(U),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[U,[U],(t,[e])=>!e.evaluate(t)],"is-supported-script":[U,[G],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[G,[G],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[G,[G],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[G,Bt($),(t,e)=>e.map(r=>Hr(r.evaluate(t))).join("")],"resolved-locale":[G,[Wi],(t,[e])=>e.evaluate(t).resolvedLocale()]});function zh(t){return Array.isArray(t)?"(".concat(t.map(te).join(", "),")"):"(".concat(te(t.type),"...)")}function Ji(t){if(t instanceof Ri)return Ji(t.boundExpression);if(t instanceof Ke&&t.name==="error")return!1;if(t instanceof Ui)return!1;if(t instanceof nn)return!1;if(t instanceof an)return!1;let e=t instanceof yt||t instanceof je,r=!0;return t.eachChild(n=>{e?r=r&&Ji(n):r=r&&n instanceof mt}),r?Qi(t)&&eo(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Qi(t){if(t instanceof Ke){if(t.name==="get"&&t.args.length===1)return!1;if(t.name==="feature-state")return!1;if(t.name==="has"&&t.args.length===1)return!1;if(t.name==="properties"||t.name==="geometry-type"||t.name==="id")return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof nn||t instanceof an)return!1;let e=!0;return t.eachChild(r=>{e&&!Qi(r)&&(e=!1)}),e}function sn(t){if(t instanceof Ke&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!sn(r)&&(e=!1)}),e}function eo(t,e){if(t instanceof Ke&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(n=>{r&&!eo(n,e)&&(r=!1)}),r}function cs(t){return{result:"success",value:t}}function ur(t){return{result:"error",value:t}}function ht(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function Ou(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function gs(t){return!!t.expression&&t.expression.interpolated}function j(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function to(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Rh(t){return t}function Nu(t,e){let r=e.type==="color",n=t.stops&&typeof t.stops[0][0]=="object",i=n||t.property!==void 0,o=n||!i,a=t.type||(gs(e)?"exponential":"interval");if(r||e.type==="padding"){let c=r?W.parse:Ze.parse;t=fr({},t),t.stops&&(t.stops=t.stops.map(p=>[p[0],c(p[1])])),t.default?t.default=c(t.default):t.default=c(e.default)}if(t.colorSpace&&!Um(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let s,l,u;if(a==="exponential")s=xu;else if(a==="interval")s=Nh;else if(a==="categorical"){s=Oh,l=Object.create(null);for(let c of t.stops)l[c[0]]=c[1];u=typeof t.stops[0][0]}else if(a==="identity")s=Uh;else throw new Error('Unknown function type "'.concat(a,'"'));if(n){let c={},p=[];for(let m=0;m<t.stops.length;m++){let h=t.stops[m],d=h[0].zoom;c[d]===void 0&&(c[d]={zoom:d,type:t.type,property:t.property,default:t.default,stops:[]},p.push(d)),c[d].stops.push([h[0].value,h[1]])}let f=[];for(let m of p)f.push([c[m].zoom,Nu(c[m],e)]);let y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:Je.interpolationFactor.bind(void 0,y),zoomStops:f.map(m=>m[0]),evaluate({zoom:m},h){return xu({stops:f,base:t.base},e,m).evaluate(m,h)}}}else if(o){let c=a==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Je.interpolationFactor.bind(void 0,c),zoomStops:t.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(t,e,p,l,u)}}else return{kind:"source",evaluate(c,p){let f=p&&p.properties?p.properties[t.property]:void 0;return f===void 0?fn(t.default,e.default):s(t,e,f,l,u)}}}function fn(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}function Oh(t,e,r,n,i){let o=typeof r===i?n[r]:void 0;return fn(o,t.default,e.default)}function Nh(t,e,r){if(j(r)!=="number")return fn(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let i=Ki(t.stops.map(o=>o[0]),r);return t.stops[i][1]}function xu(t,e,r){let n=t.base!==void 0?t.base:1;if(j(r)!=="number")return fn(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let o=Ki(t.stops.map(c=>c[0]),r),a=$h(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Oe[e.type]||Rh;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),f=l.evaluate.apply(void 0,c);if(!(p===void 0||f===void 0))return u(p,f,a,t.colorSpace)}}:u(s,l,a,t.colorSpace)}function Uh(t,e,r){switch(e.type){case"color":r=W.parse(r);break;case"formatted":r=Fe.fromString(r.toString());break;case"resolvedImage":r=Te.fromString(r.toString());break;case"padding":r=Ze.parse(r);break;default:j(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return fn(r,t.default,e.default)}function $h(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Nt=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new Vi,this._defaultValue=r?qh(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,i,o,a){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new ie("Expected value to be one of ".concat(Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", "),", but found ").concat(JSON.stringify(s)," instead."));return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function qt(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Gt}function jt(t,e){let r=new Bi(Gt,Ji,[],e?Gh(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?cs(new Nt(n,e)):ur(r.errors)}var dt=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!sn(r.expression)}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}},gt=class{constructor(e,r,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!sn(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}interpolationFactor(e,r,n){return this.interpolationType?Je.interpolationFactor(this.interpolationType,e,r,n):0}};function Uu(t,e){let r=jt(t,e);if(r.result==="error")return r;let n=r.value.expression,i=Qi(n);if(!i&&!ht(e))return ur([new Be("","data expressions not supported")]);let o=eo(n,["zoom"]);if(!o&&!Ou(e))return ur([new Be("","zoom expressions not supported")]);let a=Di(n);if(!a&&!o)return ur([new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof Be)return ur([a]);if(a instanceof Je&&!gs(e))return ur([new Be("",'"interpolate" expressions cannot be used with this property')]);if(!a)return cs(i?new dt("constant",r.value):new dt("source",r.value));let s=a instanceof Je?a.interpolation:void 0;return cs(i?new gt("camera",r.value,a.labels,s):new gt("composite",r.value,a.labels,s))}var ln=class t{constructor(e,r){this._parameters=e,this._specification=r,fr(this,Nu(this._parameters,this._specification))}static deserialize(e){return new t(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};function $u(t,e){if(to(t))return new ln(t,e);if(qt(t)){let r=Uu(t,e);if(r.result==="error")throw new Error(r.value.map(n=>"".concat(n.key,": ").concat(n.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=W.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Ze.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)&&(r=Ne.parse(t)),{kind:"constant",evaluate:()=>r}}}function Di(t){let e=null;if(t instanceof zi)e=Di(t.result);else if(t instanceof Ni){for(let r of t.args)if(e=Di(r),e)break}else(t instanceof yr||t instanceof Je)&&t.input instanceof Ke&&t.input.name==="zoom"&&(e=t);return e instanceof Be||t.eachChild(r=>{let n=Di(r);n instanceof Be?e=n:!e&&n?e=new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Be("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Gh(t){let e={color:Re,string:G,number:L,enum:G,boolean:U,formatted:dr,padding:Hi,resolvedImage:cn,variableAnchorOffsetCollection:Xi};return t.type==="array"?Ee(e[t.value]||$,t.length):e[t.type]}function qh(t){return t.type==="color"&&to(t.default)?new W(0,0,0,0):t.type==="color"?W.parse(t.default)||null:t.type==="padding"?Ze.parse(t.default)||null:t.type==="variableAnchorOffsetCollection"?Ne.parse(t.default)||null:t.default===void 0?null:t.default}function xs(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!xs(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}var jh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yn(t){if(t==null)return{filter:()=>!0,needGeometry:!1};xs(t)||(t=Zi(t));let e=jt(t,jh);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=Gu(t);return{filter:(n,i,o)=>e.value.evaluate(n,i,{},o),needGeometry:r}}}function Jh(t,e){return t<e?-1:t>e?1:0}function Gu(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Gu(t[e]))return!0;return!1}function Zi(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?Wa(t[1],t[2],"=="):e==="!="?Li(Wa(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Wa(t[1],t[2],e):e==="any"?Zh(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(Zi)):e==="none"?["all"].concat(t.slice(1).map(Zi).map(Li)):e==="in"?bu(t[1],t.slice(2)):e==="!in"?Li(bu(t[1],t.slice(2))):e==="has"?vu(t[1]):e==="!has"?Li(vu(t[1])):!0}function Wa(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}function Zh(t){return["any"].concat(t.map(Zi))}function bu(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Jh)]]:["filter-in-small",t,["literal",e]]}}function vu(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Li(t){return["!",t]}function ps(t){let e=typeof t;if(e==="number"||e==="boolean"||e==="string"||t===void 0||t===null)return JSON.stringify(t);if(Array.isArray(t)){let i="[";for(let o of t)i+="".concat(ps(o),",");return"".concat(i,"]")}let r=Object.keys(t).sort(),n="{";for(let i=0;i<r.length;i++)n+="".concat(JSON.stringify(r[i]),":").concat(ps(t[r[i]]),",");return"".concat(n,"}")}function Wh(t){let e="";for(let r of Am)e+="/".concat(ps(t[r]));return e}function qu(t,e){let r={};for(let i=0;i<t.length;i++){let o=e&&e[t[i].id]||Wh(t[i]);e&&(e[t[i].id]=o);let a=r[o];a||(a=r[o]=[]),a.push(t[i])}let n=[];for(let i in r)n.push(r[i]);return n}function ju(t){let e=t.key,r=t.value;return r?[new M(e,r,"constants have been deprecated as of v8")]:[]}function ae(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ut(t){if(Array.isArray(t))return t.map(Ut);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Ut(t[r]);return e}return ae(t)}function ze(t){let e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=t.validateSpec,l=[],u=j(r);if(u!=="object")return[new M(e,r,"object expected, ".concat(u," found"))];for(let c in r){let p=c.split(".")[0],f=n[p]||n["*"],y;if(i[p])y=i[p];else if(n[p])y=s;else if(i["*"])y=i["*"];else if(n["*"])y=s;else{l.push(new M(e,r[c],'unknown property "'.concat(c,'"')));continue}l=l.concat(y({key:(e&&"".concat(e,"."))+c,value:r[c],valueSpec:f,style:o,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new M(e,r,'missing required property "'.concat(c,'"')));return l}function bs(t){let e=t.value,r=t.valueSpec,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.key,s=t.arrayElementValidator||n;if(j(e)!=="array")return[new M(a,e,"array expected, ".concat(j(e)," found"))];if(r.length&&e.length!==r.length)return[new M(a,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new M(a,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let l={type:r.value,values:r.values};o.$version<7&&(l.function=r.function),j(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:t.validateSpec,style:i,styleSpec:o,key:"".concat(a,"[").concat(c,"]")}));return u}function vs(t){let e=t.key,r=t.value,n=t.valueSpec,i=j(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new M(e,r,"number expected, ".concat(i," found"))]:"minimum"in n&&r<n.minimum?[new M(e,r,"".concat(r," is less than the minimum value ").concat(n.minimum))]:"maximum"in n&&r>n.maximum?[new M(e,r,"".concat(r," is greater than the maximum value ").concat(n.maximum))]:[]}function Ju(t){let e=t.valueSpec,r=ae(t.value.type),n,i={},o,a,s=r!=="categorical"&&t.value.property===void 0,l=!s,u=j(t.value.stops)==="array"&&j(t.value.stops[0])==="array"&&j(t.value.stops[0][0])==="object",c=ze({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:p,default:m}});return r==="identity"&&s&&c.push(new M(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&c.push(new M(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!gs(t.valueSpec)&&c.push(new M(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!ht(t.valueSpec)?c.push(new M(t.key,t.value,"property functions not supported")):s&&!Ou(t.valueSpec)&&c.push(new M(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||u)&&t.value.property===void 0&&c.push(new M(t.key,t.value,'"property" property is required')),c;function p(h){if(r==="identity")return[new M(h.key,h.value,'identity function may not have a "stops" property')];let d=[],g=h.value;return d=d.concat(bs({key:h.key,value:g,valueSpec:h.valueSpec,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,arrayElementValidator:f})),j(g)==="array"&&g.length===0&&d.push(new M(h.key,g,"array must have at least one stop")),d}function f(h){let d=[],g=h.value,b=h.key;if(j(g)!=="array")return[new M(b,g,"array expected, ".concat(j(g)," found"))];if(g.length!==2)return[new M(b,g,"array length 2 expected, length ".concat(g.length," found"))];if(u){if(j(g[0])!=="object")return[new M(b,g,"object expected, ".concat(j(g[0])," found"))];if(g[0].zoom===void 0)return[new M(b,g,"object stop key must have zoom")];if(g[0].value===void 0)return[new M(b,g,"object stop key must have value")];if(a&&a>ae(g[0].zoom))return[new M(b,g[0].zoom,"stop zoom values must appear in ascending order")];ae(g[0].zoom)!==a&&(a=ae(g[0].zoom),o=void 0,i={}),d=d.concat(ze({key:"".concat(b,"[0]"),value:g[0],valueSpec:{zoom:{}},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{zoom:vs,value:y}}))}else d=d.concat(y({key:"".concat(b,"[0]"),value:g[0],valueSpec:{},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec},g));return qt(Ut(g[1]))?d.concat([new M("".concat(b,"[1]"),g[1],"expressions are not allowed in function stops.")]):d.concat(h.validateSpec({key:"".concat(b,"[1]"),value:g[1],valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec}))}function y(h,d){let g=j(h.value),b=ae(h.value),x=h.value!==null?h.value:d;if(!n)n=g;else if(g!==n)return[new M(h.key,x,"".concat(g," stop domain type must match previous stop domain type ").concat(n))];if(g!=="number"&&g!=="string"&&g!=="boolean")return[new M(h.key,x,"stop domain value must be a number, string, or boolean")];if(g!=="number"&&r!=="categorical"){let v="number expected, ".concat(g," found");return ht(e)&&r===void 0&&(v+='\\nIf you intended to use a categorical function, specify \`"type": "categorical"\`.'),[new M(h.key,x,v)]}return r==="categorical"&&g==="number"&&(!isFinite(b)||Math.floor(b)!==b)?[new M(h.key,x,"integer expected, found ".concat(b))]:r!=="categorical"&&g==="number"&&o!==void 0&&b<o?[new M(h.key,x,"stop domain values must appear in ascending order")]:(o=b,r==="categorical"&&b in i?[new M(h.key,x,"stop domain values must be unique")]:(i[b]=!0,[]))}function m(h){return h.validateSpec({key:h.key,value:h.value,valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec})}}function mr(t){let e=(t.expressionContext==="property"?Uu:jt)(Ut(t.value),t.valueSpec);if(e.result==="error")return e.value.map(n=>new M("".concat(t.key).concat(n.key),t.value,n.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new M(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!sn(r))return[new M(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!sn(r))return[new M(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!eo(r,["zoom","feature-state"]))return[new M(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Qi(r))return[new M(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hh(t){let e=t.value,r=t.key,n=j(e);return n!=="boolean"?[new M(r,e,"boolean expected, ".concat(n," found"))]:[]}function Xh(t){let e=t.key,r=t.value,n=j(r);return n!=="string"?[new M(e,r,"color expected, ".concat(n," found"))]:W.parse(String(r))?[]:[new M(e,r,'color expected, "'.concat(r,'" found'))]}function un(t){let e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(ae(r))===-1&&i.push(new M(e,r,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(n.values).indexOf(ae(r))===-1&&i.push(new M(e,r,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),i}function Ps(t){return xs(Ut(t.value))?mr(fr({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Zu(t)}function Zu(t){let e=t.value,r=t.key;if(j(e)!=="array")return[new M(r,e,"array expected, ".concat(j(e)," found"))];let n=t.styleSpec,i,o=[];if(e.length<1)return[new M(r,e,"filter array must have at least 1 element")];switch(o=o.concat(un({key:"".concat(r,"[0]"),value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),ae(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ae(e[1])==="$type"&&o.push(new M(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&o.push(new M(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(i=j(e[1]),i!=="string"&&o.push(new M("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found"))));for(let a=2;a<e.length;a++)i=j(e[a]),ae(e[1])==="$type"?o=o.concat(un({key:"".concat(r,"[").concat(a,"]"),value:e[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new M("".concat(r,"[").concat(a,"]"),e[a],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let a=1;a<e.length;a++)o=o.concat(Zu({key:"".concat(r,"[").concat(a,"]"),value:e[a],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=j(e[1]),e.length!==2?o.push(new M(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):i!=="string"&&o.push(new M("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found")));break}return o}function Wu(t,e){let r=t.key,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.value,s=t.objectKey,l=o["".concat(e,"_").concat(t.layerType)];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});let c=t.valueSpec||l[s];if(!c)return[new M(r,a,'unknown property "'.concat(s,'"'))];let p;if(j(a)==="string"&&ht(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new M(r,a,'"'.concat(s,'" does not support interpolation syntax\\n')+'Use an identity property function instead: \`{ "type": "identity", "property": '.concat(JSON.stringify(p[1])," }\`."))];let f=[];return t.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&f.push(new M(r,a,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&to(Ut(a))&&ae(a.type)==="identity"&&f.push(new M(r,a,'"text-font" does not support identity functions'))),f.concat(n({key:t.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:e,propertyKey:s}))}function Hu(t){return Wu(t,"paint")}function Xu(t){return Wu(t,"layout")}function Ku(t){let e=[],r=t.value,n=t.key,i=t.style,o=t.styleSpec;!r.type&&!r.ref&&e.push(new M(n,r,'either "type" or "ref" is required'));let a=ae(r.type),s=ae(r.ref);if(r.id){let l=ae(r.id);for(let u=0;u<t.arrayIndex;u++){let c=i.layers[u];ae(c.id)===l&&e.push(new M(n,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(c.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&e.push(new M(n,r[u],'"'.concat(u,'" is prohibited for ref layers')))});let l;i.layers.forEach(u=>{ae(u.id)===s&&(l=u)}),l?l.ref?e.push(new M(n,r.ref,"ref cannot reference another ref layer")):a=ae(l.type):e.push(new M(n,r.ref,'ref layer "'.concat(s,'" not found')))}else if(a!=="background")if(!r.source)e.push(new M(n,r,'missing required property "source"'));else{let l=i.sources&&i.sources[r.source],u=l&&ae(l.type);l?u==="vector"&&a==="raster"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a raster source'))):u!=="raster-dem"&&a==="hillshade"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u==="raster"&&a!=="raster"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a vector source'))):u==="vector"&&!r["source-layer"]?e.push(new M(n,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):u==="raster-dem"&&a!=="hillshade"?e.push(new M(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):a==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new M(n,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.'))):e.push(new M(n,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(ze({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(n,".type"),value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:Ps,layout(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Xu(fr({layerType:a},u))}}})},paint(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Hu(fr({layerType:a},u))}}})}}})),e}function $t(t){let e=t.value,r=t.key,n=j(e);return n!=="string"?[new M(r,e,"string expected, ".concat(n," found"))]:[]}function Kh(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",n=t.value,i=t.styleSpec,o=i.source_raster_dem,a=t.style,s=[],l=j(n);if(n===void 0)return s;if(l!=="object")return s.push(new M("source_raster_dem",n,"object expected, ".concat(l," found"))),s;let c=ae(n.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],f=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let y in n)!c&&p.includes(y)?s.push(new M(y,n[y],'In "'.concat(r,'": "').concat(y,'" is only valid when "encoding" is set to "custom". ').concat(f," encoding found"))):o[y]?s=s.concat(t.validateSpec({key:y,value:n[y],valueSpec:o[y],validateSpec:t.validateSpec,style:a,styleSpec:i})):s.push(new M(y,n[y],'unknown property "'.concat(y,'"')));return s}var Pu={promoteId:Yh};function Yu(t){let e=t.value,r=t.key,n=t.styleSpec,i=t.style,o=t.validateSpec;if(!e.type)return[new M(r,e,'"type" is required')];let a=ae(e.type),s;switch(a){case"vector":case"raster":return s=ze({key:r,value:e,valueSpec:n["source_".concat(a.replace("-","_"))],style:t.style,styleSpec:n,objectElementValidators:Pu,validateSpec:o}),s;case"raster-dem":return s=Kh({sourceName:r,value:e,style:t.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=ze({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:Pu}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...mr({key:"".concat(r,".").concat(l,".map"),value:c,validateSpec:o,expressionContext:"cluster-map"})),s.push(...mr({key:"".concat(r,".").concat(l,".reduce"),value:p,validateSpec:o,expressionContext:"cluster-reduce"}))}return s;case"video":return ze({key:r,value:e,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return ze({key:r,value:e,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new M(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return un({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:o,styleSpec:n})}}function Yh({key:t,value:e}){if(j(e)==="string")return $t({key:t,value:e});{let r=[];for(let n in e)r.push(...$t({key:"".concat(t,".").concat(n),value:e[n]}));return r}}function Qu(t){let e=t.value,r=t.styleSpec,n=r.light,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new M("light",e,"object expected, ".concat(a," found"))]),o;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:r.transition,validateSpec:t.validateSpec,style:i,styleSpec:r})):n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))])}return o}function ec(t){let e=t.value,r=t.styleSpec,n=r.sky,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new M("sky",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return a}function tc(t){let e=t.value,r=t.styleSpec,n=r.terrain,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new M("terrain",e,"object expected, ".concat(a," found"))]),o;for(let s in e)n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return o}function Qh(t){return $t(t).length===0?[]:mr(t)}function ed(t){return $t(t).length===0?[]:mr(t)}function td(t){let e=t.key,r=t.value;if(j(r)==="array"){if(r.length<1||r.length>4)return[new M(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},o=[];for(let a=0;a<r.length;a++)o=o.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return o}else return vs({key:e,value:r,valueSpec:{}})}function rd(t){let e=t.key,r=t.value,n=j(r),i=t.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new M(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(un({key:"".concat(e,"[").concat(a,"]"),value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(bs({key:"".concat(e,"[").concat(a+1,"]"),value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:i}));return o}function rc(t){let e=[],r=t.value,n=t.key;if(Array.isArray(r)){let i=[],o=[];for(let a in r){r[a].id&&i.includes(r[a].id)&&e.push(new M(n,r,"all the sprites' ids must be unique, but ".concat(r[a].id," is duplicated"))),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&e.push(new M(n,r,"all the sprites' URLs must be unique, but ".concat(r[a].url," is duplicated"))),o.push(r[a].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(ze({key:"".concat(n,"[").concat(a,"]"),value:r[a],valueSpec:s,validateSpec:t.validateSpec}))}return e}else return $t({key:n,value:r})}function nd(t){let e=t.value,r=t.styleSpec,n=r.projection,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new M("projection",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return a}var Su={"*"(){return[]},array:bs,boolean:Hh,number:vs,color:Xh,constants:ju,enum:un,filter:Ps,function:Ju,layer:Ku,object:ze,source:Yu,light:Qu,sky:ec,terrain:tc,projection:nd,string:$t,formatted:Qh,resolvedImage:ed,padding:td,variableAnchorOffsetCollection:rd,sprite:rc};function Xr(t){let e=t.value,r=t.valueSpec,n=t.styleSpec;return t.validateSpec=Xr,r.expression&&to(ae(e))?Ju(t):r.expression&&qt(Ut(e))?mr(t):r.type&&Su[r.type]?Su[r.type](t):ze(fr({},t,{valueSpec:r.type?n[r.type]:r}))}function nc(t){let e=t.value,r=t.key,n=$t(t);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new M(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new M(r,e,'"glyphs" url must include a "{range}" token'))),n}function Ue(t,e=S){let r=[];return r=r.concat(Xr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Xr,objectElementValidators:{glyphs:nc,"*"(){return[]}}})),t.constants&&(r=r.concat(ju({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:Xr}))),ic(r)}Ue.source=Qe(Ye(Yu));Ue.sprite=Qe(Ye(rc));Ue.glyphs=Qe(Ye(nc));Ue.light=Qe(Ye(Qu));Ue.sky=Qe(Ye(ec));Ue.terrain=Qe(Ye(tc));Ue.layer=Qe(Ye(Ku));Ue.filter=Qe(Ye(Ps));Ue.paintProperty=Qe(Ye(Hu));Ue.layoutProperty=Qe(Ye(Xu));function Ye(t){return function(e){return t(Ci(Dt({},e),{validateSpec:Xr}))}}function ic(t){return[].concat(t).sort((e,r)=>e.line-r.line)}function Qe(t){return function(...e){return ic(t.apply(this,e))}}var oc="AbortError";function ac(t){return t.message===oc}function Ss(){return new Error(oc)}var ro={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function sc(t){return ro.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}function lc(t,e){ro.REGISTERED_PROTOCOLS[t]=e}function uc(t){delete ro.REGISTERED_PROTOCOLS[t]}var cc="global-dispatcher",br=class extends Error{constructor(e,r,n,i){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=r,this.url=n,this.body=i}},fc=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,id=t=>/^file:/.test(t)||/^file:/.test(fc())&&!/^\\w+:/.test(t);async function od(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:fc(),signal:e.signal});t.type==="json"&&r.headers.set("Accept","application/json");let n=await fetch(r);if(!n.ok){let a=await n.blob();throw new br(n.status,n.statusText,t.url,a)}let i;t.type==="arrayBuffer"||t.type==="image"?i=n.arrayBuffer():t.type==="json"?i=n.json():i=n.text();let o=await i;if(e.signal.aborted)throw Ss();return{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function ad(t,e){return new Promise((r,n)=>{let i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(i.responseType="arraybuffer");for(let o in t.headers)i.setRequestHeader(o,t.headers[o]);t.type==="json"&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials=t.credentials==="include",i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if(!e.signal.aborted)if((i.status>=200&&i.status<300||i.status===0)&&i.response!==null){let o=i.response;if(t.type==="json")try{o=JSON.parse(i.response)}catch(a){n(a);return}r({data:o,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")})}else{let o=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});n(new br(i.status,i.statusText,t.url,o))}},e.signal.addEventListener("abort",()=>{i.abort(),n(Ss())}),i.send(t.body)})}var yc=function(t,e){if(/:\\/\\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=sc(t.url);if(r)return r(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:cc},e)}if(!id(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return od(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:cc},e)}return ad(t,e)},mc=(t,e)=>yc(Pe(t,{type:"json"}),e),hc=(t,e)=>yc(Pe(t,{type:"arrayBuffer"}),e);var xt={};function C(t,e,r={}){if(xt[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),xt[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}C("Object",Object);C("TransferableGridIndex",Vt);C("Color",W);C("Error",Error);C("AJAXError",br);C("ResolvedImage",Te);C("StylePropertyFunction",ln);C("StyleExpression",Nt,{omit:["_evaluator"]});C("ZoomDependentExpression",gt);C("ZoomConstantExpression",dt);C("CompoundExpression",Ke,{omit:["_evaluate"]});for(let t in Gt)Gt[t]._classRegistryKey||C("Expression_".concat(t),Gt[t]);function dc(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function vr(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(dc(t)||Jr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){let r=t;return e&&e.push(r.buffer),r}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){let r=[];for(let n of t)r.push(vr(n,e));return r}if(typeof t=="object"){let r=t.constructor,n=r._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class ".concat(r.name));if(!xt[n])throw new Error("".concat(n," is not registered."));let i=r.serialize?r.serialize(t,e):{};if(r.serialize){if(e&&i===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let o in t){if(!t.hasOwnProperty(o)||xt[n].omit.indexOf(o)>=0)continue;let a=t[o];i[o]=xt[n].shallow.indexOf(o)>=0?a:vr(a,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(i.$name=n),i}throw new Error("can't serialize object of type ".concat(typeof t))}function Pr(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||dc(t)||Jr(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Pr);if(typeof t=="object"){let e=t.$name||"Object";if(!xt[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=xt[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let n=Object.create(r.prototype);for(let i of Object.keys(t)){if(i==="$name")continue;let o=t[i];n[i]=xt[e].shallow.indexOf(i)>=0?o:Pr(o)}return n}throw new Error("can't deserialize object of type ".concat(typeof t))}var no=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};var io=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new no(()=>this.process()),this.subscription=tu(this.target,"message",n=>this.receive(n),!1),this.globalScope=at(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((n,i)=>{let o=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[o]={resolve:n,reject:i},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[o];let l={id:o,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let a=[],s=Ci(Dt({},e),{id:o,sourceMapId:this.mapId,origin:location.origin,data:vr(e.data,a)});this.target.postMessage(s,{transfer:a})})}receive(e){let r=e.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(at(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let o=this.resolveRejects[e];if(delete this.resolveRejects[e],!o)return;r.error?o.reject(Pr(r.error)):o.resolve(Pr(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let n=Pr(r.data),i=new AbortController;this.abortControllers[e]=i;try{let o=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(e,null,o)}catch(o){this.completeTask(e,o)}}completeTask(e,r,n){let i=[];delete this.abortControllers[e];let o={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?vr(r):null,data:vr(n,i)};this.target.postMessage(o,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};function gc(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function ws(t,e,r){if(r&&r[t]){let n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}var oo=class{constructor(e,r={}){Pe(this,r),this.type=e}},mn=class extends oo{constructor(e,r={}){super("error",Pe({error:e},r))}},ao=class{on(e,r){return this._listeners=this._listeners||{},gc(e,r,this._listeners),this}off(e,r){return ws(e,r,this._listeners),ws(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},gc(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new oo(e,r||{}));let n=e.type;if(this.listens(n)){e.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,e);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of o)ws(n,s,this._oneTimeListeners),s.call(this,e);let a=this._eventedParent;a&&(Pe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(e))}else e instanceof mn&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};var bt=Ue,tv=bt.source,rv=bt.light,nv=bt.terrain,iv=bt.filter,xc=bt.paintProperty,bc=bt.layoutProperty;function vc(t,e){let r=!1;if(e&&e.length)for(let n of e)t.fire(new mn(new Error(n.message))),r=!0;return r}var so=class{constructor(){this.first=!0}update(e,r){let n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=n,!0):!1)}};var D={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function hn(t){for(let e of t)if(lo(e.charCodeAt(0)))return!0;return!1}function Pc(t){for(let e of t)if(!sd(e.charCodeAt(0)))return!1;return!0}function sd(t){return!(D.Arabic(t)||D["Arabic Supplement"](t)||D["Arabic Extended-A"](t)||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t))}function Sc(t){return t<11904?!1:!!(D["Bopomofo Extended"](t)||D.Bopomofo(t)||D["CJK Compatibility Forms"](t)||D["CJK Compatibility Ideographs"](t)||D["CJK Compatibility"](t)||D["CJK Radicals Supplement"](t)||D["CJK Strokes"](t)||D["CJK Symbols and Punctuation"](t)||D["CJK Unified Ideographs Extension A"](t)||D["CJK Unified Ideographs"](t)||D["Enclosed CJK Letters and Months"](t)||D["Halfwidth and Fullwidth Forms"](t)||D.Hiragana(t)||D["Ideographic Description Characters"](t)||D["Kangxi Radicals"](t)||D["Katakana Phonetic Extensions"](t)||D.Katakana(t)||D["Vertical Forms"](t)||D["Yi Radicals"](t)||D["Yi Syllables"](t))}function lo(t){return t===746||t===747?!0:t<4352?!1:!!(D["Bopomofo Extended"](t)||D.Bopomofo(t)||D["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||D["CJK Compatibility Ideographs"](t)||D["CJK Compatibility"](t)||D["CJK Radicals Supplement"](t)||D["CJK Strokes"](t)||D["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||D["CJK Unified Ideographs Extension A"](t)||D["CJK Unified Ideographs"](t)||D["Enclosed CJK Letters and Months"](t)||D["Hangul Compatibility Jamo"](t)||D["Hangul Jamo Extended-A"](t)||D["Hangul Jamo Extended-B"](t)||D["Hangul Jamo"](t)||D["Hangul Syllables"](t)||D.Hiragana(t)||D["Ideographic Description Characters"](t)||D.Kanbun(t)||D["Kangxi Radicals"](t)||D["Katakana Phonetic Extensions"](t)||D.Katakana(t)&&t!==12540||D["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||D["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||D["Unified Canadian Aboriginal Syllabics"](t)||D["Unified Canadian Aboriginal Syllabics Extended"](t)||D["Vertical Forms"](t)||D["Yijing Hexagram Symbols"](t)||D["Yi Syllables"](t)||D["Yi Radicals"](t))}function ld(t){return!!(D["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||D["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||D["Letterlike Symbols"](t)||D["Number Forms"](t)||D["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||D["Control Pictures"](t)&&t!==9251||D["Optical Character Recognition"](t)||D["Enclosed Alphanumerics"](t)||D["Geometric Shapes"](t)||D["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||D["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||D["CJK Symbols and Punctuation"](t)||D.Katakana(t)||D["Private Use Area"](t)||D["CJK Compatibility Forms"](t)||D["Small Form Variants"](t)||D["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}function As(t){return!(lo(t)||ld(t))}function wc(t){return D.Arabic(t)||D["Arabic Supplement"](t)||D["Arabic Extended-A"](t)||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t)}function Ac(t){return t>=1424&&t<=2303||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t)}function ud(t,e){return!(!e&&Ac(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||D.Khmer(t))}function _c(t){for(let e of t)if(Ac(e.charCodeAt(0)))return!0;return!1}function Ic(t,e){for(let r of t)if(!ud(r.charCodeAt(0),e))return!1;return!0}var _s=class{constructor(){this.applyArabicShaping=null;this.processBidirectionalText=null;this.processStyledBidirectionalText=null;this.pluginStatus="unavailable";this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}},ye=new _s;var q=class{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new so,this.transition={})}isSupportedScript(e){return Ic(e,ye.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}};var Sr=class{constructor(e,r){this.property=e,this.value=r,this.expression=$u(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}},dn=class{constructor(e){this.property=e,this.value=new Sr(e,void 0)}transitioned(e,r){return new co(this.property,this.value,r,Pe({},e.transition,this.transition),e.now)}untransitioned(){return new co(this.property,this.value,null,{},0)}},uo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return nt(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].value=new Sr(this._values[e].property,r===null?void 0:nt(r))}getTransition(e){return nt(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].transition=nt(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n);let i=this.getTransition(r);i!==void 0&&(e["".concat(r,"-transition")]=i)}return e}transitioned(e,r){let n=new po(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,r._values[i]);return n}untransitioned(){let e=new po(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}},co=class{constructor(e,r,n,i,o){this.property=e,this.value=r,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(e,r,n){let i=e.now||0,o=this.value.possiblyEvaluate(e,r,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(e,r,n);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,r,n),o,Wl(s))}}else return o}},po=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}},fo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return nt(this._values[e].value)}setValue(e,r){this._values[e]=new Sr(this._values[e].property,r===null?void 0:nt(r))}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n)}return e}possiblyEvaluate(e,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}},Se=class{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,i){return this.property.evaluate(this.value,this.parameters,e,r,n,i)}},vt=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}},B=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,n){let i=this.specification.type,o=Oe[i];return o?o(e,r,n):e}},R=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,i){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Se(this,{kind:"constant",value:e.expression.evaluate(r,null,{},n,i)},r):new Se(this,e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Se(this,{kind:"constant",value:void 0},e.parameters);let i=this.specification.type,o=Oe[i];if(o){let a=o(e.value.value,r.value.value,n);return new Se(this,{kind:"constant",value:a},e.parameters)}else return e}evaluate(e,r,n,i,o,a){return e.kind==="constant"?e.value:e.evaluate(r,n,i,o,a)}},lt=class extends R{possiblyEvaluate(e,r,n,i){if(e.value===void 0)return new Se(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i),s=e.property.specification.type==="resolvedImage"&&typeof o!="string"?o.name:o,l=this._calculate(s,s,s,r);return new Se(this,{kind:"constant",value:l},r)}else if(e.expression.kind==="camera"){let o=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new Se(this,{kind:"constant",value:o},r)}else return new Se(this,e.expression,r)}evaluate(e,r,n,i,o,a){if(e.kind==="source"){let s=e.evaluate(r,n,i,o,a);return this._calculate(s,s,s,r)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},n,i),e.evaluate({zoom:Math.floor(r.zoom)},n,i),e.evaluate({zoom:Math.floor(r.zoom)+1},n,i),r):e.value}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},Jt=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){if(e.value!==void 0)if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i);return this._calculate(o,o,o,r)}else return this._calculate(e.expression.evaluate(new q(Math.floor(r.zoom-1),r)),e.expression.evaluate(new q(Math.floor(r.zoom),r)),e.expression.evaluate(new q(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},Zt=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){return!!e.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},re=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let n=e[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new Sr(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new dn(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};C("DataDrivenProperty",R);C("DataConstantProperty",B);C("CrossFadedDataDrivenProperty",lt);C("CrossFadedProperty",Jt);C("ColorRampProperty",Zt);var yo="-transition",se=class extends ao{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new fo(r.layout)),r.paint)){this._transitionablePaint=new uo(r.paint);for(let n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(let n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vt(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".layout.").concat(e);if(this._validate(bc,i,e,r,n))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(yo)?this._transitionablePaint.getTransition(e.slice(0,-yo.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".paint.").concat(e);if(this._validate(xc,i,e,r,n))return!1}if(e.endsWith(yo))return this._transitionablePaint.setTransition(e.slice(0,-yo.length),r||void 0),!1;{let i=this._transitionablePaint._values[e],o=i.property.specification["property-type"]==="cross-faded-data-driven",a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Kl(e,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,i,o={}){return o&&o.validate===!1?!1:vc(this,e.call(bt,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:S,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof Se)||!ht(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};var cd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pt=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},pd=128,fd=5,ee=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*fd),pd),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Y(t,e=1){let r=0,n=0,i=t.map(a=>{let s=yd(a.type),l=r=Tc(r,Math.max(e,s)),u=a.components||1;return n=Math.max(n,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:l}}),o=Tc(r,Math.max(n,e));return{members:i,size:o,alignment:e}}function yd(t){return cd[t].BYTES_PER_ELEMENT}function Tc(t,e){return Math.ceil(t/e)*e}var Cc=Z(he(),1),Wt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.int16[i+0]=r,this.int16[i+1]=n,e}};Wt.prototype.bytesPerElement=4;C("StructArrayLayout2i4",Wt);var gn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,e}};gn.prototype.bytesPerElement=6;C("StructArrayLayout3i6",gn);var mo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=o,e}};mo.prototype.bytesPerElement=8;C("StructArrayLayout4i8",mo);var xn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};xn.prototype.bytesPerElement=12;C("StructArrayLayout2i4i12",xn);var bn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*4,u=e*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=o,this.uint8[u+6]=a,this.uint8[u+7]=s,e}};bn.prototype.bytesPerElement=8;C("StructArrayLayout2i4ub8",bn);var St=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.float32[i+0]=r,this.float32[i+1]=n,e}};St.prototype.bytesPerElement=8;C("StructArrayLayout2f8",St);var vn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,n,i,o,a,s,l,u,c)}emplace(e,r,n,i,o,a,s,l,u,c,p){let f=e*10;return this.uint16[f+0]=r,this.uint16[f+1]=n,this.uint16[f+2]=i,this.uint16[f+3]=o,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=l,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=p,e}};vn.prototype.bytesPerElement=20;C("StructArrayLayout10ui20",vn);var Pn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f){let y=this.length;return this.resize(y+1),this.emplace(y,e,r,n,i,o,a,s,l,u,c,p,f)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y){let m=e*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=o,this.uint16[m+4]=a,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=p,this.int16[m+10]=f,this.int16[m+11]=y,e}};Pn.prototype.bytesPerElement=24;C("StructArrayLayout4i4ui4i24",Pn);var Sn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}};Sn.prototype.bytesPerElement=12;C("StructArrayLayout3f12",Sn);var wn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint32[n+0]=r,e}};wn.prototype.bytesPerElement=4;C("StructArrayLayout1ul4",wn);var An=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,i,o,a,s,l,u)}emplace(e,r,n,i,o,a,s,l,u,c){let p=e*10,f=e*5;return this.int16[p+0]=r,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=o,this.int16[p+4]=a,this.int16[p+5]=s,this.uint32[f+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,e}};An.prototype.bytesPerElement=20;C("StructArrayLayout6i1ul2ui20",An);var _n=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};_n.prototype.bytesPerElement=12;C("StructArrayLayout2i2i2i12",_n);var ho=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,n,i,o)}emplace(e,r,n,i,o,a){let s=e*4,l=e*8;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[l+6]=o,this.int16[l+7]=a,e}};ho.prototype.bytesPerElement=16;C("StructArrayLayout2f1f2i16",ho);var In=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*12,s=e*3;return this.uint8[a+0]=r,this.uint8[a+1]=n,this.float32[s+1]=i,this.float32[s+2]=o,e}};In.prototype.bytesPerElement=12;C("StructArrayLayout2ub2f12",In);var Tn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.uint16[o+0]=r,this.uint16[o+1]=n,this.uint16[o+2]=i,e}};Tn.prototype.bytesPerElement=6;C("StructArrayLayout3ui6",Tn);var Cn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g){let b=this.length;return this.resize(b+1),this.emplace(b,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b){let x=e*24,v=e*12,P=e*48;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=i,this.uint16[x+3]=o,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=l,this.uint16[x+10]=u,this.uint16[x+11]=c,this.uint16[x+12]=p,this.float32[v+7]=f,this.float32[v+8]=y,this.uint8[P+36]=m,this.uint8[P+37]=h,this.uint8[P+38]=d,this.uint32[v+10]=g,this.int16[x+22]=b,e}};Cn.prototype.bytesPerElement=48;C("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Cn);var kn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k){let V=this.length;return this.resize(V+1),this.emplace(V,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V){let A=e*32,z=e*16;return this.int16[A+0]=r,this.int16[A+1]=n,this.int16[A+2]=i,this.int16[A+3]=o,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=l,this.int16[A+7]=u,this.uint16[A+8]=c,this.uint16[A+9]=p,this.uint16[A+10]=f,this.uint16[A+11]=y,this.uint16[A+12]=m,this.uint16[A+13]=h,this.uint16[A+14]=d,this.uint16[A+15]=g,this.uint16[A+16]=b,this.uint16[A+17]=x,this.uint16[A+18]=v,this.uint16[A+19]=P,this.uint16[A+20]=w,this.uint16[A+21]=T,this.uint16[A+22]=F,this.uint32[z+12]=E,this.float32[z+13]=_,this.float32[z+14]=I,this.uint16[A+30]=k,this.uint16[A+31]=V,e}};kn.prototype.bytesPerElement=64;C("StructArrayLayout8i15ui1ul2f2ui64",kn);var Ht=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.float32[n+0]=r,e}};Ht.prototype.bytesPerElement=4;C("StructArrayLayout1f4",Ht);var Mn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*6,a=e*3;return this.uint16[o+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,e}};Mn.prototype.bytesPerElement=12;C("StructArrayLayout1ui2f12",Mn);var En=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*2,a=e*4;return this.uint32[o+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,e}};En.prototype.bytesPerElement=8;C("StructArrayLayout1ul2ui8",En);var Fn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,e}};Fn.prototype.bytesPerElement=4;C("StructArrayLayout2ui4",Fn);var go=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint16[n+0]=r,e}};go.prototype.bytesPerElement=2;C("StructArrayLayout1ui2",go);var wr=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=o,e}};wr.prototype.bytesPerElement=16;C("StructArrayLayout4f16",wr);var xo=class extends Pt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Cc.default(this.anchorPointX,this.anchorPointY)}};xo.prototype.size=20;var Ln=class extends An{get(e){return new xo(this,e)}};C("CollisionBoxArray",Ln);var bo=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};bo.prototype.size=48;var Dn=class extends Cn{get(e){return new bo(this,e)}};C("PlacedSymbolArray",Dn);var vo=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};vo.prototype.size=64;var Vn=class extends kn{get(e){return new vo(this,e)}};C("SymbolInstanceArray",Vn);var Bn=class extends Ht{getoffsetX(e){return this.float32[e*1+0]}};C("GlyphOffsetArray",Bn);var zn=class extends gn{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};C("SymbolLineVertexArray",zn);var Po=class extends Pt{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};Po.prototype.size=12;var Rn=class extends Mn{get(e){return new Po(this,e)}};C("TextAnchorOffsetArray",Rn);var So=class extends Pt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};So.prototype.size=8;var On=class extends En{get(e){return new So(this,e)}};C("FeatureIndexArray",On);var wo=class extends Wt{};var Ao=class extends Wt{},_o=class extends Wt{},Io=class extends xn{};var To=class extends bn{},Co=class extends St{},ut=class extends vn{},ko=class extends Pn{},Mo=class extends Sn{},Eo=class extends wn{},Nn=class extends _n{};var Fo=class extends In{};var Le=class extends Tn{},wt=class extends Fn{};var md=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:kc,size:$v,alignment:Gv}=md;var me=class t{constructor(e=[]){this.segments=e}prepareSegment(e,r,n,i){let o=this.segments[this.segments.length-1];return e>t.MAX_VERTEX_ARRAY_LENGTH&&fe("Max vertices per segment is ".concat(t.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!o||o.vertexLength+e>t.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},i!==void 0&&(o.sortKey=i),this.segments.push(o)),o}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,i){return new t([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};me.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;C("SegmentVector",me);function Is(t,e){return t=it(Math.floor(t),0,255),e=it(Math.floor(e),0,255),256*t+e}var Un=Y([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Dc=Z(ks(),1);var $n=class t{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,i){this.ids.push(Lc(e)),this.positions.push(r,n,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=Lc(e),n=0,i=this.ids.length-1;for(;n<i;){let a=n+i>>1;this.ids[a]>=r?i=a:n=a+1}let o=[];for(;this.ids[n]===r;){let a=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];o.push({index:a,start:s,end:l}),n++}return o}static serialize(e,r){let n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return Ms(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){let r=new t;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};function Lc(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,Dc.default)(String(t))}function Ms(t,e,r,n){for(;r<n;){let i=t[r+n>>1],o=r-1,a=n+1;for(;;){do o++;while(t[o]<i);do a--;while(t[a]>i);if(o>=a)break;Do(t,o,a),Do(e,3*o,3*a),Do(e,3*o+1,3*a+1),Do(e,3*o+2,3*a+2)}a-r<n-a?(Ms(t,e,r,a),r=a+1):(Ms(t,e,a+1,n),n=a)}}function Do(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}C("FeaturePositionMap",$n);var Gn=class{constructor(e,r){this.gl=e.gl,this.location=r}};var Ar=class extends Gn{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};var Vo=class extends Gn{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}},Bo=class extends Gn{constructor(e,r){super(e,r),this.current=W.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}},i1=new Float32Array(16);function Es(t){return[Is(255*t.r,255*t.g),Is(255*t.b,255*t.a)]}var Xt=class{constructor(e,r,n){this.value=e,this.uniformNames=r.map(i=>"u_".concat(i)),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new Bo(e,r):new Ar(e,r)}},At=class{constructor(e,r){this.uniformNames=r.map(n=>"u_".concat(n)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,n,i){let o=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;o&&e.set(o)}getBinding(e,r,n){return n.substr(0,9)==="u_pattern"?new Vo(e,r):new Ar(e,r)}},We=class{constructor(e,r,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(o=>({name:"a_".concat(o),type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(e,r,n,i,o){let a=this.paintVertexArray.length,s=this.expression.evaluate(new q(0),r,{},i,[],o);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(e,r,o)}_setPaintValue(e,r,n){if(this.type==="color"){let i=Es(n);for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,i[0],i[1])}else{for(let i=e;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},De=class{constructor(e,r,n,i,o,a){this.expression=e,this.uniformNames=r.map(s=>"u_".concat(s,"_t")),this.type=n,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:"a_".concat(s),type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,r,n,i,o){let a=this.expression.evaluate(new q(this.zoom),r,{},i,[],o),s=this.expression.evaluate(new q(this.zoom+1),r,{},i,[],o),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,a,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(e,r,o,a)}_setPaintValue(e,r,n,i){if(this.type==="color"){let o=Es(n),a=Es(i);for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,o[0],o[1],a[0],a[1])}else{for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,i=it(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,r,n){return new Ar(e,r)}},et=class{constructor(e,r,n,i,o,a){this.expression=e,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(e,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,i,o){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(e,r,n,i){if(!i||!n)return;let{min:o,mid:a,max:s}=n,l=i[o],u=i[a],c=i[s];if(!(!l||!u||!c))for(let p=e;p<r;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Un.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Un.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},zo=class{constructor(e,r,n){this.binders={},this._buffers=[];let i=[];for(let o in e.paint._values){if(!n(o))continue;let a=e.paint.get(o);if(!(a instanceof Se)||!ht(a.property.specification))continue;let s=xd(o,e.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,p=a.property.specification["property-type"],f=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[o]=f?new At(l.value,s):new Xt(l.value,s,u),i.push("/u_".concat(o));else if(l.kind==="source"||f){let y=Vc(o,u,"source");this.binders[o]=f?new et(l,u,c,r,y,e.id):new We(l,s,u,y),i.push("/a_".concat(o))}else{let y=Vc(o,u,"composite");this.binders[o]=new De(l,s,u,c,r,y),i.push("/z_".concat(o))}}this.cacheKey=i.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof We||r instanceof De?r.maxValue:0}populatePaintArrays(e,r,n,i,o){for(let a in this.binders){let s=this.binders[a];(s instanceof We||s instanceof De||s instanceof et)&&s.populatePaintArray(e,r,n,i,o)}}setConstantPatternPositions(e,r){for(let n in this.binders){let i=this.binders[n];i instanceof At&&i.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,i,o){let a=!1;for(let s in e){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let p in this.binders){let f=this.binders[p];if((f instanceof We||f instanceof De||f instanceof et)&&f.expression.isStateDependent===!0){let y=i.paint.get(p);f.expression=y.value,f.updatePaintArray(u.start,u.end,c,e[s],o),a=!0}}}}return a}defines(){let e=[];for(let r in this.binders){let n=this.binders[r];(n instanceof Xt||n instanceof At)&&e.push(...n.uniformNames.map(i=>"#define HAS_UNIFORM_".concat(i)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof We||n instanceof De)for(let i=0;i<n.paintVertexAttributes.length;i++)e.push(n.paintVertexAttributes[i].name);else if(n instanceof et)for(let i=0;i<Un.members.length;i++)e.push(Un.members[i].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof Xt||n instanceof At||n instanceof De)for(let i of n.uniformNames)e.push(i)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let n=[];for(let i in this.binders){let o=this.binders[i];if(o instanceof Xt||o instanceof At||o instanceof De){for(let a of o.uniformNames)if(r[a]){let s=o.getBinding(e,r[a],a);n.push({name:a,property:i,binding:s})}}}return n}setUniforms(e,r,n,i){for(let{name:o,property:a,binding:s}of r)this.binders[a].setUniform(s,i,n.get(a),o)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(e&&n instanceof et){let i=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof We||n instanceof De)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let r in this.binders){let n=this.binders[r];(n instanceof We||n instanceof De||n instanceof et)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof We||r instanceof De||r instanceof et)&&r.destroy()}}},Ce=class{constructor(e,r,n=()=>!0){this.programConfigurations={};for(let i of e)this.programConfigurations[i.id]=new zo(i,r,n);this.needsUpload=!1,this._featureMap=new $n,this._bufferOffset=0}populatePaintArrays(e,r,n,i,o,a){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,r,i,o,a);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,i){for(let o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,r,o,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};function xd(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function bd(t){return{"line-pattern":{source:ut,composite:ut},"fill-pattern":{source:ut,composite:ut},"fill-extrusion-pattern":{source:ut,composite:ut}}[t]}function Vc(t,e,r){let n={color:{source:St,composite:wr},number:{source:Ht,composite:St}},i=bd(t);return i&&i[r]||n[e][r]}C("ConstantBinder",Xt);C("CrossFadedConstantBinder",At);C("SourceExpressionBinder",We);C("CrossFadedCompositeBinder",et);C("CompositeExpressionBinder",De);C("ProgramConfiguration",zo,{omit:["_buffers"]});C("ProgramConfigurationSet",Ce);var vd=15,Fs=Math.pow(2,vd-1)-1,Bc=-Fs-1;function ke(t){let e=8192/t.extent,r=t.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let a=i[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=it(s,Bc,Fs),a.y=it(l,Bc,Fs),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function $e(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ke(t):[]}}function Ro(t,e,r,n,i){t.emplaceBack(e*2+(n+1)/2,r*2+(i+1)/2)}var Kt=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ao,this.indexArray=new Le,this.segments=new me,this.programConfigurations=new Ce(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){let i=this.layers[0],o=[],a=null,s=!1;i.type==="circle"&&(a=i.layout.get("circle-sort-key"),s=!a.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let f=this.layers[0]._featureFilter.needGeometry,y=$e(l,f);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),y,n))continue;let m=s?a.evaluate(y,{},n):void 0,h={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:f?y.geometry:ke(l),patterns:{},sortKey:m};o.push(h)}s&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l,f=e[c].feature;this.addFeature(l,u,c,n),r.featureIndex.insert(f,u,c,p,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,i){for(let o of r)for(let a of o){let s=a.x,l=a.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),c=u.vertexLength;Ro(this.layoutVertexArray,s,l,-1,-1),Ro(this.layoutVertexArray,s,l,1,-1),Ro(this.layoutVertexArray,s,l,1,1),Ro(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i)}};C("CircleBucket",Kt,{omit:["layers"]});var qn=Z(he(),1);function Rc(t,e){for(let r=0;r<t.length;r++)if(_r(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(_r(t,e[r]))return!0;return!!Ds(t,e)}function Oc(t,e,r){return!!(_r(t,e)||Ls(e,t,r))}function Oo(t,e){if(t.length===1)return zc(e,t[0]);for(let r=0;r<e.length;r++){let n=e[r];for(let i=0;i<n.length;i++)if(_r(t,n[i]))return!0}for(let r=0;r<t.length;r++)if(zc(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Ds(t,e[r]))return!0;return!1}function Nc(t,e,r){for(let n=0;n<e.length;n++){let i=e[n];if(t.length>=3){for(let o=0;o<i.length;o++)if(_r(t,i[o]))return!0}if(Pd(t,i,r))return!0}return!1}function Pd(t,e,r){if(t.length>1){if(Ds(t,e))return!0;for(let n=0;n<e.length;n++)if(Ls(e[n],t,r))return!0}for(let n=0;n<t.length;n++)if(Ls(t[n],e,r))return!0;return!1}function Ds(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let n=t[r],i=t[r+1];for(let o=0;o<e.length-1;o++){let a=e[o],s=e[o+1];if(Sd(n,i,a,s))return!0}}return!1}function Sd(t,e,r,n){return ot(t,r,n)!==ot(e,r,n)&&ot(t,e,r)!==ot(t,e,n)}function Ls(t,e,r){let n=r*r;if(e.length===1)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++){let o=e[i-1],a=e[i];if(Vs(t,o,a)<n)return!0}return!1}function Vs(t,e,r){let n=e.distSqr(r);if(n===0)return t.distSqr(e);let i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function zc(t,e){let r=!1,n,i,o;for(let a=0;a<t.length;a++){n=t[a];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],o=n[l],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function _r(t,e){let r=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){let o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Uc(t,e,r,n,i){for(let a of t)if(e<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;let o=[new qn.default(e,r),new qn.default(e,i),new qn.default(n,i),new qn.default(n,r)];if(t.length>2){for(let a of o)if(_r(t,a))return!0}for(let a=0;a<t.length-1;a++){let s=t[a],l=t[a+1];if(wd(s,l,o))return!0}return!1}function wd(t,e,r){let n=r[0],i=r[2];if(t.x<n.x&&e.x<n.x||t.x>i.x&&e.x>i.x||t.y<n.y&&e.y<n.y||t.y>i.y&&e.y>i.y)return!1;let o=ot(t,e,r[0]);return o!==ot(t,e,r[1])||o!==ot(t,e,r[2])||o!==ot(t,e,r[3])}var No=Z(he(),1);function Yt(t,e,r){let n=e.paint.get(t).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(t)}function _t(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function It(t,e,r,n,i){if(!e[0]&&!e[1])return t;let o=No.default.convert(e)._mult(i);r==="viewport"&&o._rotate(-n);let a=[];for(let s=0;s<t.length;s++){let l=t[s];a.push(l.sub(o))}return a}function $c(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],o=[];for(let a=0;a<i.length;a++){let s=i[a-1],l=i[a],u=i[a+1],c=a===0?new No.default(0,0):l.sub(s)._unit()._perp(),p=a===i.length-1?new No.default(0,0):u.sub(l)._unit()._perp(),f=c._add(p)._unit(),y=f.x*p.x+f.y*p.y;y!==0&&f._mult(1/y),o.push(f._mult(e)._add(l))}r.push(o)}return r}var Gc,Ad=()=>Gc=Gc||new re({"circle-sort-key":new R(S.layout_circle["circle-sort-key"])}),qc,_d=()=>qc=qc||new re({"circle-radius":new R(S.paint_circle["circle-radius"]),"circle-color":new R(S.paint_circle["circle-color"]),"circle-blur":new R(S.paint_circle["circle-blur"]),"circle-opacity":new R(S.paint_circle["circle-opacity"]),"circle-translate":new B(S.paint_circle["circle-translate"]),"circle-translate-anchor":new B(S.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new B(S.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new B(S.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new R(S.paint_circle["circle-stroke-width"]),"circle-stroke-color":new R(S.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new R(S.paint_circle["circle-stroke-opacity"])}),jc={get paint(){return _d()},get layout(){return Ad()}};var Q=1e-6,Ge=typeof Float32Array<"u"?Float32Array:Array,jn=Math.random;var X1=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Jn={};Ol(Jn,{add:()=>ug,adjoint:()=>Ld,clone:()=>Td,copy:()=>Cd,create:()=>Id,determinant:()=>Dd,equals:()=>yg,exactEquals:()=>fg,frob:()=>lg,fromQuat:()=>Yd,fromQuat2:()=>Zd,fromRotation:()=>Gd,fromRotationTranslation:()=>Hc,fromRotationTranslationScale:()=>Xd,fromRotationTranslationScaleOrigin:()=>Kd,fromScaling:()=>$d,fromTranslation:()=>Ud,fromValues:()=>kd,fromXRotation:()=>qd,fromYRotation:()=>jd,fromZRotation:()=>Jd,frustum:()=>Qd,getRotation:()=>Hd,getScaling:()=>Xc,getTranslation:()=>Wd,identity:()=>Zc,invert:()=>Fd,lookAt:()=>og,mul:()=>mg,multiply:()=>Wc,multiplyScalar:()=>cg,multiplyScalarAndAdd:()=>pg,ortho:()=>ng,orthoNO:()=>Yc,orthoZO:()=>ig,perspective:()=>eg,perspectiveFromFieldOfView:()=>rg,perspectiveNO:()=>Kc,perspectiveZO:()=>tg,rotate:()=>zd,rotateX:()=>Rd,rotateY:()=>Od,rotateZ:()=>Nd,scale:()=>Bd,set:()=>Md,str:()=>sg,sub:()=>hg,subtract:()=>Qc,targetTo:()=>ag,translate:()=>Vd,transpose:()=>Ed});function Id(){var t=new Ge(16);return Ge!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Td(t){var e=new Ge(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Cd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function kd(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h){var d=new Ge(16);return d[0]=t,d[1]=e,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=a,d[7]=s,d[8]=l,d[9]=u,d[10]=c,d[11]=p,d[12]=f,d[13]=y,d[14]=m,d[15]=h,d}function Md(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=p,t[11]=f,t[12]=y,t[13]=m,t[14]=h,t[15]=d,t}function Zc(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ed(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Fd(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15],b=r*s-n*a,x=r*l-i*a,v=r*u-o*a,P=n*l-i*s,w=n*u-o*s,T=i*u-o*l,F=c*h-p*m,E=c*d-f*m,_=c*g-y*m,I=p*d-f*h,k=p*g-y*h,V=f*g-y*d,A=b*V-x*k+v*I+P*_-w*E+T*F;return A?(A=1/A,t[0]=(s*V-l*k+u*I)*A,t[1]=(i*k-n*V-o*I)*A,t[2]=(h*T-d*w+g*P)*A,t[3]=(f*w-p*T-y*P)*A,t[4]=(l*_-a*V-u*E)*A,t[5]=(r*V-i*_+o*E)*A,t[6]=(d*v-m*T-g*x)*A,t[7]=(c*T-f*v+y*x)*A,t[8]=(a*k-s*_+u*F)*A,t[9]=(n*_-r*k-o*F)*A,t[10]=(m*w-h*v+g*b)*A,t[11]=(p*v-c*w-y*b)*A,t[12]=(s*E-a*I-l*F)*A,t[13]=(r*I-n*E+i*F)*A,t[14]=(h*x-m*P-d*b)*A,t[15]=(c*P-p*x+f*b)*A,t):null}function Ld(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15];return t[0]=s*(f*g-y*d)-p*(l*g-u*d)+h*(l*y-u*f),t[1]=-(n*(f*g-y*d)-p*(i*g-o*d)+h*(i*y-o*f)),t[2]=n*(l*g-u*d)-s*(i*g-o*d)+h*(i*u-o*l),t[3]=-(n*(l*y-u*f)-s*(i*y-o*f)+p*(i*u-o*l)),t[4]=-(a*(f*g-y*d)-c*(l*g-u*d)+m*(l*y-u*f)),t[5]=r*(f*g-y*d)-c*(i*g-o*d)+m*(i*y-o*f),t[6]=-(r*(l*g-u*d)-a*(i*g-o*d)+m*(i*u-o*l)),t[7]=r*(l*y-u*f)-a*(i*y-o*f)+c*(i*u-o*l),t[8]=a*(p*g-y*h)-c*(s*g-u*h)+m*(s*y-u*p),t[9]=-(r*(p*g-y*h)-c*(n*g-o*h)+m*(n*y-o*p)),t[10]=r*(s*g-u*h)-a*(n*g-o*h)+m*(n*u-o*s),t[11]=-(r*(s*y-u*p)-a*(n*y-o*p)+c*(n*u-o*s)),t[12]=-(a*(p*d-f*h)-c*(s*d-l*h)+m*(s*f-l*p)),t[13]=r*(p*d-f*h)-c*(n*d-i*h)+m*(n*f-i*p),t[14]=-(r*(s*d-l*h)-a*(n*d-i*h)+m*(n*l-i*s)),t[15]=r*(s*f-l*p)-a*(n*f-i*p)+c*(n*l-i*s),t}function Dd(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],p=t[10],f=t[11],y=t[12],m=t[13],h=t[14],d=t[15],g=e*a-r*o,b=e*s-n*o,x=e*l-i*o,v=r*s-n*a,P=r*l-i*a,w=n*l-i*s,T=u*m-c*y,F=u*h-p*y,E=u*d-f*y,_=c*h-p*m,I=c*d-f*m,k=p*d-f*h;return g*k-b*I+x*_+v*E-P*F+w*T}function Wc(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],f=e[9],y=e[10],m=e[11],h=e[12],d=e[13],g=e[14],b=e[15],x=r[0],v=r[1],P=r[2],w=r[3];return t[0]=x*n+v*s+P*p+w*h,t[1]=x*i+v*l+P*f+w*d,t[2]=x*o+v*u+P*y+w*g,t[3]=x*a+v*c+P*m+w*b,x=r[4],v=r[5],P=r[6],w=r[7],t[4]=x*n+v*s+P*p+w*h,t[5]=x*i+v*l+P*f+w*d,t[6]=x*o+v*u+P*y+w*g,t[7]=x*a+v*c+P*m+w*b,x=r[8],v=r[9],P=r[10],w=r[11],t[8]=x*n+v*s+P*p+w*h,t[9]=x*i+v*l+P*f+w*d,t[10]=x*o+v*u+P*y+w*g,t[11]=x*a+v*c+P*m+w*b,x=r[12],v=r[13],P=r[14],w=r[15],t[12]=x*n+v*s+P*p+w*h,t[13]=x*i+v*l+P*f+w*d,t[14]=x*o+v*u+P*y+w*g,t[15]=x*a+v*c+P*m+w*b,t}function Vd(t,e,r){var n=r[0],i=r[1],o=r[2],a,s,l,u,c,p,f,y,m,h,d,g;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*o+e[12],t[13]=e[1]*n+e[5]*i+e[9]*o+e[13],t[14]=e[2]*n+e[6]*i+e[10]*o+e[14],t[15]=e[3]*n+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],l=e[2],u=e[3],c=e[4],p=e[5],f=e[6],y=e[7],m=e[8],h=e[9],d=e[10],g=e[11],t[0]=a,t[1]=s,t[2]=l,t[3]=u,t[4]=c,t[5]=p,t[6]=f,t[7]=y,t[8]=m,t[9]=h,t[10]=d,t[11]=g,t[12]=a*n+c*i+m*o+e[12],t[13]=s*n+p*i+h*o+e[13],t[14]=l*n+f*i+d*o+e[14],t[15]=u*n+y*i+g*o+e[15]),t}function Bd(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zd(t,e,r,n){var i=n[0],o=n[1],a=n[2],s=Math.hypot(i,o,a),l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V,A,z;return s<Q?null:(s=1/s,i*=s,o*=s,a*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,p=e[0],f=e[1],y=e[2],m=e[3],h=e[4],d=e[5],g=e[6],b=e[7],x=e[8],v=e[9],P=e[10],w=e[11],T=i*i*c+u,F=o*i*c+a*l,E=a*i*c-o*l,_=i*o*c-a*l,I=o*o*c+u,k=a*o*c+i*l,V=i*a*c+o*l,A=o*a*c-i*l,z=a*a*c+u,t[0]=p*T+h*F+x*E,t[1]=f*T+d*F+v*E,t[2]=y*T+g*F+P*E,t[3]=m*T+b*F+w*E,t[4]=p*_+h*I+x*k,t[5]=f*_+d*I+v*k,t[6]=y*_+g*I+P*k,t[7]=m*_+b*I+w*k,t[8]=p*V+h*A+x*z,t[9]=f*V+d*A+v*z,t[10]=y*V+g*A+P*z,t[11]=m*V+b*A+w*z,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Rd(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*n,t[5]=a*i+c*n,t[6]=s*i+p*n,t[7]=l*i+f*n,t[8]=u*i-o*n,t[9]=c*i-a*n,t[10]=p*i-s*n,t[11]=f*i-l*n,t}function Od(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],p=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*n,t[1]=a*i-c*n,t[2]=s*i-p*n,t[3]=l*i-f*n,t[8]=o*n+u*i,t[9]=a*n+c*i,t[10]=s*n+p*i,t[11]=l*n+f*i,t}function Nd(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*n,t[1]=a*i+c*n,t[2]=s*i+p*n,t[3]=l*i+f*n,t[4]=u*i-o*n,t[5]=c*i-a*n,t[6]=p*i-s*n,t[7]=f*i-l*n,t}function Ud(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function $d(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gd(t,e,r){var n=r[0],i=r[1],o=r[2],a=Math.hypot(n,i,o),s,l,u;return a<Q?null:(a=1/a,n*=a,i*=a,o*=a,s=Math.sin(e),l=Math.cos(e),u=1-l,t[0]=n*n*u+l,t[1]=i*n*u+o*s,t[2]=o*n*u-i*s,t[3]=0,t[4]=n*i*u-o*s,t[5]=i*i*u+l,t[6]=o*i*u+n*s,t[7]=0,t[8]=n*o*u+i*s,t[9]=i*o*u-n*s,t[10]=o*o*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function qd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hc(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=n+n,l=i+i,u=o+o,c=n*s,p=n*l,f=n*u,y=i*l,m=i*u,h=o*u,d=a*s,g=a*l,b=a*u;return t[0]=1-(y+h),t[1]=p+b,t[2]=f-g,t[3]=0,t[4]=p-b,t[5]=1-(c+h),t[6]=m+d,t[7]=0,t[8]=f+g,t[9]=m-d,t[10]=1-(c+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Zd(t,e){var r=new Ge(3),n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=n*n+i*i+o*o+a*a;return p>0?(r[0]=(s*a+c*n+l*o-u*i)*2/p,r[1]=(l*a+c*i+u*n-s*o)*2/p,r[2]=(u*a+c*o+s*i-l*n)*2/p):(r[0]=(s*a+c*n+l*o-u*i)*2,r[1]=(l*a+c*i+u*n-s*o)*2,r[2]=(u*a+c*o+s*i-l*n)*2),Hc(t,e,r),t}function Wd(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Xc(t,e){var r=e[0],n=e[1],i=e[2],o=e[4],a=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(l,u,c),t}function Hd(t,e){var r=new Ge(3);Xc(r,e);var n=1/r[0],i=1/r[1],o=1/r[2],a=e[0]*n,s=e[1]*i,l=e[2]*o,u=e[4]*n,c=e[5]*i,p=e[6]*o,f=e[8]*n,y=e[9]*i,m=e[10]*o,h=a+c+m,d=0;return h>0?(d=Math.sqrt(h+1)*2,t[3]=.25*d,t[0]=(p-y)/d,t[1]=(f-l)/d,t[2]=(s-u)/d):a>c&&a>m?(d=Math.sqrt(1+a-c-m)*2,t[3]=(p-y)/d,t[0]=.25*d,t[1]=(s+u)/d,t[2]=(f+l)/d):c>m?(d=Math.sqrt(1+c-a-m)*2,t[3]=(f-l)/d,t[0]=(s+u)/d,t[1]=.25*d,t[2]=(p+y)/d):(d=Math.sqrt(1+m-a-c)*2,t[3]=(s-u)/d,t[0]=(f+l)/d,t[1]=(p+y)/d,t[2]=.25*d),t}function Xd(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3],l=i+i,u=o+o,c=a+a,p=i*l,f=i*u,y=i*c,m=o*u,h=o*c,d=a*c,g=s*l,b=s*u,x=s*c,v=n[0],P=n[1],w=n[2];return t[0]=(1-(m+d))*v,t[1]=(f+x)*v,t[2]=(y-b)*v,t[3]=0,t[4]=(f-x)*P,t[5]=(1-(p+d))*P,t[6]=(h+g)*P,t[7]=0,t[8]=(y+b)*w,t[9]=(h-g)*w,t[10]=(1-(p+m))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Kd(t,e,r,n,i){var o=e[0],a=e[1],s=e[2],l=e[3],u=o+o,c=a+a,p=s+s,f=o*u,y=o*c,m=o*p,h=a*c,d=a*p,g=s*p,b=l*u,x=l*c,v=l*p,P=n[0],w=n[1],T=n[2],F=i[0],E=i[1],_=i[2],I=(1-(h+g))*P,k=(y+v)*P,V=(m-x)*P,A=(y-v)*w,z=(1-(f+g))*w,O=(d+b)*w,N=(m+x)*T,K=(d-b)*T,xe=(1-(f+h))*T;return t[0]=I,t[1]=k,t[2]=V,t[3]=0,t[4]=A,t[5]=z,t[6]=O,t[7]=0,t[8]=N,t[9]=K,t[10]=xe,t[11]=0,t[12]=r[0]+F-(I*F+A*E+N*_),t[13]=r[1]+E-(k*F+z*E+K*_),t[14]=r[2]+_-(V*F+O*E+xe*_),t[15]=1,t}function Yd(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,l=i+i,u=r*a,c=n*a,p=n*s,f=i*a,y=i*s,m=i*l,h=o*a,d=o*s,g=o*l;return t[0]=1-p-m,t[1]=c+g,t[2]=f-d,t[3]=0,t[4]=c-g,t[5]=1-u-m,t[6]=y+h,t[7]=0,t[8]=f+d,t[9]=y-h,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qd(t,e,r,n,i,o,a){var s=1/(r-e),l=1/(i-n),u=1/(o-a);return t[0]=o*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(a+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*u,t[15]=0,t}function Kc(t,e,r,n,i){var o=1/Math.tan(e/2),a;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var eg=Kc;function tg(t,e,r,n,i){var o=1/Math.tan(e/2),a;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function rg(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((a-s)*l*.5),t[9]=(i-o)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Yc(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(a+o)*u,t[15]=1,t}var ng=Yc;function ig(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=o*u,t[15]=1,t}function og(t,e,r,n){var i,o,a,s,l,u,c,p,f,y,m=e[0],h=e[1],d=e[2],g=n[0],b=n[1],x=n[2],v=r[0],P=r[1],w=r[2];return Math.abs(m-v)<Q&&Math.abs(h-P)<Q&&Math.abs(d-w)<Q?Zc(t):(c=m-v,p=h-P,f=d-w,y=1/Math.hypot(c,p,f),c*=y,p*=y,f*=y,i=b*f-x*p,o=x*c-g*f,a=g*p-b*c,y=Math.hypot(i,o,a),y?(y=1/y,i*=y,o*=y,a*=y):(i=0,o=0,a=0),s=p*a-f*o,l=f*i-c*a,u=c*o-p*i,y=Math.hypot(s,l,u),y?(y=1/y,s*=y,l*=y,u*=y):(s=0,l=0,u=0),t[0]=i,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=p,t[7]=0,t[8]=a,t[9]=u,t[10]=f,t[11]=0,t[12]=-(i*m+o*h+a*d),t[13]=-(s*m+l*h+u*d),t[14]=-(c*m+p*h+f*d),t[15]=1,t)}function ag(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=n[0],l=n[1],u=n[2],c=i-r[0],p=o-r[1],f=a-r[2],y=c*c+p*p+f*f;y>0&&(y=1/Math.sqrt(y),c*=y,p*=y,f*=y);var m=l*f-u*p,h=u*c-s*f,d=s*p-l*c;return y=m*m+h*h+d*d,y>0&&(y=1/Math.sqrt(y),m*=y,h*=y,d*=y),t[0]=m,t[1]=h,t[2]=d,t[3]=0,t[4]=p*d-f*h,t[5]=f*m-c*d,t[6]=c*h-p*m,t[7]=0,t[8]=c,t[9]=p,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function sg(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function lg(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ug(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Qc(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function cg(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function pg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function fg(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function yg(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15],b=e[0],x=e[1],v=e[2],P=e[3],w=e[4],T=e[5],F=e[6],E=e[7],_=e[8],I=e[9],k=e[10],V=e[11],A=e[12],z=e[13],O=e[14],N=e[15];return Math.abs(r-b)<=Q*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=Q*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-v)<=Q*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-P)<=Q*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-w)<=Q*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-T)<=Q*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-F)<=Q*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(u-E)<=Q*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-_)<=Q*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(p-I)<=Q*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-k)<=Q*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(y-V)<=Q*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(m-A)<=Q*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(h-z)<=Q*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(d-O)<=Q*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-N)<=Q*Math.max(1,Math.abs(g),Math.abs(N))}var mg=Wc,hg=Qc;var Qt={};Ol(Qt,{add:()=>vg,ceil:()=>Pg,clone:()=>dg,copy:()=>xg,create:()=>ep,cross:()=>Fg,dist:()=>qg,distance:()=>ip,div:()=>Gg,divide:()=>np,dot:()=>Eg,equals:()=>Ng,exactEquals:()=>Og,floor:()=>Sg,forEach:()=>Wg,fromValues:()=>gg,inverse:()=>kg,len:()=>Jg,length:()=>ap,lerp:()=>Lg,max:()=>Ag,min:()=>wg,mul:()=>$g,multiply:()=>rp,negate:()=>Cg,normalize:()=>Mg,random:()=>Dg,round:()=>_g,scale:()=>Ig,scaleAndAdd:()=>Tg,set:()=>bg,sqrDist:()=>jg,sqrLen:()=>Zg,squaredDistance:()=>op,squaredLength:()=>sp,str:()=>Rg,sub:()=>Ug,subtract:()=>tp,transformMat4:()=>Vg,transformQuat:()=>Bg,zero:()=>zg});function ep(){var t=new Ge(4);return Ge!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function dg(t){var e=new Ge(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function gg(t,e,r,n){var i=new Ge(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function xg(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function bg(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function vg(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function tp(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function rp(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function np(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Pg(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Sg(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function wg(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Ag(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function _g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Ig(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Tg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function ip(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(r,n,i,o)}function op(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}function ap(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function sp(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function Cg(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function kg(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Mg(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a,t}function Eg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Fg(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=e[0],p=e[1],f=e[2],y=e[3];return t[0]=p*u-f*l+y*s,t[1]=-(c*u)+f*a-y*o,t[2]=c*l-p*a+y*i,t[3]=-(c*s)+p*o-f*i,t}function Lg(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=s+n*(r[3]-s),t}function Dg(t,e){e=e||1;var r,n,i,o,a,s;do r=jn()*2-1,n=jn()*2-1,a=r*r+n*n;while(a>=1);do i=jn()*2-1,o=jn()*2-1,s=i*i+o*o;while(s>=1);var l=Math.sqrt((1-a)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*l,t[3]=e*o*l,t}function Vg(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}function Bg(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,p=u*i+l*n-a*o,f=u*o+a*i-s*n,y=-a*n-s*i-l*o;return t[0]=c*u+y*-a+p*-l-f*-s,t[1]=p*u+y*-s+f*-a-c*-l,t[2]=f*u+y*-l+c*-s-p*-a,t[3]=e[3],t}function zg(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Rg(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Og(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Ng(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(r-a)<=Q*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Q*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Q*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=Q*Math.max(1,Math.abs(o),Math.abs(u))}var Ug=tp,$g=rp,Gg=np,qg=ip,jg=op,Jg=ap,Zg=sp,Wg=function(){var t=ep();return function(e,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();var lp=Z(he(),1),Uo=class extends se{constructor(e){super(e,jc)}createBucket(e){return new Kt(e)}queryRadius(e){let r=e;return Yt("circle-radius",this,r)+Yt("circle-stroke-width",this,r)+_t(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s,l){let u=It(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(r,n),p=this.paint.get("circle-stroke-width").evaluate(r,n),f=c+p,y=this.paint.get("circle-pitch-alignment")==="map",m=y?u:Hg(u,l),h=y?f*s:f;for(let d of i)for(let g of d){let b=y?g:up(g,l),x=h,v=Qt.transformMat4([],[g.x,g.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?x*=v[3]/a.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(x*=a.cameraToCenterDistance/v[3]),Oc(m,b,x))return!0}return!1}};function up(t,e){let r=Qt.transformMat4([],[t.x,t.y,0,1],e);return new lp.default(r[0]/r[3],r[1]/r[3])}function Hg(t,e){return t.map(r=>up(r,e))}var Zn=class extends Kt{};C("HeatmapBucket",Zn,{omit:["layers"]});var cp,Xg=()=>cp=cp||new re({"heatmap-radius":new R(S.paint_heatmap["heatmap-radius"]),"heatmap-weight":new R(S.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new B(S.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zt(S.paint_heatmap["heatmap-color"]),"heatmap-opacity":new B(S.paint_heatmap["heatmap-opacity"])}),pp={get paint(){return Xg()}};function Bs(t,{width:e,height:r},n,i){if(!i)i=new Uint8Array(e*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*r*n)throw new RangeError("mismatched image size. expected: ".concat(i.length," but got: ").concat(e*r*n));return t.width=e,t.height=r,t.data=i,t}function fp(t,{width:e,height:r},n){if(e===t.width&&r===t.height)return;let i=Bs({},{width:e,height:r},n);zs(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},n),t.width=e,t.height=r,t.data=i.data}function zs(t,e,r,n,i,o){if(i.width===0||i.height===0)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let a=t.data,s=e.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*t.width+r.x)*o,c=((n.y+l)*e.width+n.x)*o;for(let p=0;p<i.width*o;p++)s[c+p]=a[u+p]}return e}var er=class t{constructor(e,r){Bs(this,e,1,r)}resize(e){fp(this,e,1)}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){zs(e,r,n,i,o,1)}},de=class t{constructor(e,r){Bs(this,e,4,r)}resize(e){fp(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){zs(e,r,n,i,o,4)}};C("AlphaImage",er);C("RGBAImage",de);function yp(t){let e={},r=t.resolution||256,n=t.clips?t.clips.length:1,i=t.image||new de({width:r,height:n});if(!Xl(r))throw new Error("width is not a power of 2 - ".concat(r));let o=(a,s,l)=>{e[t.evaluationKey]=l;let u=t.expression.evaluate(e);i.data[a+s+0]=Math.floor(u.r*255/u.a),i.data[a+s+1]=Math.floor(u.g*255/u.a),i.data[a+s+2]=Math.floor(u.b*255/u.a),i.data[a+s+3]=Math.floor(u.a*255)};if(t.clips)for(let a=0,s=0;a<n;++a,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:p,end:f}=t.clips[a],y=p*(1-c)+f*c;o(s,u,y)}else for(let a=0,s=0;a<r;a++,s+=4){let l=a/(r-1);o(0,s,l)}return i}var $o=class extends se{createBucket(e){return new Zn(e)}constructor(e){super(e,pp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=yp({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};var mp,Kg=()=>mp=mp||new re({"hillshade-illumination-direction":new B(S.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new B(S.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new B(S.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new B(S.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new B(S.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new B(S.paint_hillshade["hillshade-accent-color"])}),hp={get paint(){return Kg()}};var Go=class extends se{constructor(e){super(e,hp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};var Yg=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:dp,size:GP,alignment:qP}=Yg;var Sp=Z($s(),1);function Gs(t,e,r,n,i){Pp(t,e,r||0,n||t.length-1,i||mx)}function Pp(t,e,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(e-a*l/o+u)),p=Math.min(n,Math.floor(e+(o-a)*l/o+u));Pp(t,e,c,p,i)}var f=t[e],y=r,m=n;for(Kn(t,r,e),i(t[n],f)>0&&Kn(t,r,n);y<m;){for(Kn(t,y,m),y++,m--;i(t[y],f)<0;)y++;for(;i(t[m],f)>0;)m--}i(t[r],f)===0?Kn(t,r,m):(m++,Kn(t,m,n)),m<=e&&(r=m+1),e<=m&&(n=m-1)}}function Kn(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function mx(t,e){return t<e?-1:t>e?1:0}function Tr(t,e){let r=t.length;if(r<=1)return[t];let n=[],i,o;for(let a=0;a<r;a++){let s=Ql(t[a]);s!==0&&(t[a].area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[t[a]]):i.push(t[a]))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(Gs(n[a],e,1,n[a].length-1,hx),n[a]=n[a].slice(0,e));return n}function hx(t,e){return e.area-t.area}function Cr(t,e,r){let n=r.patternDependencies,i=!1;for(let o of e){let a=o.paint.get("".concat(t,"-pattern"));a.isConstant()||(i=!0);let s=a.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function kr(t,e,r,n,i){let o=i.patternDependencies;for(let a of e){let l=a.paint.get("".concat(t,"-pattern")).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:n-1},r,{},i.availableImages),c=l.evaluate({zoom:n},r,{},i.availableImages),p=l.evaluate({zoom:n+1},r,{},i.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,o[u]=!0,o[c]=!0,o[p]=!0,r.patterns[a.id]={min:u,mid:c,max:p}}}return r}var dx=500,rr=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _o,this.indexArray=new Le,this.indexArray2=new wt,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.segments2=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Cr("fill",this.layers,r);let i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n,r.availableImages):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=kr("fill",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,dp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,n,i,o){for(let a of Tr(r,dx)){let s=0;for(let y of a)s+=y.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let y of a){if(y.length===0)continue;y!==a[0]&&p.push(c.length/2);let m=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),h=m.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(h+y.length-1,h),c.push(y[0].x),c.push(y[0].y);for(let d=1;d<y.length;d++)this.layoutVertexArray.emplaceBack(y[d].x,y[d].y),this.indexArray2.emplaceBack(h+d-1,h+d),c.push(y[d].x),c.push(y[d].y);m.vertexLength+=y.length,m.primitiveLength+=y.length}let f=(0,Sp.default)(c,p);for(let y=0;y<f.length;y+=3)this.indexArray.emplaceBack(u+f[y],u+f[y+1],u+f[y+2]);l.vertexLength+=s,l.primitiveLength+=f.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};C("FillBucket",rr,{omit:["layers","patternFeatures"]});var wp,gx=()=>wp=wp||new re({"fill-sort-key":new R(S.layout_fill["fill-sort-key"])}),Ap,xx=()=>Ap=Ap||new re({"fill-antialias":new B(S.paint_fill["fill-antialias"]),"fill-opacity":new R(S.paint_fill["fill-opacity"]),"fill-color":new R(S.paint_fill["fill-color"]),"fill-outline-color":new R(S.paint_fill["fill-outline-color"]),"fill-translate":new B(S.paint_fill["fill-translate"]),"fill-translate-anchor":new B(S.paint_fill["fill-translate-anchor"]),"fill-pattern":new lt(S.paint_fill["fill-pattern"])}),_p={get paint(){return xx()},get layout(){return gx()}};var Wo=class extends se{constructor(e){super(e,_p)}recalculate(e,r){super.recalculate(e,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new rr(e)}queryRadius(){return _t(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s){let l=It(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s);return Oo(l,i)}isTileClipped(){return!0}};var bx=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ip=Y([{name:"a_centroid",components:2,type:"Int16"}],4);var{members:Tp,size:IS,alignment:TS}=bx;var Lp=Z($s(),1),Dp=Z(Tt(),1);var Ex=Dp.default.VectorTileFeature.types,Fx=500,Js=Math.pow(2,13);function Yn(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,Math.floor(n*Js)*2+a,i*Js*2,o*Js*2,Math.round(s))}var nr=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Io,this.centroidVertexArray=new wo,this.indexArray=new Le,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.features=[],this.hasPattern=Cr("fill-extrusion",this.layers,r);for(let{feature:i,id:o,index:a,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=$e(i,l);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),u,n))continue;let c={id:o,sourceLayerIndex:s,index:a,geometry:l?u.geometry:ke(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(kr("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,a,n,{}),r.featureIndex.insert(i,c.geometry,a,s,this.index,!0)}}addFeatures(e,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tp),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ip.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,n,i,o){let a={x:0,y:0,vertexCount:0};for(let s of Tr(r,Fx)){let l=0;for(let m of s)l+=m.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let m of s){if(m.length===0||Dx(m))continue;let h=0;for(let d=0;d<m.length;d++){let g=m[d];if(d>=1){let b=m[d-1];if(!Lx(g,b)){u.vertexLength+4>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let x=g.sub(b)._perp()._unit(),v=b.dist(g);h+v>32768&&(h=0),Yn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,h),Yn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,h),a.x+=2*g.x,a.y+=2*g.y,a.vertexCount+=2,h+=v,Yn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,0,h),Yn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,1,h),a.x+=2*b.x,a.y+=2*b.y,a.vertexCount+=2;let P=u.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),Ex[e.type]!=="Polygon")continue;let c=[],p=[],f=u.vertexLength;for(let m of s)if(m.length!==0){m!==s[0]&&p.push(c.length/2);for(let h=0;h<m.length;h++){let d=m[h];Yn(this.layoutVertexArray,d.x,d.y,0,0,1,1,0),a.x+=d.x,a.y+=d.y,a.vertexCount+=1,c.push(d.x),c.push(d.y)}}let y=(0,Lp.default)(c,p);for(let m=0;m<y.length;m+=3)this.indexArray.emplaceBack(f+y[m],f+y[m+2],f+y[m+1]);u.primitiveLength+=y.length/3,u.vertexLength+=l}for(let s=0;s<a.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};C("FillExtrusionBucket",nr,{omit:["layers","features"]});function Lx(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}function Dx(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}var Vp,Vx=()=>Vp=Vp||new re({"fill-extrusion-opacity":new B(S["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new R(S["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new B(S["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new B(S["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lt(S["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new R(S["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new R(S["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new B(S["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Bp={get paint(){return Vx()}};var Xo=Z(he(),1);var Ko=class extends se{constructor(e){super(e,Bp)}createBucket(e){return new nr(e)}queryRadius(){return _t(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,n,i,o,a,s,l){let u=It(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(r,n),p=this.paint.get("fill-extrusion-base").evaluate(r,n),f=Rx(u,l,a,0),y=zx(i,p,c,l),m=y[0],h=y[1];return Bx(m,h,f)}};function Qn(t,e){return t.x*e.x+t.y*e.y}function zp(t,e){if(t.length===1){let r=0,n=e[r++],i;for(;!i||n.equals(i);)if(i=e[r++],!i)return 1/0;for(;r<e.length;r++){let o=e[r],a=t[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=Qn(s,s),p=Qn(s,l),f=Qn(l,l),y=Qn(u,s),m=Qn(u,l),h=c*f-p*p,d=(f*y-p*m)/h,g=(c*m-p*y)/h,b=1-d-g,x=n.z*b+i.z*d+o.z*g;if(isFinite(x))return x}return 1/0}else{let r=1/0;for(let n of e)r=Math.min(r,n.z);return r}}function Bx(t,e,r){let n=1/0;Oo(r,e)&&(n=zp(r,e[0]));for(let i=0;i<e.length;i++){let o=e[i],a=t[i];for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=a[s],p=a[s+1],f=[l,u,p,c,l];Rc(r,f)&&(n=Math.min(n,zp(r,f)))}}return n===1/0?!1:n}function zx(t,e,r,n){let i=[],o=[],a=n[8]*e,s=n[9]*e,l=n[10]*e,u=n[11]*e,c=n[8]*r,p=n[9]*r,f=n[10]*r,y=n[11]*r;for(let m of t){let h=[],d=[];for(let g of m){let b=g.x,x=g.y,v=n[0]*b+n[4]*x+n[12],P=n[1]*b+n[5]*x+n[13],w=n[2]*b+n[6]*x+n[14],T=n[3]*b+n[7]*x+n[15],F=v+a,E=P+s,_=w+l,I=T+u,k=v+c,V=P+p,A=w+f,z=T+y,O=new Xo.default(F/I,E/I);O.z=_/I,h.push(O);let N=new Xo.default(k/z,V/z);N.z=A/z,d.push(N)}i.push(h),o.push(d)}return[i,o]}function Rx(t,e,r,n){let i=[];for(let o of t){let a=[o.x,o.y,n,1];Qt.transformMat4(a,a,e),i.push(new Xo.default(a[0]/a[3],a[1]/a[3]))}return i}var Ox=Y([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rp,size:uw,alignment:cw}=Ox;var Nx=Y([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Op,size:yw,alignment:mw}=Nx;var $p=Z(Tt(),1);var Ux=$p.default.VectorTileFeature.types,Np=63,$x=Math.cos(75/2*(Math.PI/180)),Gx=15,qx=20,jx=15,Gp=1/2,Up=Math.pow(2,jx-1)/Gp,ir=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new To,this.layoutVertexArray2=new Co,this.indexArray=new Le,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Cr("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=kr("line",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Op)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,n=+e.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(e,r,n,i,o){let a=this.layers[0].layout,s=a.get("line-join").evaluate(e,{}),l=a.get("line-cap"),u=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let p of r)this.addLine(p,e,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}addLine(e,r,n,i,o,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let g=0;g<e.length-1;g++)this.totalDistance+=e[g].dist(e[g+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Ux[r.type]==="Polygon",l=e.length;for(;l>=2&&e[l-1].equals(e[l-2]);)l--;let u=0;for(;u<l-1&&e[u].equals(e[u+1]);)u++;if(l<(s?3:2))return;n==="bevel"&&(o=1.05);let c=this.overscaling<=16?Gx*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),f,y,m,h,d;this.e1=this.e2=-1,s&&(f=e[l-2],d=e[u].sub(f)._unit()._perp());for(let g=u;g<l;g++){if(m=g===l-1?s?e[u+1]:void 0:e[g+1],m&&e[g].equals(m))continue;d&&(h=d),f&&(y=f),f=e[g],d=m?m.sub(f)._unit()._perp():h,h=h||d;let b=h.add(d);(b.x!==0||b.y!==0)&&b._unit();let x=h.x*d.x+h.y*d.y,v=b.x*d.x+b.y*d.y,P=v!==0?1/v:1/0,w=2*Math.sqrt(2-2*v),T=v<$x&&y&&m,F=h.x*d.y-h.y*d.x>0;if(T&&g>u){let I=f.dist(y);if(I>2*c){let k=f.sub(f.sub(y)._mult(c/I)._round());this.updateDistance(y,k),this.addCurrentVertex(k,h,0,0,p),y=k}}let E=y&&m,_=E?n:s?"butt":i;if(E&&_==="round"&&(P<a?_="miter":P<=2&&(_="fakeround")),_==="miter"&&P>o&&(_="bevel"),_==="bevel"&&(P>2&&(_="flipbevel"),P<o&&(_="miter")),y&&this.updateDistance(y,f),_==="miter")b._mult(P),this.addCurrentVertex(f,b,0,0,p);else if(_==="flipbevel"){if(P>100)b=d.mult(-1);else{let I=P*h.add(d).mag()/h.sub(d).mag();b._perp()._mult(I*(F?-1:1))}this.addCurrentVertex(f,b,0,0,p),this.addCurrentVertex(f,b.mult(-1),0,0,p)}else if(_==="bevel"||_==="fakeround"){let I=-Math.sqrt(P*P-1),k=F?I:0,V=F?0:I;if(y&&this.addCurrentVertex(f,h,k,V,p),_==="fakeround"){let A=Math.round(w*180/Math.PI/qx);for(let z=1;z<A;z++){let O=z/A;if(O!==.5){let K=O-.5,xe=1.0904+x*(-3.2452+x*(3.55645-x*1.43519)),X=.848013+x*(-1.06021+x*.215638);O=O+O*K*(O-1)*(xe*K*K+X)}let N=d.sub(h)._mult(O)._add(h)._unit()._mult(F?-1:1);this.addHalfVertex(f,N.x,N.y,!1,F,0,p)}}m&&this.addCurrentVertex(f,d,-k,-V,p)}else if(_==="butt")this.addCurrentVertex(f,b,0,0,p);else if(_==="square"){let I=y?1:-1;this.addCurrentVertex(f,b,I,I,p)}else _==="round"&&(y&&(this.addCurrentVertex(f,h,0,0,p),this.addCurrentVertex(f,h,1,1,p,!0)),m&&(this.addCurrentVertex(f,d,-1,-1,p,!0),this.addCurrentVertex(f,d,0,0,p)));if(T&&g<l-1){let I=f.dist(m);if(I>2*c){let k=f.add(m.sub(f)._mult(c/I)._round());this.updateDistance(f,k),this.addCurrentVertex(k,d,0,0,p),f=k}}}}addCurrentVertex(e,r,n,i,o,a=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(e,s,l,a,!1,n,o),this.addHalfVertex(e,u,c,a,!0,-i,o),this.distance>Up/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,n,i,o,a))}addHalfVertex({x:e,y:r},n,i,o,a,s,l){let c=(this.lineClips?this.scaledDistance*(Up-1):this.scaledDistance)*Gp;if(this.layoutVertexArray.emplaceBack((e<<1)+(o?1:0),(r<<1)+(a?1:0),Math.round(Np*n)+128,Math.round(Np*i)+128,(s===0?0:s<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,m=f/y;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let p=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),l.primitiveLength++),a?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};C("LineBucket",ir,{omit:["layers","patternFeatures"]});var qp,Jx=()=>qp=qp||new re({"line-cap":new B(S.layout_line["line-cap"]),"line-join":new R(S.layout_line["line-join"]),"line-miter-limit":new B(S.layout_line["line-miter-limit"]),"line-round-limit":new B(S.layout_line["line-round-limit"]),"line-sort-key":new R(S.layout_line["line-sort-key"])}),jp,Zx=()=>jp=jp||new re({"line-opacity":new R(S.paint_line["line-opacity"]),"line-color":new R(S.paint_line["line-color"]),"line-translate":new B(S.paint_line["line-translate"]),"line-translate-anchor":new B(S.paint_line["line-translate-anchor"]),"line-width":new R(S.paint_line["line-width"]),"line-gap-width":new R(S.paint_line["line-gap-width"]),"line-offset":new R(S.paint_line["line-offset"]),"line-blur":new R(S.paint_line["line-blur"]),"line-dasharray":new Jt(S.paint_line["line-dasharray"]),"line-pattern":new lt(S.paint_line["line-pattern"]),"line-gradient":new Zt(S.paint_line["line-gradient"])}),Zs={get paint(){return Zx()},get layout(){return Jx()}};var Ws=class extends R{possiblyEvaluate(e,r){return r=new q(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,n,i){return r=Pe({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,n,i)}},Yo,Qo=class extends se{constructor(e){super(e,Zs),this.gradientVersion=0,Yo||(Yo=new Ws(Zs.paint.properties["line-width"].specification),Yo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();qt(r)?this.stepInterpolant=r._styleExpression.expression instanceof yr:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=Yo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new ir(e)}queryRadius(e){let r=e,n=Jp(Yt("line-width",this,r),Yt("line-gap-width",this,r)),i=Yt("line-offset",this,r);return n/2+Math.abs(i)+_t(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s){let l=It(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*Jp(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),c=this.paint.get("line-offset").evaluate(r,n);return c&&(i=$c(i,c*s)),Nc(l,i,u)}isTileClipped(){return!0}};function Jp(t,e){return e>0?e+2*t:t}var Zp=Y([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wp=Y([{name:"a_projected_pos",components:3,type:"Float32"}],4),Kw=Y([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Hp=Y([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Yw=Y([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Hs=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qw=Y([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),e2=Y([{name:"triangle",components:3,type:"Uint16"}]),t2=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),r2=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),n2=Y([{type:"Float32",name:"offsetX"}]),i2=Y([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),o2=Y([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var oi=Z(he(),1);function Wx(t,e,r){let n=e.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?t=t.toLocaleUpperCase():n==="lowercase"&&(t=t.toLocaleLowerCase()),ye.applyArabicShaping&&(t=ye.applyArabicShaping(t)),t}function Xp(t,e,r){return t.sections.forEach(n=>{n.text=Wx(n.text,e,r)}),t}function Kp(t){let e={},r={},n=[],i=0;function o(u){n.push(t[u]),i++}function a(u,c,p){let f=r[u];return delete r[u],r[c]=f,n[f].geometry[0].pop(),n[f].geometry[0]=n[f].geometry[0].concat(p[0]),f}function s(u,c,p){let f=e[c];return delete e[c],e[u]=f,n[f].geometry[0].shift(),n[f].geometry[0]=p[0].concat(n[f].geometry[0]),f}function l(u,c,p){let f=p?c[0][c[0].length-1]:c[0][0];return"".concat(u,":").concat(f.x,":").concat(f.y)}for(let u=0;u<t.length;u++){let c=t[u],p=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}let y=l(f,p),m=l(f,p,!0);if(y in r&&m in e&&r[y]!==e[m]){let h=s(y,m,p),d=a(y,m,n[h].geometry);delete e[y],delete r[m],r[l(f,n[d].geometry,!0)]=d,n[h].geometry=null}else y in r?a(y,m,p):m in e?s(y,m,p):(o(u),e[y]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}var Er={"!":"\\uFE15","#":"\\uFF03",$:"\\uFF04","%":"\\uFF05","&":"\\uFF06","(":"\\uFE35",")":"\\uFE36","*":"\\uFF0A","+":"\\uFF0B",",":"\\uFE10","-":"\\uFE32",".":"\\u30FB","/":"\\uFF0F",":":"\\uFE13",";":"\\uFE14","<":"\\uFE3F","=":"\\uFF1D",">":"\\uFE40","?":"\\uFE16","@":"\\uFF20","[":"\\uFE47","\\\\":"\\uFF3C","]":"\\uFE48","^":"\\uFF3E",_:"\\uFE33","\`":"\\uFF40","{":"\\uFE37","|":"\\u2015","}":"\\uFE38","~":"\\uFF5E","\\xA2":"\\uFFE0","\\xA3":"\\uFFE1","\\xA5":"\\uFFE5","\\xA6":"\\uFFE4","\\xAC":"\\uFFE2","\\xAF":"\\uFFE3","\\u2013":"\\uFE32","\\u2014":"\\uFE31","\\u2018":"\\uFE43","\\u2019":"\\uFE44","\\u201C":"\\uFE41","\\u201D":"\\uFE42","\\u2026":"\\uFE19","\\u2027":"\\u30FB","\\u20A9":"\\uFFE6","\\u3001":"\\uFE11","\\u3002":"\\uFE12","\\u3008":"\\uFE3F","\\u3009":"\\uFE40","\\u300A":"\\uFE3D","\\u300B":"\\uFE3E","\\u300C":"\\uFE41","\\u300D":"\\uFE42","\\u300E":"\\uFE43","\\u300F":"\\uFE44","\\u3010":"\\uFE3B","\\u3011":"\\uFE3C","\\u3014":"\\uFE39","\\u3015":"\\uFE3A","\\u3016":"\\uFE17","\\u3017":"\\uFE18","\\uFF01":"\\uFE15","\\uFF08":"\\uFE35","\\uFF09":"\\uFE36","\\uFF0C":"\\uFE10","\\uFF0D":"\\uFE32","\\uFF0E":"\\u30FB","\\uFF1A":"\\uFE13","\\uFF1B":"\\uFE14","\\uFF1C":"\\uFE3F","\\uFF1E":"\\uFE40","\\uFF1F":"\\uFE16","\\uFF3B":"\\uFE47","\\uFF3D":"\\uFE48","\\uFF3F":"\\uFE33","\\uFF5B":"\\uFE37","\\uFF5C":"\\u2015","\\uFF5D":"\\uFE38","\\uFF5F":"\\uFE35","\\uFF60":"\\uFE36","\\uFF61":"\\uFE12","\\uFF62":"\\uFE41","\\uFF63":"\\uFE42"};function Yp(t){let e="";for(let r=0;r<t.length;r++){let n=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;(!n||!As(n)||Er[t[r+1]])&&(!i||!As(i)||Er[t[r-1]])&&Er[t[r]]?e+=Er[t[r]]:e+=t[r]}return e}var ne=24;var fb=Z(ei(),1),yb=3;var ra=yb;function ti(t){let e=0,r=0;for(let s of t)e+=s.w*s.h,r=Math.max(r,s.w);t.sort((s,l)=>l.h-s.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],o=0,a=0;for(let s of t)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(s.w>u.w||s.h>u.h)){if(s.x=u.x,s.y=u.y,a=Math.max(a,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===u.w&&s.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else s.h===u.h?(u.x+=s.w,u.w-=s.w):s.w===u.w?(u.y+=s.h,u.h-=s.h):(i.push({x:u.x+s.w,y:u.y,w:u.w-s.w,h:s.h}),u.y+=s.h,u.h-=s.h);break}}return{w:o,h:a,fill:e/(o*a)||0}}var ge=1;var na=class{constructor(e,{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n}get tl(){return[this.paddedRect.x+ge,this.paddedRect.y+ge]}get br(){return[this.paddedRect.x+this.paddedRect.w-ge,this.paddedRect.y+this.paddedRect.h-ge]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-ge*2)/this.pixelRatio,(this.paddedRect.h-ge*2)/this.pixelRatio]}},ri=class{constructor(e,r){let n={},i={};this.haveRenderCallbacks=[];let o=[];this.addImages(e,n,o),this.addImages(r,i,o);let{w:a,h:s}=ti(o),l=new de({width:a||1,height:s||1});for(let u in e){let c=e[u],p=n[u].paddedRect;de.copy(c.data,l,{x:0,y:0},{x:p.x+ge,y:p.y+ge},c.data)}for(let u in r){let c=r[u],p=i[u].paddedRect,f=p.x+ge,y=p.y+ge,m=c.data.width,h=c.data.height;de.copy(c.data,l,{x:0,y:0},{x:f,y},c.data),de.copy(c.data,l,{x:0,y:h-1},{x:f,y:y-1},{width:m,height:1}),de.copy(c.data,l,{x:0,y:0},{x:f,y:y+h},{width:m,height:1}),de.copy(c.data,l,{x:m-1,y:0},{x:f-1,y},{width:1,height:h}),de.copy(c.data,l,{x:0,y:0},{x:f+m,y},{width:1,height:h})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(e,r,n){for(let i in e){let o=e[i],a={x:0,y:0,w:o.data.width+2*ge,h:o.data.height+2*ge};n.push(a),r[i]=new na(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;let[i,o]=e.tl;n.update(r.data,void 0,{x:i,y:o})}};C("ImagePosition",na);C("ImageAtlas",ri);var aa=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(aa||{}),Dr=-17;function mb(t){for(let e of t)if(e.positionedGlyphs.length!==0)return!1;return!0}var af=57344,sf=63743,ia=class t{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){let n=new t;return n.scale=e||1,n.fontStack=r,n}static forImage(e){let r=new t;return r.imageName=e,r}},ni=class t{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){let n=new t;for(let i=0;i<e.sections.length;i++){let o=e.sections[i];o.image?n.addImageSection(o):n.addTextSection(o,r)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=Yp(this.text)}trim(){let e=0;for(let n=0;n<this.text.length&&oa[this.text.charCodeAt(n)];n++)e++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&oa[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){let n=new t;return n.text=this.text.substring(e,r),n.sectionIndex=this.sectionIndex.slice(e,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(ia.forText(e.scale,e.fontStack||r));let n=this.sections.length-1;for(let i=0;i<e.text.length;++i)this.sectionIndex.push(n)}addImageSection(e){let r=e.image?e.image.name:"";if(r.length===0){fe("Can't add FormattedSection with an empty image.");return}let n=this.getNextImageSectionCharCode();if(!n){fe("Reached maximum number of images ".concat(sf-af+2));return}this.text+=String.fromCharCode(n),this.sections.push(ia.forImage(r)),this.sectionIndex.push(this.sections.length-1)}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=sf?null:++this.imageSectionID:(this.imageSectionID=af,this.imageSectionID)}};function hb(t,e){let r=[],n=t.text,i=0;for(let o of e)r.push(t.substring(i,o)),i=o;return i<n.length&&r.push(t.substring(i,n.length)),r}function ii(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h){let d=ni.fromFeature(t,i);p===2&&d.verticalizePunctuation();let g,{processBidirectionalText:b,processStyledBidirectionalText:x}=ye;if(b&&d.sections.length===1){g=[];let w=b(d.toString(),Ys(d,u,o,e,n,y,m));for(let T of w){let F=new ni;F.text=T,F.sections=d.sections;for(let E=0;E<T.length;E++)F.sectionIndex.push(0);g.push(F)}}else if(x){g=[];let w=x(d.text,d.sectionIndex,Ys(d,u,o,e,n,y,m));for(let T of w){let F=new ni;F.text=T[0],F.sectionIndex=T[1],F.sections=d.sections,g.push(F)}}else g=hb(d,Ys(d,u,o,e,n,y,m));let v=[],P={positionedLines:v,text:d.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return bb(P,e,r,n,g,a,s,l,p,u,f,h),mb(v)?!1:P}var oa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},db={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function cf(t,e,r,n,i,o){if(e.imageName){let a=n[e.imageName];return a?a.displaySize[0]*e.scale*ne/o+i:0}else{let a=r[e.fontStack],s=a&&a[t];return s?s.metrics.advance*e.scale+i:0}}function gb(t,e,r,n,i,o){let a=0;for(let l=0;l<t.length();l++){let u=t.getSection(l);a+=cf(t.getCharCode(l),u,n,i,e,o)}let s=Math.max(1,Math.ceil(a/r));return a/s}function lf(t,e,r,n){let i=Math.pow(t-e,2);return n?t<e?i/2:i*2:i+Math.abs(r)*r}function xb(t,e,r){let n=0;return t===10&&(n-=1e4),r&&(n+=150),(t===40||t===65288)&&(n+=50),(e===41||e===65289)&&(n+=50),n}function uf(t,e,r,n,i,o){let a=null,s=lf(e,r,i,o);for(let l of n){let u=e-l.x,c=lf(u,r,i,o)+l.badness;c<=s&&(a=l,s=c)}return{index:t,x:e,priorBreak:a,badness:s}}function pf(t){return t?pf(t.priorBreak).concat(t.index):[]}function Ys(t,e,r,n,i,o,a){if(o!=="point")return[];if(!t)return[];let s=[],l=gb(t,e,r,n,i,a),u=t.text.indexOf("\\u200B")>=0,c=0;for(let p=0;p<t.length();p++){let f=t.getSection(p),y=t.getCharCode(p);if(oa[y]||(c+=cf(y,f,n,i,e,a)),p<t.length()-1){let m=Sc(y);(db[y]||m||f.imageName)&&s.push(uf(p+1,c,l,s,xb(y,t.getCharCode(p+1),m&&u),!1))}}return pf(uf(t.length(),c,l,s,0,!0))}function ff(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}function bb(t,e,r,n,i,o,a,s,l,u,c,p){let f=0,y=Dr,m=0,h=0,d=s==="right"?1:s==="left"?0:.5,g=0;for(let P of i){P.trim();let w=P.getMaxScale(),T=(w-1)*ne,F={positionedGlyphs:[],lineOffset:0};t.positionedLines[g]=F;let E=F.positionedGlyphs,_=0;if(!P.length()){y+=o,++g;continue}for(let k=0;k<P.length();k++){let V=P.getSection(k),A=P.getSectionIndex(k),z=P.getCharCode(k),O=0,N=null,K=null,xe=null,X=ne,le=!(l===1||!c&&!lo(z)||c&&(oa[z]||wc(z)));if(V.imageName){let ce=n[V.imageName];if(!ce)continue;xe=V.imageName,t.iconsInText=t.iconsInText||!0,K=ce.paddedRect;let pe=ce.displaySize;V.scale=V.scale*ne/p,N={width:pe[0],height:pe[1],left:ge,top:-ra,advance:le?pe[1]:pe[0]};let _e=ne-pe[1]*V.scale;O=T+_e,X=N.advance;let be=le?pe[0]*V.scale-ne*w:pe[1]*V.scale-ne*w;be>0&&be>_&&(_=be)}else{let ce=r[V.fontStack],pe=ce&&ce[z];if(pe&&pe.rect)K=pe.rect,N=pe.metrics;else{let _e=e[V.fontStack],be=_e&&_e[z];if(!be)continue;N=be.metrics}O=(w-V.scale)*ne}le?(t.verticalizable=!0,E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=X*V.scale+u):(E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=N.advance*V.scale+u)}if(E.length!==0){let k=f-u;m=Math.max(k,m),vb(E,0,E.length-1,d,_)}f=0;let I=o*w+_;F.lineOffset=Math.max(_,T),y+=I,h=Math.max(I,h),++g}let b=y-Dr,{horizontalAlign:x,verticalAlign:v}=ff(a);Pb(t.positionedLines,d,x,v,m,h,o,b,i.length),t.top+=-v*b,t.bottom=t.top+b,t.left+=-x*m,t.right=t.left+m}function vb(t,e,r,n,i){if(!n&&!i)return;let o=t[r],a=o.metrics.advance*o.scale,s=(t[r].x+a)*n;for(let l=e;l<=r;l++)t[l].x-=s,t[l].y+=i}function Pb(t,e,r,n,i,o,a,s,l){let u=(e-r)*i,c=0;o!==a?c=-s*n-Dr:c=(-n*l+.5)*a;for(let p of t)for(let f of p.positionedGlyphs)f.x+=u,f.y+=c}function yf(t,e,r){let{horizontalAlign:n,verticalAlign:i}=ff(r),o=e[0],a=e[1],s=o-t.displaySize[0]*n,l=s+t.displaySize[0],u=a-t.displaySize[1]*i,c=u+t.displaySize[1];return{image:t,top:u,bottom:c,left:s,right:l}}function Qs(t,e,r,n,i,o){let a=t.image,s;if(a.content){let d=a.content,g=a.pixelRatio||1;s=[d[0]/g,d[1]/g,a.displaySize[0]-d[2]/g,a.displaySize[1]-d[3]/g]}let l=e.left*o,u=e.right*o,c,p,f,y;r==="width"||r==="both"?(y=i[0]+l-n[3],p=i[0]+u+n[1]):(y=i[0]+(l+u-a.displaySize[0])/2,p=y+a.displaySize[0]);let m=e.top*o,h=e.bottom*o;return r==="height"||r==="both"?(c=i[1]+m-n[0],f=i[1]+h+n[2]):(c=i[1]+(m+h-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:p,bottom:f,left:y,collisionPadding:s}}var mf=Z(Tt(),1);var Vr=255,Ct=128,tt=Vr*Ct;function el(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new q(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,o=0;for(;o<n.length&&n[o]<=t;)o++;o=Math.max(0,o-1);let a=o;for(;a<n.length&&n[a]<t+1;)a++;a=Math.min(n.length-1,a);let s=n[o],l=n[a];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new q(s)),c=r.evaluate(new q(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function tl(t,e,r){let n="never",i=t.get(e);return i?n=i:t.get(r)&&(n="always"),n}var Sb=mf.default.VectorTileFeature.types,wb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sa(t,e,r,n,i,o,a,s,l,u,c,p,f){let y=s?Math.min(tt,Math.round(s[0])):0,m=s?Math.min(tt,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(n*32),Math.round(i*32),o,a,(y<<1)+(l?1:0),m,u*16,c*16,p*256,f*256)}function hf(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Ab(t){for(let e of t.sections)if(_c(e.text))return!0;return!1}var ai=class{constructor(e){this.layoutVertexArray=new ko,this.indexArray=new Le,this.programConfigurations=e,this.segments=new me,this.dynamicLayoutVertexArray=new Mo,this.opacityVertexArray=new Eo,this.hasVisibleVertices=!1,this.placedSymbolArray=new Dn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,wb,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};C("SymbolBuffers",ai);var si=class{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new me,this.collisionVertexArray=new Fo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};C("CollisionBuffers",si);var He=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Jn.identity([]),this.placementViewportMatrix=Jn.identity([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=el(this.zoom,n["text-size"]),this.iconSizeData=el(this.zoom,n["icon-size"]);let i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=tl(i,"text-overlap","text-allow-overlap")!=="never"||tl(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!o.isConstant();let s=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>aa[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=e.sourceID}createArrays(){this.text=new ai(new Ce(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new ai(new Ce(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Bn,this.lineVertexArray=new zn,this.symbolInstances=new Vn,this.textAnchorOffsets=new Rn}calculateGlyphDependencies(e,r,n,i,o){for(let a=0;a<e.length;a++)if(r[e.charCodeAt(a)]=!0,(n||i)&&o){let s=Er[e.charAt(a)];s&&(r[s.charCodeAt(0)]=!0)}}populate(e,r,n){let i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(a.value.kind!=="constant"||a.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let f=r.iconDependencies,y=r.glyphDependencies,m=r.availableImages,h=new q(this.zoom);for(let{feature:d,id:g,index:b,sourceLayerIndex:x}of e){let v=i._featureFilter.needGeometry,P=$e(d,v);if(!i._featureFilter.filter(h,P,n))continue;v||(P.geometry=ke(d));let w;if(u){let _=i.getValueAndResolveTokens("text-field",P,n,m),I=Fe.factory(_),k=this.hasRTLText=this.hasRTLText||Ab(I);(!k||ye.getRTLTextPluginStatus()==="unavailable"||k&&ye.isParsed())&&(w=Xp(I,i,P))}let T;if(c){let _=i.getValueAndResolveTokens("icon-image",P,n,m);_ instanceof Te?T=_:T=Te.fromString(_)}if(!w&&!T)continue;let F=this.sortFeaturesByKey?p.evaluate(P,{},n):void 0,E={id:g,text:w,icon:T,index:b,sourceLayerIndex:x,geometry:P.geometry,properties:d.properties,type:Sb[d.type],sortKey:F};if(this.features.push(E),T&&(f[T.name]=!0),w){let _=a.evaluate(P,{},n).join(","),I=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let k of w.sections)if(k.image)f[k.image.name]=!0;else{let V=hn(w.toString()),A=k.fontStack||_,z=y[A]=y[A]||{};this.calculateGlyphDependencies(k.text,z,I,this.allowVerticalPlacement,V)}}}o.get("symbol-placement")==="line"&&(this.features=Kp(this.features)),this.sortFeaturesByKey&&this.features.sort((d,g)=>d.sortKey-g.sortKey)}update(e,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let n=this.lineVertexArray.length;if(e.segment!==void 0){let i=e.dist(r[e.segment+1]),o=e.dist(r[e.segment]),a={};for(let s=e.segment+1;s<r.length;s++)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=e.segment||0;s>=0;s--)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=a[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,i,o,a,s,l,u,c,p,f){let y=e.indexArray,m=e.layoutVertexArray,h=e.segments.prepareSegment(4*r.length,m,y,this.canOverlap?a.sortKey:void 0),d=this.glyphOffsetArray.length,g=h.vertexLength,b=this.allowVerticalPlacement&&s===2?Math.PI/2:0,x=a.text&&a.text.sections;for(let v=0;v<r.length;v++){let{tl:P,tr:w,bl:T,br:F,tex:E,pixelOffsetTL:_,pixelOffsetBR:I,minFontScaleX:k,minFontScaleY:V,glyphOffset:A,isSDF:z,sectionIndex:O}=r[v],N=h.vertexLength,K=A[1];sa(m,l.x,l.y,P.x,K+P.y,E.x,E.y,n,z,_.x,_.y,k,V),sa(m,l.x,l.y,w.x,K+w.y,E.x+E.w,E.y,n,z,I.x,_.y,k,V),sa(m,l.x,l.y,T.x,K+T.y,E.x,E.y+E.h,n,z,_.x,I.y,k,V),sa(m,l.x,l.y,F.x,K+F.y,E.x+E.w,E.y+E.h,n,z,I.x,I.y,k,V),hf(e.dynamicLayoutVertexArray,l,b),y.emplaceBack(N,N+1,N+2),y.emplaceBack(N+1,N+2,N+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),(v===r.length-1||O!==r[v+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(m.length,a,a.index,{},f,x&&x[O])}e.placedSymbolArray.emplaceBack(l.x,l.y,d,this.glyphOffsetArray.length-d,g,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,p)}_addCollisionDebugVertex(e,r,n,i,o,a){return r.emplaceBack(0,0),e.emplaceBack(n.x,n.y,i,o,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,r,n,i,o,a,s){let l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,y=s.anchorY;this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(e,r)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(n,r)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(n,i)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(e,i)),l.vertexLength+=4;let m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,r,n,i){for(let o=e;o<r;o++){let a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new si(Nn,Hs.members,wt),this.iconCollisionBox=new si(Nn,Hs.members,wt);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,n,i,o,a,s,l,u){let c={};for(let p=r;p<n;p++){let f=e.get(p);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(let p=i;p<o;p++){let f=e.get(p);c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}for(let p=a;p<s;p++){let f=e.get(p);c.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.iconFeatureIndex=f.featureIndex;break}for(let p=l;p<u;p++){let f=e.get(p);c.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalIconFeatureIndex=f.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let n=e.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let o=n.vertexStartIndex;o<i;o+=4)e.indexArray.emplaceBack(o,o+1,o+2),e.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),n=Math.cos(e),i=[],o=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),o.push(l.featureIndex)}return a.sort((s,l)=>i[s]-i[l]||o[l]-o[s]),a}addToSortKeyRanges(e,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,o,a)=>{i>=0&&a.indexOf(i)===o&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};C("SymbolBucket",He,{omit:["layers","collisionBoxArray","features","compareText"]});He.MAX_GLYPHS=65535;He.addDynamicAttributes=hf;function df(t,e){return e.replace(/{([^{}]+)}/g,(r,n)=>t&&n in t?String(t[n]):"")}var gf,_b=()=>gf=gf||new re({"symbol-placement":new B(S.layout_symbol["symbol-placement"]),"symbol-spacing":new B(S.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new B(S.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new R(S.layout_symbol["symbol-sort-key"]),"symbol-z-order":new B(S.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new B(S.layout_symbol["icon-allow-overlap"]),"icon-overlap":new B(S.layout_symbol["icon-overlap"]),"icon-ignore-placement":new B(S.layout_symbol["icon-ignore-placement"]),"icon-optional":new B(S.layout_symbol["icon-optional"]),"icon-rotation-alignment":new B(S.layout_symbol["icon-rotation-alignment"]),"icon-size":new R(S.layout_symbol["icon-size"]),"icon-text-fit":new B(S.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new B(S.layout_symbol["icon-text-fit-padding"]),"icon-image":new R(S.layout_symbol["icon-image"]),"icon-rotate":new R(S.layout_symbol["icon-rotate"]),"icon-padding":new R(S.layout_symbol["icon-padding"]),"icon-keep-upright":new B(S.layout_symbol["icon-keep-upright"]),"icon-offset":new R(S.layout_symbol["icon-offset"]),"icon-anchor":new R(S.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new B(S.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new B(S.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new B(S.layout_symbol["text-rotation-alignment"]),"text-field":new R(S.layout_symbol["text-field"]),"text-font":new R(S.layout_symbol["text-font"]),"text-size":new R(S.layout_symbol["text-size"]),"text-max-width":new R(S.layout_symbol["text-max-width"]),"text-line-height":new B(S.layout_symbol["text-line-height"]),"text-letter-spacing":new R(S.layout_symbol["text-letter-spacing"]),"text-justify":new R(S.layout_symbol["text-justify"]),"text-radial-offset":new R(S.layout_symbol["text-radial-offset"]),"text-variable-anchor":new B(S.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new R(S.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new R(S.layout_symbol["text-anchor"]),"text-max-angle":new B(S.layout_symbol["text-max-angle"]),"text-writing-mode":new B(S.layout_symbol["text-writing-mode"]),"text-rotate":new R(S.layout_symbol["text-rotate"]),"text-padding":new B(S.layout_symbol["text-padding"]),"text-keep-upright":new B(S.layout_symbol["text-keep-upright"]),"text-transform":new R(S.layout_symbol["text-transform"]),"text-offset":new R(S.layout_symbol["text-offset"]),"text-allow-overlap":new B(S.layout_symbol["text-allow-overlap"]),"text-overlap":new B(S.layout_symbol["text-overlap"]),"text-ignore-placement":new B(S.layout_symbol["text-ignore-placement"]),"text-optional":new B(S.layout_symbol["text-optional"])}),xf,Ib=()=>xf=xf||new re({"icon-opacity":new R(S.paint_symbol["icon-opacity"]),"icon-color":new R(S.paint_symbol["icon-color"]),"icon-halo-color":new R(S.paint_symbol["icon-halo-color"]),"icon-halo-width":new R(S.paint_symbol["icon-halo-width"]),"icon-halo-blur":new R(S.paint_symbol["icon-halo-blur"]),"icon-translate":new B(S.paint_symbol["icon-translate"]),"icon-translate-anchor":new B(S.paint_symbol["icon-translate-anchor"]),"text-opacity":new R(S.paint_symbol["text-opacity"]),"text-color":new R(S.paint_symbol["text-color"],{runtimeType:Re,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new R(S.paint_symbol["text-halo-color"]),"text-halo-width":new R(S.paint_symbol["text-halo-width"]),"text-halo-blur":new R(S.paint_symbol["text-halo-blur"]),"text-translate":new B(S.paint_symbol["text-translate"]),"text-translate-anchor":new B(S.paint_symbol["text-translate-anchor"])}),la={get paint(){return Ib()},get layout(){return _b()}};var li=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:hr,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};C("FormatSectionOverride",li,{omit:["defaultValue"]});var ua=class t extends se{constructor(e){super(e,la)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let o of n)i.indexOf(o)<0&&i.push(o);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,i){let o=this.layout.get(e).evaluate(r,{},n,i),a=this._unevaluatedLayout._values[e];return!a.isDataDriven()&&!qt(a.value)&&o?df(r.properties,o):o}createBucket(e){return new He(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of la.paint.overridableProperties){if(!t.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),n=new li(r),i=new Nt(n,r.property.specification),o=null;r.value.kind==="constant"||r.value.kind==="source"?o=new dt("source",i):o=new gt("composite",i,r.value.zoomStops),this.paint._values[e]=new Se(r.property,o,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:t.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let n=e.get("text-field"),i=la.paint.properties[r],o=!1,a=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){o=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Fe)a(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!o)if(u instanceof mt&&ue(u.value)===dr){let c=u.value;a(c.sections)}else u instanceof tn?a(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return o}};function bf(t,e,r,n=1){let i=t.get("icon-padding").evaluate(e,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}var vf,Tb=()=>vf=vf||new re({"background-color":new B(S.paint_background["background-color"]),"background-pattern":new Jt(S.paint_background["background-pattern"]),"background-opacity":new B(S.paint_background["background-opacity"])}),Pf={get paint(){return Tb()}};var ca=class extends se{constructor(e){super(e,Pf)}};var Sf,Cb=()=>Sf=Sf||new re({"raster-opacity":new B(S.paint_raster["raster-opacity"]),"raster-hue-rotate":new B(S.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new B(S.paint_raster["raster-brightness-min"]),"raster-brightness-max":new B(S.paint_raster["raster-brightness-max"]),"raster-saturation":new B(S.paint_raster["raster-saturation"]),"raster-contrast":new B(S.paint_raster["raster-contrast"]),"raster-resampling":new B(S.paint_raster["raster-resampling"]),"raster-fade-duration":new B(S.paint_raster["raster-fade-duration"])}),wf={get paint(){return Cb()}};var pa=class extends se{constructor(e){super(e,wf)}};var fa=class extends se{constructor(r){super(r,{});this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)};this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)};this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function Af(t){if(t.type==="custom")return new fa(t);switch(t.type){case"background":return new ca(t);case"circle":return new Uo(t);case"fill":return new Wo(t);case"fill-extrusion":return new Ko(t);case"heatmap":return new $o(t);case"hillshade":return new Go(t);case"line":return new Qo(t);case"raster":return new pa(t);case"symbol":return new ua(t)}}var ya=class{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(e,r){for(let i of e){this._layerConfigs[i.id]=i;let o=this._layers[i.id]=Af(i);o._featureFilter=yn(o.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(let i of r)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let n=qu(Object.values(this._layerConfigs),this.keyCache);for(let i of n){let o=i.map(p=>this._layers[p.id]),a=o[0];if(a.visibility==="none")continue;let s=a.source||"",l=this.familiesBySource[s];l||(l=this.familiesBySource[s]={});let u=a.sourceLayer||"_geojsonTileLayer",c=l[u];c||(c=l[u]=[]),c.push(o)}}};var Hf=Z(Tt(),1),Xf=Z(ei(),1);var Br=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};var Tf=Z(Tt(),1),Cf=Z(ei(),1);var ma=class{constructor(e,r,n,i,o){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=n,e._y=i,this.properties=e.properties,this.id=o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}};var ui=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Vt(8192,16,0),this.grid3D=new Vt(8192,16,0),this.featureIndexArray=new On,this.promoteId=r}insert(e,r,n,i,o,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);let l=a?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],p=[1/0,1/0,-1/0,-1/0];for(let f=0;f<c.length;f++){let y=c[f];p[0]=Math.min(p[0],y.x),p[1]=Math.min(p[1],y.y),p[2]=Math.max(p[2],y.x),p[3]=Math.max(p[3],y.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Tf.default.VectorTile(new Cf.default(this.rawTileData)).layers,this.sourceLayerCoder=new Br(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,n,i){this.loadVTLayers();let o=e.params||{},a=8192/e.tileSize/e.scale,s=yn(o.filter),l=e.queryGeometry,u=e.queryPadding*a,c=If(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),f=If(e.cameraQueryGeometry),y=this.grid3D.query(f.minX-u,f.minY-u,f.maxX+u,f.maxY+u,(d,g,b,x)=>Uc(e.cameraQueryGeometry,d-u,g-u,b+u,x+u));for(let d of y)p.push(d);p.sort(kb);let m={},h;for(let d=0;d<p.length;d++){let g=p[d];if(g===h)continue;h=g;let b=this.featureIndexArray.get(g),x=null;this.loadMatchingFeature(m,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,s,o.layers,o.availableImages,r,n,i,(v,P,w)=>(x||(x=ke(v)),P.queryIntersectsFeature(l,v,w,x,this.z,e.transform,a,e.pixelPosMatrix)))}return m}loadMatchingFeature(e,r,n,i,o,a,s,l,u,c,p){let f=this.bucketLayerIDs[r];if(a&&!Yl(a,f))return;let y=this.sourceLayerCoder.decode(n),h=this.vtLayers[y].feature(i);if(o.needGeometry){let g=$e(h,!0);if(!o.filter(new q(this.tileID.overscaledZ),g,this.tileID.canonical))return}else if(!o.filter(new q(this.tileID.overscaledZ),h))return;let d=this.getId(h,y);for(let g=0;g<f.length;g++){let b=f[g];if(a&&a.indexOf(b)<0)continue;let x=l[b];if(!x)continue;let v={};d&&c&&(v=c.getState(x.sourceLayer||"_geojsonTileLayer",d));let P=Pe({},u[b]);P.paint=_f(P.paint,x.paint,h,v,s),P.layout=_f(P.layout,x.layout,h,v,s);let w=!p||p(h,x,v);if(!w)continue;let T=new ma(h,this.z,this.x,this.y,d);T.layer=P;let F=e[b];F===void 0&&(F=e[b]=[]),F.push({featureIndex:i,feature:T,intersectionZ:w})}}lookupSymbolFeatures(e,r,n,i,o,a,s,l){let u={};this.loadVTLayers();let c=yn(o);for(let p of e)this.loadMatchingFeature(u,n,i,p,c,a,s,l,r);return u}hasLayer(e){for(let r of this.bucketLayerIDs)for(let n of r)if(e===n)return!0;return!1}getId(e,r){let n=e.id;if(this.promoteId){let i=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];n=e.properties[i],typeof n=="boolean"&&(n=Number(n))}return n}};C("FeatureIndex",ui,{omit:["rawTileData","sourceLayerCoder"]});function _f(t,e,r,n,i){return jr(t,(o,a)=>{let s=e instanceof vt?e.get(a):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function If(t){let e=1/0,r=1/0,n=-1/0,i=-1/0;for(let o of t)e=Math.min(e,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{minX:e,minY:r,maxX:n,maxY:i}}function kb(t,e){return e-t}var kf=Z(he(),1);var rt=class t extends kf.default{constructor(e,r,n,i){super(e,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new t(this.x,this.y,this.angle,this.segment)}};C("Anchor",rt);function rl(t,e,r,n,i){if(e.segment===void 0||r===0)return!0;let o=e,a=e.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;let l=[],u=0;for(;s<r/2;){let c=t[a-1],p=t[a],f=t[a+1];if(!f)return!1;let y=c.angleTo(p)-p.angleTo(f);for(y=Math.abs((y+3*Math.PI)%(Math.PI*2)-Math.PI),l.push({distance:s,angleDelta:y}),u+=y;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=p.dist(f)}return!0}function Mf(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Ef(t,e,r){return t?3/5*e*r:0}function Ff(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Lf(t,e,r,n,i,o){let a=Ef(r,i,o),s=Ff(r,n)*o,l=0,u=Mf(t)/2;for(let c=0;c<t.length-1;c++){let p=t[c],f=t[c+1],y=p.dist(f);if(l+y>u){let m=(u-l)/y,h=Oe.number(p.x,f.x,m),d=Oe.number(p.y,f.y,m),g=new rt(h,d,f.angleTo(p),c);return g._round(),!a||rl(t,g,s,a,e)?g:void 0}l+=y}}function Df(t,e,r,n,i,o,a,s,l){let u=Ef(n,o,a),c=Ff(n,i),p=c*a,f=t[0].x===0||t[0].x===l||t[0].y===0||t[0].y===l;e-p<e/4&&(e=p+e/4);let y=o*2,m=f?e/2*s%e:(c/2+y)*a*s%e;return Vf(t,m,e,u,r,p,f,!1,l)}function Vf(t,e,r,n,i,o,a,s,l){let u=o/2,c=Mf(t),p=0,f=e-r,y=[];for(let m=0;m<t.length-1;m++){let h=t[m],d=t[m+1],g=h.dist(d),b=d.angleTo(h);for(;f+r<p+g;){f+=r;let x=(f-p)/g,v=Oe.number(h.x,d.x,x),P=Oe.number(h.y,d.y,x);if(v>=0&&v<l&&P>=0&&P<l&&f-u>=0&&f+u<=c){let w=new rt(v,P,b,m);w._round(),(!n||rl(t,w,o,n,i))&&y.push(w)}}p+=g}return!s&&!y.length&&!a&&(y=Vf(t,p/2,r,n,i,o,a,!0,l)),y}var pt=Z(he(),1);function Bf(t,e,r,n,i){let o=[];for(let a=0;a<t.length;a++){let s=t[a],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new pt.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round():p.x<e&&(p=new pt.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round()),!(c.y<r&&p.y<r)&&(c.y<r?c=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round():p.y<r&&(p=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round()),!(c.x>=n&&p.x>=n)&&(c.x>=n?c=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round():p.x>=n&&(p=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round()),!(c.y>=i&&p.y>=i)&&(c.y>=i?c=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round():p.y>=i&&(p=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],o.push(l)),l.push(p)))))}}return o}var we=Z(he(),1);var zr=ge;function nl(t,e,r,n){let i=[],o=t.image,a=o.pixelRatio,s=o.paddedRect.w-2*zr,l=o.paddedRect.h-2*zr,u=t.right-t.left,c=t.bottom-t.top,p=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],y=(I,k)=>I+k[1]-k[0],m=p.reduce(y,0),h=f.reduce(y,0),d=s-m,g=l-h,b=0,x=m,v=0,P=h,w=0,T=d,F=0,E=g;if(o.content&&n){let I=o.content;b=ha(p,0,I[0]),v=ha(f,0,I[1]),x=ha(p,I[0],I[2]),P=ha(f,I[1],I[3]),w=I[0]-b,F=I[1]-v,T=I[2]-I[0]-x,E=I[3]-I[1]-P}let _=(I,k,V,A)=>{let z=da(I.stretch-b,x,u,t.left),O=ga(I.fixed-w,T,I.stretch,m),N=da(k.stretch-v,P,c,t.top),K=ga(k.fixed-F,E,k.stretch,h),xe=da(V.stretch-b,x,u,t.left),X=ga(V.fixed-w,T,V.stretch,m),le=da(A.stretch-v,P,c,t.top),ce=ga(A.fixed-F,E,A.stretch,h),pe=new we.default(z,N),_e=new we.default(xe,N),be=new we.default(xe,le),Ai=new we.default(z,le),Da=new we.default(O/a,K/a),Va=new we.default(X/a,ce/a),Ur=e*Math.PI/180;if(Ur){let Ie=Math.sin(Ur),ve=Math.cos(Ur),Ve=[ve,-Ie,Ie,ve];pe._matMult(Ve),_e._matMult(Ve),Ai._matMult(Ve),be._matMult(Ve)}let _i=I.stretch+I.fixed,Me=V.stretch+V.fixed,Ft=k.stretch+k.fixed,Ii=A.stretch+A.fixed,Ba={x:o.paddedRect.x+zr+_i,y:o.paddedRect.y+zr+Ft,w:Me-_i,h:Ii-Ft},za=T/a/u,Ra=E/a/c;return{tl:pe,tr:_e,bl:Ai,br:be,tex:Ba,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Da,pixelOffsetBR:Va,minFontScaleX:za,minFontScaleY:Ra,isSDF:r}};if(!n||!o.stretchX&&!o.stretchY)i.push(_({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));else{let I=zf(p,d,m),k=zf(f,g,h);for(let V=0;V<I.length-1;V++){let A=I[V],z=I[V+1];for(let O=0;O<k.length-1;O++){let N=k[O],K=k[O+1];i.push(_(A,N,z,K))}}}return i}function ha(t,e,r){let n=0;for(let i of t)n+=Math.max(e,Math.min(r,i[1]))-Math.max(e,Math.min(r,i[0]));return n}function zf(t,e,r){let n=[{fixed:-zr,stretch:0}];for(let[i,o]of t){let a=n[n.length-1];n.push({fixed:i-a.stretch,stretch:a.stretch}),n.push({fixed:i-a.stretch,stretch:a.stretch+(o-i)})}return n.push({fixed:e+zr,stretch:r}),n}function da(t,e,r,n){return t/e*r+n}function ga(t,e,r,n){return t-e*r/n}function Rf(t,e,r,n,i,o,a,s){let l=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(let c of e.positionedLines)for(let p of c.positionedGlyphs){if(!p.rect)continue;let f=p.rect||{},m=ra+1,h=!0,d=1,g=0,b=(i||s)&&p.vertical,x=p.metrics.advance*p.scale/2;if(s&&e.verticalizable){let X=(p.scale-1)*ne,le=(ne-p.metrics.width*p.scale)/2;g=c.lineOffset/2-(p.imageName?-le:X)}if(p.imageName){let X=a[p.imageName];h=X.sdf,d=X.pixelRatio,m=ge/d}let v=i?[p.x+x,p.y]:[0,0],P=i?[0,0]:[p.x+x+r[0],p.y+r[1]-g],w=[0,0];b&&(w=P,P=[0,0]);let T=p.metrics.isDoubleResolution?2:1,F=(p.metrics.left-m)*p.scale-x+P[0],E=(-p.metrics.top-m)*p.scale+P[1],_=F+f.w/T*p.scale/d,I=E+f.h/T*p.scale/d,k=new we.default(F,E),V=new we.default(_,E),A=new we.default(F,I),z=new we.default(_,I);if(b){let X=new we.default(-x,x-Dr),le=-Math.PI/2,ce=ne/2-x,pe=p.imageName?ce:0,_e=new we.default(5-Dr-ce,-pe),be=new we.default(...w);k._rotateAround(le,X)._add(_e)._add(be),V._rotateAround(le,X)._add(_e)._add(be),A._rotateAround(le,X)._add(_e)._add(be),z._rotateAround(le,X)._add(_e)._add(be)}if(l){let X=Math.sin(l),le=Math.cos(l),ce=[le,-X,X,le];k._matMult(ce),V._matMult(ce),A._matMult(ce),z._matMult(ce)}let O=new we.default(0,0),N=new we.default(0,0);u.push({tl:k,tr:V,bl:A,br:z,tex:f,writingMode:e.writingMode,glyphOffset:v,sectionIndex:p.sectionIndex,isSDF:h,pixelOffsetTL:O,pixelOffsetBR:N,minFontScaleX:0,minFontScaleY:0})}return u}var ci=Z(he(),1),or=class{constructor(e,r,n,i,o,a,s,l,u,c){if(this.boxStartIndex=e.length,u){let p=a.top,f=a.bottom,y=a.collisionPadding;y&&(p-=y[1],f+=y[3]);let m=f-p;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{let p=a.top*s-l[0],f=a.bottom*s+l[2],y=a.left*s-l[3],m=a.right*s+l[1],h=a.collisionPadding;if(h&&(y-=h[0]*s,p-=h[1]*s,m+=h[2]*s,f+=h[3]*s),c){let d=new ci.default(y,p),g=new ci.default(m,p),b=new ci.default(y,f),x=new ci.default(m,f),v=c*Math.PI/180;d._rotate(v),g._rotate(v),b._rotate(v),x._rotate(v),y=Math.min(d.x,g.x,b.x,x.x),m=Math.max(d.x,g.x,b.x,x.x),p=Math.min(d.y,g.y,b.y,x.y),f=Math.max(d.y,g.y,b.y,x.y)}e.emplaceBack(r.x,r.y,y,p,m,f,n,i,o)}this.boxEndIndex=e.length}};var pi=class{constructor(e=[],r=Mb){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[e]=s,e=a}r[e]=o}};function Mb(t,e){return t<e?-1:t>e?1:0}var il=Z(he(),1);function Of(t,e=1,r=!1){let n=1/0,i=1/0,o=-1/0,a=-1/0,s=t[0];for(let h=0;h<s.length;h++){let d=s[h];(!h||d.x<n)&&(n=d.x),(!h||d.y<i)&&(i=d.y),(!h||d.x>o)&&(o=d.x),(!h||d.y>a)&&(a=d.y)}let l=o-n,u=a-i,c=Math.min(l,u),p=c/2,f=new pi([],Eb);if(c===0)return new il.default(n,i);for(let h=n;h<o;h+=c)for(let d=i;d<a;d+=c)f.push(new Rr(h+p,d+p,p,t));let y=Lb(t),m=f.length;for(;f.length;){let h=f.pop();(h.d>y.d||!y.d)&&(y=h,r&&console.log("found best %d after %d probes",Math.round(1e4*h.d)/1e4,m)),!(h.max-y.d<=e)&&(p=h.h/2,f.push(new Rr(h.p.x-p,h.p.y-p,p,t)),f.push(new Rr(h.p.x+p,h.p.y-p,p,t)),f.push(new Rr(h.p.x-p,h.p.y+p,p,t)),f.push(new Rr(h.p.x+p,h.p.y+p,p,t)),m+=4)}return r&&(console.log("num probes: ".concat(m)),console.log("best distance: ".concat(y.d))),y.p}function Eb(t,e){return e.max-t.max}function Rr(t,e,r,n){this.p=new il.default(t,e),this.h=r,this.d=Fb(this.p,n),this.max=this.d+this.h*Math.SQRT2}function Fb(t,e){let r=!1,n=1/0;for(let i=0;i<e.length;i++){let o=e[i];for(let a=0,s=o.length,l=s-1;a<s;l=a++){let u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,Vs(t,u,c))}}return(r?1:-1)*Math.sqrt(n)}function Lb(t){let e=0,r=0,n=0,i=t[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){let l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=c*3}return new Rr(r/e,n/e,0,t)}var ll=Z(ks(),1);var ol=(o=>(o[o.center=1]="center",o[o.left=2]="left",o[o.right=3]="right",o[o.top=4]="top",o[o.bottom=5]="bottom",o[o["top-left"]=6]="top-left",o[o["top-right"]=7]="top-right",o[o["bottom-left"]=8]="bottom-left",o[o["bottom-right"]=9]="bottom-right",o))(ol||{}),kt=7,xa=Number.POSITIVE_INFINITY;function al(t,e){function r(i,o){let a=0,s=0;o<0&&(o=0);let l=o/Math.SQRT2;switch(i){case"top-right":case"top-left":s=l-kt;break;case"bottom-right":case"bottom-left":s=-l+kt;break;case"bottom":s=-o+kt;break;case"top":s=o-kt;break}switch(i){case"top-right":case"bottom-right":a=-l;break;case"top-left":case"bottom-left":a=l;break;case"left":a=o;break;case"right":a=-o;break}return[a,s]}function n(i,o,a){let s=0,l=0;switch(o=Math.abs(o),a=Math.abs(a),i){case"top-right":case"top-left":case"top":l=a-kt;break;case"bottom-right":case"bottom-left":case"bottom":l=-a+kt;break}switch(i){case"top-right":case"bottom-right":case"right":s=-o;break;case"top-left":case"bottom-left":case"left":s=o;break}return[s,l]}return e[1]!==xa?n(t,e[0],e[1]):r(t,e[0])}function sl(t,e,r){var a;let n=t.layout,i=(a=n.get("text-variable-anchor-offset"))==null?void 0:a.evaluate(e,{},r);if(i){let s=i.values,l=[];for(let u=0;u<s.length;u+=2){let c=l[u]=s[u],p=s[u+1].map(f=>f*ne);c.startsWith("top")?p[1]-=kt:c.startsWith("bottom")&&(p[1]+=kt),l[u+1]=p}return new Ne(l)}let o=n.get("text-variable-anchor");if(o){let s;t._unevaluatedLayout.getValue("text-radial-offset")!==void 0?s=[n.get("text-radial-offset").evaluate(e,{},r)*ne,xa]:s=n.get("text-offset").evaluate(e,{},r).map(c=>c*ne);let u=[];for(let c of o)u.push(c,al(c,s));return new Ne(u)}return null}function $f(t){t.bucket.createArrays();let e=512*t.bucket.overscaling;t.bucket.tilePixelRatio=8192/e,t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;let r=t.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,o={layoutIconSize:i["icon-size"].possiblyEvaluate(new q(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new q(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new q(18))};if(t.bucket.textSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.textSizeData;o.compositeTextSizes=[i["text-size"].possiblyEvaluate(new q(c),t.canonical),i["text-size"].possiblyEvaluate(new q(p),t.canonical)]}if(t.bucket.iconSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.iconSizeData;o.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new q(c),t.canonical),i["icon-size"].possiblyEvaluate(new q(p),t.canonical)]}let a=n.get("text-line-height")*ne,s=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",l=n.get("text-keep-upright"),u=n.get("text-size");for(let c of t.bucket.features){let p=n.get("text-font").evaluate(c,{},t.canonical).join(","),f=u.evaluate(c,{},t.canonical),y=o.layoutTextSize.evaluate(c,{},t.canonical),m=o.layoutIconSize.evaluate(c,{},t.canonical),h={horizontal:{},vertical:void 0},d=c.text,g=[0,0];if(d){let P=d.toString(),w=n.get("text-letter-spacing").evaluate(c,{},t.canonical)*ne,T=Pc(P)?w:0,F=n.get("text-anchor").evaluate(c,{},t.canonical),E=sl(r,c,t.canonical);if(!E){let A=n.get("text-radial-offset").evaluate(c,{},t.canonical);A?g=al(F,[A*ne,xa]):g=n.get("text-offset").evaluate(c,{},t.canonical).map(z=>z*ne)}let _=s?"center":n.get("text-justify").evaluate(c,{},t.canonical),I=n.get("symbol-placement"),k=I==="point"?n.get("text-max-width").evaluate(c,{},t.canonical)*ne:0,V=()=>{t.bucket.allowVerticalPlacement&&hn(P)&&(h.vertical=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,"left",T,g,2,!0,I,y,f))};if(!s&&E){let A=new Set;if(_==="auto")for(let O=0;O<E.values.length;O+=2)A.add(Nf(E.values[O]));else A.add(_);let z=!1;for(let O of A)if(!h.horizontal[O])if(z)h.horizontal[O]=h.horizontal[0];else{let N=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,"center",O,T,g,1,!1,I,y,f);N&&(h.horizontal[O]=N,z=N.positionedLines.length===1)}V()}else{_==="auto"&&(_=Nf(F));let A=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,_,T,g,1,!1,I,y,f);A&&(h.horizontal[_]=A),V(),hn(P)&&s&&l&&(h.vertical=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,_,T,g,2,!1,I,y,f))}}let b,x=!1;if(c.icon&&c.icon.name){let P=t.imageMap[c.icon.name];P&&(b=yf(t.imagePositions[c.icon.name],n.get("icon-offset").evaluate(c,{},t.canonical),n.get("icon-anchor").evaluate(c,{},t.canonical)),x=!!P.sdf,t.bucket.sdfIcons===void 0?t.bucket.sdfIcons=x:t.bucket.sdfIcons!==x&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(P.pixelRatio!==t.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(t.bucket.iconsNeedLinear=!0))}let v=Gf(h.horizontal)||h.vertical;t.bucket.iconsInText=v?v.iconsInText:!1,(v||b)&&Db(t.bucket,c,h,b,t.imageMap,o,y,m,g,x,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()}function Nf(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Db(t,e,r,n,i,o,a,s,l,u,c){let p=o.textMaxSize.evaluate(e,{});p===void 0&&(p=a);let f=t.layers[0].layout,y=f.get("icon-offset").evaluate(e,{},c),m=Gf(r.horizontal),h=24,d=a/h,g=t.tilePixelRatio*d,b=t.tilePixelRatio*p/h,x=t.tilePixelRatio*s,v=t.tilePixelRatio*f.get("symbol-spacing"),P=f.get("text-padding")*t.tilePixelRatio,w=bf(f,e,c,t.tilePixelRatio),T=f.get("text-max-angle")/180*Math.PI,F=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",E=f.get("icon-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point",_=f.get("symbol-placement"),I=v/2,k=f.get("icon-text-fit"),V;n&&k!=="none"&&(t.allowVerticalPlacement&&r.vertical&&(V=Qs(n,r.vertical,k,f.get("icon-text-fit-padding"),y,d)),m&&(n=Qs(n,m,k,f.get("icon-text-fit-padding"),y,d)));let A=(z,O)=>{O.x<0||O.x>=8192||O.y<0||O.y>=8192||Bb(t,O,z,r,n,i,V,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,g,[P,P,P,P],F,l,x,w,E,y,e,o,u,c,a)};if(_==="line")for(let z of Bf(e.geometry,0,0,8192,8192)){let O=Df(z,v,T,r.vertical||m,n,h,b,t.overscaling,8192);for(let N of O){let K=m;(!K||!zb(t,K.text,I,N))&&A(z,N)}}else if(_==="line-center"){for(let z of e.geometry)if(z.length>1){let O=Lf(z,T,r.vertical||m,n,h,b);O&&A(z,O)}}else if(e.type==="Polygon")for(let z of Tr(e.geometry,0)){let O=Of(z,16);A(z[0],new rt(O.x,O.y,0))}else if(e.type==="LineString")for(let z of e.geometry)A(z,new rt(z[0].x,z[0].y,0));else if(e.type==="Point")for(let z of e.geometry)for(let O of z)A([O],new rt(O.x,O.y,0))}function Vb(t,e){let r=t.length,n=e==null?void 0:e.values;if((n==null?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){let o=ol[n[i]],a=n[i+1];t.emplaceBack(o,a[0],a[1])}return[r,t.length]}function Uf(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=Rf(e,r,s,i,o,a,n,t.allowVerticalPlacement),d=t.textSizeData,g=null;d.kind==="source"?(g=[Ct*i.layout.get("text-size").evaluate(a,{})],g[0]>tt&&fe("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Vr,'. Reduce your "text-size".'))):d.kind==="composite"&&(g=[Ct*y.compositeTextSizes[0].evaluate(a,{},m),Ct*y.compositeTextSizes[1].evaluate(a,{},m)],(g[0]>tt||g[1]>tt)&&fe("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Vr,'. Reduce your "text-size".'))),t.addSymbols(t.text,h,g,s,o,a,u,e,l.lineStartIndex,l.lineLength,f,m);for(let b of c)p[b]=t.text.placedSymbolArray.length-1;return h.length*4}function Gf(t){for(let e in t)return t[e];return null}function Bb(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F){let E=t.addToLineVertexArray(e,r),_,I,k,V,A=0,z=0,O=0,N=0,K=-1,xe=-1,X={},le=(0,ll.default)("");if(t.allowVerticalPlacement&&n.vertical){let ve=s.layout.get("text-rotate").evaluate(v,{},T)+90,Ve=n.vertical;k=new or(l,e,u,c,p,Ve,f,y,m,ve),a&&(V=new or(l,e,u,c,p,a,d,g,m,ve))}if(i){let Ie=s.layout.get("icon-rotate").evaluate(v,{}),ve=s.layout.get("icon-text-fit")!=="none",Ve=nl(i,Ie,w,ve),$r=a?nl(a,Ie,w,ve):void 0;I=new or(l,e,u,c,p,i,d,g,!1,Ie),A=Ve.length*4;let Vl=t.iconSizeData,Lt=null;Vl.kind==="source"?(Lt=[Ct*s.layout.get("icon-size").evaluate(v,{})],Lt[0]>tt&&fe("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Vr,'. Reduce your "icon-size".'))):Vl.kind==="composite"&&(Lt=[Ct*P.compositeIconSizes[0].evaluate(v,{},T),Ct*P.compositeIconSizes[1].evaluate(v,{},T)],(Lt[0]>tt||Lt[1]>tt)&&fe("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Vr,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,Ve,Lt,x,b,v,0,e,E.lineStartIndex,E.lineLength,-1,T),K=t.icon.placedSymbolArray.length-1,$r&&(z=$r.length*4,t.addSymbols(t.icon,$r,Lt,x,b,v,2,e,E.lineStartIndex,E.lineLength,-1,T),xe=t.icon.placedSymbolArray.length-1)}let ce=Object.keys(n.horizontal);for(let Ie of ce){let ve=n.horizontal[Ie];if(!_){le=(0,ll.default)(ve.text);let $r=s.layout.get("text-rotate").evaluate(v,{},T);_=new or(l,e,u,c,p,ve,f,y,m,$r)}let Ve=ve.positionedLines.length===1;if(O+=Uf(t,e,ve,o,s,m,v,h,E,n.vertical?1:3,Ve?ce:[Ie],X,K,P,T),Ve)break}n.vertical&&(N+=Uf(t,e,n.vertical,o,s,m,v,h,E,2,["vertical"],X,xe,P,T));let pe=_?_.boxStartIndex:t.collisionBoxArray.length,_e=_?_.boxEndIndex:t.collisionBoxArray.length,be=k?k.boxStartIndex:t.collisionBoxArray.length,Ai=k?k.boxEndIndex:t.collisionBoxArray.length,Da=I?I.boxStartIndex:t.collisionBoxArray.length,Va=I?I.boxEndIndex:t.collisionBoxArray.length,Ur=V?V.boxStartIndex:t.collisionBoxArray.length,_i=V?V.boxEndIndex:t.collisionBoxArray.length,Me=-1,Ft=(Ie,ve)=>Ie&&Ie.circleDiameter?Math.max(Ie.circleDiameter,ve):ve;Me=Ft(_,Me),Me=Ft(k,Me),Me=Ft(I,Me),Me=Ft(V,Me);let Ii=Me>-1?1:0;Ii&&(Me*=F/ne),t.glyphOffsetArray.length>=He.MAX_GLYPHS&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),v.sortKey!==void 0&&t.addToSortKeyRanges(t.symbolInstances.length,v.sortKey);let Ba=sl(s,v,T),[za,Ra]=Vb(t.textAnchorOffsets,Ba);t.symbolInstances.emplaceBack(e.x,e.y,X.right>=0?X.right:-1,X.center>=0?X.center:-1,X.left>=0?X.left:-1,X.vertical||-1,K,xe,le,pe,_e,be,Ai,Da,Va,Ur,_i,u,O,N,A,z,Ii,0,f,Me,za,Ra)}function zb(t,e,r,n){let i=t.compareText;if(!(e in i))i[e]=[];else{let o=i[e];for(let a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}return i[e].push(n),!1}var ba=1,fi=class{constructor(e){let r={},n=[];for(let s in e){let l=e[s],u=r[s]={};for(let c in l){let p=l[+c];if(!p||p.bitmap.width===0||p.bitmap.height===0)continue;let f={x:0,y:0,w:p.bitmap.width+2*ba,h:p.bitmap.height+2*ba};n.push(f),u[c]={rect:f,metrics:p.metrics}}}let{w:i,h:o}=ti(n),a=new er({width:i||1,height:o||1});for(let s in e){let l=e[s];for(let u in l){let c=l[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0)continue;let p=r[s][u].rect;er.copy(c.bitmap,a,{x:0,y:0},{x:p.x+ba,y:p.y+ba},c.bitmap)}}this.image=a,this.positions=r}};C("GlyphAtlas",fi);function jf(t,e,r){e=Math.pow(2,r)-e-1;var n=qf(t*256,e*256,r),i=qf((t+1)*256,(e+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function qf(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=t*n-2*Math.PI*6378137/2,o=e*n-2*Math.PI*6378137/2;return[i,o]}var Wf=Z(he(),1);var ul=63710088e-1,yi=class t{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new t(Hl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,n=this.lat*r,i=e.lat*r,o=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*r);return ul*Math.acos(Math.min(o,1))}static convert(e){if(e instanceof t)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new t(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("\`LngLatLike\` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var Jf=2*Math.PI*ul;function Zf(t){return Jf*Math.cos(t*Math.PI/180)}function Rb(t){return(180+t)/360}function Ob(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Nb(t,e){return t/Zf(e)}function Ub(t){return t*360-180}function cl(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function $b(t,e){return t*Zf(cl(e))}function Gb(t){return 1/Math.cos(t*Math.PI/180)}var va=class t{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){let n=yi.convert(e);return new t(Rb(n.lng),Ob(n.lat),Nb(r,n.lat))}toLngLat(){return new yi(Ub(this.x),cl(this.y))}toAltitude(){return $b(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Jf*Gb(cl(this.y))}};var Pa=class{constructor(e,r,n){if(e<0||e>25||n<0||n>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error("x=".concat(r,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=r,this.y=n,this.key=mi(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,n){let i=jf(this.x,this.y,this.z),o=qb(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,o).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new Wf.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}},pl=class{constructor(e,r){this.wrap=e,this.canonical=r,this.key=mi(e,r.z,r.z,r.x,r.y)}},hi=class t{constructor(e,r,n,i,o){if(e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=r,this.canonical=new Pa(n,+i,+o),this.key=mi(r,e,n,i,o)}clone(){return new t(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new t(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new t(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let n=this.canonical.z-e;return e>this.canonical.z?mi(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):mi(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new t(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new t(r,this.wrap,r,n,i),new t(r,this.wrap,r,n+1,i),new t(r,this.wrap,r,n,i+1),new t(r,this.wrap,r,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new t(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new t(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new pl(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new va(e.x-this.wrap,e.y))}};function mi(t,e,r,n,i){t*=2,t<0&&(t=t*-1-1);let o=1<<r;return(o*o*t+o*i+n).toString(36)+r.toString(36)+e.toString(36)}function qb(t,e,r){let n="",i;for(let o=t;o>0;o--)i=1<<o-1,n+=(e&i?1:0)+(r&i?2:0);return n}C("CanonicalTileID",Pa);C("OverscaledTileID",hi,{omit:["posMatrix"]});var Sa=class{constructor(e){this.tileID=new hi(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[]}async parse(e,r,n,i){this.status="parsing",this.data=e,this.collisionBoxArray=new Ln;let o=new Br(Object.keys(e.layers).sort()),a=new ui(this.tileID,this.promoteId);a.bucketLayerIDs=[];let s={},l={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},u=r.familiesBySource[this.source];for(let P in u){let w=e.layers[P];if(!w)continue;w.version===1&&fe('Vector tile source "'.concat(this.source,'" layer "').concat(P,'" ')+"does not use vector tile spec v2 and therefore may have some rendering errors.");let T=o.encode(P),F=[];for(let E=0;E<w.length;E++){let _=w.feature(E),I=a.getId(_,P);F.push({feature:_,id:I,index:E,sourceLayerIndex:T})}for(let E of u[P]){let _=E[0];if(_.source!==this.source&&fe("layer.source = ".concat(_.source," does not equal this.source = ").concat(this.source)),_.minzoom&&this.zoom<Math.floor(_.minzoom)||_.maxzoom&&this.zoom>=_.maxzoom||_.visibility==="none")continue;fl(E,this.zoom,n),(s[_.id]=_.createBucket({index:a.bucketLayerIDs.length,layers:E,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:T,sourceID:this.source})).populate(F,l,this.tileID.canonical),a.bucketLayerIDs.push(E.map(k=>k.id))}}let c=jr(l.glyphDependencies,P=>Object.keys(P).map(Number));this.inFlightDependencies.forEach(P=>P==null?void 0:P.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(c).length){let P=new AbortController;this.inFlightDependencies.push(P),p=i.sendAsync({type:"GG",data:{stacks:c,source:this.source,tileID:this.tileID,type:"glyphs"}},P)}let f=Object.keys(l.iconDependencies),y=Promise.resolve({});if(f.length){let P=new AbortController;this.inFlightDependencies.push(P),y=i.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},P)}let m=Object.keys(l.patternDependencies),h=Promise.resolve({});if(m.length){let P=new AbortController;this.inFlightDependencies.push(P),h=i.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"patterns"}},P)}let[d,g,b]=await Promise.all([p,y,h]),x=new fi(d),v=new ri(g,b);for(let P in s){let w=s[P];w instanceof He?(fl(w.layers,this.zoom,n),$f({bucket:w,glyphMap:d,glyphPositions:x.positions,imageMap:g,imagePositions:v.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):w.hasPattern&&(w instanceof ir||w instanceof rr||w instanceof nr)&&(fl(w.layers,this.zoom,n),w.addFeatures(l,this.tileID.canonical,v.patternPositions))}return this.status="done",{buckets:Object.values(s).filter(P=>!P.isEmpty()),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:v,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?g:null,glyphPositions:this.returnDependencies?x.positions:null}}};function fl(t,e,r){let n=new q(e);for(let i of t)i.recalculate(n,r)}var jb=60,HI=1e3/jb;var Or=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return e.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}};var Nr=class{constructor(e,r,n){this.actor=e,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}async loadVectorTile(e,r){let n=await hc(e.request,r);try{return{vectorTile:new Hf.default.VectorTile(new Xf.default(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){let o=new Uint8Array(n.data),a=o[0]===31&&o[1]===139,s="Unable to parse the tile at ".concat(e.request.url,", ");throw a?s+="please make sure the data is not gzipped and that you have configured the relevant header in the server":s+="got error: ".concat(i.messge),new Error(s)}}async loadTile(e){let r=e.uid,n=e&&e.request&&e.request.collectResourceTiming?new Or(e.request):!1,i=new Sa(e);this.loading[r]=i;let o=new AbortController;i.abort=o;try{let a=await this.loadVectorTile(e,o);if(delete this.loading[r],!a)return null;let s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);let u={};if(n){let p=n.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}i.vectorTile=a.vectorTile;let c=i.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[r]=i,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{let p=await c;return Pe({rawTileData:s.slice(0)},p,l,u)}finally{delete this.fetching[r]}}catch(a){throw delete this.loading[r],i.status="done",this.loaded[r]=i,a}}async reloadTile(e){let r=e.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let n=this.loaded[r];if(n.showCollisionBoxes=e.showCollisionBoxes,n.status==="parsing"){let i=await n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor),o;if(this.fetching[r]){let{rawTileData:a,cacheControl:s,resourceTiming:l}=this.fetching[r];delete this.fetching[r],o=Pe({rawTileData:a.slice(0)},i,s,l)}else o=i;return o}if(n.status==="done"&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor)}async abortTile(e){let r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort.abort(),delete r[n])}async removeTile(e){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]}};var di=class{constructor(e,r,n,i=1,o=1,a=1,s=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){fe('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=o,this.blueFactor=a,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(e,r){let n=new Uint8Array(this.data.buffer),i=this._idx(e,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,n){return e*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new de({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,o=r*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=o-1;break;case 1:o=i+1;break}switch(n){case-1:a=s-1;break;case 1:s=a+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=a;c<s;c++)for(let p=i;p<o;p++)this.data[this._idx(p,c)]=e.data[this._idx(p+l,c+u)]}};C("DEMData",di);var wa=class{constructor(){this.loaded={}}async loadTile(e){let{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=e,u=i.width+2,c=i.height+2,p=Jr(i)?new de({width:u,height:c},await eu(i,-1,-1,u,c)):i,f=new di(r,p,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=f,f}removeTile(e){let r=this.loaded,n=e.uid;r&&r[n]&&delete r[n]}};var wy=Z(ey(),1);var yl=Z(he(),1),ty=Z(Tt(),1);var Jb=ty.default.VectorTileFeature.prototype.toGeoJSON,ml=class{constructor(e){this._feature=e,this.extent=8192,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(this._feature.type===1){let e=[];for(let r of this._feature.geometry)e.push([new yl.default(r[0],r[1])]);return e}else{let e=[];for(let r of this._feature.geometry){let n=[];for(let i of r)n.push(new yl.default(i[0],i[1]));e.push(n)}return e}}toGeoJSON(e,r,n){return Jb.call(this,e,r,n)}},_a=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=e.length,this._features=e}feature(e){return new ml(this._features[e])}};var Ay=Z(sy(),1);var ly=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],gl=1,xi=8,vi=class t{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==gl)throw new Error("Got v".concat(i," data when expected v").concat(gl,"."));let o=ly[n&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new t(s,a,o,e)}constructor(e,r=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let o=ly.indexOf(this.ArrayType),a=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(n,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,xi,e),this.coords=new this.ArrayType(this.data,xi+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(xi+a+s+l),this.ids=new this.IndexArrayType(this.data,xi,e),this.coords=new this.ArrayType(this.data,xi+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(gl<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=r,n}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return bl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:a,nodeSize:s}=this,l=[0,o.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,f=l.pop()||0;if(p-f<=s){for(let d=f;d<=p;d++){let g=a[2*d],b=a[2*d+1];g>=e&&g<=n&&b>=r&&b<=i&&u.push(o[d])}continue}let y=f+p>>1,m=a[2*y],h=a[2*y+1];m>=e&&m<=n&&h>=r&&h<=i&&u.push(o[y]),(c===0?e<=m:r<=h)&&(l.push(f),l.push(y-1),l.push(1-c)),(c===0?n>=m:i>=h)&&(l.push(y+1),l.push(p),l.push(1-c))}return u}within(e,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,f=s.pop()||0;if(p-f<=a){for(let d=f;d<=p;d++)uy(o[2*d],o[2*d+1],e,r)<=u&&l.push(i[d]);continue}let y=f+p>>1,m=o[2*y],h=o[2*y+1];uy(m,h,e,r)<=u&&l.push(i[y]),(c===0?e-n<=m:r-n<=h)&&(s.push(f),s.push(y-1),s.push(1-c)),(c===0?e+n>=m:r+n>=h)&&(s.push(y+1),s.push(p),s.push(1-c))}return l}};function bl(t,e,r,n,i,o){if(i-n<=r)return;let a=n+i>>1;cy(t,e,a,n,i,o),bl(t,e,r,n,a-1,1-o),bl(t,e,r,a+1,i,1-o)}function cy(t,e,r,n,i,o){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),y=.5*Math.sqrt(p*f*(u-f)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*f/u+y)),h=Math.min(i,Math.floor(r+(u-c)*f/u+y));cy(t,e,r,m,h,o)}let a=e[2*r+o],s=n,l=i;for(bi(t,e,n,r),e[2*i+o]>a&&bi(t,e,n,i);s<l;){for(bi(t,e,s,l),s++,l--;e[2*s+o]<a;)s++;for(;e[2*l+o]>a;)l--}e[2*n+o]===a?bi(t,e,n,l):(l++,bi(t,e,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function bi(t,e,r,n){xl(t,r,n),xl(e,2*r,2*n),xl(e,2*r+1,2*n+1)}function xl(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function uy(t,e,r,n){let i=t-r,o=e-n;return i*i+o*o}var n0={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},py=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),ar=2,Et=3,vl=4,Mt=5,yy=6,Pi=class{constructor(e){this.options=Object.assign(Object.create(n0),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){let{log:r,minZoom:n,maxZoom:i}=this.options;r&&console.time("total time");let o="prepare ".concat(e.length," points");r&&console.time(o),this.points=e;let a=[];for(let l=0;l<e.length;l++){let u=e[l];if(!u.geometry)continue;let[c,p]=u.geometry.coordinates,f=py(Ta(c)),y=py(Ca(p));a.push(f,y,1/0,l,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);r&&console.timeEnd(o);for(let l=i;l>=n;l--){let u=+Date.now();s=this.trees[l]=this._createTree(this._cluster(s,l)),r&&console.log("z%d: %d clusters in %dms",l,s.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(e,r){let n=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),o=e[2]===180?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,o=180;else if(n>o){let p=this.getClusters([n,i,180,a],r),f=this.getClusters([-180,i,o,a],r);return p.concat(f)}let s=this.trees[this._limitZoom(r)],l=s.range(Ta(n),Ca(a),Ta(o),Ca(i)),u=s.data,c=[];for(let p of l){let f=this.stride*p;c.push(u[f+Mt]>1?fy(u,f,this.clusterProps):this.points[u[f+Et]])}return c}getChildren(e){let r=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);let a=o.data;if(r*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=a[r*this.stride],u=a[r*this.stride+1],c=o.within(l,u,s),p=[];for(let f of c){let y=f*this.stride;a[y+vl]===e&&p.push(a[y+Mt]>1?fy(a,y,this.clusterProps):this.points[a[y+Et]])}if(p.length===0)throw new Error(i);return p}getLeaves(e,r,n){r=r||10,n=n||0;let i=[];return this._appendLeaves(i,e,r,n,0),i}getTile(e,r,n){let i=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:a,radius:s}=this.options,l=s/a,u=(n-l)/o,c=(n+1+l)/o,p={features:[]};return this._addTileFeatures(i.range((r-l)/o,u,(r+1+l)/o,c),i.data,r,n,o,p),r===0&&this._addTileFeatures(i.range(1-l/o,u,1,c),i.data,o,n,o,p),r===o-1&&this._addTileFeatures(i.range(0,u,l/o,c),i.data,-1,n,o,p),p.features.length?p:null}getClusterExpansionZoom(e){let r=this._getOriginZoom(e)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(e);if(r++,n.length!==1)break;e=n[0].properties.cluster_id}return r}_appendLeaves(e,r,n,i,o){let a=this.getChildren(r);for(let s of a){let l=s.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(e,l.cluster_id,n,i,o):o<i?o++:e.push(s),e.length===n)break}return o}_createTree(e){let r=new vi(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)r.add(e[n],e[n+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,n,i,o,a){for(let s of e){let l=s*this.stride,u=r[l+Mt]>1,c,p,f;if(u)c=my(r,l,this.clusterProps),p=r[l],f=r[l+1];else{let h=this.points[r[l+Et]];c=h.properties;let[d,g]=h.geometry.coordinates;p=Ta(d),f=Ca(g)}let y={type:1,geometry:[[Math.round(this.options.extent*(p*o-n)),Math.round(this.options.extent*(f*o-i))]],tags:c},m;u||this.options.generateId?m=r[l+Et]:m=this.points[r[l+Et]].id,m!==void 0&&(y.id=m),a.features.push(y)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){let{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,r)),l=e.data,u=[],c=this.stride;for(let p=0;p<l.length;p+=c){if(l[p+ar]<=r)continue;l[p+ar]=r;let f=l[p],y=l[p+1],m=e.within(l[p],l[p+1],s),h=l[p+Mt],d=h;for(let g of m){let b=g*c;l[b+ar]>r&&(d+=l[b+Mt])}if(d>h&&d>=a){let g=f*h,b=y*h,x,v=-1,P=((p/c|0)<<5)+(r+1)+this.points.length;for(let w of m){let T=w*c;if(l[T+ar]<=r)continue;l[T+ar]=r;let F=l[T+Mt];g+=l[T]*F,b+=l[T+1]*F,l[T+vl]=P,o&&(x||(x=this._map(l,p,!0),v=this.clusterProps.length,this.clusterProps.push(x)),o(x,this._map(l,T)))}l[p+vl]=P,u.push(g/d,b/d,1/0,P,-1,d),o&&u.push(v)}else{for(let g=0;g<c;g++)u.push(l[p+g]);if(d>1)for(let g of m){let b=g*c;if(!(l[b+ar]<=r)){l[b+ar]=r;for(let x=0;x<c;x++)u.push(l[b+x])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,n){if(e[r+Mt]>1){let a=this.clusterProps[e[r+yy]];return n?Object.assign({},a):a}let i=this.points[e[r+Et]].properties,o=this.options.map(i);return n&&o===i?Object.assign({},o):o}};function fy(t,e,r){return{type:"Feature",id:t[e+Et],properties:my(t,e,r),geometry:{type:"Point",coordinates:[i0(t[e]),o0(t[e+1])]}}}function my(t,e,r){let n=t[e+Mt],i=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?"".concat(Math.round(n/100)/10,"k"):n,o=t[e+yy],a=o===-1?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:t[e+Et],point_count:n,point_count_abbreviated:i})}function Ta(t){return t/360+.5}function Ca(t){let e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function i0(t){return(t-.5)*360}function o0(t){let e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function Si(t,e,r,n){for(var i=n,o=r-e>>1,a=r-e,s,l=t[e],u=t[e+1],c=t[r],p=t[r+1],f=e+3;f<r;f+=3){var y=a0(t[f],t[f+1],l,u,c,p);if(y>i)s=f,i=y;else if(y===i){var m=Math.abs(f-o);m<a&&(s=f,a=m)}}i>n&&(s-e>3&&Si(t,e,s,n),t[s+2]=i,r-s>3&&Si(t,s,r,n))}function a0(t,e,r,n,i,o){var a=i-r,s=o-n;if(a!==0||s!==0){var l=((t-r)*a+(e-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=t-r,s=e-n,a*a+s*s}function ft(t,e,r,n){var i={id:typeof t>"u"?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return s0(i),i}function s0(t){var e=t.geometry,r=t.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")Pl(t,e);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<e.length;n++)Pl(t,e[n]);else if(r==="MultiPolygon")for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)Pl(t,e[n][i])}function Pl(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Al(t,e){var r=[];if(t.type==="FeatureCollection")for(var n=0;n<t.features.length;n++)ka(r,t.features[n],e,n);else t.type==="Feature"?ka(r,t,e):ka(r,{geometry:t},e);return r}function ka(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=n||0),o==="Point")hy(i,s);else if(o==="MultiPoint")for(var u=0;u<i.length;u++)hy(i[u],s);else if(o==="LineString")wl(i,s,a,!1);else if(o==="MultiLineString")if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],wl(i[u],s,a,!1),t.push(ft(l,"LineString",s,e.properties));return}else Sl(i,s,a,!1);else if(o==="Polygon")Sl(i,s,a,!0);else if(o==="MultiPolygon")for(u=0;u<i.length;u++){var c=[];Sl(i[u],c,a,!0),s.push(c)}else if(o==="GeometryCollection"){for(u=0;u<e.geometry.geometries.length;u++)ka(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");t.push(ft(l,o,s,e.properties))}}function hy(t,e){e.push(dy(t[0])),e.push(gy(t[1])),e.push(0)}function wl(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var l=dy(t[s][0]),u=gy(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(n?a+=(i*u-l*o)/2:a+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,Si(e,0,c,r),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Sl(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];wl(t[i],o,r,n),e.push(o)}}function dy(t){return t/360+.5}function gy(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function qe(t,e,r,n,i,o,a,s){if(r/=e,n/=e,o>=r&&a<n)return t;if(a<r||o>=n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,f=c.type,y=i===0?c.minX:c.minY,m=i===0?c.maxX:c.maxY;if(y>=r&&m<n){l.push(c);continue}else if(m<r||y>=n)continue;var h=[];if(f==="Point"||f==="MultiPoint")l0(p,h,r,n,i);else if(f==="LineString")by(p,h,r,n,i,!1,s.lineMetrics);else if(f==="MultiLineString")_l(p,h,r,n,i,!1);else if(f==="Polygon")_l(p,h,r,n,i,!0);else if(f==="MultiPolygon")for(var d=0;d<p.length;d++){var g=[];_l(p[d],g,r,n,i,!0),g.length&&h.push(g)}if(h.length){if(s.lineMetrics&&f==="LineString"){for(d=0;d<h.length;d++)l.push(ft(c.id,f,h[d],c.tags));continue}(f==="LineString"||f==="MultiLineString")&&(h.length===1?(f="LineString",h=h[0]):f="MultiLineString"),(f==="Point"||f==="MultiPoint")&&(f=h.length===3?"Point":"MultiPoint"),l.push(ft(c.id,f,h,c.tags))}}return l.length?l:null}function l0(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=r&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function by(t,e,r,n,i,o,a){for(var s=xy(t),l=i===0?u0:c0,u=t.start,c,p,f=0;f<t.length-3;f+=3){var y=t[f],m=t[f+1],h=t[f+2],d=t[f+3],g=t[f+4],b=i===0?y:m,x=i===0?d:g,v=!1;a&&(c=Math.sqrt(Math.pow(y-d,2)+Math.pow(m-g,2))),b<r?x>r&&(p=l(s,y,m,d,g,r),a&&(s.start=u+c*p)):b>n?x<n&&(p=l(s,y,m,d,g,n),a&&(s.start=u+c*p)):Il(s,y,m,h),x<r&&b>=r&&(p=l(s,y,m,d,g,r),v=!0),x>n&&b<=n&&(p=l(s,y,m,d,g,n),v=!0),!o&&v&&(a&&(s.end=u+c*p),e.push(s),s=xy(t)),a&&(u+=c)}var P=t.length-3;y=t[P],m=t[P+1],h=t[P+2],b=i===0?y:m,b>=r&&b<=n&&Il(s,y,m,h),P=s.length-3,o&&P>=3&&(s[P]!==s[0]||s[P+1]!==s[1])&&Il(s,s[0],s[1],s[2]),s.length&&e.push(s)}function xy(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function _l(t,e,r,n,i,o){for(var a=0;a<t.length;a++)by(t[a],e,r,n,i,o,!1)}function Il(t,e,r,n){t.push(e),t.push(r),t.push(n)}function u0(t,e,r,n,i,o){var a=(o-e)/(n-e);return t.push(o),t.push(r+(i-r)*a),t.push(1),a}function c0(t,e,r,n,i,o){var a=(o-r)/(i-r);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function Cl(t,e){var r=e.buffer/e.extent,n=t,i=qe(t,1,-1-r,r,0,-1,2,e),o=qe(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=qe(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=vy(i,1).concat(n)),o&&(n=n.concat(vy(o,-1)))),n}function vy(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n],o=i.type,a;if(o==="Point"||o==="MultiPoint"||o==="LineString")a=Tl(i.geometry,e);else if(o==="MultiLineString"||o==="Polygon"){a=[];for(var s=0;s<i.geometry.length;s++)a.push(Tl(i.geometry[s],e))}else if(o==="MultiPolygon")for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(Tl(i.geometry[s][u],e));a.push(l)}r.push(ft(i.id,o,a,i.tags))}return r}function Tl(t,e){var r=[];r.size=t.size,t.start!==void 0&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function Ma(t,e){if(t.transformed)return t;var r=1<<t.z,n=t.x,i=t.y,o,a,s;for(o=0;o<t.features.length;o++){var l=t.features[o],u=l.geometry,c=l.type;if(l.geometry=[],c===1)for(a=0;a<u.length;a+=2)l.geometry.push(Py(u[a],u[a+1],e,r,n,i));else for(a=0;a<u.length;a++){var p=[];for(s=0;s<u[a].length;s+=2)p.push(Py(u[a][s],u[a][s+1],e,r,n,i));l.geometry.push(p)}}return t.transformed=!0,t}function Py(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function Ml(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,p0(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,p=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function p0(t,e,r,n){var i=e.geometry,o=e.type,a=[];if(o==="Point"||o==="MultiPoint")for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if(o==="LineString")kl(a,i,t,r,!1,!1);else if(o==="MultiLineString"||o==="Polygon")for(s=0;s<i.length;s++)kl(a,i[s],t,r,o==="Polygon",s===0);else if(o==="MultiPolygon")for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)kl(a,u[s],t,r,!0,s===0)}if(a.length){var c=e.tags||null;if(o==="LineString"&&n.lineMetrics){c={};for(var p in e.tags)c[p]=e.tags[p];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:o==="Polygon"||o==="MultiPolygon"?3:o==="LineString"||o==="MultiLineString"?2:1,tags:c};e.id!==null&&(f.id=e.id),t.features.push(f)}}function kl(t,e,r,n,i,o){var a=n*n;if(n>0&&e.size<(i?a:n)){r.numPoints+=e.length/3;return}for(var s=[],l=0;l<e.length;l+=3)(n===0||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;i&&f0(s,o),t.push(s)}function f0(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(r>0===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}function Fl(t,e){return new Ea(t,e)}function Ea(t,e){e=this.options=y0(Object.create(this.options),e);var r=e.debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Al(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=Cl(n,e),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ea.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Ea.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,p=El(e,r,n),f=this.tiles[p];if(!f&&(u>1&&console.time("creation"),f=this.tiles[p]=Ml(t,e,r,n,l),this.tileCoords.push({z:e,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var y="z"+e;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(f.source=t,i){if(e===l.maxZoom||e===i)continue;var m=1<<i-e;if(r!==Math.floor(o/m)||n!==Math.floor(a/m))continue}else if(e===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,t.length!==0){u>1&&console.time("clipping");var h=.5*l.buffer/l.extent,d=.5-h,g=.5+h,b=1+h,x,v,P,w,T,F;x=v=P=w=null,T=qe(t,c,r-h,r+g,0,f.minX,f.maxX,l),F=qe(t,c,r+d,r+b,0,f.minX,f.maxX,l),t=null,T&&(x=qe(T,c,n-h,n+g,1,f.minY,f.maxY,l),v=qe(T,c,n+d,n+b,1,f.minY,f.maxY,l),T=null),F&&(P=qe(F,c,n-h,n+g,1,f.minY,f.maxY,l),w=qe(F,c,n+d,n+b,1,f.minY,f.maxY,l),F=null),u>1&&console.timeEnd("clipping"),s.push(x||[],e+1,r*2,n*2),s.push(v||[],e+1,r*2,n*2+1),s.push(P||[],e+1,r*2+1,n*2),s.push(w||[],e+1,r*2+1,n*2+1)}}};Ea.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t;e=(e%a+a)%a;var s=El(t,e,r);if(this.tiles[s])return Ma(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l=t,u=e,c=r,p;!p&&l>0;)l--,u=Math.floor(u/2),c=Math.floor(c/2),p=this.tiles[El(l,u,c)];return!p||!p.source?null:(o>1&&console.log("found parent tile z%d-%d-%d",l,u,c),o>1&&console.time("drilling down"),this.splitTile(p.source,l,u,c,t,e,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Ma(this.tiles[s],i):null)};function El(t,e,r){return((1<<t)*r+e)*32+t}function y0(t,e){for(var r in e)t[r]=e[r];return t}function wi(t,e){return e?t.properties[e]:t.id}function Ll(t,e){if(t==null)return!0;if(t.type==="Feature")return wi(t,e)!=null;if(t.type==="FeatureCollection"){let r=new Set;for(let n of t.features){let i=wi(n,e);if(i==null||r.has(i))return!1;r.add(i)}return!0}return!1}function Dl(t,e){let r=new Map;if(t!=null)if(t.type==="Feature")r.set(wi(t,e),t);else for(let n of t.features)r.set(wi(n,e),n);return r}function Sy(t,e,r){var n,i,o,a;if(e.removeAll&&t.clear(),e.remove)for(let s of e.remove)t.delete(s);if(e.add)for(let s of e.add){let l=wi(s,r);l!=null&&t.set(l,s)}if(e.update)for(let s of e.update){let l=t.get(s.id);if(l==null)continue;let u=s.newGeometry||s.removeAllProperties,c=!s.removeAllProperties&&(((n=s.removeProperties)==null?void 0:n.length)>0||((i=s.addOrUpdateProperties)==null?void 0:i.length)>0);if((u||c)&&(l=Dt({},l),t.set(s.id,l),c&&(l.properties=Dt({},l.properties))),s.newGeometry&&(l.geometry=s.newGeometry),s.removeAllProperties)l.properties={};else if(((o=s.removeProperties)==null?void 0:o.length)>0)for(let p of s.removeProperties)Object.prototype.hasOwnProperty.call(l.properties,p)&&delete l.properties[p];if(((a=s.addOrUpdateProperties)==null?void 0:a.length)>0)for(let{key:p,value:f}of s.addOrUpdateProperties)l.properties[p]=f}}var Fa=class extends Nr{constructor(){super(...arguments);this._dataUpdateable=new Map}async loadVectorTile(r,n){let i=r.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return null;let a=new _a(o.features),s=(0,Ay.default)(a);return(s.byteOffset!==0||s.byteLength!==s.buffer.byteLength)&&(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}}async loadData(r){var i;(i=this._pendingRequest)==null||i.abort();let n=r&&r.request&&r.request.collectResourceTiming?new Or(r.request):!1;this._pendingRequest=new AbortController;try{let o=await this.loadGeoJSON(r,this._pendingRequest);if(delete this._pendingRequest,typeof o!="object")throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if((0,wy.default)(o,!0),r.filter){let s=jt(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(s.result==="error")throw new Error(s.value.map(u=>"".concat(u.key,": ").concat(u.message)).join(", "));o={type:"FeatureCollection",features:o.features.filter(u=>s.value.evaluate({zoom:0},u))}}this._geoJSONIndex=r.cluster?new Pi(m0(r)).load(o.features):Fl(o,r.geojsonVtOptions),this.loaded={};let a={};if(n){let s=n.finish();s&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(s)))}return a}catch(o){if(delete this._pendingRequest,ac(o))return{abandoned:!0};throw o}}reloadTile(r){let n=this.loaded,i=r.uid;return n&&n[i]?super.reloadTile(r):this.loadTile(r)}async loadGeoJSON(r,n){let{promoteId:i}=r;if(r.request){let o=await mc(r.request,n);return this._dataUpdateable=Ll(o.data,i)?Dl(o.data,i):void 0,o.data}if(typeof r.data=="string")try{let o=JSON.parse(r.data);return this._dataUpdateable=Ll(o,i)?Dl(o,i):void 0,o}catch(o){throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."))}if(!r.dataDiff)throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if(!this._dataUpdateable)throw new Error("Cannot update existing geojson data in ".concat(r.source));return Sy(this._dataUpdateable,r.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}async removeSource(r){this._pendingRequest&&this._pendingRequest.abort()}getClusterExpansionZoom(r){return this._geoJSONIndex.getClusterExpansionZoom(r.clusterId)}getClusterChildren(r){return this._geoJSONIndex.getChildren(r.clusterId)}getClusterLeaves(r){return this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset)}};function m0({superclusterOptions:t,clusterProperties:e}){if(!e||!t)return t;let r={},n={},i={accumulated:null,zoom:0},o={properties:null},a=Object.keys(e);for(let s of a){let[l,u]=e[s],c=jt(u),p=jt(typeof l=="string"?[l,["accumulated"],["get",s]]:l);r[s]=c.value,n[s]=p.value}return t.map=s=>{o.properties=s;let l={};for(let u of a)l[u]=r[u].evaluate(i,o);return l},t.reduce=(s,l)=>{o.properties=l;for(let u of a)i.accumulated=s[u],s[u]=n[u].evaluate(i,o)},t}var La=class{constructor(e){this.self=e,this.actor=new io(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(r,n)=>{if(this.externalWorkerSourceTypes[r])throw new Error('Worker source with name "'.concat(r,'" already registered.'));this.externalWorkerSourceTypes[r]=n},this.self.addProtocol=lc,this.self.removeProtocol=uc,this.self.registerRTLTextPlugin=r=>{if(ye.isParsed())throw new Error("RTL text plugin already registered.");ye.setMethods(r)},this.actor.registerMessageHandler("LDT",(r,n)=>this._getDEMWorkerSource(r,n.source).loadTile(n)),this.actor.registerMessageHandler("RDT",async(r,n)=>{this._getDEMWorkerSource(r,n.source).removeTile(n)}),this.actor.registerMessageHandler("GCEZ",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterExpansionZoom(n)),this.actor.registerMessageHandler("GCC",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterChildren(n)),this.actor.registerMessageHandler("GCL",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterLeaves(n)),this.actor.registerMessageHandler("LD",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadData(n)),this.actor.registerMessageHandler("LT",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadTile(n)),this.actor.registerMessageHandler("RT",(r,n)=>this._getWorkerSource(r,n.type,n.source).reloadTile(n)),this.actor.registerMessageHandler("AT",(r,n)=>this._getWorkerSource(r,n.type,n.source).abortTile(n)),this.actor.registerMessageHandler("RMT",(r,n)=>this._getWorkerSource(r,n.type,n.source).removeTile(n)),this.actor.registerMessageHandler("RS",async(r,n)=>{if(!this.workerSources[r]||!this.workerSources[r][n.type]||!this.workerSources[r][n.type][n.source])return;let i=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],i.removeSource!==void 0&&i.removeSource(n)}),this.actor.registerMessageHandler("RM",async r=>{delete this.layerIndexes[r],delete this.availableImages[r],delete this.workerSources[r],delete this.demWorkerSources[r]}),this.actor.registerMessageHandler("SR",async(r,n)=>{this.referrer=n}),this.actor.registerMessageHandler("SRPS",(r,n)=>this._syncRTLPluginState(r,n)),this.actor.registerMessageHandler("IS",async(r,n)=>{this.self.importScripts(n)}),this.actor.registerMessageHandler("SI",(r,n)=>this._setImages(r,n)),this.actor.registerMessageHandler("UL",async(r,n)=>{this._getLayerIndex(r).update(n.layers,n.removedIds)}),this.actor.registerMessageHandler("SL",async(r,n)=>{this._getLayerIndex(r).replace(n)})}async _setImages(e,r){this.availableImages[e]=r;for(let n in this.workerSources[e]){let i=this.workerSources[e][n];for(let o in i)i[o].availableImages=r}}async _syncRTLPluginState(e,r){if(ye.isParsed())return ye.getState();if(r.pluginStatus!=="loading")return ye.setState(r),r;let n=r.pluginURL;if(this.self.importScripts(n),ye.isParsed()){let o={pluginStatus:"loaded",pluginURL:n};return ye.setState(o),o}throw ye.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(n))}_getAvailableImages(e){let r=this.availableImages[e];return r||(r=[]),r}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new ya),r}_getWorkerSource(e,r,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][r]||(this.workerSources[e][r]={}),!this.workerSources[e][r][n]){let i={sendAsync:(o,a)=>(o.targetMapId=e,this.actor.sendAsync(o,a))};switch(r){case"vector":this.workerSources[e][r][n]=new Nr(i,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][r][n]=new Fa(i,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][r][n]=new this.externalWorkerSourceTypes[r](i,this._getLayerIndex(e),this._getAvailableImages(e));break}}return this.workerSources[e][r][n]}_getDEMWorkerSource(e,r){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][r]||(this.demWorkerSources[e][r]=new wa),this.demWorkerSources[e][r]}};at(self)&&(self.worker=new La(self));})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
`,u9e=s(()=>wc.WORKER_URL?wc.WORKER_URL:URL.createObjectURL(new Blob([l9e],{type:"text/javascript"})),"getWorkerURL");function sae(){return new Worker(u9e())}s(sae,"workerFactory");var kF="maplibre_preloaded_worker_pool",lae=class uae{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<uae.workerCount;)this.workers.push(sae());return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[kF]}numActive(){return Object.keys(this.active).length}};s(lae,"WorkerPool");var MP=lae,c9e=Math.floor(vn.hardwareConcurrency/2);MP.workerCount=mZ(globalThis)?Math.max(Math.min(c9e,3),1):1;var lw;function EP(){return lw||(lw=new MP),lw}s(EP,"getGlobalWorkerPool");function h9e(){EP().acquire(kF)}s(h9e,"prewarm");function p9e(){let t=lw;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(kF),lw=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}s(p9e,"clearPrewarmedResources");var cae=class{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;let i=this.workerPool.acquire(r);for(let n=0;n<i.length;n++){let a=i[n],o=new s9e(a,r);o.name="Worker ".concat(n),this.actors.push(o)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){let i=[];for(let n of this.actors)i.push(n.sendAsync({type:e,data:r}));return Promise.all(i)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(let i of this.actors)i.registerMessageHandler(e,r)}};s(cae,"Dispatcher");var hae=cae,IM;function NF(){return IM||(IM=new hae(EP(),eD),IM.registerMessageHandler("GR",(t,e,r)=>YT(e,r))),IM}s(NF,"getGlobalDispatcher");N();function pae(t,e){let r=Nr.create();return Nr.translate(r,r,[1,1,0]),Nr.scale(r,r,[t.width*.5,t.height*.5,1]),Nr.multiply(r,r,t.calculatePosMatrix(e.toUnwrapped()))}s(pae,"getPixelPosMatrix");function dae(t,e,r){if(t)for(let i of t){let n=e[i];if(n&&n.source===r&&n.type==="fill-extrusion")return!0}else for(let i in e){let n=e[i];if(n.source===r&&n.type==="fill-extrusion")return!0}return!1}s(dae,"queryIncludes3DLayer");function fae(t,e,r,i,n,a){let o=dae(n&&n.layers,e,t.id),l=a.maxPitchScaleFactor(),u=t.tilesIn(i,l,o);u.sort(FF);let c=[];for(let m of u)c.push({wrappedTileID:m.tileID.wrapped().key,queryResults:m.tile.queryRenderedFeatures(e,r,t._state,m.queryGeometry,m.cameraQueryGeometry,m.scale,n,a,l,pae(t.transform,m.tileID))});let p=yae(c);for(let m in p)p[m].forEach(y=>{let v=y.feature,w=t.getFeatureState(v.layer["source-layer"],v.id);v.source=v.layer.source,v.layer["source-layer"]&&(v.sourceLayer=v.layer["source-layer"]),v.state=w});return p}s(fae,"queryRenderedFeatures");function mae(t,e,r,i,n,a,o){let l={},u=a.queryRenderedSymbols(i),c=[];for(let p of Object.keys(u).map(Number))c.push(o[p]);c.sort(FF);for(let p of c){let m=p.featureIndex.lookupSymbolFeatures(u[p.bucketInstanceId],e,p.bucketIndex,p.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(let y in m){let v=l[y]=l[y]||[],w=m[y];w.sort((E,M)=>{let I=p.featureSortOrder;if(I){let P=I.indexOf(E.featureIndex);return I.indexOf(M.featureIndex)-P}else return M.featureIndex-E.featureIndex});for(let E of w)v.push(E)}}for(let p in l)l[p].forEach(m=>{let y=m.feature,v=t[p],w=r[v.source].getFeatureState(y.layer["source-layer"],y.id);y.source=y.layer.source,y.layer["source-layer"]&&(y.sourceLayer=y.layer["source-layer"]),y.state=w});return l}s(mae,"queryRenderedSymbols");function gae(t,e){let r=t.getRenderableIds().map(a=>t.getTileByID(a)),i=[],n={};for(let a=0;a<r.length;a++){let o=r[a],l=o.tileID.canonical.key;n[l]||(n[l]=!0,o.querySourceFeatures(i,e))}return i}s(gae,"querySourceFeatures");function FF(t,e){let r=t.tileID,i=e.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}s(FF,"sortTilesIn");function yae(t){let e={},r={};for(let i of t){let n=i.queryResults,a=i.wrappedTileID,o=r[a]=r[a]||{};for(let l in n){let u=n[l],c=o[l]=o[l]||{},p=e[l]=e[l]||[];for(let m of u)c[m.featureIndex]||(c[m.featureIndex]=!0,p.push(m))}}return e}s(yae,"mergeRenderedFeatureLayers");N();N();N();N();async function BF(t,e,r){let i=t;if(t.url?i=(await KT(e.transformRequest(t.url,"Source"),r)).data:await vn.frameAsync(r),!i)return null;let n=fA(zr(i,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in i&&i.vector_layers&&(n.vectorLayerIds=i.vector_layers.map(a=>a.id)),n}s(BF,"loadTileJson");N();N();N();var zF=63710088e-1,vae=class n2{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new n2(Ay(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,i=this.lat*r,n=e.lat*r,a=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((e.lng-this.lng)*r);return zF*Math.acos(Math.min(a,1))}static convert(e){if(e instanceof n2)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new n2(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new n2(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};s(vae,"LngLat");var Ki=vae,_ae=class C0{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof Ki?new Ki(e.lng,e.lat):Ki.convert(e),this}setSouthWest(e){return this._sw=e instanceof Ki?new Ki(e.lng,e.lat):Ki.convert(e),this}extend(e){let r=this._sw,i=this._ne,n,a;if(e instanceof Ki)n=e,a=e;else if(e instanceof C0){if(n=e._sw,a=e._ne,!n||!a)return this}else{if(Array.isArray(e))if(e.length===4||e.every(Array.isArray)){let o=e;return this.extend(C0.convert(o))}else{let o=e;return this.extend(Ki.convert(o))}else if(e&&("lng"in e||"lon"in e)&&"lat"in e)return this.extend(Ki.convert(e));return this}return!r&&!i?(this._sw=new Ki(n.lng,n.lat),this._ne=new Ki(a.lng,a.lat)):(r.lng=Math.min(n.lng,r.lng),r.lat=Math.min(n.lat,r.lat),i.lng=Math.max(a.lng,i.lng),i.lat=Math.max(a.lat,i.lat)),this}getCenter(){return new Ki((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ki(this.getWest(),this.getNorth())}getSouthEast(){return new Ki(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:r,lat:i}=Ki.convert(e),n=this._sw.lat<=i&&i<=this._ne.lat,a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),n&&a}static convert(e){return e instanceof C0||!e?e:new C0(e)}static fromLngLat(e,r=0){let i=360*r/40075017,n=i/Math.cos(Math.PI/180*e.lat);return new C0(new Ki(e.lng-n,e.lat-i),new Ki(e.lng+n,e.lat+i))}};s(_ae,"LngLatBounds");var Km=_ae;N();var xae=2*Math.PI*zF;function UF(t){return xae*Math.cos(t*Math.PI/180)}s(UF,"circumferenceAtLatitude");function Ry(t){return(180+t)/360}s(Ry,"mercatorXfromLng");function Oy(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}s(Oy,"mercatorYfromLat");function D3(t,e){return t/UF(e)}s(D3,"mercatorZfromAltitude");function bae(t){return t*360-180}s(bae,"lngFromMercatorX");function R3(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}s(R3,"latFromMercatorY");function wae(t,e){return t*UF(R3(e))}s(wae,"altitudeFromMercatorZ");function Aae(t){return 1/Math.cos(t*Math.PI/180)}s(Aae,"mercatorScale");var Sae=class Mae{constructor(e,r,i=0){this.x=+e,this.y=+r,this.z=+i}static fromLngLat(e,r=0){let i=Ki.convert(e);return new Mae(Ry(i.lng),Oy(i.lat),D3(r,i.lat))}toLngLat(){return new Ki(bae(this.x),R3(this.y))}toAltitude(){return wae(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/xae*Aae(R3(this.y))}};s(Sae,"MercatorCoordinate");var al=Sae,Eae=class{constructor(e,r,i){this.bounds=Km.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=i||24}validateBounds(e){return!Array.isArray(e)||e.length!==4?[-180,-90,180,90]:[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]}contains(e){let r=Math.pow(2,e.z),i={minX:Math.floor(Ry(this.bounds.getWest())*r),minY:Math.floor(Oy(this.bounds.getNorth())*r),maxX:Math.ceil(Ry(this.bounds.getEast())*r),maxY:Math.ceil(Oy(this.bounds.getSouth())*r)};return e.x>=i.minX&&e.x<i.maxX&&e.y>=i.minY&&e.y<i.maxY}};s(Eae,"TileBounds");var Cae=Eae,Iae=class extends Fl{constructor(e,r,i,n){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,zr(this,fA(r,["url","scheme","tileSize","promoteId"])),this._options=zr({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}async load(){this._loaded=!1,this.fire(new pr("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await BF(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(zr(this,e),e.bounds&&(this.tileBounds=new Cae(e.bounds,this.minzoom,this.maxzoom)),this.fire(new pr("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new pr("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new fi(e))}}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return zr({},this._options)}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(!e.actor||e.state==="expired")e.actor=this.dispatcher.getActor(),n="LT";else if(e.state==="loading")return new Promise((a,o)=>{e.reloadPromise={resolve:a,reject:o}});e.abortController=new AbortController;try{let a=await e.actor.sendAsync({type:n,data:i},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,a)}catch(a){if(delete e.abortController,e.aborted)return;if(a&&a.status!==404)throw a;this._afterTileLoadWorkerResponse(e,null)}}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){let i=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(i.resolve).catch(i.reject)}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&await e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}})}async unloadTile(e){e.unloadVectorData(),e.actor&&await e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}hasTransition(){return!1}};s(Iae,"VectorTileSource");var d9e=Iae;N();var Tae=class extends Fl{constructor(e,r,i,n){super(),this.id=e,this.dispatcher=i,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=zr({type:"raster"},r),zr(this,fA(r,["url","scheme","tileSize"]))}async load(){this._loaded=!1,this.fire(new pr("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await BF(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(zr(this,e),e.bounds&&(this.tileBounds=new Cae(e.bounds,this.minzoom,this.maxzoom)),this.fire(new pr("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new pr("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new fi(e))}}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return zr({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let i=await Hp.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(i&&i.data){this.map._refreshExpiredTiles&&i.cacheControl&&i.expires&&e.setExpiryData({cacheControl:i.cacheControl,expires:i.expires});let n=this.map.painter.context,a=n.gl,o=i.data;e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new Es(n,o,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(i){if(delete e.abortController,e.aborted)e.state="unloaded";else if(i)throw e.state="errored",i}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController)}async unloadTile(e){e.texture&&this.map.painter.saveTileTexture(e.texture)}hasTransition(){return!1}};s(Tae,"RasterTileSource");var Pae=Tae;N();N();N();function Lae(t,e,r){e=Math.pow(2,r)-e-1;var i=YD(t*256,e*256,r),n=YD((t+1)*256,(e+1)*256,r);return i[0]+","+i[1]+","+n[0]+","+n[1]}s(Lae,"getTileBBox");function YD(t,e,r){var i=2*Math.PI*6378137/256/Math.pow(2,r),n=t*i-2*Math.PI*6378137/2,a=e*i-2*Math.PI*6378137/2;return[n,a]}s(YD,"getMercCoords");var f9e=kr(Nn(),1),Dae=class{constructor(e,r,i){if(e<0||e>25||i<0||i>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error("x=".concat(r,", y=").concat(i,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=r,this.y=i,this.key=t_(0,e,e,r,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,i){let n=Lae(this.x,this.y,this.z),a=kae(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new f9e.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}};s(Dae,"CanonicalTileID");var VF=Dae,Rae=class{constructor(e,r){this.wrap=e,this.canonical=r,this.key=t_(e,r.z,r.z,r.x,r.y)}};s(Rae,"UnwrappedTileID");var KD=Rae,Oae=class bh{constructor(e,r,i,n,a){if(e<i)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(i));this.overscaledZ=e,this.wrap=r,this.canonical=new VF(i,+n,+a),this.key=t_(r,e,i,n,a)}clone(){return new bh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new bh(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bh(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let i=this.canonical.z-e;return e>this.canonical.z?t_(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):t_(this.wrap*+r,e,e,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new bh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,i=this.canonical.x*2,n=this.canonical.y*2;return[new bh(r,this.wrap,r,i,n),new bh(r,this.wrap,r,i+1,n),new bh(r,this.wrap,r,i,n+1),new bh(r,this.wrap,r,i+1,n+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new bh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new bh(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new KD(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new al(e.x-this.wrap,e.y))}};s(Oae,"OverscaledTileID");var hc=Oae;function t_(t,e,r,i,n){t*=2,t<0&&(t=t*-1-1);let a=1<<r;return(a*a*t+a*n+i).toString(36)+r.toString(36)+e.toString(36)}s(t_,"calculateKey");function kae(t,e,r){let i="",n;for(let a=t;a>0;a--)n=1<<a-1,i+=(e&n?1:0)+(r&n?2:0);return i}s(kae,"getQuadkey");Rr("CanonicalTileID",VF);Rr("OverscaledTileID",hc,{omit:["posMatrix"]});N();var Nae=class{constructor(e,r,i,n=1,a=1,o=1,l=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(i&&!["mapbox","terrarium","custom"].includes(i)){kl('"'.concat(i,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let u=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),i){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=a,this.blueFactor=o,this.baseShift=l;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let c=0;c<u;c++)this.data[this._idx(-1,c)]=this.data[this._idx(0,c)],this.data[this._idx(u,c)]=this.data[this._idx(u-1,c)],this.data[this._idx(c,-1)]=this.data[this._idx(c,0)],this.data[this._idx(c,u)]=this.data[this._idx(c,u-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(u,-1)]=this.data[this._idx(u-1,0)],this.data[this._idx(-1,u)]=this.data[this._idx(0,u-1)],this.data[this._idx(u,u)]=this.data[this._idx(u-1,u-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let c=0;c<u;c++)for(let p=0;p<u;p++){let m=this.get(c,p);m>this.max&&(this.max=m),m<this.min&&(this.min=m)}}get(e,r){let i=new Uint8Array(this.data.buffer),n=this._idx(e,r)*4;return this.unpack(i[n],i[n+1],i[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,i){return e*this.redFactor+r*this.greenFactor+i*this.blueFactor-this.baseShift}getPixels(){return new go({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=r*this.dim,a=r*this.dim+this.dim,o=i*this.dim,l=i*this.dim+this.dim;switch(r){case-1:n=a-1;break;case 1:a=n+1;break}switch(i){case-1:o=l-1;break;case 1:l=o+1;break}let u=-r*this.dim,c=-i*this.dim;for(let p=o;p<l;p++)for(let m=n;m<a;m++)this.data[this._idx(m,p)]=e.data[this._idx(m+u,p+c)]}};s(Nae,"DEMData");var m9e=Nae;Rr("DEMData",m9e);var Fae=class extends Pae{constructor(e,r,i,n){super(e,r,i,n),this.type="raster-dem",this.maxzoom=22,this._options=zr({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let n=await Hp.getImage(i,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(n&&n.data){let a=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});let o=Gp(a)&&M9()?a:await this.readImageNow(a),l={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let u=await e.actor.sendAsync({type:"LDT",data:l});e.dem=u,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}async readImageNow(e){if(typeof VideoFrame<"u"&&aZ()){let r=e.width+2,i=e.height+2;try{return new go({width:r,height:i},await yZ(e,-1,-1,r,i))}catch{}}return vn.getImageData(e,1)}_getNeighboringTiles(e){let r=e.canonical,i=Math.pow(2,r.z),n=(r.x-1+i)%i,a=r.x===0?e.wrap-1:e.wrap,o=(r.x+1+i)%i,l=r.x+1===i?e.wrap+1:e.wrap,u={};return u[new hc(e.overscaledZ,a,r.z,n,r.y).key]={backfilled:!1},u[new hc(e.overscaledZ,l,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(u[new hc(e.overscaledZ,a,r.z,n,r.y-1).key]={backfilled:!1},u[new hc(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},u[new hc(e.overscaledZ,l,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<i&&(u[new hc(e.overscaledZ,a,r.z,n,r.y+1).key]={backfilled:!1},u[new hc(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},u[new hc(e.overscaledZ,l,r.z,o,r.y+1).key]={backfilled:!1}),u}async unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&await e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}})}};s(Fae,"RasterDEMTileSource");var g9e=Fae;N();var Bae=class extends Fl{constructor(e,r,i,n){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(n),this._data=r.data,this._options=zr({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;let a=8192/this.tileSize;this.workerOptions=zr({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*a,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*a,extent:8192,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:8192,radius:(r.clusterRadius||50)*a,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}async load(){await this._updateWorkerData()}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,i){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:i}})}async _updateWorkerData(e){let r=zr({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(vn.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new pr("dataloading",{dataType:"source"}));try{let i=await this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||i.abandoned){this.fire(new pr("dataabort",{dataType:"source"}));return}let n=null;i.resourceTiming&&i.resourceTiming[this.id]&&(n=i.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&zr(a,{resourceTiming:n}),this.fire(new pr("data",vt(Ee({},a),{sourceDataType:"metadata"}))),this.fire(new pr("data",vt(Ee({},a),{sourceDataType:"content"})))}catch(i){if(this._pendingLoads--,this._removed){this.fire(new pr("dataabort",{dataType:"source"}));return}this.fire(new fi(i))}}loaded(){return this._pendingLoads===0}async loadTile(e){let r=e.actor?"RT":"LT";e.actor=this.actor;let i={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let n=await this.actor.sendAsync({type:r,data:i},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,r==="RT")}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}async unloadTile(e){e.unloadVectorData(),await this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return zr({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}};s(Bae,"GeoJSONSource");var y9e=Bae;N();N();N();var CP=ao([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),zae=class extends Fl{constructor(e,r,i,n){super(),this.id=e,this.dispatcher=i,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=r}async load(e){this._loaded=!1,this.fire(new pr("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let r=await Hp.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new fi(r))}}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new pr("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let r=e.map(al.fromLngLat);this.tileID=Uae(r),this.minzoom=this.maxzoom=this.tileID.z;let i=r.map(n=>this.tileID.getTilePoint(n)._round());return this._boundsArray=new GQ,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,8192,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,8192),this._boundsArray.emplaceBack(i[2].x,i[2].y,8192,8192),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new pr("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,CP.members)),this.boundsSegments||(this.boundsSegments=To.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Es(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,i=!0)}i&&this.fire(new pr("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}async loadTile(e){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}};s(zae,"ImageSource");var Cw=zae;function Uae(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let p of t)e=Math.min(e,p.x),r=Math.min(r,p.y),i=Math.max(i,p.x),n=Math.max(n,p.y);let a=i-e,o=n-r,l=Math.max(a,o),u=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),c=Math.pow(2,u);return new VF(u,Math.floor((e+i)/2*c),Math.floor((r+n)/2*c))}s(Uae,"getCoordinatesCenterTileID");var Vae=class extends Cw{constructor(e,r,i,n){super(e,r,i,n),this.roundZoom=!0,this.type="video",this.options=r}async load(){this._loaded=!1;let e=this.options;this.urls=[];for(let r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{let r=await bOe(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new fi(r))}}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new fi(new _r("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(r.start(0)," and ").concat(r.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,CP.members)),this.boundsSegments||(this.boundsSegments=To.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new Es(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,i=!0)}i&&this.fire(new pr("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}};s(Vae,"VideoSource");var v9e=Vae;N();var jae=class extends Cw{constructor(e,r,i,n){super(e,r,i,n),r.coordinates?(!Array.isArray(r.coordinates)||r.coordinates.length!==4||r.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(o=>typeof o!="number")))&&this.fire(new fi(new _r("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new fi(new _r("sources.".concat(e),null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new fi(new _r("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas!="string"&&!(r.canvas instanceof HTMLCanvasElement)&&this.fire(new fi(new _r("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new fi(new _r("sources.".concat(e),null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate!==void 0?r.animate:!0}async load(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new fi(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let r=this.map.painter.context,i=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,CP.members)),this.boundsSegments||(this.boundsSegments=To.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Es(r,this.canvas,i.RGBA,{premultiply:!0});let n=!1;for(let a in this.tiles){let o=this.tiles[a];o.state!=="loaded"&&(o.state="loaded",o.texture=this.texture,n=!0)}n&&this.fire(new pr("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}};s(jae,"CanvasSource");var _9e=jae,$ae={},x9e=s((t,e,r,i)=>{let n=Gae(e.type),a=new n(t,e,r,i);if(a.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(a.id));return a},"create"),Gae=s(t=>{switch(t){case"geojson":return y9e;case"image":return Cw;case"raster":return Pae;case"raster-dem":return g9e;case"vector":return d9e;case"video":return v9e;case"canvas":return _9e}return $ae[t]},"getSourceType"),b9e=s((t,e)=>{$ae[t]=e},"setSourceType"),Bot=s(async(t,e)=>{if(Gae(t))throw new Error('A source type called "'.concat(t,'" already exists.'));b9e(t,e)},"addSourceType");N();N();function Hae(t,e){let r={};if(!e)return r;for(let i of t){let n=i.layerIds.map(a=>e.getLayer(a)).filter(Boolean);if(n.length!==0){i.layers=n,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(a=>n.filter(o=>o.id===a)[0]));for(let a of n)r[a.id]=i}}return r}s(Hae,"deserialize");N();N();var qae=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let i=e[r];this._stringToNumber[i]=r,this._numberToString[r]=i}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};s(qae,"DictionaryCoder");var w9e=qae,A9e=kr(WT(),1),S9e=kr(iZ(),1);N();var Wae=class{constructor(e,r,i,n,a){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=i,e._y=n,this.properties=e.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}};s(Wae,"GeoJSONFeature");var Xae=Wae,Zae=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ID(8192,16,0),this.grid3D=new ID(8192,16,0),this.featureIndexArray=new UQ,this.promoteId=r}insert(e,r,i,n,a,o){let l=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,a);let u=o?this.grid3D:this.grid;for(let c=0;c<r.length;c++){let p=r[c],m=[1/0,1/0,-1/0,-1/0];for(let y=0;y<p.length;y++){let v=p[y];m[0]=Math.min(m[0],v.x),m[1]=Math.min(m[1],v.y),m[2]=Math.max(m[2],v.x),m[3]=Math.max(m[3],v.y)}m[0]<8192&&m[1]<8192&&m[2]>=0&&m[3]>=0&&u.insert(l,m[0],m[1],m[2],m[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new A9e.default.VectorTile(new S9e.default(this.rawTileData)).layers,this.sourceLayerCoder=new w9e(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,i,n){this.loadVTLayers();let a=e.params||{},o=8192/e.tileSize/e.scale,l=C3(a.filter),u=e.queryGeometry,c=e.queryPadding*o,p=QD(u),m=this.grid.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c),y=QD(e.cameraQueryGeometry),v=this.grid3D.query(y.minX-c,y.minY-c,y.maxX+c,y.maxY+c,(M,I,P,C)=>kee(e.cameraQueryGeometry,M-c,I-c,P+c,C+c));for(let M of v)m.push(M);m.sort(Yae);let w={},E;for(let M=0;M<m.length;M++){let I=m[M];if(I===E)continue;E=I;let P=this.featureIndexArray.get(I),C=null;this.loadMatchingFeature(w,P.bucketIndex,P.sourceLayerIndex,P.featureIndex,l,a.layers,a.availableImages,r,i,n,(T,O,F)=>(C||(C=og(T)),O.queryIntersectsFeature(u,T,F,C,this.z,e.transform,o,e.pixelPosMatrix)))}return w}loadMatchingFeature(e,r,i,n,a,o,l,u,c,p,m){let y=this.bucketLayerIDs[r];if(o&&!cZ(o,y))return;let v=this.sourceLayerCoder.decode(i),w=this.vtLayers[v].feature(n);if(a.needGeometry){let M=sg(w,!0);if(!a.filter(new fs(this.tileID.overscaledZ),M,this.tileID.canonical))return}else if(!a.filter(new fs(this.tileID.overscaledZ),w))return;let E=this.getId(w,v);for(let M=0;M<y.length;M++){let I=y[M];if(o&&o.indexOf(I)<0)continue;let P=u[I];if(!P)continue;let C={};E&&p&&(C=p.getState(P.sourceLayer||"_geojsonTileLayer",E));let T=zr({},c[I]);T.paint=JD(T.paint,P.paint,w,C,l),T.layout=JD(T.layout,P.layout,w,C,l);let O=!m||m(w,P,C);if(!O)continue;let F=new Xae(w,this.z,this.x,this.y,E);F.layer=T;let k=e[I];k===void 0&&(k=e[I]=[]),k.push({featureIndex:n,feature:F,intersectionZ:O})}}lookupSymbolFeatures(e,r,i,n,a,o,l,u){let c={};this.loadVTLayers();let p=C3(a);for(let m of e)this.loadMatchingFeature(c,i,n,m,p,o,l,u,r);return c}hasLayer(e){for(let r of this.bucketLayerIDs)for(let i of r)if(e===i)return!0;return!1}getId(e,r){let i=e.id;if(this.promoteId){let n=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];i=e.properties[n],typeof i=="boolean"&&(i=Number(i))}return i}};s(Zae,"FeatureIndex");var M9e=Zae;Rr("FeatureIndex",M9e,{omit:["rawTileData","sourceLayerCoder"]});function JD(t,e,r,i,n){return ZT(t,(a,o)=>{let l=e instanceof fP?e.get(o):null;return l&&l.evaluate?l.evaluate(r,i,n):l})}s(JD,"evaluateProperties");function QD(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let a of t)e=Math.min(e,a.x),r=Math.min(r,a.y),i=Math.max(i,a.x),n=Math.max(n,a.y);return{minX:e,minY:r,maxX:i,maxY:n}}s(QD,"getBounds");function Yae(t,e){return e-t}s(Yae,"topDownFeatureComparator");N();N();var eR="RTLPluginLoaded",Kae=class extends Fl{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=NF()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}async setRTLTextPlugin(e,r=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=vn.resolveURL(e),!this.url)throw new Error("requested url ".concat(e," is invalid"));if(this.status==="unavailable")if(r)this.status="deferred",this._syncState(this.status);else return this._requestImport();else if(this.status==="requested")return this._requestImport()}async _requestImport(){await this._syncState("loading"),this.status="loaded",this.fire(new pr(eR))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}};s(Kae,"RTLMainThreadPlugin");var E9e=Kae,kL=null;function w_(){return kL||(kL=new E9e),kL}s(w_,"rtlMainThreadPluginFactory");var C9e=3e4,Jae=class{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=E9(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!e){this.collisionBoxArray=new xQ;return}e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=Hae(e.buckets,r.style),this.hasSymbolBuckets=!1;for(let n in this.buckets){let a=this.buckets[n];if(a instanceof b_)if(this.hasSymbolBuckets=!0,i)a.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let n in this.buckets){let a=this.buckets[n];if(a instanceof b_&&a.hasRTLText){this.hasRTLText=!0,w_().lazyLoad();break}}this.queryPadding=0;for(let n in this.buckets){let a=this.buckets[n];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(n).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let i in this.buckets){let n=this.buckets[i];n.uploadPending()&&n.upload(e)}let r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Es(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Es(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,i,n,a,o,l,u,c,p){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:a,scale:o,tileSize:this.tileSize,pixelPosMatrix:p,transform:u,params:l,queryPadding:this.queryPadding*c},e,r,i)}querySourceFeatures(e,r){let i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;let n=i.loadVTLayers(),a=r&&r.sourceLayer?r.sourceLayer:"",o=n._geojsonTileLayer||n[a];if(!o)return;let l=C3(r&&r.filter),{z:u,x:c,y:p}=this.tileID.canonical,m={z:u,x:c,y:p};for(let y=0;y<o.length;y++){let v=o.feature(y);if(l.needGeometry){let M=sg(v,!0);if(!l.filter(new fs(this.tileID.overscaledZ),M,this.tileID.canonical))continue}else if(!l.filter(new fs(this.tileID.overscaledZ),v))continue;let w=i.getId(v,a),E=new Xae(v,u,c,p,w);E.tile=m,e.push(E)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let r=this.expirationTime;if(e.cacheControl){let i=fZ(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+i["max-age"]*1e3)}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let i=Date.now(),n=!1;if(this.expirationTime>i)n=!1;else if(!r)n=!0;else if(this.expirationTime<r)n=!0;else{let a=this.expirationTime-r;a?this.expirationTime=i+Math.max(a,C9e):n=!0}n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let i=this.latestFeatureIndex.loadVTLayers();for(let n in this.buckets){if(!r.style.hasLayer(n))continue;let a=this.buckets[n],o=a.layers[0].sourceLayer||"_geojsonTileLayer",l=i[o],u=e[o];if(!l||!u||Object.keys(u).length===0)continue;a.update(u,l,this.imageAtlas&&this.imageAtlas.patternPositions||{});let c=r&&r.style&&r.style.getLayer(n);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(a)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<vn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=vn.now()+e}setDependencies(e,r){let i={};for(let n of r)i[n]=!0;this.dependencies[e]=i}hasDependency(e,r){for(let i of e){let n=this.dependencies[i];if(n){for(let a of r)if(n[a])return!0}}return!1}};s(Jae,"Tile");var Qae=Jae;N();var eoe=class{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(let e in this.data)for(let r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,i){let n=e.wrapped().key;this.data[n]===void 0&&(this.data[n]=[]);let a={value:r,timeout:void 0};if(i!==void 0&&(a.timeout=setTimeout(()=>{this.remove(e,a)},i)),this.data[n].push(a),this.order.push(n),this.order.length>this.max){let o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){let r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;let i=e.wrapped().key,n=r===void 0?0:this.data[i].indexOf(r),a=this.data[i][n];return this.data[i].splice(n,1),a.timeout&&clearTimeout(a.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(a.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){let r=[];for(let i in this.data)for(let n of this.data[i])e(n.value)||r.push(n);for(let i of r)this.remove(i.value.tileID,i)}};s(eoe,"TileCache");var I9e=eoe,aq=kr(Nn(),1);N();var toe=class{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,i){let n=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},zr(this.stateChanges[e][n],i),this.deletedStates[e]===null){this.deletedStates[e]={};for(let a in this.state[e])a!==n&&(this.deletedStates[e][a]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][n]===null){this.deletedStates[e][n]={};for(let a in this.state[e][n])i[a]||(this.deletedStates[e][n][a]=null)}else for(let a in i)this.deletedStates[e]&&this.deletedStates[e][n]&&this.deletedStates[e][n][a]===null&&delete this.deletedStates[e][n][a]}removeFeatureState(e,r,i){if(this.deletedStates[e]===null)return;let n=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&r!==void 0)this.deletedStates[e][n]!==null&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][i]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][n]){this.deletedStates[e][n]={};for(i in this.stateChanges[e][n])this.deletedStates[e][n][i]=null}else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,r){let i=String(r),n=this.state[e]||{},a=this.stateChanges[e]||{},o=zr({},n[i],a[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let l=this.deletedStates[e][r];if(l===null)return{};for(let u in l)delete o[u]}return o}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){let i={};for(let n in this.stateChanges){this.state[n]=this.state[n]||{};let a={};for(let o in this.stateChanges[n])this.state[n][o]||(this.state[n][o]={}),zr(this.state[n][o],this.stateChanges[n][o]),a[o]=this.state[n][o];i[n]=a}for(let n in this.deletedStates){this.state[n]=this.state[n]||{};let a={};if(this.deletedStates[n]===null)for(let o in this.state[n])a[o]={},this.state[n][o]={};else for(let o in this.deletedStates[n]){if(this.deletedStates[n][o]===null)this.state[n][o]={};else for(let l of Object.keys(this.deletedStates[n][o]))delete this.state[n][o][l];a[o]=this.state[n][o]}i[n]=i[n]||{},zr(i[n],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(let n in e)e[n].setFeatureState(i,r)}};s(toe,"SourceFeatureState");var T9e=toe,roe=class a2 extends Fl{constructor(e,r,i){super(),this.id=e,this.dispatcher=i,this.on("data",n=>this._dataHandler(n)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=x9e(e,r,i,this),this._tiles={},this._cache=new I9e(0,n=>this._unloadTile(n)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new T9e,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if((this.used!==void 0||this.usedForTerrain!==void 0)&&!this.used&&!this.usedForTerrain)return!0;if(!this._updated)return!1;for(let e in this._tiles){let r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}async _loadTile(e,r,i){try{await this._source.loadTile(e),this._tileLoaded(e,r,i)}catch(n){e.state="errored",n.status!==404?this._source.fire(new fi(n,{tile:e})):this.update(this.transform,this.terrain)}}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new pr("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let r in this._tiles){let i=this._tiles[r];i.upload(e),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(tR).map(e=>e.key)}getRenderableIds(e){let r=[];for(let i in this._tiles)this._isIdRenderable(i,e)&&r.push(this._tiles[i]);return e?r.sort((i,n)=>{let a=i.tileID,o=n.tileID,l=new aq.default(a.canonical.x,a.canonical.y)._rotate(this.transform.angle),u=new aq.default(o.canonical.x,o.canonical.y)._rotate(this.transform.angle);return a.overscaledZ-o.overscaledZ||u.y-l.y||u.x-l.x}).map(i=>i.tileID.key):r.map(i=>i.tileID).sort(tR).map(i=>i.key)}hasRenderableParent(e){let r=this.findLoadedParent(e,0);return r?this._isIdRenderable(r.tileID.key):!1}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}async _reloadTile(e,r){let i=this._tiles[e];i&&(i.state!=="loading"&&(i.state=r),await this._loadTile(i,e,r))}_tileLoaded(e,r,i){e.timeAdded=vn.now(),i==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new pr("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let r=this.getRenderableIds();for(let n=0;n<r.length;n++){let a=r[n];if(e.neighboringTiles&&e.neighboringTiles[a]){let o=this.getTileByID(a);i(e,o),i(o,e)}}function i(n,a){n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0;let o=a.tileID.canonical.x-n.tileID.canonical.x,l=a.tileID.canonical.y-n.tileID.canonical.y,u=Math.pow(2,n.tileID.canonical.z),c=a.tileID.key;o===0&&l===0||Math.abs(l)>1||(Math.abs(o)>1&&(Math.abs(o+u)===1?o+=u:Math.abs(o-u)===1&&(o-=u)),!(!a.dem||!n.dem)&&(n.dem.backfillBorder(a.dem,o,l),n.neighboringTiles&&n.neighboringTiles[c]&&(n.neighboringTiles[c].backfilled=!0)))}s(i,"fillBorder")}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,i,n){for(let a in this._tiles){let o=this._tiles[a];if(n[a]||!o.hasData()||o.tileID.overscaledZ<=r||o.tileID.overscaledZ>i)continue;let l=o.tileID;for(;o&&o.tileID.overscaledZ>r+1;){let c=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[c.key],o&&o.hasData()&&(l=c)}let u=l;for(;u.overscaledZ>r;)if(u=u.scaledTo(u.overscaledZ-1),e[u.key]){n[l.key]=l;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){let i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=r?i:null}for(let i=e.overscaledZ-1;i>=r;i--){let n=e.scaledTo(i),a=this._getLoadedTile(n);if(a)return a}}_getLoadedTile(e){let r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let r=Math.ceil(e.width/this._source.tileSize)+1,i=Math.ceil(e.height/this._source.tileSize)+1,n=r*i,a=this._maxTileCacheZoomLevels===null?wc.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels,o=Math.floor(n*a),l=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(l)}handleWrapJump(e){let r=this._prevLng===void 0?e:this._prevLng,i=(e-r)/360,n=Math.round(i);if(this._prevLng=e,n){let a={};for(let o in this._tiles){let l=this._tiles[o];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+n),a[l.tileID.key]=l}this._tiles=a;for(let o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(let o in this._tiles){let l=this._tiles[o];this._setTileReloadTimer(o,l)}}}update(e,r){if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};let i;!this.used&&!this.usedForTerrain?i=[]:this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(p=>new hc(p.canonical.z,p.wrap,p.canonical.z,p.canonical.x,p.canonical.y)):(i=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this.usedForTerrain?!1:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r}),this._source.hasTile&&(i=i.filter(p=>this._source.hasTile(p))));let n=e.coveringZoomLevel(this._source),a=Math.max(n-a2.maxOverzooming,this._source.minzoom),o=Math.max(n+a2.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let p={};for(let m of i)if(m.canonical.z>this._source.minzoom){let y=m.scaledTo(m.canonical.z-1);p[y.key]=y;let v=m.scaledTo(Math.max(this._source.minzoom,Math.min(m.canonical.z,5)));p[v.key]=v}i=i.concat(Object.values(p))}let l=i.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,l&&this.fire(new pr("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let u=this._updateRetainedTiles(i,n);if(rR(this._source.type)){let p={},m={},y=Object.keys(u),v=vn.now();for(let w of y){let E=u[w],M=this._tiles[w];if(!M||M.fadeEndTime!==0&&M.fadeEndTime<=v)continue;let I=this.findLoadedParent(E,a);I&&(this._addTile(I.tileID),p[I.tileID.key]=I.tileID),m[w]=E}this._retainLoadedChildren(m,n,o,u);for(let w in p)u[w]||(this._coveredTiles[w]=!0,u[w]=p[w]);if(r){let w={},E={};for(let M of i)this._tiles[M.key].hasData()?w[M.key]=M:E[M.key]=M;for(let M in E){let I=E[M].children(this._source.maxzoom);this._tiles[I[0].key]&&this._tiles[I[1].key]&&this._tiles[I[2].key]&&this._tiles[I[3].key]&&(w[I[0].key]=u[I[0].key]=I[0],w[I[1].key]=u[I[1].key]=I[1],w[I[2].key]=u[I[2].key]=I[2],w[I[3].key]=u[I[3].key]=I[3],delete E[M])}for(let M in E){let I=this.findLoadedParent(E[M],this._source.minzoom);if(I){w[I.tileID.key]=u[I.tileID.key]=I.tileID;for(let P in w)w[P].isChildOf(I.tileID)&&delete w[P]}}for(let M in this._tiles)w[M]||(this._coveredTiles[M]=!0)}}for(let p in u)this._tiles[p].clearFadeHold();let c=sZ(this._tiles,u);for(let p of c){let m=this._tiles[p];m.hasSymbolBuckets&&!m.holdingForFade()?m.setHoldDuration(this.map._fadeDuration):(!m.hasSymbolBuckets||m.symbolFadeFinished())&&this._removeTile(p)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){let i={},n={},a=Math.max(r-a2.maxOverzooming,this._source.minzoom),o=Math.max(r+a2.maxUnderzooming,this._source.minzoom),l={};for(let u of e){let c=this._addTile(u);i[u.key]=u,!c.hasData()&&r<this._source.maxzoom&&(l[u.key]=u)}this._retainLoadedChildren(l,r,o,i);for(let u of e){let c=this._tiles[u.key];if(c.hasData())continue;if(r+1>this._source.maxzoom){let m=u.children(this._source.maxzoom)[0],y=this.getTile(m);if(y&&y.hasData()){i[m.key]=m;continue}}else{let m=u.children(this._source.maxzoom);if(i[m[0].key]&&i[m[1].key]&&i[m[2].key]&&i[m[3].key])continue}let p=c.wasRequested();for(let m=u.overscaledZ-1;m>=a;--m){let y=u.scaledTo(m);if(n[y.key])break;if(n[y.key]=!0,c=this.getTile(y),!c&&p&&(c=this._addTile(y)),c){let v=c.hasData();if((p||v)&&(i[y.key]=y),p=c.wasRequested(),v)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let r=[],i,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}r.push(n.key);let a=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(a),i)break;n=a}for(let a of r)this._loadedParentTiles[a]=i}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));let i=r;return r||(r=new Qae(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,i||this._source.fire(new pr("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let i=r.getExpiryTimeout();i&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},i))}_removeTile(e){let r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(r.uses>0)&&(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){let r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,i){let n=[],a=this.transform;if(!a)return n;let o=i?a.getCameraQueryGeometry(e):e,l=e.map(w=>a.pointCoordinate(w,this.terrain)),u=o.map(w=>a.pointCoordinate(w,this.terrain)),c=this.getIds(),p=1/0,m=1/0,y=-1/0,v=-1/0;for(let w of u)p=Math.min(p,w.x),m=Math.min(m,w.y),y=Math.max(y,w.x),v=Math.max(v,w.y);for(let w=0;w<c.length;w++){let E=this._tiles[c[w]];if(E.holdingForFade())continue;let M=E.tileID,I=Math.pow(2,a.zoom-E.tileID.overscaledZ),P=r*E.queryPadding*8192/E.tileSize/I,C=[M.getTilePoint(new al(p,m)),M.getTilePoint(new al(y,v))];if(C[0].x-P<8192&&C[0].y-P<8192&&C[1].x+P>=0&&C[1].y+P>=0){let T=l.map(F=>M.getTilePoint(F)),O=u.map(F=>M.getTilePoint(F));n.push({tile:E,tileID:M,queryGeometry:T,cameraQueryGeometry:O,scale:I})}}return n}getVisibleCoordinates(e){let r=this.getRenderableIds(e).map(i=>this._tiles[i].tileID);for(let i of r)i.posMatrix=this.transform.calculatePosMatrix(i.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(rR(this._source.type)){let e=vn.now();for(let r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,i){e=e||"_geojsonTileLayer",this._state.updateState(e,r,i)}removeFeatureState(e,r,i){e=e||"_geojsonTileLayer",this._state.removeFeatureState(e,r,i)}getFeatureState(e,r){return e=e||"_geojsonTileLayer",this._state.getState(e,r)}setDependencies(e,r,i){let n=this._tiles[e];n&&n.setDependencies(r,i)}reloadTilesForDependencies(e,r){for(let i in this._tiles)this._tiles[i].hasDependency(e,r)&&this._reloadTile(i,"reloading");this._cache.filter(i=>!i.hasDependency(e,r))}};s(roe,"SourceCache");var Iw=roe;Iw.maxOverzooming=10;Iw.maxUnderzooming=3;function tR(t,e){let r=Math.abs(t.wrap*2)-+(t.wrap<0),i=Math.abs(e.wrap*2)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}s(tR,"compareTileId");function rR(t){return t==="raster"||t==="image"||t==="video"}s(rR,"isRasterType");N();N();N();var Ad=kr(Nn(),1);N();var tm=kr(Nn(),1);function ioe(t,e,r,i,n){let a=[];for(let o=0;o<t.length;o++){let l=t[o],u;for(let c=0;c<l.length-1;c++){let p=l[c],m=l[c+1];p.x<e&&m.x<e||(p.x<e?p=new tm.default(e,p.y+(m.y-p.y)*((e-p.x)/(m.x-p.x)))._round():m.x<e&&(m=new tm.default(e,p.y+(m.y-p.y)*((e-p.x)/(m.x-p.x)))._round()),!(p.y<r&&m.y<r)&&(p.y<r?p=new tm.default(p.x+(m.x-p.x)*((r-p.y)/(m.y-p.y)),r)._round():m.y<r&&(m=new tm.default(p.x+(m.x-p.x)*((r-p.y)/(m.y-p.y)),r)._round()),!(p.x>=i&&m.x>=i)&&(p.x>=i?p=new tm.default(i,p.y+(m.y-p.y)*((i-p.x)/(m.x-p.x)))._round():m.x>=i&&(m=new tm.default(i,p.y+(m.y-p.y)*((i-p.x)/(m.x-p.x)))._round()),!(p.y>=n&&m.y>=n)&&(p.y>=n?p=new tm.default(p.x+(m.x-p.x)*((n-p.y)/(m.y-p.y)),n)._round():m.y>=n&&(m=new tm.default(p.x+(m.x-p.x)*((n-p.y)/(m.y-p.y)),n)._round()),(!u||!p.equals(u[u.length-1]))&&(u=[p],a.push(u)),u.push(m)))))}}return a}s(ioe,"clipLine");N();var noe=class{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,this.length*.5),this.paddedLength=this.length-this.padding*2}lerp(e){if(this.points.length===1)return this.points[0];e=ps(e,0,1);let r=1,i=this._distances[r],n=e*this.paddedLength+this.padding;for(;i<n&&r<this._distances.length;)i=this._distances[++r];let a=r-1,o=this._distances[a],l=i-o,u=l>0?(n-o)/l:0;return this.points[a].mult(1-u).add(this.points[r].mult(u))}};s(noe,"PathInterpolator");var P9e=noe;N();function o2(t,e){let r=!0;return t==="always"||(t==="never"||e==="never")&&(r=!1),r}s(o2,"overlapAllowed");var aoe=class{constructor(e,r,i){let n=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(r/i);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,i,n,a){this._forEachCell(r,i,n,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(a)}insertCircle(e,r,i,n){this._forEachCell(r-n,i-n,r+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(i),this.circles.push(n)}_insertBoxCell(e,r,i,n,a,o){this.boxCells[a].push(o)}_insertCircleCell(e,r,i,n,a,o){this.circleCells[a].push(o)}_query(e,r,i,n,a,o,l){if(i<0||e>this.width||n<0||r>this.height)return[];let u=[];if(e<=0&&r<=0&&this.width<=i&&this.height<=n){if(a)return[{key:null,x1:e,y1:r,x2:i,y2:n}];for(let c=0;c<this.boxKeys.length;c++)u.push({key:this.boxKeys[c],x1:this.bboxes[c*4],y1:this.bboxes[c*4+1],x2:this.bboxes[c*4+2],y2:this.bboxes[c*4+3]});for(let c=0;c<this.circleKeys.length;c++){let p=this.circles[c*3],m=this.circles[c*3+1],y=this.circles[c*3+2];u.push({key:this.circleKeys[c],x1:p-y,y1:m-y,x2:p+y,y2:m+y})}}else{let c={hitTest:a,overlapMode:o,seenUids:{box:{},circle:{}}};this._forEachCell(e,r,i,n,this._queryCell,u,c,l)}return u}query(e,r,i,n){return this._query(e,r,i,n,!1,null)}hitTest(e,r,i,n,a,o){return this._query(e,r,i,n,!0,a,o).length>0}hitTestCircle(e,r,i,n,a){let o=e-i,l=e+i,u=r-i,c=r+i;if(l<0||o>this.width||c<0||u>this.height)return!1;let p=[],m={hitTest:!0,overlapMode:n,circle:{x:e,y:r,radius:i},seenUids:{box:{},circle:{}}};return this._forEachCell(o,u,l,c,this._queryCellCircle,p,m,a),p.length>0}_queryCell(e,r,i,n,a,o,l,u){let{seenUids:c,hitTest:p,overlapMode:m}=l,y=this.boxCells[a];if(y!==null){let w=this.bboxes;for(let E of y)if(!c.box[E]){c.box[E]=!0;let M=E*4,I=this.boxKeys[E];if(e<=w[M+2]&&r<=w[M+3]&&i>=w[M+0]&&n>=w[M+1]&&(!u||u(I))&&(!p||!o2(m,I.overlapMode))&&(o.push({key:I,x1:w[M],y1:w[M+1],x2:w[M+2],y2:w[M+3]}),p))return!0}}let v=this.circleCells[a];if(v!==null){let w=this.circles;for(let E of v)if(!c.circle[E]){c.circle[E]=!0;let M=E*3,I=this.circleKeys[E];if(this._circleAndRectCollide(w[M],w[M+1],w[M+2],e,r,i,n)&&(!u||u(I))&&(!p||!o2(m,I.overlapMode))){let P=w[M],C=w[M+1],T=w[M+2];if(o.push({key:I,x1:P-T,y1:C-T,x2:P+T,y2:C+T}),p)return!0}}}return!1}_queryCellCircle(e,r,i,n,a,o,l,u){let{circle:c,seenUids:p,overlapMode:m}=l,y=this.boxCells[a];if(y!==null){let w=this.bboxes;for(let E of y)if(!p.box[E]){p.box[E]=!0;let M=E*4,I=this.boxKeys[E];if(this._circleAndRectCollide(c.x,c.y,c.radius,w[M+0],w[M+1],w[M+2],w[M+3])&&(!u||u(I))&&!o2(m,I.overlapMode))return o.push(!0),!0}}let v=this.circleCells[a];if(v!==null){let w=this.circles;for(let E of v)if(!p.circle[E]){p.circle[E]=!0;let M=E*3,I=this.circleKeys[E];if(this._circlesCollide(w[M],w[M+1],w[M+2],c.x,c.y,c.radius)&&(!u||u(I))&&!o2(m,I.overlapMode))return o.push(!0),!0}}}_forEachCell(e,r,i,n,a,o,l,u){let c=this._convertToXCellCoord(e),p=this._convertToYCellCoord(r),m=this._convertToXCellCoord(i),y=this._convertToYCellCoord(n);for(let v=c;v<=m;v++)for(let w=p;w<=y;w++){let E=this.xCellCount*w+v;if(a.call(this,e,r,i,n,E,o,l,u))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,i,n,a,o){let l=n-e,u=a-r,c=i+o;return c*c>l*l+u*u}_circleAndRectCollide(e,r,i,n,a,o,l){let u=(o-n)/2,c=Math.abs(e-(n+u));if(c>u+i)return!1;let p=(l-a)/2,m=Math.abs(r-(a+p));if(m>p+i)return!1;if(c<=u||m<=p)return!0;let y=c-u,v=m-p;return y*y+v*v<=i*i}};s(aoe,"GridIndex");var oq=aoe;N();var Tw=kr(Nn(),1);function IP(t,e,r,i,n){let a=Nr.create();return e?(Nr.scale(a,a,[1/n,1/n,1]),r||Nr.rotateZ(a,a,i.angle)):Nr.multiply(a,i.labelPlaneMatrix,t),a}s(IP,"getLabelPlaneMatrix");function jF(t,e,r,i,n){if(e){let a=Nr.clone(t);return Nr.scale(a,a,[n,n,1]),r||Nr.rotateZ(a,a,-i.angle),a}else return i.glCoordMatrix}s(jF,"getGlCoordMatrix");function yc(t,e,r){let i;r?(i=[t.x,t.y,r(t.x,t.y),1],Jl.transformMat4(i,i,e)):(i=[t.x,t.y,0,1],PP(i,i,e));let n=i[3];return{point:new Tw.default(i[0]/n,i[1]/n),signedDistanceFromCamera:n}}s(yc,"project");function TP(t,e){return .5+.5*(t/e)}s(TP,"getPerspectiveRatio");function ooe(t,e){let r=t[0]/t[3],i=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&i>=-e[1]&&i<=e[1]}s(ooe,"isVisible");function soe(t,e,r,i,n,a,o,l,u,c){let p=i?t.textSizeData:t.iconSizeData,m=IA(p,r.transform.zoom),y=[256/r.width*2+1,256/r.height*2+1],v=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;v.clear();let w=t.lineVertexArray,E=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,M=r.transform.width/r.transform.height,I=!1;for(let P=0;P<E.length;P++){let C=E.get(P);if(C.hidden||C.writingMode===2&&!I){ky(C.numGlyphs,v);continue}I=!1;let T;if(c?(T=[C.anchorX,C.anchorY,c(C.anchorX,C.anchorY),1],Jl.transformMat4(T,T,e)):(T=[C.anchorX,C.anchorY,0,1],PP(T,T,e)),!ooe(T,y)){ky(C.numGlyphs,v);continue}let O=T[3],F=TP(r.transform.cameraToCenterDistance,O),k=SP(p,m,C),B=o?k/F:k*F,U=new Tw.default(C.anchorX,C.anchorY),z=yc(U,n,c).point,q={projections:{},offsets:{}},W=nR(C,B,!1,l,e,n,a,t.glyphOffsetArray,w,v,z,U,q,M,u,c);I=W.useVertical,(W.notEnoughRoom||I||W.needsFlipping&&nR(C,B,!0,l,e,n,a,t.glyphOffsetArray,w,v,z,U,q,M,u,c).notEnoughRoom)&&ky(C.numGlyphs,v)}i?t.text.dynamicLayoutVertexBuffer.updateData(v):t.icon.dynamicLayoutVertexBuffer.updateData(v)}s(soe,"updateLineLabels");function $F(t,e,r,i,n,a,o,l,u,c,p,m,y){let v=l.glyphStartIndex+l.numGlyphs,w=l.lineStartIndex,E=l.lineStartIndex+l.lineLength,M=e.getoffsetX(l.glyphStartIndex),I=e.getoffsetX(v-1),P=Pw(t*M,r,i,n,a,o,l.segment,w,E,u,c,p,m,y);if(!P)return null;let C=Pw(t*I,r,i,n,a,o,l.segment,w,E,u,c,p,m,y);return C?{first:P,last:C}:null}s($F,"placeFirstAndLastGlyph");function iR(t,e,r,i){if(t===1){let n=Math.abs(r.y-e.y),a=Math.abs(r.x-e.x)*i;if(n>a)return{useVertical:!0}}return(t===2?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}s(iR,"requiresOrientationChange");function nR(t,e,r,i,n,a,o,l,u,c,p,m,y,v,w,E){let M=e/24,I=t.lineOffsetX*M,P=t.lineOffsetY*M,C;if(t.numGlyphs>1){let T=t.glyphStartIndex+t.numGlyphs,O=t.lineStartIndex,F=t.lineStartIndex+t.lineLength,k=$F(M,l,I,P,r,p,m,t,u,a,y,w,E);if(!k)return{notEnoughRoom:!0};let B=yc(k.first.point,o,E).point,U=yc(k.last.point,o,E).point;if(i&&!r){let z=iR(t.writingMode,B,U,v);if(z)return z}C=[k.first];for(let z=t.glyphStartIndex+1;z<T-1;z++){let q=Pw(M*l.getoffsetX(z),I,P,r,p,m,t.segment,O,F,u,a,y,w,E);if(q==null)return{notEnoughRoom:!0};C.push(q)}C.push(k.last)}else{if(i&&!r){let O=yc(m,n,E).point,F=t.lineStartIndex+t.segment+1,k=new Tw.default(u.getx(F),u.gety(F)),B=yc(k,n,E),U=B.signedDistanceFromCamera>0?B.point:GF(m,k,O,1,n,E),z=iR(t.writingMode,O,U,v);if(z)return z}let T=Pw(M*l.getoffsetX(t.glyphStartIndex),I,P,r,p,m,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,a,y,w,E);if(!T)return{notEnoughRoom:!0};C=[T]}for(let T of C)x_(c,T.point,T.angle);return{}}s(nR,"placeGlyphsAlongLine");function GF(t,e,r,i,n,a){let o=yc(t.add(t.sub(e)._unit()),n,a).point,l=r.sub(o);return r.add(l._mult(i/l.mag()))}s(GF,"projectTruncatedLineSegment");function O3(t,e){let{projectionCache:r,lineVertexArray:i,labelPlaneMatrix:n,tileAnchorPoint:a,distanceFromAnchor:o,getElevation:l,previousVertex:u,direction:c,absOffsetX:p}=e;if(r.projections[t])return r.projections[t];let m=new Tw.default(i.getx(t),i.gety(t)),y=yc(m,n,l);if(y.signedDistanceFromCamera>0)return r.projections[t]=y.point,y.point;let v=t-c,w=o===0?a:new Tw.default(i.getx(v),i.gety(v));return GF(w,m,u,p-o+1,n,l)}s(O3,"projectVertexToViewport");function k3(t,e,r){return t._unit()._perp()._mult(e*r)}s(k3,"transformToOffsetNormal");function loe(t,e,r,i,n,a,o,l){let{projectionCache:u,direction:c}=l;if(u.offsets[t])return u.offsets[t];let p=r.add(e);if(t+c<i||t+c>=n)return u.offsets[t]=p,p;let m=O3(t+c,l),y=k3(m.sub(r),o,c),v=r.add(y),w=m.add(y);return u.offsets[t]=hZ(a,p,v,w)||p,u.offsets[t]}s(loe,"findOffsetIntersectionPoint");function Pw(t,e,r,i,n,a,o,l,u,c,p,m,y,v){let w=i?t-e:t+e,E=w>0?1:-1,M=0;i&&(E*=-1,M=Math.PI),E<0&&(M+=Math.PI);let I=E>0?l+o:l+o+1,P=n,C=n,T,O,F=0,k=0,B=Math.abs(w),U=[],z;for(;F+k<=B;){if(I+=E,I<l||I>=u)return null;F+=k,C=P,O=T;let V={projectionCache:m,lineVertexArray:c,labelPlaneMatrix:p,tileAnchorPoint:a,distanceFromAnchor:F,getElevation:v,previousVertex:C,direction:E,absOffsetX:B};if(P=O3(I,V),r===0)U.push(C),z=P.sub(C);else{let oe,Y=P.sub(C);if(Y.mag()===0){let he=O3(I+E,V);oe=k3(he.sub(P),r,E)}else oe=k3(Y,r,E);O||(O=C.add(oe)),T=loe(I,oe,P,l,u,O,r,V),U.push(O),z=T.sub(O)}k=z.mag()}let q=(B-F)/k,W=z._mult(q)._add(O||C),J=M+Math.atan2(P.y-C.y,P.x-C.x);return U.push(W),{point:W,angle:y?J:0,path:U}}s(Pw,"placeGlyphAlongLine");var L9e=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ky(t,e){for(let r=0;r<t;r++){let i=e.length;e.resize(i+4),e.float32.set(L9e,i*3)}}s(ky,"hideGlyphs");function PP(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t[3]=r[3]*i+r[7]*n+r[15],t}s(PP,"xyTransformMat4");var as=100,uoe=class{constructor(e,r=new oq(e.width+2*as,e.height+2*as,25),i=new oq(e.width+2*as,e.height+2*as,25)){this.transform=e,this.grid=r,this.ignoredGrid=i,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+as,this.screenBottomBoundary=e.height+as,this.gridRightBoundary=e.width+2*as,this.gridBottomBoundary=e.height+2*as,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,i,n,a,o){let l=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,o),u=i*l.perspectiveRatio,c=e.x1*u+l.point.x,p=e.y1*u+l.point.y,m=e.x2*u+l.point.x,y=e.y2*u+l.point.y;return!this.isInsideGrid(c,p,m,y)||r!=="always"&&this.grid.hitTest(c,p,m,y,r,a)||l.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[c,p,m,y],offscreen:this.isOffscreen(c,p,m,y)}}placeCollisionCircles(e,r,i,n,a,o,l,u,c,p,m,y,v,w){let E=[],M=new Ad.default(r.anchorX,r.anchorY),I=yc(M,o,w),P=TP(this.transform.cameraToCenterDistance,I.signedDistanceFromCamera),C=(p?a/P:a*P)/Tne,T=yc(M,l,w).point,O={projections:{},offsets:{}},F=r.lineOffsetX*C,k=r.lineOffsetY*C,B=$F(C,n,F,k,!1,T,M,r,i,l,O,!1,w),U=!1,z=!1,q=!0;if(B){let W=y*.5*P+v,J=new Ad.default(-as,-as),V=new Ad.default(this.screenRightBoundary,this.screenBottomBoundary),oe=new P9e,Y=B.first,he=B.last,Q=[];for(let le=Y.path.length-1;le>=1;le--)Q.push(Y.path[le]);for(let le=1;le<he.path.length;le++)Q.push(he.path[le]);let ae=W*2.5;if(u){let le=Q.map(K=>yc(K,u,w));le.some(K=>K.signedDistanceFromCamera<=0)?Q=[]:Q=le.map(K=>K.point)}let ee=[];if(Q.length>0){let le=Q[0].clone(),K=Q[0].clone();for(let ce=1;ce<Q.length;ce++)le.x=Math.min(le.x,Q[ce].x),le.y=Math.min(le.y,Q[ce].y),K.x=Math.max(K.x,Q[ce].x),K.y=Math.max(K.y,Q[ce].y);le.x>=J.x&&K.x<=V.x&&le.y>=J.y&&K.y<=V.y?ee=[Q]:K.x<J.x||le.x>V.x||K.y<J.y||le.y>V.y?ee=[]:ee=ioe([Q],J.x,J.y,V.x,V.y)}for(let le of ee){oe.reset(le,W*.25);let K=0;oe.length<=.5*W?K=1:K=Math.ceil(oe.paddedLength/ae)+1;for(let ce=0;ce<K;ce++){let te=ce/Math.max(K-1,1),ne=oe.lerp(te),pe=ne.x+as,xe=ne.y+as;E.push(pe,xe,W,0);let Te=pe-W,fe=xe-W,Pe=pe+W,me=xe+W;if(q=q&&this.isOffscreen(Te,fe,Pe,me),z=z||this.isInsideGrid(Te,fe,Pe,me),e!=="always"&&this.grid.hitTestCircle(pe,xe,W,e,m)&&(U=!0,!c))return{circles:[],offscreen:!1,collisionDetected:U}}}}return{circles:!c&&U||!z||P<this.perspectiveRatioCutoff?[]:E,offscreen:q,collisionDetected:U}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let r=[],i=1/0,n=1/0,a=-1/0,o=-1/0;for(let p of e){let m=new Ad.default(p.x+as,p.y+as);i=Math.min(i,m.x),n=Math.min(n,m.y),a=Math.max(a,m.x),o=Math.max(o,m.y),r.push(m)}let l=this.grid.query(i,n,a,o).concat(this.ignoredGrid.query(i,n,a,o)),u={},c={};for(let p of l){let m=p.key;if(u[m.bucketInstanceId]===void 0&&(u[m.bucketInstanceId]={}),u[m.bucketInstanceId][m.featureIndex])continue;let y=[new Ad.default(p.x1,p.y1),new Ad.default(p.x2,p.y1),new Ad.default(p.x2,p.y2),new Ad.default(p.x1,p.y2)];V7(r,y)&&(u[m.bucketInstanceId][m.featureIndex]=!0,c[m.bucketInstanceId]===void 0&&(c[m.bucketInstanceId]=[]),c[m.bucketInstanceId].push(m.featureIndex))}return c}insertCollisionBox(e,r,i,n,a,o){let l=i?this.ignoredGrid:this.grid,u={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:r};l.insert(u,e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,i,n,a,o){let l=i?this.ignoredGrid:this.grid,u={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:r};for(let c=0;c<e.length;c+=4)l.insertCircle(u,e[c],e[c+1],e[c+2])}projectAndGetPerspectiveRatio(e,r,i,n){let a;return n?(a=[r,i,n(r,i),1],Jl.transformMat4(a,a,e)):(a=[r,i,0,1],PP(a,a,e)),{point:new Ad.default((a[0]/a[3]+1)/2*this.transform.width+as,(-a[1]/a[3]+1)/2*this.transform.height+as),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/a[3])}}isOffscreen(e,r,i,n){return i<as||e>=this.screenRightBoundary||n<as||r>this.screenBottomBoundary}isInsideGrid(e,r,i,n){return i>=0&&e<this.gridRightBoundary&&n>=0&&r<this.gridBottomBoundary}getViewportMatrix(){let e=Nr.identity([]);return Nr.translate(e,e,[-as,-as,0]),e}};s(uoe,"CollisionIndex");var D9e=uoe;N();N();var R9e=kr(Nn(),1),coe=class hoe extends R9e.default{constructor(e,r,i,n){super(e,r),this.angle=i,n!==void 0&&(this.segment=n)}clone(){return new hoe(this.x,this.y,this.angle,this.segment)}};s(coe,"Anchor");var O9e=coe;Rr("Anchor",O9e);N();N();N();kr(Nn(),1);N();kr(Nn(),1);N();kr(S9(),1);kr(Nn(),1);kr(eZ(),1);N();var aR=(t=>(t[t.center=1]="center",t[t.left=2]="left",t[t.right=3]="right",t[t.top=4]="top",t[t.bottom=5]="bottom",t[t["top-left"]=6]="top-left",t[t["top-right"]=7]="top-right",t[t["bottom-left"]=8]="bottom-left",t[t["bottom-right"]=9]="bottom-right",t))(aR||{});function poe(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}s(poe,"getAnchorJustification");N();function ku(t,e,r){return e*(8192/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}s(ku,"pixelsToTileUnits");var HF=kr(Nn(),1),doe=class{constructor(e,r,i,n){e?this.opacity=Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):this.opacity=n&&i?1:0,this.placed=i}isHidden(){return this.opacity===0&&!this.placed}};s(doe,"OpacityState");var sq=doe,foe=class{constructor(e,r,i,n,a){this.text=new sq(e?e.text:null,r,i,a),this.icon=new sq(e?e.icon:null,r,n,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}};s(foe,"JointOpacityState");var Sb=foe,moe=class{constructor(e,r,i){this.text=e,this.icon=r,this.skipFade=i}};s(moe,"JointPlacement");var lq=moe,goe=class{constructor(){this.invProjMatrix=Nr.create(),this.viewportMatrix=Nr.create(),this.circles=[]}};s(goe,"CollisionCircleArray");var k9e=goe,yoe=class{constructor(e,r,i,n,a){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=a}};s(yoe,"RetainedQueryData");var N9e=yoe,voe=class{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:s(i=>i.collisionGroupID===r,"predicate")}}return this.collisionGroups[e]}};s(voe,"CollisionGroups");var F9e=voe;function oR(t,e,r,i,n){let{horizontalAlign:a,verticalAlign:o}=OF(t),l=-(a-.5)*e,u=-(o-.5)*r;return new HF.default(l+i[0]*n,u+i[1]*n)}s(oR,"calculateVariableLayoutShift");function $E(t,e,r,i,n,a){let{x1:o,x2:l,y1:u,y2:c,anchorPointX:p,anchorPointY:m}=t,y=new HF.default(e,r);return i&&y._rotate(n?a:-a),{x1:o+y.x,y1:u+y.y,x2:l+y.x,y2:c+y.y,anchorPointX:p,anchorPointY:m}}s($E,"shiftVariableCollisionBox");var _oe=class{constructor(e,r,i,n,a){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new D9e(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new F9e(n),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,r,i,n){let a=i.getBucket(r),o=i.latestFeatureIndex;if(!a||!o||r.id!==a.layerIds[0])return;let l=i.collisionBoxArray,u=a.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),p=i.tileSize/8192,m=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),y=u.get("text-pitch-alignment")==="map",v=u.get("text-rotation-alignment")==="map",w=ku(i,1,this.transform.zoom),E=IP(m,y,v,this.transform,w),M=null;if(y){let P=jF(m,y,v,this.transform,w);M=Nr.multiply([],this.transform.labelPlaneMatrix,P)}this.retainedQueryData[a.bucketInstanceId]=new N9e(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,i.tileID);let I={bucket:a,layout:u,posMatrix:m,textLabelPlaneMatrix:E,labelToScreenMatrix:M,scale:c,textPixelRatio:p,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:IA(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(n)for(let P of a.sortKeyRanges){let{sortKey:C,symbolInstanceStart:T,symbolInstanceEnd:O}=P;e.push({sortKey:C,symbolInstanceStart:T,symbolInstanceEnd:O,parameters:I})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:I})}attemptAnchorPlacement(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M){let I=aR[e.textAnchor],P=[e.textOffset0,e.textOffset1],C=oR(I,i,n,P,a),T=this.collisionIndex.placeCollisionBox($E(r,C.x,C.y,o,l,this.transform.angle),m,u,c,p.predicate,M);if(!(E&&this.collisionIndex.placeCollisionBox($E(E,C.x,C.y,o,l,this.transform.angle),m,u,c,p.predicate,M).box.length===0)&&T.box.length>0){let O;if(this.prevPlacement&&this.prevPlacement.variableOffsets[y.crossTileID]&&this.prevPlacement.placements[y.crossTileID]&&this.prevPlacement.placements[y.crossTileID].text&&(O=this.prevPlacement.variableOffsets[y.crossTileID].anchor),y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[y.crossTileID]={textOffset:P,width:i,height:n,anchor:I,textBoxScale:a,prevAnchor:O},this.markUsedJustification(v,I,y,w),v.allowVerticalPlacement&&(this.markUsedOrientation(v,w,y),this.placedOrientations[y.crossTileID]=w),{shift:C,placedGlyphBoxes:T}}}placeLayerBucketPart(e,r,i){let{bucket:n,layout:a,posMatrix:o,textLabelPlaneMatrix:l,labelToScreenMatrix:u,textPixelRatio:c,holdingForFade:p,collisionBoxArray:m,partiallyEvaluatedTextSize:y,collisionGroup:v}=e.parameters,w=a.get("text-optional"),E=a.get("icon-optional"),M=Ew(a,"text-overlap","text-allow-overlap"),I=M==="always",P=Ew(a,"icon-overlap","icon-allow-overlap"),C=P==="always",T=a.get("text-rotation-alignment")==="map",O=a.get("text-pitch-alignment")==="map",F=a.get("icon-text-fit")!=="none",k=a.get("symbol-z-order")==="viewport-y",B=I&&(C||!n.hasIconData()||E),U=C&&(I||!n.hasTextData()||w);!n.collisionArrays&&m&&n.deserializeCollisionBoxes(m);let z=this.retainedQueryData[n.bucketInstanceId].tileID,q=this.terrain?(J,V)=>this.terrain.getElevation(z,J,V):null,W=s((J,V)=>{var oe,Y;if(r[J.crossTileID])return;if(p){this.placements[J.crossTileID]=new lq(!1,!1,!1);return}let he=!1,Q=!1,ae=!0,ee=null,le={box:null,offscreen:null},K={box:null},ce=null,te=null,ne=null,pe=0,xe=0,Te=0;V.textFeatureIndex?pe=V.textFeatureIndex:J.useRuntimeCollisionCircles&&(pe=J.featureIndex),V.verticalTextFeatureIndex&&(xe=V.verticalTextFeatureIndex);let fe=V.textBox;if(fe){let Ae=s(tt=>{let We=1;if(n.allowVerticalPlacement&&!tt&&this.prevPlacement){let at=this.prevPlacement.placedOrientations[J.crossTileID];at&&(this.placedOrientations[J.crossTileID]=at,We=at,this.markUsedOrientation(n,We,J))}return We},"updatePreviousOrientationIfNotPlaced"),Ue=s((tt,We)=>{if(n.allowVerticalPlacement&&J.numVerticalGlyphVertices>0&&V.verticalTextBox){for(let at of n.writingModes)if(at===2?(le=We(),K=le):le=tt(),le&&le.box&&le.box.length)break}else le=tt()},"placeTextForPlacementModes"),_e=J.textAnchorOffsetStartIndex,lt=J.textAnchorOffsetEndIndex;if(lt===_e){let tt=s((We,at)=>{let Lt=this.collisionIndex.placeCollisionBox(We,M,c,o,v.predicate,q);return Lt&&Lt.box&&Lt.box.length&&(this.markUsedOrientation(n,at,J),this.placedOrientations[J.crossTileID]=at),Lt},"placeBox");Ue(s(()=>tt(fe,1),"placeHorizontal"),s(()=>{let We=V.verticalTextBox;return n.allowVerticalPlacement&&J.numVerticalGlyphVertices>0&&We?tt(We,2):{box:null,offscreen:null}},"placeVertical")),Ae(le&&le.box&&le.box.length)}else{let tt=aR[(Y=(oe=this.prevPlacement)==null?void 0:oe.variableOffsets[J.crossTileID])==null?void 0:Y.anchor],We=s((Lt,dt,Me)=>{let ve=Lt.x2-Lt.x1,Ze=Lt.y2-Lt.y1,It=J.textBoxScale,Rt=F&&P==="never"?dt:null,Et={box:[],offscreen:!1},pt=M==="never"?1:2,Yt="never";tt&&pt++;for(let Kt=0;Kt<pt;Kt++){for(let $t=_e;$t<lt;$t++){let jt=n.textAnchorOffsets.get($t);if(tt&&jt.textAnchor!==tt)continue;let Nt=this.attemptAnchorPlacement(jt,Lt,ve,Ze,It,T,O,c,o,v,Yt,J,n,Me,Rt,q);if(Nt&&(Et=Nt.placedGlyphBoxes,Et&&Et.box&&Et.box.length))return he=!0,ee=Nt.shift,Et}tt?tt=null:Yt=M}return Et},"placeBoxForVariableAnchors");Ue(s(()=>We(fe,V.iconBox,1),"placeHorizontal"),s(()=>{let Lt=V.verticalTextBox,dt=le&&le.box&&le.box.length;return n.allowVerticalPlacement&&!dt&&J.numVerticalGlyphVertices>0&&Lt?We(Lt,V.verticalIconBox,2):{box:null,offscreen:null}},"placeVertical")),le&&(he=le.box,ae=le.offscreen);let at=Ae(le&&le.box);if(!he&&this.prevPlacement){let Lt=this.prevPlacement.variableOffsets[J.crossTileID];Lt&&(this.variableOffsets[J.crossTileID]=Lt,this.markUsedJustification(n,Lt.anchor,J,at))}}}if(ce=le,he=ce&&ce.box&&ce.box.length>0,ae=ce&&ce.offscreen,J.useRuntimeCollisionCircles){let Ae=n.text.placedSymbolArray.get(J.centerJustifiedTextSymbolIndex),Ue=SP(n.textSizeData,y,Ae),_e=a.get("text-padding"),lt=J.collisionCircleDiameter;te=this.collisionIndex.placeCollisionCircles(M,Ae,n.lineVertexArray,n.glyphOffsetArray,Ue,o,l,u,i,O,v.predicate,lt,_e,q),te.circles.length&&te.collisionDetected&&!i&&kl("Collisions detected, but collision boxes are not shown"),he=I||te.circles.length>0&&!te.collisionDetected,ae=ae&&te.offscreen}if(V.iconFeatureIndex&&(Te=V.iconFeatureIndex),V.iconBox){let Ae=s(Ue=>{let _e=F&&ee?$E(Ue,ee.x,ee.y,T,O,this.transform.angle):Ue;return this.collisionIndex.placeCollisionBox(_e,P,c,o,v.predicate,q)},"placeIconFeature");K&&K.box&&K.box.length&&V.verticalIconBox?(ne=Ae(V.verticalIconBox),Q=ne.box.length>0):(ne=Ae(V.iconBox),Q=ne.box.length>0),ae=ae&&ne.offscreen}let Pe=w||J.numHorizontalGlyphVertices===0&&J.numVerticalGlyphVertices===0,me=E||J.numIconVertices===0;if(!Pe&&!me?Q=he=Q&&he:me?Pe||(Q=Q&&he):he=Q&&he,he&&ce&&ce.box&&(K&&K.box&&xe?this.collisionIndex.insertCollisionBox(ce.box,M,a.get("text-ignore-placement"),n.bucketInstanceId,xe,v.ID):this.collisionIndex.insertCollisionBox(ce.box,M,a.get("text-ignore-placement"),n.bucketInstanceId,pe,v.ID)),Q&&ne&&this.collisionIndex.insertCollisionBox(ne.box,P,a.get("icon-ignore-placement"),n.bucketInstanceId,Te,v.ID),te&&(he&&this.collisionIndex.insertCollisionCircles(te.circles,M,a.get("text-ignore-placement"),n.bucketInstanceId,pe,v.ID),i)){let Ae=n.bucketInstanceId,Ue=this.collisionCircleArrays[Ae];Ue===void 0&&(Ue=this.collisionCircleArrays[Ae]=new k9e);for(let _e=0;_e<te.circles.length;_e+=4)Ue.circles.push(te.circles[_e+0]),Ue.circles.push(te.circles[_e+1]),Ue.circles.push(te.circles[_e+2]),Ue.circles.push(te.collisionDetected?1:0)}if(J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(n.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[J.crossTileID]=new lq(he||B,Q||U,ae||n.justReloaded),r[J.crossTileID]=!0},"placeSymbol");if(k){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let J=n.getSortedSymbolIndexes(this.transform.angle);for(let V=J.length-1;V>=0;--V){let oe=J[V];W(n.symbolInstances.get(oe),n.collisionArrays[oe])}}else for(let J=e.symbolInstanceStart;J<e.symbolInstanceEnd;J++)W(n.symbolInstances.get(J),n.collisionArrays[J]);if(i&&n.bucketInstanceId in this.collisionCircleArrays){let J=this.collisionCircleArrays[n.bucketInstanceId];Nr.invert(J.invProjMatrix,o),J.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}markUsedJustification(e,r,i,n){let a={left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex},o;n===2?o=i.verticalPlacedTextSymbolIndex:o=a[poe(r)];let l=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(let u of l)u>=0&&(o>=0&&u!==o?e.text.placedSymbolArray.get(u).crossTileID=0:e.text.placedSymbolArray.get(u).crossTileID=i.crossTileID)}markUsedOrientation(e,r,i){let n=r===1||r===3?r:0,a=r===2?r:0,o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(let l of o)e.text.placedSymbolArray.get(l).placedOrientation=n;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let r=this.prevPlacement,i=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;let n=r?r.symbolFadeChange(e):1,a=r?r.opacities:{},o=r?r.variableOffsets:{},l=r?r.placedOrientations:{};for(let u in this.placements){let c=this.placements[u],p=a[u];p?(this.opacities[u]=new Sb(p,n,c.text,c.icon),i=i||c.text!==p.text.placed||c.icon!==p.icon.placed):(this.opacities[u]=new Sb(null,n,c.text,c.icon,c.skipFade),i=i||c.text||c.icon)}for(let u in a){let c=a[u];if(!this.opacities[u]){let p=new Sb(c,n,!1,!1);p.isHidden()||(this.opacities[u]=p,i=i||c.text.placed||c.icon.placed)}}for(let u in o)!this.variableOffsets[u]&&this.opacities[u]&&!this.opacities[u].isHidden()&&(this.variableOffsets[u]=o[u]);for(let u in l)!this.placedOrientations[u]&&this.opacities[u]&&!this.opacities[u].isHidden()&&(this.placedOrientations[u]=l[u]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){let i={};for(let n of r){let a=n.getBucket(e);a&&n.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,i,n.collisionBoxArray)}}updateBucketOpacities(e,r,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let n=e.layers[0],a=n.layout,o=new Sb(null,0,!1,!1,!0),l=a.get("text-allow-overlap"),u=a.get("icon-allow-overlap"),c=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),p=a.get("text-rotation-alignment")==="map",m=a.get("text-pitch-alignment")==="map",y=a.get("icon-text-fit")!=="none",v=new Sb(null,0,l&&(u||!e.hasIconData()||a.get("icon-optional")),u&&(l||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);let w=s((E,M,I)=>{for(let P=0;P<M/4;P++)E.opacityVertexArray.emplaceBack(I);E.hasVisibleVertices=E.hasVisibleVertices||I!==Mb},"addOpacities");for(let E=0;E<e.symbolInstances.length;E++){let M=e.symbolInstances.get(E),{numHorizontalGlyphVertices:I,numVerticalGlyphVertices:P,crossTileID:C}=M,T=r[C],O=this.opacities[C];T?O=o:O||(O=v,this.opacities[C]=O),r[C]=!0;let F=I>0||P>0,k=M.numIconVertices>0,B=this.placedOrientations[M.crossTileID],U=B===2,z=B===1||B===3;if(F){let q=sR(O.text),W=U?Mb:q;w(e.text,I,W);let J=z?Mb:q;w(e.text,P,J);let V=O.text.isHidden();[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach(he=>{he>=0&&(e.text.placedSymbolArray.get(he).hidden=V||U?1:0)}),M.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(M.verticalPlacedTextSymbolIndex).hidden=V||z?1:0);let oe=this.variableOffsets[M.crossTileID];oe&&this.markUsedJustification(e,oe.anchor,M,B);let Y=this.placedOrientations[M.crossTileID];Y&&(this.markUsedJustification(e,"left",M,Y),this.markUsedOrientation(e,Y,M))}if(k){let q=sR(O.icon),W=!(y&&M.verticalPlacedIconSymbolIndex&&U);if(M.placedIconSymbolIndex>=0){let J=W?q:Mb;w(e.icon,M.numIconVertices,J),e.icon.placedSymbolArray.get(M.placedIconSymbolIndex).hidden=O.icon.isHidden()}if(M.verticalPlacedIconSymbolIndex>=0){let J=W?Mb:q;w(e.icon,M.numVerticalIconVertices,J),e.icon.placedSymbolArray.get(M.verticalPlacedIconSymbolIndex).hidden=O.icon.isHidden()}}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let q=e.collisionArrays[E];if(q){let W=new HF.default(0,0);if(q.textBox||q.verticalTextBox){let V=!0;if(c){let oe=this.variableOffsets[C];oe?(W=oR(oe.anchor,oe.width,oe.height,oe.textOffset,oe.textBoxScale),p&&W._rotate(m?this.transform.angle:-this.transform.angle)):V=!1}q.textBox&&s2(e.textCollisionBox.collisionVertexArray,O.text.placed,!V||U,W.x,W.y),q.verticalTextBox&&s2(e.textCollisionBox.collisionVertexArray,O.text.placed,!V||z,W.x,W.y)}let J=!!(!z&&q.verticalIconBox);q.iconBox&&s2(e.iconCollisionBox.collisionVertexArray,O.icon.placed,J,y?W.x:0,y?W.y:0),q.verticalIconBox&&s2(e.iconCollisionBox.collisionVertexArray,O.icon.placed,!J,y?W.x:0,y?W.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(e.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(e.text.layoutVertexArray.length,") / 4"));if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(e.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(e.icon.layoutVertexArray.length,") / 4"));if(e.bucketInstanceId in this.collisionCircleArrays){let E=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=E.invProjMatrix,e.placementViewportMatrix=E.viewportMatrix,e.collisionCircleArray=E.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){let i=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}};s(_oe,"Placement");var B9e=_oe;function s2(t,e,r,i,n){t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0)}s(s2,"updateCollisionVertices");var z9e=Math.pow(2,25),U9e=Math.pow(2,24),V9e=Math.pow(2,17),j9e=Math.pow(2,16),$9e=Math.pow(2,9),G9e=Math.pow(2,8),H9e=Math.pow(2,1);function sR(t){if(t.opacity===0&&!t.placed)return 0;if(t.opacity===1&&t.placed)return 4294967295;let e=t.placed?1:0,r=Math.floor(t.opacity*127);return r*z9e+e*U9e+r*V9e+e*j9e+r*$9e+e*G9e+r*H9e+e}s(sR,"packOpacity");var Mb=0,xoe=class{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,i,n,a){let o=this._bucketParts;for(;this._currentTileIndex<e.length;){let l=e[this._currentTileIndex];if(r.getBucketParts(o,n,l,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((l,u)=>l.sortKey-u.sortKey));this._currentPartIndex<o.length;){let l=o[this._currentPartIndex];if(r.placeLayerBucketPart(l,this._seenCrossTileIDs,i),this._currentPartIndex++,a())return!0}return!1}};s(xoe,"LayerPlacement");var q9e=xoe,boe=class{constructor(e,r,i,n,a,o,l,u){this.placement=new B9e(e,r,o,l,u),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,r,i){let n=vn.now(),a=s(()=>this._forceFullPlacement?!1:vn.now()-n>2,"shouldPausePlacement");for(;this._currentPlacementIndex>=0;){let o=e[this._currentPlacementIndex],l=r[o],u=this.placement.collisionIndex.transform.zoom;if(l.type==="symbol"&&(!l.minzoom||l.minzoom<=u)&&(!l.maxzoom||l.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new q9e(l)),this._inProgressLayer.continuePlacement(i[l.source],this.placement,this._showCollisionBoxes,l,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}};s(boe,"PauseablePlacement");var W9e=boe;N();N();var uq=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],NL=1,Eb=8,woe=class Aoe{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let n=i>>4;if(n!==NL)throw new Error("Got v".concat(n," data when expected v").concat(NL,"."));let a=uq[i&15];if(!a)throw new Error("Unrecognized array type.");let[o]=new Uint16Array(e,2,1),[l]=new Uint32Array(e,4,1);return new Aoe(l,o,a,e)}constructor(e,r=64,i=Float64Array,n){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=uq.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,l=e*this.IndexArrayType.BYTES_PER_ELEMENT,u=(8-l%8)%8;if(a<0)throw new Error("Unexpected typed array class: ".concat(i,"."));n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,Eb,e),this.coords=new this.ArrayType(this.data,Eb+l+u,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Eb+o+l+u),this.ids=new this.IndexArrayType(this.data,Eb,e),this.coords=new this.ArrayType(this.data,Eb+l+u,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(NL<<4)+a]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return N3(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:a,coords:o,nodeSize:l}=this,u=[0,a.length-1,0],c=[];for(;u.length;){let p=u.pop()||0,m=u.pop()||0,y=u.pop()||0;if(m-y<=l){for(let M=y;M<=m;M++){let I=o[2*M],P=o[2*M+1];I>=e&&I<=i&&P>=r&&P<=n&&c.push(a[M])}continue}let v=y+m>>1,w=o[2*v],E=o[2*v+1];w>=e&&w<=i&&E>=r&&E<=n&&c.push(a[v]),(p===0?e<=w:r<=E)&&(u.push(y),u.push(v-1),u.push(1-p)),(p===0?i>=w:n>=E)&&(u.push(v+1),u.push(m),u.push(1-p))}return c}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:n,coords:a,nodeSize:o}=this,l=[0,n.length-1,0],u=[],c=i*i;for(;l.length;){let p=l.pop()||0,m=l.pop()||0,y=l.pop()||0;if(m-y<=o){for(let M=y;M<=m;M++)lR(a[2*M],a[2*M+1],e,r)<=c&&u.push(n[M]);continue}let v=y+m>>1,w=a[2*v],E=a[2*v+1];lR(w,E,e,r)<=c&&u.push(n[v]),(p===0?e-i<=w:r-i<=E)&&(l.push(y),l.push(v-1),l.push(1-p)),(p===0?e+i>=w:r+i>=E)&&(l.push(v+1),l.push(m),l.push(1-p))}return u}};s(woe,"KDBush");var X9e=woe;function N3(t,e,r,i,n,a){if(n-i<=r)return;let o=i+n>>1;qF(t,e,o,i,n,a),N3(t,e,r,i,o-1,1-a),N3(t,e,r,o+1,n,1-a)}s(N3,"sort");function qF(t,e,r,i,n,a){for(;n>i;){if(n-i>600){let c=n-i+1,p=r-i+1,m=Math.log(c),y=.5*Math.exp(2*m/3),v=.5*Math.sqrt(m*y*(c-y)/c)*(p-c/2<0?-1:1),w=Math.max(i,Math.floor(r-p*y/c+v)),E=Math.min(n,Math.floor(r+(c-p)*y/c+v));qF(t,e,r,w,E,a)}let o=e[2*r+a],l=i,u=n;for(I0(t,e,i,r),e[2*n+a]>o&&I0(t,e,i,n);l<u;){for(I0(t,e,l,u),l++,u--;e[2*l+a]<o;)l++;for(;e[2*u+a]>o;)u--}e[2*i+a]===o?I0(t,e,i,u):(u++,I0(t,e,u,n)),u<=r&&(i=u+1),r<=u&&(n=u-1)}}s(qF,"select");function I0(t,e,r,i){GE(t,r,i),GE(e,2*r,2*i),GE(e,2*r+1,2*i+1)}s(I0,"swapItem");function GE(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}s(GE,"swap");function lR(t,e,r,i){let n=t-r,a=e-i;return n*n+a*a}s(lR,"sqDist");var Cb=512/8192/2,Z9e=128,Soe=class{constructor(e,r,i){this.tileID=e,this.bucketInstanceId=i,this._symbolsByKey={};let n=new Map;for(let a=0;a<r.length;a++){let o=r.get(a),l=o.key,u=n.get(l);u?u.push(o):n.set(l,[o])}for(let[a,o]of n){let l=o.map(p=>({x:Math.floor(p.anchorX*Cb),y:Math.floor(p.anchorY*Cb)})),u=o.map(p=>p.crossTileID),c={positions:l,crossTileIDs:u};if(c.positions.length>Z9e){let p=new X9e(c.positions.length,16,Uint16Array);for(let{x:m,y}of c.positions)p.add(m,y);p.finish(),delete c.positions,c.index=p}this._symbolsByKey[a]=c}}getScaledCoordinates(e,r){let{x:i,y:n,z:a}=this.tileID.canonical,{x:o,y:l,z:u}=r.canonical,c=u-a,p=Cb/Math.pow(2,c),m=(o*8192+e.anchorX)*p,y=(l*8192+e.anchorY)*p,v=i*8192*Cb,w=n*8192*Cb;return{x:Math.floor(m-v),y:Math.floor(y-w)}}findMatches(e,r,i){let n=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let a=0;a<e.length;a++){let o=e.get(a);if(o.crossTileID)continue;let l=this._symbolsByKey[o.key];if(!l)continue;let u=this.getScaledCoordinates(o,r);if(l.index){let c=l.index.range(u.x-n,u.y-n,u.x+n,u.y+n).sort();for(let p of c){let m=l.crossTileIDs[p];if(!i[m]){i[m]=!0,o.crossTileID=m;break}}}else if(l.positions)for(let c=0;c<l.positions.length;c++){let p=l.positions[c],m=l.crossTileIDs[c];if(Math.abs(p.x-u.x)<=n&&Math.abs(p.y-u.y)<=n&&!i[m]){i[m]=!0,o.crossTileID=m;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}};s(Soe,"TileLayerIndex");var Y9e=Soe,Moe=class{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}};s(Moe,"CrossTileIDs");var K9e=Moe,Eoe=class{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let r=Math.round((e-this.lng)/360);if(r!==0)for(let i in this.indexes){let n=this.indexes[i],a={};for(let o in n){let l=n[o];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+r),a[l.tileID.key]=l}this.indexes[i]=a}this.lng=e}addBucket(e,r,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let a=0;a<r.symbolInstances.length;a++){let o=r.symbolInstances.get(a);o.crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let n=this.usedCrossTileIDs[e.overscaledZ];for(let a in this.indexes){let o=this.indexes[a];if(Number(a)>e.overscaledZ)for(let l in o){let u=o[l];u.tileID.isChildOf(e)&&u.findMatches(r.symbolInstances,e,n)}else{let l=e.scaledTo(Number(a)),u=o[l.key];u&&u.findMatches(r.symbolInstances,e,n)}}for(let a=0;a<r.symbolInstances.length;a++){let o=r.symbolInstances.get(a);o.crossTileID||(o.crossTileID=i.generate(),n[o.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Y9e(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(let i of r.getCrossTileIDsLists())for(let n of i)delete this.usedCrossTileIDs[e][n]}removeStaleBuckets(e){let r=!1;for(let i in this.indexes){let n=this.indexes[i];for(let a in n)e[n[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[a]),delete n[a],r=!0)}return r}};s(Eoe,"CrossTileSymbolLayerIndex");var J9e=Eoe,Coe=class{constructor(){this.layerIndexes={},this.crossTileIDs=new K9e,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,i){let n=this.layerIndexes[e.id];n===void 0&&(n=this.layerIndexes[e.id]=new J9e);let a=!1,o={};n.handleWrapJump(i);for(let l of r){let u=l.getBucket(e);!u||e.id!==u.layerIds[0]||(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(a=!0),o[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(a=!0),a}pruneUnusedLayers(e){let r={};e.forEach(i=>{r[i]=!0});for(let i in this.layerIndexes)r[i]||delete this.layerIndexes[i]}};s(Coe,"CrossTileSymbolIndex");var Ioe=Coe,TM=s((t,e)=>pP(t,e&&e.filter(r=>r.identifier!=="source.canvas")),"emitValidationErrors"),Q9e=lJ(),Toe=class extends Fl{constructor(e,r={}){super(),this._rtlPluginLoaded=s(()=>{for(let i in this.sourceCaches){let n=this.sourceCaches[i].getSource().type;(n==="vector"||n==="geojson")&&this.sourceCaches[i].reload()}},"_rtlPluginLoaded"),this.map=e,this.dispatcher=new hae(EP(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(i,n)=>this.getGlyphs(i,n)),this.dispatcher.registerMessageHandler("GI",(i,n)=>this.getImages(i,n)),this.imageManager=new e9e,this.imageManager.setEventedParent(this),this.glyphManager=new r9e(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new a9e(256,512),this.crossTileSymbolIndex=new Ioe,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new bJ,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",P9()),w_().on(eR,this._rtlPluginLoaded),this.on("data",i=>{if(i.dataType!=="source"||i.sourceDataType!=="metadata")return;let n=this.sourceCaches[i.sourceId];if(!n)return;let a=n.getSource();if(!(!a||!a.vectorLayerIds))for(let o in this._layers){let l=this._layers[o];l.source===a.id&&this._validateLayer(l)}})}loadURL(e,r={},i){this.fire(new pr("dataloading",{dataType:"style"})),r.validate=typeof r.validate=="boolean"?r.validate:!0;let n=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,KT(n,this._loadStyleRequest).then(a=>{this._loadStyleRequest=null,this._load(a.data,r,i)}).catch(a=>{this._loadStyleRequest=null,a&&this.fire(new fi(a))})}loadJSON(e,r={},i){this.fire(new pr("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,vn.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,i)}).catch(()=>{})}loadEmpty(){this.fire(new pr("dataloading",{dataType:"style"})),this._load(Q9e,{validate:!1})}_load(e,r,i){var n;let a=r.transformStyle?r.transformStyle(i,e):e;if(!(r.validate&&TM(this,Ms(a)))){this._loaded=!0,this.stylesheet=a;for(let o in a.sources)this.addSource(o,a.sources[o],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new n9e(this.stylesheet.light),this.map.setTerrain((n=this.stylesheet.terrain)!=null?n:null),this.fire(new pr("data",{dataType:"style"})),this.fire(new pr("style.load"))}}_createLayers(){let e=rD(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(let r of e){let i=VE(r);i.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=i}}_loadSprite(e,r=!1,i=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController;let n;Zne(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(a=>{if(this._spriteRequest=null,a)for(let o in a){this._spritesImagesIds[o]=[];let l=this._spritesImagesIds[o]?this._spritesImagesIds[o].filter(u=>!(u in a)):[];for(let u of l)this.imageManager.removeImage(u),this._changedImages[u]=!0;for(let u in a[o]){let c=o==="default"?u:"".concat(o,":").concat(u);this._spritesImagesIds[o].push(c),c in this.imageManager.images?this.imageManager.updateImage(c,a[o][u],!1):this.imageManager.addImage(c,a[o][u]),r&&(this._changedImages[c]=!0)}}}).catch(a=>{this._spriteRequest=null,n=a,this.fire(new fi(n))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"})),i&&i(n)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"}))}_validateLayer(e){let r=this.sourceCaches[e.source];if(!r)return;let i=e.sourceLayer;if(!i)return;let n=r.getSource();(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(i)===-1)&&this.fire(new fi(new Error('Source layer "'.concat(i,'" ')+'does not exist on source "'.concat(n.id,'" ')+'as specified by style layer "'.concat(e.id,'".'))))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let r=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r);let i=[];for(let n of e)r[n]&&i.push(r[n]);return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let r=Object.keys(this._layers);for(let i of r){let n=this._layers[i];n.type!=="custom"&&(e[i]=n.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let r=this._changed;if(r){let n=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);(n.length||a.length)&&this._updateWorkerLayers(n,a);for(let o in this._updatedSources){let l=this._updatedSources[o];if(l==="reload")this._reloadSource(o);else if(l==="clear")this._clearSource(o);else throw new Error("Invalid action ".concat(l))}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}let i={};for(let n in this.sourceCaches){let a=this.sourceCaches[n];i[n]=a.used,a.used=!1}for(let n of this._order){let a=this._layers[n];a.recalculate(e,this._availableImages),!a.isHidden(e.zoom)&&a.source&&(this.sourceCaches[a.source].used=!0)}for(let n in i){let a=this.sourceCaches[n];!!i[n]!=!!a.used&&a.fire(new pr("data",{sourceDataType:"visibility",dataType:"source",sourceId:n}))}this.light.recalculate(e),this.z=e.zoom,r&&this.fire(new pr("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var i;this._checkLoaded();let n=this.serialize();if(e=r.transformStyle?r.transformStyle(n,e):e,((i=r.validate)!=null?i:!0)&&TM(this,Ms(e)))return!1;e=mc(e),e.layers=rD(e.layers);let a=kZ(n,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error("Unimplemented: ".concat(o.unimplemented.join(", "),"."));if(o.operations.length===0)return!1;for(let l of o.operations)l();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let r=[],i=[];for(let n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,n.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,n.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,n.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,n.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,n.args));break;case"addSource":r.push(()=>this.addSource.apply(this,n.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,n.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,n.args));break;case"setLight":r.push(()=>this.setLight.apply(this,n.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,n.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,n.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,n.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,n.args));break;case"setTransition":r.push(()=>{});break;default:i.push(n.command);break}return{operations:r,unimplemented:i}}addImage(e,r){if(this.getImage(e))return this.fire(new fi(new Error('An image named "'.concat(e,'" already exists.'))));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new fi(new Error('An image named "'.concat(e,'" does not exist.'))));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,i={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error('Source "'.concat(e,'" already exists.'));if(!r.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(r).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(Ms.source,"sources.".concat(e),r,null,i))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);let n=this.sourceCaches[e]=new Iw(e,r,this.dispatcher);n.style=this,n.setEventedParent(this,()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:e})),n.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let i in this._layers)if(this._layers[i].source===e)return this.fire(new fi(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(i,'" is using it.'))));let r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new pr("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID=".concat(e));let i=this.sourceCaches[e].getSource();if(i.type!=="geojson")throw new Error("geojsonSource.type is ".concat(i.type,", which is !== 'geojson"));i.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,i={}){this._checkLoaded();let n=e.id;if(this.getLayer(n)){this.fire(new fi(new Error('Layer "'.concat(n,'" already exists on this map.'))));return}let a;if(e.type==="custom"){if(TM(this,Wne(e)))return;a=VE(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(n,e.source),e=mc(e),e=zr(e,{source:n})),this._validate(Ms.layer,"layers.".concat(n),e,{arrayIndex:-1},i))return;a=VE(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:n}})}let o=r?this._order.indexOf(r):this._order.length;if(r&&o===-1){this.fire(new fi(new Error('Cannot add layer "'.concat(n,'" before non-existing layer "').concat(r,'".'))));return}if(this._order.splice(o,0,n),this._layerOrderChanged=!0,this._layers[n]=a,this._removedLayers[n]&&a.source&&a.type!=="custom"){let l=this._removedLayers[n];delete this._removedLayers[n],l.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e]){this.fire(new fi(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));return}if(e===r)return;let i=this._order.indexOf(e);this._order.splice(i,1);let n=r?this._order.indexOf(r):this._order.length;if(r&&n===-1){this.fire(new fi(new Error('Cannot move layer "'.concat(e,'" before non-existing layer "').concat(r,'".'))));return}this._order.splice(n,0,e),this._layerOrderChanged=!0}removeLayer(e){this._checkLoaded();let r=this._layers[e];if(!r){this.fire(new fi(new Error('Cannot remove non-existing layer "'.concat(e,'".'))));return}r.setEventedParent(null);let i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,i){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new fi(new Error('Cannot set the zoom range of non-existing layer "'.concat(e,'".'))));return}n.minzoom===r&&n.maxzoom===i||(r!=null&&(n.minzoom=r),i!=null&&(n.maxzoom=i),this._updateLayer(n))}setFilter(e,r,i={}){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new fi(new Error('Cannot filter non-existing layer "'.concat(e,'".'))));return}if(!zm(n.filter,r)){if(r==null){n.filter=void 0,this._updateLayer(n);return}this._validate(Ms.filter,"layers.".concat(n.id,".filter"),r,null,i)||(n.filter=mc(r),this._updateLayer(n))}}getFilter(e){return mc(this.getLayer(e).filter)}setLayoutProperty(e,r,i,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new fi(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}zm(a.getLayoutProperty(r),i)||(a.setLayoutProperty(r,i,n),this._updateLayer(a))}getLayoutProperty(e,r){let i=this.getLayer(e);if(!i){this.fire(new fi(new Error('Cannot get style of non-existing layer "'.concat(e,'".'))));return}return i.getLayoutProperty(r)}setPaintProperty(e,r,i,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new fi(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}zm(a.getPaintProperty(r),i)||(a.setPaintProperty(r,i,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null)}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();let i=e.source,n=e.sourceLayer,a=this.sourceCaches[i];if(a===void 0){this.fire(new fi(new Error("The source '".concat(i,"' does not exist in the map's style."))));return}let o=a.getSource().type;if(o==="geojson"&&n){this.fire(new fi(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(o==="vector"&&!n){this.fire(new fi(new Error("The sourceLayer parameter must be provided for vector source types.")));return}e.id===void 0&&this.fire(new fi(new Error("The feature id parameter must be provided."))),a.setFeatureState(n,e.id,r)}removeFeatureState(e,r){this._checkLoaded();let i=e.source,n=this.sourceCaches[i];if(n===void 0){this.fire(new fi(new Error("The source '".concat(i,"' does not exist in the map's style."))));return}let a=n.getSource().type,o=a==="vector"?e.sourceLayer:void 0;if(a==="vector"&&!o){this.fire(new fi(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(r&&typeof e.id!="string"&&typeof e.id!="number"){this.fire(new fi(new Error("A feature id is required to remove its specific state property.")));return}n.removeFeatureState(o,e.id,r)}getFeatureState(e){this._checkLoaded();let r=e.source,i=e.sourceLayer,n=this.sourceCaches[r];if(n===void 0){this.fire(new fi(new Error("The source '".concat(r,"' does not exist in the map's style."))));return}if(n.getSource().type==="vector"&&!i){this.fire(new fi(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return e.id===void 0&&this.fire(new fi(new Error("The feature id parameter must be provided."))),n.getFeatureState(i,e.id)}getTransition(){return zr({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=ZT(this.sourceCaches,a=>a.serialize()),r=this._serializeByIds(this._order),i=this.map.getTerrain()||void 0,n=this.stylesheet;return C9({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:e,layers:r,terrain:i},a=>a!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let r=s(o=>this._layers[o].type==="fill-extrusion","isLayer3D"),i={},n=[];for(let o=this._order.length-1;o>=0;o--){let l=this._order[o];if(r(l)){i[l]=o;for(let u of e){let c=u[l];if(c)for(let p of c)n.push(p)}}}n.sort((o,l)=>l.intersectionZ-o.intersectionZ);let a=[];for(let o=this._order.length-1;o>=0;o--){let l=this._order[o];if(r(l))for(let u=n.length-1;u>=0;u--){let c=n[u].feature;if(i[c.layer.id]<o)break;a.push(c),n.pop()}else for(let u of e){let c=u[l];if(c)for(let p of c)a.push(p.feature)}}return a}queryRenderedFeatures(e,r,i){r&&r.filter&&this._validate(Ms.filter,"queryRenderedFeatures.filter",r.filter,null,r);let n={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new fi(new Error("parameters.layers must be an Array."))),[];for(let l of r.layers){let u=this._layers[l];if(!u)return this.fire(new fi(new Error("The layer '".concat(l,"' does not exist in the map's style and cannot be queried for features.")))),[];n[u.source]=!0}}let a=[];r.availableImages=this._availableImages;let o=this._serializedAllLayers();for(let l in this.sourceCaches)r.layers&&!n[l]||a.push(fae(this.sourceCaches[l],this._layers,o,e,r,i));return this.placement&&a.push(mae(this._layers,o,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,r){r&&r.filter&&this._validate(Ms.filter,"querySourceFeatures.filter",r.filter,null,r);let i=this.sourceCaches[e];return i?gae(i,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();let i=this.light.getLight(),n=!1;for(let o in e)if(!zm(e[o],i[o])){n=!0;break}if(!n)return;let a={now:vn.now(),transition:zr({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(a)}_validate(e,r,i,n,a={}){return a&&a.validate===!1?!1:TM(this,e.call(Ms,zr({key:r,style:this.serialize(),value:i,styleSpec:Ut},n)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),w_().off(eR,this._rtlPluginLoaded);for(let r in this._layers)this._layers[r].setEventedParent(null);for(let r in this.sourceCaches){let i=this.sourceCaches[r];i.setEventedParent(null),i.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,i,n,a=!1){let o=!1,l=!1,u={};for(let c of this._order){let p=this._layers[c];if(p.type!=="symbol")continue;if(!u[p.source]){let y=this.sourceCaches[p.source];u[p.source]=y.getRenderableIds(!0).map(v=>y.getTileByID(v)).sort((v,w)=>w.tileID.overscaledZ-v.tileID.overscaledZ||(v.tileID.isLessThan(w.tileID)?-1:1))}let m=this.crossTileSymbolIndex.addLayer(p,u[p.source],e.center.lng);o=o||m}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),a=a||this._layerOrderChanged||i===0,(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(vn.now(),e.zoom))&&(this.pauseablePlacement=new W9e(e,this.map.terrain,this._order,a,r,i,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(vn.now()),l=!0),o&&this.pauseablePlacement.placement.setStale()),l||o)for(let c of this._order){let p=this._layers[c];p.type==="symbol"&&this.placement.updateLayerOpacities(p,u[p.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(vn.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}async getImages(e,r){let i=await this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();let n=this.sourceCaches[r.source];return n&&n.setDependencies(r.tileID.key,r.type,r.icons),i}async getGlyphs(e,r){let i=await this.glyphManager.getGlyphs(r.stacks),n=this.sourceCaches[r.source];return n&&n.setDependencies(r.tileID.key,r.type,[""]),i}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),!(e&&this._validate(Ms.glyphs,"glyphs",e,null,r))&&(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,i={},n){this._checkLoaded();let a=[{id:e,url:r}],o=[...sw(this.stylesheet.sprite),...a];this._validate(Ms.sprite,"sprite",o,null,i)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,n))}removeSprite(e){this._checkLoaded();let r=sw(this.stylesheet.sprite);if(!r.find(i=>i.id===e)){this.fire(new fi(new Error('Sprite "'.concat(e,`" doesn't exists on this map.`))));return}if(this._spritesImagesIds[e])for(let i of this._spritesImagesIds[e])this.imageManager.removeImage(i),this._changedImages[i]=!0;r.splice(r.findIndex(i=>i.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"}))}getSprite(){return sw(this.stylesheet.sprite)}setSprite(e,r={},i){this._checkLoaded(),!(e&&this._validate(Ms.sprite,"sprite",e,null,r))&&(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,i):(this._unloadSprite(),i&&i(null)))}};s(Toe,"Style");var cq=Toe;N();N();var FL=ao([{name:"a_pos",type:"Int16",components:2}]);N();N();var e7e=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`;N();var t7e=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`;N();var r7e=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var i7e="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";N();var n7e=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var a7e="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";N();var o7e=`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var s7e=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`;N();var l7e="void main() {gl_FragColor=vec4(1.0);}";N();var u7e="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";N();var c7e=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var h7e=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`;N();var p7e=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`;N();var d7e="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";N();var f7e="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}";N();var m7e="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}";N();var g7e="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}";N();var y7e="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";N();var v7e="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}";N();var _7e="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}";N();var x7e=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var b7e=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`;N();var w7e=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var A7e=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;N();var S7e=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var M7e=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;N();var E7e=`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var C7e=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`;N();var I7e=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var T7e=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`;N();var P7e=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var L7e=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`;N();var D7e=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var R7e="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";N();var O7e=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var k7e="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}";N();var N7e=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var F7e=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;N();var B7e=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var z7e=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;N();var U7e=`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var V7e=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`;N();var j7e=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var $7e=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`;N();var G7e=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var H7e="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}";N();var q7e=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var W7e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`;N();var X7e=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var Z7e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`;N();var Y7e=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var K7e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`;N();var J7e="varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}";N();var Q7e="precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}";N();var eFe="uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}";N();var BL="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}",l2={prelude:Zn(e7e,t7e),background:Zn(r7e,i7e),backgroundPattern:Zn(n7e,a7e),circle:Zn(o7e,s7e),clippingMask:Zn(l7e,u7e),heatmap:Zn(c7e,h7e),heatmapTexture:Zn(p7e,d7e),collisionBox:Zn(f7e,m7e),collisionCircle:Zn(g7e,y7e),debug:Zn(v7e,_7e),fill:Zn(x7e,b7e),fillOutline:Zn(w7e,A7e),fillOutlinePattern:Zn(S7e,M7e),fillPattern:Zn(E7e,C7e),fillExtrusion:Zn(I7e,T7e),fillExtrusionPattern:Zn(P7e,L7e),hillshadePrepare:Zn(D7e,R7e),hillshade:Zn(O7e,k7e),line:Zn(N7e,F7e),lineGradient:Zn(B7e,z7e),linePattern:Zn(U7e,V7e),lineSDF:Zn(j7e,$7e),raster:Zn(G7e,H7e),symbolIcon:Zn(q7e,W7e),symbolSDF:Zn(X7e,Z7e),symbolTextAndIcon:Zn(Y7e,K7e),terrain:Zn(eFe,BL),terrainDepth:Zn(J7e,BL),terrainCoords:Zn(Q7e,BL)};function Zn(t,e){let r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(n):n,l={};return t=t.replace(r,(u,c,p,m,y)=>(l[y]=!0,c==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
varying `).concat(p," ").concat(m," ").concat(y,`;
#else
uniform `).concat(p," ").concat(m," u_").concat(y,`;
#endif
`):`
#ifdef HAS_UNIFORM_u_`.concat(y,`
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`))),e=e.replace(r,(u,c,p,m,y)=>{let v=m==="float"?"vec2":"vec4",w=y.match(/color/)?"color":v;return l[y]?c==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
uniform lowp float u_`).concat(y,`_t;
attribute `).concat(p," ").concat(v," a_").concat(y,`;
varying `).concat(p," ").concat(m," ").concat(y,`;
#else
uniform `).concat(p," ").concat(m," u_").concat(y,`;
#endif
`):w==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(y," = a_").concat(y,`;
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(y," = unpack_mix_").concat(w,"(a_").concat(y,", u_").concat(y,`_t);
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`):c==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
uniform lowp float u_`).concat(y,`_t;
attribute `).concat(p," ").concat(v," a_").concat(y,`;
#else
uniform `).concat(p," ").concat(m," u_").concat(y,`;
#endif
`):w==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(p," ").concat(m," ").concat(y," = a_").concat(y,`;
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(p," ").concat(m," ").concat(y," = unpack_mix_").concat(w,"(a_").concat(y,", u_").concat(y,`_t);
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`)}),{fragmentSource:t,vertexSource:e,staticAttributes:i,staticUniforms:o}}s(Zn,"compile");N();N();var Poe=class{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,i,n,a,o,l,u,c){this.context=e;let p=this.boundPaintVertexBuffers.length!==n.length;for(let m=0;!p&&m<n.length;m++)this.boundPaintVertexBuffers[m]!==n[m]&&(p=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==i||p||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==l||this.boundDynamicVertexBuffer2!==u||this.boundDynamicVertexBuffer3!==c?this.freshBind(r,i,n,a,o,l,u,c):(e.bindVertexArray.set(this.vao),l&&l.bind(),a&&a.dynamicDraw&&a.bind(),u&&u.bind(),c&&c.bind())}freshBind(e,r,i,n,a,o,l,u){let c=e.numAttributes,p=this.context,m=p.gl;this.vao&&this.destroy(),this.vao=p.createVertexArray(),p.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=l,this.boundDynamicVertexBuffer3=u,r.enableAttributes(m,e);for(let y of i)y.enableAttributes(m,e);o&&o.enableAttributes(m,e),l&&l.enableAttributes(m,e),u&&u.enableAttributes(m,e),r.bind(),r.setVertexAttribPointers(m,e,a);for(let y of i)y.bind(),y.setVertexAttribPointers(m,e,a);o&&(o.bind(),o.setVertexAttribPointers(m,e,a)),n&&n.bind(),l&&(l.bind(),l.setVertexAttribPointers(m,e,a)),u&&(u.bind(),u.setVertexAttribPointers(m,e,a)),p.currentNumAttributes=c}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}};s(Poe,"VertexArrayObject");var tFe=Poe;N();var rFe=s((t,e)=>({u_depth:new Wi(t,e.u_depth),u_terrain:new Wi(t,e.u_terrain),u_terrain_dim:new Mr(t,e.u_terrain_dim),u_terrain_matrix:new _n(t,e.u_terrain_matrix),u_terrain_unpack:new z7(t,e.u_terrain_unpack),u_terrain_exaggeration:new Mr(t,e.u_terrain_exaggeration)}),"terrainPreludeUniforms"),iFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_texture:new Wi(t,e.u_texture),u_ele_delta:new Mr(t,e.u_ele_delta)}),"terrainUniforms"),nFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_ele_delta:new Mr(t,e.u_ele_delta)}),"terrainDepthUniforms"),aFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_texture:new Wi(t,e.u_texture),u_terrain_coords_id:new Mr(t,e.u_terrain_coords_id),u_ele_delta:new Mr(t,e.u_ele_delta)}),"terrainCoordsUniforms"),oFe=s((t,e)=>({u_matrix:t,u_texture:0,u_ele_delta:e}),"terrainUniformValues"),sFe=s((t,e)=>({u_matrix:t,u_ele_delta:e}),"terrainDepthUniformValues"),lFe=s((t,e,r)=>({u_matrix:t,u_terrain_coords_id:e/255,u_texture:0,u_ele_delta:r}),"terrainCoordsUniformValues");function HE(t){let e=[];for(let r=0;r<t.length;r++){if(t[r]===null)continue;let i=t[r].split(" ");e.push(i.pop())}return e}s(HE,"getTokenizedAttributesAndUniforms");var Loe=class{constructor(e,r,i,n,a,o){let l=e.gl;this.program=l.createProgram();let u=HE(r.staticAttributes),c=i?i.getBinderAttributes():[],p=u.concat(c),m=l2.prelude.staticUniforms?HE(l2.prelude.staticUniforms):[],y=r.staticUniforms?HE(r.staticUniforms):[],v=i?i.getBinderUniforms():[],w=m.concat(y).concat(v),E=[];for(let F of w)E.indexOf(F)<0&&E.push(F);let M=i?i.defines():[];a&&M.push("#define OVERDRAW_INSPECTOR;"),o&&M.push("#define TERRAIN3D;");let I=M.concat(l2.prelude.fragmentSource,r.fragmentSource).join(`
`),P=M.concat(l2.prelude.vertexSource,r.vertexSource).join(`
`),C=l.createShader(l.FRAGMENT_SHADER);if(l.isContextLost()){this.failedToCreate=!0;return}if(l.shaderSource(C,I),l.compileShader(C),!l.getShaderParameter(C,l.COMPILE_STATUS))throw new Error("Could not compile fragment shader: ".concat(l.getShaderInfoLog(C)));l.attachShader(this.program,C);let T=l.createShader(l.VERTEX_SHADER);if(l.isContextLost()){this.failedToCreate=!0;return}if(l.shaderSource(T,P),l.compileShader(T),!l.getShaderParameter(T,l.COMPILE_STATUS))throw new Error("Could not compile vertex shader: ".concat(l.getShaderInfoLog(T)));l.attachShader(this.program,T),this.attributes={};let O={};this.numAttributes=p.length;for(let F=0;F<this.numAttributes;F++)p[F]&&(l.bindAttribLocation(this.program,F,p[F]),this.attributes[p[F]]=F);if(l.linkProgram(this.program),!l.getProgramParameter(this.program,l.LINK_STATUS))throw new Error("Program failed to link: ".concat(l.getProgramInfoLog(this.program)));l.deleteShader(T),l.deleteShader(C);for(let F=0;F<E.length;F++){let k=E[F];if(k&&!O[k]){let B=l.getUniformLocation(this.program,k);B&&(O[k]=B)}}this.fixedUniforms=n(e,O),this.terrainUniforms=rFe(e,O),this.binderUniforms=i?i.getUniforms(e,O):[]}draw(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P){let C=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(i),e.setStencilMode(n),e.setColorMode(a),e.setCullFace(o),u){e.activeTexture.set(C.TEXTURE2),C.bindTexture(C.TEXTURE_2D,u.depthTexture),e.activeTexture.set(C.TEXTURE3),C.bindTexture(C.TEXTURE_2D,u.texture);for(let O in this.terrainUniforms)this.terrainUniforms[O].set(u[O])}for(let O in this.fixedUniforms)this.fixedUniforms[O].set(l[O]);E&&E.setUniforms(e,this.binderUniforms,v,{zoom:w});let T=0;switch(r){case C.LINES:T=2;break;case C.TRIANGLES:T=3;break;case C.LINE_STRIP:T=1;break}for(let O of y.get()){let F=O.vaos||(O.vaos={});(F[c]||(F[c]=new tFe)).bind(e,this,p,E?E.getPaintVertexBuffers():[],m,O.vertexOffset,M,I,P),C.drawElements(r,O.primitiveLength*T,C.UNSIGNED_SHORT,O.primitiveOffset*T*2)}}};s(Loe,"Program");var uFe=Loe;N();N();N();function WF(t,e,r){let i=1/ku(r,1,e.transform.tileZoom),n=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=a*(r.tileID.canonical.x+r.tileID.wrap*n),l=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,l>>16],u_pixel_coord_lower:[o&65535,l&65535]}}s(WF,"patternUniformValues");function Doe(t,e,r,i){let n=r.imageManager.getPattern(t.from.toString()),a=r.imageManager.getPattern(t.to.toString()),{width:o,height:l}=r.imageManager.getPixelSize(),u=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,r.transform.tileZoom)/u,p=c*(i.tileID.canonical.x+i.tileID.wrap*u),m=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,l],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/ku(i,1,r.transform.tileZoom),u_pixel_coord_upper:[p>>16,m>>16],u_pixel_coord_lower:[p&65535,m&65535]}}s(Doe,"bgPatternUniformValues");var cFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_lightpos:new cf(t,e.u_lightpos),u_lightintensity:new Mr(t,e.u_lightintensity),u_lightcolor:new cf(t,e.u_lightcolor),u_vertical_gradient:new Mr(t,e.u_vertical_gradient),u_opacity:new Mr(t,e.u_opacity)}),"fillExtrusionUniforms"),hFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_lightpos:new cf(t,e.u_lightpos),u_lightintensity:new Mr(t,e.u_lightintensity),u_lightcolor:new cf(t,e.u_lightcolor),u_vertical_gradient:new Mr(t,e.u_vertical_gradient),u_height_factor:new Mr(t,e.u_height_factor),u_image:new Wi(t,e.u_image),u_texsize:new an(t,e.u_texsize),u_pixel_coord_upper:new an(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new an(t,e.u_pixel_coord_lower),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade),u_opacity:new Mr(t,e.u_opacity)}),"fillExtrusionPatternUniforms"),Roe=s((t,e,r,i)=>{let n=e.style.light,a=n.properties.get("position"),o=[a.x,a.y,a.z],l=zD.create();n.properties.get("anchor")==="viewport"&&zD.fromRotation(l,-e.transform.angle),kh.transformMat3(o,o,l);let u=n.properties.get("color");return{u_matrix:t,u_lightpos:o,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},"fillExtrusionUniformValues"),pFe=s((t,e,r,i,n,a,o)=>zr(Roe(t,e,r,i),WF(a,e,o),{u_height_factor:-Math.pow(2,n.overscaledZ)/o.tileSize/8}),"fillExtrusionPatternUniformValues");N();var dFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix)}),"fillUniforms"),fFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_image:new Wi(t,e.u_image),u_texsize:new an(t,e.u_texsize),u_pixel_coord_upper:new an(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new an(t,e.u_pixel_coord_lower),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade)}),"fillPatternUniforms"),mFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_world:new an(t,e.u_world)}),"fillOutlineUniforms"),gFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_world:new an(t,e.u_world),u_image:new Wi(t,e.u_image),u_texsize:new an(t,e.u_texsize),u_pixel_coord_upper:new an(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new an(t,e.u_pixel_coord_lower),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade)}),"fillOutlinePatternUniforms"),Ooe=s(t=>({u_matrix:t}),"fillUniformValues"),koe=s((t,e,r,i)=>zr(Ooe(t),WF(r,e,i)),"fillPatternUniformValues"),yFe=s((t,e)=>({u_matrix:t,u_world:e}),"fillOutlineUniformValues"),vFe=s((t,e,r,i,n)=>zr(koe(t,e,r,i),{u_world:n}),"fillOutlinePatternUniformValues");N();var _Fe=s((t,e)=>({u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_scale_with_map:new Wi(t,e.u_scale_with_map),u_pitch_with_map:new Wi(t,e.u_pitch_with_map),u_extrude_scale:new an(t,e.u_extrude_scale),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_matrix:new _n(t,e.u_matrix)}),"circleUniforms"),xFe=s((t,e,r,i)=>{let n=t.transform,a,o;if(i.paint.get("circle-pitch-alignment")==="map"){let l=ku(r,1,n.zoom);a=!0,o=[l,l]}else a=!1,o=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+(i.paint.get("circle-pitch-scale")==="map"),u_matrix:t.translatePosMatrix(e.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},"circleUniformValues");N();var bFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new Mr(t,e.u_pixels_to_tile_units),u_extrude_scale:new an(t,e.u_extrude_scale),u_overscale_factor:new Mr(t,e.u_overscale_factor)}),"collisionUniforms"),wFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_inv_matrix:new _n(t,e.u_inv_matrix),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_viewport_size:new an(t,e.u_viewport_size)}),"collisionCircleUniforms"),AFe=s((t,e,r)=>{let i=ku(r,1,e.zoom),n=Math.pow(2,e.zoom-r.tileID.overscaledZ),a=r.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[e.pixelsToGLUnits[0]/(i*n),e.pixelsToGLUnits[1]/(i*n)],u_overscale_factor:a}},"collisionUniformValues"),SFe=s((t,e,r)=>({u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}),"collisionCircleUniformValues");N();var MFe=s((t,e)=>({u_color:new Q1(t,e.u_color),u_matrix:new _n(t,e.u_matrix),u_overlay:new Wi(t,e.u_overlay),u_overlay_scale:new Mr(t,e.u_overlay_scale)}),"debugUniforms"),hq=s((t,e,r=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:r}),"debugUniformValues");N();var EFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix)}),"clippingMaskUniforms"),pq=s(t=>({u_matrix:t}),"clippingMaskUniformValues");N();var CFe=s((t,e)=>({u_extrude_scale:new Mr(t,e.u_extrude_scale),u_intensity:new Mr(t,e.u_intensity),u_matrix:new _n(t,e.u_matrix)}),"heatmapUniforms"),IFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_world:new an(t,e.u_world),u_image:new Wi(t,e.u_image),u_color_ramp:new Wi(t,e.u_color_ramp),u_opacity:new Mr(t,e.u_opacity)}),"heatmapTextureUniforms"),TFe=s((t,e,r,i)=>({u_matrix:t,u_extrude_scale:ku(e,1,r),u_intensity:i}),"heatmapUniformValues"),PFe=s((t,e,r,i)=>{let n=Nr.create();Nr.ortho(n,0,t.width,t.height,0,0,1);let a=t.context.gl;return{u_matrix:n,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:e.paint.get("heatmap-opacity")}},"heatmapTextureUniformValues");N();var LFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_image:new Wi(t,e.u_image),u_latrange:new an(t,e.u_latrange),u_light:new an(t,e.u_light),u_shadow:new Q1(t,e.u_shadow),u_highlight:new Q1(t,e.u_highlight),u_accent:new Q1(t,e.u_accent)}),"hillshadeUniforms"),DFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_image:new Wi(t,e.u_image),u_dimension:new an(t,e.u_dimension),u_zoom:new Mr(t,e.u_zoom),u_unpack:new z7(t,e.u_unpack)}),"hillshadePrepareUniforms"),RFe=s((t,e,r,i)=>{let n=r.paint.get("hillshade-shadow-color"),a=r.paint.get("hillshade-highlight-color"),o=r.paint.get("hillshade-accent-color"),l=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);r.paint.get("hillshade-illumination-anchor")==="viewport"&&(l-=t.transform.angle);let u=!t.options.moving;return{u_matrix:i?i.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),u),u_image:0,u_latrange:Noe(t,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),l],u_shadow:n,u_highlight:a,u_accent:o}},"hillshadeUniformValues"),OFe=s((t,e)=>{let r=e.stride,i=Nr.create();return Nr.ortho(i,0,8192,-8192,0,0,1),Nr.translate(i,i,[0,-8192,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:t.overscaledZ,u_unpack:e.getUnpackVector()}},"hillshadeUniformPrepareValues");function Noe(t,e){let r=Math.pow(2,e.canonical.z),i=e.canonical.y;return[new al(0,i/r).toLngLat().lat,new al(0,(i+1)/r).toLngLat().lat]}s(Noe,"getTileLatRange");N();var kFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_units_to_pixels:new an(t,e.u_units_to_pixels)}),"lineUniforms"),NFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_units_to_pixels:new an(t,e.u_units_to_pixels),u_image:new Wi(t,e.u_image),u_image_height:new Mr(t,e.u_image_height)}),"lineGradientUniforms"),FFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_texsize:new an(t,e.u_texsize),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_image:new Wi(t,e.u_image),u_units_to_pixels:new an(t,e.u_units_to_pixels),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade)}),"linePatternUniforms"),BFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_units_to_pixels:new an(t,e.u_units_to_pixels),u_patternscale_a:new an(t,e.u_patternscale_a),u_patternscale_b:new an(t,e.u_patternscale_b),u_sdfgamma:new Mr(t,e.u_sdfgamma),u_image:new Wi(t,e.u_image),u_tex_y_a:new Mr(t,e.u_tex_y_a),u_tex_y_b:new Mr(t,e.u_tex_y_b),u_mix:new Mr(t,e.u_mix)}),"lineSDFUniforms"),XF=s((t,e,r,i)=>{let n=t.transform;return{u_matrix:YF(t,e,r,i),u_ratio:1/ku(e,1,n.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},"lineUniformValues"),zFe=s((t,e,r,i,n)=>zr(XF(t,e,r,n),{u_image:0,u_image_height:i}),"lineGradientUniformValues"),UFe=s((t,e,r,i,n)=>{let a=t.transform,o=ZF(e,a);return{u_matrix:YF(t,e,r,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/ku(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},"linePatternUniformValues"),VFe=s((t,e,r,i,n,a)=>{let o=t.transform,l=t.lineAtlas,u=ZF(e,o),c=r.layout.get("line-cap")==="round",p=l.getDash(i.from,c),m=l.getDash(i.to,c),y=p.width*n.fromScale,v=m.width*n.toScale;return zr(XF(t,e,r,a),{u_patternscale_a:[u/y,-p.height/2],u_patternscale_b:[u/v,-m.height/2],u_sdfgamma:l.width/(Math.min(y,v)*256*t.pixelRatio)/2,u_image:0,u_tex_y_a:p.y,u_tex_y_b:m.y,u_mix:n.t})},"lineSDFUniformValues");function ZF(t,e){return 1/ku(t,1,e.tileZoom)}s(ZF,"calculateTileRatio");function YF(t,e,r,i){return t.translatePosMatrix(i?i.posMatrix:e.tileID.posMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}s(YF,"calculateMatrix");N();var jFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_tl_parent:new an(t,e.u_tl_parent),u_scale_parent:new Mr(t,e.u_scale_parent),u_buffer_scale:new Mr(t,e.u_buffer_scale),u_fade_t:new Mr(t,e.u_fade_t),u_opacity:new Mr(t,e.u_opacity),u_image0:new Wi(t,e.u_image0),u_image1:new Wi(t,e.u_image1),u_brightness_low:new Mr(t,e.u_brightness_low),u_brightness_high:new Mr(t,e.u_brightness_high),u_saturation_factor:new Mr(t,e.u_saturation_factor),u_contrast_factor:new Mr(t,e.u_contrast_factor),u_spin_weights:new cf(t,e.u_spin_weights)}),"rasterUniforms"),$Fe=s((t,e,r,i,n)=>({u_matrix:t,u_tl_parent:e,u_scale_parent:r,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:zoe(n.paint.get("raster-saturation")),u_contrast_factor:Boe(n.paint.get("raster-contrast")),u_spin_weights:Foe(n.paint.get("raster-hue-rotate"))}),"rasterUniformValues");function Foe(t){t*=Math.PI/180;let e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}s(Foe,"spinWeights");function Boe(t){return t>0?1/(1-t):1+t}s(Boe,"contrastFactor");function zoe(t){return t>0?1-1/(1.001-t):-t}s(zoe,"saturationFactor");N();var GFe=s((t,e)=>({u_is_size_zoom_constant:new Wi(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Wi(t,e.u_is_size_feature_constant),u_size_t:new Mr(t,e.u_size_t),u_size:new Mr(t,e.u_size),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pitch:new Mr(t,e.u_pitch),u_rotate_symbol:new Wi(t,e.u_rotate_symbol),u_aspect_ratio:new Mr(t,e.u_aspect_ratio),u_fade_change:new Mr(t,e.u_fade_change),u_matrix:new _n(t,e.u_matrix),u_label_plane_matrix:new _n(t,e.u_label_plane_matrix),u_coord_matrix:new _n(t,e.u_coord_matrix),u_is_text:new Wi(t,e.u_is_text),u_pitch_with_map:new Wi(t,e.u_pitch_with_map),u_texsize:new an(t,e.u_texsize),u_texture:new Wi(t,e.u_texture)}),"symbolIconUniforms"),HFe=s((t,e)=>({u_is_size_zoom_constant:new Wi(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Wi(t,e.u_is_size_feature_constant),u_size_t:new Mr(t,e.u_size_t),u_size:new Mr(t,e.u_size),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pitch:new Mr(t,e.u_pitch),u_rotate_symbol:new Wi(t,e.u_rotate_symbol),u_aspect_ratio:new Mr(t,e.u_aspect_ratio),u_fade_change:new Mr(t,e.u_fade_change),u_matrix:new _n(t,e.u_matrix),u_label_plane_matrix:new _n(t,e.u_label_plane_matrix),u_coord_matrix:new _n(t,e.u_coord_matrix),u_is_text:new Wi(t,e.u_is_text),u_pitch_with_map:new Wi(t,e.u_pitch_with_map),u_texsize:new an(t,e.u_texsize),u_texture:new Wi(t,e.u_texture),u_gamma_scale:new Mr(t,e.u_gamma_scale),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_is_halo:new Wi(t,e.u_is_halo)}),"symbolSDFUniforms"),qFe=s((t,e)=>({u_is_size_zoom_constant:new Wi(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Wi(t,e.u_is_size_feature_constant),u_size_t:new Mr(t,e.u_size_t),u_size:new Mr(t,e.u_size),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pitch:new Mr(t,e.u_pitch),u_rotate_symbol:new Wi(t,e.u_rotate_symbol),u_aspect_ratio:new Mr(t,e.u_aspect_ratio),u_fade_change:new Mr(t,e.u_fade_change),u_matrix:new _n(t,e.u_matrix),u_label_plane_matrix:new _n(t,e.u_label_plane_matrix),u_coord_matrix:new _n(t,e.u_coord_matrix),u_is_text:new Wi(t,e.u_is_text),u_pitch_with_map:new Wi(t,e.u_pitch_with_map),u_texsize:new an(t,e.u_texsize),u_texsize_icon:new an(t,e.u_texsize_icon),u_texture:new Wi(t,e.u_texture),u_texture_icon:new Wi(t,e.u_texture_icon),u_gamma_scale:new Mr(t,e.u_gamma_scale),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_is_halo:new Wi(t,e.u_is_halo)}),"symbolTextAndIconUniforms"),Uoe=s((t,e,r,i,n,a,o,l,u,c)=>{let p=n.transform;return{u_is_size_zoom_constant:+(t==="constant"||t==="source"),u_is_size_feature_constant:+(t==="constant"||t==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:p.cameraToCenterDistance,u_pitch:p.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:p.width/p.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+i,u_texsize:c,u_texture:0}},"symbolIconUniformValues"),Voe=s((t,e,r,i,n,a,o,l,u,c,p)=>{let m=n.transform;return zr(Uoe(t,e,r,i,n,a,o,l,u,c),{u_gamma_scale:i?Math.cos(m._pitch)*m.cameraToCenterDistance:1,u_device_pixel_ratio:n.pixelRatio,u_is_halo:+p})},"symbolSDFUniformValues"),WFe=s((t,e,r,i,n,a,o,l,u,c)=>zr(Voe(t,e,r,i,n,a,o,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1}),"symbolTextAndIconUniformValues");N();var XFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_opacity:new Mr(t,e.u_opacity),u_color:new Q1(t,e.u_color)}),"backgroundUniforms"),ZFe=s((t,e)=>({u_matrix:new _n(t,e.u_matrix),u_opacity:new Mr(t,e.u_opacity),u_image:new Wi(t,e.u_image),u_pattern_tl_a:new an(t,e.u_pattern_tl_a),u_pattern_br_a:new an(t,e.u_pattern_br_a),u_pattern_tl_b:new an(t,e.u_pattern_tl_b),u_pattern_br_b:new an(t,e.u_pattern_br_b),u_texsize:new an(t,e.u_texsize),u_mix:new Mr(t,e.u_mix),u_pattern_size_a:new an(t,e.u_pattern_size_a),u_pattern_size_b:new an(t,e.u_pattern_size_b),u_scale_a:new Mr(t,e.u_scale_a),u_scale_b:new Mr(t,e.u_scale_b),u_pixel_coord_upper:new an(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new an(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new Mr(t,e.u_tile_units_to_pixels)}),"backgroundPatternUniforms"),YFe=s((t,e,r)=>({u_matrix:t,u_opacity:e,u_color:r}),"backgroundUniformValues"),KFe=s((t,e,r,i,n,a)=>zr(Doe(i,a,r,n),{u_matrix:t,u_opacity:e}),"backgroundPatternUniformValues"),JFe={fillExtrusion:cFe,fillExtrusionPattern:hFe,fill:dFe,fillPattern:fFe,fillOutline:mFe,fillOutlinePattern:gFe,circle:_Fe,collisionBox:bFe,collisionCircle:wFe,debug:MFe,clippingMask:EFe,heatmap:CFe,heatmapTexture:IFe,hillshade:LFe,hillshadePrepare:DFe,line:kFe,lineGradient:NFe,linePattern:FFe,lineSDF:BFe,raster:jFe,symbolIcon:GFe,symbolSDF:HFe,symbolTextAndIcon:qFe,background:XFe,backgroundPattern:ZFe,terrain:iFe,terrainDepth:nFe,terrainCoords:aFe};N();N();var joe=class{constructor(e,r,i){this.context=e;let n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=!!i,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};s(joe,"IndexBuffer");var QFe=joe;N();var eBe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},$oe=class{constructor(e,r,i,n){this.length=r.length,this.attributes=i,this.itemSize=r.bytesPerElement,this.dynamicDraw=n,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error("Length of new data is ".concat(e.length,", which doesn't match current length of ").concat(this.length));let r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let i=0;i<this.attributes.length;i++){let n=this.attributes[i],a=r.attributes[n.name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,r,i){for(let n=0;n<this.attributes.length;n++){let a=this.attributes[n],o=r.attributes[a.name];o!==void 0&&e.vertexAttribPointer(o,a.components,e[eBe[a.type]],!1,this.itemSize,a.offset+this.itemSize*(i||0))}}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};s($oe,"VertexBuffer");var tBe=$oe;N();N();N();var zL=new WeakMap;function uw(t){var e;if(zL.has(t))return zL.get(t);{let r=(e=t.getParameter(t.VERSION))==null?void 0:e.startsWith("WebGL 2.0");return zL.set(t,r),r}}s(uw,"isWebGL2");var Goe=class{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}};s(Goe,"BaseValue");var Un=Goe,Hoe=class extends Un{getDefault(){return Li.transparent}set(e){let r=this.current;e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};s(Hoe,"ClearColor");var rBe=Hoe,qoe=class extends Un{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}};s(qoe,"ClearDepth");var iBe=qoe,Woe=class extends Un{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}};s(Woe,"ClearStencil");var nBe=Woe,Xoe=class extends Un{getDefault(){return[!0,!0,!0,!0]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};s(Xoe,"ColorMask");var aBe=Xoe,Zoe=class extends Un{getDefault(){return!0}set(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)}};s(Zoe,"DepthMask");var oBe=Zoe,Yoe=class extends Un{getDefault(){return 255}set(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}};s(Yoe,"StencilMask");var sBe=Yoe,Koe=class extends Un{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let r=this.current;e.func===r.func&&e.ref===r.ref&&e.mask===r.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}};s(Koe,"StencilFunc");var lBe=Koe,Joe=class extends Un{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}};s(Joe,"StencilOp");var uBe=Joe,Qoe=class extends Un{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}};s(Qoe,"StencilTest");var cBe=Qoe,ese=class extends Un{getDefault(){return[0,1]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}};s(ese,"DepthRange");var hBe=ese,tse=class extends Un{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}};s(tse,"DepthTest");var pBe=tse,rse=class extends Un{getDefault(){return this.gl.LESS}set(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}};s(rse,"DepthFunc");var dBe=rse,ise=class extends Un{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}};s(ise,"Blend");var fBe=ise,nse=class extends Un{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}};s(nse,"BlendFunc");var mBe=nse,ase=class extends Un{getDefault(){return Li.transparent}set(e){let r=this.current;e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};s(ase,"BlendColor");var gBe=ase,ose=class extends Un{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}};s(ose,"BlendEquation");var yBe=ose,sse=class extends Un{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}};s(sse,"CullFace");var vBe=sse,lse=class extends Un{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}};s(lse,"CullFaceSide");var _Be=lse,use=class extends Un{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}};s(use,"FrontFace");var xBe=use,cse=class extends Un{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};s(cse,"ProgramValue");var bBe=cse,hse=class extends Un{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}};s(hse,"ActiveTextureUnit");var wBe=hse,pse=class extends Un{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};s(pse,"Viewport");var ABe=pse,dse=class extends Un{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}};s(dse,"BindFramebuffer");var SBe=dse,fse=class extends Un{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};s(fse,"BindRenderbuffer");var MBe=fse,mse=class extends Un{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}};s(mse,"BindTexture");var EBe=mse,gse=class extends Un{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};s(gse,"BindVertexBuffer");var CBe=gse,yse=class extends Un{getDefault(){return null}set(e){let r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};s(yse,"BindElementBuffer");var IBe=yse,vse=class extends Un{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;let i=this.gl;uw(i)?i.bindVertexArray(e):(r=i.getExtension("OES_vertex_array_object"))==null||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}};s(vse,"BindVertexArray");var TBe=vse,_se=class extends Un{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}};s(_se,"PixelStoreUnpack");var PBe=_se,xse=class extends Un{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}};s(xse,"PixelStoreUnpackPremultiplyAlpha");var LBe=xse,bse=class extends Un{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}};s(bse,"PixelStoreUnpackFlipY");var DBe=bse,wse=class extends Un{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}};s(wse,"FramebufferAttachment");var KF=wse,Ase=class extends KF{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}};s(Ase,"ColorAttachment");var RBe=Ase,Sse=class extends KF{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};s(Sse,"DepthAttachment");var OBe=Sse,Mse=class extends KF{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};s(Mse,"DepthStencilAttachment");var kBe=Mse,Ese=class{constructor(e,r,i,n,a){this.context=e,this.width=r,this.height=i;let o=e.gl,l=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new RBe(e,l),n)this.depthAttachment=a?new kBe(e,l):new OBe(e,l);else if(a)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){let i=this.depthAttachment.get();i&&e.deleteRenderbuffer(i)}e.deleteFramebuffer(this.framebuffer)}};s(Ese,"Framebuffer");var NBe=Ese;N();var FBe=0,Cse=1,BBe=771,Ise=class{constructor(e,r,i){this.blendFunction=e,this.blendColor=r,this.mask=i}};s(Ise,"ColorMode");var qo=Ise;qo.Replace=[Cse,FBe];qo.disabled=new qo(qo.Replace,Li.transparent,[!1,!1,!1,!1]);qo.unblended=new qo(qo.Replace,Li.transparent,[!0,!0,!0,!0]);qo.alphaBlended=new qo([Cse,BBe],Li.transparent,[!0,!0,!0,!0]);var Tse=class{constructor(e){var r,i;if(this.gl=e,this.clearColor=new rBe(this),this.clearDepth=new iBe(this),this.clearStencil=new nBe(this),this.colorMask=new aBe(this),this.depthMask=new oBe(this),this.stencilMask=new sBe(this),this.stencilFunc=new lBe(this),this.stencilOp=new uBe(this),this.stencilTest=new cBe(this),this.depthRange=new hBe(this),this.depthTest=new pBe(this),this.depthFunc=new dBe(this),this.blend=new fBe(this),this.blendFunc=new mBe(this),this.blendColor=new gBe(this),this.blendEquation=new yBe(this),this.cullFace=new vBe(this),this.cullFaceSide=new _Be(this),this.frontFace=new xBe(this),this.program=new bBe(this),this.activeTexture=new wBe(this),this.viewport=new ABe(this),this.bindFramebuffer=new SBe(this),this.bindRenderbuffer=new MBe(this),this.bindTexture=new EBe(this),this.bindVertexBuffer=new CBe(this),this.bindElementBuffer=new IBe(this),this.bindVertexArray=new TBe(this),this.pixelStoreUnpack=new PBe(this),this.pixelStoreUnpackPremultiplyAlpha=new LBe(this),this.pixelStoreUnpackFlipY=new DBe(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),uw(e)){this.HALF_FLOAT=e.HALF_FLOAT;let n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!=null?r:n==null?void 0:n.RGBA16F_EXT,this.RGB16F=(i=e.RGB16F)!=null?i:n==null?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let n=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=n==null?void 0:n.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new QFe(this,e,r)}createVertexBuffer(e,r,i){return new tBe(this,e,r,i)}createRenderbuffer(e,r,i){let n=this.gl,a=n.createRenderbuffer();return this.bindRenderbuffer.set(a),n.renderbufferStorage(n.RENDERBUFFER,e,r,i),this.bindRenderbuffer.set(null),a}createFramebuffer(e,r,i,n){return new NBe(this,e,r,i,n)}clear({color:e,depth:r,stencil:i}){let n=this.gl,a=0;e&&(a|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),typeof r<"u"&&(a|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),typeof i<"u"&&(a|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),n.clear(a)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func===this.gl.ALWAYS&&!e.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range))}setStencilMode(e){e.test.func===this.gl.ALWAYS&&!e.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask}))}setColorMode(e){zm(e.blendFunction,qo.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return uw(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return uw(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}};s(Tse,"Context");var zBe=Tse;N();var Pse=class{constructor(e,r,i){this.func=e,this.mask=r,this.range=i}};s(Pse,"DepthMode");var yn=Pse;yn.ReadOnly=!1;yn.ReadWrite=!0;yn.disabled=new yn(519,yn.ReadOnly,[0,1]);N();var Lse=class{constructor(e,r,i,n,a,o){this.test=e,this.ref=r,this.mask=i,this.fail=n,this.depthFail=a,this.pass=o}};s(Lse,"StencilMode");var Ja=Lse;Ja.disabled=new Ja({func:519,mask:0},0,0,7680,7680,7680);N();var Dse=class{constructor(e,r,i){this.enable=e,this.mode=r,this.frontFace=i}};s(Dse,"CullFaceMode");var Ha=Dse;Ha.disabled=new Ha(!1,1029,2305);Ha.backCCW=new Ha(!0,1029,2305);N();var Rse=kr(Nn(),1);N();var PM;function uR(t,e,r,i,n,a,o){let l=t.context,u=l.gl,c=t.useProgram("collisionBox"),p=[],m=0,y=0;for(let P=0;P<i.length;P++){let C=i[P],T=e.getTile(C),O=T.getBucket(r);if(!O)continue;let F=C.posMatrix;(n[0]!==0||n[1]!==0)&&(F=t.translatePosMatrix(C.posMatrix,T,n,a));let k=o?O.textCollisionBox:O.iconCollisionBox,B=O.collisionCircleArray;if(B.length>0){let U=Nr.create(),z=F;Nr.mul(U,O.placementInvProjMatrix,t.transform.glCoordMatrix),Nr.mul(U,U,O.placementViewportMatrix),p.push({circleArray:B,circleOffset:y,transform:z,invTransform:U,coord:C}),m+=B.length/4,y=m}k&&c.draw(l,u.LINES,yn.disabled,Ja.disabled,t.colorModeForRenderPass(),Ha.disabled,AFe(F,t.transform,T),t.style.map.terrain&&t.style.map.terrain.getTerrainData(C),r.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,null,t.transform.zoom,null,null,k.collisionVertexBuffer)}if(!o||!p.length)return;let v=t.useProgram("collisionCircle"),w=new i8e;w.resize(m*4),w._trim();let E=0;for(let P of p)for(let C=0;C<P.circleArray.length/4;C++){let T=C*4,O=P.circleArray[T+0],F=P.circleArray[T+1],k=P.circleArray[T+2],B=P.circleArray[T+3];w.emplace(E++,O,F,k,B,0),w.emplace(E++,O,F,k,B,1),w.emplace(E++,O,F,k,B,2),w.emplace(E++,O,F,k,B,3)}(!PM||PM.length<m*2)&&(PM=Ose(m));let M=l.createIndexBuffer(PM,!0),I=l.createVertexBuffer(w,NNe.members,!0);for(let P of p){let C=SFe(P.transform,P.invTransform,t.transform);v.draw(l,u.TRIANGLES,yn.disabled,Ja.disabled,t.colorModeForRenderPass(),Ha.disabled,C,t.style.map.terrain&&t.style.map.terrain.getTerrainData(P.coord),r.id,I,M,To.simpleSegment(0,P.circleOffset*2,P.circleArray.length,P.circleArray.length/2),null,t.transform.zoom,null,null,null)}I.destroy(),M.destroy()}s(uR,"drawCollisionDebug");function Ose(t){let e=t*2,r=new a8e;r.resize(e),r._trim();for(let i=0;i<e;i++){let n=i*6;r.uint16[n+0]=i*4+0,r.uint16[n+1]=i*4+1,r.uint16[n+2]=i*4+2,r.uint16[n+3]=i*4+2,r.uint16[n+4]=i*4+3,r.uint16[n+5]=i*4+0}return r}s(Ose,"createQuadTriangles");var UBe=Nr.identity(new Float32Array(16));function kse(t,e,r,i,n){if(t.renderPass!=="translucent")return;let a=Ja.disabled,o=t.colorModeForRenderPass();(r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&Fse(i,t,r,e,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),n),r.paint.get("icon-opacity").constantOr(1)!==0&&cR(t,e,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,o),r.paint.get("text-opacity").constantOr(1)!==0&&cR(t,e,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,o),e.map.showCollisionBoxes&&(uR(t,e,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),uR(t,e,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}s(kse,"drawSymbols");function Nse(t,e,r,i,n,a){let{horizontalAlign:o,verticalAlign:l}=OF(t),u=-(o-.5)*e,c=-(l-.5)*r;return new Rse.default((u/n+i[0])*a,(c/n+i[1])*a)}s(Nse,"calculateVariableRenderShift");function Fse(t,e,r,i,n,a,o){let l=e.transform,u=n==="map",c=a==="map";for(let p of t){let m=i.getTile(p),y=m.getBucket(r);if(!y||!y.text||!y.text.segments.get().length)continue;let v=y.textSizeData,w=IA(v,l.zoom),E=ku(m,1,e.transform.zoom),M=IP(p.posMatrix,c,u,e.transform,E),I=r.layout.get("icon-text-fit")!=="none"&&y.hasIconData();if(w){let P=Math.pow(2,l.zoom-m.tileID.overscaledZ),C=e.style.map.terrain?(T,O)=>e.style.map.terrain.getElevation(p,T,O):null;Bse(y,u,c,o,l,M,p.posMatrix,P,w,I,C)}}}s(Fse,"updateVariableAnchors");function Bse(t,e,r,i,n,a,o,l,u,c,p){let m=t.text.placedSymbolArray,y=t.text.dynamicLayoutVertexArray,v=t.icon.dynamicLayoutVertexArray,w={};y.clear();for(let E=0;E<m.length;E++){let M=m.get(E),I=t.allowVerticalPlacement&&!M.placedOrientation,P=!M.hidden&&M.crossTileID&&!I?i[M.crossTileID]:null;if(!P)ky(M.numGlyphs,y);else{let C=new Rse.default(M.anchorX,M.anchorY),T=yc(C,r?o:a,p),O=TP(n.cameraToCenterDistance,T.signedDistanceFromCamera),F=SP(t.textSizeData,u,M)*O/Tne;r&&(F*=t.tilePixelRatio/l);let{width:k,height:B,anchor:U,textOffset:z,textBoxScale:q}=P,W=Nse(U,k,B,z,q,F),J=r?yc(C.add(W),a,p).point:T.point.add(e?W.rotate(-n.angle):W),V=t.allowVerticalPlacement&&M.placedOrientation===2?Math.PI/2:0;for(let oe=0;oe<M.numGlyphs;oe++)x_(y,J,V);c&&M.associatedIconIndex>=0&&(w[M.associatedIconIndex]={shiftedAnchor:J,angle:V})}}if(c){v.clear();let E=t.icon.placedSymbolArray;for(let M=0;M<E.length;M++){let I=E.get(M);if(I.hidden)ky(I.numGlyphs,v);else{let P=w[M];if(!P)ky(I.numGlyphs,v);else for(let C=0;C<I.numGlyphs;C++)x_(v,P.shiftedAnchor,P.angle)}}t.icon.dynamicLayoutVertexBuffer.updateData(v)}t.text.dynamicLayoutVertexBuffer.updateData(y)}s(Bse,"updateVariableAnchorsForBucket");function zse(t,e,r){return r.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}s(zse,"getSymbolProgramName");function cR(t,e,r,i,n,a,o,l,u,c,p,m){let y=t.context,v=y.gl,w=t.transform,E=l==="map",M=u==="map",I=l!=="viewport"&&r.layout.get("symbol-placement")!=="point",P=E&&!M&&!I,C=!r.layout.get("symbol-sort-key").isConstant(),T=!1,O=t.depthModeForSublayer(0,yn.ReadOnly),F=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k=[];for(let B of i){let U=e.getTile(B),z=U.getBucket(r);if(!z)continue;let q=n?z.text:z.icon;if(!q||!q.segments.get().length||!q.hasVisibleVertices)continue;let W=q.programConfigurations.get(r.id),J=n||z.sdfIcons,V=n?z.textSizeData:z.iconSizeData,oe=M||w.pitch!==0,Y=t.useProgram(zse(J,n,z),W),he=IA(V,w.zoom),Q=t.style.map.terrain&&t.style.map.terrain.getTerrainData(B),ae,ee=[0,0],le,K,ce=null,te;if(n){if(le=U.glyphAtlasTexture,K=v.LINEAR,ae=U.glyphAtlasTexture.size,z.iconsInText){ee=U.imageAtlasTexture.size,ce=U.imageAtlasTexture;let tt=V.kind==="composite"||V.kind==="camera";te=oe||t.options.rotating||t.options.zooming||tt?v.LINEAR:v.NEAREST}}else{let tt=r.layout.get("icon-size").constantOr(0)!==1||z.iconsNeedLinear;le=U.imageAtlasTexture,K=J||t.options.rotating||t.options.zooming||tt||oe?v.LINEAR:v.NEAREST,ae=U.imageAtlasTexture.size}let ne=ku(U,1,t.transform.zoom),pe=IP(B.posMatrix,M,E,t.transform,ne),xe=jF(B.posMatrix,M,E,t.transform,ne),Te=F&&z.hasTextData(),fe=r.layout.get("icon-text-fit")!=="none"&&Te&&z.hasIconData();if(I){let tt=t.style.map.terrain?(at,Lt)=>t.style.map.terrain.getElevation(B,at,Lt):null,We=r.layout.get("text-rotation-alignment")==="map";soe(z,B.posMatrix,t,n,pe,xe,M,c,We,tt)}let Pe=t.translatePosMatrix(B.posMatrix,U,a,o),me=I||n&&F||fe?UBe:pe,Ae=t.translatePosMatrix(xe,U,a,o,!0),Ue=J&&r.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1)!==0,_e;J?z.iconsInText?_e=WFe(V.kind,he,P,M,t,Pe,me,Ae,ae,ee):_e=Voe(V.kind,he,P,M,t,Pe,me,Ae,n,ae,!0):_e=Uoe(V.kind,he,P,M,t,Pe,me,Ae,n,ae);let lt={program:Y,buffers:q,uniformValues:_e,atlasTexture:le,atlasTextureIcon:ce,atlasInterpolation:K,atlasInterpolationIcon:te,isSDF:J,hasHalo:Ue};if(C&&z.canOverlap){T=!0;let tt=q.segments.get();for(let We of tt)k.push({segments:new To([We]),sortKey:We.sortKey,state:lt,terrainData:Q})}else k.push({segments:q.segments,sortKey:0,state:lt,terrainData:Q})}T&&k.sort((B,U)=>B.sortKey-U.sortKey);for(let B of k){let U=B.state;if(y.activeTexture.set(v.TEXTURE0),U.atlasTexture.bind(U.atlasInterpolation,v.CLAMP_TO_EDGE),U.atlasTextureIcon&&(y.activeTexture.set(v.TEXTURE1),U.atlasTextureIcon&&U.atlasTextureIcon.bind(U.atlasInterpolationIcon,v.CLAMP_TO_EDGE)),U.isSDF){let z=U.uniformValues;U.hasHalo&&(z.u_is_halo=1,hR(U.buffers,B.segments,r,t,U.program,O,p,m,z,B.terrainData)),z.u_is_halo=0}hR(U.buffers,B.segments,r,t,U.program,O,p,m,U.uniformValues,B.terrainData)}}s(cR,"drawLayerSymbols");function hR(t,e,r,i,n,a,o,l,u,c){let p=i.context,m=p.gl;n.draw(p,m.TRIANGLES,a,o,l,Ha.disabled,u,c,r.id,t.layoutVertexBuffer,t.indexBuffer,e,r.paint,i.transform.zoom,t.programConfigurations.get(r.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}s(hR,"drawSymbolElements");N();function Use(t,e,r,i){if(t.renderPass!=="translucent")return;let n=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),o=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(n.constantOr(1)===0&&(a.constantOr(1)===0||o.constantOr(1)===0))return;let u=t.context,c=u.gl,p=t.depthModeForSublayer(0,yn.ReadOnly),m=Ja.disabled,y=t.colorModeForRenderPass(),v=[];for(let w=0;w<i.length;w++){let E=i[w],M=e.getTile(E),I=M.getBucket(r);if(!I)continue;let P=I.programConfigurations.get(r.id),C=t.useProgram("circle",P),T=I.layoutVertexBuffer,O=I.indexBuffer,F=t.style.map.terrain&&t.style.map.terrain.getTerrainData(E),k=xFe(t,E,M,r),B={programConfiguration:P,program:C,layoutVertexBuffer:T,indexBuffer:O,uniformValues:k,terrainData:F};if(l){let U=I.segments.get();for(let z of U)v.push({segments:new To([z]),sortKey:z.sortKey,state:B})}else v.push({segments:I.segments,sortKey:0,state:B})}l&&v.sort((w,E)=>w.sortKey-E.sortKey);for(let w of v){let{programConfiguration:E,program:M,layoutVertexBuffer:I,indexBuffer:P,uniformValues:C,terrainData:T}=w.state,O=w.segments;M.draw(u,c.TRIANGLES,p,m,y,Ha.disabled,C,T,r.id,I,P,O,r.paint,t.transform.zoom,E)}}s(Use,"drawCircles");N();function Vse(t,e,r,i){if(r.paint.get("heatmap-opacity")!==0)if(t.renderPass==="offscreen"){let n=t.context,a=n.gl,o=Ja.disabled,l=new qo([a.ONE,a.ONE],Li.transparent,[!0,!0,!0,!0]);jse(n,t,r),n.clear({color:Li.transparent});for(let u=0;u<i.length;u++){let c=i[u];if(e.hasRenderableParent(c))continue;let p=e.getTile(c),m=p.getBucket(r);if(!m)continue;let y=m.programConfigurations.get(r.id),v=t.useProgram("heatmap",y),{zoom:w}=t.transform;v.draw(n,a.TRIANGLES,yn.disabled,o,l,Ha.disabled,TFe(c.posMatrix,p,w,r.paint.get("heatmap-intensity")),null,r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,r.paint,t.transform.zoom,y)}n.viewport.set([0,0,t.width,t.height])}else t.renderPass==="translucent"&&(t.context.setColorMode(t.colorModeForRenderPass()),Gse(t,r))}s(Vse,"drawHeatmap");function jse(t,e,r){let i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let n=r.heatmapFbo;if(n)i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),t.bindFramebuffer.set(n.framebuffer);else{let a=i.createTexture();i.bindTexture(i.TEXTURE_2D,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),n=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),$se(t,e,a,n)}}s(jse,"bindFramebuffer");function $se(t,e,r,i){var n,a;let o=t.gl,l=(n=t.HALF_FLOAT)!=null?n:o.UNSIGNED_BYTE,u=(a=t.RGBA16F)!=null?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,u,e.width/4,e.height/4,0,o.RGBA,l,null),i.colorAttachment.set(r)}s($se,"bindTextureToFramebuffer");function Gse(t,e){let r=t.context,i=r.gl,n=e.heatmapFbo;if(!n)return;r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);let a=e.colorRampTexture;a||(a=e.colorRampTexture=new Es(r,e.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(r,i.TRIANGLES,yn.disabled,Ja.disabled,t.colorModeForRenderPass(),Ha.disabled,PFe(t,e,0,1),null,e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}s(Gse,"renderTextureToMap");N();function Hse(t,e,r,i){if(t.renderPass!=="translucent")return;let n=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(n.constantOr(1)===0||a.constantOr(1)===0)return;let o=t.depthModeForSublayer(0,yn.ReadOnly),l=t.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),c=r.paint.get("line-pattern"),p=c.constantOr(1),m=r.paint.get("line-gradient"),y=r.getCrossfadeParameters(),v=p?"linePattern":u?"lineSDF":m?"lineGradient":"line",w=t.context,E=w.gl,M=!0;for(let I of i){let P=e.getTile(I);if(p&&!P.patternsLoaded())continue;let C=P.getBucket(r);if(!C)continue;let T=C.programConfigurations.get(r.id),O=t.context.program.get(),F=t.useProgram(v,T),k=M||F.program!==O,B=t.style.map.terrain&&t.style.map.terrain.getTerrainData(I),U=c.constantOr(null);if(U&&P.imageAtlas){let W=P.imageAtlas,J=W.patternPositions[U.to.toString()],V=W.patternPositions[U.from.toString()];J&&V&&T.setConstantPatternPositions(J,V)}let z=B?I:null,q=p?UFe(t,P,r,y,z):u?VFe(t,P,r,u,y,z):m?zFe(t,P,r,C.lineClipsArray.length,z):XF(t,P,r,z);if(p)w.activeTexture.set(E.TEXTURE0),P.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),T.updatePaintBuffers(y);else if(u&&(k||t.lineAtlas.dirty))w.activeTexture.set(E.TEXTURE0),t.lineAtlas.bind(w);else if(m){let W=C.gradients[r.id],J=W.texture;if(r.gradientVersion!==W.version){let V=256;if(r.stepInterpolant){let oe=e.getSource().maxzoom,Y=I.canonical.z===oe?Math.ceil(1<<t.transform.maxZoom-I.canonical.z):1,he=C.maxLineLength/8192*1024*Y;V=ps(uZ(he),256,w.maxTextureSize)}W.gradient=TF({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:V,image:W.gradient||void 0,clips:C.lineClipsArray}),W.texture?W.texture.update(W.gradient):W.texture=new Es(w,W.gradient,E.RGBA),W.version=r.gradientVersion,J=W.texture}w.activeTexture.set(E.TEXTURE0),J.bind(r.stepInterpolant?E.NEAREST:E.LINEAR,E.CLAMP_TO_EDGE)}F.draw(w,E.TRIANGLES,o,t.stencilModeForClipping(I),l,Ha.disabled,q,B,r.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,r.paint,t.transform.zoom,T,C.layoutVertexBuffer2),M=!1}}s(Hse,"drawLine");N();N();function JF(t,e,r,i,n){if(!r||!i||!i.imageAtlas)return;let a=i.imageAtlas.patternPositions,o=a[r.to.toString()],l=a[r.from.toString()];if(!o&&l&&(o=l),!l&&o&&(l=o),!o||!l){let u=n.getPaintProperty(e);o=a[u],l=a[u]}o&&l&&t.setConstantPatternPositions(o,l)}s(JF,"updatePatternPositionsInProgram");function qse(t,e,r,i){let n=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(a.constantOr(1)===0)return;let o=t.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&n.constantOr(Li.transparent).a===1&&a.constantOr(0)===1?"opaque":"translucent";if(t.renderPass===u){let c=t.depthModeForSublayer(1,t.renderPass==="opaque"?yn.ReadWrite:yn.ReadOnly);pR(t,e,r,i,c,o,!1)}if(t.renderPass==="translucent"&&r.paint.get("fill-antialias")){let c=t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,yn.ReadOnly);pR(t,e,r,i,c,o,!0)}}s(qse,"drawFill");function pR(t,e,r,i,n,a,o){let l=t.context.gl,u="fill-pattern",c=r.paint.get(u),p=c&&c.constantOr(1),m=r.getCrossfadeParameters(),y,v,w,E,M;o?(v=p&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y=l.LINES):(v=p?"fillPattern":"fill",y=l.TRIANGLES);let I=c.constantOr(null);for(let P of i){let C=e.getTile(P);if(p&&!C.patternsLoaded())continue;let T=C.getBucket(r);if(!T)continue;let O=T.programConfigurations.get(r.id),F=t.useProgram(v,O),k=t.style.map.terrain&&t.style.map.terrain.getTerrainData(P);p&&(t.context.activeTexture.set(l.TEXTURE0),C.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),O.updatePaintBuffers(m)),JF(O,u,I,C,r);let B=k?P:null,U=B?B.posMatrix:P.posMatrix,z=t.translatePosMatrix(U,C,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(!o)E=T.indexBuffer,M=T.segments,w=p?koe(z,t,m,C):Ooe(z);else{E=T.indexBuffer2,M=T.segments2;let q=[l.drawingBufferWidth,l.drawingBufferHeight];w=v==="fillOutlinePattern"&&p?vFe(z,t,m,C,q):yFe(z,q)}F.draw(t.context,y,n,t.stencilModeForClipping(P),a,Ha.disabled,w,k,r.id,T.layoutVertexBuffer,E,M,r.paint,t.transform.zoom,O)}}s(pR,"drawFillTiles");N();function Wse(t,e,r,i){let n=r.paint.get("fill-extrusion-opacity");if(n!==0&&t.renderPass==="translucent"){let a=new yn(t.context.gl.LEQUAL,yn.ReadWrite,t.depthRangeFor3D);if(n===1&&!r.paint.get("fill-extrusion-pattern").constantOr(1)){let o=t.colorModeForRenderPass();qE(t,e,r,i,a,Ja.disabled,o)}else qE(t,e,r,i,a,Ja.disabled,qo.disabled),qE(t,e,r,i,a,t.stencilModeFor3D(),t.colorModeForRenderPass())}}s(Wse,"drawFillExtrusion");function qE(t,e,r,i,n,a,o){let l=t.context,u=l.gl,c="fill-extrusion-pattern",p=r.paint.get(c),m=p.constantOr(1),y=r.getCrossfadeParameters(),v=r.paint.get("fill-extrusion-opacity"),w=p.constantOr(null);for(let E of i){let M=e.getTile(E),I=M.getBucket(r);if(!I)continue;let P=t.style.map.terrain&&t.style.map.terrain.getTerrainData(E),C=I.programConfigurations.get(r.id),T=t.useProgram(m?"fillExtrusionPattern":"fillExtrusion",C);m&&(t.context.activeTexture.set(u.TEXTURE0),M.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),C.updatePaintBuffers(y)),JF(C,c,w,M,r);let O=t.translatePosMatrix(E.posMatrix,M,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),F=r.paint.get("fill-extrusion-vertical-gradient"),k=m?pFe(O,t,F,v,E,y,M):Roe(O,t,F,v);T.draw(l,l.gl.TRIANGLES,n,a,o,Ha.backCCW,k,P,r.id,I.layoutVertexBuffer,I.indexBuffer,I.segments,r.paint,t.transform.zoom,C,t.style.map.terrain&&I.centroidVertexBuffer)}}s(qE,"drawExtrusionTiles");N();function Xse(t,e,r,i){if(t.renderPass!=="offscreen"&&t.renderPass!=="translucent")return;let n=t.context,a=t.depthModeForSublayer(0,yn.ReadOnly),o=t.colorModeForRenderPass(),[l,u]=t.renderPass==="translucent"?t.stencilConfigForOverlap(i):[{},i];for(let c of u){let p=e.getTile(c);typeof p.needsHillshadePrepare<"u"&&p.needsHillshadePrepare&&t.renderPass==="offscreen"?Yse(t,p,r,a,Ja.disabled,o):t.renderPass==="translucent"&&Zse(t,c,p,r,a,l[c.overscaledZ],o)}n.viewport.set([0,0,t.width,t.height])}s(Xse,"drawHillshade");function Zse(t,e,r,i,n,a,o){let l=t.context,u=l.gl,c=r.fbo;if(!c)return;let p=t.useProgram("hillshade"),m=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());let y=m?e:null;p.draw(l,u.TRIANGLES,n,a,o,Ha.disabled,RFe(t,r,i,y),m,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}s(Zse,"renderHillshade");function Yse(t,e,r,i,n,a){let o=t.context,l=o.gl,u=e.dem;if(u&&u.data){let c=u.dim,p=u.stride,m=u.getPixels();if(o.activeTexture.set(l.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(p),e.demTexture){let v=e.demTexture;v.update(m,{premultiply:!1}),v.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else e.demTexture=new Es(o,m,l.RGBA,{premultiply:!1}),e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);o.activeTexture.set(l.TEXTURE0);let y=e.fbo;if(!y){let v=new Es(o,{width:c,height:c,data:null},l.RGBA);v.bind(l.LINEAR,l.CLAMP_TO_EDGE),y=e.fbo=o.createFramebuffer(c,c,!0,!1),y.colorAttachment.set(v.texture)}o.bindFramebuffer.set(y.framebuffer),o.viewport.set([0,0,c,c]),t.useProgram("hillshadePrepare").draw(o,l.TRIANGLES,i,n,a,Ha.disabled,OFe(e.tileID,u),null,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}s(Yse,"prepareHillshade");N();function Kse(t,e,r,i){if(t.renderPass!=="translucent"||r.paint.get("raster-opacity")===0||!i.length)return;let n=t.context,a=n.gl,o=e.getSource(),l=t.useProgram("raster"),u=t.colorModeForRenderPass(),[c,p]=o instanceof Cw?[{},i]:t.stencilConfigForOverlap(i),m=p[p.length-1].overscaledZ,y=!t.options.moving;for(let v of p){let w=t.depthModeForSublayer(v.overscaledZ-m,r.paint.get("raster-opacity")===1?yn.ReadWrite:yn.ReadOnly,a.LESS),E=e.getTile(v);E.registerFadeDuration(r.paint.get("raster-fade-duration"));let M=e.findLoadedParent(v,0),I=Jse(E,M,e,r,t.transform,t.style.map.terrain),P,C,T=r.paint.get("raster-resampling")==="nearest"?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),E.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),M?(M.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),P=Math.pow(2,M.tileID.overscaledZ-E.tileID.overscaledZ),C=[E.tileID.canonical.x*P%1,E.tileID.canonical.y*P%1]):E.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);let O=t.style.map.terrain&&t.style.map.terrain.getTerrainData(v),F=O?v:null,k=F?F.posMatrix:t.transform.calculatePosMatrix(v.toUnwrapped(),y),B=$Fe(k,C||[0,0],P||1,I,r);o instanceof Cw?l.draw(n,a.TRIANGLES,w,Ja.disabled,u,Ha.disabled,B,O,r.id,o.boundsBuffer,t.quadTriangleIndexBuffer,o.boundsSegments):l.draw(n,a.TRIANGLES,w,c[v.overscaledZ],u,Ha.disabled,B,O,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}s(Kse,"drawRaster");function Jse(t,e,r,i,n,a){let o=i.paint.get("raster-fade-duration");if(!a&&o>0){let l=vn.now(),u=(l-t.timeAdded)/o,c=e?(l-e.timeAdded)/o:-1,p=r.getSource(),m=n.coveringZoomLevel({tileSize:p.tileSize,roundZoom:p.roundZoom}),y=!e||Math.abs(e.tileID.overscaledZ-m)>Math.abs(t.tileID.overscaledZ-m),v=y&&t.refreshedUponExpiration?1:ps(y?u:1-c,0,1);return t.refreshedUponExpiration&&u>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-v}:{opacity:v,mix:0}}else return{opacity:1,mix:0}}s(Jse,"getFadeValues");N();function Qse(t,e,r,i){let n=r.paint.get("background-color"),a=r.paint.get("background-opacity");if(a===0)return;let o=t.context,l=o.gl,u=t.transform,c=u.tileSize,p=r.paint.get("background-pattern");if(t.isPatternMissing(p))return;let m=!p&&n.a===1&&a===1&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==m)return;let y=Ja.disabled,v=t.depthModeForSublayer(0,m==="opaque"?yn.ReadWrite:yn.ReadOnly),w=t.colorModeForRenderPass(),E=t.useProgram(p?"backgroundPattern":"background"),M=i||u.coveringTiles({tileSize:c,terrain:t.style.map.terrain});p&&(o.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));let I=r.getCrossfadeParameters();for(let P of M){let C=i?P.posMatrix:t.transform.calculatePosMatrix(P.toUnwrapped()),T=p?KFe(C,a,t,p,{tileID:P,tileSize:c},I):YFe(C,a,n),O=t.style.map.terrain&&t.style.map.terrain.getTerrainData(P);E.draw(o,l.TRIANGLES,v,y,w,Ha.disabled,T,O,r.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}s(Qse,"drawBackground");N();var VBe=new Li(1,0,0,1),jBe=new Li(0,1,0,1),$Be=new Li(0,0,1,1),GBe=new Li(1,0,1,1),HBe=new Li(0,1,1,1);function ele(t){let e=t.transform.padding,r=3;dR(t,t.transform.height-(e.top||0),r,VBe),dR(t,e.bottom||0,r,jBe),fR(t,e.left||0,r,$Be),fR(t,t.transform.width-(e.right||0),r,GBe);let i=t.transform.centerPoint;tle(t,i.x,t.transform.height-i.y,HBe)}s(ele,"drawDebugPadding");function tle(t,e,r,i){Lw(t,e-2/2,r-20/2,2,20,i),Lw(t,e-20/2,r-2/2,20,2,i)}s(tle,"drawCrosshair");function dR(t,e,r,i){Lw(t,0,e+r/2,t.transform.width,r,i)}s(dR,"drawHorizontalLine");function fR(t,e,r,i){Lw(t,e-r/2,0,r,t.transform.height,i)}s(fR,"drawVerticalLine");function Lw(t,e,r,i,n,a){let o=t.context,l=o.gl;l.enable(l.SCISSOR_TEST),l.scissor(e*t.pixelRatio,r*t.pixelRatio,i*t.pixelRatio,n*t.pixelRatio),o.clear({color:a}),l.disable(l.SCISSOR_TEST)}s(Lw,"drawDebugSSRect");function rle(t,e,r){for(let i=0;i<r.length;i++)ile(t,e,r[i])}s(rle,"drawDebug");function ile(t,e,r){let i=t.context,n=i.gl,a=r.posMatrix,o=t.useProgram("debug"),l=yn.disabled,u=Ja.disabled,c=t.colorModeForRenderPass(),p="$debug",m=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r);i.activeTexture.set(n.TEXTURE0);let y=e.getTileByID(r.key).latestRawTileData,v=y&&y.byteLength||0,w=Math.floor(v/1024),E=e.getTile(r).tileSize,M=512/Math.min(E,512)*(r.overscaledZ/t.transform.zoom)*.5,I=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(I+=" => ".concat(r.overscaledZ));let P="".concat(I," ").concat(w,"kB");nle(t,P),o.draw(i,n.TRIANGLES,l,u,qo.alphaBlended,Ha.disabled,hq(a,Li.transparent,M),null,p,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),o.draw(i,n.LINE_STRIP,l,u,c,Ha.disabled,hq(a,Li.red),m,p,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}s(ile,"drawDebugTile");function nle(t,e){t.initDebugOverlayCanvas();let r=t.debugOverlayCanvas,i=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,r.width,r.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(r),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}s(nle,"drawTextToOverlay");function ale(t,e){let r=null,i=Object.values(t._layers).flatMap(l=>l.source&&!l.isHidden(e)?[t.sourceCaches[l.source]]:[]),n=i.filter(l=>l.getSource().type==="vector"),a=i.filter(l=>l.getSource().type!=="vector"),o=s(l=>{(!r||r.getSource().maxzoom<l.getSource().maxzoom)&&(r=l)},"considerSource");return n.forEach(l=>o(l)),r||a.forEach(l=>o(l)),r}s(ale,"selectDebugSource");N();function ole(t,e,r){let i=t.context,n=r.implementation;if(t.renderPass==="offscreen"){let a=n.prerender;a&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),a.call(n,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if(t.renderPass==="translucent"){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(Ja.disabled);let a=n.renderingMode==="3d"?new yn(t.context.gl.LEQUAL,yn.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,yn.ReadOnly);i.setDepthMode(a),n.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}s(ole,"drawCustom");N();function sle(t,e){let r=t.context,i=r.gl,n=qo.unblended,a=new yn(i.LEQUAL,yn.ReadWrite,[0,1]),o=e.getTerrainMesh(),l=e.sourceCache.getRenderableTiles(),u=t.useProgram("terrainDepth");r.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:Li.transparent,depth:1});for(let c of l){let p=e.getTerrainData(c.tileID),m=t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),y=sFe(m,e.getMeshFrameDelta(t.transform.zoom));u.draw(r,i.TRIANGLES,a,Ja.disabled,n,Ha.backCCW,y,p,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}s(sle,"drawDepth");function lle(t,e){let r=t.context,i=r.gl,n=qo.unblended,a=new yn(i.LEQUAL,yn.ReadWrite,[0,1]),o=e.getTerrainMesh(),l=e.getCoordsTexture(),u=e.sourceCache.getRenderableTiles(),c=t.useProgram("terrainCoords");r.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:Li.transparent,depth:1}),e.coordsIndex=[];for(let p of u){let m=e.getTerrainData(p.tileID);r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);let y=t.transform.calculatePosMatrix(p.tileID.toUnwrapped()),v=lFe(y,255-e.coordsIndex.length,e.getMeshFrameDelta(t.transform.zoom));c.draw(r,i.TRIANGLES,a,Ja.disabled,n,Ha.backCCW,v,m,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(p.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}s(lle,"drawCoords");function mR(t,e,r){let i=t.context,n=i.gl,a=t.colorModeForRenderPass(),o=new yn(n.LEQUAL,yn.ReadWrite,t.depthRangeFor3D),l=t.useProgram("terrain"),u=e.getTerrainMesh();i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height]);for(let c of r){let p=t.renderToTexture.getTexture(c),m=e.getTerrainData(c.tileID);i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,p.texture);let y=t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),v=oFe(y,e.getMeshFrameDelta(t.transform.zoom));l.draw(i,n.TRIANGLES,o,Ja.disabled,a,Ha.backCCW,v,m,"terrain",u.vertexBuffer,u.indexBuffer,u.segments)}}s(mR,"drawTerrain");var ule=class{constructor(e,r){this.context=new zBe(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Nr.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Iw.maxUnderzooming+Iw.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ioe}resize(e,r,i){if(this.width=Math.floor(e*i),this.height=Math.floor(r*i),this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let n of this.style._order)this.style._layers[n].resize()}setup(){let e=this.context,r=new zE;r.emplaceBack(0,0),r.emplaceBack(8192,0),r.emplaceBack(0,8192),r.emplaceBack(8192,8192),this.tileExtentBuffer=e.createVertexBuffer(r,FL.members),this.tileExtentSegments=To.simpleSegment(0,0,4,2);let i=new zE;i.emplaceBack(0,0),i.emplaceBack(8192,0),i.emplaceBack(0,8192),i.emplaceBack(8192,8192),this.debugBuffer=e.createVertexBuffer(i,FL.members),this.debugSegments=To.simpleSegment(0,0,4,5);let n=new GQ;n.emplaceBack(0,0,0,0),n.emplaceBack(8192,0,8192,0),n.emplaceBack(0,8192,0,8192),n.emplaceBack(8192,8192,8192,8192),this.rasterBoundsBuffer=e.createVertexBuffer(n,CP.members),this.rasterBoundsSegments=To.simpleSegment(0,0,4,2);let a=new zE;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,FL.members),this.viewportSegments=To.simpleSegment(0,0,4,2);let o=new o8e;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);let l=new cv;l.emplaceBack(0,1,2),l.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l);let u=this.context.gl;this.stencilClearMode=new Ja({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)}clearStencil(){let e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let i=Nr.create();Nr.ortho(i,0,this.width,this.height,0,0,1),Nr.scale(i,i,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,r.TRIANGLES,yn.disabled,this.stencilClearMode,qo.disabled,Ha.disabled,pq(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source;let i=this.context,n=i.gl;this.nextStencilID+r.length>256&&this.clearStencil(),i.setColorMode(qo.disabled),i.setDepthMode(yn.disabled);let a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let o of r){let l=this._tileClippingMaskIDs[o.key]=this.nextStencilID++,u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(o);a.draw(i,n.TRIANGLES,yn.disabled,new Ja({func:n.ALWAYS,mask:0},l,255,n.KEEP,n.KEEP,n.REPLACE),qo.disabled,Ha.disabled,pq(o.posMatrix),u,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,r=this.context.gl;return new Ja({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){let r=this.context.gl;return new Ja({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(e){let r=this.context.gl,i=e.sort((o,l)=>l.overscaledZ-o.overscaledZ),n=i[i.length-1].overscaledZ,a=i[0].overscaledZ-n+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let o={};for(let l=0;l<a;l++)o[l+n]=new Ja({func:r.GEQUAL,mask:255},l+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=a,[o,i]}return[{[n]:Ja.disabled},i]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new qo([e.CONSTANT_COLOR,e.ONE],new Li(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qo.unblended:qo.alphaBlended}depthModeForSublayer(e,r,i){if(!this.opaquePassEnabledForLayer())return yn.disabled;let n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new yn(i||this.context.gl.LEQUAL,r,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(vn.now()),this.imageManager.beginFrame();let i=this.style._order,n=this.style.sourceCaches,a={},o={},l={};for(let u in n){let c=n[u];c.used&&c.prepare(this.context),a[u]=c.getVisibleCoordinates(),o[u]=a[u].slice().reverse(),l[u]=c.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let u=0;u<i.length;u++){let c=i[u];if(this.style._layers[c].is3D()){this.opaquePassCutoff=u;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let u of i){let c=this.style._layers[u];if(!c.hasOffscreenPass()||c.isHidden(this.transform.zoom))continue;let p=o[c.source];c.type!=="custom"&&!p.length||this.renderLayer(this,n[c.source],c,p)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?Li.black:Li.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){let u=this.style._layers[i[this.currentLayer]],c=n[u.source],p=a[u.source];this._renderTileClippingMasks(u,p),this.renderLayer(this,c,u,p)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){let u=this.style._layers[i[this.currentLayer]],c=n[u.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(u))continue;let p=(u.type==="symbol"?l:o)[u.source];this._renderTileClippingMasks(u,a[u.source]),this.renderLayer(this,c,u,p)}if(this.options.showTileBoundaries){let u=ale(this.style,this.transform.zoom);u&&rle(this,u,u.getVisibleCoordinates())}this.options.showPadding&&ele(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let r=this.terrainFacilitator.matrix,i=this.transform.projMatrix,n=this.terrainFacilitator.dirty;n||(n=e?!Nr.exactEquals(r,i):!Nr.equals(r,i)),n||(n=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),n&&(Nr.copy(r,i),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,sle(this,this.style.map.terrain),lle(this,this.style.map.terrain))}renderLayer(e,r,i,n){if(!i.isHidden(this.transform.zoom)&&!(i.type!=="background"&&i.type!=="custom"&&!(n||[]).length))switch(this.id=i.id,i.type){case"symbol":kse(e,r,i,n,this.style.placement.variableOffsets);break;case"circle":Use(e,r,i,n);break;case"heatmap":Vse(e,r,i,n);break;case"line":Hse(e,r,i,n);break;case"fill":qse(e,r,i,n);break;case"fill-extrusion":Wse(e,r,i,n);break;case"hillshade":Xse(e,r,i,n);break;case"raster":Kse(e,r,i,n);break;case"background":Qse(e,r,i,n);break;case"custom":ole(e,r,i);break}}translatePosMatrix(e,r,i,n,a){if(!i[0]&&!i[1])return e;let o=a?n==="map"?this.transform.angle:0:n==="viewport"?-this.transform.angle:0;if(o){let c=Math.sin(o),p=Math.cos(o);i=[i[0]*p-i[1]*c,i[0]*c+i[1]*p]}let l=[a?i[0]:ku(r,i[0],this.transform.zoom),a?i[1]:ku(r,i[1],this.transform.zoom),0],u=new Float32Array(16);return Nr.translate(u,e,l),u}saveTileTexture(e){let r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let r=this.imageManager.getPattern(e.from.toString()),i=this.imageManager.getPattern(e.to.toString());return!r||!i}useProgram(e,r){this.cache=this.cache||{};let i=e+(r?r.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new uFe(this.context,l2[e],r,JFe[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;let e=this.context.gl;this.debugOverlayTexture=new Es(this.context,this.debugOverlayCanvas,e.RGBA)}}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}};s(ule,"Painter");var qBe=ule;N();var os=kr(Nn(),1);N();var cle=class hle{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,i){let n=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],a=Math.pow(2,i),o=n.map(u=>{u=Jl.transformMat4([],u,e);let c=1/u[3]/r*a;return Jl.mul(u,u,[c,c,1/u[3],c])}),l=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(u=>{let c=kh.sub([],o[u[0]],o[u[1]]),p=kh.sub([],o[u[2]],o[u[1]]),m=kh.normalize([],kh.cross([],c,p)),y=-kh.dot(m,o[u[1]]);return m.concat(y)});return new hle(o,l)}};s(cle,"Frustum");var WBe=cle,ple=class dle{constructor(e,r){this.min=e,this.max=r,this.center=kh.scale([],kh.add([],this.min,this.max),.5)}quadrant(e){let r=[e%2===0,e<2],i=kh.clone(this.min),n=kh.clone(this.max);for(let a=0;a<r.length;a++)i[a]=r[a]?this.min[a]:this.center[a],n[a]=r[a]?this.center[a]:this.max[a];return n[2]=this.max[2],new dle(i,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let r=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],i=!0;for(let n=0;n<e.planes.length;n++){let a=e.planes[n],o=0;for(let l=0;l<r.length;l++)Jl.dot(a,r[l])>=0&&o++;if(o===0)return 0;o!==r.length&&(i=!1)}if(i)return 2;for(let n=0;n<3;n++){let a=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let l=0;l<e.points.length;l++){let u=e.points[l][n]-this.min[n];a=Math.min(a,u),o=Math.max(o,u)}if(o<0||a>this.max[n]-this.min[n])return 0}return 1}};s(ple,"Aabb");var dq=ple;N();var XBe=kr(Nn(),1),fle=class mle{constructor(e=0,r=0,i=0,n=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(i)||i<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=i,this.right=n}interpolate(e,r,i){return r.top!=null&&e.top!=null&&(this.top=Ka.number(e.top,r.top,i)),r.bottom!=null&&e.bottom!=null&&(this.bottom=Ka.number(e.bottom,r.bottom,i)),r.left!=null&&e.left!=null&&(this.left=Ka.number(e.left,r.left,i)),r.right!=null&&e.right!=null&&(this.right=Ka.number(e.right,r.right,i)),this}getCenter(e,r){let i=ps((this.left+e-this.right)/2,0,e),n=ps((this.top+r-this.bottom)/2,0,r);return new XBe.default(i,n)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new mle(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}};s(fle,"EdgeInsets");var ZBe=fle,LM=85.051129,gle=class yle{constructor(e,r,i,n,a){this.tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=i??0,this._maxPitch=n??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Ki(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ZBe,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new yle(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new os.default(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){let r=-Ay(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=BD.create(),BD.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let r=ps(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let r=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this.tileZoom=Math.max(0,Math.floor(r)),this.scale=this.zoomScale(r),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,i){this._unmodified=!1,this._edgeInsets.interpolate(e,r,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){let r=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(e){let r=[new KD(0,e)];if(this._renderWorldCopies){let i=this.pointCoordinate(new os.default(0,0)),n=this.pointCoordinate(new os.default(this.width,0)),a=this.pointCoordinate(new os.default(this.width,this.height)),o=this.pointCoordinate(new os.default(0,this.height)),l=Math.floor(Math.min(i.x,n.x,a.x,o.x)),u=Math.floor(Math.max(i.x,n.x,a.x,o.x)),c=1;for(let p=l-c;p<=u+c;p++)p!==0&&r.push(new KD(p,e))}return r}coveringTiles(e){var r,i;let n=this.coveringZoomLevel(e),a=n;if(e.minzoom!==void 0&&n<e.minzoom)return[];e.maxzoom!==void 0&&n>e.maxzoom&&(n=e.maxzoom);let o=this.pointCoordinate(this.getCameraPoint()),l=al.fromLngLat(this.center),u=Math.pow(2,n),c=[u*o.x,u*o.y,0],p=[u*l.x,u*l.y,0],m=WBe.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),y=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(y=n);let v=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,w=s(C=>({aabb:new dq([C*u,0,0],[(C+1)*u,u,0]),zoom:0,x:0,y:0,wrap:C,fullyVisible:!1}),"newRootTile"),E=[],M=[],I=n,P=e.reparseOverscaled?a:n;if(this._renderWorldCopies)for(let C=1;C<=3;C++)E.push(w(-C)),E.push(w(C));for(E.push(w(0));E.length>0;){let C=E.pop(),T=C.x,O=C.y,F=C.fullyVisible;if(!F){let W=C.aabb.intersects(m);if(W===0)continue;F=W===2}let k=e.terrain?c:p,B=C.aabb.distanceX(k),U=C.aabb.distanceY(k),z=Math.max(Math.abs(B),Math.abs(U)),q=v+(1<<I-C.zoom)-2;if(C.zoom===I||z>q&&C.zoom>=y){let W=I-C.zoom,J=c[0]-.5-(T<<W),V=c[1]-.5-(O<<W);M.push({tileID:new hc(C.zoom===I?P:C.zoom,C.wrap,C.zoom,T,O),distanceSq:yF.sqrLen([p[0]-.5-T,p[1]-.5-O]),tileDistanceToCamera:Math.sqrt(J*J+V*V)});continue}for(let W=0;W<4;W++){let J=(T<<1)+W%2,V=(O<<1)+(W>>1),oe=C.zoom+1,Y=C.aabb.quadrant(W);if(e.terrain){let he=new hc(oe,C.wrap,oe,J,V),Q=e.terrain.getMinMaxElevation(he),ae=(r=Q.minElevation)!=null?r:this.elevation,ee=(i=Q.maxElevation)!=null?i:this.elevation;Y=new dq([Y.min[0],Y.min[1],ae],[Y.max[0],Y.max[1],ee])}E.push({aabb:Y,zoom:oe,x:J,y:V,wrap:C.wrap,fullyVisible:F})}}return M.sort((C,T)=>C.distanceSq-T.distanceSq).map(C=>C.tileID)}resize(e,r){this.width=e,this.height=r,this.pixelsToGLUnits=[2/e,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let r=ps(e.lat,-LM,LM);return new os.default(Ry(e.lng)*this.worldSize,Oy(r)*this.worldSize)}unproject(e){return new al(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){let e=this.pointLocation(this.getCameraPoint()),r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:e,altitude:r+this.elevation}}recalculateZoom(e){let r=this.elevation,i=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,n=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(n,this.tileZoom);if(!(this.elevation-a))return;let o=i+r-a,l=Math.cos(this._pitch)*this.cameraToCenterDistance/o/D3(1,n.lat)/this.tileSize,u=this.scaleZoom(l);this._elevation=a,this._center=n,this.zoom=u}setLocationAtPoint(e,r){let i=this.pointCoordinate(r),n=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new al(a.x-(i.x-n.x),a.y-(i.y-n.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,r){return r?this.coordinatePoint(this.locationCoordinate(e),r.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,r){return this.coordinateLocation(this.pointCoordinate(e,r))}locationCoordinate(e){return al.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,r){if(r){let E=r.pointCoordinate(e);if(E!=null)return E}let i=0,n=[e.x,e.y,0,1],a=[e.x,e.y,1,1];Jl.transformMat4(n,n,this.pixelMatrixInverse),Jl.transformMat4(a,a,this.pixelMatrixInverse);let o=n[3],l=a[3],u=n[0]/o,c=a[0]/l,p=n[1]/o,m=a[1]/l,y=n[2]/o,v=a[2]/l,w=y===v?0:(i-y)/(v-y);return new al(Ka.number(u,c,w)/this.worldSize,Ka.number(p,m,w)/this.worldSize)}coordinatePoint(e,r=0,i=this.pixelMatrix){let n=[e.x*this.worldSize,e.y*this.worldSize,r,1];return Jl.transformMat4(n,n,i),new os.default(n[0]/n[3],n[1]/n[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new Km().extend(this.pointLocation(new os.default(0,e))).extend(this.pointLocation(new os.default(this.width,e))).extend(this.pointLocation(new os.default(this.width,this.height))).extend(this.pointLocation(new os.default(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new Km([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-LM,LM])}calculatePosMatrix(e,r=!1){let i=e.key,n=r?this._alignedPosMatrixCache:this._posMatrixCache;if(n[i])return n[i];let a=e.canonical,o=this.worldSize/this.zoomScale(a.z),l=a.x+Math.pow(2,a.z)*e.wrap,u=Nr.identity(new Float64Array(16));return Nr.translate(u,u,[l*o,a.y*o,0]),Nr.scale(u,u,[o/8192,o/8192,1]),Nr.multiply(u,r?this.alignedProjMatrix:this.projMatrix,u),n[i]=new Float32Array(u),n[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,r){r=ps(+r,this.minZoom,this.maxZoom);let i={center:new Ki(e.lng,e.lat),zoom:r},n=this.lngRange;if(!this._renderWorldCopies&&n===null){let C=179.9999999999;n=[-C,C]}let a=this.tileSize*this.zoomScale(i.zoom),o=0,l=a,u=0,c=a,p=0,m=0,{x:y,y:v}=this.size;if(this.latRange){let C=this.latRange;o=Oy(C[1])*a,l=Oy(C[0])*a,l-o<v&&(p=v/(l-o))}n&&(u=Ay(Ry(n[0])*a,0,a),c=Ay(Ry(n[1])*a,0,a),c<u&&(c+=a),c-u<y&&(m=y/(c-u)));let{x:w,y:E}=this.project.call({worldSize:a},e),M,I,P=Math.max(m||0,p||0);if(P){let C=new os.default(m?(c+u)/2:w,p?(l+o)/2:E);return i.center=this.unproject.call({worldSize:a},C).wrap(),i.zoom+=this.scaleZoom(P),i}if(this.latRange){let C=v/2;E-C<o&&(I=o+C),E+C>l&&(I=l-C)}if(n){let C=(u+c)/2,T=w;this._renderWorldCopies&&(T=Ay(w,C-a/2,C+a/2));let O=y/2;T-O<u&&(M=u+O),T+O>c&&(M=c-O)}if(M!==void 0||I!==void 0){let C=new os.default(M??w,I??E);i.center=this.unproject.call({worldSize:a},C).wrap()}return i}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:r,zoom:i}=this.getConstrained(this.center,this.zoom);this.center=r,this.zoom=i,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this._fov/2,r=this.centerOffset,i=this.point.x,n=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=D3(1,this.center.lat)*this.worldSize;let a=Nr.identity(new Float64Array(16));Nr.scale(a,a,[this.width/2,-this.height/2,1]),Nr.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=Nr.identity(new Float64Array(16)),Nr.scale(a,a,[1,-1,1]),Nr.translate(a,a,[-1,-1,0]),Nr.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;let o=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),l=Math.min(this.elevation,this.minElevationForCurrentTile),u=o-l*this._pixelPerMeter/Math.cos(this._pitch),c=l<0?u:o,p=Math.PI/2+this._pitch,m=this._fov*(.5+r.y/this.height),y=Math.sin(m)*c/Math.sin(ps(Math.PI-p-m,.01,Math.PI-.01)),v=this.getHorizon(),w=2*Math.atan(v/this.cameraToCenterDistance)*(.5+r.y/(v*2)),E=Math.sin(w)*c/Math.sin(ps(Math.PI-p-w,.01,Math.PI-.01)),M=Math.min(y,E),I=(Math.cos(Math.PI/2-this._pitch)*M+c)*1.01,P=this.height/50;a=new Float64Array(16),Nr.perspective(a,this._fov,this.width/this.height,P,I),a[8]=-r.x*2/this.width,a[9]=r.y*2/this.height,Nr.scale(a,a,[1,-1,1]),Nr.translate(a,a,[0,0,-this.cameraToCenterDistance]),Nr.rotateX(a,a,this._pitch),Nr.rotateZ(a,a,this.angle),Nr.translate(a,a,[-i,-n,0]),this.mercatorMatrix=Nr.scale([],a,[this.worldSize,this.worldSize,this.worldSize]),Nr.scale(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=Nr.multiply(new Float64Array(16),this.labelPlaneMatrix,a),Nr.translate(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=Nr.invert([],a),this.pixelMatrix3D=Nr.multiply(new Float64Array(16),this.labelPlaneMatrix,a);let C=this.width%2/2,T=this.height%2/2,O=Math.cos(this.angle),F=Math.sin(this.angle),k=i-Math.round(i)+O*C+F*T,B=n-Math.round(n)+O*T+F*C,U=new Float64Array(a);if(Nr.translate(U,U,[k>.5?k-1:k,B>.5?B-1:B,0]),this.alignedProjMatrix=U,a=Nr.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new os.default(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return Jl.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=this._pitch,r=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new os.default(0,r))}getCameraQueryGeometry(e){let r=this.getCameraPoint();if(e.length===1)return[e[0],r];{let i=r.x,n=r.y,a=r.x,o=r.y;for(let l of e)i=Math.min(i,l.x),n=Math.min(n,l.y),a=Math.max(a,l.x),o=Math.max(o,l.y);return[new os.default(i,n),new os.default(a,n),new os.default(a,o),new os.default(i,o),new os.default(i,n)]}}lngLatToCameraDepth(e,r){let i=this.locationCoordinate(e),n=[i.x*this.worldSize,i.y*this.worldSize,r,1];return Jl.transformMat4(n,n,this.projMatrix),n[2]/n[3]}};s(gle,"Transform");var YBe=gle;N();N();function LP(t,e){let r=!1,i=null,n=null,a,o=s(()=>{i=null,r&&(t.apply(n,a),i=setTimeout(o,e),r=!1)},"later");return(...l)=>(r=!0,n=this,a=l,i||o(),i)}s(LP,"throttle");var vle=class{constructor(e){this._getCurrentHash=s(()=>{let r=window.location.hash.replace("#","");if(this._hashName){let i;return r.split("&").map(n=>n.split("=")).forEach(n=>{n[0]===this._hashName&&(i=n)}),(i&&i[1]||"").split("/")}return r.split("/")},"_getCurrentHash"),this._onHashChange=s(()=>{let r=this._getCurrentHash();if(r.length>=3&&!r.some(i=>isNaN(i))){let i=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:i,pitch:+(r[4]||0)}),!0}return!1},"_onHashChange"),this._updateHashUnthrottled=s(()=>{let r=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,r)}catch{}},"_updateHashUnthrottled"),this._updateHash=LP(this._updateHashUnthrottled,30*1e3/100),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){let r=this._map.getCenter(),i=Math.round(this._map.getZoom()*100)/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,n),o=Math.round(r.lng*a)/a,l=Math.round(r.lat*a)/a,u=this._map.getBearing(),c=this._map.getPitch(),p="";if(e?p+="/".concat(o,"/").concat(l,"/").concat(i):p+="".concat(i,"/").concat(l,"/").concat(o),(u||c)&&(p+="/".concat(Math.round(u*10)/10)),c&&(p+="/".concat(Math.round(c))),this._hashName){let m=this._hashName,y=!1,v=window.location.hash.slice(1).split("&").map(w=>{let E=w.split("=")[0];return E===m?(y=!0,"".concat(E,"=").concat(p)):w}).filter(w=>w);return y||v.push("".concat(m,"=").concat(p)),"#".concat(v.join("&"))}return"#".concat(p)}};s(vle,"Hash");var KBe=vle;N();N();var JBe=kr(Nn(),1),DP={linearity:.3,easing:XT(0,0,.3,1)},QBe=zr({deceleration:2500,maxSpeed:1400},DP),eze=zr({deceleration:20,maxSpeed:1400},DP),tze=zr({deceleration:1e3,maxSpeed:360},DP),rze=zr({deceleration:1e3,maxSpeed:90},DP),_le=class{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:vn.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,r=vn.now(),i=160;for(;e.length>0&&r-e[0].time>i;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let r={zoom:0,bearing:0,pitch:0,pan:new JBe.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:a}of this._inertiaBuffer)r.zoom+=a.zoomDelta||0,r.bearing+=a.bearingDelta||0,r.pitch+=a.pitchDelta||0,a.panDelta&&r.pan._add(a.panDelta),a.around&&(r.around=a.around),a.pinchAround&&(r.pinchAround=a.pinchAround);let i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(r.pan.mag()){let a=c2(r.pan.mag(),i,zr({},QBe,e||{}));n.offset=r.pan.mult(a.amount/r.pan.mag()),n.center=this._map.transform.center,u2(n,a)}if(r.zoom){let a=c2(r.zoom,i,eze);n.zoom=this._map.transform.zoom+a.amount,u2(n,a)}if(r.bearing){let a=c2(r.bearing,i,tze);n.bearing=this._map.transform.bearing+ps(a.amount,-179,179),u2(n,a)}if(r.pitch){let a=c2(r.pitch,i,rze);n.pitch=this._map.transform.pitch+a.amount,u2(n,a)}if(n.zoom||n.bearing){let a=r.pinchAround===void 0?r.around:r.pinchAround;n.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),zr(n,{noMoveStart:!0})}};s(_le,"HandlerInertia");var ize=_le;function u2(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}s(u2,"extendDuration");function c2(t,e,r){let{maxSpeed:i,linearity:n,deceleration:a}=r,o=ps(t*n/(e/1e3),-i,i),l=Math.abs(o)/(a*n);return{easing:r.easing,duration:l*1e3,amount:o*(l/2)}}s(c2,"calculateEasing");N();N();var nze=kr(Nn(),1),xle=class extends pr{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i,n={}){let a=or.mousePos(r.getCanvas(),i),o=r.unproject(a);super(e,zr({point:a,lngLat:o,originalEvent:i},n)),this._defaultPrevented=!1,this.target=r}};s(xle,"MapMouseEvent");var Kc=xle,ble=class extends pr{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){let n=e==="touchend"?i.changedTouches:i.touches,a=or.touchPos(r.getCanvasContainer(),n),o=a.map(c=>r.unproject(c)),l=a.reduce((c,p,m,y)=>c.add(p.div(y.length)),new nze.default(0,0)),u=r.unproject(l);super(e,{points:a,point:l,lngLats:o,lngLat:u,originalEvent:i}),this._defaultPrevented=!1}};s(ble,"MapTouchEvent");var DM=ble,wle=class extends pr{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}};s(wle,"MapWheelEvent");var aze=wle,Ale=class{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new aze(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Kc(e.type,this._map,e))}mouseup(e){this._map.fire(new Kc(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Kc(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Kc(e.type,this._map,e))}mouseover(e){this._map.fire(new Kc(e.type,this._map,e))}mouseout(e){this._map.fire(new Kc(e.type,this._map,e))}touchstart(e){return this._firePreventable(new DM(e.type,this._map,e))}touchmove(e){this._map.fire(new DM(e.type,this._map,e))}touchend(e){this._map.fire(new DM(e.type,this._map,e))}touchcancel(e){this._map.fire(new DM(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};s(Ale,"MapEventHandler");var oze=Ale,Sle=class{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Kc(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Kc("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Kc(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};s(Sle,"BlockableMapEventHandler");var sze=Sle;N();N();var lze=kr(Nn(),1),Mle=class{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(lze.default.convert(e),this._map.terrain)}};s(Mle,"TransformProvider");var TA=Mle,Ele=class{constructor(e,r){this._map=e,this._tr=new TA(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){console.warn("boxZoom will not work. Use SDK interaction events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(or.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;let i=r;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=i,this._box||(this._box=or.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let a=Math.min(n.x,i.x),o=Math.max(n.x,i.x),l=Math.min(n.y,i.y),u=Math.max(n.y,i.y);or.setTransform(this._box,"translate(".concat(a,"px,").concat(l,"px)")),this._box.style.width="".concat(o-a,"px"),this._box.style.height="".concat(u-l,"px")}mouseupWindow(e,r){if(!this._active||e.button!==0)return;let i=this._startPos,n=r;if(this.reset(),or.suppressClick(),i.x===n.x&&i.y===n.y)this._fireEvent("boxzoomcancel",e);else return this._map.fire(new pr("boxzoomend",{originalEvent:e})),{cameraAnimation:s(a=>a.fitScreenCoordinates(i,n,this._tr.bearing,{linear:!0}),"cameraAnimation")}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(or.remove(this._box),this._box=null),or.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new pr(e,{originalEvent:r}))}};s(Ele,"BoxZoomHandler");var uze=Ele;N();N();var cze=kr(Nn(),1);N();function F3(t,e){if(t.length!==e.length)throw new Error("The number of touches and points are not equal - touches ".concat(t.length,", points ").concat(e.length));let r={};for(let i=0;i<t.length;i++)r[t[i].identifier]=e[i];return r}s(F3,"indexTouches");function Cle(t){let e=new cze.default(0,0);for(let r of t)e._add(r);return e.div(t.length)}s(Cle,"getCentroid");var Ile=500,hze=500,QF=30,Tle=class{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=Cle(r),this.touches=F3(i,r)))}touchmove(e,r,i){if(this.aborted||!this.centroid)return;let n=F3(i,r);for(let a in this.touches){let o=this.touches[a],l=n[a];(!l||l.dist(o)>QF)&&(this.aborted=!0)}}touchend(e,r,i){if((!this.centroid||e.timeStamp-this.startTime>hze)&&(this.aborted=!0),i.length===0){let n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}};s(Tle,"SingleTapRecognizer");var pze=Tle,Ple=class{constructor(e){this.singleTap=new pze(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,i){this.singleTap.touchstart(e,r,i)}touchmove(e,r,i){this.singleTap.touchmove(e,r,i)}touchend(e,r,i){let n=this.singleTap.touchend(e,r,i);if(n){let a=e.timeStamp-this.lastTime<Ile,o=!this.lastTap||this.lastTap.dist(n)<QF;if((!a||!o)&&this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}};s(Ple,"TapRecognizer");var gR=Ple,Lle=class{constructor(e){this._tr=new TA(e),this._zoomIn=new gR({numTouches:1,numTaps:2}),this._zoomOut=new gR({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,i){this._zoomIn.touchstart(e,r,i),this._zoomOut.touchstart(e,r,i)}touchmove(e,r,i){this._zoomIn.touchmove(e,r,i),this._zoomOut.touchmove(e,r,i)}touchend(e,r,i){let n=this._zoomIn.touchend(e,r,i),a=this._zoomOut.touchend(e,r,i),o=this._tr;if(n)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s(l=>l.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(n)},{originalEvent:e}),"cameraAnimation")};if(a)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s(l=>l.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:e}),"cameraAnimation")}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Lle,"TapZoomHandler");var dze=Lle;N();N();var Dle=class{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=r.length?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;let i=this._lastPoint;if(!i)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e)){this.reset(e);return}let n=r.length?r[0]:r;if(!(!this._moved&&n.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(i,n)}dragEnd(e){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(e)&&(this._moved&&or.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}};s(Dle,"DragHandler");var PA=Dle;N();var fze=0,mze=2,gze={[fze]:1,[mze]:2};function Rle(t,e){let r=gze[e];return t.buttons===void 0||(t.buttons&r)!==r}s(Rle,"buttonNoLongerPressed");var Ole=class{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let r=or.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!Rle(e,this._eventButton)}isValidEndEvent(e){return or.mouseButton(e)===this._eventButton}};s(Ole,"MouseMoveStateManager");var eB=Ole,kle=class{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){let r=e.targetTouches[0].identifier;this._firstTouch=r}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}};s(kle,"OneFingerTouchMoveStateManager");var Nle=kle,tB=0,Fle=2,rB=s(t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=function(e){e.preventDefault()}},"assignEvents"),yze=s(({enable:t,clickTolerance:e})=>{let r=new eB({checkCorrectEvent:s(i=>or.mouseButton(i)===tB&&!i.ctrlKey,"checkCorrectEvent")});return new PA({clickTolerance:e,move:s((i,n)=>({around:n,panDelta:n.sub(i)}),"move"),activateOnStart:!0,moveStateManager:r,enable:t,assignEvents:rB})},"generateMousePanHandler"),Ble=s(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:r=.8})=>{let i=new eB({checkCorrectEvent:s(n=>or.mouseButton(n)===tB&&n.ctrlKey||or.mouseButton(n)===Fle,"checkCorrectEvent")});return new PA({clickTolerance:e,move:s((n,a)=>({bearingDelta:(a.x-n.x)*r}),"move"),moveStateManager:i,enable:t,assignEvents:rB})},"generateMouseRotationHandler"),zle=s(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:r=-.5})=>{let i=new eB({checkCorrectEvent:s(n=>or.mouseButton(n)===tB&&n.ctrlKey||or.mouseButton(n)===Fle,"checkCorrectEvent")});return new PA({clickTolerance:e,move:s((n,a)=>({pitchDelta:(a.y-n.y)*r}),"move"),moveStateManager:i,enable:t,assignEvents:rB})},"generateMousePitchHandler");N();var UL=kr(Nn(),1),Ule=class{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new UL.default(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,r,i){return this._calculateTransform(e,r,i)}touchmove(e,r,i){if(!(!this._active||i.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,r,i)}touchend(e,r,i){this._calculateTransform(e,r,i),this._active&&i.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,i){i.length>0&&(this._active=!0);let n=F3(i,r),a=new UL.default(0,0),o=new UL.default(0,0),l=0;for(let c in n){let p=n[c],m=this._touches[c];m&&(a._add(p),o._add(p.sub(m)),l++,n[c]=p)}if(this._touches=n,l<this.minTouchs()||!o.mag())return;let u=o.div(l);return this._sum._add(u),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(l),panDelta:u}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Ule,"TouchPanHandler");var vze=Ule;N();var Vle=class{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,i){if(!this._firstTwoTouches)return;e.preventDefault();let[n,a]=this._firstTwoTouches,o=h2(i,r,n),l=h2(i,r,a);if(!o||!l)return;let u=this._aroundCenter?null:o.add(l).div(2);return this._move([o,l],u,e)}touchend(e,r,i){if(!this._firstTwoTouches)return;let[n,a]=this._firstTwoTouches,o=h2(i,r,n),l=h2(i,r,a);o&&l||(this._active&&or.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}};s(Vle,"TwoFingersTouchHandler");var iB=Vle;function h2(t,e,r){for(let i=0;i<t.length;i++)if(t[i].identifier===r)return e[i]}s(h2,"getTouchById");var _ze=.1;function yR(t,e){return Math.log(t/e)/Math.LN2}s(yR,"getZoomDelta");var jle=class extends iB{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){let i=this._distance;if(this._distance=e[0].dist(e[1]),!(!this._active&&Math.abs(yR(this._distance,this._startDistance))<_ze))return this._active=!0,{zoomDelta:yR(this._distance,i),pinchAround:r}}};s(jle,"TwoFingersTouchZoomHandler");var xze=jle,bze=25;function vR(t,e){return t.angleWith(e)*180/Math.PI}s(vR,"getBearingDelta");var $le=class extends iB{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,i){let n=this._vector;if(this._vector=e[0].sub(e[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:vR(this._vector,n),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let r=Math.PI*this._minDiameter,i=bze/r*360,n=vR(e,this._startVector);return Math.abs(n)<i}};s($le,"TwoFingersTouchRotateHandler");var wze=$le;function WE(t){return Math.abs(t.y)>Math.abs(t.x)}s(WE,"isVertical");var Aze=100,Gle=class extends iB{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,i){super.touchstart(e,r,i),this._currentTouchCount=i.length}_start(e){this._lastPoints=e,WE(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,i){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let n=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,a,i.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+a.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,i){if(this._valid!==void 0)return this._valid;let n=2,a=e.mag()>=n,o=r.mag()>=n;if(!a&&!o)return;if(!a||!o)return this._firstMove===void 0&&(this._firstMove=i),i-this._firstMove<Aze?void 0:!1;let l=e.y>0==r.y>0;return WE(e)&&WE(r)&&l}};s(Gle,"TwoFingersTouchPitchHandler");var Sze=Gle;N();var Mze={panStep:100,bearingStep:15,pitchStep:10},Hle=class{constructor(e){this._tr=new TA(e);let r=Mze;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,i=0,n=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:s(l=>{let u=this._tr;l.easeTo({duration:300,easeId:"keyboardHandler",easing:qle,zoom:r?Math.round(u.zoom)+r*(e.shiftKey?2:1):u.zoom,bearing:u.bearing+i*this._bearingStep,pitch:u.pitch+n*this._pitchStep,offset:[-a*this._panStep,-o*this._panStep],center:u.center},{originalEvent:e})},"cameraAnimation")}}enable(){console.warn("maplibre keyboard events are not supported, use SDK keyboard events instead.")}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}};s(Hle,"KeyboardHandler");var Eze=Hle;function qle(t){return t*(2-t)}s(qle,"easeOut");N();var fq=4.000244140625,Cze=1/100,Ize=1/450,Tze=2,Wle=class{constructor(e,r){this._onTimeout=s(i=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)},"_onTimeout"),this._map=e,this._tr=new TA(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=Cze,this._wheelZoomRate=Ize}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){console.log("Enable maplibre scrollZoom events will not work. Use Mappedin SDK interactions events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?e.deltaY*40:e.deltaY,i=vn.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,r!==0&&r%fq===0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r=r/4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let r=or.mousePos(this._map.getCanvas(),e),i=this._tr;r.y>i.transform.height/2-i.transform.getHorizon()?this._around=Ki.convert(this._aroundCenter?i.center:i.unproject(r)):this._around=Ki.convert(i.center),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(this._delta!==0){let l=this._type==="wheel"&&Math.abs(this._delta)>fq?this._wheelZoomRate:this._defaultZoomRate,u=Tze/(1+Math.exp(-Math.abs(this._delta*l)));this._delta<0&&u!==0&&(u=1/u);let c=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(c*u))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let r=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,i=this._startZoom,n=this._easing,a=!1,o;if(this._type==="wheel"&&i&&n){let l=Math.min((vn.now()-this._lastWheelEventTime)/200,1),u=n(l);o=Ka.number(i,r,u),l<1?this._frameId||(this._frameId=!0):a=!0}else o=r,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=J6;if(this._prevEase){let i=this._prevEase,n=(vn.now()-i.start)/i.duration,a=i.easing(n+.01)-i.easing(n),o=.27/Math.sqrt(a*a+1e-4)*.01,l=Math.sqrt(.27*.27-o*o);r=XT(o,l,.25,1)}return this._prevEase={start:vn.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}};s(Wle,"ScrollZoomHandler");var Pze=Wle;N();var Xle=class{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}};s(Xle,"DoubleClickZoomHandler");var Lze=Xle;N();var Zle=class{constructor(e){this._tr=new TA(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:s(i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})},"cameraAnimation")}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Zle,"ClickZoomHandler");var Dze=Zle;N();var Yle=class{constructor(){this._tap=new gR({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,i){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(e,r,i);else{let n=r[0],a=e.timeStamp-this._tapTime<Ile,o=this._tapPoint.dist(n)<QF;!a||!o?this.reset():i.length>0&&(this._swipePoint=n,this._swipeTouch=i[0].identifier)}}touchmove(e,r,i){if(!this._tapTime)this._tap.touchmove(e,r,i);else if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;let n=r[0],a=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(e,r,i){if(this._tapTime)this._swipePoint&&i.length===0&&this.reset();else{let n=this._tap.touchend(e,r,i);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Yle,"TapDragZoomHandler");var Rze=Yle;N();var Kle=class{constructor(e,r,i){this._el=e,this._mousePan=r,this._touchPan=i}enable(e){console.log("Maplibre interaction is not supported. Use Mappedin SDK interaction instead")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}};s(Kle,"DragPanHandler");var Oze=Kle;N();var Jle=class{constructor(e,r,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=r,this._mousePitch=i}enable(){console.warn("dragRotate does not work. Use SDK interaction events instead.")}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}};s(Jle,"DragRotateHandler");var kze=Jle;N();var Qle=class{constructor(e,r,i,n){this._el=e,this._touchZoom=r,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}};s(Qle,"TwoFingersTouchZoomRotateHandler");var Nze=Qle;N();var eue=class{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=or.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let i=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=r,this._container.appendChild(n);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=i,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(or.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(e.touches.length===1)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){!this._enabled||!e||(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}};s(eue,"CooperativeGesturesHandler");var Fze=eue,Bze=kr(Nn(),1),RM=s(t=>t.zoom||t.drag||t.pitch||t.rotate,"isMoving"),tue=class extends pr{};s(tue,"RenderFrameEvent");var zze=tue;function XE(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}s(XE,"hasChange");var rue=class{constructor(e,r){this.handleWindowEvent=s(n=>{this.handleEvent(n,"".concat(n.type,"Window"))},"handleWindowEvent"),this.handleEvent=s((n,a)=>{if(n.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;let o=n.type==="renderFrame"?void 0:n,l={needsRenderFrame:!1},u={},c={},p=n.touches,m=p?this._getMapTouches(p):void 0,y=m?or.touchPos(this._map.getCanvas(),m):or.mousePos(this._map.getCanvas(),n);for(let{handlerName:E,handler:M,allowed:I}of this._handlers){if(!M.isEnabled())continue;let P;this._blockedByActive(c,I,E)?M.reset():M[a||n.type]&&(P=M[a||n.type](n,y,m),this.mergeHandlerResult(l,u,P,E,o),P&&P.needsRenderFrame&&this._triggerRenderFrame()),(P||M.isActive())&&(c[E]=M)}let v={};for(let E in this._previousActiveHandlers)c[E]||(v[E]=o);this._previousActiveHandlers=c,(Object.keys(v).length||XE(l))&&(this._changes.push([l,u,v]),this._triggerRenderFrame()),(Object.keys(c).length||XE(l))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:w}=l;w&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],w(this._map))},"handleEvent"),this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ize(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);let i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(let[n,a,o]of this._listeners);}destroy(){for(let[e,r,i]of this._listeners)or.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(e){let r=this._map,i=r.getCanvasContainer();this._add("mapEvent",new oze(r,e));let n=r.boxZoom=new uze(r,e);this._add("boxZoom",n),e.interactive&&e.boxZoom&&n.enable();let a=r.cooperativeGestures=new Fze(r,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let o=new dze(r),l=new Dze(r);r.doubleClickZoom=new Lze(l,o),this._add("tapZoom",o),this._add("clickZoom",l),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();let u=new Rze;this._add("tapDragZoom",u);let c=r.touchPitch=new Sze(r);this._add("touchPitch",c),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);let p=Ble(e),m=zle(e);r.dragRotate=new kze(e,p,m),this._add("mouseRotate",p,["mousePitch"]),this._add("mousePitch",m,["mouseRotate"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();let y=yze(e),v=new vze(e,r);r.dragPan=new Oze(i,y,v),this._add("mousePan",y),this._add("touchPan",v,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);let w=new wze,E=new xze;r.touchZoomRotate=new Nze(i,E,w,u),this._add("touchRotate",w,["touchPan","touchZoom"]),this._add("touchZoom",E,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);let M=r.scrollZoom=new Pze(r,()=>this._triggerRenderFrame());this._add("scrollZoom",M,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);let I=r.keyboard=new Eze(r);this._add("keyboard",I),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new sze(r))}_add(e,r,i){this._handlers.push({handlerName:e,handler:r,allowed:i}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(let{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!RM(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,i){for(let n in e)if(n!==i&&(!r||r.indexOf(n)<0))return!0;return!1}_getMapTouches(e){let r=[];for(let i of e){let n=i.target;this._el.contains(n)&&r.push(i)}return r}mergeHandlerResult(e,r,i,n,a){if(!i)return;zr(e,i);let o={handlerName:n,originalEvent:i.originalEvent||a};i.zoomDelta!==void 0&&(r.zoom=o),i.panDelta!==void 0&&(r.drag=o),i.pitchDelta!==void 0&&(r.pitch=o),i.bearingDelta!==void 0&&(r.rotate=o)}_applyChanges(){let e={},r={},i={};for(let[n,a,o]of this._changes)n.panDelta&&(e.panDelta=(e.panDelta||new Bze.default(0,0))._add(n.panDelta)),n.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+n.pitchDelta),n.around!==void 0&&(e.around=n.around),n.pinchAround!==void 0&&(e.pinchAround=n.pinchAround),n.noInertia&&(e.noInertia=n.noInertia),zr(r,a),zr(i,o);this._updateMapTransform(e,r,i),this._changes=[]}_updateMapTransform(e,r,i){let n=this._map,a=n._getTransformForUpdate(),o=n.terrain;if(!XE(e)&&!(o&&this._terrainMovement))return this._fireEvents(r,i,!0);let{panDelta:l,zoomDelta:u,bearingDelta:c,pitchDelta:p,around:m,pinchAround:y}=e;y!==void 0&&(m=y),n._stop(!0),m=m||n.transform.centerPoint;let v=a.pointLocation(l?m.sub(l):m);c&&(a.bearing+=c),p&&(a.pitch+=p),u&&(a.zoom+=u),o?!this._terrainMovement&&(r.drag||r.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,a.setLocationAtPoint(v,m),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,a.recalculateZoom(n.terrain)})):r.drag&&this._terrainMovement?a.center=a.pointLocation(a.centerPoint.sub(l)):a.setLocationAtPoint(v,m):a.setLocationAtPoint(v,m),n._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,i,!0)}_fireEvents(e,r,i){let n=RM(this._eventsInProgress),a=RM(e),o={};for(let p in e){let{originalEvent:m}=e[p];this._eventsInProgress[p]||(o["".concat(p,"start")]=m),this._eventsInProgress[p]=e[p]}!n&&a&&this._fireEvent("movestart",a.originalEvent);for(let p in o)this._fireEvent(p,o[p]);a&&this._fireEvent("move",a.originalEvent);for(let p in e){let{originalEvent:m}=e[p];this._fireEvent(p,m)}let l={},u;for(let p in this._eventsInProgress){let{handlerName:m,originalEvent:y}=this._eventsInProgress[p];this._handlersById[m].isActive()||(delete this._eventsInProgress[p],u=r[m]||y,l["".concat(p,"end")]=u)}for(let p in l)this._fireEvent(p,l[p]);let c=RM(this._eventsInProgress);if(i&&(n||a)&&!c){this._updatingCamera=!0;let p=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),m=s(y=>y!==0&&-this._bearingSnap<y&&y<this._bearingSnap,"shouldSnapToNorth");p&&(p.essential||!vn.prefersReducedMotion)?(m(p.bearing||this._map.getBearing())&&(p.bearing=0),p.freezeElevation=!0,this._map.easeTo(p,{originalEvent:u})):(this._map.fire(new pr("moveend",{originalEvent:u})),m(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new pr(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new zze("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}};s(rue,"HandlerManager");var Uze=rue;N();var Sd=kr(Nn(),1),iue=class extends Fl{constructor(e,r){super(),this._renderFrameCallback=s(()=>{let i=Math.min((vn.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},"_renderFrameCallback"),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new Ki(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}panBy(e,r,i){return e=Sd.default.convert(e).mult(-1),this.panTo(this.transform.center,zr({offset:e},r),i)}panTo(e,r,i){return this.easeTo(zr({center:e},r),i)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,i){return this.easeTo(zr({zoom:e},r),i)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,i){return this.easeTo(zr({bearing:e},r),i)}resetNorth(e,r){return this.rotateTo(0,zr({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(zr({bearing:0,pitch:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}cameraForBounds(e,r){e=Km.convert(e);let i=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,r)}_cameraForBoxAndBearing(e,r,i,n){let a={top:0,bottom:0,right:0,left:0};if(n=zr({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n),typeof n.padding=="number"){let J=n.padding;n.padding={top:J,bottom:J,right:J,left:J}}n.padding=zr(a,n.padding);let o=this.transform,l=o.padding,u=new Km(e,r),c=o.project(u.getNorthWest()),p=o.project(u.getNorthEast()),m=o.project(u.getSouthEast()),y=o.project(u.getSouthWest()),v=Q6(-i),w=c.rotate(v),E=p.rotate(v),M=m.rotate(v),I=y.rotate(v),P=new Sd.default(Math.max(w.x,E.x,I.x,M.x),Math.max(w.y,E.y,I.y,M.y)),C=new Sd.default(Math.min(w.x,E.x,I.x,M.x),Math.min(w.y,E.y,I.y,M.y)),T=P.sub(C),O=(o.width-(l.left+l.right+n.padding.left+n.padding.right))/T.x,F=(o.height-(l.top+l.bottom+n.padding.top+n.padding.bottom))/T.y;if(F<0||O<0){kl("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}let k=Math.min(o.scaleZoom(o.scale*Math.min(O,F)),n.maxZoom),B=Sd.default.convert(n.offset),U=(n.padding.left-n.padding.right)/2,z=(n.padding.top-n.padding.bottom)/2,q=new Sd.default(U,z).rotate(Q6(i)),W=B.add(q).mult(o.scale/o.zoomScale(k));return{center:o.unproject(c.add(m).div(2).sub(W)),zoom:k,bearing:i}}fitBounds(e,r,i){return this._fitInternal(this.cameraForBounds(e,r),r,i)}fitScreenCoordinates(e,r,i,n,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(Sd.default.convert(e)),this.transform.pointLocation(Sd.default.convert(r)),i,n),n,a)}_fitInternal(e,r,i){return e?(r=zr(e,r),delete r.padding,r.linear?this.easeTo(r,i):this.flyTo(r,i)):this}jumpTo(e,r){this.stop();let i=this._getTransformForUpdate(),n=!1,a=!1,o=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(n=!0,i.zoom=+e.zoom),e.center!==void 0&&(i.center=Ki.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(a=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(o=!0,i.pitch=+e.pitch),e.padding!=null&&!i.isPaddingEqual(e.padding)&&(i.padding=e.padding),this._applyUpdatedTransform(i),this.fire(new pr("movestart",r)).fire(new pr("move",r)),n&&this.fire(new pr("zoomstart",r)).fire(new pr("zoom",r)).fire(new pr("zoomend",r)),a&&this.fire(new pr("rotatestart",r)).fire(new pr("rotate",r)).fire(new pr("rotateend",r)),o&&this.fire(new pr("pitchstart",r)).fire(new pr("pitch",r)).fire(new pr("pitchend",r)),this.fire(new pr("moveend",r))}calculateCameraOptionsFromTo(e,r,i,n=0){let a=al.fromLngLat(e,r),o=al.fromLngLat(i,n),l=o.x-a.x,u=o.y-a.y,c=o.z-a.z,p=Math.hypot(l,u,c);if(p===0)throw new Error("Can't calculate camera options with same From and To");let m=Math.hypot(l,u),y=this.transform.scaleZoom(this.transform.cameraToCenterDistance/p/this.transform.tileSize),v=Math.atan2(l,-u)*180/Math.PI,w=Math.acos(m/p)*180/Math.PI;return w=c<0?90-w:90+w,{center:o.toLngLat(),zoom:y,pitch:w,bearing:v}}easeTo(e,r){var i;this._stop(!1,e.easeId),e=zr({offset:[0,0],duration:500,easing:J6},e),(e.animate===!1||!e.essential&&vn.prefersReducedMotion)&&(e.duration=0);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="bearing"in e?this._normalizeBearing(e.bearing,o):o,p="pitch"in e?+e.pitch:l,m="padding"in e?e.padding:n.padding,y=Sd.default.convert(e.offset),v=n.centerPoint.add(y),w=n.pointLocation(v),{center:E,zoom:M}=n.getConstrained(Ki.convert(e.center||w),(i=e.zoom)!=null?i:a);this._normalizeCenter(E);let I=n.project(w),P=n.project(E).sub(I),C=n.zoomScale(M-a),T,O;e.around&&(T=Ki.convert(e.around),O=n.locationPoint(T));let F={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||M!==a,this._rotating=this._rotating||o!==c,this._pitching=this._pitching||p!==l,this._padding=!n.isPaddingEqual(m),this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,F),this.terrain&&this._prepareElevation(E),this._ease(k=>{if(this._zooming&&(n.zoom=Ka.number(a,M,k)),this._rotating&&(n.bearing=Ka.number(o,c,k)),this._pitching&&(n.pitch=Ka.number(l,p,k)),this._padding&&(n.interpolatePadding(u,m,k),v=n.centerPoint.add(y)),this.terrain&&!e.freezeElevation&&this._updateElevation(k),T)n.setLocationAtPoint(T,O);else{let B=n.zoomScale(n.zoom-a),U=M>a?Math.min(2,C):Math.max(.5,C),z=Math.pow(U,1-k),q=n.unproject(I.add(P.mult(k*z)).mult(B));n.setLocationAtPoint(n.renderWorldCopies?q.wrap():q,v)}this._applyUpdatedTransform(n),this._fireMoveEvents(r)},k=>{this.terrain&&this._finalizeElevation(),this._afterEase(r,k)},e),this}_prepareEase(e,r,i={}){this._moving=!0,!r&&!i.moving&&this.fire(new pr("movestart",e)),this._zooming&&!i.zooming&&this.fire(new pr("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new pr("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new pr("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){let i=this._elevationTarget-this._elevationStart,n=(r-(i*e+this._elevationStart))/(1-e);this._elevationStart+=e*(i-n),this._elevationTarget=r}this.transform.elevation=Ka.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let r=e.clone(),{center:i,zoom:n,pitch:a,bearing:o,elevation:l}=this.transformCameraUpdate(r);i&&(r.center=i),n!==void 0&&(r.zoom=n),a!==void 0&&(r.pitch=a),o!==void 0&&(r.bearing=o),l!==void 0&&(r.elevation=l),this.transform.apply(r)}_fireMoveEvents(e){this.fire(new pr("move",e)),this._zooming&&this.fire(new pr("zoom",e)),this._rotating&&this.fire(new pr("rotate",e)),this._pitching&&this.fire(new pr("pitch",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;let i=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new pr("zoomend",e)),n&&this.fire(new pr("rotateend",e)),a&&this.fire(new pr("pitchend",e)),this.fire(new pr("moveend",e))}flyTo(e,r){var i;if(!e.essential&&vn.prefersReducedMotion){let he=fA(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(he,r)}this.stop(),e=zr({offset:[0,0],speed:1.2,curve:1.42,easing:J6},e);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="bearing"in e?this._normalizeBearing(e.bearing,o):o,p="pitch"in e?+e.pitch:l,m="padding"in e?e.padding:n.padding,y=Sd.default.convert(e.offset),v=n.centerPoint.add(y),w=n.pointLocation(v),{center:E,zoom:M}=n.getConstrained(Ki.convert(e.center||w),(i=e.zoom)!=null?i:a);this._normalizeCenter(E);let I=n.zoomScale(M-a),P=n.project(w),C=n.project(E).sub(P),T=e.curve,O=Math.max(n.width,n.height),F=O/I,k=C.mag();if("minZoom"in e){let he=ps(Math.min(e.minZoom,a,M),n.minZoom,n.maxZoom),Q=O/n.zoomScale(he-a);T=Math.sqrt(Q/k*2)}let B=T*T;function U(he){let Q=(F*F-O*O+(he?-1:1)*B*B*k*k)/(2*(he?F:O)*B*k);return Math.log(Math.sqrt(Q*Q+1)-Q)}s(U,"zoomOutFactor");function z(he){return(Math.exp(he)-Math.exp(-he))/2}s(z,"sinh");function q(he){return(Math.exp(he)+Math.exp(-he))/2}s(q,"cosh");function W(he){return z(he)/q(he)}s(W,"tanh");let J=U(!1),V=s(function(he){return q(J)/q(J+T*he)},"w"),oe=s(function(he){return O*((q(J)*W(J+T*he)-z(J))/B)/k},"u"),Y=(U(!0)-J)/T;if(Math.abs(k)<1e-6||!isFinite(Y)){if(Math.abs(O-F)<1e-6)return this.easeTo(e,r);let he=F<O?-1:1;Y=Math.abs(Math.log(F/O))/T,oe=s(function(){return 0},"u"),V=s(function(Q){return Math.exp(he*T*Q)},"w")}if("duration"in e)e.duration=+e.duration;else{let he="screenSpeed"in e?+e.screenSpeed/T:+e.speed;e.duration=1e3*Y/he}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==c,this._pitching=p!==l,this._padding=!n.isPaddingEqual(m),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(E),this._ease(he=>{let Q=he*Y,ae=1/V(Q);n.zoom=he===1?M:a+n.scaleZoom(ae),this._rotating&&(n.bearing=Ka.number(o,c,he)),this._pitching&&(n.pitch=Ka.number(l,p,he)),this._padding&&(n.interpolatePadding(u,m,he),v=n.centerPoint.add(y)),this.terrain&&!e.freezeElevation&&this._updateElevation(he);let ee=he===1?E:n.unproject(P.add(C.mult(oe(Q))).mult(ae));n.setLocationAtPoint(n.renderWorldCopies?ee.wrap():ee,v),this._applyUpdatedTransform(n),this._fireMoveEvents(r)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,r)}if(!e){let i=this.handlers;i&&i.stop(!1)}return this}_ease(e,r,i){i.animate===!1||i.duration===0?(e(1),r()):(this._easeStart=vn.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=Ay(e,-180,180);let i=Math.abs(e-r);return Math.abs(e-360-r)<i&&(e-=360),Math.abs(e+360-r)<i&&(e+=360),e}_normalizeCenter(e){let r=this.transform;if(!r.renderWorldCopies||r.lngRange)return;let i=e.lng-r.center.lng;e.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(Ki.convert(e),this.transform.tileZoom)-this.transform.elevation:null}};s(iue,"Camera");var Vze=iue,rm=kr(Nn(),1);N();var nue={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'},aue=class{constructor(e=nue){this._toggleAttribution=s(()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},"_toggleAttribution"),this._updateData=s(r=>{r&&(r.sourceDataType==="metadata"||r.sourceDataType==="visibility"||r.dataType==="style"||r.type==="terrain")&&this._updateAttributions()},"_updateData"),this._updateCompact=s(()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):!this._container.classList.contains("maplibregl-compact")&&!this._container.classList.contains("maplibregl-attrib-empty")&&(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},"_updateCompact"),this._updateCompactMinimize=s(()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},"_updateCompactMinimize"),this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=or.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=or.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=or.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){or.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){let i=this._map._getUIString("AttributionControl.".concat(r));e.title=i,e.setAttribute("aria-label",i)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(n=>typeof n!="string"?"":n)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let n=this._map.style.stylesheet;this.styleOwner=n.owner,this.styleId=n.id}let r=this._map.style.sourceCaches;for(let n in r){let a=r[n];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e=e.filter(n=>String(n).trim()),e.sort((n,a)=>n.length-a.length),e=e.filter((n,a)=>{for(let o=a+1;o<e.length;o++)if(e[o].indexOf(n)>=0)return!1;return!0});let i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}};s(aue,"AttributionControl");var jze=aue;N();var oue=class{constructor(e={}){this._updateCompact=s(()=>{let r=this._container.children;if(r.length){let i=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&i.classList.add("maplibregl-compact"):i.classList.remove("maplibregl-compact")}},"_updateCompact"),this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=or.create("div","maplibregl-ctrl");let r=or.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){or.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}};s(oue,"LogoControl");var $ze=oue;N();var sue=class{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){let r=this._currentlyRunning,i=r?this._queue.concat(r):this._queue;for(let n of i)if(n.id===e){n.cancelled=!0;return}}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let r=this._currentlyRunning=this._queue;this._queue=[];for(let i of r)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}};s(sue,"TaskQueue");var Gze=sue;N();var _R=(t=>(t.create="create",t.load="load",t.fullLoad="fullLoad",t))(_R||{}),OM=null,Ib=[],Hze=60,VL=1e3/Hze,jL="loadTime",$L="fullLoadTime",Tb={mark(t){performance.mark(t)},frame(t){let e=t;if(OM!=null){let r=e-OM;Ib.push(r)}OM=e},clearMetrics(){OM=null,Ib=[],performance.clearMeasures(jL),performance.clearMeasures($L);for(let t in _R)performance.clearMarks(_R[t])},getPerformanceMetrics(){performance.measure(jL,"create","load"),performance.measure($L,"create","fullLoad");let t=performance.getEntriesByName(jL)[0].duration,e=performance.getEntriesByName($L)[0].duration,r=Ib.length,i=1/(Ib.reduce((o,l)=>o+l,0)/r/1e3),n=Ib.filter(o=>o>VL).reduce((o,l)=>o+(l-VL)/VL,0),a=n/(r+n)*100;return{loadTime:t,fullLoadTime:e,fps:i,percentDroppedFrames:a,totalFrames:r}}};N();N();var qze=ao([{name:"a_pos3d",type:"Int16",components:3}]);N();var lue=class extends Fl{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];let i={};for(let n of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r}))i[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),Nr.ortho(n.posMatrix,0,8192,0,8192,0,1),this._tiles[n.key]=new Qae(n,this.tileSize));for(let n in this._tiles)i[n]||delete this._tiles[n]}freeRtt(e){for(let r in this._tiles){let i=this._tiles[r];(!e||i.tileID.equals(e)||i.tileID.isChildOf(e)||e.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let r={};for(let i of this._renderableTilesKeys){let n=this._tiles[i].tileID;if(n.canonical.equals(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16),Nr.ortho(a.posMatrix,0,8192,0,8192,0,1),r[i]=a}else if(n.canonical.isChildOf(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=n.canonical.z-e.canonical.z,l=n.canonical.x-(n.canonical.x>>o<<o),u=n.canonical.y-(n.canonical.y>>o<<o),c=8192>>o;Nr.ortho(a.posMatrix,0,c,0,c,0,1),Nr.translate(a.posMatrix,a.posMatrix,[-l*c,-u*c,0]),r[i]=a}else if(e.canonical.isChildOf(n.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=e.canonical.z-n.canonical.z,l=e.canonical.x-(e.canonical.x>>o<<o),u=e.canonical.y-(e.canonical.y>>o<<o),c=8192>>o;Nr.ortho(a.posMatrix,0,8192,0,8192,0,1),Nr.translate(a.posMatrix,a.posMatrix,[l*c,u*c,0]),Nr.scale(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),r[i]=a}}return r}getSourceTile(e,r){let i=this.sourceCache._source,n=e.overscaledZ-this.deltaZoom;if(n>i.maxzoom&&(n=i.maxzoom),n<i.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if(!(a&&a.dem)&&r)for(;n>=i.minzoom&&!(a&&a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(n--).key);return a}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(r=>r.timeAdded>=e)}};s(lue,"TerrainSourceCache");var Wze=lue,uue=class{constructor(e,r,i){this.painter=e,this.sourceCache=new Wze(r),this.options=i,this.exaggeration=typeof i.exaggeration=="number"?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,i,n=8192){var a;if(!(r>=0&&r<n&&i>=0&&i<n))return 0;let o=this.getTerrainData(e),l=(a=o.tile)==null?void 0:a.dem;if(!l)return 0;let u=yF.transformMat4([],[r/n*8192,i/n*8192],o.u_terrain_matrix),c=[u[0]*l.dim,u[1]*l.dim],p=Math.floor(c[0]),m=Math.floor(c[1]),y=c[0]-p,v=c[1]-m;return l.get(p,m)*(1-y)*(1-v)+l.get(p+1,m)*y*(1-v)+l.get(p,m+1)*(1-y)*v+l.get(p+1,m+1)*y*v}getElevationForLngLatZoom(e,r){let{tileID:i,mercatorX:n,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(i,n%8192,a%8192,8192)}getElevation(e,r,i,n=8192){return this.getDEMElevation(e,r,i,n)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let n=this.painter.context,a=new go({width:1,height:1},new Uint8Array(1*4));this._emptyDepthTexture=new Es(n,a,n.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Es(n,new go({width:1,height:1}),n.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Nr.identity([])}let r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){let n=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new Es(n,r.dem.getPixels(),n.gl.RGBA,{premultiply:!1}),r.demTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}let i=r&&r+r.tileID.key+e.key;if(i&&!this._demMatrixCache[i]){let n=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?a=e.canonical.z-n:kl("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let o=e.canonical.x-(e.canonical.x>>a<<a),l=e.canonical.y-(e.canonical.y>>a<<a),u=Nr.fromScaling(new Float64Array(16),[1/(8192<<a),1/(8192<<a),0]);Nr.translate(u,u,[o*8192,l*8192,0]),this._demMatrixCache[e.key]={matrix:u,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){let r=this.painter,i=r.width/devicePixelRatio,n=r.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==i||this._fbo.height!==n)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Es(r.context,{width:i,height:n,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Es(r.context,{width:i,height:n,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(i,n,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,i,n))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let a=0,o=0;a<this._coordsTextureSize;a++)for(let l=0;l<this._coordsTextureSize;l++,o+=4)r[o+0]=l&255,r[o+1]=a&255,r[o+2]=l>>8<<4|a>>8,r[o+3]=0;let i=new go({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),n=new Es(e,i,e.gl.RGBA,{premultiply:!1});return n.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let r=new Uint8Array(4),i=this.painter.context,n=i.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),l=Math.round(this.painter.height/devicePixelRatio);i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(a,l-o-1,1,1,n.RGBA,n.UNSIGNED_BYTE,r),i.bindFramebuffer.set(null);let u=r[0]+(r[2]>>4<<8),c=r[1]+((r[2]&15)<<8),p=this.coordsIndex[255-r[3]],m=p&&this.sourceCache.getTileByID(p);if(!m)return null;let y=this._coordsTextureSize,v=(1<<m.tileID.canonical.z)*y;return new al((m.tileID.canonical.x*y+u)/v+m.tileID.wrap,(m.tileID.canonical.y*y+c)/v,this.getElevation(m.tileID,u,c,y))}depthAtPoint(e){let r=new Uint8Array(4),i=this.painter.context,n=i.gl;return i.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,r),i.bindFramebuffer.set(null),(r[0]/(256*256*256)+r[1]/(256*256)+r[2]/256+r[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,r=new Xke,i=new cv,n=this.meshSize,a=8192/n,o=n*n;for(let m=0;m<=n;m++)for(let y=0;y<=n;y++)r.emplaceBack(y*a,m*a,0);for(let m=0;m<o;m+=n+1)for(let y=0;y<n;y++)i.emplaceBack(y+m,n+y+m+1,n+y+m+2),i.emplaceBack(y+m,n+y+m+2,y+m+1);let l=r.length,u=l+(n+1)*2;for(let m of[0,1])for(let y=0;y<=n;y++)for(let v of[0,1])r.emplaceBack(y*a,m*8192,v);for(let m=0;m<n*2;m+=2)i.emplaceBack(u+m,u+m+1,u+m+3),i.emplaceBack(u+m,u+m+3,u+m+2),i.emplaceBack(l+m,l+m+3,l+m+1),i.emplaceBack(l+m,l+m+2,l+m+3);let c=r.length,p=c+(n+1)*2;for(let m of[0,1])for(let y=0;y<=n;y++)for(let v of[0,1])r.emplaceBack(m*8192,y*a,v);for(let m=0;m<n*2;m+=2)i.emplaceBack(c+m,c+m+1,c+m+3),i.emplaceBack(c+m,c+m+3,c+m+2),i.emplaceBack(p+m,p+m+3,p+m+1),i.emplaceBack(p+m,p+m+2,p+m+3);return this._mesh={indexBuffer:e.createIndexBuffer(i),vertexBuffer:e.createVertexBuffer(r,qze.members),segments:To.simpleSegment(0,0,r.length,i.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*zF/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,r){var i;let{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(i=this.getMinMaxElevation(n).minElevation)!=null?i:0}getMinMaxElevation(e){let r=this.getTerrainData(e).tile,i={minElevation:null,maxElevation:null};return r&&r.dem&&(i.minElevation=r.dem.min*this.exaggeration,i.maxElevation=r.dem.max*this.exaggeration),i}_getOverscaledTileIDFromLngLatZoom(e,r){let i=al.fromLngLat(e.wrap()),n=(1<<r)*8192,a=i.x*n,o=i.y*n,l=Math.floor(a/8192),u=Math.floor(o/8192);return{tileID:new hc(r,0,r,l,u),mercatorX:a,mercatorY:o}}};s(uue,"Terrain");var Xze=uue;N();N();var cue=class{constructor(e,r,i){this._context=e,this._size=r,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new Es(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(i.texture),{id:e,fbo:r,texture:i,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return this._objects.length<this._size?!1:this._objects.some(e=>!e.inUse)===!1}};s(cue,"RenderPool");var Zze=cue,n0={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0},hue=class{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new Zze(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(i=>!e._layers[i].isHidden(r)),this._coordsDescendingInv={};for(let i in e.sourceCaches){this._coordsDescendingInv[i]={};let n=e.sourceCaches[i].getVisibleCoordinates();for(let a of n){let o=this.terrain.sourceCache.getTerrainCoords(a);for(let l in o)this._coordsDescendingInv[i][l]||(this._coordsDescendingInv[i][l]=[]),this._coordsDescendingInv[i][l].push(o[l])}}this._coordsDescendingInvStr={};for(let i of e._order){let n=e._layers[i],a=n.source;if(n0[n.type]&&!this._coordsDescendingInvStr[a]){this._coordsDescendingInvStr[a]={};for(let o in this._coordsDescendingInv[a])this._coordsDescendingInvStr[a][o]=this._coordsDescendingInv[a][o].map(l=>l.key).sort().join()}}for(let i of this._renderableTiles)for(let n in this._coordsDescendingInvStr){let a=this._coordsDescendingInvStr[n][i.tileID.key];a&&a!==i.rttCoords[n]&&(i.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let r=e.type,i=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(n0[r]&&((!this._prevType||!n0[this._prevType])&&this._stacks.push([]),this._prevType=r,this._stacks[this._stacks.length-1].push(e.id),!n))return!0;if(n0[this._prevType]||n0[r]&&n){this._prevType=r;let a=this._stacks.length-1,o=this._stacks[a]||[];for(let l of this._renderableTiles){if(this.pool.isFull()&&(mR(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(l),l.rtt[a]){let c=this.pool.getObjectForId(l.rtt[a].id);if(c.stamp===l.rtt[a].stamp){this.pool.useObject(c);continue}}let u=this.pool.getOrCreateFreeObject();this.pool.useObject(u),this.pool.stampObject(u),l.rtt[a]={id:u.id,stamp:u.stamp},i.context.bindFramebuffer.set(u.fbo.framebuffer),i.context.clear({color:Li.transparent,stencil:0}),i.currentStencilSource=void 0;for(let c=0;c<o.length;c++){let p=i.style._layers[o[c]],m=p.source?this._coordsDescendingInv[p.source][l.tileID.key]:[l.tileID];i.context.viewport.set([0,0,u.fbo.width,u.fbo.height]),i._renderTileClippingMasks(p,m),i.renderLayer(i,i.style.sourceCaches[p.source],p,m),p.source&&(l.rttCoords[p.source]=this._coordsDescendingInvStr[p.source][l.tileID.key])}}return mR(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),n0[r]}return!1}};s(hue,"RenderToTexture");var Yze=hue;N();var Kze={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Jze=nZ.version,ZE=-2,pue=22,pm=0,due=80,kM=85,Qze={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:ZE,maxZoom:pue,minPitch:pm,maxPitch:due,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:nue,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:wc.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},fue=class extends Vze{constructor(e){if(Tb.mark("create"),e=zr({},Qze,e),e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<pm)throw new Error("minPitch must be greater than or equal to ".concat(pm));if(e.maxPitch!=null&&e.maxPitch>kM)throw new Error("maxPitch must be less than or equal to ".concat(kM));let r=new YBe(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(super(r,{bearingSnap:e.bearingSnap}),this._contextLost=s(n=>{n.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new pr("webglcontextlost",{originalEvent:n}))},"_contextLost"),this._contextRestored=s(n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new pr("webglcontextrestored",{originalEvent:n}))},"_contextRestored"),this._onMapScroll=s(n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},"_onMapScroll"),this._onWindowOnline=s(()=>{this._update()},"_onWindowOnline"),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new Gze,this._controls=[],this._mapId=E9(),this._locale=zr({},Kze,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=Hp.addThrottleControl(()=>this.isMoving()),this._requestManager=new wOe(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error("Container '".concat(e.container,"' not found."))}else if(e.container instanceof HTMLElement)this._container=e.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1,a=LP(o=>{this._trackResize&&!this._removed&&this.resize(o)._update()},50);this._resizeObserver=new ResizeObserver(o=>{if(!n){n=!0;return}a(o)}),this._resizeObserver.observe(this._container)}this.handlers=new Uze(this,e);let i=typeof e.hash=="string"&&e.hash||void 0;this._hash=e.hash&&new KBe(i).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,zr({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new jze(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new $ze,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new pr("".concat(n.dataType,"data"),n))}),this.on("dataloading",n=>{this.fire(new pr("".concat(n.dataType,"dataloading"),n))}),this.on("dataabort",n=>{this.fire(new pr("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(e,r){if(r===void 0&&(e.getDefaultPosition?r=e.getDefaultPosition():r="top-right"),!e||!e.onAdd)return this.fire(new fi(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let i=e.onAdd(this);this._controls.push(e);let n=this._controlPositions[r];return r.indexOf("bottom")!==-1?n.insertBefore(i,n.firstChild):n.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new fi(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,r,i,n){return n==null&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,r,i,n)}resize(e){var r;let i=this._containerDimensions(),n=i[0],a=i[1],o=this._getClampedPixelRatio(n,a);if(this._resizeCanvas(n,a,o),this.painter.resize(n,a,o),this.painter.overLimit()){let u=this.painter.context.gl;this._maxCanvasSize=[u.drawingBufferWidth,u.drawingBufferHeight];let c=this._getClampedPixelRatio(n,a);this._resizeCanvas(n,a,c),this.painter.resize(n,a,c)}this.transform.resize(n,a),(r=this._requestedCameraState)==null||r.resize(n,a);let l=!this._moving;return l&&(this.stop(),this.fire(new pr("movestart",e)).fire(new pr("move",e))),this.fire(new pr("resize",e)),l&&this.fire(new pr("moveend",e)),this}_getClampedPixelRatio(e,r){let{0:i,1:n}=this._maxCanvasSize,a=this.getPixelRatio(),o=e*a,l=r*a,u=o>i?i/o:1,c=l>n?n/l:1;return Math.min(u,c)*a}getPixelRatio(){var e;return(e=this._overridePixelRatio)!=null?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Km.convert(e)),this._update()}setMinZoom(e){if(e=e??ZE,e>=ZE&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between ".concat(ZE," and the current maxZoom, inclusive"))}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if(e=e??pue,e>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if(e=e??pm,e<pm)throw new Error("minPitch must be greater than or equal to ".concat(pm));if(e>=pm&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between ".concat(pm," and the current maxPitch, inclusive"))}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(e=e??due,e>kM)throw new Error("maxPitch must be less than or equal to ".concat(kM));if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(Ki.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(rm.default.convert(e),this.terrain)}isMoving(){var e;return this._moving||((e=this.handlers)==null?void 0:e.isMoving())}isZooming(){var e;return this._zooming||((e=this.handlers)==null?void 0:e.isZooming())}isRotating(){var e;return this._rotating||((e=this.handlers)==null?void 0:e.isRotating())}_createDelegatedListener(e,r,i){if(e==="mouseenter"||e==="mouseover"){let n=!1;return{layer:r,listener:i,delegates:{mousemove:s(a=>{let o=this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[];o.length?n||(n=!0,i.call(this,new Kc(e,this,a.originalEvent,{features:o}))):n=!1},"mousemove"),mouseout:s(()=>{n=!1},"mouseout")}}}else if(e==="mouseleave"||e==="mouseout"){let n=!1;return{layer:r,listener:i,delegates:{mousemove:s(a=>{(this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[]).length?n=!0:n&&(n=!1,i.call(this,new Kc(e,this,a.originalEvent)))},"mousemove"),mouseout:s(a=>{n&&(n=!1,i.call(this,new Kc(e,this,a.originalEvent)))},"mouseout")}}}else{let n=s(a=>{let o=this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[];o.length&&(a.features=o,i.call(this,a),delete a.features)},"delegate");return{layer:r,listener:i,delegates:{[e]:n}}}}on(e,r,i){if(i===void 0)return super.on(e,r);let n=this._createDelegatedListener(e,r,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(let a in n.delegates)this.on(a,n.delegates[a]);return this}once(e,r,i){if(i===void 0)return super.once(e,r);let n=this._createDelegatedListener(e,r,i);for(let a in n.delegates)this.once(a,n.delegates[a]);return this}off(e,r,i){if(i===void 0)return super.off(e,r);let n=s(a=>{let o=a[e];for(let l=0;l<o.length;l++){let u=o[l];if(u.layer===r&&u.listener===i){for(let c in u.delegates)this.off(c,u.delegates[c]);return o.splice(l,1),this}}},"removeDelegatedListener");return this._delegatedListeners&&this._delegatedListeners[e]&&n(this._delegatedListeners),this}queryRenderedFeatures(e,r){if(!this.style)return[];let i,n=e instanceof rm.default||Array.isArray(e),a=n?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(n?{}:e)||{},a instanceof rm.default||typeof a[0]=="number")i=[rm.default.convert(a)];else{let o=rm.default.convert(a[0]),l=rm.default.convert(a[1]);i=[o,new rm.default(l.x,o.y),l,new rm.default(o.x,l.y),o]}return this.style.queryRenderedFeatures(i,r,this.transform)}querySourceFeatures(e,r){return this.style.querySourceFeatures(e,r)}setStyle(e,r){return r=zr({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r),r.diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let r=this._locale[e];if(r==null)throw new Error("Missing UI string '".concat(e,"'"));return r}_updateStyle(e,r){if(r.transformStyle&&this.style&&!this.style._loaded){this.style.once("style.load",()=>this._updateStyle(e,r));return}let i=this.style&&r.transformStyle?this.style.serialize():void 0;if(this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e)this.style=new cq(this,r||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e,r,i):this.style.loadJSON(e,r,i),this}_lazyInitEmptyStyle(){this.style||(this.style=new cq(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if(typeof e=="string"){let i=e,n=this._requestManager.transformRequest(i,"Style");KT(n,new AbortController).then(a=>{this._updateDiff(a.data,r)}).catch(a=>{a&&this.fire(new fi(a))})}else typeof e=="object"&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(i){kl("Unable to perform style diff: ".concat(i.message||i.error||i,".  Rebuilding the style from scratch.")),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():kl("There is no style added to the map.")}addSource(e,r){return this._lazyInitEmptyStyle(),this.style.addSource(e,r),this._update(!0)}isSourceLoaded(e){let r=this.style&&this.style.sourceCaches[e];if(r===void 0){this.fire(new fi(new Error("There is no source with ID '".concat(e,"'"))));return}return r.loaded()}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),!e)this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;else{let r=this.style.sourceCaches[e.source];if(!r)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(e.source));this.terrain===null&&r.reload();for(let i in this.style._layers){let n=this.style._layers[i];n.type==="hillshade"&&n.source===e.source&&kl("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Xze(this.painter,r,e),this.painter.renderToTexture=new Yze(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId===e.source&&!this._elevationFreeze&&(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}return this.fire(new pr("terrain",{terrain:e})),this}getTerrain(){var e,r;return(r=(e=this.terrain)==null?void 0:e.options)!=null?r:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let r in e){let i=e[r]._tiles;for(let n in i){let a=i[n];if(!(a.state==="loaded"||a.state==="errored"))return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,r,i={}){let{pixelRatio:n=1,sdf:a=!1,stretchX:o,stretchY:l,content:u}=i;this._lazyInitEmptyStyle();let c=0;if(r instanceof HTMLImageElement||Gp(r)){let{width:p,height:m,data:y}=vn.getImageData(r);this.style.addImage(e,{data:new go({width:p,height:m},y),pixelRatio:n,stretchX:o,stretchY:l,content:u,sdf:a,version:c})}else{if(r.width===void 0||r.height===void 0)return this.fire(new fi(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:p,height:m,data:y}=r,v=r;return this.style.addImage(e,{data:new go({width:p,height:m},new Uint8Array(y)),pixelRatio:n,stretchX:o,stretchY:l,content:u,sdf:a,version:c,userImage:v}),v.onAdd&&v.onAdd(this,e),this}}}updateImage(e,r){let i=this.style.getImage(e);if(!i)return this.fire(new fi(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let n=r instanceof HTMLImageElement||Gp(r)?vn.getImageData(r):r,{width:a,height:o,data:l}=n;if(a===void 0||o===void 0)return this.fire(new fi(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==i.data.width||o!==i.data.height)return this.fire(new fi(new Error("The width and height of the updated image must be that same as the previous version of the image")));let u=!(r instanceof HTMLImageElement||Gp(r));return i.data.replace(l,u),this.style.updateImage(e,i),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new fi(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return Hp.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,r){return this._lazyInitEmptyStyle(),this.style.addLayer(e,r),this._update(!0)}moveLayer(e,r){return this.style.moveLayer(e,r),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,r,i){return this.style.setLayerZoomRange(e,r,i),this._update(!0)}setFilter(e,r,i={}){return this.style.setFilter(e,r,i),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,r,i,n={}){return this.style.setPaintProperty(e,r,i,n),this._update(!0)}getPaintProperty(e,r){return this.style.getPaintProperty(e,r)}setLayoutProperty(e,r,i,n={}){return this.style.setLayoutProperty(e,r,i,n),this._update(!0)}getLayoutProperty(e,r){return this.style.getLayoutProperty(e,r)}setGlyphs(e,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,r,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,r,i,n=>{n||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,r,i=>{i||this._update(!0)}),this}setLight(e,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,r){return this.style.setFeatureState(e,r),this._update()}removeFeatureState(e,r){return this.style.removeFeatureState(e,r),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,r=0;return this._container&&(e=this._container.clientWidth||400,r=this._container.clientHeight||300),[e,r]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let r=this._canvasContainer=or.create("div","maplibregl-canvas-container",e);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=or.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let i=this._containerDimensions(),n=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],n);let a=this._controlContainer=or.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(l=>{o[l]=or.create("div","maplibregl-ctrl-".concat(l," "),a)})}_resizeCanvas(e,r,i){this._canvas.width=Math.floor(i*e),this._canvas.height=Math.floor(i*r),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(r,"px")}_setupPainter(){let e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},r=null;this._canvas.addEventListener("webglcontextcreationerror",n=>{r={requestedAttributes:e},n&&(r.statusMessage=n.statusMessage,r.type=n.type)},{once:!0});let i=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!i){let n="Failed to initialize WebGL";throw r?(r.message=n,new Error(JSON.stringify(r))):new Error(n)}this.painter=new qBe(i,this.transform),D9.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return!this.style||!this.style._loaded?this:(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this)}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){let r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let a=this.transform.zoom,o=vn.now();this.style.zoomHistory.update(a,o);let l=new fs(a,{now:o,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=l.crossFadingFactor();(u!==1||u!==this._crossFadingFactor)&&(i=!0,this._crossFadingFactor=u),this.style.update(l)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new pr("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,Tb.mark("load"),this.fire(new pr("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new pr("idle")),this._loaded&&!this._fullyLoaded&&!n&&(this._fullyLoaded=!0,Tb.mark("fullLoad")),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(let i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Hp.removeThrottleControl(this._imageQueueHandle),(e=this._resizeObserver)==null||e.disconnect();let r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),or.remove(this._canvasContainer),or.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),Tb.clearMetrics(),this._removed=!0,this.fire(new pr("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,vn.frameAsync(this._frameRequest).then(e=>{Tb.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return Jze}getCameraTargetElevation(){return this.transform.elevation}};s(fue,"Map");var jlt=fue;N();N();var mue=s(t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},"assignEvents"),eUe=s(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:r=.8})=>{let i=new Nle;return new PA({clickTolerance:e,move:s((n,a)=>({bearingDelta:(a.x-n.x)*r}),"move"),moveStateManager:i,enable:t,assignEvents:mue})},"generateOneFingerTouchRotationHandler"),tUe=s(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:r=-.5})=>{let i=new Nle;return new PA({clickTolerance:e,move:s((n,a)=>({pitchDelta:(a.y-n.y)*r}),"move"),moveStateManager:i,enable:t,assignEvents:mue})},"generateOneFingerTouchPitchHandler"),rUe={showCompass:!0,showZoom:!0,visualizePitch:!1},gue=class{constructor(e){this._updateZoomButtons=s(()=>{let r=this._map.getZoom(),i=r===this._map.getMaxZoom(),n=r===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},"_updateZoomButtons"),this._rotateCompassArrow=s(()=>{let r=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(this._map.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(this._map.transform.angle*(180/Math.PI),"deg)");this._compassIcon.style.transform=r},"_rotateCompassArrow"),this._setButtonTitle=s((r,i)=>{let n=this._map._getUIString("NavigationControl.".concat(i));r.title=n,r.setAttribute("aria-label",n)},"_setButtonTitle"),this.options=zr({},rUe,e),this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),or.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),or.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=or.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new iUe(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){or.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,r){let i=or.create("button",e,this._container);return i.type="button",i.addEventListener("click",r),i}};s(gue,"NavigationControl");var Glt=gue,yue=class{constructor(e,r,i=!1){this.mousedown=s(o=>{this.startMouse(zr({},o,{ctrlKey:!0,preventDefault:s(()=>o.preventDefault(),"preventDefault")}),or.mousePos(this.element,o)),or.addEventListener(window,"mousemove",this.mousemove),or.addEventListener(window,"mouseup",this.mouseup)},"mousedown"),this.mousemove=s(o=>{this.moveMouse(o,or.mousePos(this.element,o))},"mousemove"),this.mouseup=s(o=>{this.mouseRotate.dragEnd(o),this.mousePitch&&this.mousePitch.dragEnd(o),this.offTemp()},"mouseup"),this.touchstart=s(o=>{o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=or.touchPos(this.element,o.targetTouches)[0],this.startTouch(o,this._startPos),or.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),or.addEventListener(window,"touchend",this.touchend))},"touchstart"),this.touchmove=s(o=>{o.targetTouches.length!==1?this.reset():(this._lastPos=or.touchPos(this.element,o.targetTouches)[0],this.moveTouch(o,this._lastPos))},"touchmove"),this.touchend=s(o=>{o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},"touchend"),this.reset=s(()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},"reset"),this._clickTolerance=10;let n=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=r,this.mouseRotate=Ble({clickTolerance:n,enable:!0}),this.touchRotate=eUe({clickTolerance:n,enable:!0}),this.map=e,i&&(this.mousePitch=zle({clickTolerance:a,enable:!0}),this.touchPitch=tUe({clickTolerance:a,enable:!0})),or.addEventListener(r,"mousedown",this.mousedown),or.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),or.addEventListener(r,"touchcancel",this.reset)}startMouse(e,r){this.mouseRotate.dragStart(e,r),this.mousePitch&&this.mousePitch.dragStart(e,r),or.disableDrag()}startTouch(e,r){this.touchRotate.dragStart(e,r),this.touchPitch&&this.touchPitch.dragStart(e,r),or.disableDrag()}moveMouse(e,r){let i=this.map,{bearingDelta:n}=this.mouseRotate.dragMove(e,r)||{};if(n&&i.setBearing(i.getBearing()+n),this.mousePitch){let{pitchDelta:a}=this.mousePitch.dragMove(e,r)||{};a&&i.setPitch(i.getPitch()+a)}}moveTouch(e,r){let i=this.map,{bearingDelta:n}=this.touchRotate.dragMove(e,r)||{};if(n&&i.setBearing(i.getBearing()+n),this.touchPitch){let{pitchDelta:a}=this.touchPitch.dragMove(e,r)||{};a&&i.setPitch(i.getPitch()+a)}}off(){let e=this.element;or.removeEventListener(e,"mousedown",this.mousedown),or.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),or.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),or.removeEventListener(window,"touchend",this.touchend),or.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){or.enableDrag(),or.removeEventListener(window,"mousemove",this.mousemove),or.removeEventListener(window,"mouseup",this.mouseup),or.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),or.removeEventListener(window,"touchend",this.touchend)}};s(yue,"MouseRotateWrapper");var iUe=yue;N();N();var Dg;async function vue(t=!1){if(Dg!==void 0&&!t)return Dg;if(window.navigator.permissions===void 0)return Dg=!!window.navigator.geolocation,Dg;try{Dg=(await window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Dg=!!window.navigator.geolocation}return Dg}s(vue,"checkGeolocationSupport");N();var NM=kr(Nn(),1);N();function nB(t,e,r){let i=new Ki(t.lng,t.lat);if(t=new Ki(t.lng,t.lat),e){let n=new Ki(t.lng-360,t.lat),a=new Ki(t.lng+360,t.lat),o=r.locationPoint(t).distSqr(e);r.locationPoint(n).distSqr(e)<o?t=n:r.locationPoint(a).distSqr(e)<o&&(t=a)}for(;Math.abs(t.lng-r.center.lng)>180;){let n=r.locationPoint(t);if(n.x>=0&&n.y>=0&&n.x<=r.width&&n.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t.lng!==i.lng&&r.locationPoint(t).y>r.height/2-r.getHorizon()?t:i}s(nB,"smartWrap");N();var aB={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function oB(t,e,r){let i=t.classList;for(let n in aB)i.remove("maplibregl-".concat(r,"-anchor-").concat(n));i.add("maplibregl-".concat(r,"-anchor-").concat(e))}s(oB,"applyAnchorClass");var _ue=class extends Fl{constructor(e){if(super(),this._onKeyPress=s(r=>{let i=r.code,n=r.charCode||r.keyCode;(i==="Space"||i==="Enter"||n===32||n===13)&&this.togglePopup()},"_onKeyPress"),this._onMapClick=s(r=>{let i=r.originalEvent.target,n=this._element;this._popup&&(i===n||n.contains(i))&&this.togglePopup()},"_onMapClick"),this._update=s(r=>{var i;if(!this._map)return;let n=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!n)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies?this._lngLat=nB(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(i=this._lngLat)==null?void 0:i.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a="rotateZ(".concat(this._rotation,"deg)"):this._rotationAlignment==="map"&&(a="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));let o="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?o="rotateX(0deg)":this._pitchAlignment==="map"&&(o="rotateX(".concat(this._map.getPitch(),"deg)")),(!r||r.type==="moveend")&&(this._pos=this._pos.round()),or.setTransform(this._element,"".concat(aB[this._anchor]," translate(").concat(this._pos.x,"px, ").concat(this._pos.y,"px) ").concat(o," ").concat(a)),vn.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},"_update"),this._onMove=s(r=>{if(!this._isDragging){let i=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=i}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new pr("dragstart"))),this.fire(new pr("drag")))},"_onMove"),this._onUp=s(()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new pr("dragend")),this._state="inactive"},"_onUp"),this._addDragHandler=s(r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},"_addDragHandler"),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),!e||!e.element){this._defaultMarker=!0,this._element=or.create("div"),this._element.setAttribute("aria-label","Map marker");let r=or.createNS("http://www.w3.org/2000/svg","svg"),i=41,n=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","".concat(i,"px")),r.setAttributeNS(null,"width","".concat(n,"px")),r.setAttributeNS(null,"viewBox","0 0 ".concat(n," ").concat(i));let a=or.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");let o=or.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");let l=or.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");let u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let I of u){let P=or.createNS("http://www.w3.org/2000/svg","ellipse");P.setAttributeNS(null,"opacity","0.04"),P.setAttributeNS(null,"cx","10.5"),P.setAttributeNS(null,"cy","5.80029008"),P.setAttributeNS(null,"rx",I.rx),P.setAttributeNS(null,"ry",I.ry),l.appendChild(P)}let c=or.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);let p=or.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(p);let m=or.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"fill","#000000");let y=or.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),m.appendChild(y);let v=or.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");let w=or.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(8.0, 8.0)");let E=or.createNS("http://www.w3.org/2000/svg","circle");E.setAttributeNS(null,"fill","#000000"),E.setAttributeNS(null,"opacity","0.25"),E.setAttributeNS(null,"cx","5.5"),E.setAttributeNS(null,"cy","5.5"),E.setAttributeNS(null,"r","5.4999962");let M=or.createNS("http://www.w3.org/2000/svg","circle");M.setAttributeNS(null,"fill","#FFFFFF"),M.setAttributeNS(null,"cx","5.5"),M.setAttributeNS(null,"cy","5.5"),M.setAttributeNS(null,"r","5.4999962"),w.appendChild(E),w.appendChild(M),o.appendChild(l),o.appendChild(c),o.appendChild(m),o.appendChild(v),o.appendChild(w),r.appendChild(o),r.setAttributeNS(null,"height","".concat(i*this._scale,"px")),r.setAttributeNS(null,"width","".concat(n*this._scale,"px")),this._element.appendChild(r),this._offset=NM.default.convert(e&&e.offset||[0,-14])}else this._element=e.element,this._offset=NM.default.convert(e&&e.offset||[0,0]);if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),oB(this._element,this._anchor,"marker"),e&&e.className)for(let r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),or.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Ki.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let r=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[r,(38.1-13.5+r)*-1],"bottom-right":[-r,(38.1-13.5+r)*-1],left:[13.5,(38.1-13.5)*-1],right:[-13.5,(38.1-13.5)*-1]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let e=this._popup;if(this._element.style.opacity===this._opacityWhenCovered)return this;if(e)e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map));else return this;return this}_updateOpacity(e=!1){var r,i;if(!((r=this._map)!=null&&r.terrain)){this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity);return}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let n=this._map,a=n.terrain.depthAtPoint(this._pos),o=n.terrain.getElevationForLngLatZoom(this._lngLat,n.transform.tileZoom),l=n.transform.lngLatToCameraDepth(this._lngLat,o),u=.006;if(l-a<u){this._element.style.opacity=this._opacity;return}let c=-this._offset.y/n.transform._pixelPerMeter,p=Math.sin(n.getPitch()*Math.PI/180)*c,m=n.terrain.depthAtPoint(new NM.default(this._pos.x,this._pos.y-this._offset.y)),y=n.transform.lngLatToCameraDepth(this._lngLat,o+p)-m>u;(i=this._popup)!=null&&i.isOpen()&&y&&this._popup.remove(),this._element.style.opacity=y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=NM.default.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return e===void 0&&r===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}};s(_ue,"Marker");var mq=_ue,nUe={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},FM=0,Pb=!1,xue=class extends Fl{constructor(e){super(),this._onSuccess=s(r=>{if(this._map){if(this._isOutOfMapMaxBounds(r)){this._setErrorState(),this.fire(new pr("outofmaxbounds",r)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new pr("geolocate",r)),this._finish()}},"_onSuccess"),this._updateCamera=s(r=>{let i=new Ki(r.coords.longitude,r.coords.latitude),n=r.coords.accuracy,a=this._map.getBearing(),o=zr({bearing:a},this.options.fitBoundsOptions),l=Km.fromLngLat(i,n);this._map.fitBounds(l,o,{geolocateSource:!0})},"_updateCamera"),this._updateMarker=s(r=>{if(r){let i=new Ki(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},"_updateMarker"),this._onZoom=s(()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},"_onZoom"),this._onError=s(r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Pb)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new pr("error",r)),this._finish()}},"_onError"),this._finish=s(()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},"_finish"),this._setupUI=s(r=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=or.create("button","maplibregl-ctrl-geolocate",this._container),or.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){kl("Geolocation support is not available so the GeolocateControl will be disabled.");let i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{let i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=or.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new mq({element:this._dotElement}),this._circleElement=or.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new mq({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{let n=i.originalEvent&&i.originalEvent.type==="resize";!i.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!n&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new pr("trackuserlocationend")))})}},"_setupUI"),this.options=zr({},nUe,e)}onAdd(e){return this._map=e,this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),vue().then(r=>this._setupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),or.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,FM=0,Pb=!1}_isOutOfMapMaxBounds(e){let r=this._map.getMaxBounds(),i=e.coords;return r&&(i.longitude<r.getWest()||i.longitude>r.getEast()||i.latitude<r.getSouth()||i.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}}_updateCircleRadius(){let e=this._map.getBounds(),r=e.getSouthEast(),i=e.getNorthEast(),n=r.distanceTo(i),a=this._map._container.clientHeight,o=Math.ceil(2*(this._accuracy/(n/a)));this._circleElement.style.width="".concat(o,"px"),this._circleElement.style.height="".concat(o,"px")}trigger(){if(!this._setup)return kl("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new pr("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":FM--,Pb=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new pr("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new pr("trackuserlocationstart"));break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),FM++;let e;FM>1?(e={maximumAge:6e5,timeout:0},Pb=!0):(e=this.options.positionOptions,Pb=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}};s(xue,"GeolocateControl");var Xlt=xue;N();var aUe={maxWidth:100,unit:"metric"},bue=class{constructor(e){this._onMove=s(()=>{xR(this._map,this._container,this.options)},"_onMove"),this.setUnit=s(r=>{this.options.unit=r,xR(this._map,this._container,this.options)},"setUnit"),this.options=Ee(Ee({},aUe),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){or.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}};s(bue,"ScaleControl");var Ylt=bue;function xR(t,e,r){let i=r&&r.maxWidth||100,n=t._container.clientHeight/2,a=t.unproject([0,n]),o=t.unproject([i,n]),l=a.distanceTo(o);if(r&&r.unit==="imperial"){let u=3.2808*l;if(u>5280){let c=u/5280;T0(e,i,c,t._getUIString("ScaleControl.Miles"))}else T0(e,i,u,t._getUIString("ScaleControl.Feet"))}else if(r&&r.unit==="nautical"){let u=l/1852;T0(e,i,u,t._getUIString("ScaleControl.NauticalMiles"))}else l>=1e3?T0(e,i,l/1e3,t._getUIString("ScaleControl.Kilometers")):T0(e,i,l,t._getUIString("ScaleControl.Meters"))}s(xR,"updateScale");function T0(t,e,r,i){let n=Aue(r),a=n/r;t.style.width="".concat(e*a,"px"),t.innerHTML="".concat(n,"&nbsp;").concat(i)}s(T0,"setScale");function wue(t){let e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}s(wue,"getDecimalRoundNum");function Aue(t){let e=Math.pow(10,"".concat(Math.floor(t)).length-1),r=t/e;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:wue(r),e*r}s(Aue,"getRoundNum");N();var Sue=class extends Fl{constructor(e={}){super(),this._onFullscreenChange=s(()=>{var r;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;(r=i==null?void 0:i.shadowRoot)!=null&&r.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},"_onFullscreenChange"),this._onClickFullscreen=s(()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},"_onClickFullscreen"),this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:kl("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){or.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let e=this._fullscreenButton=or.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);or.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new pr("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new pr("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}};s(Sue,"FullscreenControl");var Jlt=Sue;N();var Mue=class{constructor(e){this._toggleTerrain=s(()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},"_toggleTerrain"),this._updateTerrainIcon=s(()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},"_updateTerrainIcon"),this.options=e}onAdd(e){return this._map=e,this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=or.create("button","maplibregl-ctrl-terrain",this._container),or.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){or.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}};s(Mue,"TerrainControl");var eut=Mue;N();var jo=kr(Nn(),1),oUe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},sUe=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Eue=class extends Fl{constructor(e){super(),this.remove=s(()=>(this._content&&or.remove(this._content),this._container&&(or.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new pr("close"))),this),"remove"),this._onMouseUp=s(r=>{this._update(r.point)},"_onMouseUp"),this._onMouseMove=s(r=>{this._update(r.point)},"_onMouseMove"),this._onDrag=s(r=>{this._update(r.point)},"_onDrag"),this._update=s(r=>{var i;let n=this._lngLat||this._trackPointer;if(!this._map||!n||!this._content)return;if(!this._container){if(this._container=or.create("div","maplibregl-popup",this._map.getContainer()),this._tip=or.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let c of this.options.className.split(" "))this._container.classList.add(c);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer?this._lngLat=nB(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(i=this._lngLat)==null?void 0:i.wrap(),this._trackPointer&&!r)return;let a=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let o=this.options.anchor,l=sB(this.options.offset);if(!o){let c=this._container.offsetWidth,p=this._container.offsetHeight,m;a.y+l.bottom.y<p?m=["top"]:a.y>this._map.transform.height-p?m=["bottom"]:m=[],a.x<c/2?m.push("left"):a.x>this._map.transform.width-c/2&&m.push("right"),m.length===0?o="bottom":o=m.join("-")}let u=a.add(l[o]);this.options.subpixelPositioning||(u=u.round()),or.setTransform(this._container,"".concat(aB[o]," translate(").concat(u.x,"px,").concat(u.y,"px)")),oB(this._container,o,"popup")},"_update"),this._onClose=s(()=>{this.remove()},"_onClose"),this.options=zr(Object.create(oUe),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new pr("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Ki.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){let r=document.createDocumentFragment(),i=document.createElement("body"),n;for(i.innerHTML=e;n=i.firstChild,!!n;)r.appendChild(n);return this.setDOMContent(r)}getMaxWidth(){var e;return(e=this._container)==null?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=or.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=or.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let e=this._container.querySelector(sUe);e&&e.focus()}};s(Eue,"Popup");var rut=Eue;function sB(t){if(t)if(typeof t=="number"){let e=Math.round(Math.abs(t)/Math.SQRT2);return{center:new jo.default(0,0),top:new jo.default(0,t),"top-left":new jo.default(e,e),"top-right":new jo.default(-e,e),bottom:new jo.default(0,-t),"bottom-left":new jo.default(e,-e),"bottom-right":new jo.default(-e,-e),left:new jo.default(t,0),right:new jo.default(-t,0)}}else if(t instanceof jo.default||Array.isArray(t)){let e=jo.default.convert(t);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}else return{center:jo.default.convert(t.center||[0,0]),top:jo.default.convert(t.top||[0,0]),"top-left":jo.default.convert(t["top-left"]||[0,0]),"top-right":jo.default.convert(t["top-right"]||[0,0]),bottom:jo.default.convert(t.bottom||[0,0]),"bottom-left":jo.default.convert(t["bottom-left"]||[0,0]),"bottom-right":jo.default.convert(t["bottom-right"]||[0,0]),left:jo.default.convert(t.left||[0,0]),right:jo.default.convert(t.right||[0,0])};else return sB(new jo.default(0,0))}s(sB,"normalizeOffset");var iut=kr(Nn(),1),lUe=nZ.version;function uUe(t,e){return w_().setRTLTextPlugin(t,e)}s(uUe,"setRTLTextPlugin");function cUe(){return w_().getRTLTextPluginStatus()}s(cUe,"getRTLTextPluginStatus");function hUe(){return lUe}s(hUe,"getVersion");function pUe(){return MP.workerCount}s(pUe,"getWorkerCount");function dUe(t){MP.workerCount=t}s(dUe,"setWorkerCount");function fUe(){return wc.MAX_PARALLEL_IMAGE_REQUESTS}s(fUe,"getMaxParallelImageRequests");function mUe(t){wc.MAX_PARALLEL_IMAGE_REQUESTS=t}s(mUe,"setMaxParallelImageRequests");function gUe(){return wc.WORKER_URL}s(gUe,"getWorkerUrl");function Cue(t){wc.WORKER_URL=t}s(Cue,"setWorkerUrl");function yUe(t){return NF().broadcast("IS",t)}s(yUe,"importScriptInWorkers");N();var lB="173",GL={LEFT:0,MIDDLE:1,RIGHT:2},vUe=0,gq=1,_Ue=2,Iue=1,xUe=2,Rd=3,Qp=0,tu=1,Pu=2,Hm=0,r_=1,yq=2,vq=3,_q=4,bUe=5,dy=100,wUe=101,AUe=102,SUe=103,MUe=104,EUe=200,CUe=201,IUe=202,TUe=203,bR=204,wR=205,PUe=206,LUe=207,DUe=208,RUe=209,OUe=210,kUe=211,NUe=212,FUe=213,BUe=214,AR=0,SR=1,MR=2,A_=3,ER=4,CR=5,IR=6,TR=7,uB=0,zUe=1,UUe=2,qm=0,VUe=1,jUe=2,$Ue=3,GUe=4,HUe=5,qUe=6,WUe=7,xq="attached",XUe="detached",Tue=300,S_=301,M_=302,B3=303,PR=304,RP=306,Bh=1e3,My=1001,LR=1002,_c=1003,ZUe=1004,BM=1005,Up=1006,HL=1007,Ey=1008,ed=1009,Pue=1010,Lue=1011,Dw=1012,cB=1013,Jm=1014,Lu=1015,LA=1016,hB=1017,pB=1018,E_=1020,Due=35902,Rue=1021,Oue=1022,Dl=1023,kue=1024,Nue=1025,i_=1026,C_=1027,dB=1028,OP=1029,Fue=1030,fB=1031,mB=1033,YE=33776,KE=33777,JE=33778,QE=33779,DR=35840,RR=35841,OR=35842,kR=35843,NR=36196,FR=37492,BR=37496,zR=37808,UR=37809,VR=37810,jR=37811,$R=37812,GR=37813,HR=37814,qR=37815,WR=37816,XR=37817,ZR=37818,YR=37819,KR=37820,JR=37821,eC=36492,QR=36494,eO=36495,Bue=36283,tO=36284,rO=36285,iO=36286,z3=2300,nO=2301,qL=2302,bq=2400,wq=2401,Aq=2402,YUe=2500,KUe=0,JUe=1,Sq=2,QUe=3200,eVe=3201,gB=0,tVe=1,Nm="",nl="srgb",Wy="srgb-linear",U3="linear",ga="srgb",Jd=7680,WL=7681,rVe=517,aO=519,iVe=512,nVe=513,aVe=514,zue=515,oVe=516,sVe=517,lVe=518,uVe=519,oO=35044,nut=35048,sO="300 es",sf=2e3,V3=2001,Uue=class{addEventListener(e,r){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(r)===-1&&i[e].push(r)}hasEventListener(e,r){let i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(r)!==-1}removeEventListener(e,r){let i=this._listeners;if(i===void 0)return;let n=i[e];if(n!==void 0){let a=n.indexOf(r);a!==-1&&n.splice(a,1)}}dispatchEvent(e){let r=this._listeners;if(r===void 0)return;let i=r[e.type];if(i!==void 0){e.target=this;let n=i.slice(0);for(let a=0,o=n.length;a<o;a++)n[a].call(this,e);e.target=null}}};s(Uue,"EventDispatcher");var ox=Uue,xl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Mq=1234567,n_=Math.PI/180,I_=180/Math.PI;function xc(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(xl[t&255]+xl[t>>8&255]+xl[t>>16&255]+xl[t>>24&255]+"-"+xl[e&255]+xl[e>>8&255]+"-"+xl[e>>16&15|64]+xl[e>>24&255]+"-"+xl[r&63|128]+xl[r>>8&255]+"-"+xl[r>>16&255]+xl[r>>24&255]+xl[i&255]+xl[i>>8&255]+xl[i>>16&255]+xl[i>>24&255]).toLowerCase()}s(xc,"generateUUID");function Ji(t,e,r){return Math.max(e,Math.min(r,t))}s(Ji,"clamp");function kP(t,e){return(t%e+e)%e}s(kP,"euclideanModulo");function Vue(t,e,r,i,n){return i+(t-e)*(n-i)/(r-e)}s(Vue,"mapLinear");function jue(t,e,r){return t!==e?(r-t)/(e-t):0}s(jue,"inverseLerp");function a_(t,e,r){return(1-r)*t+r*e}s(a_,"lerp");function $ue(t,e,r,i){return a_(t,e,1-Math.exp(-r*i))}s($ue,"damp");function Gue(t,e=1){return e-Math.abs(kP(t,e*2)-e)}s(Gue,"pingpong");function Hue(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*(3-2*t))}s(Hue,"smoothstep");function que(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*t*(t*(t*6-15)+10))}s(que,"smootherstep");function Wue(t,e){return t+Math.floor(Math.random()*(e-t+1))}s(Wue,"randInt");function Xue(t,e){return t+Math.random()*(e-t)}s(Xue,"randFloat");function Zue(t){return t*(.5-Math.random())}s(Zue,"randFloatSpread");function Yue(t){t!==void 0&&(Mq=t);let e=Mq+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}s(Yue,"seededRandom");function Kue(t){return t*n_}s(Kue,"degToRad");function Jue(t){return t*I_}s(Jue,"radToDeg");function Que(t){return(t&t-1)===0&&t!==0}s(Que,"isPowerOfTwo");function ece(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}s(ece,"ceilPowerOfTwo");function tce(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}s(tce,"floorPowerOfTwo");function rce(t,e,r,i,n){let a=Math.cos,o=Math.sin,l=a(r/2),u=o(r/2),c=a((e+i)/2),p=o((e+i)/2),m=a((e-i)/2),y=o((e-i)/2),v=a((i-e)/2),w=o((i-e)/2);switch(n){case"XYX":t.set(l*p,u*m,u*y,l*c);break;case"YZY":t.set(u*y,l*p,u*m,l*c);break;case"ZXZ":t.set(u*m,u*y,l*p,l*c);break;case"XZX":t.set(l*p,u*w,u*v,l*c);break;case"YXY":t.set(u*v,l*p,u*w,l*c);break;case"ZYZ":t.set(u*w,u*v,l*p,l*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}s(rce,"setQuaternionFromProperEuler");function Qc(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}s(Qc,"denormalize");function Yn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}s(Yn,"normalize");var Gn={DEG2RAD:n_,RAD2DEG:I_,generateUUID:xc,clamp:Ji,euclideanModulo:kP,mapLinear:Vue,inverseLerp:jue,lerp:a_,damp:$ue,pingpong:Gue,smoothstep:Hue,smootherstep:que,randInt:Wue,randFloat:Xue,randFloatSpread:Zue,seededRandom:Yue,degToRad:Kue,radToDeg:Jue,isPowerOfTwo:Que,ceilPowerOfTwo:ece,floorPowerOfTwo:tce,setQuaternionFromProperEuler:rce,normalize:Yn,denormalize:Qc},ice=class nce{constructor(e=0,r=0){nce.prototype.isVector2=!0,this.x=e,this.y=r}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,r){return this.x=e,this.y=r,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let r=this.x,i=this.y,n=e.elements;return this.x=n[0]*r+n[3]*i+n[6],this.y=n[1]*r+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,r){return this.x=Ji(this.x,e.x,r.x),this.y=Ji(this.y,e.y,r.y),this}clampScalar(e,r){return this.x=Ji(this.x,e,r),this.y=Ji(this.y,e,r),this}clampLength(e,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ji(i,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;let i=this.dot(e)/r;return Math.acos(Ji(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let r=this.x-e.x,i=this.y-e.y;return r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this}lerpVectors(e,r,i){return this.x=e.x+(r.x-e.x)*i,this.y=e.y+(r.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this}rotateAround(e,r){let i=Math.cos(r),n=Math.sin(r),a=this.x-e.x,o=this.y-e.y;return this.x=a*i-o*n+e.x,this.y=a*n+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};s(ice,"Vector2");var Jt=ice,ace=class oce{constructor(e,r,i,n,a,o,l,u,c){oce.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,r,i,n,a,o,l,u,c)}set(e,r,i,n,a,o,l,u,c){let p=this.elements;return p[0]=e,p[1]=n,p[2]=l,p[3]=r,p[4]=a,p[5]=u,p[6]=i,p[7]=o,p[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let r=this.elements,i=e.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],this}extractBasis(e,r,i){return e.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let r=e.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){let i=e.elements,n=r.elements,a=this.elements,o=i[0],l=i[3],u=i[6],c=i[1],p=i[4],m=i[7],y=i[2],v=i[5],w=i[8],E=n[0],M=n[3],I=n[6],P=n[1],C=n[4],T=n[7],O=n[2],F=n[5],k=n[8];return a[0]=o*E+l*P+u*O,a[3]=o*M+l*C+u*F,a[6]=o*I+l*T+u*k,a[1]=c*E+p*P+m*O,a[4]=c*M+p*C+m*F,a[7]=c*I+p*T+m*k,a[2]=y*E+v*P+w*O,a[5]=y*M+v*C+w*F,a[8]=y*I+v*T+w*k,this}multiplyScalar(e){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=e,r[4]*=e,r[7]*=e,r[2]*=e,r[5]*=e,r[8]*=e,this}determinant(){let e=this.elements,r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8];return r*o*p-r*l*c-i*a*p+i*l*u+n*a*c-n*o*u}invert(){let e=this.elements,r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=p*o-l*c,y=l*u-p*a,v=c*a-o*u,w=r*m+i*y+n*v;if(w===0)return this.set(0,0,0,0,0,0,0,0,0);let E=1/w;return e[0]=m*E,e[1]=(n*c-p*i)*E,e[2]=(l*i-n*o)*E,e[3]=y*E,e[4]=(p*r-n*u)*E,e[5]=(n*a-l*r)*E,e[6]=v*E,e[7]=(i*u-c*r)*E,e[8]=(o*r-i*a)*E,this}transpose(){let e,r=this.elements;return e=r[1],r[1]=r[3],r[3]=e,e=r[2],r[2]=r[6],r[6]=e,e=r[5],r[5]=r[7],r[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let r=this.elements;return e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8],this}setUvTransform(e,r,i,n,a,o,l){let u=Math.cos(a),c=Math.sin(a);return this.set(i*u,i*c,-i*(u*o+c*l)+o+e,-n*c,n*u,-n*(-c*o+u*l)+l+r,0,0,1),this}scale(e,r){return this.premultiply(XL.makeScale(e,r)),this}rotate(e){return this.premultiply(XL.makeRotation(-e)),this}translate(e,r){return this.premultiply(XL.makeTranslation(e,r)),this}makeTranslation(e,r){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,r,0,0,1),this}makeRotation(e){let r=Math.cos(e),i=Math.sin(e);return this.set(r,-i,0,i,r,0,0,0,1),this}makeScale(e,r){return this.set(e,0,0,0,r,0,0,0,1),this}equals(e){let r=this.elements,i=e.elements;for(let n=0;n<9;n++)if(r[n]!==i[n])return!1;return!0}fromArray(e,r=0){for(let i=0;i<9;i++)this.elements[i]=e[i+r];return this}toArray(e=[],r=0){let i=this.elements;return e[r]=i[0],e[r+1]=i[1],e[r+2]=i[2],e[r+3]=i[3],e[r+4]=i[4],e[r+5]=i[5],e[r+6]=i[6],e[r+7]=i[7],e[r+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};s(ace,"Matrix3");var nn=ace,XL=new nn;function yB(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}s(yB,"arrayNeedsUint32");function T_(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}s(T_,"createElementNS");function sce(){let t=T_("canvas");return t.style.display="block",t}s(sce,"createCanvasElement");var Eq={};function fy(t){t in Eq||(Eq[t]=!0,console.warn(t))}s(fy,"warnOnce");function lce(t,e,r){return new Promise(function(i,n){function a(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:n();break;case t.TIMEOUT_EXPIRED:setTimeout(a,r);break;default:i()}}s(a,"probe"),setTimeout(a,r)})}s(lce,"probeAsync");function uce(t){let e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}s(uce,"toNormalizedProjectionMatrix");function cce(t){let e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}s(cce,"toReversedProjectionMatrix");var Cq=new nn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Iq=new nn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function hce(){let t={enabled:!0,workingColorSpace:Wy,spaces:{},convert:s(function(n,a,o){return this.enabled===!1||a===o||!a||!o||(this.spaces[a].transfer===ga&&(n.r=Xp(n.r),n.g=Xp(n.g),n.b=Xp(n.b)),this.spaces[a].primaries!==this.spaces[o].primaries&&(n.applyMatrix3(this.spaces[a].toXYZ),n.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===ga&&(n.r=Ny(n.r),n.g=Ny(n.g),n.b=Ny(n.b))),n},"convert"),fromWorkingColorSpace:s(function(n,a){return this.convert(n,this.workingColorSpace,a)},"fromWorkingColorSpace"),toWorkingColorSpace:s(function(n,a){return this.convert(n,a,this.workingColorSpace)},"toWorkingColorSpace"),getPrimaries:s(function(n){return this.spaces[n].primaries},"getPrimaries"),getTransfer:s(function(n){return n===Nm?U3:this.spaces[n].transfer},"getTransfer"),getLuminanceCoefficients:s(function(n,a=this.workingColorSpace){return n.fromArray(this.spaces[a].luminanceCoefficients)},"getLuminanceCoefficients"),define:s(function(n){Object.assign(this.spaces,n)},"define"),_getMatrix:s(function(n,a,o){return n.copy(this.spaces[a].toXYZ).multiply(this.spaces[o].fromXYZ)},"_getMatrix"),_getDrawingBufferColorSpace:s(function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},"_getDrawingBufferColorSpace"),_getUnpackColorSpace:s(function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace},"_getUnpackColorSpace")},e=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[Wy]:{primaries:e,whitePoint:i,transfer:U3,toXYZ:Cq,fromXYZ:Iq,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:nl},outputColorSpaceConfig:{drawingBufferColorSpace:nl}},[nl]:{primaries:e,whitePoint:i,transfer:ga,toXYZ:Cq,fromXYZ:Iq,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:nl}}}),t}s(hce,"createColorManagement");var Rn=hce();function Xp(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}s(Xp,"SRGBToLinear");function Ny(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}s(Ny,"LinearToSRGB");var a0,pce=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{a0===void 0&&(a0=T_("canvas")),a0.width=e.width,a0.height=e.height;let i=a0.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=a0}return r.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let r=T_("canvas");r.width=e.width,r.height=e.height;let i=r.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let n=i.getImageData(0,0,e.width,e.height),a=n.data;for(let o=0;o<a.length;o++)a[o]=Xp(a[o]/255)*255;return i.putImageData(n,0,0),r}else if(e.data){let r=e.data.slice(0);for(let i=0;i<r.length;i++)r instanceof Uint8Array||r instanceof Uint8ClampedArray?r[i]=Math.floor(Xp(r[i]/255)*255):r[i]=Xp(r[i]);return{data:r,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}};s(pce,"ImageUtils");var cVe=pce,hVe=0,dce=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:hVe++}),this.uuid=xc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let r=e===void 0||typeof e=="string";if(!r&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let o=0,l=n.length;o<l;o++)n[o].isDataTexture?a.push(tC(n[o].image)):a.push(tC(n[o]))}else a=tC(n);i.url=a}return r||(e.images[this.uuid]=i),i}};s(dce,"Source");var fce=dce;function tC(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?cVe.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}s(tC,"serializeImage");var pVe=0,mce=class rC extends ox{constructor(e=rC.DEFAULT_IMAGE,r=rC.DEFAULT_MAPPING,i=My,n=My,a=Up,o=Ey,l=Dl,u=ed,c=rC.DEFAULT_ANISOTROPY,p=Nm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:pVe++}),this.uuid=xc(),this.name="",this.source=new fce(e),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=i,this.wrapT=n,this.magFilter=a,this.minFilter=o,this.anisotropy=c,this.format=l,this.internalFormat=null,this.type=u,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new nn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let r=e===void 0||typeof e=="string";if(!r&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),r||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Tue)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Bh:e.x=e.x-Math.floor(e.x);break;case My:e.x=e.x<0?0:1;break;case LR:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Bh:e.y=e.y-Math.floor(e.y);break;case My:e.y=e.y<0?0:1;break;case LR:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};s(mce,"Texture");var Gu=mce;Gu.DEFAULT_IMAGE=null;Gu.DEFAULT_MAPPING=Tue;Gu.DEFAULT_ANISOTROPY=1;var gce=class yce{constructor(e=0,r=0,i=0,n=1){yce.prototype.isVector4=!0,this.x=e,this.y=r,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,r,i,n){return this.x=e,this.y=r,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this.w=e.w+r.w,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this.w+=e.w*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this.w=e.w-r.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let r=this.x,i=this.y,n=this.z,a=this.w,o=e.elements;return this.x=o[0]*r+o[4]*i+o[8]*n+o[12]*a,this.y=o[1]*r+o[5]*i+o[9]*n+o[13]*a,this.z=o[2]*r+o[6]*i+o[10]*n+o[14]*a,this.w=o[3]*r+o[7]*i+o[11]*n+o[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let r=Math.sqrt(1-e.w*e.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/r,this.y=e.y/r,this.z=e.z/r),this}setAxisAngleFromRotationMatrix(e){let r,i,n,a,o=e.elements,l=o[0],u=o[4],c=o[8],p=o[1],m=o[5],y=o[9],v=o[2],w=o[6],E=o[10];if(Math.abs(u-p)<.01&&Math.abs(c-v)<.01&&Math.abs(y-w)<.01){if(Math.abs(u+p)<.1&&Math.abs(c+v)<.1&&Math.abs(y+w)<.1&&Math.abs(l+m+E-3)<.1)return this.set(1,0,0,0),this;r=Math.PI;let I=(l+1)/2,P=(m+1)/2,C=(E+1)/2,T=(u+p)/4,O=(c+v)/4,F=(y+w)/4;return I>P&&I>C?I<.01?(i=0,n=.707106781,a=.707106781):(i=Math.sqrt(I),n=T/i,a=O/i):P>C?P<.01?(i=.707106781,n=0,a=.707106781):(n=Math.sqrt(P),i=T/n,a=F/n):C<.01?(i=.707106781,n=.707106781,a=0):(a=Math.sqrt(C),i=O/a,n=F/a),this.set(i,n,a,r),this}let M=Math.sqrt((w-y)*(w-y)+(c-v)*(c-v)+(p-u)*(p-u));return Math.abs(M)<.001&&(M=1),this.x=(w-y)/M,this.y=(c-v)/M,this.z=(p-u)/M,this.w=Math.acos((l+m+E-1)/2),this}setFromMatrixPosition(e){let r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this.w=r[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,r){return this.x=Ji(this.x,e.x,r.x),this.y=Ji(this.y,e.y,r.y),this.z=Ji(this.z,e.z,r.z),this.w=Ji(this.w,e.w,r.w),this}clampScalar(e,r){return this.x=Ji(this.x,e,r),this.y=Ji(this.y,e,r),this.z=Ji(this.z,e,r),this.w=Ji(this.w,e,r),this}clampLength(e,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ji(i,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this.w+=(e.w-this.w)*r,this}lerpVectors(e,r,i){return this.x=e.x+(r.x-e.x)*i,this.y=e.y+(r.y-e.y)*i,this.z=e.z+(r.z-e.z)*i,this.w=e.w+(r.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this.w=e[r+3],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e[r+3]=this.w,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this.w=e.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};s(gce,"Vector4");var Qn=gce,vce=class extends ox{constructor(e=1,r=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=r,this.depth=1,this.scissor=new Qn(0,0,e,r),this.scissorTest=!1,this.viewport=new Qn(0,0,e,r);let n={width:e,height:r,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Up,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);let a=new Gu(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);a.flipY=!1,a.generateMipmaps=i.generateMipmaps,a.internalFormat=i.internalFormat,this.textures=[];let o=i.count;for(let l=0;l<o;l++)this.textures[l]=a.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,r,i=1){if(this.width!==e||this.height!==r||this.depth!==i){this.width=e,this.height=r,this.depth=i;for(let n=0,a=this.textures.length;n<a;n++)this.textures[n].image.width=e,this.textures[n].image.height=r,this.textures[n].image.depth=i;this.dispose()}this.viewport.set(0,0,e,r),this.scissor.set(0,0,e,r)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,n=e.textures.length;i<n;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0,this.textures[i].renderTarget=this;let r=Object.assign({},e.texture.image);return this.texture.source=new fce(r),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};s(vce,"RenderTarget");var dVe=vce,_ce=class extends dVe{constructor(e=1,r=1,i={}){super(e,r,i),this.isWebGLRenderTarget=!0}};s(_ce,"WebGLRenderTarget");var Qm=_ce,xce=class extends Gu{constructor(e=null,r=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:r,height:i,depth:n},this.magFilter=_c,this.minFilter=_c,this.wrapR=My,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};s(xce,"DataArrayTexture");var bce=xce,wce=class extends Gu{constructor(e=null,r=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:r,height:i,depth:n},this.magFilter=_c,this.minFilter=_c,this.wrapR=My,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};s(wce,"Data3DTexture");var fVe=wce,Ace=class{constructor(e=0,r=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=r,this._z=i,this._w=n}static slerpFlat(e,r,i,n,a,o,l){let u=i[n+0],c=i[n+1],p=i[n+2],m=i[n+3],y=a[o+0],v=a[o+1],w=a[o+2],E=a[o+3];if(l===0){e[r+0]=u,e[r+1]=c,e[r+2]=p,e[r+3]=m;return}if(l===1){e[r+0]=y,e[r+1]=v,e[r+2]=w,e[r+3]=E;return}if(m!==E||u!==y||c!==v||p!==w){let M=1-l,I=u*y+c*v+p*w+m*E,P=I>=0?1:-1,C=1-I*I;if(C>Number.EPSILON){let O=Math.sqrt(C),F=Math.atan2(O,I*P);M=Math.sin(M*F)/O,l=Math.sin(l*F)/O}let T=l*P;if(u=u*M+y*T,c=c*M+v*T,p=p*M+w*T,m=m*M+E*T,M===1-l){let O=1/Math.sqrt(u*u+c*c+p*p+m*m);u*=O,c*=O,p*=O,m*=O}}e[r]=u,e[r+1]=c,e[r+2]=p,e[r+3]=m}static multiplyQuaternionsFlat(e,r,i,n,a,o){let l=i[n],u=i[n+1],c=i[n+2],p=i[n+3],m=a[o],y=a[o+1],v=a[o+2],w=a[o+3];return e[r]=l*w+p*m+u*v-c*y,e[r+1]=u*w+p*y+c*m-l*v,e[r+2]=c*w+p*v+l*y-u*m,e[r+3]=p*w-l*m-u*y-c*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,r,i,n){return this._x=e,this._y=r,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,r=!0){let i=e._x,n=e._y,a=e._z,o=e._order,l=Math.cos,u=Math.sin,c=l(i/2),p=l(n/2),m=l(a/2),y=u(i/2),v=u(n/2),w=u(a/2);switch(o){case"XYZ":this._x=y*p*m+c*v*w,this._y=c*v*m-y*p*w,this._z=c*p*w+y*v*m,this._w=c*p*m-y*v*w;break;case"YXZ":this._x=y*p*m+c*v*w,this._y=c*v*m-y*p*w,this._z=c*p*w-y*v*m,this._w=c*p*m+y*v*w;break;case"ZXY":this._x=y*p*m-c*v*w,this._y=c*v*m+y*p*w,this._z=c*p*w+y*v*m,this._w=c*p*m-y*v*w;break;case"ZYX":this._x=y*p*m-c*v*w,this._y=c*v*m+y*p*w,this._z=c*p*w-y*v*m,this._w=c*p*m+y*v*w;break;case"YZX":this._x=y*p*m+c*v*w,this._y=c*v*m+y*p*w,this._z=c*p*w-y*v*m,this._w=c*p*m-y*v*w;break;case"XZY":this._x=y*p*m-c*v*w,this._y=c*v*m-y*p*w,this._z=c*p*w+y*v*m,this._w=c*p*m+y*v*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return r===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,r){let i=r/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let r=e.elements,i=r[0],n=r[4],a=r[8],o=r[1],l=r[5],u=r[9],c=r[2],p=r[6],m=r[10],y=i+l+m;if(y>0){let v=.5/Math.sqrt(y+1);this._w=.25/v,this._x=(p-u)*v,this._y=(a-c)*v,this._z=(o-n)*v}else if(i>l&&i>m){let v=2*Math.sqrt(1+i-l-m);this._w=(p-u)/v,this._x=.25*v,this._y=(n+o)/v,this._z=(a+c)/v}else if(l>m){let v=2*Math.sqrt(1+l-i-m);this._w=(a-c)/v,this._x=(n+o)/v,this._y=.25*v,this._z=(u+p)/v}else{let v=2*Math.sqrt(1+m-i-l);this._w=(o-n)/v,this._x=(a+c)/v,this._y=(u+p)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,r){let i=e.dot(r)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*r.z-e.z*r.y,this._y=e.z*r.x-e.x*r.z,this._z=e.x*r.y-e.y*r.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ji(this.dot(e),-1,1)))}rotateTowards(e,r){let i=this.angleTo(e);if(i===0)return this;let n=Math.min(1,r/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,r){let i=e._x,n=e._y,a=e._z,o=e._w,l=r._x,u=r._y,c=r._z,p=r._w;return this._x=i*p+o*l+n*c-a*u,this._y=n*p+o*u+a*l-i*c,this._z=a*p+o*c+i*u-n*l,this._w=o*p-i*l-n*u-a*c,this._onChangeCallback(),this}slerp(e,r){if(r===0)return this;if(r===1)return this.copy(e);let i=this._x,n=this._y,a=this._z,o=this._w,l=o*e._w+i*e._x+n*e._y+a*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=i,this._y=n,this._z=a,this;let u=1-l*l;if(u<=Number.EPSILON){let v=1-r;return this._w=v*o+r*this._w,this._x=v*i+r*this._x,this._y=v*n+r*this._y,this._z=v*a+r*this._z,this.normalize(),this}let c=Math.sqrt(u),p=Math.atan2(c,l),m=Math.sin((1-r)*p)/c,y=Math.sin(r*p)/c;return this._w=o*m+this._w*y,this._x=i*m+this._x*y,this._y=n*m+this._y*y,this._z=a*m+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,r,i){return this.copy(e).slerp(r,i)}random(){let e=2*Math.PI*Math.random(),r=2*Math.PI*Math.random(),i=Math.random(),n=Math.sqrt(1-i),a=Math.sqrt(i);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(r),a*Math.cos(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,r=0){return this._x=e[r],this._y=e[r+1],this._z=e[r+2],this._w=e[r+3],this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._w,e}fromBufferAttribute(e,r){return this._x=e.getX(r),this._y=e.getY(r),this._z=e.getZ(r),this._w=e.getW(r),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};s(Ace,"Quaternion");var ff=Ace,Sce=class Mce{constructor(e=0,r=0,i=0){Mce.prototype.isVector3=!0,this.x=e,this.y=r,this.z=i}set(e,r,i){return i===void 0&&(i=this.z),this.x=e,this.y=r,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,r){return this.x=e.x*r.x,this.y=e.y*r.y,this.z=e.z*r.z,this}applyEuler(e){return this.applyQuaternion(Tq.setFromEuler(e))}applyAxisAngle(e,r){return this.applyQuaternion(Tq.setFromAxisAngle(e,r))}applyMatrix3(e){let r=this.x,i=this.y,n=this.z,a=e.elements;return this.x=a[0]*r+a[3]*i+a[6]*n,this.y=a[1]*r+a[4]*i+a[7]*n,this.z=a[2]*r+a[5]*i+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let r=this.x,i=this.y,n=this.z,a=e.elements,o=1/(a[3]*r+a[7]*i+a[11]*n+a[15]);return this.x=(a[0]*r+a[4]*i+a[8]*n+a[12])*o,this.y=(a[1]*r+a[5]*i+a[9]*n+a[13])*o,this.z=(a[2]*r+a[6]*i+a[10]*n+a[14])*o,this}applyQuaternion(e){let r=this.x,i=this.y,n=this.z,a=e.x,o=e.y,l=e.z,u=e.w,c=2*(o*n-l*i),p=2*(l*r-a*n),m=2*(a*i-o*r);return this.x=r+u*c+o*m-l*p,this.y=i+u*p+l*c-a*m,this.z=n+u*m+a*p-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let r=this.x,i=this.y,n=this.z,a=e.elements;return this.x=a[0]*r+a[4]*i+a[8]*n,this.y=a[1]*r+a[5]*i+a[9]*n,this.z=a[2]*r+a[6]*i+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,r){return this.x=Ji(this.x,e.x,r.x),this.y=Ji(this.y,e.y,r.y),this.z=Ji(this.z,e.z,r.z),this}clampScalar(e,r){return this.x=Ji(this.x,e,r),this.y=Ji(this.y,e,r),this.z=Ji(this.z,e,r),this}clampLength(e,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ji(i,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this}lerpVectors(e,r,i){return this.x=e.x+(r.x-e.x)*i,this.y=e.y+(r.y-e.y)*i,this.z=e.z+(r.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,r){let i=e.x,n=e.y,a=e.z,o=r.x,l=r.y,u=r.z;return this.x=n*u-a*l,this.y=a*o-i*u,this.z=i*l-n*o,this}projectOnVector(e){let r=e.lengthSq();if(r===0)return this.set(0,0,0);let i=e.dot(this)/r;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return ZL.copy(this).projectOnVector(e),this.sub(ZL)}reflect(e){return this.sub(ZL.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;let i=this.dot(e)/r;return Math.acos(Ji(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let r=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return r*r+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,r,i){let n=Math.sin(r)*e;return this.x=n*Math.sin(i),this.y=Math.cos(r)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,r,i){return this.x=e*Math.sin(r),this.y=i,this.z=e*Math.cos(r),this}setFromMatrixPosition(e){let r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(e){let r=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=r,this.y=i,this.z=n,this}setFromMatrixColumn(e,r){return this.fromArray(e.elements,r*4)}setFromMatrix3Column(e,r){return this.fromArray(e.elements,r*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,r=Math.random()*2-1,i=Math.sqrt(1-r*r);return this.x=i*Math.cos(e),this.y=r,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};s(Sce,"Vector3");var qe=Sce,ZL=new qe,Tq=new ff,Ece=class{constructor(e=new qe(1/0,1/0,1/0),r=new qe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromArray(e){this.makeEmpty();for(let r=0,i=e.length;r<i;r+=3)this.expandByPoint(yh.fromArray(e,r));return this}setFromBufferAttribute(e){this.makeEmpty();for(let r=0,i=e.count;r<i;r++)this.expandByPoint(yh.fromBufferAttribute(e,r));return this}setFromPoints(e){this.makeEmpty();for(let r=0,i=e.length;r<i;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){let i=yh.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,r=!1){return this.makeEmpty(),this.expandByObject(e,r)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,r=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let a=i.getAttribute("position");if(r===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=a.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,yh):yh.fromBufferAttribute(a,o),yh.applyMatrix4(e.matrixWorld),this.expandByPoint(yh);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),zM.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),zM.copy(i.boundingBox)),zM.applyMatrix4(e.matrixWorld),this.union(zM)}let n=e.children;for(let a=0,o=n.length;a<o;a++)this.expandByObject(n[a],r);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,yh),yh.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let r,i;return e.normal.x>0?(r=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(r=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(r+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(r+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(r+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(r+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),r<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Lb),UM.subVectors(this.max,Lb),o0.subVectors(e.a,Lb),s0.subVectors(e.b,Lb),l0.subVectors(e.c,Lb),im.subVectors(s0,o0),nm.subVectors(l0,s0),Rg.subVectors(o0,l0);let r=[0,-im.z,im.y,0,-nm.z,nm.y,0,-Rg.z,Rg.y,im.z,0,-im.x,nm.z,0,-nm.x,Rg.z,0,-Rg.x,-im.y,im.x,0,-nm.y,nm.x,0,-Rg.y,Rg.x,0];return!iC(r,o0,s0,l0,UM)||(r=[1,0,0,0,1,0,0,0,1],!iC(r,o0,s0,l0,UM))?!1:(VM.crossVectors(im,nm),r=[VM.x,VM.y,VM.z],iC(r,o0,s0,l0,UM))}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,yh).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(yh).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Md[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Md[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Md[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Md[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Md[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Md[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Md[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Md[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Md),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};s(Ece,"Box3");var ro=Ece,Md=[new qe,new qe,new qe,new qe,new qe,new qe,new qe,new qe],yh=new qe,zM=new ro,o0=new qe,s0=new qe,l0=new qe,im=new qe,nm=new qe,Rg=new qe,Lb=new qe,UM=new qe,VM=new qe,Og=new qe;function iC(t,e,r,i,n){for(let a=0,o=t.length-3;a<=o;a+=3){Og.fromArray(t,a);let l=n.x*Math.abs(Og.x)+n.y*Math.abs(Og.y)+n.z*Math.abs(Og.z),u=e.dot(Og),c=r.dot(Og),p=i.dot(Og);if(Math.max(-Math.max(u,c,p),Math.min(u,c,p))>l)return!1}return!0}s(iC,"satForAxes");var mVe=new ro,Db=new qe,YL=new qe,Cce=class{constructor(e=new qe,r=-1){this.isSphere=!0,this.center=e,this.radius=r}set(e,r){return this.center.copy(e),this.radius=r,this}setFromPoints(e,r){let i=this.center;r!==void 0?i.copy(r):mVe.setFromPoints(e).getCenter(i);let n=0;for(let a=0,o=e.length;a<o;a++)n=Math.max(n,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let r=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=r*r}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,r){let i=this.center.distanceToSquared(e);return r.copy(e),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Db.subVectors(e,this.center);let r=Db.lengthSq();if(r>this.radius*this.radius){let i=Math.sqrt(r),n=(i-this.radius)*.5;this.center.addScaledVector(Db,n/i),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(YL.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Db.copy(e.center).add(YL)),this.expandByPoint(Db.copy(e.center).sub(YL))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};s(Cce,"Sphere");var Ru=Cce,Ed=new qe,KL=new qe,jM=new qe,am=new qe,JL=new qe,$M=new qe,QL=new qe,Ice=class{constructor(e=new qe,r=new qe(0,0,-1)){this.origin=e,this.direction=r}set(e,r){return this.origin.copy(e),this.direction.copy(r),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,r){return r.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ed)),this}closestPointToPoint(e,r){r.subVectors(e,this.origin);let i=r.dot(this.direction);return i<0?r.copy(this.origin):r.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let r=Ed.subVectors(e,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(e):(Ed.copy(this.origin).addScaledVector(this.direction,r),Ed.distanceToSquared(e))}distanceSqToSegment(e,r,i,n){KL.copy(e).add(r).multiplyScalar(.5),jM.copy(r).sub(e).normalize(),am.copy(this.origin).sub(KL);let a=e.distanceTo(r)*.5,o=-this.direction.dot(jM),l=am.dot(this.direction),u=-am.dot(jM),c=am.lengthSq(),p=Math.abs(1-o*o),m,y,v,w;if(p>0)if(m=o*u-l,y=o*l-u,w=a*p,m>=0)if(y>=-w)if(y<=w){let E=1/p;m*=E,y*=E,v=m*(m+o*y+2*l)+y*(o*m+y+2*u)+c}else y=a,m=Math.max(0,-(o*y+l)),v=-m*m+y*(y+2*u)+c;else y=-a,m=Math.max(0,-(o*y+l)),v=-m*m+y*(y+2*u)+c;else y<=-w?(m=Math.max(0,-(-o*a+l)),y=m>0?-a:Math.min(Math.max(-a,-u),a),v=-m*m+y*(y+2*u)+c):y<=w?(m=0,y=Math.min(Math.max(-a,-u),a),v=y*(y+2*u)+c):(m=Math.max(0,-(o*a+l)),y=m>0?a:Math.min(Math.max(-a,-u),a),v=-m*m+y*(y+2*u)+c);else y=o>0?-a:a,m=Math.max(0,-(o*y+l)),v=-m*m+y*(y+2*u)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,m),n&&n.copy(KL).addScaledVector(jM,y),v}intersectSphere(e,r){Ed.subVectors(e.center,this.origin);let i=Ed.dot(this.direction),n=Ed.dot(Ed)-i*i,a=e.radius*e.radius;if(n>a)return null;let o=Math.sqrt(a-n),l=i-o,u=i+o;return u<0?null:l<0?this.at(u,r):this.at(l,r)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let r=e.normal.dot(this.direction);if(r===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/r;return i>=0?i:null}intersectPlane(e,r){let i=this.distanceToPlane(e);return i===null?null:this.at(i,r)}intersectsPlane(e){let r=e.distanceToPoint(this.origin);return r===0||e.normal.dot(this.direction)*r<0}intersectBox(e,r){let i,n,a,o,l,u,c=1/this.direction.x,p=1/this.direction.y,m=1/this.direction.z,y=this.origin;return c>=0?(i=(e.min.x-y.x)*c,n=(e.max.x-y.x)*c):(i=(e.max.x-y.x)*c,n=(e.min.x-y.x)*c),p>=0?(a=(e.min.y-y.y)*p,o=(e.max.y-y.y)*p):(a=(e.max.y-y.y)*p,o=(e.min.y-y.y)*p),i>o||a>n||((a>i||isNaN(i))&&(i=a),(o<n||isNaN(n))&&(n=o),m>=0?(l=(e.min.z-y.z)*m,u=(e.max.z-y.z)*m):(l=(e.max.z-y.z)*m,u=(e.min.z-y.z)*m),i>u||l>n)||((l>i||i!==i)&&(i=l),(u<n||n!==n)&&(n=u),n<0)?null:this.at(i>=0?i:n,r)}intersectsBox(e){return this.intersectBox(e,Ed)!==null}intersectTriangle(e,r,i,n,a){JL.subVectors(r,e),$M.subVectors(i,e),QL.crossVectors(JL,$M);let o=this.direction.dot(QL),l;if(o>0){if(n)return null;l=1}else if(o<0)l=-1,o=-o;else return null;am.subVectors(this.origin,e);let u=l*this.direction.dot($M.crossVectors(am,$M));if(u<0)return null;let c=l*this.direction.dot(JL.cross(am));if(c<0||u+c>o)return null;let p=-l*am.dot(QL);return p<0?null:this.at(p/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};s(Ice,"Ray");var DA=Ice,Tce=class lO{constructor(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M){lO.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M)}set(e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M){let I=this.elements;return I[0]=e,I[4]=r,I[8]=i,I[12]=n,I[1]=a,I[5]=o,I[9]=l,I[13]=u,I[2]=c,I[6]=p,I[10]=m,I[14]=y,I[3]=v,I[7]=w,I[11]=E,I[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new lO().fromArray(this.elements)}copy(e){let r=this.elements,i=e.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this}copyPosition(e){let r=this.elements,i=e.elements;return r[12]=i[12],r[13]=i[13],r[14]=i[14],this}setFromMatrix3(e){let r=e.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(e,r,i){return e.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,r,i){return this.set(e.x,r.x,i.x,0,e.y,r.y,i.y,0,e.z,r.z,i.z,0,0,0,0,1),this}extractRotation(e){let r=this.elements,i=e.elements,n=1/u0.setFromMatrixColumn(e,0).length(),a=1/u0.setFromMatrixColumn(e,1).length(),o=1/u0.setFromMatrixColumn(e,2).length();return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=0,r[4]=i[4]*a,r[5]=i[5]*a,r[6]=i[6]*a,r[7]=0,r[8]=i[8]*o,r[9]=i[9]*o,r[10]=i[10]*o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(e){let r=this.elements,i=e.x,n=e.y,a=e.z,o=Math.cos(i),l=Math.sin(i),u=Math.cos(n),c=Math.sin(n),p=Math.cos(a),m=Math.sin(a);if(e.order==="XYZ"){let y=o*p,v=o*m,w=l*p,E=l*m;r[0]=u*p,r[4]=-u*m,r[8]=c,r[1]=v+w*c,r[5]=y-E*c,r[9]=-l*u,r[2]=E-y*c,r[6]=w+v*c,r[10]=o*u}else if(e.order==="YXZ"){let y=u*p,v=u*m,w=c*p,E=c*m;r[0]=y+E*l,r[4]=w*l-v,r[8]=o*c,r[1]=o*m,r[5]=o*p,r[9]=-l,r[2]=v*l-w,r[6]=E+y*l,r[10]=o*u}else if(e.order==="ZXY"){let y=u*p,v=u*m,w=c*p,E=c*m;r[0]=y-E*l,r[4]=-o*m,r[8]=w+v*l,r[1]=v+w*l,r[5]=o*p,r[9]=E-y*l,r[2]=-o*c,r[6]=l,r[10]=o*u}else if(e.order==="ZYX"){let y=o*p,v=o*m,w=l*p,E=l*m;r[0]=u*p,r[4]=w*c-v,r[8]=y*c+E,r[1]=u*m,r[5]=E*c+y,r[9]=v*c-w,r[2]=-c,r[6]=l*u,r[10]=o*u}else if(e.order==="YZX"){let y=o*u,v=o*c,w=l*u,E=l*c;r[0]=u*p,r[4]=E-y*m,r[8]=w*m+v,r[1]=m,r[5]=o*p,r[9]=-l*p,r[2]=-c*p,r[6]=v*m+w,r[10]=y-E*m}else if(e.order==="XZY"){let y=o*u,v=o*c,w=l*u,E=l*c;r[0]=u*p,r[4]=-m,r[8]=c*p,r[1]=y*m+E,r[5]=o*p,r[9]=v*m-w,r[2]=w*m-v,r[6]=l*p,r[10]=E*m+y}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gVe,e,yVe)}lookAt(e,r,i){let n=this.elements;return nc.subVectors(e,r),nc.lengthSq()===0&&(nc.z=1),nc.normalize(),om.crossVectors(i,nc),om.lengthSq()===0&&(Math.abs(i.z)===1?nc.x+=1e-4:nc.z+=1e-4,nc.normalize(),om.crossVectors(i,nc)),om.normalize(),GM.crossVectors(nc,om),n[0]=om.x,n[4]=GM.x,n[8]=nc.x,n[1]=om.y,n[5]=GM.y,n[9]=nc.y,n[2]=om.z,n[6]=GM.z,n[10]=nc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){let i=e.elements,n=r.elements,a=this.elements,o=i[0],l=i[4],u=i[8],c=i[12],p=i[1],m=i[5],y=i[9],v=i[13],w=i[2],E=i[6],M=i[10],I=i[14],P=i[3],C=i[7],T=i[11],O=i[15],F=n[0],k=n[4],B=n[8],U=n[12],z=n[1],q=n[5],W=n[9],J=n[13],V=n[2],oe=n[6],Y=n[10],he=n[14],Q=n[3],ae=n[7],ee=n[11],le=n[15];return a[0]=o*F+l*z+u*V+c*Q,a[4]=o*k+l*q+u*oe+c*ae,a[8]=o*B+l*W+u*Y+c*ee,a[12]=o*U+l*J+u*he+c*le,a[1]=p*F+m*z+y*V+v*Q,a[5]=p*k+m*q+y*oe+v*ae,a[9]=p*B+m*W+y*Y+v*ee,a[13]=p*U+m*J+y*he+v*le,a[2]=w*F+E*z+M*V+I*Q,a[6]=w*k+E*q+M*oe+I*ae,a[10]=w*B+E*W+M*Y+I*ee,a[14]=w*U+E*J+M*he+I*le,a[3]=P*F+C*z+T*V+O*Q,a[7]=P*k+C*q+T*oe+O*ae,a[11]=P*B+C*W+T*Y+O*ee,a[15]=P*U+C*J+T*he+O*le,this}multiplyScalar(e){let r=this.elements;return r[0]*=e,r[4]*=e,r[8]*=e,r[12]*=e,r[1]*=e,r[5]*=e,r[9]*=e,r[13]*=e,r[2]*=e,r[6]*=e,r[10]*=e,r[14]*=e,r[3]*=e,r[7]*=e,r[11]*=e,r[15]*=e,this}determinant(){let e=this.elements,r=e[0],i=e[4],n=e[8],a=e[12],o=e[1],l=e[5],u=e[9],c=e[13],p=e[2],m=e[6],y=e[10],v=e[14],w=e[3],E=e[7],M=e[11],I=e[15];return w*(+a*u*m-n*c*m-a*l*y+i*c*y+n*l*v-i*u*v)+E*(+r*u*v-r*c*y+a*o*y-n*o*v+n*c*p-a*u*p)+M*(+r*c*m-r*l*v-a*o*m+i*o*v+a*l*p-i*c*p)+I*(-n*l*p-r*u*m+r*l*y+n*o*m-i*o*y+i*u*p)}transpose(){let e=this.elements,r;return r=e[1],e[1]=e[4],e[4]=r,r=e[2],e[2]=e[8],e[8]=r,r=e[6],e[6]=e[9],e[9]=r,r=e[3],e[3]=e[12],e[12]=r,r=e[7],e[7]=e[13],e[13]=r,r=e[11],e[11]=e[14],e[14]=r,this}setPosition(e,r,i){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=r,n[14]=i),this}invert(){let e=this.elements,r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],w=e[12],E=e[13],M=e[14],I=e[15],P=m*M*c-E*y*c+E*u*v-l*M*v-m*u*I+l*y*I,C=w*y*c-p*M*c-w*u*v+o*M*v+p*u*I-o*y*I,T=p*E*c-w*m*c+w*l*v-o*E*v-p*l*I+o*m*I,O=w*m*u-p*E*u-w*l*y+o*E*y+p*l*M-o*m*M,F=r*P+i*C+n*T+a*O;if(F===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let k=1/F;return e[0]=P*k,e[1]=(E*y*a-m*M*a-E*n*v+i*M*v+m*n*I-i*y*I)*k,e[2]=(l*M*a-E*u*a+E*n*c-i*M*c-l*n*I+i*u*I)*k,e[3]=(m*u*a-l*y*a-m*n*c+i*y*c+l*n*v-i*u*v)*k,e[4]=C*k,e[5]=(p*M*a-w*y*a+w*n*v-r*M*v-p*n*I+r*y*I)*k,e[6]=(w*u*a-o*M*a-w*n*c+r*M*c+o*n*I-r*u*I)*k,e[7]=(o*y*a-p*u*a+p*n*c-r*y*c-o*n*v+r*u*v)*k,e[8]=T*k,e[9]=(w*m*a-p*E*a-w*i*v+r*E*v+p*i*I-r*m*I)*k,e[10]=(o*E*a-w*l*a+w*i*c-r*E*c-o*i*I+r*l*I)*k,e[11]=(p*l*a-o*m*a-p*i*c+r*m*c+o*i*v-r*l*v)*k,e[12]=O*k,e[13]=(p*E*n-w*m*n+w*i*y-r*E*y-p*i*M+r*m*M)*k,e[14]=(w*l*n-o*E*n-w*i*u+r*E*u+o*i*M-r*l*M)*k,e[15]=(o*m*n-p*l*n+p*i*u-r*m*u-o*i*y+r*l*y)*k,this}scale(e){let r=this.elements,i=e.x,n=e.y,a=e.z;return r[0]*=i,r[4]*=n,r[8]*=a,r[1]*=i,r[5]*=n,r[9]*=a,r[2]*=i,r[6]*=n,r[10]*=a,r[3]*=i,r[7]*=n,r[11]*=a,this}getMaxScaleOnAxis(){let e=this.elements,r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(r,i,n))}makeTranslation(e,r,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,r,0,0,1,i,0,0,0,1),this}makeRotationX(e){let r=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1),this}makeRotationY(e){let r=Math.cos(e),i=Math.sin(e);return this.set(r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1),this}makeRotationZ(e){let r=Math.cos(e),i=Math.sin(e);return this.set(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,r){let i=Math.cos(r),n=Math.sin(r),a=1-i,o=e.x,l=e.y,u=e.z,c=a*o,p=a*l;return this.set(c*o+i,c*l-n*u,c*u+n*l,0,c*l+n*u,p*l+i,p*u-n*o,0,c*u-n*l,p*u+n*o,a*u*u+i,0,0,0,0,1),this}makeScale(e,r,i){return this.set(e,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,r,i,n,a,o){return this.set(1,i,a,0,e,1,o,0,r,n,1,0,0,0,0,1),this}compose(e,r,i){let n=this.elements,a=r._x,o=r._y,l=r._z,u=r._w,c=a+a,p=o+o,m=l+l,y=a*c,v=a*p,w=a*m,E=o*p,M=o*m,I=l*m,P=u*c,C=u*p,T=u*m,O=i.x,F=i.y,k=i.z;return n[0]=(1-(E+I))*O,n[1]=(v+T)*O,n[2]=(w-C)*O,n[3]=0,n[4]=(v-T)*F,n[5]=(1-(y+I))*F,n[6]=(M+P)*F,n[7]=0,n[8]=(w+C)*k,n[9]=(M-P)*k,n[10]=(1-(y+E))*k,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,r,i){let n=this.elements,a=u0.set(n[0],n[1],n[2]).length(),o=u0.set(n[4],n[5],n[6]).length(),l=u0.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],vh.copy(this);let u=1/a,c=1/o,p=1/l;return vh.elements[0]*=u,vh.elements[1]*=u,vh.elements[2]*=u,vh.elements[4]*=c,vh.elements[5]*=c,vh.elements[6]*=c,vh.elements[8]*=p,vh.elements[9]*=p,vh.elements[10]*=p,r.setFromRotationMatrix(vh),i.x=a,i.y=o,i.z=l,this}makePerspective(e,r,i,n,a,o,l=sf){let u=this.elements,c=2*a/(r-e),p=2*a/(i-n),m=(r+e)/(r-e),y=(i+n)/(i-n),v,w;if(l===sf)v=-(o+a)/(o-a),w=-2*o*a/(o-a);else if(l===V3)v=-o/(o-a),w=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=c,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=p,u[9]=y,u[13]=0,u[2]=0,u[6]=0,u[10]=v,u[14]=w,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,r,i,n,a,o,l=sf){let u=this.elements,c=1/(r-e),p=1/(i-n),m=1/(o-a),y=(r+e)*c,v=(i+n)*p,w,E;if(l===sf)w=(o+a)*m,E=-2*m;else if(l===V3)w=a*m,E=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=2*c,u[4]=0,u[8]=0,u[12]=-y,u[1]=0,u[5]=2*p,u[9]=0,u[13]=-v,u[2]=0,u[6]=0,u[10]=E,u[14]=-w,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){let r=this.elements,i=e.elements;for(let n=0;n<16;n++)if(r[n]!==i[n])return!1;return!0}fromArray(e,r=0){for(let i=0;i<16;i++)this.elements[i]=e[i+r];return this}toArray(e=[],r=0){let i=this.elements;return e[r]=i[0],e[r+1]=i[1],e[r+2]=i[2],e[r+3]=i[3],e[r+4]=i[4],e[r+5]=i[5],e[r+6]=i[6],e[r+7]=i[7],e[r+8]=i[8],e[r+9]=i[9],e[r+10]=i[10],e[r+11]=i[11],e[r+12]=i[12],e[r+13]=i[13],e[r+14]=i[14],e[r+15]=i[15],e}};s(Tce,"Matrix4");var Oi=Tce,u0=new qe,vh=new Oi,gVe=new qe(0,0,0),yVe=new qe(1,1,1),om=new qe,GM=new qe,nc=new qe,Pq=new Oi,Lq=new ff,Pce=class Lce{constructor(e=0,r=0,i=0,n=Lce.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=r,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,r,i,n=this._order){return this._x=e,this._y=r,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,r=this._order,i=!0){let n=e.elements,a=n[0],o=n[4],l=n[8],u=n[1],c=n[5],p=n[9],m=n[2],y=n[6],v=n[10];switch(r){case"XYZ":this._y=Math.asin(Ji(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-p,v),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(y,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Ji(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(l,v),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-m,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ji(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-m,v),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-Ji(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(y,v),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Ji(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,c),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(l,v));break;case"XZY":this._z=Math.asin(-Ji(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(y,c),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-p,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,r,i){return Pq.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Pq,r,i)}setFromVector3(e,r=this._order){return this.set(e.x,e.y,e.z,r)}reorder(e){return Lq.setFromEuler(this),this.setFromQuaternion(Lq,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};s(Pce,"Euler");var Nu=Pce;Nu.DEFAULT_ORDER="XYZ";var Dce=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}};s(Dce,"Layers");var vB=Dce,vVe=0,Dq=new qe,c0=new ff,Cd=new Oi,HM=new qe,Rb=new qe,_Ve=new qe,xVe=new ff,Rq=new qe(1,0,0),Oq=new qe(0,1,0),kq=new qe(0,0,1),Nq={type:"added"},bVe={type:"removed"},h0={type:"childadded",child:null},e6={type:"childremoved",child:null},Rce=class nC extends ox{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vVe++}),this.uuid=xc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=nC.DEFAULT_UP.clone();let e=new qe,r=new Nu,i=new ff,n=new qe(1,1,1);function a(){i.setFromEuler(r,!1)}s(a,"onRotationChange");function o(){r.setFromQuaternion(i,void 0,!1)}s(o,"onQuaternionChange"),r._onChange(a),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Oi},normalMatrix:{value:new nn}}),this.matrix=new Oi,this.matrixWorld=new Oi,this.matrixAutoUpdate=nC.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=nC.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new vB,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,r){this.quaternion.setFromAxisAngle(e,r)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,r){return c0.setFromAxisAngle(e,r),this.quaternion.multiply(c0),this}rotateOnWorldAxis(e,r){return c0.setFromAxisAngle(e,r),this.quaternion.premultiply(c0),this}rotateX(e){return this.rotateOnAxis(Rq,e)}rotateY(e){return this.rotateOnAxis(Oq,e)}rotateZ(e){return this.rotateOnAxis(kq,e)}translateOnAxis(e,r){return Dq.copy(e).applyQuaternion(this.quaternion),this.position.add(Dq.multiplyScalar(r)),this}translateX(e){return this.translateOnAxis(Rq,e)}translateY(e){return this.translateOnAxis(Oq,e)}translateZ(e){return this.translateOnAxis(kq,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Cd.copy(this.matrixWorld).invert())}lookAt(e,r,i){e.isVector3?HM.copy(e):HM.set(e,r,i);let n=this.parent;this.updateWorldMatrix(!0,!1),Rb.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Cd.lookAt(Rb,HM,this.up):Cd.lookAt(HM,Rb,this.up),this.quaternion.setFromRotationMatrix(Cd),n&&(Cd.extractRotation(n.matrixWorld),c0.setFromRotationMatrix(Cd),this.quaternion.premultiply(c0.invert()))}add(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Nq),h0.child=e,this.dispatchEvent(h0),h0.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let r=this.children.indexOf(e);return r!==-1&&(e.parent=null,this.children.splice(r,1),e.dispatchEvent(bVe),e6.child=e,this.dispatchEvent(e6),e6.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Cd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Cd.multiply(e.parent.matrixWorld)),e.applyMatrix4(Cd),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Nq),h0.child=e,this.dispatchEvent(h0),h0.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,r){if(this[e]===r)return this;for(let i=0,n=this.children.length;i<n;i++){let a=this.children[i].getObjectByProperty(e,r);if(a!==void 0)return a}}getObjectsByProperty(e,r,i=[]){this[e]===r&&i.push(this);let n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].getObjectsByProperty(e,r,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rb,e,_Ve),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rb,xVe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let r=this.matrixWorld.elements;return e.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(e){e(this);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].traverseVisible(e)}traverseAncestors(e){let r=this.parent;r!==null&&(e(r),r.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].updateMatrixWorld(e)}updateWorldMatrix(e,r){let i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),r===!0){let n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].updateWorldMatrix(!1,!0)}}toJSON(e){let r=e===void 0||typeof e=="string",i={};r&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(n.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(e)),u.uuid}if(s(a,"serialize"),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);let l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){let u=l.shapes;if(Array.isArray(u))for(let c=0,p=u.length;c<p;c++){let m=u[c];a(e.shapes,m)}else a(e.shapes,u)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let l=[];for(let u=0,c=this.material.length;u<c;u++)l.push(a(e.materials,this.material[u]));n.material=l}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let l=0;l<this.children.length;l++)n.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let l=0;l<this.animations.length;l++){let u=this.animations[l];n.animations.push(a(e.animations,u))}}if(r){let l=o(e.geometries),u=o(e.materials),c=o(e.textures),p=o(e.images),m=o(e.shapes),y=o(e.skeletons),v=o(e.animations),w=o(e.nodes);l.length>0&&(i.geometries=l),u.length>0&&(i.materials=u),c.length>0&&(i.textures=c),p.length>0&&(i.images=p),m.length>0&&(i.shapes=m),y.length>0&&(i.skeletons=y),v.length>0&&(i.animations=v),w.length>0&&(i.nodes=w)}return i.object=n,i;function o(l){let u=[];for(let c in l){let p=l[c];delete p.metadata,u.push(p)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,r=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),r===!0)for(let i=0;i<e.children.length;i++){let n=e.children[i];this.add(n.clone())}return this}};s(Rce,"Object3D");var qa=Rce;qa.DEFAULT_UP=new qe(0,1,0);qa.DEFAULT_MATRIX_AUTO_UPDATE=!0;qa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var _h=new qe,Id=new qe,t6=new qe,Td=new qe,p0=new qe,d0=new qe,Fq=new qe,r6=new qe,i6=new qe,n6=new qe,a6=new Qn,o6=new Qn,s6=new Qn,Oce=class P0{constructor(e=new qe,r=new qe,i=new qe){this.a=e,this.b=r,this.c=i}static getNormal(e,r,i,n){n.subVectors(i,r),_h.subVectors(e,r),n.cross(_h);let a=n.lengthSq();return a>0?n.multiplyScalar(1/Math.sqrt(a)):n.set(0,0,0)}static getBarycoord(e,r,i,n,a){_h.subVectors(n,r),Id.subVectors(i,r),t6.subVectors(e,r);let o=_h.dot(_h),l=_h.dot(Id),u=_h.dot(t6),c=Id.dot(Id),p=Id.dot(t6),m=o*c-l*l;if(m===0)return a.set(0,0,0),null;let y=1/m,v=(c*u-l*p)*y,w=(o*p-l*u)*y;return a.set(1-v-w,w,v)}static containsPoint(e,r,i,n){return this.getBarycoord(e,r,i,n,Td)===null?!1:Td.x>=0&&Td.y>=0&&Td.x+Td.y<=1}static getInterpolation(e,r,i,n,a,o,l,u){return this.getBarycoord(e,r,i,n,Td)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(a,Td.x),u.addScaledVector(o,Td.y),u.addScaledVector(l,Td.z),u)}static getInterpolatedAttribute(e,r,i,n,a,o){return a6.setScalar(0),o6.setScalar(0),s6.setScalar(0),a6.fromBufferAttribute(e,r),o6.fromBufferAttribute(e,i),s6.fromBufferAttribute(e,n),o.setScalar(0),o.addScaledVector(a6,a.x),o.addScaledVector(o6,a.y),o.addScaledVector(s6,a.z),o}static isFrontFacing(e,r,i,n){return _h.subVectors(i,r),Id.subVectors(e,r),_h.cross(Id).dot(n)<0}set(e,r,i){return this.a.copy(e),this.b.copy(r),this.c.copy(i),this}setFromPointsAndIndices(e,r,i,n){return this.a.copy(e[r]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,r,i,n){return this.a.fromBufferAttribute(e,r),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _h.subVectors(this.c,this.b),Id.subVectors(this.a,this.b),_h.cross(Id).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return P0.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,r){return P0.getBarycoord(e,this.a,this.b,this.c,r)}getInterpolation(e,r,i,n,a){return P0.getInterpolation(e,this.a,this.b,this.c,r,i,n,a)}containsPoint(e){return P0.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return P0.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,r){let i=this.a,n=this.b,a=this.c,o,l;p0.subVectors(n,i),d0.subVectors(a,i),r6.subVectors(e,i);let u=p0.dot(r6),c=d0.dot(r6);if(u<=0&&c<=0)return r.copy(i);i6.subVectors(e,n);let p=p0.dot(i6),m=d0.dot(i6);if(p>=0&&m<=p)return r.copy(n);let y=u*m-p*c;if(y<=0&&u>=0&&p<=0)return o=u/(u-p),r.copy(i).addScaledVector(p0,o);n6.subVectors(e,a);let v=p0.dot(n6),w=d0.dot(n6);if(w>=0&&v<=w)return r.copy(a);let E=v*c-u*w;if(E<=0&&c>=0&&w<=0)return l=c/(c-w),r.copy(i).addScaledVector(d0,l);let M=p*w-v*m;if(M<=0&&m-p>=0&&v-w>=0)return Fq.subVectors(a,n),l=(m-p)/(m-p+(v-w)),r.copy(n).addScaledVector(Fq,l);let I=1/(M+E+y);return o=E*I,l=y*I,r.copy(i).addScaledVector(p0,o).addScaledVector(d0,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};s(Oce,"Triangle");var L0=Oce,kce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},sm={h:0,s:0,l:0},qM={h:0,s:0,l:0};function aC(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*6*(2/3-r):t}s(aC,"hue2rgb");var Nce=class{constructor(e,r,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,r,i)}set(e,r,i){if(r===void 0&&i===void 0){let n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,r,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,r=nl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Rn.toWorkingColorSpace(this,r),this}setRGB(e,r,i,n=Rn.workingColorSpace){return this.r=e,this.g=r,this.b=i,Rn.toWorkingColorSpace(this,n),this}setHSL(e,r,i,n=Rn.workingColorSpace){if(e=kP(e,1),r=Ji(r,0,1),i=Ji(i,0,1),r===0)this.r=this.g=this.b=i;else{let a=i<=.5?i*(1+r):i+r-i*r,o=2*i-a;this.r=aC(o,a,e+1/3),this.g=aC(o,a,e),this.b=aC(o,a,e-1/3)}return Rn.toWorkingColorSpace(this,n),this}setStyle(e,r=nl){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}s(i,"handleAlpha");let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a,o=n[1],l=n[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,r);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,r);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let a=n[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,r);if(o===6)return this.setHex(parseInt(a,16),r);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,r);return this}setColorName(e,r=nl){let i=kce[e.toLowerCase()];return i!==void 0?this.setHex(i,r):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Xp(e.r),this.g=Xp(e.g),this.b=Xp(e.b),this}copyLinearToSRGB(e){return this.r=Ny(e.r),this.g=Ny(e.g),this.b=Ny(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=nl){return Rn.fromWorkingColorSpace(bl.copy(this),e),Math.round(Ji(bl.r*255,0,255))*65536+Math.round(Ji(bl.g*255,0,255))*256+Math.round(Ji(bl.b*255,0,255))}getHexString(e=nl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,r=Rn.workingColorSpace){Rn.fromWorkingColorSpace(bl.copy(this),r);let i=bl.r,n=bl.g,a=bl.b,o=Math.max(i,n,a),l=Math.min(i,n,a),u,c,p=(l+o)/2;if(l===o)u=0,c=0;else{let m=o-l;switch(c=p<=.5?m/(o+l):m/(2-o-l),o){case i:u=(n-a)/m+(n<a?6:0);break;case n:u=(a-i)/m+2;break;case a:u=(i-n)/m+4;break}u/=6}return e.h=u,e.s=c,e.l=p,e}getRGB(e,r=Rn.workingColorSpace){return Rn.fromWorkingColorSpace(bl.copy(this),r),e.r=bl.r,e.g=bl.g,e.b=bl.b,e}getStyle(e=nl){Rn.fromWorkingColorSpace(bl.copy(this),e);let r=bl.r,i=bl.g,n=bl.b;return e!==nl?"color(".concat(e," ").concat(r.toFixed(3)," ").concat(i.toFixed(3)," ").concat(n.toFixed(3),")"):"rgb(".concat(Math.round(r*255),",").concat(Math.round(i*255),",").concat(Math.round(n*255),")")}offsetHSL(e,r,i){return this.getHSL(sm),this.setHSL(sm.h+e,sm.s+r,sm.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,r){return this.r=e.r+r.r,this.g=e.g+r.g,this.b=e.b+r.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,r){return this.r+=(e.r-this.r)*r,this.g+=(e.g-this.g)*r,this.b+=(e.b-this.b)*r,this}lerpColors(e,r,i){return this.r=e.r+(r.r-e.r)*i,this.g=e.g+(r.g-e.g)*i,this.b=e.b+(r.b-e.b)*i,this}lerpHSL(e,r){this.getHSL(sm),e.getHSL(qM);let i=a_(sm.h,qM.h,r),n=a_(sm.s,qM.s,r),a=a_(sm.l,qM.l,r);return this.setHSL(i,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let r=this.r,i=this.g,n=this.b,a=e.elements;return this.r=a[0]*r+a[3]*i+a[6]*n,this.g=a[1]*r+a[4]*i+a[7]*n,this.b=a[2]*r+a[5]*i+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,r=0){return this.r=e[r],this.g=e[r+1],this.b=e[r+2],this}toArray(e=[],r=0){return e[r]=this.r,e[r+1]=this.g,e[r+2]=this.b,e}fromBufferAttribute(e,r){return this.r=e.getX(r),this.g=e.getY(r),this.b=e.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};s(Nce,"Color");var si=Nce,bl=new si;si.NAMES=kce;var wVe=0,Fce=class extends ox{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:wVe++}),this.uuid=xc(),this.name="",this.type="Material",this.blending=r_,this.side=Qp,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=bR,this.blendDst=wR,this.blendEquation=dy,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new si(0,0,0),this.blendAlpha=0,this.depthFunc=A_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=aO,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Jd,this.stencilZFail=Jd,this.stencilZPass=Jd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let r in e){let i=e[r];if(i===void 0){console.warn("THREE.Material: parameter '".concat(r,"' has value of undefined."));continue}let n=this[r];if(n===void 0){console.warn("THREE.Material: '".concat(r,"' is not a property of THREE.").concat(this.type,"."));continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[r]=i}}toJSON(e){let r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==r_&&(i.blending=this.blending),this.side!==Qp&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==bR&&(i.blendSrc=this.blendSrc),this.blendDst!==wR&&(i.blendDst=this.blendDst),this.blendEquation!==dy&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==A_&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==aO&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Jd&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Jd&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Jd&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(a){let o=[];for(let l in a){let u=a[l];delete u.metadata,o.push(u)}return o}if(s(n,"extractFromCache"),r){let a=n(e.textures),o=n(e.images);a.length>0&&(i.textures=a),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let r=e.clippingPlanes,i=null;if(r!==null){let n=r.length;i=new Array(n);for(let a=0;a!==n;++a)i[a]=r[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}};s(Fce,"Material");var lg=Fce,Bce=class extends lg{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new si(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nu,this.combine=uB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};s(Bce,"MeshBasicMaterial");var ug=Bce,ss=new qe,WM=new Jt,AVe=0,zce=class{constructor(e,r,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:AVe++}),this.name="",this.array=e,this.itemSize=r,this.count=e!==void 0?e.length/r:0,this.normalized=i,this.usage=oO,this.updateRanges=[],this.gpuType=Lu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,r){this.updateRanges.push({start:e,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,r,i){e*=this.itemSize,i*=r.itemSize;for(let n=0,a=this.itemSize;n<a;n++)this.array[e+n]=r.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let r=0,i=this.count;r<i;r++)WM.fromBufferAttribute(this,r),WM.applyMatrix3(e),this.setXY(r,WM.x,WM.y);else if(this.itemSize===3)for(let r=0,i=this.count;r<i;r++)ss.fromBufferAttribute(this,r),ss.applyMatrix3(e),this.setXYZ(r,ss.x,ss.y,ss.z);return this}applyMatrix4(e){for(let r=0,i=this.count;r<i;r++)ss.fromBufferAttribute(this,r),ss.applyMatrix4(e),this.setXYZ(r,ss.x,ss.y,ss.z);return this}applyNormalMatrix(e){for(let r=0,i=this.count;r<i;r++)ss.fromBufferAttribute(this,r),ss.applyNormalMatrix(e),this.setXYZ(r,ss.x,ss.y,ss.z);return this}transformDirection(e){for(let r=0,i=this.count;r<i;r++)ss.fromBufferAttribute(this,r),ss.transformDirection(e),this.setXYZ(r,ss.x,ss.y,ss.z);return this}set(e,r=0){return this.array.set(e,r),this}getComponent(e,r){let i=this.array[e*this.itemSize+r];return this.normalized&&(i=Qc(i,this.array)),i}setComponent(e,r,i){return this.normalized&&(i=Yn(i,this.array)),this.array[e*this.itemSize+r]=i,this}getX(e){let r=this.array[e*this.itemSize];return this.normalized&&(r=Qc(r,this.array)),r}setX(e,r){return this.normalized&&(r=Yn(r,this.array)),this.array[e*this.itemSize]=r,this}getY(e){let r=this.array[e*this.itemSize+1];return this.normalized&&(r=Qc(r,this.array)),r}setY(e,r){return this.normalized&&(r=Yn(r,this.array)),this.array[e*this.itemSize+1]=r,this}getZ(e){let r=this.array[e*this.itemSize+2];return this.normalized&&(r=Qc(r,this.array)),r}setZ(e,r){return this.normalized&&(r=Yn(r,this.array)),this.array[e*this.itemSize+2]=r,this}getW(e){let r=this.array[e*this.itemSize+3];return this.normalized&&(r=Qc(r,this.array)),r}setW(e,r){return this.normalized&&(r=Yn(r,this.array)),this.array[e*this.itemSize+3]=r,this}setXY(e,r,i){return e*=this.itemSize,this.normalized&&(r=Yn(r,this.array),i=Yn(i,this.array)),this.array[e+0]=r,this.array[e+1]=i,this}setXYZ(e,r,i,n){return e*=this.itemSize,this.normalized&&(r=Yn(r,this.array),i=Yn(i,this.array),n=Yn(n,this.array)),this.array[e+0]=r,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,r,i,n,a){return e*=this.itemSize,this.normalized&&(r=Yn(r,this.array),i=Yn(i,this.array),n=Yn(n,this.array),a=Yn(a,this.array)),this.array[e+0]=r,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==oO&&(e.usage=this.usage),e}};s(zce,"BufferAttribute");var Yo=zce,Uce=class extends Yo{constructor(e,r,i){super(new Uint16Array(e),r,i)}};s(Uce,"Uint16BufferAttribute");var Vce=Uce,jce=class extends Yo{constructor(e,r,i){super(new Uint32Array(e),r,i)}};s(jce,"Uint32BufferAttribute");var $ce=jce,Gce=class extends Yo{constructor(e,r,i){super(new Float32Array(e),r,i)}};s(Gce,"Float32BufferAttribute");var yo=Gce,SVe=0,jc=new Oi,l6=new qa,f0=new qe,ac=new ro,Ob=new ro,Fs=new qe,Hce=class qce extends ox{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:SVe++}),this.uuid=xc(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(yB(e)?$ce:Vce)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,r){return this.attributes[e]=r,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,r,i=0){this.groups.push({start:e,count:r,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,r){this.drawRange.start=e,this.drawRange.count=r}applyMatrix4(e){let r=this.attributes.position;r!==void 0&&(r.applyMatrix4(e),r.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let a=new nn().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return jc.makeRotationFromQuaternion(e),this.applyMatrix4(jc),this}rotateX(e){return jc.makeRotationX(e),this.applyMatrix4(jc),this}rotateY(e){return jc.makeRotationY(e),this.applyMatrix4(jc),this}rotateZ(e){return jc.makeRotationZ(e),this.applyMatrix4(jc),this}translate(e,r,i){return jc.makeTranslation(e,r,i),this.applyMatrix4(jc),this}scale(e,r,i){return jc.makeScale(e,r,i),this.applyMatrix4(jc),this}lookAt(e){return l6.lookAt(e),l6.updateMatrix(),this.applyMatrix4(l6.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(f0).negate(),this.translate(f0.x,f0.y,f0.z),this}setFromPoints(e){let r=this.getAttribute("position");if(r===void 0){let i=[];for(let n=0,a=e.length;n<a;n++){let o=e[n];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new yo(i,3))}else{let i=Math.min(e.length,r.count);for(let n=0;n<i;n++){let a=e[n];r.setXYZ(n,a.x,a.y,a.z||0)}e.length>r.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),r.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ro);let e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new qe(-1/0,-1/0,-1/0),new qe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),r)for(let i=0,n=r.length;i<n;i++){let a=r[i];ac.setFromBufferAttribute(a),this.morphTargetsRelative?(Fs.addVectors(this.boundingBox.min,ac.min),this.boundingBox.expandByPoint(Fs),Fs.addVectors(this.boundingBox.max,ac.max),this.boundingBox.expandByPoint(Fs)):(this.boundingBox.expandByPoint(ac.min),this.boundingBox.expandByPoint(ac.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ru);let e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new qe,1/0);return}if(e){let i=this.boundingSphere.center;if(ac.setFromBufferAttribute(e),r)for(let a=0,o=r.length;a<o;a++){let l=r[a];Ob.setFromBufferAttribute(l),this.morphTargetsRelative?(Fs.addVectors(ac.min,Ob.min),ac.expandByPoint(Fs),Fs.addVectors(ac.max,Ob.max),ac.expandByPoint(Fs)):(ac.expandByPoint(Ob.min),ac.expandByPoint(Ob.max))}ac.getCenter(i);let n=0;for(let a=0,o=e.count;a<o;a++)Fs.fromBufferAttribute(e,a),n=Math.max(n,i.distanceToSquared(Fs));if(r)for(let a=0,o=r.length;a<o;a++){let l=r[a],u=this.morphTargetsRelative;for(let c=0,p=l.count;c<p;c++)Fs.fromBufferAttribute(l,c),u&&(f0.fromBufferAttribute(e,c),Fs.add(f0)),n=Math.max(n,i.distanceToSquared(Fs))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,r=this.attributes;if(e===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=r.position,n=r.normal,a=r.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Yo(new Float32Array(4*i.count),4));let o=this.getAttribute("tangent"),l=[],u=[];for(let B=0;B<i.count;B++)l[B]=new qe,u[B]=new qe;let c=new qe,p=new qe,m=new qe,y=new Jt,v=new Jt,w=new Jt,E=new qe,M=new qe;function I(B,U,z){c.fromBufferAttribute(i,B),p.fromBufferAttribute(i,U),m.fromBufferAttribute(i,z),y.fromBufferAttribute(a,B),v.fromBufferAttribute(a,U),w.fromBufferAttribute(a,z),p.sub(c),m.sub(c),v.sub(y),w.sub(y);let q=1/(v.x*w.y-w.x*v.y);isFinite(q)&&(E.copy(p).multiplyScalar(w.y).addScaledVector(m,-v.y).multiplyScalar(q),M.copy(m).multiplyScalar(v.x).addScaledVector(p,-w.x).multiplyScalar(q),l[B].add(E),l[U].add(E),l[z].add(E),u[B].add(M),u[U].add(M),u[z].add(M))}s(I,"handleTriangle");let P=this.groups;P.length===0&&(P=[{start:0,count:e.count}]);for(let B=0,U=P.length;B<U;++B){let z=P[B],q=z.start,W=z.count;for(let J=q,V=q+W;J<V;J+=3)I(e.getX(J+0),e.getX(J+1),e.getX(J+2))}let C=new qe,T=new qe,O=new qe,F=new qe;function k(B){O.fromBufferAttribute(n,B),F.copy(O);let U=l[B];C.copy(U),C.sub(O.multiplyScalar(O.dot(U))).normalize(),T.crossVectors(F,U);let z=T.dot(u[B])<0?-1:1;o.setXYZW(B,C.x,C.y,C.z,z)}s(k,"handleVertex");for(let B=0,U=P.length;B<U;++B){let z=P[B],q=z.start,W=z.count;for(let J=q,V=q+W;J<V;J+=3)k(e.getX(J+0)),k(e.getX(J+1)),k(e.getX(J+2))}}computeVertexNormals(){let e=this.index,r=this.getAttribute("position");if(r!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Yo(new Float32Array(r.count*3),3),this.setAttribute("normal",i);else for(let y=0,v=i.count;y<v;y++)i.setXYZ(y,0,0,0);let n=new qe,a=new qe,o=new qe,l=new qe,u=new qe,c=new qe,p=new qe,m=new qe;if(e)for(let y=0,v=e.count;y<v;y+=3){let w=e.getX(y+0),E=e.getX(y+1),M=e.getX(y+2);n.fromBufferAttribute(r,w),a.fromBufferAttribute(r,E),o.fromBufferAttribute(r,M),p.subVectors(o,a),m.subVectors(n,a),p.cross(m),l.fromBufferAttribute(i,w),u.fromBufferAttribute(i,E),c.fromBufferAttribute(i,M),l.add(p),u.add(p),c.add(p),i.setXYZ(w,l.x,l.y,l.z),i.setXYZ(E,u.x,u.y,u.z),i.setXYZ(M,c.x,c.y,c.z)}else for(let y=0,v=r.count;y<v;y+=3)n.fromBufferAttribute(r,y+0),a.fromBufferAttribute(r,y+1),o.fromBufferAttribute(r,y+2),p.subVectors(o,a),m.subVectors(n,a),p.cross(m),i.setXYZ(y+0,p.x,p.y,p.z),i.setXYZ(y+1,p.x,p.y,p.z),i.setXYZ(y+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let r=0,i=e.count;r<i;r++)Fs.fromBufferAttribute(e,r),Fs.normalize(),e.setXYZ(r,Fs.x,Fs.y,Fs.z)}toNonIndexed(){function e(l,u){let c=l.array,p=l.itemSize,m=l.normalized,y=new c.constructor(u.length*p),v=0,w=0;for(let E=0,M=u.length;E<M;E++){l.isInterleavedBufferAttribute?v=u[E]*l.data.stride+l.offset:v=u[E]*p;for(let I=0;I<p;I++)y[w++]=c[v++]}return new Yo(y,p,m)}if(s(e,"convertBufferAttribute"),this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let r=new qce,i=this.index.array,n=this.attributes;for(let l in n){let u=n[l],c=e(u,i);r.setAttribute(l,c)}let a=this.morphAttributes;for(let l in a){let u=[],c=a[l];for(let p=0,m=c.length;p<m;p++){let y=c[p],v=e(y,i);u.push(v)}r.morphAttributes[l]=u}r.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let l=0,u=o.length;l<u;l++){let c=o[l];r.addGroup(c.start,c.count,c.materialIndex)}return r}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let u=this.parameters;for(let c in u)u[c]!==void 0&&(e[c]=u[c]);return e}e.data={attributes:{}};let r=this.index;r!==null&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});let i=this.attributes;for(let u in i){let c=i[u];e.data.attributes[u]=c.toJSON(e.data)}let n={},a=!1;for(let u in this.morphAttributes){let c=this.morphAttributes[u],p=[];for(let m=0,y=c.length;m<y;m++){let v=c[m];p.push(v.toJSON(e.data))}p.length>0&&(n[u]=p,a=!0)}a&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let r={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(r));let n=e.attributes;for(let c in n){let p=n[c];this.setAttribute(c,p.clone(r))}let a=e.morphAttributes;for(let c in a){let p=[],m=a[c];for(let y=0,v=m.length;y<v;y++)p.push(m[y].clone(r));this.morphAttributes[c]=p}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,p=o.length;c<p;c++){let m=o[c];this.addGroup(m.start,m.count,m.materialIndex)}let l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};s(Hce,"BufferGeometry");var js=Hce,Bq=new Oi,kg=new DA,XM=new Ru,zq=new qe,ZM=new qe,YM=new qe,KM=new qe,u6=new qe,JM=new qe,Uq=new qe,QM=new qe,Wce=class extends qa{constructor(e=new js,r=new ug){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=i.length;n<a;n++){let o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}getVertexPosition(e,r){let i=this.geometry,n=i.attributes.position,a=i.morphAttributes.position,o=i.morphTargetsRelative;r.fromBufferAttribute(n,e);let l=this.morphTargetInfluences;if(a&&l){JM.set(0,0,0);for(let u=0,c=a.length;u<c;u++){let p=l[u],m=a[u];p!==0&&(u6.fromBufferAttribute(m,e),o?JM.addScaledVector(u6,p):JM.addScaledVector(u6.sub(r),p))}r.add(JM)}return r}raycast(e,r){let i=this.geometry,n=this.material,a=this.matrixWorld;n!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),XM.copy(i.boundingSphere),XM.applyMatrix4(a),kg.copy(e.ray).recast(e.near),!(XM.containsPoint(kg.origin)===!1&&(kg.intersectSphere(XM,zq)===null||kg.origin.distanceToSquared(zq)>(e.far-e.near)**2))&&(Bq.copy(a).invert(),kg.copy(e.ray).applyMatrix4(Bq),!(i.boundingBox!==null&&kg.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,r,kg)))}_computeIntersections(e,r,i){let n,a=this.geometry,o=this.material,l=a.index,u=a.attributes.position,c=a.attributes.uv,p=a.attributes.uv1,m=a.attributes.normal,y=a.groups,v=a.drawRange;if(l!==null)if(Array.isArray(o))for(let w=0,E=y.length;w<E;w++){let M=y[w],I=o[M.materialIndex],P=Math.max(M.start,v.start),C=Math.min(l.count,Math.min(M.start+M.count,v.start+v.count));for(let T=P,O=C;T<O;T+=3){let F=l.getX(T),k=l.getX(T+1),B=l.getX(T+2);n=p2(this,I,e,i,c,p,m,F,k,B),n&&(n.faceIndex=Math.floor(T/3),n.face.materialIndex=M.materialIndex,r.push(n))}}else{let w=Math.max(0,v.start),E=Math.min(l.count,v.start+v.count);for(let M=w,I=E;M<I;M+=3){let P=l.getX(M),C=l.getX(M+1),T=l.getX(M+2);n=p2(this,o,e,i,c,p,m,P,C,T),n&&(n.faceIndex=Math.floor(M/3),r.push(n))}}else if(u!==void 0)if(Array.isArray(o))for(let w=0,E=y.length;w<E;w++){let M=y[w],I=o[M.materialIndex],P=Math.max(M.start,v.start),C=Math.min(u.count,Math.min(M.start+M.count,v.start+v.count));for(let T=P,O=C;T<O;T+=3){let F=T,k=T+1,B=T+2;n=p2(this,I,e,i,c,p,m,F,k,B),n&&(n.faceIndex=Math.floor(T/3),n.face.materialIndex=M.materialIndex,r.push(n))}}else{let w=Math.max(0,v.start),E=Math.min(u.count,v.start+v.count);for(let M=w,I=E;M<I;M+=3){let P=M,C=M+1,T=M+2;n=p2(this,o,e,i,c,p,m,P,C,T),n&&(n.faceIndex=Math.floor(M/3),r.push(n))}}}};s(Wce,"Mesh");var Pn=Wce;function Xce(t,e,r,i,n,a,o,l){let u;if(e.side===tu?u=i.intersectTriangle(o,a,n,!0,l):u=i.intersectTriangle(n,a,o,e.side===Qp,l),u===null)return null;QM.copy(l),QM.applyMatrix4(t.matrixWorld);let c=r.ray.origin.distanceTo(QM);return c<r.near||c>r.far?null:{distance:c,point:QM.clone(),object:t}}s(Xce,"checkIntersection$1");function p2(t,e,r,i,n,a,o,l,u,c){t.getVertexPosition(l,ZM),t.getVertexPosition(u,YM),t.getVertexPosition(c,KM);let p=Xce(t,e,r,i,ZM,YM,KM,Uq);if(p){let m=new qe;L0.getBarycoord(Uq,ZM,YM,KM,m),n&&(p.uv=L0.getInterpolatedAttribute(n,l,u,c,m,new Jt)),a&&(p.uv1=L0.getInterpolatedAttribute(a,l,u,c,m,new Jt)),o&&(p.normal=L0.getInterpolatedAttribute(o,l,u,c,m,new qe),p.normal.dot(i.direction)>0&&p.normal.multiplyScalar(-1));let y={a:l,b:u,c,normal:new qe,materialIndex:0};L0.getNormal(ZM,YM,KM,y.normal),p.face=y,p.barycoord=m}return p}s(p2,"checkGeometryIntersection");var Zce=class Yce extends js{constructor(e=1,r=1,i=1,n=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:r,depth:i,widthSegments:n,heightSegments:a,depthSegments:o};let l=this;n=Math.floor(n),a=Math.floor(a),o=Math.floor(o);let u=[],c=[],p=[],m=[],y=0,v=0;w("z","y","x",-1,-1,i,r,e,o,a,0),w("z","y","x",1,-1,i,r,-e,o,a,1),w("x","z","y",1,1,e,i,r,n,o,2),w("x","z","y",1,-1,e,i,-r,n,o,3),w("x","y","z",1,-1,e,r,i,n,a,4),w("x","y","z",-1,-1,e,r,-i,n,a,5),this.setIndex(u),this.setAttribute("position",new yo(c,3)),this.setAttribute("normal",new yo(p,3)),this.setAttribute("uv",new yo(m,2));function w(E,M,I,P,C,T,O,F,k,B,U){let z=T/k,q=O/B,W=T/2,J=O/2,V=F/2,oe=k+1,Y=B+1,he=0,Q=0,ae=new qe;for(let ee=0;ee<Y;ee++){let le=ee*q-J;for(let K=0;K<oe;K++){let ce=K*z-W;ae[E]=ce*P,ae[M]=le*C,ae[I]=V,c.push(ae.x,ae.y,ae.z),ae[E]=0,ae[M]=0,ae[I]=F>0?1:-1,p.push(ae.x,ae.y,ae.z),m.push(K/k),m.push(1-ee/B),he+=1}}for(let ee=0;ee<B;ee++)for(let le=0;le<k;le++){let K=y+le+oe*ee,ce=y+le+oe*(ee+1),te=y+(le+1)+oe*(ee+1),ne=y+(le+1)+oe*ee;u.push(K,ce,ne),u.push(ce,te,ne),Q+=6}l.addGroup(v,Q,U),v+=Q,y+=he}s(w,"buildPlane")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yce(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};s(Zce,"BoxGeometry");var RA=Zce;function Xy(t){let e={};for(let r in t){e[r]={};for(let i in t[r]){let n=t[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[r][i]=null):e[r][i]=n.clone():Array.isArray(n)?e[r][i]=n.slice():e[r][i]=n}}return e}s(Xy,"cloneUniforms");function Sl(t){let e={};for(let r=0;r<t.length;r++){let i=Xy(t[r]);for(let n in i)e[n]=i[n]}return e}s(Sl,"mergeUniforms");function Kce(t){let e=[];for(let r=0;r<t.length;r++)e.push(t[r].clone());return e}s(Kce,"cloneUniformsGroups");function _B(t){let e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Rn.workingColorSpace}s(_B,"getUnlitUniformColorSpace");var MVe={clone:Xy,merge:Sl},EVe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,CVe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Jce=class extends lg{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=EVe,this.fragmentShader=CVe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xy(e.uniforms),this.uniformsGroups=Kce(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let r=super.toJSON(e);r.glslVersion=this.glslVersion,r.uniforms={};for(let n in this.uniforms){let a=this.uniforms[n].value;a&&a.isTexture?r.uniforms[n]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?r.uniforms[n]={type:"c",value:a.getHex()}:a&&a.isVector2?r.uniforms[n]={type:"v2",value:a.toArray()}:a&&a.isVector3?r.uniforms[n]={type:"v3",value:a.toArray()}:a&&a.isVector4?r.uniforms[n]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?r.uniforms[n]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?r.uniforms[n]={type:"m4",value:a.toArray()}:r.uniforms[n]={value:a}}Object.keys(this.defines).length>0&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,r.lights=this.lights,r.clipping=this.clipping;let i={};for(let n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(r.extensions=i),r}};s(Jce,"ShaderMaterial");var bc=Jce,Qce=class extends qa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Oi,this.projectionMatrix=new Oi,this.projectionMatrixInverse=new Oi,this.coordinateSystem=sf}copy(e,r){return super.copy(e,r),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,r){super.updateWorldMatrix(e,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};s(Qce,"Camera");var xB=Qce,lm=new qe,Vq=new Jt,jq=new Jt,ehe=class extends xB{constructor(e=50,r=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let r=.5*this.getFilmHeight()/e;this.fov=I_*2*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(n_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return I_*2*Math.atan(Math.tan(n_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,r,i){lm.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(lm.x,lm.y).multiplyScalar(-e/lm.z),lm.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(lm.x,lm.y).multiplyScalar(-e/lm.z)}getViewSize(e,r){return this.getViewBounds(e,Vq,jq),r.subVectors(jq,Vq)}setViewOffset(e,r,i,n,a,o){this.aspect=e/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,r=e*Math.tan(n_*.5*this.fov)/this.zoom,i=2*r,n=this.aspect*i,a=-.5*n,o=this.view;if(this.view!==null&&this.view.enabled){let u=o.fullWidth,c=o.fullHeight;a+=o.offsetX*n/u,r-=o.offsetY*i/c,n*=o.width/u,i*=o.height/c}let l=this.filmOffset;l!==0&&(a+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+n,r,r-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let r=super.toJSON(e);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,this.view!==null&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}};s(ehe,"PerspectiveCamera");var Kl=ehe,m0=-90,g0=1,the=class extends qa{constructor(e,r,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let n=new Kl(m0,g0,e,r);n.layers=this.layers,this.add(n);let a=new Kl(m0,g0,e,r);a.layers=this.layers,this.add(a);let o=new Kl(m0,g0,e,r);o.layers=this.layers,this.add(o);let l=new Kl(m0,g0,e,r);l.layers=this.layers,this.add(l);let u=new Kl(m0,g0,e,r);u.layers=this.layers,this.add(u);let c=new Kl(m0,g0,e,r);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){let e=this.coordinateSystem,r=this.children.concat(),[i,n,a,o,l,u]=r;for(let c of r)this.remove(c);if(e===sf)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===V3)i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let c of r)this.add(c),c.updateMatrixWorld()}update(e,r){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[a,o,l,u,c,p]=this.children,m=e.getRenderTarget(),y=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),w=e.xr.enabled;e.xr.enabled=!1;let E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,n),e.render(r,a),e.setRenderTarget(i,1,n),e.render(r,o),e.setRenderTarget(i,2,n),e.render(r,l),e.setRenderTarget(i,3,n),e.render(r,u),e.setRenderTarget(i,4,n),e.render(r,c),i.texture.generateMipmaps=E,e.setRenderTarget(i,5,n),e.render(r,p),e.setRenderTarget(m,y,v),e.xr.enabled=w,i.texture.needsPMREMUpdate=!0}};s(the,"CubeCamera");var IVe=the,rhe=class extends Gu{constructor(e,r,i,n,a,o,l,u,c,p){e=e!==void 0?e:[],r=r!==void 0?r:S_,super(e,r,i,n,a,o,l,u,c,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};s(rhe,"CubeTexture");var ihe=rhe,nhe=class extends Qm{constructor(e=1,r={}){super(e,e,r),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new ihe(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Up}fromEquirectangularTexture(e,r){this.texture.type=r.type,this.texture.colorSpace=r.colorSpace,this.texture.generateMipmaps=r.generateMipmaps,this.texture.minFilter=r.minFilter,this.texture.magFilter=r.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new RA(5,5,5),a=new bc({name:"CubemapFromEquirect",uniforms:Xy(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:tu,blending:Hm});a.uniforms.tEquirect.value=r;let o=new Pn(n,a),l=r.minFilter;return r.minFilter===Ey&&(r.minFilter=Up),new IVe(1,10,this).update(e,o),r.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,r,i,n){let a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(r,i,n);e.setRenderTarget(a)}};s(nhe,"WebGLCubeRenderTarget");var TVe=nhe,ahe=class extends qa{constructor(){super(),this.isGroup=!0,this.type="Group"}};s(ahe,"Group");var eE=ahe,PVe={type:"move"},ohe=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new eE,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new eE,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new qe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new qe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new eE,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new qe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new qe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let r=this._hand;if(r)for(let i of e.hand.values())this._getHandJoint(r,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,r,i){let n=null,a=null,o=null,l=this._targetRay,u=this._grip,c=this._hand;if(e&&r.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(let E of e.hand.values()){let M=r.getJointPose(E,i),I=this._getHandJoint(c,E);M!==null&&(I.matrix.fromArray(M.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=M.radius),I.visible=M!==null}let p=c.joints["index-finger-tip"],m=c.joints["thumb-tip"],y=p.position.distanceTo(m.position),v=.02,w=.005;c.inputState.pinching&&y>v+w?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&y<=v-w&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(a=r.getPose(e.gripSpace,i),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,a.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(a.linearVelocity)):u.hasLinearVelocity=!1,a.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(a.angularVelocity)):u.hasAngularVelocity=!1));l!==null&&(n=r.getPose(e.targetRaySpace,i),n===null&&a!==null&&(n=a),n!==null&&(l.matrix.fromArray(n.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,n.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(n.linearVelocity)):l.hasLinearVelocity=!1,n.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(n.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(PVe)))}return l!==null&&(l.visible=n!==null),u!==null&&(u.visible=a!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,r){if(e.joints[r.jointName]===void 0){let i=new eE;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[r.jointName]=i,e.add(i)}return e.joints[r.jointName]}};s(ohe,"WebXRController");var c6=ohe,she=class extends qa{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Nu,this.environmentIntensity=1,this.environmentRotation=new Nu,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,r){return super.copy(e,r),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let r=super.toJSON(e);return this.fog!==null&&(r.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(r.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(r.object.backgroundIntensity=this.backgroundIntensity),r.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(r.object.environmentIntensity=this.environmentIntensity),r.object.environmentRotation=this.environmentRotation.toArray(),r}};s(she,"Scene");var bB=she,lhe=class{constructor(e,r){this.isInterleavedBuffer=!0,this.array=e,this.stride=r,this.count=e!==void 0?e.length/r:0,this.usage=oO,this.updateRanges=[],this.version=0,this.uuid=xc()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,r){this.updateRanges.push({start:e,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,r,i){e*=this.stride,i*=r.stride;for(let n=0,a=this.stride;n<a;n++)this.array[e+n]=r.array[i+n];return this}set(e,r=0){return this.array.set(e,r),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let r=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(r,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};s(lhe,"InterleavedBuffer");var kut=lhe,Hl=new qe,uhe=class che{constructor(e,r,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=r,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let r=0,i=this.data.count;r<i;r++)Hl.fromBufferAttribute(this,r),Hl.applyMatrix4(e),this.setXYZ(r,Hl.x,Hl.y,Hl.z);return this}applyNormalMatrix(e){for(let r=0,i=this.count;r<i;r++)Hl.fromBufferAttribute(this,r),Hl.applyNormalMatrix(e),this.setXYZ(r,Hl.x,Hl.y,Hl.z);return this}transformDirection(e){for(let r=0,i=this.count;r<i;r++)Hl.fromBufferAttribute(this,r),Hl.transformDirection(e),this.setXYZ(r,Hl.x,Hl.y,Hl.z);return this}getComponent(e,r){let i=this.array[e*this.data.stride+this.offset+r];return this.normalized&&(i=Qc(i,this.array)),i}setComponent(e,r,i){return this.normalized&&(i=Yn(i,this.array)),this.data.array[e*this.data.stride+this.offset+r]=i,this}setX(e,r){return this.normalized&&(r=Yn(r,this.array)),this.data.array[e*this.data.stride+this.offset]=r,this}setY(e,r){return this.normalized&&(r=Yn(r,this.array)),this.data.array[e*this.data.stride+this.offset+1]=r,this}setZ(e,r){return this.normalized&&(r=Yn(r,this.array)),this.data.array[e*this.data.stride+this.offset+2]=r,this}setW(e,r){return this.normalized&&(r=Yn(r,this.array)),this.data.array[e*this.data.stride+this.offset+3]=r,this}getX(e){let r=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(r=Qc(r,this.array)),r}getY(e){let r=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(r=Qc(r,this.array)),r}getZ(e){let r=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(r=Qc(r,this.array)),r}getW(e){let r=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(r=Qc(r,this.array)),r}setXY(e,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(r=Yn(r,this.array),i=Yn(i,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=i,this}setXYZ(e,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(r=Yn(r,this.array),i=Yn(i,this.array),n=Yn(n,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,r,i,n,a){return e=e*this.data.stride+this.offset,this.normalized&&(r=Yn(r,this.array),i=Yn(i,this.array),n=Yn(n,this.array),a=Yn(a,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let r=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)r.push(this.data.array[n+a])}return new Yo(new this.array.constructor(r),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new che(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let r=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)r.push(this.data.array[n+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:r,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};s(uhe,"InterleavedBufferAttribute");var Nut=uhe,$q=new qe,Gq=new Qn,Hq=new Qn,LVe=new qe,qq=new Oi,tE=new qe,h6=new Ru,Wq=new Oi,p6=new DA,hhe=class extends Pn{constructor(e,r){super(e,r),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=xq,this.bindMatrix=new Oi,this.bindMatrixInverse=new Oi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ro),this.boundingBox.makeEmpty();let r=e.getAttribute("position");for(let i=0;i<r.count;i++)this.getVertexPosition(i,tE),this.boundingBox.expandByPoint(tE)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ru),this.boundingSphere.makeEmpty();let r=e.getAttribute("position");for(let i=0;i<r.count;i++)this.getVertexPosition(i,tE),this.boundingSphere.expandByPoint(tE)}copy(e,r){return super.copy(e,r),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,r){let i=this.material,n=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),h6.copy(this.boundingSphere),h6.applyMatrix4(n),e.ray.intersectsSphere(h6)!==!1&&(Wq.copy(n).invert(),p6.copy(e.ray).applyMatrix4(Wq),!(this.boundingBox!==null&&p6.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,r,p6)))}getVertexPosition(e,r){return super.getVertexPosition(e,r),this.applyBoneTransform(e,r),r}bind(e,r){this.skeleton=e,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Qn,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){e.fromBufferAttribute(r,i);let a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),r.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===xq?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===XUe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,r){let i=this.skeleton,n=this.geometry;Gq.fromBufferAttribute(n.attributes.skinIndex,e),Hq.fromBufferAttribute(n.attributes.skinWeight,e),$q.copy(r).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let a=0;a<4;a++){let o=Hq.getComponent(a);if(o!==0){let l=Gq.getComponent(a);qq.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),r.addScaledVector(LVe.copy($q).applyMatrix4(qq),o)}}return r.applyMatrix4(this.bindMatrixInverse)}};s(hhe,"SkinnedMesh");var But=hhe,phe=class extends qa{constructor(){super(),this.isBone=!0,this.type="Bone"}};s(phe,"Bone");var DVe=phe,dhe=class extends Gu{constructor(e=null,r=1,i=1,n,a,o,l,u,c=_c,p=_c,m,y){super(null,o,l,u,c,p,n,a,m,y),this.isDataTexture=!0,this.image={data:e,width:r,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};s(dhe,"DataTexture");var o_=dhe,Xq=new Oi,RVe=new Oi,fhe=class mhe{constructor(e=[],r=[]){this.uuid=xc(),this.bones=e.slice(0),this.boneInverses=r,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,r=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),r.length===0)this.calculateInverses();else if(e.length!==r.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Oi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,r=this.bones.length;e<r;e++){let i=new Oi;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,r=this.bones.length;e<r;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,r=this.bones.length;e<r;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,r=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let a=0,o=e.length;a<o;a++){let l=e[a]?e[a].matrixWorld:RVe;Xq.multiplyMatrices(l,r[a]),Xq.toArray(i,a*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new mhe(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let r=new Float32Array(e*e*4);r.set(this.boneMatrices);let i=new o_(r,e,e,Dl,Lu);return i.needsUpdate=!0,this.boneMatrices=r,this.boneTexture=i,this}getBoneByName(e){for(let r=0,i=this.bones.length;r<i;r++){let n=this.bones[r];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,r){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){let a=e.bones[i],o=r[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new DVe),this.bones.push(o),this.boneInverses.push(new Oi().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let r=this.bones,i=this.boneInverses;for(let n=0,a=r.length;n<a;n++){let o=r[n];e.bones.push(o.uuid);let l=i[n];e.boneInverses.push(l.toArray())}return e}};s(fhe,"Skeleton");var Vut=fhe,ghe=class extends Yo{constructor(e,r,i,n=1){super(e,r,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};s(ghe,"InstancedBufferAttribute");var Zq=ghe,y0=new Oi,Yq=new Oi,rE=[],Kq=new ro,OVe=new Oi,kb=new Pn,Nb=new Ru,yhe=class extends Pn{constructor(e,r,i){super(e,r),this.isInstancedMesh=!0,this.instanceMatrix=new Zq(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let n=0;n<i;n++)this.setMatrixAt(n,OVe)}computeBoundingBox(){let e=this.geometry,r=this.count;this.boundingBox===null&&(this.boundingBox=new ro),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<r;i++)this.getMatrixAt(i,y0),Kq.copy(e.boundingBox).applyMatrix4(y0),this.boundingBox.union(Kq)}computeBoundingSphere(){let e=this.geometry,r=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ru),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<r;i++)this.getMatrixAt(i,y0),Nb.copy(e.boundingSphere).applyMatrix4(y0),this.boundingSphere.union(Nb)}copy(e,r){return super.copy(e,r),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,r){r.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,r){r.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,r){let i=r.morphTargetInfluences,n=this.morphTexture.source.data.data,a=i.length+1,o=e*a+1;for(let l=0;l<i.length;l++)i[l]=n[o+l]}raycast(e,r){let i=this.matrixWorld,n=this.count;if(kb.geometry=this.geometry,kb.material=this.material,kb.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Nb.copy(this.boundingSphere),Nb.applyMatrix4(i),e.ray.intersectsSphere(Nb)!==!1))for(let a=0;a<n;a++){this.getMatrixAt(a,y0),Yq.multiplyMatrices(i,y0),kb.matrixWorld=Yq,kb.raycast(e,rE);for(let o=0,l=rE.length;o<l;o++){let u=rE[o];u.instanceId=a,u.object=this,r.push(u)}rE.length=0}}setColorAt(e,r){this.instanceColor===null&&(this.instanceColor=new Zq(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),r.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,r){r.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,r){let i=r.morphTargetInfluences,n=i.length+1;this.morphTexture===null&&(this.morphTexture=new o_(new Float32Array(n*this.count),n,this.count,dB,Lu));let a=this.morphTexture.source.data.data,o=0;for(let c=0;c<i.length;c++)o+=i[c];let l=this.geometry.morphTargetsRelative?1:1-o,u=n*e;a[u]=l,a.set(i,u+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};s(yhe,"InstancedMesh");var j3=yhe,d6=new qe,kVe=new qe,NVe=new nn,vhe=class{constructor(e=new qe(1,0,0),r=0){this.isPlane=!0,this.normal=e,this.constant=r}set(e,r){return this.normal.copy(e),this.constant=r,this}setComponents(e,r,i,n){return this.normal.set(e,r,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,r){return this.normal.copy(e),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(e,r,i){let n=d6.subVectors(i,r).cross(kVe.subVectors(e,r)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,r){return r.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,r){let i=e.delta(d6),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(e.start)===0?r.copy(e.start):null;let a=-(e.start.dot(this.normal)+this.constant)/n;return a<0||a>1?null:r.copy(e.start).addScaledVector(i,a)}intersectsLine(e){let r=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return r<0&&i>0||i<0&&r>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,r){let i=r||NVe.getNormalMatrix(e),n=this.coplanarPoint(d6).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};s(vhe,"Plane");var $g=vhe,Ng=new Ru,iE=new qe,_he=class{constructor(e=new $g,r=new $g,i=new $g,n=new $g,a=new $g,o=new $g){this.planes=[e,r,i,n,a,o]}set(e,r,i,n,a,o){let l=this.planes;return l[0].copy(e),l[1].copy(r),l[2].copy(i),l[3].copy(n),l[4].copy(a),l[5].copy(o),this}copy(e){let r=this.planes;for(let i=0;i<6;i++)r[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,r=sf){let i=this.planes,n=e.elements,a=n[0],o=n[1],l=n[2],u=n[3],c=n[4],p=n[5],m=n[6],y=n[7],v=n[8],w=n[9],E=n[10],M=n[11],I=n[12],P=n[13],C=n[14],T=n[15];if(i[0].setComponents(u-a,y-c,M-v,T-I).normalize(),i[1].setComponents(u+a,y+c,M+v,T+I).normalize(),i[2].setComponents(u+o,y+p,M+w,T+P).normalize(),i[3].setComponents(u-o,y-p,M-w,T-P).normalize(),i[4].setComponents(u-l,y-m,M-E,T-C).normalize(),r===sf)i[5].setComponents(u+l,y+m,M+E,T+C).normalize();else if(r===V3)i[5].setComponents(l,m,E,C).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+r);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ng.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let r=e.geometry;r.boundingSphere===null&&r.computeBoundingSphere(),Ng.copy(r.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ng)}intersectsSprite(e){return Ng.center.set(0,0,0),Ng.radius=.7071067811865476,Ng.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ng)}intersectsSphere(e){let r=this.planes,i=e.center,n=-e.radius;for(let a=0;a<6;a++)if(r[a].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){let r=this.planes;for(let i=0;i<6;i++){let n=r[i];if(iE.x=n.normal.x>0?e.max.x:e.min.x,iE.y=n.normal.y>0?e.max.y:e.min.y,iE.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(iE)<0)return!1}return!0}containsPoint(e){let r=this.planes;for(let i=0;i<6;i++)if(r[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};s(_he,"Frustum");var OA=_he;function oC(t,e){return t-e}s(oC,"ascIdSort");function xhe(t,e){return t.z-e.z}s(xhe,"sortOpaque");function bhe(t,e){return e.z-t.z}s(bhe,"sortTransparent");var whe=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,r,i,n){let a=this.pool,o=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});let l=a[this.index];o.push(l),this.index++,l.start=e,l.count=r,l.z=i,l.index=n}reset(){this.list.length=0,this.index=0}};s(whe,"MultiDrawRenderList");var FVe=whe,xu=new Oi,BVe=new si(1,1,1),f6=new OA,nE=new ro,Fg=new Ru,Fb=new qe,Jq=new qe,zVe=new qe,m6=new FVe,wl=new Pn,aE=[];function Ahe(t,e,r=0){let i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){let n=t.count;for(let a=0;a<n;a++)for(let o=0;o<i;o++)e.setComponent(a+r,o,t.getComponent(a,o))}else e.array.set(t.array,r*i);e.needsUpdate=!0}s(Ahe,"copyAttributeData");function dm(t,e){if(t.constructor!==e.constructor){let r=Math.min(t.length,e.length);for(let i=0;i<r;i++)e[i]=t[i]}else{let r=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,r))}}s(dm,"copyArrayContents");var She=class extends Pn{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,r,i=r*2,n){super(new js,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=r,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let r=new Float32Array(e*e*4),i=new o_(r,e,e,Dl,Lu);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let r=new Uint32Array(e*e),i=new o_(r,e,e,OP,Jm);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let r=new Float32Array(e*e*4).fill(1),i=new o_(r,e,e,Dl,Lu);i.colorSpace=Rn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){let r=this.geometry,i=this._maxVertexCount,n=this._maxIndexCount;if(this._geometryInitialized===!1){for(let a in e.attributes){let o=e.getAttribute(a),{array:l,itemSize:u,normalized:c}=o,p=new l.constructor(i*u),m=new Yo(p,u,c);r.setAttribute(a,m)}if(e.getIndex()!==null){let a=i>65535?new Uint32Array(n):new Uint16Array(n);r.setIndex(new Yo(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){let r=this.geometry;if(!!e.getIndex()!=!!r.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let i in r.attributes){if(!e.hasAttribute(i))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(i,'". All geometries must have consistent attributes.'));let n=e.getAttribute(i),a=r.getAttribute(i);if(n.itemSize!==a.itemSize||n.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let r=this._instanceInfo;if(e<0||e>=r.length||r[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){let r=this._geometryInfo;if(e<0||e>=r.length||r[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ro);let e=this.boundingBox,r=this._instanceInfo;e.makeEmpty();for(let i=0,n=r.length;i<n;i++){if(r[i].active===!1)continue;let a=r[i].geometryIndex;this.getMatrixAt(i,xu),this.getBoundingBoxAt(a,nE).applyMatrix4(xu),e.union(nE)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ru);let e=this.boundingSphere,r=this._instanceInfo;e.makeEmpty();for(let i=0,n=r.length;i<n;i++){if(r[i].active===!1)continue;let a=r[i].geometryIndex;this.getMatrixAt(i,xu),this.getBoundingSphereAt(a,Fg).applyMatrix4(xu),e.union(Fg)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");let r={visible:!0,active:!0,geometryIndex:e},i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(oC),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=r):(i=this._instanceInfo.length,this._instanceInfo.push(r));let n=this._matricesTexture;xu.identity().toArray(n.image.data,i*16),n.needsUpdate=!0;let a=this._colorsTexture;return a&&(BVe.toArray(a.image.data,i*4),a.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,r=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);let n={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;n.vertexStart=this._nextVertexStart,n.reservedVertexCount=r===-1?e.getAttribute("position").count:r;let o=e.getIndex();if(o!==null&&(n.indexStart=this._nextIndexStart,n.reservedIndexCount=i===-1?o.count:i),n.indexStart!==-1&&n.indexStart+n.reservedIndexCount>this._maxIndexCount||n.vertexStart+n.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(oC),l=this._availableGeometryIds.shift(),a[l]=n):(l=this._geometryCount,this._geometryCount++,a.push(n)),this.setGeometryAt(l,e),this._nextIndexStart=n.indexStart+n.reservedIndexCount,this._nextVertexStart=n.vertexStart+n.reservedVertexCount,l}setGeometryAt(e,r){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(r);let i=this.geometry,n=i.getIndex()!==null,a=i.getIndex(),o=r.getIndex(),l=this._geometryInfo[e];if(n&&o.count>l.reservedIndexCount||r.attributes.position.count>l.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let u=l.vertexStart,c=l.reservedVertexCount;l.vertexCount=r.getAttribute("position").count;for(let p in i.attributes){let m=r.getAttribute(p),y=i.getAttribute(p);Ahe(m,y,u);let v=m.itemSize;for(let w=m.count,E=c;w<E;w++){let M=u+w;for(let I=0;I<v;I++)y.setComponent(M,I,0)}y.needsUpdate=!0,y.addUpdateRange(u*v,c*v)}if(n){let p=l.indexStart,m=l.reservedIndexCount;l.indexCount=r.getIndex().count;for(let y=0;y<o.count;y++)a.setX(p+y,u+o.getX(y));for(let y=o.count,v=m;y<v;y++)a.setX(p+y,u);a.needsUpdate=!0,a.addUpdateRange(p,l.reservedIndexCount)}return l.start=n?l.indexStart:l.vertexStart,l.count=n?l.indexCount:l.vertexCount,l.boundingBox=null,r.boundingBox!==null&&(l.boundingBox=r.boundingBox.clone()),l.boundingSphere=null,r.boundingSphere!==null&&(l.boundingSphere=r.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let r=this._geometryInfo;if(e>=r.length||r[e].active===!1)return this;let i=this._instanceInfo;for(let n=0,a=i.length;n<a;n++)i[n].active&&i[n].geometryIndex===e&&this.deleteInstance(n);return r[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,r=0,i=this._geometryInfo,n=i.map((o,l)=>l).sort((o,l)=>i[o].vertexStart-i[l].vertexStart),a=this.geometry;for(let o=0,l=i.length;o<l;o++){let u=n[o],c=i[u];if(c.active!==!1){if(a.index!==null){if(c.indexStart!==r){let{indexStart:p,vertexStart:m,reservedIndexCount:y}=c,v=a.index,w=v.array,E=e-m;for(let M=p;M<p+y;M++)w[M]=w[M]+E;v.array.copyWithin(r,p,p+y),v.addUpdateRange(r,y),c.indexStart=r}r+=c.reservedIndexCount}if(c.vertexStart!==e){let{vertexStart:p,reservedVertexCount:m}=c,y=a.attributes;for(let v in y){let w=y[v],{array:E,itemSize:M}=w;E.copyWithin(e*M,p*M,(p+m)*M),w.addUpdateRange(e*M,m*M)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=a.index?c.indexStart:c.vertexStart,this._nextIndexStart=a.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,r){if(e>=this._geometryCount)return null;let i=this.geometry,n=this._geometryInfo[e];if(n.boundingBox===null){let a=new ro,o=i.index,l=i.attributes.position;for(let u=n.start,c=n.start+n.count;u<c;u++){let p=u;o&&(p=o.getX(p)),a.expandByPoint(Fb.fromBufferAttribute(l,p))}n.boundingBox=a}return r.copy(n.boundingBox),r}getBoundingSphereAt(e,r){if(e>=this._geometryCount)return null;let i=this.geometry,n=this._geometryInfo[e];if(n.boundingSphere===null){let a=new Ru;this.getBoundingBoxAt(e,nE),nE.getCenter(a.center);let o=i.index,l=i.attributes.position,u=0;for(let c=n.start,p=n.start+n.count;c<p;c++){let m=c;o&&(m=o.getX(m)),Fb.fromBufferAttribute(l,m),u=Math.max(u,a.center.distanceToSquared(Fb))}a.radius=Math.sqrt(u),n.boundingSphere=a}return r.copy(n.boundingSphere),r}setMatrixAt(e,r){this.validateInstanceId(e);let i=this._matricesTexture,n=this._matricesTexture.image.data;return r.toArray(n,e*16),i.needsUpdate=!0,this}getMatrixAt(e,r){return this.validateInstanceId(e),r.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,r){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),r.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,r){return this.validateInstanceId(e),r.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,r){return this.validateInstanceId(e),this._instanceInfo[e].visible===r?this:(this._instanceInfo[e].visible=r,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,r){return this.validateInstanceId(e),this.validateGeometryId(r),this._instanceInfo[e].geometryIndex=r,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,r={}){this.validateGeometryId(e);let i=this._geometryInfo[e];return r.vertexStart=i.vertexStart,r.vertexCount=i.vertexCount,r.reservedVertexCount=i.reservedVertexCount,r.indexStart=i.indexStart,r.indexCount=i.indexCount,r.reservedIndexCount=i.reservedIndexCount,r.start=i.start,r.count=i.count,r}setInstanceCount(e){let r=this._availableInstanceIds,i=this._instanceInfo;for(r.sort(oC);r[r.length-1]===i.length;)i.pop(),r.pop();if(e<i.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));let n=new Int32Array(e),a=new Int32Array(e);dm(this._multiDrawCounts,n),dm(this._multiDrawStarts,a),this._multiDrawCounts=n,this._multiDrawStarts=a,this._maxInstanceCount=e;let o=this._indirectTexture,l=this._matricesTexture,u=this._colorsTexture;o.dispose(),this._initIndirectTexture(),dm(o.image.data,this._indirectTexture.image.data),l.dispose(),this._initMatricesTexture(),dm(l.image.data,this._matricesTexture.image.data),u&&(u.dispose(),this._initColorsTexture(),dm(u.image.data,this._colorsTexture.image.data))}setGeometrySize(e,r){let i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(r,". Cannot shrink further."));if(this.geometry.index&&Math.max(...i.map(o=>o.indexStart+o.reservedIndexCount))>r)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(r,". Cannot shrink further."));let n=this.geometry;n.dispose(),this._maxVertexCount=e,this._maxIndexCount=r,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new js,this._initializeGeometry(n));let a=this.geometry;n.index&&dm(n.index.array,a.index.array);for(let o in n.attributes)dm(n.attributes[o].array,a.attributes[o].array)}raycast(e,r){let i=this._instanceInfo,n=this._geometryInfo,a=this.matrixWorld,o=this.geometry;wl.material=this.material,wl.geometry.index=o.index,wl.geometry.attributes=o.attributes,wl.geometry.boundingBox===null&&(wl.geometry.boundingBox=new ro),wl.geometry.boundingSphere===null&&(wl.geometry.boundingSphere=new Ru);for(let l=0,u=i.length;l<u;l++){if(!i[l].visible||!i[l].active)continue;let c=i[l].geometryIndex,p=n[c];wl.geometry.setDrawRange(p.start,p.count),this.getMatrixAt(l,wl.matrixWorld).premultiply(a),this.getBoundingBoxAt(c,wl.geometry.boundingBox),this.getBoundingSphereAt(c,wl.geometry.boundingSphere),wl.raycast(e,aE);for(let m=0,y=aE.length;m<y;m++){let v=aE[m];v.object=this,v.batchId=l,r.push(v)}aE.length=0}wl.material=null,wl.geometry.index=null,wl.geometry.attributes={},wl.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(r=>vt(Ee({},r),{boundingBox:r.boundingBox!==null?r.boundingBox.clone():null,boundingSphere:r.boundingSphere!==null?r.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(r=>Ee({},r)),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,r,i,n,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=n.getIndex(),l=o===null?1:o.array.BYTES_PER_ELEMENT,u=this._instanceInfo,c=this._multiDrawStarts,p=this._multiDrawCounts,m=this._geometryInfo,y=this.perObjectFrustumCulled,v=this._indirectTexture,w=v.image.data;y&&(xu.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),f6.setFromProjectionMatrix(xu,e.coordinateSystem));let E=0;if(this.sortObjects){xu.copy(this.matrixWorld).invert(),Fb.setFromMatrixPosition(i.matrixWorld).applyMatrix4(xu),Jq.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(xu);for(let P=0,C=u.length;P<C;P++)if(u[P].visible&&u[P].active){let T=u[P].geometryIndex;this.getMatrixAt(P,xu),this.getBoundingSphereAt(T,Fg).applyMatrix4(xu);let O=!1;if(y&&(O=!f6.intersectsSphere(Fg)),!O){let F=m[T],k=zVe.subVectors(Fg.center,Fb).dot(Jq);m6.push(F.start,F.count,k,P)}}let M=m6.list,I=this.customSort;I===null?M.sort(a.transparent?bhe:xhe):I.call(this,M,i);for(let P=0,C=M.length;P<C;P++){let T=M[P];c[E]=T.start*l,p[E]=T.count,w[E]=T.index,E++}m6.reset()}else for(let M=0,I=u.length;M<I;M++)if(u[M].visible&&u[M].active){let P=u[M].geometryIndex,C=!1;if(y&&(this.getMatrixAt(M,xu),this.getBoundingSphereAt(P,Fg).applyMatrix4(xu),C=!f6.intersectsSphere(Fg)),!C){let T=m[P];c[E]=T.start*l,p[E]=T.count,w[E]=M,E++}}v.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,r,i,n,a,o){this.onBeforeRender(e,null,n,a,o)}};s(She,"BatchedMesh");var wB=She,Mhe=class extends lg{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new si(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};s(Mhe,"LineBasicMaterial");var AB=Mhe,$3=new qe,G3=new qe,Qq=new Oi,Bb=new DA,oE=new Ru,g6=new qe,eW=new qe,Ehe=class extends qa{constructor(e=new js,r=new AB){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let r=e.attributes.position,i=[0];for(let n=1,a=r.count;n<a;n++)$3.fromBufferAttribute(r,n-1),G3.fromBufferAttribute(r,n),i[n]=i[n-1],i[n]+=$3.distanceTo(G3);e.setAttribute("lineDistance",new yo(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,r){let i=this.geometry,n=this.matrixWorld,a=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),oE.copy(i.boundingSphere),oE.applyMatrix4(n),oE.radius+=a,e.ray.intersectsSphere(oE)===!1)return;Qq.copy(n).invert(),Bb.copy(e.ray).applyMatrix4(Qq);let l=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=this.isLineSegments?2:1,p=i.index,m=i.attributes.position;if(p!==null){let y=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let w=y,E=v-1;w<E;w+=c){let M=p.getX(w),I=p.getX(w+1),P=d2(this,e,Bb,u,M,I,w);P&&r.push(P)}if(this.isLineLoop){let w=p.getX(v-1),E=p.getX(y),M=d2(this,e,Bb,u,w,E,v-1);M&&r.push(M)}}else{let y=Math.max(0,o.start),v=Math.min(m.count,o.start+o.count);for(let w=y,E=v-1;w<E;w+=c){let M=d2(this,e,Bb,u,w,w+1,w);M&&r.push(M)}if(this.isLineLoop){let w=d2(this,e,Bb,u,v-1,y,v-1);w&&r.push(w)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=i.length;n<a;n++){let o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};s(Ehe,"Line");var Che=Ehe;function d2(t,e,r,i,n,a,o){let l=t.geometry.attributes.position;if($3.fromBufferAttribute(l,n),G3.fromBufferAttribute(l,a),r.distanceSqToSegment($3,G3,g6,eW)>i)return;g6.applyMatrix4(t.matrixWorld);let u=e.ray.origin.distanceTo(g6);if(!(u<e.near||u>e.far))return{distance:u,point:eW.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}s(d2,"checkIntersection");var tW=new qe,rW=new qe,Ihe=class extends Che{constructor(e,r){super(e,r),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let r=e.attributes.position,i=[];for(let n=0,a=r.count;n<a;n+=2)tW.fromBufferAttribute(r,n),rW.fromBufferAttribute(r,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+tW.distanceTo(rW);e.setAttribute("lineDistance",new yo(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};s(Ihe,"LineSegments");var NP=Ihe,The=class extends Che{constructor(e,r){super(e,r),this.isLineLoop=!0,this.type="LineLoop"}};s(The,"LineLoop");var Jut=The,Phe=class extends lg{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new si(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};s(Phe,"PointsMaterial");var UVe=Phe,iW=new Oi,uO=new DA,sE=new Ru,lE=new qe,Lhe=class extends qa{constructor(e=new js,r=new UVe){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,r){let i=this.geometry,n=this.matrixWorld,a=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),sE.copy(i.boundingSphere),sE.applyMatrix4(n),sE.radius+=a,e.ray.intersectsSphere(sE)===!1)return;iW.copy(n).invert(),uO.copy(e.ray).applyMatrix4(iW);let l=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=i.index,p=i.attributes.position;if(c!==null){let m=Math.max(0,o.start),y=Math.min(c.count,o.start+o.count);for(let v=m,w=y;v<w;v++){let E=c.getX(v);lE.fromBufferAttribute(p,E),cO(lE,E,u,n,e,r,this)}}else{let m=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let v=m,w=y;v<w;v++)lE.fromBufferAttribute(p,v),cO(lE,v,u,n,e,r,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=i.length;n<a;n++){let o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};s(Lhe,"Points");var tct=Lhe;function cO(t,e,r,i,n,a,o){let l=uO.distanceSqToPoint(t);if(l<r){let u=new qe;uO.closestPointToPoint(t,u),u.applyMatrix4(i);let c=n.ray.origin.distanceTo(u);if(c<n.near||c>n.far)return;a.push({distance:c,distanceToRay:Math.sqrt(l),point:u,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}s(cO,"testPoint");var Dhe=class extends Gu{constructor(e,r,i,n,a,o,l,u,c,p,m,y){super(null,o,l,u,c,p,n,a,m,y),this.isCompressedTexture=!0,this.image={width:r,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}};s(Dhe,"CompressedTexture");var ict=Dhe,Rhe=class extends Gu{constructor(e,r,i,n,a,o,l,u,c,p=i_){if(p!==i_&&p!==C_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===i_&&(i=Jm),i===void 0&&p===C_&&(i=E_),super(null,n,a,o,l,u,p,i,c),this.isDepthTexture=!0,this.image={width:e,height:r},this.magFilter=l!==void 0?l:_c,this.minFilter=u!==void 0?u:_c,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let r=super.toJSON(e);return this.compareFunction!==null&&(r.compareFunction=this.compareFunction),r}};s(Rhe,"DepthTexture");var Ohe=Rhe,khe=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,r){let i=this.getUtoTmapping(e);return this.getPoint(i,r)}getPoints(e=5){let r=[];for(let i=0;i<=e;i++)r.push(this.getPoint(i/e));return r}getSpacedPoints(e=5){let r=[];for(let i=0;i<=e;i++)r.push(this.getPointAt(i/e));return r}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let r=[],i,n=this.getPoint(0),a=0;r.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),a+=i.distanceTo(n),r.push(a),n=i;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,r){let i=this.getLengths(),n=0,a=i.length,o;r?o=r:o=e*i[a-1];let l=0,u=a-1,c;for(;l<=u;)if(n=Math.floor(l+(u-l)/2),c=i[n]-o,c<0)l=n+1;else if(c>0)u=n-1;else{u=n;break}if(n=u,i[n]===o)return n/(a-1);let p=i[n],m=i[n+1]-p,y=(o-p)/m;return(n+y)/(a-1)}getTangent(e,r){let i=e-1e-4,n=e+1e-4;i<0&&(i=0),n>1&&(n=1);let a=this.getPoint(i),o=this.getPoint(n),l=r||(a.isVector2?new Jt:new qe);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,r){let i=this.getUtoTmapping(e);return this.getTangent(i,r)}computeFrenetFrames(e,r){let i=new qe,n=[],a=[],o=[],l=new qe,u=new Oi;for(let v=0;v<=e;v++){let w=v/e;n[v]=this.getTangentAt(w,new qe)}a[0]=new qe,o[0]=new qe;let c=Number.MAX_VALUE,p=Math.abs(n[0].x),m=Math.abs(n[0].y),y=Math.abs(n[0].z);p<=c&&(c=p,i.set(1,0,0)),m<=c&&(c=m,i.set(0,1,0)),y<=c&&i.set(0,0,1),l.crossVectors(n[0],i).normalize(),a[0].crossVectors(n[0],l),o[0].crossVectors(n[0],a[0]);for(let v=1;v<=e;v++){if(a[v]=a[v-1].clone(),o[v]=o[v-1].clone(),l.crossVectors(n[v-1],n[v]),l.length()>Number.EPSILON){l.normalize();let w=Math.acos(Ji(n[v-1].dot(n[v]),-1,1));a[v].applyMatrix4(u.makeRotationAxis(l,w))}o[v].crossVectors(n[v],a[v])}if(r===!0){let v=Math.acos(Ji(a[0].dot(a[e]),-1,1));v/=e,n[0].dot(l.crossVectors(a[0],a[e]))>0&&(v=-v);for(let w=1;w<=e;w++)a[w].applyMatrix4(u.makeRotationAxis(n[w],v*w)),o[w].crossVectors(n[w],a[w])}return{tangents:n,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};s(khe,"Curve");var nd=khe,Nhe=class extends nd{constructor(e=0,r=0,i=1,n=1,a=0,o=Math.PI*2,l=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=r,this.xRadius=i,this.yRadius=n,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=l,this.aRotation=u}getPoint(e,r=new Jt){let i=r,n=Math.PI*2,a=this.aEndAngle-this.aStartAngle,o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=n;for(;a>n;)a-=n;a<Number.EPSILON&&(o?a=0:a=n),this.aClockwise===!0&&!o&&(a===n?a=-n:a=a-n);let l=this.aStartAngle+e*a,u=this.aX+this.xRadius*Math.cos(l),c=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){let p=Math.cos(this.aRotation),m=Math.sin(this.aRotation),y=u-this.aX,v=c-this.aY;u=y*p-v*m+this.aX,c=y*m+v*p+this.aY}return i.set(u,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};s(Nhe,"EllipseCurve");var SB=Nhe,Fhe=class extends SB{constructor(e,r,i,n,a,o){super(e,r,i,i,n,a,o),this.isArcCurve=!0,this.type="ArcCurve"}};s(Fhe,"ArcCurve");var VVe=Fhe;function FP(){let t=0,e=0,r=0,i=0;function n(a,o,l,u){t=a,e=l,r=-3*a+3*o-2*l-u,i=2*a-2*o+l+u}return s(n,"init"),{initCatmullRom:s(function(a,o,l,u,c){n(o,l,c*(l-a),c*(u-o))},"initCatmullRom"),initNonuniformCatmullRom:s(function(a,o,l,u,c,p,m){let y=(o-a)/c-(l-a)/(c+p)+(l-o)/p,v=(l-o)/p-(u-o)/(p+m)+(u-l)/m;y*=p,v*=p,n(o,l,y,v)},"initNonuniformCatmullRom"),calc:s(function(a){let o=a*a,l=o*a;return t+e*a+r*o+i*l},"calc")}}s(FP,"CubicPoly");var uE=new qe,y6=new FP,v6=new FP,_6=new FP,Bhe=class extends nd{constructor(e=[],r=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=r,this.curveType=i,this.tension=n}getPoint(e,r=new qe){let i=r,n=this.points,a=n.length,o=(a-(this.closed?0:1))*e,l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/a)+1)*a:u===0&&l===a-1&&(l=a-2,u=1);let c,p;this.closed||l>0?c=n[(l-1)%a]:(uE.subVectors(n[0],n[1]).add(n[0]),c=uE);let m=n[l%a],y=n[(l+1)%a];if(this.closed||l+2<a?p=n[(l+2)%a]:(uE.subVectors(n[a-1],n[a-2]).add(n[a-1]),p=uE),this.curveType==="centripetal"||this.curveType==="chordal"){let v=this.curveType==="chordal"?.5:.25,w=Math.pow(c.distanceToSquared(m),v),E=Math.pow(m.distanceToSquared(y),v),M=Math.pow(y.distanceToSquared(p),v);E<1e-4&&(E=1),w<1e-4&&(w=E),M<1e-4&&(M=E),y6.initNonuniformCatmullRom(c.x,m.x,y.x,p.x,w,E,M),v6.initNonuniformCatmullRom(c.y,m.y,y.y,p.y,w,E,M),_6.initNonuniformCatmullRom(c.z,m.z,y.z,p.z,w,E,M)}else this.curveType==="catmullrom"&&(y6.initCatmullRom(c.x,m.x,y.x,p.x,this.tension),v6.initCatmullRom(c.y,m.y,y.y,p.y,this.tension),_6.initCatmullRom(c.z,m.z,y.z,p.z,this.tension));return i.set(y6.calc(u),v6.calc(u),_6.calc(u)),i}copy(e){super.copy(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(new qe().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};s(Bhe,"CatmullRomCurve3");var zhe=Bhe;function hO(t,e,r,i,n){let a=(i-e)*.5,o=(n-r)*.5,l=t*t,u=t*l;return(2*r-2*i+a+o)*u+(-3*r+3*i-2*a-o)*l+a*t+r}s(hO,"CatmullRom");function Uhe(t,e){let r=1-t;return r*r*e}s(Uhe,"QuadraticBezierP0");function Vhe(t,e){return 2*(1-t)*t*e}s(Vhe,"QuadraticBezierP1");function jhe(t,e){return t*t*e}s(jhe,"QuadraticBezierP2");function s_(t,e,r,i){return Uhe(t,e)+Vhe(t,r)+jhe(t,i)}s(s_,"QuadraticBezier");function $he(t,e){let r=1-t;return r*r*r*e}s($he,"CubicBezierP0");function Ghe(t,e){let r=1-t;return 3*r*r*t*e}s(Ghe,"CubicBezierP1");function Hhe(t,e){return 3*(1-t)*t*t*e}s(Hhe,"CubicBezierP2");function qhe(t,e){return t*t*t*e}s(qhe,"CubicBezierP3");function l_(t,e,r,i,n){return $he(t,e)+Ghe(t,r)+Hhe(t,i)+qhe(t,n)}s(l_,"CubicBezier");var Whe=class extends nd{constructor(e=new Jt,r=new Jt,i=new Jt,n=new Jt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=r,this.v2=i,this.v3=n}getPoint(e,r=new Jt){let i=r,n=this.v0,a=this.v1,o=this.v2,l=this.v3;return i.set(l_(e,n.x,a.x,o.x,l.x),l_(e,n.y,a.y,o.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};s(Whe,"CubicBezierCurve");var Xhe=Whe,Zhe=class extends nd{constructor(e=new qe,r=new qe,i=new qe,n=new qe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=r,this.v2=i,this.v3=n}getPoint(e,r=new qe){let i=r,n=this.v0,a=this.v1,o=this.v2,l=this.v3;return i.set(l_(e,n.x,a.x,o.x,l.x),l_(e,n.y,a.y,o.y,l.y),l_(e,n.z,a.z,o.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};s(Zhe,"CubicBezierCurve3");var jVe=Zhe,Yhe=class extends nd{constructor(e=new Jt,r=new Jt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=r}getPoint(e,r=new Jt){let i=r;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r=new Jt){return r.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,r){return this.getTangent(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Yhe,"LineCurve");var Khe=Yhe,Jhe=class extends nd{constructor(e=new qe,r=new qe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=r}getPoint(e,r=new qe){let i=r;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r=new qe){return r.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,r){return this.getTangent(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Jhe,"LineCurve3");var $Ve=Jhe,Qhe=class extends nd{constructor(e=new Jt,r=new Jt,i=new Jt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=r,this.v2=i}getPoint(e,r=new Jt){let i=r,n=this.v0,a=this.v1,o=this.v2;return i.set(s_(e,n.x,a.x,o.x),s_(e,n.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Qhe,"QuadraticBezierCurve");var epe=Qhe,tpe=class extends nd{constructor(e=new qe,r=new qe,i=new qe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=r,this.v2=i}getPoint(e,r=new qe){let i=r,n=this.v0,a=this.v1,o=this.v2;return i.set(s_(e,n.x,a.x,o.x),s_(e,n.y,a.y,o.y),s_(e,n.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(tpe,"QuadraticBezierCurve3");var rpe=tpe,ipe=class extends nd{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,r=new Jt){let i=r,n=this.points,a=(n.length-1)*e,o=Math.floor(a),l=a-o,u=n[o===0?o:o-1],c=n[o],p=n[o>n.length-2?n.length-1:o+1],m=n[o>n.length-3?n.length-1:o+2];return i.set(hO(l,u.x,c.x,p.x,m.x),hO(l,u.y,c.y,p.y,m.y)),i}copy(e){super.copy(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(new Jt().fromArray(n))}return this}};s(ipe,"SplineCurve");var npe=ipe,H3=Object.freeze({__proto__:null,ArcCurve:VVe,CatmullRomCurve3:zhe,CubicBezierCurve:Xhe,CubicBezierCurve3:jVe,EllipseCurve:SB,LineCurve:Khe,LineCurve3:$Ve,QuadraticBezierCurve:epe,QuadraticBezierCurve3:rpe,SplineCurve:npe}),ape=class extends nd{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(r)){let i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new H3[i](r,e))}return this}getPoint(e,r){let i=e*this.getLength(),n=this.getCurveLengths(),a=0;for(;a<n.length;){if(n[a]>=i){let o=n[a]-i,l=this.curves[a],u=l.getLength(),c=u===0?0:1-o/u;return l.getPointAt(c,r)}a++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],r=0;for(let i=0,n=this.curves.length;i<n;i++)r+=this.curves[i].getLength(),e.push(r);return this.cacheLengths=e,e}getSpacedPoints(e=40){let r=[];for(let i=0;i<=e;i++)r.push(this.getPoint(i/e));return this.autoClose&&r.push(r[0]),r}getPoints(e=12){let r=[],i;for(let n=0,a=this.curves;n<a.length;n++){let o=a[n],l=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,u=o.getPoints(l);for(let c=0;c<u.length;c++){let p=u[c];i&&i.equals(p)||(r.push(p),i=p)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let r=0,i=e.curves.length;r<i;r++){let n=e.curves[r];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let r=0,i=this.curves.length;r<i;r++){let n=this.curves[r];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let r=0,i=e.curves.length;r<i;r++){let n=e.curves[r];this.curves.push(new H3[n.type]().fromJSON(n))}return this}};s(ape,"CurvePath");var GVe=ape,ope=class extends GVe{constructor(e){super(),this.type="Path",this.currentPoint=new Jt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let r=1,i=e.length;r<i;r++)this.lineTo(e[r].x,e[r].y);return this}moveTo(e,r){return this.currentPoint.set(e,r),this}lineTo(e,r){let i=new Khe(this.currentPoint.clone(),new Jt(e,r));return this.curves.push(i),this.currentPoint.set(e,r),this}quadraticCurveTo(e,r,i,n){let a=new epe(this.currentPoint.clone(),new Jt(e,r),new Jt(i,n));return this.curves.push(a),this.currentPoint.set(i,n),this}bezierCurveTo(e,r,i,n,a,o){let l=new Xhe(this.currentPoint.clone(),new Jt(e,r),new Jt(i,n),new Jt(a,o));return this.curves.push(l),this.currentPoint.set(a,o),this}splineThru(e){let r=[this.currentPoint.clone()].concat(e),i=new npe(r);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,r,i,n,a,o){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+l,r+u,i,n,a,o),this}absarc(e,r,i,n,a,o){return this.absellipse(e,r,i,i,n,a,o),this}ellipse(e,r,i,n,a,o,l,u){let c=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(e+c,r+p,i,n,a,o,l,u),this}absellipse(e,r,i,n,a,o,l,u){let c=new SB(e,r,i,n,a,o,l,u);if(this.curves.length>0){let m=c.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(c);let p=c.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};s(ope,"Path");var P_=ope,spe=class lpe extends js{constructor(e=1,r=1,i=1,n=32,a=1,o=!1,l=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:r,height:i,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:u};let c=this;n=Math.floor(n),a=Math.floor(a);let p=[],m=[],y=[],v=[],w=0,E=[],M=i/2,I=0;P(),o===!1&&(e>0&&C(!0),r>0&&C(!1)),this.setIndex(p),this.setAttribute("position",new yo(m,3)),this.setAttribute("normal",new yo(y,3)),this.setAttribute("uv",new yo(v,2));function P(){let T=new qe,O=new qe,F=0,k=(r-e)/i;for(let B=0;B<=a;B++){let U=[],z=B/a,q=z*(r-e)+e;for(let W=0;W<=n;W++){let J=W/n,V=J*u+l,oe=Math.sin(V),Y=Math.cos(V);O.x=q*oe,O.y=-z*i+M,O.z=q*Y,m.push(O.x,O.y,O.z),T.set(oe,k,Y).normalize(),y.push(T.x,T.y,T.z),v.push(J,1-z),U.push(w++)}E.push(U)}for(let B=0;B<n;B++)for(let U=0;U<a;U++){let z=E[U][B],q=E[U+1][B],W=E[U+1][B+1],J=E[U][B+1];(e>0||U!==0)&&(p.push(z,q,J),F+=3),(r>0||U!==a-1)&&(p.push(q,W,J),F+=3)}c.addGroup(I,F,0),I+=F}s(P,"generateTorso");function C(T){let O=w,F=new Jt,k=new qe,B=0,U=T===!0?e:r,z=T===!0?1:-1;for(let W=1;W<=n;W++)m.push(0,M*z,0),y.push(0,z,0),v.push(.5,.5),w++;let q=w;for(let W=0;W<=n;W++){let J=W/n*u+l,V=Math.cos(J),oe=Math.sin(J);k.x=U*oe,k.y=M*z,k.z=U*V,m.push(k.x,k.y,k.z),y.push(0,z,0),F.x=V*.5+.5,F.y=oe*.5*z+.5,v.push(F.x,F.y),w++}for(let W=0;W<n;W++){let J=O+W,V=q+W;T===!0?p.push(V,V+1,J):p.push(V+1,V,J),B+=3}c.addGroup(I,B,T===!0?1:2),I+=B}s(C,"generateCap")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lpe(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};s(spe,"CylinderGeometry");var pO=spe,cE=new qe,hE=new qe,x6=new qe,pE=new L0,upe=class extends js{constructor(e=null,r=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:r},e!==null){let i=Math.pow(10,4),n=Math.cos(n_*r),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,u=[0,0,0],c=["a","b","c"],p=new Array(3),m={},y=[];for(let v=0;v<l;v+=3){a?(u[0]=a.getX(v),u[1]=a.getX(v+1),u[2]=a.getX(v+2)):(u[0]=v,u[1]=v+1,u[2]=v+2);let{a:w,b:E,c:M}=pE;if(w.fromBufferAttribute(o,u[0]),E.fromBufferAttribute(o,u[1]),M.fromBufferAttribute(o,u[2]),pE.getNormal(x6),p[0]="".concat(Math.round(w.x*i),",").concat(Math.round(w.y*i),",").concat(Math.round(w.z*i)),p[1]="".concat(Math.round(E.x*i),",").concat(Math.round(E.y*i),",").concat(Math.round(E.z*i)),p[2]="".concat(Math.round(M.x*i),",").concat(Math.round(M.y*i),",").concat(Math.round(M.z*i)),!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let I=0;I<3;I++){let P=(I+1)%3,C=p[I],T=p[P],O=pE[c[I]],F=pE[c[P]],k="".concat(C,"_").concat(T),B="".concat(T,"_").concat(C);B in m&&m[B]?(x6.dot(m[B].normal)<=n&&(y.push(O.x,O.y,O.z),y.push(F.x,F.y,F.z)),m[B]=null):k in m||(m[k]={index0:u[I],index1:u[P],normal:x6.clone()})}}for(let v in m)if(m[v]){let{index0:w,index1:E}=m[v];cE.fromBufferAttribute(o,w),hE.fromBufferAttribute(o,E),y.push(cE.x,cE.y,cE.z),y.push(hE.x,hE.y,hE.z)}this.setAttribute("position",new yo(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};s(upe,"EdgesGeometry");var HVe=upe,cpe=class extends P_{constructor(e){super(e),this.uuid=xc(),this.type="Shape",this.holes=[]}getPointsHoles(e){let r=[];for(let i=0,n=this.holes.length;i<n;i++)r[i]=this.holes[i].getPoints(e);return r}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let r=0,i=e.holes.length;r<i;r++){let n=e.holes[r];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let r=0,i=this.holes.length;r<i;r++){let n=this.holes[r];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let r=0,i=e.holes.length;r<i;r++){let n=e.holes[r];this.holes.push(new P_().fromJSON(n))}return this}};s(cpe,"Shape");var sx=cpe,qVe={triangulate:s(function(t,e,r=2){let i=e&&e.length,n=i?e[0]*r:t.length,a=MB(t,0,n,r,!0),o=[];if(!a||a.next===a.prev)return o;let l,u,c,p,m,y,v;if(i&&(a=mpe(t,e,a,r)),t.length>80*r){l=c=t[0],u=p=t[1];for(let w=r;w<n;w+=r)m=t[w],y=t[w+1],m<l&&(l=m),y<u&&(u=y),m>c&&(c=m),y>p&&(p=y);v=Math.max(c-l,p-u),v=v!==0?32767/v:0}return L_(a,o,r,l,u,v,0),o},"triangulate")};function MB(t,e,r,i,n){let a,o;if(n===Epe(t,e,r,i)>0)for(a=e;a<r;a+=i)o=dO(a,t[a],t[a+1],o);else for(a=r-i;a>=e;a-=i)o=dO(a,t[a],t[a+1],o);return o&&kA(o,o.next)&&(R_(o),o=o.next),o}s(MB,"linkedList");function eg(t,e){if(!t)return t;e||(e=t);let r=t,i;do if(i=!1,!r.steiner&&(kA(r,r.next)||Qa(r.prev,r,r.next)===0)){if(R_(r),r=e=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==e);return e}s(eg,"filterPoints");function L_(t,e,r,i,n,a,o){if(!t)return;!o&&a&&xpe(t,i,n,a);let l=t,u,c;for(;t.prev!==t.next;){if(u=t.prev,c=t.next,a?ppe(t,i,n,a):hpe(t)){e.push(u.i/r|0),e.push(t.i/r|0),e.push(c.i/r|0),R_(t),t=c.next,l=c.next;continue}if(t=c,t===l){o?o===1?(t=dpe(eg(t),e,r),L_(t,e,r,i,n,a,2)):o===2&&fpe(t,e,r,i,n,a):L_(eg(t),e,r,i,n,a,1);break}}}s(L_,"earcutLinked");function hpe(t){let e=t.prev,r=t,i=t.next;if(Qa(e,r,i)>=0)return!1;let n=e.x,a=r.x,o=i.x,l=e.y,u=r.y,c=i.y,p=n<a?n<o?n:o:a<o?a:o,m=l<u?l<c?l:c:u<c?u:c,y=n>a?n>o?n:o:a>o?a:o,v=l>u?l>c?l:c:u>c?u:c,w=i.next;for(;w!==e;){if(w.x>=p&&w.x<=y&&w.y>=m&&w.y<=v&&Cy(n,l,a,u,o,c,w.x,w.y)&&Qa(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}s(hpe,"isEar");function ppe(t,e,r,i){let n=t.prev,a=t,o=t.next;if(Qa(n,a,o)>=0)return!1;let l=n.x,u=a.x,c=o.x,p=n.y,m=a.y,y=o.y,v=l<u?l<c?l:c:u<c?u:c,w=p<m?p<y?p:y:m<y?m:y,E=l>u?l>c?l:c:u>c?u:c,M=p>m?p>y?p:y:m>y?m:y,I=q3(v,w,e,r,i),P=q3(E,M,e,r,i),C=t.prevZ,T=t.nextZ;for(;C&&C.z>=I&&T&&T.z<=P;){if(C.x>=v&&C.x<=E&&C.y>=w&&C.y<=M&&C!==n&&C!==o&&Cy(l,p,u,m,c,y,C.x,C.y)&&Qa(C.prev,C,C.next)>=0||(C=C.prevZ,T.x>=v&&T.x<=E&&T.y>=w&&T.y<=M&&T!==n&&T!==o&&Cy(l,p,u,m,c,y,T.x,T.y)&&Qa(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;C&&C.z>=I;){if(C.x>=v&&C.x<=E&&C.y>=w&&C.y<=M&&C!==n&&C!==o&&Cy(l,p,u,m,c,y,C.x,C.y)&&Qa(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;T&&T.z<=P;){if(T.x>=v&&T.x<=E&&T.y>=w&&T.y<=M&&T!==n&&T!==o&&Cy(l,p,u,m,c,y,T.x,T.y)&&Qa(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}s(ppe,"isEarHashed");function dpe(t,e,r){let i=t;do{let n=i.prev,a=i.next.next;!kA(n,a)&&EB(n,i,i.next,a)&&D_(n,a)&&D_(a,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(a.i/r|0),R_(i),R_(i.next),i=t=a),i=i.next}while(i!==t);return eg(i)}s(dpe,"cureLocalIntersections");function fpe(t,e,r,i,n,a){let o=t;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&Ape(o,l)){let u=CB(o,l);o=eg(o,o.next),u=eg(u,u.next),L_(o,e,r,i,n,a,0),L_(u,e,r,i,n,a,0);return}l=l.next}o=o.next}while(o!==t)}s(fpe,"splitEarcut");function mpe(t,e,r,i){let n=[],a,o,l,u,c;for(a=0,o=e.length;a<o;a++)l=e[a]*i,u=a<o-1?e[a+1]*i:t.length,c=MB(t,l,u,i,!1),c===c.next&&(c.steiner=!0),n.push(wpe(c));for(n.sort(gpe),a=0;a<n.length;a++)r=ype(n[a],r);return r}s(mpe,"eliminateHoles");function gpe(t,e){return t.x-e.x}s(gpe,"compareX");function ype(t,e){let r=vpe(t,e);if(!r)return e;let i=CB(r,t);return eg(i,i.next),eg(r,r.next)}s(ype,"eliminateHole");function vpe(t,e){let r=e,i=-1/0,n,a=t.x,o=t.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let y=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(y<=a&&y>i&&(i=y,n=r.x<r.next.x?r:r.next,y===a))return n}r=r.next}while(r!==e);if(!n)return null;let l=n,u=n.x,c=n.y,p=1/0,m;r=n;do a>=r.x&&r.x>=u&&a!==r.x&&Cy(o<c?a:i,o,u,c,o<c?i:a,o,r.x,r.y)&&(m=Math.abs(o-r.y)/(a-r.x),D_(r,t)&&(m<p||m===p&&(r.x>n.x||r.x===n.x&&_pe(n,r)))&&(n=r,p=m)),r=r.next;while(r!==l);return n}s(vpe,"findHoleBridge");function _pe(t,e){return Qa(t.prev,t,e.prev)<0&&Qa(e.next,t,t.next)<0}s(_pe,"sectorContainsSector");function xpe(t,e,r,i){let n=t;do n.z===0&&(n.z=q3(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,bpe(n)}s(xpe,"indexCurve");function bpe(t){let e,r,i,n,a,o,l,u,c=1;do{for(r=t,t=null,a=null,o=0;r;){for(o++,i=r,l=0,e=0;e<c&&(l++,i=i.nextZ,!!i);e++);for(u=c;l>0||u>0&&i;)l!==0&&(u===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,l--):(n=i,i=i.nextZ,u--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;r=i}a.nextZ=null,c*=2}while(o>1);return t}s(bpe,"sortLinked");function q3(t,e,r,i,n){return t=(t-r)*n|0,e=(e-i)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}s(q3,"zOrder");function wpe(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}s(wpe,"getLeftmost");function Cy(t,e,r,i,n,a,o,l){return(n-o)*(e-l)>=(t-o)*(a-l)&&(t-o)*(i-l)>=(r-o)*(e-l)&&(r-o)*(a-l)>=(n-o)*(i-l)}s(Cy,"pointInTriangle");function Ape(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Spe(t,e)&&(D_(t,e)&&D_(e,t)&&Mpe(t,e)&&(Qa(t.prev,t,e.prev)||Qa(t,e.prev,e))||kA(t,e)&&Qa(t.prev,t,t.next)>0&&Qa(e.prev,e,e.next)>0)}s(Ape,"isValidDiagonal");function Qa(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}s(Qa,"area");function kA(t,e){return t.x===e.x&&t.y===e.y}s(kA,"equals");function EB(t,e,r,i){let n=m2(Qa(t,e,r)),a=m2(Qa(t,e,i)),o=m2(Qa(r,i,t)),l=m2(Qa(r,i,e));return!!(n!==a&&o!==l||n===0&&f2(t,r,e)||a===0&&f2(t,i,e)||o===0&&f2(r,t,i)||l===0&&f2(r,e,i))}s(EB,"intersects");function f2(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}s(f2,"onSegment");function m2(t){return t>0?1:t<0?-1:0}s(m2,"sign");function Spe(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&EB(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}s(Spe,"intersectsPolygon");function D_(t,e){return Qa(t.prev,t,t.next)<0?Qa(t,e,t.next)>=0&&Qa(t,t.prev,e)>=0:Qa(t,e,t.prev)<0||Qa(t,t.next,e)<0}s(D_,"locallyInside");function Mpe(t,e){let r=t,i=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i}s(Mpe,"middleInside");function CB(t,e){let r=new W3(t.i,t.x,t.y),i=new W3(e.i,e.x,e.y),n=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}s(CB,"splitPolygon");function dO(t,e,r,i){let n=new W3(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}s(dO,"insertNode");function R_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}s(R_,"removeNode");function W3(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}s(W3,"Node");function Epe(t,e,r,i){let n=0;for(let a=e,o=r-i;a<r;a+=i)n+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return n}s(Epe,"signedArea");var Cpe=class Ipe{static area(e){let r=e.length,i=0;for(let n=r-1,a=0;a<r;n=a++)i+=e[n].x*e[a].y-e[a].x*e[n].y;return i*.5}static isClockWise(e){return Ipe.area(e)<0}static triangulateShape(e,r){let i=[],n=[],a=[];fO(e),mO(i,e);let o=e.length;r.forEach(fO);for(let u=0;u<r.length;u++)n.push(o),o+=r[u].length,mO(i,r[u]);let l=qVe.triangulate(i,n);for(let u=0;u<l.length;u+=3)a.push(l.slice(u,u+3));return a}};s(Cpe,"ShapeUtils");var b6=Cpe;function fO(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}s(fO,"removeDupEndPts");function mO(t,e){for(let r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}s(mO,"addContour");var Tpe=class Ppe extends js{constructor(e=new sx([new Jt(.5,.5),new Jt(-.5,.5),new Jt(-.5,-.5),new Jt(.5,-.5)]),r={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];let i=this,n=[],a=[];for(let l=0,u=e.length;l<u;l++){let c=e[l];o(c)}this.setAttribute("position",new yo(n,3)),this.setAttribute("uv",new yo(a,2)),this.computeVertexNormals();function o(l){let u=[],c=r.curveSegments!==void 0?r.curveSegments:12,p=r.steps!==void 0?r.steps:1,m=r.depth!==void 0?r.depth:1,y=r.bevelEnabled!==void 0?r.bevelEnabled:!0,v=r.bevelThickness!==void 0?r.bevelThickness:.2,w=r.bevelSize!==void 0?r.bevelSize:v-.1,E=r.bevelOffset!==void 0?r.bevelOffset:0,M=r.bevelSegments!==void 0?r.bevelSegments:3,I=r.extrudePath,P=r.UVGenerator!==void 0?r.UVGenerator:WVe,C,T=!1,O,F,k,B;I&&(C=I.getSpacedPoints(p),T=!0,y=!1,O=I.computeFrenetFrames(p,!1),F=new qe,k=new qe,B=new qe),y||(M=0,v=0,w=0,E=0);let U=l.extractPoints(c),z=U.shape,q=U.holes;if(!b6.isClockWise(z)){z=z.reverse();for(let me=0,Ae=q.length;me<Ae;me++){let Ue=q[me];b6.isClockWise(Ue)&&(q[me]=Ue.reverse())}}let W=b6.triangulateShape(z,q),J=z;for(let me=0,Ae=q.length;me<Ae;me++){let Ue=q[me];z=z.concat(Ue)}function V(me,Ae,Ue){return Ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),me.clone().addScaledVector(Ae,Ue)}s(V,"scalePt2");let oe=z.length,Y=W.length;function he(me,Ae,Ue){let _e,lt,tt,We=me.x-Ae.x,at=me.y-Ae.y,Lt=Ue.x-me.x,dt=Ue.y-me.y,Me=We*We+at*at,ve=We*dt-at*Lt;if(Math.abs(ve)>Number.EPSILON){let Ze=Math.sqrt(Me),It=Math.sqrt(Lt*Lt+dt*dt),Rt=Ae.x-at/Ze,Et=Ae.y+We/Ze,pt=Ue.x-dt/It,Yt=Ue.y+Lt/It,Kt=((pt-Rt)*dt-(Yt-Et)*Lt)/(We*dt-at*Lt);_e=Rt+We*Kt-me.x,lt=Et+at*Kt-me.y;let $t=_e*_e+lt*lt;if($t<=2)return new Jt(_e,lt);tt=Math.sqrt($t/2)}else{let Ze=!1;We>Number.EPSILON?Lt>Number.EPSILON&&(Ze=!0):We<-Number.EPSILON?Lt<-Number.EPSILON&&(Ze=!0):Math.sign(at)===Math.sign(dt)&&(Ze=!0),Ze?(_e=-at,lt=We,tt=Math.sqrt(Me)):(_e=We,lt=at,tt=Math.sqrt(Me/2))}return new Jt(_e/tt,lt/tt)}s(he,"getBevelVec");let Q=[];for(let me=0,Ae=J.length,Ue=Ae-1,_e=me+1;me<Ae;me++,Ue++,_e++)Ue===Ae&&(Ue=0),_e===Ae&&(_e=0),Q[me]=he(J[me],J[Ue],J[_e]);let ae=[],ee,le=Q.concat();for(let me=0,Ae=q.length;me<Ae;me++){let Ue=q[me];ee=[];for(let _e=0,lt=Ue.length,tt=lt-1,We=_e+1;_e<lt;_e++,tt++,We++)tt===lt&&(tt=0),We===lt&&(We=0),ee[_e]=he(Ue[_e],Ue[tt],Ue[We]);ae.push(ee),le=le.concat(ee)}for(let me=0;me<M;me++){let Ae=me/M,Ue=v*Math.cos(Ae*Math.PI/2),_e=w*Math.sin(Ae*Math.PI/2)+E;for(let lt=0,tt=J.length;lt<tt;lt++){let We=V(J[lt],Q[lt],_e);pe(We.x,We.y,-Ue)}for(let lt=0,tt=q.length;lt<tt;lt++){let We=q[lt];ee=ae[lt];for(let at=0,Lt=We.length;at<Lt;at++){let dt=V(We[at],ee[at],_e);pe(dt.x,dt.y,-Ue)}}}let K=w+E;for(let me=0;me<oe;me++){let Ae=y?V(z[me],le[me],K):z[me];T?(k.copy(O.normals[0]).multiplyScalar(Ae.x),F.copy(O.binormals[0]).multiplyScalar(Ae.y),B.copy(C[0]).add(k).add(F),pe(B.x,B.y,B.z)):pe(Ae.x,Ae.y,0)}for(let me=1;me<=p;me++)for(let Ae=0;Ae<oe;Ae++){let Ue=y?V(z[Ae],le[Ae],K):z[Ae];T?(k.copy(O.normals[me]).multiplyScalar(Ue.x),F.copy(O.binormals[me]).multiplyScalar(Ue.y),B.copy(C[me]).add(k).add(F),pe(B.x,B.y,B.z)):pe(Ue.x,Ue.y,m/p*me)}for(let me=M-1;me>=0;me--){let Ae=me/M,Ue=v*Math.cos(Ae*Math.PI/2),_e=w*Math.sin(Ae*Math.PI/2)+E;for(let lt=0,tt=J.length;lt<tt;lt++){let We=V(J[lt],Q[lt],_e);pe(We.x,We.y,m+Ue)}for(let lt=0,tt=q.length;lt<tt;lt++){let We=q[lt];ee=ae[lt];for(let at=0,Lt=We.length;at<Lt;at++){let dt=V(We[at],ee[at],_e);T?pe(dt.x,dt.y+C[p-1].y,C[p-1].x+Ue):pe(dt.x,dt.y,m+Ue)}}}ce(),te();function ce(){let me=n.length/3;if(y){let Ae=0,Ue=oe*Ae;for(let _e=0;_e<Y;_e++){let lt=W[_e];xe(lt[2]+Ue,lt[1]+Ue,lt[0]+Ue)}Ae=p+M*2,Ue=oe*Ae;for(let _e=0;_e<Y;_e++){let lt=W[_e];xe(lt[0]+Ue,lt[1]+Ue,lt[2]+Ue)}}else{for(let Ae=0;Ae<Y;Ae++){let Ue=W[Ae];xe(Ue[2],Ue[1],Ue[0])}for(let Ae=0;Ae<Y;Ae++){let Ue=W[Ae];xe(Ue[0]+oe*p,Ue[1]+oe*p,Ue[2]+oe*p)}}i.addGroup(me,n.length/3-me,0)}s(ce,"buildLidFaces");function te(){let me=n.length/3,Ae=0;ne(J,Ae),Ae+=J.length;for(let Ue=0,_e=q.length;Ue<_e;Ue++){let lt=q[Ue];ne(lt,Ae),Ae+=lt.length}i.addGroup(me,n.length/3-me,1)}s(te,"buildSideFaces");function ne(me,Ae){let Ue=me.length;for(;--Ue>=0;){let _e=Ue,lt=Ue-1;lt<0&&(lt=me.length-1);for(let tt=0,We=p+M*2;tt<We;tt++){let at=oe*tt,Lt=oe*(tt+1),dt=Ae+_e+at,Me=Ae+lt+at,ve=Ae+lt+Lt,Ze=Ae+_e+Lt;Te(dt,Me,ve,Ze)}}}s(ne,"sidewalls");function pe(me,Ae,Ue){u.push(me),u.push(Ae),u.push(Ue)}s(pe,"v");function xe(me,Ae,Ue){fe(me),fe(Ae),fe(Ue);let _e=n.length/3,lt=P.generateTopUV(i,n,_e-3,_e-2,_e-1);Pe(lt[0]),Pe(lt[1]),Pe(lt[2])}s(xe,"f3");function Te(me,Ae,Ue,_e){fe(me),fe(Ae),fe(_e),fe(Ae),fe(Ue),fe(_e);let lt=n.length/3,tt=P.generateSideWallUV(i,n,lt-6,lt-3,lt-2,lt-1);Pe(tt[0]),Pe(tt[1]),Pe(tt[3]),Pe(tt[1]),Pe(tt[2]),Pe(tt[3])}s(Te,"f4");function fe(me){n.push(u[me*3+0]),n.push(u[me*3+1]),n.push(u[me*3+2])}s(fe,"addVertex");function Pe(me){a.push(me.x),a.push(me.y)}s(Pe,"addUV")}s(o,"addShape")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),r=this.parameters.shapes,i=this.parameters.options;return Lpe(r,i,e)}static fromJSON(e,r){let i=[];for(let a=0,o=e.shapes.length;a<o;a++){let l=r[e.shapes[a]];i.push(l)}let n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new H3[n.type]().fromJSON(n)),new Ppe(i,e.options)}};s(Tpe,"ExtrudeGeometry");var NA=Tpe,WVe={generateTopUV:s(function(t,e,r,i,n){let a=e[r*3],o=e[r*3+1],l=e[i*3],u=e[i*3+1],c=e[n*3],p=e[n*3+1];return[new Jt(a,o),new Jt(l,u),new Jt(c,p)]},"generateTopUV"),generateSideWallUV:s(function(t,e,r,i,n,a){let o=e[r*3],l=e[r*3+1],u=e[r*3+2],c=e[i*3],p=e[i*3+1],m=e[i*3+2],y=e[n*3],v=e[n*3+1],w=e[n*3+2],E=e[a*3],M=e[a*3+1],I=e[a*3+2];return Math.abs(l-p)<Math.abs(o-c)?[new Jt(o,1-u),new Jt(c,1-m),new Jt(y,1-w),new Jt(E,1-I)]:[new Jt(l,1-u),new Jt(p,1-m),new Jt(v,1-w),new Jt(M,1-I)]},"generateSideWallUV")};function Lpe(t,e,r){if(r.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){let a=t[i];r.shapes.push(a.uuid)}else r.shapes.push(t.uuid);return r.options=Object.assign({},e),e.extrudePath!==void 0&&(r.options.extrudePath=e.extrudePath.toJSON()),r}s(Lpe,"toJSON$1");var Dpe=class Rpe extends js{constructor(e=1,r=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:r,widthSegments:i,heightSegments:n};let a=e/2,o=r/2,l=Math.floor(i),u=Math.floor(n),c=l+1,p=u+1,m=e/l,y=r/u,v=[],w=[],E=[],M=[];for(let I=0;I<p;I++){let P=I*y-o;for(let C=0;C<c;C++){let T=C*m-a;w.push(T,-P,0),E.push(0,0,1),M.push(C/l),M.push(1-I/u)}}for(let I=0;I<u;I++)for(let P=0;P<l;P++){let C=P+c*I,T=P+c*(I+1),O=P+1+c*(I+1),F=P+1+c*I;v.push(C,T,F),v.push(T,O,F)}this.setIndex(v),this.setAttribute("position",new yo(w,3)),this.setAttribute("normal",new yo(E,3)),this.setAttribute("uv",new yo(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rpe(e.width,e.height,e.widthSegments,e.heightSegments)}};s(Dpe,"PlaneGeometry");var pv=Dpe,XVe=class Ope extends js{constructor(e=1,r=32,i=16,n=0,a=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:r,heightSegments:i,phiStart:n,phiLength:a,thetaStart:o,thetaLength:l},r=Math.max(3,Math.floor(r)),i=Math.max(2,Math.floor(i));let u=Math.min(o+l,Math.PI),c=0,p=[],m=new qe,y=new qe,v=[],w=[],E=[],M=[];for(let I=0;I<=i;I++){let P=[],C=I/i,T=0;I===0&&o===0?T=.5/r:I===i&&u===Math.PI&&(T=-.5/r);for(let O=0;O<=r;O++){let F=O/r;m.x=-e*Math.cos(n+F*a)*Math.sin(o+C*l),m.y=e*Math.cos(o+C*l),m.z=e*Math.sin(n+F*a)*Math.sin(o+C*l),w.push(m.x,m.y,m.z),y.copy(m).normalize(),E.push(y.x,y.y,y.z),M.push(F+T,1-C),P.push(c++)}p.push(P)}for(let I=0;I<i;I++)for(let P=0;P<r;P++){let C=p[I][P+1],T=p[I][P],O=p[I+1][P],F=p[I+1][P+1];(I!==0||o>0)&&v.push(C,T,F),(I!==i-1||u<Math.PI)&&v.push(T,O,F)}this.setIndex(v),this.setAttribute("position",new yo(w,3)),this.setAttribute("normal",new yo(E,3)),this.setAttribute("uv",new yo(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ope(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};s(XVe,"SphereGeometry");var kpe=class Npe extends js{constructor(e=new rpe(new qe(-1,-1,0),new qe(-1,1,0),new qe(1,1,0)),r=64,i=1,n=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:r,radius:i,radialSegments:n,closed:a};let o=e.computeFrenetFrames(r,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let l=new qe,u=new qe,c=new Jt,p=new qe,m=[],y=[],v=[],w=[];E(),this.setIndex(w),this.setAttribute("position",new yo(m,3)),this.setAttribute("normal",new yo(y,3)),this.setAttribute("uv",new yo(v,2));function E(){for(let C=0;C<r;C++)M(C);M(a===!1?r:0),P(),I()}s(E,"generateBufferData");function M(C){p=e.getPointAt(C/r,p);let T=o.normals[C],O=o.binormals[C];for(let F=0;F<=n;F++){let k=F/n*Math.PI*2,B=Math.sin(k),U=-Math.cos(k);u.x=U*T.x+B*O.x,u.y=U*T.y+B*O.y,u.z=U*T.z+B*O.z,u.normalize(),y.push(u.x,u.y,u.z),l.x=p.x+i*u.x,l.y=p.y+i*u.y,l.z=p.z+i*u.z,m.push(l.x,l.y,l.z)}}s(M,"generateSegment");function I(){for(let C=1;C<=r;C++)for(let T=1;T<=n;T++){let O=(n+1)*(C-1)+(T-1),F=(n+1)*C+(T-1),k=(n+1)*C+T,B=(n+1)*(C-1)+T;w.push(O,F,B),w.push(F,k,B)}}s(I,"generateIndices");function P(){for(let C=0;C<=r;C++)for(let T=0;T<=n;T++)c.x=C/r,c.y=T/n,v.push(c.x,c.y)}s(P,"generateUVs")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Npe(new H3[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};s(kpe,"TubeGeometry");var ZVe=kpe,Fpe=class extends lg{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new si(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new si(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gB,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nu,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};s(Fpe,"MeshStandardMaterial");var Bpe=Fpe,zpe=class extends Bpe{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Jt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:s(function(){return Ji(2.5*(this.ior-1)/(this.ior+1),0,1)},"get"),set:s(function(r){this.ior=(1+.4*r)/(1-.4*r)},"set")}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new si(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new si(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new si(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};s(zpe,"MeshPhysicalMaterial");var wct=zpe,Upe=class extends lg{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new si(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new si(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gB,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nu,this.combine=uB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};s(Upe,"MeshLambertMaterial");var O_=Upe,Vpe=class extends lg{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=QUe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};s(Vpe,"MeshDepthMaterial");var YVe=Vpe,jpe=class extends lg{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};s(jpe,"MeshDistanceMaterial");var KVe=jpe;function g2(t,e,r){return!t||!r&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}s(g2,"convertArray");function $pe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}s($pe,"isTypedArray");function Gpe(t){function e(n,a){return t[n]-t[a]}s(e,"compareTime");let r=t.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(e),i}s(Gpe,"getKeyframeOrder");function gO(t,e,r){let i=t.length,n=new t.constructor(i);for(let a=0,o=0;o!==i;++a){let l=r[a]*e;for(let u=0;u!==e;++u)n[o++]=t[l+u]}return n}s(gO,"sortedArray");function IB(t,e,r,i){let n=1,a=t[0];for(;a!==void 0&&a[i]===void 0;)a=t[n++];if(a===void 0)return;let o=a[i];if(o!==void 0)if(Array.isArray(o))do o=a[i],o!==void 0&&(e.push(a.time),r.push.apply(r,o)),a=t[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[i],o!==void 0&&(e.push(a.time),o.toArray(r,r.length)),a=t[n++];while(a!==void 0);else do o=a[i],o!==void 0&&(e.push(a.time),r.push(o)),a=t[n++];while(a!==void 0)}s(IB,"flattenJSON");var Hpe=class{constructor(e,r,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new r.constructor(i),this.sampleValues=r,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let r=this.parameterPositions,i=this._cachedIndex,n=r[i],a=r[i-1];e:{t:{let o;r:{i:if(!(e<n)){for(let l=i+2;;){if(n===void 0){if(e<a)break i;return i=r.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(a=n,n=r[++i],e<n)break t}o=r.length;break r}if(!(e>=a)){let l=r[1];e<l&&(i=2,a=l);for(let u=i-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===u)break;if(n=a,a=r[--i-1],e>=a)break t}o=i,i=0;break r}break e}for(;i<o;){let l=i+o>>>1;e<r[l]?o=l:i=l+1}if(n=r[i],a=r[i-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=r.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,a,n)}return this.interpolate_(i,a,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let r=this.resultBuffer,i=this.sampleValues,n=this.valueSize,a=e*n;for(let o=0;o!==n;++o)r[o]=i[a+o];return r}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};s(Hpe,"Interpolant");var BP=Hpe,qpe=class extends BP{constructor(e,r,i,n){super(e,r,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:bq,endingEnd:bq}}intervalChanged_(e,r,i){let n=this.parameterPositions,a=e-2,o=e+1,l=n[a],u=n[o];if(l===void 0)switch(this.getSettings_().endingStart){case wq:a=e,l=2*r-i;break;case Aq:a=n.length-2,l=r+n[a]-n[a+1];break;default:a=e,l=i}if(u===void 0)switch(this.getSettings_().endingEnd){case wq:o=e,u=2*i-r;break;case Aq:o=1,u=i+n[1]-n[0];break;default:o=e-1,u=r}let c=(i-r)*.5,p=this.valueSize;this._weightPrev=c/(r-l),this._weightNext=c/(u-i),this._offsetPrev=a*p,this._offsetNext=o*p}interpolate_(e,r,i,n){let a=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,c=u-l,p=this._offsetPrev,m=this._offsetNext,y=this._weightPrev,v=this._weightNext,w=(i-r)/(n-r),E=w*w,M=E*w,I=-y*M+2*y*E-y*w,P=(1+y)*M+(-1.5-2*y)*E+(-.5+y)*w+1,C=(-1-v)*M+(1.5+v)*E+.5*w,T=v*M-v*E;for(let O=0;O!==l;++O)a[O]=I*o[p+O]+P*o[c+O]+C*o[u+O]+T*o[m+O];return a}};s(qpe,"CubicInterpolant");var JVe=qpe,Wpe=class extends BP{constructor(e,r,i,n){super(e,r,i,n)}interpolate_(e,r,i,n){let a=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,c=u-l,p=(i-r)/(n-r),m=1-p;for(let y=0;y!==l;++y)a[y]=o[c+y]*m+o[u+y]*p;return a}};s(Wpe,"LinearInterpolant");var QVe=Wpe,Xpe=class extends BP{constructor(e,r,i,n){super(e,r,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}};s(Xpe,"DiscreteInterpolant");var eje=Xpe,Zpe=class{constructor(e,r,i,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=g2(r,this.TimeBufferType),this.values=g2(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let r=e.constructor,i;if(r.toJSON!==this.toJSON)i=r.toJSON(e);else{i={name:e.name,times:g2(e.times,Array),values:g2(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(i.interpolation=n)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new eje(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new QVe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new JVe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let r;switch(e){case z3:r=this.InterpolantFactoryMethodDiscrete;break;case nO:r=this.InterpolantFactoryMethodLinear;break;case qL:r=this.InterpolantFactoryMethodSmooth;break}if(r===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=r,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return z3;case this.InterpolantFactoryMethodLinear:return nO;case this.InterpolantFactoryMethodSmooth:return qL}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let r=this.times;for(let i=0,n=r.length;i!==n;++i)r[i]+=e}return this}scale(e){if(e!==1){let r=this.times;for(let i=0,n=r.length;i!==n;++i)r[i]*=e}return this}trim(e,r){let i=this.times,n=i.length,a=0,o=n-1;for(;a!==n&&i[a]<e;)++a;for(;o!==-1&&i[o]>r;)--o;if(++o,a!==0||o!==n){a>=o&&(o=Math.max(o,1),a=o-1);let l=this.getValueSize();this.times=i.slice(a,o),this.values=this.values.slice(a*l,o*l)}return this}validate(){let e=!0,r=this.getValueSize();r-Math.floor(r)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,n=this.values,a=i.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==a;l++){let u=i[l];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(o!==null&&o>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,o),e=!1;break}o=u}if(n!==void 0&&$pe(n))for(let l=0,u=n.length;l!==u;++l){let c=n[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}optimize(){let e=this.times.slice(),r=this.values.slice(),i=this.getValueSize(),n=this.getInterpolation()===qL,a=e.length-1,o=1;for(let l=1;l<a;++l){let u=!1,c=e[l],p=e[l+1];if(c!==p&&(l!==1||c!==e[0]))if(n)u=!0;else{let m=l*i,y=m-i,v=m+i;for(let w=0;w!==i;++w){let E=r[m+w];if(E!==r[y+w]||E!==r[v+w]){u=!0;break}}}if(u){if(l!==o){e[o]=e[l];let m=l*i,y=o*i;for(let v=0;v!==i;++v)r[y+v]=r[m+v]}++o}}if(a>0){e[o]=e[a];for(let l=a*i,u=o*i,c=0;c!==i;++c)r[u+c]=r[l+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=r.slice(0,o*i)):(this.times=e,this.values=r),this}clone(){let e=this.times.slice(),r=this.values.slice(),i=this.constructor,n=new i(this.name,e,r);return n.createInterpolant=this.createInterpolant,n}};s(Zpe,"KeyframeTrack");var ad=Zpe;ad.prototype.TimeBufferType=Float32Array;ad.prototype.ValueBufferType=Float32Array;ad.prototype.DefaultInterpolation=nO;var Ype=class extends ad{constructor(e,r,i){super(e,r,i)}};s(Ype,"BooleanKeyframeTrack");var lx=Ype;lx.prototype.ValueTypeName="bool";lx.prototype.ValueBufferType=Array;lx.prototype.DefaultInterpolation=z3;lx.prototype.InterpolantFactoryMethodLinear=void 0;lx.prototype.InterpolantFactoryMethodSmooth=void 0;var Kpe=class extends ad{};s(Kpe,"ColorKeyframeTrack");var Jpe=Kpe;Jpe.prototype.ValueTypeName="color";var Qpe=class extends ad{};s(Qpe,"NumberKeyframeTrack");var X3=Qpe;X3.prototype.ValueTypeName="number";var ede=class extends BP{constructor(e,r,i,n){super(e,r,i,n)}interpolate_(e,r,i,n){let a=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=(i-r)/(n-r),c=e*l;for(let p=c+l;c!==p;c+=4)ff.slerpFlat(a,0,o,c-l,o,c,u);return a}};s(ede,"QuaternionLinearInterpolant");var tje=ede,tde=class extends ad{InterpolantFactoryMethodLinear(e){return new tje(this.times,this.values,this.getValueSize(),e)}};s(tde,"QuaternionKeyframeTrack");var zP=tde;zP.prototype.ValueTypeName="quaternion";zP.prototype.InterpolantFactoryMethodSmooth=void 0;var rde=class extends ad{constructor(e,r,i){super(e,r,i)}};s(rde,"StringKeyframeTrack");var ux=rde;ux.prototype.ValueTypeName="string";ux.prototype.ValueBufferType=Array;ux.prototype.DefaultInterpolation=z3;ux.prototype.InterpolantFactoryMethodLinear=void 0;ux.prototype.InterpolantFactoryMethodSmooth=void 0;var ide=class extends ad{};s(ide,"VectorKeyframeTrack");var Z3=ide;Z3.prototype.ValueTypeName="vector";var nde=class{constructor(e="",r=-1,i=[],n=YUe){this.name=e,this.tracks=i,this.duration=r,this.blendMode=n,this.uuid=xc(),this.duration<0&&this.resetDuration()}static parse(e){let r=[],i=e.tracks,n=1/(e.fps||1);for(let o=0,l=i.length;o!==l;++o)r.push(ode(i[o]).scale(n));let a=new this(e.name,e.duration,r,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){let r=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:r,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,o=i.length;a!==o;++a)r.push(ad.toJSON(i[a]));return n}static CreateFromMorphTargetSequence(e,r,i,n){let a=r.length,o=[];for(let l=0;l<a;l++){let u=[],c=[];u.push((l+a-1)%a,l,(l+1)%a),c.push(0,1,0);let p=Gpe(u);u=gO(u,1,p),c=gO(c,1,p),!n&&u[0]===0&&(u.push(a),c.push(c[0])),o.push(new X3(".morphTargetInfluences["+r[l].name+"]",u,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,r){let i=e;if(!Array.isArray(e)){let n=e;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===r)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,r,i){let n={},a=/^([\w-]*?)([\d]+)$/;for(let l=0,u=e.length;l<u;l++){let c=e[l],p=c.name.match(a);if(p&&p.length>1){let m=p[1],y=n[m];y||(n[m]=y=[]),y.push(c)}}let o=[];for(let l in n)o.push(this.CreateFromMorphTargetSequence(l,n[l],r,i));return o}static parseAnimation(e,r){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=s(function(p,m,y,v,w){if(y.length!==0){let E=[],M=[];IB(y,E,M,v),E.length!==0&&w.push(new p(m,E,M))}},"addNonemptyTrack"),n=[],a=e.name||"default",o=e.fps||30,l=e.blendMode,u=e.length||-1,c=e.hierarchy||[];for(let p=0;p<c.length;p++){let m=c[p].keys;if(!(!m||m.length===0))if(m[0].morphTargets){let y={},v;for(v=0;v<m.length;v++)if(m[v].morphTargets)for(let w=0;w<m[v].morphTargets.length;w++)y[m[v].morphTargets[w]]=-1;for(let w in y){let E=[],M=[];for(let I=0;I!==m[v].morphTargets.length;++I){let P=m[v];E.push(P.time),M.push(P.morphTarget===w?1:0)}n.push(new X3(".morphTargetInfluence["+w+"]",E,M))}u=y.length*o}else{let y=".bones["+r[p].name+"]";i(Z3,y+".position",m,"pos",n),i(zP,y+".quaternion",m,"rot",n),i(Z3,y+".scale",m,"scl",n)}}return n.length===0?null:new this(a,u,n,l)}resetDuration(){let e=this.tracks,r=0;for(let i=0,n=e.length;i!==n;++i){let a=this.tracks[i];r=Math.max(r,a.times[a.times.length-1])}return this.duration=r,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let r=0;r<this.tracks.length;r++)e=e&&this.tracks[r].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let r=0;r<this.tracks.length;r++)e.push(this.tracks[r].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};s(nde,"AnimationClip");var zct=nde;function ade(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return X3;case"vector":case"vector2":case"vector3":case"vector4":return Z3;case"color":return Jpe;case"quaternion":return zP;case"bool":case"boolean":return lx;case"string":return ux}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}s(ade,"getTrackTypeForValueTypeName");function ode(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=ade(t.type);if(t.times===void 0){let r=[],i=[];IB(t.keys,r,i,"value"),t.times=r,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}s(ode,"parseKeyframeTrack");var Vm={enabled:!1,files:{},add:s(function(t,e){this.enabled!==!1&&(this.files[t]=e)},"add"),get:s(function(t){if(this.enabled!==!1)return this.files[t]},"get"),remove:s(function(t){delete this.files[t]},"remove"),clear:s(function(){this.files={}},"clear")},sde=class{constructor(e,r,i){let n=this,a=!1,o=0,l=0,u,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=r,this.onError=i,this.itemStart=function(p){l++,a===!1&&n.onStart!==void 0&&n.onStart(p,o,l),a=!0},this.itemEnd=function(p){o++,n.onProgress!==void 0&&n.onProgress(p,o,l),o===l&&(a=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(p){n.onError!==void 0&&n.onError(p)},this.resolveURL=function(p){return u?u(p):p},this.setURLModifier=function(p){return u=p,this},this.addHandler=function(p,m){return c.push(p,m),this},this.removeHandler=function(p){let m=c.indexOf(p);return m!==-1&&c.splice(m,2),this},this.getHandler=function(p){for(let m=0,y=c.length;m<y;m+=2){let v=c[m],w=c[m+1];if(v.global&&(v.lastIndex=0),v.test(p))return w}return null}}};s(sde,"LoadingManager");var rje=sde,ije=new rje,lde=class{constructor(e){this.manager=e!==void 0?e:ije,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,r){let i=this;return new Promise(function(n,a){i.load(e,n,r,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};s(lde,"Loader");var FA=lde;FA.DEFAULT_MATERIAL_NAME="__DEFAULT";var Pd={},ude=class extends Error{constructor(e,r){super(e),this.response=r}};s(ude,"HttpError");var nje=ude,cde=class extends FA{constructor(e){super(e)}load(e,r,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=Vm.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{r&&r(a),this.manager.itemEnd(e)},0),a;if(Pd[e]!==void 0){Pd[e].push({onLoad:r,onProgress:i,onError:n});return}Pd[e]=[],Pd[e].push({onLoad:r,onProgress:i,onError:n});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,u=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;let p=Pd[e],m=c.body.getReader(),y=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),v=y?parseInt(y):0,w=v!==0,E=0,M=new ReadableStream({start(I){P();function P(){m.read().then(({done:C,value:T})=>{if(C)I.close();else{E+=T.byteLength;let O=new ProgressEvent("progress",{lengthComputable:w,loaded:E,total:v});for(let F=0,k=p.length;F<k;F++){let B=p[F];B.onProgress&&B.onProgress(O)}I.enqueue(T),P()}},C=>{I.error(C)})}s(P,"readData")}});return new Response(M)}else throw new nje('fetch for "'.concat(c.url,'" responded with ').concat(c.status,": ").concat(c.statusText),c)}).then(c=>{switch(u){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(p=>new DOMParser().parseFromString(p,l));case"json":return c.json();default:if(l===void 0)return c.text();{let p=/charset="?([^;"\s]*)"?/i.exec(l),m=p&&p[1]?p[1].toLowerCase():void 0,y=new TextDecoder(m);return c.arrayBuffer().then(v=>y.decode(v))}}}).then(c=>{Vm.add(e,c);let p=Pd[e];delete Pd[e];for(let m=0,y=p.length;m<y;m++){let v=p[m];v.onLoad&&v.onLoad(c)}}).catch(c=>{let p=Pd[e];if(p===void 0)throw this.manager.itemError(e),c;delete Pd[e];for(let m=0,y=p.length;m<y;m++){let v=p[m];v.onError&&v.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};s(cde,"FileLoader");var Gct=cde,hde=class extends FA{constructor(e){super(e)}load(e,r,i,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Vm.get(e);if(o!==void 0)return a.manager.itemStart(e),setTimeout(function(){r&&r(o),a.manager.itemEnd(e)},0),o;let l=T_("img");function u(){p(),Vm.add(e,this),r&&r(this),a.manager.itemEnd(e)}s(u,"onImageLoad");function c(m){p(),n&&n(m),a.manager.itemError(e),a.manager.itemEnd(e)}s(c,"onImageError");function p(){l.removeEventListener("load",u,!1),l.removeEventListener("error",c,!1)}return s(p,"removeEventListeners"),l.addEventListener("load",u,!1),l.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),a.manager.itemStart(e),l.src=e,l}};s(hde,"ImageLoader");var aje=hde,pde=class extends FA{constructor(e){super(e)}load(e,r,i,n){let a=new Gu,o=new aje(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){a.image=l,a.needsUpdate=!0,r!==void 0&&r(a)},i,n),a}};s(pde,"TextureLoader");var TB=pde,dde=class extends qa{constructor(e,r=1){super(),this.isLight=!0,this.type="Light",this.color=new si(e),this.intensity=r}dispose(){}copy(e,r){return super.copy(e,r),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let r=super.toJSON(e);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,this.groundColor!==void 0&&(r.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(r.object.distance=this.distance),this.angle!==void 0&&(r.object.angle=this.angle),this.decay!==void 0&&(r.object.decay=this.decay),this.penumbra!==void 0&&(r.object.penumbra=this.penumbra),this.shadow!==void 0&&(r.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(r.object.target=this.target.uuid),r}};s(dde,"Light");var UP=dde,w6=new Oi,nW=new qe,aW=new qe,fde=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jt(512,512),this.map=null,this.mapPass=null,this.matrix=new Oi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new OA,this._frameExtents=new Jt(1,1),this._viewportCount=1,this._viewports=[new Qn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let r=this.camera,i=this.matrix;nW.setFromMatrixPosition(e.matrixWorld),r.position.copy(nW),aW.setFromMatrixPosition(e.target.matrixWorld),r.lookAt(aW),r.updateMatrixWorld(),w6.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(w6),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(w6)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};s(fde,"LightShadow");var PB=fde,mde=class extends PB{constructor(){super(new Kl(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let r=this.camera,i=I_*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,a=e.distance||r.far;(i!==r.fov||n!==r.aspect||a!==r.far)&&(r.fov=i,r.aspect=n,r.far=a,r.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};s(mde,"SpotLightShadow");var oje=mde,gde=class extends UP{constructor(e,r,i=0,n=Math.PI/3,a=0,o=2){super(e,r),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(qa.DEFAULT_UP),this.updateMatrix(),this.target=new qa,this.distance=i,this.angle=n,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new oje}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,r){return super.copy(e,r),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};s(gde,"SpotLight");var Kct=gde,oW=new Oi,zb=new qe,A6=new qe,yde=class extends PB{constructor(){super(new Kl(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Jt(4,2),this._viewportCount=6,this._viewports=[new Qn(2,1,1,1),new Qn(0,1,1,1),new Qn(3,1,1,1),new Qn(1,1,1,1),new Qn(3,0,1,1),new Qn(1,0,1,1)],this._cubeDirections=[new qe(1,0,0),new qe(-1,0,0),new qe(0,0,1),new qe(0,0,-1),new qe(0,1,0),new qe(0,-1,0)],this._cubeUps=[new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,0,1),new qe(0,0,-1)]}updateMatrices(e,r=0){let i=this.camera,n=this.matrix,a=e.distance||i.far;a!==i.far&&(i.far=a,i.updateProjectionMatrix()),zb.setFromMatrixPosition(e.matrixWorld),i.position.copy(zb),A6.copy(i.position),A6.add(this._cubeDirections[r]),i.up.copy(this._cubeUps[r]),i.lookAt(A6),i.updateMatrixWorld(),n.makeTranslation(-zb.x,-zb.y,-zb.z),oW.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(oW)}};s(yde,"PointLightShadow");var sje=yde,vde=class extends UP{constructor(e,r,i=0,n=2){super(e,r),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new sje}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,r){return super.copy(e,r),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};s(vde,"PointLight");var eht=vde,_de=class extends xB{constructor(e=-1,r=1,i=1,n=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=r,this.top=i,this.bottom=n,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,r,i,n,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,a=i-e,o=i+e,l=n+r,u=n-r;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=c*this.view.offsetX,o=a+c*this.view.width,l-=p*this.view.offsetY,u=l-p*this.view.height}this.projectionMatrix.makeOrthographic(a,o,l,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let r=super.toJSON(e);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,this.view!==null&&(r.object.view=Object.assign({},this.view)),r}};s(_de,"OrthographicCamera");var xde=_de,bde=class extends PB{constructor(){super(new xde(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}};s(bde,"DirectionalLightShadow");var lje=bde,wde=class extends UP{constructor(e,r){super(e,r),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(qa.DEFAULT_UP),this.updateMatrix(),this.target=new qa,this.shadow=new lje}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};s(wde,"DirectionalLight");var Ade=wde,Sde=class extends UP{constructor(e,r){super(e,r),this.isAmbientLight=!0,this.type="AmbientLight"}};s(Sde,"AmbientLight");var uje=Sde,Mde=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let r="";for(let i=0,n=e.length;i<n;i++)r+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(r))}catch{return r}}static extractUrlBase(e){let r=e.lastIndexOf("/");return r===-1?"./":e.slice(0,r+1)}static resolveURL(e,r){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(r)&&/^\//.test(e)&&(r=r.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:r+e)}};s(Mde,"LoaderUtils");var oht=Mde,Ede=class extends js{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};s(Ede,"InstancedBufferGeometry");var lht=Ede,Cde=class extends FA{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,r,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Vm.get(e);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(c=>{r&&r(c),a.manager.itemEnd(e)}).catch(c=>{n&&n(c)});return}return setTimeout(function(){r&&r(o),a.manager.itemEnd(e)},0),o}let l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;let u=fetch(e,l).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(c){return Vm.add(e,c),r&&r(c),a.manager.itemEnd(e),c}).catch(function(c){n&&n(c),Vm.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});Vm.add(e,u),a.manager.itemStart(e)}};s(Cde,"ImageBitmapLoader");var cht=Cde,Ide=class extends Kl{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}};s(Ide,"ArrayCamera");var cje=Ide,Tde=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=yO(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let r=yO();e=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=e}return e}};s(Tde,"Clock");var hje=Tde;function yO(){return performance.now()}s(yO,"now");var LB="\\[\\]\\.:\\/",pje=new RegExp("["+LB+"]","g"),DB="[^"+LB+"]",dje="[^"+LB.replace("\\.","")+"]",fje=/((?:WC+[\/:])*)/.source.replace("WC",DB),mje=/(WCOD+)?/.source.replace("WCOD",dje),gje=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",DB),yje=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",DB),vje=new RegExp("^"+fje+mje+gje+yje+"$"),_je=["material","materials","bones","map"],Pde=class{constructor(e,r,i){let n=i||Co.parseTrackName(r);this._targetGroup=e,this._bindings=e.subscribe_(r,n)}getValue(e,r){this.bind();let i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(e,r)}setValue(e,r){let i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,a=i.length;n!==a;++n)i[n].setValue(e,r)}bind(){let e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=e.length;r!==i;++r)e[r].bind()}unbind(){let e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=e.length;r!==i;++r)e[r].unbind()}};s(Pde,"Composite");var xje=Pde,Lde=class D0{constructor(e,r,i){this.path=r,this.parsedPath=i||D0.parseTrackName(r),this.node=D0.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,r,i){return e&&e.isAnimationObjectGroup?new D0.Composite(e,r,i):new D0(e,r,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(pje,"")}static parseTrackName(e){let r=vje.exec(e);if(r===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let a=i.nodeName.substring(n+1);_je.indexOf(a)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=a)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,r){if(r===void 0||r===""||r==="."||r===-1||r===e.name||r===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(r);if(i!==void 0)return i}if(e.children){let i=s(function(a){for(let o=0;o<a.length;o++){let l=a[o];if(l.name===r||l.uuid===r)return l;let u=i(l.children);if(u)return u}return null},"searchNodeSubtree"),n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,r){e[r]=this.targetObject[this.propertyName]}_getValue_array(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)e[r++]=i[n]}_getValue_arrayElement(e,r){e[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,r){this.resolvedProperty.toArray(e,r)}_setValue_direct(e,r){this.targetObject[this.propertyName]=e[r]}_setValue_direct_setNeedsUpdate(e,r){this.targetObject[this.propertyName]=e[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,r){this.targetObject[this.propertyName]=e[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)i[n]=e[r++]}_setValue_array_setNeedsUpdate(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)i[n]=e[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)i[n]=e[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,r){this.resolvedProperty[this.propertyIndex]=e[r]}_setValue_arrayElement_setNeedsUpdate(e,r){this.resolvedProperty[this.propertyIndex]=e[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,r){this.resolvedProperty[this.propertyIndex]=e[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,r){this.resolvedProperty.fromArray(e,r)}_setValue_fromArray_setNeedsUpdate(e,r){this.resolvedProperty.fromArray(e,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,r){this.resolvedProperty.fromArray(e,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,r){this.bind(),this.getValue(e,r)}_setValue_unbound(e,r){this.bind(),this.setValue(e,r)}bind(){let e=this.node,r=this.parsedPath,i=r.objectName,n=r.propertyName,a=r.propertyIndex;if(e||(e=D0.findNode(this.rootNode,r.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=r.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===c){c=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}let o=e[n];if(o===void 0){let c=r.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+n+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?l=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(a!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};s(Lde,"PropertyBinding");var Co=Lde;Co.Composite=xje;Co.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Co.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Co.prototype.GetterByBindingType=[Co.prototype._getValue_direct,Co.prototype._getValue_array,Co.prototype._getValue_arrayElement,Co.prototype._getValue_toArray];Co.prototype.SetterByBindingTypeAndVersioning=[[Co.prototype._setValue_direct,Co.prototype._setValue_direct_setNeedsUpdate,Co.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Co.prototype._setValue_array,Co.prototype._setValue_array_setNeedsUpdate,Co.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Co.prototype._setValue_arrayElement,Co.prototype._setValue_arrayElement_setNeedsUpdate,Co.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Co.prototype._setValue_fromArray,Co.prototype._setValue_fromArray_setNeedsUpdate,Co.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var sW=new Oi,Dde=class{constructor(e,r,i=0,n=1/0){this.ray=new DA(e,r),this.near=i,this.far=n,this.camera=null,this.layers=new vB,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,r){this.ray.set(e,r)}setFromCamera(e,r){r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type: "+r.type)}setFromXRController(e){return sW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(sW),this}intersectObject(e,r=!0,i=[]){return Y3(e,this,i,r),i.sort(vO),i}intersectObjects(e,r=!0,i=[]){for(let n=0,a=e.length;n<a;n++)Y3(e[n],this,i,r);return i.sort(vO),i}};s(Dde,"Raycaster");var BA=Dde;function vO(t,e){return t.distance-e.distance}s(vO,"ascSort");function Y3(t,e,r,i){let n=!0;if(t.layers.test(e.layers)&&t.raycast(e,r)===!1&&(n=!1),n===!0&&i===!0){let a=t.children;for(let o=0,l=a.length;o<l;o++)Y3(a[o],e,r,!0)}}s(Y3,"intersect");var lW=new Jt,Rde=class{constructor(e=new Jt(1/0,1/0),r=new Jt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromPoints(e){this.makeEmpty();for(let r=0,i=e.length;r<i;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){let i=lW.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,lW).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};s(Rde,"Box2");var Ode=Rde,bje=class extends NP{constructor(e=1){let r=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new js;n.setAttribute("position",new yo(r,3)),n.setAttribute("color",new yo(i,3));let a=new AB({vertexColors:!0,toneMapped:!1});super(n,a),this.type="AxesHelper"}setColors(e,r,i){let n=new si,a=this.geometry.attributes.color.array;return n.set(e),n.toArray(a,0),n.toArray(a,3),n.set(r),n.toArray(a,6),n.toArray(a,9),n.set(i),n.toArray(a,12),n.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};s(bje,"AxesHelper");function _O(t,e,r,i){let n=kde(i);switch(r){case Rue:return t*e;case kue:return t*e;case Nue:return t*e*2;case dB:return t*e/n.components*n.byteLength;case OP:return t*e/n.components*n.byteLength;case Fue:return t*e*2/n.components*n.byteLength;case fB:return t*e*2/n.components*n.byteLength;case Oue:return t*e*3/n.components*n.byteLength;case Dl:return t*e*4/n.components*n.byteLength;case mB:return t*e*4/n.components*n.byteLength;case YE:case KE:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case JE:case QE:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case RR:case kR:return Math.max(t,16)*Math.max(e,8)/4;case DR:case OR:return Math.max(t,8)*Math.max(e,8)/2;case NR:case FR:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case BR:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case zR:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case UR:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case VR:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case jR:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case $R:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case GR:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case HR:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case qR:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case WR:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case XR:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case ZR:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case YR:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case KR:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case JR:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case eC:case QR:case eO:return Math.ceil(t/4)*Math.ceil(e/4)*16;case Bue:case tO:return Math.ceil(t/4)*Math.ceil(e/4)*8;case rO:case iO:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error("Unable to determine texture byte length for ".concat(r," format."))}s(_O,"getByteLength");function kde(t){switch(t){case ed:case Pue:return{byteLength:1,components:1};case Dw:case Lue:case LA:return{byteLength:2,components:1};case hB:case pB:return{byteLength:2,components:4};case Jm:case cB:case Lu:return{byteLength:4,components:1};case Due:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(t,"."))}s(kde,"getTextureTypeByteLength");typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:lB}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=lB);N();function RB(){let t=null,e=!1,r=null,i=null;function n(a,o){r(a,o),i=t.requestAnimationFrame(n)}return s(n,"onAnimationFrame"),{start:s(function(){e!==!0&&r!==null&&(i=t.requestAnimationFrame(n),e=!0)},"start"),stop:s(function(){t.cancelAnimationFrame(i),e=!1},"stop"),setAnimationLoop:s(function(a){r=a},"setAnimationLoop"),setContext:s(function(a){t=a},"setContext")}}s(RB,"WebGLAnimation");function Nde(t){let e=new WeakMap;function r(l,u){let c=l.array,p=l.usage,m=c.byteLength,y=t.createBuffer();t.bindBuffer(u,y),t.bufferData(u,c,p),l.onUploadCallback();let v;if(c instanceof Float32Array)v=t.FLOAT;else if(c instanceof Uint16Array)l.isFloat16BufferAttribute?v=t.HALF_FLOAT:v=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)v=t.SHORT;else if(c instanceof Uint32Array)v=t.UNSIGNED_INT;else if(c instanceof Int32Array)v=t.INT;else if(c instanceof Int8Array)v=t.BYTE;else if(c instanceof Uint8Array)v=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)v=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:y,type:v,bytesPerElement:c.BYTES_PER_ELEMENT,version:l.version,size:m}}s(r,"createBuffer");function i(l,u,c){let p=u.array,m=u.updateRanges;if(t.bindBuffer(c,l),m.length===0)t.bufferSubData(c,0,p);else{m.sort((v,w)=>v.start-w.start);let y=0;for(let v=1;v<m.length;v++){let w=m[y],E=m[v];E.start<=w.start+w.count+1?w.count=Math.max(w.count,E.start+E.count-w.start):(++y,m[y]=E)}m.length=y+1;for(let v=0,w=m.length;v<w;v++){let E=m[v];t.bufferSubData(c,E.start*p.BYTES_PER_ELEMENT,p,E.start,E.count)}u.clearUpdateRanges()}u.onUploadCallback()}s(i,"updateBuffer");function n(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}s(n,"get");function a(l){l.isInterleavedBufferAttribute&&(l=l.data);let u=e.get(l);u&&(t.deleteBuffer(u.buffer),e.delete(l))}s(a,"remove");function o(l,u){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){let p=e.get(l);(!p||p.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}let c=e.get(l);if(c===void 0)e.set(l,r(l,u));else if(c.version<l.version){if(c.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,l,u),c.version=l.version}}return s(o,"update"),{get:n,remove:a,update:o}}s(Nde,"WebGLAttributes");var wje=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Aje=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Sje=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Mje=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Eje=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Cje=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Ije=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Tje=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Pje=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Lje=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Dje=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Rje=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Oje=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,kje=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Nje=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Fje=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Bje=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,zje=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Uje=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Vje=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,jje=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,$je=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Gje=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Hje=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,qje=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Wje=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Xje=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Zje=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Yje=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Kje=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Jje="gl_FragColor = linearToOutputTexel( gl_FragColor );",Qje=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,e$e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,t$e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,r$e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,i$e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,n$e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,a$e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,o$e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,s$e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,l$e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,u$e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,c$e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,h$e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,p$e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,d$e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,f$e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,m$e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,g$e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,y$e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,v$e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,_$e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,x$e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,b$e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,w$e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,A$e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,S$e=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,M$e=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,E$e=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,C$e=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,I$e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,T$e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,P$e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,L$e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,D$e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,R$e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,O$e=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,k$e=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,N$e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,F$e=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,B$e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,z$e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,U$e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,V$e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,j$e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$$e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,G$e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,H$e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,q$e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,W$e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,X$e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Z$e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Y$e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,K$e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,J$e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Q$e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,eGe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,tGe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,rGe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,iGe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,nGe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,aGe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,oGe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,sGe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,lGe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,uGe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,cGe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,hGe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,pGe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,dGe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,fGe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,mGe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,gGe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,yGe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vGe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,_Ge=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,xGe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,bGe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,wGe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,AGe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,SGe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,MGe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,EGe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,CGe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,IGe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,TGe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,PGe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,LGe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,DGe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,RGe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,OGe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kGe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,NGe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FGe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,BGe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zGe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,UGe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VGe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,jGe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,$Ge=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,GGe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HGe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,qGe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WGe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,XGe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZGe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,YGe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,KGe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JGe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,QGe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,eHe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Yi={alphahash_fragment:wje,alphahash_pars_fragment:Aje,alphamap_fragment:Sje,alphamap_pars_fragment:Mje,alphatest_fragment:Eje,alphatest_pars_fragment:Cje,aomap_fragment:Ije,aomap_pars_fragment:Tje,batching_pars_vertex:Pje,batching_vertex:Lje,begin_vertex:Dje,beginnormal_vertex:Rje,bsdfs:Oje,iridescence_fragment:kje,bumpmap_pars_fragment:Nje,clipping_planes_fragment:Fje,clipping_planes_pars_fragment:Bje,clipping_planes_pars_vertex:zje,clipping_planes_vertex:Uje,color_fragment:Vje,color_pars_fragment:jje,color_pars_vertex:$je,color_vertex:Gje,common:Hje,cube_uv_reflection_fragment:qje,defaultnormal_vertex:Wje,displacementmap_pars_vertex:Xje,displacementmap_vertex:Zje,emissivemap_fragment:Yje,emissivemap_pars_fragment:Kje,colorspace_fragment:Jje,colorspace_pars_fragment:Qje,envmap_fragment:e$e,envmap_common_pars_fragment:t$e,envmap_pars_fragment:r$e,envmap_pars_vertex:i$e,envmap_physical_pars_fragment:f$e,envmap_vertex:n$e,fog_vertex:a$e,fog_pars_vertex:o$e,fog_fragment:s$e,fog_pars_fragment:l$e,gradientmap_pars_fragment:u$e,lightmap_pars_fragment:c$e,lights_lambert_fragment:h$e,lights_lambert_pars_fragment:p$e,lights_pars_begin:d$e,lights_toon_fragment:m$e,lights_toon_pars_fragment:g$e,lights_phong_fragment:y$e,lights_phong_pars_fragment:v$e,lights_physical_fragment:_$e,lights_physical_pars_fragment:x$e,lights_fragment_begin:b$e,lights_fragment_maps:w$e,lights_fragment_end:A$e,logdepthbuf_fragment:S$e,logdepthbuf_pars_fragment:M$e,logdepthbuf_pars_vertex:E$e,logdepthbuf_vertex:C$e,map_fragment:I$e,map_pars_fragment:T$e,map_particle_fragment:P$e,map_particle_pars_fragment:L$e,metalnessmap_fragment:D$e,metalnessmap_pars_fragment:R$e,morphinstance_vertex:O$e,morphcolor_vertex:k$e,morphnormal_vertex:N$e,morphtarget_pars_vertex:F$e,morphtarget_vertex:B$e,normal_fragment_begin:z$e,normal_fragment_maps:U$e,normal_pars_fragment:V$e,normal_pars_vertex:j$e,normal_vertex:$$e,normalmap_pars_fragment:G$e,clearcoat_normal_fragment_begin:H$e,clearcoat_normal_fragment_maps:q$e,clearcoat_pars_fragment:W$e,iridescence_pars_fragment:X$e,opaque_fragment:Z$e,packing:Y$e,premultiplied_alpha_fragment:K$e,project_vertex:J$e,dithering_fragment:Q$e,dithering_pars_fragment:eGe,roughnessmap_fragment:tGe,roughnessmap_pars_fragment:rGe,shadowmap_pars_fragment:iGe,shadowmap_pars_vertex:nGe,shadowmap_vertex:aGe,shadowmask_pars_fragment:oGe,skinbase_vertex:sGe,skinning_pars_vertex:lGe,skinning_vertex:uGe,skinnormal_vertex:cGe,specularmap_fragment:hGe,specularmap_pars_fragment:pGe,tonemapping_fragment:dGe,tonemapping_pars_fragment:fGe,transmission_fragment:mGe,transmission_pars_fragment:gGe,uv_pars_fragment:yGe,uv_pars_vertex:vGe,uv_vertex:_Ge,worldpos_vertex:xGe,background_vert:bGe,background_frag:wGe,backgroundCube_vert:AGe,backgroundCube_frag:SGe,cube_vert:MGe,cube_frag:EGe,depth_vert:CGe,depth_frag:IGe,distanceRGBA_vert:TGe,distanceRGBA_frag:PGe,equirect_vert:LGe,equirect_frag:DGe,linedashed_vert:RGe,linedashed_frag:OGe,meshbasic_vert:kGe,meshbasic_frag:NGe,meshlambert_vert:FGe,meshlambert_frag:BGe,meshmatcap_vert:zGe,meshmatcap_frag:UGe,meshnormal_vert:VGe,meshnormal_frag:jGe,meshphong_vert:$Ge,meshphong_frag:GGe,meshphysical_vert:HGe,meshphysical_frag:qGe,meshtoon_vert:WGe,meshtoon_frag:XGe,points_vert:ZGe,points_frag:YGe,shadow_vert:KGe,shadow_frag:JGe,sprite_vert:QGe,sprite_frag:eHe},Pr={common:{diffuse:{value:new si(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new nn},alphaMap:{value:null},alphaMapTransform:{value:new nn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new nn}},envmap:{envMap:{value:null},envMapRotation:{value:new nn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new nn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new nn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new nn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new nn},normalScale:{value:new Jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new nn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new nn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new nn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new nn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new si(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new si(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new nn},alphaTest:{value:0},uvTransform:{value:new nn}},sprite:{diffuse:{value:new si(16777215)},opacity:{value:1},center:{value:new Jt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new nn},alphaMap:{value:null},alphaMapTransform:{value:new nn},alphaTest:{value:0}}},Pp={basic:{uniforms:Sl([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.fog]),vertexShader:Yi.meshbasic_vert,fragmentShader:Yi.meshbasic_frag},lambert:{uniforms:Sl([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,Pr.lights,{emissive:{value:new si(0)}}]),vertexShader:Yi.meshlambert_vert,fragmentShader:Yi.meshlambert_frag},phong:{uniforms:Sl([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,Pr.lights,{emissive:{value:new si(0)},specular:{value:new si(1118481)},shininess:{value:30}}]),vertexShader:Yi.meshphong_vert,fragmentShader:Yi.meshphong_frag},standard:{uniforms:Sl([Pr.common,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.roughnessmap,Pr.metalnessmap,Pr.fog,Pr.lights,{emissive:{value:new si(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Yi.meshphysical_vert,fragmentShader:Yi.meshphysical_frag},toon:{uniforms:Sl([Pr.common,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.gradientmap,Pr.fog,Pr.lights,{emissive:{value:new si(0)}}]),vertexShader:Yi.meshtoon_vert,fragmentShader:Yi.meshtoon_frag},matcap:{uniforms:Sl([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,{matcap:{value:null}}]),vertexShader:Yi.meshmatcap_vert,fragmentShader:Yi.meshmatcap_frag},points:{uniforms:Sl([Pr.points,Pr.fog]),vertexShader:Yi.points_vert,fragmentShader:Yi.points_frag},dashed:{uniforms:Sl([Pr.common,Pr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Yi.linedashed_vert,fragmentShader:Yi.linedashed_frag},depth:{uniforms:Sl([Pr.common,Pr.displacementmap]),vertexShader:Yi.depth_vert,fragmentShader:Yi.depth_frag},normal:{uniforms:Sl([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,{opacity:{value:1}}]),vertexShader:Yi.meshnormal_vert,fragmentShader:Yi.meshnormal_frag},sprite:{uniforms:Sl([Pr.sprite,Pr.fog]),vertexShader:Yi.sprite_vert,fragmentShader:Yi.sprite_frag},background:{uniforms:{uvTransform:{value:new nn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Yi.background_vert,fragmentShader:Yi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new nn}},vertexShader:Yi.backgroundCube_vert,fragmentShader:Yi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Yi.cube_vert,fragmentShader:Yi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Yi.equirect_vert,fragmentShader:Yi.equirect_frag},distanceRGBA:{uniforms:Sl([Pr.common,Pr.displacementmap,{referencePosition:{value:new qe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Yi.distanceRGBA_vert,fragmentShader:Yi.distanceRGBA_frag},shadow:{uniforms:Sl([Pr.lights,Pr.fog,{color:{value:new si(0)},opacity:{value:1}}]),vertexShader:Yi.shadow_vert,fragmentShader:Yi.shadow_frag}};Pp.physical={uniforms:Sl([Pp.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new nn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new nn},clearcoatNormalScale:{value:new Jt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new nn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new nn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new nn},sheen:{value:0},sheenColor:{value:new si(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new nn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new nn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new nn},transmissionSamplerSize:{value:new Jt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new nn},attenuationDistance:{value:0},attenuationColor:{value:new si(0)},specularColor:{value:new si(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new nn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new nn},anisotropyVector:{value:new Jt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new nn}}]),vertexShader:Yi.meshphysical_vert,fragmentShader:Yi.meshphysical_frag};var dE={r:0,b:0,g:0},Bg=new Nu,tHe=new Oi;function Fde(t,e,r,i,n,a,o){let l=new si(0),u=a===!0?0:1,c,p,m=null,y=0,v=null;function w(C){let T=C.isScene===!0?C.background:null;return T&&T.isTexture&&(T=(C.backgroundBlurriness>0?r:e).get(T)),T}s(w,"getBackground");function E(C){let T=!1,O=w(C);O===null?I(l,u):O&&O.isColor&&(I(O,1),T=!0);let F=t.xr.getEnvironmentBlendMode();F==="additive"?i.buffers.color.setClear(0,0,0,1,o):F==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(t.autoClear||T)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}s(E,"render");function M(C,T){let O=w(T);O&&(O.isCubeTexture||O.mapping===RP)?(p===void 0&&(p=new Pn(new RA(1,1,1),new bc({name:"BackgroundCubeMaterial",uniforms:Xy(Pp.backgroundCube.uniforms),vertexShader:Pp.backgroundCube.vertexShader,fragmentShader:Pp.backgroundCube.fragmentShader,side:tu,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(F,k,B){this.matrixWorld.copyPosition(B.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:s(function(){return this.uniforms.envMap.value},"get")}),n.update(p)),Bg.copy(T.backgroundRotation),Bg.x*=-1,Bg.y*=-1,Bg.z*=-1,O.isCubeTexture&&O.isRenderTargetTexture===!1&&(Bg.y*=-1,Bg.z*=-1),p.material.uniforms.envMap.value=O,p.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=T.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(tHe.makeRotationFromEuler(Bg)),p.material.toneMapped=Rn.getTransfer(O.colorSpace)!==ga,(m!==O||y!==O.version||v!==t.toneMapping)&&(p.material.needsUpdate=!0,m=O,y=O.version,v=t.toneMapping),p.layers.enableAll(),C.unshift(p,p.geometry,p.material,0,0,null)):O&&O.isTexture&&(c===void 0&&(c=new Pn(new pv(2,2),new bc({name:"BackgroundMaterial",uniforms:Xy(Pp.background.uniforms),vertexShader:Pp.background.vertexShader,fragmentShader:Pp.background.fragmentShader,side:Qp,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:s(function(){return this.uniforms.t2D.value},"get")}),n.update(c)),c.material.uniforms.t2D.value=O,c.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,c.material.toneMapped=Rn.getTransfer(O.colorSpace)!==ga,O.matrixAutoUpdate===!0&&O.updateMatrix(),c.material.uniforms.uvTransform.value.copy(O.matrix),(m!==O||y!==O.version||v!==t.toneMapping)&&(c.material.needsUpdate=!0,m=O,y=O.version,v=t.toneMapping),c.layers.enableAll(),C.unshift(c,c.geometry,c.material,0,0,null))}s(M,"addToRenderList");function I(C,T){C.getRGB(dE,_B(t)),i.buffers.color.setClear(dE.r,dE.g,dE.b,T,o)}s(I,"setClear");function P(){p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return s(P,"dispose"),{getClearColor:s(function(){return l},"getClearColor"),setClearColor:s(function(C,T=1){l.set(C),u=T,I(l,u)},"setClearColor"),getClearAlpha:s(function(){return u},"getClearAlpha"),setClearAlpha:s(function(C){u=C,I(l,u)},"setClearAlpha"),render:E,addToRenderList:M,dispose:P}}s(Fde,"WebGLBackground");function Bde(t,e){let r=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},n=y(null),a=n,o=!1;function l(z,q,W,J,V){let oe=!1,Y=m(J,W,q);a!==Y&&(a=Y,c(a.object)),oe=v(z,J,W,V),oe&&w(z,J,W,V),V!==null&&e.update(V,t.ELEMENT_ARRAY_BUFFER),(oe||o)&&(o=!1,T(z,q,W,J),V!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(V).buffer))}s(l,"setup");function u(){return t.createVertexArray()}s(u,"createVertexArrayObject");function c(z){return t.bindVertexArray(z)}s(c,"bindVertexArrayObject");function p(z){return t.deleteVertexArray(z)}s(p,"deleteVertexArrayObject");function m(z,q,W){let J=W.wireframe===!0,V=i[z.id];V===void 0&&(V={},i[z.id]=V);let oe=V[q.id];oe===void 0&&(oe={},V[q.id]=oe);let Y=oe[J];return Y===void 0&&(Y=y(u()),oe[J]=Y),Y}s(m,"getBindingState");function y(z){let q=[],W=[],J=[];for(let V=0;V<r;V++)q[V]=0,W[V]=0,J[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:W,attributeDivisors:J,object:z,attributes:{},index:null}}s(y,"createBindingState");function v(z,q,W,J){let V=a.attributes,oe=q.attributes,Y=0,he=W.getAttributes();for(let Q in he)if(he[Q].location>=0){let ae=V[Q],ee=oe[Q];if(ee===void 0&&(Q==="instanceMatrix"&&z.instanceMatrix&&(ee=z.instanceMatrix),Q==="instanceColor"&&z.instanceColor&&(ee=z.instanceColor)),ae===void 0||ae.attribute!==ee||ee&&ae.data!==ee.data)return!0;Y++}return a.attributesNum!==Y||a.index!==J}s(v,"needsUpdate");function w(z,q,W,J){let V={},oe=q.attributes,Y=0,he=W.getAttributes();for(let Q in he)if(he[Q].location>=0){let ae=oe[Q];ae===void 0&&(Q==="instanceMatrix"&&z.instanceMatrix&&(ae=z.instanceMatrix),Q==="instanceColor"&&z.instanceColor&&(ae=z.instanceColor));let ee={};ee.attribute=ae,ae&&ae.data&&(ee.data=ae.data),V[Q]=ee,Y++}a.attributes=V,a.attributesNum=Y,a.index=J}s(w,"saveCache");function E(){let z=a.newAttributes;for(let q=0,W=z.length;q<W;q++)z[q]=0}s(E,"initAttributes");function M(z){I(z,0)}s(M,"enableAttribute");function I(z,q){let W=a.newAttributes,J=a.enabledAttributes,V=a.attributeDivisors;W[z]=1,J[z]===0&&(t.enableVertexAttribArray(z),J[z]=1),V[z]!==q&&(t.vertexAttribDivisor(z,q),V[z]=q)}s(I,"enableAttributeAndDivisor");function P(){let z=a.newAttributes,q=a.enabledAttributes;for(let W=0,J=q.length;W<J;W++)q[W]!==z[W]&&(t.disableVertexAttribArray(W),q[W]=0)}s(P,"disableUnusedAttributes");function C(z,q,W,J,V,oe,Y){Y===!0?t.vertexAttribIPointer(z,q,W,V,oe):t.vertexAttribPointer(z,q,W,J,V,oe)}s(C,"vertexAttribPointer");function T(z,q,W,J){E();let V=J.attributes,oe=W.getAttributes(),Y=q.defaultAttributeValues;for(let he in oe){let Q=oe[he];if(Q.location>=0){let ae=V[he];if(ae===void 0&&(he==="instanceMatrix"&&z.instanceMatrix&&(ae=z.instanceMatrix),he==="instanceColor"&&z.instanceColor&&(ae=z.instanceColor)),ae!==void 0){let ee=ae.normalized,le=ae.itemSize,K=e.get(ae);if(K===void 0)continue;let ce=K.buffer,te=K.type,ne=K.bytesPerElement,pe=te===t.INT||te===t.UNSIGNED_INT||ae.gpuType===cB;if(ae.isInterleavedBufferAttribute){let xe=ae.data,Te=xe.stride,fe=ae.offset;if(xe.isInstancedInterleavedBuffer){for(let Pe=0;Pe<Q.locationSize;Pe++)I(Q.location+Pe,xe.meshPerAttribute);z.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=xe.meshPerAttribute*xe.count)}else for(let Pe=0;Pe<Q.locationSize;Pe++)M(Q.location+Pe);t.bindBuffer(t.ARRAY_BUFFER,ce);for(let Pe=0;Pe<Q.locationSize;Pe++)C(Q.location+Pe,le/Q.locationSize,te,ee,Te*ne,(fe+le/Q.locationSize*Pe)*ne,pe)}else{if(ae.isInstancedBufferAttribute){for(let xe=0;xe<Q.locationSize;xe++)I(Q.location+xe,ae.meshPerAttribute);z.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let xe=0;xe<Q.locationSize;xe++)M(Q.location+xe);t.bindBuffer(t.ARRAY_BUFFER,ce);for(let xe=0;xe<Q.locationSize;xe++)C(Q.location+xe,le/Q.locationSize,te,ee,le*ne,le/Q.locationSize*xe*ne,pe)}}else if(Y!==void 0){let ee=Y[he];if(ee!==void 0)switch(ee.length){case 2:t.vertexAttrib2fv(Q.location,ee);break;case 3:t.vertexAttrib3fv(Q.location,ee);break;case 4:t.vertexAttrib4fv(Q.location,ee);break;default:t.vertexAttrib1fv(Q.location,ee)}}}}P()}s(T,"setupVertexAttributes");function O(){B();for(let z in i){let q=i[z];for(let W in q){let J=q[W];for(let V in J)p(J[V].object),delete J[V];delete q[W]}delete i[z]}}s(O,"dispose");function F(z){if(i[z.id]===void 0)return;let q=i[z.id];for(let W in q){let J=q[W];for(let V in J)p(J[V].object),delete J[V];delete q[W]}delete i[z.id]}s(F,"releaseStatesOfGeometry");function k(z){for(let q in i){let W=i[q];if(W[z.id]===void 0)continue;let J=W[z.id];for(let V in J)p(J[V].object),delete J[V];delete W[z.id]}}s(k,"releaseStatesOfProgram");function B(){U(),o=!0,a!==n&&(a=n,c(a.object))}s(B,"reset");function U(){n.geometry=null,n.program=null,n.wireframe=!1}return s(U,"resetDefaultState"),{setup:l,reset:B,resetDefaultState:U,dispose:O,releaseStatesOfGeometry:F,releaseStatesOfProgram:k,initAttributes:E,enableAttribute:M,disableUnusedAttributes:P}}s(Bde,"WebGLBindingStates");function zde(t,e,r){let i;function n(c){i=c}s(n,"setMode");function a(c,p){t.drawArrays(i,c,p),r.update(p,i,1)}s(a,"render");function o(c,p,m){m!==0&&(t.drawArraysInstanced(i,c,p,m),r.update(p,i,m))}s(o,"renderInstances");function l(c,p,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,p,0,m);let y=0;for(let v=0;v<m;v++)y+=p[v];r.update(y,i,1)}s(l,"renderMultiDraw");function u(c,p,m,y){if(m===0)return;let v=e.get("WEBGL_multi_draw");if(v===null)for(let w=0;w<c.length;w++)o(c[w],p[w],y[w]);else{v.multiDrawArraysInstancedWEBGL(i,c,0,p,0,y,0,m);let w=0;for(let E=0;E<m;E++)w+=p[E]*y[E];r.update(w,i,1)}}s(u,"renderMultiDrawInstances"),this.setMode=n,this.render=a,this.renderInstances=o,this.renderMultiDraw=l,this.renderMultiDrawInstances=u}s(zde,"WebGLBufferRenderer");function Ude(t,e,r,i){let n;function a(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){let k=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}s(a,"getMaxAnisotropy");function o(k){return!(k!==Dl&&i.convert(k)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}s(o,"textureFormatReadable");function l(k){let B=k===LA&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(k!==ed&&i.convert(k)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&k!==Lu&&!B)}s(l,"textureTypeReadable");function u(k){if(k==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}s(u,"getMaxPrecision");let c=r.precision!==void 0?r.precision:"highp",p=u(c);p!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",p,"instead."),c=p);let m=r.logarithmicDepthBuffer===!0,y=r.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),v=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),w=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),E=t.getParameter(t.MAX_TEXTURE_SIZE),M=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),I=t.getParameter(t.MAX_VERTEX_ATTRIBS),P=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),C=t.getParameter(t.MAX_VARYING_VECTORS),T=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),O=w>0,F=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:u,textureFormatReadable:o,textureTypeReadable:l,precision:c,logarithmicDepthBuffer:m,reverseDepthBuffer:y,maxTextures:v,maxVertexTextures:w,maxTextureSize:E,maxCubemapSize:M,maxAttributes:I,maxVertexUniforms:P,maxVaryings:C,maxFragmentUniforms:T,vertexTextures:O,maxSamples:F}}s(Ude,"WebGLCapabilities");function Vde(t){let e=this,r=null,i=0,n=!1,a=!1,o=new $g,l=new nn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(m,y){let v=m.length!==0||y||i!==0||n;return n=y,i=m.length,v},this.beginShadows=function(){a=!0,p(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(m,y){r=p(m,y,0)},this.setState=function(m,y,v){let w=m.clippingPlanes,E=m.clipIntersection,M=m.clipShadows,I=t.get(m);if(!n||w===null||w.length===0||a&&!M)a?p(null):c();else{let P=a?0:i,C=P*4,T=I.clippingState||null;u.value=T,T=p(w,y,C,v);for(let O=0;O!==C;++O)T[O]=r[O];I.clippingState=T,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=P}};function c(){u.value!==r&&(u.value=r,u.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}s(c,"resetGlobalState");function p(m,y,v,w){let E=m!==null?m.length:0,M=null;if(E!==0){if(M=u.value,w!==!0||M===null){let I=v+E*4,P=y.matrixWorldInverse;l.getNormalMatrix(P),(M===null||M.length<I)&&(M=new Float32Array(I));for(let C=0,T=v;C!==E;++C,T+=4)o.copy(m[C]).applyMatrix4(P,l),o.normal.toArray(M,T),M[T+3]=o.constant}u.value=M,u.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,M}s(p,"projectPlanes")}s(Vde,"WebGLClipping");function jde(t){let e=new WeakMap;function r(o,l){return l===B3?o.mapping=S_:l===PR&&(o.mapping=M_),o}s(r,"mapTextureMapping");function i(o){if(o&&o.isTexture){let l=o.mapping;if(l===B3||l===PR)if(e.has(o)){let u=e.get(o).texture;return r(u,o.mapping)}else{let u=o.image;if(u&&u.height>0){let c=new TVe(u.height);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",n),r(c.texture,o.mapping)}else return null}}return o}s(i,"get");function n(o){let l=o.target;l.removeEventListener("dispose",n);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}s(n,"onTextureDispose");function a(){e=new WeakMap}return s(a,"dispose"),{get:i,dispose:a}}s(jde,"WebGLCubeMaps");var O1=4,uW=[.125,.215,.35,.446,.526,.582],my=20,S6=new xde,cW=new si,M6=null,E6=0,C6=0,I6=!1,Gg=(1+Math.sqrt(5))/2,v0=1/Gg,hW=[new qe(-Gg,v0,0),new qe(Gg,v0,0),new qe(-v0,0,Gg),new qe(v0,0,Gg),new qe(0,Gg,-v0),new qe(0,Gg,v0),new qe(-1,1,-1),new qe(1,1,-1),new qe(-1,1,1),new qe(1,1,1)],$de=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,r=0,i=.1,n=100){M6=this._renderer.getRenderTarget(),E6=this._renderer.getActiveCubeFace(),C6=this._renderer.getActiveMipmapLevel(),I6=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,i,n,a),r>0&&this._blur(a,0,0,r),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,r=null){return this._fromTexture(e,r)}fromCubemap(e,r=null){return this._fromTexture(e,r)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=wO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=bO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(M6,E6,C6),this._renderer.xr.enabled=I6,e.scissorTest=!1,y2(e,0,0,e.width,e.height)}_fromTexture(e,r){e.mapping===S_||e.mapping===M_?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),M6=this._renderer.getRenderTarget(),E6=this._renderer.getActiveCubeFace(),C6=this._renderer.getActiveMipmapLevel(),I6=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let i=r||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),r=4*this._cubeSize,i={magFilter:Up,minFilter:Up,generateMipmaps:!1,type:LA,format:Dl,colorSpace:Wy,depthBuffer:!1},n=xO(e,r,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==r){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=xO(e,r,i);let{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Gde(a)),this._blurMaterial=Hde(a,e,r)}return n}_compileMaterial(e){let r=new Pn(this._lodPlanes[0],e);this._renderer.compile(r,S6)}_sceneToCubeUV(e,r,i,n){let a=new Kl(90,1,r,i),o=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,c=u.autoClear,p=u.toneMapping;u.getClearColor(cW),u.toneMapping=qm,u.autoClear=!1;let m=new ug({name:"PMREM.Background",side:tu,depthWrite:!1,depthTest:!1}),y=new Pn(new RA,m),v=!1,w=e.background;w?w.isColor&&(m.color.copy(w),e.background=null,v=!0):(m.color.copy(cW),v=!0);for(let E=0;E<6;E++){let M=E%3;M===0?(a.up.set(0,o[E],0),a.lookAt(l[E],0,0)):M===1?(a.up.set(0,0,o[E]),a.lookAt(0,l[E],0)):(a.up.set(0,o[E],0),a.lookAt(0,0,l[E]));let I=this._cubeSize;y2(n,M*I,E>2?I:0,I,I),u.setRenderTarget(n),v&&u.render(y,a),u.render(e,a)}y.geometry.dispose(),y.material.dispose(),u.toneMapping=p,u.autoClear=c,e.background=w}_textureToCubeUV(e,r){let i=this._renderer,n=e.mapping===S_||e.mapping===M_;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=wO()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=bO());let a=n?this._cubemapMaterial:this._equirectMaterial,o=new Pn(this._lodPlanes[0],a),l=a.uniforms;l.envMap.value=e;let u=this._cubeSize;y2(r,0,0,3*u,2*u),i.setRenderTarget(r),i.render(o,S6)}_applyPMREM(e){let r=this._renderer,i=r.autoClear;r.autoClear=!1;let n=this._lodPlanes.length;for(let a=1;a<n;a++){let o=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),l=hW[(n-a-1)%hW.length];this._blur(e,a-1,a,o,l)}r.autoClear=i}_blur(e,r,i,n,a){let o=this._pingPongRenderTarget;this._halfBlur(e,o,r,i,n,"latitudinal",a),this._halfBlur(o,e,i,i,n,"longitudinal",a)}_halfBlur(e,r,i,n,a,o,l){let u=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let p=3,m=new Pn(this._lodPlanes[n],c),y=c.uniforms,v=this._sizeLods[i]-1,w=isFinite(a)?Math.PI/(2*v):2*Math.PI/(2*my-1),E=a/w,M=isFinite(a)?1+Math.floor(p*E):my;M>my&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(M," samples when the maximum is set to ").concat(my));let I=[],P=0;for(let k=0;k<my;++k){let B=k/E,U=Math.exp(-B*B/2);I.push(U),k===0?P+=U:k<M&&(P+=2*U)}for(let k=0;k<I.length;k++)I[k]=I[k]/P;y.envMap.value=e.texture,y.samples.value=M,y.weights.value=I,y.latitudinal.value=o==="latitudinal",l&&(y.poleAxis.value=l);let{_lodMax:C}=this;y.dTheta.value=w,y.mipInt.value=C-i;let T=this._sizeLods[n],O=3*T*(n>C-O1?n-C+O1:0),F=4*(this._cubeSize-T);y2(r,O,F,3*T,2*T),u.setRenderTarget(r),u.render(m,S6)}};s($de,"PMREMGenerator");var pW=$de;function Gde(t){let e=[],r=[],i=[],n=t,a=t-O1+1+uW.length;for(let o=0;o<a;o++){let l=Math.pow(2,n);r.push(l);let u=1/l;o>t-O1?u=uW[o-t+O1-1]:o===0&&(u=0),i.push(u);let c=1/(l-2),p=-c,m=1+c,y=[p,p,m,p,m,m,p,p,m,m,p,m],v=6,w=6,E=3,M=2,I=1,P=new Float32Array(E*w*v),C=new Float32Array(M*w*v),T=new Float32Array(I*w*v);for(let F=0;F<v;F++){let k=F%3*2/3-1,B=F>2?0:-1,U=[k,B,0,k+2/3,B,0,k+2/3,B+1,0,k,B,0,k+2/3,B+1,0,k,B+1,0];P.set(U,E*w*F),C.set(y,M*w*F);let z=[F,F,F,F,F,F];T.set(z,I*w*F)}let O=new js;O.setAttribute("position",new Yo(P,E)),O.setAttribute("uv",new Yo(C,M)),O.setAttribute("faceIndex",new Yo(T,I)),e.push(O),n>O1&&n--}return{lodPlanes:e,sizeLods:r,sigmas:i}}s(Gde,"_createPlanes");function xO(t,e,r){let i=new Qm(t,e,r);return i.texture.mapping=RP,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}s(xO,"_createRenderTarget");function y2(t,e,r,i,n){t.viewport.set(e,r,i,n),t.scissor.set(e,r,i,n)}s(y2,"_setViewport");function Hde(t,e,r){let i=new Float32Array(my),n=new qe(0,1,0);return new bc({name:"SphericalGaussianBlur",defines:{n:my,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:"".concat(t,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:VP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Hm,depthTest:!1,depthWrite:!1})}s(Hde,"_getBlurShader");function bO(){return new bc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:VP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Hm,depthTest:!1,depthWrite:!1})}s(bO,"_getEquirectMaterial");function wO(){return new bc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:VP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Hm,depthTest:!1,depthWrite:!1})}s(wO,"_getCubemapMaterial");function VP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}s(VP,"_getCommonVertexShader");function qde(t){let e=new WeakMap,r=null;function i(l){if(l&&l.isTexture){let u=l.mapping,c=u===B3||u===PR,p=u===S_||u===M_;if(c||p){let m=e.get(l),y=m!==void 0?m.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==y)return r===null&&(r=new pW(t)),m=c?r.fromEquirectangular(l,m):r.fromCubemap(l,m),m.texture.pmremVersion=l.pmremVersion,e.set(l,m),m.texture;if(m!==void 0)return m.texture;{let v=l.image;return c&&v&&v.height>0||p&&v&&n(v)?(r===null&&(r=new pW(t)),m=c?r.fromEquirectangular(l):r.fromCubemap(l),m.texture.pmremVersion=l.pmremVersion,e.set(l,m),l.addEventListener("dispose",a),m.texture):null}}}return l}s(i,"get");function n(l){let u=0,c=6;for(let p=0;p<c;p++)l[p]!==void 0&&u++;return u===c}s(n,"isCubeTextureComplete");function a(l){let u=l.target;u.removeEventListener("dispose",a);let c=e.get(u);c!==void 0&&(e.delete(u),c.dispose())}s(a,"onTextureDispose");function o(){e=new WeakMap,r!==null&&(r.dispose(),r=null)}return s(o,"dispose"),{get:i,dispose:o}}s(qde,"WebGLCubeUVMaps");function Wde(t){let e={};function r(i){if(e[i]!==void 0)return e[i];let n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return e[i]=n,n}return s(r,"getExtension"),{has:s(function(i){return r(i)!==null},"has"),init:s(function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},"init"),get:s(function(i){let n=r(i);return n===null&&fy("THREE.WebGLRenderer: "+i+" extension not supported."),n},"get")}}s(Wde,"WebGLExtensions");function Xde(t,e,r,i){let n={},a=new WeakMap;function o(m){let y=m.target;y.index!==null&&e.remove(y.index);for(let w in y.attributes)e.remove(y.attributes[w]);y.removeEventListener("dispose",o),delete n[y.id];let v=a.get(y);v&&(e.remove(v),a.delete(y)),i.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,r.memory.geometries--}s(o,"onGeometryDispose");function l(m,y){return n[y.id]===!0||(y.addEventListener("dispose",o),n[y.id]=!0,r.memory.geometries++),y}s(l,"get");function u(m){let y=m.attributes;for(let v in y)e.update(y[v],t.ARRAY_BUFFER)}s(u,"update");function c(m){let y=[],v=m.index,w=m.attributes.position,E=0;if(v!==null){let P=v.array;E=v.version;for(let C=0,T=P.length;C<T;C+=3){let O=P[C+0],F=P[C+1],k=P[C+2];y.push(O,F,F,k,k,O)}}else if(w!==void 0){let P=w.array;E=w.version;for(let C=0,T=P.length/3-1;C<T;C+=3){let O=C+0,F=C+1,k=C+2;y.push(O,F,F,k,k,O)}}else return;let M=new(yB(y)?$ce:Vce)(y,1);M.version=E;let I=a.get(m);I&&e.remove(I),a.set(m,M)}s(c,"updateWireframeAttribute");function p(m){let y=a.get(m);if(y){let v=m.index;v!==null&&y.version<v.version&&c(m)}else c(m);return a.get(m)}return s(p,"getWireframeAttribute"),{get:l,update:u,getWireframeAttribute:p}}s(Xde,"WebGLGeometries");function Zde(t,e,r){let i;function n(y){i=y}s(n,"setMode");let a,o;function l(y){a=y.type,o=y.bytesPerElement}s(l,"setIndex");function u(y,v){t.drawElements(i,v,a,y*o),r.update(v,i,1)}s(u,"render");function c(y,v,w){w!==0&&(t.drawElementsInstanced(i,v,a,y*o,w),r.update(v,i,w))}s(c,"renderInstances");function p(y,v,w){if(w===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,a,y,0,w);let E=0;for(let M=0;M<w;M++)E+=v[M];r.update(E,i,1)}s(p,"renderMultiDraw");function m(y,v,w,E){if(w===0)return;let M=e.get("WEBGL_multi_draw");if(M===null)for(let I=0;I<y.length;I++)c(y[I]/o,v[I],E[I]);else{M.multiDrawElementsInstancedWEBGL(i,v,0,a,y,0,E,0,w);let I=0;for(let P=0;P<w;P++)I+=v[P]*E[P];r.update(I,i,1)}}s(m,"renderMultiDrawInstances"),this.setMode=n,this.setIndex=l,this.render=u,this.renderInstances=c,this.renderMultiDraw=p,this.renderMultiDrawInstances=m}s(Zde,"WebGLIndexedBufferRenderer");function Yde(t){let e={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,o,l){switch(r.calls++,o){case t.TRIANGLES:r.triangles+=l*(a/3);break;case t.LINES:r.lines+=l*(a/2);break;case t.LINE_STRIP:r.lines+=l*(a-1);break;case t.LINE_LOOP:r.lines+=l*a;break;case t.POINTS:r.points+=l*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}s(i,"update");function n(){r.calls=0,r.triangles=0,r.points=0,r.lines=0}return s(n,"reset"),{memory:e,render:r,programs:null,autoReset:!0,reset:n,update:i}}s(Yde,"WebGLInfo");function Kde(t,e,r){let i=new WeakMap,n=new Qn;function a(o,l,u){let c=o.morphTargetInfluences,p=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,m=p!==void 0?p.length:0,y=i.get(l);if(y===void 0||y.count!==m){let v=function(){B.dispose(),i.delete(l),l.removeEventListener("dispose",v)};s(v,"disposeTexture"),y!==void 0&&y.texture.dispose();let w=l.morphAttributes.position!==void 0,E=l.morphAttributes.normal!==void 0,M=l.morphAttributes.color!==void 0,I=l.morphAttributes.position||[],P=l.morphAttributes.normal||[],C=l.morphAttributes.color||[],T=0;w===!0&&(T=1),E===!0&&(T=2),M===!0&&(T=3);let O=l.attributes.position.count*T,F=1;O>e.maxTextureSize&&(F=Math.ceil(O/e.maxTextureSize),O=e.maxTextureSize);let k=new Float32Array(O*F*4*m),B=new bce(k,O,F,m);B.type=Lu,B.needsUpdate=!0;let U=T*4;for(let z=0;z<m;z++){let q=I[z],W=P[z],J=C[z],V=O*F*4*z;for(let oe=0;oe<q.count;oe++){let Y=oe*U;w===!0&&(n.fromBufferAttribute(q,oe),k[V+Y+0]=n.x,k[V+Y+1]=n.y,k[V+Y+2]=n.z,k[V+Y+3]=0),E===!0&&(n.fromBufferAttribute(W,oe),k[V+Y+4]=n.x,k[V+Y+5]=n.y,k[V+Y+6]=n.z,k[V+Y+7]=0),M===!0&&(n.fromBufferAttribute(J,oe),k[V+Y+8]=n.x,k[V+Y+9]=n.y,k[V+Y+10]=n.z,k[V+Y+11]=J.itemSize===4?n.w:1)}}y={count:m,texture:B,size:new Jt(O,F)},i.set(l,y),l.addEventListener("dispose",v)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)u.getUniforms().setValue(t,"morphTexture",o.morphTexture,r);else{let v=0;for(let E=0;E<c.length;E++)v+=c[E];let w=l.morphTargetsRelative?1:1-v;u.getUniforms().setValue(t,"morphTargetBaseInfluence",w),u.getUniforms().setValue(t,"morphTargetInfluences",c)}u.getUniforms().setValue(t,"morphTargetsTexture",y.texture,r),u.getUniforms().setValue(t,"morphTargetsTextureSize",y.size)}return s(a,"update"),{update:a}}s(Kde,"WebGLMorphtargets");function Jde(t,e,r,i){let n=new WeakMap;function a(u){let c=i.render.frame,p=u.geometry,m=e.get(u,p);if(n.get(m)!==c&&(e.update(m),n.set(m,c)),u.isInstancedMesh&&(u.hasEventListener("dispose",l)===!1&&u.addEventListener("dispose",l),n.get(u)!==c&&(r.update(u.instanceMatrix,t.ARRAY_BUFFER),u.instanceColor!==null&&r.update(u.instanceColor,t.ARRAY_BUFFER),n.set(u,c))),u.isSkinnedMesh){let y=u.skeleton;n.get(y)!==c&&(y.update(),n.set(y,c))}return m}s(a,"update");function o(){n=new WeakMap}s(o,"dispose");function l(u){let c=u.target;c.removeEventListener("dispose",l),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return s(l,"onInstancedMeshDispose"),{update:a,dispose:o}}s(Jde,"WebGLObjects");var Qde=new Gu,dW=new Ohe(1,1),efe=new bce,tfe=new fVe,rfe=new ihe,fW=[],mW=[],gW=new Float32Array(16),yW=new Float32Array(9),vW=new Float32Array(4);function dv(t,e,r){let i=t[0];if(i<=0||i>0)return t;let n=e*r,a=fW[n];if(a===void 0&&(a=new Float32Array(n),fW[n]=a),e!==0){i.toArray(a,0);for(let o=1,l=0;o!==e;++o)l+=r,t[o].toArray(a,l)}return a}s(dv,"flatten");function ms(t,e){if(t.length!==e.length)return!1;for(let r=0,i=t.length;r<i;r++)if(t[r]!==e[r])return!1;return!0}s(ms,"arraysEqual");function gs(t,e){for(let r=0,i=e.length;r<i;r++)t[r]=e[r]}s(gs,"copyArray");function zA(t,e){let r=mW[e];r===void 0&&(r=new Int32Array(e),mW[e]=r);for(let i=0;i!==e;++i)r[i]=t.allocateTextureUnit();return r}s(zA,"allocTexUnits");function ife(t,e){let r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}s(ife,"setValueV1f");function nfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(ms(r,e))return;t.uniform2fv(this.addr,e),gs(r,e)}}s(nfe,"setValueV2f");function afe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(e.r!==void 0)(r[0]!==e.r||r[1]!==e.g||r[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(ms(r,e))return;t.uniform3fv(this.addr,e),gs(r,e)}}s(afe,"setValueV3f");function ofe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(ms(r,e))return;t.uniform4fv(this.addr,e),gs(r,e)}}s(ofe,"setValueV4f");function sfe(t,e){let r=this.cache,i=e.elements;if(i===void 0){if(ms(r,e))return;t.uniformMatrix2fv(this.addr,!1,e),gs(r,e)}else{if(ms(r,i))return;vW.set(i),t.uniformMatrix2fv(this.addr,!1,vW),gs(r,i)}}s(sfe,"setValueM2");function lfe(t,e){let r=this.cache,i=e.elements;if(i===void 0){if(ms(r,e))return;t.uniformMatrix3fv(this.addr,!1,e),gs(r,e)}else{if(ms(r,i))return;yW.set(i),t.uniformMatrix3fv(this.addr,!1,yW),gs(r,i)}}s(lfe,"setValueM3");function ufe(t,e){let r=this.cache,i=e.elements;if(i===void 0){if(ms(r,e))return;t.uniformMatrix4fv(this.addr,!1,e),gs(r,e)}else{if(ms(r,i))return;gW.set(i),t.uniformMatrix4fv(this.addr,!1,gW),gs(r,i)}}s(ufe,"setValueM4");function cfe(t,e){let r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}s(cfe,"setValueV1i");function hfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(ms(r,e))return;t.uniform2iv(this.addr,e),gs(r,e)}}s(hfe,"setValueV2i");function pfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(ms(r,e))return;t.uniform3iv(this.addr,e),gs(r,e)}}s(pfe,"setValueV3i");function dfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(ms(r,e))return;t.uniform4iv(this.addr,e),gs(r,e)}}s(dfe,"setValueV4i");function ffe(t,e){let r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}s(ffe,"setValueV1ui");function mfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(ms(r,e))return;t.uniform2uiv(this.addr,e),gs(r,e)}}s(mfe,"setValueV2ui");function gfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(ms(r,e))return;t.uniform3uiv(this.addr,e),gs(r,e)}}s(gfe,"setValueV3ui");function yfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(ms(r,e))return;t.uniform4uiv(this.addr,e),gs(r,e)}}s(yfe,"setValueV4ui");function vfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n);let a;this.type===t.SAMPLER_2D_SHADOW?(dW.compareFunction=zue,a=dW):a=Qde,r.setTexture2D(e||a,n)}s(vfe,"setValueT1");function _fe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(e||tfe,n)}s(_fe,"setValueT3D1");function xfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(e||rfe,n)}s(xfe,"setValueT6");function bfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(e||efe,n)}s(bfe,"setValueT2DArray1");function wfe(t){switch(t){case 5126:return ife;case 35664:return nfe;case 35665:return afe;case 35666:return ofe;case 35674:return sfe;case 35675:return lfe;case 35676:return ufe;case 5124:case 35670:return cfe;case 35667:case 35671:return hfe;case 35668:case 35672:return pfe;case 35669:case 35673:return dfe;case 5125:return ffe;case 36294:return mfe;case 36295:return gfe;case 36296:return yfe;case 35678:case 36198:case 36298:case 36306:case 35682:return vfe;case 35679:case 36299:case 36307:return _fe;case 35680:case 36300:case 36308:case 36293:return xfe;case 36289:case 36303:case 36311:case 36292:return bfe}}s(wfe,"getSingularSetter");function Afe(t,e){t.uniform1fv(this.addr,e)}s(Afe,"setValueV1fArray");function Sfe(t,e){let r=dv(e,this.size,2);t.uniform2fv(this.addr,r)}s(Sfe,"setValueV2fArray");function Mfe(t,e){let r=dv(e,this.size,3);t.uniform3fv(this.addr,r)}s(Mfe,"setValueV3fArray");function Efe(t,e){let r=dv(e,this.size,4);t.uniform4fv(this.addr,r)}s(Efe,"setValueV4fArray");function Cfe(t,e){let r=dv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,r)}s(Cfe,"setValueM2Array");function Ife(t,e){let r=dv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,r)}s(Ife,"setValueM3Array");function Tfe(t,e){let r=dv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,r)}s(Tfe,"setValueM4Array");function Pfe(t,e){t.uniform1iv(this.addr,e)}s(Pfe,"setValueV1iArray");function Lfe(t,e){t.uniform2iv(this.addr,e)}s(Lfe,"setValueV2iArray");function Dfe(t,e){t.uniform3iv(this.addr,e)}s(Dfe,"setValueV3iArray");function Rfe(t,e){t.uniform4iv(this.addr,e)}s(Rfe,"setValueV4iArray");function Ofe(t,e){t.uniform1uiv(this.addr,e)}s(Ofe,"setValueV1uiArray");function kfe(t,e){t.uniform2uiv(this.addr,e)}s(kfe,"setValueV2uiArray");function Nfe(t,e){t.uniform3uiv(this.addr,e)}s(Nfe,"setValueV3uiArray");function Ffe(t,e){t.uniform4uiv(this.addr,e)}s(Ffe,"setValueV4uiArray");function Bfe(t,e,r){let i=this.cache,n=e.length,a=zA(r,n);ms(i,a)||(t.uniform1iv(this.addr,a),gs(i,a));for(let o=0;o!==n;++o)r.setTexture2D(e[o]||Qde,a[o])}s(Bfe,"setValueT1Array");function zfe(t,e,r){let i=this.cache,n=e.length,a=zA(r,n);ms(i,a)||(t.uniform1iv(this.addr,a),gs(i,a));for(let o=0;o!==n;++o)r.setTexture3D(e[o]||tfe,a[o])}s(zfe,"setValueT3DArray");function Ufe(t,e,r){let i=this.cache,n=e.length,a=zA(r,n);ms(i,a)||(t.uniform1iv(this.addr,a),gs(i,a));for(let o=0;o!==n;++o)r.setTextureCube(e[o]||rfe,a[o])}s(Ufe,"setValueT6Array");function Vfe(t,e,r){let i=this.cache,n=e.length,a=zA(r,n);ms(i,a)||(t.uniform1iv(this.addr,a),gs(i,a));for(let o=0;o!==n;++o)r.setTexture2DArray(e[o]||efe,a[o])}s(Vfe,"setValueT2DArrayArray");function jfe(t){switch(t){case 5126:return Afe;case 35664:return Sfe;case 35665:return Mfe;case 35666:return Efe;case 35674:return Cfe;case 35675:return Ife;case 35676:return Tfe;case 5124:case 35670:return Pfe;case 35667:case 35671:return Lfe;case 35668:case 35672:return Dfe;case 35669:case 35673:return Rfe;case 5125:return Ofe;case 36294:return kfe;case 36295:return Nfe;case 36296:return Ffe;case 35678:case 36198:case 36298:case 36306:case 35682:return Bfe;case 35679:case 36299:case 36307:return zfe;case 35680:case 36300:case 36308:case 36293:return Ufe;case 36289:case 36303:case 36311:case 36292:return Vfe}}s(jfe,"getPureArraySetter");var $fe=class{constructor(e,r,i){this.id=e,this.addr=i,this.cache=[],this.type=r.type,this.setValue=wfe(r.type)}};s($fe,"SingleUniform");var rHe=$fe,Gfe=class{constructor(e,r,i){this.id=e,this.addr=i,this.cache=[],this.type=r.type,this.size=r.size,this.setValue=jfe(r.type)}};s(Gfe,"PureArrayUniform");var iHe=Gfe,Hfe=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,r,i){let n=this.seq;for(let a=0,o=n.length;a!==o;++a){let l=n[a];l.setValue(e,r[l.id],i)}}};s(Hfe,"StructuredUniform");var nHe=Hfe,T6=/(\w+)(\])?(\[|\.)?/g;function AO(t,e){t.seq.push(e),t.map[e.id]=e}s(AO,"addUniform");function qfe(t,e,r){let i=t.name,n=i.length;for(T6.lastIndex=0;;){let a=T6.exec(i),o=T6.lastIndex,l=a[1],u=a[2]==="]",c=a[3];if(u&&(l=l|0),c===void 0||c==="["&&o+2===n){AO(r,c===void 0?new rHe(l,t,e):new iHe(l,t,e));break}else{let p=r.map[l];p===void 0&&(p=new nHe(l),AO(r,p)),r=p}}}s(qfe,"parseUniform");var Wfe=class{constructor(e,r){this.seq=[],this.map={};let i=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){let a=e.getActiveUniform(r,n),o=e.getUniformLocation(r,a.name);qfe(a,o,this)}}setValue(e,r,i,n){let a=this.map[r];a!==void 0&&a.setValue(e,i,n)}setOptional(e,r,i){let n=r[i];n!==void 0&&this.setValue(e,i,n)}static upload(e,r,i,n){for(let a=0,o=r.length;a!==o;++a){let l=r[a],u=i[l.id];u.needsUpdate!==!1&&l.setValue(e,u.value,n)}}static seqWithValue(e,r){let i=[];for(let n=0,a=e.length;n!==a;++n){let o=e[n];o.id in r&&i.push(o)}return i}};s(Wfe,"WebGLUniforms");var sC=Wfe;function SO(t,e,r){let i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}s(SO,"WebGLShader");var aHe=37297,oHe=0;function Xfe(t,e){let r=t.split(`
`),i=[],n=Math.max(e-6,0),a=Math.min(e+6,r.length);for(let o=n;o<a;o++){let l=o+1;i.push("".concat(l===e?">":" "," ").concat(l,": ").concat(r[o]))}return i.join(`
`)}s(Xfe,"handleSource");var _W=new nn;function Zfe(t){Rn._getMatrix(_W,Rn.workingColorSpace,t);let e="mat3( ".concat(_W.elements.map(r=>r.toFixed(4))," )");switch(Rn.getTransfer(t)){case U3:return[e,"LinearTransferOETF"];case ga:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}s(Zfe,"getEncodingComponents");function MO(t,e,r){let i=t.getShaderParameter(e,t.COMPILE_STATUS),n=t.getShaderInfoLog(e).trim();if(i&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let o=parseInt(a[1]);return r.toUpperCase()+`

`+n+`

`+Xfe(t.getShaderSource(e),o)}else return n}s(MO,"getShaderErrors");function Yfe(t,e){let r=Zfe(e);return["vec4 ".concat(t,"( vec4 value ) {"),"	return ".concat(r[1],"( vec4( value.rgb * ").concat(r[0],", value.a ) );"),"}"].join(`
`)}s(Yfe,"getTexelEncodingFunction");function Kfe(t,e){let r;switch(e){case VUe:r="Linear";break;case jUe:r="Reinhard";break;case $Ue:r="Cineon";break;case GUe:r="ACESFilmic";break;case qUe:r="AgX";break;case WUe:r="Neutral";break;case HUe:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}s(Kfe,"getToneMappingFunction");var fE=new qe;function Jfe(){Rn.getLuminanceCoefficients(fE);let t=fE.x.toFixed(4),e=fE.y.toFixed(4),r=fE.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","	const vec3 weights = vec3( ".concat(t,", ").concat(e,", ").concat(r," );"),"	return dot( weights, rgb );","}"].join(`
`)}s(Jfe,"getLuminanceFunction");function Qfe(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(k1).join(`
`)}s(Qfe,"generateVertexExtensions");function eme(t){let e=[];for(let r in t){let i=t[r];i!==!1&&e.push("#define "+r+" "+i)}return e.join(`
`)}s(eme,"generateDefines");function tme(t,e){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let a=t.getActiveAttrib(e,n),o=a.name,l=1;a.type===t.FLOAT_MAT2&&(l=2),a.type===t.FLOAT_MAT3&&(l=3),a.type===t.FLOAT_MAT4&&(l=4),r[o]={type:a.type,location:t.getAttribLocation(e,o),locationSize:l}}return r}s(tme,"fetchAttributeLocations");function k1(t){return t!==""}s(k1,"filterEmptyLine");function EO(t,e){let r=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}s(EO,"replaceLightNums");function CO(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}s(CO,"replaceClippingPlaneNums");var sHe=/^[ \t]*#include +<([\w\d./]+)>/gm;function K3(t){return t.replace(sHe,rme)}s(K3,"resolveIncludes");var lHe=new Map;function rme(t,e){let r=Yi[e];if(r===void 0){let i=lHe.get(e);if(i!==void 0)r=Yi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return K3(r)}s(rme,"includeReplacer");var uHe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function IO(t){return t.replace(uHe,ime)}s(IO,"unrollLoops");function ime(t,e,r,i){let n="";for(let a=parseInt(e);a<parseInt(r);a++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}s(ime,"loopReplacer");function TO(t){let e="precision ".concat(t.precision,` float;
	precision `).concat(t.precision,` int;
	precision `).concat(t.precision,` sampler2D;
	precision `).concat(t.precision,` samplerCube;
	precision `).concat(t.precision,` sampler3D;
	precision `).concat(t.precision,` sampler2DArray;
	precision `).concat(t.precision,` sampler2DShadow;
	precision `).concat(t.precision,` samplerCubeShadow;
	precision `).concat(t.precision,` sampler2DArrayShadow;
	precision `).concat(t.precision,` isampler2D;
	precision `).concat(t.precision,` isampler3D;
	precision `).concat(t.precision,` isamplerCube;
	precision `).concat(t.precision,` isampler2DArray;
	precision `).concat(t.precision,` usampler2D;
	precision `).concat(t.precision,` usampler3D;
	precision `).concat(t.precision,` usamplerCube;
	precision `).concat(t.precision,` usampler2DArray;
	`);return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}s(TO,"generatePrecision");function nme(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Iue?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===xUe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Rd&&(e="SHADOWMAP_TYPE_VSM"),e}s(nme,"generateShadowMapTypeDefine");function ame(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case S_:case M_:e="ENVMAP_TYPE_CUBE";break;case RP:e="ENVMAP_TYPE_CUBE_UV";break}return e}s(ame,"generateEnvMapTypeDefine");function ome(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case M_:e="ENVMAP_MODE_REFRACTION";break}return e}s(ome,"generateEnvMapModeDefine");function sme(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case uB:e="ENVMAP_BLENDING_MULTIPLY";break;case zUe:e="ENVMAP_BLENDING_MIX";break;case UUe:e="ENVMAP_BLENDING_ADD";break}return e}s(sme,"generateEnvMapBlendingDefine");function lme(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let r=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}s(lme,"generateCubeUVSize");function ume(t,e,r,i){let n=t.getContext(),a=r.defines,o=r.vertexShader,l=r.fragmentShader,u=nme(r),c=ame(r),p=ome(r),m=sme(r),y=lme(r),v=Qfe(r),w=eme(a),E=n.createProgram(),M,I,P=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(M=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,w].filter(k1).join(`
`),M.length>0&&(M+=`
`),I=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,w].filter(k1).join(`
`),I.length>0&&(I+=`
`)):(M=[TO(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,w,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(k1).join(`
`),I=[TO(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,w,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+p:"",r.envMap?"#define "+m:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==qm?"#define TONE_MAPPING":"",r.toneMapping!==qm?Yi.tonemapping_pars_fragment:"",r.toneMapping!==qm?Kfe("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Yi.colorspace_pars_fragment,Yfe("linearToOutputTexel",r.outputColorSpace),Jfe(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(k1).join(`
`)),o=K3(o),o=EO(o,r),o=CO(o,r),l=K3(l),l=EO(l,r),l=CO(l,r),o=IO(o),l=IO(l),r.isRawShaderMaterial!==!0&&(P=`#version 300 es
`,M=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,I=["#define varying in",r.glslVersion===sO?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===sO?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+I);let C=P+M+o,T=P+I+l,O=SO(n,n.VERTEX_SHADER,C),F=SO(n,n.FRAGMENT_SHADER,T);n.attachShader(E,O),n.attachShader(E,F),r.index0AttributeName!==void 0?n.bindAttribLocation(E,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(E,0,"position"),n.linkProgram(E);function k(q){if(t.debug.checkShaderErrors){let W=n.getProgramInfoLog(E).trim(),J=n.getShaderInfoLog(O).trim(),V=n.getShaderInfoLog(F).trim(),oe=!0,Y=!0;if(n.getProgramParameter(E,n.LINK_STATUS)===!1)if(oe=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(n,E,O,F);else{let he=MO(n,O,"vertex"),Q=MO(n,F,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(E,n.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+W+`
`+he+`
`+Q)}else W!==""?console.warn("THREE.WebGLProgram: Program Info Log:",W):(J===""||V==="")&&(Y=!1);Y&&(q.diagnostics={runnable:oe,programLog:W,vertexShader:{log:J,prefix:M},fragmentShader:{log:V,prefix:I}})}n.deleteShader(O),n.deleteShader(F),B=new sC(n,E),U=tme(n,E)}s(k,"onFirstUse");let B;this.getUniforms=function(){return B===void 0&&k(this),B};let U;this.getAttributes=function(){return U===void 0&&k(this),U};let z=r.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return z===!1&&(z=n.getProgramParameter(E,aHe)),z},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(E),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=oHe++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=O,this.fragmentShader=F,this}s(ume,"WebGLProgram");var cHe=0,cme=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let r=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(r),a=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){let r=this.materialCache.get(e);for(let i of r)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let r=this.materialCache,i=r.get(e);return i===void 0&&(i=new Set,r.set(e,i)),i}_getShaderStage(e){let r=this.shaderCache,i=r.get(e);return i===void 0&&(i=new pHe(e),r.set(e,i)),i}};s(cme,"WebGLShaderCache");var hHe=cme,hme=class{constructor(e){this.id=cHe++,this.code=e,this.usedTimes=0}};s(hme,"WebGLShaderStage");var pHe=hme;function pme(t,e,r,i,n,a,o){let l=new vB,u=new hHe,c=new Set,p=[],m=n.logarithmicDepthBuffer,y=n.vertexTextures,v=n.precision,w={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(U){return c.add(U),U===0?"uv":"uv".concat(U)}s(E,"getChannel");function M(U,z,q,W,J){let V=W.fog,oe=J.geometry,Y=U.isMeshStandardMaterial?W.environment:null,he=(U.isMeshStandardMaterial?r:e).get(U.envMap||Y),Q=he&&he.mapping===RP?he.image.height:null,ae=w[U.type];U.precision!==null&&(v=n.getMaxPrecision(U.precision),v!==U.precision&&console.warn("THREE.WebGLProgram.getParameters:",U.precision,"not supported, using",v,"instead."));let ee=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,le=ee!==void 0?ee.length:0,K=0;oe.morphAttributes.position!==void 0&&(K=1),oe.morphAttributes.normal!==void 0&&(K=2),oe.morphAttributes.color!==void 0&&(K=3);let ce,te,ne,pe;if(ae){let st=Pp[ae];ce=st.vertexShader,te=st.fragmentShader}else ce=U.vertexShader,te=U.fragmentShader,u.update(U),ne=u.getVertexShaderID(U),pe=u.getFragmentShaderID(U);let xe=t.getRenderTarget(),Te=t.state.buffers.depth.getReversed(),fe=J.isInstancedMesh===!0,Pe=J.isBatchedMesh===!0,me=!!U.map,Ae=!!U.matcap,Ue=!!he,_e=!!U.aoMap,lt=!!U.lightMap,tt=!!U.bumpMap,We=!!U.normalMap,at=!!U.displacementMap,Lt=!!U.emissiveMap,dt=!!U.metalnessMap,Me=!!U.roughnessMap,ve=U.anisotropy>0,Ze=U.clearcoat>0,It=U.dispersion>0,Rt=U.iridescence>0,Et=U.sheen>0,pt=U.transmission>0,Yt=ve&&!!U.anisotropyMap,Kt=Ze&&!!U.clearcoatMap,$t=Ze&&!!U.clearcoatNormalMap,jt=Ze&&!!U.clearcoatRoughnessMap,Nt=Rt&&!!U.iridescenceMap,Fe=Rt&&!!U.iridescenceThicknessMap,Xe=Et&&!!U.sheenColorMap,ht=Et&&!!U.sheenRoughnessMap,rr=!!U.specularMap,ar=!!U.specularColorMap,Vr=!!U.specularIntensityMap,Qe=pt&&!!U.transmissionMap,er=pt&&!!U.thicknessMap,Oe=!!U.gradientMap,se=!!U.alphaMap,ue=U.alphaTest>0,Se=!!U.alphaHash,ze=!!U.extensions,Re=qm;U.toneMapped&&(xe===null||xe.isXRRenderTarget===!0)&&(Re=t.toneMapping);let yt={shaderID:ae,shaderType:U.type,shaderName:U.name,vertexShader:ce,fragmentShader:te,defines:U.defines,customVertexShaderID:ne,customFragmentShaderID:pe,isRawShaderMaterial:U.isRawShaderMaterial===!0,glslVersion:U.glslVersion,precision:v,batching:Pe,batchingColor:Pe&&J._colorsTexture!==null,instancing:fe,instancingColor:fe&&J.instanceColor!==null,instancingMorph:fe&&J.morphTexture!==null,supportsVertexTextures:y,outputColorSpace:xe===null?t.outputColorSpace:xe.isXRRenderTarget===!0?xe.texture.colorSpace:Wy,alphaToCoverage:!!U.alphaToCoverage,map:me,matcap:Ae,envMap:Ue,envMapMode:Ue&&he.mapping,envMapCubeUVHeight:Q,aoMap:_e,lightMap:lt,bumpMap:tt,normalMap:We,displacementMap:y&&at,emissiveMap:Lt,normalMapObjectSpace:We&&U.normalMapType===tVe,normalMapTangentSpace:We&&U.normalMapType===gB,metalnessMap:dt,roughnessMap:Me,anisotropy:ve,anisotropyMap:Yt,clearcoat:Ze,clearcoatMap:Kt,clearcoatNormalMap:$t,clearcoatRoughnessMap:jt,dispersion:It,iridescence:Rt,iridescenceMap:Nt,iridescenceThicknessMap:Fe,sheen:Et,sheenColorMap:Xe,sheenRoughnessMap:ht,specularMap:rr,specularColorMap:ar,specularIntensityMap:Vr,transmission:pt,transmissionMap:Qe,thicknessMap:er,gradientMap:Oe,opaque:U.transparent===!1&&U.blending===r_&&U.alphaToCoverage===!1,alphaMap:se,alphaTest:ue,alphaHash:Se,combine:U.combine,mapUv:me&&E(U.map.channel),aoMapUv:_e&&E(U.aoMap.channel),lightMapUv:lt&&E(U.lightMap.channel),bumpMapUv:tt&&E(U.bumpMap.channel),normalMapUv:We&&E(U.normalMap.channel),displacementMapUv:at&&E(U.displacementMap.channel),emissiveMapUv:Lt&&E(U.emissiveMap.channel),metalnessMapUv:dt&&E(U.metalnessMap.channel),roughnessMapUv:Me&&E(U.roughnessMap.channel),anisotropyMapUv:Yt&&E(U.anisotropyMap.channel),clearcoatMapUv:Kt&&E(U.clearcoatMap.channel),clearcoatNormalMapUv:$t&&E(U.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:jt&&E(U.clearcoatRoughnessMap.channel),iridescenceMapUv:Nt&&E(U.iridescenceMap.channel),iridescenceThicknessMapUv:Fe&&E(U.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&E(U.sheenColorMap.channel),sheenRoughnessMapUv:ht&&E(U.sheenRoughnessMap.channel),specularMapUv:rr&&E(U.specularMap.channel),specularColorMapUv:ar&&E(U.specularColorMap.channel),specularIntensityMapUv:Vr&&E(U.specularIntensityMap.channel),transmissionMapUv:Qe&&E(U.transmissionMap.channel),thicknessMapUv:er&&E(U.thicknessMap.channel),alphaMapUv:se&&E(U.alphaMap.channel),vertexTangents:!!oe.attributes.tangent&&(We||ve),vertexColors:U.vertexColors,vertexAlphas:U.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,pointsUvs:J.isPoints===!0&&!!oe.attributes.uv&&(me||se),fog:!!V,useFog:U.fog===!0,fogExp2:!!V&&V.isFogExp2,flatShading:U.flatShading===!0,sizeAttenuation:U.sizeAttenuation===!0,logarithmicDepthBuffer:m,reverseDepthBuffer:Te,skinning:J.isSkinnedMesh===!0,morphTargets:oe.morphAttributes.position!==void 0,morphNormals:oe.morphAttributes.normal!==void 0,morphColors:oe.morphAttributes.color!==void 0,morphTargetsCount:le,morphTextureStride:K,numDirLights:z.directional.length,numPointLights:z.point.length,numSpotLights:z.spot.length,numSpotLightMaps:z.spotLightMap.length,numRectAreaLights:z.rectArea.length,numHemiLights:z.hemi.length,numDirLightShadows:z.directionalShadowMap.length,numPointLightShadows:z.pointShadowMap.length,numSpotLightShadows:z.spotShadowMap.length,numSpotLightShadowsWithMaps:z.numSpotLightShadowsWithMaps,numLightProbes:z.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:U.dithering,shadowMapEnabled:t.shadowMap.enabled&&q.length>0,shadowMapType:t.shadowMap.type,toneMapping:Re,decodeVideoTexture:me&&U.map.isVideoTexture===!0&&Rn.getTransfer(U.map.colorSpace)===ga,decodeVideoTextureEmissive:Lt&&U.emissiveMap.isVideoTexture===!0&&Rn.getTransfer(U.emissiveMap.colorSpace)===ga,premultipliedAlpha:U.premultipliedAlpha,doubleSided:U.side===Pu,flipSided:U.side===tu,useDepthPacking:U.depthPacking>=0,depthPacking:U.depthPacking||0,index0AttributeName:U.index0AttributeName,extensionClipCullDistance:ze&&U.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ze&&U.extensions.multiDraw===!0||Pe)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:U.customProgramCacheKey()};return yt.vertexUv1s=c.has(1),yt.vertexUv2s=c.has(2),yt.vertexUv3s=c.has(3),c.clear(),yt}s(M,"getParameters");function I(U){let z=[];if(U.shaderID?z.push(U.shaderID):(z.push(U.customVertexShaderID),z.push(U.customFragmentShaderID)),U.defines!==void 0)for(let q in U.defines)z.push(q),z.push(U.defines[q]);return U.isRawShaderMaterial===!1&&(P(z,U),C(z,U),z.push(t.outputColorSpace)),z.push(U.customProgramCacheKey),z.join()}s(I,"getProgramCacheKey");function P(U,z){U.push(z.precision),U.push(z.outputColorSpace),U.push(z.envMapMode),U.push(z.envMapCubeUVHeight),U.push(z.mapUv),U.push(z.alphaMapUv),U.push(z.lightMapUv),U.push(z.aoMapUv),U.push(z.bumpMapUv),U.push(z.normalMapUv),U.push(z.displacementMapUv),U.push(z.emissiveMapUv),U.push(z.metalnessMapUv),U.push(z.roughnessMapUv),U.push(z.anisotropyMapUv),U.push(z.clearcoatMapUv),U.push(z.clearcoatNormalMapUv),U.push(z.clearcoatRoughnessMapUv),U.push(z.iridescenceMapUv),U.push(z.iridescenceThicknessMapUv),U.push(z.sheenColorMapUv),U.push(z.sheenRoughnessMapUv),U.push(z.specularMapUv),U.push(z.specularColorMapUv),U.push(z.specularIntensityMapUv),U.push(z.transmissionMapUv),U.push(z.thicknessMapUv),U.push(z.combine),U.push(z.fogExp2),U.push(z.sizeAttenuation),U.push(z.morphTargetsCount),U.push(z.morphAttributeCount),U.push(z.numDirLights),U.push(z.numPointLights),U.push(z.numSpotLights),U.push(z.numSpotLightMaps),U.push(z.numHemiLights),U.push(z.numRectAreaLights),U.push(z.numDirLightShadows),U.push(z.numPointLightShadows),U.push(z.numSpotLightShadows),U.push(z.numSpotLightShadowsWithMaps),U.push(z.numLightProbes),U.push(z.shadowMapType),U.push(z.toneMapping),U.push(z.numClippingPlanes),U.push(z.numClipIntersection),U.push(z.depthPacking)}s(P,"getProgramCacheKeyParameters");function C(U,z){l.disableAll(),z.supportsVertexTextures&&l.enable(0),z.instancing&&l.enable(1),z.instancingColor&&l.enable(2),z.instancingMorph&&l.enable(3),z.matcap&&l.enable(4),z.envMap&&l.enable(5),z.normalMapObjectSpace&&l.enable(6),z.normalMapTangentSpace&&l.enable(7),z.clearcoat&&l.enable(8),z.iridescence&&l.enable(9),z.alphaTest&&l.enable(10),z.vertexColors&&l.enable(11),z.vertexAlphas&&l.enable(12),z.vertexUv1s&&l.enable(13),z.vertexUv2s&&l.enable(14),z.vertexUv3s&&l.enable(15),z.vertexTangents&&l.enable(16),z.anisotropy&&l.enable(17),z.alphaHash&&l.enable(18),z.batching&&l.enable(19),z.dispersion&&l.enable(20),z.batchingColor&&l.enable(21),U.push(l.mask),l.disableAll(),z.fog&&l.enable(0),z.useFog&&l.enable(1),z.flatShading&&l.enable(2),z.logarithmicDepthBuffer&&l.enable(3),z.reverseDepthBuffer&&l.enable(4),z.skinning&&l.enable(5),z.morphTargets&&l.enable(6),z.morphNormals&&l.enable(7),z.morphColors&&l.enable(8),z.premultipliedAlpha&&l.enable(9),z.shadowMapEnabled&&l.enable(10),z.doubleSided&&l.enable(11),z.flipSided&&l.enable(12),z.useDepthPacking&&l.enable(13),z.dithering&&l.enable(14),z.transmission&&l.enable(15),z.sheen&&l.enable(16),z.opaque&&l.enable(17),z.pointsUvs&&l.enable(18),z.decodeVideoTexture&&l.enable(19),z.decodeVideoTextureEmissive&&l.enable(20),z.alphaToCoverage&&l.enable(21),U.push(l.mask)}s(C,"getProgramCacheKeyBooleans");function T(U){let z=w[U.type],q;if(z){let W=Pp[z];q=MVe.clone(W.uniforms)}else q=U.uniforms;return q}s(T,"getUniforms");function O(U,z){let q;for(let W=0,J=p.length;W<J;W++){let V=p[W];if(V.cacheKey===z){q=V,++q.usedTimes;break}}return q===void 0&&(q=new ume(t,z,U,a),p.push(q)),q}s(O,"acquireProgram");function F(U){if(--U.usedTimes===0){let z=p.indexOf(U);p[z]=p[p.length-1],p.pop(),U.destroy()}}s(F,"releaseProgram");function k(U){u.remove(U)}s(k,"releaseShaderCache");function B(){u.dispose()}return s(B,"dispose"),{getParameters:M,getProgramCacheKey:I,getUniforms:T,acquireProgram:O,releaseProgram:F,releaseShaderCache:k,programs:p,dispose:B}}s(pme,"WebGLPrograms");function dme(){let t=new WeakMap;function e(o){return t.has(o)}s(e,"has");function r(o){let l=t.get(o);return l===void 0&&(l={},t.set(o,l)),l}s(r,"get");function i(o){t.delete(o)}s(i,"remove");function n(o,l,u){t.get(o)[l]=u}s(n,"update");function a(){t=new WeakMap}return s(a,"dispose"),{has:e,get:r,remove:i,update:n,dispose:a}}s(dme,"WebGLProperties");function fme(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}s(fme,"painterSortStable");function PO(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}s(PO,"reversePainterSortStable");function LO(){let t=[],e=0,r=[],i=[],n=[];function a(){e=0,r.length=0,i.length=0,n.length=0}s(a,"init");function o(m,y,v,w,E,M){let I=t[e];return I===void 0?(I={id:m.id,object:m,geometry:y,material:v,groupOrder:w,renderOrder:m.renderOrder,z:E,group:M},t[e]=I):(I.id=m.id,I.object=m,I.geometry=y,I.material=v,I.groupOrder=w,I.renderOrder=m.renderOrder,I.z=E,I.group=M),e++,I}s(o,"getNextRenderItem");function l(m,y,v,w,E,M){let I=o(m,y,v,w,E,M);v.transmission>0?i.push(I):v.transparent===!0?n.push(I):r.push(I)}s(l,"push");function u(m,y,v,w,E,M){let I=o(m,y,v,w,E,M);v.transmission>0?i.unshift(I):v.transparent===!0?n.unshift(I):r.unshift(I)}s(u,"unshift");function c(m,y){r.length>1&&r.sort(m||fme),i.length>1&&i.sort(y||PO),n.length>1&&n.sort(y||PO)}s(c,"sort");function p(){for(let m=e,y=t.length;m<y;m++){let v=t[m];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return s(p,"finish"),{opaque:r,transmissive:i,transparent:n,init:a,push:l,unshift:u,finish:p,sort:c}}s(LO,"WebGLRenderList");function mme(){let t=new WeakMap;function e(i,n){let a=t.get(i),o;return a===void 0?(o=new LO,t.set(i,[o])):n>=a.length?(o=new LO,a.push(o)):o=a[n],o}s(e,"get");function r(){t=new WeakMap}return s(r,"dispose"),{get:e,dispose:r}}s(mme,"WebGLRenderLists");function gme(){let t={};return{get:s(function(e){if(t[e.id]!==void 0)return t[e.id];let r;switch(e.type){case"DirectionalLight":r={direction:new qe,color:new si};break;case"SpotLight":r={position:new qe,direction:new qe,color:new si,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new qe,color:new si,distance:0,decay:0};break;case"HemisphereLight":r={direction:new qe,skyColor:new si,groundColor:new si};break;case"RectAreaLight":r={color:new si,position:new qe,halfWidth:new qe,halfHeight:new qe};break}return t[e.id]=r,r},"get")}}s(gme,"UniformsCache");function yme(){let t={};return{get:s(function(e){if(t[e.id]!==void 0)return t[e.id];let r;switch(e.type){case"DirectionalLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=r,r},"get")}}s(yme,"ShadowUniformsCache");var dHe=0;function vme(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}s(vme,"shadowCastingAndTexturingLightsFirst");function _me(t){let e=new gme,r=yme(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new qe);let n=new qe,a=new Oi,o=new Oi;function l(c){let p=0,m=0,y=0;for(let U=0;U<9;U++)i.probe[U].set(0,0,0);let v=0,w=0,E=0,M=0,I=0,P=0,C=0,T=0,O=0,F=0,k=0;c.sort(vme);for(let U=0,z=c.length;U<z;U++){let q=c[U],W=q.color,J=q.intensity,V=q.distance,oe=q.shadow&&q.shadow.map?q.shadow.map.texture:null;if(q.isAmbientLight)p+=W.r*J,m+=W.g*J,y+=W.b*J;else if(q.isLightProbe){for(let Y=0;Y<9;Y++)i.probe[Y].addScaledVector(q.sh.coefficients[Y],J);k++}else if(q.isDirectionalLight){let Y=e.get(q);if(Y.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){let he=q.shadow,Q=r.get(q);Q.shadowIntensity=he.intensity,Q.shadowBias=he.bias,Q.shadowNormalBias=he.normalBias,Q.shadowRadius=he.radius,Q.shadowMapSize=he.mapSize,i.directionalShadow[v]=Q,i.directionalShadowMap[v]=oe,i.directionalShadowMatrix[v]=q.shadow.matrix,P++}i.directional[v]=Y,v++}else if(q.isSpotLight){let Y=e.get(q);Y.position.setFromMatrixPosition(q.matrixWorld),Y.color.copy(W).multiplyScalar(J),Y.distance=V,Y.coneCos=Math.cos(q.angle),Y.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),Y.decay=q.decay,i.spot[E]=Y;let he=q.shadow;if(q.map&&(i.spotLightMap[O]=q.map,O++,he.updateMatrices(q),q.castShadow&&F++),i.spotLightMatrix[E]=he.matrix,q.castShadow){let Q=r.get(q);Q.shadowIntensity=he.intensity,Q.shadowBias=he.bias,Q.shadowNormalBias=he.normalBias,Q.shadowRadius=he.radius,Q.shadowMapSize=he.mapSize,i.spotShadow[E]=Q,i.spotShadowMap[E]=oe,T++}E++}else if(q.isRectAreaLight){let Y=e.get(q);Y.color.copy(W).multiplyScalar(J),Y.halfWidth.set(q.width*.5,0,0),Y.halfHeight.set(0,q.height*.5,0),i.rectArea[M]=Y,M++}else if(q.isPointLight){let Y=e.get(q);if(Y.color.copy(q.color).multiplyScalar(q.intensity),Y.distance=q.distance,Y.decay=q.decay,q.castShadow){let he=q.shadow,Q=r.get(q);Q.shadowIntensity=he.intensity,Q.shadowBias=he.bias,Q.shadowNormalBias=he.normalBias,Q.shadowRadius=he.radius,Q.shadowMapSize=he.mapSize,Q.shadowCameraNear=he.camera.near,Q.shadowCameraFar=he.camera.far,i.pointShadow[w]=Q,i.pointShadowMap[w]=oe,i.pointShadowMatrix[w]=q.shadow.matrix,C++}i.point[w]=Y,w++}else if(q.isHemisphereLight){let Y=e.get(q);Y.skyColor.copy(q.color).multiplyScalar(J),Y.groundColor.copy(q.groundColor).multiplyScalar(J),i.hemi[I]=Y,I++}}M>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Pr.LTC_FLOAT_1,i.rectAreaLTC2=Pr.LTC_FLOAT_2):(i.rectAreaLTC1=Pr.LTC_HALF_1,i.rectAreaLTC2=Pr.LTC_HALF_2)),i.ambient[0]=p,i.ambient[1]=m,i.ambient[2]=y;let B=i.hash;(B.directionalLength!==v||B.pointLength!==w||B.spotLength!==E||B.rectAreaLength!==M||B.hemiLength!==I||B.numDirectionalShadows!==P||B.numPointShadows!==C||B.numSpotShadows!==T||B.numSpotMaps!==O||B.numLightProbes!==k)&&(i.directional.length=v,i.spot.length=E,i.rectArea.length=M,i.point.length=w,i.hemi.length=I,i.directionalShadow.length=P,i.directionalShadowMap.length=P,i.pointShadow.length=C,i.pointShadowMap.length=C,i.spotShadow.length=T,i.spotShadowMap.length=T,i.directionalShadowMatrix.length=P,i.pointShadowMatrix.length=C,i.spotLightMatrix.length=T+O-F,i.spotLightMap.length=O,i.numSpotLightShadowsWithMaps=F,i.numLightProbes=k,B.directionalLength=v,B.pointLength=w,B.spotLength=E,B.rectAreaLength=M,B.hemiLength=I,B.numDirectionalShadows=P,B.numPointShadows=C,B.numSpotShadows=T,B.numSpotMaps=O,B.numLightProbes=k,i.version=dHe++)}s(l,"setup");function u(c,p){let m=0,y=0,v=0,w=0,E=0,M=p.matrixWorldInverse;for(let I=0,P=c.length;I<P;I++){let C=c[I];if(C.isDirectionalLight){let T=i.directional[m];T.direction.setFromMatrixPosition(C.matrixWorld),n.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(M),m++}else if(C.isSpotLight){let T=i.spot[v];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(M),T.direction.setFromMatrixPosition(C.matrixWorld),n.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(M),v++}else if(C.isRectAreaLight){let T=i.rectArea[w];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(M),o.identity(),a.copy(C.matrixWorld),a.premultiply(M),o.extractRotation(a),T.halfWidth.set(C.width*.5,0,0),T.halfHeight.set(0,C.height*.5,0),T.halfWidth.applyMatrix4(o),T.halfHeight.applyMatrix4(o),w++}else if(C.isPointLight){let T=i.point[y];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(M),y++}else if(C.isHemisphereLight){let T=i.hemi[E];T.direction.setFromMatrixPosition(C.matrixWorld),T.direction.transformDirection(M),E++}}}return s(u,"setupView"),{setup:l,setupView:u,state:i}}s(_me,"WebGLLights");function DO(t){let e=new _me(t),r=[],i=[];function n(p){c.camera=p,r.length=0,i.length=0}s(n,"init");function a(p){r.push(p)}s(a,"pushLight");function o(p){i.push(p)}s(o,"pushShadow");function l(){e.setup(r)}s(l,"setupLights");function u(p){e.setupView(r,p)}s(u,"setupLightsView");let c={lightsArray:r,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:n,state:c,setupLights:l,setupLightsView:u,pushLight:a,pushShadow:o}}s(DO,"WebGLRenderState");function xme(t){let e=new WeakMap;function r(n,a=0){let o=e.get(n),l;return o===void 0?(l=new DO(t),e.set(n,[l])):a>=o.length?(l=new DO(t),o.push(l)):l=o[a],l}s(r,"get");function i(){e=new WeakMap}return s(i,"dispose"),{get:r,dispose:i}}s(xme,"WebGLRenderStates");var fHe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,mHe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function bme(t,e,r){let i=new OA,n=new Jt,a=new Jt,o=new Qn,l=new YVe({depthPacking:eVe}),u=new KVe,c={},p=r.maxTextureSize,m={[Qp]:tu,[tu]:Qp,[Pu]:Pu},y=new bc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Jt},radius:{value:4}},vertexShader:fHe,fragmentShader:mHe}),v=y.clone();v.defines.HORIZONTAL_PASS=1;let w=new js;w.setAttribute("position",new Yo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let E=new Pn(w,y),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Iue;let I=this.type;this.render=function(F,k,B){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||F.length===0)return;let U=t.getRenderTarget(),z=t.getActiveCubeFace(),q=t.getActiveMipmapLevel(),W=t.state;W.setBlending(Hm),W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);let J=I!==Rd&&this.type===Rd,V=I===Rd&&this.type!==Rd;for(let oe=0,Y=F.length;oe<Y;oe++){let he=F[oe],Q=he.shadow;if(Q===void 0){console.warn("THREE.WebGLShadowMap:",he,"has no shadow.");continue}if(Q.autoUpdate===!1&&Q.needsUpdate===!1)continue;n.copy(Q.mapSize);let ae=Q.getFrameExtents();if(n.multiply(ae),a.copy(Q.mapSize),(n.x>p||n.y>p)&&(n.x>p&&(a.x=Math.floor(p/ae.x),n.x=a.x*ae.x,Q.mapSize.x=a.x),n.y>p&&(a.y=Math.floor(p/ae.y),n.y=a.y*ae.y,Q.mapSize.y=a.y)),Q.map===null||J===!0||V===!0){let le=this.type!==Rd?{minFilter:_c,magFilter:_c}:{};Q.map!==null&&Q.map.dispose(),Q.map=new Qm(n.x,n.y,le),Q.map.texture.name=he.name+".shadowMap",Q.camera.updateProjectionMatrix()}t.setRenderTarget(Q.map),t.clear();let ee=Q.getViewportCount();for(let le=0;le<ee;le++){let K=Q.getViewport(le);o.set(a.x*K.x,a.y*K.y,a.x*K.z,a.y*K.w),W.viewport(o),Q.updateMatrices(he,le),i=Q.getFrustum(),T(k,B,Q.camera,he,this.type)}Q.isPointLightShadow!==!0&&this.type===Rd&&P(Q,B),Q.needsUpdate=!1}I=this.type,M.needsUpdate=!1,t.setRenderTarget(U,z,q)};function P(F,k){let B=e.update(E);y.defines.VSM_SAMPLES!==F.blurSamples&&(y.defines.VSM_SAMPLES=F.blurSamples,v.defines.VSM_SAMPLES=F.blurSamples,y.needsUpdate=!0,v.needsUpdate=!0),F.mapPass===null&&(F.mapPass=new Qm(n.x,n.y)),y.uniforms.shadow_pass.value=F.map.texture,y.uniforms.resolution.value=F.mapSize,y.uniforms.radius.value=F.radius,t.setRenderTarget(F.mapPass),t.clear(),t.renderBufferDirect(k,null,B,y,E,null),v.uniforms.shadow_pass.value=F.mapPass.texture,v.uniforms.resolution.value=F.mapSize,v.uniforms.radius.value=F.radius,t.setRenderTarget(F.map),t.clear(),t.renderBufferDirect(k,null,B,v,E,null)}s(P,"VSMPass");function C(F,k,B,U){let z=null,q=B.isPointLight===!0?F.customDistanceMaterial:F.customDepthMaterial;if(q!==void 0)z=q;else if(z=B.isPointLight===!0?u:l,t.localClippingEnabled&&k.clipShadows===!0&&Array.isArray(k.clippingPlanes)&&k.clippingPlanes.length!==0||k.displacementMap&&k.displacementScale!==0||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0){let W=z.uuid,J=k.uuid,V=c[W];V===void 0&&(V={},c[W]=V);let oe=V[J];oe===void 0&&(oe=z.clone(),V[J]=oe,k.addEventListener("dispose",O)),z=oe}if(z.visible=k.visible,z.wireframe=k.wireframe,U===Rd?z.side=k.shadowSide!==null?k.shadowSide:k.side:z.side=k.shadowSide!==null?k.shadowSide:m[k.side],z.alphaMap=k.alphaMap,z.alphaTest=k.alphaTest,z.map=k.map,z.clipShadows=k.clipShadows,z.clippingPlanes=k.clippingPlanes,z.clipIntersection=k.clipIntersection,z.displacementMap=k.displacementMap,z.displacementScale=k.displacementScale,z.displacementBias=k.displacementBias,z.wireframeLinewidth=k.wireframeLinewidth,z.linewidth=k.linewidth,B.isPointLight===!0&&z.isMeshDistanceMaterial===!0){let W=t.properties.get(z);W.light=B}return z}s(C,"getDepthMaterial");function T(F,k,B,U,z){if(F.visible===!1)return;if(F.layers.test(k.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&z===Rd)&&(!F.frustumCulled||i.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,F.matrixWorld);let W=e.update(F),J=F.material;if(Array.isArray(J)){let V=W.groups;for(let oe=0,Y=V.length;oe<Y;oe++){let he=V[oe],Q=J[he.materialIndex];if(Q&&Q.visible){let ae=C(F,Q,U,z);F.onBeforeShadow(t,F,k,B,W,ae,he),t.renderBufferDirect(B,null,W,ae,F,he),F.onAfterShadow(t,F,k,B,W,ae,he)}}}else if(J.visible){let V=C(F,J,U,z);F.onBeforeShadow(t,F,k,B,W,V,null),t.renderBufferDirect(B,null,W,V,F,null),F.onAfterShadow(t,F,k,B,W,V,null)}}let q=F.children;for(let W=0,J=q.length;W<J;W++)T(q[W],k,B,U,z)}s(T,"renderObject");function O(F){F.target.removeEventListener("dispose",O);for(let k in c){let B=c[k],U=F.target.uuid;U in B&&(B[U].dispose(),delete B[U])}}s(O,"onMaterialDispose")}s(bme,"WebGLShadowMap");var gHe={[AR]:SR,[MR]:IR,[ER]:TR,[A_]:CR,[SR]:AR,[IR]:MR,[TR]:ER,[CR]:A_};function wme(t,e){function r(){let Qe=!1,er=new Qn,Oe=null,se=new Qn(0,0,0,0);return{setMask:s(function(ue){Oe!==ue&&!Qe&&(t.colorMask(ue,ue,ue,ue),Oe=ue)},"setMask"),setLocked:s(function(ue){Qe=ue},"setLocked"),setClear:s(function(ue,Se,ze,Re,yt){yt===!0&&(ue*=Re,Se*=Re,ze*=Re),er.set(ue,Se,ze,Re),se.equals(er)===!1&&(t.clearColor(ue,Se,ze,Re),se.copy(er))},"setClear"),reset:s(function(){Qe=!1,Oe=null,se.set(-1,0,0,0)},"reset")}}s(r,"ColorBuffer");function i(){let Qe=!1,er=!1,Oe=null,se=null,ue=null;return{setReversed:s(function(Se){if(er!==Se){let ze=e.get("EXT_clip_control");er?ze.clipControlEXT(ze.LOWER_LEFT_EXT,ze.ZERO_TO_ONE_EXT):ze.clipControlEXT(ze.LOWER_LEFT_EXT,ze.NEGATIVE_ONE_TO_ONE_EXT);let Re=ue;ue=null,this.setClear(Re)}er=Se},"setReversed"),getReversed:s(function(){return er},"getReversed"),setTest:s(function(Se){Se?xe(t.DEPTH_TEST):Te(t.DEPTH_TEST)},"setTest"),setMask:s(function(Se){Oe!==Se&&!Qe&&(t.depthMask(Se),Oe=Se)},"setMask"),setFunc:s(function(Se){if(er&&(Se=gHe[Se]),se!==Se){switch(Se){case AR:t.depthFunc(t.NEVER);break;case SR:t.depthFunc(t.ALWAYS);break;case MR:t.depthFunc(t.LESS);break;case A_:t.depthFunc(t.LEQUAL);break;case ER:t.depthFunc(t.EQUAL);break;case CR:t.depthFunc(t.GEQUAL);break;case IR:t.depthFunc(t.GREATER);break;case TR:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}se=Se}},"setFunc"),setLocked:s(function(Se){Qe=Se},"setLocked"),setClear:s(function(Se){ue!==Se&&(er&&(Se=1-Se),t.clearDepth(Se),ue=Se)},"setClear"),reset:s(function(){Qe=!1,Oe=null,se=null,ue=null,er=!1},"reset")}}s(i,"DepthBuffer");function n(){let Qe=!1,er=null,Oe=null,se=null,ue=null,Se=null,ze=null,Re=null,yt=null;return{setTest:s(function(st){Qe||(st?xe(t.STENCIL_TEST):Te(t.STENCIL_TEST))},"setTest"),setMask:s(function(st){er!==st&&!Qe&&(t.stencilMask(st),er=st)},"setMask"),setFunc:s(function(st,kt,mt){(Oe!==st||se!==kt||ue!==mt)&&(t.stencilFunc(st,kt,mt),Oe=st,se=kt,ue=mt)},"setFunc"),setOp:s(function(st,kt,mt){(Se!==st||ze!==kt||Re!==mt)&&(t.stencilOp(st,kt,mt),Se=st,ze=kt,Re=mt)},"setOp"),setLocked:s(function(st){Qe=st},"setLocked"),setClear:s(function(st){yt!==st&&(t.clearStencil(st),yt=st)},"setClear"),reset:s(function(){Qe=!1,er=null,Oe=null,se=null,ue=null,Se=null,ze=null,Re=null,yt=null},"reset")}}s(n,"StencilBuffer");let a=new r,o=new i,l=new n,u=new WeakMap,c=new WeakMap,p={},m={},y=new WeakMap,v=[],w=null,E=!1,M=null,I=null,P=null,C=null,T=null,O=null,F=null,k=new si(0,0,0),B=0,U=!1,z=null,q=null,W=null,J=null,V=null,oe=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Y=!1,he=0,Q=t.getParameter(t.VERSION);Q.indexOf("WebGL")!==-1?(he=parseFloat(/^WebGL (\d)/.exec(Q)[1]),Y=he>=1):Q.indexOf("OpenGL ES")!==-1&&(he=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),Y=he>=2);let ae=null,ee={},le=t.getParameter(t.SCISSOR_BOX),K=t.getParameter(t.VIEWPORT),ce=new Qn().fromArray(le),te=new Qn().fromArray(K);function ne(Qe,er,Oe,se){let ue=new Uint8Array(4),Se=t.createTexture();t.bindTexture(Qe,Se),t.texParameteri(Qe,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(Qe,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let ze=0;ze<Oe;ze++)Qe===t.TEXTURE_3D||Qe===t.TEXTURE_2D_ARRAY?t.texImage3D(er,0,t.RGBA,1,1,se,0,t.RGBA,t.UNSIGNED_BYTE,ue):t.texImage2D(er+ze,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,ue);return Se}s(ne,"createTexture");let pe={};pe[t.TEXTURE_2D]=ne(t.TEXTURE_2D,t.TEXTURE_2D,1),pe[t.TEXTURE_CUBE_MAP]=ne(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),pe[t.TEXTURE_2D_ARRAY]=ne(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),pe[t.TEXTURE_3D]=ne(t.TEXTURE_3D,t.TEXTURE_3D,1,1),a.setClear(0,0,0,1),o.setClear(1),l.setClear(0),xe(t.DEPTH_TEST),o.setFunc(A_),tt(!1),We(gq),xe(t.CULL_FACE),_e(Hm);function xe(Qe){p[Qe]!==!0&&(t.enable(Qe),p[Qe]=!0)}s(xe,"enable");function Te(Qe){p[Qe]!==!1&&(t.disable(Qe),p[Qe]=!1)}s(Te,"disable");function fe(Qe,er){return m[Qe]!==er?(t.bindFramebuffer(Qe,er),m[Qe]=er,Qe===t.DRAW_FRAMEBUFFER&&(m[t.FRAMEBUFFER]=er),Qe===t.FRAMEBUFFER&&(m[t.DRAW_FRAMEBUFFER]=er),!0):!1}s(fe,"bindFramebuffer");function Pe(Qe,er){let Oe=v,se=!1;if(Qe){Oe=y.get(er),Oe===void 0&&(Oe=[],y.set(er,Oe));let ue=Qe.textures;if(Oe.length!==ue.length||Oe[0]!==t.COLOR_ATTACHMENT0){for(let Se=0,ze=ue.length;Se<ze;Se++)Oe[Se]=t.COLOR_ATTACHMENT0+Se;Oe.length=ue.length,se=!0}}else Oe[0]!==t.BACK&&(Oe[0]=t.BACK,se=!0);se&&t.drawBuffers(Oe)}s(Pe,"drawBuffers");function me(Qe){return w!==Qe?(t.useProgram(Qe),w=Qe,!0):!1}s(me,"useProgram");let Ae={[dy]:t.FUNC_ADD,[wUe]:t.FUNC_SUBTRACT,[AUe]:t.FUNC_REVERSE_SUBTRACT};Ae[SUe]=t.MIN,Ae[MUe]=t.MAX;let Ue={[EUe]:t.ZERO,[CUe]:t.ONE,[IUe]:t.SRC_COLOR,[bR]:t.SRC_ALPHA,[OUe]:t.SRC_ALPHA_SATURATE,[DUe]:t.DST_COLOR,[PUe]:t.DST_ALPHA,[TUe]:t.ONE_MINUS_SRC_COLOR,[wR]:t.ONE_MINUS_SRC_ALPHA,[RUe]:t.ONE_MINUS_DST_COLOR,[LUe]:t.ONE_MINUS_DST_ALPHA,[kUe]:t.CONSTANT_COLOR,[NUe]:t.ONE_MINUS_CONSTANT_COLOR,[FUe]:t.CONSTANT_ALPHA,[BUe]:t.ONE_MINUS_CONSTANT_ALPHA};function _e(Qe,er,Oe,se,ue,Se,ze,Re,yt,st){if(Qe===Hm){E===!0&&(Te(t.BLEND),E=!1);return}if(E===!1&&(xe(t.BLEND),E=!0),Qe!==bUe){if(Qe!==M||st!==U){if((I!==dy||T!==dy)&&(t.blendEquation(t.FUNC_ADD),I=dy,T=dy),st)switch(Qe){case r_:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case yq:t.blendFunc(t.ONE,t.ONE);break;case vq:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case _q:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Qe);break}else switch(Qe){case r_:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case yq:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case vq:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case _q:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Qe);break}P=null,C=null,O=null,F=null,k.set(0,0,0),B=0,M=Qe,U=st}return}ue=ue||er,Se=Se||Oe,ze=ze||se,(er!==I||ue!==T)&&(t.blendEquationSeparate(Ae[er],Ae[ue]),I=er,T=ue),(Oe!==P||se!==C||Se!==O||ze!==F)&&(t.blendFuncSeparate(Ue[Oe],Ue[se],Ue[Se],Ue[ze]),P=Oe,C=se,O=Se,F=ze),(Re.equals(k)===!1||yt!==B)&&(t.blendColor(Re.r,Re.g,Re.b,yt),k.copy(Re),B=yt),M=Qe,U=!1}s(_e,"setBlending");function lt(Qe,er){Qe.side===Pu?Te(t.CULL_FACE):xe(t.CULL_FACE);let Oe=Qe.side===tu;er&&(Oe=!Oe),tt(Oe),Qe.blending===r_&&Qe.transparent===!1?_e(Hm):_e(Qe.blending,Qe.blendEquation,Qe.blendSrc,Qe.blendDst,Qe.blendEquationAlpha,Qe.blendSrcAlpha,Qe.blendDstAlpha,Qe.blendColor,Qe.blendAlpha,Qe.premultipliedAlpha),o.setFunc(Qe.depthFunc),o.setTest(Qe.depthTest),o.setMask(Qe.depthWrite),a.setMask(Qe.colorWrite);let se=Qe.stencilWrite;l.setTest(se),se&&(l.setMask(Qe.stencilWriteMask),l.setFunc(Qe.stencilFunc,Qe.stencilRef,Qe.stencilFuncMask),l.setOp(Qe.stencilFail,Qe.stencilZFail,Qe.stencilZPass)),Lt(Qe.polygonOffset,Qe.polygonOffsetFactor,Qe.polygonOffsetUnits),Qe.alphaToCoverage===!0?xe(t.SAMPLE_ALPHA_TO_COVERAGE):Te(t.SAMPLE_ALPHA_TO_COVERAGE)}s(lt,"setMaterial");function tt(Qe){z!==Qe&&(Qe?t.frontFace(t.CW):t.frontFace(t.CCW),z=Qe)}s(tt,"setFlipSided");function We(Qe){Qe!==vUe?(xe(t.CULL_FACE),Qe!==q&&(Qe===gq?t.cullFace(t.BACK):Qe===_Ue?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Te(t.CULL_FACE),q=Qe}s(We,"setCullFace");function at(Qe){Qe!==W&&(Y&&t.lineWidth(Qe),W=Qe)}s(at,"setLineWidth");function Lt(Qe,er,Oe){Qe?(xe(t.POLYGON_OFFSET_FILL),(J!==er||V!==Oe)&&(t.polygonOffset(er,Oe),J=er,V=Oe)):Te(t.POLYGON_OFFSET_FILL)}s(Lt,"setPolygonOffset");function dt(Qe){Qe?xe(t.SCISSOR_TEST):Te(t.SCISSOR_TEST)}s(dt,"setScissorTest");function Me(Qe){Qe===void 0&&(Qe=t.TEXTURE0+oe-1),ae!==Qe&&(t.activeTexture(Qe),ae=Qe)}s(Me,"activeTexture");function ve(Qe,er,Oe){Oe===void 0&&(ae===null?Oe=t.TEXTURE0+oe-1:Oe=ae);let se=ee[Oe];se===void 0&&(se={type:void 0,texture:void 0},ee[Oe]=se),(se.type!==Qe||se.texture!==er)&&(ae!==Oe&&(t.activeTexture(Oe),ae=Oe),t.bindTexture(Qe,er||pe[Qe]),se.type=Qe,se.texture=er)}s(ve,"bindTexture");function Ze(){let Qe=ee[ae];Qe!==void 0&&Qe.type!==void 0&&(t.bindTexture(Qe.type,null),Qe.type=void 0,Qe.texture=void 0)}s(Ze,"unbindTexture");function It(){try{t.compressedTexImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(It,"compressedTexImage2D");function Rt(){try{t.compressedTexImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Rt,"compressedTexImage3D");function Et(){try{t.texSubImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Et,"texSubImage2D");function pt(){try{t.texSubImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(pt,"texSubImage3D");function Yt(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Yt,"compressedTexSubImage2D");function Kt(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Kt,"compressedTexSubImage3D");function $t(){try{t.texStorage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s($t,"texStorage2D");function jt(){try{t.texStorage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(jt,"texStorage3D");function Nt(){try{t.texImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Nt,"texImage2D");function Fe(){try{t.texImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Fe,"texImage3D");function Xe(Qe){ce.equals(Qe)===!1&&(t.scissor(Qe.x,Qe.y,Qe.z,Qe.w),ce.copy(Qe))}s(Xe,"scissor");function ht(Qe){te.equals(Qe)===!1&&(t.viewport(Qe.x,Qe.y,Qe.z,Qe.w),te.copy(Qe))}s(ht,"viewport");function rr(Qe,er){let Oe=c.get(er);Oe===void 0&&(Oe=new WeakMap,c.set(er,Oe));let se=Oe.get(Qe);se===void 0&&(se=t.getUniformBlockIndex(er,Qe.name),Oe.set(Qe,se))}s(rr,"updateUBOMapping");function ar(Qe,er){let Oe=c.get(er).get(Qe);u.get(er)!==Oe&&(t.uniformBlockBinding(er,Oe,Qe.__bindingPointIndex),u.set(er,Oe))}s(ar,"uniformBlockBinding");function Vr(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),p={},ae=null,ee={},m={},y=new WeakMap,v=[],w=null,E=!1,M=null,I=null,P=null,C=null,T=null,O=null,F=null,k=new si(0,0,0),B=0,U=!1,z=null,q=null,W=null,J=null,V=null,ce.set(0,0,t.canvas.width,t.canvas.height),te.set(0,0,t.canvas.width,t.canvas.height),a.reset(),o.reset(),l.reset()}return s(Vr,"reset"),{buffers:{color:a,depth:o,stencil:l},enable:xe,disable:Te,bindFramebuffer:fe,drawBuffers:Pe,useProgram:me,setBlending:_e,setMaterial:lt,setFlipSided:tt,setCullFace:We,setLineWidth:at,setPolygonOffset:Lt,setScissorTest:dt,activeTexture:Me,bindTexture:ve,unbindTexture:Ze,compressedTexImage2D:It,compressedTexImage3D:Rt,texImage2D:Nt,texImage3D:Fe,updateUBOMapping:rr,uniformBlockBinding:ar,texStorage2D:$t,texStorage3D:jt,texSubImage2D:Et,texSubImage3D:pt,compressedTexSubImage2D:Yt,compressedTexSubImage3D:Kt,scissor:Xe,viewport:ht,reset:Vr}}s(wme,"WebGLState");function Ame(t,e,r,i,n,a,o){let l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Jt,p=new WeakMap,m,y=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(Me,ve){return v?new OffscreenCanvas(Me,ve):T_("canvas")}s(w,"createCanvas");function E(Me,ve,Ze){let It=1,Rt=dt(Me);if((Rt.width>Ze||Rt.height>Ze)&&(It=Ze/Math.max(Rt.width,Rt.height)),It<1)if(typeof HTMLImageElement<"u"&&Me instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Me instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Me instanceof ImageBitmap||typeof VideoFrame<"u"&&Me instanceof VideoFrame){let Et=Math.floor(It*Rt.width),pt=Math.floor(It*Rt.height);m===void 0&&(m=w(Et,pt));let Yt=ve?w(Et,pt):m;return Yt.width=Et,Yt.height=pt,Yt.getContext("2d").drawImage(Me,0,0,Et,pt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Rt.width+"x"+Rt.height+") to ("+Et+"x"+pt+")."),Yt}else return"data"in Me&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Rt.width+"x"+Rt.height+")."),Me;return Me}s(E,"resizeImage");function M(Me){return Me.generateMipmaps}s(M,"textureNeedsGenerateMipmaps");function I(Me){t.generateMipmap(Me)}s(I,"generateMipmap");function P(Me){return Me.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Me.isWebGL3DRenderTarget?t.TEXTURE_3D:Me.isWebGLArrayRenderTarget||Me.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}s(P,"getTargetType");function C(Me,ve,Ze,It,Rt=!1){if(Me!==null){if(t[Me]!==void 0)return t[Me];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Me+"'")}let Et=ve;if(ve===t.RED&&(Ze===t.FLOAT&&(Et=t.R32F),Ze===t.HALF_FLOAT&&(Et=t.R16F),Ze===t.UNSIGNED_BYTE&&(Et=t.R8)),ve===t.RED_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.R8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.R16UI),Ze===t.UNSIGNED_INT&&(Et=t.R32UI),Ze===t.BYTE&&(Et=t.R8I),Ze===t.SHORT&&(Et=t.R16I),Ze===t.INT&&(Et=t.R32I)),ve===t.RG&&(Ze===t.FLOAT&&(Et=t.RG32F),Ze===t.HALF_FLOAT&&(Et=t.RG16F),Ze===t.UNSIGNED_BYTE&&(Et=t.RG8)),ve===t.RG_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.RG8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.RG16UI),Ze===t.UNSIGNED_INT&&(Et=t.RG32UI),Ze===t.BYTE&&(Et=t.RG8I),Ze===t.SHORT&&(Et=t.RG16I),Ze===t.INT&&(Et=t.RG32I)),ve===t.RGB_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.RGB8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.RGB16UI),Ze===t.UNSIGNED_INT&&(Et=t.RGB32UI),Ze===t.BYTE&&(Et=t.RGB8I),Ze===t.SHORT&&(Et=t.RGB16I),Ze===t.INT&&(Et=t.RGB32I)),ve===t.RGBA_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.RGBA8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.RGBA16UI),Ze===t.UNSIGNED_INT&&(Et=t.RGBA32UI),Ze===t.BYTE&&(Et=t.RGBA8I),Ze===t.SHORT&&(Et=t.RGBA16I),Ze===t.INT&&(Et=t.RGBA32I)),ve===t.RGB&&Ze===t.UNSIGNED_INT_5_9_9_9_REV&&(Et=t.RGB9_E5),ve===t.RGBA){let pt=Rt?U3:Rn.getTransfer(It);Ze===t.FLOAT&&(Et=t.RGBA32F),Ze===t.HALF_FLOAT&&(Et=t.RGBA16F),Ze===t.UNSIGNED_BYTE&&(Et=pt===ga?t.SRGB8_ALPHA8:t.RGBA8),Ze===t.UNSIGNED_SHORT_4_4_4_4&&(Et=t.RGBA4),Ze===t.UNSIGNED_SHORT_5_5_5_1&&(Et=t.RGB5_A1)}return(Et===t.R16F||Et===t.R32F||Et===t.RG16F||Et===t.RG32F||Et===t.RGBA16F||Et===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Et}s(C,"getInternalFormat");function T(Me,ve){let Ze;return Me?ve===null||ve===Jm||ve===E_?Ze=t.DEPTH24_STENCIL8:ve===Lu?Ze=t.DEPTH32F_STENCIL8:ve===Dw&&(Ze=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ve===null||ve===Jm||ve===E_?Ze=t.DEPTH_COMPONENT24:ve===Lu?Ze=t.DEPTH_COMPONENT32F:ve===Dw&&(Ze=t.DEPTH_COMPONENT16),Ze}s(T,"getInternalDepthFormat");function O(Me,ve){return M(Me)===!0||Me.isFramebufferTexture&&Me.minFilter!==_c&&Me.minFilter!==Up?Math.log2(Math.max(ve.width,ve.height))+1:Me.mipmaps!==void 0&&Me.mipmaps.length>0?Me.mipmaps.length:Me.isCompressedTexture&&Array.isArray(Me.image)?ve.mipmaps.length:1}s(O,"getMipLevels");function F(Me){let ve=Me.target;ve.removeEventListener("dispose",F),B(ve),ve.isVideoTexture&&p.delete(ve)}s(F,"onTextureDispose");function k(Me){let ve=Me.target;ve.removeEventListener("dispose",k),z(ve)}s(k,"onRenderTargetDispose");function B(Me){let ve=i.get(Me);if(ve.__webglInit===void 0)return;let Ze=Me.source,It=y.get(Ze);if(It){let Rt=It[ve.__cacheKey];Rt.usedTimes--,Rt.usedTimes===0&&U(Me),Object.keys(It).length===0&&y.delete(Ze)}i.remove(Me)}s(B,"deallocateTexture");function U(Me){let ve=i.get(Me);t.deleteTexture(ve.__webglTexture);let Ze=Me.source,It=y.get(Ze);delete It[ve.__cacheKey],o.memory.textures--}s(U,"deleteTexture");function z(Me){let ve=i.get(Me);if(Me.depthTexture&&(Me.depthTexture.dispose(),i.remove(Me.depthTexture)),Me.isWebGLCubeRenderTarget)for(let It=0;It<6;It++){if(Array.isArray(ve.__webglFramebuffer[It]))for(let Rt=0;Rt<ve.__webglFramebuffer[It].length;Rt++)t.deleteFramebuffer(ve.__webglFramebuffer[It][Rt]);else t.deleteFramebuffer(ve.__webglFramebuffer[It]);ve.__webglDepthbuffer&&t.deleteRenderbuffer(ve.__webglDepthbuffer[It])}else{if(Array.isArray(ve.__webglFramebuffer))for(let It=0;It<ve.__webglFramebuffer.length;It++)t.deleteFramebuffer(ve.__webglFramebuffer[It]);else t.deleteFramebuffer(ve.__webglFramebuffer);if(ve.__webglDepthbuffer&&t.deleteRenderbuffer(ve.__webglDepthbuffer),ve.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ve.__webglMultisampledFramebuffer),ve.__webglColorRenderbuffer)for(let It=0;It<ve.__webglColorRenderbuffer.length;It++)ve.__webglColorRenderbuffer[It]&&t.deleteRenderbuffer(ve.__webglColorRenderbuffer[It]);ve.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ve.__webglDepthRenderbuffer)}let Ze=Me.textures;for(let It=0,Rt=Ze.length;It<Rt;It++){let Et=i.get(Ze[It]);Et.__webglTexture&&(t.deleteTexture(Et.__webglTexture),o.memory.textures--),i.remove(Ze[It])}i.remove(Me)}s(z,"deallocateRenderTarget");let q=0;function W(){q=0}s(W,"resetTextureUnits");function J(){let Me=q;return Me>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Me+" texture units while this GPU supports only "+n.maxTextures),q+=1,Me}s(J,"allocateTextureUnit");function V(Me){let ve=[];return ve.push(Me.wrapS),ve.push(Me.wrapT),ve.push(Me.wrapR||0),ve.push(Me.magFilter),ve.push(Me.minFilter),ve.push(Me.anisotropy),ve.push(Me.internalFormat),ve.push(Me.format),ve.push(Me.type),ve.push(Me.generateMipmaps),ve.push(Me.premultiplyAlpha),ve.push(Me.flipY),ve.push(Me.unpackAlignment),ve.push(Me.colorSpace),ve.join()}s(V,"getTextureCacheKey");function oe(Me,ve){let Ze=i.get(Me);if(Me.isVideoTexture&&at(Me),Me.isRenderTargetTexture===!1&&Me.version>0&&Ze.__version!==Me.version){let It=Me.image;if(It===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(It.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{te(Ze,Me,ve);return}}r.bindTexture(t.TEXTURE_2D,Ze.__webglTexture,t.TEXTURE0+ve)}s(oe,"setTexture2D");function Y(Me,ve){let Ze=i.get(Me);if(Me.version>0&&Ze.__version!==Me.version){te(Ze,Me,ve);return}r.bindTexture(t.TEXTURE_2D_ARRAY,Ze.__webglTexture,t.TEXTURE0+ve)}s(Y,"setTexture2DArray");function he(Me,ve){let Ze=i.get(Me);if(Me.version>0&&Ze.__version!==Me.version){te(Ze,Me,ve);return}r.bindTexture(t.TEXTURE_3D,Ze.__webglTexture,t.TEXTURE0+ve)}s(he,"setTexture3D");function Q(Me,ve){let Ze=i.get(Me);if(Me.version>0&&Ze.__version!==Me.version){ne(Ze,Me,ve);return}r.bindTexture(t.TEXTURE_CUBE_MAP,Ze.__webglTexture,t.TEXTURE0+ve)}s(Q,"setTextureCube");let ae={[Bh]:t.REPEAT,[My]:t.CLAMP_TO_EDGE,[LR]:t.MIRRORED_REPEAT},ee={[_c]:t.NEAREST,[ZUe]:t.NEAREST_MIPMAP_NEAREST,[BM]:t.NEAREST_MIPMAP_LINEAR,[Up]:t.LINEAR,[HL]:t.LINEAR_MIPMAP_NEAREST,[Ey]:t.LINEAR_MIPMAP_LINEAR},le={[iVe]:t.NEVER,[uVe]:t.ALWAYS,[nVe]:t.LESS,[zue]:t.LEQUAL,[aVe]:t.EQUAL,[lVe]:t.GEQUAL,[oVe]:t.GREATER,[sVe]:t.NOTEQUAL};function K(Me,ve){if(ve.type===Lu&&e.has("OES_texture_float_linear")===!1&&(ve.magFilter===Up||ve.magFilter===HL||ve.magFilter===BM||ve.magFilter===Ey||ve.minFilter===Up||ve.minFilter===HL||ve.minFilter===BM||ve.minFilter===Ey)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Me,t.TEXTURE_WRAP_S,ae[ve.wrapS]),t.texParameteri(Me,t.TEXTURE_WRAP_T,ae[ve.wrapT]),(Me===t.TEXTURE_3D||Me===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Me,t.TEXTURE_WRAP_R,ae[ve.wrapR]),t.texParameteri(Me,t.TEXTURE_MAG_FILTER,ee[ve.magFilter]),t.texParameteri(Me,t.TEXTURE_MIN_FILTER,ee[ve.minFilter]),ve.compareFunction&&(t.texParameteri(Me,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Me,t.TEXTURE_COMPARE_FUNC,le[ve.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ve.magFilter===_c||ve.minFilter!==BM&&ve.minFilter!==Ey||ve.type===Lu&&e.has("OES_texture_float_linear")===!1)return;if(ve.anisotropy>1||i.get(ve).__currentAnisotropy){let Ze=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Me,Ze.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ve.anisotropy,n.getMaxAnisotropy())),i.get(ve).__currentAnisotropy=ve.anisotropy}}}s(K,"setTextureParameters");function ce(Me,ve){let Ze=!1;Me.__webglInit===void 0&&(Me.__webglInit=!0,ve.addEventListener("dispose",F));let It=ve.source,Rt=y.get(It);Rt===void 0&&(Rt={},y.set(It,Rt));let Et=V(ve);if(Et!==Me.__cacheKey){Rt[Et]===void 0&&(Rt[Et]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,Ze=!0),Rt[Et].usedTimes++;let pt=Rt[Me.__cacheKey];pt!==void 0&&(Rt[Me.__cacheKey].usedTimes--,pt.usedTimes===0&&U(ve)),Me.__cacheKey=Et,Me.__webglTexture=Rt[Et].texture}return Ze}s(ce,"initTexture");function te(Me,ve,Ze){let It=t.TEXTURE_2D;(ve.isDataArrayTexture||ve.isCompressedArrayTexture)&&(It=t.TEXTURE_2D_ARRAY),ve.isData3DTexture&&(It=t.TEXTURE_3D);let Rt=ce(Me,ve),Et=ve.source;r.bindTexture(It,Me.__webglTexture,t.TEXTURE0+Ze);let pt=i.get(Et);if(Et.version!==pt.__version||Rt===!0){r.activeTexture(t.TEXTURE0+Ze);let Yt=Rn.getPrimaries(Rn.workingColorSpace),Kt=ve.colorSpace===Nm?null:Rn.getPrimaries(ve.colorSpace),$t=ve.colorSpace===Nm||Yt===Kt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ve.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ve.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ve.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);let jt=E(ve.image,!1,n.maxTextureSize);jt=Lt(ve,jt);let Nt=a.convert(ve.format,ve.colorSpace),Fe=a.convert(ve.type),Xe=C(ve.internalFormat,Nt,Fe,ve.colorSpace,ve.isVideoTexture);K(It,ve);let ht,rr=ve.mipmaps,ar=ve.isVideoTexture!==!0,Vr=pt.__version===void 0||Rt===!0,Qe=Et.dataReady,er=O(ve,jt);if(ve.isDepthTexture)Xe=T(ve.format===C_,ve.type),Vr&&(ar?r.texStorage2D(t.TEXTURE_2D,1,Xe,jt.width,jt.height):r.texImage2D(t.TEXTURE_2D,0,Xe,jt.width,jt.height,0,Nt,Fe,null));else if(ve.isDataTexture)if(rr.length>0){ar&&Vr&&r.texStorage2D(t.TEXTURE_2D,er,Xe,rr[0].width,rr[0].height);for(let Oe=0,se=rr.length;Oe<se;Oe++)ht=rr[Oe],ar?Qe&&r.texSubImage2D(t.TEXTURE_2D,Oe,0,0,ht.width,ht.height,Nt,Fe,ht.data):r.texImage2D(t.TEXTURE_2D,Oe,Xe,ht.width,ht.height,0,Nt,Fe,ht.data);ve.generateMipmaps=!1}else ar?(Vr&&r.texStorage2D(t.TEXTURE_2D,er,Xe,jt.width,jt.height),Qe&&r.texSubImage2D(t.TEXTURE_2D,0,0,0,jt.width,jt.height,Nt,Fe,jt.data)):r.texImage2D(t.TEXTURE_2D,0,Xe,jt.width,jt.height,0,Nt,Fe,jt.data);else if(ve.isCompressedTexture)if(ve.isCompressedArrayTexture){ar&&Vr&&r.texStorage3D(t.TEXTURE_2D_ARRAY,er,Xe,rr[0].width,rr[0].height,jt.depth);for(let Oe=0,se=rr.length;Oe<se;Oe++)if(ht=rr[Oe],ve.format!==Dl)if(Nt!==null)if(ar){if(Qe)if(ve.layerUpdates.size>0){let ue=_O(ht.width,ht.height,ve.format,ve.type);for(let Se of ve.layerUpdates){let ze=ht.data.subarray(Se*ue/ht.data.BYTES_PER_ELEMENT,(Se+1)*ue/ht.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Oe,0,0,Se,ht.width,ht.height,1,Nt,ze)}ve.clearLayerUpdates()}else r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Oe,0,0,0,ht.width,ht.height,jt.depth,Nt,ht.data)}else r.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Oe,Xe,ht.width,ht.height,jt.depth,0,ht.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ar?Qe&&r.texSubImage3D(t.TEXTURE_2D_ARRAY,Oe,0,0,0,ht.width,ht.height,jt.depth,Nt,Fe,ht.data):r.texImage3D(t.TEXTURE_2D_ARRAY,Oe,Xe,ht.width,ht.height,jt.depth,0,Nt,Fe,ht.data)}else{ar&&Vr&&r.texStorage2D(t.TEXTURE_2D,er,Xe,rr[0].width,rr[0].height);for(let Oe=0,se=rr.length;Oe<se;Oe++)ht=rr[Oe],ve.format!==Dl?Nt!==null?ar?Qe&&r.compressedTexSubImage2D(t.TEXTURE_2D,Oe,0,0,ht.width,ht.height,Nt,ht.data):r.compressedTexImage2D(t.TEXTURE_2D,Oe,Xe,ht.width,ht.height,0,ht.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ar?Qe&&r.texSubImage2D(t.TEXTURE_2D,Oe,0,0,ht.width,ht.height,Nt,Fe,ht.data):r.texImage2D(t.TEXTURE_2D,Oe,Xe,ht.width,ht.height,0,Nt,Fe,ht.data)}else if(ve.isDataArrayTexture)if(ar){if(Vr&&r.texStorage3D(t.TEXTURE_2D_ARRAY,er,Xe,jt.width,jt.height,jt.depth),Qe)if(ve.layerUpdates.size>0){let Oe=_O(jt.width,jt.height,ve.format,ve.type);for(let se of ve.layerUpdates){let ue=jt.data.subarray(se*Oe/jt.data.BYTES_PER_ELEMENT,(se+1)*Oe/jt.data.BYTES_PER_ELEMENT);r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,se,jt.width,jt.height,1,Nt,Fe,ue)}ve.clearLayerUpdates()}else r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,jt.width,jt.height,jt.depth,Nt,Fe,jt.data)}else r.texImage3D(t.TEXTURE_2D_ARRAY,0,Xe,jt.width,jt.height,jt.depth,0,Nt,Fe,jt.data);else if(ve.isData3DTexture)ar?(Vr&&r.texStorage3D(t.TEXTURE_3D,er,Xe,jt.width,jt.height,jt.depth),Qe&&r.texSubImage3D(t.TEXTURE_3D,0,0,0,0,jt.width,jt.height,jt.depth,Nt,Fe,jt.data)):r.texImage3D(t.TEXTURE_3D,0,Xe,jt.width,jt.height,jt.depth,0,Nt,Fe,jt.data);else if(ve.isFramebufferTexture){if(Vr)if(ar)r.texStorage2D(t.TEXTURE_2D,er,Xe,jt.width,jt.height);else{let Oe=jt.width,se=jt.height;for(let ue=0;ue<er;ue++)r.texImage2D(t.TEXTURE_2D,ue,Xe,Oe,se,0,Nt,Fe,null),Oe>>=1,se>>=1}}else if(rr.length>0){if(ar&&Vr){let Oe=dt(rr[0]);r.texStorage2D(t.TEXTURE_2D,er,Xe,Oe.width,Oe.height)}for(let Oe=0,se=rr.length;Oe<se;Oe++)ht=rr[Oe],ar?Qe&&r.texSubImage2D(t.TEXTURE_2D,Oe,0,0,Nt,Fe,ht):r.texImage2D(t.TEXTURE_2D,Oe,Xe,Nt,Fe,ht);ve.generateMipmaps=!1}else if(ar){if(Vr){let Oe=dt(jt);r.texStorage2D(t.TEXTURE_2D,er,Xe,Oe.width,Oe.height)}Qe&&r.texSubImage2D(t.TEXTURE_2D,0,0,0,Nt,Fe,jt)}else r.texImage2D(t.TEXTURE_2D,0,Xe,Nt,Fe,jt);M(ve)&&I(It),pt.__version=Et.version,ve.onUpdate&&ve.onUpdate(ve)}Me.__version=ve.version}s(te,"uploadTexture");function ne(Me,ve,Ze){if(ve.image.length!==6)return;let It=ce(Me,ve),Rt=ve.source;r.bindTexture(t.TEXTURE_CUBE_MAP,Me.__webglTexture,t.TEXTURE0+Ze);let Et=i.get(Rt);if(Rt.version!==Et.__version||It===!0){r.activeTexture(t.TEXTURE0+Ze);let pt=Rn.getPrimaries(Rn.workingColorSpace),Yt=ve.colorSpace===Nm?null:Rn.getPrimaries(ve.colorSpace),Kt=ve.colorSpace===Nm||pt===Yt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ve.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ve.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ve.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Kt);let $t=ve.isCompressedTexture||ve.image[0].isCompressedTexture,jt=ve.image[0]&&ve.image[0].isDataTexture,Nt=[];for(let se=0;se<6;se++)!$t&&!jt?Nt[se]=E(ve.image[se],!0,n.maxCubemapSize):Nt[se]=jt?ve.image[se].image:ve.image[se],Nt[se]=Lt(ve,Nt[se]);let Fe=Nt[0],Xe=a.convert(ve.format,ve.colorSpace),ht=a.convert(ve.type),rr=C(ve.internalFormat,Xe,ht,ve.colorSpace),ar=ve.isVideoTexture!==!0,Vr=Et.__version===void 0||It===!0,Qe=Rt.dataReady,er=O(ve,Fe);K(t.TEXTURE_CUBE_MAP,ve);let Oe;if($t){ar&&Vr&&r.texStorage2D(t.TEXTURE_CUBE_MAP,er,rr,Fe.width,Fe.height);for(let se=0;se<6;se++){Oe=Nt[se].mipmaps;for(let ue=0;ue<Oe.length;ue++){let Se=Oe[ue];ve.format!==Dl?Xe!==null?ar?Qe&&r.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue,0,0,Se.width,Se.height,Xe,Se.data):r.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue,rr,Se.width,Se.height,0,Se.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue,0,0,Se.width,Se.height,Xe,ht,Se.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue,rr,Se.width,Se.height,0,Xe,ht,Se.data)}}}else{if(Oe=ve.mipmaps,ar&&Vr){Oe.length>0&&er++;let se=dt(Nt[0]);r.texStorage2D(t.TEXTURE_CUBE_MAP,er,rr,se.width,se.height)}for(let se=0;se<6;se++)if(jt){ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,Nt[se].width,Nt[se].height,Xe,ht,Nt[se].data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,rr,Nt[se].width,Nt[se].height,0,Xe,ht,Nt[se].data);for(let ue=0;ue<Oe.length;ue++){let Se=Oe[ue].image[se].image;ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue+1,0,0,Se.width,Se.height,Xe,ht,Se.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue+1,rr,Se.width,Se.height,0,Xe,ht,Se.data)}}else{ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,Xe,ht,Nt[se]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,rr,Xe,ht,Nt[se]);for(let ue=0;ue<Oe.length;ue++){let Se=Oe[ue];ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue+1,0,0,Xe,ht,Se.image[se]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,ue+1,rr,Xe,ht,Se.image[se])}}}M(ve)&&I(t.TEXTURE_CUBE_MAP),Et.__version=Rt.version,ve.onUpdate&&ve.onUpdate(ve)}Me.__version=ve.version}s(ne,"uploadCubeTexture");function pe(Me,ve,Ze,It,Rt,Et){let pt=a.convert(Ze.format,Ze.colorSpace),Yt=a.convert(Ze.type),Kt=C(Ze.internalFormat,pt,Yt,Ze.colorSpace),$t=i.get(ve),jt=i.get(Ze);if(jt.__renderTarget=ve,!$t.__hasExternalTextures){let Nt=Math.max(1,ve.width>>Et),Fe=Math.max(1,ve.height>>Et);Rt===t.TEXTURE_3D||Rt===t.TEXTURE_2D_ARRAY?r.texImage3D(Rt,Et,Kt,Nt,Fe,ve.depth,0,pt,Yt,null):r.texImage2D(Rt,Et,Kt,Nt,Fe,0,pt,Yt,null)}r.bindFramebuffer(t.FRAMEBUFFER,Me),We(ve)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,It,Rt,jt.__webglTexture,0,tt(ve)):(Rt===t.TEXTURE_2D||Rt>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Rt<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,It,Rt,jt.__webglTexture,Et),r.bindFramebuffer(t.FRAMEBUFFER,null)}s(pe,"setupFrameBufferTexture");function xe(Me,ve,Ze){if(t.bindRenderbuffer(t.RENDERBUFFER,Me),ve.depthBuffer){let It=ve.depthTexture,Rt=It&&It.isDepthTexture?It.type:null,Et=T(ve.stencilBuffer,Rt),pt=ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Yt=tt(ve);We(ve)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Yt,Et,ve.width,ve.height):Ze?t.renderbufferStorageMultisample(t.RENDERBUFFER,Yt,Et,ve.width,ve.height):t.renderbufferStorage(t.RENDERBUFFER,Et,ve.width,ve.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,pt,t.RENDERBUFFER,Me)}else{let It=ve.textures;for(let Rt=0;Rt<It.length;Rt++){let Et=It[Rt],pt=a.convert(Et.format,Et.colorSpace),Yt=a.convert(Et.type),Kt=C(Et.internalFormat,pt,Yt,Et.colorSpace),$t=tt(ve);Ze&&We(ve)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,$t,Kt,ve.width,ve.height):We(ve)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,$t,Kt,ve.width,ve.height):t.renderbufferStorage(t.RENDERBUFFER,Kt,ve.width,ve.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}s(xe,"setupRenderBufferStorage");function Te(Me,ve){if(ve&&ve.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(t.FRAMEBUFFER,Me),!(ve.depthTexture&&ve.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let Ze=i.get(ve.depthTexture);Ze.__renderTarget=ve,(!Ze.__webglTexture||ve.depthTexture.image.width!==ve.width||ve.depthTexture.image.height!==ve.height)&&(ve.depthTexture.image.width=ve.width,ve.depthTexture.image.height=ve.height,ve.depthTexture.needsUpdate=!0),oe(ve.depthTexture,0);let It=Ze.__webglTexture,Rt=tt(ve);if(ve.depthTexture.format===i_)We(ve)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,It,0,Rt):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,It,0);else if(ve.depthTexture.format===C_)We(ve)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,It,0,Rt):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,It,0);else throw new Error("Unknown depthTexture format")}s(Te,"setupDepthTexture");function fe(Me){let ve=i.get(Me),Ze=Me.isWebGLCubeRenderTarget===!0;if(ve.__boundDepthTexture!==Me.depthTexture){let It=Me.depthTexture;if(ve.__depthDisposeCallback&&ve.__depthDisposeCallback(),It){let Rt=s(()=>{delete ve.__boundDepthTexture,delete ve.__depthDisposeCallback,It.removeEventListener("dispose",Rt)},"disposeEvent");It.addEventListener("dispose",Rt),ve.__depthDisposeCallback=Rt}ve.__boundDepthTexture=It}if(Me.depthTexture&&!ve.__autoAllocateDepthBuffer){if(Ze)throw new Error("target.depthTexture not supported in Cube render targets");Te(ve.__webglFramebuffer,Me)}else if(Ze){ve.__webglDepthbuffer=[];for(let It=0;It<6;It++)if(r.bindFramebuffer(t.FRAMEBUFFER,ve.__webglFramebuffer[It]),ve.__webglDepthbuffer[It]===void 0)ve.__webglDepthbuffer[It]=t.createRenderbuffer(),xe(ve.__webglDepthbuffer[It],Me,!1);else{let Rt=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Et=ve.__webglDepthbuffer[It];t.bindRenderbuffer(t.RENDERBUFFER,Et),t.framebufferRenderbuffer(t.FRAMEBUFFER,Rt,t.RENDERBUFFER,Et)}}else if(r.bindFramebuffer(t.FRAMEBUFFER,ve.__webglFramebuffer),ve.__webglDepthbuffer===void 0)ve.__webglDepthbuffer=t.createRenderbuffer(),xe(ve.__webglDepthbuffer,Me,!1);else{let It=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Rt=ve.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Rt),t.framebufferRenderbuffer(t.FRAMEBUFFER,It,t.RENDERBUFFER,Rt)}r.bindFramebuffer(t.FRAMEBUFFER,null)}s(fe,"setupDepthRenderbuffer");function Pe(Me,ve,Ze){let It=i.get(Me);ve!==void 0&&pe(It.__webglFramebuffer,Me,Me.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Ze!==void 0&&fe(Me)}s(Pe,"rebindTextures");function me(Me){let ve=Me.texture,Ze=i.get(Me),It=i.get(ve);Me.addEventListener("dispose",k);let Rt=Me.textures,Et=Me.isWebGLCubeRenderTarget===!0,pt=Rt.length>1;if(pt||(It.__webglTexture===void 0&&(It.__webglTexture=t.createTexture()),It.__version=ve.version,o.memory.textures++),Et){Ze.__webglFramebuffer=[];for(let Yt=0;Yt<6;Yt++)if(ve.mipmaps&&ve.mipmaps.length>0){Ze.__webglFramebuffer[Yt]=[];for(let Kt=0;Kt<ve.mipmaps.length;Kt++)Ze.__webglFramebuffer[Yt][Kt]=t.createFramebuffer()}else Ze.__webglFramebuffer[Yt]=t.createFramebuffer()}else{if(ve.mipmaps&&ve.mipmaps.length>0){Ze.__webglFramebuffer=[];for(let Yt=0;Yt<ve.mipmaps.length;Yt++)Ze.__webglFramebuffer[Yt]=t.createFramebuffer()}else Ze.__webglFramebuffer=t.createFramebuffer();if(pt)for(let Yt=0,Kt=Rt.length;Yt<Kt;Yt++){let $t=i.get(Rt[Yt]);$t.__webglTexture===void 0&&($t.__webglTexture=t.createTexture(),o.memory.textures++)}if(Me.samples>0&&We(Me)===!1){Ze.__webglMultisampledFramebuffer=t.createFramebuffer(),Ze.__webglColorRenderbuffer=[],r.bindFramebuffer(t.FRAMEBUFFER,Ze.__webglMultisampledFramebuffer);for(let Yt=0;Yt<Rt.length;Yt++){let Kt=Rt[Yt];Ze.__webglColorRenderbuffer[Yt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Ze.__webglColorRenderbuffer[Yt]);let $t=a.convert(Kt.format,Kt.colorSpace),jt=a.convert(Kt.type),Nt=C(Kt.internalFormat,$t,jt,Kt.colorSpace,Me.isXRRenderTarget===!0),Fe=tt(Me);t.renderbufferStorageMultisample(t.RENDERBUFFER,Fe,Nt,Me.width,Me.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Yt,t.RENDERBUFFER,Ze.__webglColorRenderbuffer[Yt])}t.bindRenderbuffer(t.RENDERBUFFER,null),Me.depthBuffer&&(Ze.__webglDepthRenderbuffer=t.createRenderbuffer(),xe(Ze.__webglDepthRenderbuffer,Me,!0)),r.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Et){r.bindTexture(t.TEXTURE_CUBE_MAP,It.__webglTexture),K(t.TEXTURE_CUBE_MAP,ve);for(let Yt=0;Yt<6;Yt++)if(ve.mipmaps&&ve.mipmaps.length>0)for(let Kt=0;Kt<ve.mipmaps.length;Kt++)pe(Ze.__webglFramebuffer[Yt][Kt],Me,ve,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Yt,Kt);else pe(Ze.__webglFramebuffer[Yt],Me,ve,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Yt,0);M(ve)&&I(t.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(pt){for(let Yt=0,Kt=Rt.length;Yt<Kt;Yt++){let $t=Rt[Yt],jt=i.get($t);r.bindTexture(t.TEXTURE_2D,jt.__webglTexture),K(t.TEXTURE_2D,$t),pe(Ze.__webglFramebuffer,Me,$t,t.COLOR_ATTACHMENT0+Yt,t.TEXTURE_2D,0),M($t)&&I(t.TEXTURE_2D)}r.unbindTexture()}else{let Yt=t.TEXTURE_2D;if((Me.isWebGL3DRenderTarget||Me.isWebGLArrayRenderTarget)&&(Yt=Me.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),r.bindTexture(Yt,It.__webglTexture),K(Yt,ve),ve.mipmaps&&ve.mipmaps.length>0)for(let Kt=0;Kt<ve.mipmaps.length;Kt++)pe(Ze.__webglFramebuffer[Kt],Me,ve,t.COLOR_ATTACHMENT0,Yt,Kt);else pe(Ze.__webglFramebuffer,Me,ve,t.COLOR_ATTACHMENT0,Yt,0);M(ve)&&I(Yt),r.unbindTexture()}Me.depthBuffer&&fe(Me)}s(me,"setupRenderTarget");function Ae(Me){let ve=Me.textures;for(let Ze=0,It=ve.length;Ze<It;Ze++){let Rt=ve[Ze];if(M(Rt)){let Et=P(Me),pt=i.get(Rt).__webglTexture;r.bindTexture(Et,pt),I(Et),r.unbindTexture()}}}s(Ae,"updateRenderTargetMipmap");let Ue=[],_e=[];function lt(Me){if(Me.samples>0){if(We(Me)===!1){let ve=Me.textures,Ze=Me.width,It=Me.height,Rt=t.COLOR_BUFFER_BIT,Et=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,pt=i.get(Me),Yt=ve.length>1;if(Yt)for(let Kt=0;Kt<ve.length;Kt++)r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.RENDERBUFFER,null),r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.TEXTURE_2D,null,0);r.bindFramebuffer(t.READ_FRAMEBUFFER,pt.__webglMultisampledFramebuffer),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,pt.__webglFramebuffer);for(let Kt=0;Kt<ve.length;Kt++){if(Me.resolveDepthBuffer&&(Me.depthBuffer&&(Rt|=t.DEPTH_BUFFER_BIT),Me.stencilBuffer&&Me.resolveStencilBuffer&&(Rt|=t.STENCIL_BUFFER_BIT)),Yt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,pt.__webglColorRenderbuffer[Kt]);let $t=i.get(ve[Kt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,$t,0)}t.blitFramebuffer(0,0,Ze,It,0,0,Ze,It,Rt,t.NEAREST),u===!0&&(Ue.length=0,_e.length=0,Ue.push(t.COLOR_ATTACHMENT0+Kt),Me.depthBuffer&&Me.resolveDepthBuffer===!1&&(Ue.push(Et),_e.push(Et),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,_e)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ue))}if(r.bindFramebuffer(t.READ_FRAMEBUFFER,null),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Yt)for(let Kt=0;Kt<ve.length;Kt++){r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.RENDERBUFFER,pt.__webglColorRenderbuffer[Kt]);let $t=i.get(ve[Kt]).__webglTexture;r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.TEXTURE_2D,$t,0)}r.bindFramebuffer(t.DRAW_FRAMEBUFFER,pt.__webglMultisampledFramebuffer)}else if(Me.depthBuffer&&Me.resolveDepthBuffer===!1&&u){let ve=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[ve])}}}s(lt,"updateMultisampleRenderTarget");function tt(Me){return Math.min(n.maxSamples,Me.samples)}s(tt,"getRenderTargetSamples");function We(Me){let ve=i.get(Me);return Me.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ve.__useRenderToTexture!==!1}s(We,"useMultisampledRTT");function at(Me){let ve=o.render.frame;p.get(Me)!==ve&&(p.set(Me,ve),Me.update())}s(at,"updateVideoTexture");function Lt(Me,ve){let Ze=Me.colorSpace,It=Me.format,Rt=Me.type;return Me.isCompressedTexture===!0||Me.isVideoTexture===!0||Ze!==Wy&&Ze!==Nm&&(Rn.getTransfer(Ze)===ga?(It!==Dl||Rt!==ed)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ze)),ve}s(Lt,"verifyColorSpace");function dt(Me){return typeof HTMLImageElement<"u"&&Me instanceof HTMLImageElement?(c.width=Me.naturalWidth||Me.width,c.height=Me.naturalHeight||Me.height):typeof VideoFrame<"u"&&Me instanceof VideoFrame?(c.width=Me.displayWidth,c.height=Me.displayHeight):(c.width=Me.width,c.height=Me.height),c}s(dt,"getDimensions"),this.allocateTextureUnit=J,this.resetTextureUnits=W,this.setTexture2D=oe,this.setTexture2DArray=Y,this.setTexture3D=he,this.setTextureCube=Q,this.rebindTextures=Pe,this.setupRenderTarget=me,this.updateRenderTargetMipmap=Ae,this.updateMultisampleRenderTarget=lt,this.setupDepthRenderbuffer=fe,this.setupFrameBufferTexture=pe,this.useMultisampledRTT=We}s(Ame,"WebGLTextures");function Sme(t,e){function r(i,n=Nm){let a,o=Rn.getTransfer(n);if(i===ed)return t.UNSIGNED_BYTE;if(i===hB)return t.UNSIGNED_SHORT_4_4_4_4;if(i===pB)return t.UNSIGNED_SHORT_5_5_5_1;if(i===Due)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===Pue)return t.BYTE;if(i===Lue)return t.SHORT;if(i===Dw)return t.UNSIGNED_SHORT;if(i===cB)return t.INT;if(i===Jm)return t.UNSIGNED_INT;if(i===Lu)return t.FLOAT;if(i===LA)return t.HALF_FLOAT;if(i===Rue)return t.ALPHA;if(i===Oue)return t.RGB;if(i===Dl)return t.RGBA;if(i===kue)return t.LUMINANCE;if(i===Nue)return t.LUMINANCE_ALPHA;if(i===i_)return t.DEPTH_COMPONENT;if(i===C_)return t.DEPTH_STENCIL;if(i===dB)return t.RED;if(i===OP)return t.RED_INTEGER;if(i===Fue)return t.RG;if(i===fB)return t.RG_INTEGER;if(i===mB)return t.RGBA_INTEGER;if(i===YE||i===KE||i===JE||i===QE)if(o===ga)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(i===YE)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===KE)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===JE)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===QE)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(i===YE)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===KE)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===JE)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===QE)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===DR||i===RR||i===OR||i===kR)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(i===DR)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===RR)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===OR)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===kR)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===NR||i===FR||i===BR)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(i===NR||i===FR)return o===ga?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===BR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===zR||i===UR||i===VR||i===jR||i===$R||i===GR||i===HR||i===qR||i===WR||i===XR||i===ZR||i===YR||i===KR||i===JR)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(i===zR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===UR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===VR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===jR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===$R)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===GR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===HR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===qR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===WR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===XR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===ZR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===YR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===KR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===JR)return o===ga?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===eC||i===QR||i===eO)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(i===eC)return o===ga?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===QR)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===eO)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===Bue||i===tO||i===rO||i===iO)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(i===eC)return a.COMPRESSED_RED_RGTC1_EXT;if(i===tO)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===rO)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===iO)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===E_?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return s(r,"convert"),{convert:r}}s(Sme,"WebGLUtils");var yHe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,vHe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,Mme=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,r,i){if(this.texture===null){let n=new Gu,a=e.properties.get(n);a.__webglTexture=r.texture,(r.depthNear!==i.depthNear||r.depthFar!==i.depthFar)&&(this.depthNear=r.depthNear,this.depthFar=r.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){let r=e.cameras[0].viewport,i=new bc({vertexShader:yHe,fragmentShader:vHe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new Pn(new pv(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}};s(Mme,"WebXRDepthSensing");var _He=Mme,Eme=class extends ox{constructor(e,r){super();let i=this,n=null,a=1,o=null,l="local-floor",u=1,c=null,p=null,m=null,y=null,v=null,w=null,E=new _He,M=r.getContextAttributes(),I=null,P=null,C=[],T=[],O=new Jt,F=null,k=new Kl;k.viewport=new Qn;let B=new Kl;B.viewport=new Qn;let U=[k,B],z=new cje,q=null,W=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(te){let ne=C[te];return ne===void 0&&(ne=new c6,C[te]=ne),ne.getTargetRaySpace()},this.getControllerGrip=function(te){let ne=C[te];return ne===void 0&&(ne=new c6,C[te]=ne),ne.getGripSpace()},this.getHand=function(te){let ne=C[te];return ne===void 0&&(ne=new c6,C[te]=ne),ne.getHandSpace()};function J(te){let ne=T.indexOf(te.inputSource);if(ne===-1)return;let pe=C[ne];pe!==void 0&&(pe.update(te.inputSource,te.frame,c||o),pe.dispatchEvent({type:te.type,data:te.inputSource}))}s(J,"onSessionEvent");function V(){n.removeEventListener("select",J),n.removeEventListener("selectstart",J),n.removeEventListener("selectend",J),n.removeEventListener("squeeze",J),n.removeEventListener("squeezestart",J),n.removeEventListener("squeezeend",J),n.removeEventListener("end",V),n.removeEventListener("inputsourceschange",oe);for(let te=0;te<C.length;te++){let ne=T[te];ne!==null&&(T[te]=null,C[te].disconnect(ne))}q=null,W=null,E.reset(),e.setRenderTarget(I),v=null,y=null,m=null,n=null,P=null,ce.stop(),i.isPresenting=!1,e.setPixelRatio(F),e.setSize(O.width,O.height,!1),i.dispatchEvent({type:"sessionend"})}s(V,"onSessionEnd"),this.setFramebufferScaleFactor=function(te){a=te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(te){l=te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(te){c=te},this.getBaseLayer=function(){return y!==null?y:v},this.getBinding=function(){return m},this.getFrame=function(){return w},this.getSession=function(){return n},this.setSession=async function(te){if(n=te,n!==null){if(I=e.getRenderTarget(),n.addEventListener("select",J),n.addEventListener("selectstart",J),n.addEventListener("selectend",J),n.addEventListener("squeeze",J),n.addEventListener("squeezestart",J),n.addEventListener("squeezeend",J),n.addEventListener("end",V),n.addEventListener("inputsourceschange",oe),M.xrCompatible!==!0&&await r.makeXRCompatible(),F=e.getPixelRatio(),e.getSize(O),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let ne=null,pe=null,xe=null;M.depth&&(xe=M.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,ne=M.stencil?C_:i_,pe=M.stencil?E_:Jm);let Te={colorFormat:r.RGBA8,depthFormat:xe,scaleFactor:a};m=new XRWebGLBinding(n,r),y=m.createProjectionLayer(Te),n.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),P=new Qm(y.textureWidth,y.textureHeight,{format:Dl,type:ed,depthTexture:new Ohe(y.textureWidth,y.textureHeight,pe,void 0,void 0,void 0,void 0,void 0,void 0,ne),stencilBuffer:M.stencil,colorSpace:e.outputColorSpace,samples:M.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1})}else{let ne={antialias:M.antialias,alpha:!0,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:a};v=new XRWebGLLayer(n,r,ne),n.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),P=new Qm(v.framebufferWidth,v.framebufferHeight,{format:Dl,type:ed,colorSpace:e.outputColorSpace,stencilBuffer:M.stencil})}P.isXRRenderTarget=!0,this.setFoveation(u),c=null,o=await n.requestReferenceSpace(l),ce.setContext(n),ce.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(n!==null)return n.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function oe(te){for(let ne=0;ne<te.removed.length;ne++){let pe=te.removed[ne],xe=T.indexOf(pe);xe>=0&&(T[xe]=null,C[xe].disconnect(pe))}for(let ne=0;ne<te.added.length;ne++){let pe=te.added[ne],xe=T.indexOf(pe);if(xe===-1){for(let fe=0;fe<C.length;fe++)if(fe>=T.length){T.push(pe),xe=fe;break}else if(T[fe]===null){T[fe]=pe,xe=fe;break}if(xe===-1)break}let Te=C[xe];Te&&Te.connect(pe)}}s(oe,"onInputSourcesChange");let Y=new qe,he=new qe;function Q(te,ne,pe){Y.setFromMatrixPosition(ne.matrixWorld),he.setFromMatrixPosition(pe.matrixWorld);let xe=Y.distanceTo(he),Te=ne.projectionMatrix.elements,fe=pe.projectionMatrix.elements,Pe=Te[14]/(Te[10]-1),me=Te[14]/(Te[10]+1),Ae=(Te[9]+1)/Te[5],Ue=(Te[9]-1)/Te[5],_e=(Te[8]-1)/Te[0],lt=(fe[8]+1)/fe[0],tt=Pe*_e,We=Pe*lt,at=xe/(-_e+lt),Lt=at*-_e;if(ne.matrixWorld.decompose(te.position,te.quaternion,te.scale),te.translateX(Lt),te.translateZ(at),te.matrixWorld.compose(te.position,te.quaternion,te.scale),te.matrixWorldInverse.copy(te.matrixWorld).invert(),Te[10]===-1)te.projectionMatrix.copy(ne.projectionMatrix),te.projectionMatrixInverse.copy(ne.projectionMatrixInverse);else{let dt=Pe+at,Me=me+at,ve=tt-Lt,Ze=We+(xe-Lt),It=Ae*me/Me*dt,Rt=Ue*me/Me*dt;te.projectionMatrix.makePerspective(ve,Ze,It,Rt,dt,Me),te.projectionMatrixInverse.copy(te.projectionMatrix).invert()}}s(Q,"setProjectionFromUnion");function ae(te,ne){ne===null?te.matrixWorld.copy(te.matrix):te.matrixWorld.multiplyMatrices(ne.matrixWorld,te.matrix),te.matrixWorldInverse.copy(te.matrixWorld).invert()}s(ae,"updateCamera"),this.updateCamera=function(te){if(n===null)return;let ne=te.near,pe=te.far;E.texture!==null&&(E.depthNear>0&&(ne=E.depthNear),E.depthFar>0&&(pe=E.depthFar)),z.near=B.near=k.near=ne,z.far=B.far=k.far=pe,(q!==z.near||W!==z.far)&&(n.updateRenderState({depthNear:z.near,depthFar:z.far}),q=z.near,W=z.far),k.layers.mask=te.layers.mask|2,B.layers.mask=te.layers.mask|4,z.layers.mask=k.layers.mask|B.layers.mask;let xe=te.parent,Te=z.cameras;ae(z,xe);for(let fe=0;fe<Te.length;fe++)ae(Te[fe],xe);Te.length===2?Q(z,k,B):z.projectionMatrix.copy(k.projectionMatrix),ee(te,z,xe)};function ee(te,ne,pe){pe===null?te.matrix.copy(ne.matrixWorld):(te.matrix.copy(pe.matrixWorld),te.matrix.invert(),te.matrix.multiply(ne.matrixWorld)),te.matrix.decompose(te.position,te.quaternion,te.scale),te.updateMatrixWorld(!0),te.projectionMatrix.copy(ne.projectionMatrix),te.projectionMatrixInverse.copy(ne.projectionMatrixInverse),te.isPerspectiveCamera&&(te.fov=I_*2*Math.atan(1/te.projectionMatrix.elements[5]),te.zoom=1)}s(ee,"updateUserCamera"),this.getCamera=function(){return z},this.getFoveation=function(){if(!(y===null&&v===null))return u},this.setFoveation=function(te){u=te,y!==null&&(y.fixedFoveation=te),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=te)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(z)};let le=null;function K(te,ne){if(p=ne.getViewerPose(c||o),w=ne,p!==null){let pe=p.views;v!==null&&(e.setRenderTargetFramebuffer(P,v.framebuffer),e.setRenderTarget(P));let xe=!1;pe.length!==z.cameras.length&&(z.cameras.length=0,xe=!0);for(let fe=0;fe<pe.length;fe++){let Pe=pe[fe],me=null;if(v!==null)me=v.getViewport(Pe);else{let Ue=m.getViewSubImage(y,Pe);me=Ue.viewport,fe===0&&(e.setRenderTargetTextures(P,Ue.colorTexture,y.ignoreDepthValues?void 0:Ue.depthStencilTexture),e.setRenderTarget(P))}let Ae=U[fe];Ae===void 0&&(Ae=new Kl,Ae.layers.enable(fe),Ae.viewport=new Qn,U[fe]=Ae),Ae.matrix.fromArray(Pe.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.quaternion,Ae.scale),Ae.projectionMatrix.fromArray(Pe.projectionMatrix),Ae.projectionMatrixInverse.copy(Ae.projectionMatrix).invert(),Ae.viewport.set(me.x,me.y,me.width,me.height),fe===0&&(z.matrix.copy(Ae.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale)),xe===!0&&z.cameras.push(Ae)}let Te=n.enabledFeatures;if(Te&&Te.includes("depth-sensing")&&n.depthUsage=="gpu-optimized"&&m){let fe=m.getDepthInformation(pe[0]);fe&&fe.isValid&&fe.texture&&E.init(e,fe,n.renderState)}}for(let pe=0;pe<C.length;pe++){let xe=T[pe],Te=C[pe];xe!==null&&Te!==void 0&&Te.update(xe,ne,c||o)}le&&le(te,ne),ne.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ne}),w=null}s(K,"onAnimationFrame");let ce=new RB;ce.setAnimationLoop(K),this.setAnimationLoop=function(te){le=te},this.dispose=function(){}}};s(Eme,"WebXRManager");var xHe=Eme,zg=new Nu,bHe=new Oi;function Cme(t,e){function r(M,I){M.matrixAutoUpdate===!0&&M.updateMatrix(),I.value.copy(M.matrix)}s(r,"refreshTransformUniform");function i(M,I){I.color.getRGB(M.fogColor.value,_B(t)),I.isFog?(M.fogNear.value=I.near,M.fogFar.value=I.far):I.isFogExp2&&(M.fogDensity.value=I.density)}s(i,"refreshFogUniforms");function n(M,I,P,C,T){I.isMeshBasicMaterial||I.isMeshLambertMaterial?a(M,I):I.isMeshToonMaterial?(a(M,I),m(M,I)):I.isMeshPhongMaterial?(a(M,I),p(M,I)):I.isMeshStandardMaterial?(a(M,I),y(M,I),I.isMeshPhysicalMaterial&&v(M,I,T)):I.isMeshMatcapMaterial?(a(M,I),w(M,I)):I.isMeshDepthMaterial?a(M,I):I.isMeshDistanceMaterial?(a(M,I),E(M,I)):I.isMeshNormalMaterial?a(M,I):I.isLineBasicMaterial?(o(M,I),I.isLineDashedMaterial&&l(M,I)):I.isPointsMaterial?u(M,I,P,C):I.isSpriteMaterial?c(M,I):I.isShadowMaterial?(M.color.value.copy(I.color),M.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}s(n,"refreshMaterialUniforms");function a(M,I){M.opacity.value=I.opacity,I.color&&M.diffuse.value.copy(I.color),I.emissive&&M.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(M.map.value=I.map,r(I.map,M.mapTransform)),I.alphaMap&&(M.alphaMap.value=I.alphaMap,r(I.alphaMap,M.alphaMapTransform)),I.bumpMap&&(M.bumpMap.value=I.bumpMap,r(I.bumpMap,M.bumpMapTransform),M.bumpScale.value=I.bumpScale,I.side===tu&&(M.bumpScale.value*=-1)),I.normalMap&&(M.normalMap.value=I.normalMap,r(I.normalMap,M.normalMapTransform),M.normalScale.value.copy(I.normalScale),I.side===tu&&M.normalScale.value.negate()),I.displacementMap&&(M.displacementMap.value=I.displacementMap,r(I.displacementMap,M.displacementMapTransform),M.displacementScale.value=I.displacementScale,M.displacementBias.value=I.displacementBias),I.emissiveMap&&(M.emissiveMap.value=I.emissiveMap,r(I.emissiveMap,M.emissiveMapTransform)),I.specularMap&&(M.specularMap.value=I.specularMap,r(I.specularMap,M.specularMapTransform)),I.alphaTest>0&&(M.alphaTest.value=I.alphaTest);let P=e.get(I),C=P.envMap,T=P.envMapRotation;C&&(M.envMap.value=C,zg.copy(T),zg.x*=-1,zg.y*=-1,zg.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(zg.y*=-1,zg.z*=-1),M.envMapRotation.value.setFromMatrix4(bHe.makeRotationFromEuler(zg)),M.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=I.reflectivity,M.ior.value=I.ior,M.refractionRatio.value=I.refractionRatio),I.lightMap&&(M.lightMap.value=I.lightMap,M.lightMapIntensity.value=I.lightMapIntensity,r(I.lightMap,M.lightMapTransform)),I.aoMap&&(M.aoMap.value=I.aoMap,M.aoMapIntensity.value=I.aoMapIntensity,r(I.aoMap,M.aoMapTransform))}s(a,"refreshUniformsCommon");function o(M,I){M.diffuse.value.copy(I.color),M.opacity.value=I.opacity,I.map&&(M.map.value=I.map,r(I.map,M.mapTransform))}s(o,"refreshUniformsLine");function l(M,I){M.dashSize.value=I.dashSize,M.totalSize.value=I.dashSize+I.gapSize,M.scale.value=I.scale}s(l,"refreshUniformsDash");function u(M,I,P,C){M.diffuse.value.copy(I.color),M.opacity.value=I.opacity,M.size.value=I.size*P,M.scale.value=C*.5,I.map&&(M.map.value=I.map,r(I.map,M.uvTransform)),I.alphaMap&&(M.alphaMap.value=I.alphaMap,r(I.alphaMap,M.alphaMapTransform)),I.alphaTest>0&&(M.alphaTest.value=I.alphaTest)}s(u,"refreshUniformsPoints");function c(M,I){M.diffuse.value.copy(I.color),M.opacity.value=I.opacity,M.rotation.value=I.rotation,I.map&&(M.map.value=I.map,r(I.map,M.mapTransform)),I.alphaMap&&(M.alphaMap.value=I.alphaMap,r(I.alphaMap,M.alphaMapTransform)),I.alphaTest>0&&(M.alphaTest.value=I.alphaTest)}s(c,"refreshUniformsSprites");function p(M,I){M.specular.value.copy(I.specular),M.shininess.value=Math.max(I.shininess,1e-4)}s(p,"refreshUniformsPhong");function m(M,I){I.gradientMap&&(M.gradientMap.value=I.gradientMap)}s(m,"refreshUniformsToon");function y(M,I){M.metalness.value=I.metalness,I.metalnessMap&&(M.metalnessMap.value=I.metalnessMap,r(I.metalnessMap,M.metalnessMapTransform)),M.roughness.value=I.roughness,I.roughnessMap&&(M.roughnessMap.value=I.roughnessMap,r(I.roughnessMap,M.roughnessMapTransform)),I.envMap&&(M.envMapIntensity.value=I.envMapIntensity)}s(y,"refreshUniformsStandard");function v(M,I,P){M.ior.value=I.ior,I.sheen>0&&(M.sheenColor.value.copy(I.sheenColor).multiplyScalar(I.sheen),M.sheenRoughness.value=I.sheenRoughness,I.sheenColorMap&&(M.sheenColorMap.value=I.sheenColorMap,r(I.sheenColorMap,M.sheenColorMapTransform)),I.sheenRoughnessMap&&(M.sheenRoughnessMap.value=I.sheenRoughnessMap,r(I.sheenRoughnessMap,M.sheenRoughnessMapTransform))),I.clearcoat>0&&(M.clearcoat.value=I.clearcoat,M.clearcoatRoughness.value=I.clearcoatRoughness,I.clearcoatMap&&(M.clearcoatMap.value=I.clearcoatMap,r(I.clearcoatMap,M.clearcoatMapTransform)),I.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap,r(I.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),I.clearcoatNormalMap&&(M.clearcoatNormalMap.value=I.clearcoatNormalMap,r(I.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),I.side===tu&&M.clearcoatNormalScale.value.negate())),I.dispersion>0&&(M.dispersion.value=I.dispersion),I.iridescence>0&&(M.iridescence.value=I.iridescence,M.iridescenceIOR.value=I.iridescenceIOR,M.iridescenceThicknessMinimum.value=I.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=I.iridescenceThicknessRange[1],I.iridescenceMap&&(M.iridescenceMap.value=I.iridescenceMap,r(I.iridescenceMap,M.iridescenceMapTransform)),I.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=I.iridescenceThicknessMap,r(I.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),I.transmission>0&&(M.transmission.value=I.transmission,M.transmissionSamplerMap.value=P.texture,M.transmissionSamplerSize.value.set(P.width,P.height),I.transmissionMap&&(M.transmissionMap.value=I.transmissionMap,r(I.transmissionMap,M.transmissionMapTransform)),M.thickness.value=I.thickness,I.thicknessMap&&(M.thicknessMap.value=I.thicknessMap,r(I.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=I.attenuationDistance,M.attenuationColor.value.copy(I.attenuationColor)),I.anisotropy>0&&(M.anisotropyVector.value.set(I.anisotropy*Math.cos(I.anisotropyRotation),I.anisotropy*Math.sin(I.anisotropyRotation)),I.anisotropyMap&&(M.anisotropyMap.value=I.anisotropyMap,r(I.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=I.specularIntensity,M.specularColor.value.copy(I.specularColor),I.specularColorMap&&(M.specularColorMap.value=I.specularColorMap,r(I.specularColorMap,M.specularColorMapTransform)),I.specularIntensityMap&&(M.specularIntensityMap.value=I.specularIntensityMap,r(I.specularIntensityMap,M.specularIntensityMapTransform))}s(v,"refreshUniformsPhysical");function w(M,I){I.matcap&&(M.matcap.value=I.matcap)}s(w,"refreshUniformsMatcap");function E(M,I){let P=e.get(I).light;M.referencePosition.value.setFromMatrixPosition(P.matrixWorld),M.nearDistance.value=P.shadow.camera.near,M.farDistance.value=P.shadow.camera.far}return s(E,"refreshUniformsDistance"),{refreshFogUniforms:i,refreshMaterialUniforms:n}}s(Cme,"WebGLMaterials");function Ime(t,e,r,i){let n={},a={},o=[],l=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function u(P,C){let T=C.program;i.uniformBlockBinding(P,T)}s(u,"bind");function c(P,C){let T=n[P.id];T===void 0&&(w(P),T=p(P),n[P.id]=T,P.addEventListener("dispose",M));let O=C.program;i.updateUBOMapping(P,O);let F=e.render.frame;a[P.id]!==F&&(y(P),a[P.id]=F)}s(c,"update");function p(P){let C=m();P.__bindingPointIndex=C;let T=t.createBuffer(),O=P.__size,F=P.usage;return t.bindBuffer(t.UNIFORM_BUFFER,T),t.bufferData(t.UNIFORM_BUFFER,O,F),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,C,T),T}s(p,"createBuffer");function m(){for(let P=0;P<l;P++)if(o.indexOf(P)===-1)return o.push(P),P;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}s(m,"allocateBindingPointIndex");function y(P){let C=n[P.id],T=P.uniforms,O=P.__cache;t.bindBuffer(t.UNIFORM_BUFFER,C);for(let F=0,k=T.length;F<k;F++){let B=Array.isArray(T[F])?T[F]:[T[F]];for(let U=0,z=B.length;U<z;U++){let q=B[U];if(v(q,F,U,O)===!0){let W=q.__offset,J=Array.isArray(q.value)?q.value:[q.value],V=0;for(let oe=0;oe<J.length;oe++){let Y=J[oe],he=E(Y);typeof Y=="number"||typeof Y=="boolean"?(q.__data[0]=Y,t.bufferSubData(t.UNIFORM_BUFFER,W+V,q.__data)):Y.isMatrix3?(q.__data[0]=Y.elements[0],q.__data[1]=Y.elements[1],q.__data[2]=Y.elements[2],q.__data[3]=0,q.__data[4]=Y.elements[3],q.__data[5]=Y.elements[4],q.__data[6]=Y.elements[5],q.__data[7]=0,q.__data[8]=Y.elements[6],q.__data[9]=Y.elements[7],q.__data[10]=Y.elements[8],q.__data[11]=0):(Y.toArray(q.__data,V),V+=he.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,W,q.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}s(y,"updateBufferData");function v(P,C,T,O){let F=P.value,k=C+"_"+T;if(O[k]===void 0)return typeof F=="number"||typeof F=="boolean"?O[k]=F:O[k]=F.clone(),!0;{let B=O[k];if(typeof F=="number"||typeof F=="boolean"){if(B!==F)return O[k]=F,!0}else if(B.equals(F)===!1)return B.copy(F),!0}return!1}s(v,"hasUniformChanged");function w(P){let C=P.uniforms,T=0,O=16;for(let k=0,B=C.length;k<B;k++){let U=Array.isArray(C[k])?C[k]:[C[k]];for(let z=0,q=U.length;z<q;z++){let W=U[z],J=Array.isArray(W.value)?W.value:[W.value];for(let V=0,oe=J.length;V<oe;V++){let Y=J[V],he=E(Y),Q=T%O,ae=Q%he.boundary,ee=Q+ae;T+=ae,ee!==0&&O-ee<he.storage&&(T+=O-ee),W.__data=new Float32Array(he.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=T,T+=he.storage}}}let F=T%O;return F>0&&(T+=O-F),P.__size=T,P.__cache={},this}s(w,"prepareUniformsGroup");function E(P){let C={boundary:0,storage:0};return typeof P=="number"||typeof P=="boolean"?(C.boundary=4,C.storage=4):P.isVector2?(C.boundary=8,C.storage=8):P.isVector3||P.isColor?(C.boundary=16,C.storage=12):P.isVector4?(C.boundary=16,C.storage=16):P.isMatrix3?(C.boundary=48,C.storage=48):P.isMatrix4?(C.boundary=64,C.storage=64):P.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",P),C}s(E,"getUniformSize");function M(P){let C=P.target;C.removeEventListener("dispose",M);let T=o.indexOf(C.__bindingPointIndex);o.splice(T,1),t.deleteBuffer(n[C.id]),delete n[C.id],delete a[C.id]}s(M,"onUniformsGroupsDispose");function I(){for(let P in n)t.deleteBuffer(n[P]);o=[],n={},a={}}return s(I,"dispose"),{bind:u,update:c,dispose:I}}s(Ime,"WebGLUniformsGroups");var Tme=class{constructor(e={}){let{canvas:r=sce(),context:i=null,depth:n=!0,stencil:a=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:c=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:m=!1,reverseDepthBuffer:y=!1}=e;this.isWebGLRenderer=!0;let v;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=i.getContextAttributes().alpha}else v=o;let w=new Uint32Array(4),E=new Int32Array(4),M=null,I=null,P=[],C=[];this.domElement=r,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=nl,this.toneMapping=qm,this.toneMappingExposure=1;let T=this,O=!1,F=0,k=0,B=null,U=-1,z=null,q=new Qn,W=new Qn,J=null,V=new si(0),oe=0,Y=r.width,he=r.height,Q=1,ae=null,ee=null,le=new Qn(0,0,Y,he),K=new Qn(0,0,Y,he),ce=!1,te=new OA,ne=!1,pe=!1;this.transmissionResolutionScale=1;let xe=new Oi,Te=new Oi,fe=new qe,Pe=new Qn,me={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},Ae=!1;function Ue(){return B===null?Q:1}s(Ue,"getTargetPixelRatio");let _e=i;function lt(Ie,Je){return r.getContext(Ie,Je)}s(lt,"getContext");try{let Ie={alpha:!0,depth:n,stencil:a,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:p,failIfMajorPerformanceCaveat:m};if("setAttribute"in r&&r.setAttribute("data-engine","three.js r".concat(lB)),r.addEventListener("webglcontextlost",se,!1),r.addEventListener("webglcontextrestored",ue,!1),r.addEventListener("webglcontextcreationerror",Se,!1),_e===null){let Je="webgl2";if(_e=lt(Je,Ie),_e===null)throw lt(Je)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ie){throw console.error("THREE.WebGLRenderer: "+Ie.message),Ie}let tt,We,at,Lt,dt,Me,ve,Ze,It,Rt,Et,pt,Yt,Kt,$t,jt,Nt,Fe,Xe,ht,rr,ar,Vr,Qe;function er(){tt=new Wde(_e),tt.init(),ar=new Sme(_e,tt),We=new Ude(_e,tt,e,ar),at=new wme(_e,tt),We.reverseDepthBuffer&&y&&at.buffers.depth.setReversed(!0),Lt=new Yde(_e),dt=new dme,Me=new Ame(_e,tt,at,dt,We,ar,Lt),ve=new jde(T),Ze=new qde(T),It=new Nde(_e),Vr=new Bde(_e,It),Rt=new Xde(_e,It,Lt,Vr),Et=new Jde(_e,Rt,It,Lt),Xe=new Kde(_e,We,Me),jt=new Vde(dt),pt=new pme(T,ve,Ze,tt,We,Vr,jt),Yt=new Cme(T,dt),Kt=new mme,$t=new xme(tt),Fe=new Fde(T,ve,Ze,at,Et,v,u),Nt=new bme(T,Et,We),Qe=new Ime(_e,Lt,We,at),ht=new zde(_e,tt,Lt),rr=new Zde(_e,tt,Lt),Lt.programs=pt.programs,T.capabilities=We,T.extensions=tt,T.properties=dt,T.renderLists=Kt,T.shadowMap=Nt,T.state=at,T.info=Lt}s(er,"initGLContext"),er();let Oe=new xHe(T,_e);this.xr=Oe,this.getContext=function(){return _e},this.getContextAttributes=function(){return _e.getContextAttributes()},this.forceContextLoss=function(){let Ie=tt.get("WEBGL_lose_context");Ie&&Ie.loseContext()},this.forceContextRestore=function(){let Ie=tt.get("WEBGL_lose_context");Ie&&Ie.restoreContext()},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(Ie){Ie!==void 0&&(Q=Ie,this.setSize(Y,he,!1))},this.getSize=function(Ie){return Ie.set(Y,he)},this.setSize=function(Ie,Je,wt=!0){if(Oe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=Ie,he=Je,r.width=Math.floor(Ie*Q),r.height=Math.floor(Je*Q),wt===!0&&(r.style.width=Ie+"px",r.style.height=Je+"px"),this.setViewport(0,0,Ie,Je)},this.getDrawingBufferSize=function(Ie){return Ie.set(Y*Q,he*Q).floor()},this.setDrawingBufferSize=function(Ie,Je,wt){Y=Ie,he=Je,Q=wt,r.width=Math.floor(Ie*wt),r.height=Math.floor(Je*wt),this.setViewport(0,0,Ie,Je)},this.getCurrentViewport=function(Ie){return Ie.copy(q)},this.getViewport=function(Ie){return Ie.copy(le)},this.setViewport=function(Ie,Je,wt,ft){Ie.isVector4?le.set(Ie.x,Ie.y,Ie.z,Ie.w):le.set(Ie,Je,wt,ft),at.viewport(q.copy(le).multiplyScalar(Q).round())},this.getScissor=function(Ie){return Ie.copy(K)},this.setScissor=function(Ie,Je,wt,ft){Ie.isVector4?K.set(Ie.x,Ie.y,Ie.z,Ie.w):K.set(Ie,Je,wt,ft),at.scissor(W.copy(K).multiplyScalar(Q).round())},this.getScissorTest=function(){return ce},this.setScissorTest=function(Ie){at.setScissorTest(ce=Ie)},this.setOpaqueSort=function(Ie){ae=Ie},this.setTransparentSort=function(Ie){ee=Ie},this.getClearColor=function(Ie){return Ie.copy(Fe.getClearColor())},this.setClearColor=function(){Fe.setClearColor.apply(Fe,arguments)},this.getClearAlpha=function(){return Fe.getClearAlpha()},this.setClearAlpha=function(){Fe.setClearAlpha.apply(Fe,arguments)},this.clear=function(Ie=!0,Je=!0,wt=!0){let ft=0;if(Ie){let rt=!1;if(B!==null){let zt=B.texture.format;rt=zt===mB||zt===fB||zt===OP}if(rt){let zt=B.texture.type,cr=zt===ed||zt===Jm||zt===Dw||zt===E_||zt===hB||zt===pB,ur=Fe.getClearColor(),Ar=Fe.getClearAlpha(),Fr=ur.r,Xr=ur.g,Zr=ur.b;cr?(w[0]=Fr,w[1]=Xr,w[2]=Zr,w[3]=Ar,_e.clearBufferuiv(_e.COLOR,0,w)):(E[0]=Fr,E[1]=Xr,E[2]=Zr,E[3]=Ar,_e.clearBufferiv(_e.COLOR,0,E))}else ft|=_e.COLOR_BUFFER_BIT}Je&&(ft|=_e.DEPTH_BUFFER_BIT),wt&&(ft|=_e.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),_e.clear(ft)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",se,!1),r.removeEventListener("webglcontextrestored",ue,!1),r.removeEventListener("webglcontextcreationerror",Se,!1),Fe.dispose(),Kt.dispose(),$t.dispose(),dt.dispose(),ve.dispose(),Ze.dispose(),Et.dispose(),Vr.dispose(),Qe.dispose(),pt.dispose(),Oe.dispose(),Oe.removeEventListener("sessionstart",Gt),Oe.removeEventListener("sessionend",ke),$e.stop()};function se(Ie){Ie.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}s(se,"onContextLost");function ue(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1;let Ie=Lt.autoReset,Je=Nt.enabled,wt=Nt.autoUpdate,ft=Nt.needsUpdate,rt=Nt.type;er(),Lt.autoReset=Ie,Nt.enabled=Je,Nt.autoUpdate=wt,Nt.needsUpdate=ft,Nt.type=rt}s(ue,"onContextRestore");function Se(Ie){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ie.statusMessage)}s(Se,"onContextCreationError");function ze(Ie){let Je=Ie.target;Je.removeEventListener("dispose",ze),Re(Je)}s(ze,"onMaterialDispose");function Re(Ie){yt(Ie),dt.remove(Ie)}s(Re,"deallocateMaterial");function yt(Ie){let Je=dt.get(Ie).programs;Je!==void 0&&(Je.forEach(function(wt){pt.releaseProgram(wt)}),Ie.isShaderMaterial&&pt.releaseShaderCache(Ie))}s(yt,"releaseMaterialProgramReferences"),this.renderBufferDirect=function(Ie,Je,wt,ft,rt,zt){Je===null&&(Je=me);let cr=rt.isMesh&&rt.matrixWorld.determinant()<0,ur=Cr(Ie,Je,wt,ft,rt);at.setMaterial(ft,cr);let Ar=wt.index,Fr=1;if(ft.wireframe===!0){if(Ar=Rt.getWireframeAttribute(wt),Ar===void 0)return;Fr=2}let Xr=wt.drawRange,Zr=wt.attributes.position,_i=Xr.start*Fr,Di=(Xr.start+Xr.count)*Fr;zt!==null&&(_i=Math.max(_i,zt.start*Fr),Di=Math.min(Di,(zt.start+zt.count)*Fr)),Ar!==null?(_i=Math.max(_i,0),Di=Math.min(Di,Ar.count)):Zr!=null&&(_i=Math.max(_i,0),Di=Math.min(Di,Zr.count));let jr=Di-_i;if(jr<0||jr===1/0)return;Vr.setup(rt,ft,ur,wt,Ar);let vi,wi=ht;if(Ar!==null&&(vi=It.get(Ar),wi=rr,wi.setIndex(vi)),rt.isMesh)ft.wireframe===!0?(at.setLineWidth(ft.wireframeLinewidth*Ue()),wi.setMode(_e.LINES)):wi.setMode(_e.TRIANGLES);else if(rt.isLine){let Yr=ft.linewidth;Yr===void 0&&(Yr=1),at.setLineWidth(Yr*Ue()),rt.isLineSegments?wi.setMode(_e.LINES):rt.isLineLoop?wi.setMode(_e.LINE_LOOP):wi.setMode(_e.LINE_STRIP)}else rt.isPoints?wi.setMode(_e.POINTS):rt.isSprite&&wi.setMode(_e.TRIANGLES);if(rt.isBatchedMesh)if(rt._multiDrawInstances!==null)wi.renderMultiDrawInstances(rt._multiDrawStarts,rt._multiDrawCounts,rt._multiDrawCount,rt._multiDrawInstances);else if(tt.get("WEBGL_multi_draw"))wi.renderMultiDraw(rt._multiDrawStarts,rt._multiDrawCounts,rt._multiDrawCount);else{let Yr=rt._multiDrawStarts,$r=rt._multiDrawCounts,li=rt._multiDrawCount,sa=Ar?It.get(Ar).bytesPerElement:1,ta=dt.get(ft).currentProgram.getUniforms();for(let Vi=0;Vi<li;Vi++)ta.setValue(_e,"_gl_DrawID",Vi),wi.render(Yr[Vi]/sa,$r[Vi])}else if(rt.isInstancedMesh)wi.renderInstances(_i,jr,rt.count);else if(wt.isInstancedBufferGeometry){let Yr=wt._maxInstanceCount!==void 0?wt._maxInstanceCount:1/0,$r=Math.min(wt.instanceCount,Yr);wi.renderInstances(_i,jr,$r)}else wi.render(_i,jr)};function st(Ie,Je,wt){Ie.transparent===!0&&Ie.side===Pu&&Ie.forceSinglePass===!1?(Ie.side=tu,Ie.needsUpdate=!0,Kr(Ie,Je,wt),Ie.side=Qp,Ie.needsUpdate=!0,Kr(Ie,Je,wt),Ie.side=Pu):Kr(Ie,Je,wt)}s(st,"prepareMaterial"),this.compile=function(Ie,Je,wt=null){wt===null&&(wt=Ie),I=$t.get(wt),I.init(Je),C.push(I),wt.traverseVisible(function(rt){rt.isLight&&rt.layers.test(Je.layers)&&(I.pushLight(rt),rt.castShadow&&I.pushShadow(rt))}),Ie!==wt&&Ie.traverseVisible(function(rt){rt.isLight&&rt.layers.test(Je.layers)&&(I.pushLight(rt),rt.castShadow&&I.pushShadow(rt))}),I.setupLights();let ft=new Set;return Ie.traverse(function(rt){if(!(rt.isMesh||rt.isPoints||rt.isLine||rt.isSprite))return;let zt=rt.material;if(zt)if(Array.isArray(zt))for(let cr=0;cr<zt.length;cr++){let ur=zt[cr];st(ur,wt,rt),ft.add(ur)}else st(zt,wt,rt),ft.add(zt)}),C.pop(),I=null,ft},this.compileAsync=function(Ie,Je,wt=null){let ft=this.compile(Ie,Je,wt);return new Promise(rt=>{function zt(){if(ft.forEach(function(cr){dt.get(cr).currentProgram.isReady()&&ft.delete(cr)}),ft.size===0){rt(Ie);return}setTimeout(zt,10)}s(zt,"checkMaterialsReady"),tt.get("KHR_parallel_shader_compile")!==null?zt():setTimeout(zt,10)})};let kt=null;function mt(Ie){kt&&kt(Ie)}s(mt,"onAnimationFrame");function Gt(){$e.stop()}s(Gt,"onXRSessionStart");function ke(){$e.start()}s(ke,"onXRSessionEnd");let $e=new RB;$e.setAnimationLoop(mt),typeof self<"u"&&$e.setContext(self),this.setAnimationLoop=function(Ie){kt=Ie,Oe.setAnimationLoop(Ie),Ie===null?$e.stop():$e.start()},Oe.addEventListener("sessionstart",Gt),Oe.addEventListener("sessionend",ke),this.render=function(Ie,Je){if(Je!==void 0&&Je.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(O===!0)return;if(Ie.matrixWorldAutoUpdate===!0&&Ie.updateMatrixWorld(),Je.parent===null&&Je.matrixWorldAutoUpdate===!0&&Je.updateMatrixWorld(),Oe.enabled===!0&&Oe.isPresenting===!0&&(Oe.cameraAutoUpdate===!0&&Oe.updateCamera(Je),Je=Oe.getCamera()),Ie.isScene===!0&&Ie.onBeforeRender(T,Ie,Je,B),I=$t.get(Ie,C.length),I.init(Je),C.push(I),Te.multiplyMatrices(Je.projectionMatrix,Je.matrixWorldInverse),te.setFromProjectionMatrix(Te),pe=this.localClippingEnabled,ne=jt.init(this.clippingPlanes,pe),M=Kt.get(Ie,P.length),M.init(),P.push(M),Oe.enabled===!0&&Oe.isPresenting===!0){let zt=T.xr.getDepthSensingMesh();zt!==null&&ot(zt,Je,-1/0,T.sortObjects)}ot(Ie,Je,0,T.sortObjects),M.finish(),T.sortObjects===!0&&M.sort(ae,ee),Ae=Oe.enabled===!1||Oe.isPresenting===!1||Oe.hasDepthSensing()===!1,Ae&&Fe.addToRenderList(M,Ie),this.info.render.frame++,ne===!0&&jt.beginShadows();let wt=I.state.shadowsArray;Nt.render(wt,Ie,Je),ne===!0&&jt.endShadows(),this.info.autoReset===!0&&this.info.reset();let ft=M.opaque,rt=M.transmissive;if(I.setupLights(),Je.isArrayCamera){let zt=Je.cameras;if(rt.length>0)for(let cr=0,ur=zt.length;cr<ur;cr++){let Ar=zt[cr];Ht(ft,rt,Ie,Ar)}Ae&&Fe.render(Ie);for(let cr=0,ur=zt.length;cr<ur;cr++){let Ar=zt[cr];Ft(M,Ie,Ar,Ar.viewport)}}else rt.length>0&&Ht(ft,rt,Ie,Je),Ae&&Fe.render(Ie),Ft(M,Ie,Je);B!==null&&k===0&&(Me.updateMultisampleRenderTarget(B),Me.updateRenderTargetMipmap(B)),Ie.isScene===!0&&Ie.onAfterRender(T,Ie,Je),Vr.resetDefaultState(),U=-1,z=null,C.pop(),C.length>0?(I=C[C.length-1],ne===!0&&jt.setGlobalState(T.clippingPlanes,I.state.camera)):I=null,P.pop(),P.length>0?M=P[P.length-1]:M=null};function ot(Ie,Je,wt,ft){if(Ie.visible===!1)return;if(Ie.layers.test(Je.layers)){if(Ie.isGroup)wt=Ie.renderOrder;else if(Ie.isLOD)Ie.autoUpdate===!0&&Ie.update(Je);else if(Ie.isLight)I.pushLight(Ie),Ie.castShadow&&I.pushShadow(Ie);else if(Ie.isSprite){if(!Ie.frustumCulled||te.intersectsSprite(Ie)){ft&&Pe.setFromMatrixPosition(Ie.matrixWorld).applyMatrix4(Te);let zt=Et.update(Ie),cr=Ie.material;cr.visible&&M.push(Ie,zt,cr,wt,Pe.z,null)}}else if((Ie.isMesh||Ie.isLine||Ie.isPoints)&&(!Ie.frustumCulled||te.intersectsObject(Ie))){let zt=Et.update(Ie),cr=Ie.material;if(ft&&(Ie.boundingSphere!==void 0?(Ie.boundingSphere===null&&Ie.computeBoundingSphere(),Pe.copy(Ie.boundingSphere.center)):(zt.boundingSphere===null&&zt.computeBoundingSphere(),Pe.copy(zt.boundingSphere.center)),Pe.applyMatrix4(Ie.matrixWorld).applyMatrix4(Te)),Array.isArray(cr)){let ur=zt.groups;for(let Ar=0,Fr=ur.length;Ar<Fr;Ar++){let Xr=ur[Ar],Zr=cr[Xr.materialIndex];Zr&&Zr.visible&&M.push(Ie,zt,Zr,wt,Pe.z,Xr)}}else cr.visible&&M.push(Ie,zt,cr,wt,Pe.z,null)}}let rt=Ie.children;for(let zt=0,cr=rt.length;zt<cr;zt++)ot(rt[zt],Je,wt,ft)}s(ot,"projectObject");function Ft(Ie,Je,wt,ft){let rt=Ie.opaque,zt=Ie.transmissive,cr=Ie.transparent;I.setupLightsView(wt),ne===!0&&jt.setGlobalState(T.clippingPlanes,wt),ft&&at.viewport(q.copy(ft)),rt.length>0&&fr(rt,Je,wt),zt.length>0&&fr(zt,Je,wt),cr.length>0&&fr(cr,Je,wt),at.buffers.depth.setTest(!0),at.buffers.depth.setMask(!0),at.buffers.color.setMask(!0),at.setPolygonOffset(!1)}s(Ft,"renderScene");function Ht(Ie,Je,wt,ft){if((wt.isScene===!0?wt.overrideMaterial:null)!==null)return;I.state.transmissionRenderTarget[ft.id]===void 0&&(I.state.transmissionRenderTarget[ft.id]=new Qm(1,1,{generateMipmaps:!0,type:tt.has("EXT_color_buffer_half_float")||tt.has("EXT_color_buffer_float")?LA:ed,minFilter:Ey,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Rn.workingColorSpace}));let rt=I.state.transmissionRenderTarget[ft.id],zt=ft.viewport||q;rt.setSize(zt.z*T.transmissionResolutionScale,zt.w*T.transmissionResolutionScale);let cr=T.getRenderTarget();T.setRenderTarget(rt),T.getClearColor(V),oe=T.getClearAlpha(),oe<1&&T.setClearColor(16777215,.5),T.clear(),Ae&&Fe.render(wt);let ur=T.toneMapping;T.toneMapping=qm;let Ar=ft.viewport;if(ft.viewport!==void 0&&(ft.viewport=void 0),I.setupLightsView(ft),ne===!0&&jt.setGlobalState(T.clippingPlanes,ft),fr(Ie,wt,ft),Me.updateMultisampleRenderTarget(rt),Me.updateRenderTargetMipmap(rt),tt.has("WEBGL_multisampled_render_to_texture")===!1){let Fr=!1;for(let Xr=0,Zr=Je.length;Xr<Zr;Xr++){let _i=Je[Xr],Di=_i.object,jr=_i.geometry,vi=_i.material,wi=_i.group;if(vi.side===Pu&&Di.layers.test(ft.layers)){let Yr=vi.side;vi.side=tu,vi.needsUpdate=!0,nr(Di,wt,ft,jr,vi,wi),vi.side=Yr,vi.needsUpdate=!0,Fr=!0}}Fr===!0&&(Me.updateMultisampleRenderTarget(rt),Me.updateRenderTargetMipmap(rt))}T.setRenderTarget(cr),T.setClearColor(V,oe),Ar!==void 0&&(ft.viewport=Ar),T.toneMapping=ur}s(Ht,"renderTransmissionPass");function fr(Ie,Je,wt){let ft=Je.isScene===!0?Je.overrideMaterial:null;for(let rt=0,zt=Ie.length;rt<zt;rt++){let cr=Ie[rt],ur=cr.object,Ar=cr.geometry,Fr=ft===null?cr.material:ft,Xr=cr.group;ur.layers.test(wt.layers)&&nr(ur,Je,wt,Ar,Fr,Xr)}}s(fr,"renderObjects");function nr(Ie,Je,wt,ft,rt,zt){Ie.onBeforeRender(T,Je,wt,ft,rt,zt),Ie.modelViewMatrix.multiplyMatrices(wt.matrixWorldInverse,Ie.matrixWorld),Ie.normalMatrix.getNormalMatrix(Ie.modelViewMatrix),rt.onBeforeRender(T,Je,wt,ft,Ie,zt),rt.transparent===!0&&rt.side===Pu&&rt.forceSinglePass===!1?(rt.side=tu,rt.needsUpdate=!0,T.renderBufferDirect(wt,Je,ft,rt,Ie,zt),rt.side=Qp,rt.needsUpdate=!0,T.renderBufferDirect(wt,Je,ft,rt,Ie,zt),rt.side=Pu):T.renderBufferDirect(wt,Je,ft,rt,Ie,zt),Ie.onAfterRender(T,Je,wt,ft,rt,zt)}s(nr,"renderObject");function Kr(Ie,Je,wt){Je.isScene!==!0&&(Je=me);let ft=dt.get(Ie),rt=I.state.lights,zt=I.state.shadowsArray,cr=rt.state.version,ur=pt.getParameters(Ie,rt.state,zt,Je,wt),Ar=pt.getProgramCacheKey(ur),Fr=ft.programs;ft.environment=Ie.isMeshStandardMaterial?Je.environment:null,ft.fog=Je.fog,ft.envMap=(Ie.isMeshStandardMaterial?Ze:ve).get(Ie.envMap||ft.environment),ft.envMapRotation=ft.environment!==null&&Ie.envMap===null?Je.environmentRotation:Ie.envMapRotation,Fr===void 0&&(Ie.addEventListener("dispose",ze),Fr=new Map,ft.programs=Fr);let Xr=Fr.get(Ar);if(Xr!==void 0){if(ft.currentProgram===Xr&&ft.lightsStateVersion===cr)return Jr(Ie,ur),Xr}else ur.uniforms=pt.getUniforms(Ie),Ie.onBeforeCompile(ur,T),Xr=pt.acquireProgram(ur,Ar),Fr.set(Ar,Xr),ft.uniforms=ur.uniforms;let Zr=ft.uniforms;return(!Ie.isShaderMaterial&&!Ie.isRawShaderMaterial||Ie.clipping===!0)&&(Zr.clippingPlanes=jt.uniform),Jr(Ie,ur),ft.needsLights=Hr(Ie),ft.lightsStateVersion=cr,ft.needsLights&&(Zr.ambientLightColor.value=rt.state.ambient,Zr.lightProbe.value=rt.state.probe,Zr.directionalLights.value=rt.state.directional,Zr.directionalLightShadows.value=rt.state.directionalShadow,Zr.spotLights.value=rt.state.spot,Zr.spotLightShadows.value=rt.state.spotShadow,Zr.rectAreaLights.value=rt.state.rectArea,Zr.ltc_1.value=rt.state.rectAreaLTC1,Zr.ltc_2.value=rt.state.rectAreaLTC2,Zr.pointLights.value=rt.state.point,Zr.pointLightShadows.value=rt.state.pointShadow,Zr.hemisphereLights.value=rt.state.hemi,Zr.directionalShadowMap.value=rt.state.directionalShadowMap,Zr.directionalShadowMatrix.value=rt.state.directionalShadowMatrix,Zr.spotShadowMap.value=rt.state.spotShadowMap,Zr.spotLightMatrix.value=rt.state.spotLightMatrix,Zr.spotLightMap.value=rt.state.spotLightMap,Zr.pointShadowMap.value=rt.state.pointShadowMap,Zr.pointShadowMatrix.value=rt.state.pointShadowMatrix),ft.currentProgram=Xr,ft.uniformsList=null,Xr}s(Kr,"getProgram");function ai(Ie){if(Ie.uniformsList===null){let Je=Ie.currentProgram.getUniforms();Ie.uniformsList=sC.seqWithValue(Je.seq,Ie.uniforms)}return Ie.uniformsList}s(ai,"getUniformList");function Jr(Ie,Je){let wt=dt.get(Ie);wt.outputColorSpace=Je.outputColorSpace,wt.batching=Je.batching,wt.batchingColor=Je.batchingColor,wt.instancing=Je.instancing,wt.instancingColor=Je.instancingColor,wt.instancingMorph=Je.instancingMorph,wt.skinning=Je.skinning,wt.morphTargets=Je.morphTargets,wt.morphNormals=Je.morphNormals,wt.morphColors=Je.morphColors,wt.morphTargetsCount=Je.morphTargetsCount,wt.numClippingPlanes=Je.numClippingPlanes,wt.numIntersection=Je.numClipIntersection,wt.vertexAlphas=Je.vertexAlphas,wt.vertexTangents=Je.vertexTangents,wt.toneMapping=Je.toneMapping}s(Jr,"updateCommonMaterialProperties");function Cr(Ie,Je,wt,ft,rt){Je.isScene!==!0&&(Je=me),Me.resetTextureUnits();let zt=Je.fog,cr=ft.isMeshStandardMaterial?Je.environment:null,ur=B===null?T.outputColorSpace:B.isXRRenderTarget===!0?B.texture.colorSpace:Wy,Ar=(ft.isMeshStandardMaterial?Ze:ve).get(ft.envMap||cr),Fr=ft.vertexColors===!0&&!!wt.attributes.color&&wt.attributes.color.itemSize===4,Xr=!!wt.attributes.tangent&&(!!ft.normalMap||ft.anisotropy>0),Zr=!!wt.morphAttributes.position,_i=!!wt.morphAttributes.normal,Di=!!wt.morphAttributes.color,jr=qm;ft.toneMapped&&(B===null||B.isXRRenderTarget===!0)&&(jr=T.toneMapping);let vi=wt.morphAttributes.position||wt.morphAttributes.normal||wt.morphAttributes.color,wi=vi!==void 0?vi.length:0,Yr=dt.get(ft),$r=I.state.lights;if(ne===!0&&(pe===!0||Ie!==z)){let Z=Ie===z&&ft.id===U;jt.setState(ft,Ie,Z)}let li=!1;ft.version===Yr.__version?(Yr.needsLights&&Yr.lightsStateVersion!==$r.state.version||Yr.outputColorSpace!==ur||rt.isBatchedMesh&&Yr.batching===!1||!rt.isBatchedMesh&&Yr.batching===!0||rt.isBatchedMesh&&Yr.batchingColor===!0&&rt.colorTexture===null||rt.isBatchedMesh&&Yr.batchingColor===!1&&rt.colorTexture!==null||rt.isInstancedMesh&&Yr.instancing===!1||!rt.isInstancedMesh&&Yr.instancing===!0||rt.isSkinnedMesh&&Yr.skinning===!1||!rt.isSkinnedMesh&&Yr.skinning===!0||rt.isInstancedMesh&&Yr.instancingColor===!0&&rt.instanceColor===null||rt.isInstancedMesh&&Yr.instancingColor===!1&&rt.instanceColor!==null||rt.isInstancedMesh&&Yr.instancingMorph===!0&&rt.morphTexture===null||rt.isInstancedMesh&&Yr.instancingMorph===!1&&rt.morphTexture!==null||Yr.envMap!==Ar||ft.fog===!0&&Yr.fog!==zt||Yr.numClippingPlanes!==void 0&&(Yr.numClippingPlanes!==jt.numPlanes||Yr.numIntersection!==jt.numIntersection)||Yr.vertexAlphas!==Fr||Yr.vertexTangents!==Xr||Yr.morphTargets!==Zr||Yr.morphNormals!==_i||Yr.morphColors!==Di||Yr.toneMapping!==jr||Yr.morphTargetsCount!==wi)&&(li=!0):(li=!0,Yr.__version=ft.version);let sa=Yr.currentProgram;li===!0&&(sa=Kr(ft,Je,rt));let ta=!1,Vi=!1,qr=!1,S=sa.getUniforms(),R=Yr.uniforms;if(at.useProgram(sa.program)&&(ta=!0,Vi=!0,qr=!0),ft.id!==U&&(U=ft.id,Vi=!0),ta||z!==Ie){at.buffers.depth.getReversed()?(xe.copy(Ie.projectionMatrix),uce(xe),cce(xe),S.setValue(_e,"projectionMatrix",xe)):S.setValue(_e,"projectionMatrix",Ie.projectionMatrix),S.setValue(_e,"viewMatrix",Ie.matrixWorldInverse);let Z=S.map.cameraPosition;Z!==void 0&&Z.setValue(_e,fe.setFromMatrixPosition(Ie.matrixWorld)),We.logarithmicDepthBuffer&&S.setValue(_e,"logDepthBufFC",2/(Math.log(Ie.far+1)/Math.LN2)),(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial)&&S.setValue(_e,"isOrthographic",Ie.isOrthographicCamera===!0),z!==Ie&&(z=Ie,Vi=!0,qr=!0)}if(rt.isSkinnedMesh){S.setOptional(_e,rt,"bindMatrix"),S.setOptional(_e,rt,"bindMatrixInverse");let Z=rt.skeleton;Z&&(Z.boneTexture===null&&Z.computeBoneTexture(),S.setValue(_e,"boneTexture",Z.boneTexture,Me))}rt.isBatchedMesh&&(S.setOptional(_e,rt,"batchingTexture"),S.setValue(_e,"batchingTexture",rt._matricesTexture,Me),S.setOptional(_e,rt,"batchingIdTexture"),S.setValue(_e,"batchingIdTexture",rt._indirectTexture,Me),S.setOptional(_e,rt,"batchingColorTexture"),rt._colorsTexture!==null&&S.setValue(_e,"batchingColorTexture",rt._colorsTexture,Me));let j=wt.morphAttributes;if((j.position!==void 0||j.normal!==void 0||j.color!==void 0)&&Xe.update(rt,wt,sa),(Vi||Yr.receiveShadow!==rt.receiveShadow)&&(Yr.receiveShadow=rt.receiveShadow,S.setValue(_e,"receiveShadow",rt.receiveShadow)),ft.isMeshGouraudMaterial&&ft.envMap!==null&&(R.envMap.value=Ar,R.flipEnvMap.value=Ar.isCubeTexture&&Ar.isRenderTargetTexture===!1?-1:1),ft.isMeshStandardMaterial&&ft.envMap===null&&Je.environment!==null&&(R.envMapIntensity.value=Je.environmentIntensity),Vi&&(S.setValue(_e,"toneMappingExposure",T.toneMappingExposure),Yr.needsLights&&Ei(R,qr),zt&&ft.fog===!0&&Yt.refreshFogUniforms(R,zt),Yt.refreshMaterialUniforms(R,ft,Q,he,I.state.transmissionRenderTarget[Ie.id]),sC.upload(_e,ai(Yr),R,Me)),ft.isShaderMaterial&&ft.uniformsNeedUpdate===!0&&(sC.upload(_e,ai(Yr),R,Me),ft.uniformsNeedUpdate=!1),ft.isSpriteMaterial&&S.setValue(_e,"center",rt.center),S.setValue(_e,"modelViewMatrix",rt.modelViewMatrix),S.setValue(_e,"normalMatrix",rt.normalMatrix),S.setValue(_e,"modelMatrix",rt.matrixWorld),ft.isShaderMaterial||ft.isRawShaderMaterial){let Z=ft.uniformsGroups;for(let ie=0,we=Z.length;ie<we;ie++){let Ce=Z[ie];Qe.update(Ce,sa),Qe.bind(Ce,sa)}}return sa}s(Cr,"setProgram");function Ei(Ie,Je){Ie.ambientLightColor.needsUpdate=Je,Ie.lightProbe.needsUpdate=Je,Ie.directionalLights.needsUpdate=Je,Ie.directionalLightShadows.needsUpdate=Je,Ie.pointLights.needsUpdate=Je,Ie.pointLightShadows.needsUpdate=Je,Ie.spotLights.needsUpdate=Je,Ie.spotLightShadows.needsUpdate=Je,Ie.rectAreaLights.needsUpdate=Je,Ie.hemisphereLights.needsUpdate=Je}s(Ei,"markUniformsLightsNeedsUpdate");function Hr(Ie){return Ie.isMeshLambertMaterial||Ie.isMeshToonMaterial||Ie.isMeshPhongMaterial||Ie.isMeshStandardMaterial||Ie.isShadowMaterial||Ie.isShaderMaterial&&Ie.lights===!0}s(Hr,"materialNeedsLights"),this.getActiveCubeFace=function(){return F},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(Ie,Je,wt){dt.get(Ie.texture).__webglTexture=Je,dt.get(Ie.depthTexture).__webglTexture=wt;let ft=dt.get(Ie);ft.__hasExternalTextures=!0,ft.__autoAllocateDepthBuffer=wt===void 0,ft.__autoAllocateDepthBuffer||tt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ft.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Ie,Je){let wt=dt.get(Ie);wt.__webglFramebuffer=Je,wt.__useDefaultFramebuffer=Je===void 0};let en=_e.createFramebuffer();this.setRenderTarget=function(Ie,Je=0,wt=0){B=Ie,F=Je,k=wt;let ft=!0,rt=null,zt=!1,cr=!1;if(Ie){let ur=dt.get(Ie);if(ur.__useDefaultFramebuffer!==void 0)at.bindFramebuffer(_e.FRAMEBUFFER,null),ft=!1;else if(ur.__webglFramebuffer===void 0)Me.setupRenderTarget(Ie);else if(ur.__hasExternalTextures)Me.rebindTextures(Ie,dt.get(Ie.texture).__webglTexture,dt.get(Ie.depthTexture).__webglTexture);else if(Ie.depthBuffer){let Xr=Ie.depthTexture;if(ur.__boundDepthTexture!==Xr){if(Xr!==null&&dt.has(Xr)&&(Ie.width!==Xr.image.width||Ie.height!==Xr.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Me.setupDepthRenderbuffer(Ie)}}let Ar=Ie.texture;(Ar.isData3DTexture||Ar.isDataArrayTexture||Ar.isCompressedArrayTexture)&&(cr=!0);let Fr=dt.get(Ie).__webglFramebuffer;Ie.isWebGLCubeRenderTarget?(Array.isArray(Fr[Je])?rt=Fr[Je][wt]:rt=Fr[Je],zt=!0):Ie.samples>0&&Me.useMultisampledRTT(Ie)===!1?rt=dt.get(Ie).__webglMultisampledFramebuffer:Array.isArray(Fr)?rt=Fr[wt]:rt=Fr,q.copy(Ie.viewport),W.copy(Ie.scissor),J=Ie.scissorTest}else q.copy(le).multiplyScalar(Q).floor(),W.copy(K).multiplyScalar(Q).floor(),J=ce;if(wt!==0&&(rt=en),at.bindFramebuffer(_e.FRAMEBUFFER,rt)&&ft&&at.drawBuffers(Ie,rt),at.viewport(q),at.scissor(W),at.setScissorTest(J),zt){let ur=dt.get(Ie.texture);_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_CUBE_MAP_POSITIVE_X+Je,ur.__webglTexture,wt)}else if(cr){let ur=dt.get(Ie.texture),Ar=Je;_e.framebufferTextureLayer(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,ur.__webglTexture,wt,Ar)}else if(Ie!==null&&wt!==0){let ur=dt.get(Ie.texture);_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,ur.__webglTexture,wt)}U=-1},this.readRenderTargetPixels=function(Ie,Je,wt,ft,rt,zt,cr){if(!(Ie&&Ie.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ur=dt.get(Ie).__webglFramebuffer;if(Ie.isWebGLCubeRenderTarget&&cr!==void 0&&(ur=ur[cr]),ur){at.bindFramebuffer(_e.FRAMEBUFFER,ur);try{let Ar=Ie.texture,Fr=Ar.format,Xr=Ar.type;if(!We.textureFormatReadable(Fr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!We.textureTypeReadable(Xr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Je>=0&&Je<=Ie.width-ft&&wt>=0&&wt<=Ie.height-rt&&_e.readPixels(Je,wt,ft,rt,ar.convert(Fr),ar.convert(Xr),zt)}finally{let Ar=B!==null?dt.get(B).__webglFramebuffer:null;at.bindFramebuffer(_e.FRAMEBUFFER,Ar)}}},this.readRenderTargetPixelsAsync=async function(Ie,Je,wt,ft,rt,zt,cr){if(!(Ie&&Ie.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ur=dt.get(Ie).__webglFramebuffer;if(Ie.isWebGLCubeRenderTarget&&cr!==void 0&&(ur=ur[cr]),ur){let Ar=Ie.texture,Fr=Ar.format,Xr=Ar.type;if(!We.textureFormatReadable(Fr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!We.textureTypeReadable(Xr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Je>=0&&Je<=Ie.width-ft&&wt>=0&&wt<=Ie.height-rt){at.bindFramebuffer(_e.FRAMEBUFFER,ur);let Zr=_e.createBuffer();_e.bindBuffer(_e.PIXEL_PACK_BUFFER,Zr),_e.bufferData(_e.PIXEL_PACK_BUFFER,zt.byteLength,_e.STREAM_READ),_e.readPixels(Je,wt,ft,rt,ar.convert(Fr),ar.convert(Xr),0);let _i=B!==null?dt.get(B).__webglFramebuffer:null;at.bindFramebuffer(_e.FRAMEBUFFER,_i);let Di=_e.fenceSync(_e.SYNC_GPU_COMMANDS_COMPLETE,0);return _e.flush(),await lce(_e,Di,4),_e.bindBuffer(_e.PIXEL_PACK_BUFFER,Zr),_e.getBufferSubData(_e.PIXEL_PACK_BUFFER,0,zt),_e.deleteBuffer(Zr),_e.deleteSync(Di),zt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(Ie,Je=null,wt=0){Ie.isTexture!==!0&&(fy("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Je=arguments[0]||null,Ie=arguments[1]);let ft=Math.pow(2,-wt),rt=Math.floor(Ie.image.width*ft),zt=Math.floor(Ie.image.height*ft),cr=Je!==null?Je.x:0,ur=Je!==null?Je.y:0;Me.setTexture2D(Ie,0),_e.copyTexSubImage2D(_e.TEXTURE_2D,wt,0,0,cr,ur,rt,zt),at.unbindTexture()};let Hi=_e.createFramebuffer(),En=_e.createFramebuffer();this.copyTextureToTexture=function(Ie,Je,wt=null,ft=null,rt=0,zt=null){Ie.isTexture!==!0&&(fy("WebGLRenderer: copyTextureToTexture function signature has changed."),ft=arguments[0]||null,Ie=arguments[1],Je=arguments[2],zt=arguments[3]||0,wt=null),zt===null&&(rt!==0?(fy("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),zt=rt,rt=0):zt=0);let cr,ur,Ar,Fr,Xr,Zr,_i,Di,jr,vi=Ie.isCompressedTexture?Ie.mipmaps[zt]:Ie.image;if(wt!==null)cr=wt.max.x-wt.min.x,ur=wt.max.y-wt.min.y,Ar=wt.isBox3?wt.max.z-wt.min.z:1,Fr=wt.min.x,Xr=wt.min.y,Zr=wt.isBox3?wt.min.z:0;else{let j=Math.pow(2,-rt);cr=Math.floor(vi.width*j),ur=Math.floor(vi.height*j),Ie.isDataArrayTexture?Ar=vi.depth:Ie.isData3DTexture?Ar=Math.floor(vi.depth*j):Ar=1,Fr=0,Xr=0,Zr=0}ft!==null?(_i=ft.x,Di=ft.y,jr=ft.z):(_i=0,Di=0,jr=0);let wi=ar.convert(Je.format),Yr=ar.convert(Je.type),$r;Je.isData3DTexture?(Me.setTexture3D(Je,0),$r=_e.TEXTURE_3D):Je.isDataArrayTexture||Je.isCompressedArrayTexture?(Me.setTexture2DArray(Je,0),$r=_e.TEXTURE_2D_ARRAY):(Me.setTexture2D(Je,0),$r=_e.TEXTURE_2D),_e.pixelStorei(_e.UNPACK_FLIP_Y_WEBGL,Je.flipY),_e.pixelStorei(_e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Je.premultiplyAlpha),_e.pixelStorei(_e.UNPACK_ALIGNMENT,Je.unpackAlignment);let li=_e.getParameter(_e.UNPACK_ROW_LENGTH),sa=_e.getParameter(_e.UNPACK_IMAGE_HEIGHT),ta=_e.getParameter(_e.UNPACK_SKIP_PIXELS),Vi=_e.getParameter(_e.UNPACK_SKIP_ROWS),qr=_e.getParameter(_e.UNPACK_SKIP_IMAGES);_e.pixelStorei(_e.UNPACK_ROW_LENGTH,vi.width),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,vi.height),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,Fr),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,Xr),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,Zr);let S=Ie.isDataArrayTexture||Ie.isData3DTexture,R=Je.isDataArrayTexture||Je.isData3DTexture;if(Ie.isDepthTexture){let j=dt.get(Ie),Z=dt.get(Je),ie=dt.get(j.__renderTarget),we=dt.get(Z.__renderTarget);at.bindFramebuffer(_e.READ_FRAMEBUFFER,ie.__webglFramebuffer),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,we.__webglFramebuffer);for(let Ce=0;Ce<Ar;Ce++)S&&(_e.framebufferTextureLayer(_e.READ_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,dt.get(Ie).__webglTexture,rt,Zr+Ce),_e.framebufferTextureLayer(_e.DRAW_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,dt.get(Je).__webglTexture,zt,jr+Ce)),_e.blitFramebuffer(Fr,Xr,cr,ur,_i,Di,cr,ur,_e.DEPTH_BUFFER_BIT,_e.NEAREST);at.bindFramebuffer(_e.READ_FRAMEBUFFER,null),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,null)}else if(rt!==0||Ie.isRenderTargetTexture||dt.has(Ie)){let j=dt.get(Ie),Z=dt.get(Je);at.bindFramebuffer(_e.READ_FRAMEBUFFER,Hi),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,En);for(let ie=0;ie<Ar;ie++)S?_e.framebufferTextureLayer(_e.READ_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,j.__webglTexture,rt,Zr+ie):_e.framebufferTexture2D(_e.READ_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,j.__webglTexture,rt),R?_e.framebufferTextureLayer(_e.DRAW_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,Z.__webglTexture,zt,jr+ie):_e.framebufferTexture2D(_e.DRAW_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,Z.__webglTexture,zt),rt!==0?_e.blitFramebuffer(Fr,Xr,cr,ur,_i,Di,cr,ur,_e.COLOR_BUFFER_BIT,_e.NEAREST):R?_e.copyTexSubImage3D($r,zt,_i,Di,jr+ie,Fr,Xr,cr,ur):_e.copyTexSubImage2D($r,zt,_i,Di,Fr,Xr,cr,ur);at.bindFramebuffer(_e.READ_FRAMEBUFFER,null),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,null)}else R?Ie.isDataTexture||Ie.isData3DTexture?_e.texSubImage3D($r,zt,_i,Di,jr,cr,ur,Ar,wi,Yr,vi.data):Je.isCompressedArrayTexture?_e.compressedTexSubImage3D($r,zt,_i,Di,jr,cr,ur,Ar,wi,vi.data):_e.texSubImage3D($r,zt,_i,Di,jr,cr,ur,Ar,wi,Yr,vi):Ie.isDataTexture?_e.texSubImage2D(_e.TEXTURE_2D,zt,_i,Di,cr,ur,wi,Yr,vi.data):Ie.isCompressedTexture?_e.compressedTexSubImage2D(_e.TEXTURE_2D,zt,_i,Di,vi.width,vi.height,wi,vi.data):_e.texSubImage2D(_e.TEXTURE_2D,zt,_i,Di,cr,ur,wi,Yr,vi);_e.pixelStorei(_e.UNPACK_ROW_LENGTH,li),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,sa),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,ta),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,Vi),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,qr),zt===0&&Je.generateMipmaps&&_e.generateMipmap($r),at.unbindTexture()},this.copyTextureToTexture3D=function(Ie,Je,wt=null,ft=null,rt=0){return Ie.isTexture!==!0&&(fy("WebGLRenderer: copyTextureToTexture3D function signature has changed."),wt=arguments[0]||null,ft=arguments[1]||null,Ie=arguments[2],Je=arguments[3],rt=arguments[4]||0),fy('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Ie,Je,wt,ft,rt)},this.initRenderTarget=function(Ie){dt.get(Ie).__webglFramebuffer===void 0&&Me.setupRenderTarget(Ie)},this.initTexture=function(Ie){Ie.isCubeTexture?Me.setTextureCube(Ie,0):Ie.isData3DTexture?Me.setTexture3D(Ie,0):Ie.isDataArrayTexture||Ie.isCompressedArrayTexture?Me.setTexture2DArray(Ie,0):Me.setTexture2D(Ie,0),at.unbindTexture()},this.resetState=function(){F=0,k=0,B=null,at.reset(),Vr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return sf}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let r=this.getContext();r.drawingBufferColorspace=Rn._getDrawingBufferColorSpace(e),r.unpackColorSpace=Rn._getUnpackColorSpace()}};s(Tme,"WebGLRenderer");var wHe=Tme;N();function Pme(t,e,r=!1){let i=null,n=0;return function(...a){n++,n===1&&r===!0&&t(...a);let o=s(()=>{(!r||n>1)&&t(...a),i=null,n=0},"later");clearTimeout(i),i=setTimeout(o,e)}}s(Pme,"debounce");N();N();var Lme="[MappedinJS]",Dme=(t=>(t[t.LOG=0]="LOG",t[t.WARN=1]="WARN",t[t.ERROR=2]="ERROR",t[t.SILENT=3]="SILENT",t))(Dme||{});function Rme(t=""){let e="".concat(Lme).concat(t?"-".concat(t):"");return{logState:$a.env.NODE_ENV==="test"?3:0,log(...r){this.logState<=0&&console.log(e,...r)},warn(...r){this.logState<=1&&console.warn(e,...r)},error(...r){this.logState<=2&&console.error(e,...r)},assert(...r){console.assert(...r)},time(r){console.time(r)},timeEnd(r){console.timeEnd(r)},setLevel(r){0<=r&&r<=3&&(this.logState=r)}}}s(Rme,"createLogger");var Ome=Rme();function kme(t){0<=t&&t<=3&&(Ome.logState=t)}s(kme,"setLoggerLevel");var Vt=Ome;N();N();var Nme=class extends Error{};s(Nme,"InvalidTokenError");var v2=Nme;v2.prototype.name="InvalidTokenError";function Fme(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let i=r.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}s(Fme,"b64DecodeUnicode");function Bme(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Fme(e)}catch{return atob(e)}}s(Bme,"base64UrlDecode");function zme(t,e){if(typeof t!="string")throw new v2("Invalid token specified: must be a string");e||(e={});let r=e.header===!0?0:1,i=t.split(".")[r];if(typeof i!="string")throw new v2("Invalid token specified: missing part #".concat(r+1));let n;try{n=Bme(i)}catch(a){throw new v2("Invalid token specified: invalid base64 for part #".concat(r+1," (").concat(a.message,")"))}try{return JSON.parse(n)}catch(a){throw new v2("Invalid token specified: invalid json for part #".concat(r+1," (").concat(a.message,")"))}}s(zme,"jwtDecode");N();var Zy=63710088e-1;function OB(t){var e,r;let i=zme(t);if(i.sub==null)throw new Error("Access token is missing sub claim.");return{sub:i.sub,aud:typeof i.aud=="string"?[i.aud]:(e=i.aud)!=null?e:[],capabilities:(r=i.capabilities)!=null?r:{}}}s(OB,"decodeAccessToken");function Vp(t){return t*(Math.PI/180)}s(Vp,"toRadians");function Ume(t){return t*(180/Math.PI)}s(Ume,"toDegrees");function UA(t,e){let r=Math.pow(10,e);return Math.sign(t)*Math.round(Math.abs(t)*r)/r}s(UA,"round");function RO(t,e){return(t%e+e)%e}s(RO,"euclideanModulo");function kB([t,e],[r,i]){let n=Vp(i-e),a=Vp(r-t),o=Vp(e),l=Vp(i),u=Math.sin(n/2)*Math.sin(n/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(o)*Math.cos(l),c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return Zy*c}s(kB,"haversineDistance");function Vme([t,e],[r,i]){let n=Vp(e),a=Vp(t),o=Vp(i),l=Vp(r)-a,u=Math.sin(l)*Math.cos(o),c=Math.cos(n)*Math.sin(o)-Math.sin(n)*Math.cos(o)*Math.cos(l);return Ume((Math.atan2(u,c)+Math.PI*2)%(Math.PI*2))}s(Vme,"getForwardBearing");function NB(t,e){let r=RO(t,Math.PI*2),i=RO(e,Math.PI*2),n=i-r,a=i+(n>Math.PI?-Math.PI*2:n<-Math.PI?Math.PI*2:0);return{start:r,end:a}}s(NB,"shortestTweenRotation");function J3(t){return t instanceof Ode?Number.isFinite(t.min.x)&&Number.isFinite(t.min.y)&&Number.isFinite(t.max.x)&&Number.isFinite(t.max.y):Number.isFinite(t.min.x)&&Number.isFinite(t.min.y)&&Number.isFinite(t.max.x)&&Number.isFinite(t.max.y)&&Number.isFinite(t.min.z)&&Number.isFinite(t.max.z)}s(J3,"isFiniteBox");function Lp(t,e,r,i){return(t<e||t>r)&&Vt.warn(i),Math.min(r,Math.max(e,t))}s(Lp,"clampWithWarning");function jme(t,e){if(t==null||e==null)return t===e;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}s(jme,"arraysEqual");N();var $me=class Gme extends Error{constructor(e){super(e),$(this,"name","AssertionError"),Error.captureStackTrace&&Error.captureStackTrace(this,Gme)}};s($me,"AssertionError");var AHe=$me;function FB(t,e){if(t==null){let r;if(e!=null&&e.customMessage)r=e.customMessage;else{let a=e!=null&&e.valueName?"'".concat(e.valueName,"'"):"value";r="Expected ".concat(a," to be defined, but received ").concat(t)}let i=(e==null?void 0:e.errorClass)||AHe,n=new i(r);throw(e==null?void 0:e.captureStackTrace)!==!1&&Error.captureStackTrace&&Error.captureStackTrace(n,FB),n}}s(FB,"assertExists");function OO(t,e,r){if(FB(t),(t==null?void 0:t.type)!==e){let i="Expected type ".concat(e," but got ").concat(t==null?void 0:t.type);throw new Error(r??i)}}s(OO,"assertType");N();var P6=[0,4,6,8,10],ya=s(()=>{let t=new Array(16).fill(0),e=Math.random()*4294967296;for(let i=0;i<t.length;i++)i>0&&(i&3)===0&&(e=Math.random()*4294967296),t[i]=e>>>((i&3)<<3)&255;let r=t.map(i=>i.toString(16).padStart(2,"0"));return r[6]="4"+r[6][1],r[8]=["8","9","a","b"].includes(r[7][0])?r[7]:"a"+r[7][1],P6.map((i,n)=>r.slice(i,n===P6.length-1?void 0:P6[n+1]).join("")).join("-")},"randomId");N();var Hme=class{constructor(){$(this,"_subscribers",{})}publish(e,r){!this._subscribers||!this._subscribers[e]||this._subscribers[e].forEach(function(i){typeof i=="function"&&i(r)})}on(e,r){this._subscribers||(this._subscribers={}),this._subscribers[e]=this._subscribers[e]||[],this._subscribers[e].push(r)}off(e,r){if(!this._subscribers||this._subscribers[e]==null)return;let i=this._subscribers[e].indexOf(r);i!==-1&&this._subscribers[e].splice(i,1)}destroy(){this._subscribers={}}};s(Hme,"PubSub");var Wa=Hme;N();var xW="mi-session-data",bW="mi-local-data",mE="id",gE="deviceId",N1,fp,mp,kO=class qme{constructor(){Be(this,fp),Be(this,mp);try{let e=sessionStorage.getItem(xW);e?He(this,fp,JSON.parse(e)):He(this,fp,{[mE]:ya()})}catch{He(this,fp,{[mE]:ya()})}try{let e=localStorage.getItem(bW);e?He(this,mp,JSON.parse(e)):He(this,mp,{[gE]:ya()})}catch{He(this,mp,{[gE]:ya()})}b(this,fp)[mE]||(b(this,fp)[mE]=ya()),b(this,mp)[gE]||(b(this,mp)[gE]=ya())}static getInstance(){return b(this,N1)||He(this,N1,new qme),b(this,N1)}static ___clearInstance(){He(this,N1,void 0)}saveSessionData(e,r){b(this,fp)[e]=r;try{return sessionStorage.setItem(xW,JSON.stringify(b(this,fp))),!0}catch{return!1}}loadSessionData(e){let r=b(this,fp)[e];if(r!=null)return r}saveLocalData(e,r){b(this,mp)[e]=r;try{return localStorage.setItem(bW,JSON.stringify(b(this,mp))),!0}catch{return!1}}loadLocalData(e){let r=b(this,mp)[e];if(r!=null)return r}};N1=new WeakMap,fp=new WeakMap,mp=new WeakMap,s(kO,"SafeStorage"),Be(kO,N1);var k_=kO;N();function NO(t){return(t%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}s(NO,"normalizeAngle");N();N();N();N();N();N();N();N();var bu=63710088e-1,Wme={centimeters:bu*100,centimetres:bu*100,degrees:bu/111325,feet:bu*3.28084,inches:bu*39.37,kilometers:bu/1e3,kilometres:bu/1e3,meters:bu,metres:bu,miles:bu/1609.344,millimeters:bu*1e3,millimetres:bu*1e3,nauticalmiles:bu/1852,radians:1,yards:bu*1.0936};function Vh(t,e,r){r===void 0&&(r={});var i={type:"Feature"};return(r.id===0||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=e||{},i.geometry=t,i}s(Vh,"feature");function hf(t,e,r){if(r===void 0&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!FO(t[0])||!FO(t[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:t};return Vh(i,e,r)}s(hf,"point");function u_(t,e,r){r===void 0&&(r={});for(var i=0,n=t;i<n.length;i++){var a=n[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:t};return Vh(l,e,r)}s(u_,"polygon");function tg(t,e,r){if(r===void 0&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:t};return Vh(i,e,r)}s(tg,"lineString");function Rw(t,e){e===void 0&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}s(Rw,"featureCollection");function Xme(t,e,r){r===void 0&&(r={});var i={type:"MultiLineString",coordinates:t};return Vh(i,e,r)}s(Xme,"multiLineString");function Zme(t,e,r){r===void 0&&(r={});var i={type:"MultiPoint",coordinates:t};return Vh(i,e,r)}s(Zme,"multiPoint");function Yme(t,e,r){r===void 0&&(r={});var i={type:"MultiPolygon",coordinates:t};return Vh(i,e,r)}s(Yme,"multiPolygon");function Kme(t,e){e===void 0&&(e="kilometers");var r=Wme[e];if(!r)throw new Error(e+" units is invalid");return t*r}s(Kme,"radiansToLength");function Jme(t,e){e===void 0&&(e="kilometers");var r=Wme[e];if(!r)throw new Error(e+" units is invalid");return t/r}s(Jme,"lengthToRadians");function Q3(t){var e=t%(2*Math.PI);return e*180/Math.PI}s(Q3,"radiansToDegrees");function eh(t){var e=t%360;return e*Math.PI/180}s(eh,"degreesToRadians");function FO(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}s(FO,"isNumber");function cx(t,e,r){if(t!==null)for(var i,n,a,o,l,u,c,p=0,m=0,y,v=t.type,w=v==="FeatureCollection",E=v==="Feature",M=w?t.features.length:1,I=0;I<M;I++){c=w?t.features[I].geometry:E?t.geometry:t,y=c?c.type==="GeometryCollection":!1,l=y?c.geometries.length:1;for(var P=0;P<l;P++){var C=0,T=0;if(o=y?c.geometries[P]:c,o!==null){u=o.coordinates;var O=o.type;switch(p=r&&(O==="Polygon"||O==="MultiPolygon")?1:0,O){case null:break;case"Point":if(e(u,m,I,C,T)===!1)return!1;m++,C++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(e(u[i],m,I,C,T)===!1)return!1;m++,O==="MultiPoint"&&C++}O==="LineString"&&C++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(n=0;n<u[i].length-p;n++){if(e(u[i][n],m,I,C,T)===!1)return!1;m++}O==="MultiLineString"&&C++,O==="Polygon"&&T++}O==="Polygon"&&C++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(T=0,n=0;n<u[i].length;n++){for(a=0;a<u[i][n].length-p;a++){if(e(u[i][n][a],m,I,C,T)===!1)return!1;m++}T++}C++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(cx(o.geometries[i],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}s(cx,"coordEach");function Qme(t,e,r,i){var n=r;return cx(t,function(a,o,l,u,c){o===0&&r===void 0?n=a:n=e(n,a,o,l,u,c)},i),n}s(Qme,"coordReduce");function BO(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}s(BO,"featureEach");function ege(t,e){var r,i,n,a,o,l,u,c,p,m,y=0,v=t.type==="FeatureCollection",w=t.type==="Feature",E=v?t.features.length:1;for(r=0;r<E;r++){for(l=v?t.features[r].geometry:w?t.geometry:t,c=v?t.features[r].properties:w?t.properties:{},p=v?t.features[r].bbox:w?t.bbox:void 0,m=v?t.features[r].id:w?t.id:void 0,u=l?l.type==="GeometryCollection":!1,o=u?l.geometries.length:1,n=0;n<o;n++){if(a=u?l.geometries[n]:l,a===null){if(e(null,y,c,p,m)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,y,c,p,m)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(e(a.geometries[i],y,c,p,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}y++}}s(ege,"geomEach");function mf(t,e){ege(t,function(r,i,n,a,o){var l=r===null?null:r.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(Vh(r,n,{bbox:a,id:o}),i,0)===!1?!1:void 0}var u;switch(l){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var c=0;c<r.coordinates.length;c++){var p=r.coordinates[c],m={type:u,coordinates:p};if(e(Vh(m,n),i,c)===!1)return!1}})}s(mf,"flattenEach");function tge(t,e){mf(t,function(r,i,n){var a=0;if(r.geometry){var o=r.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var l,u=0,c=0,p=0;if(cx(r,function(m,y,v,w,E){if(l===void 0||i>u||w>c||E>p){l=m,u=i,c=w,p=E,a=0;return}var M=tg([l,m],r.properties);if(e(M,i,n,E,a)===!1)return!1;a++,l=m})===!1)return!1}}})}s(tge,"segmentEach");function rge(t,e,r){var i=r,n=!1;return tge(t,function(a,o,l,u,c){n===!1&&r===void 0?i=a:i=e(i,a,o,l,u,c),n=!0}),i}s(rge,"segmentReduce");function eT(t){var e=[1/0,1/0,-1/0,-1/0];return cx(t,function(r){e[0]>r[0]&&(e[0]=r[0]),e[1]>r[1]&&(e[1]=r[1]),e[2]<r[0]&&(e[2]=r[0]),e[3]<r[1]&&(e[3]=r[1])}),e}s(eT,"bbox");eT.default=eT;var VA=eT;function ige(t){return VA(t)}s(ige,"getBoundingBoxFromFeature");N();var zO="#ffffff",nge=class{constructor(e={}){$(this,"initialColor",zO),$(this,"color",zO),$(this,"initialTopColor"),$(this,"topColor"),$(this,"topTexture"),$(this,"texture"),$(this,"hoverColor"),$(this,"dirty",!0),$(this,"visible",!0),$(this,"opacity",1),$(this,"width",.1),$(this,"height",.1),$(this,"initialHeight",.1),$(this,"altitude",0),$(this,"join","round"),$(this,"cap","round"),$(this,"showImage",!0),$(this,"flipImageToFaceCamera",!0),$(this,"url"),$(this,"side","double"),$(this,"renderOrder",0),this.color=(e==null?void 0:e.color)!==void 0?e.color:this.color,this.initialColor=this.color,this.width=(e==null?void 0:e.width)!==void 0?e.width:this.width,this.opacity=(e==null?void 0:e.opacity)!==void 0?e.opacity:this.opacity,this.visible=(e==null?void 0:e.visible)!==void 0?e.visible:this.visible,this.height=(e==null?void 0:e.height)!==void 0?e.height:this.height,this.initialHeight=this.height,this.altitude=(e==null?void 0:e.altitude)!==void 0?e.altitude:this.altitude,this.join=(e==null?void 0:e.join)!==void 0?e.join:this.join,this.cap=(e==null?void 0:e.cap)!==void 0?e.cap:this.cap,this.topColor=e==null?void 0:e.topColor,this.initialTopColor=this.topColor,this.texture=e==null?void 0:e.texture,this.topTexture=e==null?void 0:e.topTexture,this.showImage=(e==null?void 0:e.showImage)!==void 0?e.showImage:this.showImage,this.flipImageToFaceCamera=(e==null?void 0:e.flipImageToFaceCamera)!==void 0?e.flipImageToFaceCamera:this.flipImageToFaceCamera,this.url=e==null?void 0:e.url,this.side=(e==null?void 0:e.side)!==void 0?e.side:this.side,this.renderOrder=(e==null?void 0:e.renderOrder)!==void 0?e.renderOrder:this.renderOrder}};s(nge,"StyleComponent");var c_=nge,age=class extends wB{constructor(){super(...arguments),$(this,"type","entityBatchedMesh"),$(this,"userData",{entities:{}})}};s(age,"EntityBatchedMesh");var BB=age,lC,uC,R0,oge=class{constructor(e){$(this,"mesh"),$(this,"focusMesh"),$(this,"imageMesh"),$(this,"textMesh"),$(this,"textEntityId"),$(this,"type","geometry"),$(this,"dirty",!0),$(this,"detached",!1),$(this,"instanceIndex",-1),$(this,"geometry"),$(this,"material"),$(this,"feature"),$(this,"currentHeight",.1),$(this,"focusable",!1),$(this,"color",new si),$(this,"topColor",new si),$(this,"position",new qe),Be(this,lC,0),Be(this,uC,1),Be(this,R0),$(this,"texturesVisible",!1),this.feature=e}get visible(){return this.mesh&&this.instanceIndex!==-1?this.mesh.getVisibleAt(this.instanceIndex):!1}set visible(e){this.mesh&&this.instanceIndex!==-1&&this.mesh.setVisibleAt(this.instanceIndex,e)}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}setColor(e,r){this.color.set(e),this.topColor.set(r),this.material&&this.material.setColor(this.instanceIndex,this.color,this.topColor)}getColor(){var e;return(e=this.material)==null?void 0:e.getColor(this.instanceIndex)}get altitude(){return b(this,lC)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,lC,e))}get opacity(){return b(this,uC)}set opacity(e){if(this.material&&(this.material.opacity=e,this.material.transparent=e<1,this.material.needsUpdate=!0),this.imageMesh){let r=Array.isArray(this.imageMesh.material)?this.imageMesh.material:[this.imageMesh.material];for(let i of r)i.opacity=e,i.needsUpdate=!0}He(this,uC,e)}get texture(){var e,r;return(r=(e=this.material)==null?void 0:e.texture)==null?void 0:r.image.src}set texture(e){this.material&&(this.material.texture=e)}get textureInstance(){var e;return(e=this.material)==null?void 0:e.texture}set topTexture(e){this.material&&(this.material.topTexture=e)}get topTexture(){var e,r;return(r=(e=this.material)==null?void 0:e.topTexture)==null?void 0:r.image.src}get topTextureInstance(){var e;return(e=this.material)==null?void 0:e.topTexture}set blendTexture(e){this.material&&(this.material.blendTexture=e)}get featureBbox(){return b(this,R0)?b(this,R0):(He(this,R0,ige(this.feature)),b(this,R0))}showTextures(){this.material&&(this.material.showTextures(this.instanceIndex),this.texturesVisible=!0)}hideTextures(){this.material&&(this.material.hideTextures(this.instanceIndex),this.texturesVisible=!1)}removeSideTexture(){this.material&&this.material.removeSideTexture(this.instanceIndex)}removeTopTexture(){this.material&&this.material.removeTopTexture(this.instanceIndex)}};lC=new WeakMap,uC=new WeakMap,R0=new WeakMap,s(oge,"MeshComponent");var ru=oge;N();var wW="#ffffff",Hg,sge=class{constructor(e={}){$(this,"color",wW),$(this,"initialColor",wW),$(this,"topColor"),$(this,"initialTopColor"),$(this,"opacity",1),$(this,"height"),Be(this,Hg),$(this,"outline",!0),$(this,"texture"),$(this,"topTexture"),$(this,"dirty",!0);var r,i;this.color=(r=e==null?void 0:e.color)!=null?r:this.color,this.initialColor=this.color,this.topColor=e==null?void 0:e.topColor,this.initialTopColor=this.topColor,this.opacity=(i=e==null?void 0:e.opacity)!=null?i:this.opacity,this.height=e==null?void 0:e.height,this.shading=e==null?void 0:e.shading,this.outline=(e==null?void 0:e.outline)!==void 0?!!e.outline:this.outline}get shading(){return b(this,Hg)}set shading(e){var r;if(!e){He(this,Hg,void 0);return}He(this,Hg,(r=b(this,Hg))!=null?r:{start:0,end:0,intensity:0}),Object.assign(b(this,Hg),e)}};Hg=new WeakMap,s(sge,"GeometryGroupStyleComponent");var UO=sge,lge=class extends qa{constructor(e,r=new UO){super(),$(this,"visible",!0),$(this,"type","geometry-group"),$(this,"components"),$(this,"userData",{entityId:"",entities3D:new Set,opacity:1,dirty:!0,shadingDirty:!0}),this.components=[r],this.userData.entityId=e}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}getOpacity(){return this.userData.opacity}setOpacity(e){this.userData.opacity=e}removeEntity(){this.dispatchEvent({type:"childremoved",child:this})}getfirstChildEntityId(){let e;for(let r of this.children)if(!r.userData.detached){e=r;break}return e instanceof BB?Object.values(e.userData.entities)[0]:void 0}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}))}get altitude(){return this.position.z}};s(lge,"GeometryGroupObject3D");var Fu=lge;N();var uge=class extends qa{};s(uge,"Geometry2DObject3D");var Ow=uge,cge=class{constructor(e,r,i=0){$(this,"id"),$(this,"verticalOffset"),$(this,"occluderId"),$(this,"object3d",new Ow),$(this,"components"),$(this,"disposed",!1),$(this,"worldPosition",new qe),this.id=e.id||ya(),this.components=[e],this.verticalOffset=i,this.object3d=new Ow,this.object3d.position.set(r.x,r.y,r.z+i),this.object3d.userData.entityId=this.id,this.object3d.userData.type=this.type,this.positionDirty=!0}get type(){return this.components[0].type}get parentObject3D(){return this.object3d.parent}get attachedTo(){return this.object3d.userData.attachedEntityId}get position(){return this.positionDirty&&(this.object3d.matrixAutoUpdate=!0,this.object3d.getWorldPosition(this.worldPosition),this.positionDirty=!1,this.object3d.matrixAutoUpdate=!1),this.worldPosition}get positionDirty(){return this.object3d.userData.worldPositionDirty}set positionDirty(e){this.object3d.userData.worldPositionDirty=e}updatePosition(e){this.object3d.position.copy(e),this.positionDirty=!0}setAltitude(e){this.object3d.position.z=e,this.positionDirty=!0}};s(cge,"Geometry2D");var N_=cge;N();var hge=class extends qa{constructor(){super(...arguments),$(this,"type","geometry"),$(this,"userData",{entityId:"",type:"geometry"})}raycast(e,r){this.userData.type==="model"&&this.children[0]&&e.intersectObject(this.children[0],!0).forEach(i=>{r.push(i)})}};s(hge,"Geometry3DObject3D");var hx=hge,pge=class{constructor(e,r){$(this,"id",ya()),$(this,"components"),$(this,"entities2D",new Map),this.components=[e,r]}get object3d(){return this.components[0].mesh}get parentObject3D(){var e;return(e=this.components[0].mesh)==null?void 0:e.parent}get type(){return this.components[0].type}attach(e){this.parentObject3D instanceof Fu?e.object3d.userData.attachedEntityId=this.id:this.entities2D.set(e.id,e)}detach(e){this.parentObject3D instanceof Fu&&(e.object3d.userData.parentEntityId=void 0),this.entities2D.delete(e.id)}removeAllEntities(){for(let e of this.entities2D.values())this.detach(e)}};s(pge,"Geometry3D");var Ua=pge,dge=class cC extends qa{constructor(e){super(),$(this,"childrenIds",new Set),$(this,"children",[]),$(this,"type","group-container"),$(this,"userData",{entityId:"",entities2D:new Set,dirty:!0,occluderDirty:!1,opacity:1,computedOpacity:1,preloadGeometry:!1}),$(this,"components",[]),this.userData.entityId=e}addOccluderFeature(e,r){this.userData.occluderFeature=e,this.userData.occluderId=r,this.userData.occluderDirty=!0}addEntity(e){e instanceof cC?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof N_?(this.childrenIds.add(e.id),this.add(e.object3d),this.userData.entities2D.add(e.id),e.positionDirty=!0):e instanceof Fu?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof Ua&&e.object3d&&(this.childrenIds.add(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childadded",child:this})}removeEntity(e){e instanceof cC?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof N_?(this.childrenIds.delete(e.id),this.userData.entities2D.delete(e.id),this.remove(e.object3d)):e instanceof Fu?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof Ua&&e.object3d&&(this.childrenIds.delete(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childremoved",child:this})}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}),this.set2DGeometryChildrenPositionDirty())}set2DGeometryChildrenPositionDirty(){this.children.forEach(e=>{e instanceof Ow?e.userData.worldPositionDirty=!0:e instanceof cC&&e.set2DGeometryChildrenPositionDirty()})}get altitude(){return this.position.z}setOpacity(e){this.userData.opacity=e}get opacity(){return this.userData.opacity}};s(dge,"GroupContainerObject3D");var Kn=dge;N();var zB={top:0,bottom:0,left:0,right:0,type:"pixel"},fge="mappedin",mge={ALWAYS_ON_TOP:10},AW=250;N();function gge(t){let e=t.min,r=t.max,i=new qe(e.x,e.y,e.z),n=new qe(r.x,e.y,e.z),a=new qe(e.x,r.y,e.z),o=new qe(r.x,r.y,e.z);return[i,n,a,o]}s(gge,"getCornersOfBoundingBox");N();function F1(t,e){let r;return typeof e=="string"||typeof e=="number"?(r=t.geometry2DMap.get(e),r==null&&(r=t.geometry3DMap.get(e))):typeof(e==null?void 0:e.id)=="string"||typeof(e==null?void 0:e.id)=="number"?(r=t.geometry2DMap.get(e.id),r==null&&(r=t.geometry3DMap.get(e.id))):r=e,r}s(F1,"getGeometryByGeometryId");function yge(t,e,r=[],i=new ro,n){(t.getSystems().renderSystem.threeDdirty||t.getSystems().renderSystem.twoDdirty)&&t.renderSync();let a=F1(t.getInternalState(),e);return UB(a,r,i,n),r}s(yge,"getVerticesOfEntity");var yE=new qe;function UB(t,e=[],r=new ro,i){if(t.visible){if(t.isMesh||t.isLine||t.isPoints){let n=t.geometry;if(n.isBufferGeometry){let a=n.attributes.position;for(let o=0;o<a.count;o++)yE.fromBufferAttribute(a,o),i!==void 0&&(yE.z=i),e.push(yE.clone()),r.expandByPoint(yE)}}for(let n of t.children)UB(n,e,r,i)}}s(UB,"traverse");N();function cw(){return typeof window>"u"?1:Math.min(window.devicePixelRatio,2)}s(cw,"getPixelRatio");N();function tT(t,e,r=!1){let i=null,n=0;return function(...a){n++,n===1&&r===!0&&t(...a);let o=s(()=>{(!r||n>1)&&t(...a),i=null,n=0},"later");clearTimeout(i),i=setTimeout(o,e)}}s(tT,"debounce");N();var SHe=(()=>{let t;return{getDeviceType(){if(t)return t;let{userAgent:e,platform:r,maxTouchPoints:i}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),a=r==="iPad"||r.indexOf("Mac")===0&&i>0&&!window.MSStream,o=/android/i.test(e);return t={isIpad:a,isMobile:o||n||a,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e),isWindows:/windows/i.test(e)},t},_reset(){t=void 0}}})(),SW=SHe.getDeviceType,vge=(()=>{let t,e,r;function i(){if(e!==void 0)return e;t||(t=document.createElement("canvas"));let a=t.getContext("webgl")||t.getContext("experimental-webgl");if(!a)return e;try{let o=SW().isFirefox?null:a.getExtension("WEBGL_debug_renderer_info");return e=o?a.getParameter(o.UNMASKED_RENDERER_WEBGL):a.getParameter(a.RENDERER),e}catch{let l=new Error("Failed getting device info");throw l.name="FailedGettingDeviceInfo",l}}s(i,"getInfo");function n(){var a,o;if(!SW().isWindows)return!1;if(r!==void 0)return r;let l=(o=(a=MHe())==null?void 0:a.toLowerCase())!=null?o:"";return r=l.includes("intel")&&(l.includes("uhd")||l.includes("iris")),r}return s(n,"shouldDisableOffscreenCanvas"),{getInfo:i,shouldDisableOffscreenCanvas:n,_setCanvas(a){t=a,e=void 0,r=void 0}}})(),MHe=vge.getInfo,EHe=vge.shouldDisableOffscreenCanvas;N();function Zc(t,e){let r={};for(let i=0;i<e.length;i++){let n=e[i];n in t&&(r[n]=t[n])}return r}s(Zc,"pick");function _ge(t){return Object.keys(t).length===0}s(_ge,"isEmpty");N();var CHe=s(t=>e=>{if(!e.includes("mappedin")){let r={};for(let i in t){let n=t[i];e.includes("mappedin")||(t[i]=n)}return{url:e,headers:r}}return{url:e,headers:t}},"transformRequest");function VB(t,e,r,i){let n=t*(Math.PI/180),a=i/Zy,o=t+a*180/Math.PI,l=r/Zy/Math.cos(n),u=e+l*180/Math.PI;return{lat:o,lon:u}}s(VB,"cartesianToGeographic");function jB(t,e,r,i){let n=r*(Math.PI/180),a=i*(Math.PI/180),o=t*(Math.PI/180),l=e*(Math.PI/180),u=n-o,c=a-l,p=Zy*c*Math.cos(o),m=Zy*u;return{x:p,y:m}}s(jB,"geographicToCartesian");var xge=s((t,e)=>{var r;if(t.children&&t.visible)for(let i of t.children){if(i.visible&&i.type)if("entities3D"in i.userData&&(r=i.userData)!=null&&r.entities3D&&i.type==="geometry-group"){e.add(i.userData.entityId);for(let n of i.userData.entities3D.values())e.add(n)}else(i.type==="group-container"||i.type==="custom-geometry"||i instanceof hx)&&e.add(i.userData.entityId);xge(i,e)}return e},"populateGeometry3DIdsInScene"),bge=s((t,e)=>{var r;if(t.children&&t.visible&&!((r=t.userData)!=null&&r.hidden))for(let i of t.children)i.visible&&i instanceof Ow&&e.add(i.userData.entityId),bge(i,e);return e},"populateGeometry2DIdsInScene");function $B(t,e){for(let r in e){if(e[r]==null){t[r]=void 0;continue}typeof e[r]=="object"?$B(t[r],e[r]):t[r]=e[r]}return t}s($B,"mergeObjects");function GB(t,e,r,i){let n={translateX:t.x,translateY:t.y,translateZ:t.z,scale:t.meterInMercatorCoordinateUnits()},a=new Oi,o=new qe(n.scale,-n.scale,n.scale),l=new Oi().makeTranslation(n.translateX,n.translateY,n.translateZ).scale(o),u=r.elevation;return{id:fge,type:"custom",renderingMode:"3d",render:s((c,p)=>{if(a.fromArray(p),u!==r.elevation){let m=al.fromLngLat(t.toLngLat(),r.elevation);l.makeTranslation(n.translateX,n.translateY,-m.z).scale(o)}e.projectionMatrix=a.multiply(l),u=r.elevation,i()},"render")}}s(GB,"createCustomLayer");function wge(t){return fetch(t,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials"})})}s(wge,"fetchToken");async function Age(t){let e=await wge(t),{access_token:r}=await e.json();return{"x-mappedin-tiles-key":r}}s(Age,"getRequestHeaders");function Sge(t,e=0){let r=3735928559^e,i=1103547991^e;for(let n=0,a;n<t.length;n++)a=t.charCodeAt(n),r=Math.imul(r^a,2654435761),i=Math.imul(i^a,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&i)+(r>>>0)}s(Sge,"cyrb53");var Mge=s(t=>t,"linearEase"),IHe=s(t=>1-Math.cos(t*Math.PI/2),"easeIn");function Yy(t,e,r,i,n,a=Mge){t=Math.max(e,Math.min(t,r));let o=(t-Math.min(e,r))/Math.abs(r-e),l=a(o);return i+l*(n-i)}s(Yy,"interpolate");function VO(t,e,r){let i=t*(Math.PI/180)/2,n=e/2;return r*Math.tan(i)/n}s(VO,"getProjectionScaleFactor");function Ege(t){return new Km(new Ki(t[0][0],t[0][1]),new Ki(t[1][0],t[1][1])).getCenter().toArray()}s(Ege,"getBoundingBoxCenter");function Cge(t,e){return t<e||e<=12}s(Cge,"shouldExpandZoomLevel");function kw(t){let e=1;return t.type==="geometry-group"&&t.parent!=null&&t.parent instanceof Kn?e=t.parent.userData.computedOpacity:(t.type==="geometry"||t.type==="custom-geometry"||t.type==="model")&&t.parentObject3D!=null&&t.parentObject3D instanceof Fu&&t.parentObject3D.parent!=null&&t.parentObject3D.parent instanceof Kn&&(e=t.parentObject3D.parent.userData.computedOpacity),e}s(kw,"getGroupContainerOpacity");N();var Ige=class{constructor(e){$(this,"visible"),$(this,"altitude"),$(this,"color"),$(this,"dirty",!0),$(this,"maxWidth"),$(this,"maxHeight"),$(this,"hoverByPolygon"),$(this,"flipToFaceCamera",hw.flipToFaceCamera),$(this,"font"),$(this,"fillOpacity"),$(this,"fontSize"),$(this,"margin"),$(this,"outlineWidth"),$(this,"outlineBlur"),$(this,"outlineOffsetX"),$(this,"strokeColor"),$(this,"strokeOpacity"),$(this,"strokeWidth"),$(this,"hoverColor"),$(this,"outlineOffsetY"),$(this,"outlineColor"),$(this,"outlineOpacity"),e&&Object.assign(this,e)}getState(e=!1){let r={};for(let i in this)!e&&i==="dirty"||this[i]!==void 0&&(r[i]=this[i]);return r}};s(Ige,"Text3DStyleComponent");var jO=Ige,hw=Object.freeze({visible:!0,color:"black",flipToFaceCamera:!0,fillOpacity:1,font:void 0,fontSize:2,margin:[.2,1,.2,1.5],outlineColor:"black",outlineOpacity:1,outlineWidth:0,outlineOffsetX:0,outlineOffsetY:0,outlineBlur:0,strokeOpacity:1,strokeWidth:0,maxWidth:void 0,maxHeight:void 0,strokeColor:"black",hoverColor:void 0});N();N();var Tge=class{constructor(e){$(this,"dirty",!0),$(this,"visible",!0),$(this,"opacity",1),$(this,"verticalOffset",0),$(this,"interactive",!1),$(this,"color"),$(this,"material"),$(this,"rotation"),$(this,"scale"),e&&Object.assign(this,e)}};s(Tge,"ModelStyleComponnet");var Pge=Tge;N();var hC=[1,1,1],pC=[0,0,0];N();function fv(t,e=!1){let r=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),n=new Set(Object.keys(t[0].morphAttributes)),a={},o={},l=t[0].morphTargetsRelative,u=new js,c=0;for(let p=0;p<t.length;++p){let m=t[p],y=0;if(r!==(m.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let v in m.attributes){if(!i.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;a[v]===void 0&&(a[v]=[]),a[v].push(m.attributes[v]),y++}if(y!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". Make sure all geometries have the same number of attributes."),null;if(l!==m.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let v in m.morphAttributes){if(!n.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+".  .morphAttributes must be consistent throughout all geometries."),null;o[v]===void 0&&(o[v]=[]),o[v].push(m.morphAttributes[v])}if(e){let v;if(r)v=m.index.count;else if(m.attributes.position!==void 0)v=m.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". The geometry must have either an index or a position attribute"),null;u.addGroup(c,v,p),c+=v}}if(r){let p=0,m=[];for(let y=0;y<t.length;++y){let v=t[y].index;for(let w=0;w<v.count;++w)m.push(v.getX(w)+p);p+=t[y].attributes.position.count}u.setIndex(m)}for(let p in a){let m=$O(a[p]);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+p+" attribute."),null;u.setAttribute(p,m)}for(let p in o){let m=o[p][0].length;if(m===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[p]=[];for(let y=0;y<m;++y){let v=[];for(let E=0;E<o[p].length;++E)v.push(o[p][E][y]);let w=$O(v);if(!w)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+p+" morphAttribute."),null;u.morphAttributes[p].push(w)}}return u}s(fv,"mergeGeometries");function $O(t){let e,r,i,n=-1,a=0;for(let c=0;c<t.length;++c){let p=t[c];if(e===void 0&&(e=p.array.constructor),e!==p.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=p.itemSize),r!==p.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=p.normalized),i!==p.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(n===-1&&(n=p.gpuType),n!==p.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=p.count*r}let o=new e(a),l=new Yo(o,r,i),u=0;for(let c=0;c<t.length;++c){let p=t[c];if(p.isInterleavedBufferAttribute){let m=u/r;for(let y=0,v=p.count;y<v;y++)for(let w=0;w<r;w++){let E=p.getComponent(y,w);l.setComponent(y+m,w,E)}}else o.set(p.array,u);u+=p.count*r}return n!==void 0&&(l.gpuType=n),l}s($O,"mergeAttributes");function THe(t,e){if(e===KUe)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===Sq||e===JUe){let r=t.getIndex();if(r===null){let o=[],l=t.getAttribute("position");if(l!==void 0){for(let u=0;u<l.count;u++)o.push(u);t.setIndex(o),r=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}let i=r.count-2,n=[];if(e===Sq)for(let o=1;o<=i;o++)n.push(r.getX(0)),n.push(r.getX(o)),n.push(r.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(n.push(r.getX(o)),n.push(r.getX(o+1)),n.push(r.getX(o+2))):(n.push(r.getX(o+2)),n.push(r.getX(o+1)),n.push(r.getX(o)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=t.clone();return a.setIndex(n),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}s(THe,"toTrianglesDrawMode");var HB=bt((t,e)=>{N();var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function a(l){if(l==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(l)}s(a,"toObject");function o(){try{if(!Object.assign)return!1;var l=new String("abc");if(l[5]="de",Object.getOwnPropertyNames(l)[0]==="5")return!1;for(var u={},c=0;c<10;c++)u["_"+String.fromCharCode(c)]=c;var p=Object.getOwnPropertyNames(u).map(function(y){return u[y]});if(p.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(y){m[y]=y}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}s(o,"shouldUseNative"),e.exports=o()?Object.assign:function(l,u){for(var c,p=a(l),m,y=1;y<arguments.length;y++){c=Object(arguments[y]);for(var v in c)i.call(c,v)&&(p[v]=c[v]);if(r){m=r(c);for(var w=0;w<m.length;w++)n.call(c,m[w])&&(p[m[w]]=c[m[w]])}}return p}}),Lge=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self).RBush=i()}(t,function(){function r(P,C,T,O,F){s(function k(B,U,z,q,W){for(;q>z;){if(q-z>600){var J=q-z+1,V=U-z+1,oe=Math.log(J),Y=.5*Math.exp(2*oe/3),he=.5*Math.sqrt(oe*Y*(J-Y)/J)*(V-J/2<0?-1:1),Q=Math.max(z,Math.floor(U-V*Y/J+he)),ae=Math.min(q,Math.floor(U+(J-V)*Y/J+he));k(B,U,Q,ae,W)}var ee=B[U],le=z,K=q;for(i(B,z,U),W(B[q],ee)>0&&i(B,z,q);le<K;){for(i(B,le,K),le++,K--;W(B[le],ee)<0;)le++;for(;W(B[K],ee)>0;)K--}W(B[z],ee)===0?i(B,z,K):i(B,++K,q),K<=U&&(z=K+1),U<=K&&(q=K-1)}},"t")(P,C,T||0,O||P.length-1,F||n)}s(r,"t");function i(P,C,T){var O=P[C];P[C]=P[T],P[T]=O}s(i,"i");function n(P,C){return P<C?-1:P>C?1:0}s(n,"n");var a=s(function(P){P===void 0&&(P=9),this._maxEntries=Math.max(4,P),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()},"r");function o(P,C,T){if(!T)return C.indexOf(P);for(var O=0;O<C.length;O++)if(T(P,C[O]))return O;return-1}s(o,"e");function l(P,C){u(P,0,P.children.length,C,P)}s(l,"a");function u(P,C,T,O,F){F||(F=M(null)),F.minX=1/0,F.minY=1/0,F.maxX=-1/0,F.maxY=-1/0;for(var k=C;k<T;k++){var B=P.children[k];c(F,P.leaf?O(B):B)}return F}s(u,"h");function c(P,C){return P.minX=Math.min(P.minX,C.minX),P.minY=Math.min(P.minY,C.minY),P.maxX=Math.max(P.maxX,C.maxX),P.maxY=Math.max(P.maxY,C.maxY),P}s(c,"o");function p(P,C){return P.minX-C.minX}s(p,"s");function m(P,C){return P.minY-C.minY}s(m,"l");function y(P){return(P.maxX-P.minX)*(P.maxY-P.minY)}s(y,"f");function v(P){return P.maxX-P.minX+(P.maxY-P.minY)}s(v,"u");function w(P,C){return P.minX<=C.minX&&P.minY<=C.minY&&C.maxX<=P.maxX&&C.maxY<=P.maxY}s(w,"m");function E(P,C){return C.minX<=P.maxX&&C.minY<=P.maxY&&C.maxX>=P.minX&&C.maxY>=P.minY}s(E,"c");function M(P){return{children:P,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}s(M,"p");function I(P,C,T,O,F){for(var k=[C,T];k.length;)if(!((T=k.pop())-(C=k.pop())<=O)){var B=C+Math.ceil((T-C)/O/2)*O;r(P,B,C,T,F),k.push(C,B,B,T)}}return s(I,"d"),a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(P){var C=this.data,T=[];if(!E(P,C))return T;for(var O=this.toBBox,F=[];C;){for(var k=0;k<C.children.length;k++){var B=C.children[k],U=C.leaf?O(B):B;E(P,U)&&(C.leaf?T.push(B):w(P,U)?this._all(B,T):F.push(B))}C=F.pop()}return T},a.prototype.collides=function(P){var C=this.data;if(!E(P,C))return!1;for(var T=[];C;){for(var O=0;O<C.children.length;O++){var F=C.children[O],k=C.leaf?this.toBBox(F):F;if(E(P,k)){if(C.leaf||w(P,k))return!0;T.push(F)}}C=T.pop()}return!1},a.prototype.load=function(P){if(!P||!P.length)return this;if(P.length<this._minEntries){for(var C=0;C<P.length;C++)this.insert(P[C]);return this}var T=this._build(P.slice(),0,P.length-1,0);if(this.data.children.length)if(this.data.height===T.height)this._splitRoot(this.data,T);else{if(this.data.height<T.height){var O=this.data;this.data=T,T=O}this._insert(T,this.data.height-T.height-1,!0)}else this.data=T;return this},a.prototype.insert=function(P){return P&&this._insert(P,this.data.height-1),this},a.prototype.clear=function(){return this.data=M([]),this},a.prototype.remove=function(P,C){if(!P)return this;for(var T,O,F,k=this.data,B=this.toBBox(P),U=[],z=[];k||U.length;){if(k||(k=U.pop(),O=U[U.length-1],T=z.pop(),F=!0),k.leaf){var q=o(P,k.children,C);if(q!==-1)return k.children.splice(q,1),U.push(k),this._condense(U),this}F||k.leaf||!w(k,B)?O?(T++,k=O.children[T],F=!1):k=null:(U.push(k),z.push(T),T=0,O=k,k=k.children[0])}return this},a.prototype.toBBox=function(P){return P},a.prototype.compareMinX=function(P,C){return P.minX-C.minX},a.prototype.compareMinY=function(P,C){return P.minY-C.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(P){return this.data=P,this},a.prototype._all=function(P,C){for(var T=[];P;)P.leaf?C.push.apply(C,P.children):T.push.apply(T,P.children),P=T.pop();return C},a.prototype._build=function(P,C,T,O){var F,k=T-C+1,B=this._maxEntries;if(k<=B)return l(F=M(P.slice(C,T+1)),this.toBBox),F;O||(O=Math.ceil(Math.log(k)/Math.log(B)),B=Math.ceil(k/Math.pow(B,O-1))),(F=M([])).leaf=!1,F.height=O;var U=Math.ceil(k/B),z=U*Math.ceil(Math.sqrt(B));I(P,C,T,z,this.compareMinX);for(var q=C;q<=T;q+=z){var W=Math.min(q+z-1,T);I(P,q,W,U,this.compareMinY);for(var J=q;J<=W;J+=U){var V=Math.min(J+U-1,W);F.children.push(this._build(P,J,V,O-1))}}return l(F,this.toBBox),F},a.prototype._chooseSubtree=function(P,C,T,O){for(;O.push(C),!C.leaf&&O.length-1!==T;){for(var F=1/0,k=1/0,B=void 0,U=0;U<C.children.length;U++){var z=C.children[U],q=y(z),W=(J=P,V=z,(Math.max(V.maxX,J.maxX)-Math.min(V.minX,J.minX))*(Math.max(V.maxY,J.maxY)-Math.min(V.minY,J.minY))-q);W<k?(k=W,F=q<F?q:F,B=z):W===k&&q<F&&(F=q,B=z)}C=B||C.children[0]}var J,V;return C},a.prototype._insert=function(P,C,T){var O=T?P:this.toBBox(P),F=[],k=this._chooseSubtree(O,this.data,C,F);for(k.children.push(P),c(k,O);C>=0&&F[C].children.length>this._maxEntries;)this._split(F,C),C--;this._adjustParentBBoxes(O,F,C)},a.prototype._split=function(P,C){var T=P[C],O=T.children.length,F=this._minEntries;this._chooseSplitAxis(T,F,O);var k=this._chooseSplitIndex(T,F,O),B=M(T.children.splice(k,T.children.length-k));B.height=T.height,B.leaf=T.leaf,l(T,this.toBBox),l(B,this.toBBox),C?P[C-1].children.push(B):this._splitRoot(T,B)},a.prototype._splitRoot=function(P,C){this.data=M([P,C]),this.data.height=P.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(P,C,T){for(var O,F,k,B,U,z,q,W=1/0,J=1/0,V=C;V<=T-C;V++){var oe=u(P,0,V,this.toBBox),Y=u(P,V,T,this.toBBox),he=(F=oe,k=Y,B=void 0,U=void 0,z=void 0,q=void 0,B=Math.max(F.minX,k.minX),U=Math.max(F.minY,k.minY),z=Math.min(F.maxX,k.maxX),q=Math.min(F.maxY,k.maxY),Math.max(0,z-B)*Math.max(0,q-U)),Q=y(oe)+y(Y);he<W?(W=he,O=V,J=Q<J?Q:J):he===W&&Q<J&&(J=Q,O=V)}return O||T-C},a.prototype._chooseSplitAxis=function(P,C,T){var O=P.leaf?this.compareMinX:p,F=P.leaf?this.compareMinY:m;this._allDistMargin(P,C,T,O)<this._allDistMargin(P,C,T,F)&&P.children.sort(O)},a.prototype._allDistMargin=function(P,C,T,O){P.children.sort(O);for(var F=this.toBBox,k=u(P,0,C,F),B=u(P,T-C,T,F),U=v(k)+v(B),z=C;z<T-C;z++){var q=P.children[z];c(k,P.leaf?F(q):q),U+=v(k)}for(var W=T-C-1;W>=C;W--){var J=P.children[W];c(B,P.leaf?F(J):J),U+=v(B)}return U},a.prototype._adjustParentBBoxes=function(P,C,T){for(var O=T;O>=0;O--)c(C[O],P)},a.prototype._condense=function(P){for(var C=P.length-1,T=void 0;C>=0;C--)P[C].children.length===0?C>0?(T=P[C-1].children).splice(T.indexOf(P[C]),1):this.clear():l(P[C],this.toBBox)},a})}),PHe=bt((t,e)=>{N(),e.exports=s(function(r,i,n,a){var o=r[0],l=r[1],u=!1;n===void 0&&(n=0),a===void 0&&(a=i.length);for(var c=(a-n)/2,p=0,m=c-1;p<c;m=p++){var y=i[n+p*2+0],v=i[n+p*2+1],w=i[n+m*2+0],E=i[n+m*2+1],M=v>l!=E>l&&o<(w-y)*(l-v)/(E-v)+y;M&&(u=!u)}return u},"pointInPolygonFlat")}),LHe=bt((t,e)=>{N(),e.exports=s(function(r,i,n,a){var o=r[0],l=r[1],u=!1;n===void 0&&(n=0),a===void 0&&(a=i.length);for(var c=a-n,p=0,m=c-1;p<c;m=p++){var y=i[p+n][0],v=i[p+n][1],w=i[m+n][0],E=i[m+n][1],M=v>l!=E>l&&o<(w-y)*(l-v)/(E-v)+y;M&&(u=!u)}return u},"pointInPolygonNested")}),DHe=bt((t,e)=>{N();var r=PHe(),i=LHe();e.exports=s(function(n,a,o,l){return a.length>0&&Array.isArray(a[0])?i(n,a,o,l):r(n,a,o,l)},"pointInPolygon"),e.exports.nested=i,e.exports.flat=r}),RHe=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i((r=r||self).predicates={})}(t,function(r){let i=33306690738754706e-32;function n(w,E,M,I,P){let C,T,O,F,k=E[0],B=I[0],U=0,z=0;B>k==B>-k?(C=k,k=E[++U]):(C=B,B=I[++z]);let q=0;if(U<w&&z<M)for(B>k==B>-k?(O=C-((T=k+C)-k),k=E[++U]):(O=C-((T=B+C)-B),B=I[++z]),C=T,O!==0&&(P[q++]=O);U<w&&z<M;)B>k==B>-k?(O=C-((T=C+k)-(F=T-C))+(k-F),k=E[++U]):(O=C-((T=C+B)-(F=T-C))+(B-F),B=I[++z]),C=T,O!==0&&(P[q++]=O);for(;U<w;)O=C-((T=C+k)-(F=T-C))+(k-F),k=E[++U],C=T,O!==0&&(P[q++]=O);for(;z<M;)O=C-((T=C+B)-(F=T-C))+(B-F),B=I[++z],C=T,O!==0&&(P[q++]=O);return C===0&&q!==0||(P[q++]=C),q}s(n,"r");function a(w){return new Float64Array(w)}s(a,"o");let o=33306690738754716e-32,l=22204460492503146e-32,u=11093356479670487e-47,c=a(4),p=a(8),m=a(12),y=a(16),v=a(4);r.orient2d=function(w,E,M,I,P,C){let T=(E-C)*(M-P),O=(w-P)*(I-C),F=T-O;if(T===0||O===0||T>0!=O>0)return F;let k=Math.abs(T+O);return Math.abs(F)>=o*k?F:-function(B,U,z,q,W,J,V){let oe,Y,he,Q,ae,ee,le,K,ce,te,ne,pe,xe,Te,fe,Pe,me,Ae,Ue=B-W,_e=z-W,lt=U-J,tt=q-J;ae=(fe=(K=Ue-(le=(ee=134217729*Ue)-(ee-Ue)))*(te=tt-(ce=(ee=134217729*tt)-(ee-tt)))-((Te=Ue*tt)-le*ce-K*ce-le*te))-(ne=fe-(me=(K=lt-(le=(ee=134217729*lt)-(ee-lt)))*(te=_e-(ce=(ee=134217729*_e)-(ee-_e)))-((Pe=lt*_e)-le*ce-K*ce-le*te))),c[0]=fe-(ne+ae)+(ae-me),ae=(xe=Te-((pe=Te+ne)-(ae=pe-Te))+(ne-ae))-(ne=xe-Pe),c[1]=xe-(ne+ae)+(ae-Pe),ae=(Ae=pe+ne)-pe,c[2]=pe-(Ae-ae)+(ne-ae),c[3]=Ae;let We=function(ve,Ze){let It=Ze[0];for(let Rt=1;Rt<ve;Rt++)It+=Ze[Rt];return It}(4,c),at=l*V;if(We>=at||-We>=at||(oe=B-(Ue+(ae=B-Ue))+(ae-W),he=z-(_e+(ae=z-_e))+(ae-W),Y=U-(lt+(ae=U-lt))+(ae-J),Q=q-(tt+(ae=q-tt))+(ae-J),oe===0&&Y===0&&he===0&&Q===0)||(at=u*V+i*Math.abs(We),(We+=Ue*Q+tt*oe-(lt*he+_e*Y))>=at||-We>=at))return We;ae=(fe=(K=oe-(le=(ee=134217729*oe)-(ee-oe)))*(te=tt-(ce=(ee=134217729*tt)-(ee-tt)))-((Te=oe*tt)-le*ce-K*ce-le*te))-(ne=fe-(me=(K=Y-(le=(ee=134217729*Y)-(ee-Y)))*(te=_e-(ce=(ee=134217729*_e)-(ee-_e)))-((Pe=Y*_e)-le*ce-K*ce-le*te))),v[0]=fe-(ne+ae)+(ae-me),ae=(xe=Te-((pe=Te+ne)-(ae=pe-Te))+(ne-ae))-(ne=xe-Pe),v[1]=xe-(ne+ae)+(ae-Pe),ae=(Ae=pe+ne)-pe,v[2]=pe-(Ae-ae)+(ne-ae),v[3]=Ae;let Lt=n(4,c,4,v,p);ae=(fe=(K=Ue-(le=(ee=134217729*Ue)-(ee-Ue)))*(te=Q-(ce=(ee=134217729*Q)-(ee-Q)))-((Te=Ue*Q)-le*ce-K*ce-le*te))-(ne=fe-(me=(K=lt-(le=(ee=134217729*lt)-(ee-lt)))*(te=he-(ce=(ee=134217729*he)-(ee-he)))-((Pe=lt*he)-le*ce-K*ce-le*te))),v[0]=fe-(ne+ae)+(ae-me),ae=(xe=Te-((pe=Te+ne)-(ae=pe-Te))+(ne-ae))-(ne=xe-Pe),v[1]=xe-(ne+ae)+(ae-Pe),ae=(Ae=pe+ne)-pe,v[2]=pe-(Ae-ae)+(ne-ae),v[3]=Ae;let dt=n(Lt,p,4,v,m);ae=(fe=(K=oe-(le=(ee=134217729*oe)-(ee-oe)))*(te=Q-(ce=(ee=134217729*Q)-(ee-Q)))-((Te=oe*Q)-le*ce-K*ce-le*te))-(ne=fe-(me=(K=Y-(le=(ee=134217729*Y)-(ee-Y)))*(te=he-(ce=(ee=134217729*he)-(ee-he)))-((Pe=Y*he)-le*ce-K*ce-le*te))),v[0]=fe-(ne+ae)+(ae-me),ae=(xe=Te-((pe=Te+ne)-(ae=pe-Te))+(ne-ae))-(ne=xe-Pe),v[1]=xe-(ne+ae)+(ae-Pe),ae=(Ae=pe+ne)-pe,v[2]=pe-(Ae-ae)+(ne-ae),v[3]=Ae;let Me=n(dt,m,4,v,y);return y[Me-1]}(w,E,M,I,P,C,k)},r.orient2dfast=function(w,E,M,I,P,C){return(E-C)*(M-P)-(w-P)*(I-C)},Object.defineProperty(r,"__esModule",{value:!0})})}),OHe=bt((t,e)=>{N();var r=Lge(),i=S9(),n=DHe(),a=RHe().orient2d;i.default&&(i=i.default),e.exports=o,e.exports.default=o;function o(F,k,B){k=Math.max(0,k===void 0?2:k),B=B||0;var U=E(F),z=new r(16);z.toBBox=function(te){return{minX:te[0],minY:te[1],maxX:te[0],maxY:te[1]}},z.compareMinX=function(te,ne){return te[0]-ne[0]},z.compareMinY=function(te,ne){return te[1]-ne[1]},z.load(F);for(var q=[],W=0,J;W<U.length;W++){var V=U[W];z.remove(V),J=M(V,J),q.push(J)}var oe=new r(16);for(W=0;W<q.length;W++)oe.insert(w(q[W]));for(var Y=k*k,he=B*B;q.length;){var Q=q.shift(),ae=Q.p,ee=Q.next.p,le=I(ae,ee);if(!(le<he)){var K=le/Y;V=l(z,Q.prev.p,ae,ee,Q.next.next.p,K,oe),V&&Math.min(I(V,ae),I(V,ee))<=K&&(q.push(Q),q.push(M(V,Q)),z.remove(V),oe.remove(Q),oe.insert(w(Q)),oe.insert(w(Q.next)))}}Q=J;var ce=[];do ce.push(Q.p),Q=Q.next;while(Q!==J);return ce.push(Q.p),ce}s(o,"concaveman");function l(F,k,B,U,z,q,W){for(var J=new i([],u),V=F.data;V;){for(var oe=0;oe<V.children.length;oe++){var Y=V.children[oe],he=V.leaf?P(Y,B,U):c(B,U,Y);he>q||J.push({node:Y,dist:he})}for(;J.length&&!J.peek().node.children;){var Q=J.pop(),ae=Q.node,ee=P(ae,k,B),le=P(ae,U,z);if(Q.dist<ee&&Q.dist<le&&m(B,ae,W)&&m(U,ae,W))return ae}V=J.pop(),V&&(V=V.node)}return null}s(l,"findCandidate");function u(F,k){return F.dist-k.dist}s(u,"compareDist");function c(F,k,B){if(p(F,B)||p(k,B))return 0;var U=C(F[0],F[1],k[0],k[1],B.minX,B.minY,B.maxX,B.minY);if(U===0)return 0;var z=C(F[0],F[1],k[0],k[1],B.minX,B.minY,B.minX,B.maxY);if(z===0)return 0;var q=C(F[0],F[1],k[0],k[1],B.maxX,B.minY,B.maxX,B.maxY);if(q===0)return 0;var W=C(F[0],F[1],k[0],k[1],B.minX,B.maxY,B.maxX,B.maxY);return W===0?0:Math.min(U,z,q,W)}s(c,"sqSegBoxDist");function p(F,k){return F[0]>=k.minX&&F[0]<=k.maxX&&F[1]>=k.minY&&F[1]<=k.maxY}s(p,"inside");function m(F,k,B){for(var U=Math.min(F[0],k[0]),z=Math.min(F[1],k[1]),q=Math.max(F[0],k[0]),W=Math.max(F[1],k[1]),J=B.search({minX:U,minY:z,maxX:q,maxY:W}),V=0;V<J.length;V++)if(v(J[V].p,J[V].next.p,F,k))return!1;return!0}s(m,"noIntersections");function y(F,k,B){return a(F[0],F[1],k[0],k[1],B[0],B[1])}s(y,"cross");function v(F,k,B,U){return F!==U&&k!==B&&y(F,k,B)>0!=y(F,k,U)>0&&y(B,U,F)>0!=y(B,U,k)>0}s(v,"intersects");function w(F){var k=F.p,B=F.next.p;return F.minX=Math.min(k[0],B[0]),F.minY=Math.min(k[1],B[1]),F.maxX=Math.max(k[0],B[0]),F.maxY=Math.max(k[1],B[1]),F}s(w,"updateBBox");function E(F){for(var k=F[0],B=F[0],U=F[0],z=F[0],q=0;q<F.length;q++){var W=F[q];W[0]<k[0]&&(k=W),W[0]>U[0]&&(U=W),W[1]<B[1]&&(B=W),W[1]>z[1]&&(z=W)}var J=[k,B,U,z],V=J.slice();for(q=0;q<F.length;q++)n(F[q],J)||V.push(F[q]);return O(V)}s(E,"fastConvexHull");function M(F,k){var B={p:F,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return k?(B.next=k.next,B.prev=k,k.next.prev=B,k.next=B):(B.prev=B,B.next=B),B}s(M,"insertNode");function I(F,k){var B=F[0]-k[0],U=F[1]-k[1];return B*B+U*U}s(I,"getSqDist");function P(F,k,B){var U=k[0],z=k[1],q=B[0]-U,W=B[1]-z;if(q!==0||W!==0){var J=((F[0]-U)*q+(F[1]-z)*W)/(q*q+W*W);J>1?(U=B[0],z=B[1]):J>0&&(U+=q*J,z+=W*J)}return q=F[0]-U,W=F[1]-z,q*q+W*W}s(P,"sqSegDist");function C(F,k,B,U,z,q,W,J){var V=B-F,oe=U-k,Y=W-z,he=J-q,Q=F-z,ae=k-q,ee=V*V+oe*oe,le=V*Y+oe*he,K=Y*Y+he*he,ce=V*Q+oe*ae,te=Y*Q+he*ae,ne=ee*K-le*le,pe,xe,Te,fe,Pe=ne,me=ne;ne===0?(xe=0,Pe=1,fe=te,me=K):(xe=le*te-K*ce,fe=ee*te-le*ce,xe<0?(xe=0,fe=te,me=K):xe>Pe&&(xe=Pe,fe=te+le,me=K)),fe<0?(fe=0,-ce<0?xe=0:-ce>ee?xe=Pe:(xe=-ce,Pe=ee)):fe>me&&(fe=me,-ce+le<0?xe=0:-ce+le>ee?xe=Pe:(xe=-ce+le,Pe=ee)),pe=xe===0?0:xe/Pe,Te=fe===0?0:fe/me;var Ae=(1-pe)*F+pe*B,Ue=(1-pe)*k+pe*U,_e=(1-Te)*z+Te*W,lt=(1-Te)*q+Te*J,tt=_e-Ae,We=lt-Ue;return tt*tt+We*We}s(C,"sqSegSegDist");function T(F,k){return F[0]===k[0]?F[1]-k[1]:F[0]-k[0]}s(T,"compareByX");function O(F){F.sort(T);for(var k=[],B=0;B<F.length;B++){for(;k.length>=2&&y(k[k.length-2],k[k.length-1],F[B])<=0;)k.pop();k.push(F[B])}for(var U=[],z=F.length-1;z>=0;z--){for(;U.length>=2&&y(U[U.length-2],U[U.length-1],F[z])<=0;)U.pop();U.push(F[z])}return U.pop(),k.pop(),k.concat(U)}s(O,"convexHull")}),kHe=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):r.quickselect=i()}(t,function(){function r(o,l,u,c,p){i(o,l,u||0,c||o.length-1,p||a)}s(r,"quickselect");function i(o,l,u,c,p){for(;c>u;){if(c-u>600){var m=c-u+1,y=l-u+1,v=Math.log(m),w=.5*Math.exp(2*v/3),E=.5*Math.sqrt(v*w*(m-w)/m)*(y-m/2<0?-1:1),M=Math.max(u,Math.floor(l-y*w/m+E)),I=Math.min(c,Math.floor(l+(m-y)*w/m+E));i(o,l,M,I,p)}var P=o[l],C=u,T=c;for(n(o,u,l),p(o[c],P)>0&&n(o,u,c);C<T;){for(n(o,C,T),C++,T--;p(o[C],P)<0;)C++;for(;p(o[T],P)>0;)T--}p(o[u],P)===0?n(o,u,T):(T++,n(o,T,c)),T<=l&&(u=T+1),l<=T&&(c=T-1)}}s(i,"quickselectStep");function n(o,l,u){var c=o[l];o[l]=o[u],o[u]=c}s(n,"swap");function a(o,l){return o<l?-1:o>l?1:0}return s(a,"defaultCompare"),r})}),Dge=bt((t,e)=>{N(),e.exports=i,e.exports.default=i;var r=kHe();function i(P,C){if(!(this instanceof i))return new i(P,C);this._maxEntries=Math.max(4,P||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),C&&this._initFormat(C),this.clear()}s(i,"rbush"),i.prototype={all:s(function(){return this._all(this.data,[])},"all"),search:s(function(P){var C=this.data,T=[],O=this.toBBox;if(!E(P,C))return T;for(var F=[],k,B,U,z;C;){for(k=0,B=C.children.length;k<B;k++)U=C.children[k],z=C.leaf?O(U):U,E(P,z)&&(C.leaf?T.push(U):w(P,z)?this._all(U,T):F.push(U));C=F.pop()}return T},"search"),collides:s(function(P){var C=this.data,T=this.toBBox;if(!E(P,C))return!1;for(var O=[],F,k,B,U;C;){for(F=0,k=C.children.length;F<k;F++)if(B=C.children[F],U=C.leaf?T(B):B,E(P,U)){if(C.leaf||w(P,U))return!0;O.push(B)}C=O.pop()}return!1},"collides"),load:s(function(P){if(!(P&&P.length))return this;if(P.length<this._minEntries){for(var C=0,T=P.length;C<T;C++)this.insert(P[C]);return this}var O=this._build(P.slice(),0,P.length-1,0);if(!this.data.children.length)this.data=O;else if(this.data.height===O.height)this._splitRoot(this.data,O);else{if(this.data.height<O.height){var F=this.data;this.data=O,O=F}this._insert(O,this.data.height-O.height-1,!0)}return this},"load"),insert:s(function(P){return P&&this._insert(P,this.data.height-1),this},"insert"),clear:s(function(){return this.data=M([]),this},"clear"),remove:s(function(P,C){if(!P)return this;for(var T=this.data,O=this.toBBox(P),F=[],k=[],B,U,z,q;T||F.length;){if(T||(T=F.pop(),U=F[F.length-1],B=k.pop(),q=!0),T.leaf&&(z=n(P,T.children,C),z!==-1))return T.children.splice(z,1),F.push(T),this._condense(F),this;!q&&!T.leaf&&w(T,O)?(F.push(T),k.push(B),B=0,U=T,T=T.children[0]):U?(B++,T=U.children[B],q=!1):T=null}return this},"remove"),toBBox:s(function(P){return P},"toBBox"),compareMinX:u,compareMinY:c,toJSON:s(function(){return this.data},"toJSON"),fromJSON:s(function(P){return this.data=P,this},"fromJSON"),_all:s(function(P,C){for(var T=[];P;)P.leaf?C.push.apply(C,P.children):T.push.apply(T,P.children),P=T.pop();return C},"_all"),_build:s(function(P,C,T,O){var F=T-C+1,k=this._maxEntries,B;if(F<=k)return B=M(P.slice(C,T+1)),a(B,this.toBBox),B;O||(O=Math.ceil(Math.log(F)/Math.log(k)),k=Math.ceil(F/Math.pow(k,O-1))),B=M([]),B.leaf=!1,B.height=O;var U=Math.ceil(F/k),z=U*Math.ceil(Math.sqrt(k)),q,W,J,V;for(I(P,C,T,z,this.compareMinX),q=C;q<=T;q+=z)for(J=Math.min(q+z-1,T),I(P,q,J,U,this.compareMinY),W=q;W<=J;W+=U)V=Math.min(W+U-1,J),B.children.push(this._build(P,W,V,O-1));return a(B,this.toBBox),B},"_build"),_chooseSubtree:s(function(P,C,T,O){for(var F,k,B,U,z,q,W,J;O.push(C),!(C.leaf||O.length-1===T);){for(W=J=1/0,F=0,k=C.children.length;F<k;F++)B=C.children[F],z=p(B),q=y(P,B)-z,q<J?(J=q,W=z<W?z:W,U=B):q===J&&z<W&&(W=z,U=B);C=U||C.children[0]}return C},"_chooseSubtree"),_insert:s(function(P,C,T){var O=this.toBBox,F=T?P:O(P),k=[],B=this._chooseSubtree(F,this.data,C,k);for(B.children.push(P),l(B,F);C>=0&&k[C].children.length>this._maxEntries;)this._split(k,C),C--;this._adjustParentBBoxes(F,k,C)},"_insert"),_split:s(function(P,C){var T=P[C],O=T.children.length,F=this._minEntries;this._chooseSplitAxis(T,F,O);var k=this._chooseSplitIndex(T,F,O),B=M(T.children.splice(k,T.children.length-k));B.height=T.height,B.leaf=T.leaf,a(T,this.toBBox),a(B,this.toBBox),C?P[C-1].children.push(B):this._splitRoot(T,B)},"_split"),_splitRoot:s(function(P,C){this.data=M([P,C]),this.data.height=P.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},"_splitRoot"),_chooseSplitIndex:s(function(P,C,T){var O,F,k,B,U,z,q,W;for(z=q=1/0,O=C;O<=T-C;O++)F=o(P,0,O,this.toBBox),k=o(P,O,T,this.toBBox),B=v(F,k),U=p(F)+p(k),B<z?(z=B,W=O,q=U<q?U:q):B===z&&U<q&&(q=U,W=O);return W},"_chooseSplitIndex"),_chooseSplitAxis:s(function(P,C,T){var O=P.leaf?this.compareMinX:u,F=P.leaf?this.compareMinY:c,k=this._allDistMargin(P,C,T,O),B=this._allDistMargin(P,C,T,F);k<B&&P.children.sort(O)},"_chooseSplitAxis"),_allDistMargin:s(function(P,C,T,O){P.children.sort(O);var F=this.toBBox,k=o(P,0,C,F),B=o(P,T-C,T,F),U=m(k)+m(B),z,q;for(z=C;z<T-C;z++)q=P.children[z],l(k,P.leaf?F(q):q),U+=m(k);for(z=T-C-1;z>=C;z--)q=P.children[z],l(B,P.leaf?F(q):q),U+=m(B);return U},"_allDistMargin"),_adjustParentBBoxes:s(function(P,C,T){for(var O=T;O>=0;O--)l(C[O],P)},"_adjustParentBBoxes"),_condense:s(function(P){for(var C=P.length-1,T;C>=0;C--)P[C].children.length===0?C>0?(T=P[C-1].children,T.splice(T.indexOf(P[C]),1)):this.clear():a(P[C],this.toBBox)},"_condense"),_initFormat:s(function(P){var C=["return a"," - b",";"];this.compareMinX=new Function("a","b",C.join(P[0])),this.compareMinY=new Function("a","b",C.join(P[1])),this.toBBox=new Function("a","return {minX: a"+P[0]+", minY: a"+P[1]+", maxX: a"+P[2]+", maxY: a"+P[3]+"};")},"_initFormat")};function n(P,C,T){if(!T)return C.indexOf(P);for(var O=0;O<C.length;O++)if(T(P,C[O]))return O;return-1}s(n,"findItem");function a(P,C){o(P,0,P.children.length,C,P)}s(a,"calcBBox");function o(P,C,T,O,F){F||(F=M(null)),F.minX=1/0,F.minY=1/0,F.maxX=-1/0,F.maxY=-1/0;for(var k=C,B;k<T;k++)B=P.children[k],l(F,P.leaf?O(B):B);return F}s(o,"distBBox");function l(P,C){return P.minX=Math.min(P.minX,C.minX),P.minY=Math.min(P.minY,C.minY),P.maxX=Math.max(P.maxX,C.maxX),P.maxY=Math.max(P.maxY,C.maxY),P}s(l,"extend");function u(P,C){return P.minX-C.minX}s(u,"compareNodeMinX");function c(P,C){return P.minY-C.minY}s(c,"compareNodeMinY");function p(P){return(P.maxX-P.minX)*(P.maxY-P.minY)}s(p,"bboxArea");function m(P){return P.maxX-P.minX+(P.maxY-P.minY)}s(m,"bboxMargin");function y(P,C){return(Math.max(C.maxX,P.maxX)-Math.min(C.minX,P.minX))*(Math.max(C.maxY,P.maxY)-Math.min(C.minY,P.minY))}s(y,"enlargedArea");function v(P,C){var T=Math.max(P.minX,C.minX),O=Math.max(P.minY,C.minY),F=Math.min(P.maxX,C.maxX),k=Math.min(P.maxY,C.maxY);return Math.max(0,F-T)*Math.max(0,k-O)}s(v,"intersectionArea");function w(P,C){return P.minX<=C.minX&&P.minY<=C.minY&&C.maxX<=P.maxX&&C.maxY<=P.maxY}s(w,"contains");function E(P,C){return C.minX<=P.maxX&&C.minY<=P.maxY&&C.maxX>=P.minX&&C.maxY>=P.minY}s(E,"intersects");function M(P){return{children:P,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}s(M,"createNode");function I(P,C,T,O,F){for(var k=[C,T],B;k.length;)T=k.pop(),C=k.pop(),!(T-C<=O)&&(B=C+Math.ceil((T-C)/O/2)*O,r(P,B,C,T,F),k.push(C,B,B,T))}s(I,"multiSelect")}),Rge=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=63710088e-1,t.factors={centimeters:t.earthRadius*100,centimetres:t.earthRadius*100,degrees:t.earthRadius/111325,feet:t.earthRadius*3.28084,inches:t.earthRadius*39.37,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:t.earthRadius*1e3,millimetres:t.earthRadius*1e3,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius*1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(q,W,J){J===void 0&&(J={});var V={type:"Feature"};return(J.id===0||J.id)&&(V.id=J.id),J.bbox&&(V.bbox=J.bbox),V.properties=W||{},V.geometry=q,V}s(e,"feature"),t.feature=e;function r(q,W,J){switch(q){case"Point":return i(W).geometry;case"LineString":return l(W).geometry;case"Polygon":return a(W).geometry;case"MultiPoint":return m(W).geometry;case"MultiLineString":return p(W).geometry;case"MultiPolygon":return y(W).geometry;default:throw new Error(q+" is invalid")}}s(r,"geometry"),t.geometry=r;function i(q,W,J){if(J===void 0&&(J={}),!q)throw new Error("coordinates is required");if(!Array.isArray(q))throw new Error("coordinates must be an Array");if(q.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!k(q[0])||!k(q[1]))throw new Error("coordinates must contain numbers");var V={type:"Point",coordinates:q};return e(V,W,J)}s(i,"point"),t.point=i;function n(q,W,J){return J===void 0&&(J={}),c(q.map(function(V){return i(V,W)}),J)}s(n,"points"),t.points=n;function a(q,W,J){J===void 0&&(J={});for(var V=0,oe=q;V<oe.length;V++){var Y=oe[V];if(Y.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var he=0;he<Y[Y.length-1].length;he++)if(Y[Y.length-1][he]!==Y[0][he])throw new Error("First and last Position are not equivalent.")}var Q={type:"Polygon",coordinates:q};return e(Q,W,J)}s(a,"polygon"),t.polygon=a;function o(q,W,J){return J===void 0&&(J={}),c(q.map(function(V){return a(V,W)}),J)}s(o,"polygons"),t.polygons=o;function l(q,W,J){if(J===void 0&&(J={}),q.length<2)throw new Error("coordinates must be an array of two or more positions");var V={type:"LineString",coordinates:q};return e(V,W,J)}s(l,"lineString"),t.lineString=l;function u(q,W,J){return J===void 0&&(J={}),c(q.map(function(V){return l(V,W)}),J)}s(u,"lineStrings"),t.lineStrings=u;function c(q,W){W===void 0&&(W={});var J={type:"FeatureCollection"};return W.id&&(J.id=W.id),W.bbox&&(J.bbox=W.bbox),J.features=q,J}s(c,"featureCollection"),t.featureCollection=c;function p(q,W,J){J===void 0&&(J={});var V={type:"MultiLineString",coordinates:q};return e(V,W,J)}s(p,"multiLineString"),t.multiLineString=p;function m(q,W,J){J===void 0&&(J={});var V={type:"MultiPoint",coordinates:q};return e(V,W,J)}s(m,"multiPoint"),t.multiPoint=m;function y(q,W,J){J===void 0&&(J={});var V={type:"MultiPolygon",coordinates:q};return e(V,W,J)}s(y,"multiPolygon"),t.multiPolygon=y;function v(q,W,J){J===void 0&&(J={});var V={type:"GeometryCollection",geometries:q};return e(V,W,J)}s(v,"geometryCollection"),t.geometryCollection=v;function w(q,W){if(W===void 0&&(W=0),W&&!(W>=0))throw new Error("precision must be a positive number");var J=Math.pow(10,W||0);return Math.round(q*J)/J}s(w,"round"),t.round=w;function E(q,W){W===void 0&&(W="kilometers");var J=t.factors[W];if(!J)throw new Error(W+" units is invalid");return q*J}s(E,"radiansToLength"),t.radiansToLength=E;function M(q,W){W===void 0&&(W="kilometers");var J=t.factors[W];if(!J)throw new Error(W+" units is invalid");return q/J}s(M,"lengthToRadians"),t.lengthToRadians=M;function I(q,W){return C(M(q,W))}s(I,"lengthToDegrees"),t.lengthToDegrees=I;function P(q){var W=q%360;return W<0&&(W+=360),W}s(P,"bearingToAzimuth"),t.bearingToAzimuth=P;function C(q){var W=q%(2*Math.PI);return W*180/Math.PI}s(C,"radiansToDegrees"),t.radiansToDegrees=C;function T(q){var W=q%360;return W*Math.PI/180}s(T,"degreesToRadians"),t.degreesToRadians=T;function O(q,W,J){if(W===void 0&&(W="kilometers"),J===void 0&&(J="kilometers"),!(q>=0))throw new Error("length must be a positive number");return E(M(q,W),J)}s(O,"convertLength"),t.convertLength=O;function F(q,W,J){if(W===void 0&&(W="meters"),J===void 0&&(J="kilometers"),!(q>=0))throw new Error("area must be a positive number");var V=t.areaFactors[W];if(!V)throw new Error("invalid original units");var oe=t.areaFactors[J];if(!oe)throw new Error("invalid final units");return q/V*oe}s(F,"convertArea"),t.convertArea=F;function k(q){return!isNaN(q)&&q!==null&&!Array.isArray(q)}s(k,"isNumber"),t.isNumber=k;function B(q){return!!q&&q.constructor===Object}s(B,"isObject"),t.isObject=B;function U(q){if(!q)throw new Error("bbox is required");if(!Array.isArray(q))throw new Error("bbox must be an Array");if(q.length!==4&&q.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");q.forEach(function(W){if(!k(W))throw new Error("bbox must only contain numbers")})}s(U,"validateBBox"),t.validateBBox=U;function z(q){if(!q)throw new Error("id is required");if(["string","number"].indexOf(typeof q)===-1)throw new Error("id must be a number or a string")}s(z,"validateId"),t.validateId=z}),Oge=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Rge();function r(C,T,O){if(C!==null)for(var F,k,B,U,z,q,W,J=0,V=0,oe,Y=C.type,he=Y==="FeatureCollection",Q=Y==="Feature",ae=he?C.features.length:1,ee=0;ee<ae;ee++){W=he?C.features[ee].geometry:Q?C.geometry:C,oe=W?W.type==="GeometryCollection":!1,z=oe?W.geometries.length:1;for(var le=0;le<z;le++){var K=0,ce=0;if(U=oe?W.geometries[le]:W,U!==null){q=U.coordinates;var te=U.type;switch(J=O&&(te==="Polygon"||te==="MultiPolygon")?1:0,te){case null:break;case"Point":if(T(q,V,ee,K,ce)===!1)return!1;V++,K++;break;case"LineString":case"MultiPoint":for(F=0;F<q.length;F++){if(T(q[F],V,ee,K,ce)===!1)return!1;V++,te==="MultiPoint"&&K++}te==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(F=0;F<q.length;F++){for(k=0;k<q[F].length-J;k++){if(T(q[F][k],V,ee,K,ce)===!1)return!1;V++}te==="MultiLineString"&&K++,te==="Polygon"&&ce++}te==="Polygon"&&K++;break;case"MultiPolygon":for(F=0;F<q.length;F++){for(ce=0,k=0;k<q[F].length;k++){for(B=0;B<q[F][k].length-J;B++){if(T(q[F][k][B],V,ee,K,ce)===!1)return!1;V++}ce++}K++}break;case"GeometryCollection":for(F=0;F<U.geometries.length;F++)if(r(U.geometries[F],T,O)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}s(r,"coordEach");function i(C,T,O,F){var k=O;return r(C,function(B,U,z,q,W){U===0&&O===void 0?k=B:k=T(k,B,U,z,q,W)},F),k}s(i,"coordReduce");function n(C,T){var O;switch(C.type){case"FeatureCollection":for(O=0;O<C.features.length&&T(C.features[O].properties,O)!==!1;O++);break;case"Feature":T(C.properties,0);break}}s(n,"propEach");function a(C,T,O){var F=O;return n(C,function(k,B){B===0&&O===void 0?F=k:F=T(F,k,B)}),F}s(a,"propReduce");function o(C,T){if(C.type==="Feature")T(C,0);else if(C.type==="FeatureCollection")for(var O=0;O<C.features.length&&T(C.features[O],O)!==!1;O++);}s(o,"featureEach");function l(C,T,O){var F=O;return o(C,function(k,B){B===0&&O===void 0?F=k:F=T(F,k,B)}),F}s(l,"featureReduce");function u(C){var T=[];return r(C,function(O){T.push(O)}),T}s(u,"coordAll");function c(C,T){var O,F,k,B,U,z,q,W,J,V,oe=0,Y=C.type==="FeatureCollection",he=C.type==="Feature",Q=Y?C.features.length:1;for(O=0;O<Q;O++){for(z=Y?C.features[O].geometry:he?C.geometry:C,W=Y?C.features[O].properties:he?C.properties:{},J=Y?C.features[O].bbox:he?C.bbox:void 0,V=Y?C.features[O].id:he?C.id:void 0,q=z?z.type==="GeometryCollection":!1,U=q?z.geometries.length:1,k=0;k<U;k++){if(B=q?z.geometries[k]:z,B===null){if(T(null,oe,W,J,V)===!1)return!1;continue}switch(B.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(T(B,oe,W,J,V)===!1)return!1;break}case"GeometryCollection":{for(F=0;F<B.geometries.length;F++)if(T(B.geometries[F],oe,W,J,V)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}oe++}}s(c,"geomEach");function p(C,T,O){var F=O;return c(C,function(k,B,U,z,q){B===0&&O===void 0?F=k:F=T(F,k,B,U,z,q)}),F}s(p,"geomReduce");function m(C,T){c(C,function(O,F,k,B,U){var z=O===null?null:O.type;switch(z){case null:case"Point":case"LineString":case"Polygon":return T(e.feature(O,k,{bbox:B,id:U}),F,0)===!1?!1:void 0}var q;switch(z){case"MultiPoint":q="Point";break;case"MultiLineString":q="LineString";break;case"MultiPolygon":q="Polygon";break}for(var W=0;W<O.coordinates.length;W++){var J=O.coordinates[W],V={type:q,coordinates:J};if(T(e.feature(V,k),F,W)===!1)return!1}})}s(m,"flattenEach");function y(C,T,O){var F=O;return m(C,function(k,B,U){B===0&&U===0&&O===void 0?F=k:F=T(F,k,B,U)}),F}s(y,"flattenReduce");function v(C,T){m(C,function(O,F,k){var B=0;if(O.geometry){var U=O.geometry.type;if(!(U==="Point"||U==="MultiPoint")){var z,q=0,W=0,J=0;if(r(O,function(V,oe,Y,he,Q){if(z===void 0||F>q||he>W||Q>J){z=V,q=F,W=he,J=Q,B=0;return}var ae=e.lineString([z,V],O.properties);if(T(ae,F,k,Q,B)===!1)return!1;B++,z=V})===!1)return!1}}})}s(v,"segmentEach");function w(C,T,O){var F=O,k=!1;return v(C,function(B,U,z,q,W){k===!1&&O===void 0?F=B:F=T(F,B,U,z,q,W),k=!0}),F}s(w,"segmentReduce");function E(C,T){if(!C)throw new Error("geojson is required");m(C,function(O,F,k){if(O.geometry!==null){var B=O.geometry.type,U=O.geometry.coordinates;switch(B){case"LineString":if(T(O,F,k,0,0)===!1)return!1;break;case"Polygon":for(var z=0;z<U.length;z++)if(T(e.lineString(U[z],O.properties),F,k,z)===!1)return!1;break}}})}s(E,"lineEach");function M(C,T,O){var F=O;return E(C,function(k,B,U,z){B===0&&O===void 0?F=k:F=T(F,k,B,U,z)}),F}s(M,"lineReduce");function I(C,T){if(T=T||{},!e.isObject(T))throw new Error("options is invalid");var O=T.featureIndex||0,F=T.multiFeatureIndex||0,k=T.geometryIndex||0,B=T.segmentIndex||0,U=T.properties,z;switch(C.type){case"FeatureCollection":O<0&&(O=C.features.length+O),U=U||C.features[O].properties,z=C.features[O].geometry;break;case"Feature":U=U||C.properties,z=C.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":z=C;break;default:throw new Error("geojson is invalid")}if(z===null)return null;var q=z.coordinates;switch(z.type){case"Point":case"MultiPoint":return null;case"LineString":return B<0&&(B=q.length+B-1),e.lineString([q[B],q[B+1]],U,T);case"Polygon":return k<0&&(k=q.length+k),B<0&&(B=q[k].length+B-1),e.lineString([q[k][B],q[k][B+1]],U,T);case"MultiLineString":return F<0&&(F=q.length+F),B<0&&(B=q[F].length+B-1),e.lineString([q[F][B],q[F][B+1]],U,T);case"MultiPolygon":return F<0&&(F=q.length+F),k<0&&(k=q[F].length+k),B<0&&(B=q[F][k].length-B-1),e.lineString([q[F][k][B],q[F][k][B+1]],U,T)}throw new Error("geojson is invalid")}s(I,"findSegment");function P(C,T){if(T=T||{},!e.isObject(T))throw new Error("options is invalid");var O=T.featureIndex||0,F=T.multiFeatureIndex||0,k=T.geometryIndex||0,B=T.coordIndex||0,U=T.properties,z;switch(C.type){case"FeatureCollection":O<0&&(O=C.features.length+O),U=U||C.features[O].properties,z=C.features[O].geometry;break;case"Feature":U=U||C.properties,z=C.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":z=C;break;default:throw new Error("geojson is invalid")}if(z===null)return null;var q=z.coordinates;switch(z.type){case"Point":return e.point(q,U,T);case"MultiPoint":return F<0&&(F=q.length+F),e.point(q[F],U,T);case"LineString":return B<0&&(B=q.length+B),e.point(q[B],U,T);case"Polygon":return k<0&&(k=q.length+k),B<0&&(B=q[k].length+B),e.point(q[k][B],U,T);case"MultiLineString":return F<0&&(F=q.length+F),B<0&&(B=q[F].length+B),e.point(q[F][B],U,T);case"MultiPolygon":return F<0&&(F=q.length+F),k<0&&(k=q[F].length+k),B<0&&(B=q[F][k].length-B),e.point(q[F][k][B],U,T)}throw new Error("geojson is invalid")}s(P,"findPoint"),t.coordAll=u,t.coordEach=r,t.coordReduce=i,t.featureEach=o,t.featureReduce=l,t.findPoint=P,t.findSegment=I,t.flattenEach=m,t.flattenReduce=y,t.geomEach=c,t.geomReduce=p,t.lineEach=E,t.lineReduce=M,t.propEach=n,t.propReduce=a,t.segmentEach=v,t.segmentReduce=w}),NHe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Oge();function r(i){var n=[1/0,1/0,-1/0,-1/0];return e.coordEach(i,function(a){n[0]>a[0]&&(n[0]=a[0]),n[1]>a[1]&&(n[1]=a[1]),n[2]<a[0]&&(n[2]=a[0]),n[3]<a[1]&&(n[3]=a[1])}),n}s(r,"bbox"),r.default=r,t.default=r}),qB=bt((t,e)=>{N();var r=Lge(),i=Rge(),n=Oge(),a=NHe().default,o=n.featureEach;n.coordEach,i.polygon;var l=i.featureCollection;function u(c){var p=new r(c);return p.insert=function(m){if(m.type!=="Feature")throw new Error("invalid feature");return m.bbox=m.bbox?m.bbox:a(m),r.prototype.insert.call(this,m)},p.load=function(m){var y=[];return Array.isArray(m)?m.forEach(function(v){if(v.type!=="Feature")throw new Error("invalid features");v.bbox=v.bbox?v.bbox:a(v),y.push(v)}):o(m,function(v){if(v.type!=="Feature")throw new Error("invalid features");v.bbox=v.bbox?v.bbox:a(v),y.push(v)}),r.prototype.load.call(this,y)},p.remove=function(m,y){if(m.type!=="Feature")throw new Error("invalid feature");return m.bbox=m.bbox?m.bbox:a(m),r.prototype.remove.call(this,m,y)},p.clear=function(){return r.prototype.clear.call(this)},p.search=function(m){var y=r.prototype.search.call(this,this.toBBox(m));return l(y)},p.collides=function(m){return r.prototype.collides.call(this,this.toBBox(m))},p.all=function(){var m=r.prototype.all.call(this);return l(m)},p.toJSON=function(){return r.prototype.toJSON.call(this)},p.fromJSON=function(m){return r.prototype.fromJSON.call(this,m)},p.toBBox=function(m){var y;if(m.bbox)y=m.bbox;else if(Array.isArray(m)&&m.length===4)y=m;else if(Array.isArray(m)&&m.length===6)y=[m[0],m[1],m[3],m[4]];else if(m.type==="Feature")y=a(m);else if(m.type==="FeatureCollection")y=a(m);else throw new Error("invalid geojson");return{minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]}},p}s(u,"geojsonRbush"),e.exports=u,e.exports.default=u}),kge=bt((t,e)=>{N();var r=Object.prototype.toString;e.exports=s(function(i){var n=r.call(i),a=n==="[object Arguments]";return a||(a=n!=="[object Array]"&&i!==null&&typeof i=="object"&&typeof i.length=="number"&&i.length>=0&&r.call(i.callee)==="[object Function]"),a},"isArguments")}),FHe=bt((t,e)=>{N();var r;Object.keys||(i=Object.prototype.hasOwnProperty,n=Object.prototype.toString,a=kge(),o=Object.prototype.propertyIsEnumerable,l=!o.call({toString:null},"toString"),u=o.call(function(){},"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=s(function(w){var E=w.constructor;return E&&E.prototype===w},"equalsConstructorPrototype"),m={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},y=function(){if(typeof window>"u")return!1;for(var w in window)try{if(!m["$"+w]&&i.call(window,w)&&window[w]!==null&&typeof window[w]=="object")try{p(window[w])}catch{return!0}}catch{return!0}return!1}(),v=s(function(w){if(typeof window>"u"||!y)return p(w);try{return p(w)}catch{return!1}},"equalsConstructorPrototypeIfNotBuggy"),r=s(function(w){var E=w!==null&&typeof w=="object",M=n.call(w)==="[object Function]",I=a(w),P=E&&n.call(w)==="[object String]",C=[];if(!E&&!M&&!I)throw new TypeError("Object.keys called on a non-object");var T=u&&M;if(P&&w.length>0&&!i.call(w,0))for(var O=0;O<w.length;++O)C.push(String(O));if(I&&w.length>0)for(var F=0;F<w.length;++F)C.push(String(F));else for(var k in w)!(T&&k==="prototype")&&i.call(w,k)&&C.push(String(k));if(l)for(var B=v(w),U=0;U<c.length;++U)!(B&&c[U]==="constructor")&&i.call(w,c[U])&&C.push(c[U]);return C},"keys"));var i,n,a,o,l,u,c,p,m,y,v;e.exports=r}),Nge=bt((t,e)=>{N();var r=Array.prototype.slice,i=kge(),n=Object.keys,a=n?s(function(l){return n(l)},"keys"):FHe(),o=Object.keys;a.shim=s(function(){if(Object.keys){var l=function(){var u=Object.keys(arguments);return u&&u.length===arguments.length}(1,2);l||(Object.keys=s(function(u){return i(u)?o(r.call(u)):o(u)},"keys"))}else Object.keys=a;return Object.keys||a},"shimObjectKeys"),e.exports=a}),Fge=bt((t,e)=>{N(),e.exports=s(function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var r={},i=Symbol("test"),n=Object(i);if(typeof i=="string"||Object.prototype.toString.call(i)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;r[i]=a;for(var o in r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var l=Object.getOwnPropertySymbols(r);if(l.length!==1||l[0]!==i||!Object.prototype.propertyIsEnumerable.call(r,i))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(r,i);if(u.value!==a||u.enumerable!==!0)return!1}return!0},"hasSymbols")}),WB=bt((t,e)=>{N();var r=Fge();e.exports=s(function(){return r()&&!!Symbol.toStringTag},"hasToStringTagShams")}),Bge=bt((t,e)=>{N(),e.exports=Object}),zge=bt((t,e)=>{N(),e.exports=Error}),BHe=bt((t,e)=>{N(),e.exports=EvalError}),zHe=bt((t,e)=>{N(),e.exports=RangeError}),UHe=bt((t,e)=>{N(),e.exports=ReferenceError}),Uge=bt((t,e)=>{N(),e.exports=SyntaxError}),px=bt((t,e)=>{N(),e.exports=TypeError}),VHe=bt((t,e)=>{N(),e.exports=URIError}),jHe=bt((t,e)=>{N(),e.exports=Math.abs}),$He=bt((t,e)=>{N(),e.exports=Math.floor}),GHe=bt((t,e)=>{N(),e.exports=Math.max}),HHe=bt((t,e)=>{N(),e.exports=Math.min}),qHe=bt((t,e)=>{N(),e.exports=Math.pow}),WHe=bt((t,e)=>{N(),e.exports=Math.round}),XHe=bt((t,e)=>{N(),e.exports=Number.isNaN||s(function(r){return r!==r},"isNaN")}),ZHe=bt((t,e)=>{N();var r=XHe();e.exports=s(function(i){return r(i)||i===0?i:i<0?-1:1},"sign")}),YHe=bt((t,e)=>{N(),e.exports=Object.getOwnPropertyDescriptor}),dx=bt((t,e)=>{N();var r=YHe();if(r)try{r([],"length")}catch{r=null}e.exports=r}),jP=bt((t,e)=>{N();var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}e.exports=r}),KHe=bt((t,e)=>{N();var r=typeof Symbol<"u"&&Symbol,i=Fge();e.exports=s(function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:i()},"hasNativeSymbols")}),Vge=bt((t,e)=>{N(),e.exports=typeof Reflect<"u"&&Reflect.getPrototypeOf||null}),jge=bt((t,e)=>{N();var r=Bge();e.exports=r.getPrototypeOf||null}),JHe=bt((t,e)=>{N();var r="Function.prototype.bind called on incompatible ",i=Object.prototype.toString,n=Math.max,a="[object Function]",o=s(function(c,p){for(var m=[],y=0;y<c.length;y+=1)m[y]=c[y];for(var v=0;v<p.length;v+=1)m[v+c.length]=p[v];return m},"concatty"),l=s(function(c,p){for(var m=[],y=p||0,v=0;y<c.length;y+=1,v+=1)m[v]=c[y];return m},"slicy"),u=s(function(c,p){for(var m="",y=0;y<c.length;y+=1)m+=c[y],y+1<c.length&&(m+=p);return m},"joiny");e.exports=s(function(c){var p=this;if(typeof p!="function"||i.apply(p)!==a)throw new TypeError(r+p);for(var m=l(arguments,1),y,v=s(function(){if(this instanceof y){var P=p.apply(this,o(m,arguments));return Object(P)===P?P:this}return p.apply(c,o(m,arguments))},"binder"),w=n(0,p.length-m.length),E=[],M=0;M<w;M++)E[M]="$"+M;if(y=Function("binder","return function ("+u(E,",")+"){ return binder.apply(this,arguments); }")(v),p.prototype){var I=s(function(){},"Empty");I.prototype=p.prototype,y.prototype=new I,I.prototype=null}return y},"bind")}),jA=bt((t,e)=>{N();var r=JHe();e.exports=Function.prototype.bind||r}),XB=bt((t,e)=>{N(),e.exports=Function.prototype.call}),ZB=bt((t,e)=>{N(),e.exports=Function.prototype.apply}),QHe=bt((t,e)=>{N(),e.exports=typeof Reflect<"u"&&Reflect&&Reflect.apply}),$ge=bt((t,e)=>{N();var r=jA(),i=ZB(),n=XB(),a=QHe();e.exports=a||r.call(n,i)}),YB=bt((t,e)=>{N();var r=jA(),i=px(),n=XB(),a=$ge();e.exports=s(function(o){if(o.length<1||typeof o[0]!="function")throw new i("a function is required");return a(r,n,o)},"callBindBasic")}),eqe=bt((t,e)=>{N();var r=YB(),i=dx(),n;try{n=[].__proto__===Array.prototype}catch(u){if(!u||typeof u!="object"||!("code"in u)||u.code!=="ERR_PROTO_ACCESS")throw u}var a=!!n&&i&&i(Object.prototype,"__proto__"),o=Object,l=o.getPrototypeOf;e.exports=a&&typeof a.get=="function"?r([a.get]):typeof l=="function"?s(function(u){return l(u==null?u:o(u))},"getDunder"):!1}),Gge=bt((t,e)=>{N();var r=Vge(),i=jge(),n=eqe();e.exports=r?s(function(a){return r(a)},"getProto"):i?s(function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return i(a)},"getProto"):n?s(function(a){return n(a)},"getProto"):null}),Hge=bt((t,e)=>{N();var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,n=jA();e.exports=n.call(r,i)}),qge=bt((t,e)=>{N();var r,i=Bge(),n=zge(),a=BHe(),o=zHe(),l=UHe(),u=Uge(),c=px(),p=VHe(),m=jHe(),y=$He(),v=GHe(),w=HHe(),E=qHe(),M=WHe(),I=ZHe(),P=Function,C=s(function(me){try{return P('"use strict"; return ('+me+").constructor;")()}catch{}},"getEvalledConstructor"),T=dx(),O=jP(),F=s(function(){throw new c},"throwTypeError"),k=T?function(){try{return arguments.callee,F}catch{try{return T(arguments,"callee").get}catch{return F}}}():F,B=KHe()(),U=Gge(),z=jge(),q=Vge(),W=ZB(),J=XB(),V={},oe=typeof Uint8Array>"u"||!U?r:U(Uint8Array),Y={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":B&&U?U([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":V,"%AsyncGenerator%":V,"%AsyncGeneratorFunction%":V,"%AsyncIteratorPrototype%":V,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":a,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":P,"%GeneratorFunction%":V,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":B&&U?U(U([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!B||!U?r:U(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":T,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":o,"%ReferenceError%":l,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!B||!U?r:U(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":B&&U?U(""[Symbol.iterator]()):r,"%Symbol%":B?Symbol:r,"%SyntaxError%":u,"%ThrowTypeError%":k,"%TypedArray%":oe,"%TypeError%":c,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":p,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":J,"%Function.prototype.apply%":W,"%Object.defineProperty%":O,"%Object.getPrototypeOf%":z,"%Math.abs%":m,"%Math.floor%":y,"%Math.max%":v,"%Math.min%":w,"%Math.pow%":E,"%Math.round%":M,"%Math.sign%":I,"%Reflect.getPrototypeOf%":q};if(U)try{null.error}catch(me){he=U(U(me)),Y["%Error.prototype%"]=he}var he,Q=s(function me(Ae){var Ue;if(Ae==="%AsyncFunction%")Ue=C("async function () {}");else if(Ae==="%GeneratorFunction%")Ue=C("function* () {}");else if(Ae==="%AsyncGeneratorFunction%")Ue=C("async function* () {}");else if(Ae==="%AsyncGenerator%"){var _e=me("%AsyncGeneratorFunction%");_e&&(Ue=_e.prototype)}else if(Ae==="%AsyncIteratorPrototype%"){var lt=me("%AsyncGenerator%");lt&&U&&(Ue=U(lt.prototype))}return Y[Ae]=Ue,Ue},"doEval"),ae={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ee=jA(),le=Hge(),K=ee.call(J,Array.prototype.concat),ce=ee.call(W,Array.prototype.splice),te=ee.call(J,String.prototype.replace),ne=ee.call(J,String.prototype.slice),pe=ee.call(J,RegExp.prototype.exec),xe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Te=/\\(\\)?/g,fe=s(function(me){var Ae=ne(me,0,1),Ue=ne(me,-1);if(Ae==="%"&&Ue!=="%")throw new u("invalid intrinsic syntax, expected closing `%`");if(Ue==="%"&&Ae!=="%")throw new u("invalid intrinsic syntax, expected opening `%`");var _e=[];return te(me,xe,function(lt,tt,We,at){_e[_e.length]=We?te(at,Te,"$1"):tt||lt}),_e},"stringToPath"),Pe=s(function(me,Ae){var Ue=me,_e;if(le(ae,Ue)&&(_e=ae[Ue],Ue="%"+_e[0]+"%"),le(Y,Ue)){var lt=Y[Ue];if(lt===V&&(lt=Q(Ue)),typeof lt>"u"&&!Ae)throw new c("intrinsic "+me+" exists, but is not available. Please file an issue!");return{alias:_e,name:Ue,value:lt}}throw new u("intrinsic "+me+" does not exist!")},"getBaseIntrinsic");e.exports=s(function(me,Ae){if(typeof me!="string"||me.length===0)throw new c("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Ae!="boolean")throw new c('"allowMissing" argument must be a boolean');if(pe(/^%?[^%]*%?$/,me)===null)throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ue=fe(me),_e=Ue.length>0?Ue[0]:"",lt=Pe("%"+_e+"%",Ae),tt=lt.name,We=lt.value,at=!1,Lt=lt.alias;Lt&&(_e=Lt[0],ce(Ue,K([0,1],Lt)));for(var dt=1,Me=!0;dt<Ue.length;dt+=1){var ve=Ue[dt],Ze=ne(ve,0,1),It=ne(ve,-1);if((Ze==='"'||Ze==="'"||Ze==="`"||It==='"'||It==="'"||It==="`")&&Ze!==It)throw new u("property names with quotes must have matching quotes");if((ve==="constructor"||!Me)&&(at=!0),_e+="."+ve,tt="%"+_e+"%",le(Y,tt))We=Y[tt];else if(We!=null){if(!(ve in We)){if(!Ae)throw new c("base intrinsic for "+me+" exists, but the property is not available.");return}if(T&&dt+1>=Ue.length){var Rt=T(We,ve);Me=!!Rt,Me&&"get"in Rt&&!("originalValue"in Rt.get)?We=Rt.get:We=We[ve]}else Me=le(We,ve),We=We[ve];Me&&!at&&(Y[tt]=We)}}return We},"GetIntrinsic")}),KB=bt((t,e)=>{N();var r=qge(),i=YB(),n=i([r("%String.prototype.indexOf%")]);e.exports=s(function(a,o){var l=r(a,!!o);return typeof l=="function"&&n(a,".prototype.")>-1?i([l]):l},"callBoundIntrinsic")}),tqe=bt((t,e)=>{N();var r=WB()(),i=KB(),n=i("Object.prototype.toString"),a=s(function(u){return r&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:n(u)==="[object Arguments]"},"isArguments"),o=s(function(u){return a(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&n(u)!=="[object Array]"&&"callee"in u&&n(u.callee)==="[object Function]"},"isArguments"),l=function(){return a(arguments)}();a.isLegacyArguments=o,e.exports=l?a:o}),JB=bt((t,e)=>{N();var r=jP(),i=Uge(),n=px(),a=dx();e.exports=s(function(o,l,u){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,p=arguments.length>4?arguments[4]:null,m=arguments.length>5?arguments[5]:null,y=arguments.length>6?arguments[6]:!1,v=!!a&&a(o,l);if(r)r(o,l,{configurable:m===null&&v?v.configurable:!m,enumerable:c===null&&v?v.enumerable:!c,value:u,writable:p===null&&v?v.writable:!p});else if(y||!c&&!p&&!m)o[l]=u;else throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},"defineDataProperty")}),QB=bt((t,e)=>{N();var r=jP(),i=s(function(){return!!r},"hasPropertyDescriptors");i.hasArrayLengthDefineBug=s(function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},"hasArrayLengthDefineBug"),e.exports=i}),$A=bt((t,e)=>{N();var r=Nge(),i=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,a=Array.prototype.concat,o=JB(),l=s(function(m){return typeof m=="function"&&n.call(m)==="[object Function]"},"isFunction"),u=QB()(),c=s(function(m,y,v,w){if(y in m){if(w===!0){if(m[y]===v)return}else if(!l(w)||!w())return}u?o(m,y,v,!0):o(m,y,v)},"defineProperty"),p=s(function(m,y){var v=arguments.length>2?arguments[2]:{},w=r(y);i&&(w=a.call(w,Object.getOwnPropertySymbols(y)));for(var E=0;E<w.length;E+=1)c(m,w[E],y[w[E]],v[w[E]])},"defineProperties");p.supportsDescriptors=!!u,e.exports=p}),rqe=bt((t,e)=>{N();var r=qge(),i=JB(),n=QB()(),a=dx(),o=px(),l=r("%Math.floor%");e.exports=s(function(u,c){if(typeof u!="function")throw new o("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||l(c)!==c)throw new o("`length` must be a positive 32-bit integer");var p=arguments.length>2&&!!arguments[2],m=!0,y=!0;if("length"in u&&a){var v=a(u,"length");v&&!v.configurable&&(m=!1),v&&!v.writable&&(y=!1)}return(m||y||!p)&&(n?i(u,"length",c,!0,!0):i(u,"length",c)),u},"setFunctionLength")}),iqe=bt((t,e)=>{N();var r=jA(),i=ZB(),n=$ge();e.exports=s(function(){return n(r,i,arguments)},"applyBind")}),Wge=bt((t,e)=>{N();var r=rqe(),i=jP(),n=YB(),a=iqe();e.exports=s(function(o){var l=n(arguments),u=o.length-(arguments.length-1);return r(l,1+(u>0?u:0),!0)},"callBind"),i?i(e.exports,"apply",{value:a}):e.exports.apply=a}),Xge=bt((t,e)=>{N();var r=s(function(i){return i!==i},"numberIsNaN");e.exports=s(function(i,n){return i===0&&n===0?1/i===1/n:!!(i===n||r(i)&&r(n))},"is")}),Zge=bt((t,e)=>{N();var r=Xge();e.exports=s(function(){return typeof Object.is=="function"?Object.is:r},"getPolyfill")}),nqe=bt((t,e)=>{N();var r=Zge(),i=$A();e.exports=s(function(){var n=r();return i(Object,{is:n},{is:s(function(){return Object.is!==n},"testObjectIs")}),n},"shimObjectIs")}),aqe=bt((t,e)=>{N();var r=$A(),i=Wge(),n=Xge(),a=Zge(),o=nqe(),l=i(a(),Object);r(l,{getPolyfill:a,implementation:n,shim:o}),e.exports=l}),oqe=bt((t,e)=>{N();var r=KB(),i=WB()(),n=Hge(),a=dx(),o;i?(l=r("RegExp.prototype.exec"),u={},c=s(function(){throw u},"throwRegexMarker"),p={toString:c,valueOf:c},typeof Symbol.toPrimitive=="symbol"&&(p[Symbol.toPrimitive]=c),o=s(function(v){if(!v||typeof v!="object")return!1;var w=a(v,"lastIndex"),E=w&&n(w,"value");if(!E)return!1;try{l(v,p)}catch(M){return M===u}},"isRegex")):(m=r("Object.prototype.toString"),y="[object RegExp]",o=s(function(v){return!v||typeof v!="object"&&typeof v!="function"?!1:m(v)===y},"isRegex"));var l,u,c,p,m,y;e.exports=o}),sqe=bt((t,e)=>{N();var r=s(function(){return typeof s(function(){},"f").name=="string"},"functionsHaveNames"),i=Object.getOwnPropertyDescriptor;if(i)try{i([],"length")}catch{i=null}r.functionsHaveConfigurableNames=s(function(){if(!r()||!i)return!1;var a=i(function(){},"name");return!!a&&!!a.configurable},"functionsHaveConfigurableNames");var n=Function.prototype.bind;r.boundFunctionsHaveNames=s(function(){return r()&&typeof n=="function"&&s(function(){},"f").bind().name!==""},"boundFunctionsHaveNames"),e.exports=r}),lqe=bt((t,e)=>{N();var r=JB(),i=QB()(),n=sqe().functionsHaveConfigurableNames(),a=px();e.exports=s(function(o,l){if(typeof o!="function")throw new a("`fn` is not a function");var u=arguments.length>2&&!!arguments[2];return(!u||n)&&(i?r(o,"name",l,!0,!0):r(o,"name",l)),o},"setFunctionName")}),Yge=bt((t,e)=>{N();var r=lqe(),i=px(),n=Object;e.exports=r(s(function(){if(this==null||this!==n(this))throw new i("RegExp.prototype.flags getter called on non-object");var a="";return this.hasIndices&&(a+="d"),this.global&&(a+="g"),this.ignoreCase&&(a+="i"),this.multiline&&(a+="m"),this.dotAll&&(a+="s"),this.unicode&&(a+="u"),this.unicodeSets&&(a+="v"),this.sticky&&(a+="y"),a},"flags"),"get flags",!0)}),Kge=bt((t,e)=>{N();var r=Yge(),i=$A().supportsDescriptors,n=Object.getOwnPropertyDescriptor;e.exports=s(function(){if(i&&/a/mig.flags==="gim"){var a=n(RegExp.prototype,"flags");if(a&&typeof a.get=="function"&&"dotAll"in RegExp.prototype&&"hasIndices"in RegExp.prototype){var o="",l={};if(Object.defineProperty(l,"hasIndices",{get:s(function(){o+="d"},"get")}),Object.defineProperty(l,"sticky",{get:s(function(){o+="y"},"get")}),a.get.call(l),o==="dy")return a.get}}return r},"getPolyfill")}),uqe=bt((t,e)=>{N();var r=$A().supportsDescriptors,i=Kge(),n=dx(),a=Object.defineProperty,o=zge(),l=Gge(),u=/a/;e.exports=s(function(){if(!r||!l)throw new o("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var c=i(),p=l(u),m=n(p,"flags");return(!m||m.get!==c)&&a(p,"flags",{configurable:!0,enumerable:!1,get:c}),c},"shimFlags")}),cqe=bt((t,e)=>{N();var r=$A(),i=Wge(),n=Yge(),a=Kge(),o=uqe(),l=i(a());r(l,{getPolyfill:a,implementation:n,shim:o}),e.exports=l}),hqe=bt((t,e)=>{N();var r=KB(),i=r("Date.prototype.getDay"),n=s(function(u){try{return i(u),!0}catch{return!1}},"tryDateGetDayCall"),a=r("Object.prototype.toString"),o="[object Date]",l=WB()();e.exports=s(function(u){return typeof u!="object"||u===null?!1:l?n(u):a(u)===o},"isDateObject")}),Jge=bt((t,e)=>{N();var r=Nge(),i=tqe(),n=aqe(),a=oqe(),o=cqe(),l=hqe(),u=Date.prototype.getTime;function c(v,w,E){var M=E||{};return(M.strict?n(v,w):v===w)?!0:!v||!w||typeof v!="object"&&typeof w!="object"?M.strict?n(v,w):v==w:y(v,w,M)}s(c,"deepEqual");function p(v){return v==null}s(p,"isUndefinedOrNull");function m(v){return!(!v||typeof v!="object"||typeof v.length!="number"||typeof v.copy!="function"||typeof v.slice!="function"||v.length>0&&typeof v[0]!="number")}s(m,"isBuffer");function y(v,w,E){var M,I;if(typeof v!=typeof w||p(v)||p(w)||v.prototype!==w.prototype||i(v)!==i(w))return!1;var P=a(v),C=a(w);if(P!==C)return!1;if(P||C)return v.source===w.source&&o(v)===o(w);if(l(v)&&l(w))return u.call(v)===u.call(w);var T=m(v),O=m(w);if(T!==O)return!1;if(T||O){if(v.length!==w.length)return!1;for(M=0;M<v.length;M++)if(v[M]!==w[M])return!1;return!0}if(typeof v!=typeof w)return!1;try{var F=r(v),k=r(w)}catch{return!1}if(F.length!==k.length)return!1;for(F.sort(),k.sort(),M=F.length-1;M>=0;M--)if(F[M]!=k[M])return!1;for(M=F.length-1;M>=0;M--)if(I=F[M],!c(v[I],w[I],E))return!1;return!0}s(y,"objEquiv"),e.exports=c}),Qge=bt((t,e)=>{N();var r=Jge(),i=s(function(l){this.precision=l&&l.precision?l.precision:17,this.direction=l&&l.direction?l.direction:!1,this.pseudoNode=l&&l.pseudoNode?l.pseudoNode:!1,this.objectComparator=l&&l.objectComparator?l.objectComparator:o},"Equality");i.prototype.compare=function(l,u){if(l.type!==u.type||!a(l,u))return!1;switch(l.type){case"Point":return this.compareCoord(l.coordinates,u.coordinates);case"LineString":return this.compareLine(l.coordinates,u.coordinates,0,!1);case"Polygon":return this.comparePolygon(l,u);case"Feature":return this.compareFeature(l,u);default:if(l.type.indexOf("Multi")===0){var c=this,p=n(l),m=n(u);return p.every(function(y){return this.some(function(v){return c.compare(y,v)})},m)}}return!1};function n(l){return l.coordinates.map(function(u){return{type:l.type.replace("Multi",""),coordinates:u}})}s(n,"explode");function a(l,u){return l.hasOwnProperty("coordinates")?l.coordinates.length===u.coordinates.length:l.length===u.length}s(a,"sameLength"),i.prototype.compareCoord=function(l,u){if(l.length!==u.length)return!1;for(var c=0;c<l.length;c++)if(l[c].toFixed(this.precision)!==u[c].toFixed(this.precision))return!1;return!0},i.prototype.compareLine=function(l,u,c,p){if(!a(l,u))return!1;var m=this.pseudoNode?l:this.removePseudo(l),y=this.pseudoNode?u:this.removePseudo(u);if(!(p&&!this.compareCoord(m[0],y[0])&&(y=this.fixStartIndex(y,m),!y))){var v=this.compareCoord(m[c],y[c]);return this.direction||v?this.comparePath(m,y):this.compareCoord(m[c],y[y.length-(1+c)])?this.comparePath(m.slice().reverse(),y):!1}},i.prototype.fixStartIndex=function(l,u){for(var c,p=-1,m=0;m<l.length;m++)if(this.compareCoord(l[m],u[0])){p=m;break}return p>=0&&(c=[].concat(l.slice(p,l.length),l.slice(1,p+1))),c},i.prototype.comparePath=function(l,u){var c=this;return l.every(function(p,m){return c.compareCoord(p,this[m])},u)},i.prototype.comparePolygon=function(l,u){if(this.compareLine(l.coordinates[0],u.coordinates[0],1,!0)){var c=l.coordinates.slice(1,l.coordinates.length),p=u.coordinates.slice(1,u.coordinates.length),m=this;return c.every(function(y){return this.some(function(v){return m.compareLine(y,v,1,!0)})},p)}else return!1},i.prototype.compareFeature=function(l,u){return l.id!==u.id||!this.objectComparator(l.properties,u.properties)||!this.compareBBox(l,u)?!1:this.compare(l.geometry,u.geometry)},i.prototype.compareBBox=function(l,u){return!!(!l.bbox&&!u.bbox||l.bbox&&u.bbox&&this.compareCoord(l.bbox,u.bbox))},i.prototype.removePseudo=function(l){return l};function o(l,u){return r(l,u,{strict:!0})}s(o,"objectComparator"),e.exports=i}),pqe=bt((t,e)=>{N();function r(i,n,a,o){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(i,n,a,o)}s(r,"DBSCAN"),r.prototype.run=function(i,n,a,o){this._init(i,n,a,o);for(var l=0;l<this._datasetLength;l++)if(this._visited[l]!==1){this._visited[l]=1;var u=this._regionQuery(l);if(u.length<this.minPts)this.noise.push(l);else{var c=this.clusters.length;this.clusters.push([]),this._addToCluster(l,c),this._expandCluster(c,u)}}return this.clusters},r.prototype._init=function(i,n,a,o){if(i){if(!(i instanceof Array))throw Error("Dataset must be of type array, "+typeof i+" given");this.dataset=i,this.clusters=[],this.noise=[],this._datasetLength=i.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}n&&(this.epsilon=n),a&&(this.minPts=a),o&&(this.distance=o)},r.prototype._expandCluster=function(i,n){for(var a=0;a<n.length;a++){var o=n[a];if(this._visited[o]!==1){this._visited[o]=1;var l=this._regionQuery(o);l.length>=this.minPts&&(n=this._mergeArrays(n,l))}this._assigned[o]!==1&&this._addToCluster(o,i)}},r.prototype._addToCluster=function(i,n){this.clusters[n].push(i),this._assigned[i]=1},r.prototype._regionQuery=function(i){for(var n=[],a=0;a<this._datasetLength;a++){var o=this.distance(this.dataset[i],this.dataset[a]);o<this.epsilon&&n.push(a)}return n},r.prototype._mergeArrays=function(i,n){for(var a=n.length,o=0;o<a;o++){var l=n[o];i.indexOf(l)<0&&i.push(l)}return i},r.prototype._euclideanDistance=function(i,n){for(var a=0,o=Math.min(i.length,n.length);o--;)a+=(i[o]-n[o])*(i[o]-n[o]);return Math.sqrt(a)},typeof e<"u"&&e.exports&&(e.exports=r)}),dqe=bt((t,e)=>{N();function r(i,n,a){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(i,n,a)}s(r,"KMEANS"),r.prototype.init=function(i,n,a){this.assignments=[],this.centroids=[],typeof i<"u"&&(this.dataset=i),typeof n<"u"&&(this.k=n),typeof a<"u"&&(this.distance=a)},r.prototype.run=function(i,n){this.init(i,n);for(var a=this.dataset.length,o=0;o<this.k;o++)this.centroids[o]=this.randomCentroid();for(var l=!0;l;){l=this.assign();for(var u=0;u<this.k;u++){for(var c=new Array(v),p=0,m=0;m<v;m++)c[m]=0;for(var y=0;y<a;y++){var v=this.dataset[y].length;if(u===this.assignments[y]){for(var m=0;m<v;m++)c[m]+=this.dataset[y][m];p++}}if(p>0){for(var m=0;m<v;m++)c[m]/=p;this.centroids[u]=c}else this.centroids[u]=this.randomCentroid(),l=!0}}return this.getClusters()},r.prototype.randomCentroid=function(){var i=this.dataset.length-1,n,a;do a=Math.round(Math.random()*i),n=this.dataset[a];while(this.centroids.indexOf(n)>=0);return n},r.prototype.assign=function(){for(var i=!1,n=this.dataset.length,a,o=0;o<n;o++)a=this.argmin(this.dataset[o],this.centroids,this.distance),a!=this.assignments[o]&&(this.assignments[o]=a,i=!0);return i},r.prototype.getClusters=function(){for(var i=new Array(this.k),n,a=0;a<this.assignments.length;a++)n=this.assignments[a],typeof i[n]>"u"&&(i[n]=[]),i[n].push(a);return i},r.prototype.argmin=function(i,n,a){for(var o=Number.MAX_VALUE,l=0,u=n.length,c,p=0;p<u;p++)c=a(i,n[p]),c<o&&(o=c,l=p);return l},r.prototype.distance=function(i,n){for(var a=0,o=Math.min(i.length,n.length);o--;){var l=i[o]-n[o];a+=l*l}return Math.sqrt(a)},typeof e<"u"&&e.exports&&(e.exports=r)}),eye=bt((t,e)=>{N();function r(i,n,a){this._queue=[],this._priorities=[],this._sorting="desc",this._init(i,n,a)}s(r,"PriorityQueue"),r.prototype.insert=function(i,n){for(var a=this._queue.length,o=a;o--;){var l=this._priorities[o];this._sorting==="desc"?n>l&&(a=o):n<l&&(a=o)}this._insertAt(i,n,a)},r.prototype.remove=function(i){for(var n=this._queue.length;n--;){var a=this._queue[n];if(i===a){this._queue.splice(n,1),this._priorities.splice(n,1);break}}},r.prototype.forEach=function(i){this._queue.forEach(i)},r.prototype.getElements=function(){return this._queue},r.prototype.getElementPriority=function(i){return this._priorities[i]},r.prototype.getPriorities=function(){return this._priorities},r.prototype.getElementsWithPriorities=function(){for(var i=[],n=0,a=this._queue.length;n<a;n++)i.push([this._queue[n],this._priorities[n]]);return i},r.prototype._init=function(i,n,a){if(i&&n){if(this._queue=[],this._priorities=[],i.length!==n.length)throw new Error("Arrays must have the same length");for(var o=0;o<i.length;o++)this.insert(i[o],n[o])}a&&(this._sorting=a)},r.prototype._insertAt=function(i,n,a){this._queue.length===a?(this._queue.push(i),this._priorities.push(n)):(this._queue.splice(a,0,i),this._priorities.splice(a,0,n))},typeof e<"u"&&e.exports&&(e.exports=r)}),fqe=bt((t,e)=>{N(),typeof e<"u"&&e.exports&&(r=eye());var r;function i(n,a,o,l){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(n,a,o,l)}s(i,"OPTICS"),i.prototype.run=function(n,a,o,l){this._init(n,a,o,l);for(var u=0,c=this.dataset.length;u<c;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var p=this.clusters.length-1;this._orderedList.push(u);var m=new r(null,null,"asc"),y=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,y,m),this._expandCluster(p,m))}return this.clusters},i.prototype.getReachabilityPlot=function(){for(var n=[],a=0,o=this._orderedList.length;a<o;a++){var l=this._orderedList[a],u=this._reachability[l];n.push([l,u])}return n},i.prototype._init=function(n,a,o,l){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}a&&(this.epsilon=a),o&&(this.minPts=o),l&&(this.distance=l)},i.prototype._updateQueue=function(n,a,o){var l=this;this._coreDistance=this._distanceToCore(n),a.forEach(function(u){if(l._processed[u]===void 0){var c=l.distance(l.dataset[n],l.dataset[u]),p=Math.max(l._coreDistance,c);l._reachability[u]===void 0?(l._reachability[u]=p,o.insert(u,p)):p<l._reachability[u]&&(l._reachability[u]=p,o.remove(u),o.insert(u,p))}})},i.prototype._expandCluster=function(n,a){for(var o=a.getElements(),l=0,u=o.length;l<u;l++){var c=o[l];if(this._processed[c]===void 0){var p=this._regionQuery(c);this._processed[c]=1,this.clusters[n].push(c),this._orderedList.push(c),this._distanceToCore(c)!==void 0&&(this._updateQueue(c,p,a),this._expandCluster(n,a))}}},i.prototype._distanceToCore=function(n){for(var a=this.epsilon,o=0;o<a;o++){var l=this._regionQuery(n,o);if(l.length>=this.minPts)return o}},i.prototype._regionQuery=function(n,a){a=a||this.epsilon;for(var o=[],l=0,u=this.dataset.length;l<u;l++)this.distance(this.dataset[n],this.dataset[l])<a&&o.push(l);return o},i.prototype._euclideanDistance=function(n,a){for(var o=0,l=Math.min(n.length,a.length);l--;)o+=(n[l]-a[l])*(n[l]-a[l]);return Math.sqrt(o)},typeof e<"u"&&e.exports&&(e.exports=i)}),mqe=bt((t,e)=>{N(),typeof e<"u"&&e.exports&&(e.exports={DBSCAN:pqe(),KMEANS:dqe(),OPTICS:fqe(),PriorityQueue:eye()})}),tye=bt((t,e)=>{N(),e.exports={eudist:s(function(r,i,n){for(var a=r.length,o=0,l=0;l<a;l++){var u=(r[l]||0)-(i[l]||0);o+=u*u}return n?Math.sqrt(o):o},"eudist"),mandist:s(function(r,i,n){for(var a=r.length,o=0,l=0;l<a;l++)o+=Math.abs((r[l]||0)-(i[l]||0));return n?Math.sqrt(o):o},"mandist"),dist:s(function(r,i,n){var a=Math.abs(r-i);return n?a:a*a},"dist")}}),gqe=bt((t,e)=>{N();var r=tye(),i=r.eudist,n=r.dist;e.exports={kmrand:s(function(a,o){for(var l={},u=[],c=o<<2,p=a.length,m=a[0].length>0;u.length<o&&c-- >0;){var y=a[Math.floor(Math.random()*p)],v=m?y.join("_"):""+y;l[v]||(l[v]=!0,u.push(y))}if(u.length<o)throw new Error("Error initializating clusters");return u},"kmrand"),kmpp:s(function(a,o){var l=a[0].length?i:n,u=[],c=a.length,p=a[0].length>0,m=a[Math.floor(Math.random()*c)];for(p?m.join("_"):""+m,u.push(m),!0;u.length<o;){for(var y=[],v=u.length,w=0,E=[],M=0;M<c;M++){for(var I=1/0,P=0;P<v;P++){var C=l(a[M],u[P]);C<=I&&(I=C)}y[M]=I}for(var T=0;T<c;T++)w+=y[T];for(var O=0;O<c;O++)E[O]={i:O,v:a[O],pr:y[O]/w,cs:0};E.sort(function(U,z){return U.pr-z.pr}),E[0].cs=E[0].pr;for(var F=1;F<c;F++)E[F].cs=E[F-1].cs+E[F].pr;for(var k=Math.random(),B=0;B<c-1&&E[B++].cs<k;);u.push(E[B-1].v)}return u},"kmpp")}}),yqe=bt((t,e)=>{N();var r=tye(),i=gqe(),n=r.eudist;r.mandist,r.dist;var a=i.kmrand,o=i.kmpp,l=1e4;function u(p,m,y){y=y||[];for(var v=0;v<p;v++)y[v]=m;return y}s(u,"init");function c(p,m,y,v){var w=[],E=[],M=[],I=[],P=!1,C=v||l,T=p.length,O=p[0].length,F=O>0,k=[];if(y)y=="kmrand"?w=a(p,m):y=="kmpp"?w=o(p,m):w=y;else for(var B={};w.length<m;){var U=Math.floor(Math.random()*T);B[U]||(B[U]=!0,w.push(p[U]))}do{u(m,0,k);for(var z=0;z<T;z++){for(var q=1/0,W=0,J=0;J<m;J++){var I=F?n(p[z],w[J]):Math.abs(p[z]-w[J]);I<=q&&(q=I,W=J)}M[z]=W,k[W]++}for(var V=[],E=[],oe=0,Y=0;Y<m;Y++)V[Y]=F?u(O,0,V[Y]):0,E[Y]=w[Y];if(F){for(var he=0;he<m;he++)w[he]=[];for(var Q=0;Q<T;Q++)for(var ae=M[Q],ee=V[ae],le=p[Q],K=0;K<O;K++)ee[K]+=le[K];P=!0;for(var ce=0;ce<m;ce++){for(var te=w[ce],ne=V[ce],pe=E[ce],xe=k[ce],Te=0;Te<O;Te++)te[Te]=ne[Te]/xe||0;if(P){for(var fe=0;fe<O;fe++)if(pe[fe]!=te[fe]){P=!1;break}}}}else{for(var Pe=0;Pe<T;Pe++){var me=M[Pe];V[me]+=p[Pe]}for(var Ae=0;Ae<m;Ae++)w[Ae]=V[Ae]/k[Ae]||0;P=!0;for(var Ue=0;Ue<m;Ue++)if(E[Ue]!=w[Ue]){P=!1;break}}P=P||--C<=0}while(!P);return{it:l-C,k:m,idxs:M,centroids:w}}s(c,"skmeans"),e.exports=c}),GA=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(r=typeof globalThis<"u"?globalThis:r||self,r.polygonClipping=i())}(t,function(){function r(Oe,se){var ue={label:0,sent:s(function(){if(Re[0]&1)throw Re[1];return Re[1]},"sent"),trys:[],ops:[]},Se,ze,Re,yt;return yt={next:st(0),throw:st(1),return:st(2)},typeof Symbol=="function"&&(yt[Symbol.iterator]=function(){return this}),yt;function st(mt){return function(Gt){return kt([mt,Gt])}}function kt(mt){if(Se)throw new TypeError("Generator is already executing.");for(;ue;)try{if(Se=1,ze&&(Re=mt[0]&2?ze.return:mt[0]?ze.throw||((Re=ze.return)&&Re.call(ze),0):ze.next)&&!(Re=Re.call(ze,mt[1])).done)return Re;switch(ze=0,Re&&(mt=[mt[0]&2,Re.value]),mt[0]){case 0:case 1:Re=mt;break;case 4:return ue.label++,{value:mt[1],done:!1};case 5:ue.label++,ze=mt[1],mt=[0];continue;case 7:mt=ue.ops.pop(),ue.trys.pop();continue;default:if(Re=ue.trys,!(Re=Re.length>0&&Re[Re.length-1])&&(mt[0]===6||mt[0]===2)){ue=0;continue}if(mt[0]===3&&(!Re||mt[1]>Re[0]&&mt[1]<Re[3])){ue.label=mt[1];break}if(mt[0]===6&&ue.label<Re[1]){ue.label=Re[1],Re=mt;break}if(Re&&ue.label<Re[2]){ue.label=Re[2],ue.ops.push(mt);break}Re[2]&&ue.ops.pop(),ue.trys.pop();continue}mt=se.call(Oe,ue)}catch(Gt){mt=[6,Gt],ze=0}finally{Se=Re=0}if(mt[0]&5)throw mt[1];return{value:mt[0]?mt[1]:void 0,done:!0}}}s(r,"__generator");var i=function(){function Oe(se,ue){this.next=null,this.key=se,this.data=ue,this.left=null,this.right=null}return s(Oe,"Node"),Oe}();function n(Oe,se){return Oe>se?1:Oe<se?-1:0}s(n,"DEFAULT_COMPARE");function a(Oe,se,ue){for(var Se=new i(null,null),ze=Se,Re=Se;;){var yt=ue(Oe,se.key);if(yt<0){if(se.left===null)break;if(ue(Oe,se.left.key)<0){var st=se.left;if(se.left=st.right,st.right=se,se=st,se.left===null)break}Re.left=se,Re=se,se=se.left}else if(yt>0){if(se.right===null)break;if(ue(Oe,se.right.key)>0){var st=se.right;if(se.right=st.left,st.left=se,se=st,se.right===null)break}ze.right=se,ze=se,se=se.right}else break}return ze.right=se.left,Re.left=se.right,se.left=Se.right,se.right=Se.left,se}s(a,"splay");function o(Oe,se,ue,Se){var ze=new i(Oe,se);if(ue===null)return ze.left=ze.right=null,ze;ue=a(Oe,ue,Se);var Re=Se(Oe,ue.key);return Re<0?(ze.left=ue.left,ze.right=ue,ue.left=null):Re>=0&&(ze.right=ue.right,ze.left=ue,ue.right=null),ze}s(o,"insert");function l(Oe,se,ue){var Se=null,ze=null;if(se){se=a(Oe,se,ue);var Re=ue(se.key,Oe);Re===0?(Se=se.left,ze=se.right):Re<0?(ze=se.right,se.right=null,Se=se):(Se=se.left,se.left=null,ze=se)}return{left:Se,right:ze}}s(l,"split");function u(Oe,se,ue){return se===null?Oe:(Oe===null||(se=a(Oe.key,se,ue),se.left=Oe),se)}s(u,"merge");function c(Oe,se,ue,Se,ze){if(Oe){Se(""+se+(ue?" ":" ")+ze(Oe)+`
`);var Re=se+(ue?"    ":"   ");Oe.left&&c(Oe.left,Re,!1,Se,ze),Oe.right&&c(Oe.right,Re,!0,Se,ze)}}s(c,"printRow");var p=function(){function Oe(se){se===void 0&&(se=n),this._root=null,this._size=0,this._comparator=se}return s(Oe,"Tree"),Oe.prototype.insert=function(se,ue){return this._size++,this._root=o(se,ue,this._root,this._comparator)},Oe.prototype.add=function(se,ue){var Se=new i(se,ue);this._root===null&&(Se.left=Se.right=null,this._size++,this._root=Se);var ze=this._comparator,Re=a(se,this._root,ze),yt=ze(se,Re.key);return yt===0?this._root=Re:(yt<0?(Se.left=Re.left,Se.right=Re,Re.left=null):yt>0&&(Se.right=Re.right,Se.left=Re,Re.right=null),this._size++,this._root=Se),this._root},Oe.prototype.remove=function(se){this._root=this._remove(se,this._root,this._comparator)},Oe.prototype._remove=function(se,ue,Se){var ze;if(ue===null)return null;ue=a(se,ue,Se);var Re=Se(se,ue.key);return Re===0?(ue.left===null?ze=ue.right:(ze=a(se,ue.left,Se),ze.right=ue.right),this._size--,ze):ue},Oe.prototype.pop=function(){var se=this._root;if(se){for(;se.left;)se=se.left;return this._root=a(se.key,this._root,this._comparator),this._root=this._remove(se.key,this._root,this._comparator),{key:se.key,data:se.data}}return null},Oe.prototype.findStatic=function(se){for(var ue=this._root,Se=this._comparator;ue;){var ze=Se(se,ue.key);if(ze===0)return ue;ze<0?ue=ue.left:ue=ue.right}return null},Oe.prototype.find=function(se){return this._root&&(this._root=a(se,this._root,this._comparator),this._comparator(se,this._root.key)!==0)?null:this._root},Oe.prototype.contains=function(se){for(var ue=this._root,Se=this._comparator;ue;){var ze=Se(se,ue.key);if(ze===0)return!0;ze<0?ue=ue.left:ue=ue.right}return!1},Oe.prototype.forEach=function(se,ue){for(var Se=this._root,ze=[],Re=!1;!Re;)Se!==null?(ze.push(Se),Se=Se.left):ze.length!==0?(Se=ze.pop(),se.call(ue,Se),Se=Se.right):Re=!0;return this},Oe.prototype.range=function(se,ue,Se,ze){for(var Re=[],yt=this._comparator,st=this._root,kt;Re.length!==0||st;)if(st)Re.push(st),st=st.left;else{if(st=Re.pop(),kt=yt(st.key,ue),kt>0)break;if(yt(st.key,se)>=0&&Se.call(ze,st))return this;st=st.right}return this},Oe.prototype.keys=function(){var se=[];return this.forEach(function(ue){var Se=ue.key;return se.push(Se)}),se},Oe.prototype.values=function(){var se=[];return this.forEach(function(ue){var Se=ue.data;return se.push(Se)}),se},Oe.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Oe.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Oe.prototype.minNode=function(se){if(se===void 0&&(se=this._root),se)for(;se.left;)se=se.left;return se},Oe.prototype.maxNode=function(se){if(se===void 0&&(se=this._root),se)for(;se.right;)se=se.right;return se},Oe.prototype.at=function(se){for(var ue=this._root,Se=!1,ze=0,Re=[];!Se;)if(ue)Re.push(ue),ue=ue.left;else if(Re.length>0){if(ue=Re.pop(),ze===se)return ue;ze++,ue=ue.right}else Se=!0;return null},Oe.prototype.next=function(se){var ue=this._root,Se=null;if(se.right){for(Se=se.right;Se.left;)Se=Se.left;return Se}for(var ze=this._comparator;ue;){var Re=ze(se.key,ue.key);if(Re===0)break;Re<0?(Se=ue,ue=ue.left):ue=ue.right}return Se},Oe.prototype.prev=function(se){var ue=this._root,Se=null;if(se.left!==null){for(Se=se.left;Se.right;)Se=Se.right;return Se}for(var ze=this._comparator;ue;){var Re=ze(se.key,ue.key);if(Re===0)break;Re<0?ue=ue.left:(Se=ue,ue=ue.right)}return Se},Oe.prototype.clear=function(){return this._root=null,this._size=0,this},Oe.prototype.toList=function(){return v(this._root)},Oe.prototype.load=function(se,ue,Se){ue===void 0&&(ue=[]),Se===void 0&&(Se=!1);var ze=se.length,Re=this._comparator;if(Se&&M(se,ue,0,ze-1,Re),this._root===null)this._root=m(se,ue,0,ze),this._size=ze;else{var yt=E(this.toList(),y(se,ue),Re);ze=this._size+ze,this._root=w({head:yt},0,ze)}return this},Oe.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Oe.prototype,"size",{get:s(function(){return this._size},"get"),enumerable:!0,configurable:!0}),Object.defineProperty(Oe.prototype,"root",{get:s(function(){return this._root},"get"),enumerable:!0,configurable:!0}),Oe.prototype.toString=function(se){se===void 0&&(se=s(function(Se){return String(Se.key)},"printNode"));var ue=[];return c(this._root,"",!0,function(Se){return ue.push(Se)},se),ue.join("")},Oe.prototype.update=function(se,ue,Se){var ze=this._comparator,Re=l(se,this._root,ze),yt=Re.left,st=Re.right;ze(se,ue)<0?st=o(ue,Se,st,ze):yt=o(ue,Se,yt,ze),this._root=u(yt,st,ze)},Oe.prototype.split=function(se){return l(se,this._root,this._comparator)},Oe.prototype[Symbol.iterator]=function(){var se,ue,Se;return r(this,function(ze){switch(ze.label){case 0:se=this._root,ue=[],Se=!1,ze.label=1;case 1:return Se?[3,6]:se===null?[3,2]:(ue.push(se),se=se.left,[3,5]);case 2:return ue.length===0?[3,4]:(se=ue.pop(),[4,se]);case 3:return ze.sent(),se=se.right,[3,5];case 4:Se=!0,ze.label=5;case 5:return[3,1];case 6:return[2]}})},Oe}();function m(Oe,se,ue,Se){var ze=Se-ue;if(ze>0){var Re=ue+Math.floor(ze/2),yt=Oe[Re],st=se[Re],kt=new i(yt,st);return kt.left=m(Oe,se,ue,Re),kt.right=m(Oe,se,Re+1,Se),kt}return null}s(m,"loadRecursive");function y(Oe,se){for(var ue=new i(null,null),Se=ue,ze=0;ze<Oe.length;ze++)Se=Se.next=new i(Oe[ze],se[ze]);return Se.next=null,ue.next}s(y,"createList");function v(Oe){for(var se=Oe,ue=[],Se=!1,ze=new i(null,null),Re=ze;!Se;)se?(ue.push(se),se=se.left):ue.length>0?(se=Re=Re.next=ue.pop(),se=se.right):Se=!0;return Re.next=null,ze.next}s(v,"toList");function w(Oe,se,ue){var Se=ue-se;if(Se>0){var ze=se+Math.floor(Se/2),Re=w(Oe,se,ze),yt=Oe.head;return yt.left=Re,Oe.head=Oe.head.next,yt.right=w(Oe,ze+1,ue),yt}return null}s(w,"sortedListToBST");function E(Oe,se,ue){for(var Se=new i(null,null),ze=Se,Re=Oe,yt=se;Re!==null&&yt!==null;)ue(Re.key,yt.key)<0?(ze.next=Re,Re=Re.next):(ze.next=yt,yt=yt.next),ze=ze.next;return Re!==null?ze.next=Re:yt!==null&&(ze.next=yt),Se.next}s(E,"mergeLists");function M(Oe,se,ue,Se,ze){if(!(ue>=Se)){for(var Re=Oe[ue+Se>>1],yt=ue-1,st=Se+1;;){do yt++;while(ze(Oe[yt],Re)<0);do st--;while(ze(Oe[st],Re)>0);if(yt>=st)break;var kt=Oe[yt];Oe[yt]=Oe[st],Oe[st]=kt,kt=se[yt],se[yt]=se[st],se[st]=kt}M(Oe,se,ue,st,ze),M(Oe,se,st+1,Se,ze)}}s(M,"sort");let I=s((Oe,se)=>Oe.ll.x<=se.x&&se.x<=Oe.ur.x&&Oe.ll.y<=se.y&&se.y<=Oe.ur.y,"isInBbox"),P=s((Oe,se)=>{if(se.ur.x<Oe.ll.x||Oe.ur.x<se.ll.x||se.ur.y<Oe.ll.y||Oe.ur.y<se.ll.y)return null;let ue=Oe.ll.x<se.ll.x?se.ll.x:Oe.ll.x,Se=Oe.ur.x<se.ur.x?Oe.ur.x:se.ur.x,ze=Oe.ll.y<se.ll.y?se.ll.y:Oe.ll.y,Re=Oe.ur.y<se.ur.y?Oe.ur.y:se.ur.y;return{ll:{x:ue,y:ze},ur:{x:Se,y:Re}}},"getBboxOverlap"),C=Number.EPSILON;C===void 0&&(C=Math.pow(2,-52));let T=C*C,O=s((Oe,se)=>{if(-C<Oe&&Oe<C&&-C<se&&se<C)return 0;let ue=Oe-se;return ue*ue<T*Oe*se?0:Oe<se?-1:1},"cmp"),F=class{constructor(){this.reset()}reset(){this.xRounder=new U,this.yRounder=new U}round(se,ue){return{x:this.xRounder.round(se),y:this.yRounder.round(ue)}}};s(F,"PtRounder");let k=F,B=class{constructor(){this.tree=new p,this.round(0)}round(se){let ue=this.tree.add(se),Se=this.tree.prev(ue);if(Se!==null&&O(ue.key,Se.key)===0)return this.tree.remove(se),Se.key;let ze=this.tree.next(ue);return ze!==null&&O(ue.key,ze.key)===0?(this.tree.remove(se),ze.key):se}};s(B,"CoordRounder");let U=B,z=new k,q=11102230246251565e-32,W=134217729,J=(3+8*q)*q;function V(Oe,se,ue,Se,ze){let Re,yt,st,kt,mt=se[0],Gt=Se[0],ke=0,$e=0;Gt>mt==Gt>-mt?(Re=mt,mt=se[++ke]):(Re=Gt,Gt=Se[++$e]);let ot=0;if(ke<Oe&&$e<ue)for(Gt>mt==Gt>-mt?(yt=mt+Re,st=Re-(yt-mt),mt=se[++ke]):(yt=Gt+Re,st=Re-(yt-Gt),Gt=Se[++$e]),Re=yt,st!==0&&(ze[ot++]=st);ke<Oe&&$e<ue;)Gt>mt==Gt>-mt?(yt=Re+mt,kt=yt-Re,st=Re-(yt-kt)+(mt-kt),mt=se[++ke]):(yt=Re+Gt,kt=yt-Re,st=Re-(yt-kt)+(Gt-kt),Gt=Se[++$e]),Re=yt,st!==0&&(ze[ot++]=st);for(;ke<Oe;)yt=Re+mt,kt=yt-Re,st=Re-(yt-kt)+(mt-kt),mt=se[++ke],Re=yt,st!==0&&(ze[ot++]=st);for(;$e<ue;)yt=Re+Gt,kt=yt-Re,st=Re-(yt-kt)+(Gt-kt),Gt=Se[++$e],Re=yt,st!==0&&(ze[ot++]=st);return(Re!==0||ot===0)&&(ze[ot++]=Re),ot}s(V,"sum");function oe(Oe,se){let ue=se[0];for(let Se=1;Se<Oe;Se++)ue+=se[Se];return ue}s(oe,"estimate");function Y(Oe){return new Float64Array(Oe)}s(Y,"vec");let he=(3+16*q)*q,Q=(2+12*q)*q,ae=(9+64*q)*q*q,ee=Y(4),le=Y(8),K=Y(12),ce=Y(16),te=Y(4);function ne(Oe,se,ue,Se,ze,Re,yt){let st,kt,mt,Gt,ke,$e,ot,Ft,Ht,fr,nr,Kr,ai,Jr,Cr,Ei,Hr,en,Hi=Oe-ze,En=ue-ze,Ie=se-Re,Je=Se-Re;Jr=Hi*Je,$e=W*Hi,ot=$e-($e-Hi),Ft=Hi-ot,$e=W*Je,Ht=$e-($e-Je),fr=Je-Ht,Cr=Ft*fr-(Jr-ot*Ht-Ft*Ht-ot*fr),Ei=Ie*En,$e=W*Ie,ot=$e-($e-Ie),Ft=Ie-ot,$e=W*En,Ht=$e-($e-En),fr=En-Ht,Hr=Ft*fr-(Ei-ot*Ht-Ft*Ht-ot*fr),nr=Cr-Hr,ke=Cr-nr,ee[0]=Cr-(nr+ke)+(ke-Hr),Kr=Jr+nr,ke=Kr-Jr,ai=Jr-(Kr-ke)+(nr-ke),nr=ai-Ei,ke=ai-nr,ee[1]=ai-(nr+ke)+(ke-Ei),en=Kr+nr,ke=en-Kr,ee[2]=Kr-(en-ke)+(nr-ke),ee[3]=en;let wt=oe(4,ee),ft=Q*yt;if(wt>=ft||-wt>=ft||(ke=Oe-Hi,st=Oe-(Hi+ke)+(ke-ze),ke=ue-En,mt=ue-(En+ke)+(ke-ze),ke=se-Ie,kt=se-(Ie+ke)+(ke-Re),ke=Se-Je,Gt=Se-(Je+ke)+(ke-Re),st===0&&kt===0&&mt===0&&Gt===0)||(ft=ae*yt+J*Math.abs(wt),wt+=Hi*Gt+Je*st-(Ie*mt+En*kt),wt>=ft||-wt>=ft))return wt;Jr=st*Je,$e=W*st,ot=$e-($e-st),Ft=st-ot,$e=W*Je,Ht=$e-($e-Je),fr=Je-Ht,Cr=Ft*fr-(Jr-ot*Ht-Ft*Ht-ot*fr),Ei=kt*En,$e=W*kt,ot=$e-($e-kt),Ft=kt-ot,$e=W*En,Ht=$e-($e-En),fr=En-Ht,Hr=Ft*fr-(Ei-ot*Ht-Ft*Ht-ot*fr),nr=Cr-Hr,ke=Cr-nr,te[0]=Cr-(nr+ke)+(ke-Hr),Kr=Jr+nr,ke=Kr-Jr,ai=Jr-(Kr-ke)+(nr-ke),nr=ai-Ei,ke=ai-nr,te[1]=ai-(nr+ke)+(ke-Ei),en=Kr+nr,ke=en-Kr,te[2]=Kr-(en-ke)+(nr-ke),te[3]=en;let rt=V(4,ee,4,te,le);Jr=Hi*Gt,$e=W*Hi,ot=$e-($e-Hi),Ft=Hi-ot,$e=W*Gt,Ht=$e-($e-Gt),fr=Gt-Ht,Cr=Ft*fr-(Jr-ot*Ht-Ft*Ht-ot*fr),Ei=Ie*mt,$e=W*Ie,ot=$e-($e-Ie),Ft=Ie-ot,$e=W*mt,Ht=$e-($e-mt),fr=mt-Ht,Hr=Ft*fr-(Ei-ot*Ht-Ft*Ht-ot*fr),nr=Cr-Hr,ke=Cr-nr,te[0]=Cr-(nr+ke)+(ke-Hr),Kr=Jr+nr,ke=Kr-Jr,ai=Jr-(Kr-ke)+(nr-ke),nr=ai-Ei,ke=ai-nr,te[1]=ai-(nr+ke)+(ke-Ei),en=Kr+nr,ke=en-Kr,te[2]=Kr-(en-ke)+(nr-ke),te[3]=en;let zt=V(rt,le,4,te,K);Jr=st*Gt,$e=W*st,ot=$e-($e-st),Ft=st-ot,$e=W*Gt,Ht=$e-($e-Gt),fr=Gt-Ht,Cr=Ft*fr-(Jr-ot*Ht-Ft*Ht-ot*fr),Ei=kt*mt,$e=W*kt,ot=$e-($e-kt),Ft=kt-ot,$e=W*mt,Ht=$e-($e-mt),fr=mt-Ht,Hr=Ft*fr-(Ei-ot*Ht-Ft*Ht-ot*fr),nr=Cr-Hr,ke=Cr-nr,te[0]=Cr-(nr+ke)+(ke-Hr),Kr=Jr+nr,ke=Kr-Jr,ai=Jr-(Kr-ke)+(nr-ke),nr=ai-Ei,ke=ai-nr,te[1]=ai-(nr+ke)+(ke-Ei),en=Kr+nr,ke=en-Kr,te[2]=Kr-(en-ke)+(nr-ke),te[3]=en;let cr=V(zt,K,4,te,ce);return ce[cr-1]}s(ne,"orient2dadapt");function pe(Oe,se,ue,Se,ze,Re){let yt=(se-Re)*(ue-ze),st=(Oe-ze)*(Se-Re),kt=yt-st,mt=Math.abs(yt+st);return Math.abs(kt)>=he*mt?kt:-ne(Oe,se,ue,Se,ze,Re,mt)}s(pe,"orient2d");let xe=s((Oe,se)=>Oe.x*se.y-Oe.y*se.x,"crossProduct"),Te=s((Oe,se)=>Oe.x*se.x+Oe.y*se.y,"dotProduct"),fe=s((Oe,se,ue)=>{let Se=pe(Oe.x,Oe.y,se.x,se.y,ue.x,ue.y);return Se>0?-1:Se<0?1:0},"compareVectorAngles"),Pe=s(Oe=>Math.sqrt(Te(Oe,Oe)),"length"),me=s((Oe,se,ue)=>{let Se={x:se.x-Oe.x,y:se.y-Oe.y},ze={x:ue.x-Oe.x,y:ue.y-Oe.y};return xe(ze,Se)/Pe(ze)/Pe(Se)},"sineOfAngle"),Ae=s((Oe,se,ue)=>{let Se={x:se.x-Oe.x,y:se.y-Oe.y},ze={x:ue.x-Oe.x,y:ue.y-Oe.y};return Te(ze,Se)/Pe(ze)/Pe(Se)},"cosineOfAngle"),Ue=s((Oe,se,ue)=>se.y===0?null:{x:Oe.x+se.x/se.y*(ue-Oe.y),y:ue},"horizontalIntersection"),_e=s((Oe,se,ue)=>se.x===0?null:{x:ue,y:Oe.y+se.y/se.x*(ue-Oe.x)},"verticalIntersection"),lt=s((Oe,se,ue,Se)=>{if(se.x===0)return _e(ue,Se,Oe.x);if(Se.x===0)return _e(Oe,se,ue.x);if(se.y===0)return Ue(ue,Se,Oe.y);if(Se.y===0)return Ue(Oe,se,ue.y);let ze=xe(se,Se);if(ze==0)return null;let Re={x:ue.x-Oe.x,y:ue.y-Oe.y},yt=xe(Re,se)/ze,st=xe(Re,Se)/ze,kt=Oe.x+st*se.x,mt=ue.x+yt*Se.x,Gt=Oe.y+st*se.y,ke=ue.y+yt*Se.y,$e=(kt+mt)/2,ot=(Gt+ke)/2;return{x:$e,y:ot}},"intersection$1"),tt=class rye{static compare(se,ue){let Se=rye.comparePoints(se.point,ue.point);return Se!==0?Se:(se.point!==ue.point&&se.link(ue),se.isLeft!==ue.isLeft?se.isLeft?1:-1:dt.compare(se.segment,ue.segment))}static comparePoints(se,ue){return se.x<ue.x?-1:se.x>ue.x?1:se.y<ue.y?-1:se.y>ue.y?1:0}constructor(se,ue){se.events===void 0?se.events=[this]:se.events.push(this),this.point=se,this.isLeft=ue}link(se){if(se.point===this.point)throw new Error("Tried to link already linked events");let ue=se.point.events;for(let Se=0,ze=ue.length;Se<ze;Se++){let Re=ue[Se];this.point.events.push(Re),Re.point=this.point}this.checkForConsuming()}checkForConsuming(){let se=this.point.events.length;for(let ue=0;ue<se;ue++){let Se=this.point.events[ue];if(Se.segment.consumedBy===void 0)for(let ze=ue+1;ze<se;ze++){let Re=this.point.events[ze];Re.consumedBy===void 0&&Se.otherSE.point.events===Re.otherSE.point.events&&Se.segment.consume(Re.segment)}}}getAvailableLinkedEvents(){let se=[];for(let ue=0,Se=this.point.events.length;ue<Se;ue++){let ze=this.point.events[ue];ze!==this&&!ze.segment.ringOut&&ze.segment.isInResult()&&se.push(ze)}return se}getLeftmostComparator(se){let ue=new Map,Se=s(ze=>{let Re=ze.otherSE;ue.set(ze,{sine:me(this.point,se.point,Re.point),cosine:Ae(this.point,se.point,Re.point)})},"fillCache");return(ze,Re)=>{ue.has(ze)||Se(ze),ue.has(Re)||Se(Re);let{sine:yt,cosine:st}=ue.get(ze),{sine:kt,cosine:mt}=ue.get(Re);return yt>=0&&kt>=0?st<mt?1:st>mt?-1:0:yt<0&&kt<0?st<mt?-1:st>mt?1:0:kt<yt?-1:kt>yt?1:0}}};s(tt,"SweepEvent");let We=tt,at=0,Lt=class dC{static compare(se,ue){let Se=se.leftSE.point.x,ze=ue.leftSE.point.x,Re=se.rightSE.point.x,yt=ue.rightSE.point.x;if(yt<Se)return 1;if(Re<ze)return-1;let st=se.leftSE.point.y,kt=ue.leftSE.point.y,mt=se.rightSE.point.y,Gt=ue.rightSE.point.y;if(Se<ze){if(kt<st&&kt<mt)return 1;if(kt>st&&kt>mt)return-1;let ke=se.comparePoint(ue.leftSE.point);if(ke<0)return 1;if(ke>0)return-1;let $e=ue.comparePoint(se.rightSE.point);return $e!==0?$e:-1}if(Se>ze){if(st<kt&&st<Gt)return-1;if(st>kt&&st>Gt)return 1;let ke=ue.comparePoint(se.leftSE.point);if(ke!==0)return ke;let $e=se.comparePoint(ue.rightSE.point);return $e<0?1:$e>0?-1:1}if(st<kt)return-1;if(st>kt)return 1;if(Re<yt){let ke=ue.comparePoint(se.rightSE.point);if(ke!==0)return ke}if(Re>yt){let ke=se.comparePoint(ue.rightSE.point);if(ke<0)return 1;if(ke>0)return-1}if(Re!==yt){let ke=mt-st,$e=Re-Se,ot=Gt-kt,Ft=yt-ze;if(ke>$e&&ot<Ft)return 1;if(ke<$e&&ot>Ft)return-1}return Re>yt?1:Re<yt||mt<Gt?-1:mt>Gt?1:se.id<ue.id?-1:se.id>ue.id?1:0}constructor(se,ue,Se,ze){this.id=++at,this.leftSE=se,se.segment=this,se.otherSE=ue,this.rightSE=ue,ue.segment=this,ue.otherSE=se,this.rings=Se,this.windings=ze}static fromRing(se,ue,Se){let ze,Re,yt,st=We.comparePoints(se,ue);if(st<0)ze=se,Re=ue,yt=1;else if(st>0)ze=ue,Re=se,yt=-1;else throw new Error("Tried to create degenerate segment at [".concat(se.x,", ").concat(se.y,"]"));let kt=new We(ze,!0),mt=new We(Re,!1);return new dC(kt,mt,[Se],[yt])}replaceRightSE(se){this.rightSE=se,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let se=this.leftSE.point.y,ue=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:se<ue?se:ue},ur:{x:this.rightSE.point.x,y:se>ue?se:ue}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(se){return se.x===this.leftSE.point.x&&se.y===this.leftSE.point.y||se.x===this.rightSE.point.x&&se.y===this.rightSE.point.y}comparePoint(se){if(this.isAnEndpoint(se))return 0;let ue=this.leftSE.point,Se=this.rightSE.point,ze=this.vector();if(ue.x===Se.x)return se.x===ue.x?0:se.x<ue.x?1:-1;let Re=(se.y-ue.y)/ze.y,yt=ue.x+Re*ze.x;if(se.x===yt)return 0;let st=(se.x-ue.x)/ze.x,kt=ue.y+st*ze.y;return se.y===kt?0:se.y<kt?-1:1}getIntersection(se){let ue=this.bbox(),Se=se.bbox(),ze=P(ue,Se);if(ze===null)return null;let Re=this.leftSE.point,yt=this.rightSE.point,st=se.leftSE.point,kt=se.rightSE.point,mt=I(ue,st)&&this.comparePoint(st)===0,Gt=I(Se,Re)&&se.comparePoint(Re)===0,ke=I(ue,kt)&&this.comparePoint(kt)===0,$e=I(Se,yt)&&se.comparePoint(yt)===0;if(Gt&&mt)return $e&&!ke?yt:!$e&&ke?kt:null;if(Gt)return ke&&Re.x===kt.x&&Re.y===kt.y?null:Re;if(mt)return $e&&yt.x===st.x&&yt.y===st.y?null:st;if($e&&ke)return null;if($e)return yt;if(ke)return kt;let ot=lt(Re,this.vector(),st,se.vector());return ot===null||!I(ze,ot)?null:z.round(ot.x,ot.y)}split(se){let ue=[],Se=se.events!==void 0,ze=new We(se,!0),Re=new We(se,!1),yt=this.rightSE;this.replaceRightSE(Re),ue.push(Re),ue.push(ze);let st=new dC(ze,yt,this.rings.slice(),this.windings.slice());return We.comparePoints(st.leftSE.point,st.rightSE.point)>0&&st.swapEvents(),We.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Se&&(ze.checkForConsuming(),Re.checkForConsuming()),ue}swapEvents(){let se=this.rightSE;this.rightSE=this.leftSE,this.leftSE=se,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let ue=0,Se=this.windings.length;ue<Se;ue++)this.windings[ue]*=-1}consume(se){let ue=this,Se=se;for(;ue.consumedBy;)ue=ue.consumedBy;for(;Se.consumedBy;)Se=Se.consumedBy;let ze=dC.compare(ue,Se);if(ze!==0){if(ze>0){let Re=ue;ue=Se,Se=Re}if(ue.prev===Se){let Re=ue;ue=Se,Se=Re}for(let Re=0,yt=Se.rings.length;Re<yt;Re++){let st=Se.rings[Re],kt=Se.windings[Re],mt=ue.rings.indexOf(st);mt===-1?(ue.rings.push(st),ue.windings.push(kt)):ue.windings[mt]+=kt}Se.rings=null,Se.windings=null,Se.consumedBy=ue,Se.leftSE.consumedBy=ue.leftSE,Se.rightSE.consumedBy=ue.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let se=this.prev.consumedBy||this.prev;this._beforeState=se.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let se=this.beforeState();this._afterState={rings:se.rings.slice(0),windings:se.windings.slice(0),multiPolys:[]};let ue=this._afterState.rings,Se=this._afterState.windings,ze=this._afterState.multiPolys;for(let st=0,kt=this.rings.length;st<kt;st++){let mt=this.rings[st],Gt=this.windings[st],ke=ue.indexOf(mt);ke===-1?(ue.push(mt),Se.push(Gt)):Se[ke]+=Gt}let Re=[],yt=[];for(let st=0,kt=ue.length;st<kt;st++){if(Se[st]===0)continue;let mt=ue[st],Gt=mt.poly;if(yt.indexOf(Gt)===-1)if(mt.isExterior)Re.push(Gt);else{yt.indexOf(Gt)===-1&&yt.push(Gt);let ke=Re.indexOf(mt.poly);ke!==-1&&Re.splice(ke,1)}}for(let st=0,kt=Re.length;st<kt;st++){let mt=Re[st].multiPoly;ze.indexOf(mt)===-1&&ze.push(mt)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let se=this.beforeState().multiPolys,ue=this.afterState().multiPolys;switch(Qe.type){case"union":{let Se=se.length===0,ze=ue.length===0;this._isInResult=Se!==ze;break}case"intersection":{let Se,ze;se.length<ue.length?(Se=se.length,ze=ue.length):(Se=ue.length,ze=se.length),this._isInResult=ze===Qe.numMultiPolys&&Se<ze;break}case"xor":{let Se=Math.abs(se.length-ue.length);this._isInResult=Se%2===1;break}case"difference":{let Se=s(ze=>ze.length===1&&ze[0].isSubject,"isJustSubject");this._isInResult=Se(se)!==Se(ue);break}default:throw new Error("Unrecognized operation type found ".concat(Qe.type))}return this._isInResult}};s(Lt,"Segment");let dt=Lt,Me=class{constructor(se,ue,Se){if(!Array.isArray(se)||se.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=ue,this.isExterior=Se,this.segments=[],typeof se[0][0]!="number"||typeof se[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let ze=z.round(se[0][0],se[0][1]);this.bbox={ll:{x:ze.x,y:ze.y},ur:{x:ze.x,y:ze.y}};let Re=ze;for(let yt=1,st=se.length;yt<st;yt++){if(typeof se[yt][0]!="number"||typeof se[yt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let kt=z.round(se[yt][0],se[yt][1]);kt.x===Re.x&&kt.y===Re.y||(this.segments.push(dt.fromRing(Re,kt,this)),kt.x<this.bbox.ll.x&&(this.bbox.ll.x=kt.x),kt.y<this.bbox.ll.y&&(this.bbox.ll.y=kt.y),kt.x>this.bbox.ur.x&&(this.bbox.ur.x=kt.x),kt.y>this.bbox.ur.y&&(this.bbox.ur.y=kt.y),Re=kt)}(ze.x!==Re.x||ze.y!==Re.y)&&this.segments.push(dt.fromRing(Re,ze,this))}getSweepEvents(){let se=[];for(let ue=0,Se=this.segments.length;ue<Se;ue++){let ze=this.segments[ue];se.push(ze.leftSE),se.push(ze.rightSE)}return se}};s(Me,"RingIn");let ve=Me,Ze=class{constructor(se,ue){if(!Array.isArray(se))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ve(se[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let Se=1,ze=se.length;Se<ze;Se++){let Re=new ve(se[Se],this,!1);Re.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Re.bbox.ll.x),Re.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Re.bbox.ll.y),Re.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Re.bbox.ur.x),Re.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Re.bbox.ur.y),this.interiorRings.push(Re)}this.multiPoly=ue}getSweepEvents(){let se=this.exteriorRing.getSweepEvents();for(let ue=0,Se=this.interiorRings.length;ue<Se;ue++){let ze=this.interiorRings[ue].getSweepEvents();for(let Re=0,yt=ze.length;Re<yt;Re++)se.push(ze[Re])}return se}};s(Ze,"PolyIn");let It=Ze,Rt=class{constructor(se,ue){if(!Array.isArray(se))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof se[0][0][0]=="number"&&(se=[se])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let Se=0,ze=se.length;Se<ze;Se++){let Re=new It(se[Se],this);Re.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Re.bbox.ll.x),Re.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Re.bbox.ll.y),Re.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Re.bbox.ur.x),Re.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Re.bbox.ur.y),this.polys.push(Re)}this.isSubject=ue}getSweepEvents(){let se=[];for(let ue=0,Se=this.polys.length;ue<Se;ue++){let ze=this.polys[ue].getSweepEvents();for(let Re=0,yt=ze.length;Re<yt;Re++)se.push(ze[Re])}return se}};s(Rt,"MultiPolyIn");let Et=Rt,pt=class GO{static factory(se){let ue=[];for(let Se=0,ze=se.length;Se<ze;Se++){let Re=se[Se];if(!Re.isInResult()||Re.ringOut)continue;let yt=null,st=Re.leftSE,kt=Re.rightSE,mt=[st],Gt=st.point,ke=[];for(;yt=st,st=kt,mt.push(st),st.point!==Gt;)for(;;){let $e=st.getAvailableLinkedEvents();if($e.length===0){let Ht=mt[0].point,fr=mt[mt.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Ht.x,",")+" ".concat(Ht.y,"]. Last matching segment found ends at")+" [".concat(fr.x,", ").concat(fr.y,"]."))}if($e.length===1){kt=$e[0].otherSE;break}let ot=null;for(let Ht=0,fr=ke.length;Ht<fr;Ht++)if(ke[Ht].point===st.point){ot=Ht;break}if(ot!==null){let Ht=ke.splice(ot)[0],fr=mt.splice(Ht.index);fr.unshift(fr[0].otherSE),ue.push(new GO(fr.reverse()));continue}ke.push({index:mt.length,point:st.point});let Ft=st.getLeftmostComparator(yt);kt=$e.sort(Ft)[0].otherSE;break}ue.push(new GO(mt))}return ue}constructor(se){this.events=se;for(let ue=0,Se=se.length;ue<Se;ue++)se[ue].segment.ringOut=this;this.poly=null}getGeom(){let se=this.events[0].point,ue=[se];for(let mt=1,Gt=this.events.length-1;mt<Gt;mt++){let ke=this.events[mt].point,$e=this.events[mt+1].point;fe(ke,se,$e)!==0&&(ue.push(ke),se=ke)}if(ue.length===1)return null;let Se=ue[0],ze=ue[1];fe(Se,se,ze)===0&&ue.shift(),ue.push(ue[0]);let Re=this.isExteriorRing()?1:-1,yt=this.isExteriorRing()?0:ue.length-1,st=this.isExteriorRing()?ue.length:-1,kt=[];for(let mt=yt;mt!=st;mt+=Re)kt.push([ue[mt].x,ue[mt].y]);return kt}isExteriorRing(){if(this._isExteriorRing===void 0){let se=this.enclosingRing();this._isExteriorRing=se?!se.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let se=this.events[0];for(let ze=1,Re=this.events.length;ze<Re;ze++){let yt=this.events[ze];We.compare(se,yt)>0&&(se=yt)}let ue=se.segment.prevInResult(),Se=ue?ue.prevInResult():null;for(;;){if(!ue)return null;if(!Se)return ue.ringOut;if(Se.ringOut!==ue.ringOut)return Se.ringOut.enclosingRing()!==ue.ringOut?ue.ringOut:ue.ringOut.enclosingRing();ue=Se.prevInResult(),Se=ue?ue.prevInResult():null}}};s(pt,"RingOut");let Yt=pt,Kt=class{constructor(se){this.exteriorRing=se,se.poly=this,this.interiorRings=[]}addInterior(se){this.interiorRings.push(se),se.poly=this}getGeom(){let se=[this.exteriorRing.getGeom()];if(se[0]===null)return null;for(let ue=0,Se=this.interiorRings.length;ue<Se;ue++){let ze=this.interiorRings[ue].getGeom();ze!==null&&se.push(ze)}return se}};s(Kt,"PolyOut");let $t=Kt,jt=class{constructor(se){this.rings=se,this.polys=this._composePolys(se)}getGeom(){let se=[];for(let ue=0,Se=this.polys.length;ue<Se;ue++){let ze=this.polys[ue].getGeom();ze!==null&&se.push(ze)}return se}_composePolys(se){let ue=[];for(let Se=0,ze=se.length;Se<ze;Se++){let Re=se[Se];if(!Re.poly)if(Re.isExteriorRing())ue.push(new $t(Re));else{let yt=Re.enclosingRing();yt.poly||ue.push(new $t(yt)),yt.poly.addInterior(Re)}}return ue}};s(jt,"MultiPolyOut");let Nt=jt,Fe=class{constructor(se){let ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dt.compare;this.queue=se,this.tree=new p(ue),this.segments=[]}process(se){let ue=se.segment,Se=[];if(se.consumedBy)return se.isLeft?this.queue.remove(se.otherSE):this.tree.remove(ue),Se;let ze=se.isLeft?this.tree.add(ue):this.tree.find(ue);if(!ze)throw new Error("Unable to find segment #".concat(ue.id," ")+"[".concat(ue.leftSE.point.x,", ").concat(ue.leftSE.point.y,"] -> ")+"[".concat(ue.rightSE.point.x,", ").concat(ue.rightSE.point.y,"] ")+"in SweepLine tree.");let Re=ze,yt=ze,st,kt;for(;st===void 0;)Re=this.tree.prev(Re),Re===null?st=null:Re.key.consumedBy===void 0&&(st=Re.key);for(;kt===void 0;)yt=this.tree.next(yt),yt===null?kt=null:yt.key.consumedBy===void 0&&(kt=yt.key);if(se.isLeft){let mt=null;if(st){let ke=st.getIntersection(ue);if(ke!==null&&(ue.isAnEndpoint(ke)||(mt=ke),!st.isAnEndpoint(ke))){let $e=this._splitSafely(st,ke);for(let ot=0,Ft=$e.length;ot<Ft;ot++)Se.push($e[ot])}}let Gt=null;if(kt){let ke=kt.getIntersection(ue);if(ke!==null&&(ue.isAnEndpoint(ke)||(Gt=ke),!kt.isAnEndpoint(ke))){let $e=this._splitSafely(kt,ke);for(let ot=0,Ft=$e.length;ot<Ft;ot++)Se.push($e[ot])}}if(mt!==null||Gt!==null){let ke=null;mt===null?ke=Gt:Gt===null?ke=mt:ke=We.comparePoints(mt,Gt)<=0?mt:Gt,this.queue.remove(ue.rightSE),Se.push(ue.rightSE);let $e=ue.split(ke);for(let ot=0,Ft=$e.length;ot<Ft;ot++)Se.push($e[ot])}Se.length>0?(this.tree.remove(ue),Se.push(se)):(this.segments.push(ue),ue.prev=st)}else{if(st&&kt){let mt=st.getIntersection(kt);if(mt!==null){if(!st.isAnEndpoint(mt)){let Gt=this._splitSafely(st,mt);for(let ke=0,$e=Gt.length;ke<$e;ke++)Se.push(Gt[ke])}if(!kt.isAnEndpoint(mt)){let Gt=this._splitSafely(kt,mt);for(let ke=0,$e=Gt.length;ke<$e;ke++)Se.push(Gt[ke])}}}this.tree.remove(ue)}return Se}_splitSafely(se,ue){this.tree.remove(se);let Se=se.rightSE;this.queue.remove(Se);let ze=se.split(ue);return ze.push(Se),se.consumedBy===void 0&&this.tree.add(se),ze}};s(Fe,"SweepLine");let Xe=Fe,ht=typeof $a<"u"&&$a.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,rr=typeof $a<"u"&&$a.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ar=class{run(se,ue,Se){Qe.type=se,z.reset();let ze=[new Et(ue,!0)];for(let Gt=0,ke=Se.length;Gt<ke;Gt++)ze.push(new Et(Se[Gt],!1));if(Qe.numMultiPolys=ze.length,Qe.type==="difference"){let Gt=ze[0],ke=1;for(;ke<ze.length;)P(ze[ke].bbox,Gt.bbox)!==null?ke++:ze.splice(ke,1)}if(Qe.type==="intersection")for(let Gt=0,ke=ze.length;Gt<ke;Gt++){let $e=ze[Gt];for(let ot=Gt+1,Ft=ze.length;ot<Ft;ot++)if(P($e.bbox,ze[ot].bbox)===null)return[]}let Re=new p(We.compare);for(let Gt=0,ke=ze.length;Gt<ke;Gt++){let $e=ze[Gt].getSweepEvents();for(let ot=0,Ft=$e.length;ot<Ft;ot++)if(Re.insert($e[ot]),Re.size>ht)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}let yt=new Xe(Re),st=Re.size,kt=Re.pop();for(;kt;){let Gt=kt.key;if(Re.size===st){let $e=Gt.segment;throw new Error("Unable to pop() ".concat(Gt.isLeft?"left":"right"," SweepEvent ")+"[".concat(Gt.point.x,", ").concat(Gt.point.y,"] from segment #").concat($e.id," ")+"[".concat($e.leftSE.point.x,", ").concat($e.leftSE.point.y,"] -> ")+"[".concat($e.rightSE.point.x,", ").concat($e.rightSE.point.y,"] from queue."))}if(Re.size>ht)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(yt.segments.length>rr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");let ke=yt.process(Gt);for(let $e=0,ot=ke.length;$e<ot;$e++){let Ft=ke[$e];Ft.consumedBy===void 0&&Re.insert(Ft)}st=Re.size,kt=Re.pop()}z.reset();let mt=Yt.factory(yt.segments);return new Nt(mt).getGeom()}};s(ar,"Operation");let Vr=ar,Qe=new Vr;var er={union:s(function(Oe){for(var se=arguments.length,ue=new Array(se>1?se-1:0),Se=1;Se<se;Se++)ue[Se-1]=arguments[Se];return Qe.run("union",Oe,ue)},"union"),intersection:s(function(Oe){for(var se=arguments.length,ue=new Array(se>1?se-1:0),Se=1;Se<se;Se++)ue[Se-1]=arguments[Se];return Qe.run("intersection",Oe,ue)},"intersection"),xor:s(function(Oe){for(var se=arguments.length,ue=new Array(se>1?se-1:0),Se=1;Se<se;Se++)ue[Se-1]=arguments[Se];return Qe.run("xor",Oe,ue)},"xor"),difference:s(function(Oe){for(var se=arguments.length,ue=new Array(se>1?se-1:0),Se=1;Se<se;Se++)ue[Se-1]=arguments[Se];return Qe.run("difference",Oe,ue)},"difference")};return er})}),vqe=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i(r.jsts={})}(t,function(r){function i(){}s(i,"e");function n(h){this.message=h||""}s(n,"n");function a(h){this.message=h||""}s(a,"i");function o(h){this.message=h||""}s(o,"r");function l(){}s(l,"o");function u(h){return h===null?ot:h.color}s(u,"s");function c(h){return h===null?null:h.parent}s(c,"a");function p(h,f){h!==null&&(h.color=f)}s(p,"u");function m(h){return h===null?null:h.left}s(m,"l");function y(h){return h===null?null:h.right}s(y,"c");function v(){this.root_=null,this.size_=0}s(v,"p");function w(){}s(w,"h");function E(){this.array_=[],arguments[0]instanceof er&&this.addAll(arguments[0])}s(E,"f");function M(){}s(M,"g");function I(h){this.message=h||""}s(I,"d");function P(){this.array_=[]}s(P,"y"),"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:s(function(h){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var f=Object(this),_=Math.max(Math.min(f.length,9007199254740991),0)||0,A=1 in arguments&&parseInt(Number(arguments[1]),10)||0;A=A<0?Math.max(_+A,0):Math.min(A,_);var D=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:_;for(D=D<0?Math.max(_+arguments[2],0):Math.min(D,_);A<D;)f[A]=h,++A;return f},"value"),writable:!0}),Number.isFinite=Number.isFinite||function(h){return typeof h=="number"&&isFinite(h)},Number.isInteger=Number.isInteger||function(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(h){return h!=h},Math.trunc=Math.trunc||function(h){return h<0?Math.ceil(h):Math.floor(h)};var C=s(function(){},"_");C.prototype.interfaces_=function(){return[]},C.prototype.getClass=function(){return C},C.prototype.equalsWithTolerance=function(h,f,_){return Math.abs(h-f)<=_};var T=function(h){function f(_){h.call(this,_),this.name="IllegalArgumentException",this.message=_,this.stack=new h().stack}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f}(Error),O=s(function(){},"v"),F={MAX_VALUE:{configurable:!0}};O.isNaN=function(h){return Number.isNaN(h)},O.doubleToLongBits=function(h){return h},O.longBitsToDouble=function(h){return h},O.isInfinite=function(h){return!Number.isFinite(h)},F.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(O,F);var k=s(function(){},"E"),B=s(function(){},"x"),U=s(function(){},"N"),z=s(function h(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=h.NULL_ORDINATE;else if(arguments.length===1){var f=arguments[0];this.x=f.x,this.y=f.y,this.z=f.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=h.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},"t"),q={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};z.prototype.setOrdinate=function(h,f){switch(h){case z.X:this.x=f;break;case z.Y:this.y=f;break;case z.Z:this.z=f;break;default:throw new T("Invalid ordinate index: "+h)}},z.prototype.equals2D=function(){if(arguments.length===1){var h=arguments[0];return this.x===h.x&&this.y===h.y}if(arguments.length===2){var f=arguments[0],_=arguments[1];return!!C.equalsWithTolerance(this.x,f.x,_)&&!!C.equalsWithTolerance(this.y,f.y,_)}},z.prototype.getOrdinate=function(h){switch(h){case z.X:return this.x;case z.Y:return this.y;case z.Z:return this.z}throw new T("Invalid ordinate index: "+h)},z.prototype.equals3D=function(h){return this.x===h.x&&this.y===h.y&&(this.z===h.z||O.isNaN(this.z))&&O.isNaN(h.z)},z.prototype.equals=function(h){return h instanceof z&&this.equals2D(h)},z.prototype.equalInZ=function(h,f){return C.equalsWithTolerance(this.z,h.z,f)},z.prototype.compareTo=function(h){var f=h;return this.x<f.x?-1:this.x>f.x?1:this.y<f.y?-1:this.y>f.y?1:0},z.prototype.clone=function(){},z.prototype.copy=function(){return new z(this)},z.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},z.prototype.distance3D=function(h){var f=this.x-h.x,_=this.y-h.y,A=this.z-h.z;return Math.sqrt(f*f+_*_+A*A)},z.prototype.distance=function(h){var f=this.x-h.x,_=this.y-h.y;return Math.sqrt(f*f+_*_)},z.prototype.hashCode=function(){var h=17;return h=37*h+z.hashCode(this.x),h=37*h+z.hashCode(this.y)},z.prototype.setCoordinate=function(h){this.x=h.x,this.y=h.y,this.z=h.z},z.prototype.interfaces_=function(){return[k,B,i]},z.prototype.getClass=function(){return z},z.hashCode=function(){if(arguments.length===1){var h=arguments[0],f=O.doubleToLongBits(h);return Math.trunc((f^f)>>>32)}},q.DimensionalComparator.get=function(){return W},q.serialVersionUID.get=function(){return 6683108902428367e3},q.NULL_ORDINATE.get=function(){return O.NaN},q.X.get=function(){return 0},q.Y.get=function(){return 1},q.Z.get=function(){return 2},Object.defineProperties(z,q);var W=s(function(h){if(this._dimensionsToTest=2,arguments.length!==0&&arguments.length===1){var f=arguments[0];if(f!==2&&f!==3)throw new T("only 2 or 3 dimensions may be specified");this._dimensionsToTest=f}},"L");W.prototype.compare=function(h,f){var _=h,A=f,D=W.compare(_.x,A.x);if(D!==0)return D;var H=W.compare(_.y,A.y);return H!==0?H:this._dimensionsToTest<=2?0:W.compare(_.z,A.z)},W.prototype.interfaces_=function(){return[U]},W.prototype.getClass=function(){return W},W.compare=function(h,f){return h<f?-1:h>f?1:O.isNaN(h)?O.isNaN(f)?0:-1:O.isNaN(f)?1:0};var J=s(function(){},"b");J.prototype.create=function(){},J.prototype.interfaces_=function(){return[]},J.prototype.getClass=function(){return J};var V=s(function(){},"w"),oe={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};V.prototype.interfaces_=function(){return[]},V.prototype.getClass=function(){return V},V.toLocationSymbol=function(h){switch(h){case V.EXTERIOR:return"e";case V.BOUNDARY:return"b";case V.INTERIOR:return"i";case V.NONE:return"-"}throw new T("Unknown location value: "+h)},oe.INTERIOR.get=function(){return 0},oe.BOUNDARY.get=function(){return 1},oe.EXTERIOR.get=function(){return 2},oe.NONE.get=function(){return-1},Object.defineProperties(V,oe);var Y=s(function(h,f){return h.interfaces_&&h.interfaces_().indexOf(f)>-1},"T"),he=s(function(){},"R"),Q={LOG_10:{configurable:!0}};he.prototype.interfaces_=function(){return[]},he.prototype.getClass=function(){return he},he.log10=function(h){var f=Math.log(h);return O.isInfinite(f)||O.isNaN(f)?f:f/he.LOG_10},he.min=function(h,f,_,A){var D=h;return f<D&&(D=f),_<D&&(D=_),A<D&&(D=A),D},he.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var h=arguments[0],f=arguments[1],_=arguments[2];return h<f?f:h>_?_:h}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var A=arguments[0],D=arguments[1],H=arguments[2];return A<D?D:A>H?H:A}},he.wrap=function(h,f){return h<0?f- -h%f:h%f},he.max=function(){if(arguments.length===3){var h=arguments[0],f=arguments[1],_=arguments[2],A=h;return f>A&&(A=f),_>A&&(A=_),A}if(arguments.length===4){var D=arguments[0],H=arguments[1],re=arguments[2],ge=arguments[3],Ne=D;return H>Ne&&(Ne=H),re>Ne&&(Ne=re),ge>Ne&&(Ne=ge),Ne}},he.average=function(h,f){return(h+f)/2},Q.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(he,Q);var ae=s(function(h){this.str=h},"D");ae.prototype.append=function(h){this.str+=h},ae.prototype.setCharAt=function(h,f){this.str=this.str.substr(0,h)+f+this.str.substr(h+1)},ae.prototype.toString=function(h){return this.str};var ee=s(function(h){this.value=h},"M");ee.prototype.intValue=function(){return this.value},ee.prototype.compareTo=function(h){return this.value<h?-1:this.value>h?1:0},ee.isNaN=function(h){return Number.isNaN(h)};var le=s(function(){},"A");le.isWhitespace=function(h){return h<=32&&h>=0||h===127},le.toUpperCase=function(h){return h.toUpperCase()};var K=s(function h(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var f=arguments[0];this.init(f)}else if(arguments[0]instanceof h){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var A=arguments[0];h.call(this,h.parse(A))}}else if(arguments.length===2){var D=arguments[0],H=arguments[1];this.init(D,H)}},"t"),ce={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};K.prototype.le=function(h){return(this._hi<h._hi||this._hi===h._hi)&&this._lo<=h._lo},K.prototype.extractSignificantDigits=function(h,f){var _=this.abs(),A=K.magnitude(_._hi),D=K.TEN.pow(A);(_=_.divide(D)).gt(K.TEN)?(_=_.divide(K.TEN),A+=1):_.lt(K.ONE)&&(_=_.multiply(K.TEN),A-=1);for(var H=A+1,re=new ae,ge=K.MAX_PRINT_DIGITS-1,Ne=0;Ne<=ge;Ne++){h&&Ne===H&&re.append(".");var Ye=Math.trunc(_._hi);if(Ye<0)break;var Mt=!1,At=0;Ye>9?(Mt=!0,At="9"):At="0"+Ye,re.append(At),_=_.subtract(K.valueOf(Ye)).multiply(K.TEN),Mt&&_.selfAdd(K.TEN);var hr=!0,gr=K.magnitude(_._hi);if(gr<0&&Math.abs(gr)>=ge-Ne&&(hr=!1),!hr)break}return f[0]=A,re.toString()},K.prototype.sqr=function(){return this.multiply(this)},K.prototype.doubleValue=function(){return this._hi+this._lo},K.prototype.subtract=function(){if(arguments[0]instanceof K){var h=arguments[0];return this.add(h.negate())}if(typeof arguments[0]=="number"){var f=arguments[0];return this.add(-f)}},K.prototype.equals=function(){if(arguments.length===1){var h=arguments[0];return this._hi===h._hi&&this._lo===h._lo}},K.prototype.isZero=function(){return this._hi===0&&this._lo===0},K.prototype.selfSubtract=function(){if(arguments[0]instanceof K){var h=arguments[0];return this.isNaN()?this:this.selfAdd(-h._hi,-h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0];return this.isNaN()?this:this.selfAdd(-f,0)}},K.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},K.prototype.min=function(h){return this.le(h)?this:h},K.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof K){var h=arguments[0];return this.selfDivide(h._hi,h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0];return this.selfDivide(f,0)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1],D=null,H=null,re=null,ge=null,Ne=null,Ye=null,Mt=null,At=null;return Ne=this._hi/_,Ye=K.SPLIT*Ne,D=Ye-Ne,At=K.SPLIT*_,D=Ye-D,H=Ne-D,re=At-_,Mt=Ne*_,re=At-re,ge=_-re,At=D*re-Mt+D*ge+H*re+H*ge,Ye=(this._hi-Mt-At+this._lo-Ne*A)/_,At=Ne+Ye,this._hi=At,this._lo=Ne-At+Ye,this}},K.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},K.prototype.divide=function(){if(arguments[0]instanceof K){var h=arguments[0],f=null,_=null,A=null,D=null,H=null,re=null,ge=null,Ne=null;return _=(H=this._hi/h._hi)-(f=(re=K.SPLIT*H)-(f=re-H)),Ne=f*(A=(Ne=K.SPLIT*h._hi)-(A=Ne-h._hi))-(ge=H*h._hi)+f*(D=h._hi-A)+_*A+_*D,re=(this._hi-ge-Ne+this._lo-H*h._lo)/h._hi,new K(Ne=H+re,H-Ne+re)}if(typeof arguments[0]=="number"){var Ye=arguments[0];return O.isNaN(Ye)?K.createNaN():K.copy(this).selfDivide(Ye,0)}},K.prototype.ge=function(h){return(this._hi>h._hi||this._hi===h._hi)&&this._lo>=h._lo},K.prototype.pow=function(h){if(h===0)return K.valueOf(1);var f=new K(this),_=K.valueOf(1),A=Math.abs(h);if(A>1)for(;A>0;)A%2==1&&_.selfMultiply(f),(A/=2)>0&&(f=f.sqr());else _=f;return h<0?_.reciprocal():_},K.prototype.ceil=function(){if(this.isNaN())return K.NaN;var h=Math.ceil(this._hi),f=0;return h===this._hi&&(f=Math.ceil(this._lo)),new K(h,f)},K.prototype.compareTo=function(h){var f=h;return this._hi<f._hi?-1:this._hi>f._hi?1:this._lo<f._lo?-1:this._lo>f._lo?1:0},K.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},K.prototype.setValue=function(){if(arguments[0]instanceof K){var h=arguments[0];return this.init(h),this}if(typeof arguments[0]=="number"){var f=arguments[0];return this.init(f),this}},K.prototype.max=function(h){return this.ge(h)?this:h},K.prototype.sqrt=function(){if(this.isZero())return K.valueOf(0);if(this.isNegative())return K.NaN;var h=1/Math.sqrt(this._hi),f=this._hi*h,_=K.valueOf(f),A=this.subtract(_.sqr())._hi*(.5*h);return _.add(A)},K.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof K){var h=arguments[0];return this.selfAdd(h._hi,h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0],_=null,A=null,D=null,H=null,re=null,ge=null;return D=this._hi+f,re=D-this._hi,H=D-re,H=f-re+(this._hi-H),ge=H+this._lo,_=D+ge,A=ge+(D-_),this._hi=_+A,this._lo=A+(_-this._hi),this}}else if(arguments.length===2){var Ne=arguments[0],Ye=arguments[1],Mt=null,At=null,hr=null,gr=null,Sr=null,Qr=null,ji=null;gr=this._hi+Ne,At=this._lo+Ye,Sr=gr-(Qr=gr-this._hi),hr=At-(ji=At-this._lo);var $n=(Mt=gr+(Qr=(Sr=Ne-Qr+(this._hi-Sr))+At))+(Qr=(hr=Ye-ji+(this._lo-hr))+(Qr+(gr-Mt))),rs=Qr+(Mt-$n);return this._hi=$n,this._lo=rs,this}},K.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof K){var h=arguments[0];return this.selfMultiply(h._hi,h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0];return this.selfMultiply(f,0)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1],D=null,H=null,re=null,ge=null,Ne=null,Ye=null;D=(Ne=K.SPLIT*this._hi)-this._hi,Ye=K.SPLIT*_,D=Ne-D,H=this._hi-D,re=Ye-_;var Mt=(Ne=this._hi*_)+(Ye=D*(re=Ye-re)-Ne+D*(ge=_-re)+H*re+H*ge+(this._hi*A+this._lo*_)),At=Ye+(D=Ne-Mt);return this._hi=Mt,this._lo=At,this}},K.prototype.selfSqr=function(){return this.selfMultiply(this)},K.prototype.floor=function(){if(this.isNaN())return K.NaN;var h=Math.floor(this._hi),f=0;return h===this._hi&&(f=Math.floor(this._lo)),new K(h,f)},K.prototype.negate=function(){return this.isNaN()?this:new K(-this._hi,-this._lo)},K.prototype.clone=function(){},K.prototype.multiply=function(){if(arguments[0]instanceof K){var h=arguments[0];return h.isNaN()?K.createNaN():K.copy(this).selfMultiply(h)}if(typeof arguments[0]=="number"){var f=arguments[0];return O.isNaN(f)?K.createNaN():K.copy(this).selfMultiply(f,0)}},K.prototype.isNaN=function(){return O.isNaN(this._hi)},K.prototype.intValue=function(){return Math.trunc(this._hi)},K.prototype.toString=function(){var h=K.magnitude(this._hi);return h>=-3&&h<=20?this.toStandardNotation():this.toSciNotation()},K.prototype.toStandardNotation=function(){var h=this.getSpecialNumberString();if(h!==null)return h;var f=new Array(1).fill(null),_=this.extractSignificantDigits(!0,f),A=f[0]+1,D=_;if(_.charAt(0)===".")D="0"+_;else if(A<0)D="0."+K.stringOfChar("0",-A)+_;else if(_.indexOf(".")===-1){var H=A-_.length;D=_+K.stringOfChar("0",H)+".0"}return this.isNegative()?"-"+D:D},K.prototype.reciprocal=function(){var h=null,f=null,_=null,A=null,D=null,H=null,re=null,ge=null;f=(D=1/this._hi)-(h=(H=K.SPLIT*D)-(h=H-D)),_=(ge=K.SPLIT*this._hi)-this._hi;var Ne=D+(H=(1-(re=D*this._hi)-(ge=h*(_=ge-_)-re+h*(A=this._hi-_)+f*_+f*A)-D*this._lo)/this._hi);return new K(Ne,D-Ne+H)},K.prototype.toSciNotation=function(){if(this.isZero())return K.SCI_NOT_ZERO;var h=this.getSpecialNumberString();if(h!==null)return h;var f=new Array(1).fill(null),_=this.extractSignificantDigits(!1,f),A=K.SCI_NOT_EXPONENT_CHAR+f[0];if(_.charAt(0)==="0")throw new Error("Found leading zero: "+_);var D="";_.length>1&&(D=_.substring(1));var H=_.charAt(0)+"."+D;return this.isNegative()?"-"+H+A:H+A},K.prototype.abs=function(){return this.isNaN()?K.NaN:this.isNegative()?this.negate():new K(this)},K.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},K.prototype.lt=function(h){return(this._hi<h._hi||this._hi===h._hi)&&this._lo<h._lo},K.prototype.add=function(){if(arguments[0]instanceof K){var h=arguments[0];return K.copy(this).selfAdd(h)}if(typeof arguments[0]=="number"){var f=arguments[0];return K.copy(this).selfAdd(f)}},K.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var h=arguments[0];this._hi=h,this._lo=0}else if(arguments[0]instanceof K){var f=arguments[0];this._hi=f._hi,this._lo=f._lo}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this._hi=_,this._lo=A}},K.prototype.gt=function(h){return(this._hi>h._hi||this._hi===h._hi)&&this._lo>h._lo},K.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},K.prototype.trunc=function(){return this.isNaN()?K.NaN:this.isPositive()?this.floor():this.ceil()},K.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},K.prototype.interfaces_=function(){return[i,k,B]},K.prototype.getClass=function(){return K},K.sqr=function(h){return K.valueOf(h).selfMultiply(h)},K.valueOf=function(){if(typeof arguments[0]=="string"){var h=arguments[0];return K.parse(h)}if(typeof arguments[0]=="number"){var f=arguments[0];return new K(f)}},K.sqrt=function(h){return K.valueOf(h).sqrt()},K.parse=function(h){for(var f=0,_=h.length;le.isWhitespace(h.charAt(f));)f++;var A=!1;if(f<_){var D=h.charAt(f);D!=="-"&&D!=="+"||(f++,D==="-"&&(A=!0))}for(var H=new K,re=0,ge=0,Ne=0;!(f>=_);){var Ye=h.charAt(f);if(f++,le.isDigit(Ye)){var Mt=Ye-"0";H.selfMultiply(K.TEN),H.selfAdd(Mt),re++}else{if(Ye!=="."){if(Ye==="e"||Ye==="E"){var At=h.substring(f);try{Ne=ee.parseInt(At)}catch(ji){throw ji instanceof Error?new Error("Invalid exponent "+At+" in string "+h):ji}break}throw new Error("Unexpected character '"+Ye+"' at position "+f+" in string "+h)}ge=re}}var hr=H,gr=re-ge-Ne;if(gr===0)hr=H;else if(gr>0){var Sr=K.TEN.pow(gr);hr=H.divide(Sr)}else if(gr<0){var Qr=K.TEN.pow(-gr);hr=H.multiply(Qr)}return A?hr.negate():hr},K.createNaN=function(){return new K(O.NaN,O.NaN)},K.copy=function(h){return new K(h)},K.magnitude=function(h){var f=Math.abs(h),_=Math.log(f)/Math.log(10),A=Math.trunc(Math.floor(_));return 10*Math.pow(10,A)<=f&&(A+=1),A},K.stringOfChar=function(h,f){for(var _=new ae,A=0;A<f;A++)_.append(h);return _.toString()},ce.PI.get=function(){return new K(3.141592653589793,12246467991473532e-32)},ce.TWO_PI.get=function(){return new K(6.283185307179586,24492935982947064e-32)},ce.PI_2.get=function(){return new K(1.5707963267948966,6123233995736766e-32)},ce.E.get=function(){return new K(2.718281828459045,14456468917292502e-32)},ce.NaN.get=function(){return new K(O.NaN,O.NaN)},ce.EPS.get=function(){return 123259516440783e-46},ce.SPLIT.get=function(){return 134217729},ce.MAX_PRINT_DIGITS.get=function(){return 32},ce.TEN.get=function(){return K.valueOf(10)},ce.ONE.get=function(){return K.valueOf(1)},ce.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},ce.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(K,ce);var te=s(function(){},"q"),ne={DP_SAFE_EPSILON:{configurable:!0}};te.prototype.interfaces_=function(){return[]},te.prototype.getClass=function(){return te},te.orientationIndex=function(h,f,_){var A=te.orientationIndexFilter(h,f,_);if(A<=1)return A;var D=K.valueOf(f.x).selfAdd(-h.x),H=K.valueOf(f.y).selfAdd(-h.y),re=K.valueOf(_.x).selfAdd(-f.x),ge=K.valueOf(_.y).selfAdd(-f.y);return D.selfMultiply(ge).selfSubtract(H.selfMultiply(re)).signum()},te.signOfDet2x2=function(h,f,_,A){return h.multiply(A).selfSubtract(f.multiply(_)).signum()},te.intersection=function(h,f,_,A){var D=K.valueOf(A.y).selfSubtract(_.y).selfMultiply(K.valueOf(f.x).selfSubtract(h.x)),H=K.valueOf(A.x).selfSubtract(_.x).selfMultiply(K.valueOf(f.y).selfSubtract(h.y)),re=D.subtract(H),ge=K.valueOf(A.x).selfSubtract(_.x).selfMultiply(K.valueOf(h.y).selfSubtract(_.y)),Ne=K.valueOf(A.y).selfSubtract(_.y).selfMultiply(K.valueOf(h.x).selfSubtract(_.x)),Ye=ge.subtract(Ne).selfDivide(re).doubleValue(),Mt=K.valueOf(h.x).selfAdd(K.valueOf(f.x).selfSubtract(h.x).selfMultiply(Ye)).doubleValue(),At=K.valueOf(f.x).selfSubtract(h.x).selfMultiply(K.valueOf(h.y).selfSubtract(_.y)),hr=K.valueOf(f.y).selfSubtract(h.y).selfMultiply(K.valueOf(h.x).selfSubtract(_.x)),gr=At.subtract(hr).selfDivide(re).doubleValue(),Sr=K.valueOf(_.y).selfAdd(K.valueOf(A.y).selfSubtract(_.y).selfMultiply(gr)).doubleValue();return new z(Mt,Sr)},te.orientationIndexFilter=function(h,f,_){var A=null,D=(h.x-_.x)*(f.y-_.y),H=(h.y-_.y)*(f.x-_.x),re=D-H;if(D>0){if(H<=0)return te.signum(re);A=D+H}else{if(!(D<0)||H>=0)return te.signum(re);A=-D-H}var ge=te.DP_SAFE_EPSILON*A;return re>=ge||-re>=ge?te.signum(re):2},te.signum=function(h){return h>0?1:h<0?-1:0},ne.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(te,ne);var pe=s(function(){},"V"),xe={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};xe.X.get=function(){return 0},xe.Y.get=function(){return 1},xe.Z.get=function(){return 2},xe.M.get=function(){return 3},pe.prototype.setOrdinate=function(h,f,_){},pe.prototype.size=function(){},pe.prototype.getOrdinate=function(h,f){},pe.prototype.getCoordinate=function(){},pe.prototype.getCoordinateCopy=function(h){},pe.prototype.getDimension=function(){},pe.prototype.getX=function(h){},pe.prototype.clone=function(){},pe.prototype.expandEnvelope=function(h){},pe.prototype.copy=function(){},pe.prototype.getY=function(h){},pe.prototype.toCoordinateArray=function(){},pe.prototype.interfaces_=function(){return[B]},pe.prototype.getClass=function(){return pe},Object.defineProperties(pe,xe);var Te=s(function(){},"z"),fe=function(h){function f(){h.call(this,"Projective point not representable on the Cartesian plane.")}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Te),Pe=s(function(){},"Y");Pe.arraycopy=function(h,f,_,A,D){for(var H=0,re=f;re<f+D;re++)_[A+H]=h[re],H++},Pe.getProperty=function(h){return{"line.separator":`
`}[h]};var me=s(function h(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var f=arguments[0];this.x=f.x,this.y=f.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],A=arguments[1];this.x=_,this.y=A,this.w=1}else if(arguments[0]instanceof h&&arguments[1]instanceof h){var D=arguments[0],H=arguments[1];this.x=D.y*H.w-H.y*D.w,this.y=H.x*D.w-D.x*H.w,this.w=D.x*H.y-H.x*D.y}else if(arguments[0]instanceof z&&arguments[1]instanceof z){var re=arguments[0],ge=arguments[1];this.x=re.y-ge.y,this.y=ge.x-re.x,this.w=re.x*ge.y-ge.x*re.y}}else if(arguments.length===3){var Ne=arguments[0],Ye=arguments[1],Mt=arguments[2];this.x=Ne,this.y=Ye,this.w=Mt}else if(arguments.length===4){var At=arguments[0],hr=arguments[1],gr=arguments[2],Sr=arguments[3],Qr=At.y-hr.y,ji=hr.x-At.x,$n=At.x*hr.y-hr.x*At.y,rs=gr.y-Sr.y,gu=Sr.x-gr.x,fh=gr.x*Sr.y-Sr.x*gr.y;this.x=ji*fh-gu*$n,this.y=rs*$n-Qr*fh,this.w=Qr*gu-rs*ji}},"t");me.prototype.getY=function(){var h=this.y/this.w;if(O.isNaN(h)||O.isInfinite(h))throw new fe;return h},me.prototype.getX=function(){var h=this.x/this.w;if(O.isNaN(h)||O.isInfinite(h))throw new fe;return h},me.prototype.getCoordinate=function(){var h=new z;return h.x=this.getX(),h.y=this.getY(),h},me.prototype.interfaces_=function(){return[]},me.prototype.getClass=function(){return me},me.intersection=function(h,f,_,A){var D=h.y-f.y,H=f.x-h.x,re=h.x*f.y-f.x*h.y,ge=_.y-A.y,Ne=A.x-_.x,Ye=_.x*A.y-A.x*_.y,Mt=D*Ne-ge*H,At=(H*Ye-Ne*re)/Mt,hr=(ge*re-D*Ye)/Mt;if(O.isNaN(At)||O.isInfinite(At)||O.isNaN(hr)||O.isInfinite(hr))throw new fe;return new z(At,hr)};var Ae=s(function h(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof z){var f=arguments[0];this.init(f.x,f.x,f.y,f.y)}else if(arguments[0]instanceof h){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var A=arguments[0],D=arguments[1];this.init(A.x,D.x,A.y,D.y)}else if(arguments.length===4){var H=arguments[0],re=arguments[1],ge=arguments[2],Ne=arguments[3];this.init(H,re,ge,Ne)}},"t"),Ue={serialVersionUID:{configurable:!0}};Ae.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Ae.prototype.equals=function(h){if(!(h instanceof Ae))return!1;var f=h;return this.isNull()?f.isNull():this._maxx===f.getMaxX()&&this._maxy===f.getMaxY()&&this._minx===f.getMinX()&&this._miny===f.getMinY()},Ae.prototype.intersection=function(h){if(this.isNull()||h.isNull()||!this.intersects(h))return new Ae;var f=this._minx>h._minx?this._minx:h._minx,_=this._miny>h._miny?this._miny:h._miny,A=this._maxx<h._maxx?this._maxx:h._maxx,D=this._maxy<h._maxy?this._maxy:h._maxy;return new Ae(f,A,_,D)},Ae.prototype.isNull=function(){return this._maxx<this._minx},Ae.prototype.getMaxX=function(){return this._maxx},Ae.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];return this.covers(h.x,h.y)}if(arguments[0]instanceof Ae){var f=arguments[0];return!this.isNull()&&!f.isNull()&&f.getMinX()>=this._minx&&f.getMaxX()<=this._maxx&&f.getMinY()>=this._miny&&f.getMaxY()<=this._maxy}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return!this.isNull()&&_>=this._minx&&_<=this._maxx&&A>=this._miny&&A<=this._maxy}},Ae.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof Ae){var h=arguments[0];return!this.isNull()&&!h.isNull()&&!(h._minx>this._maxx||h._maxx<this._minx||h._miny>this._maxy||h._maxy<this._miny)}if(arguments[0]instanceof z){var f=arguments[0];return this.intersects(f.x,f.y)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return!this.isNull()&&!(_>this._maxx||_<this._minx||A>this._maxy||A<this._miny)}},Ae.prototype.getMinY=function(){return this._miny},Ae.prototype.getMinX=function(){return this._minx},Ae.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];this.expandToInclude(h.x,h.y)}else if(arguments[0]instanceof Ae){var f=arguments[0];if(f.isNull())return null;this.isNull()?(this._minx=f.getMinX(),this._maxx=f.getMaxX(),this._miny=f.getMinY(),this._maxy=f.getMaxY()):(f._minx<this._minx&&(this._minx=f._minx),f._maxx>this._maxx&&(this._maxx=f._maxx),f._miny<this._miny&&(this._miny=f._miny),f._maxy>this._maxy&&(this._maxy=f._maxy))}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this.isNull()?(this._minx=_,this._maxx=_,this._miny=A,this._maxy=A):(_<this._minx&&(this._minx=_),_>this._maxx&&(this._maxx=_),A<this._miny&&(this._miny=A),A>this._maxy&&(this._maxy=A))}},Ae.prototype.minExtent=function(){if(this.isNull())return 0;var h=this.getWidth(),f=this.getHeight();return h<f?h:f},Ae.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Ae.prototype.compareTo=function(h){var f=h;return this.isNull()?f.isNull()?0:-1:f.isNull()?1:this._minx<f._minx?-1:this._minx>f._minx?1:this._miny<f._miny?-1:this._miny>f._miny?1:this._maxx<f._maxx?-1:this._maxx>f._maxx?1:this._maxy<f._maxy?-1:this._maxy>f._maxy?1:0},Ae.prototype.translate=function(h,f){if(this.isNull())return null;this.init(this.getMinX()+h,this.getMaxX()+h,this.getMinY()+f,this.getMaxY()+f)},Ae.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Ae.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Ae.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Ae.prototype.maxExtent=function(){if(this.isNull())return 0;var h=this.getWidth(),f=this.getHeight();return h>f?h:f},Ae.prototype.expandBy=function(){if(arguments.length===1){var h=arguments[0];this.expandBy(h,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this.isNull())return null;this._minx-=f,this._maxx+=f,this._miny-=_,this._maxy+=_,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Ae.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof Ae){var h=arguments[0];return this.covers(h)}if(arguments[0]instanceof z){var f=arguments[0];return this.covers(f)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return this.covers(_,A)}},Ae.prototype.centre=function(){return this.isNull()?null:new z((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Ae.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];this.init(h.x,h.x,h.y,h.y)}else if(arguments[0]instanceof Ae){var f=arguments[0];this._minx=f._minx,this._maxx=f._maxx,this._miny=f._miny,this._maxy=f._maxy}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this.init(_.x,A.x,_.y,A.y)}else if(arguments.length===4){var D=arguments[0],H=arguments[1],re=arguments[2],ge=arguments[3];D<H?(this._minx=D,this._maxx=H):(this._minx=H,this._maxx=D),re<ge?(this._miny=re,this._maxy=ge):(this._miny=ge,this._maxy=re)}},Ae.prototype.getMaxY=function(){return this._maxy},Ae.prototype.distance=function(h){if(this.intersects(h))return 0;var f=0;this._maxx<h._minx?f=h._minx-this._maxx:this._minx>h._maxx&&(f=this._minx-h._maxx);var _=0;return this._maxy<h._miny?_=h._miny-this._maxy:this._miny>h._maxy&&(_=this._miny-h._maxy),f===0?_:_===0?f:Math.sqrt(f*f+_*_)},Ae.prototype.hashCode=function(){var h=17;return h=37*h+z.hashCode(this._minx),h=37*h+z.hashCode(this._maxx),h=37*h+z.hashCode(this._miny),h=37*h+z.hashCode(this._maxy)},Ae.prototype.interfaces_=function(){return[k,i]},Ae.prototype.getClass=function(){return Ae},Ae.intersects=function(){if(arguments.length===3){var h=arguments[0],f=arguments[1],_=arguments[2];return _.x>=(h.x<f.x?h.x:f.x)&&_.x<=(h.x>f.x?h.x:f.x)&&_.y>=(h.y<f.y?h.y:f.y)&&_.y<=(h.y>f.y?h.y:f.y)}if(arguments.length===4){var A=arguments[0],D=arguments[1],H=arguments[2],re=arguments[3],ge=Math.min(H.x,re.x),Ne=Math.max(H.x,re.x),Ye=Math.min(A.x,D.x),Mt=Math.max(A.x,D.x);return!(Ye>Ne)&&!(Mt<ge)&&(ge=Math.min(H.y,re.y),Ne=Math.max(H.y,re.y),Ye=Math.min(A.y,D.y),Mt=Math.max(A.y,D.y),!(Ye>Ne)&&!(Mt<ge))}},Ue.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(Ae,Ue);var _e={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},lt=s(function(h){this.geometryFactory=h||new qr},"K");lt.prototype.read=function(h){var f,_,A;h=h.replace(/[\n\r]/g," ");var D=_e.typeStr.exec(h);if(h.search("EMPTY")!==-1&&((D=_e.emptyTypeStr.exec(h))[2]=void 0),D&&(_=D[1].toLowerCase(),A=D[2],We[_]&&(f=We[_].apply(this,[A]))),f===void 0)throw new Error("Could not parse WKT "+h);return f},lt.prototype.write=function(h){return this.extractGeometry(h)},lt.prototype.extractGeometry=function(h){var f=h.getGeometryType().toLowerCase();if(!tt[f])return null;var _=f.toUpperCase();return h.isEmpty()?_+" EMPTY":_+"("+tt[f].apply(this,[h])+")"};var tt={coordinate:s(function(h){return h.x+" "+h.y},"coordinate"),point:s(function(h){return tt.coordinate.call(this,h._coordinates._coordinates[0])},"point"),multipoint:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push("("+tt.point.apply(this,[h._geometries[_]])+")");return f.join(",")},"multipoint"),linestring:s(function(h){for(var f=[],_=0,A=h._points._coordinates.length;_<A;++_)f.push(tt.coordinate.apply(this,[h._points._coordinates[_]]));return f.join(",")},"linestring"),linearring:s(function(h){for(var f=[],_=0,A=h._points._coordinates.length;_<A;++_)f.push(tt.coordinate.apply(this,[h._points._coordinates[_]]));return f.join(",")},"linearring"),multilinestring:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push("("+tt.linestring.apply(this,[h._geometries[_]])+")");return f.join(",")},"multilinestring"),polygon:s(function(h){var f=[];f.push("("+tt.linestring.apply(this,[h._shell])+")");for(var _=0,A=h._holes.length;_<A;++_)f.push("("+tt.linestring.apply(this,[h._holes[_]])+")");return f.join(",")},"polygon"),multipolygon:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push("("+tt.polygon.apply(this,[h._geometries[_]])+")");return f.join(",")},"multipolygon"),geometrycollection:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push(this.extractGeometry(h._geometries[_]));return f.join(",")},"geometrycollection")},We={point:s(function(h){if(h===void 0)return this.geometryFactory.createPoint();var f=h.trim().split(_e.spaces);return this.geometryFactory.createPoint(new z(Number.parseFloat(f[0]),Number.parseFloat(f[1])))},"point"),multipoint:s(function(h){if(h===void 0)return this.geometryFactory.createMultiPoint();for(var f,_=h.trim().split(","),A=[],D=0,H=_.length;D<H;++D)f=_[D].replace(_e.trimParens,"$1"),A.push(We.point.apply(this,[f]));return this.geometryFactory.createMultiPoint(A)},"multipoint"),linestring:s(function(h){if(h===void 0)return this.geometryFactory.createLineString();for(var f,_=h.trim().split(","),A=[],D=0,H=_.length;D<H;++D)f=_[D].trim().split(_e.spaces),A.push(new z(Number.parseFloat(f[0]),Number.parseFloat(f[1])));return this.geometryFactory.createLineString(A)},"linestring"),linearring:s(function(h){if(h===void 0)return this.geometryFactory.createLinearRing();for(var f,_=h.trim().split(","),A=[],D=0,H=_.length;D<H;++D)f=_[D].trim().split(_e.spaces),A.push(new z(Number.parseFloat(f[0]),Number.parseFloat(f[1])));return this.geometryFactory.createLinearRing(A)},"linearring"),multilinestring:s(function(h){if(h===void 0)return this.geometryFactory.createMultiLineString();for(var f,_=h.trim().split(_e.parenComma),A=[],D=0,H=_.length;D<H;++D)f=_[D].replace(_e.trimParens,"$1"),A.push(We.linestring.apply(this,[f]));return this.geometryFactory.createMultiLineString(A)},"multilinestring"),polygon:s(function(h){if(h===void 0)return this.geometryFactory.createPolygon();for(var f,_,A,D,H=h.trim().split(_e.parenComma),re=[],ge=0,Ne=H.length;ge<Ne;++ge)f=H[ge].replace(_e.trimParens,"$1"),_=We.linestring.apply(this,[f]),A=this.geometryFactory.createLinearRing(_._points),ge===0?D=A:re.push(A);return this.geometryFactory.createPolygon(D,re)},"polygon"),multipolygon:s(function(h){if(h===void 0)return this.geometryFactory.createMultiPolygon();for(var f,_=h.trim().split(_e.doubleParenComma),A=[],D=0,H=_.length;D<H;++D)f=_[D].replace(_e.trimParens,"$1"),A.push(We.polygon.apply(this,[f]));return this.geometryFactory.createMultiPolygon(A)},"multipolygon"),geometrycollection:s(function(h){if(h===void 0)return this.geometryFactory.createGeometryCollection();for(var f=(h=h.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),_=[],A=0,D=f.length;A<D;++A)_.push(this.read(f[A]));return this.geometryFactory.createGeometryCollection(_)},"geometrycollection")},at=s(function(h){this.parser=new lt(h)},"Z");at.prototype.write=function(h){return this.parser.write(h)},at.toLineString=function(h,f){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+h.x+" "+h.y+", "+f.x+" "+f.y+" )"};var Lt=function(h){function f(_){h.call(this,_),this.name="RuntimeException",this.message=_,this.stack=new h().stack}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f}(Error),dt=function(h){function f(){if(h.call(this),arguments.length===0)h.call(this);else if(arguments.length===1){var _=arguments[0];h.call(this,_)}}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Lt),Me=s(function(){},"et");Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me},Me.shouldNeverReachHere=function(){if(arguments.length===0)Me.shouldNeverReachHere(null);else if(arguments.length===1){var h=arguments[0];throw new dt("Should never reach here"+(h!==null?": "+h:""))}},Me.isTrue=function(){var h,f;if(arguments.length===1)h=arguments[0],Me.isTrue(h,null);else if(arguments.length===2&&(h=arguments[0],f=arguments[1],!h))throw f===null?new dt:new dt(f)},Me.equals=function(){var h,f,_;if(arguments.length===2)h=arguments[0],f=arguments[1],Me.equals(h,f,null);else if(arguments.length===3&&(h=arguments[0],f=arguments[1],_=arguments[2],!f.equals(h)))throw new dt("Expected "+h+" but encountered "+f+(_!==null?": "+_:""))};var ve=s(function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new z,this._intPt[1]=new z,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},"nt"),Ze={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};ve.prototype.getIndexAlongSegment=function(h,f){return this.computeIntLineIndex(),this._intLineIndex[h][f]},ve.prototype.getTopologySummary=function(){var h=new ae;return this.isEndPoint()&&h.append(" endpoint"),this._isProper&&h.append(" proper"),this.isCollinear()&&h.append(" collinear"),h.toString()},ve.prototype.computeIntersection=function(h,f,_,A){this._inputLines[0][0]=h,this._inputLines[0][1]=f,this._inputLines[1][0]=_,this._inputLines[1][1]=A,this._result=this.computeIntersect(h,f,_,A)},ve.prototype.getIntersectionNum=function(){return this._result},ve.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var h=arguments[0];this.getEdgeDistance(h,0)>this.getEdgeDistance(h,1)?(this._intLineIndex[h][0]=0,this._intLineIndex[h][1]=1):(this._intLineIndex[h][0]=1,this._intLineIndex[h][1]=0)}},ve.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},ve.prototype.setPrecisionModel=function(h){this._precisionModel=h},ve.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var h=arguments[0],f=0;f<this._result;f++)if(!this._intPt[f].equals2D(this._inputLines[h][0])&&!this._intPt[f].equals2D(this._inputLines[h][1]))return!0;return!1}},ve.prototype.getIntersection=function(h){return this._intPt[h]},ve.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},ve.prototype.hasIntersection=function(){return this._result!==ve.NO_INTERSECTION},ve.prototype.getEdgeDistance=function(h,f){return ve.computeEdgeDistance(this._intPt[f],this._inputLines[h][0],this._inputLines[h][1])},ve.prototype.isCollinear=function(){return this._result===ve.COLLINEAR_INTERSECTION},ve.prototype.toString=function(){return at.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+at.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},ve.prototype.getEndpoint=function(h,f){return this._inputLines[h][f]},ve.prototype.isIntersection=function(h){for(var f=0;f<this._result;f++)if(this._intPt[f].equals2D(h))return!0;return!1},ve.prototype.getIntersectionAlongSegment=function(h,f){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[h][f]]},ve.prototype.interfaces_=function(){return[]},ve.prototype.getClass=function(){return ve},ve.computeEdgeDistance=function(h,f,_){var A=Math.abs(_.x-f.x),D=Math.abs(_.y-f.y),H=-1;if(h.equals(f))H=0;else if(h.equals(_))H=A>D?A:D;else{var re=Math.abs(h.x-f.x),ge=Math.abs(h.y-f.y);(H=A>D?re:ge)!==0||h.equals(f)||(H=Math.max(re,ge))}return Me.isTrue(!(H===0&&!h.equals(f)),"Bad distance calculation"),H},ve.nonRobustComputeEdgeDistance=function(h,f,_){var A=h.x-f.x,D=h.y-f.y,H=Math.sqrt(A*A+D*D);return Me.isTrue(!(H===0&&!h.equals(f)),"Invalid distance calculation"),H},Ze.DONT_INTERSECT.get=function(){return 0},Ze.DO_INTERSECT.get=function(){return 1},Ze.COLLINEAR.get=function(){return 2},Ze.NO_INTERSECTION.get=function(){return 0},Ze.POINT_INTERSECTION.get=function(){return 1},Ze.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(ve,Ze);var It=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.isInSegmentEnvelopes=function(_){var A=new Ae(this._inputLines[0][0],this._inputLines[0][1]),D=new Ae(this._inputLines[1][0],this._inputLines[1][1]);return A.contains(_)&&D.contains(_)},f.prototype.computeIntersection=function(){if(arguments.length!==3)return h.prototype.computeIntersection.apply(this,arguments);var _=arguments[0],A=arguments[1],D=arguments[2];if(this._isProper=!1,Ae.intersects(A,D,_)&&pt.orientationIndex(A,D,_)===0&&pt.orientationIndex(D,A,_)===0)return this._isProper=!0,(_.equals(A)||_.equals(D))&&(this._isProper=!1),this._result=h.POINT_INTERSECTION,null;this._result=h.NO_INTERSECTION},f.prototype.normalizeToMinimum=function(_,A,D,H,re){re.x=this.smallestInAbsValue(_.x,A.x,D.x,H.x),re.y=this.smallestInAbsValue(_.y,A.y,D.y,H.y),_.x-=re.x,_.y-=re.y,A.x-=re.x,A.y-=re.y,D.x-=re.x,D.y-=re.y,H.x-=re.x,H.y-=re.y},f.prototype.safeHCoordinateIntersection=function(_,A,D,H){var re=null;try{re=me.intersection(_,A,D,H)}catch(ge){if(!(ge instanceof fe))throw ge;re=f.nearestEndpoint(_,A,D,H)}return re},f.prototype.intersection=function(_,A,D,H){var re=this.intersectionWithNormalization(_,A,D,H);return this.isInSegmentEnvelopes(re)||(re=new z(f.nearestEndpoint(_,A,D,H))),this._precisionModel!==null&&this._precisionModel.makePrecise(re),re},f.prototype.smallestInAbsValue=function(_,A,D,H){var re=_,ge=Math.abs(re);return Math.abs(A)<ge&&(re=A,ge=Math.abs(A)),Math.abs(D)<ge&&(re=D,ge=Math.abs(D)),Math.abs(H)<ge&&(re=H),re},f.prototype.checkDD=function(_,A,D,H,re){var ge=te.intersection(_,A,D,H),Ne=this.isInSegmentEnvelopes(ge);Pe.out.println("DD in env = "+Ne+"  --------------------- "+ge),re.distance(ge)>1e-4&&Pe.out.println("Distance = "+re.distance(ge))},f.prototype.intersectionWithNormalization=function(_,A,D,H){var re=new z(_),ge=new z(A),Ne=new z(D),Ye=new z(H),Mt=new z;this.normalizeToEnvCentre(re,ge,Ne,Ye,Mt);var At=this.safeHCoordinateIntersection(re,ge,Ne,Ye);return At.x+=Mt.x,At.y+=Mt.y,At},f.prototype.computeCollinearIntersection=function(_,A,D,H){var re=Ae.intersects(_,A,D),ge=Ae.intersects(_,A,H),Ne=Ae.intersects(D,H,_),Ye=Ae.intersects(D,H,A);return re&&ge?(this._intPt[0]=D,this._intPt[1]=H,h.COLLINEAR_INTERSECTION):Ne&&Ye?(this._intPt[0]=_,this._intPt[1]=A,h.COLLINEAR_INTERSECTION):re&&Ne?(this._intPt[0]=D,this._intPt[1]=_,!D.equals(_)||ge||Ye?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):re&&Ye?(this._intPt[0]=D,this._intPt[1]=A,!D.equals(A)||ge||Ne?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):ge&&Ne?(this._intPt[0]=H,this._intPt[1]=_,!H.equals(_)||re||Ye?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):ge&&Ye?(this._intPt[0]=H,this._intPt[1]=A,!H.equals(A)||re||Ne?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):h.NO_INTERSECTION},f.prototype.normalizeToEnvCentre=function(_,A,D,H,re){var ge=_.x<A.x?_.x:A.x,Ne=_.y<A.y?_.y:A.y,Ye=_.x>A.x?_.x:A.x,Mt=_.y>A.y?_.y:A.y,At=D.x<H.x?D.x:H.x,hr=D.y<H.y?D.y:H.y,gr=D.x>H.x?D.x:H.x,Sr=D.y>H.y?D.y:H.y,Qr=((ge>At?ge:At)+(Ye<gr?Ye:gr))/2,ji=((Ne>hr?Ne:hr)+(Mt<Sr?Mt:Sr))/2;re.x=Qr,re.y=ji,_.x-=re.x,_.y-=re.y,A.x-=re.x,A.y-=re.y,D.x-=re.x,D.y-=re.y,H.x-=re.x,H.y-=re.y},f.prototype.computeIntersect=function(_,A,D,H){if(this._isProper=!1,!Ae.intersects(_,A,D,H))return h.NO_INTERSECTION;var re=pt.orientationIndex(_,A,D),ge=pt.orientationIndex(_,A,H);if(re>0&&ge>0||re<0&&ge<0)return h.NO_INTERSECTION;var Ne=pt.orientationIndex(D,H,_),Ye=pt.orientationIndex(D,H,A);return Ne>0&&Ye>0||Ne<0&&Ye<0?h.NO_INTERSECTION:re===0&&ge===0&&Ne===0&&Ye===0?this.computeCollinearIntersection(_,A,D,H):(re===0||ge===0||Ne===0||Ye===0?(this._isProper=!1,_.equals2D(D)||_.equals2D(H)?this._intPt[0]=_:A.equals2D(D)||A.equals2D(H)?this._intPt[0]=A:re===0?this._intPt[0]=new z(D):ge===0?this._intPt[0]=new z(H):Ne===0?this._intPt[0]=new z(_):Ye===0&&(this._intPt[0]=new z(A))):(this._isProper=!0,this._intPt[0]=this.intersection(_,A,D,H)),h.POINT_INTERSECTION)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.nearestEndpoint=function(_,A,D,H){var re=_,ge=pt.distancePointLine(_,D,H),Ne=pt.distancePointLine(A,D,H);return Ne<ge&&(ge=Ne,re=A),(Ne=pt.distancePointLine(D,_,A))<ge&&(ge=Ne,re=D),(Ne=pt.distancePointLine(H,_,A))<ge&&(ge=Ne,re=H),re},f}(ve),Rt=s(function(){},"ot");Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},Rt.orientationIndex=function(h,f,_){var A=f.x-h.x,D=f.y-h.y,H=_.x-f.x,re=_.y-f.y;return Rt.signOfDet2x2(A,D,H,re)},Rt.signOfDet2x2=function(h,f,_,A){var D=null,H=null,re=null;if(D=1,h===0||A===0)return f===0||_===0?0:f>0?_>0?-D:D:_>0?D:-D;if(f===0||_===0)return A>0?h>0?D:-D:h>0?-D:D;if(f>0?A>0?f<=A||(D=-D,H=h,h=_,_=H,H=f,f=A,A=H):f<=-A?(D=-D,_=-_,A=-A):(H=h,h=-_,_=H,H=f,f=-A,A=H):A>0?-f<=A?(D=-D,h=-h,f=-f):(H=-h,h=_,_=H,H=-f,f=A,A=H):f>=A?(h=-h,f=-f,_=-_,A=-A):(D=-D,H=-h,h=-_,_=H,H=-f,f=-A,A=H),h>0){if(!(_>0)||!(h<=_))return D}else{if(_>0||!(h>=_))return-D;D=-D,h=-h,_=-_}for(;;){if(re=Math.floor(_/h),_-=re*h,(A-=re*f)<0)return-D;if(A>f)return D;if(h>_+_){if(f<A+A)return D}else{if(f>A+A)return-D;_=h-_,A=f-A,D=-D}if(A===0)return _===0?0:-D;if(_===0||(re=Math.floor(h/_),h-=re*_,(f-=re*A)<0))return D;if(f>A)return-D;if(_>h+h){if(A<f+f)return-D}else{if(A>f+f)return D;h=_-h,f=A-f,D=-D}if(f===0)return h===0?0:D;if(h===0)return-D}};var Et=s(function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var h=arguments[0];this._p=h},"st");Et.prototype.countSegment=function(h,f){if(h.x<this._p.x&&f.x<this._p.x)return null;if(this._p.x===f.x&&this._p.y===f.y)return this._isPointOnSegment=!0,null;if(h.y===this._p.y&&f.y===this._p.y){var _=h.x,A=f.x;return _>A&&(_=f.x,A=h.x),this._p.x>=_&&this._p.x<=A&&(this._isPointOnSegment=!0),null}if(h.y>this._p.y&&f.y<=this._p.y||f.y>this._p.y&&h.y<=this._p.y){var D=h.x-this._p.x,H=h.y-this._p.y,re=f.x-this._p.x,ge=f.y-this._p.y,Ne=Rt.signOfDet2x2(D,H,re,ge);if(Ne===0)return this._isPointOnSegment=!0,null;ge<H&&(Ne=-Ne),Ne>0&&this._crossingCount++}},Et.prototype.isPointInPolygon=function(){return this.getLocation()!==V.EXTERIOR},Et.prototype.getLocation=function(){return this._isPointOnSegment?V.BOUNDARY:this._crossingCount%2==1?V.INTERIOR:V.EXTERIOR},Et.prototype.isOnSegment=function(){return this._isPointOnSegment},Et.prototype.interfaces_=function(){return[]},Et.prototype.getClass=function(){return Et},Et.locatePointInRing=function(){if(arguments[0]instanceof z&&Y(arguments[1],pe)){for(var h=arguments[0],f=arguments[1],_=new Et(h),A=new z,D=new z,H=1;H<f.size();H++)if(f.getCoordinate(H,A),f.getCoordinate(H-1,D),_.countSegment(A,D),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof z&&arguments[1]instanceof Array){for(var re=arguments[0],ge=arguments[1],Ne=new Et(re),Ye=1;Ye<ge.length;Ye++){var Mt=ge[Ye],At=ge[Ye-1];if(Ne.countSegment(Mt,At),Ne.isOnSegment())return Ne.getLocation()}return Ne.getLocation()}};var pt=s(function(){},"at"),Yt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt},pt.orientationIndex=function(h,f,_){return te.orientationIndex(h,f,_)},pt.signedArea=function(){if(arguments[0]instanceof Array){var h=arguments[0];if(h.length<3)return 0;for(var f=0,_=h[0].x,A=1;A<h.length-1;A++){var D=h[A].x-_,H=h[A+1].y;f+=D*(h[A-1].y-H)}return f/2}if(Y(arguments[0],pe)){var re=arguments[0],ge=re.size();if(ge<3)return 0;var Ne=new z,Ye=new z,Mt=new z;re.getCoordinate(0,Ye),re.getCoordinate(1,Mt);var At=Ye.x;Mt.x-=At;for(var hr=0,gr=1;gr<ge-1;gr++)Ne.y=Ye.y,Ye.x=Mt.x,Ye.y=Mt.y,re.getCoordinate(gr+1,Mt),Mt.x-=At,hr+=Ye.x*(Ne.y-Mt.y);return hr/2}},pt.distanceLineLine=function(h,f,_,A){if(h.equals(f))return pt.distancePointLine(h,_,A);if(_.equals(A))return pt.distancePointLine(A,h,f);var D=!1;if(Ae.intersects(h,f,_,A)){var H=(f.x-h.x)*(A.y-_.y)-(f.y-h.y)*(A.x-_.x);if(H===0)D=!0;else{var re=(h.y-_.y)*(A.x-_.x)-(h.x-_.x)*(A.y-_.y),ge=((h.y-_.y)*(f.x-h.x)-(h.x-_.x)*(f.y-h.y))/H,Ne=re/H;(Ne<0||Ne>1||ge<0||ge>1)&&(D=!0)}}else D=!0;return D?he.min(pt.distancePointLine(h,_,A),pt.distancePointLine(f,_,A),pt.distancePointLine(_,h,f),pt.distancePointLine(A,h,f)):0},pt.isPointInRing=function(h,f){return pt.locatePointInRing(h,f)!==V.EXTERIOR},pt.computeLength=function(h){var f=h.size();if(f<=1)return 0;var _=0,A=new z;h.getCoordinate(0,A);for(var D=A.x,H=A.y,re=1;re<f;re++){h.getCoordinate(re,A);var ge=A.x,Ne=A.y,Ye=ge-D,Mt=Ne-H;_+=Math.sqrt(Ye*Ye+Mt*Mt),D=ge,H=Ne}return _},pt.isCCW=function(h){var f=h.length-1;if(f<3)throw new T("Ring has fewer than 4 points, so orientation cannot be determined");for(var _=h[0],A=0,D=1;D<=f;D++){var H=h[D];H.y>_.y&&(_=H,A=D)}var re=A;do(re-=1)<0&&(re=f);while(h[re].equals2D(_)&&re!==A);var ge=A;do ge=(ge+1)%f;while(h[ge].equals2D(_)&&ge!==A);var Ne=h[re],Ye=h[ge];if(Ne.equals2D(_)||Ye.equals2D(_)||Ne.equals2D(Ye))return!1;var Mt=pt.computeOrientation(Ne,_,Ye),At=!1;return At=Mt===0?Ne.x>Ye.x:Mt>0,At},pt.locatePointInRing=function(h,f){return Et.locatePointInRing(h,f)},pt.distancePointLinePerpendicular=function(h,f,_){var A=(_.x-f.x)*(_.x-f.x)+(_.y-f.y)*(_.y-f.y),D=((f.y-h.y)*(_.x-f.x)-(f.x-h.x)*(_.y-f.y))/A;return Math.abs(D)*Math.sqrt(A)},pt.computeOrientation=function(h,f,_){return pt.orientationIndex(h,f,_)},pt.distancePointLine=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];if(f.length===0)throw new T("Line array must contain at least one vertex");for(var _=h.distance(f[0]),A=0;A<f.length-1;A++){var D=pt.distancePointLine(h,f[A],f[A+1]);D<_&&(_=D)}return _}if(arguments.length===3){var H=arguments[0],re=arguments[1],ge=arguments[2];if(re.x===ge.x&&re.y===ge.y)return H.distance(re);var Ne=(ge.x-re.x)*(ge.x-re.x)+(ge.y-re.y)*(ge.y-re.y),Ye=((H.x-re.x)*(ge.x-re.x)+(H.y-re.y)*(ge.y-re.y))/Ne;if(Ye<=0)return H.distance(re);if(Ye>=1)return H.distance(ge);var Mt=((re.y-H.y)*(ge.x-re.x)-(re.x-H.x)*(ge.y-re.y))/Ne;return Math.abs(Mt)*Math.sqrt(Ne)}},pt.isOnLine=function(h,f){for(var _=new It,A=1;A<f.length;A++){var D=f[A-1],H=f[A];if(_.computeIntersection(h,D,H),_.hasIntersection())return!0}return!1},Yt.CLOCKWISE.get=function(){return-1},Yt.RIGHT.get=function(){return pt.CLOCKWISE},Yt.COUNTERCLOCKWISE.get=function(){return 1},Yt.LEFT.get=function(){return pt.COUNTERCLOCKWISE},Yt.COLLINEAR.get=function(){return 0},Yt.STRAIGHT.get=function(){return pt.COLLINEAR},Object.defineProperties(pt,Yt);var Kt=s(function(){},"lt");Kt.prototype.filter=function(h){},Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var $t=s(function(){var h=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=h,this._SRID=h.getSRID()},"ct"),jt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};$t.prototype.isGeometryCollection=function(){return this.getSortIndex()===$t.SORTINDEX_GEOMETRYCOLLECTION},$t.prototype.getFactory=function(){return this._factory},$t.prototype.getGeometryN=function(h){return this},$t.prototype.getArea=function(){return 0},$t.prototype.isRectangle=function(){return!1},$t.prototype.equals=function(){if(arguments[0]instanceof $t){var h=arguments[0];return h!==null&&this.equalsTopo(h)}if(arguments[0]instanceof Object){var f=arguments[0];if(!(f instanceof $t))return!1;var _=f;return this.equalsExact(_)}},$t.prototype.equalsExact=function(h){return this===h||this.equalsExact(h,0)},$t.prototype.geometryChanged=function(){this.apply($t.geometryChangedFilter)},$t.prototype.geometryChangedAction=function(){this._envelope=null},$t.prototype.equalsNorm=function(h){return h!==null&&this.norm().equalsExact(h.norm())},$t.prototype.getLength=function(){return 0},$t.prototype.getNumGeometries=function(){return 1},$t.prototype.compareTo=function(){if(arguments.length===1){var h=arguments[0],f=h;return this.getSortIndex()!==f.getSortIndex()?this.getSortIndex()-f.getSortIndex():this.isEmpty()&&f.isEmpty()?0:this.isEmpty()?-1:f.isEmpty()?1:this.compareToSameClass(h)}if(arguments.length===2){var _=arguments[0],A=arguments[1];return this.getSortIndex()!==_.getSortIndex()?this.getSortIndex()-_.getSortIndex():this.isEmpty()&&_.isEmpty()?0:this.isEmpty()?-1:_.isEmpty()?1:this.compareToSameClass(_,A)}},$t.prototype.getUserData=function(){return this._userData},$t.prototype.getSRID=function(){return this._SRID},$t.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},$t.prototype.checkNotGeometryCollection=function(h){if(h.getSortIndex()===$t.SORTINDEX_GEOMETRYCOLLECTION)throw new T("This method does not support GeometryCollection arguments")},$t.prototype.equal=function(h,f,_){return _===0?h.equals(f):h.distance(f)<=_},$t.prototype.norm=function(){var h=this.copy();return h.normalize(),h},$t.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},$t.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ae(this._envelope)},$t.prototype.setSRID=function(h){this._SRID=h},$t.prototype.setUserData=function(h){this._userData=h},$t.prototype.compare=function(h,f){for(var _=h.iterator(),A=f.iterator();_.hasNext()&&A.hasNext();){var D=_.next(),H=A.next(),re=D.compareTo(H);if(re!==0)return re}return _.hasNext()?1:A.hasNext()?-1:0},$t.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},$t.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===$t.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===$t.SORTINDEX_MULTIPOINT||this.getSortIndex()===$t.SORTINDEX_MULTILINESTRING||this.getSortIndex()===$t.SORTINDEX_MULTIPOLYGON},$t.prototype.interfaces_=function(){return[B,k,i]},$t.prototype.getClass=function(){return $t},$t.hasNonEmptyElements=function(h){for(var f=0;f<h.length;f++)if(!h[f].isEmpty())return!0;return!1},$t.hasNullElements=function(h){for(var f=0;f<h.length;f++)if(h[f]===null)return!0;return!1},jt.serialVersionUID.get=function(){return 8763622679187377e3},jt.SORTINDEX_POINT.get=function(){return 0},jt.SORTINDEX_MULTIPOINT.get=function(){return 1},jt.SORTINDEX_LINESTRING.get=function(){return 2},jt.SORTINDEX_LINEARRING.get=function(){return 3},jt.SORTINDEX_MULTILINESTRING.get=function(){return 4},jt.SORTINDEX_POLYGON.get=function(){return 5},jt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},jt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},jt.geometryChangedFilter.get=function(){return Nt},Object.defineProperties($t,jt);var Nt=s(function(){},"ht");Nt.interfaces_=function(){return[Kt]},Nt.filter=function(h){h.geometryChangedAction()};var Fe=s(function(){},"ft");Fe.prototype.filter=function(h){},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var Xe=s(function(){},"gt"),ht={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Xe.prototype.isInBoundary=function(h){},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe},ht.Mod2BoundaryNodeRule.get=function(){return rr},ht.EndPointBoundaryNodeRule.get=function(){return ar},ht.MultiValentEndPointBoundaryNodeRule.get=function(){return Vr},ht.MonoValentEndPointBoundaryNodeRule.get=function(){return Qe},ht.MOD2_BOUNDARY_RULE.get=function(){return new rr},ht.ENDPOINT_BOUNDARY_RULE.get=function(){return new ar},ht.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Vr},ht.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Qe},ht.OGC_SFS_BOUNDARY_RULE.get=function(){return Xe.MOD2_BOUNDARY_RULE},Object.defineProperties(Xe,ht);var rr=s(function(){},"yt");rr.prototype.isInBoundary=function(h){return h%2==1},rr.prototype.interfaces_=function(){return[Xe]},rr.prototype.getClass=function(){return rr};var ar=s(function(){},"_t");ar.prototype.isInBoundary=function(h){return h>0},ar.prototype.interfaces_=function(){return[Xe]},ar.prototype.getClass=function(){return ar};var Vr=s(function(){},"mt");Vr.prototype.isInBoundary=function(h){return h>1},Vr.prototype.interfaces_=function(){return[Xe]},Vr.prototype.getClass=function(){return Vr};var Qe=s(function(){},"vt");Qe.prototype.isInBoundary=function(h){return h===1},Qe.prototype.interfaces_=function(){return[Xe]},Qe.prototype.getClass=function(){return Qe};var er=s(function(){},"It");er.prototype.add=function(){},er.prototype.addAll=function(){},er.prototype.isEmpty=function(){},er.prototype.iterator=function(){},er.prototype.size=function(){},er.prototype.toArray=function(){},er.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var Oe=s(function(){},"Et");Oe.prototype.hasNext=function(){},Oe.prototype.next=function(){},Oe.prototype.remove=function(){};var se=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.get=function(){},f.prototype.set=function(){},f.prototype.isEmpty=function(){},f}(er);(a.prototype=new Error).name="NoSuchElementException";var ue=function(h){function f(){h.call(this),this.array_=[],arguments[0]instanceof er&&this.addAll(arguments[0])}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.ensureCapacity=function(){},f.prototype.interfaces_=function(){return[h,er]},f.prototype.add=function(_){return arguments.length===1?this.array_.push(_):this.array_.splice(arguments[0],arguments[1]),!0},f.prototype.clear=function(){this.array_=[]},f.prototype.addAll=function(_){for(var A=_.iterator();A.hasNext();)this.add(A.next());return!0},f.prototype.set=function(_,A){var D=this.array_[_];return this.array_[_]=A,D},f.prototype.iterator=function(){return new Se(this)},f.prototype.get=function(_){if(_<0||_>=this.size())throw new n;return this.array_[_]},f.prototype.isEmpty=function(){return this.array_.length===0},f.prototype.size=function(){return this.array_.length},f.prototype.toArray=function(){for(var _=[],A=0,D=this.array_.length;A<D;A++)_.push(this.array_[A]);return _},f.prototype.remove=function(_){for(var A=!1,D=0,H=this.array_.length;D<H;D++)if(this.array_[D]===_){this.array_.splice(D,1),A=!0;break}return A},f}(se),Se=function(h){function f(_){h.call(this),this.arrayList_=_,this.position_=0}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new a;return this.arrayList_.get(this.position_++)},f.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},f.prototype.set=function(_){return this.arrayList_.set(this.position_-1,_)},f.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},f}(Oe),ze=function(h){function f(){if(h.call(this),arguments.length!==0){if(arguments.length===1){var A=arguments[0];this.ensureCapacity(A.length),this.add(A,!0)}else if(arguments.length===2){var D=arguments[0],H=arguments[1];this.ensureCapacity(D.length),this.add(D,H)}}}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={coordArrayType:{configurable:!0}};return _.coordArrayType.get=function(){return new Array(0).fill(null)},f.prototype.getCoordinate=function(A){return this.get(A)},f.prototype.addAll=function(){if(arguments.length===2){for(var A=arguments[0],D=arguments[1],H=!1,re=A.iterator();re.hasNext();)this.add(re.next(),D),H=!0;return H}return h.prototype.addAll.apply(this,arguments)},f.prototype.clone=function(){for(var A=h.prototype.clone.call(this),D=0;D<this.size();D++)A.add(D,this.get(D).copy());return A},f.prototype.toCoordinateArray=function(){return this.toArray(f.coordArrayType)},f.prototype.add=function(){if(arguments.length===1){var A=arguments[0];h.prototype.add.call(this,A)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var D=arguments[0],H=arguments[1];return this.add(D,H,!0),!0}if(arguments[0]instanceof z&&typeof arguments[1]=="boolean"){var re=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(re))return null;h.prototype.add.call(this,re)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ge=arguments[0],Ne=arguments[1];return this.add(ge,Ne),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Ye=arguments[0],Mt=arguments[1];if(arguments[2])for(var At=0;At<Ye.length;At++)this.add(Ye[At],Mt);else for(var hr=Ye.length-1;hr>=0;hr--)this.add(Ye[hr],Mt);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof z){var gr=arguments[0],Sr=arguments[1];if(!arguments[2]){var Qr=this.size();if(Qr>0&&(gr>0&&this.get(gr-1).equals2D(Sr)||gr<Qr&&this.get(gr).equals2D(Sr)))return null}h.prototype.add.call(this,gr,Sr)}}else if(arguments.length===4){var ji=arguments[0],$n=arguments[1],rs=arguments[2],gu=arguments[3],fh=1;rs>gu&&(fh=-1);for(var Fv=rs;Fv!==gu;Fv+=fh)this.add(ji[Fv],$n);return!0}},f.prototype.closeRing=function(){this.size()>0&&this.add(new z(this.get(0)),!1)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},Object.defineProperties(f,_),f}(ue),Re=s(function(){},"Lt"),yt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};yt.ForwardComparator.get=function(){return st},yt.BidirectionalComparator.get=function(){return kt},yt.coordArrayType.get=function(){return new Array(0).fill(null)},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re},Re.isRing=function(h){return!(h.length<4)&&!!h[0].equals2D(h[h.length-1])},Re.ptNotInList=function(h,f){for(var _=0;_<h.length;_++){var A=h[_];if(Re.indexOf(A,f)<0)return A}return null},Re.scroll=function(h,f){var _=Re.indexOf(f,h);if(_<0)return null;var A=new Array(h.length).fill(null);Pe.arraycopy(h,_,A,0,h.length-_),Pe.arraycopy(h,0,A,h.length-_,_),Pe.arraycopy(A,0,h,0,h.length)},Re.equals=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];if(h===f)return!0;if(h===null||f===null||h.length!==f.length)return!1;for(var _=0;_<h.length;_++)if(!h[_].equals(f[_]))return!1;return!0}if(arguments.length===3){var A=arguments[0],D=arguments[1],H=arguments[2];if(A===D)return!0;if(A===null||D===null||A.length!==D.length)return!1;for(var re=0;re<A.length;re++)if(H.compare(A[re],D[re])!==0)return!1;return!0}},Re.intersection=function(h,f){for(var _=new ze,A=0;A<h.length;A++)f.intersects(h[A])&&_.add(h[A],!0);return _.toCoordinateArray()},Re.hasRepeatedPoints=function(h){for(var f=1;f<h.length;f++)if(h[f-1].equals(h[f]))return!0;return!1},Re.removeRepeatedPoints=function(h){return Re.hasRepeatedPoints(h)?new ze(h,!1).toCoordinateArray():h},Re.reverse=function(h){for(var f=h.length-1,_=Math.trunc(f/2),A=0;A<=_;A++){var D=h[A];h[A]=h[f-A],h[f-A]=D}},Re.removeNull=function(h){for(var f=0,_=0;_<h.length;_++)h[_]!==null&&f++;var A=new Array(f).fill(null);if(f===0)return A;for(var D=0,H=0;H<h.length;H++)h[H]!==null&&(A[D++]=h[H]);return A},Re.copyDeep=function(){if(arguments.length===1){for(var h=arguments[0],f=new Array(h.length).fill(null),_=0;_<h.length;_++)f[_]=new z(h[_]);return f}if(arguments.length===5)for(var A=arguments[0],D=arguments[1],H=arguments[2],re=arguments[3],ge=arguments[4],Ne=0;Ne<ge;Ne++)H[re+Ne]=new z(A[D+Ne])},Re.isEqualReversed=function(h,f){for(var _=0;_<h.length;_++){var A=h[_],D=f[h.length-_-1];if(A.compareTo(D)!==0)return!1}return!0},Re.envelope=function(h){for(var f=new Ae,_=0;_<h.length;_++)f.expandToInclude(h[_]);return f},Re.toCoordinateArray=function(h){return h.toArray(Re.coordArrayType)},Re.atLeastNCoordinatesOrNothing=function(h,f){return f.length>=h?f:[]},Re.indexOf=function(h,f){for(var _=0;_<f.length;_++)if(h.equals(f[_]))return _;return-1},Re.increasingDirection=function(h){for(var f=0;f<Math.trunc(h.length/2);f++){var _=h.length-1-f,A=h[f].compareTo(h[_]);if(A!==0)return A}return 1},Re.compare=function(h,f){for(var _=0;_<h.length&&_<f.length;){var A=h[_].compareTo(f[_]);if(A!==0)return A;_++}return _<f.length?-1:_<h.length?1:0},Re.minCoordinate=function(h){for(var f=null,_=0;_<h.length;_++)(f===null||f.compareTo(h[_])>0)&&(f=h[_]);return f},Re.extract=function(h,f,_){f=he.clamp(f,0,h.length);var A=(_=he.clamp(_,-1,h.length))-f+1;_<0&&(A=0),f>=h.length&&(A=0),_<f&&(A=0);var D=new Array(A).fill(null);if(A===0)return D;for(var H=0,re=f;re<=_;re++)D[H++]=h[re];return D},Object.defineProperties(Re,yt);var st=s(function(){},"wt");st.prototype.compare=function(h,f){return Re.compare(h,f)},st.prototype.interfaces_=function(){return[U]},st.prototype.getClass=function(){return st};var kt=s(function(){},"Ot");kt.prototype.compare=function(h,f){var _=h,A=f;if(_.length<A.length)return-1;if(_.length>A.length)return 1;if(_.length===0)return 0;var D=Re.compare(_,A);return Re.isEqualReversed(_,A)?0:D},kt.prototype.OLDcompare=function(h,f){var _=h,A=f;if(_.length<A.length)return-1;if(_.length>A.length)return 1;if(_.length===0)return 0;for(var D=Re.increasingDirection(_),H=Re.increasingDirection(A),re=D>0?0:_.length-1,ge=H>0?0:_.length-1,Ne=0;Ne<_.length;Ne++){var Ye=_[re].compareTo(A[ge]);if(Ye!==0)return Ye;re+=D,ge+=H}return 0},kt.prototype.interfaces_=function(){return[U]},kt.prototype.getClass=function(){return kt};var mt=s(function(){},"Tt");mt.prototype.get=function(){},mt.prototype.put=function(){},mt.prototype.size=function(){},mt.prototype.values=function(){},mt.prototype.entrySet=function(){};var Gt=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f}(mt);(o.prototype=new Error).name="OperationNotSupported",(l.prototype=new er).contains=function(){};var ke=function(h){function f(){h.call(this),this.array_=[],arguments[0]instanceof er&&this.addAll(arguments[0])}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.contains=function(_){for(var A=0,D=this.array_.length;A<D;A++)if(this.array_[A]===_)return!0;return!1},f.prototype.add=function(_){return!this.contains(_)&&(this.array_.push(_),!0)},f.prototype.addAll=function(_){for(var A=_.iterator();A.hasNext();)this.add(A.next());return!0},f.prototype.remove=function(_){throw new Error},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return this.array_.length===0},f.prototype.toArray=function(){for(var _=[],A=0,D=this.array_.length;A<D;A++)_.push(this.array_[A]);return _},f.prototype.iterator=function(){return new $e(this)},f}(l),$e=function(h){function f(_){h.call(this),this.hashSet_=_,this.position_=0}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new a;return this.hashSet_.array_[this.position_++]},f.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},f.prototype.remove=function(){throw new o},f}(Oe),ot=0;(v.prototype=new Gt).get=function(h){for(var f=this.root_;f!==null;){var _=h.compareTo(f.key);if(_<0)f=f.left;else{if(!(_>0))return f.value;f=f.right}}return null},v.prototype.put=function(h,f){if(this.root_===null)return this.root_={key:h,value:f,left:null,right:null,parent:null,color:ot,getValue:s(function(){return this.value},"getValue"),getKey:s(function(){return this.key},"getKey")},this.size_=1,null;var _,A,D=this.root_;do if(_=D,(A=h.compareTo(D.key))<0)D=D.left;else{if(!(A>0)){var H=D.value;return D.value=f,H}D=D.right}while(D!==null);var re={key:h,left:null,right:null,value:f,parent:_,color:ot,getValue:s(function(){return this.value},"getValue"),getKey:s(function(){return this.key},"getKey")};return A<0?_.left=re:_.right=re,this.fixAfterInsertion(re),this.size_++,null},v.prototype.fixAfterInsertion=function(h){for(h.color=1;h!=null&&h!==this.root_&&h.parent.color===1;)if(c(h)===m(c(c(h)))){var f=y(c(c(h)));u(f)===1?(p(c(h),ot),p(f,ot),p(c(c(h)),1),h=c(c(h))):(h===y(c(h))&&(h=c(h),this.rotateLeft(h)),p(c(h),ot),p(c(c(h)),1),this.rotateRight(c(c(h))))}else{var _=m(c(c(h)));u(_)===1?(p(c(h),ot),p(_,ot),p(c(c(h)),1),h=c(c(h))):(h===m(c(h))&&(h=c(h),this.rotateRight(h)),p(c(h),ot),p(c(c(h)),1),this.rotateLeft(c(c(h))))}this.root_.color=ot},v.prototype.values=function(){var h=new ue,f=this.getFirstEntry();if(f!==null)for(h.add(f.value);(f=v.successor(f))!==null;)h.add(f.value);return h},v.prototype.entrySet=function(){var h=new ke,f=this.getFirstEntry();if(f!==null)for(h.add(f);(f=v.successor(f))!==null;)h.add(f);return h},v.prototype.rotateLeft=function(h){if(h!=null){var f=h.right;h.right=f.left,f.left!=null&&(f.left.parent=h),f.parent=h.parent,h.parent===null?this.root_=f:h.parent.left===h?h.parent.left=f:h.parent.right=f,f.left=h,h.parent=f}},v.prototype.rotateRight=function(h){if(h!=null){var f=h.left;h.left=f.right,f.right!=null&&(f.right.parent=h),f.parent=h.parent,h.parent===null?this.root_=f:h.parent.right===h?h.parent.right=f:h.parent.left=f,f.right=h,h.parent=f}},v.prototype.getFirstEntry=function(){var h=this.root_;if(h!=null)for(;h.left!=null;)h=h.left;return h},v.successor=function(h){if(h===null)return null;if(h.right!==null){for(var f=h.right;f.left!==null;)f=f.left;return f}for(var _=h.parent,A=h;_!==null&&A===_.right;)A=_,_=_.parent;return _},v.prototype.size=function(){return this.size_};var Ft=s(function(){},"At");Ft.prototype.interfaces_=function(){return[]},Ft.prototype.getClass=function(){return Ft},w.prototype=new l,(E.prototype=new w).contains=function(h){for(var f=0,_=this.array_.length;f<_;f++)if(this.array_[f].compareTo(h)===0)return!0;return!1},E.prototype.add=function(h){if(this.contains(h))return!1;for(var f=0,_=this.array_.length;f<_;f++)if(this.array_[f].compareTo(h)===1)return this.array_.splice(f,0,h),!0;return this.array_.push(h),!0},E.prototype.addAll=function(h){for(var f=h.iterator();f.hasNext();)this.add(f.next());return!0},E.prototype.remove=function(h){throw new o},E.prototype.size=function(){return this.array_.length},E.prototype.isEmpty=function(){return this.array_.length===0},E.prototype.toArray=function(){for(var h=[],f=0,_=this.array_.length;f<_;f++)h.push(this.array_[f]);return h},E.prototype.iterator=function(){return new Ht(this)};var Ht=s(function(h){this.treeSet_=h,this.position_=0},"Ft");Ht.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new a;return this.treeSet_.array_[this.position_++]},Ht.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ht.prototype.remove=function(){throw new o};var fr=s(function(){},"Gt");fr.sort=function(){var h,f,_,A,D=arguments[0];if(arguments.length===1)A=s(function(re,ge){return re.compareTo(ge)},"i"),D.sort(A);else if(arguments.length===2)_=arguments[1],A=s(function(re,ge){return _.compare(re,ge)},"i"),D.sort(A);else if(arguments.length===3){(f=D.slice(arguments[1],arguments[2])).sort();var H=D.slice(0,arguments[1]).concat(f,D.slice(arguments[2],D.length));for(D.splice(0,D.length),h=0;h<H.length;h++)D.push(H[h])}else if(arguments.length===4)for(f=D.slice(arguments[1],arguments[2]),_=arguments[3],A=s(function(re,ge){return _.compare(re,ge)},"i"),f.sort(A),H=D.slice(0,arguments[1]).concat(f,D.slice(arguments[2],D.length)),D.splice(0,D.length),h=0;h<H.length;h++)D.push(H[h])},fr.asList=function(h){for(var f=new ue,_=0,A=h.length;_<A;_++)f.add(h[_]);return f};var nr=s(function(){},"qt"),Kr={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Kr.P.get=function(){return 0},Kr.L.get=function(){return 1},Kr.A.get=function(){return 2},Kr.FALSE.get=function(){return-1},Kr.TRUE.get=function(){return-2},Kr.DONTCARE.get=function(){return-3},Kr.SYM_FALSE.get=function(){return"F"},Kr.SYM_TRUE.get=function(){return"T"},Kr.SYM_DONTCARE.get=function(){return"*"},Kr.SYM_P.get=function(){return"0"},Kr.SYM_L.get=function(){return"1"},Kr.SYM_A.get=function(){return"2"},nr.prototype.interfaces_=function(){return[]},nr.prototype.getClass=function(){return nr},nr.toDimensionSymbol=function(h){switch(h){case nr.FALSE:return nr.SYM_FALSE;case nr.TRUE:return nr.SYM_TRUE;case nr.DONTCARE:return nr.SYM_DONTCARE;case nr.P:return nr.SYM_P;case nr.L:return nr.SYM_L;case nr.A:return nr.SYM_A}throw new T("Unknown dimension value: "+h)},nr.toDimensionValue=function(h){switch(le.toUpperCase(h)){case nr.SYM_FALSE:return nr.FALSE;case nr.SYM_TRUE:return nr.TRUE;case nr.SYM_DONTCARE:return nr.DONTCARE;case nr.SYM_P:return nr.P;case nr.SYM_L:return nr.L;case nr.SYM_A:return nr.A}throw new T("Unknown dimension symbol: "+h)},Object.defineProperties(nr,Kr);var ai=s(function(){},"Vt");ai.prototype.filter=function(h){},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai};var Jr=s(function(){},"Ut");Jr.prototype.filter=function(h,f){},Jr.prototype.isDone=function(){},Jr.prototype.isGeometryChanged=function(){},Jr.prototype.interfaces_=function(){return[]},Jr.prototype.getClass=function(){return Jr};var Cr=function(h){function f(A,D){if(h.call(this,D),this._geometries=A||[],h.hasNullElements(this._geometries))throw new T("geometries must not contain null elements")}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){for(var A=new Ae,D=0;D<this._geometries.length;D++)A.expandToInclude(this._geometries[D].getEnvelopeInternal());return A},f.prototype.getGeometryN=function(A){return this._geometries[A]},f.prototype.getSortIndex=function(){return h.SORTINDEX_GEOMETRYCOLLECTION},f.prototype.getCoordinates=function(){for(var A=new Array(this.getNumPoints()).fill(null),D=-1,H=0;H<this._geometries.length;H++)for(var re=this._geometries[H].getCoordinates(),ge=0;ge<re.length;ge++)A[++D]=re[ge];return A},f.prototype.getArea=function(){for(var A=0,D=0;D<this._geometries.length;D++)A+=this._geometries[D].getArea();return A},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];if(!this.isEquivalentClass(A))return!1;var H=A;if(this._geometries.length!==H._geometries.length)return!1;for(var re=0;re<this._geometries.length;re++)if(!this._geometries[re].equalsExact(H._geometries[re],D))return!1;return!0}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){for(var A=0;A<this._geometries.length;A++)this._geometries[A].normalize();fr.sort(this._geometries)},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},f.prototype.getBoundaryDimension=function(){for(var A=nr.FALSE,D=0;D<this._geometries.length;D++)A=Math.max(A,this._geometries[D].getBoundaryDimension());return A},f.prototype.getDimension=function(){for(var A=nr.FALSE,D=0;D<this._geometries.length;D++)A=Math.max(A,this._geometries[D].getDimension());return A},f.prototype.getLength=function(){for(var A=0,D=0;D<this._geometries.length;D++)A+=this._geometries[D].getLength();return A},f.prototype.getNumPoints=function(){for(var A=0,D=0;D<this._geometries.length;D++)A+=this._geometries[D].getNumPoints();return A},f.prototype.getNumGeometries=function(){return this._geometries.length},f.prototype.reverse=function(){for(var A=this._geometries.length,D=new Array(A).fill(null),H=0;H<this._geometries.length;H++)D[H]=this._geometries[H].reverse();return this.getFactory().createGeometryCollection(D)},f.prototype.compareToSameClass=function(){if(arguments.length===1){var A=arguments[0],D=new E(fr.asList(this._geometries)),H=new E(fr.asList(A._geometries));return this.compare(D,H)}if(arguments.length===2){for(var re=arguments[0],ge=arguments[1],Ne=re,Ye=this.getNumGeometries(),Mt=Ne.getNumGeometries(),At=0;At<Ye&&At<Mt;){var hr=this.getGeometryN(At),gr=Ne.getGeometryN(At),Sr=hr.compareToSameClass(gr,ge);if(Sr!==0)return Sr;At++}return At<Ye?1:At<Mt?-1:0}},f.prototype.apply=function(){if(Y(arguments[0],Fe))for(var A=arguments[0],D=0;D<this._geometries.length;D++)this._geometries[D].apply(A);else if(Y(arguments[0],Jr)){var H=arguments[0];if(this._geometries.length===0)return null;for(var re=0;re<this._geometries.length&&(this._geometries[re].apply(H),!H.isDone());re++);H.isGeometryChanged()&&this.geometryChanged()}else if(Y(arguments[0],ai)){var ge=arguments[0];ge.filter(this);for(var Ne=0;Ne<this._geometries.length;Ne++)this._geometries[Ne].apply(ge)}else if(Y(arguments[0],Kt)){var Ye=arguments[0];Ye.filter(this);for(var Mt=0;Mt<this._geometries.length;Mt++)this._geometries[Mt].apply(Ye)}},f.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Me.shouldNeverReachHere(),null},f.prototype.clone=function(){var A=h.prototype.clone.call(this);A._geometries=new Array(this._geometries.length).fill(null);for(var D=0;D<this._geometries.length;D++)A._geometries[D]=this._geometries[D].clone();return A},f.prototype.getGeometryType=function(){return"GeometryCollection"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),D=0;D<A.length;D++)A[D]=this._geometries[D].copy();return new f(A,this._factory)},f.prototype.isEmpty=function(){for(var A=0;A<this._geometries.length;A++)if(!this._geometries[A].isEmpty())return!1;return!0},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(f,_),f}($t),Ei=function(h){function f(){h.apply(this,arguments)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_MULTILINESTRING},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];return!!this.isEquivalentClass(A)&&h.prototype.equalsExact.call(this,A,D)}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return this.isClosed()?nr.FALSE:0},f.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var A=0;A<this._geometries.length;A++)if(!this._geometries[A].isClosed())return!1;return!0},f.prototype.getDimension=function(){return 1},f.prototype.reverse=function(){for(var A=this._geometries.length,D=new Array(A).fill(null),H=0;H<this._geometries.length;H++)D[A-1-H]=this._geometries[H].reverse();return this.getFactory().createMultiLineString(D)},f.prototype.getBoundary=function(){return new Hr(this).getBoundary()},f.prototype.getGeometryType=function(){return"MultiLineString"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),D=0;D<A.length;D++)A[D]=this._geometries[D].copy();return new f(A,this._factory)},f.prototype.interfaces_=function(){return[Ft]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(f,_),f}(Cr),Hr=s(function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var h=arguments[0],f=Xe.MOD2_BOUNDARY_RULE;this._geom=h,this._geomFact=h.getFactory(),this._bnRule=f}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this._geom=_,this._geomFact=_.getFactory(),this._bnRule=A}},"Yt");Hr.prototype.boundaryMultiLineString=function(h){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var f=this.computeBoundaryCoordinates(h);return f.length===1?this._geomFact.createPoint(f[0]):this._geomFact.createMultiPointFromCoords(f)},Hr.prototype.getBoundary=function(){return this._geom instanceof Je?this.boundaryLineString(this._geom):this._geom instanceof Ei?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Hr.prototype.boundaryLineString=function(h){return this._geom.isEmpty()?this.getEmptyMultiPoint():h.isClosed()?this._bnRule.isInBoundary(2)?h.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([h.getStartPoint(),h.getEndPoint()])},Hr.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Hr.prototype.computeBoundaryCoordinates=function(h){var f=new ue;this._endpointMap=new v;for(var _=0;_<h.getNumGeometries();_++){var A=h.getGeometryN(_);A.getNumPoints()!==0&&(this.addEndpoint(A.getCoordinateN(0)),this.addEndpoint(A.getCoordinateN(A.getNumPoints()-1)))}for(var D=this._endpointMap.entrySet().iterator();D.hasNext();){var H=D.next(),re=H.getValue().count;this._bnRule.isInBoundary(re)&&f.add(H.getKey())}return Re.toCoordinateArray(f)},Hr.prototype.addEndpoint=function(h){var f=this._endpointMap.get(h);f===null&&(f=new en,this._endpointMap.put(h,f)),f.count++},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr},Hr.getBoundary=function(){if(arguments.length===1){var h=arguments[0];return new Hr(h).getBoundary()}if(arguments.length===2){var f=arguments[0],_=arguments[1];return new Hr(f,_).getBoundary()}};var en=s(function(){this.count=null},"kt");en.prototype.interfaces_=function(){return[]},en.prototype.getClass=function(){return en};var Hi=s(function(){},"jt"),En={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi},Hi.chars=function(h,f){for(var _=new Array(f).fill(null),A=0;A<f;A++)_[A]=h;return String(_)},Hi.getStackTrace=function(){if(arguments.length===1){var h=arguments[0],f=new function(){},_=new function(){};return h.printStackTrace(_),f.toString()}if(arguments.length===2){for(var A=arguments[0],D=arguments[1],H="",re=new function(){}(new function(){}(Hi.getStackTrace(A))),ge=0;ge<D;ge++)try{H+=re.readLine()+Hi.NEWLINE}catch(Ne){if(!(Ne instanceof M))throw Ne;Me.shouldNeverReachHere()}return H}},Hi.split=function(h,f){for(var _=f.length,A=new ue,D=""+h,H=D.indexOf(f);H>=0;){var re=D.substring(0,H);A.add(re),H=(D=D.substring(H+_)).indexOf(f)}D.length>0&&A.add(D);for(var ge=new Array(A.size()).fill(null),Ne=0;Ne<ge.length;Ne++)ge[Ne]=A.get(Ne);return ge},Hi.toString=function(){if(arguments.length===1){var h=arguments[0];return Hi.SIMPLE_ORDINATE_FORMAT.format(h)}},Hi.spaces=function(h){return Hi.chars(" ",h)},En.NEWLINE.get=function(){return Pe.getProperty("line.separator")},En.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}},Object.defineProperties(Hi,En);var Ie=s(function(){},"Wt");Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie},Ie.copyCoord=function(h,f,_,A){for(var D=Math.min(h.getDimension(),_.getDimension()),H=0;H<D;H++)_.setOrdinate(A,H,h.getOrdinate(f,H))},Ie.isRing=function(h){var f=h.size();return f===0||!(f<=3)&&h.getOrdinate(0,pe.X)===h.getOrdinate(f-1,pe.X)&&h.getOrdinate(0,pe.Y)===h.getOrdinate(f-1,pe.Y)},Ie.isEqual=function(h,f){var _=h.size();if(_!==f.size())return!1;for(var A=Math.min(h.getDimension(),f.getDimension()),D=0;D<_;D++)for(var H=0;H<A;H++){var re=h.getOrdinate(D,H),ge=f.getOrdinate(D,H);if(h.getOrdinate(D,H)!==f.getOrdinate(D,H)&&(!O.isNaN(re)||!O.isNaN(ge)))return!1}return!0},Ie.extend=function(h,f,_){var A=h.create(_,f.getDimension()),D=f.size();if(Ie.copy(f,0,A,0,D),D>0)for(var H=D;H<_;H++)Ie.copy(f,D-1,A,H,1);return A},Ie.reverse=function(h){for(var f=h.size()-1,_=Math.trunc(f/2),A=0;A<=_;A++)Ie.swap(h,A,f-A)},Ie.swap=function(h,f,_){if(f===_)return null;for(var A=0;A<h.getDimension();A++){var D=h.getOrdinate(f,A);h.setOrdinate(f,A,h.getOrdinate(_,A)),h.setOrdinate(_,A,D)}},Ie.copy=function(h,f,_,A,D){for(var H=0;H<D;H++)Ie.copyCoord(h,f+H,_,A+H)},Ie.toString=function(){if(arguments.length===1){var h=arguments[0],f=h.size();if(f===0)return"()";var _=h.getDimension(),A=new ae;A.append("(");for(var D=0;D<f;D++){D>0&&A.append(" ");for(var H=0;H<_;H++)H>0&&A.append(","),A.append(Hi.toString(h.getOrdinate(D,H)))}return A.append(")"),A.toString()}},Ie.ensureValidRing=function(h,f){var _=f.size();return _===0?f:_<=3?Ie.createClosedRing(h,f,4):f.getOrdinate(0,pe.X)===f.getOrdinate(_-1,pe.X)&&f.getOrdinate(0,pe.Y)===f.getOrdinate(_-1,pe.Y)?f:Ie.createClosedRing(h,f,_+1)},Ie.createClosedRing=function(h,f,_){var A=h.create(_,f.getDimension()),D=f.size();Ie.copy(f,0,A,0,D);for(var H=D;H<_;H++)Ie.copy(f,0,A,H,1);return A};var Je=function(h){function f(A,D){h.call(this,D),this._points=null,this.init(A)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Ae:this._points.expandEnvelope(new Ae)},f.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},f.prototype.getSortIndex=function(){return h.SORTINDEX_LINESTRING},f.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];if(!this.isEquivalentClass(A))return!1;var H=A;if(this._points.size()!==H._points.size())return!1;for(var re=0;re<this._points.size();re++)if(!this.equal(this._points.getCoordinate(re),H._points.getCoordinate(re),D))return!1;return!0}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){for(var A=0;A<Math.trunc(this._points.size()/2);A++){var D=this._points.size()-1-A;if(!this._points.getCoordinate(A).equals(this._points.getCoordinate(D)))return this._points.getCoordinate(A).compareTo(this._points.getCoordinate(D))>0&&Ie.reverse(this._points),null}},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},f.prototype.getBoundaryDimension=function(){return this.isClosed()?nr.FALSE:0},f.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},f.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},f.prototype.getDimension=function(){return 1},f.prototype.getLength=function(){return pt.computeLength(this._points)},f.prototype.getNumPoints=function(){return this._points.size()},f.prototype.reverse=function(){var A=this._points.copy();return Ie.reverse(A),this.getFactory().createLineString(A)},f.prototype.compareToSameClass=function(){if(arguments.length===1){for(var A=arguments[0],D=0,H=0;D<this._points.size()&&H<A._points.size();){var re=this._points.getCoordinate(D).compareTo(A._points.getCoordinate(H));if(re!==0)return re;D++,H++}return D<this._points.size()?1:H<A._points.size()?-1:0}if(arguments.length===2){var ge=arguments[0];return arguments[1].compare(this._points,ge._points)}},f.prototype.apply=function(){if(Y(arguments[0],Fe))for(var A=arguments[0],D=0;D<this._points.size();D++)A.filter(this._points.getCoordinate(D));else if(Y(arguments[0],Jr)){var H=arguments[0];if(this._points.size()===0)return null;for(var re=0;re<this._points.size()&&(H.filter(this._points,re),!H.isDone());re++);H.isGeometryChanged()&&this.geometryChanged()}else Y(arguments[0],ai)?arguments[0].filter(this):Y(arguments[0],Kt)&&arguments[0].filter(this)},f.prototype.getBoundary=function(){return new Hr(this).getBoundary()},f.prototype.isEquivalentClass=function(A){return A instanceof f},f.prototype.clone=function(){var A=h.prototype.clone.call(this);return A._points=this._points.clone(),A},f.prototype.getCoordinateN=function(A){return this._points.getCoordinate(A)},f.prototype.getGeometryType=function(){return"LineString"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._points},f.prototype.isEmpty=function(){return this._points.size()===0},f.prototype.init=function(A){if(A===null&&(A=this.getFactory().getCoordinateSequenceFactory().create([])),A.size()===1)throw new T("Invalid number of points in LineString (found "+A.size()+" - must be 0 or >= 2)");this._points=A},f.prototype.isCoordinate=function(A){for(var D=0;D<this._points.size();D++)if(this._points.getCoordinate(D).equals(A))return!0;return!1},f.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},f.prototype.getPointN=function(A){return this.getFactory().createPoint(this._points.getCoordinate(A))},f.prototype.interfaces_=function(){return[Ft]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(f,_),f}($t),wt=s(function(){},"Jt");wt.prototype.interfaces_=function(){return[]},wt.prototype.getClass=function(){return wt};var ft=function(h){function f(A,D){h.call(this,D),this._coordinates=A||null,this.init(this._coordinates)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ae;var A=new Ae;return A.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),A},f.prototype.getSortIndex=function(){return h.SORTINDEX_POINT},f.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];return!!this.isEquivalentClass(A)&&(!(!this.isEmpty()||!A.isEmpty())||this.isEmpty()===A.isEmpty()&&this.equal(A.getCoordinate(),this.getCoordinate(),D))}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){},f.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},f.prototype.getBoundaryDimension=function(){return nr.FALSE},f.prototype.getDimension=function(){return 0},f.prototype.getNumPoints=function(){return this.isEmpty()?0:1},f.prototype.reverse=function(){return this.copy()},f.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},f.prototype.compareToSameClass=function(){if(arguments.length===1){var A=arguments[0];return this.getCoordinate().compareTo(A.getCoordinate())}if(arguments.length===2){var D=arguments[0];return arguments[1].compare(this._coordinates,D._coordinates)}},f.prototype.apply=function(){if(Y(arguments[0],Fe)){var A=arguments[0];if(this.isEmpty())return null;A.filter(this.getCoordinate())}else if(Y(arguments[0],Jr)){var D=arguments[0];if(this.isEmpty())return null;D.filter(this._coordinates,0),D.isGeometryChanged()&&this.geometryChanged()}else Y(arguments[0],ai)?arguments[0].filter(this):Y(arguments[0],Kt)&&arguments[0].filter(this)},f.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},f.prototype.clone=function(){var A=h.prototype.clone.call(this);return A._coordinates=this._coordinates.clone(),A},f.prototype.getGeometryType=function(){return"Point"},f.prototype.copy=function(){return new f(this._coordinates.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._coordinates},f.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},f.prototype.isEmpty=function(){return this._coordinates.size()===0},f.prototype.init=function(A){A===null&&(A=this.getFactory().getCoordinateSequenceFactory().create([])),Me.isTrue(A.size()<=1),this._coordinates=A},f.prototype.isSimple=function(){return!0},f.prototype.interfaces_=function(){return[wt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(f,_),f}($t),rt=s(function(){},"Zt");rt.prototype.interfaces_=function(){return[]},rt.prototype.getClass=function(){return rt};var zt=function(h){function f(A,D,H){if(h.call(this,H),this._shell=null,this._holes=null,A===null&&(A=this.getFactory().createLinearRing()),D===null&&(D=[]),h.hasNullElements(D))throw new T("holes must not contain null elements");if(A.isEmpty()&&h.hasNonEmptyElements(D))throw new T("shell is empty but holes are not");this._shell=A,this._holes=D}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},f.prototype.getSortIndex=function(){return h.SORTINDEX_POLYGON},f.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var A=new Array(this.getNumPoints()).fill(null),D=-1,H=this._shell.getCoordinates(),re=0;re<H.length;re++)A[++D]=H[re];for(var ge=0;ge<this._holes.length;ge++)for(var Ne=this._holes[ge].getCoordinates(),Ye=0;Ye<Ne.length;Ye++)A[++D]=Ne[Ye];return A},f.prototype.getArea=function(){var A=0;A+=Math.abs(pt.signedArea(this._shell.getCoordinateSequence()));for(var D=0;D<this._holes.length;D++)A-=Math.abs(pt.signedArea(this._holes[D].getCoordinateSequence()));return A},f.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var A=this._shell.getCoordinateSequence(),D=this.getEnvelopeInternal(),H=0;H<5;H++){var re=A.getX(H);if(re!==D.getMinX()&&re!==D.getMaxX())return!1;var ge=A.getY(H);if(ge!==D.getMinY()&&ge!==D.getMaxY())return!1}for(var Ne=A.getX(0),Ye=A.getY(0),Mt=1;Mt<=4;Mt++){var At=A.getX(Mt),hr=A.getY(Mt);if(At!==Ne==(hr!==Ye))return!1;Ne=At,Ye=hr}return!0},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];if(!this.isEquivalentClass(A))return!1;var H=A,re=this._shell,ge=H._shell;if(!re.equalsExact(ge,D)||this._holes.length!==H._holes.length)return!1;for(var Ne=0;Ne<this._holes.length;Ne++)if(!this._holes[Ne].equalsExact(H._holes[Ne],D))return!1;return!0}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var A=0;A<this._holes.length;A++)this.normalize(this._holes[A],!1);fr.sort(this._holes)}else if(arguments.length===2){var D=arguments[0],H=arguments[1];if(D.isEmpty())return null;var re=new Array(D.getCoordinates().length-1).fill(null);Pe.arraycopy(D.getCoordinates(),0,re,0,re.length);var ge=Re.minCoordinate(D.getCoordinates());Re.scroll(re,ge),Pe.arraycopy(re,0,D.getCoordinates(),0,re.length),D.getCoordinates()[re.length]=re[0],pt.isCCW(D.getCoordinates())===H&&Re.reverse(D.getCoordinates())}},f.prototype.getCoordinate=function(){return this._shell.getCoordinate()},f.prototype.getNumInteriorRing=function(){return this._holes.length},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.getLength=function(){var A=0;A+=this._shell.getLength();for(var D=0;D<this._holes.length;D++)A+=this._holes[D].getLength();return A},f.prototype.getNumPoints=function(){for(var A=this._shell.getNumPoints(),D=0;D<this._holes.length;D++)A+=this._holes[D].getNumPoints();return A},f.prototype.reverse=function(){var A=this.copy();A._shell=this._shell.copy().reverse(),A._holes=new Array(this._holes.length).fill(null);for(var D=0;D<this._holes.length;D++)A._holes[D]=this._holes[D].copy().reverse();return A},f.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},f.prototype.compareToSameClass=function(){if(arguments.length===1){var A=arguments[0],D=this._shell,H=A._shell;return D.compareToSameClass(H)}if(arguments.length===2){var re=arguments[0],ge=arguments[1],Ne=re,Ye=this._shell,Mt=Ne._shell,At=Ye.compareToSameClass(Mt,ge);if(At!==0)return At;for(var hr=this.getNumInteriorRing(),gr=Ne.getNumInteriorRing(),Sr=0;Sr<hr&&Sr<gr;){var Qr=this.getInteriorRingN(Sr),ji=Ne.getInteriorRingN(Sr),$n=Qr.compareToSameClass(ji,ge);if($n!==0)return $n;Sr++}return Sr<hr?1:Sr<gr?-1:0}},f.prototype.apply=function(A){if(Y(A,Fe)){this._shell.apply(A);for(var D=0;D<this._holes.length;D++)this._holes[D].apply(A)}else if(Y(A,Jr)){if(this._shell.apply(A),!A.isDone())for(var H=0;H<this._holes.length&&(this._holes[H].apply(A),!A.isDone());H++);A.isGeometryChanged()&&this.geometryChanged()}else if(Y(A,ai))A.filter(this);else if(Y(A,Kt)){A.filter(this),this._shell.apply(A);for(var re=0;re<this._holes.length;re++)this._holes[re].apply(A)}},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var A=new Array(this._holes.length+1).fill(null);A[0]=this._shell;for(var D=0;D<this._holes.length;D++)A[D+1]=this._holes[D];return A.length<=1?this.getFactory().createLinearRing(A[0].getCoordinateSequence()):this.getFactory().createMultiLineString(A)},f.prototype.clone=function(){var A=h.prototype.clone.call(this);A._shell=this._shell.clone(),A._holes=new Array(this._holes.length).fill(null);for(var D=0;D<this._holes.length;D++)A._holes[D]=this._holes[D].clone();return A},f.prototype.getGeometryType=function(){return"Polygon"},f.prototype.copy=function(){for(var A=this._shell.copy(),D=new Array(this._holes.length).fill(null),H=0;H<D.length;H++)D[H]=this._holes[H].copy();return new f(A,D,this._factory)},f.prototype.getExteriorRing=function(){return this._shell},f.prototype.isEmpty=function(){return this._shell.isEmpty()},f.prototype.getInteriorRingN=function(A){return this._holes[A]},f.prototype.interfaces_=function(){return[rt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(f,_),f}($t),cr=function(h){function f(){h.apply(this,arguments)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_MULTIPOINT},f.prototype.isValid=function(){return!0},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];return!!this.isEquivalentClass(A)&&h.prototype.equalsExact.call(this,A,D)}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.getCoordinate=function(){if(arguments.length===1){var A=arguments[0];return this._geometries[A].getCoordinate()}return h.prototype.getCoordinate.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return nr.FALSE},f.prototype.getDimension=function(){return 0},f.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},f.prototype.getGeometryType=function(){return"MultiPoint"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),D=0;D<A.length;D++)A[D]=this._geometries[D].copy();return new f(A,this._factory)},f.prototype.interfaces_=function(){return[wt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(f,_),f}(Cr),ur=function(h){function f(A,D){A instanceof z&&D instanceof qr&&(A=D.getCoordinateSequenceFactory().create(A)),h.call(this,A,D),this.validateConstruction()}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_LINEARRING},f.prototype.getBoundaryDimension=function(){return nr.FALSE},f.prototype.isClosed=function(){return!!this.isEmpty()||h.prototype.isClosed.call(this)},f.prototype.reverse=function(){var A=this._points.copy();return Ie.reverse(A),this.getFactory().createLinearRing(A)},f.prototype.validateConstruction=function(){if(!this.isEmpty()&&!h.prototype.isClosed.call(this))throw new T("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<f.MINIMUM_VALID_SIZE)throw new T("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},f.prototype.getGeometryType=function(){return"LinearRing"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},_.MINIMUM_VALID_SIZE.get=function(){return 4},_.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(f,_),f}(Je),Ar=function(h){function f(){h.apply(this,arguments)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_MULTIPOLYGON},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];return!!this.isEquivalentClass(A)&&h.prototype.equalsExact.call(this,A,D)}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.reverse=function(){for(var A=this._geometries.length,D=new Array(A).fill(null),H=0;H<this._geometries.length;H++)D[H]=this._geometries[H].reverse();return this.getFactory().createMultiPolygon(D)},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var A=new ue,D=0;D<this._geometries.length;D++)for(var H=this._geometries[D].getBoundary(),re=0;re<H.getNumGeometries();re++)A.add(H.getGeometryN(re));var ge=new Array(A.size()).fill(null);return this.getFactory().createMultiLineString(A.toArray(ge))},f.prototype.getGeometryType=function(){return"MultiPolygon"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),D=0;D<A.length;D++)A[D]=this._geometries[D].copy();return new f(A,this._factory)},f.prototype.interfaces_=function(){return[rt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(f,_),f}(Cr),Fr=s(function(h){this._factory=h||null,this._isUserDataCopied=!1},"ie"),Xr={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Fr.prototype.setCopyUserData=function(h){this._isUserDataCopied=h},Fr.prototype.edit=function(h,f){if(h===null)return null;var _=this.editInternal(h,f);return this._isUserDataCopied&&_.setUserData(h.getUserData()),_},Fr.prototype.editInternal=function(h,f){return this._factory===null&&(this._factory=h.getFactory()),h instanceof Cr?this.editGeometryCollection(h,f):h instanceof zt?this.editPolygon(h,f):h instanceof ft?f.edit(h,this._factory):h instanceof Je?f.edit(h,this._factory):(Me.shouldNeverReachHere("Unsupported Geometry class: "+h.getClass().getName()),null)},Fr.prototype.editGeometryCollection=function(h,f){for(var _=f.edit(h,this._factory),A=new ue,D=0;D<_.getNumGeometries();D++){var H=this.edit(_.getGeometryN(D),f);H===null||H.isEmpty()||A.add(H)}return _.getClass()===cr?this._factory.createMultiPoint(A.toArray([])):_.getClass()===Ei?this._factory.createMultiLineString(A.toArray([])):_.getClass()===Ar?this._factory.createMultiPolygon(A.toArray([])):this._factory.createGeometryCollection(A.toArray([]))},Fr.prototype.editPolygon=function(h,f){var _=f.edit(h,this._factory);if(_===null&&(_=this._factory.createPolygon(null)),_.isEmpty())return _;var A=this.edit(_.getExteriorRing(),f);if(A===null||A.isEmpty())return this._factory.createPolygon();for(var D=new ue,H=0;H<_.getNumInteriorRing();H++){var re=this.edit(_.getInteriorRingN(H),f);re===null||re.isEmpty()||D.add(re)}return this._factory.createPolygon(A,D.toArray([]))},Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr},Fr.GeometryEditorOperation=function(){},Xr.NoOpGeometryOperation.get=function(){return Zr},Xr.CoordinateOperation.get=function(){return _i},Xr.CoordinateSequenceOperation.get=function(){return Di},Object.defineProperties(Fr,Xr);var Zr=s(function(){},"oe");Zr.prototype.edit=function(h,f){return h},Zr.prototype.interfaces_=function(){return[Fr.GeometryEditorOperation]},Zr.prototype.getClass=function(){return Zr};var _i=s(function(){},"se");_i.prototype.edit=function(h,f){var _=this.editCoordinates(h.getCoordinates(),h);return _===null?h:h instanceof ur?f.createLinearRing(_):h instanceof Je?f.createLineString(_):h instanceof ft?_.length>0?f.createPoint(_[0]):f.createPoint():h},_i.prototype.interfaces_=function(){return[Fr.GeometryEditorOperation]},_i.prototype.getClass=function(){return _i};var Di=s(function(){},"ae");Di.prototype.edit=function(h,f){return h instanceof ur?f.createLinearRing(this.edit(h.getCoordinateSequence(),h)):h instanceof Je?f.createLineString(this.edit(h.getCoordinateSequence(),h)):h instanceof ft?f.createPoint(this.edit(h.getCoordinateSequence(),h)):h},Di.prototype.interfaces_=function(){return[Fr.GeometryEditorOperation]},Di.prototype.getClass=function(){return Di};var jr=s(function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var h=arguments[0];this._coordinates=new Array(h).fill(null);for(var f=0;f<h;f++)this._coordinates[f]=new z}else if(Y(arguments[0],pe)){var _=arguments[0];if(_===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=_.getDimension(),this._coordinates=new Array(_.size()).fill(null);for(var A=0;A<this._coordinates.length;A++)this._coordinates[A]=_.getCoordinateCopy(A)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var D=arguments[0],H=arguments[1];this._coordinates=D,this._dimension=H,D===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var re=arguments[0],ge=arguments[1];this._coordinates=new Array(re).fill(null),this._dimension=ge;for(var Ne=0;Ne<re;Ne++)this._coordinates[Ne]=new z}}},"ue"),vi={serialVersionUID:{configurable:!0}};jr.prototype.setOrdinate=function(h,f,_){switch(f){case pe.X:this._coordinates[h].x=_;break;case pe.Y:this._coordinates[h].y=_;break;case pe.Z:this._coordinates[h].z=_;break;default:throw new T("invalid ordinateIndex")}},jr.prototype.size=function(){return this._coordinates.length},jr.prototype.getOrdinate=function(h,f){switch(f){case pe.X:return this._coordinates[h].x;case pe.Y:return this._coordinates[h].y;case pe.Z:return this._coordinates[h].z}return O.NaN},jr.prototype.getCoordinate=function(){if(arguments.length===1){var h=arguments[0];return this._coordinates[h]}if(arguments.length===2){var f=arguments[0],_=arguments[1];_.x=this._coordinates[f].x,_.y=this._coordinates[f].y,_.z=this._coordinates[f].z}},jr.prototype.getCoordinateCopy=function(h){return new z(this._coordinates[h])},jr.prototype.getDimension=function(){return this._dimension},jr.prototype.getX=function(h){return this._coordinates[h].x},jr.prototype.clone=function(){for(var h=new Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)h[f]=this._coordinates[f].clone();return new jr(h,this._dimension)},jr.prototype.expandEnvelope=function(h){for(var f=0;f<this._coordinates.length;f++)h.expandToInclude(this._coordinates[f]);return h},jr.prototype.copy=function(){for(var h=new Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)h[f]=this._coordinates[f].copy();return new jr(h,this._dimension)},jr.prototype.toString=function(){if(this._coordinates.length>0){var h=new ae(17*this._coordinates.length);h.append("("),h.append(this._coordinates[0]);for(var f=1;f<this._coordinates.length;f++)h.append(", "),h.append(this._coordinates[f]);return h.append(")"),h.toString()}return"()"},jr.prototype.getY=function(h){return this._coordinates[h].y},jr.prototype.toCoordinateArray=function(){return this._coordinates},jr.prototype.interfaces_=function(){return[pe,i]},jr.prototype.getClass=function(){return jr},vi.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(jr,vi);var wi=s(function(){},"ce"),Yr={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};wi.prototype.readResolve=function(){return wi.instance()},wi.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var h=arguments[0];return new jr(h)}if(Y(arguments[0],pe)){var f=arguments[0];return new jr(f)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return A>3&&(A=3),A<2?new jr(_):new jr(_,A)}},wi.prototype.interfaces_=function(){return[J,i]},wi.prototype.getClass=function(){return wi},wi.instance=function(){return wi.instanceObject},Yr.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Yr.instanceObject.get=function(){return new wi},Object.defineProperties(wi,Yr);var $r=function(h){function f(){h.call(this),this.map_=new Map}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.get=function(_){return this.map_.get(_)||null},f.prototype.put=function(_,A){return this.map_.set(_,A),A},f.prototype.values=function(){for(var _=new ue,A=this.map_.values(),D=A.next();!D.done;)_.add(D.value),D=A.next();return _},f.prototype.entrySet=function(){var _=new ke;return this.map_.entries().forEach(function(A){return _.add(A)}),_},f.prototype.size=function(){return this.map_.size()},f}(mt),li=s(function h(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=h.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof ta){var f=arguments[0];this._modelType=f,f===h.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=h.FIXED,this.setScale(_)}else if(arguments[0]instanceof h){var A=arguments[0];this._modelType=A._modelType,this._scale=A._scale}}},"t"),sa={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};li.prototype.equals=function(h){if(!(h instanceof li))return!1;var f=h;return this._modelType===f._modelType&&this._scale===f._scale},li.prototype.compareTo=function(h){var f=h,_=this.getMaximumSignificantDigits(),A=f.getMaximumSignificantDigits();return new ee(_).compareTo(new ee(A))},li.prototype.getScale=function(){return this._scale},li.prototype.isFloating=function(){return this._modelType===li.FLOATING||this._modelType===li.FLOATING_SINGLE},li.prototype.getType=function(){return this._modelType},li.prototype.toString=function(){var h="UNKNOWN";return this._modelType===li.FLOATING?h="Floating":this._modelType===li.FLOATING_SINGLE?h="Floating-Single":this._modelType===li.FIXED&&(h="Fixed (Scale="+this.getScale()+")"),h},li.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var h=arguments[0];return O.isNaN(h)||this._modelType===li.FLOATING_SINGLE?h:this._modelType===li.FIXED?Math.round(h*this._scale)/this._scale:h}if(arguments[0]instanceof z){var f=arguments[0];if(this._modelType===li.FLOATING)return null;f.x=this.makePrecise(f.x),f.y=this.makePrecise(f.y)}},li.prototype.getMaximumSignificantDigits=function(){var h=16;return this._modelType===li.FLOATING?h=16:this._modelType===li.FLOATING_SINGLE?h=6:this._modelType===li.FIXED&&(h=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),h},li.prototype.setScale=function(h){this._scale=Math.abs(h)},li.prototype.interfaces_=function(){return[i,k]},li.prototype.getClass=function(){return li},li.mostPrecise=function(h,f){return h.compareTo(f)>=0?h:f},sa.serialVersionUID.get=function(){return 7777263578777804e3},sa.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(li,sa);var ta=s(function h(f){this._name=f||null,h.nameToTypeMap.put(f,this)},"t"),Vi={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ta.prototype.readResolve=function(){return ta.nameToTypeMap.get(this._name)},ta.prototype.toString=function(){return this._name},ta.prototype.interfaces_=function(){return[i]},ta.prototype.getClass=function(){return ta},Vi.serialVersionUID.get=function(){return-552860263173159e4},Vi.nameToTypeMap.get=function(){return new $r},Object.defineProperties(ta,Vi),li.Type=ta,li.FIXED=new ta("FIXED"),li.FLOATING=new ta("FLOATING"),li.FLOATING_SINGLE=new ta("FLOATING SINGLE");var qr=s(function h(){this._precisionModel=new li,this._SRID=0,this._coordinateSequenceFactory=h.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Y(arguments[0],J)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof li&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},"t"),S={serialVersionUID:{configurable:!0}};qr.prototype.toGeometry=function(h){return h.isNull()?this.createPoint(null):h.getMinX()===h.getMaxX()&&h.getMinY()===h.getMaxY()?this.createPoint(new z(h.getMinX(),h.getMinY())):h.getMinX()===h.getMaxX()||h.getMinY()===h.getMaxY()?this.createLineString([new z(h.getMinX(),h.getMinY()),new z(h.getMaxX(),h.getMaxY())]):this.createPolygon(this.createLinearRing([new z(h.getMinX(),h.getMinY()),new z(h.getMinX(),h.getMaxY()),new z(h.getMaxX(),h.getMaxY()),new z(h.getMaxX(),h.getMinY()),new z(h.getMinX(),h.getMinY())]),null)},qr.prototype.createLineString=function(h){return h?h instanceof Array?new Je(this.getCoordinateSequenceFactory().create(h),this):Y(h,pe)?new Je(h,this):void 0:new Je(this.getCoordinateSequenceFactory().create([]),this)},qr.prototype.createMultiLineString=function(){if(arguments.length===0)return new Ei(null,this);if(arguments.length===1){var h=arguments[0];return new Ei(h,this)}},qr.prototype.buildGeometry=function(h){for(var f=null,_=!1,A=!1,D=h.iterator();D.hasNext();){var H=D.next(),re=H.getClass();f===null&&(f=re),re!==f&&(_=!0),H.isGeometryCollectionOrDerived()&&(A=!0)}if(f===null)return this.createGeometryCollection();if(_||A)return this.createGeometryCollection(qr.toGeometryArray(h));var ge=h.iterator().next();if(h.size()>1){if(ge instanceof zt)return this.createMultiPolygon(qr.toPolygonArray(h));if(ge instanceof Je)return this.createMultiLineString(qr.toLineStringArray(h));if(ge instanceof ft)return this.createMultiPoint(qr.toPointArray(h));Me.shouldNeverReachHere("Unhandled class: "+ge.getClass().getName())}return ge},qr.prototype.createMultiPointFromCoords=function(h){return this.createMultiPoint(h!==null?this.getCoordinateSequenceFactory().create(h):null)},qr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];return this.createPoint(h!==null?this.getCoordinateSequenceFactory().create([h]):null)}if(Y(arguments[0],pe)){var f=arguments[0];return new ft(f,this)}}},qr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},qr.prototype.createPolygon=function(){if(arguments.length===0)return new zt(null,null,this);if(arguments.length===1){if(Y(arguments[0],pe)){var h=arguments[0];return this.createPolygon(this.createLinearRing(h))}if(arguments[0]instanceof Array){var f=arguments[0];return this.createPolygon(this.createLinearRing(f))}if(arguments[0]instanceof ur){var _=arguments[0];return this.createPolygon(_,null)}}else if(arguments.length===2){var A=arguments[0],D=arguments[1];return new zt(A,D,this)}},qr.prototype.getSRID=function(){return this._SRID},qr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Cr(null,this);if(arguments.length===1){var h=arguments[0];return new Cr(h,this)}},qr.prototype.createGeometry=function(h){return new Fr(this).edit(h,{edit:s(function(){if(arguments.length===2){var f=arguments[0];return this._coordinateSequenceFactory.create(f)}},"edit")})},qr.prototype.getPrecisionModel=function(){return this._precisionModel},qr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var h=arguments[0];return this.createLinearRing(h!==null?this.getCoordinateSequenceFactory().create(h):null)}if(Y(arguments[0],pe)){var f=arguments[0];return new ur(f,this)}}},qr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new Ar(null,this);if(arguments.length===1){var h=arguments[0];return new Ar(h,this)}},qr.prototype.createMultiPoint=function(){if(arguments.length===0)return new cr(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var h=arguments[0];return new cr(h,this)}if(arguments[0]instanceof Array){var f=arguments[0];return this.createMultiPoint(f!==null?this.getCoordinateSequenceFactory().create(f):null)}if(Y(arguments[0],pe)){var _=arguments[0];if(_===null)return this.createMultiPoint(new Array(0).fill(null));for(var A=new Array(_.size()).fill(null),D=0;D<_.size();D++){var H=this.getCoordinateSequenceFactory().create(1,_.getDimension());Ie.copy(_,D,H,0,1),A[D]=this.createPoint(H)}return this.createMultiPoint(A)}}},qr.prototype.interfaces_=function(){return[i]},qr.prototype.getClass=function(){return qr},qr.toMultiPolygonArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.toGeometryArray=function(h){if(h===null)return null;var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.getDefaultCoordinateSequenceFactory=function(){return wi.instance()},qr.toMultiLineStringArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.toLineStringArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.toMultiPointArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.toLinearRingArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.toPointArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.toPolygonArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},qr.createPointFromInternalCoord=function(h,f){return f.getPrecisionModel().makePrecise(h),f.getFactory().createPoint(h)},S.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(qr,S);var R=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],j=s(function(h){this.geometryFactory=h||new qr},"Ie");j.prototype.read=function(h){var f,_=(f=typeof h=="string"?JSON.parse(h):h).type;if(!Z[_])throw new Error("Unknown GeoJSON type: "+f.type);return R.indexOf(_)!==-1?Z[_].apply(this,[f.coordinates]):_==="GeometryCollection"?Z[_].apply(this,[f.geometries]):Z[_].apply(this,[f])},j.prototype.write=function(h){var f=h.getGeometryType();if(!ie[f])throw new Error("Geometry is not supported");return ie[f].apply(this,[h])};var Z={Feature:s(function(h){var f={};for(var _ in h)f[_]=h[_];if(h.geometry){var A=h.geometry.type;if(!Z[A])throw new Error("Unknown GeoJSON type: "+h.type);f.geometry=this.read(h.geometry)}return h.bbox&&(f.bbox=Z.bbox.apply(this,[h.bbox])),f},"Feature"),FeatureCollection:s(function(h){var f={};if(h.features){f.features=[];for(var _=0;_<h.features.length;++_)f.features.push(this.read(h.features[_]))}return h.bbox&&(f.bbox=this.parse.bbox.apply(this,[h.bbox])),f},"FeatureCollection"),coordinates:s(function(h){for(var f=[],_=0;_<h.length;++_){var A=h[_];f.push(new z(A[0],A[1]))}return f},"coordinates"),bbox:s(function(h){return this.geometryFactory.createLinearRing([new z(h[0],h[1]),new z(h[2],h[1]),new z(h[2],h[3]),new z(h[0],h[3]),new z(h[0],h[1])])},"bbox"),Point:s(function(h){var f=new z(h[0],h[1]);return this.geometryFactory.createPoint(f)},"Point"),MultiPoint:s(function(h){for(var f=[],_=0;_<h.length;++_)f.push(Z.Point.apply(this,[h[_]]));return this.geometryFactory.createMultiPoint(f)},"MultiPoint"),LineString:s(function(h){var f=Z.coordinates.apply(this,[h]);return this.geometryFactory.createLineString(f)},"LineString"),MultiLineString:s(function(h){for(var f=[],_=0;_<h.length;++_)f.push(Z.LineString.apply(this,[h[_]]));return this.geometryFactory.createMultiLineString(f)},"MultiLineString"),Polygon:s(function(h){for(var f=Z.coordinates.apply(this,[h[0]]),_=this.geometryFactory.createLinearRing(f),A=[],D=1;D<h.length;++D){var H=h[D],re=Z.coordinates.apply(this,[H]),ge=this.geometryFactory.createLinearRing(re);A.push(ge)}return this.geometryFactory.createPolygon(_,A)},"Polygon"),MultiPolygon:s(function(h){for(var f=[],_=0;_<h.length;++_){var A=h[_];f.push(Z.Polygon.apply(this,[A]))}return this.geometryFactory.createMultiPolygon(f)},"MultiPolygon"),GeometryCollection:s(function(h){for(var f=[],_=0;_<h.length;++_){var A=h[_];f.push(this.read(A))}return this.geometryFactory.createGeometryCollection(f)},"GeometryCollection")},ie={coordinate:s(function(h){return[h.x,h.y]},"coordinate"),Point:s(function(h){return{type:"Point",coordinates:ie.coordinate.apply(this,[h.getCoordinate()])}},"Point"),MultiPoint:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],D=ie.Point.apply(this,[A]);f.push(D.coordinates)}return{type:"MultiPoint",coordinates:f}},"MultiPoint"),LineString:s(function(h){for(var f=[],_=h.getCoordinates(),A=0;A<_.length;++A){var D=_[A];f.push(ie.coordinate.apply(this,[D]))}return{type:"LineString",coordinates:f}},"LineString"),MultiLineString:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],D=ie.LineString.apply(this,[A]);f.push(D.coordinates)}return{type:"MultiLineString",coordinates:f}},"MultiLineString"),Polygon:s(function(h){var f=[],_=ie.LineString.apply(this,[h._shell]);f.push(_.coordinates);for(var A=0;A<h._holes.length;++A){var D=h._holes[A],H=ie.LineString.apply(this,[D]);f.push(H.coordinates)}return{type:"Polygon",coordinates:f}},"Polygon"),MultiPolygon:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],D=ie.Polygon.apply(this,[A]);f.push(D.coordinates)}return{type:"MultiPolygon",coordinates:f}},"MultiPolygon"),GeometryCollection:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],D=A.getGeometryType();f.push(ie[D].apply(this,[A]))}return{type:"GeometryCollection",geometries:f}},"GeometryCollection")},we=s(function(h){this.geometryFactory=h||new qr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new j(this.geometryFactory)},"Ne");we.prototype.read=function(h){var f=this.parser.read(h);return this.precisionModel.getType()===li.FIXED&&this.reducePrecision(f),f},we.prototype.reducePrecision=function(h){var f,_;if(h.coordinate)this.precisionModel.makePrecise(h.coordinate);else if(h.points)for(f=0,_=h.points.length;f<_;f++)this.precisionModel.makePrecise(h.points[f]);else if(h.geometries)for(f=0,_=h.geometries.length;f<_;f++)this.reducePrecision(h.geometries[f])};var Ce=s(function(){this.parser=new j(this.geometryFactory)},"Ce");Ce.prototype.write=function(h){return this.parser.write(h)};var Le=s(function(){},"Se"),ct={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.opposite=function(h){return h===Le.LEFT?Le.RIGHT:h===Le.RIGHT?Le.LEFT:h},ct.ON.get=function(){return 0},ct.LEFT.get=function(){return 1},ct.RIGHT.get=function(){return 2},Object.defineProperties(Le,ct),(I.prototype=new Error).name="EmptyStackException",(P.prototype=new se).add=function(h){return this.array_.push(h),!0},P.prototype.get=function(h){if(h<0||h>=this.size())throw new Error;return this.array_[h]},P.prototype.push=function(h){return this.array_.push(h),h},P.prototype.pop=function(h){if(this.array_.length===0)throw new I;return this.array_.pop()},P.prototype.peek=function(){if(this.array_.length===0)throw new I;return this.array_[this.array_.length-1]},P.prototype.empty=function(){return this.array_.length===0},P.prototype.isEmpty=function(){return this.empty()},P.prototype.search=function(h){return this.array_.indexOf(h)},P.prototype.size=function(){return this.array_.length},P.prototype.toArray=function(){for(var h=[],f=0,_=this.array_.length;f<_;f++)h.push(this.array_[f]);return h};var _t=s(function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null},"be");_t.prototype.getCoordinate=function(){return this._minCoord},_t.prototype.getRightmostSide=function(h,f){var _=this.getRightmostSideOfSegment(h,f);return _<0&&(_=this.getRightmostSideOfSegment(h,f-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(h)),_},_t.prototype.findRightmostEdgeAtVertex=function(){var h=this._minDe.getEdge().getCoordinates();Me.isTrue(this._minIndex>0&&this._minIndex<h.length,"rightmost point expected to be interior vertex of edge");var f=h[this._minIndex-1],_=h[this._minIndex+1],A=pt.computeOrientation(this._minCoord,_,f),D=!1;(f.y<this._minCoord.y&&_.y<this._minCoord.y&&A===pt.COUNTERCLOCKWISE||f.y>this._minCoord.y&&_.y>this._minCoord.y&&A===pt.CLOCKWISE)&&(D=!0),D&&(this._minIndex=this._minIndex-1)},_t.prototype.getRightmostSideOfSegment=function(h,f){var _=h.getEdge().getCoordinates();if(f<0||f+1>=_.length||_[f].y===_[f+1].y)return-1;var A=Le.LEFT;return _[f].y<_[f+1].y&&(A=Le.RIGHT),A},_t.prototype.getEdge=function(){return this._orientedDe},_t.prototype.checkForRightmostCoordinate=function(h){for(var f=h.getEdge().getCoordinates(),_=0;_<f.length-1;_++)(this._minCoord===null||f[_].x>this._minCoord.x)&&(this._minDe=h,this._minIndex=_,this._minCoord=f[_])},_t.prototype.findRightmostEdgeAtNode=function(){var h=this._minDe.getNode().getEdges();this._minDe=h.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},_t.prototype.findEdge=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next();_.isForward()&&this.checkForRightmostCoordinate(_)}Me.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Le.LEFT&&(this._orientedDe=this._minDe.getSym())},_t.prototype.interfaces_=function(){return[]},_t.prototype.getClass=function(){return _t};var qt=function(h){function f(_,A){h.call(this,f.msgWithCoord(_,A)),this.pt=A?new z(A):null,this.name="TopologyException"}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.getCoordinate=function(){return this.pt},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.msgWithCoord=function(_,A){return A?_:_+" [ "+A+" ]"},f}(Lt),sr=s(function(){this.array_=[]},"Oe");sr.prototype.addLast=function(h){this.array_.push(h)},sr.prototype.removeFirst=function(){return this.array_.shift()},sr.prototype.isEmpty=function(){return this.array_.length===0};var mr=s(function(){this._finder=null,this._dirEdgeList=new ue,this._nodes=new ue,this._rightMostCoord=null,this._env=null,this._finder=new _t},"Te");mr.prototype.clearVisitedEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();)h.next().setVisited(!1)},mr.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},mr.prototype.computeNodeDepth=function(h){for(var f=null,_=h.getEdges().iterator();_.hasNext();){var A=_.next();if(A.isVisited()||A.getSym().isVisited()){f=A;break}}if(f===null)throw new qt("unable to find edge to compute depths at "+h.getCoordinate());h.getEdges().computeDepths(f);for(var D=h.getEdges().iterator();D.hasNext();){var H=D.next();H.setVisited(!0),this.copySymDepths(H)}},mr.prototype.computeDepth=function(h){this.clearVisitedEdges();var f=this._finder.getEdge();f.setEdgeDepths(Le.RIGHT,h),this.copySymDepths(f),this.computeDepths(f)},mr.prototype.create=function(h){this.addReachable(h),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},mr.prototype.findResultEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();){var f=h.next();f.getDepth(Le.RIGHT)>=1&&f.getDepth(Le.LEFT)<=0&&!f.isInteriorAreaEdge()&&f.setInResult(!0)}},mr.prototype.computeDepths=function(h){var f=new ke,_=new sr,A=h.getNode();for(_.addLast(A),f.add(A),h.setVisited(!0);!_.isEmpty();){var D=_.removeFirst();f.add(D),this.computeNodeDepth(D);for(var H=D.getEdges().iterator();H.hasNext();){var re=H.next().getSym();if(!re.isVisited()){var ge=re.getNode();f.contains(ge)||(_.addLast(ge),f.add(ge))}}}},mr.prototype.compareTo=function(h){var f=h;return this._rightMostCoord.x<f._rightMostCoord.x?-1:this._rightMostCoord.x>f._rightMostCoord.x?1:0},mr.prototype.getEnvelope=function(){if(this._env===null){for(var h=new Ae,f=this._dirEdgeList.iterator();f.hasNext();)for(var _=f.next().getEdge().getCoordinates(),A=0;A<_.length-1;A++)h.expandToInclude(_[A]);this._env=h}return this._env},mr.prototype.addReachable=function(h){var f=new P;for(f.add(h);!f.empty();){var _=f.pop();this.add(_,f)}},mr.prototype.copySymDepths=function(h){var f=h.getSym();f.setDepth(Le.LEFT,h.getDepth(Le.RIGHT)),f.setDepth(Le.RIGHT,h.getDepth(Le.LEFT))},mr.prototype.add=function(h,f){h.setVisited(!0),this._nodes.add(h);for(var _=h.getEdges().iterator();_.hasNext();){var A=_.next();this._dirEdgeList.add(A);var D=A.getSym().getNode();D.isVisited()||f.push(D)}},mr.prototype.getNodes=function(){return this._nodes},mr.prototype.getDirectedEdges=function(){return this._dirEdgeList},mr.prototype.interfaces_=function(){return[k]},mr.prototype.getClass=function(){return mr};var xr=s(function h(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var f=arguments[0];this.init(f.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[Le.ON]=_}else if(arguments[0]instanceof h){var A=arguments[0];if(this.init(A.location.length),A!==null)for(var D=0;D<this.location.length;D++)this.location[D]=A.location[D]}}else if(arguments.length===3){var H=arguments[0],re=arguments[1],ge=arguments[2];this.init(3),this.location[Le.ON]=H,this.location[Le.LEFT]=re,this.location[Le.RIGHT]=ge}},"t");xr.prototype.setAllLocations=function(h){for(var f=0;f<this.location.length;f++)this.location[f]=h},xr.prototype.isNull=function(){for(var h=0;h<this.location.length;h++)if(this.location[h]!==V.NONE)return!1;return!0},xr.prototype.setAllLocationsIfNull=function(h){for(var f=0;f<this.location.length;f++)this.location[f]===V.NONE&&(this.location[f]=h)},xr.prototype.isLine=function(){return this.location.length===1},xr.prototype.merge=function(h){if(h.location.length>this.location.length){var f=new Array(3).fill(null);f[Le.ON]=this.location[Le.ON],f[Le.LEFT]=V.NONE,f[Le.RIGHT]=V.NONE,this.location=f}for(var _=0;_<this.location.length;_++)this.location[_]===V.NONE&&_<h.location.length&&(this.location[_]=h.location[_])},xr.prototype.getLocations=function(){return this.location},xr.prototype.flip=function(){if(this.location.length<=1)return null;var h=this.location[Le.LEFT];this.location[Le.LEFT]=this.location[Le.RIGHT],this.location[Le.RIGHT]=h},xr.prototype.toString=function(){var h=new ae;return this.location.length>1&&h.append(V.toLocationSymbol(this.location[Le.LEFT])),h.append(V.toLocationSymbol(this.location[Le.ON])),this.location.length>1&&h.append(V.toLocationSymbol(this.location[Le.RIGHT])),h.toString()},xr.prototype.setLocations=function(h,f,_){this.location[Le.ON]=h,this.location[Le.LEFT]=f,this.location[Le.RIGHT]=_},xr.prototype.get=function(h){return h<this.location.length?this.location[h]:V.NONE},xr.prototype.isArea=function(){return this.location.length>1},xr.prototype.isAnyNull=function(){for(var h=0;h<this.location.length;h++)if(this.location[h]===V.NONE)return!0;return!1},xr.prototype.setLocation=function(){if(arguments.length===1){var h=arguments[0];this.setLocation(Le.ON,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this.location[f]=_}},xr.prototype.init=function(h){this.location=new Array(h).fill(null),this.setAllLocations(V.NONE)},xr.prototype.isEqualOnSide=function(h,f){return this.location[f]===h.location[f]},xr.prototype.allPositionsEqual=function(h){for(var f=0;f<this.location.length;f++)if(this.location[f]!==h)return!1;return!0},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var lr=s(function h(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var f=arguments[0];this.elt[0]=new xr(f),this.elt[1]=new xr(f)}else if(arguments[0]instanceof h){var _=arguments[0];this.elt[0]=new xr(_.elt[0]),this.elt[1]=new xr(_.elt[1])}}else if(arguments.length===2){var A=arguments[0],D=arguments[1];this.elt[0]=new xr(V.NONE),this.elt[1]=new xr(V.NONE),this.elt[A].setLocation(D)}else if(arguments.length===3){var H=arguments[0],re=arguments[1],ge=arguments[2];this.elt[0]=new xr(H,re,ge),this.elt[1]=new xr(H,re,ge)}else if(arguments.length===4){var Ne=arguments[0],Ye=arguments[1],Mt=arguments[2],At=arguments[3];this.elt[0]=new xr(V.NONE,V.NONE,V.NONE),this.elt[1]=new xr(V.NONE,V.NONE,V.NONE),this.elt[Ne].setLocations(Ye,Mt,At)}},"t");lr.prototype.getGeometryCount=function(){var h=0;return this.elt[0].isNull()||h++,this.elt[1].isNull()||h++,h},lr.prototype.setAllLocations=function(h,f){this.elt[h].setAllLocations(f)},lr.prototype.isNull=function(h){return this.elt[h].isNull()},lr.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var h=arguments[0];this.setAllLocationsIfNull(0,h),this.setAllLocationsIfNull(1,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this.elt[f].setAllLocationsIfNull(_)}},lr.prototype.isLine=function(h){return this.elt[h].isLine()},lr.prototype.merge=function(h){for(var f=0;f<2;f++)this.elt[f]===null&&h.elt[f]!==null?this.elt[f]=new xr(h.elt[f]):this.elt[f].merge(h.elt[f])},lr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},lr.prototype.getLocation=function(){if(arguments.length===1){var h=arguments[0];return this.elt[h].get(Le.ON)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return this.elt[f].get(_)}},lr.prototype.toString=function(){var h=new ae;return this.elt[0]!==null&&(h.append("A:"),h.append(this.elt[0].toString())),this.elt[1]!==null&&(h.append(" B:"),h.append(this.elt[1].toString())),h.toString()},lr.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var h=arguments[0];return this.elt[h].isArea()}},lr.prototype.isAnyNull=function(h){return this.elt[h].isAnyNull()},lr.prototype.setLocation=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];this.elt[h].setLocation(Le.ON,f)}else if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2];this.elt[_].setLocation(A,D)}},lr.prototype.isEqualOnSide=function(h,f){return this.elt[0].isEqualOnSide(h.elt[0],f)&&this.elt[1].isEqualOnSide(h.elt[1],f)},lr.prototype.allPositionsEqual=function(h,f){return this.elt[h].allPositionsEqual(f)},lr.prototype.toLine=function(h){this.elt[h].isArea()&&(this.elt[h]=new xr(this.elt[h].location[0]))},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},lr.toLineLabel=function(h){for(var f=new lr(V.NONE),_=0;_<2;_++)f.setLocation(_,h.getLocation(_));return f};var Er=s(function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new ue,this._pts=new ue,this._label=new lr(V.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ue,this._geometryFactory=null;var h=arguments[0],f=arguments[1];this._geometryFactory=f,this.computePoints(h),this.computeRing()},"De");Er.prototype.computeRing=function(){if(this._ring!==null)return null;for(var h=new Array(this._pts.size()).fill(null),f=0;f<this._pts.size();f++)h[f]=this._pts.get(f);this._ring=this._geometryFactory.createLinearRing(h),this._isHole=pt.isCCW(this._ring.getCoordinates())},Er.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},Er.prototype.computePoints=function(h){this._startDe=h;var f=h,_=!0;do{if(f===null)throw new qt("Found null DirectedEdge");if(f.getEdgeRing()===this)throw new qt("Directed Edge visited twice during ring-building at "+f.getCoordinate());this._edges.add(f);var A=f.getLabel();Me.isTrue(A.isArea()),this.mergeLabel(A),this.addPoints(f.getEdge(),f.isForward(),_),_=!1,this.setEdgeRing(f,this),f=this.getNext(f)}while(f!==this._startDe)},Er.prototype.getLinearRing=function(){return this._ring},Er.prototype.getCoordinate=function(h){return this._pts.get(h)},Er.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var h=this._startDe;do{var f=h.getNode().getEdges().getOutgoingDegree(this);f>this._maxNodeDegree&&(this._maxNodeDegree=f),h=this.getNext(h)}while(h!==this._startDe);this._maxNodeDegree*=2},Er.prototype.addPoints=function(h,f,_){var A=h.getCoordinates();if(f){var D=1;_&&(D=0);for(var H=D;H<A.length;H++)this._pts.add(A[H])}else{var re=A.length-2;_&&(re=A.length-1);for(var ge=re;ge>=0;ge--)this._pts.add(A[ge])}},Er.prototype.isHole=function(){return this._isHole},Er.prototype.setInResult=function(){var h=this._startDe;do h.getEdge().setInResult(!0),h=h.getNext();while(h!==this._startDe)},Er.prototype.containsPoint=function(h){var f=this.getLinearRing();if(!f.getEnvelopeInternal().contains(h)||!pt.isPointInRing(h,f.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(h))return!1;return!0},Er.prototype.addHole=function(h){this._holes.add(h)},Er.prototype.isShell=function(){return this._shell===null},Er.prototype.getLabel=function(){return this._label},Er.prototype.getEdges=function(){return this._edges},Er.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Er.prototype.getShell=function(){return this._shell},Er.prototype.mergeLabel=function(){if(arguments.length===1){var h=arguments[0];this.mergeLabel(h,0),this.mergeLabel(h,1)}else if(arguments.length===2){var f=arguments[0],_=arguments[1],A=f.getLocation(_,Le.RIGHT);if(A===V.NONE)return null;if(this._label.getLocation(_)===V.NONE)return this._label.setLocation(_,A),null}},Er.prototype.setShell=function(h){this._shell=h,h!==null&&h.addHole(this)},Er.prototype.toPolygon=function(h){for(var f=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)f[_]=this._holes.get(_).getLinearRing();return h.createPolygon(this.getLinearRing(),f)},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er};var sn=function(h){function f(){var _=arguments[0],A=arguments[1];h.call(this,_,A)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.setEdgeRing=function(_,A){_.setMinEdgeRing(A)},f.prototype.getNext=function(_){return _.getNextMin()},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Er),ra=function(h){function f(){var _=arguments[0],A=arguments[1];h.call(this,_,A)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.buildMinimalRings=function(){var _=new ue,A=this._startDe;do{if(A.getMinEdgeRing()===null){var D=new sn(A,this._geometryFactory);_.add(D)}A=A.getNext()}while(A!==this._startDe);return _},f.prototype.setEdgeRing=function(_,A){_.setEdgeRing(A)},f.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)},f.prototype.getNext=function(_){return _.getNext()},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Er),ln=s(function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0&&arguments.length===1){var h=arguments[0];this._label=h}},"Fe");ln.prototype.setVisited=function(h){this._isVisited=h},ln.prototype.setInResult=function(h){this._isInResult=h},ln.prototype.isCovered=function(){return this._isCovered},ln.prototype.isCoveredSet=function(){return this._isCoveredSet},ln.prototype.setLabel=function(h){this._label=h},ln.prototype.getLabel=function(){return this._label},ln.prototype.setCovered=function(h){this._isCovered=h,this._isCoveredSet=!0},ln.prototype.updateIM=function(h){Me.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(h)},ln.prototype.isInResult=function(){return this._isInResult},ln.prototype.isVisited=function(){return this._isVisited},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln};var zl=function(h){function f(){h.call(this),this._coord=null,this._edges=null;var _=arguments[0],A=arguments[1];this._coord=_,this._edges=A,this._label=new lr(0,V.NONE)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.isIncidentEdgeInResult=function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1},f.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},f.prototype.getCoordinate=function(){return this._coord},f.prototype.print=function(_){_.println("node "+this._coord+" lbl: "+this._label)},f.prototype.computeIM=function(_){},f.prototype.computeMergedLocation=function(_,A){var D=V.NONE;if(D=this._label.getLocation(A),!_.isNull(A)){var H=_.getLocation(A);D!==V.BOUNDARY&&(D=H)}return D},f.prototype.setLabel=function(){if(arguments.length!==2)return h.prototype.setLabel.apply(this,arguments);var _=arguments[0],A=arguments[1];this._label===null?this._label=new lr(_,A):this._label.setLocation(_,A)},f.prototype.getEdges=function(){return this._edges},f.prototype.mergeLabel=function(){if(arguments[0]instanceof f){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof lr)for(var A=arguments[0],D=0;D<2;D++){var H=this.computeMergedLocation(A,D);this._label.getLocation(D)===V.NONE&&this._label.setLocation(D,H)}},f.prototype.add=function(_){this._edges.insert(_),_.setNode(this)},f.prototype.setLabelBoundary=function(_){if(this._label===null)return null;var A=V.NONE;this._label!==null&&(A=this._label.getLocation(_));var D=null;switch(A){case V.BOUNDARY:D=V.INTERIOR;break;case V.INTERIOR:default:D=V.BOUNDARY}this._label.setLocation(_,D)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(ln),la=s(function(){this.nodeMap=new v,this.nodeFact=null;var h=arguments[0];this.nodeFact=h},"qe");la.prototype.find=function(h){return this.nodeMap.get(h)},la.prototype.addNode=function(){if(arguments[0]instanceof z){var h=arguments[0],f=this.nodeMap.get(h);return f===null&&(f=this.nodeFact.createNode(h),this.nodeMap.put(h,f)),f}if(arguments[0]instanceof zl){var _=arguments[0],A=this.nodeMap.get(_.getCoordinate());return A===null?(this.nodeMap.put(_.getCoordinate(),_),_):(A.mergeLabel(_),A)}},la.prototype.print=function(h){for(var f=this.iterator();f.hasNext();)f.next().print(h)},la.prototype.iterator=function(){return this.nodeMap.values().iterator()},la.prototype.values=function(){return this.nodeMap.values()},la.prototype.getBoundaryNodes=function(h){for(var f=new ue,_=this.iterator();_.hasNext();){var A=_.next();A.getLabel().getLocation(h)===V.BOUNDARY&&f.add(A)}return f},la.prototype.add=function(h){var f=h.getCoordinate();this.addNode(f).add(h)},la.prototype.interfaces_=function(){return[]},la.prototype.getClass=function(){return la};var ui=s(function(){},"Be"),_o={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui},ui.isNorthern=function(h){return h===ui.NE||h===ui.NW},ui.isOpposite=function(h,f){return h===f?!1:(h-f+4)%4===2},ui.commonHalfPlane=function(h,f){if(h===f)return h;if((h-f+4)%4===2)return-1;var _=h<f?h:f;return _===0&&(h>f?h:f)===3?3:_},ui.isInHalfPlane=function(h,f){return f===ui.SE?h===ui.SE||h===ui.SW:h===f||h===f+1},ui.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var h=arguments[0],f=arguments[1];if(h===0&&f===0)throw new T("Cannot compute the quadrant for point ( "+h+", "+f+" )");return h>=0?f>=0?ui.NE:ui.SE:f>=0?ui.NW:ui.SW}if(arguments[0]instanceof z&&arguments[1]instanceof z){var _=arguments[0],A=arguments[1];if(A.x===_.x&&A.y===_.y)throw new T("Cannot compute the quadrant for two identical points "+_);return A.x>=_.x?A.y>=_.y?ui.NE:ui.SE:A.y>=_.y?ui.NW:ui.SW}},_o.NE.get=function(){return 0},_o.NW.get=function(){return 1},_o.SW.get=function(){return 2},_o.SE.get=function(){return 3},Object.defineProperties(ui,_o);var Ni=s(function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var h=arguments[0];this._edge=h}else if(arguments.length===3){var f=arguments[0],_=arguments[1],A=arguments[2];this._edge=f,this.init(_,A),this._label=null}else if(arguments.length===4){var D=arguments[0],H=arguments[1],re=arguments[2],ge=arguments[3];this._edge=D,this.init(H,re),this._label=ge}},"Ue");Ni.prototype.compareDirection=function(h){return this._dx===h._dx&&this._dy===h._dy?0:this._quadrant>h._quadrant?1:this._quadrant<h._quadrant?-1:pt.computeOrientation(h._p0,h._p1,this._p1)},Ni.prototype.getDy=function(){return this._dy},Ni.prototype.getCoordinate=function(){return this._p0},Ni.prototype.setNode=function(h){this._node=h},Ni.prototype.print=function(h){var f=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),A=_.lastIndexOf("."),D=_.substring(A+1);h.print("  "+D+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+f+"   "+this._label)},Ni.prototype.compareTo=function(h){var f=h;return this.compareDirection(f)},Ni.prototype.getDirectedCoordinate=function(){return this._p1},Ni.prototype.getDx=function(){return this._dx},Ni.prototype.getLabel=function(){return this._label},Ni.prototype.getEdge=function(){return this._edge},Ni.prototype.getQuadrant=function(){return this._quadrant},Ni.prototype.getNode=function(){return this._node},Ni.prototype.toString=function(){var h=Math.atan2(this._dy,this._dx),f=this.getClass().getName(),_=f.lastIndexOf(".");return"  "+f.substring(_+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+h+"   "+this._label},Ni.prototype.computeLabel=function(h){},Ni.prototype.init=function(h,f){this._p0=h,this._p1=f,this._dx=f.x-h.x,this._dy=f.y-h.y,this._quadrant=ui.quadrant(this._dx,this._dy),Me.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},Ni.prototype.interfaces_=function(){return[k]},Ni.prototype.getClass=function(){return Ni};var xo=function(h){function f(){var _=arguments[0],A=arguments[1];if(h.call(this,_),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=A,A)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var D=_.getNumPoints()-1;this.init(_.getCoordinate(D),_.getCoordinate(D-1))}this.computeDirectedLabel()}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.getNextMin=function(){return this._nextMin},f.prototype.getDepth=function(_){return this._depth[_]},f.prototype.setVisited=function(_){this._isVisited=_},f.prototype.computeDirectedLabel=function(){this._label=new lr(this._edge.getLabel()),this._isForward||this._label.flip()},f.prototype.getNext=function(){return this._next},f.prototype.setDepth=function(_,A){if(this._depth[_]!==-999&&this._depth[_]!==A)throw new qt("assigned depths do not match",this.getCoordinate());this._depth[_]=A},f.prototype.isInteriorAreaEdge=function(){for(var _=!0,A=0;A<2;A++)this._label.isArea(A)&&this._label.getLocation(A,Le.LEFT)===V.INTERIOR&&this._label.getLocation(A,Le.RIGHT)===V.INTERIOR||(_=!1);return _},f.prototype.setNextMin=function(_){this._nextMin=_},f.prototype.print=function(_){h.prototype.print.call(this,_),_.print(" "+this._depth[Le.LEFT]+"/"+this._depth[Le.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")},f.prototype.setMinEdgeRing=function(_){this._minEdgeRing=_},f.prototype.isLineEdge=function(){var _=this._label.isLine(0)||this._label.isLine(1),A=!this._label.isArea(0)||this._label.allPositionsEqual(0,V.EXTERIOR),D=!this._label.isArea(1)||this._label.allPositionsEqual(1,V.EXTERIOR);return _&&A&&D},f.prototype.setEdgeRing=function(_){this._edgeRing=_},f.prototype.getMinEdgeRing=function(){return this._minEdgeRing},f.prototype.getDepthDelta=function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_},f.prototype.setInResult=function(_){this._isInResult=_},f.prototype.getSym=function(){return this._sym},f.prototype.isForward=function(){return this._isForward},f.prototype.getEdge=function(){return this._edge},f.prototype.printEdge=function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)},f.prototype.setSym=function(_){this._sym=_},f.prototype.setVisitedEdge=function(_){this.setVisited(_),this._sym.setVisited(_)},f.prototype.setEdgeDepths=function(_,A){var D=this.getEdge().getDepthDelta();this._isForward||(D=-D);var H=1;_===Le.LEFT&&(H=-1);var re=Le.opposite(_),ge=A+D*H;this.setDepth(_,A),this.setDepth(re,ge)},f.prototype.getEdgeRing=function(){return this._edgeRing},f.prototype.isInResult=function(){return this._isInResult},f.prototype.setNext=function(_){this._next=_},f.prototype.isVisited=function(){return this._isVisited},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.depthFactor=function(_,A){return _===V.EXTERIOR&&A===V.INTERIOR?1:_===V.INTERIOR&&A===V.EXTERIOR?-1:0},f}(Ni),pl=s(function(){},"Xe");pl.prototype.createNode=function(h){return new zl(h,null)},pl.prototype.interfaces_=function(){return[]},pl.prototype.getClass=function(){return pl};var un=s(function(){if(this._edges=new ue,this._nodes=null,this._edgeEndList=new ue,arguments.length===0)this._nodes=new la(new pl);else if(arguments.length===1){var h=arguments[0];this._nodes=new la(h)}},"Ye");un.prototype.printEdges=function(h){h.println("Edges:");for(var f=0;f<this._edges.size();f++){h.println("edge "+f+":");var _=this._edges.get(f);_.print(h),_.eiList.print(h)}},un.prototype.find=function(h){return this._nodes.find(h)},un.prototype.addNode=function(){if(arguments[0]instanceof zl){var h=arguments[0];return this._nodes.addNode(h)}if(arguments[0]instanceof z){var f=arguments[0];return this._nodes.addNode(f)}},un.prototype.getNodeIterator=function(){return this._nodes.iterator()},un.prototype.linkResultDirectedEdges=function(){for(var h=this._nodes.iterator();h.hasNext();)h.next().getEdges().linkResultDirectedEdges()},un.prototype.debugPrintln=function(h){Pe.out.println(h)},un.prototype.isBoundaryNode=function(h,f){var _=this._nodes.find(f);if(_===null)return!1;var A=_.getLabel();return A!==null&&A.getLocation(h)===V.BOUNDARY},un.prototype.linkAllDirectedEdges=function(){for(var h=this._nodes.iterator();h.hasNext();)h.next().getEdges().linkAllDirectedEdges()},un.prototype.matchInSameDirection=function(h,f,_,A){return!!h.equals(_)&&pt.computeOrientation(h,f,A)===pt.COLLINEAR&&ui.quadrant(h,f)===ui.quadrant(_,A)},un.prototype.getEdgeEnds=function(){return this._edgeEndList},un.prototype.debugPrint=function(h){Pe.out.print(h)},un.prototype.getEdgeIterator=function(){return this._edges.iterator()},un.prototype.findEdgeInSameDirection=function(h,f){for(var _=0;_<this._edges.size();_++){var A=this._edges.get(_),D=A.getCoordinates();if(this.matchInSameDirection(h,f,D[0],D[1])||this.matchInSameDirection(h,f,D[D.length-1],D[D.length-2]))return A}return null},un.prototype.insertEdge=function(h){this._edges.add(h)},un.prototype.findEdgeEnd=function(h){for(var f=this.getEdgeEnds().iterator();f.hasNext();){var _=f.next();if(_.getEdge()===h)return _}return null},un.prototype.addEdges=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next();this._edges.add(_);var A=new xo(_,!0),D=new xo(_,!1);A.setSym(D),D.setSym(A),this.add(A),this.add(D)}},un.prototype.add=function(h){this._nodes.add(h),this._edgeEndList.add(h)},un.prototype.getNodes=function(){return this._nodes.values()},un.prototype.findEdge=function(h,f){for(var _=0;_<this._edges.size();_++){var A=this._edges.get(_),D=A.getCoordinates();if(h.equals(D[0])&&f.equals(D[1]))return A}return null},un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},un.linkResultDirectedEdges=function(h){for(var f=h.iterator();f.hasNext();)f.next().getEdges().linkResultDirectedEdges()};var Ta=s(function(){this._geometryFactory=null,this._shellList=new ue;var h=arguments[0];this._geometryFactory=h},"ke");Ta.prototype.sortShellsAndHoles=function(h,f,_){for(var A=h.iterator();A.hasNext();){var D=A.next();D.isHole()?_.add(D):f.add(D)}},Ta.prototype.computePolygons=function(h){for(var f=new ue,_=h.iterator();_.hasNext();){var A=_.next().toPolygon(this._geometryFactory);f.add(A)}return f},Ta.prototype.placeFreeHoles=function(h,f){for(var _=f.iterator();_.hasNext();){var A=_.next();if(A.getShell()===null){var D=this.findEdgeRingContaining(A,h);if(D===null)throw new qt("unable to assign hole to a shell",A.getCoordinate(0));A.setShell(D)}}},Ta.prototype.buildMinimalEdgeRings=function(h,f,_){for(var A=new ue,D=h.iterator();D.hasNext();){var H=D.next();if(H.getMaxNodeDegree()>2){H.linkDirectedEdgesForMinimalEdgeRings();var re=H.buildMinimalRings(),ge=this.findShell(re);ge!==null?(this.placePolygonHoles(ge,re),f.add(ge)):_.addAll(re)}else A.add(H)}return A},Ta.prototype.containsPoint=function(h){for(var f=this._shellList.iterator();f.hasNext();)if(f.next().containsPoint(h))return!0;return!1},Ta.prototype.buildMaximalEdgeRings=function(h){for(var f=new ue,_=h.iterator();_.hasNext();){var A=_.next();if(A.isInResult()&&A.getLabel().isArea()&&A.getEdgeRing()===null){var D=new ra(A,this._geometryFactory);f.add(D),D.setInResult()}}return f},Ta.prototype.placePolygonHoles=function(h,f){for(var _=f.iterator();_.hasNext();){var A=_.next();A.isHole()&&A.setShell(h)}},Ta.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ta.prototype.findEdgeRingContaining=function(h,f){for(var _=h.getLinearRing(),A=_.getEnvelopeInternal(),D=_.getCoordinateN(0),H=null,re=null,ge=f.iterator();ge.hasNext();){var Ne=ge.next(),Ye=Ne.getLinearRing(),Mt=Ye.getEnvelopeInternal();H!==null&&(re=H.getLinearRing().getEnvelopeInternal());var At=!1;Mt.contains(A)&&pt.isPointInRing(D,Ye.getCoordinates())&&(At=!0),At&&(H===null||re.contains(Mt))&&(H=Ne)}return H},Ta.prototype.findShell=function(h){for(var f=0,_=null,A=h.iterator();A.hasNext();){var D=A.next();D.isHole()||(_=D,f++)}return Me.isTrue(f<=1,"found two shells in MinimalEdgeRing list"),_},Ta.prototype.add=function(){if(arguments.length===1){var h=arguments[0];this.add(h.getEdgeEnds(),h.getNodes())}else if(arguments.length===2){var f=arguments[0],_=arguments[1];un.linkResultDirectedEdges(_);var A=this.buildMaximalEdgeRings(f),D=new ue,H=this.buildMinimalEdgeRings(A,this._shellList,D);this.sortShellsAndHoles(H,this._shellList,D),this.placeFreeHoles(this._shellList,D)}},Ta.prototype.interfaces_=function(){return[]},Ta.prototype.getClass=function(){return Ta};var Ul=s(function(){},"je");Ul.prototype.getBounds=function(){},Ul.prototype.interfaces_=function(){return[]},Ul.prototype.getClass=function(){return Ul};var ka=s(function(){this._bounds=null,this._item=null;var h=arguments[0],f=arguments[1];this._bounds=h,this._item=f},"He");ka.prototype.getItem=function(){return this._item},ka.prototype.getBounds=function(){return this._bounds},ka.prototype.interfaces_=function(){return[Ul,i]},ka.prototype.getClass=function(){return ka};var ys=s(function(){this._size=null,this._items=null,this._size=0,this._items=new ue,this._items.add(null)},"We");ys.prototype.poll=function(){if(this.isEmpty())return null;var h=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),h},ys.prototype.size=function(){return this._size},ys.prototype.reorder=function(h){for(var f=null,_=this._items.get(h);2*h<=this._size&&((f=2*h)!==this._size&&this._items.get(f+1).compareTo(this._items.get(f))<0&&f++,this._items.get(f).compareTo(_)<0);h=f)this._items.set(h,this._items.get(f));this._items.set(h,_)},ys.prototype.clear=function(){this._size=0,this._items.clear()},ys.prototype.isEmpty=function(){return this._size===0},ys.prototype.add=function(h){this._items.add(null),this._size+=1;var f=this._size;for(this._items.set(0,h);h.compareTo(this._items.get(Math.trunc(f/2)))<0;f/=2)this._items.set(f,this._items.get(Math.trunc(f/2)));this._items.set(f,h)},ys.prototype.interfaces_=function(){return[]},ys.prototype.getClass=function(){return ys};var Wn=s(function(){},"Ke");Wn.prototype.visitItem=function(h){},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var Ve=s(function(){},"Je");Ve.prototype.insert=function(h,f){},Ve.prototype.remove=function(h,f){},Ve.prototype.query=function(){},Ve.prototype.interfaces_=function(){return[]},Ve.prototype.getClass=function(){return Ve};var et=s(function(){if(this._childBoundables=new ue,this._bounds=null,this._level=null,arguments.length!==0&&arguments.length===1){var h=arguments[0];this._level=h}},"Qe"),be={serialVersionUID:{configurable:!0}};et.prototype.getLevel=function(){return this._level},et.prototype.size=function(){return this._childBoundables.size()},et.prototype.getChildBoundables=function(){return this._childBoundables},et.prototype.addChildBoundable=function(h){Me.isTrue(this._bounds===null),this._childBoundables.add(h)},et.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},et.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},et.prototype.interfaces_=function(){return[Ul,i]},et.prototype.getClass=function(){return et},be.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(et,be);var Ge=s(function(){},"$e");Ge.reverseOrder=function(){return{compare:s(function(h,f){return f.compareTo(h)},"compare")}},Ge.min=function(h){return Ge.sort(h),h.get(0)},Ge.sort=function(h,f){var _=h.toArray();f?fr.sort(_,f):fr.sort(_);for(var A=h.iterator(),D=0,H=_.length;D<H;D++)A.next(),A.set(_[D])},Ge.singletonList=function(h){var f=new ue;return f.add(h),f};var nt=s(function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var h=arguments[0],f=arguments[1],_=arguments[2];this._boundable1=h,this._boundable2=f,this._itemDistance=_,this._distance=this.distance()},"tn");nt.prototype.expandToQueue=function(h,f){var _=nt.isComposite(this._boundable1),A=nt.isComposite(this._boundable2);if(_&&A)return nt.area(this._boundable1)>nt.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,h,f),null):(this.expand(this._boundable2,this._boundable1,h,f),null);if(_)return this.expand(this._boundable1,this._boundable2,h,f),null;if(A)return this.expand(this._boundable2,this._boundable1,h,f),null;throw new T("neither boundable is composite")},nt.prototype.isLeaves=function(){return!(nt.isComposite(this._boundable1)||nt.isComposite(this._boundable2))},nt.prototype.compareTo=function(h){var f=h;return this._distance<f._distance?-1:this._distance>f._distance?1:0},nt.prototype.expand=function(h,f,_,A){for(var D=h.getChildBoundables().iterator();D.hasNext();){var H=D.next(),re=new nt(H,f,this._itemDistance);re.getDistance()<A&&_.add(re)}},nt.prototype.getBoundable=function(h){return h===0?this._boundable1:this._boundable2},nt.prototype.getDistance=function(){return this._distance},nt.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},nt.prototype.interfaces_=function(){return[k]},nt.prototype.getClass=function(){return nt},nt.area=function(h){return h.getBounds().getArea()},nt.isComposite=function(h){return h instanceof et};var Wt=s(function h(){if(this._root=null,this._built=!1,this._itemBoundables=new ue,this._nodeCapacity=null,arguments.length===0){var f=h.DEFAULT_NODE_CAPACITY;this._nodeCapacity=f}else if(arguments.length===1){var _=arguments[0];Me.isTrue(_>1,"Node capacity must be greater than 1"),this._nodeCapacity=_}},"t"),Br={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Wt.prototype.getNodeCapacity=function(){return this._nodeCapacity},Wt.prototype.lastNode=function(h){return h.get(h.size()-1)},Wt.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var h=0,f=arguments[0].getChildBoundables().iterator();f.hasNext();){var _=f.next();_ instanceof et?h+=this.size(_):_ instanceof ka&&(h+=1)}return h}},Wt.prototype.removeItem=function(h,f){for(var _=null,A=h.getChildBoundables().iterator();A.hasNext();){var D=A.next();D instanceof ka&&D.getItem()===f&&(_=D)}return _!==null&&(h.getChildBoundables().remove(_),!0)},Wt.prototype.itemsTree=function(){if(arguments.length===0){this.build();var h=this.itemsTree(this._root);return h===null?new ue:h}if(arguments.length===1){for(var f=arguments[0],_=new ue,A=f.getChildBoundables().iterator();A.hasNext();){var D=A.next();if(D instanceof et){var H=this.itemsTree(D);H!==null&&_.add(H)}else D instanceof ka?_.add(D.getItem()):Me.shouldNeverReachHere()}return _.size()<=0?null:_}},Wt.prototype.insert=function(h,f){Me.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ka(h,f))},Wt.prototype.boundablesAtLevel=function(){if(arguments.length===1){var h=arguments[0],f=new ue;return this.boundablesAtLevel(h,this._root,f),f}if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2];if(Me.isTrue(_>-2),A.getLevel()===_)return D.add(A),null;for(var H=A.getChildBoundables().iterator();H.hasNext();){var re=H.next();re instanceof et?this.boundablesAtLevel(_,re,D):(Me.isTrue(re instanceof ka),_===-1&&D.add(re))}return null}},Wt.prototype.query=function(){if(arguments.length===1){var h=arguments[0];this.build();var f=new ue;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.query(h,this._root,f),f}if(arguments.length===2){var _=arguments[0],A=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),_)&&this.query(_,this._root,A)}else if(arguments.length===3){if(Y(arguments[2],Wn)&&arguments[0]instanceof Object&&arguments[1]instanceof et)for(var D=arguments[0],H=arguments[1],re=arguments[2],ge=H.getChildBoundables(),Ne=0;Ne<ge.size();Ne++){var Ye=ge.get(Ne);this.getIntersectsOp().intersects(Ye.getBounds(),D)&&(Ye instanceof et?this.query(D,Ye,re):Ye instanceof ka?re.visitItem(Ye.getItem()):Me.shouldNeverReachHere())}else if(Y(arguments[2],se)&&arguments[0]instanceof Object&&arguments[1]instanceof et)for(var Mt=arguments[0],At=arguments[1],hr=arguments[2],gr=At.getChildBoundables(),Sr=0;Sr<gr.size();Sr++){var Qr=gr.get(Sr);this.getIntersectsOp().intersects(Qr.getBounds(),Mt)&&(Qr instanceof et?this.query(Mt,Qr,hr):Qr instanceof ka?hr.add(Qr.getItem()):Me.shouldNeverReachHere())}}},Wt.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Wt.prototype.getRoot=function(){return this.build(),this._root},Wt.prototype.remove=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.remove(h,this._root,f)}if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2],H=this.removeItem(A,D);if(H)return!0;for(var re=null,ge=A.getChildBoundables().iterator();ge.hasNext();){var Ne=ge.next();if(this.getIntersectsOp().intersects(Ne.getBounds(),_)&&Ne instanceof et&&(H=this.remove(_,Ne,D))){re=Ne;break}}return re!==null&&re.getChildBoundables().isEmpty()&&A.getChildBoundables().remove(re),H}},Wt.prototype.createHigherLevels=function(h,f){Me.isTrue(!h.isEmpty());var _=this.createParentBoundables(h,f+1);return _.size()===1?_.get(0):this.createHigherLevels(_,f+1)},Wt.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var h=0,f=arguments[0].getChildBoundables().iterator();f.hasNext();){var _=f.next();if(_ instanceof et){var A=this.depth(_);A>h&&(h=A)}}return h+1}},Wt.prototype.createParentBoundables=function(h,f){Me.isTrue(!h.isEmpty());var _=new ue;_.add(this.createNode(f));var A=new ue(h);Ge.sort(A,this.getComparator());for(var D=A.iterator();D.hasNext();){var H=D.next();this.lastNode(_).getChildBoundables().size()===this.getNodeCapacity()&&_.add(this.createNode(f)),this.lastNode(_).addChildBoundable(H)}return _},Wt.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Wt.prototype.interfaces_=function(){return[i]},Wt.prototype.getClass=function(){return Wt},Wt.compareDoubles=function(h,f){return h>f?1:h<f?-1:0},Br.IntersectsOp.get=function(){return Or},Br.serialVersionUID.get=function(){return-3886435814360241e3},Br.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Wt,Br);var Or=s(function(){},"rn"),ci=s(function(){},"on");ci.prototype.distance=function(h,f){},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci};var gi=function(h){function f(A){A=A||f.DEFAULT_NODE_CAPACITY,h.call(this,A)}s(f,"n"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return f.prototype.createParentBoundablesFromVerticalSlices=function(A,D){Me.isTrue(A.length>0);for(var H=new ue,re=0;re<A.length;re++)H.addAll(this.createParentBoundablesFromVerticalSlice(A[re],D));return H},f.prototype.createNode=function(A){return new Fi(A)},f.prototype.size=function(){return arguments.length===0?h.prototype.size.call(this):h.prototype.size.apply(this,arguments)},f.prototype.insert=function(){if(arguments.length!==2)return h.prototype.insert.apply(this,arguments);var A=arguments[0],D=arguments[1];if(A.isNull())return null;h.prototype.insert.call(this,A,D)},f.prototype.getIntersectsOp=function(){return f.intersectsOp},f.prototype.verticalSlices=function(A,D){for(var H=Math.trunc(Math.ceil(A.size()/D)),re=new Array(D).fill(null),ge=A.iterator(),Ne=0;Ne<D;Ne++){re[Ne]=new ue;for(var Ye=0;ge.hasNext()&&Ye<H;){var Mt=ge.next();re[Ne].add(Mt),Ye++}}return re},f.prototype.query=function(){if(arguments.length===1){var A=arguments[0];return h.prototype.query.call(this,A)}if(arguments.length===2){var D=arguments[0],H=arguments[1];h.prototype.query.call(this,D,H)}else if(arguments.length===3){if(Y(arguments[2],Wn)&&arguments[0]instanceof Object&&arguments[1]instanceof et){var re=arguments[0],ge=arguments[1],Ne=arguments[2];h.prototype.query.call(this,re,ge,Ne)}else if(Y(arguments[2],se)&&arguments[0]instanceof Object&&arguments[1]instanceof et){var Ye=arguments[0],Mt=arguments[1],At=arguments[2];h.prototype.query.call(this,Ye,Mt,At)}}},f.prototype.getComparator=function(){return f.yComparator},f.prototype.createParentBoundablesFromVerticalSlice=function(A,D){return h.prototype.createParentBoundables.call(this,A,D)},f.prototype.remove=function(){if(arguments.length===2){var A=arguments[0],D=arguments[1];return h.prototype.remove.call(this,A,D)}return h.prototype.remove.apply(this,arguments)},f.prototype.depth=function(){return arguments.length===0?h.prototype.depth.call(this):h.prototype.depth.apply(this,arguments)},f.prototype.createParentBoundables=function(A,D){Me.isTrue(!A.isEmpty());var H=Math.trunc(Math.ceil(A.size()/this.getNodeCapacity())),re=new ue(A);Ge.sort(re,f.xComparator);var ge=this.verticalSlices(re,Math.trunc(Math.ceil(Math.sqrt(H))));return this.createParentBoundablesFromVerticalSlices(ge,D)},f.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Y(arguments[0],ci)){var A=arguments[0],D=new nt(this.getRoot(),this.getRoot(),A);return this.nearestNeighbour(D)}if(arguments[0]instanceof nt){var H=arguments[0];return this.nearestNeighbour(H,O.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof f&&Y(arguments[1],ci)){var re=arguments[0],ge=arguments[1],Ne=new nt(this.getRoot(),re.getRoot(),ge);return this.nearestNeighbour(Ne)}if(arguments[0]instanceof nt&&typeof arguments[1]=="number"){var Ye=arguments[0],Mt=arguments[1],At=null,hr=new ys;for(hr.add(Ye);!hr.isEmpty()&&Mt>0;){var gr=hr.poll(),Sr=gr.getDistance();if(Sr>=Mt)break;gr.isLeaves()?(Mt=Sr,At=gr):gr.expandToQueue(hr,Mt)}return[At.getBoundable(0).getItem(),At.getBoundable(1).getItem()]}}else if(arguments.length===3){var Qr=arguments[0],ji=arguments[1],$n=arguments[2],rs=new ka(Qr,ji),gu=new nt(this.getRoot(),rs,$n);return this.nearestNeighbour(gu)[0]}},f.prototype.interfaces_=function(){return[Ve,i]},f.prototype.getClass=function(){return f},f.centreX=function(A){return f.avg(A.getMinX(),A.getMaxX())},f.avg=function(A,D){return(A+D)/2},f.centreY=function(A){return f.avg(A.getMinY(),A.getMaxY())},_.STRtreeNode.get=function(){return Fi},_.serialVersionUID.get=function(){return 0x39920f7d5f261e0},_.xComparator.get=function(){return{interfaces_:s(function(){return[U]},"interfaces_"),compare:s(function(A,D){return h.compareDoubles(f.centreX(A.getBounds()),f.centreX(D.getBounds()))},"compare")}},_.yComparator.get=function(){return{interfaces_:s(function(){return[U]},"interfaces_"),compare:s(function(A,D){return h.compareDoubles(f.centreY(A.getBounds()),f.centreY(D.getBounds()))},"compare")}},_.intersectsOp.get=function(){return{interfaces_:s(function(){return[h.IntersectsOp]},"interfaces_"),intersects:s(function(A,D){return A.intersects(D)},"intersects")}},_.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(f,_),f}(Wt),Fi=function(h){function f(){var _=arguments[0];h.call(this,_)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.computeBounds=function(){for(var _=null,A=this.getChildBoundables().iterator();A.hasNext();){var D=A.next();_===null?_=new Ae(D.getBounds()):_.expandToInclude(D.getBounds())}return _},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(et),cn=s(function(){},"un");cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn},cn.relativeSign=function(h,f){return h<f?-1:h>f?1:0},cn.compare=function(h,f,_){if(f.equals2D(_))return 0;var A=cn.relativeSign(f.x,_.x),D=cn.relativeSign(f.y,_.y);switch(h){case 0:return cn.compareValue(A,D);case 1:return cn.compareValue(D,A);case 2:return cn.compareValue(D,-A);case 3:return cn.compareValue(-A,D);case 4:return cn.compareValue(-A,-D);case 5:return cn.compareValue(-D,-A);case 6:return cn.compareValue(-D,A);case 7:return cn.compareValue(A,-D)}return Me.shouldNeverReachHere("invalid octant value"),0},cn.compareValue=function(h,f){return h<0?-1:h>0?1:f<0?-1:f>0?1:0};var Vn=s(function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];this._segString=h,this.coord=new z(f),this.segmentIndex=_,this._segmentOctant=A,this._isInterior=!f.equals2D(h.getCoordinate(_))},"ln");Vn.prototype.getCoordinate=function(){return this.coord},Vn.prototype.print=function(h){h.print(this.coord),h.print(" seg # = "+this.segmentIndex)},Vn.prototype.compareTo=function(h){var f=h;return this.segmentIndex<f.segmentIndex?-1:this.segmentIndex>f.segmentIndex?1:this.coord.equals2D(f.coord)?0:cn.compare(this._segmentOctant,this.coord,f.coord)},Vn.prototype.isEndPoint=function(h){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===h},Vn.prototype.isInterior=function(){return this._isInterior},Vn.prototype.interfaces_=function(){return[k]},Vn.prototype.getClass=function(){return Vn};var Xn=s(function(){this._nodeMap=new v,this._edge=null;var h=arguments[0];this._edge=h},"cn");Xn.prototype.getSplitCoordinates=function(){var h=new ze;this.addEndpoints();for(var f=this.iterator(),_=f.next();f.hasNext();){var A=f.next();this.addEdgeCoordinates(_,A,h),_=A}return h.toCoordinateArray()},Xn.prototype.addCollapsedNodes=function(){var h=new ue;this.findCollapsesFromInsertedNodes(h),this.findCollapsesFromExistingVertices(h);for(var f=h.iterator();f.hasNext();){var _=f.next().intValue();this.add(this._edge.getCoordinate(_),_)}},Xn.prototype.print=function(h){h.println("Intersections:");for(var f=this.iterator();f.hasNext();)f.next().print(h)},Xn.prototype.findCollapsesFromExistingVertices=function(h){for(var f=0;f<this._edge.size()-2;f++){var _=this._edge.getCoordinate(f),A=this._edge.getCoordinate(f+2);_.equals2D(A)&&h.add(new ee(f+1))}},Xn.prototype.addEdgeCoordinates=function(h,f,_){var A=this._edge.getCoordinate(f.segmentIndex),D=f.isInterior()||!f.coord.equals2D(A);_.add(new z(h.coord),!1);for(var H=h.segmentIndex+1;H<=f.segmentIndex;H++)_.add(this._edge.getCoordinate(H));D&&_.add(new z(f.coord))},Xn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Xn.prototype.addSplitEdges=function(h){this.addEndpoints(),this.addCollapsedNodes();for(var f=this.iterator(),_=f.next();f.hasNext();){var A=f.next(),D=this.createSplitEdge(_,A);h.add(D),_=A}},Xn.prototype.findCollapseIndex=function(h,f,_){if(!h.coord.equals2D(f.coord))return!1;var A=f.segmentIndex-h.segmentIndex;return f.isInterior()||A--,A===1&&(_[0]=h.segmentIndex+1,!0)},Xn.prototype.findCollapsesFromInsertedNodes=function(h){for(var f=new Array(1).fill(null),_=this.iterator(),A=_.next();_.hasNext();){var D=_.next();this.findCollapseIndex(A,D,f)&&h.add(new ee(f[0])),A=D}},Xn.prototype.getEdge=function(){return this._edge},Xn.prototype.addEndpoints=function(){var h=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(h),h)},Xn.prototype.createSplitEdge=function(h,f){var _=f.segmentIndex-h.segmentIndex+2,A=this._edge.getCoordinate(f.segmentIndex),D=f.isInterior()||!f.coord.equals2D(A);D||_--;var H=new Array(_).fill(null),re=0;H[re++]=new z(h.coord);for(var ge=h.segmentIndex+1;ge<=f.segmentIndex;ge++)H[re++]=this._edge.getCoordinate(ge);return D&&(H[re]=new z(f.coord)),new wa(H,this._edge.getData())},Xn.prototype.add=function(h,f){var _=new Vn(this._edge,h,f,this._edge.getSegmentOctant(f)),A=this._nodeMap.get(_);return A!==null?(Me.isTrue(A.coord.equals2D(h),"Found equal nodes with different coordinates"),A):(this._nodeMap.put(_,_),_)},Xn.prototype.checkSplitEdgesCorrectness=function(h){var f=this._edge.getCoordinates(),_=h.get(0).getCoordinate(0);if(!_.equals2D(f[0]))throw new Lt("bad split edge start point at "+_);var A=h.get(h.size()-1).getCoordinates(),D=A[A.length-1];if(!D.equals2D(f[f.length-1]))throw new Lt("bad split edge end point at "+D)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var dl=s(function(){},"pn");dl.prototype.interfaces_=function(){return[]},dl.prototype.getClass=function(){return dl},dl.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var h=arguments[0],f=arguments[1];if(h===0&&f===0)throw new T("Cannot compute the octant for point ( "+h+", "+f+" )");var _=Math.abs(h),A=Math.abs(f);return h>=0?f>=0?_>=A?0:1:_>=A?7:6:f>=0?_>=A?3:2:_>=A?4:5}if(arguments[0]instanceof z&&arguments[1]instanceof z){var D=arguments[0],H=arguments[1],re=H.x-D.x,ge=H.y-D.y;if(re===0&&ge===0)throw new T("Cannot compute the octant for two identical points "+D);return dl.octant(re,ge)}};var Ws=s(function(){},"hn");Ws.prototype.getCoordinates=function(){},Ws.prototype.size=function(){},Ws.prototype.getCoordinate=function(h){},Ws.prototype.isClosed=function(){},Ws.prototype.setData=function(h){},Ws.prototype.getData=function(){},Ws.prototype.interfaces_=function(){return[]},Ws.prototype.getClass=function(){return Ws};var ip=s(function(){},"fn");ip.prototype.addIntersection=function(h,f){},ip.prototype.interfaces_=function(){return[Ws]},ip.prototype.getClass=function(){return ip};var wa=s(function(){this._nodeList=new Xn(this),this._pts=null,this._data=null;var h=arguments[0],f=arguments[1];this._pts=h,this._data=f},"gn");wa.prototype.getCoordinates=function(){return this._pts},wa.prototype.size=function(){return this._pts.length},wa.prototype.getCoordinate=function(h){return this._pts[h]},wa.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},wa.prototype.getSegmentOctant=function(h){return h===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(h),this.getCoordinate(h+1))},wa.prototype.setData=function(h){this._data=h},wa.prototype.safeOctant=function(h,f){return h.equals2D(f)?0:dl.octant(h,f)},wa.prototype.getData=function(){return this._data},wa.prototype.addIntersection=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];this.addIntersectionNode(h,f)}else if(arguments.length===4){var _=arguments[0],A=arguments[1],D=arguments[3],H=new z(_.getIntersection(D));this.addIntersection(H,A)}},wa.prototype.toString=function(){return at.toLineString(new jr(this._pts))},wa.prototype.getNodeList=function(){return this._nodeList},wa.prototype.addIntersectionNode=function(h,f){var _=f,A=_+1;if(A<this._pts.length){var D=this._pts[A];h.equals2D(D)&&(_=A)}return this._nodeList.add(h,_)},wa.prototype.addIntersections=function(h,f,_){for(var A=0;A<h.getIntersectionNum();A++)this.addIntersection(h,f,_,A)},wa.prototype.interfaces_=function(){return[ip]},wa.prototype.getClass=function(){return wa},wa.getNodedSubstrings=function(){if(arguments.length===1){var h=arguments[0],f=new ue;return wa.getNodedSubstrings(h,f),f}if(arguments.length===2)for(var _=arguments[0],A=arguments[1],D=_.iterator();D.hasNext();)D.next().getNodeList().addSplitEdges(A)};var Gr=s(function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new z,this.p1=new z;else if(arguments.length===1){var h=arguments[0];this.p0=new z(h.p0),this.p1=new z(h.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var f=arguments[0],_=arguments[1],A=arguments[2],D=arguments[3];this.p0=new z(f,_),this.p1=new z(A,D)}},"dn"),bS={serialVersionUID:{configurable:!0}};Gr.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Gr.prototype.orientationIndex=function(){if(arguments[0]instanceof Gr){var h=arguments[0],f=pt.orientationIndex(this.p0,this.p1,h.p0),_=pt.orientationIndex(this.p0,this.p1,h.p1);return f>=0&&_>=0||f<=0&&_<=0?Math.max(f,_):0}if(arguments[0]instanceof z){var A=arguments[0];return pt.orientationIndex(this.p0,this.p1,A)}},Gr.prototype.toGeometry=function(h){return h.createLineString([this.p0,this.p1])},Gr.prototype.isVertical=function(){return this.p0.x===this.p1.x},Gr.prototype.equals=function(h){if(!(h instanceof Gr))return!1;var f=h;return this.p0.equals(f.p0)&&this.p1.equals(f.p1)},Gr.prototype.intersection=function(h){var f=new It;return f.computeIntersection(this.p0,this.p1,h.p0,h.p1),f.hasIntersection()?f.getIntersection(0):null},Gr.prototype.project=function(){if(arguments[0]instanceof z){var h=arguments[0];if(h.equals(this.p0)||h.equals(this.p1))return new z(h);var f=this.projectionFactor(h),_=new z;return _.x=this.p0.x+f*(this.p1.x-this.p0.x),_.y=this.p0.y+f*(this.p1.y-this.p0.y),_}if(arguments[0]instanceof Gr){var A=arguments[0],D=this.projectionFactor(A.p0),H=this.projectionFactor(A.p1);if(D>=1&&H>=1||D<=0&&H<=0)return null;var re=this.project(A.p0);D<0&&(re=this.p0),D>1&&(re=this.p1);var ge=this.project(A.p1);return H<0&&(ge=this.p0),H>1&&(ge=this.p1),new Gr(re,ge)}},Gr.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Gr.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Gr.prototype.getCoordinate=function(h){return h===0?this.p0:this.p1},Gr.prototype.distancePerpendicular=function(h){return pt.distancePointLinePerpendicular(h,this.p0,this.p1)},Gr.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Gr.prototype.midPoint=function(){return Gr.midPoint(this.p0,this.p1)},Gr.prototype.projectionFactor=function(h){if(h.equals(this.p0))return 0;if(h.equals(this.p1))return 1;var f=this.p1.x-this.p0.x,_=this.p1.y-this.p0.y,A=f*f+_*_;return A<=0?O.NaN:((h.x-this.p0.x)*f+(h.y-this.p0.y)*_)/A},Gr.prototype.closestPoints=function(h){var f=this.intersection(h);if(f!==null)return[f,f];var _=new Array(2).fill(null),A=O.MAX_VALUE,D=null,H=this.closestPoint(h.p0);A=H.distance(h.p0),_[0]=H,_[1]=h.p0;var re=this.closestPoint(h.p1);(D=re.distance(h.p1))<A&&(A=D,_[0]=re,_[1]=h.p1);var ge=h.closestPoint(this.p0);(D=ge.distance(this.p0))<A&&(A=D,_[0]=this.p0,_[1]=ge);var Ne=h.closestPoint(this.p1);return(D=Ne.distance(this.p1))<A&&(A=D,_[0]=this.p1,_[1]=Ne),_},Gr.prototype.closestPoint=function(h){var f=this.projectionFactor(h);return f>0&&f<1?this.project(h):this.p0.distance(h)<this.p1.distance(h)?this.p0:this.p1},Gr.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Gr.prototype.getLength=function(){return this.p0.distance(this.p1)},Gr.prototype.compareTo=function(h){var f=h,_=this.p0.compareTo(f.p0);return _!==0?_:this.p1.compareTo(f.p1)},Gr.prototype.reverse=function(){var h=this.p0;this.p0=this.p1,this.p1=h},Gr.prototype.equalsTopo=function(h){return this.p0.equals(h.p0)&&(this.p1.equals(h.p1)||this.p0.equals(h.p1))&&this.p1.equals(h.p0)},Gr.prototype.lineIntersection=function(h){try{return me.intersection(this.p0,this.p1,h.p0,h.p1)}catch(f){if(!(f instanceof fe))throw f}return null},Gr.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Gr.prototype.pointAlongOffset=function(h,f){var _=this.p0.x+h*(this.p1.x-this.p0.x),A=this.p0.y+h*(this.p1.y-this.p0.y),D=this.p1.x-this.p0.x,H=this.p1.y-this.p0.y,re=Math.sqrt(D*D+H*H),ge=0,Ne=0;if(f!==0){if(re<=0)throw new Error("Cannot compute offset from zero-length line segment");ge=f*D/re,Ne=f*H/re}return new z(_-Ne,A+ge)},Gr.prototype.setCoordinates=function(){if(arguments.length===1){var h=arguments[0];this.setCoordinates(h.p0,h.p1)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this.p0.x=f.x,this.p0.y=f.y,this.p1.x=_.x,this.p1.y=_.y}},Gr.prototype.segmentFraction=function(h){var f=this.projectionFactor(h);return f<0?f=0:(f>1||O.isNaN(f))&&(f=1),f},Gr.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Gr.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Gr.prototype.distance=function(){if(arguments[0]instanceof Gr){var h=arguments[0];return pt.distanceLineLine(this.p0,this.p1,h.p0,h.p1)}if(arguments[0]instanceof z){var f=arguments[0];return pt.distancePointLine(f,this.p0,this.p1)}},Gr.prototype.pointAlong=function(h){var f=new z;return f.x=this.p0.x+h*(this.p1.x-this.p0.x),f.y=this.p0.y+h*(this.p1.y-this.p0.y),f},Gr.prototype.hashCode=function(){var h=O.doubleToLongBits(this.p0.x);h^=31*O.doubleToLongBits(this.p0.y);var f=Math.trunc(h)^Math.trunc(h>>32),_=O.doubleToLongBits(this.p1.x);return _^=31*O.doubleToLongBits(this.p1.y),f^(Math.trunc(_)^Math.trunc(_>>32))},Gr.prototype.interfaces_=function(){return[k,i]},Gr.prototype.getClass=function(){return Gr},Gr.midPoint=function(h,f){return new z((h.x+f.x)/2,(h.y+f.y)/2)},bS.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Gr,bS);var xg=s(function(){this.tempEnv1=new Ae,this.tempEnv2=new Ae,this._overlapSeg1=new Gr,this._overlapSeg2=new Gr},"_n");xg.prototype.overlap=function(){if(arguments.length!==2&&arguments.length===4){var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];h.getLineSegment(f,this._overlapSeg1),_.getLineSegment(A,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},xg.prototype.interfaces_=function(){return[]},xg.prototype.getClass=function(){return xg};var Ts=s(function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];this._pts=h,this._start=f,this._end=_,this._context=A},"mn");Ts.prototype.getLineSegment=function(h,f){f.p0=this._pts[h],f.p1=this._pts[h+1]},Ts.prototype.computeSelect=function(h,f,_,A){var D=this._pts[f],H=this._pts[_];if(A.tempEnv1.init(D,H),_-f==1)return A.select(this,f),null;if(!h.intersects(A.tempEnv1))return null;var re=Math.trunc((f+_)/2);f<re&&this.computeSelect(h,f,re,A),re<_&&this.computeSelect(h,re,_,A)},Ts.prototype.getCoordinates=function(){for(var h=new Array(this._end-this._start+1).fill(null),f=0,_=this._start;_<=this._end;_++)h[f++]=this._pts[_];return h},Ts.prototype.computeOverlaps=function(h,f){this.computeOverlapsInternal(this._start,this._end,h,h._start,h._end,f)},Ts.prototype.setId=function(h){this._id=h},Ts.prototype.select=function(h,f){this.computeSelect(h,this._start,this._end,f)},Ts.prototype.getEnvelope=function(){if(this._env===null){var h=this._pts[this._start],f=this._pts[this._end];this._env=new Ae(h,f)}return this._env},Ts.prototype.getEndIndex=function(){return this._end},Ts.prototype.getStartIndex=function(){return this._start},Ts.prototype.getContext=function(){return this._context},Ts.prototype.getId=function(){return this._id},Ts.prototype.computeOverlapsInternal=function(h,f,_,A,D,H){var re=this._pts[h],ge=this._pts[f],Ne=_._pts[A],Ye=_._pts[D];if(f-h==1&&D-A==1)return H.overlap(this,h,_,A),null;if(H.tempEnv1.init(re,ge),H.tempEnv2.init(Ne,Ye),!H.tempEnv1.intersects(H.tempEnv2))return null;var Mt=Math.trunc((h+f)/2),At=Math.trunc((A+D)/2);h<Mt&&(A<At&&this.computeOverlapsInternal(h,Mt,_,A,At,H),At<D&&this.computeOverlapsInternal(h,Mt,_,At,D,H)),Mt<f&&(A<At&&this.computeOverlapsInternal(Mt,f,_,A,At,H),At<D&&this.computeOverlapsInternal(Mt,f,_,At,D,H))},Ts.prototype.interfaces_=function(){return[]},Ts.prototype.getClass=function(){return Ts};var su=s(function(){},"vn");su.prototype.interfaces_=function(){return[]},su.prototype.getClass=function(){return su},su.getChainStartIndices=function(h){var f=0,_=new ue;_.add(new ee(f));do{var A=su.findChainEnd(h,f);_.add(new ee(A)),f=A}while(f<h.length-1);return su.toIntArray(_)},su.findChainEnd=function(h,f){for(var _=f;_<h.length-1&&h[_].equals2D(h[_+1]);)_++;if(_>=h.length-1)return h.length-1;for(var A=ui.quadrant(h[_],h[_+1]),D=f+1;D<h.length&&!(!h[D-1].equals2D(h[D])&&ui.quadrant(h[D-1],h[D])!==A);)D++;return D-1},su.getChains=function(){if(arguments.length===1){var h=arguments[0];return su.getChains(h,null)}if(arguments.length===2){for(var f=arguments[0],_=arguments[1],A=new ue,D=su.getChainStartIndices(f),H=0;H<D.length-1;H++){var re=new Ts(f,D[H],D[H+1],_);A.add(re)}return A}},su.toIntArray=function(h){for(var f=new Array(h.size()).fill(null),_=0;_<f.length;_++)f[_]=h.get(_).intValue();return f};var Ic=s(function(){},"In");Ic.prototype.computeNodes=function(h){},Ic.prototype.getNodedSubstrings=function(){},Ic.prototype.interfaces_=function(){return[]},Ic.prototype.getClass=function(){return Ic};var bg=s(function(){if(this._segInt=null,arguments.length!==0&&arguments.length===1){var h=arguments[0];this.setSegmentIntersector(h)}},"En");bg.prototype.setSegmentIntersector=function(h){this._segInt=h},bg.prototype.interfaces_=function(){return[Ic]},bg.prototype.getClass=function(){return bg};var jx=function(h){function f(A){A?h.call(this,A):h.call(this),this._monoChains=new ue,this._index=new gi,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={SegmentOverlapAction:{configurable:!0}};return f.prototype.getMonotoneChains=function(){return this._monoChains},f.prototype.getNodedSubstrings=function(){return wa.getNodedSubstrings(this._nodedSegStrings)},f.prototype.getIndex=function(){return this._index},f.prototype.add=function(A){for(var D=su.getChains(A.getCoordinates(),A).iterator();D.hasNext();){var H=D.next();H.setId(this._idCounter++),this._index.insert(H.getEnvelope(),H),this._monoChains.add(H)}},f.prototype.computeNodes=function(A){this._nodedSegStrings=A;for(var D=A.iterator();D.hasNext();)this.add(D.next());this.intersectChains()},f.prototype.intersectChains=function(){for(var A=new wS(this._segInt),D=this._monoChains.iterator();D.hasNext();)for(var H=D.next(),re=this._index.query(H.getEnvelope()).iterator();re.hasNext();){var ge=re.next();if(ge.getId()>H.getId()&&(H.computeOverlaps(ge,A),this._nOverlaps++),this._segInt.isDone())return null}},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},_.SegmentOverlapAction.get=function(){return wS},Object.defineProperties(f,_),f}(bg),wS=function(h){function f(){h.call(this),this._si=null;var _=arguments[0];this._si=_}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.overlap=function(){if(arguments.length!==4)return h.prototype.overlap.apply(this,arguments);var _=arguments[0],A=arguments[1],D=arguments[2],H=arguments[3],re=_.getContext(),ge=D.getContext();this._si.processIntersections(re,A,ge,H)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(xg),Xi=s(function h(){if(this._quadrantSegments=h.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=h.CAP_ROUND,this._joinStyle=h.JOIN_ROUND,this._mitreLimit=h.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=h.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var f=arguments[0];this.setQuadrantSegments(f)}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(A)}else if(arguments.length===4){var D=arguments[0],H=arguments[1],re=arguments[2],ge=arguments[3];this.setQuadrantSegments(D),this.setEndCapStyle(H),this.setJoinStyle(re),this.setMitreLimit(ge)}}},"t"),Tc={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Xi.prototype.getEndCapStyle=function(){return this._endCapStyle},Xi.prototype.isSingleSided=function(){return this._isSingleSided},Xi.prototype.setQuadrantSegments=function(h){this._quadrantSegments=h,this._quadrantSegments===0&&(this._joinStyle=Xi.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Xi.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),h<=0&&(this._quadrantSegments=1),this._joinStyle!==Xi.JOIN_ROUND&&(this._quadrantSegments=Xi.DEFAULT_QUADRANT_SEGMENTS)},Xi.prototype.getJoinStyle=function(){return this._joinStyle},Xi.prototype.setJoinStyle=function(h){this._joinStyle=h},Xi.prototype.setSimplifyFactor=function(h){this._simplifyFactor=h<0?0:h},Xi.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Xi.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Xi.prototype.setEndCapStyle=function(h){this._endCapStyle=h},Xi.prototype.getMitreLimit=function(){return this._mitreLimit},Xi.prototype.setMitreLimit=function(h){this._mitreLimit=h},Xi.prototype.setSingleSided=function(h){this._isSingleSided=h},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi},Xi.bufferDistanceError=function(h){var f=Math.PI/2/h;return 1-Math.cos(f/2)},Tc.CAP_ROUND.get=function(){return 1},Tc.CAP_FLAT.get=function(){return 2},Tc.CAP_SQUARE.get=function(){return 3},Tc.JOIN_ROUND.get=function(){return 1},Tc.JOIN_MITRE.get=function(){return 2},Tc.JOIN_BEVEL.get=function(){return 3},Tc.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Tc.DEFAULT_MITRE_LIMIT.get=function(){return 5},Tc.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(Xi,Tc);var ua=s(function(h){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=pt.COUNTERCLOCKWISE,this._inputLine=h||null},"Ln"),wg={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ua.prototype.isDeletable=function(h,f,_,A){var D=this._inputLine[h],H=this._inputLine[f],re=this._inputLine[_];return!!this.isConcave(D,H,re)&&!!this.isShallow(D,H,re,A)&&this.isShallowSampled(D,H,h,_,A)},ua.prototype.deleteShallowConcavities=function(){for(var h=1,f=this.findNextNonDeletedIndex(h),_=this.findNextNonDeletedIndex(f),A=!1;_<this._inputLine.length;){var D=!1;this.isDeletable(h,f,_,this._distanceTol)&&(this._isDeleted[f]=ua.DELETE,D=!0,A=!0),h=D?_:f,f=this.findNextNonDeletedIndex(h),_=this.findNextNonDeletedIndex(f)}return A},ua.prototype.isShallowConcavity=function(h,f,_,A){return pt.computeOrientation(h,f,_)!==this._angleOrientation?!1:pt.distancePointLine(f,h,_)<A},ua.prototype.isShallowSampled=function(h,f,_,A,D){var H=Math.trunc((A-_)/ua.NUM_PTS_TO_CHECK);H<=0&&(H=1);for(var re=_;re<A;re+=H)if(!this.isShallow(h,f,this._inputLine[re],D))return!1;return!0},ua.prototype.isConcave=function(h,f,_){var A=pt.computeOrientation(h,f,_)===this._angleOrientation;return A},ua.prototype.simplify=function(h){this._distanceTol=Math.abs(h),h<0&&(this._angleOrientation=pt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var f=!1;do f=this.deleteShallowConcavities();while(f);return this.collapseLine()},ua.prototype.findNextNonDeletedIndex=function(h){for(var f=h+1;f<this._inputLine.length&&this._isDeleted[f]===ua.DELETE;)f++;return f},ua.prototype.isShallow=function(h,f,_,A){return pt.distancePointLine(f,h,_)<A},ua.prototype.collapseLine=function(){for(var h=new ze,f=0;f<this._inputLine.length;f++)this._isDeleted[f]!==ua.DELETE&&h.add(this._inputLine[f]);return h.toCoordinateArray()},ua.prototype.interfaces_=function(){return[]},ua.prototype.getClass=function(){return ua},ua.simplify=function(h,f){return new ua(h).simplify(f)},wg.INIT.get=function(){return 0},wg.DELETE.get=function(){return 1},wg.KEEP.get=function(){return 1},wg.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(ua,wg);var Xs=s(function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ue},"wn"),AS={COORDINATE_ARRAY_TYPE:{configurable:!0}};Xs.prototype.getCoordinates=function(){return this._ptList.toArray(Xs.COORDINATE_ARRAY_TYPE)},Xs.prototype.setPrecisionModel=function(h){this._precisionModel=h},Xs.prototype.addPt=function(h){var f=new z(h);if(this._precisionModel.makePrecise(f),this.isRedundant(f))return null;this._ptList.add(f)},Xs.prototype.revere=function(){},Xs.prototype.addPts=function(h,f){if(f)for(var _=0;_<h.length;_++)this.addPt(h[_]);else for(var A=h.length-1;A>=0;A--)this.addPt(h[A])},Xs.prototype.isRedundant=function(h){if(this._ptList.size()<1)return!1;var f=this._ptList.get(this._ptList.size()-1);return h.distance(f)<this._minimimVertexDistance},Xs.prototype.toString=function(){return new qr().createLineString(this.getCoordinates()).toString()},Xs.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var h=new z(this._ptList.get(0)),f=this._ptList.get(this._ptList.size()-1);if(h.equals(f))return null;this._ptList.add(h)},Xs.prototype.setMinimumVertexDistance=function(h){this._minimimVertexDistance=h},Xs.prototype.interfaces_=function(){return[]},Xs.prototype.getClass=function(){return Xs},AS.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Xs,AS);var Bi=s(function(){},"Tn"),cd={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.toDegrees=function(h){return 180*h/Math.PI},Bi.normalize=function(h){for(;h>Math.PI;)h-=Bi.PI_TIMES_2;for(;h<=-Math.PI;)h+=Bi.PI_TIMES_2;return h},Bi.angle=function(){if(arguments.length===1){var h=arguments[0];return Math.atan2(h.y,h.x)}if(arguments.length===2){var f=arguments[0],_=arguments[1],A=_.x-f.x,D=_.y-f.y;return Math.atan2(D,A)}},Bi.isAcute=function(h,f,_){var A=h.x-f.x,D=h.y-f.y;return A*(_.x-f.x)+D*(_.y-f.y)>0},Bi.isObtuse=function(h,f,_){var A=h.x-f.x,D=h.y-f.y;return A*(_.x-f.x)+D*(_.y-f.y)<0},Bi.interiorAngle=function(h,f,_){var A=Bi.angle(f,h),D=Bi.angle(f,_);return Math.abs(D-A)},Bi.normalizePositive=function(h){if(h<0){for(;h<0;)h+=Bi.PI_TIMES_2;h>=Bi.PI_TIMES_2&&(h=0)}else{for(;h>=Bi.PI_TIMES_2;)h-=Bi.PI_TIMES_2;h<0&&(h=0)}return h},Bi.angleBetween=function(h,f,_){var A=Bi.angle(f,h),D=Bi.angle(f,_);return Bi.diff(A,D)},Bi.diff=function(h,f){var _=null;return(_=h<f?f-h:h-f)>Math.PI&&(_=2*Math.PI-_),_},Bi.toRadians=function(h){return h*Math.PI/180},Bi.getTurn=function(h,f){var _=Math.sin(f-h);return _>0?Bi.COUNTERCLOCKWISE:_<0?Bi.CLOCKWISE:Bi.NONE},Bi.angleBetweenOriented=function(h,f,_){var A=Bi.angle(f,h),D=Bi.angle(f,_)-A;return D<=-Math.PI?D+Bi.PI_TIMES_2:D>Math.PI?D-Bi.PI_TIMES_2:D},cd.PI_TIMES_2.get=function(){return 2*Math.PI},cd.PI_OVER_2.get=function(){return Math.PI/2},cd.PI_OVER_4.get=function(){return Math.PI/4},cd.COUNTERCLOCKWISE.get=function(){return pt.COUNTERCLOCKWISE},cd.CLOCKWISE.get=function(){return pt.CLOCKWISE},cd.NONE.get=function(){return pt.COLLINEAR},Object.defineProperties(Bi,cd);var jn=s(function h(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Gr,this._seg1=new Gr,this._offset0=new Gr,this._offset1=new Gr,this._side=0,this._hasNarrowConcaveAngle=!1;var f=arguments[0],_=arguments[1],A=arguments[2];this._precisionModel=f,this._bufParams=_,this._li=new It,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===Xi.JOIN_ROUND&&(this._closingSegLengthFactor=h.MAX_CLOSING_SEG_LEN_FACTOR),this.init(A)},"t"),Ag={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};jn.prototype.addNextSegment=function(h,f){if(this._s0=this._s1,this._s1=this._s2,this._s2=h,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var _=pt.computeOrientation(this._s0,this._s1,this._s2),A=_===pt.CLOCKWISE&&this._side===Le.LEFT||_===pt.COUNTERCLOCKWISE&&this._side===Le.RIGHT;_===0?this.addCollinear(f):A?this.addOutsideTurn(_,f):this.addInsideTurn(_,f)},jn.prototype.addLineEndCap=function(h,f){var _=new Gr(h,f),A=new Gr;this.computeOffsetSegment(_,Le.LEFT,this._distance,A);var D=new Gr;this.computeOffsetSegment(_,Le.RIGHT,this._distance,D);var H=f.x-h.x,re=f.y-h.y,ge=Math.atan2(re,H);switch(this._bufParams.getEndCapStyle()){case Xi.CAP_ROUND:this._segList.addPt(A.p1),this.addFilletArc(f,ge+Math.PI/2,ge-Math.PI/2,pt.CLOCKWISE,this._distance),this._segList.addPt(D.p1);break;case Xi.CAP_FLAT:this._segList.addPt(A.p1),this._segList.addPt(D.p1);break;case Xi.CAP_SQUARE:var Ne=new z;Ne.x=Math.abs(this._distance)*Math.cos(ge),Ne.y=Math.abs(this._distance)*Math.sin(ge);var Ye=new z(A.p1.x+Ne.x,A.p1.y+Ne.y),Mt=new z(D.p1.x+Ne.x,D.p1.y+Ne.y);this._segList.addPt(Ye),this._segList.addPt(Mt)}},jn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},jn.prototype.addMitreJoin=function(h,f,_,A){var D=!0,H=null;try{H=me.intersection(f.p0,f.p1,_.p0,_.p1),(A<=0?1:H.distance(h)/Math.abs(A))>this._bufParams.getMitreLimit()&&(D=!1)}catch(re){if(!(re instanceof fe))throw re;H=new z(0,0),D=!1}D?this._segList.addPt(H):this.addLimitedMitreJoin(f,_,A,this._bufParams.getMitreLimit())},jn.prototype.addFilletCorner=function(h,f,_,A,D){var H=f.x-h.x,re=f.y-h.y,ge=Math.atan2(re,H),Ne=_.x-h.x,Ye=_.y-h.y,Mt=Math.atan2(Ye,Ne);A===pt.CLOCKWISE?ge<=Mt&&(ge+=2*Math.PI):ge>=Mt&&(ge-=2*Math.PI),this._segList.addPt(f),this.addFilletArc(h,ge,Mt,A,D),this._segList.addPt(_)},jn.prototype.addOutsideTurn=function(h,f){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*jn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Xi.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Xi.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(f&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,h,this._distance),this._segList.addPt(this._offset1.p0))},jn.prototype.createSquare=function(h){this._segList.addPt(new z(h.x+this._distance,h.y+this._distance)),this._segList.addPt(new z(h.x+this._distance,h.y-this._distance)),this._segList.addPt(new z(h.x-this._distance,h.y-this._distance)),this._segList.addPt(new z(h.x-this._distance,h.y+this._distance)),this._segList.closeRing()},jn.prototype.addSegments=function(h,f){this._segList.addPts(h,f)},jn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},jn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},jn.prototype.initSideSegments=function(h,f,_){this._s1=h,this._s2=f,this._side=_,this._seg1.setCoordinates(h,f),this.computeOffsetSegment(this._seg1,_,this._distance,this._offset1)},jn.prototype.addLimitedMitreJoin=function(h,f,_,A){var D=this._seg0.p1,H=Bi.angle(D,this._seg0.p0),re=Bi.angleBetweenOriented(this._seg0.p0,D,this._seg1.p1)/2,ge=Bi.normalize(H+re),Ne=Bi.normalize(ge+Math.PI),Ye=A*_,Mt=_-Ye*Math.abs(Math.sin(re)),At=D.x+Ye*Math.cos(Ne),hr=D.y+Ye*Math.sin(Ne),gr=new z(At,hr),Sr=new Gr(D,gr),Qr=Sr.pointAlongOffset(1,Mt),ji=Sr.pointAlongOffset(1,-Mt);this._side===Le.LEFT?(this._segList.addPt(Qr),this._segList.addPt(ji)):(this._segList.addPt(ji),this._segList.addPt(Qr))},jn.prototype.computeOffsetSegment=function(h,f,_,A){var D=f===Le.LEFT?1:-1,H=h.p1.x-h.p0.x,re=h.p1.y-h.p0.y,ge=Math.sqrt(H*H+re*re),Ne=D*_*H/ge,Ye=D*_*re/ge;A.p0.x=h.p0.x-Ye,A.p0.y=h.p0.y+Ne,A.p1.x=h.p1.x-Ye,A.p1.y=h.p1.y+Ne},jn.prototype.addFilletArc=function(h,f,_,A,D){var H=A===pt.CLOCKWISE?-1:1,re=Math.abs(f-_),ge=Math.trunc(re/this._filletAngleQuantum+.5);if(ge<1)return null;for(var Ne=re/ge,Ye=0,Mt=new z;Ye<re;){var At=f+H*Ye;Mt.x=h.x+D*Math.cos(At),Mt.y=h.y+D*Math.sin(At),this._segList.addPt(Mt),Ye+=Ne}},jn.prototype.addInsideTurn=function(h,f){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*jn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var _=new z((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_);var A=new z((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(A)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},jn.prototype.createCircle=function(h){var f=new z(h.x+this._distance,h.y);this._segList.addPt(f),this.addFilletArc(h,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},jn.prototype.addBevelJoin=function(h,f){this._segList.addPt(h.p1),this._segList.addPt(f.p0)},jn.prototype.init=function(h){this._distance=h,this._maxCurveSegmentError=h*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Xs,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(h*jn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},jn.prototype.addCollinear=function(h){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Xi.JOIN_BEVEL||this._bufParams.getJoinStyle()===Xi.JOIN_MITRE?(h&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,pt.CLOCKWISE,this._distance))},jn.prototype.closeRing=function(){this._segList.closeRing()},jn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn},Ag.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Ag.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Ag.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ag.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(jn,Ag);var Lo=s(function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var h=arguments[0],f=arguments[1];this._precisionModel=h,this._bufParams=f},"Mn");Lo.prototype.getOffsetCurve=function(h,f){if(this._distance=f,f===0)return null;var _=f<0,A=Math.abs(f),D=this.getSegGen(A);h.length<=1?this.computePointCurve(h[0],D):this.computeOffsetCurve(h,_,D);var H=D.getCoordinates();return _&&Re.reverse(H),H},Lo.prototype.computeSingleSidedBufferCurve=function(h,f,_){var A=this.simplifyTolerance(this._distance);if(f){_.addSegments(h,!0);var D=ua.simplify(h,-A),H=D.length-1;_.initSideSegments(D[H],D[H-1],Le.LEFT),_.addFirstSegment();for(var re=H-2;re>=0;re--)_.addNextSegment(D[re],!0)}else{_.addSegments(h,!1);var ge=ua.simplify(h,A),Ne=ge.length-1;_.initSideSegments(ge[0],ge[1],Le.LEFT),_.addFirstSegment();for(var Ye=2;Ye<=Ne;Ye++)_.addNextSegment(ge[Ye],!0)}_.addLastSegment(),_.closeRing()},Lo.prototype.computeRingBufferCurve=function(h,f,_){var A=this.simplifyTolerance(this._distance);f===Le.RIGHT&&(A=-A);var D=ua.simplify(h,A),H=D.length-1;_.initSideSegments(D[H-1],D[0],f);for(var re=1;re<=H;re++){var ge=re!==1;_.addNextSegment(D[re],ge)}_.closeRing()},Lo.prototype.computeLineBufferCurve=function(h,f){var _=this.simplifyTolerance(this._distance),A=ua.simplify(h,_),D=A.length-1;f.initSideSegments(A[0],A[1],Le.LEFT);for(var H=2;H<=D;H++)f.addNextSegment(A[H],!0);f.addLastSegment(),f.addLineEndCap(A[D-1],A[D]);var re=ua.simplify(h,-_),ge=re.length-1;f.initSideSegments(re[ge],re[ge-1],Le.LEFT);for(var Ne=ge-2;Ne>=0;Ne--)f.addNextSegment(re[Ne],!0);f.addLastSegment(),f.addLineEndCap(re[1],re[0]),f.closeRing()},Lo.prototype.computePointCurve=function(h,f){switch(this._bufParams.getEndCapStyle()){case Xi.CAP_ROUND:f.createCircle(h);break;case Xi.CAP_SQUARE:f.createSquare(h)}},Lo.prototype.getLineCurve=function(h,f){if(this._distance=f,f<0&&!this._bufParams.isSingleSided()||f===0)return null;var _=Math.abs(f),A=this.getSegGen(_);if(h.length<=1)this.computePointCurve(h[0],A);else if(this._bufParams.isSingleSided()){var D=f<0;this.computeSingleSidedBufferCurve(h,D,A)}else this.computeLineBufferCurve(h,A);return A.getCoordinates()},Lo.prototype.getBufferParameters=function(){return this._bufParams},Lo.prototype.simplifyTolerance=function(h){return h*this._bufParams.getSimplifyFactor()},Lo.prototype.getRingCurve=function(h,f,_){if(this._distance=_,h.length<=2)return this.getLineCurve(h,_);if(_===0)return Lo.copyCoordinates(h);var A=this.getSegGen(_);return this.computeRingBufferCurve(h,f,A),A.getCoordinates()},Lo.prototype.computeOffsetCurve=function(h,f,_){var A=this.simplifyTolerance(this._distance);if(f){var D=ua.simplify(h,-A),H=D.length-1;_.initSideSegments(D[H],D[H-1],Le.LEFT),_.addFirstSegment();for(var re=H-2;re>=0;re--)_.addNextSegment(D[re],!0)}else{var ge=ua.simplify(h,A),Ne=ge.length-1;_.initSideSegments(ge[0],ge[1],Le.LEFT),_.addFirstSegment();for(var Ye=2;Ye<=Ne;Ye++)_.addNextSegment(ge[Ye],!0)}_.addLastSegment()},Lo.prototype.getSegGen=function(h){return new jn(this._precisionModel,this._bufParams,h)},Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo},Lo.copyCoordinates=function(h){for(var f=new Array(h.length).fill(null),_=0;_<f.length;_++)f[_]=new z(h[_]);return f};var Wu=s(function(){this._subgraphs=null,this._seg=new Gr,this._cga=new pt;var h=arguments[0];this._subgraphs=h},"An"),SS={DepthSegment:{configurable:!0}};Wu.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var h=arguments[0],f=new ue,_=this._subgraphs.iterator();_.hasNext();){var A=_.next(),D=A.getEnvelope();h.y<D.getMinY()||h.y>D.getMaxY()||this.findStabbedSegments(h,A.getDirectedEdges(),f)}return f}if(arguments.length===3){if(Y(arguments[2],se)&&arguments[0]instanceof z&&arguments[1]instanceof xo){for(var H=arguments[0],re=arguments[1],ge=arguments[2],Ne=re.getEdge().getCoordinates(),Ye=0;Ye<Ne.length-1;Ye++)if(this._seg.p0=Ne[Ye],this._seg.p1=Ne[Ye+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<H.x)&&!(this._seg.isHorizontal()||H.y<this._seg.p0.y||H.y>this._seg.p1.y||pt.computeOrientation(this._seg.p0,this._seg.p1,H)===pt.RIGHT)){var Mt=re.getDepth(Le.LEFT);this._seg.p0.equals(Ne[Ye])||(Mt=re.getDepth(Le.RIGHT));var At=new sh(this._seg,Mt);ge.add(At)}}else if(Y(arguments[2],se)&&arguments[0]instanceof z&&Y(arguments[1],se))for(var hr=arguments[0],gr=arguments[1],Sr=arguments[2],Qr=gr.iterator();Qr.hasNext();){var ji=Qr.next();ji.isForward()&&this.findStabbedSegments(hr,ji,Sr)}}},Wu.prototype.getDepth=function(h){var f=this.findStabbedSegments(h);return f.size()===0?0:Ge.min(f)._leftDepth},Wu.prototype.interfaces_=function(){return[]},Wu.prototype.getClass=function(){return Wu},SS.DepthSegment.get=function(){return sh},Object.defineProperties(Wu,SS);var sh=s(function(){this._upwardSeg=null,this._leftDepth=null;var h=arguments[0],f=arguments[1];this._upwardSeg=new Gr(h),this._leftDepth=f},"Gn");sh.prototype.compareTo=function(h){var f=h;if(this._upwardSeg.minX()>=f._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=f._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(f._upwardSeg);return _!==0||(_=-1*f._upwardSeg.orientationIndex(this._upwardSeg))!=0?_:this._upwardSeg.compareTo(f._upwardSeg)},sh.prototype.compareX=function(h,f){var _=h.p0.compareTo(f.p0);return _!==0?_:h.p1.compareTo(f.p1)},sh.prototype.toString=function(){return this._upwardSeg.toString()},sh.prototype.interfaces_=function(){return[k]},sh.prototype.getClass=function(){return sh};var Zi=s(function(h,f,_){this.p0=h||null,this.p1=f||null,this.p2=_||null},"qn");Zi.prototype.area=function(){return Zi.area(this.p0,this.p1,this.p2)},Zi.prototype.signedArea=function(){return Zi.signedArea(this.p0,this.p1,this.p2)},Zi.prototype.interpolateZ=function(h){if(h===null)throw new T("Supplied point is null.");return Zi.interpolateZ(h,this.p0,this.p1,this.p2)},Zi.prototype.longestSideLength=function(){return Zi.longestSideLength(this.p0,this.p1,this.p2)},Zi.prototype.isAcute=function(){return Zi.isAcute(this.p0,this.p1,this.p2)},Zi.prototype.circumcentre=function(){return Zi.circumcentre(this.p0,this.p1,this.p2)},Zi.prototype.area3D=function(){return Zi.area3D(this.p0,this.p1,this.p2)},Zi.prototype.centroid=function(){return Zi.centroid(this.p0,this.p1,this.p2)},Zi.prototype.inCentre=function(){return Zi.inCentre(this.p0,this.p1,this.p2)},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Zi.area=function(h,f,_){return Math.abs(((_.x-h.x)*(f.y-h.y)-(f.x-h.x)*(_.y-h.y))/2)},Zi.signedArea=function(h,f,_){return((_.x-h.x)*(f.y-h.y)-(f.x-h.x)*(_.y-h.y))/2},Zi.det=function(h,f,_,A){return h*A-f*_},Zi.interpolateZ=function(h,f,_,A){var D=f.x,H=f.y,re=_.x-D,ge=A.x-D,Ne=_.y-H,Ye=A.y-H,Mt=re*Ye-ge*Ne,At=h.x-D,hr=h.y-H,gr=(Ye*At-ge*hr)/Mt,Sr=(-Ne*At+re*hr)/Mt;return f.z+gr*(_.z-f.z)+Sr*(A.z-f.z)},Zi.longestSideLength=function(h,f,_){var A=h.distance(f),D=f.distance(_),H=_.distance(h),re=A;return D>re&&(re=D),H>re&&(re=H),re},Zi.isAcute=function(h,f,_){return!!Bi.isAcute(h,f,_)&&!!Bi.isAcute(f,_,h)&&!!Bi.isAcute(_,h,f)},Zi.circumcentre=function(h,f,_){var A=_.x,D=_.y,H=h.x-A,re=h.y-D,ge=f.x-A,Ne=f.y-D,Ye=2*Zi.det(H,re,ge,Ne),Mt=Zi.det(re,H*H+re*re,Ne,ge*ge+Ne*Ne),At=Zi.det(H,H*H+re*re,ge,ge*ge+Ne*Ne);return new z(A-Mt/Ye,D+At/Ye)},Zi.perpendicularBisector=function(h,f){var _=f.x-h.x,A=f.y-h.y,D=new me(h.x+_/2,h.y+A/2,1),H=new me(h.x-A+_/2,h.y+_+A/2,1);return new me(D,H)},Zi.angleBisector=function(h,f,_){var A=f.distance(h),D=A/(A+f.distance(_)),H=_.x-h.x,re=_.y-h.y;return new z(h.x+D*H,h.y+D*re)},Zi.area3D=function(h,f,_){var A=f.x-h.x,D=f.y-h.y,H=f.z-h.z,re=_.x-h.x,ge=_.y-h.y,Ne=_.z-h.z,Ye=D*Ne-H*ge,Mt=H*re-A*Ne,At=A*ge-D*re,hr=Ye*Ye+Mt*Mt+At*At,gr=Math.sqrt(hr)/2;return gr},Zi.centroid=function(h,f,_){var A=(h.x+f.x+_.x)/3,D=(h.y+f.y+_.y)/3;return new z(A,D)},Zi.inCentre=function(h,f,_){var A=f.distance(_),D=h.distance(_),H=h.distance(f),re=A+D+H,ge=(A*h.x+D*f.x+H*_.x)/re,Ne=(A*h.y+D*f.y+H*_.y)/re;return new z(ge,Ne)};var Zs=s(function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ue;var h=arguments[0],f=arguments[1],_=arguments[2];this._inputGeom=h,this._distance=f,this._curveBuilder=_},"Bn");Zs.prototype.addPoint=function(h){if(this._distance<=0)return null;var f=h.getCoordinates(),_=this._curveBuilder.getLineCurve(f,this._distance);this.addCurve(_,V.EXTERIOR,V.INTERIOR)},Zs.prototype.addPolygon=function(h){var f=this._distance,_=Le.LEFT;this._distance<0&&(f=-this._distance,_=Le.RIGHT);var A=h.getExteriorRing(),D=Re.removeRepeatedPoints(A.getCoordinates());if(this._distance<0&&this.isErodedCompletely(A,this._distance)||this._distance<=0&&D.length<3)return null;this.addPolygonRing(D,f,_,V.EXTERIOR,V.INTERIOR);for(var H=0;H<h.getNumInteriorRing();H++){var re=h.getInteriorRingN(H),ge=Re.removeRepeatedPoints(re.getCoordinates());this._distance>0&&this.isErodedCompletely(re,-this._distance)||this.addPolygonRing(ge,f,Le.opposite(_),V.INTERIOR,V.EXTERIOR)}},Zs.prototype.isTriangleErodedCompletely=function(h,f){var _=new Zi(h[0],h[1],h[2]),A=_.inCentre();return pt.distancePointLine(A,_.p0,_.p1)<Math.abs(f)},Zs.prototype.addLineString=function(h){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var f=Re.removeRepeatedPoints(h.getCoordinates()),_=this._curveBuilder.getLineCurve(f,this._distance);this.addCurve(_,V.EXTERIOR,V.INTERIOR)},Zs.prototype.addCurve=function(h,f,_){if(h===null||h.length<2)return null;var A=new wa(h,new lr(0,V.BOUNDARY,f,_));this._curveList.add(A)},Zs.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Zs.prototype.addPolygonRing=function(h,f,_,A,D){if(f===0&&h.length<ur.MINIMUM_VALID_SIZE)return null;var H=A,re=D;h.length>=ur.MINIMUM_VALID_SIZE&&pt.isCCW(h)&&(H=D,re=A,_=Le.opposite(_));var ge=this._curveBuilder.getRingCurve(h,_,f);this.addCurve(ge,H,re)},Zs.prototype.add=function(h){if(h.isEmpty())return null;h instanceof zt?this.addPolygon(h):h instanceof Je?this.addLineString(h):h instanceof ft?this.addPoint(h):h instanceof cr?this.addCollection(h):h instanceof Ei?this.addCollection(h):h instanceof Ar?this.addCollection(h):h instanceof Cr&&this.addCollection(h)},Zs.prototype.isErodedCompletely=function(h,f){var _=h.getCoordinates();if(_.length<4)return f<0;if(_.length===4)return this.isTriangleErodedCompletely(_,f);var A=h.getEnvelopeInternal(),D=Math.min(A.getHeight(),A.getWidth());return f<0&&2*Math.abs(f)>D},Zs.prototype.addCollection=function(h){for(var f=0;f<h.getNumGeometries();f++){var _=h.getGeometryN(f);this.add(_)}},Zs.prototype.interfaces_=function(){return[]},Zs.prototype.getClass=function(){return Zs};var hd=s(function(){},"Vn");hd.prototype.locate=function(h){},hd.prototype.interfaces_=function(){return[]},hd.prototype.getClass=function(){return hd};var lu=s(function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var h=arguments[0];this._parent=h,this._atStart=!0,this._index=0,this._max=h.getNumGeometries()},"Un");lu.prototype.next=function(){if(this._atStart)return this._atStart=!1,lu.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new a;var h=this._parent.getGeometryN(this._index++);return h instanceof Cr?(this._subcollectionIterator=new lu(h),this._subcollectionIterator.next()):h},lu.prototype.remove=function(){throw new Error(this.getClass().getName())},lu.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},lu.prototype.interfaces_=function(){return[Oe]},lu.prototype.getClass=function(){return lu},lu.isAtomic=function(h){return!(h instanceof Cr)};var bo=s(function(){this._geom=null;var h=arguments[0];this._geom=h},"zn");bo.prototype.locate=function(h){return bo.locate(h,this._geom)},bo.prototype.interfaces_=function(){return[hd]},bo.prototype.getClass=function(){return bo},bo.isPointInRing=function(h,f){return!!f.getEnvelopeInternal().intersects(h)&&pt.isPointInRing(h,f.getCoordinates())},bo.containsPointInPolygon=function(h,f){if(f.isEmpty())return!1;var _=f.getExteriorRing();if(!bo.isPointInRing(h,_))return!1;for(var A=0;A<f.getNumInteriorRing();A++){var D=f.getInteriorRingN(A);if(bo.isPointInRing(h,D))return!1}return!0},bo.containsPoint=function(h,f){if(f instanceof zt)return bo.containsPointInPolygon(h,f);if(f instanceof Cr)for(var _=new lu(f);_.hasNext();){var A=_.next();if(A!==f&&bo.containsPoint(h,A))return!0}return!1},bo.locate=function(h,f){return f.isEmpty()?V.EXTERIOR:bo.containsPoint(h,f)?V.INTERIOR:V.EXTERIOR};var Do=s(function(){this._edgeMap=new v,this._edgeList=null,this._ptInAreaLocation=[V.NONE,V.NONE]},"Xn");Do.prototype.getNextCW=function(h){this.getEdges();var f=this._edgeList.indexOf(h),_=f-1;return f===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)},Do.prototype.propagateSideLabels=function(h){for(var f=V.NONE,_=this.iterator();_.hasNext();){var A=_.next().getLabel();A.isArea(h)&&A.getLocation(h,Le.LEFT)!==V.NONE&&(f=A.getLocation(h,Le.LEFT))}if(f===V.NONE)return null;for(var D=f,H=this.iterator();H.hasNext();){var re=H.next(),ge=re.getLabel();if(ge.getLocation(h,Le.ON)===V.NONE&&ge.setLocation(h,Le.ON,D),ge.isArea(h)){var Ne=ge.getLocation(h,Le.LEFT),Ye=ge.getLocation(h,Le.RIGHT);if(Ye!==V.NONE){if(Ye!==D)throw new qt("side location conflict",re.getCoordinate());Ne===V.NONE&&Me.shouldNeverReachHere("found single null side (at "+re.getCoordinate()+")"),D=Ne}else Me.isTrue(ge.getLocation(h,Le.LEFT)===V.NONE,"found single null side"),ge.setLocation(h,Le.RIGHT,D),ge.setLocation(h,Le.LEFT,D)}}},Do.prototype.getCoordinate=function(){var h=this.iterator();return h.hasNext()?h.next().getCoordinate():null},Do.prototype.print=function(h){Pe.out.println("EdgeEndStar:   "+this.getCoordinate());for(var f=this.iterator();f.hasNext();)f.next().print(h)},Do.prototype.isAreaLabelsConsistent=function(h){return this.computeEdgeEndLabels(h.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Do.prototype.checkAreaLabelsConsistent=function(h){var f=this.getEdges();if(f.size()<=0)return!0;var _=f.size()-1,A=f.get(_).getLabel().getLocation(h,Le.LEFT);Me.isTrue(A!==V.NONE,"Found unlabelled area edge");for(var D=A,H=this.iterator();H.hasNext();){var re=H.next().getLabel();Me.isTrue(re.isArea(h),"Found non-area edge");var ge=re.getLocation(h,Le.LEFT),Ne=re.getLocation(h,Le.RIGHT);if(ge===Ne||Ne!==D)return!1;D=ge}return!0},Do.prototype.findIndex=function(h){this.iterator();for(var f=0;f<this._edgeList.size();f++)if(this._edgeList.get(f)===h)return f;return-1},Do.prototype.iterator=function(){return this.getEdges().iterator()},Do.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new ue(this._edgeMap.values())),this._edgeList},Do.prototype.getLocation=function(h,f,_){return this._ptInAreaLocation[h]===V.NONE&&(this._ptInAreaLocation[h]=bo.locate(f,_[h].getGeometry())),this._ptInAreaLocation[h]},Do.prototype.toString=function(){var h=new ae;h.append("EdgeEndStar:   "+this.getCoordinate()),h.append(`
`);for(var f=this.iterator();f.hasNext();){var _=f.next();h.append(_),h.append(`
`)}return h.toString()},Do.prototype.computeEdgeEndLabels=function(h){for(var f=this.iterator();f.hasNext();)f.next().computeLabel(h)},Do.prototype.computeLabelling=function(h){this.computeEdgeEndLabels(h[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var f=[!1,!1],_=this.iterator();_.hasNext();)for(var A=_.next().getLabel(),D=0;D<2;D++)A.isLine(D)&&A.getLocation(D)===V.BOUNDARY&&(f[D]=!0);for(var H=this.iterator();H.hasNext();)for(var re=H.next(),ge=re.getLabel(),Ne=0;Ne<2;Ne++)if(ge.isAnyNull(Ne)){var Ye=V.NONE;if(f[Ne])Ye=V.EXTERIOR;else{var Mt=re.getCoordinate();Ye=this.getLocation(Ne,Mt,h)}ge.setAllLocationsIfNull(Ne,Ye)}},Do.prototype.getDegree=function(){return this._edgeMap.size()},Do.prototype.insertEdgeEnd=function(h,f){this._edgeMap.put(h,f),this._edgeList=null},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do};var K5=function(h){function f(){h.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var _=null,A=null,D=this._SCANNING_FOR_INCOMING,H=0;H<this._resultAreaEdgeList.size();H++){var re=this._resultAreaEdgeList.get(H),ge=re.getSym();if(re.getLabel().isArea())switch(_===null&&re.isInResult()&&(_=re),D){case this._SCANNING_FOR_INCOMING:if(!ge.isInResult())continue;A=ge,D=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!re.isInResult())continue;A.setNext(re),D=this._SCANNING_FOR_INCOMING}}if(D===this._LINKING_TO_OUTGOING){if(_===null)throw new qt("no outgoing dirEdge found",this.getCoordinate());Me.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),A.setNext(_)}},f.prototype.insert=function(_){var A=_;this.insertEdgeEnd(A,A)},f.prototype.getRightmostEdge=function(){var _=this.getEdges(),A=_.size();if(A<1)return null;var D=_.get(0);if(A===1)return D;var H=_.get(A-1),re=D.getQuadrant(),ge=H.getQuadrant();return ui.isNorthern(re)&&ui.isNorthern(ge)?D:ui.isNorthern(re)||ui.isNorthern(ge)?D.getDy()!==0?D:H.getDy()!==0?H:(Me.shouldNeverReachHere("found two horizontal edges incident on node"),null):H},f.prototype.print=function(_){Pe.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var A=this.iterator();A.hasNext();){var D=A.next();_.print("out "),D.print(_),_.println(),_.print("in "),D.getSym().print(_),_.println()}},f.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ue;for(var _=this.iterator();_.hasNext();){var A=_.next();(A.isInResult()||A.getSym().isInResult())&&this._resultAreaEdgeList.add(A)}return this._resultAreaEdgeList},f.prototype.updateLabelling=function(_){for(var A=this.iterator();A.hasNext();){var D=A.next().getLabel();D.setAllLocationsIfNull(0,_.getLocation(0)),D.setAllLocationsIfNull(1,_.getLocation(1))}},f.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var _=null,A=null,D=this._edgeList.size()-1;D>=0;D--){var H=this._edgeList.get(D),re=H.getSym();A===null&&(A=re),_!==null&&re.setNext(_),_=H}A.setNext(_)},f.prototype.computeDepths=function(){if(arguments.length===1){var _=arguments[0],A=this.findIndex(_),D=_.getDepth(Le.LEFT),H=_.getDepth(Le.RIGHT),re=this.computeDepths(A+1,this._edgeList.size(),D);if(this.computeDepths(0,A,re)!==H)throw new qt("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var ge=arguments[0],Ne=arguments[1],Ye=arguments[2],Mt=ge;Mt<Ne;Mt++){var At=this._edgeList.get(Mt);At.setEdgeDepths(Le.RIGHT,Ye),Ye=At.getDepth(Le.LEFT)}return Ye}},f.prototype.mergeSymLabels=function(){for(var _=this.iterator();_.hasNext();){var A=_.next();A.getLabel().merge(A.getSym().getLabel())}},f.prototype.linkMinimalDirectedEdges=function(_){for(var A=null,D=null,H=this._SCANNING_FOR_INCOMING,re=this._resultAreaEdgeList.size()-1;re>=0;re--){var ge=this._resultAreaEdgeList.get(re),Ne=ge.getSym();switch(A===null&&ge.getEdgeRing()===_&&(A=ge),H){case this._SCANNING_FOR_INCOMING:if(Ne.getEdgeRing()!==_)continue;D=Ne,H=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ge.getEdgeRing()!==_)continue;D.setNextMin(ge),H=this._SCANNING_FOR_INCOMING}}H===this._LINKING_TO_OUTGOING&&(Me.isTrue(A!==null,"found null for first outgoing dirEdge"),Me.isTrue(A.getEdgeRing()===_,"unable to link last incoming dirEdge"),D.setNextMin(A))},f.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var _=0,A=this.iterator();A.hasNext();)A.next().isInResult()&&_++;return _}if(arguments.length===1){for(var D=arguments[0],H=0,re=this.iterator();re.hasNext();)re.next().getEdgeRing()===D&&H++;return H}},f.prototype.getLabel=function(){return this._label},f.prototype.findCoveredLineEdges=function(){for(var _=V.NONE,A=this.iterator();A.hasNext();){var D=A.next(),H=D.getSym();if(!D.isLineEdge()){if(D.isInResult()){_=V.INTERIOR;break}if(H.isInResult()){_=V.EXTERIOR;break}}}if(_===V.NONE)return null;for(var re=_,ge=this.iterator();ge.hasNext();){var Ne=ge.next(),Ye=Ne.getSym();Ne.isLineEdge()?Ne.getEdge().setCovered(re===V.INTERIOR):(Ne.isInResult()&&(re=V.EXTERIOR),Ye.isInResult()&&(re=V.INTERIOR))}},f.prototype.computeLabelling=function(_){h.prototype.computeLabelling.call(this,_),this._label=new lr(V.NONE);for(var A=this.iterator();A.hasNext();)for(var D=A.next().getEdge().getLabel(),H=0;H<2;H++){var re=D.getLocation(H);re!==V.INTERIOR&&re!==V.BOUNDARY||this._label.setLocation(H,V.INTERIOR)}},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Do),MS=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.createNode=function(_){return new zl(_,new K5)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(pl),Pc=s(function h(){this._pts=null,this._orientation=null;var f=arguments[0];this._pts=f,this._orientation=h.orientation(f)},"t");Pc.prototype.compareTo=function(h){var f=h;return Pc.compareOriented(this._pts,this._orientation,f._pts,f._orientation)},Pc.prototype.interfaces_=function(){return[k]},Pc.prototype.getClass=function(){return Pc},Pc.orientation=function(h){return Re.increasingDirection(h)===1},Pc.compareOriented=function(h,f,_,A){for(var D=f?1:-1,H=A?1:-1,re=f?h.length:-1,ge=A?_.length:-1,Ne=f?0:h.length-1,Ye=A?0:_.length-1;;){var Mt=h[Ne].compareTo(_[Ye]);if(Mt!==0)return Mt;var At=(Ne+=D)===re,hr=(Ye+=H)===ge;if(At&&!hr)return-1;if(!At&&hr)return 1;if(At&&hr)return 0}};var fl=s(function(){this._edges=new ue,this._ocaMap=new v},"Hn");fl.prototype.print=function(h){h.print("MULTILINESTRING ( ");for(var f=0;f<this._edges.size();f++){var _=this._edges.get(f);f>0&&h.print(","),h.print("(");for(var A=_.getCoordinates(),D=0;D<A.length;D++)D>0&&h.print(","),h.print(A[D].x+" "+A[D].y);h.println(")")}h.print(")  ")},fl.prototype.addAll=function(h){for(var f=h.iterator();f.hasNext();)this.add(f.next())},fl.prototype.findEdgeIndex=function(h){for(var f=0;f<this._edges.size();f++)if(this._edges.get(f).equals(h))return f;return-1},fl.prototype.iterator=function(){return this._edges.iterator()},fl.prototype.getEdges=function(){return this._edges},fl.prototype.get=function(h){return this._edges.get(h)},fl.prototype.findEqualEdge=function(h){var f=new Pc(h.getCoordinates());return this._ocaMap.get(f)},fl.prototype.add=function(h){this._edges.add(h);var f=new Pc(h.getCoordinates());this._ocaMap.put(f,h)},fl.prototype.interfaces_=function(){return[]},fl.prototype.getClass=function(){return fl};var uu=s(function(){},"Wn");uu.prototype.processIntersections=function(h,f,_,A){},uu.prototype.isDone=function(){},uu.prototype.interfaces_=function(){return[]},uu.prototype.getClass=function(){return uu};var Ro=s(function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var h=arguments[0];this._li=h},"Kn");Ro.prototype.isTrivialIntersection=function(h,f,_,A){if(h===_&&this._li.getIntersectionNum()===1){if(Ro.isAdjacentSegments(f,A))return!0;if(h.isClosed()){var D=h.size()-1;if(f===0&&A===D||A===0&&f===D)return!0}}return!1},Ro.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Ro.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Ro.prototype.getLineIntersector=function(){return this._li},Ro.prototype.hasProperIntersection=function(){return this._hasProper},Ro.prototype.processIntersections=function(h,f,_,A){if(h===_&&f===A)return null;this.numTests++;var D=h.getCoordinates()[f],H=h.getCoordinates()[f+1],re=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];this._li.computeIntersection(D,H,re,ge),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(h,f,_,A)||(this._hasIntersection=!0,h.addIntersections(this._li,f,0),_.addIntersections(this._li,A,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Ro.prototype.hasIntersection=function(){return this._hasIntersection},Ro.prototype.isDone=function(){return!1},Ro.prototype.hasInteriorIntersection=function(){return this._hasInterior},Ro.prototype.interfaces_=function(){return[uu]},Ro.prototype.getClass=function(){return Ro},Ro.isAdjacentSegments=function(h,f){return Math.abs(h-f)===1};var cu=s(function(){this.coord=null,this.segmentIndex=null,this.dist=null;var h=arguments[0],f=arguments[1],_=arguments[2];this.coord=new z(h),this.segmentIndex=f,this.dist=_},"Jn");cu.prototype.getSegmentIndex=function(){return this.segmentIndex},cu.prototype.getCoordinate=function(){return this.coord},cu.prototype.print=function(h){h.print(this.coord),h.print(" seg # = "+this.segmentIndex),h.println(" dist = "+this.dist)},cu.prototype.compareTo=function(h){var f=h;return this.compare(f.segmentIndex,f.dist)},cu.prototype.isEndPoint=function(h){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===h},cu.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},cu.prototype.getDistance=function(){return this.dist},cu.prototype.compare=function(h,f){return this.segmentIndex<h?-1:this.segmentIndex>h?1:this.dist<f?-1:this.dist>f?1:0},cu.prototype.interfaces_=function(){return[k]},cu.prototype.getClass=function(){return cu};var ml=s(function(){this._nodeMap=new v,this.edge=null;var h=arguments[0];this.edge=h},"Qn");ml.prototype.print=function(h){h.println("Intersections:");for(var f=this.iterator();f.hasNext();)f.next().print(h)},ml.prototype.iterator=function(){return this._nodeMap.values().iterator()},ml.prototype.addSplitEdges=function(h){this.addEndpoints();for(var f=this.iterator(),_=f.next();f.hasNext();){var A=f.next(),D=this.createSplitEdge(_,A);h.add(D),_=A}},ml.prototype.addEndpoints=function(){var h=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[h],h,0)},ml.prototype.createSplitEdge=function(h,f){var _=f.segmentIndex-h.segmentIndex+2,A=this.edge.pts[f.segmentIndex],D=f.dist>0||!f.coord.equals2D(A);D||_--;var H=new Array(_).fill(null),re=0;H[re++]=new z(h.coord);for(var ge=h.segmentIndex+1;ge<=f.segmentIndex;ge++)H[re++]=this.edge.pts[ge];return D&&(H[re]=f.coord),new Sg(H,new lr(this.edge._label))},ml.prototype.add=function(h,f,_){var A=new cu(h,f,_),D=this._nodeMap.get(A);return D!==null?D:(this._nodeMap.put(A,A),A)},ml.prototype.isIntersection=function(h){for(var f=this.iterator();f.hasNext();)if(f.next().coord.equals(h))return!0;return!1},ml.prototype.interfaces_=function(){return[]},ml.prototype.getClass=function(){return ml};var lh=s(function(){},"Zn");lh.prototype.getChainStartIndices=function(h){var f=0,_=new ue;_.add(new ee(f));do{var A=this.findChainEnd(h,f);_.add(new ee(A)),f=A}while(f<h.length-1);return lh.toIntArray(_)},lh.prototype.findChainEnd=function(h,f){for(var _=ui.quadrant(h[f],h[f+1]),A=f+1;A<h.length&&ui.quadrant(h[A-1],h[A])===_;)A++;return A-1},lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh},lh.toIntArray=function(h){for(var f=new Array(h.size()).fill(null),_=0;_<f.length;_++)f[_]=h.get(_).intValue();return f};var Xu=s(function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Ae,this.env2=new Ae;var h=arguments[0];this.e=h,this.pts=h.getCoordinates();var f=new lh;this.startIndex=f.getChainStartIndices(this.pts)},"$n");Xu.prototype.getCoordinates=function(){return this.pts},Xu.prototype.getMaxX=function(h){var f=this.pts[this.startIndex[h]].x,_=this.pts[this.startIndex[h+1]].x;return f>_?f:_},Xu.prototype.getMinX=function(h){var f=this.pts[this.startIndex[h]].x,_=this.pts[this.startIndex[h+1]].x;return f<_?f:_},Xu.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];this.computeIntersectsForChain(this.startIndex[h],this.startIndex[h+1],f,f.startIndex[_],f.startIndex[_+1],A)}else if(arguments.length===6){var D=arguments[0],H=arguments[1],re=arguments[2],ge=arguments[3],Ne=arguments[4],Ye=arguments[5],Mt=this.pts[D],At=this.pts[H],hr=re.pts[ge],gr=re.pts[Ne];if(H-D==1&&Ne-ge==1)return Ye.addIntersections(this.e,D,re.e,ge),null;if(this.env1.init(Mt,At),this.env2.init(hr,gr),!this.env1.intersects(this.env2))return null;var Sr=Math.trunc((D+H)/2),Qr=Math.trunc((ge+Ne)/2);D<Sr&&(ge<Qr&&this.computeIntersectsForChain(D,Sr,re,ge,Qr,Ye),Qr<Ne&&this.computeIntersectsForChain(D,Sr,re,Qr,Ne,Ye)),Sr<H&&(ge<Qr&&this.computeIntersectsForChain(Sr,H,re,ge,Qr,Ye),Qr<Ne&&this.computeIntersectsForChain(Sr,H,re,Qr,Ne,Ye))}},Xu.prototype.getStartIndexes=function(){return this.startIndex},Xu.prototype.computeIntersects=function(h,f){for(var _=0;_<this.startIndex.length-1;_++)for(var A=0;A<h.startIndex.length-1;A++)this.computeIntersectsForChain(_,h,A,f)},Xu.prototype.interfaces_=function(){return[]},Xu.prototype.getClass=function(){return Xu};var Xa=s(function h(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var f=0;f<2;f++)for(var _=0;_<3;_++)this._depth[f][_]=h.NULL_VALUE},"t"),Dv={NULL_VALUE:{configurable:!0}};Xa.prototype.getDepth=function(h,f){return this._depth[h][f]},Xa.prototype.setDepth=function(h,f,_){this._depth[h][f]=_},Xa.prototype.isNull=function(){if(arguments.length===0){for(var h=0;h<2;h++)for(var f=0;f<3;f++)if(this._depth[h][f]!==Xa.NULL_VALUE)return!1;return!0}if(arguments.length===1){var _=arguments[0];return this._depth[_][1]===Xa.NULL_VALUE}if(arguments.length===2){var A=arguments[0],D=arguments[1];return this._depth[A][D]===Xa.NULL_VALUE}},Xa.prototype.normalize=function(){for(var h=0;h<2;h++)if(!this.isNull(h)){var f=this._depth[h][1];this._depth[h][2]<f&&(f=this._depth[h][2]),f<0&&(f=0);for(var _=1;_<3;_++){var A=0;this._depth[h][_]>f&&(A=1),this._depth[h][_]=A}}},Xa.prototype.getDelta=function(h){return this._depth[h][Le.RIGHT]-this._depth[h][Le.LEFT]},Xa.prototype.getLocation=function(h,f){return this._depth[h][f]<=0?V.EXTERIOR:V.INTERIOR},Xa.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Xa.prototype.add=function(){if(arguments.length===1)for(var h=arguments[0],f=0;f<2;f++)for(var _=1;_<3;_++){var A=h.getLocation(f,_);A!==V.EXTERIOR&&A!==V.INTERIOR||(this.isNull(f,_)?this._depth[f][_]=Xa.depthAtLocation(A):this._depth[f][_]+=Xa.depthAtLocation(A))}else if(arguments.length===3){var D=arguments[0],H=arguments[1];arguments[2]===V.INTERIOR&&this._depth[D][H]++}},Xa.prototype.interfaces_=function(){return[]},Xa.prototype.getClass=function(){return Xa},Xa.depthAtLocation=function(h){return h===V.EXTERIOR?0:h===V.INTERIOR?1:Xa.NULL_VALUE},Dv.NULL_VALUE.get=function(){return-1},Object.defineProperties(Xa,Dv);var Sg=function(h){function f(){if(h.call(this),this.pts=null,this._env=null,this.eiList=new ml(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Xa,this._depthDelta=0,arguments.length===1){var _=arguments[0];f.call(this,_,null)}else if(arguments.length===2){var A=arguments[0],D=arguments[1];this.pts=A,this._label=D}}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.getDepth=function(){return this._depth},f.prototype.getCollapsedEdge=function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new f(_,lr.toLineLabel(this._label))},f.prototype.isIsolated=function(){return this._isIsolated},f.prototype.getCoordinates=function(){return this.pts},f.prototype.setIsolated=function(_){this._isIsolated=_},f.prototype.setName=function(_){this._name=_},f.prototype.equals=function(_){if(!(_ instanceof f))return!1;var A=_;if(this.pts.length!==A.pts.length)return!1;for(var D=!0,H=!0,re=this.pts.length,ge=0;ge<this.pts.length;ge++)if(this.pts[ge].equals2D(A.pts[ge])||(D=!1),this.pts[ge].equals2D(A.pts[--re])||(H=!1),!D&&!H)return!1;return!0},f.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}},f.prototype.print=function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var A=0;A<this.pts.length;A++)A>0&&_.print(","),_.print(this.pts[A].x+" "+this.pts[A].y);_.print(")  "+this._label+" "+this._depthDelta)},f.prototype.computeIM=function(_){f.updateIM(this._label,_)},f.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},f.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},f.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},f.prototype.getDepthDelta=function(){return this._depthDelta},f.prototype.getNumPoints=function(){return this.pts.length},f.prototype.printReverse=function(_){_.print("edge "+this._name+": ");for(var A=this.pts.length-1;A>=0;A--)_.print(this.pts[A]+" ");_.println("")},f.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Xu(this)),this._mce},f.prototype.getEnvelope=function(){if(this._env===null){this._env=new Ae;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env},f.prototype.addIntersection=function(_,A,D,H){var re=new z(_.getIntersection(H)),ge=A,Ne=_.getEdgeDistance(D,H),Ye=ge+1;if(Ye<this.pts.length){var Mt=this.pts[Ye];re.equals2D(Mt)&&(ge=Ye,Ne=0)}this.eiList.add(re,ge,Ne)},f.prototype.toString=function(){var _=new ae;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var A=0;A<this.pts.length;A++)A>0&&_.append(","),_.append(this.pts[A].x+" "+this.pts[A].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()},f.prototype.isPointwiseEqual=function(_){if(this.pts.length!==_.pts.length)return!1;for(var A=0;A<this.pts.length;A++)if(!this.pts[A].equals2D(_.pts[A]))return!1;return!0},f.prototype.setDepthDelta=function(_){this._depthDelta=_},f.prototype.getEdgeIntersectionList=function(){return this.eiList},f.prototype.addIntersections=function(_,A,D){for(var H=0;H<_.getIntersectionNum();H++)this.addIntersection(_,A,D,H)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.updateIM=function(){if(arguments.length!==2)return h.prototype.updateIM.apply(this,arguments);var _=arguments[0],A=arguments[1];A.setAtLeastIfValid(_.getLocation(0,Le.ON),_.getLocation(1,Le.ON),1),_.isArea()&&(A.setAtLeastIfValid(_.getLocation(0,Le.LEFT),_.getLocation(1,Le.LEFT),2),A.setAtLeastIfValid(_.getLocation(0,Le.RIGHT),_.getLocation(1,Le.RIGHT),2))},f}(ln),Oo=s(function(h){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new fl,this._bufParams=h||null},"ii");Oo.prototype.setWorkingPrecisionModel=function(h){this._workingPrecisionModel=h},Oo.prototype.insertUniqueEdge=function(h){var f=this._edgeList.findEqualEdge(h);if(f!==null){var _=f.getLabel(),A=h.getLabel();f.isPointwiseEqual(h)||(A=new lr(h.getLabel())).flip(),_.merge(A);var D=Oo.depthDelta(A),H=f.getDepthDelta()+D;f.setDepthDelta(H)}else this._edgeList.add(h),h.setDepthDelta(Oo.depthDelta(h.getLabel()))},Oo.prototype.buildSubgraphs=function(h,f){for(var _=new ue,A=h.iterator();A.hasNext();){var D=A.next(),H=D.getRightmostCoordinate(),re=new Wu(_).getDepth(H);D.computeDepth(re),D.findResultEdges(),_.add(D),f.add(D.getDirectedEdges(),D.getNodes())}},Oo.prototype.createSubgraphs=function(h){for(var f=new ue,_=h.getNodes().iterator();_.hasNext();){var A=_.next();if(!A.isVisited()){var D=new mr;D.create(A),f.add(D)}}return Ge.sort(f,Ge.reverseOrder()),f},Oo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Oo.prototype.getNoder=function(h){if(this._workingNoder!==null)return this._workingNoder;var f=new jx,_=new It;return _.setPrecisionModel(h),f.setSegmentIntersector(new Ro(_)),f},Oo.prototype.buffer=function(h,f){var _=this._workingPrecisionModel;_===null&&(_=h.getPrecisionModel()),this._geomFact=h.getFactory();var A=new Lo(_,this._bufParams),D=new Zs(h,f,A).getCurves();if(D.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(D,_),this._graph=new un(new MS),this._graph.addEdges(this._edgeList.getEdges());var H=this.createSubgraphs(this._graph),re=new Ta(this._geomFact);this.buildSubgraphs(H,re);var ge=re.getPolygons();return ge.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(ge)},Oo.prototype.computeNodedEdges=function(h,f){var _=this.getNoder(f);_.computeNodes(h);for(var A=_.getNodedSubstrings().iterator();A.hasNext();){var D=A.next(),H=D.getCoordinates();if(H.length!==2||!H[0].equals2D(H[1])){var re=D.getData(),ge=new Sg(D.getCoordinates(),new lr(re));this.insertUniqueEdge(ge)}}},Oo.prototype.setNoder=function(h){this._workingNoder=h},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo},Oo.depthDelta=function(h){var f=h.getLocation(0,Le.LEFT),_=h.getLocation(0,Le.RIGHT);return f===V.INTERIOR&&_===V.EXTERIOR?1:f===V.EXTERIOR&&_===V.INTERIOR?-1:0},Oo.convertSegStrings=function(h){for(var f=new qr,_=new ue;h.hasNext();){var A=h.next(),D=f.createLineString(A.getCoordinates());_.add(D)}return f.buildGeometry(_)};var Lc=s(function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var h=arguments[0],f=arguments[1];this._noder=h,this._scaleFactor=f,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var _=arguments[0],A=arguments[1],D=arguments[2],H=arguments[3];this._noder=_,this._scaleFactor=A,this._offsetX=D,this._offsetY=H,this._isScaled=!this.isIntegerPrecision()}},"ri");Lc.prototype.rescale=function(){if(Y(arguments[0],er))for(var h=arguments[0].iterator();h.hasNext();){var f=h.next();this.rescale(f.getCoordinates())}else if(arguments[0]instanceof Array){for(var _=arguments[0],A=0;A<_.length;A++)_[A].x=_[A].x/this._scaleFactor+this._offsetX,_[A].y=_[A].y/this._scaleFactor+this._offsetY;_.length===2&&_[0].equals2D(_[1])&&Pe.out.println(_)}},Lc.prototype.scale=function(){if(Y(arguments[0],er)){for(var h=arguments[0],f=new ue,_=h.iterator();_.hasNext();){var A=_.next();f.add(new wa(this.scale(A.getCoordinates()),A.getData()))}return f}if(arguments[0]instanceof Array){for(var D=arguments[0],H=new Array(D.length).fill(null),re=0;re<D.length;re++)H[re]=new z(Math.round((D[re].x-this._offsetX)*this._scaleFactor),Math.round((D[re].y-this._offsetY)*this._scaleFactor),D[re].z);return Re.removeRepeatedPoints(H)}},Lc.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},Lc.prototype.getNodedSubstrings=function(){var h=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(h),h},Lc.prototype.computeNodes=function(h){var f=h;this._isScaled&&(f=this.scale(h)),this._noder.computeNodes(f)},Lc.prototype.interfaces_=function(){return[Ic]},Lc.prototype.getClass=function(){return Lc};var hu=s(function(){this._li=new It,this._segStrings=null;var h=arguments[0];this._segStrings=h},"oi"),ES={fact:{configurable:!0}};hu.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var h=this._segStrings.iterator();h.hasNext();){var f=h.next().getCoordinates();this.checkEndPtVertexIntersections(f[0],this._segStrings),this.checkEndPtVertexIntersections(f[f.length-1],this._segStrings)}else if(arguments.length===2){for(var _=arguments[0],A=arguments[1].iterator();A.hasNext();)for(var D=A.next().getCoordinates(),H=1;H<D.length-1;H++)if(D[H].equals(_))throw new Lt("found endpt/interior pt intersection at index "+H+" :pt "+_)}},hu.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var h=this._segStrings.iterator();h.hasNext();)for(var f=h.next(),_=this._segStrings.iterator();_.hasNext();){var A=_.next();this.checkInteriorIntersections(f,A)}else if(arguments.length===2)for(var D=arguments[0],H=arguments[1],re=D.getCoordinates(),ge=H.getCoordinates(),Ne=0;Ne<re.length-1;Ne++)for(var Ye=0;Ye<ge.length-1;Ye++)this.checkInteriorIntersections(D,Ne,H,Ye);else if(arguments.length===4){var Mt=arguments[0],At=arguments[1],hr=arguments[2],gr=arguments[3];if(Mt===hr&&At===gr)return null;var Sr=Mt.getCoordinates()[At],Qr=Mt.getCoordinates()[At+1],ji=hr.getCoordinates()[gr],$n=hr.getCoordinates()[gr+1];if(this._li.computeIntersection(Sr,Qr,ji,$n),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Sr,Qr)||this.hasInteriorIntersection(this._li,ji,$n)))throw new Lt("found non-noded intersection at "+Sr+"-"+Qr+" and "+ji+"-"+$n)}},hu.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},hu.prototype.checkCollapses=function(){if(arguments.length===0)for(var h=this._segStrings.iterator();h.hasNext();){var f=h.next();this.checkCollapses(f)}else if(arguments.length===1)for(var _=arguments[0].getCoordinates(),A=0;A<_.length-2;A++)this.checkCollapse(_[A],_[A+1],_[A+2])},hu.prototype.hasInteriorIntersection=function(h,f,_){for(var A=0;A<h.getIntersectionNum();A++){var D=h.getIntersection(A);if(!D.equals(f)&&!D.equals(_))return!0}return!1},hu.prototype.checkCollapse=function(h,f,_){if(h.equals(_))throw new Lt("found non-noded collapse at "+hu.fact.createLineString([h,f,_]))},hu.prototype.interfaces_=function(){return[]},hu.prototype.getClass=function(){return hu},ES.fact.get=function(){return new qr},Object.defineProperties(hu,ES);var vs=s(function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var h=arguments[0],f=arguments[1],_=arguments[2];if(this._originalPt=h,this._pt=h,this._scaleFactor=f,this._li=_,f<=0)throw new T("Scale factor must be non-zero");f!==1&&(this._pt=new z(this.scale(h.x),this.scale(h.y)),this._p0Scaled=new z,this._p1Scaled=new z),this.initCorners(this._pt)},"ai"),CS={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};vs.prototype.intersectsScaled=function(h,f){var _=Math.min(h.x,f.x),A=Math.max(h.x,f.x),D=Math.min(h.y,f.y),H=Math.max(h.y,f.y),re=this._maxx<_||this._minx>A||this._maxy<D||this._miny>H;if(re)return!1;var ge=this.intersectsToleranceSquare(h,f);return Me.isTrue(!(re&&ge),"Found bad envelope test"),ge},vs.prototype.initCorners=function(h){this._minx=h.x-.5,this._maxx=h.x+.5,this._miny=h.y-.5,this._maxy=h.y+.5,this._corner[0]=new z(this._maxx,this._maxy),this._corner[1]=new z(this._minx,this._maxy),this._corner[2]=new z(this._minx,this._miny),this._corner[3]=new z(this._maxx,this._miny)},vs.prototype.intersects=function(h,f){return this._scaleFactor===1?this.intersectsScaled(h,f):(this.copyScaled(h,this._p0Scaled),this.copyScaled(f,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},vs.prototype.scale=function(h){return Math.round(h*this._scaleFactor)},vs.prototype.getCoordinate=function(){return this._originalPt},vs.prototype.copyScaled=function(h,f){f.x=this.scale(h.x),f.y=this.scale(h.y)},vs.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var h=vs.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ae(this._originalPt.x-h,this._originalPt.x+h,this._originalPt.y-h,this._originalPt.y+h)}return this._safeEnv},vs.prototype.intersectsPixelClosure=function(h,f){return this._li.computeIntersection(h,f,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(h,f,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(h,f,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(h,f,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},vs.prototype.intersectsToleranceSquare=function(h,f){var _=!1,A=!1;return this._li.computeIntersection(h,f,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(h,f,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(h,f,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(A=!0),this._li.computeIntersection(h,f,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!_||!A)||!!h.equals(this._pt)||!!f.equals(this._pt))))},vs.prototype.addSnappedNode=function(h,f){var _=h.getCoordinate(f),A=h.getCoordinate(f+1);return!!this.intersects(_,A)&&(h.addIntersection(this.getCoordinate(),f),!0)},vs.prototype.interfaces_=function(){return[]},vs.prototype.getClass=function(){return vs},CS.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(vs,CS);var Mg=s(function(){this.tempEnv1=new Ae,this.selectedSegment=new Gr},"li");Mg.prototype.select=function(){if(arguments.length!==1&&arguments.length===2){var h=arguments[0],f=arguments[1];h.getLineSegment(f,this.selectedSegment),this.select(this.selectedSegment)}},Mg.prototype.interfaces_=function(){return[]},Mg.prototype.getClass=function(){return Mg};var es=s(function(){this._index=null;var h=arguments[0];this._index=h},"ci"),Df={HotPixelSnapAction:{configurable:!0}};es.prototype.snap=function(){if(arguments.length===1){var h=arguments[0];return this.snap(h,null,-1)}if(arguments.length===3){var f=arguments[0],_=arguments[1],A=arguments[2],D=f.getSafeEnvelope(),H=new $x(f,_,A);return this._index.query(D,{interfaces_:s(function(){return[Wn]},"interfaces_"),visitItem:s(function(re){re.select(D,H)},"visitItem")}),H.isNodeAdded()}},es.prototype.interfaces_=function(){return[]},es.prototype.getClass=function(){return es},Df.HotPixelSnapAction.get=function(){return $x},Object.defineProperties(es,Df);var $x=function(h){function f(){h.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],A=arguments[1],D=arguments[2];this._hotPixel=_,this._parentEdge=A,this._hotPixelVertexIndex=D}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.isNodeAdded=function(){return this._isNodeAdded},f.prototype.select=function(){if(arguments.length!==2)return h.prototype.select.apply(this,arguments);var _=arguments[0],A=arguments[1],D=_.getContext();if(this._parentEdge!==null&&D===this._parentEdge&&A===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(D,A)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Mg),np=s(function(){this._li=null,this._interiorIntersections=null;var h=arguments[0];this._li=h,this._interiorIntersections=new ue},"fi");np.prototype.processIntersections=function(h,f,_,A){if(h===_&&f===A)return null;var D=h.getCoordinates()[f],H=h.getCoordinates()[f+1],re=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];if(this._li.computeIntersection(D,H,re,ge),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Ne=0;Ne<this._li.getIntersectionNum();Ne++)this._interiorIntersections.add(this._li.getIntersection(Ne));h.addIntersections(this._li,f,0),_.addIntersections(this._li,A,1)}},np.prototype.isDone=function(){return!1},np.prototype.getInteriorIntersections=function(){return this._interiorIntersections},np.prototype.interfaces_=function(){return[uu]},np.prototype.getClass=function(){return np};var pu=s(function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var h=arguments[0];this._pm=h,this._li=new It,this._li.setPrecisionModel(h),this._scaleFactor=h.getScale()},"gi");pu.prototype.checkCorrectness=function(h){var f=wa.getNodedSubstrings(h),_=new hu(f);try{_.checkValid()}catch(A){if(!(A instanceof Te))throw A;A.printStackTrace()}},pu.prototype.getNodedSubstrings=function(){return wa.getNodedSubstrings(this._nodedSegStrings)},pu.prototype.snapRound=function(h,f){var _=this.findInteriorIntersections(h,f);this.computeIntersectionSnaps(_),this.computeVertexSnaps(h)},pu.prototype.findInteriorIntersections=function(h,f){var _=new np(f);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(h),_.getInteriorIntersections()},pu.prototype.computeVertexSnaps=function(){if(Y(arguments[0],er))for(var h=arguments[0].iterator();h.hasNext();){var f=h.next();this.computeVertexSnaps(f)}else if(arguments[0]instanceof wa)for(var _=arguments[0],A=_.getCoordinates(),D=0;D<A.length;D++){var H=new vs(A[D],this._scaleFactor,this._li);this._pointSnapper.snap(H,_,D)&&_.addIntersection(A[D],D)}},pu.prototype.computeNodes=function(h){this._nodedSegStrings=h,this._noder=new jx,this._pointSnapper=new es(this._noder.getIndex()),this.snapRound(h,this._li)},pu.prototype.computeIntersectionSnaps=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next(),A=new vs(_,this._scaleFactor,this._li);this._pointSnapper.snap(A)}},pu.prototype.interfaces_=function(){return[Ic]},pu.prototype.getClass=function(){return pu};var so=s(function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Xi,this._resultGeometry=null,this._saveException=null,arguments.length===1){var h=arguments[0];this._argGeom=h}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this._argGeom=f,this._bufParams=_}},"di"),ap={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};so.prototype.bufferFixedPrecision=function(h){var f=new Lc(new pu(new li(1)),h.getScale()),_=new Oo(this._bufParams);_.setWorkingPrecisionModel(h),_.setNoder(f),this._resultGeometry=_.buffer(this._argGeom,this._distance)},so.prototype.bufferReducedPrecision=function(){var h=this;if(arguments.length===0){for(var f=so.MAX_PRECISION_DIGITS;f>=0;f--){try{h.bufferReducedPrecision(f)}catch(H){if(!(H instanceof qt))throw H;h._saveException=H}if(h._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],A=so.precisionScaleFactor(this._argGeom,this._distance,_),D=new li(A);this.bufferFixedPrecision(D)}},so.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var h=this._argGeom.getFactory().getPrecisionModel();h.getType()===li.FIXED?this.bufferFixedPrecision(h):this.bufferReducedPrecision()},so.prototype.setQuadrantSegments=function(h){this._bufParams.setQuadrantSegments(h)},so.prototype.bufferOriginalPrecision=function(){try{var h=new Oo(this._bufParams);this._resultGeometry=h.buffer(this._argGeom,this._distance)}catch(f){if(!(f instanceof Lt))throw f;this._saveException=f}},so.prototype.getResultGeometry=function(h){return this._distance=h,this.computeGeometry(),this._resultGeometry},so.prototype.setEndCapStyle=function(h){this._bufParams.setEndCapStyle(h)},so.prototype.interfaces_=function(){return[]},so.prototype.getClass=function(){return so},so.bufferOp=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];return new so(h).getResultGeometry(f)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof $t&&typeof arguments[1]=="number"){var _=arguments[0],A=arguments[1],D=arguments[2],H=new so(_);return H.setQuadrantSegments(D),H.getResultGeometry(A)}if(arguments[2]instanceof Xi&&arguments[0]instanceof $t&&typeof arguments[1]=="number"){var re=arguments[0],ge=arguments[1],Ne=arguments[2];return new so(re,Ne).getResultGeometry(ge)}}else if(arguments.length===4){var Ye=arguments[0],Mt=arguments[1],At=arguments[2],hr=arguments[3],gr=new so(Ye);return gr.setQuadrantSegments(At),gr.setEndCapStyle(hr),gr.getResultGeometry(Mt)}},so.precisionScaleFactor=function(h,f,_){var A=h.getEnvelopeInternal(),D=he.max(Math.abs(A.getMaxX()),Math.abs(A.getMaxY()),Math.abs(A.getMinX()),Math.abs(A.getMinY()))+2*(f>0?f:0),H=_-Math.trunc(Math.log(D)/Math.log(10)+1);return Math.pow(10,H)},ap.CAP_ROUND.get=function(){return Xi.CAP_ROUND},ap.CAP_BUTT.get=function(){return Xi.CAP_FLAT},ap.CAP_FLAT.get=function(){return Xi.CAP_FLAT},ap.CAP_SQUARE.get=function(){return Xi.CAP_SQUARE},ap.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(so,ap);var ts=s(function(){this._pt=[new z,new z],this._distance=O.NaN,this._isNull=!0},"_i");ts.prototype.getCoordinates=function(){return this._pt},ts.prototype.getCoordinate=function(h){return this._pt[h]},ts.prototype.setMinimum=function(){if(arguments.length===1){var h=arguments[0];this.setMinimum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A<this._distance&&this.initialize(f,_,A)}},ts.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var h=arguments[0],f=arguments[1];this._pt[0].setCoordinate(h),this._pt[1].setCoordinate(f),this._distance=h.distance(f),this._isNull=!1}else if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2];this._pt[0].setCoordinate(_),this._pt[1].setCoordinate(A),this._distance=D,this._isNull=!1}},ts.prototype.getDistance=function(){return this._distance},ts.prototype.setMaximum=function(){if(arguments.length===1){var h=arguments[0];this.setMaximum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A>this._distance&&this.initialize(f,_,A)}},ts.prototype.interfaces_=function(){return[]},ts.prototype.getClass=function(){return ts};var Ps=s(function(){},"mi");Ps.prototype.interfaces_=function(){return[]},Ps.prototype.getClass=function(){return Ps},Ps.computeDistance=function(){if(arguments[2]instanceof ts&&arguments[0]instanceof Je&&arguments[1]instanceof z)for(var h=arguments[0],f=arguments[1],_=arguments[2],A=h.getCoordinates(),D=new Gr,H=0;H<A.length-1;H++){D.setCoordinates(A[H],A[H+1]);var re=D.closestPoint(f);_.setMinimum(re,f)}else if(arguments[2]instanceof ts&&arguments[0]instanceof zt&&arguments[1]instanceof z){var ge=arguments[0],Ne=arguments[1],Ye=arguments[2];Ps.computeDistance(ge.getExteriorRing(),Ne,Ye);for(var Mt=0;Mt<ge.getNumInteriorRing();Mt++)Ps.computeDistance(ge.getInteriorRingN(Mt),Ne,Ye)}else if(arguments[2]instanceof ts&&arguments[0]instanceof $t&&arguments[1]instanceof z){var At=arguments[0],hr=arguments[1],gr=arguments[2];if(At instanceof Je)Ps.computeDistance(At,hr,gr);else if(At instanceof zt)Ps.computeDistance(At,hr,gr);else if(At instanceof Cr)for(var Sr=At,Qr=0;Qr<Sr.getNumGeometries();Qr++){var ji=Sr.getGeometryN(Qr);Ps.computeDistance(ji,hr,gr)}else gr.setMinimum(At.getCoordinate(),hr)}else if(arguments[2]instanceof ts&&arguments[0]instanceof Gr&&arguments[1]instanceof z){var $n=arguments[0],rs=arguments[1],gu=arguments[2],fh=$n.closestPoint(rs);gu.setMinimum(fh,rs)}};var Dc=s(function(h){this._maxPtDist=new ts,this._inputGeom=h||null},"vi"),pd={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Dc.prototype.computeMaxMidpointDistance=function(h){var f=new Rc(this._inputGeom);h.apply(f),this._maxPtDist.setMaximum(f.getMaxPointDistance())},Dc.prototype.computeMaxVertexDistance=function(h){var f=new uh(this._inputGeom);h.apply(f),this._maxPtDist.setMaximum(f.getMaxPointDistance())},Dc.prototype.findDistance=function(h){return this.computeMaxVertexDistance(h),this.computeMaxMidpointDistance(h),this._maxPtDist.getDistance()},Dc.prototype.getDistancePoints=function(){return this._maxPtDist},Dc.prototype.interfaces_=function(){return[]},Dc.prototype.getClass=function(){return Dc},pd.MaxPointDistanceFilter.get=function(){return uh},pd.MaxMidpointDistanceFilter.get=function(){return Rc},Object.defineProperties(Dc,pd);var uh=s(function(h){this._maxPtDist=new ts,this._minPtDist=new ts,this._geom=h||null},"Ei");uh.prototype.filter=function(h){this._minPtDist.initialize(),Ps.computeDistance(this._geom,h,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},uh.prototype.getMaxPointDistance=function(){return this._maxPtDist},uh.prototype.interfaces_=function(){return[Fe]},uh.prototype.getClass=function(){return uh};var Rc=s(function(h){this._maxPtDist=new ts,this._minPtDist=new ts,this._geom=h||null},"xi");Rc.prototype.filter=function(h,f){if(f===0)return null;var _=h.getCoordinate(f-1),A=h.getCoordinate(f),D=new z((_.x+A.x)/2,(_.y+A.y)/2);this._minPtDist.initialize(),Ps.computeDistance(this._geom,D,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Rc.prototype.isDone=function(){return!1},Rc.prototype.isGeometryChanged=function(){return!1},Rc.prototype.getMaxPointDistance=function(){return this._maxPtDist},Rc.prototype.interfaces_=function(){return[Jr]},Rc.prototype.getClass=function(){return Rc};var Ls=s(function(h){this._comps=h||null},"Ni");Ls.prototype.filter=function(h){h instanceof zt&&this._comps.add(h)},Ls.prototype.interfaces_=function(){return[ai]},Ls.prototype.getClass=function(){return Ls},Ls.getPolygons=function(){if(arguments.length===1){var h=arguments[0];return Ls.getPolygons(h,new ue)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f instanceof zt?_.add(f):f instanceof Cr&&f.apply(new Ls(_)),_}};var Aa=s(function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var h=arguments[0];this._lines=h}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this._lines=f,this._isForcedToLineString=_}},"Ci");Aa.prototype.filter=function(h){if(this._isForcedToLineString&&h instanceof ur){var f=h.getFactory().createLineString(h.getCoordinateSequence());return this._lines.add(f),null}h instanceof Je&&this._lines.add(h)},Aa.prototype.setForceToLineString=function(h){this._isForcedToLineString=h},Aa.prototype.interfaces_=function(){return[Kt]},Aa.prototype.getClass=function(){return Aa},Aa.getGeometry=function(){if(arguments.length===1){var h=arguments[0];return h.getFactory().buildGeometry(Aa.getLines(h))}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f.getFactory().buildGeometry(Aa.getLines(f,_))}},Aa.getLines=function(){if(arguments.length===1){var h=arguments[0];return Aa.getLines(h,!1)}if(arguments.length===2){if(Y(arguments[0],er)&&Y(arguments[1],er)){for(var f=arguments[0],_=arguments[1],A=f.iterator();A.hasNext();){var D=A.next();Aa.getLines(D,_)}return _}if(arguments[0]instanceof $t&&typeof arguments[1]=="boolean"){var H=arguments[0],re=arguments[1],ge=new ue;return H.apply(new Aa(ge,re)),ge}if(arguments[0]instanceof $t&&Y(arguments[1],er)){var Ne=arguments[0],Ye=arguments[1];return Ne instanceof Je?Ye.add(Ne):Ne.apply(new Aa(Ye)),Ye}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Y(arguments[0],er)&&Y(arguments[1],er)){for(var Mt=arguments[0],At=arguments[1],hr=arguments[2],gr=Mt.iterator();gr.hasNext();){var Sr=gr.next();Aa.getLines(Sr,At,hr)}return At}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof $t&&Y(arguments[1],er)){var Qr=arguments[0],ji=arguments[1],$n=arguments[2];return Qr.apply(new Aa(ji,$n)),ji}}};var Ys=s(function(){if(this._boundaryRule=Xe.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0&&arguments.length===1){var h=arguments[0];if(h===null)throw new T("Rule must be non-null");this._boundaryRule=h}},"Si");Ys.prototype.locateInternal=function(){if(arguments[0]instanceof z&&arguments[1]instanceof zt){var h=arguments[0],f=arguments[1];if(f.isEmpty())return V.EXTERIOR;var _=f.getExteriorRing(),A=this.locateInPolygonRing(h,_);if(A===V.EXTERIOR)return V.EXTERIOR;if(A===V.BOUNDARY)return V.BOUNDARY;for(var D=0;D<f.getNumInteriorRing();D++){var H=f.getInteriorRingN(D),re=this.locateInPolygonRing(h,H);if(re===V.INTERIOR)return V.EXTERIOR;if(re===V.BOUNDARY)return V.BOUNDARY}return V.INTERIOR}if(arguments[0]instanceof z&&arguments[1]instanceof Je){var ge=arguments[0],Ne=arguments[1];if(!Ne.getEnvelopeInternal().intersects(ge))return V.EXTERIOR;var Ye=Ne.getCoordinates();return Ne.isClosed()||!ge.equals(Ye[0])&&!ge.equals(Ye[Ye.length-1])?pt.isOnLine(ge,Ye)?V.INTERIOR:V.EXTERIOR:V.BOUNDARY}if(arguments[0]instanceof z&&arguments[1]instanceof ft){var Mt=arguments[0];return arguments[1].getCoordinate().equals2D(Mt)?V.INTERIOR:V.EXTERIOR}},Ys.prototype.locateInPolygonRing=function(h,f){return f.getEnvelopeInternal().intersects(h)?pt.locatePointInRing(h,f.getCoordinates()):V.EXTERIOR},Ys.prototype.intersects=function(h,f){return this.locate(h,f)!==V.EXTERIOR},Ys.prototype.updateLocationInfo=function(h){h===V.INTERIOR&&(this._isIn=!0),h===V.BOUNDARY&&this._numBoundaries++},Ys.prototype.computeLocation=function(h,f){if(f instanceof ft&&this.updateLocationInfo(this.locateInternal(h,f)),f instanceof Je)this.updateLocationInfo(this.locateInternal(h,f));else if(f instanceof zt)this.updateLocationInfo(this.locateInternal(h,f));else if(f instanceof Ei)for(var _=f,A=0;A<_.getNumGeometries();A++){var D=_.getGeometryN(A);this.updateLocationInfo(this.locateInternal(h,D))}else if(f instanceof Ar)for(var H=f,re=0;re<H.getNumGeometries();re++){var ge=H.getGeometryN(re);this.updateLocationInfo(this.locateInternal(h,ge))}else if(f instanceof Cr)for(var Ne=new lu(f);Ne.hasNext();){var Ye=Ne.next();Ye!==f&&this.computeLocation(h,Ye)}},Ys.prototype.locate=function(h,f){return f.isEmpty()?V.EXTERIOR:f instanceof Je?this.locateInternal(h,f):f instanceof zt?this.locateInternal(h,f):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(h,f),this._boundaryRule.isInBoundary(this._numBoundaries)?V.BOUNDARY:this._numBoundaries>0||this._isIn?V.INTERIOR:V.EXTERIOR)},Ys.prototype.interfaces_=function(){return[]},Ys.prototype.getClass=function(){return Ys};var ko=s(function h(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var f=arguments[0],_=arguments[1];h.call(this,f,h.INSIDE_AREA,_)}else if(arguments.length===3){var A=arguments[0],D=arguments[1],H=arguments[2];this._component=A,this._segIndex=D,this._pt=H}},"t"),op={INSIDE_AREA:{configurable:!0}};ko.prototype.isInsideArea=function(){return this._segIndex===ko.INSIDE_AREA},ko.prototype.getCoordinate=function(){return this._pt},ko.prototype.getGeometryComponent=function(){return this._component},ko.prototype.getSegmentIndex=function(){return this._segIndex},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko},op.INSIDE_AREA.get=function(){return-1},Object.defineProperties(ko,op);var Oc=s(function(h){this._pts=h||null},"wi");Oc.prototype.filter=function(h){h instanceof ft&&this._pts.add(h)},Oc.prototype.interfaces_=function(){return[ai]},Oc.prototype.getClass=function(){return Oc},Oc.getPoints=function(){if(arguments.length===1){var h=arguments[0];return h instanceof ft?Ge.singletonList(h):Oc.getPoints(h,new ue)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f instanceof ft?_.add(f):f instanceof Cr&&f.apply(new Oc(_)),_}};var sp=s(function(){this._locations=null;var h=arguments[0];this._locations=h},"Oi");sp.prototype.filter=function(h){(h instanceof ft||h instanceof Je||h instanceof zt)&&this._locations.add(new ko(h,0,h.getCoordinate()))},sp.prototype.interfaces_=function(){return[ai]},sp.prototype.getClass=function(){return sp},sp.getLocations=function(h){var f=new ue;return h.apply(new sp(f)),f};var lo=s(function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Ys,this._minDistanceLocation=null,this._minDistance=O.MAX_VALUE,arguments.length===2){var h=arguments[0],f=arguments[1];this._geom=[h,f],this._terminateDistance=0}else if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=_,this._geom[1]=A,this._terminateDistance=D}},"Ti");lo.prototype.computeContainmentDistance=function(){if(arguments.length===0){var h=new Array(2).fill(null);if(this.computeContainmentDistance(0,h),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1],A=1-f,D=Ls.getPolygons(this._geom[f]);if(D.size()>0){var H=sp.getLocations(this._geom[A]);if(this.computeContainmentDistance(H,D,_),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[A]=_[0],this._minDistanceLocation[f]=_[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Y(arguments[0],se)&&Y(arguments[1],se)){for(var re=arguments[0],ge=arguments[1],Ne=arguments[2],Ye=0;Ye<re.size();Ye++)for(var Mt=re.get(Ye),At=0;At<ge.size();At++)if(this.computeContainmentDistance(Mt,ge.get(At),Ne),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ko&&arguments[1]instanceof zt){var hr=arguments[0],gr=arguments[1],Sr=arguments[2],Qr=hr.getCoordinate();if(V.EXTERIOR!==this._ptLocator.locate(Qr,gr))return this._minDistance=0,Sr[0]=hr,Sr[1]=new ko(gr,Qr),null}}},lo.prototype.computeMinDistanceLinesPoints=function(h,f,_){for(var A=0;A<h.size();A++)for(var D=h.get(A),H=0;H<f.size();H++){var re=f.get(H);if(this.computeMinDistance(D,re,_),this._minDistance<=this._terminateDistance)return null}},lo.prototype.computeFacetDistance=function(){var h=new Array(2).fill(null),f=Aa.getLines(this._geom[0]),_=Aa.getLines(this._geom[1]),A=Oc.getPoints(this._geom[0]),D=Oc.getPoints(this._geom[1]);return this.computeMinDistanceLines(f,_,h),this.updateMinDistance(h,!1),this._minDistance<=this._terminateDistance?null:(h[0]=null,h[1]=null,this.computeMinDistanceLinesPoints(f,D,h),this.updateMinDistance(h,!1),this._minDistance<=this._terminateDistance?null:(h[0]=null,h[1]=null,this.computeMinDistanceLinesPoints(_,A,h),this.updateMinDistance(h,!0),this._minDistance<=this._terminateDistance?null:(h[0]=null,h[1]=null,this.computeMinDistancePoints(A,D,h),void this.updateMinDistance(h,!1))))},lo.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},lo.prototype.updateMinDistance=function(h,f){if(h[0]===null)return null;f?(this._minDistanceLocation[0]=h[1],this._minDistanceLocation[1]=h[0]):(this._minDistanceLocation[0]=h[0],this._minDistanceLocation[1]=h[1])},lo.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},lo.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Je&&arguments[1]instanceof ft){var h=arguments[0],f=arguments[1],_=arguments[2];if(h.getEnvelopeInternal().distance(f.getEnvelopeInternal())>this._minDistance)return null;for(var A=h.getCoordinates(),D=f.getCoordinate(),H=0;H<A.length-1;H++){var re=pt.distancePointLine(D,A[H],A[H+1]);if(re<this._minDistance){this._minDistance=re;var ge=new Gr(A[H],A[H+1]).closestPoint(D);_[0]=new ko(h,H,ge),_[1]=new ko(f,0,D)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Je&&arguments[1]instanceof Je){var Ne=arguments[0],Ye=arguments[1],Mt=arguments[2];if(Ne.getEnvelopeInternal().distance(Ye.getEnvelopeInternal())>this._minDistance)return null;for(var At=Ne.getCoordinates(),hr=Ye.getCoordinates(),gr=0;gr<At.length-1;gr++)for(var Sr=0;Sr<hr.length-1;Sr++){var Qr=pt.distanceLineLine(At[gr],At[gr+1],hr[Sr],hr[Sr+1]);if(Qr<this._minDistance){this._minDistance=Qr;var ji=new Gr(At[gr],At[gr+1]),$n=new Gr(hr[Sr],hr[Sr+1]),rs=ji.closestPoints($n);Mt[0]=new ko(Ne,gr,rs[0]),Mt[1]=new ko(Ye,Sr,rs[1])}if(this._minDistance<=this._terminateDistance)return null}}}},lo.prototype.computeMinDistancePoints=function(h,f,_){for(var A=0;A<h.size();A++)for(var D=h.get(A),H=0;H<f.size();H++){var re=f.get(H),ge=D.getCoordinate().distance(re.getCoordinate());if(ge<this._minDistance&&(this._minDistance=ge,_[0]=new ko(D,0,D.getCoordinate()),_[1]=new ko(re,0,re.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},lo.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new T("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},lo.prototype.computeMinDistanceLines=function(h,f,_){for(var A=0;A<h.size();A++)for(var D=h.get(A),H=0;H<f.size();H++){var re=f.get(H);if(this.computeMinDistance(D,re,_),this._minDistance<=this._terminateDistance)return null}},lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo.distance=function(h,f){return new lo(h,f).distance()},lo.isWithinDistance=function(h,f,_){return new lo(h,f,_).distance()<=_},lo.nearestPoints=function(h,f){return new lo(h,f).nearestPoints()};var No=s(function(){this._pt=[new z,new z],this._distance=O.NaN,this._isNull=!0},"Ri");No.prototype.getCoordinates=function(){return this._pt},No.prototype.getCoordinate=function(h){return this._pt[h]},No.prototype.setMinimum=function(){if(arguments.length===1){var h=arguments[0];this.setMinimum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A<this._distance&&this.initialize(f,_,A)}},No.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var h=arguments[0],f=arguments[1];this._pt[0].setCoordinate(h),this._pt[1].setCoordinate(f),this._distance=h.distance(f),this._isNull=!1}else if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2];this._pt[0].setCoordinate(_),this._pt[1].setCoordinate(A),this._distance=D,this._isNull=!1}},No.prototype.toString=function(){return at.toLineString(this._pt[0],this._pt[1])},No.prototype.getDistance=function(){return this._distance},No.prototype.setMaximum=function(){if(arguments.length===1){var h=arguments[0];this.setMaximum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A>this._distance&&this.initialize(f,_,A)}},No.prototype.interfaces_=function(){return[]},No.prototype.getClass=function(){return No};var du=s(function(){},"Pi");du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du},du.computeDistance=function(){if(arguments[2]instanceof No&&arguments[0]instanceof Je&&arguments[1]instanceof z)for(var h=arguments[0],f=arguments[1],_=arguments[2],A=new Gr,D=h.getCoordinates(),H=0;H<D.length-1;H++){A.setCoordinates(D[H],D[H+1]);var re=A.closestPoint(f);_.setMinimum(re,f)}else if(arguments[2]instanceof No&&arguments[0]instanceof zt&&arguments[1]instanceof z){var ge=arguments[0],Ne=arguments[1],Ye=arguments[2];du.computeDistance(ge.getExteriorRing(),Ne,Ye);for(var Mt=0;Mt<ge.getNumInteriorRing();Mt++)du.computeDistance(ge.getInteriorRingN(Mt),Ne,Ye)}else if(arguments[2]instanceof No&&arguments[0]instanceof $t&&arguments[1]instanceof z){var At=arguments[0],hr=arguments[1],gr=arguments[2];if(At instanceof Je)du.computeDistance(At,hr,gr);else if(At instanceof zt)du.computeDistance(At,hr,gr);else if(At instanceof Cr)for(var Sr=At,Qr=0;Qr<Sr.getNumGeometries();Qr++){var ji=Sr.getGeometryN(Qr);du.computeDistance(ji,hr,gr)}else gr.setMinimum(At.getCoordinate(),hr)}else if(arguments[2]instanceof No&&arguments[0]instanceof Gr&&arguments[1]instanceof z){var $n=arguments[0],rs=arguments[1],gu=arguments[2],fh=$n.closestPoint(rs);gu.setMinimum(fh,rs)}};var gl=s(function(){this._g0=null,this._g1=null,this._ptDist=new No,this._densifyFrac=0;var h=arguments[0],f=arguments[1];this._g0=h,this._g1=f},"Di"),Rv={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};gl.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},gl.prototype.setDensifyFraction=function(h){if(h>1||h<=0)throw new T("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=h},gl.prototype.compute=function(h,f){this.computeOrientedDistance(h,f,this._ptDist),this.computeOrientedDistance(f,h,this._ptDist)},gl.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},gl.prototype.computeOrientedDistance=function(h,f,_){var A=new lp(f);if(h.apply(A),_.setMaximum(A.getMaxPointDistance()),this._densifyFrac>0){var D=new Zu(f,this._densifyFrac);h.apply(D),_.setMaximum(D.getMaxPointDistance())}},gl.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},gl.prototype.interfaces_=function(){return[]},gl.prototype.getClass=function(){return gl},gl.distance=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];return new gl(h,f).distance()}if(arguments.length===3){var _=arguments[0],A=arguments[1],D=arguments[2],H=new gl(_,A);return H.setDensifyFraction(D),H.distance()}},Rv.MaxPointDistanceFilter.get=function(){return lp},Rv.MaxDensifiedByFractionDistanceFilter.get=function(){return Zu},Object.defineProperties(gl,Rv);var lp=s(function(){this._maxPtDist=new No,this._minPtDist=new No,this._euclideanDist=new du,this._geom=null;var h=arguments[0];this._geom=h},"Ai");lp.prototype.filter=function(h){this._minPtDist.initialize(),du.computeDistance(this._geom,h,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},lp.prototype.getMaxPointDistance=function(){return this._maxPtDist},lp.prototype.interfaces_=function(){return[Fe]},lp.prototype.getClass=function(){return lp};var Zu=s(function(){this._maxPtDist=new No,this._minPtDist=new No,this._geom=null,this._numSubSegs=0;var h=arguments[0],f=arguments[1];this._geom=h,this._numSubSegs=Math.trunc(Math.round(1/f))},"Fi");Zu.prototype.filter=function(h,f){if(f===0)return null;for(var _=h.getCoordinate(f-1),A=h.getCoordinate(f),D=(A.x-_.x)/this._numSubSegs,H=(A.y-_.y)/this._numSubSegs,re=0;re<this._numSubSegs;re++){var ge=_.x+re*D,Ne=_.y+re*H,Ye=new z(ge,Ne);this._minPtDist.initialize(),du.computeDistance(this._geom,Ye,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Zu.prototype.isDone=function(){return!1},Zu.prototype.isGeometryChanged=function(){return!1},Zu.prototype.getMaxPointDistance=function(){return this._maxPtDist},Zu.prototype.interfaces_=function(){return[Jr]},Zu.prototype.getClass=function(){return Zu};var ca=s(function(h,f,_){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=h||null,this._bufDistance=f||null,this._result=_||null},"Gi"),Ov={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ca.prototype.checkMaximumDistance=function(h,f,_){var A=new gl(f,h);if(A.setDensifyFraction(.25),this._maxDistanceFound=A.orientedDistance(),this._maxDistanceFound>_){this._isValid=!1;var D=A.getCoordinates();this._errorLocation=D[1],this._errorIndicator=h.getFactory().createLineString(D),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+at.toLineString(D[0],D[1])+")"}},ca.prototype.isValid=function(){var h=Math.abs(this._bufDistance),f=ca.MAX_DISTANCE_DIFF_FRAC*h;return this._minValidDistance=h-f,this._maxValidDistance=h+f,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ca.VERBOSE&&Pe.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ca.prototype.checkNegativeValid=function(){if(!(this._input instanceof zt||this._input instanceof Ar||this._input instanceof Cr))return null;var h=this.getPolygonLines(this._input);if(this.checkMinimumDistance(h,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(h,this._result,this._maxValidDistance)},ca.prototype.getErrorIndicator=function(){return this._errorIndicator},ca.prototype.checkMinimumDistance=function(h,f,_){var A=new lo(h,f,_);if(this._minDistanceFound=A.distance(),this._minDistanceFound<_){this._isValid=!1;var D=A.nearestPoints();this._errorLocation=A.nearestPoints()[1],this._errorIndicator=h.getFactory().createLineString(D),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+at.toLineString(D[0],D[1])+" )"}},ca.prototype.checkPositiveValid=function(){var h=this._result.getBoundary();if(this.checkMinimumDistance(this._input,h,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,h,this._maxValidDistance)},ca.prototype.getErrorLocation=function(){return this._errorLocation},ca.prototype.getPolygonLines=function(h){for(var f=new ue,_=new Aa(f),A=Ls.getPolygons(h).iterator();A.hasNext();)A.next().apply(_);return h.getFactory().buildGeometry(f)},ca.prototype.getErrorMessage=function(){return this._errMsg},ca.prototype.interfaces_=function(){return[]},ca.prototype.getClass=function(){return ca},Ov.VERBOSE.get=function(){return!1},Ov.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(ca,Ov);var Ln=s(function(h,f,_){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=h||null,this._distance=f||null,this._result=_||null},"Bi"),yl={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Ln.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Ln.prototype.checkEnvelope=function(){if(this._distance<0)return null;var h=this._distance*Ln.MAX_ENV_DIFF_FRAC;h===0&&(h=.001);var f=new Ae(this._input.getEnvelopeInternal());f.expandBy(this._distance);var _=new Ae(this._result.getEnvelopeInternal());_.expandBy(h),_.contains(f)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(_)),this.report("Envelope")},Ln.prototype.checkDistance=function(){var h=new ca(this._input,this._distance,this._result);h.isValid()||(this._isValid=!1,this._errorMsg=h.getErrorMessage(),this._errorLocation=h.getErrorLocation(),this._errorIndicator=h.getErrorIndicator()),this.report("Distance")},Ln.prototype.checkArea=function(){var h=this._input.getArea(),f=this._result.getArea();this._distance>0&&h>f&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&h<f&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Ln.prototype.checkPolygonal=function(){this._result instanceof zt||this._result instanceof Ar||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Ln.prototype.getErrorIndicator=function(){return this._errorIndicator},Ln.prototype.getErrorLocation=function(){return this._errorLocation},Ln.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Ln.prototype.report=function(h){if(!Ln.VERBOSE)return null;Pe.out.println("Check "+h+": "+(this._isValid?"passed":"FAILED"))},Ln.prototype.getErrorMessage=function(){return this._errorMsg},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.isValidMsg=function(h,f,_){var A=new Ln(h,f,_);return A.isValid()?null:A.getErrorMessage()},Ln.isValid=function(h,f,_){return!!new Ln(h,f,_).isValid()},yl.VERBOSE.get=function(){return!1},yl.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Ln,yl);var _s=s(function(){this._pts=null,this._data=null;var h=arguments[0],f=arguments[1];this._pts=h,this._data=f},"Ui");_s.prototype.getCoordinates=function(){return this._pts},_s.prototype.size=function(){return this._pts.length},_s.prototype.getCoordinate=function(h){return this._pts[h]},_s.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},_s.prototype.getSegmentOctant=function(h){return h===this._pts.length-1?-1:dl.octant(this.getCoordinate(h),this.getCoordinate(h+1))},_s.prototype.setData=function(h){this._data=h},_s.prototype.getData=function(){return this._data},_s.prototype.toString=function(){return at.toLineString(new jr(this._pts))},_s.prototype.interfaces_=function(){return[Ws]},_s.prototype.getClass=function(){return _s};var Na=s(function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new ue,this._intersectionCount=0,this._keepIntersections=!0;var h=arguments[0];this._li=h,this._interiorIntersection=null},"zi");Na.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Na.prototype.setCheckEndSegmentsOnly=function(h){this._isCheckEndSegmentsOnly=h},Na.prototype.getIntersectionSegments=function(){return this._intSegments},Na.prototype.count=function(){return this._intersectionCount},Na.prototype.getIntersections=function(){return this._intersections},Na.prototype.setFindAllIntersections=function(h){this._findAllIntersections=h},Na.prototype.setKeepIntersections=function(h){this._keepIntersections=h},Na.prototype.processIntersections=function(h,f,_,A){if(!this._findAllIntersections&&this.hasIntersection()||h===_&&f===A||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(h,f)||this.isEndSegment(_,A)))return null;var D=h.getCoordinates()[f],H=h.getCoordinates()[f+1],re=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];this._li.computeIntersection(D,H,re,ge),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=D,this._intSegments[1]=H,this._intSegments[2]=re,this._intSegments[3]=ge,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Na.prototype.isEndSegment=function(h,f){return f===0||f>=h.size()-2},Na.prototype.hasIntersection=function(){return this._interiorIntersection!==null},Na.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},Na.prototype.interfaces_=function(){return[uu]},Na.prototype.getClass=function(){return Na},Na.createAllIntersectionsFinder=function(h){var f=new Na(h);return f.setFindAllIntersections(!0),f},Na.createAnyIntersectionFinder=function(h){return new Na(h)},Na.createIntersectionCounter=function(h){var f=new Na(h);return f.setFindAllIntersections(!0),f.setKeepIntersections(!1),f};var Ds=s(function(){this._li=new It,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var h=arguments[0];this._segStrings=h},"Xi");Ds.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},Ds.prototype.getIntersections=function(){return this._segInt.getIntersections()},Ds.prototype.isValid=function(){return this.execute(),this._isValid},Ds.prototype.setFindAllIntersections=function(h){this._findAllIntersections=h},Ds.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Na(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var h=new jx;if(h.setSegmentIntersector(this._segInt),h.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Ds.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new qt(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Ds.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var h=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+at.toLineString(h[0],h[1])+" and "+at.toLineString(h[2],h[3])},Ds.prototype.interfaces_=function(){return[]},Ds.prototype.getClass=function(){return Ds},Ds.computeIntersections=function(h){var f=new Ds(h);return f.setFindAllIntersections(!0),f.isValid(),f.getIntersections()};var Yu=s(function h(){this._nv=null;var f=arguments[0];this._nv=new Ds(h.toSegmentStrings(f))},"t");Yu.prototype.checkValid=function(){this._nv.checkValid()},Yu.prototype.interfaces_=function(){return[]},Yu.prototype.getClass=function(){return Yu},Yu.toSegmentStrings=function(h){for(var f=new ue,_=h.iterator();_.hasNext();){var A=_.next();f.add(new _s(A.getCoordinates(),A))}return f},Yu.checkValid=function(h){new Yu(h).checkValid()};var ch=s(function(h){this._mapOp=h},"ki");ch.prototype.map=function(h){for(var f=new ue,_=0;_<h.getNumGeometries();_++){var A=this._mapOp.map(h.getGeometryN(_));A.isEmpty()||f.add(A)}return h.getFactory().createGeometryCollection(qr.toGeometryArray(f))},ch.prototype.interfaces_=function(){return[]},ch.prototype.getClass=function(){return ch},ch.map=function(h,f){return new ch(f).map(h)};var xs=s(function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new ue,this._resultLineList=new ue;var h=arguments[0],f=arguments[1],_=arguments[2];this._op=h,this._geometryFactory=f,this._ptLocator=_},"ji");xs.prototype.collectLines=function(h){for(var f=this._op.getGraph().getEdgeEnds().iterator();f.hasNext();){var _=f.next();this.collectLineEdge(_,h,this._lineEdgesList),this.collectBoundaryTouchEdge(_,h,this._lineEdgesList)}},xs.prototype.labelIsolatedLine=function(h,f){var _=this._ptLocator.locate(h.getCoordinate(),this._op.getArgGeometry(f));h.getLabel().setLocation(f,_)},xs.prototype.build=function(h){return this.findCoveredLineEdges(),this.collectLines(h),this.buildLines(h),this._resultLineList},xs.prototype.collectLineEdge=function(h,f,_){var A=h.getLabel(),D=h.getEdge();h.isLineEdge()&&(h.isVisited()||!mi.isResultOfOp(A,f)||D.isCovered()||(_.add(D),h.setVisitedEdge(!0)))},xs.prototype.findCoveredLineEdges=function(){for(var h=this._op.getGraph().getNodes().iterator();h.hasNext();)h.next().getEdges().findCoveredLineEdges();for(var f=this._op.getGraph().getEdgeEnds().iterator();f.hasNext();){var _=f.next(),A=_.getEdge();if(_.isLineEdge()&&!A.isCoveredSet()){var D=this._op.isCoveredByA(_.getCoordinate());A.setCovered(D)}}},xs.prototype.labelIsolatedLines=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next(),A=_.getLabel();_.isIsolated()&&(A.isNull(0)?this.labelIsolatedLine(_,0):this.labelIsolatedLine(_,1))}},xs.prototype.buildLines=function(h){for(var f=this._lineEdgesList.iterator();f.hasNext();){var _=f.next(),A=this._geometryFactory.createLineString(_.getCoordinates());this._resultLineList.add(A),_.setInResult(!0)}},xs.prototype.collectBoundaryTouchEdge=function(h,f,_){var A=h.getLabel();return h.isLineEdge()||h.isVisited()||h.isInteriorAreaEdge()||h.getEdge().isInResult()?null:(Me.isTrue(!(h.isInResult()||h.getSym().isInResult())||!h.getEdge().isInResult()),void(mi.isResultOfOp(A,f)&&f===mi.INTERSECTION&&(_.add(h.getEdge()),h.setVisitedEdge(!0))))},xs.prototype.interfaces_=function(){return[]},xs.prototype.getClass=function(){return xs};var up=s(function(){this._op=null,this._geometryFactory=null,this._resultPointList=new ue;var h=arguments[0],f=arguments[1];this._op=h,this._geometryFactory=f},"Hi");up.prototype.filterCoveredNodeToPoint=function(h){var f=h.getCoordinate();if(!this._op.isCoveredByLA(f)){var _=this._geometryFactory.createPoint(f);this._resultPointList.add(_)}},up.prototype.extractNonCoveredResultNodes=function(h){for(var f=this._op.getGraph().getNodes().iterator();f.hasNext();){var _=f.next();if(!_.isInResult()&&!_.isIncidentEdgeInResult()&&(_.getEdges().getDegree()===0||h===mi.INTERSECTION)){var A=_.getLabel();mi.isResultOfOp(A,h)&&this.filterCoveredNodeToPoint(_)}}},up.prototype.build=function(h){return this.extractNonCoveredResultNodes(h),this._resultPointList},up.prototype.interfaces_=function(){return[]},up.prototype.getClass=function(){return up};var wo=s(function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1},"Wi");wo.prototype.transformPoint=function(h,f){return this._factory.createPoint(this.transformCoordinates(h.getCoordinateSequence(),h))},wo.prototype.transformPolygon=function(h,f){var _=!0,A=this.transformLinearRing(h.getExteriorRing(),h);A!==null&&A instanceof ur&&!A.isEmpty()||(_=!1);for(var D=new ue,H=0;H<h.getNumInteriorRing();H++){var re=this.transformLinearRing(h.getInteriorRingN(H),h);re===null||re.isEmpty()||(re instanceof ur||(_=!1),D.add(re))}if(_)return this._factory.createPolygon(A,D.toArray([]));var ge=new ue;return A!==null&&ge.add(A),ge.addAll(D),this._factory.buildGeometry(ge)},wo.prototype.createCoordinateSequence=function(h){return this._factory.getCoordinateSequenceFactory().create(h)},wo.prototype.getInputGeometry=function(){return this._inputGeom},wo.prototype.transformMultiLineString=function(h,f){for(var _=new ue,A=0;A<h.getNumGeometries();A++){var D=this.transformLineString(h.getGeometryN(A),h);D!==null&&(D.isEmpty()||_.add(D))}return this._factory.buildGeometry(_)},wo.prototype.transformCoordinates=function(h,f){return this.copy(h)},wo.prototype.transformLineString=function(h,f){return this._factory.createLineString(this.transformCoordinates(h.getCoordinateSequence(),h))},wo.prototype.transformMultiPoint=function(h,f){for(var _=new ue,A=0;A<h.getNumGeometries();A++){var D=this.transformPoint(h.getGeometryN(A),h);D!==null&&(D.isEmpty()||_.add(D))}return this._factory.buildGeometry(_)},wo.prototype.transformMultiPolygon=function(h,f){for(var _=new ue,A=0;A<h.getNumGeometries();A++){var D=this.transformPolygon(h.getGeometryN(A),h);D!==null&&(D.isEmpty()||_.add(D))}return this._factory.buildGeometry(_)},wo.prototype.copy=function(h){return h.copy()},wo.prototype.transformGeometryCollection=function(h,f){for(var _=new ue,A=0;A<h.getNumGeometries();A++){var D=this.transform(h.getGeometryN(A));D!==null&&(this._pruneEmptyGeometry&&D.isEmpty()||_.add(D))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(qr.toGeometryArray(_)):this._factory.buildGeometry(_)},wo.prototype.transform=function(h){if(this._inputGeom=h,this._factory=h.getFactory(),h instanceof ft)return this.transformPoint(h,null);if(h instanceof cr)return this.transformMultiPoint(h,null);if(h instanceof ur)return this.transformLinearRing(h,null);if(h instanceof Je)return this.transformLineString(h,null);if(h instanceof Ei)return this.transformMultiLineString(h,null);if(h instanceof zt)return this.transformPolygon(h,null);if(h instanceof Ar)return this.transformMultiPolygon(h,null);if(h instanceof Cr)return this.transformGeometryCollection(h,null);throw new T("Unknown Geometry subtype: "+h.getClass().getName())},wo.prototype.transformLinearRing=function(h,f){var _=this.transformCoordinates(h.getCoordinateSequence(),h);if(_===null)return this._factory.createLinearRing(null);var A=_.size();return A>0&&A<4&&!this._preserveType?this._factory.createLineString(_):this._factory.createLinearRing(_)},wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo};var Rs=s(function h(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Gr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Je&&typeof arguments[1]=="number"){var f=arguments[0],_=arguments[1];h.call(this,f.getCoordinates(),_)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var A=arguments[0],D=arguments[1];this._srcPts=A,this._isClosed=h.isClosed(A),this._snapTolerance=D}},"t");Rs.prototype.snapVertices=function(h,f){for(var _=this._isClosed?h.size()-1:h.size(),A=0;A<_;A++){var D=h.get(A),H=this.findSnapForVertex(D,f);H!==null&&(h.set(A,new z(H)),A===0&&this._isClosed&&h.set(h.size()-1,new z(H)))}},Rs.prototype.findSnapForVertex=function(h,f){for(var _=0;_<f.length;_++){if(h.equals2D(f[_]))return null;if(h.distance(f[_])<this._snapTolerance)return f[_]}return null},Rs.prototype.snapTo=function(h){var f=new ze(this._srcPts);return this.snapVertices(f,h),this.snapSegments(f,h),f.toCoordinateArray()},Rs.prototype.snapSegments=function(h,f){if(f.length===0)return null;var _=f.length;f[0].equals2D(f[f.length-1])&&(_=f.length-1);for(var A=0;A<_;A++){var D=f[A],H=this.findSegmentIndexToSnap(D,h);H>=0&&h.add(H+1,new z(D),!1)}},Rs.prototype.findSegmentIndexToSnap=function(h,f){for(var _=O.MAX_VALUE,A=-1,D=0;D<f.size()-1;D++){if(this._seg.p0=f.get(D),this._seg.p1=f.get(D+1),this._seg.p0.equals2D(h)||this._seg.p1.equals2D(h)){if(this._allowSnappingToSourceVertices)continue;return-1}var H=this._seg.distance(h);H<this._snapTolerance&&H<_&&(_=H,A=D)}return A},Rs.prototype.setAllowSnappingToSourceVertices=function(h){this._allowSnappingToSourceVertices=h},Rs.prototype.interfaces_=function(){return[]},Rs.prototype.getClass=function(){return Rs},Rs.isClosed=function(h){return!(h.length<=1)&&h[0].equals2D(h[h.length-1])};var Sa=s(function(h){this._srcGeom=h||null},"Ji"),vl={SNAP_PRECISION_FACTOR:{configurable:!0}};Sa.prototype.snapTo=function(h,f){var _=this.extractTargetCoordinates(h);return new kv(f,_).transform(this._srcGeom)},Sa.prototype.snapToSelf=function(h,f){var _=this.extractTargetCoordinates(this._srcGeom),A=new kv(h,_,!0).transform(this._srcGeom),D=A;return f&&Y(D,rt)&&(D=A.buffer(0)),D},Sa.prototype.computeSnapTolerance=function(h){return this.computeMinimumSegmentLength(h)/10},Sa.prototype.extractTargetCoordinates=function(h){for(var f=new E,_=h.getCoordinates(),A=0;A<_.length;A++)f.add(_[A]);return f.toArray(new Array(0).fill(null))},Sa.prototype.computeMinimumSegmentLength=function(h){for(var f=O.MAX_VALUE,_=0;_<h.length-1;_++){var A=h[_].distance(h[_+1]);A<f&&(f=A)}return f},Sa.prototype.interfaces_=function(){return[]},Sa.prototype.getClass=function(){return Sa},Sa.snap=function(h,f,_){var A=new Array(2).fill(null),D=new Sa(h);A[0]=D.snapTo(f,_);var H=new Sa(f);return A[1]=H.snapTo(A[0],_),A},Sa.computeOverlaySnapTolerance=function(){if(arguments.length===1){var h=arguments[0],f=Sa.computeSizeBasedSnapTolerance(h),_=h.getPrecisionModel();if(_.getType()===li.FIXED){var A=1/_.getScale()*2/1.415;A>f&&(f=A)}return f}if(arguments.length===2){var D=arguments[0],H=arguments[1];return Math.min(Sa.computeOverlaySnapTolerance(D),Sa.computeOverlaySnapTolerance(H))}},Sa.computeSizeBasedSnapTolerance=function(h){var f=h.getEnvelopeInternal();return Math.min(f.getHeight(),f.getWidth())*Sa.SNAP_PRECISION_FACTOR},Sa.snapToSelf=function(h,f,_){return new Sa(h).snapToSelf(f,_)},vl.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Sa,vl);var kv=function(h){function f(_,A,D){h.call(this),this._snapTolerance=_||null,this._snapPts=A||null,this._isSelfSnap=D!==void 0&&D}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.snapLine=function(_,A){var D=new Rs(_,this._snapTolerance);return D.setAllowSnappingToSourceVertices(this._isSelfSnap),D.snapTo(A)},f.prototype.transformCoordinates=function(_,A){var D=_.toCoordinateArray(),H=this.snapLine(D,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(H)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(wo),ha=s(function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null},"$i");ha.prototype.getCommon=function(){return O.longBitsToDouble(this._commonBits)},ha.prototype.add=function(h){var f=O.doubleToLongBits(h);if(this._isFirst)return this._commonBits=f,this._commonSignExp=ha.signExpBits(this._commonBits),this._isFirst=!1,null;if(ha.signExpBits(f)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=ha.numCommonMostSigMantissaBits(this._commonBits,f),this._commonBits=ha.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},ha.prototype.toString=function(){if(arguments.length===1){var h=arguments[0],f=O.longBitsToDouble(h),_="0000000000000000000000000000000000000000000000000000000000000000"+O.toBinaryString(h),A=_.substring(_.length-64);return A.substring(0,1)+"  "+A.substring(1,12)+"(exp) "+A.substring(12)+" [ "+f+" ]"}},ha.prototype.interfaces_=function(){return[]},ha.prototype.getClass=function(){return ha},ha.getBit=function(h,f){return(h&1<<f)!=0?1:0},ha.signExpBits=function(h){return h>>52},ha.zeroLowerBits=function(h,f){return h&~((1<<f)-1)},ha.numCommonMostSigMantissaBits=function(h,f){for(var _=0,A=52;A>=0;A--){if(ha.getBit(h,A)!==ha.getBit(f,A))return _;_++}return 52};var kc=s(function(){this._commonCoord=null,this._ccFilter=new Vl},"tr"),Rf={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};kc.prototype.addCommonBits=function(h){var f=new Ku(this._commonCoord);h.apply(f),h.geometryChanged()},kc.prototype.removeCommonBits=function(h){if(this._commonCoord.x===0&&this._commonCoord.y===0)return h;var f=new z(this._commonCoord);f.x=-f.x,f.y=-f.y;var _=new Ku(f);return h.apply(_),h.geometryChanged(),h},kc.prototype.getCommonCoordinate=function(){return this._commonCoord},kc.prototype.add=function(h){h.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},kc.prototype.interfaces_=function(){return[]},kc.prototype.getClass=function(){return kc},Rf.CommonCoordinateFilter.get=function(){return Vl},Rf.Translater.get=function(){return Ku},Object.defineProperties(kc,Rf);var Vl=s(function(){this._commonBitsX=new ha,this._commonBitsY=new ha},"nr");Vl.prototype.filter=function(h){this._commonBitsX.add(h.x),this._commonBitsY.add(h.y)},Vl.prototype.getCommonCoordinate=function(){return new z(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Vl.prototype.interfaces_=function(){return[Fe]},Vl.prototype.getClass=function(){return Vl};var Ku=s(function(){this.trans=null;var h=arguments[0];this.trans=h},"ir");Ku.prototype.filter=function(h,f){var _=h.getOrdinate(f,0)+this.trans.x,A=h.getOrdinate(f,1)+this.trans.y;h.setOrdinate(f,0,_),h.setOrdinate(f,1,A)},Ku.prototype.isDone=function(){return!1},Ku.prototype.isGeometryChanged=function(){return!0},Ku.prototype.interfaces_=function(){return[Jr]},Ku.prototype.getClass=function(){return Ku};var Fa=s(function(h,f){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=h,this._geom[1]=f,this.computeSnapTolerance()},"rr");Fa.prototype.selfSnap=function(h){return new Sa(h).snapTo(h,this._snapTolerance)},Fa.prototype.removeCommonBits=function(h){this._cbr=new kc,this._cbr.add(h[0]),this._cbr.add(h[1]);var f=new Array(2).fill(null);return f[0]=this._cbr.removeCommonBits(h[0].copy()),f[1]=this._cbr.removeCommonBits(h[1].copy()),f},Fa.prototype.prepareResult=function(h){return this._cbr.addCommonBits(h),h},Fa.prototype.getResultGeometry=function(h){var f=this.snap(this._geom),_=mi.overlayOp(f[0],f[1],h);return this.prepareResult(_)},Fa.prototype.checkValid=function(h){h.isValid()||Pe.out.println("Snapped geometry is invalid")},Fa.prototype.computeSnapTolerance=function(){this._snapTolerance=Sa.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Fa.prototype.snap=function(h){var f=this.removeCommonBits(h);return Sa.snap(f[0],f[1],this._snapTolerance)},Fa.prototype.interfaces_=function(){return[]},Fa.prototype.getClass=function(){return Fa},Fa.overlayOp=function(h,f,_){return new Fa(h,f).getResultGeometry(_)},Fa.union=function(h,f){return Fa.overlayOp(h,f,mi.UNION)},Fa.intersection=function(h,f){return Fa.overlayOp(h,f,mi.INTERSECTION)},Fa.symDifference=function(h,f){return Fa.overlayOp(h,f,mi.SYMDIFFERENCE)},Fa.difference=function(h,f){return Fa.overlayOp(h,f,mi.DIFFERENCE)};var Ba=s(function(h,f){this._geom=new Array(2).fill(null),this._geom[0]=h,this._geom[1]=f},"or");Ba.prototype.getResultGeometry=function(h){var f=null,_=!1,A=null;try{f=mi.overlayOp(this._geom[0],this._geom[1],h),_=!0}catch(D){if(!(D instanceof Lt))throw D;A=D}if(!_)try{f=Fa.overlayOp(this._geom[0],this._geom[1],h)}catch(D){throw D instanceof Lt?A:D}return f},Ba.prototype.interfaces_=function(){return[]},Ba.prototype.getClass=function(){return Ba},Ba.overlayOp=function(h,f,_){return new Ba(h,f).getResultGeometry(_)},Ba.union=function(h,f){return Ba.overlayOp(h,f,mi.UNION)},Ba.intersection=function(h,f){return Ba.overlayOp(h,f,mi.INTERSECTION)},Ba.symDifference=function(h,f){return Ba.overlayOp(h,f,mi.SYMDIFFERENCE)},Ba.difference=function(h,f){return Ba.overlayOp(h,f,mi.DIFFERENCE)};var Nc=s(function(){this.mce=null,this.chainIndex=null;var h=arguments[0],f=arguments[1];this.mce=h,this.chainIndex=f},"sr");Nc.prototype.computeIntersections=function(h,f){this.mce.computeIntersectsForChain(this.chainIndex,h.mce,h.chainIndex,f)},Nc.prototype.interfaces_=function(){return[]},Nc.prototype.getClass=function(){return Nc};var Fo=s(function h(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var f=arguments[0],_=arguments[1];this._eventType=h.DELETE,this._xValue=f,this._insertEvent=_}else if(arguments.length===3){var A=arguments[0],D=arguments[1],H=arguments[2];this._eventType=h.INSERT,this._label=A,this._xValue=D,this._obj=H}},"t"),Of={INSERT:{configurable:!0},DELETE:{configurable:!0}};Fo.prototype.isDelete=function(){return this._eventType===Fo.DELETE},Fo.prototype.setDeleteEventIndex=function(h){this._deleteEventIndex=h},Fo.prototype.getObject=function(){return this._obj},Fo.prototype.compareTo=function(h){var f=h;return this._xValue<f._xValue?-1:this._xValue>f._xValue?1:this._eventType<f._eventType?-1:this._eventType>f._eventType?1:0},Fo.prototype.getInsertEvent=function(){return this._insertEvent},Fo.prototype.isInsert=function(){return this._eventType===Fo.INSERT},Fo.prototype.isSameLabel=function(h){return this._label!==null&&this._label===h._label},Fo.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Fo.prototype.interfaces_=function(){return[k]},Fo.prototype.getClass=function(){return Fo},Of.INSERT.get=function(){return 1},Of.DELETE.get=function(){return 2},Object.defineProperties(Fo,Of);var Ks=s(function(){},"lr");Ks.prototype.interfaces_=function(){return[]},Ks.prototype.getClass=function(){return Ks};var Dn=s(function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var h=arguments[0],f=arguments[1],_=arguments[2];this._li=h,this._includeProper=f,this._recordIsolated=_},"cr");Dn.prototype.isTrivialIntersection=function(h,f,_,A){if(h===_&&this._li.getIntersectionNum()===1){if(Dn.isAdjacentSegments(f,A))return!0;if(h.isClosed()){var D=h.getNumPoints()-1;if(f===0&&A===D||A===0&&f===D)return!0}}return!1},Dn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Dn.prototype.setIsDoneIfProperInt=function(h){this._isDoneWhenProperInt=h},Dn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Dn.prototype.isBoundaryPointInternal=function(h,f){for(var _=f.iterator();_.hasNext();){var A=_.next().getCoordinate();if(h.isIntersection(A))return!0}return!1},Dn.prototype.hasProperIntersection=function(){return this._hasProper},Dn.prototype.hasIntersection=function(){return this._hasIntersection},Dn.prototype.isDone=function(){return this._isDone},Dn.prototype.isBoundaryPoint=function(h,f){return f!==null&&(!!this.isBoundaryPointInternal(h,f[0])||!!this.isBoundaryPointInternal(h,f[1]))},Dn.prototype.setBoundaryNodes=function(h,f){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=h,this._bdyNodes[1]=f},Dn.prototype.addIntersections=function(h,f,_,A){if(h===_&&f===A)return null;this.numTests++;var D=h.getCoordinates()[f],H=h.getCoordinates()[f+1],re=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];this._li.computeIntersection(D,H,re,ge),this._li.hasIntersection()&&(this._recordIsolated&&(h.setIsolated(!1),_.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(h,f,_,A)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(h.addIntersections(this._li,f,0),_.addIntersections(this._li,A,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Dn.isAdjacentSegments=function(h,f){return Math.abs(h-f)===1};var dd=function(h){function f(){h.call(this),this.events=new ue,this.nOverlaps=null}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.prepareEvents=function(){Ge.sort(this.events);for(var _=0;_<this.events.size();_++){var A=this.events.get(_);A.isDelete()&&A.getInsertEvent().setDeleteEventIndex(_)}},f.prototype.computeIntersections=function(){if(arguments.length===1){var _=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var A=0;A<this.events.size();A++){var D=this.events.get(A);if(D.isInsert()&&this.processOverlaps(A,D.getDeleteEventIndex(),D,_),_.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Dn&&Y(arguments[0],se)&&Y(arguments[1],se)){var H=arguments[0],re=arguments[1],ge=arguments[2];this.addEdges(H,H),this.addEdges(re,re),this.computeIntersections(ge)}else if(typeof arguments[2]=="boolean"&&Y(arguments[0],se)&&arguments[1]instanceof Dn){var Ne=arguments[0],Ye=arguments[1];arguments[2]?this.addEdges(Ne,null):this.addEdges(Ne),this.computeIntersections(Ye)}}},f.prototype.addEdge=function(_,A){for(var D=_.getMonotoneChainEdge(),H=D.getStartIndexes(),re=0;re<H.length-1;re++){var ge=new Nc(D,re),Ne=new Fo(A,D.getMinX(re),ge);this.events.add(Ne),this.events.add(new Fo(D.getMaxX(re),Ne))}},f.prototype.processOverlaps=function(_,A,D,H){for(var re=D.getObject(),ge=_;ge<A;ge++){var Ne=this.events.get(ge);if(Ne.isInsert()){var Ye=Ne.getObject();D.isSameLabel(Ne)||(re.computeIntersections(Ye,H),this.nOverlaps++)}}},f.prototype.addEdges=function(){if(arguments.length===1)for(var _=arguments[0].iterator();_.hasNext();){var A=_.next();this.addEdge(A,A)}else if(arguments.length===2)for(var D=arguments[0],H=arguments[1],re=D.iterator();re.hasNext();){var ge=re.next();this.addEdge(ge,H)}},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Ks),Bo=s(function(){this._min=O.POSITIVE_INFINITY,this._max=O.NEGATIVE_INFINITY},"hr"),Fc={NodeComparator:{configurable:!0}};Bo.prototype.getMin=function(){return this._min},Bo.prototype.intersects=function(h,f){return!(this._min>f||this._max<h)},Bo.prototype.getMax=function(){return this._max},Bo.prototype.toString=function(){return at.toLineString(new z(this._min,0),new z(this._max,0))},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo},Fc.NodeComparator.get=function(){return Ju},Object.defineProperties(Bo,Fc);var Ju=s(function(){},"gr");Ju.prototype.compare=function(h,f){var _=h,A=f,D=(_._min+_._max)/2,H=(A._min+A._max)/2;return D<H?-1:D>H?1:0},Ju.prototype.interfaces_=function(){return[U]},Ju.prototype.getClass=function(){return Ju};var IS=function(h){function f(){h.call(this),this._item=null;var _=arguments[0],A=arguments[1],D=arguments[2];this._min=_,this._max=A,this._item=D}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.query=function(_,A,D){if(!this.intersects(_,A))return null;D.visitItem(this._item)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Bo),Gx=function(h){function f(){h.call(this),this._node1=null,this._node2=null;var _=arguments[0],A=arguments[1];this._node1=_,this._node2=A,this.buildExtent(this._node1,this._node2)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.buildExtent=function(_,A){this._min=Math.min(_._min,A._min),this._max=Math.max(_._max,A._max)},f.prototype.query=function(_,A,D){if(!this.intersects(_,A))return null;this._node1!==null&&this._node1.query(_,A,D),this._node2!==null&&this._node2.query(_,A,D)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Bo),jl=s(function(){this._leaves=new ue,this._root=null,this._level=0},"_r");jl.prototype.buildTree=function(){Ge.sort(this._leaves,new Bo.NodeComparator);for(var h=this._leaves,f=null,_=new ue;;){if(this.buildLevel(h,_),_.size()===1)return _.get(0);f=h,h=_,_=f}},jl.prototype.insert=function(h,f,_){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new IS(h,f,_))},jl.prototype.query=function(h,f,_){this.init(),this._root.query(h,f,_)},jl.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},jl.prototype.printNode=function(h){Pe.out.println(at.toLineString(new z(h._min,this._level),new z(h._max,this._level)))},jl.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},jl.prototype.buildLevel=function(h,f){this._level++,f.clear();for(var _=0;_<h.size();_+=2){var A=h.get(_);if((_+1<h.size()?h.get(_):null)===null)f.add(A);else{var D=new Gx(h.get(_),h.get(_+1));f.add(D)}}},jl.prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl};var Ao=s(function(){this._items=new ue},"mr");Ao.prototype.visitItem=function(h){this._items.add(h)},Ao.prototype.getItems=function(){return this._items},Ao.prototype.interfaces_=function(){return[Wn]},Ao.prototype.getClass=function(){return Ao};var ia=s(function(){this._index=null;var h=arguments[0];if(!Y(h,rt))throw new T("Argument must be Polygonal");this._index=new bs(h)},"vr"),bn={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};ia.prototype.locate=function(h){var f=new Et(h),_=new fu(f);return this._index.query(h.y,h.y,_),f.getLocation()},ia.prototype.interfaces_=function(){return[hd]},ia.prototype.getClass=function(){return ia},bn.SegmentVisitor.get=function(){return fu},bn.IntervalIndexedGeometry.get=function(){return bs},Object.defineProperties(ia,bn);var fu=s(function(){this._counter=null;var h=arguments[0];this._counter=h},"Er");fu.prototype.visitItem=function(h){var f=h;this._counter.countSegment(f.getCoordinate(0),f.getCoordinate(1))},fu.prototype.interfaces_=function(){return[Wn]},fu.prototype.getClass=function(){return fu};var bs=s(function(){this._index=new jl;var h=arguments[0];this.init(h)},"xr");bs.prototype.init=function(h){for(var f=Aa.getLines(h).iterator();f.hasNext();){var _=f.next().getCoordinates();this.addLine(_)}},bs.prototype.addLine=function(h){for(var f=1;f<h.length;f++){var _=new Gr(h[f-1],h[f]),A=Math.min(_.p0.y,_.p1.y),D=Math.max(_.p0.y,_.p1.y);this._index.insert(A,D,_)}},bs.prototype.query=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1],_=new Ao;return this._index.query(h,f,_),_.getItems()}if(arguments.length===3){var A=arguments[0],D=arguments[1],H=arguments[2];this._index.query(A,D,H)}},bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs};var fd=function(h){function f(){if(h.call(this),this._parentGeom=null,this._lineEdgeMap=new $r,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Ys,arguments.length===2){var _=arguments[0],A=arguments[1],D=Xe.OGC_SFS_BOUNDARY_RULE;this._argIndex=_,this._parentGeom=A,this._boundaryNodeRule=D,A!==null&&this.add(A)}else if(arguments.length===3){var H=arguments[0],re=arguments[1],ge=arguments[2];this._argIndex=H,this._parentGeom=re,this._boundaryNodeRule=ge,re!==null&&this.add(re)}}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.insertBoundaryPoint=function(_,A){var D=this._nodes.addNode(A).getLabel(),H=1;V.NONE,D.getLocation(_,Le.ON)===V.BOUNDARY&&H++;var re=f.determineBoundary(this._boundaryNodeRule,H);D.setLocation(_,re)},f.prototype.computeSelfNodes=function(){if(arguments.length===2){var _=arguments[0],A=arguments[1];return this.computeSelfNodes(_,A,!1)}if(arguments.length===3){var D=arguments[0],H=arguments[1],re=arguments[2],ge=new Dn(D,!0,!1);ge.setIsDoneIfProperInt(re);var Ne=this.createEdgeSetIntersector(),Ye=this._parentGeom instanceof ur||this._parentGeom instanceof zt||this._parentGeom instanceof Ar,Mt=H||!Ye;return Ne.computeIntersections(this._edges,ge,Mt),this.addSelfIntersectionNodes(this._argIndex),ge}},f.prototype.computeSplitEdges=function(_){for(var A=this._edges.iterator();A.hasNext();)A.next().eiList.addSplitEdges(_)},f.prototype.computeEdgeIntersections=function(_,A,D){var H=new Dn(A,D,!0);return H.setBoundaryNodes(this.getBoundaryNodes(),_.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,_._edges,H),H},f.prototype.getGeometry=function(){return this._parentGeom},f.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},f.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},f.prototype.addPoint=function(){if(arguments[0]instanceof ft){var _=arguments[0].getCoordinate();this.insertPoint(this._argIndex,_,V.INTERIOR)}else if(arguments[0]instanceof z){var A=arguments[0];this.insertPoint(this._argIndex,A,V.INTERIOR)}},f.prototype.addPolygon=function(_){this.addPolygonRing(_.getExteriorRing(),V.EXTERIOR,V.INTERIOR);for(var A=0;A<_.getNumInteriorRing();A++){var D=_.getInteriorRingN(A);this.addPolygonRing(D,V.INTERIOR,V.EXTERIOR)}},f.prototype.addEdge=function(_){this.insertEdge(_);var A=_.getCoordinates();this.insertPoint(this._argIndex,A[0],V.BOUNDARY),this.insertPoint(this._argIndex,A[A.length-1],V.BOUNDARY)},f.prototype.addLineString=function(_){var A=Re.removeRepeatedPoints(_.getCoordinates());if(A.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=A[0],null;var D=new Sg(A,new lr(this._argIndex,V.INTERIOR));this._lineEdgeMap.put(_,D),this.insertEdge(D),Me.isTrue(A.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,A[0]),this.insertBoundaryPoint(this._argIndex,A[A.length-1])},f.prototype.getInvalidPoint=function(){return this._invalidPoint},f.prototype.getBoundaryPoints=function(){for(var _=this.getBoundaryNodes(),A=new Array(_.size()).fill(null),D=0,H=_.iterator();H.hasNext();){var re=H.next();A[D++]=re.getCoordinate().copy()}return A},f.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},f.prototype.addSelfIntersectionNode=function(_,A,D){if(this.isBoundaryNode(_,A))return null;D===V.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(_,A):this.insertPoint(_,A,D)},f.prototype.addPolygonRing=function(_,A,D){if(_.isEmpty())return null;var H=Re.removeRepeatedPoints(_.getCoordinates());if(H.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=H[0],null;var re=A,ge=D;pt.isCCW(H)&&(re=D,ge=A);var Ne=new Sg(H,new lr(this._argIndex,V.BOUNDARY,re,ge));this._lineEdgeMap.put(_,Ne),this.insertEdge(Ne),this.insertPoint(this._argIndex,H[0],V.BOUNDARY)},f.prototype.insertPoint=function(_,A,D){var H=this._nodes.addNode(A),re=H.getLabel();re===null?H._label=new lr(_,D):re.setLocation(_,D)},f.prototype.createEdgeSetIntersector=function(){return new dd},f.prototype.addSelfIntersectionNodes=function(_){for(var A=this._edges.iterator();A.hasNext();)for(var D=A.next(),H=D.getLabel().getLocation(_),re=D.eiList.iterator();re.hasNext();){var ge=re.next();this.addSelfIntersectionNode(_,ge.coord,H)}},f.prototype.add=function(){if(arguments.length!==1)return h.prototype.add.apply(this,arguments);var _=arguments[0];if(_.isEmpty())return null;if(_ instanceof Ar&&(this._useBoundaryDeterminationRule=!1),_ instanceof zt)this.addPolygon(_);else if(_ instanceof Je)this.addLineString(_);else if(_ instanceof ft)this.addPoint(_);else if(_ instanceof cr)this.addCollection(_);else if(_ instanceof Ei)this.addCollection(_);else if(_ instanceof Ar)this.addCollection(_);else{if(!(_ instanceof Cr))throw new Error(_.getClass().getName());this.addCollection(_)}},f.prototype.addCollection=function(_){for(var A=0;A<_.getNumGeometries();A++){var D=_.getGeometryN(A);this.add(D)}},f.prototype.locate=function(_){return Y(this._parentGeom,rt)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new ia(this._parentGeom)),this._areaPtLocator.locate(_)):this._ptLocator.locate(_,this._parentGeom)},f.prototype.findEdge=function(){if(arguments.length===1){var _=arguments[0];return this._lineEdgeMap.get(_)}return h.prototype.findEdge.apply(this,arguments)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.determineBoundary=function(_,A){return _.isInBoundary(A)?V.BOUNDARY:V.INTERIOR},f}(un),mu=s(function(){if(this._li=new It,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var h=arguments[0];this.setComputationPrecision(h.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new fd(0,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1],A=Xe.OGC_SFS_BOUNDARY_RULE;f.getPrecisionModel().compareTo(_.getPrecisionModel())>=0?this.setComputationPrecision(f.getPrecisionModel()):this.setComputationPrecision(_.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new fd(0,f,A),this._arg[1]=new fd(1,_,A)}else if(arguments.length===3){var D=arguments[0],H=arguments[1],re=arguments[2];D.getPrecisionModel().compareTo(H.getPrecisionModel())>=0?this.setComputationPrecision(D.getPrecisionModel()):this.setComputationPrecision(H.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new fd(0,D,re),this._arg[1]=new fd(1,H,re)}},"Cr");mu.prototype.getArgGeometry=function(h){return this._arg[h].getGeometry()},mu.prototype.setComputationPrecision=function(h){this._resultPrecisionModel=h,this._li.setPrecisionModel(this._resultPrecisionModel)},mu.prototype.interfaces_=function(){return[]},mu.prototype.getClass=function(){return mu};var hh=s(function(){},"Sr");hh.prototype.interfaces_=function(){return[]},hh.prototype.getClass=function(){return hh},hh.map=function(){if(arguments[0]instanceof $t&&Y(arguments[1],hh.MapOp)){for(var h=arguments[0],f=arguments[1],_=new ue,A=0;A<h.getNumGeometries();A++){var D=f.map(h.getGeometryN(A));D!==null&&_.add(D)}return h.getFactory().buildGeometry(_)}if(Y(arguments[0],er)&&Y(arguments[1],hh.MapOp)){for(var H=arguments[0],re=arguments[1],ge=new ue,Ne=H.iterator();Ne.hasNext();){var Ye=Ne.next(),Mt=re.map(Ye);Mt!==null&&ge.add(Mt)}return ge}},hh.MapOp=function(){};var mi=function(h){function f(){var _=arguments[0],A=arguments[1];h.call(this,_,A),this._ptLocator=new Ys,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new fl,this._resultPolyList=new ue,this._resultLineList=new ue,this._resultPointList=new ue,this._graph=new un(new MS),this._geomFact=_.getFactory()}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.insertUniqueEdge=function(_){var A=this._edgeList.findEqualEdge(_);if(A!==null){var D=A.getLabel(),H=_.getLabel();A.isPointwiseEqual(_)||(H=new lr(_.getLabel())).flip();var re=A.getDepth();re.isNull()&&re.add(D),re.add(H),D.merge(H)}else this._edgeList.add(_)},f.prototype.getGraph=function(){return this._graph},f.prototype.cancelDuplicateResultEdges=function(){for(var _=this._graph.getEdgeEnds().iterator();_.hasNext();){var A=_.next(),D=A.getSym();A.isInResult()&&D.isInResult()&&(A.setInResult(!1),D.setInResult(!1))}},f.prototype.isCoveredByLA=function(_){return!!this.isCovered(_,this._resultLineList)||!!this.isCovered(_,this._resultPolyList)},f.prototype.computeGeometry=function(_,A,D,H){var re=new ue;return re.addAll(_),re.addAll(A),re.addAll(D),re.isEmpty()?f.createEmptyResult(H,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(re)},f.prototype.mergeSymLabels=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();)_.next().getEdges().mergeSymLabels()},f.prototype.isCovered=function(_,A){for(var D=A.iterator();D.hasNext();){var H=D.next();if(this._ptLocator.locate(_,H)!==V.EXTERIOR)return!0}return!1},f.prototype.replaceCollapsedEdges=function(){for(var _=new ue,A=this._edgeList.iterator();A.hasNext();){var D=A.next();D.isCollapsed()&&(A.remove(),_.add(D.getCollapsedEdge()))}this._edgeList.addAll(_)},f.prototype.updateNodeLabelling=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();){var A=_.next(),D=A.getEdges().getLabel();A.getLabel().merge(D)}},f.prototype.getResultGeometry=function(_){return this.computeOverlay(_),this._resultGeom},f.prototype.insertUniqueEdges=function(_){for(var A=_.iterator();A.hasNext();){var D=A.next();this.insertUniqueEdge(D)}},f.prototype.computeOverlay=function(_){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var A=new ue;this._arg[0].computeSplitEdges(A),this._arg[1].computeSplitEdges(A),this.insertUniqueEdges(A),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Yu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(_),this.cancelDuplicateResultEdges();var D=new Ta(this._geomFact);D.add(this._graph),this._resultPolyList=D.getPolygons();var H=new xs(this,this._geomFact,this._ptLocator);this._resultLineList=H.build(_);var re=new up(this,this._geomFact,this._ptLocator);this._resultPointList=re.build(_),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,_)},f.prototype.labelIncompleteNode=function(_,A){var D=this._ptLocator.locate(_.getCoordinate(),this._arg[A].getGeometry());_.getLabel().setLocation(A,D)},f.prototype.copyPoints=function(_){for(var A=this._arg[_].getNodeIterator();A.hasNext();){var D=A.next();this._graph.addNode(D.getCoordinate()).setLabel(_,D.getLabel().getLocation(_))}},f.prototype.findResultAreaEdges=function(_){for(var A=this._graph.getEdgeEnds().iterator();A.hasNext();){var D=A.next(),H=D.getLabel();H.isArea()&&!D.isInteriorAreaEdge()&&f.isResultOfOp(H.getLocation(0,Le.RIGHT),H.getLocation(1,Le.RIGHT),_)&&D.setInResult(!0)}},f.prototype.computeLabelsFromDepths=function(){for(var _=this._edgeList.iterator();_.hasNext();){var A=_.next(),D=A.getLabel(),H=A.getDepth();if(!H.isNull()){H.normalize();for(var re=0;re<2;re++)D.isNull(re)||!D.isArea()||H.isNull(re)||(H.getDelta(re)===0?D.toLine(re):(Me.isTrue(!H.isNull(re,Le.LEFT),"depth of LEFT side has not been initialized"),D.setLocation(re,Le.LEFT,H.getLocation(re,Le.LEFT)),Me.isTrue(!H.isNull(re,Le.RIGHT),"depth of RIGHT side has not been initialized"),D.setLocation(re,Le.RIGHT,H.getLocation(re,Le.RIGHT))))}}},f.prototype.computeLabelling=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();)_.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},f.prototype.labelIncompleteNodes=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();){var A=_.next(),D=A.getLabel();A.isIsolated()&&(D.isNull(0)?this.labelIncompleteNode(A,0):this.labelIncompleteNode(A,1)),A.getEdges().updateLabelling(D)}},f.prototype.isCoveredByA=function(_){return!!this.isCovered(_,this._resultPolyList)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(mu);mi.overlayOp=function(h,f,_){return new mi(h,f).getResultGeometry(_)},mi.intersection=function(h,f){if(h.isEmpty()||f.isEmpty())return mi.createEmptyResult(mi.INTERSECTION,h,f,h.getFactory());if(h.isGeometryCollection()){var _=f;return ch.map(h,{interfaces_:s(function(){return[hh.MapOp]},"interfaces_"),map:s(function(A){return A.intersection(_)},"map")})}return h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Ba.overlayOp(h,f,mi.INTERSECTION)},mi.symDifference=function(h,f){if(h.isEmpty()||f.isEmpty()){if(h.isEmpty()&&f.isEmpty())return mi.createEmptyResult(mi.SYMDIFFERENCE,h,f,h.getFactory());if(h.isEmpty())return f.copy();if(f.isEmpty())return h.copy()}return h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Ba.overlayOp(h,f,mi.SYMDIFFERENCE)},mi.resultDimension=function(h,f,_){var A=f.getDimension(),D=_.getDimension(),H=-1;switch(h){case mi.INTERSECTION:H=Math.min(A,D);break;case mi.UNION:H=Math.max(A,D);break;case mi.DIFFERENCE:H=A;break;case mi.SYMDIFFERENCE:H=Math.max(A,D)}return H},mi.createEmptyResult=function(h,f,_,A){var D=null;switch(mi.resultDimension(h,f,_)){case-1:D=A.createGeometryCollection(new Array(0).fill(null));break;case 0:D=A.createPoint();break;case 1:D=A.createLineString();break;case 2:D=A.createPolygon()}return D},mi.difference=function(h,f){return h.isEmpty()?mi.createEmptyResult(mi.DIFFERENCE,h,f,h.getFactory()):f.isEmpty()?h.copy():(h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Ba.overlayOp(h,f,mi.DIFFERENCE))},mi.isResultOfOp=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1],_=h.getLocation(0),A=h.getLocation(1);return mi.isResultOfOp(_,A,f)}if(arguments.length===3){var D=arguments[0],H=arguments[1],re=arguments[2];switch(D===V.BOUNDARY&&(D=V.INTERIOR),H===V.BOUNDARY&&(H=V.INTERIOR),re){case mi.INTERSECTION:return D===V.INTERIOR&&H===V.INTERIOR;case mi.UNION:return D===V.INTERIOR||H===V.INTERIOR;case mi.DIFFERENCE:return D===V.INTERIOR&&H!==V.INTERIOR;case mi.SYMDIFFERENCE:return D===V.INTERIOR&&H!==V.INTERIOR||D!==V.INTERIOR&&H===V.INTERIOR}return!1}},mi.INTERSECTION=1,mi.UNION=2,mi.DIFFERENCE=3,mi.SYMDIFFERENCE=4;var $l=s(function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Ys,this._seg=new Gr;var h=arguments[0],f=arguments[1];this._g=h,this._boundaryDistanceTolerance=f,this._linework=this.extractLinework(h)},"br");$l.prototype.isWithinToleranceOfBoundary=function(h){for(var f=0;f<this._linework.getNumGeometries();f++)for(var _=this._linework.getGeometryN(f).getCoordinateSequence(),A=0;A<_.size()-1;A++)if(_.getCoordinate(A,this._seg.p0),_.getCoordinate(A+1,this._seg.p1),this._seg.distance(h)<=this._boundaryDistanceTolerance)return!0;return!1},$l.prototype.getLocation=function(h){return this.isWithinToleranceOfBoundary(h)?V.BOUNDARY:this._ptLocator.locate(h,this._g)},$l.prototype.extractLinework=function(h){var f=new Bc;h.apply(f);var _=f.getLinework(),A=qr.toLineStringArray(_);return h.getFactory().createMultiLineString(A)},$l.prototype.interfaces_=function(){return[]},$l.prototype.getClass=function(){return $l};var Bc=s(function(){this._linework=null,this._linework=new ue},"wr");Bc.prototype.getLinework=function(){return this._linework},Bc.prototype.filter=function(h){if(h instanceof zt){var f=h;this._linework.add(f.getExteriorRing());for(var _=0;_<f.getNumInteriorRing();_++)this._linework.add(f.getInteriorRingN(_))}},Bc.prototype.interfaces_=function(){return[ai]},Bc.prototype.getClass=function(){return Bc};var ph=s(function(){this._g=null,this._doLeft=!0,this._doRight=!0;var h=arguments[0];this._g=h},"Or");ph.prototype.extractPoints=function(h,f,_){for(var A=h.getCoordinates(),D=0;D<A.length-1;D++)this.computeOffsetPoints(A[D],A[D+1],f,_)},ph.prototype.setSidesToGenerate=function(h,f){this._doLeft=h,this._doRight=f},ph.prototype.getPoints=function(h){for(var f=new ue,_=Aa.getLines(this._g).iterator();_.hasNext();){var A=_.next();this.extractPoints(A,h,f)}return f},ph.prototype.computeOffsetPoints=function(h,f,_,A){var D=f.x-h.x,H=f.y-h.y,re=Math.sqrt(D*D+H*H),ge=_*D/re,Ne=_*H/re,Ye=(f.x+h.x)/2,Mt=(f.y+h.y)/2;if(this._doLeft){var At=new z(Ye-Ne,Mt+ge);A.add(At)}if(this._doRight){var hr=new z(Ye+Ne,Mt-ge);A.add(hr)}},ph.prototype.interfaces_=function(){return[]},ph.prototype.getClass=function(){return ph};var zo=s(function h(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=h.TOLERANCE,this._testCoords=new ue;var f=arguments[0],_=arguments[1],A=arguments[2];this._boundaryDistanceTolerance=h.computeBoundaryDistanceTolerance(f,_),this._geom=[f,_,A],this._locFinder=[new $l(this._geom[0],this._boundaryDistanceTolerance),new $l(this._geom[1],this._boundaryDistanceTolerance),new $l(this._geom[2],this._boundaryDistanceTolerance)]},"t"),Nv={TOLERANCE:{configurable:!0}};zo.prototype.reportResult=function(h,f,_){Pe.out.println("Overlay result invalid - A:"+V.toLocationSymbol(f[0])+" B:"+V.toLocationSymbol(f[1])+" expected:"+(_?"i":"e")+" actual:"+V.toLocationSymbol(f[2]))},zo.prototype.isValid=function(h){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var f=this.checkValid(h);return f},zo.prototype.checkValid=function(){if(arguments.length===1){for(var h=arguments[0],f=0;f<this._testCoords.size();f++){var _=this._testCoords.get(f);if(!this.checkValid(h,_))return this._invalidLocation=_,!1}return!0}if(arguments.length===2){var A=arguments[0],D=arguments[1];return this._location[0]=this._locFinder[0].getLocation(D),this._location[1]=this._locFinder[1].getLocation(D),this._location[2]=this._locFinder[2].getLocation(D),!!zo.hasLocation(this._location,V.BOUNDARY)||this.isValidResult(A,this._location)}},zo.prototype.addTestPts=function(h){var f=new ph(h);this._testCoords.addAll(f.getPoints(5*this._boundaryDistanceTolerance))},zo.prototype.isValidResult=function(h,f){var _=mi.isResultOfOp(f[0],f[1],h),A=!(_^f[2]===V.INTERIOR);return A||this.reportResult(h,f,_),A},zo.prototype.getInvalidLocation=function(){return this._invalidLocation},zo.prototype.interfaces_=function(){return[]},zo.prototype.getClass=function(){return zo},zo.hasLocation=function(h,f){for(var _=0;_<3;_++)if(h[_]===f)return!0;return!1},zo.computeBoundaryDistanceTolerance=function(h,f){return Math.min(Sa.computeSizeBasedSnapTolerance(h),Sa.computeSizeBasedSnapTolerance(f))},zo.isValid=function(h,f,_,A){return new zo(h,f,A).isValid(_)},Nv.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(zo,Nv);var uo=s(function h(f){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=h.extractFactory(f),this._inputGeoms=f},"t");uo.prototype.extractElements=function(h,f){if(h===null)return null;for(var _=0;_<h.getNumGeometries();_++){var A=h.getGeometryN(_);this._skipEmpty&&A.isEmpty()||f.add(A)}},uo.prototype.combine=function(){for(var h=new ue,f=this._inputGeoms.iterator();f.hasNext();){var _=f.next();this.extractElements(_,h)}return h.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(h)},uo.prototype.interfaces_=function(){return[]},uo.prototype.getClass=function(){return uo},uo.combine=function(){if(arguments.length===1){var h=arguments[0];return new uo(h).combine()}if(arguments.length===2){var f=arguments[0],_=arguments[1];return new uo(uo.createList(f,_)).combine()}if(arguments.length===3){var A=arguments[0],D=arguments[1],H=arguments[2];return new uo(uo.createList(A,D,H)).combine()}},uo.extractFactory=function(h){return h.isEmpty()?null:h.iterator().next().getFactory()},uo.createList=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1],_=new ue;return _.add(h),_.add(f),_}if(arguments.length===3){var A=arguments[0],D=arguments[1],H=arguments[2],re=new ue;return re.add(A),re.add(D),re.add(H),re}};var Cn=s(function(){this._inputPolys=null,this._geomFactory=null;var h=arguments[0];this._inputPolys=h,this._inputPolys===null&&(this._inputPolys=new ue)},"Dr"),dh={STRTREE_NODE_CAPACITY:{configurable:!0}};Cn.prototype.reduceToGeometries=function(h){for(var f=new ue,_=h.iterator();_.hasNext();){var A=_.next(),D=null;Y(A,se)?D=this.unionTree(A):A instanceof $t&&(D=A),f.add(D)}return f},Cn.prototype.extractByEnvelope=function(h,f,_){for(var A=new ue,D=0;D<f.getNumGeometries();D++){var H=f.getGeometryN(D);H.getEnvelopeInternal().intersects(h)?A.add(H):_.add(H)}return this._geomFactory.buildGeometry(A)},Cn.prototype.unionOptimized=function(h,f){var _=h.getEnvelopeInternal(),A=f.getEnvelopeInternal();if(!_.intersects(A))return uo.combine(h,f);if(h.getNumGeometries()<=1&&f.getNumGeometries()<=1)return this.unionActual(h,f);var D=_.intersection(A);return this.unionUsingEnvelopeIntersection(h,f,D)},Cn.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var h=new gi(Cn.STRTREE_NODE_CAPACITY),f=this._inputPolys.iterator();f.hasNext();){var _=f.next();h.insert(_.getEnvelopeInternal(),_)}this._inputPolys=null;var A=h.itemsTree();return this.unionTree(A)},Cn.prototype.binaryUnion=function(){if(arguments.length===1){var h=arguments[0];return this.binaryUnion(h,0,h.size())}if(arguments.length===3){var f=arguments[0],_=arguments[1],A=arguments[2];if(A-_<=1){var D=Cn.getGeometry(f,_);return this.unionSafe(D,null)}if(A-_==2)return this.unionSafe(Cn.getGeometry(f,_),Cn.getGeometry(f,_+1));var H=Math.trunc((A+_)/2),re=this.binaryUnion(f,_,H),ge=this.binaryUnion(f,H,A);return this.unionSafe(re,ge)}},Cn.prototype.repeatedUnion=function(h){for(var f=null,_=h.iterator();_.hasNext();){var A=_.next();f=f===null?A.copy():f.union(A)}return f},Cn.prototype.unionSafe=function(h,f){return h===null&&f===null?null:h===null?f.copy():f===null?h.copy():this.unionOptimized(h,f)},Cn.prototype.unionActual=function(h,f){return Cn.restrictToPolygons(h.union(f))},Cn.prototype.unionTree=function(h){var f=this.reduceToGeometries(h);return this.binaryUnion(f)},Cn.prototype.unionUsingEnvelopeIntersection=function(h,f,_){var A=new ue,D=this.extractByEnvelope(_,h,A),H=this.extractByEnvelope(_,f,A),re=this.unionActual(D,H);return A.add(re),uo.combine(A)},Cn.prototype.bufferUnion=function(){if(arguments.length===1){var h=arguments[0];return h.get(0).getFactory().buildGeometry(h).buffer(0)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f.getFactory().createGeometryCollection([f,_]).buffer(0)}},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Cn.restrictToPolygons=function(h){if(Y(h,rt))return h;var f=Ls.getPolygons(h);return f.size()===1?f.get(0):h.getFactory().createMultiPolygon(qr.toPolygonArray(f))},Cn.getGeometry=function(h,f){return f>=h.size()?null:h.get(f)},Cn.union=function(h){return new Cn(h).union()},dh.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Cn,dh);var Gl=s(function(){},"Ar");Gl.prototype.interfaces_=function(){return[]},Gl.prototype.getClass=function(){return Gl},Gl.union=function(h,f){if(h.isEmpty()||f.isEmpty()){if(h.isEmpty()&&f.isEmpty())return mi.createEmptyResult(mi.UNION,h,f,h.getFactory());if(h.isEmpty())return f.copy();if(f.isEmpty())return h.copy()}return h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Ba.overlayOp(h,f,mi.UNION)},r.GeoJSONReader=we,r.GeoJSONWriter=Ce,r.OverlayOp=mi,r.UnionOp=Gl,r.BufferOp=so,Object.defineProperty(r,"__esModule",{value:!0})})}),rT=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;var e=class{};s(e,"_CodeOrName");var r=e;t._CodeOrName=r,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var i=class extends r{constructor(k){if(super(),!t.IDENTIFIER.test(k))throw new Error("CodeGen: name must be a valid identifier");this.str=k}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};s(i,"Name");var n=i;t.Name=n;var a=class extends r{constructor(k){super(),this._items=typeof k=="string"?[k]:k}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let k=this._items[0];return k===""||k==='""'}get str(){var k;return(k=this._str)!==null&&k!==void 0?k:this._str=this._items.reduce((B,U)=>"".concat(B).concat(U),"")}get names(){var k;return(k=this._names)!==null&&k!==void 0?k:this._names=this._items.reduce((B,U)=>(U instanceof n&&(B[U.str]=(B[U.str]||0)+1),B),{})}};s(a,"_Code");var o=a;t._Code=o,t.nil=new o("");function l(F,...k){let B=[F[0]],U=0;for(;U<k.length;)p(B,k[U]),B.push(F[++U]);return new o(B)}s(l,"_"),t._=l;var u=new o("+");function c(F,...k){let B=[I(F[0])],U=0;for(;U<k.length;)B.push(u),p(B,k[U]),B.push(u,I(F[++U]));return m(B),new o(B)}s(c,"str"),t.str=c;function p(F,k){k instanceof o?F.push(...k._items):k instanceof n?F.push(k):F.push(E(k))}s(p,"addCodeArg"),t.addCodeArg=p;function m(F){let k=1;for(;k<F.length-1;){if(F[k]===u){let B=y(F[k-1],F[k+1]);if(B!==void 0){F.splice(k-1,3,B);continue}F[k++]="+"}k++}}s(m,"optimize");function y(F,k){if(k==='""')return F;if(F==='""')return k;if(typeof F=="string")return k instanceof n||F[F.length-1]!=='"'?void 0:typeof k!="string"?"".concat(F.slice(0,-1)).concat(k,'"'):k[0]==='"'?F.slice(0,-1)+k.slice(1):void 0;if(typeof k=="string"&&k[0]==='"'&&!(F instanceof n))return'"'.concat(F).concat(k.slice(1))}s(y,"mergeExprItems");var v;function w(F,k){return k.emptyStr()?F:F.emptyStr()?k:c(v||(v=je(["","",""])),F,k)}s(w,"strConcat"),t.strConcat=w;function E(F){return typeof F=="number"||typeof F=="boolean"||F===null?F:I(Array.isArray(F)?F.join(","):F)}s(E,"interpolate");function M(F){return new o(I(F))}s(M,"stringify"),t.stringify=M;function I(F){return JSON.stringify(F).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}s(I,"safeStringify"),t.safeStringify=I;var P;function C(F){return typeof F=="string"&&t.IDENTIFIER.test(F)?new o(".".concat(F)):l(P||(P=je(["[","]"])),F)}s(C,"getProperty"),t.getProperty=C;function T(F){if(typeof F=="string"&&t.IDENTIFIER.test(F))return new o("".concat(F));throw new Error("CodeGen: invalid export name: ".concat(F,", use explicit $id name mapping"))}s(T,"getEsmExportName"),t.getEsmExportName=T;function O(F){return new o(F.toString())}s(O,"regexpCode"),t.regexpCode=O}),MW=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;var e=rT(),r=class extends Error{constructor(P){super('CodeGen: "code" for '.concat(P," not defined")),this.value=P.value}};s(r,"ValueError");var i=r,n;(function(I){I[I.Started=0]="Started",I[I.Completed=1]="Completed"})(n||(t.UsedValueState=n={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};var a=class{constructor({prefixes:P,parent:C}={}){this._names={},this._prefixes=P,this._parent=C}toName(P){return P instanceof e.Name?P:this.name(P)}name(P){return new e.Name(this._newName(P))}_newName(P){let C=this._names[P]||this._nameGroup(P);return"".concat(P).concat(C.index++)}_nameGroup(P){var C,T;if(!((T=(C=this._parent)===null||C===void 0?void 0:C._prefixes)===null||T===void 0)&&T.has(P)||this._prefixes&&!this._prefixes.has(P))throw new Error('CodeGen: prefix "'.concat(P,'" is not allowed in this scope'));return this._names[P]={prefix:P,index:0}}};s(a,"Scope");var o=a;t.Scope=o;var l,u=class extends e.Name{constructor(P,C){super(C),this.prefix=P}setValue(P,{property:C,itemIndex:T}){this.value=P,this.scopePath=(0,e._)(l||(l=je([".","[","]"])),new e.Name(C),T)}};s(u,"ValueScopeName");var c=u;t.ValueScopeName=c;var p,m=(0,e._)(p||(p=je([`
`],["\\n"]))),y,v,w,E=class extends o{constructor(P){super(P),this._values={},this._scope=P.scope,this.opts=vt(Ee({},P),{_n:P.lines?m:e.nil})}get(){return this._scope}name(P){return new c(P,this._newName(P))}value(P,C){var T;if(C.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let O=this.toName(P),{prefix:F}=O,k=(T=C.key)!==null&&T!==void 0?T:C.ref,B=this._values[F];if(B){let q=B.get(k);if(q)return q}else B=this._values[F]=new Map;B.set(k,O);let U=this._scope[F]||(this._scope[F]=[]),z=U.length;return U[z]=C.ref,O.setValue(C,{property:F,itemIndex:z}),O}getValue(P,C){let T=this._values[P];if(T)return T.get(C)}scopeRefs(P,C=this._values){return this._reduceValues(C,T=>{if(T.scopePath===void 0)throw new Error('CodeGen: name "'.concat(T,'" has no value'));return(0,e._)(y||(y=je(["","",""])),P,T.scopePath)})}scopeCode(P=this._values,C,T){return this._reduceValues(P,O=>{if(O.value===void 0)throw new Error('CodeGen: name "'.concat(O,'" has no value'));return O.value.code},C,T)}_reduceValues(P,C,T={},O){let F=e.nil;for(let k in P){let B=P[k];if(!B)continue;let U=T[k]=T[k]||new Map;B.forEach(z=>{if(U.has(z))return;U.set(z,n.Started);let q=C(z);if(q){let W=this.opts.es5?t.varKinds.var:t.varKinds.const;F=(0,e._)(v||(v=je(["",""," "," = ",";",""])),F,W,z,q,this.opts._n)}else if(q=O==null?void 0:O(z))F=(0,e._)(w||(w=je(["","","",""])),F,q,this.opts._n);else throw new i(z);U.set(z,n.Completed)})}return F}};s(E,"ValueScope");var M=E;t.ValueScope=M}),on=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;var e=rT(),r=MW(),i=rT();Object.defineProperty(t,"_",{enumerable:!0,get:s(function(){return i._},"get")}),Object.defineProperty(t,"str",{enumerable:!0,get:s(function(){return i.str},"get")}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:s(function(){return i.strConcat},"get")}),Object.defineProperty(t,"nil",{enumerable:!0,get:s(function(){return i.nil},"get")}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:s(function(){return i.getProperty},"get")}),Object.defineProperty(t,"stringify",{enumerable:!0,get:s(function(){return i.stringify},"get")}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:s(function(){return i.regexpCode},"get")}),Object.defineProperty(t,"Name",{enumerable:!0,get:s(function(){return i.Name},"get")});var n=MW();Object.defineProperty(t,"Scope",{enumerable:!0,get:s(function(){return n.Scope},"get")}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:s(function(){return n.ValueScope},"get")}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:s(function(){return n.ValueScopeName},"get")}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:s(function(){return n.varKinds},"get")}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};var a=class{optimizeNodes(){return this}optimizeNames(Fe,Xe){return this}};s(a,"Node");var o=a,l=class extends o{constructor(Fe,Xe,ht){super(),this.varKind=Fe,this.name=Xe,this.rhs=ht}render({es5:Fe,_n:Xe}){let ht=Fe?r.varKinds.var:this.varKind,rr=this.rhs===void 0?"":" = ".concat(this.rhs);return"".concat(ht," ").concat(this.name).concat(rr,";")+Xe}optimizeNames(Fe,Xe){if(Fe[this.name.str])return this.rhs&&(this.rhs=dt(this.rhs,Fe,Xe)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}};s(l,"Def");var u=l,c=class extends o{constructor(Fe,Xe,ht){super(),this.lhs=Fe,this.rhs=Xe,this.sideEffects=ht}render({_n:Fe}){return"".concat(this.lhs," = ").concat(this.rhs,";")+Fe}optimizeNames(Fe,Xe){if(!(this.lhs instanceof e.Name&&!Fe[this.lhs.str]&&!this.sideEffects))return this.rhs=dt(this.rhs,Fe,Xe),this}get names(){let Fe=this.lhs instanceof e.Name?{}:Ee({},this.lhs.names);return Lt(Fe,this.rhs)}};s(c,"Assign");var p=c,m=class extends p{constructor(Fe,Xe,ht,rr){super(Fe,ht,rr),this.op=Xe}render({_n:Fe}){return"".concat(this.lhs," ").concat(this.op,"= ").concat(this.rhs,";")+Fe}};s(m,"AssignOp");var y=m,v=class extends o{constructor(Fe){super(),this.label=Fe,this.names={}}render({_n:Fe}){return"".concat(this.label,":")+Fe}};s(v,"Label");var w=v,E=class extends o{constructor(Fe){super(),this.label=Fe,this.names={}}render({_n:Fe}){let Xe=this.label?" ".concat(this.label):"";return"break".concat(Xe,";")+Fe}};s(E,"Break");var M=E,I=class extends o{constructor(Fe){super(),this.error=Fe}render({_n:Fe}){return"throw ".concat(this.error,";")+Fe}get names(){return this.error.names}};s(I,"Throw");var P=I,C=class extends o{constructor(Fe){super(),this.code=Fe}render({_n:Fe}){return"".concat(this.code,";")+Fe}optimizeNodes(){return"".concat(this.code)?this:void 0}optimizeNames(Fe,Xe){return this.code=dt(this.code,Fe,Xe),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}};s(C,"AnyCode");var T=C,O=class extends o{constructor(Fe=[]){super(),this.nodes=Fe}render(Fe){return this.nodes.reduce((Xe,ht)=>Xe+ht.render(Fe),"")}optimizeNodes(){let{nodes:Fe}=this,Xe=Fe.length;for(;Xe--;){let ht=Fe[Xe].optimizeNodes();Array.isArray(ht)?Fe.splice(Xe,1,...ht):ht?Fe[Xe]=ht:Fe.splice(Xe,1)}return Fe.length>0?this:void 0}optimizeNames(Fe,Xe){let{nodes:ht}=this,rr=ht.length;for(;rr--;){let ar=ht[rr];ar.optimizeNames(Fe,Xe)||(Me(Fe,ar.names),ht.splice(rr,1))}return ht.length>0?this:void 0}get names(){return this.nodes.reduce((Fe,Xe)=>at(Fe,Xe.names),{})}};s(O,"ParentNode");var F=O,k=class extends F{render(Fe){return"{"+Fe._n+super.render(Fe)+"}"+Fe._n}};s(k,"BlockNode");var B=k,U=class extends F{};s(U,"Root");var z=U,q=class extends B{};s(q,"Else");var W=q;W.kind="else";var J=class fC extends B{constructor(Fe,Xe){super(Xe),this.condition=Fe}render(Fe){let Xe="if(".concat(this.condition,")")+super.render(Fe);return this.else&&(Xe+="else "+this.else.render(Fe)),Xe}optimizeNodes(){super.optimizeNodes();let Fe=this.condition;if(Fe===!0)return this.nodes;let Xe=this.else;if(Xe){let ht=Xe.optimizeNodes();Xe=this.else=Array.isArray(ht)?new W(ht):ht}if(Xe)return Fe===!1?Xe instanceof fC?Xe:Xe.nodes:this.nodes.length?this:new fC(Ze(Fe),Xe instanceof fC?[Xe]:Xe.nodes);if(!(Fe===!1||!this.nodes.length))return this}optimizeNames(Fe,Xe){var ht;if(this.else=(ht=this.else)===null||ht===void 0?void 0:ht.optimizeNames(Fe,Xe),!!(super.optimizeNames(Fe,Xe)||this.else))return this.condition=dt(this.condition,Fe,Xe),this}get names(){let Fe=super.names;return Lt(Fe,this.condition),this.else&&at(Fe,this.else.names),Fe}};s(J,"If");var V=J;V.kind="if";var oe=class extends B{};s(oe,"For");var Y=oe;Y.kind="for";var he=class extends Y{constructor(Fe){super(),this.iteration=Fe}render(Fe){return"for(".concat(this.iteration,")")+super.render(Fe)}optimizeNames(Fe,Xe){if(super.optimizeNames(Fe,Xe))return this.iteration=dt(this.iteration,Fe,Xe),this}get names(){return at(super.names,this.iteration.names)}};s(he,"ForLoop");var Q=he,ae=class extends Y{constructor(Fe,Xe,ht,rr){super(),this.varKind=Fe,this.name=Xe,this.from=ht,this.to=rr}render(Fe){let Xe=Fe.es5?r.varKinds.var:this.varKind,{name:ht,from:rr,to:ar}=this;return"for(".concat(Xe," ").concat(ht,"=").concat(rr,"; ").concat(ht,"<").concat(ar,"; ").concat(ht,"++)")+super.render(Fe)}get names(){let Fe=Lt(super.names,this.from);return Lt(Fe,this.to)}};s(ae,"ForRange");var ee=ae,le=class extends Y{constructor(Fe,Xe,ht,rr){super(),this.loop=Fe,this.varKind=Xe,this.name=ht,this.iterable=rr}render(Fe){return"for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+super.render(Fe)}optimizeNames(Fe,Xe){if(super.optimizeNames(Fe,Xe))return this.iterable=dt(this.iterable,Fe,Xe),this}get names(){return at(super.names,this.iterable.names)}};s(le,"ForIter");var K=le,ce=class extends B{constructor(Fe,Xe,ht){super(),this.name=Fe,this.args=Xe,this.async=ht}render(Fe){let Xe=this.async?"async ":"";return"".concat(Xe,"function ").concat(this.name,"(").concat(this.args,")")+super.render(Fe)}};s(ce,"Func");var te=ce;te.kind="func";var ne=class extends F{render(Fe){return"return "+super.render(Fe)}};s(ne,"Return");var pe=ne;pe.kind="return";var xe=class extends B{render(Fe){let Xe="try"+super.render(Fe);return this.catch&&(Xe+=this.catch.render(Fe)),this.finally&&(Xe+=this.finally.render(Fe)),Xe}optimizeNodes(){var Fe,Xe;return super.optimizeNodes(),(Fe=this.catch)===null||Fe===void 0||Fe.optimizeNodes(),(Xe=this.finally)===null||Xe===void 0||Xe.optimizeNodes(),this}optimizeNames(Fe,Xe){var ht,rr;return super.optimizeNames(Fe,Xe),(ht=this.catch)===null||ht===void 0||ht.optimizeNames(Fe,Xe),(rr=this.finally)===null||rr===void 0||rr.optimizeNames(Fe,Xe),this}get names(){let Fe=super.names;return this.catch&&at(Fe,this.catch.names),this.finally&&at(Fe,this.finally.names),Fe}};s(xe,"Try");var Te=xe,fe=class extends B{constructor(Fe){super(),this.error=Fe}render(Fe){return"catch(".concat(this.error,")")+super.render(Fe)}};s(fe,"Catch");var Pe=fe;Pe.kind="catch";var me=class extends B{render(Fe){return"finally"+super.render(Fe)}};s(me,"Finally");var Ae=me;Ae.kind="finally";var Ue,_e,lt,tt=class{constructor(Fe,Xe={}){this._values={},this._blockStarts=[],this._constants={},this.opts=vt(Ee({},Xe),{_n:Xe.lines?`
`:""}),this._extScope=Fe,this._scope=new r.Scope({parent:Fe}),this._nodes=[new z]}toString(){return this._root.render(this.opts)}name(Fe){return this._scope.name(Fe)}scopeName(Fe){return this._extScope.name(Fe)}scopeValue(Fe,Xe){let ht=this._extScope.value(Fe,Xe);return(this._values[ht.prefix]||(this._values[ht.prefix]=new Set)).add(ht),ht}getScopeValue(Fe,Xe){return this._extScope.getValue(Fe,Xe)}scopeRefs(Fe){return this._extScope.scopeRefs(Fe,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Fe,Xe,ht,rr){let ar=this._scope.toName(Xe);return ht!==void 0&&rr&&(this._constants[ar.str]=ht),this._leafNode(new u(Fe,ar,ht)),ar}const(Fe,Xe,ht){return this._def(r.varKinds.const,Fe,Xe,ht)}let(Fe,Xe,ht){return this._def(r.varKinds.let,Fe,Xe,ht)}var(Fe,Xe,ht){return this._def(r.varKinds.var,Fe,Xe,ht)}assign(Fe,Xe,ht){return this._leafNode(new p(Fe,Xe,ht))}add(Fe,Xe){return this._leafNode(new y(Fe,t.operators.ADD,Xe))}code(Fe){return typeof Fe=="function"?Fe():Fe!==e.nil&&this._leafNode(new T(Fe)),this}object(...Fe){let Xe=["{"];for(let[ht,rr]of Fe)Xe.length>1&&Xe.push(","),Xe.push(ht),(ht!==rr||this.opts.es5)&&(Xe.push(":"),(0,e.addCodeArg)(Xe,rr));return Xe.push("}"),new e._Code(Xe)}if(Fe,Xe,ht){if(this._blockNode(new V(Fe)),Xe&&ht)this.code(Xe).else().code(ht).endIf();else if(Xe)this.code(Xe).endIf();else if(ht)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(Fe){return this._elseNode(new V(Fe))}else(){return this._elseNode(new W)}endIf(){return this._endBlockNode(V,W)}_for(Fe,Xe){return this._blockNode(Fe),Xe&&this.code(Xe).endFor(),this}for(Fe,Xe){return this._for(new Q(Fe),Xe)}forRange(Fe,Xe,ht,rr,ar=this.opts.es5?r.varKinds.var:r.varKinds.let){let Vr=this._scope.toName(Fe);return this._for(new ee(ar,Vr,Xe,ht),()=>rr(Vr))}forOf(Fe,Xe,ht,rr=r.varKinds.const){let ar=this._scope.toName(Fe);if(this.opts.es5){let Vr=Xe instanceof e.Name?Xe:this.var("_arr",Xe);return this.forRange("_i",0,(0,e._)(Ue||(Ue=je(["",".length"])),Vr),Qe=>{this.var(ar,(0,e._)(_e||(_e=je(["","[","]"])),Vr,Qe)),ht(ar)})}return this._for(new K("of",rr,ar,Xe),()=>ht(ar))}forIn(Fe,Xe,ht,rr=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(Fe,(0,e._)(lt||(lt=je(["Object.keys(",")"])),Xe),ht);let ar=this._scope.toName(Fe);return this._for(new K("in",rr,ar,Xe),()=>ht(ar))}endFor(){return this._endBlockNode(Y)}label(Fe){return this._leafNode(new w(Fe))}break(Fe){return this._leafNode(new M(Fe))}return(Fe){let Xe=new pe;if(this._blockNode(Xe),this.code(Fe),Xe.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(pe)}try(Fe,Xe,ht){if(!Xe&&!ht)throw new Error('CodeGen: "try" without "catch" and "finally"');let rr=new Te;if(this._blockNode(rr),this.code(Fe),Xe){let ar=this.name("e");this._currNode=rr.catch=new Pe(ar),Xe(ar)}return ht&&(this._currNode=rr.finally=new Ae,this.code(ht)),this._endBlockNode(Pe,Ae)}throw(Fe){return this._leafNode(new P(Fe))}block(Fe,Xe){return this._blockStarts.push(this._nodes.length),Fe&&this.code(Fe).endBlock(Xe),this}endBlock(Fe){let Xe=this._blockStarts.pop();if(Xe===void 0)throw new Error("CodeGen: not in self-balancing block");let ht=this._nodes.length-Xe;if(ht<0||Fe!==void 0&&ht!==Fe)throw new Error("CodeGen: wrong number of nodes: ".concat(ht," vs ").concat(Fe," expected"));return this._nodes.length=Xe,this}func(Fe,Xe=e.nil,ht,rr){return this._blockNode(new te(Fe,Xe,ht)),rr&&this.code(rr).endFunc(),this}endFunc(){return this._endBlockNode(te)}optimize(Fe=1){for(;Fe-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Fe){return this._currNode.nodes.push(Fe),this}_blockNode(Fe){this._currNode.nodes.push(Fe),this._nodes.push(Fe)}_endBlockNode(Fe,Xe){let ht=this._currNode;if(ht instanceof Fe||Xe&&ht instanceof Xe)return this._nodes.pop(),this;throw new Error('CodeGen: not in block "'.concat(Xe?"".concat(Fe.kind,"/").concat(Xe.kind):Fe.kind,'"'))}_elseNode(Fe){let Xe=this._currNode;if(!(Xe instanceof V))throw new Error('CodeGen: "else" without "if"');return this._currNode=Xe.else=Fe,this}get _root(){return this._nodes[0]}get _currNode(){let Fe=this._nodes;return Fe[Fe.length-1]}set _currNode(Fe){let Xe=this._nodes;Xe[Xe.length-1]=Fe}};s(tt,"CodeGen");var We=tt;t.CodeGen=We;function at(Nt,Fe){for(let Xe in Fe)Nt[Xe]=(Nt[Xe]||0)+(Fe[Xe]||0);return Nt}s(at,"addNames");function Lt(Nt,Fe){return Fe instanceof e._CodeOrName?at(Nt,Fe.names):Nt}s(Lt,"addExprNames");function dt(Nt,Fe,Xe){if(Nt instanceof e.Name)return ht(Nt);if(!rr(Nt))return Nt;return new e._Code(Nt._items.reduce((ar,Vr)=>(Vr instanceof e.Name&&(Vr=ht(Vr)),Vr instanceof e._Code?ar.push(...Vr._items):ar.push(Vr),ar),[]));function ht(ar){let Vr=Xe[ar.str];return Vr===void 0||Fe[ar.str]!==1?ar:(delete Fe[ar.str],Vr)}function rr(ar){return ar instanceof e._Code&&ar._items.some(Vr=>Vr instanceof e.Name&&Fe[Vr.str]===1&&Xe[Vr.str]!==void 0)}}s(dt,"optimizeExpr");function Me(Nt,Fe){for(let Xe in Fe)Nt[Xe]=(Nt[Xe]||0)-(Fe[Xe]||0)}s(Me,"subtractNames");var ve;function Ze(Nt){return typeof Nt=="boolean"||typeof Nt=="number"||Nt===null?!Nt:(0,e._)(ve||(ve=je(["!",""])),jt(Nt))}s(Ze,"not"),t.not=Ze;var It=Kt(t.operators.AND);function Rt(...Nt){return Nt.reduce(It)}s(Rt,"and"),t.and=Rt;var Et=Kt(t.operators.OR);function pt(...Nt){return Nt.reduce(Et)}s(pt,"or"),t.or=pt;var Yt;function Kt(Nt){return(Fe,Xe)=>Fe===e.nil?Xe:Xe===e.nil?Fe:(0,e._)(Yt||(Yt=je([""," "," ",""])),jt(Fe),Nt,jt(Xe))}s(Kt,"mappend");var $t;function jt(Nt){return Nt instanceof e.Name?Nt:(0,e._)($t||($t=je(["(",")"])),Nt)}s(jt,"par")}),Bn=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;var e=on(),r=rT();function i(te){let ne={};for(let pe of te)ne[pe]=!0;return ne}s(i,"toHash"),t.toHash=i;function n(te,ne){return typeof ne=="boolean"?ne:Object.keys(ne).length===0?!0:(a(te,ne),!o(ne,te.self.RULES.all))}s(n,"alwaysValidSchema"),t.alwaysValidSchema=n;function a(te,ne=te.schema){let{opts:pe,self:xe}=te;if(!pe.strictSchema||typeof ne=="boolean")return;let Te=xe.RULES.keywords;for(let fe in ne)Te[fe]||ce(te,'unknown keyword: "'.concat(fe,'"'))}s(a,"checkUnknownRules"),t.checkUnknownRules=a;function o(te,ne){if(typeof te=="boolean")return!te;for(let pe in te)if(ne[pe])return!0;return!1}s(o,"schemaHasRules"),t.schemaHasRules=o;function l(te,ne){if(typeof te=="boolean")return!te;for(let pe in te)if(pe!=="$ref"&&ne.all[pe])return!0;return!1}s(l,"schemaHasRulesButRef"),t.schemaHasRulesButRef=l;var u,c;function p({topSchemaRef:te,schemaPath:ne},pe,xe,Te){if(!Te){if(typeof pe=="number"||typeof pe=="boolean")return pe;if(typeof pe=="string")return(0,e._)(u||(u=je(["",""])),pe)}return(0,e._)(c||(c=je(["","","",""])),te,ne,(0,e.getProperty)(xe))}s(p,"schemaRefOrVal"),t.schemaRefOrVal=p;function m(te){return w(decodeURIComponent(te))}s(m,"unescapeFragment"),t.unescapeFragment=m;function y(te){return encodeURIComponent(v(te))}s(y,"escapeFragment"),t.escapeFragment=y;function v(te){return typeof te=="number"?"".concat(te):te.replace(/~/g,"~0").replace(/\//g,"~1")}s(v,"escapeJsonPointer"),t.escapeJsonPointer=v;function w(te){return te.replace(/~1/g,"/").replace(/~0/g,"~")}s(w,"unescapeJsonPointer"),t.unescapeJsonPointer=w;function E(te,ne){if(Array.isArray(te))for(let pe of te)ne(pe);else ne(te)}s(E,"eachItem"),t.eachItem=E;function M({mergeNames:te,mergeToName:ne,mergeValues:pe,resultToName:xe}){return(Te,fe,Pe,me)=>{let Ae=Pe===void 0?fe:Pe instanceof e.Name?(fe instanceof e.Name?te(Te,fe,Pe):ne(Te,fe,Pe),Pe):fe instanceof e.Name?(ne(Te,Pe,fe),fe):pe(fe,Pe);return me===e.Name&&!(Ae instanceof e.Name)?xe(Te,Ae):Ae}}s(M,"makeMergeEvaluated");var I,P,C,T,O,F,k,B,U,z;t.mergeEvaluated={props:M({mergeNames:s((te,ne,pe)=>te.if((0,e._)(I||(I=je([""," !== true && "," !== undefined"])),pe,ne),()=>{te.if((0,e._)(P||(P=je([""," === true"])),ne),()=>te.assign(pe,!0),()=>te.assign(pe,(0,e._)(C||(C=je([""," || {}"])),pe)).code((0,e._)(T||(T=je(["Object.assign(",", ",")"])),pe,ne)))}),"mergeNames"),mergeToName:s((te,ne,pe)=>te.if((0,e._)(O||(O=je([""," !== true"])),pe),()=>{ne===!0?te.assign(pe,!0):(te.assign(pe,(0,e._)(F||(F=je([""," || {}"])),pe)),V(te,pe,ne))}),"mergeToName"),mergeValues:s((te,ne)=>te===!0?!0:Ee(Ee({},te),ne),"mergeValues"),resultToName:W}),items:M({mergeNames:s((te,ne,pe)=>te.if((0,e._)(k||(k=je([""," !== true && "," !== undefined"])),pe,ne),()=>te.assign(pe,(0,e._)(B||(B=je([""," === true ? true : "," > "," ? "," : ",""])),ne,pe,ne,pe,ne))),"mergeNames"),mergeToName:s((te,ne,pe)=>te.if((0,e._)(U||(U=je([""," !== true"])),pe),()=>te.assign(pe,ne===!0?!0:(0,e._)(z||(z=je([""," > "," ? "," : ",""])),pe,ne,pe,ne))),"mergeToName"),mergeValues:s((te,ne)=>te===!0?!0:Math.max(te,ne),"mergeValues"),resultToName:s((te,ne)=>te.var("items",ne),"resultToName")})};var q;function W(te,ne){if(ne===!0)return te.var("props",!0);let pe=te.var("props",(0,e._)(q||(q=je(["{}"]))));return ne!==void 0&&V(te,pe,ne),pe}s(W,"evaluatedPropsToName"),t.evaluatedPropsToName=W;var J;function V(te,ne,pe){Object.keys(pe).forEach(xe=>te.assign((0,e._)(J||(J=je(["","",""])),ne,(0,e.getProperty)(xe)),!0))}s(V,"setEvaluated"),t.setEvaluated=V;var oe={};function Y(te,ne){return te.scopeValue("func",{ref:ne,code:oe[ne.code]||(oe[ne.code]=new r._Code(ne.code))})}s(Y,"useFunc"),t.useFunc=Y;var he;(function(te){te[te.Num=0]="Num",te[te.Str=1]="Str"})(he||(t.Type=he={}));var Q,ae,ee,le;function K(te,ne,pe){if(te instanceof e.Name){let xe=ne===he.Num;return pe?xe?(0,e._)(Q||(Q=je(['"[" + ',' + "]"'])),te):(0,e._)(ae||(ae=je([`"['" + `,` + "']"`])),te):xe?(0,e._)(ee||(ee=je(['"/" + ',""])),te):(0,e._)(le||(le=je(['"/" + ','.replace(/~/g, "~0").replace(/\\//g, "~1")'],['"/" + ','.replace(/~/g, "~0").replace(/\\\\//g, "~1")'])),te)}return pe?(0,e.getProperty)(te).toString():"/"+v(te)}s(K,"getErrorPath"),t.getErrorPath=K;function ce(te,ne,pe=te.opts.strictSchema){if(pe){if(ne="strict mode: ".concat(ne),pe===!0)throw new Error(ne);te.self.logger.warn(ne)}}s(ce,"checkStrictMode"),t.checkStrictMode=ce}),cg=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};t.default=r}),$P=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;var e=on(),r=Bn(),i=cg(),n;t.keywordError={message:s(({keyword:ne})=>(0,e.str)(n||(n=je(['must pass "','" keyword validation'])),ne),"message")};var a,o;t.keyword$DataError={message:s(({keyword:ne,schemaType:pe})=>pe?(0,e.str)(a||(a=je(['"','" keyword must be '," ($data)"])),ne,pe):(0,e.str)(o||(o=je(['"','" keyword is invalid ($data)'])),ne),"message")};var l;function u(ne,pe=t.keywordError,xe,Te){let{it:fe}=ne,{gen:Pe,compositeRule:me,allErrors:Ae}=fe,Ue=oe(ne,pe,xe);Te??(me||Ae)?U(Pe,Ue):W(fe,(0,e._)(l||(l=je(["[","]"])),Ue))}s(u,"reportError"),t.reportError=u;function c(ne,pe=t.keywordError,xe){let{it:Te}=ne,{gen:fe,compositeRule:Pe,allErrors:me}=Te,Ae=oe(ne,pe,xe);U(fe,Ae),Pe||me||W(Te,i.default.vErrors)}s(c,"reportExtraError"),t.reportExtraError=c;var p,m;function y(ne,pe){ne.assign(i.default.errors,pe),ne.if((0,e._)(p||(p=je([""," !== null"])),i.default.vErrors),()=>ne.if(pe,()=>ne.assign((0,e._)(m||(m=je(["",".length"])),i.default.vErrors),pe),()=>ne.assign(i.default.vErrors,null)))}s(y,"resetErrorsCount"),t.resetErrorsCount=y;var v,w,E,M,I,P,C;function T({gen:ne,keyword:pe,schemaValue:xe,data:Te,errsCount:fe,it:Pe}){if(fe===void 0)throw new Error("ajv implementation error");let me=ne.name("err");ne.forRange("i",fe,i.default.errors,Ae=>{ne.const(me,(0,e._)(v||(v=je(["","[","]"])),i.default.vErrors,Ae)),ne.if((0,e._)(w||(w=je(["",".instancePath === undefined"])),me),()=>ne.assign((0,e._)(E||(E=je(["",".instancePath"])),me),(0,e.strConcat)(i.default.instancePath,Pe.errorPath))),ne.assign((0,e._)(M||(M=je(["",".schemaPath"])),me),(0,e.str)(I||(I=je(["","/",""])),Pe.errSchemaPath,pe)),Pe.opts.verbose&&(ne.assign((0,e._)(P||(P=je(["",".schema"])),me),xe),ne.assign((0,e._)(C||(C=je(["",".data"])),me),Te))})}s(T,"extendErrors"),t.extendErrors=T;var O,F,k,B;function U(ne,pe){let xe=ne.const("err",pe);ne.if((0,e._)(O||(O=je([""," === null"])),i.default.vErrors),()=>ne.assign(i.default.vErrors,(0,e._)(F||(F=je(["[","]"])),xe)),(0,e._)(k||(k=je(["",".push(",")"])),i.default.vErrors,xe)),ne.code((0,e._)(B||(B=je(["","++"])),i.default.errors))}s(U,"addError");var z,q;function W(ne,pe){let{gen:xe,validateName:Te,schemaEnv:fe}=ne;fe.$async?xe.throw((0,e._)(z||(z=je(["new ","(",")"])),ne.ValidationError,pe)):(xe.assign((0,e._)(q||(q=je(["",".errors"])),Te),pe),xe.return(!1))}s(W,"returnErrors");var J={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")},V;function oe(ne,pe,xe){let{createErrors:Te}=ne.it;return Te===!1?(0,e._)(V||(V=je(["{}"]))):Y(ne,pe,xe)}s(oe,"errorObjectCode");function Y(ne,pe,xe={}){let{gen:Te,it:fe}=ne,Pe=[Q(fe,xe),le(ne,xe)];return te(ne,pe,Pe),Te.object(...Pe)}s(Y,"errorObject");var he;function Q({errorPath:ne},{instancePath:pe}){let xe=pe?(0,e.str)(he||(he=je(["","",""])),ne,(0,r.getErrorPath)(pe,r.Type.Str)):ne;return[i.default.instancePath,(0,e.strConcat)(i.default.instancePath,xe)]}s(Q,"errorInstancePath");var ae,ee;function le({keyword:ne,it:{errSchemaPath:pe}},{schemaPath:xe,parentSchema:Te}){let fe=Te?pe:(0,e.str)(ae||(ae=je(["","/",""])),pe,ne);return xe&&(fe=(0,e.str)(ee||(ee=je(["","",""])),fe,(0,r.getErrorPath)(xe,r.Type.Str))),[J.schemaPath,fe]}s(le,"errorSchemaPath");var K,ce;function te(ne,{params:pe,message:xe},Te){let{keyword:fe,data:Pe,schemaValue:me,it:Ae}=ne,{opts:Ue,propertyName:_e,topSchemaRef:lt,schemaPath:tt}=Ae;Te.push([J.keyword,fe],[J.params,typeof pe=="function"?pe(ne):pe||(0,e._)(K||(K=je(["{}"])))]),Ue.messages&&Te.push([J.message,typeof xe=="function"?xe(ne):xe]),Ue.verbose&&Te.push([J.schema,me],[J.parentSchema,(0,e._)(ce||(ce=je(["","",""])),lt,tt)],[i.default.data,Pe]),_e&&Te.push([J.propertyName,_e])}s(te,"extraErrorProps")}),_qe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;var e=$P(),r=on(),i=cg(),n={message:"boolean schema is false"},a;function o(c){let{gen:p,schema:m,validateName:y}=c;m===!1?u(c,!1):typeof m=="object"&&m.$async===!0?p.return(i.default.data):(p.assign((0,r._)(a||(a=je(["",".errors"])),y),null),p.return(!0))}s(o,"topBoolOrEmptySchema"),t.topBoolOrEmptySchema=o;function l(c,p){let{gen:m,schema:y}=c;y===!1?(m.var(p,!1),u(c)):m.var(p,!0)}s(l,"boolOrEmptySchema"),t.boolOrEmptySchema=l;function u(c,p){let{gen:m,data:y}=c,v={gen:m,keyword:"false schema",data:y,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:c};(0,e.reportError)(v,n,void 0,p)}s(u,"falseSchemaError")}),iye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;var e=["string","number","integer","boolean","null","object","array"],r=new Set(e);function i(a){return typeof a=="string"&&r.has(a)}s(i,"isJSONType"),t.isJSONType=i;function n(){let a={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:vt(Ee({},a),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},a.number,a.string,a.array,a.object],post:{rules:[]},all:{},keywords:{}}}s(n,"getRules"),t.getRules=n}),nye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0;function e({schema:n,self:a},o){let l=a.RULES.types[o];return l&&l!==!0&&r(n,l)}s(e,"schemaHasRulesForType"),t.schemaHasRulesForType=e;function r(n,a){return a.rules.some(o=>i(n,o))}s(r,"shouldUseGroup"),t.shouldUseGroup=r;function i(n,a){var o;return n[a.keyword]!==void 0||((o=a.definition.implements)===null||o===void 0?void 0:o.some(l=>n[l]!==void 0))}s(i,"shouldUseRule"),t.shouldUseRule=i}),iT=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;var e=iye(),r=nye(),i=$P(),n=on(),a=Bn(),o;(function(tt){tt[tt.Correct=0]="Correct",tt[tt.Wrong=1]="Wrong"})(o||(t.DataType=o={}));function l(tt){let We=u(tt.type);if(We.includes("null")){if(tt.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!We.length&&tt.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');tt.nullable===!0&&We.push("null")}return We}s(l,"getSchemaTypes"),t.getSchemaTypes=l;function u(tt){let We=Array.isArray(tt)?tt:tt?[tt]:[];if(We.every(e.isJSONType))return We;throw new Error("type must be JSONType or JSONType[]: "+We.join(","))}s(u,"getJSONTypes"),t.getJSONTypes=u;function c(tt,We){let{gen:at,data:Lt,opts:dt}=tt,Me=m(We,dt.coerceTypes),ve=We.length>0&&!(Me.length===0&&We.length===1&&(0,r.schemaHasRulesForType)(tt,We[0]));if(ve){let Ze=Pe(We,Lt,dt.strictNumbers,o.Wrong);at.if(Ze,()=>{Me.length?Y(tt,We,Me):_e(tt)})}return ve}s(c,"coerceAndCheckDataType"),t.coerceAndCheckDataType=c;var p=new Set(["string","number","integer","boolean","null"]);function m(tt,We){return We?tt.filter(at=>p.has(at)||We==="array"&&at==="array"):[]}s(m,"coerceToTypes");var y,v,w,E,M,I,P,C,T,O,F,k,B,U,z,q,W,J,V,oe;function Y(tt,We,at){let{gen:Lt,data:dt,opts:Me}=tt,ve=Lt.let("dataType",(0,n._)(y||(y=je(["typeof ",""])),dt)),Ze=Lt.let("coerced",(0,n._)(v||(v=je(["undefined"]))));Me.coerceTypes==="array"&&Lt.if((0,n._)(w||(w=je([""," == 'object' && Array.isArray(",") && ",".length == 1"])),ve,dt,dt),()=>Lt.assign(dt,(0,n._)(E||(E=je(["","[0]"])),dt)).assign(ve,(0,n._)(M||(M=je(["typeof ",""])),dt)).if(Pe(We,dt,Me.strictNumbers),()=>Lt.assign(Ze,dt))),Lt.if((0,n._)(I||(I=je([""," !== undefined"])),Ze));for(let Rt of at)(p.has(Rt)||Rt==="array"&&Me.coerceTypes==="array")&&It(Rt);Lt.else(),_e(tt),Lt.endIf(),Lt.if((0,n._)(P||(P=je([""," !== undefined"])),Ze),()=>{Lt.assign(dt,Ze),ae(tt,Ze)});function It(Rt){switch(Rt){case"string":Lt.elseIf((0,n._)(C||(C=je(["",' == "number" || ',' == "boolean"'])),ve,ve)).assign(Ze,(0,n._)(T||(T=je(['"" + ',""])),dt)).elseIf((0,n._)(O||(O=je([""," === null"])),dt)).assign(Ze,(0,n._)(F||(F=je(['""']))));return;case"number":Lt.elseIf((0,n._)(k||(k=je(["",' == "boolean" || ',` === null
              || (`,' == "string" && '," && "," == +",")"])),ve,dt,ve,dt,dt,dt)).assign(Ze,(0,n._)(B||(B=je(["+",""])),dt));return;case"integer":Lt.elseIf((0,n._)(U||(U=je(["",' === "boolean" || ',` === null
              || (`,' === "string" && '," && "," == +"," && !("," % 1))"])),ve,dt,ve,dt,dt,dt,dt)).assign(Ze,(0,n._)(z||(z=je(["+",""])),dt));return;case"boolean":Lt.elseIf((0,n._)(q||(q=je(["",' === "false" || '," === 0 || "," === null"])),dt,dt,dt)).assign(Ze,!1).elseIf((0,n._)(W||(W=je(["",' === "true" || '," === 1"])),dt,dt)).assign(Ze,!0);return;case"null":Lt.elseIf((0,n._)(J||(J=je(["",' === "" || '," === 0 || "," === false"])),dt,dt,dt)),Lt.assign(Ze,null);return;case"array":Lt.elseIf((0,n._)(V||(V=je(["",' === "string" || ',` === "number"
              || `,' === "boolean" || '," === null"])),ve,ve,ve,dt)).assign(Ze,(0,n._)(oe||(oe=je(["[","]"])),dt))}}s(It,"coerceSpecificType")}s(Y,"coerceData");var he,Q;function ae({gen:tt,parentData:We,parentDataProperty:at},Lt){tt.if((0,n._)(he||(he=je([""," !== undefined"])),We),()=>tt.assign((0,n._)(Q||(Q=je(["","[","]"])),We,at),Lt))}s(ae,"assignParentData");var ee,le,K,ce,te,ne,pe;function xe(tt,We,at,Lt=o.Correct){let dt=Lt===o.Correct?n.operators.EQ:n.operators.NEQ,Me;switch(tt){case"null":return(0,n._)(ee||(ee=je([""," "," null"])),We,dt);case"array":Me=(0,n._)(le||(le=je(["Array.isArray(",")"])),We);break;case"object":Me=(0,n._)(K||(K=je([""," && typeof ",' == "object" && !Array.isArray(',")"])),We,We,We);break;case"integer":Me=ve((0,n._)(ce||(ce=je(["!("," % 1) && !isNaN(",")"])),We,We));break;case"number":Me=ve();break;default:return(0,n._)(te||(te=je(["typeof "," "," ",""])),We,dt,tt)}return Lt===o.Correct?Me:(0,n.not)(Me);function ve(Ze=n.nil){return(0,n.and)((0,n._)(ne||(ne=je(["typeof ",' == "number"'])),We),Ze,at?(0,n._)(pe||(pe=je(["isFinite(",")"])),We):n.nil)}}s(xe,"checkDataType"),t.checkDataType=xe;var Te,fe;function Pe(tt,We,at,Lt){if(tt.length===1)return xe(tt[0],We,at,Lt);let dt,Me=(0,a.toHash)(tt);if(Me.array&&Me.object){let ve=(0,n._)(Te||(Te=je(["typeof ",' != "object"'])),We);dt=Me.null?ve:(0,n._)(fe||(fe=je(["!"," || ",""])),We,ve),delete Me.null,delete Me.array,delete Me.object}else dt=n.nil;Me.number&&delete Me.integer;for(let ve in Me)dt=(0,n.and)(dt,xe(ve,We,at,Lt));return dt}s(Pe,"checkDataTypes"),t.checkDataTypes=Pe;var me,Ae,Ue={message:s(({schema:tt})=>"must be ".concat(tt),"message"),params:s(({schema:tt,schemaValue:We})=>typeof tt=="string"?(0,n._)(me||(me=je(["{type: ","}"])),tt):(0,n._)(Ae||(Ae=je(["{type: ","}"])),We),"params")};function _e(tt){let We=lt(tt);(0,i.reportError)(We,Ue)}s(_e,"reportTypeError"),t.reportTypeError=_e;function lt(tt){let{gen:We,data:at,schema:Lt}=tt,dt=(0,a.schemaRefOrVal)(tt,Lt,"type");return{gen:We,keyword:"type",data:at,schema:Lt.type,schemaCode:dt,schemaValue:dt,parentSchema:Lt,params:{},it:tt}}s(lt,"getTypeErrorContext")}),xqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;var e=on(),r=Bn();function i(c,p){let{properties:m,items:y}=c.schema;if(p==="object"&&m)for(let v in m)u(c,v,m[v].default);else p==="array"&&Array.isArray(y)&&y.forEach((v,w)=>u(c,w,v.default))}s(i,"assignDefaults"),t.assignDefaults=i;var n,a,o,l;function u(c,p,m){let{gen:y,compositeRule:v,data:w,opts:E}=c;if(m===void 0)return;let M=(0,e._)(n||(n=je(["","",""])),w,(0,e.getProperty)(p));if(v){(0,r.checkStrictMode)(c,"default is ignored for: ".concat(M));return}let I=(0,e._)(a||(a=je([""," === undefined"])),M);E.useDefaults==="empty"&&(I=(0,e._)(o||(o=je([""," || "," === null || ",' === ""'])),I,M,M)),y.if(I,(0,e._)(l||(l=je([""," = ",""])),M,(0,e.stringify)(m)))}s(u,"assignDefault")}),Kh=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;var e=on(),r=Bn(),i=cg(),n=Bn(),a;function o(Q,ae){let{gen:ee,data:le,it:K}=Q;ee.if(P(ee,le,ae,K.opts.ownProperties),()=>{Q.setParams({missingProperty:(0,e._)(a||(a=je(["",""])),ae)},!0),Q.error()})}s(o,"checkReportMissingProp"),t.checkReportMissingProp=o;var l;function u({gen:Q,data:ae,it:{opts:ee}},le,K){return(0,e.or)(...le.map(ce=>(0,e.and)(P(Q,ae,ce,ee.ownProperties),(0,e._)(l||(l=je([""," = ",""])),K,ce))))}s(u,"checkMissingProp"),t.checkMissingProp=u;function c(Q,ae){Q.setParams({missingProperty:ae},!0),Q.error()}s(c,"reportMissingProp"),t.reportMissingProp=c;var p;function m(Q){return Q.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,e._)(p||(p=je(["Object.prototype.hasOwnProperty"])))})}s(m,"hasPropFunc"),t.hasPropFunc=m;var y;function v(Q,ae,ee){return(0,e._)(y||(y=je(["",".call(",", ",")"])),m(Q),ae,ee)}s(v,"isOwnProperty"),t.isOwnProperty=v;var w,E;function M(Q,ae,ee,le){let K=(0,e._)(w||(w=je(["",""," !== undefined"])),ae,(0,e.getProperty)(ee));return le?(0,e._)(E||(E=je([""," && ",""])),K,v(Q,ae,ee)):K}s(M,"propertyInData"),t.propertyInData=M;var I;function P(Q,ae,ee,le){let K=(0,e._)(I||(I=je(["",""," === undefined"])),ae,(0,e.getProperty)(ee));return le?(0,e.or)(K,(0,e.not)(v(Q,ae,ee))):K}s(P,"noPropertyInData"),t.noPropertyInData=P;function C(Q){return Q?Object.keys(Q).filter(ae=>ae!=="__proto__"):[]}s(C,"allSchemaProperties"),t.allSchemaProperties=C;function T(Q,ae){return C(ae).filter(ee=>!(0,r.alwaysValidSchema)(Q,ae[ee]))}s(T,"schemaProperties"),t.schemaProperties=T;var O,F,k,B;function U({schemaCode:Q,data:ae,it:{gen:ee,topSchemaRef:le,schemaPath:K,errorPath:ce},it:te},ne,pe,xe){let Te=xe?(0,e._)(O||(O=je(["",", ",", ","",""])),Q,ae,le,K):ae,fe=[[i.default.instancePath,(0,e.strConcat)(i.default.instancePath,ce)],[i.default.parentData,te.parentData],[i.default.parentDataProperty,te.parentDataProperty],[i.default.rootData,i.default.rootData]];te.opts.dynamicRef&&fe.push([i.default.dynamicAnchors,i.default.dynamicAnchors]);let Pe=(0,e._)(F||(F=je(["",", ",""])),Te,ee.object(...fe));return pe!==e.nil?(0,e._)(k||(k=je(["",".call(",", ",")"])),ne,pe,Pe):(0,e._)(B||(B=je(["","(",")"])),ne,Pe)}s(U,"callValidateCode"),t.callValidateCode=U;var z,q=(0,e._)(z||(z=je(["new RegExp"]))),W;function J({gen:Q,it:{opts:ae}},ee){let le=ae.unicodeRegExp?"u":"",{regExp:K}=ae.code,ce=K(ee,le);return Q.scopeValue("pattern",{key:ce.toString(),ref:ce,code:(0,e._)(W||(W=je(["","(",", ",")"])),K.code==="new RegExp"?q:(0,n.useFunc)(Q,K),ee,le)})}s(J,"usePattern"),t.usePattern=J;var V;function oe(Q){let{gen:ae,data:ee,keyword:le,it:K}=Q,ce=ae.name("valid");if(K.allErrors){let ne=ae.let("valid",!0);return te(()=>ae.assign(ne,!1)),ne}return ae.var(ce,!0),te(()=>ae.break()),ce;function te(ne){let pe=ae.const("len",(0,e._)(V||(V=je(["",".length"])),ee));ae.forRange("i",0,pe,xe=>{Q.subschema({keyword:le,dataProp:xe,dataPropType:r.Type.Num},ce),ae.if((0,e.not)(ce),ne)})}}s(oe,"validateArray"),t.validateArray=oe;var Y;function he(Q){let{gen:ae,schema:ee,keyword:le,it:K}=Q;if(!Array.isArray(ee))throw new Error("ajv implementation error");if(ee.some(ne=>(0,r.alwaysValidSchema)(K,ne))&&!K.opts.unevaluated)return;let ce=ae.let("valid",!1),te=ae.name("_valid");ae.block(()=>ee.forEach((ne,pe)=>{let xe=Q.subschema({keyword:le,schemaProp:pe,compositeRule:!0},te);ae.assign(ce,(0,e._)(Y||(Y=je([""," || ",""])),ce,te)),Q.mergeValidEvaluated(xe,te)||ae.if((0,e.not)(ce))})),Q.result(ce,()=>Q.reset(),()=>Q.error(!0))}s(he,"validateUnion"),t.validateUnion=he}),bqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;var e=on(),r=cg(),i=Kh(),n=$P();function a(k,B){let{gen:U,keyword:z,schema:q,parentSchema:W,it:J}=k,V=B.macro.call(J.self,q,W,J),oe=T(U,z,V);J.opts.validateSchema!==!1&&J.self.validateSchema(V,!0);let Y=U.name("valid");k.subschema({schema:V,schemaPath:e.nil,errSchemaPath:"".concat(J.errSchemaPath,"/").concat(z),topSchemaRef:oe,compositeRule:!0},Y),k.pass(Y,()=>k.error(!0))}s(a,"macroKeywordCode"),t.macroKeywordCode=a;var o,l,u,c,p,m;function y(k,B){var U;let{gen:z,keyword:q,schema:W,parentSchema:J,$data:V,it:oe}=k;C(oe,B);let Y=!V&&B.compile?B.compile.call(oe.self,W,J,oe):B.validate,he=T(z,q,Y),Q=z.let("valid");k.block$data(Q,ae),k.ok((U=B.valid)!==null&&U!==void 0?U:Q);function ae(){if(B.errors===!1)K(),B.modifying&&w(k),ce(()=>k.error());else{let te=B.async?ee():le();B.modifying&&w(k),ce(()=>P(k,te))}}s(ae,"validateKeyword");function ee(){let te=z.let("ruleErrs",null);return z.try(()=>K((0,e._)(o||(o=je(["await "])))),ne=>z.assign(Q,!1).if((0,e._)(l||(l=je([""," instanceof ",""])),ne,oe.ValidationError),()=>z.assign(te,(0,e._)(u||(u=je(["",".errors"])),ne)),()=>z.throw(ne))),te}s(ee,"validateAsync");function le(){let te=(0,e._)(c||(c=je(["",".errors"])),he);return z.assign(te,null),K(e.nil),te}s(le,"validateSync");function K(te=B.async?(0,e._)(p||(p=je(["await "]))):e.nil){let ne=oe.opts.passContext?r.default.this:r.default.self,pe=!("compile"in B&&!V||B.schema===!1);z.assign(Q,(0,e._)(m||(m=je(["","",""])),te,(0,i.callValidateCode)(k,he,ne,pe)),B.modifying)}s(K,"assignValid");function ce(te){var ne;z.if((0,e.not)((ne=B.valid)!==null&&ne!==void 0?ne:Q),te)}s(ce,"reportErrs")}s(y,"funcKeywordCode"),t.funcKeywordCode=y;var v;function w(k){let{gen:B,data:U,it:z}=k;B.if(z.parentData,()=>B.assign(U,(0,e._)(v||(v=je(["","[","]"])),z.parentData,z.parentDataProperty)))}s(w,"modifyData");var E,M,I;function P(k,B){let{gen:U}=k;U.if((0,e._)(E||(E=je(["Array.isArray(",")"])),B),()=>{U.assign(r.default.vErrors,(0,e._)(M||(M=je([""," === null ? "," : ",".concat(",")"])),r.default.vErrors,B,r.default.vErrors,B)).assign(r.default.errors,(0,e._)(I||(I=je(["",".length"])),r.default.vErrors)),(0,n.extendErrors)(k)},()=>k.error())}s(P,"addErrs");function C({schemaEnv:k},B){if(B.async&&!k.$async)throw new Error("async keyword in sync schema")}s(C,"checkAsyncKeyword");function T(k,B,U){if(U===void 0)throw new Error('keyword "'.concat(B,'" failed to compile'));return k.scopeValue("keyword",typeof U=="function"?{ref:U}:{ref:U,code:(0,e.stringify)(U)})}s(T,"useKeyword");function O(k,B,U=!1){return!B.length||B.some(z=>z==="array"?Array.isArray(k):z==="object"?k&&typeof k=="object"&&!Array.isArray(k):typeof k==z||U&&typeof k>"u")}s(O,"validSchemaType"),t.validSchemaType=O;function F({schema:k,opts:B,self:U,errSchemaPath:z},q,W){if(Array.isArray(q.keyword)?!q.keyword.includes(W):q.keyword!==W)throw new Error("ajv implementation error");let J=q.dependencies;if(J!=null&&J.some(V=>!Object.prototype.hasOwnProperty.call(k,V)))throw new Error("parent schema must have dependencies of ".concat(W,": ").concat(J.join(",")));if(q.validateSchema&&!q.validateSchema(k[W])){let V='keyword "'.concat(W,'" value is invalid at path "').concat(z,'": ')+U.errorsText(q.validateSchema.errors);if(B.validateSchema==="log")U.logger.error(V);else throw new Error(V)}}s(F,"validateKeywordUsage"),t.validateKeywordUsage=F}),wqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;var e=on(),r=Bn(),i,n;function a(m,{keyword:y,schemaProp:v,schema:w,schemaPath:E,errSchemaPath:M,topSchemaRef:I}){if(y!==void 0&&w!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(y!==void 0){let P=m.schema[y];return v===void 0?{schema:P,schemaPath:(0,e._)(i||(i=je(["","",""])),m.schemaPath,(0,e.getProperty)(y)),errSchemaPath:"".concat(m.errSchemaPath,"/").concat(y)}:{schema:P[v],schemaPath:(0,e._)(n||(n=je(["","","",""])),m.schemaPath,(0,e.getProperty)(y),(0,e.getProperty)(v)),errSchemaPath:"".concat(m.errSchemaPath,"/").concat(y,"/").concat((0,r.escapeFragment)(v))}}if(w!==void 0){if(E===void 0||M===void 0||I===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:w,schemaPath:E,topSchemaRef:I,errSchemaPath:M}}throw new Error('either "keyword" or "schema" must be passed')}s(a,"getSubschema"),t.getSubschema=a;var o,l,u;function c(m,y,{dataProp:v,dataPropType:w,data:E,dataTypes:M,propertyName:I}){if(E!==void 0&&v!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:P}=y;if(v!==void 0){let{errorPath:T,dataPathArr:O,opts:F}=y,k=P.let("data",(0,e._)(o||(o=je(["","",""])),y.data,(0,e.getProperty)(v)),!0);C(k),m.errorPath=(0,e.str)(l||(l=je(["","",""])),T,(0,r.getErrorPath)(v,w,F.jsPropertySyntax)),m.parentDataProperty=(0,e._)(u||(u=je(["",""])),v),m.dataPathArr=[...O,m.parentDataProperty]}if(E!==void 0){let T=E instanceof e.Name?E:P.let("data",E,!0);C(T),I!==void 0&&(m.propertyName=I)}M&&(m.dataTypes=M);function C(T){m.data=T,m.dataLevel=y.dataLevel+1,m.dataTypes=[],y.definedProperties=new Set,m.parentData=y.data,m.dataNames=[...y.dataNames,T]}s(C,"dataContextProps")}s(c,"extendSubschemaData"),t.extendSubschemaData=c;function p(m,{jtdDiscriminator:y,jtdMetadata:v,compositeRule:w,createErrors:E,allErrors:M}){w!==void 0&&(m.compositeRule=w),E!==void 0&&(m.createErrors=E),M!==void 0&&(m.allErrors=M),m.jtdDiscriminator=y,m.jtdMetadata=v}s(p,"extendSubschemaMode"),t.extendSubschemaMode=p}),aye=bt((t,e)=>{N(),e.exports=s(function r(i,n){if(i===n)return!0;if(i&&n&&typeof i=="object"&&typeof n=="object"){if(i.constructor!==n.constructor)return!1;var a,o,l;if(Array.isArray(i)){if(a=i.length,a!=n.length)return!1;for(o=a;o--!==0;)if(!r(i[o],n[o]))return!1;return!0}if(i.constructor===RegExp)return i.source===n.source&&i.flags===n.flags;if(i.valueOf!==Object.prototype.valueOf)return i.valueOf()===n.valueOf();if(i.toString!==Object.prototype.toString)return i.toString()===n.toString();if(l=Object.keys(i),a=l.length,a!==Object.keys(n).length)return!1;for(o=a;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,l[o]))return!1;for(o=a;o--!==0;){var u=l[o];if(!r(i[u],n[u]))return!1}return!0}return i!==i&&n!==n},"equal")}),Aqe=bt((t,e)=>{N();var r=e.exports=function(a,o,l){typeof o=="function"&&(l=o,o={}),l=o.cb||l;var u=typeof l=="function"?l:l.pre||function(){},c=l.post||function(){};i(o,u,c,a,"",a)};r.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},r.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},r.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},r.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function i(a,o,l,u,c,p,m,y,v,w){if(u&&typeof u=="object"&&!Array.isArray(u)){o(u,c,p,m,y,v,w);for(var E in u){var M=u[E];if(Array.isArray(M)){if(E in r.arrayKeywords)for(var I=0;I<M.length;I++)i(a,o,l,M[I],c+"/"+E+"/"+I,p,c,E,u,I)}else if(E in r.propsKeywords){if(M&&typeof M=="object")for(var P in M)i(a,o,l,M[P],c+"/"+E+"/"+n(P),p,c,E,u,P)}else(E in r.keywords||a.allKeys&&!(E in r.skipKeywords))&&i(a,o,l,M,c+"/"+E,p,c,E,u)}l(u,c,p,m,y,v,w)}}s(i,"_traverse");function n(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}s(n,"escapeJsonPtr")}),GP=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;var e=Bn(),r=aye(),i=Aqe(),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function a(M,I=!0){return typeof M=="boolean"?!0:I===!0?!l(M):I?u(M)<=I:!1}s(a,"inlineRef"),t.inlineRef=a;var o=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(M){for(let I in M){if(o.has(I))return!0;let P=M[I];if(Array.isArray(P)&&P.some(l)||typeof P=="object"&&l(P))return!0}return!1}s(l,"hasRef");function u(M){let I=0;for(let P in M)if(P==="$ref"||(I++,!n.has(P)&&(typeof M[P]=="object"&&(0,e.eachItem)(M[P],C=>I+=u(C)),I===1/0)))return 1/0;return I}s(u,"countKeys");function c(M,I="",P){P!==!1&&(I=y(I));let C=M.parse(I);return p(M,C)}s(c,"getFullPath"),t.getFullPath=c;function p(M,I){return M.serialize(I).split("#")[0]+"#"}s(p,"_getFullPath"),t._getFullPath=p;var m=/#\/?$/;function y(M){return M?M.replace(m,""):""}s(y,"normalizeId"),t.normalizeId=y;function v(M,I,P){return P=y(P),M.resolve(I,P)}s(v,"resolveUrl"),t.resolveUrl=v;var w=/^[a-z_][-a-z0-9._]*$/i;function E(M,I){if(typeof M=="boolean")return{};let{schemaId:P,uriResolver:C}=this.opts,T=y(M[P]||I),O={"":T},F=c(C,T,!1),k={},B=new Set;return i(M,{allKeys:!0},(q,W,J,V)=>{if(V===void 0)return;let oe=F+W,Y=O[V];typeof q[P]=="string"&&(Y=he.call(this,q[P])),Q.call(this,q.$anchor),Q.call(this,q.$dynamicAnchor),O[W]=Y;function he(ae){let ee=this.opts.uriResolver.resolve;if(ae=y(Y?ee(Y,ae):ae),B.has(ae))throw z(ae);B.add(ae);let le=this.refs[ae];return typeof le=="string"&&(le=this.refs[le]),typeof le=="object"?U(q,le.schema,ae):ae!==y(oe)&&(ae[0]==="#"?(U(q,k[ae],ae),k[ae]=q):this.refs[ae]=oe),ae}s(he,"addRef");function Q(ae){if(typeof ae=="string"){if(!w.test(ae))throw new Error('invalid anchor "'.concat(ae,'"'));he.call(this,"#".concat(ae))}}s(Q,"addAnchor")}),k;function U(q,W,J){if(W!==void 0&&!r(q,W))throw z(J)}function z(q){return new Error('reference "'.concat(q,'" resolves to more than one schema'))}}s(E,"getSchemaRefs"),t.getSchemaRefs=E}),HP=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;var e=_qe(),r=iT(),i=nye(),n=iT(),a=xqe(),o=bqe(),l=wqe(),u=on(),c=cg(),p=GP(),m=Bn(),y=$P();function v(ke){if(Te(ke)&&(me(ke),xe(ke))){oe(ke);return}I(ke,()=>(0,e.topBoolOrEmptySchema)(ke))}s(v,"validateFunctionCode"),t.validateFunctionCode=v;var w,E,M;function I({gen:ke,validateName:$e,schema:ot,schemaEnv:Ft,opts:Ht},fr){Ht.code.es5?ke.func($e,(0,u._)(w||(w=je(["",", ",""])),c.default.data,c.default.valCxt),Ft.$async,()=>{ke.code((0,u._)(E||(E=je(['"use strict"; ',""])),ne(ot,Ht))),V(ke,Ht),ke.code(fr)}):ke.func($e,(0,u._)(M||(M=je(["",", ",""])),c.default.data,T(Ht)),Ft.$async,()=>ke.code(ne(ot,Ht)).code(fr))}s(I,"validateFunction");var P,C;function T(ke){return(0,u._)(C||(C=je(["{",'="", ',", ",", ","=","","}={}"])),c.default.instancePath,c.default.parentData,c.default.parentDataProperty,c.default.rootData,c.default.data,ke.dynamicRef?(0,u._)(P||(P=je([", ","={}"])),c.default.dynamicAnchors):u.nil)}s(T,"destructureValCxt");var O,F,k,B,U,z,q,W,J;function V(ke,$e){ke.if(c.default.valCxt,()=>{ke.var(c.default.instancePath,(0,u._)(O||(O=je(["",".",""])),c.default.valCxt,c.default.instancePath)),ke.var(c.default.parentData,(0,u._)(F||(F=je(["",".",""])),c.default.valCxt,c.default.parentData)),ke.var(c.default.parentDataProperty,(0,u._)(k||(k=je(["",".",""])),c.default.valCxt,c.default.parentDataProperty)),ke.var(c.default.rootData,(0,u._)(B||(B=je(["",".",""])),c.default.valCxt,c.default.rootData)),$e.dynamicRef&&ke.var(c.default.dynamicAnchors,(0,u._)(U||(U=je(["",".",""])),c.default.valCxt,c.default.dynamicAnchors))},()=>{ke.var(c.default.instancePath,(0,u._)(z||(z=je(['""'])))),ke.var(c.default.parentData,(0,u._)(q||(q=je(["undefined"])))),ke.var(c.default.parentDataProperty,(0,u._)(W||(W=je(["undefined"])))),ke.var(c.default.rootData,c.default.data),$e.dynamicRef&&ke.var(c.default.dynamicAnchors,(0,u._)(J||(J=je(["{}"]))))})}s(V,"destructureValCxtES5");function oe(ke){let{schema:$e,opts:ot,gen:Ft}=ke;I(ke,()=>{ot.$comment&&$e.$comment&&dt(ke),_e(ke),Ft.let(c.default.vErrors,null),Ft.let(c.default.errors,0),ot.unevaluated&&ce(ke),Ae(ke),Rt(ke)})}s(oe,"topSchemaObjCode");var Y,he,Q,ae,ee,le,K;function ce(ke){let{gen:$e,validateName:ot}=ke;ke.evaluated=$e.const("evaluated",(0,u._)(Y||(Y=je(["",".evaluated"])),ot)),$e.if((0,u._)(he||(he=je(["",".dynamicProps"])),ke.evaluated),()=>$e.assign((0,u._)(Q||(Q=je(["",".props"])),ke.evaluated),(0,u._)(ae||(ae=je(["undefined"]))))),$e.if((0,u._)(ee||(ee=je(["",".dynamicItems"])),ke.evaluated),()=>$e.assign((0,u._)(le||(le=je(["",".items"])),ke.evaluated),(0,u._)(K||(K=je(["undefined"])))))}s(ce,"resetEvaluated");var te;function ne(ke,$e){let ot=typeof ke=="object"&&ke[$e.schemaId];return ot&&($e.code.source||$e.code.process)?(0,u._)(te||(te=je(["/*# sourceURL="," */"])),ot):u.nil}s(ne,"funcSourceUrl");function pe(ke,$e){if(Te(ke)&&(me(ke),xe(ke))){Pe(ke,$e);return}(0,e.boolOrEmptySchema)(ke,$e)}s(pe,"subschemaCode");function xe({schema:ke,self:$e}){if(typeof ke=="boolean")return!ke;for(let ot in ke)if($e.RULES.all[ot])return!0;return!1}s(xe,"schemaCxtHasRules");function Te(ke){return typeof ke.schema!="boolean"}s(Te,"isSchemaObj");var fe;function Pe(ke,$e){let{schema:ot,gen:Ft,opts:Ht}=ke;Ht.$comment&&ot.$comment&&dt(ke),lt(ke),tt(ke);let fr=Ft.const("_errs",c.default.errors);Ae(ke,fr),Ft.var($e,(0,u._)(fe||(fe=je([""," === ",""])),fr,c.default.errors))}s(Pe,"subSchemaObjCode");function me(ke){(0,m.checkUnknownRules)(ke),Ue(ke)}s(me,"checkKeywords");function Ae(ke,$e){if(ke.opts.jtd)return $t(ke,[],!1,$e);let ot=(0,r.getSchemaTypes)(ke.schema),Ft=(0,r.coerceAndCheckDataType)(ke,ot);$t(ke,ot,!Ft,$e)}s(Ae,"typeAndKeywords");function Ue(ke){let{schema:$e,errSchemaPath:ot,opts:Ft,self:Ht}=ke;$e.$ref&&Ft.ignoreKeywordsWithRef&&(0,m.schemaHasRulesButRef)($e,Ht.RULES)&&Ht.logger.warn('$ref: keywords ignored in schema at path "'.concat(ot,'"'))}s(Ue,"checkRefsAndKeywords");function _e(ke){let{schema:$e,opts:ot}=ke;$e.default!==void 0&&ot.useDefaults&&ot.strictSchema&&(0,m.checkStrictMode)(ke,"default is ignored in the schema root")}s(_e,"checkNoDefault");function lt(ke){let $e=ke.schema[ke.opts.schemaId];$e&&(ke.baseId=(0,p.resolveUrl)(ke.opts.uriResolver,ke.baseId,$e))}s(lt,"updateContext");function tt(ke){if(ke.schema.$async&&!ke.schemaEnv.$async)throw new Error("async schema in sync schema")}s(tt,"checkAsyncSchema");var We,at,Lt;function dt({gen:ke,schemaEnv:$e,schema:ot,errSchemaPath:Ft,opts:Ht}){let fr=ot.$comment;if(Ht.$comment===!0)ke.code((0,u._)(We||(We=je(["",".logger.log(",")"])),c.default.self,fr));else if(typeof Ht.$comment=="function"){let nr=(0,u.str)(at||(at=je(["","/$comment"])),Ft),Kr=ke.scopeValue("root",{ref:$e.root});ke.code((0,u._)(Lt||(Lt=je(["",".opts.$comment(",", ",", ",".schema)"])),c.default.self,fr,nr,Kr))}}s(dt,"commentKeyword");var Me,ve,Ze,It;function Rt(ke){let{gen:$e,schemaEnv:ot,validateName:Ft,ValidationError:Ht,opts:fr}=ke;ot.$async?$e.if((0,u._)(Me||(Me=je([""," === 0"])),c.default.errors),()=>$e.return(c.default.data),()=>$e.throw((0,u._)(ve||(ve=je(["new ","(",")"])),Ht,c.default.vErrors))):($e.assign((0,u._)(Ze||(Ze=je(["",".errors"])),Ft),c.default.vErrors),fr.unevaluated&&Yt(ke),$e.return((0,u._)(It||(It=je([""," === 0"])),c.default.errors)))}s(Rt,"returnResults");var Et,pt;function Yt({gen:ke,evaluated:$e,props:ot,items:Ft}){ot instanceof u.Name&&ke.assign((0,u._)(Et||(Et=je(["",".props"])),$e),ot),Ft instanceof u.Name&&ke.assign((0,u._)(pt||(pt=je(["",".items"])),$e),Ft)}s(Yt,"assignEvaluated");var Kt;function $t(ke,$e,ot,Ft){let{gen:Ht,schema:fr,data:nr,allErrors:Kr,opts:ai,self:Jr}=ke,{RULES:Cr}=Jr;if(fr.$ref&&(ai.ignoreKeywordsWithRef||!(0,m.schemaHasRulesButRef)(fr,Cr))){Ht.block(()=>Re(ke,"$ref",Cr.all.$ref.definition));return}ai.jtd||Nt(ke,$e),Ht.block(()=>{for(let Hr of Cr.rules)Ei(Hr);Ei(Cr.post)});function Ei(Hr){(0,i.shouldUseGroup)(fr,Hr)&&(Hr.type?(Ht.if((0,n.checkDataType)(Hr.type,nr,ai.strictNumbers)),jt(ke,Hr),$e.length===1&&$e[0]===Hr.type&&ot&&(Ht.else(),(0,n.reportTypeError)(ke)),Ht.endIf()):jt(ke,Hr),Kr||Ht.if((0,u._)(Kt||(Kt=je([""," === ",""])),c.default.errors,Ft||0)))}s(Ei,"groupKeywords")}s($t,"schemaKeywords");function jt(ke,$e){let{gen:ot,schema:Ft,opts:{useDefaults:Ht}}=ke;Ht&&(0,a.assignDefaults)(ke,$e.type),ot.block(()=>{for(let fr of $e.rules)(0,i.shouldUseRule)(Ft,fr)&&Re(ke,fr.keyword,fr.definition,$e.type)})}s(jt,"iterateKeywords");function Nt(ke,$e){ke.schemaEnv.meta||!ke.opts.strictTypes||(Fe(ke,$e),ke.opts.allowUnionTypes||Xe(ke,$e),ht(ke,ke.dataTypes))}s(Nt,"checkStrictTypes");function Fe(ke,$e){if($e.length){if(!ke.dataTypes.length){ke.dataTypes=$e;return}$e.forEach(ot=>{ar(ke.dataTypes,ot)||Qe(ke,'type "'.concat(ot,'" not allowed by context "').concat(ke.dataTypes.join(","),'"'))}),Vr(ke,$e)}}s(Fe,"checkContextTypes");function Xe(ke,$e){$e.length>1&&!($e.length===2&&$e.includes("null"))&&Qe(ke,"use allowUnionTypes to allow union type keyword")}s(Xe,"checkMultipleTypes");function ht(ke,$e){let ot=ke.self.RULES.all;for(let Ft in ot){let Ht=ot[Ft];if(typeof Ht=="object"&&(0,i.shouldUseRule)(ke.schema,Ht)){let{type:fr}=Ht.definition;fr.length&&!fr.some(nr=>rr($e,nr))&&Qe(ke,'missing type "'.concat(fr.join(","),'" for keyword "').concat(Ft,'"'))}}}s(ht,"checkKeywordTypes");function rr(ke,$e){return ke.includes($e)||$e==="number"&&ke.includes("integer")}s(rr,"hasApplicableType");function ar(ke,$e){return ke.includes($e)||$e==="integer"&&ke.includes("number")}s(ar,"includesType");function Vr(ke,$e){let ot=[];for(let Ft of ke.dataTypes)ar($e,Ft)?ot.push(Ft):$e.includes("integer")&&Ft==="number"&&ot.push("integer");ke.dataTypes=ot}s(Vr,"narrowSchemaTypes");function Qe(ke,$e){let ot=ke.schemaEnv.baseId+ke.errSchemaPath;$e+=' at "'.concat(ot,'" (strictTypes)'),(0,m.checkStrictMode)(ke,$e,ke.opts.strictTypes)}s(Qe,"strictTypesError");var er,Oe,se,ue,Se=class{constructor($e,ot,Ft){if((0,o.validateKeywordUsage)($e,ot,Ft),this.gen=$e.gen,this.allErrors=$e.allErrors,this.keyword=Ft,this.data=$e.data,this.schema=$e.schema[Ft],this.$data=ot.$data&&$e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,m.schemaRefOrVal)($e,this.schema,Ft,this.$data),this.schemaType=ot.schemaType,this.parentSchema=$e.schema,this.params={},this.it=$e,this.def=ot,this.$data)this.schemaCode=$e.gen.const("vSchema",Gt(this.$data,$e));else if(this.schemaCode=this.schemaValue,!(0,o.validSchemaType)(this.schema,ot.schemaType,ot.allowUndefined))throw new Error("".concat(Ft," value must be ").concat(JSON.stringify(ot.schemaType)));("code"in ot?ot.trackErrors:ot.errors!==!1)&&(this.errsCount=$e.gen.const("_errs",c.default.errors))}result($e,ot,Ft){this.failResult((0,u.not)($e),ot,Ft)}failResult($e,ot,Ft){this.gen.if($e),Ft?Ft():this.error(),ot?(this.gen.else(),ot(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass($e,ot){this.failResult((0,u.not)($e),void 0,ot)}fail($e){if($e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if($e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data($e){if(!this.$data)return this.fail($e);let{schemaCode:ot}=this;this.fail((0,u._)(er||(er=je([""," !== undefined && (",")"])),ot,(0,u.or)(this.invalid$data(),$e)))}error($e,ot,Ft){if(ot){this.setParams(ot),this._error($e,Ft),this.setParams({});return}this._error($e,Ft)}_error($e,ot){($e?y.reportExtraError:y.reportError)(this,this.def.error,ot)}$dataError(){(0,y.reportError)(this,this.def.$dataError||y.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,y.resetErrorsCount)(this.gen,this.errsCount)}ok($e){this.allErrors||this.gen.if($e)}setParams($e,ot){ot?Object.assign(this.params,$e):this.params=$e}block$data($e,ot,Ft=u.nil){this.gen.block(()=>{this.check$data($e,Ft),ot()})}check$data($e=u.nil,ot=u.nil){if(!this.$data)return;let{gen:Ft,schemaCode:Ht,schemaType:fr,def:nr}=this;Ft.if((0,u.or)((0,u._)(Oe||(Oe=je([""," === undefined"])),Ht),ot)),$e!==u.nil&&Ft.assign($e,!0),(fr.length||nr.validateSchema)&&(Ft.elseIf(this.invalid$data()),this.$dataError(),$e!==u.nil&&Ft.assign($e,!1)),Ft.else()}invalid$data(){let{gen:$e,schemaCode:ot,schemaType:Ft,def:Ht,it:fr}=this;return(0,u.or)(nr(),Kr());function nr(){if(Ft.length){if(!(ot instanceof u.Name))throw new Error("ajv implementation error");let ai=Array.isArray(Ft)?Ft:[Ft];return(0,u._)(se||(se=je(["",""])),(0,n.checkDataTypes)(ai,ot,fr.opts.strictNumbers,n.DataType.Wrong))}return u.nil}function Kr(){if(Ht.validateSchema){let ai=$e.scopeValue("validate$data",{ref:Ht.validateSchema});return(0,u._)(ue||(ue=je(["!","(",")"])),ai,ot)}return u.nil}}subschema($e,ot){let Ft=(0,l.getSubschema)(this.it,$e);(0,l.extendSubschemaData)(Ft,this.it,$e),(0,l.extendSubschemaMode)(Ft,$e);let Ht=vt(Ee(Ee({},this.it),Ft),{items:void 0,props:void 0});return pe(Ht,ot),Ht}mergeEvaluated($e,ot){let{it:Ft,gen:Ht}=this;Ft.opts.unevaluated&&(Ft.props!==!0&&$e.props!==void 0&&(Ft.props=m.mergeEvaluated.props(Ht,$e.props,Ft.props,ot)),Ft.items!==!0&&$e.items!==void 0&&(Ft.items=m.mergeEvaluated.items(Ht,$e.items,Ft.items,ot)))}mergeValidEvaluated($e,ot){let{it:Ft,gen:Ht}=this;if(Ft.opts.unevaluated&&(Ft.props!==!0||Ft.items!==!0))return Ht.if(ot,()=>this.mergeEvaluated($e,u.Name)),!0}};s(Se,"KeywordCxt");var ze=Se;t.KeywordCxt=ze;function Re(ke,$e,ot,Ft){let Ht=new ze(ke,ot,$e);"code"in ot?ot.code(Ht,Ft):Ht.$data&&ot.validate?(0,o.funcKeywordCode)(Ht,ot):"macro"in ot?(0,o.macroKeywordCode)(Ht,ot):(ot.compile||ot.validate)&&(0,o.funcKeywordCode)(Ht,ot)}s(Re,"keywordCode");var yt=/^\/(?:[^~]|~0|~1)*$/,st=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/,kt,mt;function Gt(ke,{dataLevel:$e,dataNames:ot,dataPathArr:Ft}){let Ht,fr;if(ke==="")return c.default.rootData;if(ke[0]==="/"){if(!yt.test(ke))throw new Error("Invalid JSON-pointer: ".concat(ke));Ht=ke,fr=c.default.rootData}else{let Jr=st.exec(ke);if(!Jr)throw new Error("Invalid JSON-pointer: ".concat(ke));let Cr=+Jr[1];if(Ht=Jr[2],Ht==="#"){if(Cr>=$e)throw new Error(ai("property/index",Cr));return Ft[$e-Cr]}if(Cr>$e)throw new Error(ai("data",Cr));if(fr=ot[$e-Cr],!Ht)return fr}let nr=fr,Kr=Ht.split("/");for(let Jr of Kr)Jr&&(fr=(0,u._)(kt||(kt=je(["","",""])),fr,(0,u.getProperty)((0,m.unescapeJsonPointer)(Jr))),nr=(0,u._)(mt||(mt=je([""," && ",""])),nr,fr));return nr;function ai(Jr,Cr){return"Cannot access ".concat(Jr," ").concat(Cr," levels up, current level is ").concat($e)}}s(Gt,"getData"),t.getData=Gt}),ez=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=class extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}};s(e,"ValidationError");var r=e;t.default=r}),qP=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=GP(),r=class extends Error{constructor(a,o,l,u){super(u||"can't resolve reference ".concat(l," from id ").concat(o)),this.missingRef=(0,e.resolveUrl)(a,o,l),this.missingSchema=(0,e.normalizeId)((0,e.getFullPath)(a,this.missingRef))}};s(r,"MissingRefError");var i=r;t.default=i}),tz=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;var e=on(),r=ez(),i=cg(),n=GP(),a=Bn(),o=HP(),l=class{constructor(O){var F;this.refs={},this.dynamicAnchors={};let k;typeof O.schema=="object"&&(k=O.schema),this.schema=O.schema,this.schemaId=O.schemaId,this.root=O.root||this,this.baseId=(F=O.baseId)!==null&&F!==void 0?F:(0,n.normalizeId)(k==null?void 0:k[O.schemaId||"$id"]),this.schemaPath=O.schemaPath,this.localRefs=O.localRefs,this.meta=O.meta,this.$async=k==null?void 0:k.$async,this.refs={}}};s(l,"SchemaEnv");var u=l;t.SchemaEnv=u;var c,p;function m(T){let O=w.call(this,T);if(O)return O;let F=(0,n.getFullPath)(this.opts.uriResolver,T.root.baseId),{es5:k,lines:B}=this.opts.code,{ownProperties:U}=this.opts,z=new e.CodeGen(this.scope,{es5:k,lines:B,ownProperties:U}),q;T.$async&&(q=z.scopeValue("Error",{ref:r.default,code:(0,e._)(c||(c=je(['require("ajv/dist/runtime/validation_error").default'])))}));let W=z.scopeName("validate");T.validateName=W;let J={gen:z,allErrors:this.opts.allErrors,data:i.default.data,parentData:i.default.parentData,parentDataProperty:i.default.parentDataProperty,dataNames:[i.default.data],dataPathArr:[e.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:z.scopeValue("schema",this.opts.code.source===!0?{ref:T.schema,code:(0,e.stringify)(T.schema)}:{ref:T.schema}),validateName:W,ValidationError:q,schema:T.schema,schemaEnv:T,rootId:F,baseId:T.baseId||F,schemaPath:e.nil,errSchemaPath:T.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,e._)(p||(p=je(['""']))),opts:this.opts,self:this},V;try{this._compilations.add(T),(0,o.validateFunctionCode)(J),z.optimize(this.opts.code.optimize);let oe=z.toString();V="".concat(z.scopeRefs(i.default.scope),"return ").concat(oe),this.opts.code.process&&(V=this.opts.code.process(V,T));let Y=new Function("".concat(i.default.self),"".concat(i.default.scope),V)(this,this.scope.get());if(this.scope.value(W,{ref:Y}),Y.errors=null,Y.schema=T.schema,Y.schemaEnv=T,T.$async&&(Y.$async=!0),this.opts.code.source===!0&&(Y.source={validateName:W,validateCode:oe,scopeValues:z._values}),this.opts.unevaluated){let{props:he,items:Q}=J;Y.evaluated={props:he instanceof e.Name?void 0:he,items:Q instanceof e.Name?void 0:Q,dynamicProps:he instanceof e.Name,dynamicItems:Q instanceof e.Name},Y.source&&(Y.source.evaluated=(0,e.stringify)(Y.evaluated))}return T.validate=Y,T}catch(oe){throw delete T.validate,delete T.validateName,V&&this.logger.error("Error compiling schema, function code:",V),oe}finally{this._compilations.delete(T)}}s(m,"compileSchema"),t.compileSchema=m;function y(T,O,F){var k;F=(0,n.resolveUrl)(this.opts.uriResolver,O,F);let B=T.refs[F];if(B)return B;let U=M.call(this,T,F);if(U===void 0){let z=(k=T.localRefs)===null||k===void 0?void 0:k[F],{schemaId:q}=this.opts;z&&(U=new u({schema:z,schemaId:q,root:T,baseId:O}))}if(U!==void 0)return T.refs[F]=v.call(this,U)}s(y,"resolveRef"),t.resolveRef=y;function v(T){return(0,n.inlineRef)(T.schema,this.opts.inlineRefs)?T.schema:T.validate?T:m.call(this,T)}s(v,"inlineOrCompile");function w(T){for(let O of this._compilations)if(E(O,T))return O}s(w,"getCompilingSchema"),t.getCompilingSchema=w;function E(T,O){return T.schema===O.schema&&T.root===O.root&&T.baseId===O.baseId}s(E,"sameSchemaEnv");function M(T,O){let F;for(;typeof(F=this.refs[O])=="string";)O=F;return F||this.schemas[O]||I.call(this,T,O)}s(M,"resolve");function I(T,O){let F=this.opts.uriResolver.parse(O),k=(0,n._getFullPath)(this.opts.uriResolver,F),B=(0,n.getFullPath)(this.opts.uriResolver,T.baseId,void 0);if(Object.keys(T.schema).length>0&&k===B)return C.call(this,F,T);let U=(0,n.normalizeId)(k),z=this.refs[U]||this.schemas[U];if(typeof z=="string"){let q=I.call(this,T,z);return typeof(q==null?void 0:q.schema)!="object"?void 0:C.call(this,F,q)}if(typeof(z==null?void 0:z.schema)=="object"){if(z.validate||m.call(this,z),U===(0,n.normalizeId)(O)){let{schema:q}=z,{schemaId:W}=this.opts,J=q[W];return J&&(B=(0,n.resolveUrl)(this.opts.uriResolver,B,J)),new u({schema:q,schemaId:W,root:T,baseId:B})}return C.call(this,F,z)}}s(I,"resolveSchema"),t.resolveSchema=I;var P=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function C(T,{baseId:O,schema:F,root:k}){var B;if(((B=T.fragment)===null||B===void 0?void 0:B[0])!=="/")return;for(let q of T.fragment.slice(1).split("/")){if(typeof F=="boolean")return;let W=F[(0,a.unescapeFragment)(q)];if(W===void 0)return;F=W;let J=typeof F=="object"&&F[this.opts.schemaId];!P.has(q)&&J&&(O=(0,n.resolveUrl)(this.opts.uriResolver,O,J))}let U;if(typeof F!="boolean"&&F.$ref&&!(0,a.schemaHasRulesButRef)(F,this.RULES)){let q=(0,n.resolveUrl)(this.opts.uriResolver,O,F.$ref);U=I.call(this,k,q)}let{schemaId:z}=this.opts;if(U=U||new u({schema:F,schemaId:z,root:k,baseId:O}),U.schema!==U.root.schema)return U}s(C,"getJsonPointer")}),Sqe=bt((t,e)=>{e.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}}),Mqe=bt((t,e)=>{N();var r={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};e.exports={HEX:r}}),Eqe=bt((t,e)=>{N();var{HEX:r}=Mqe(),i=new RegExp("^(?:(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)$","u");function n(I){if(c(I,".")<3)return{host:I,isIPV4:!1};let P=I.match(i)||[],[C]=P;return C?{host:u(C,"."),isIPV4:!0}:{host:I,isIPV4:!1}}s(n,"normalizeIPv4");function a(I,P=!1){let C="",T=!0;for(let O of I){if(r[O]===void 0)return;O!=="0"&&T===!0&&(T=!1),T||(C+=O)}return P&&C.length===0&&(C="0"),C}s(a,"stringArrayToHexStripped");function o(I){let P=0,C={error:!1,address:"",zone:""},T=[],O=[],F=!1,k=!1,B=!1;function U(){if(O.length){if(F===!1){let z=a(O);if(z!==void 0)T.push(z);else return C.error=!0,!1}O.length=0}return!0}s(U,"consume");for(let z=0;z<I.length;z++){let q=I[z];if(!(q==="["||q==="]"))if(q===":"){if(k===!0&&(B=!0),!U())break;if(P++,T.push(":"),P>7){C.error=!0;break}z-1>=0&&I[z-1]===":"&&(k=!0);continue}else if(q==="%"){if(!U())break;F=!0}else{O.push(q);continue}}return O.length&&(F?C.zone=O.join(""):B?T.push(O.join("")):T.push(a(O))),C.address=T.join(""),C}s(o,"getIPV6");function l(I){if(c(I,":")<2)return{host:I,isIPV6:!1};let P=o(I);if(P.error)return{host:I,isIPV6:!1};{let C=P.address,T=P.address;return P.zone&&(C+="%"+P.zone,T+="%25"+P.zone),{host:C,escapedHost:T,isIPV6:!0}}}s(l,"normalizeIPv6");function u(I,P){let C="",T=!0,O=I.length;for(let F=0;F<O;F++){let k=I[F];k==="0"&&T?(F+1<=O&&I[F+1]===P||F+1===O)&&(C+=k,T=!1):(k===P?T=!0:T=!1,C+=k)}return C}s(u,"stripLeadingZeros");function c(I,P){let C=0;for(let T=0;T<I.length;T++)I[T]===P&&C++;return C}s(c,"findToken");var p=new RegExp("^\\.\\.?\\/","u"),m=new RegExp("^\\/\\.(?:\\/|$)","u"),y=new RegExp("^\\/\\.\\.(?:\\/|$)","u"),v=new RegExp("^\\/?(?:.|\\n)*?(?=\\/|$)","u");function w(I){let P=[];for(;I.length;)if(I.match(p))I=I.replace(p,"");else if(I.match(m))I=I.replace(m,"/");else if(I.match(y))I=I.replace(y,"/"),P.pop();else if(I==="."||I==="..")I="";else{let C=I.match(v);if(C){let T=C[0];I=I.slice(T.length),P.push(T)}else throw new Error("Unexpected dot segment condition")}return P.join("")}s(w,"removeDotSegments");function E(I,P){let C=P!==!0?escape:unescape;return I.scheme!==void 0&&(I.scheme=C(I.scheme)),I.userinfo!==void 0&&(I.userinfo=C(I.userinfo)),I.host!==void 0&&(I.host=C(I.host)),I.path!==void 0&&(I.path=C(I.path)),I.query!==void 0&&(I.query=C(I.query)),I.fragment!==void 0&&(I.fragment=C(I.fragment)),I}s(E,"normalizeComponentEncoding");function M(I){let P=[];if(I.userinfo!==void 0&&(P.push(I.userinfo),P.push("@")),I.host!==void 0){let C=unescape(I.host),T=n(C);if(T.isIPV4)C=T.host;else{let O=l(T.host);O.isIPV6===!0?C="[".concat(O.escapedHost,"]"):C=I.host}P.push(C)}return(typeof I.port=="number"||typeof I.port=="string")&&(P.push(":"),P.push(String(I.port))),P.length?P.join(""):void 0}s(M,"recomposeAuthority"),e.exports={recomposeAuthority:M,normalizeComponentEncoding:E,removeDotSegments:w,normalizeIPv4:n,normalizeIPv6:l,stringArrayToHexStripped:a}}),Cqe=bt((t,e)=>{N();var r=new RegExp("^[\\da-f]{8}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{12}$","iu"),i=new RegExp("([\\da-z][\\d\\-a-z]{0,31}):((?:[\\w!$'()*+,\\-.:;=@]|%[\\da-f]{2})+)","iu");function n(T){return typeof T.secure=="boolean"?T.secure:String(T.scheme).toLowerCase()==="wss"}s(n,"isSecure");function a(T){return T.host||(T.error=T.error||"HTTP URIs must have a host."),T}s(a,"httpParse");function o(T){let O=String(T.scheme).toLowerCase()==="https";return(T.port===(O?443:80)||T.port==="")&&(T.port=void 0),T.path||(T.path="/"),T}s(o,"httpSerialize");function l(T){return T.secure=n(T),T.resourceName=(T.path||"/")+(T.query?"?"+T.query:""),T.path=void 0,T.query=void 0,T}s(l,"wsParse");function u(T){if((T.port===(n(T)?443:80)||T.port==="")&&(T.port=void 0),typeof T.secure=="boolean"&&(T.scheme=T.secure?"wss":"ws",T.secure=void 0),T.resourceName){let[O,F]=T.resourceName.split("?");T.path=O&&O!=="/"?O:void 0,T.query=F,T.resourceName=void 0}return T.fragment=void 0,T}s(u,"wsSerialize");function c(T,O){if(!T.path)return T.error="URN can not be parsed",T;let F=T.path.match(i);if(F){let k=O.scheme||T.scheme||"urn";T.nid=F[1].toLowerCase(),T.nss=F[2];let B="".concat(k,":").concat(O.nid||T.nid),U=C[B];T.path=void 0,U&&(T=U.parse(T,O))}else T.error=T.error||"URN can not be parsed.";return T}s(c,"urnParse");function p(T,O){let F=O.scheme||T.scheme||"urn",k=T.nid.toLowerCase(),B="".concat(F,":").concat(O.nid||k),U=C[B];U&&(T=U.serialize(T,O));let z=T,q=T.nss;return z.path="".concat(k||O.nid,":").concat(q),O.skipEscape=!0,z}s(p,"urnSerialize");function m(T,O){let F=T;return F.uuid=F.nss,F.nss=void 0,!O.tolerant&&(!F.uuid||!r.test(F.uuid))&&(F.error=F.error||"UUID is not valid."),F}s(m,"urnuuidParse");function y(T){let O=T;return O.nss=(T.uuid||"").toLowerCase(),O}s(y,"urnuuidSerialize");var v={scheme:"http",domainHost:!0,parse:a,serialize:o},w={scheme:"https",domainHost:v.domainHost,parse:a,serialize:o},E={scheme:"ws",domainHost:!0,parse:l,serialize:u},M={scheme:"wss",domainHost:E.domainHost,parse:E.parse,serialize:E.serialize},I={scheme:"urn",parse:c,serialize:p,skipNormalize:!0},P={scheme:"urn:uuid",parse:m,serialize:y,skipNormalize:!0},C={http:v,https:w,ws:E,wss:M,urn:I,"urn:uuid":P};e.exports=C}),Iqe=bt((t,e)=>{N();var{normalizeIPv6:r,normalizeIPv4:i,removeDotSegments:n,recomposeAuthority:a,normalizeComponentEncoding:o}=Eqe(),l=Cqe();function u(P,C){return typeof P=="string"?P=y(M(P,C),C):typeof P=="object"&&(P=M(y(P,C),C)),P}s(u,"normalize");function c(P,C,T){let O=Object.assign({scheme:"null"},T),F=p(M(P,O),M(C,O),O,!0);return y(F,vt(Ee({},O),{skipEscape:!0}))}s(c,"resolve");function p(P,C,T,O){let F={};return O||(P=M(y(P,T),T),C=M(y(C,T),T)),T=T||{},!T.tolerant&&C.scheme?(F.scheme=C.scheme,F.userinfo=C.userinfo,F.host=C.host,F.port=C.port,F.path=n(C.path||""),F.query=C.query):(C.userinfo!==void 0||C.host!==void 0||C.port!==void 0?(F.userinfo=C.userinfo,F.host=C.host,F.port=C.port,F.path=n(C.path||""),F.query=C.query):(C.path?(C.path.charAt(0)==="/"?F.path=n(C.path):((P.userinfo!==void 0||P.host!==void 0||P.port!==void 0)&&!P.path?F.path="/"+C.path:P.path?F.path=P.path.slice(0,P.path.lastIndexOf("/")+1)+C.path:F.path=C.path,F.path=n(F.path)),F.query=C.query):(F.path=P.path,C.query!==void 0?F.query=C.query:F.query=P.query),F.userinfo=P.userinfo,F.host=P.host,F.port=P.port),F.scheme=P.scheme),F.fragment=C.fragment,F}s(p,"resolveComponents");function m(P,C,T){return typeof P=="string"?(P=unescape(P),P=y(o(M(P,T),!0),vt(Ee({},T),{skipEscape:!0}))):typeof P=="object"&&(P=y(o(P,!0),vt(Ee({},T),{skipEscape:!0}))),typeof C=="string"?(C=unescape(C),C=y(o(M(C,T),!0),vt(Ee({},T),{skipEscape:!0}))):typeof C=="object"&&(C=y(o(C,!0),vt(Ee({},T),{skipEscape:!0}))),P.toLowerCase()===C.toLowerCase()}s(m,"equal");function y(P,C){let T={host:P.host,scheme:P.scheme,userinfo:P.userinfo,port:P.port,path:P.path,query:P.query,nid:P.nid,nss:P.nss,uuid:P.uuid,fragment:P.fragment,reference:P.reference,resourceName:P.resourceName,secure:P.secure,error:""},O=Object.assign({},C),F=[],k=l[(O.scheme||T.scheme||"").toLowerCase()];k&&k.serialize&&k.serialize(T,O),T.path!==void 0&&(O.skipEscape?T.path=unescape(T.path):(T.path=escape(T.path),T.scheme!==void 0&&(T.path=T.path.split("%3A").join(":")))),O.reference!=="suffix"&&T.scheme&&F.push(T.scheme,":");let B=a(T);if(B!==void 0&&(O.reference!=="suffix"&&F.push("//"),F.push(B),T.path&&T.path.charAt(0)!=="/"&&F.push("/")),T.path!==void 0){let U=T.path;!O.absolutePath&&(!k||!k.absolutePath)&&(U=n(U)),B===void 0&&(U=U.replace(new RegExp("^\\/\\/","u"),"/%2F")),F.push(U)}return T.query!==void 0&&F.push("?",T.query),T.fragment!==void 0&&F.push("#",T.fragment),F.join("")}s(y,"serialize");var v=Array.from({length:127},(P,C)=>new RegExp("[^!\"$&'()*+,\\-.;=_`a-z{}~]","u").test(String.fromCharCode(C)));function w(P){let C=0;for(let T=0,O=P.length;T<O;++T)if(C=P.charCodeAt(T),C>126||v[C])return!0;return!1}s(w,"nonSimpleDomain");var E=new RegExp("^(?:([^#/:?]+):)?(?:\\/\\/((?:([^#/?@]*)@)?(\\[[^#/?\\]]+\\]|[^#/:?]*)(?::(\\d*))?))?([^#?]*)(?:\\?([^#]*))?(?:#((?:.|[\\n\\r])*))?","u");function M(P,C){let T=Object.assign({},C),O={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},F=P.indexOf("%")!==-1,k=!1;T.reference==="suffix"&&(P=(T.scheme?T.scheme+":":"")+"//"+P);let B=P.match(E);if(B){if(O.scheme=B[1],O.userinfo=B[3],O.host=B[4],O.port=parseInt(B[5],10),O.path=B[6]||"",O.query=B[7],O.fragment=B[8],isNaN(O.port)&&(O.port=B[5]),O.host){let z=i(O.host);if(z.isIPV4===!1){let q=r(z.host);O.host=q.host.toLowerCase(),k=q.isIPV6}else O.host=z.host,k=!0}O.scheme===void 0&&O.userinfo===void 0&&O.host===void 0&&O.port===void 0&&O.query===void 0&&!O.path?O.reference="same-document":O.scheme===void 0?O.reference="relative":O.fragment===void 0?O.reference="absolute":O.reference="uri",T.reference&&T.reference!=="suffix"&&T.reference!==O.reference&&(O.error=O.error||"URI is not a "+T.reference+" reference.");let U=l[(T.scheme||O.scheme||"").toLowerCase()];if(!T.unicodeSupport&&(!U||!U.unicodeSupport)&&O.host&&(T.domainHost||U&&U.domainHost)&&k===!1&&w(O.host))try{O.host=URL.domainToASCII(O.host.toLowerCase())}catch(z){O.error=O.error||"Host's domain name can not be converted to ASCII: "+z}(!U||U&&!U.skipNormalize)&&(F&&O.scheme!==void 0&&(O.scheme=unescape(O.scheme)),F&&O.host!==void 0&&(O.host=unescape(O.host)),O.path&&(O.path=escape(unescape(O.path))),O.fragment&&(O.fragment=encodeURI(decodeURIComponent(O.fragment)))),U&&U.parse&&U.parse(O,T)}else O.error=O.error||"URI can not be parsed.";return O}s(M,"parse");var I={SCHEMES:l,normalize:u,resolve:c,resolveComponents:p,equal:m,serialize:y,parse:M};e.exports=I,e.exports.default=I,e.exports.fastUri=I}),Tqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Iqe();e.code='require("ajv/dist/runtime/uri").default',t.default=e}),Pqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=HP();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:s(function(){return e.KeywordCxt},"get")});var r=on();Object.defineProperty(t,"_",{enumerable:!0,get:s(function(){return r._},"get")}),Object.defineProperty(t,"str",{enumerable:!0,get:s(function(){return r.str},"get")}),Object.defineProperty(t,"stringify",{enumerable:!0,get:s(function(){return r.stringify},"get")}),Object.defineProperty(t,"nil",{enumerable:!0,get:s(function(){return r.nil},"get")}),Object.defineProperty(t,"Name",{enumerable:!0,get:s(function(){return r.Name},"get")}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:s(function(){return r.CodeGen},"get")});var i=ez(),n=qP(),a=iye(),o=tz(),l=on(),u=GP(),c=iT(),p=Bn(),m=Sqe(),y=Tqe(),v=s((le,K)=>new RegExp(le,K),"defaultRegExp");v.code="new RegExp";var w=["removeAdditional","useDefaults","coerceTypes"],E=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),M={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},I={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},P=200;function C(le){var K,ce,te,ne,pe,xe,Te,fe,Pe,me,Ae,Ue,_e,lt,tt,We,at,Lt,dt,Me,ve,Ze,It,Rt,Et;let pt=le.strict,Yt=(K=le.code)===null||K===void 0?void 0:K.optimize,Kt=Yt===!0||Yt===void 0?1:Yt||0,$t=(te=(ce=le.code)===null||ce===void 0?void 0:ce.regExp)!==null&&te!==void 0?te:v,jt=(ne=le.uriResolver)!==null&&ne!==void 0?ne:y.default;return{strictSchema:(xe=(pe=le.strictSchema)!==null&&pe!==void 0?pe:pt)!==null&&xe!==void 0?xe:!0,strictNumbers:(fe=(Te=le.strictNumbers)!==null&&Te!==void 0?Te:pt)!==null&&fe!==void 0?fe:!0,strictTypes:(me=(Pe=le.strictTypes)!==null&&Pe!==void 0?Pe:pt)!==null&&me!==void 0?me:"log",strictTuples:(Ue=(Ae=le.strictTuples)!==null&&Ae!==void 0?Ae:pt)!==null&&Ue!==void 0?Ue:"log",strictRequired:(lt=(_e=le.strictRequired)!==null&&_e!==void 0?_e:pt)!==null&&lt!==void 0?lt:!1,code:le.code?vt(Ee({},le.code),{optimize:Kt,regExp:$t}):{optimize:Kt,regExp:$t},loopRequired:(tt=le.loopRequired)!==null&&tt!==void 0?tt:P,loopEnum:(We=le.loopEnum)!==null&&We!==void 0?We:P,meta:(at=le.meta)!==null&&at!==void 0?at:!0,messages:(Lt=le.messages)!==null&&Lt!==void 0?Lt:!0,inlineRefs:(dt=le.inlineRefs)!==null&&dt!==void 0?dt:!0,schemaId:(Me=le.schemaId)!==null&&Me!==void 0?Me:"$id",addUsedSchema:(ve=le.addUsedSchema)!==null&&ve!==void 0?ve:!0,validateSchema:(Ze=le.validateSchema)!==null&&Ze!==void 0?Ze:!0,validateFormats:(It=le.validateFormats)!==null&&It!==void 0?It:!0,unicodeRegExp:(Rt=le.unicodeRegExp)!==null&&Rt!==void 0?Rt:!0,int32range:(Et=le.int32range)!==null&&Et!==void 0?Et:!0,uriResolver:jt}}s(C,"requiredOptions");var T=class{constructor(K={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,K=this.opts=Ee(Ee({},K),C(K));let{es5:ce,lines:te}=this.opts.code;this.scope=new l.ValueScope({scope:{},prefixes:E,es5:ce,lines:te}),this.logger=J(K.logger);let ne=K.validateFormats;K.validateFormats=!1,this.RULES=(0,a.getRules)(),F.call(this,M,K,"NOT SUPPORTED"),F.call(this,I,K,"DEPRECATED","warn"),this._metaOpts=q.call(this),K.formats&&U.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),K.keywords&&z.call(this,K.keywords),typeof K.meta=="object"&&this.addMetaSchema(K.meta),B.call(this),K.validateFormats=ne}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:K,meta:ce,schemaId:te}=this.opts,ne=m;te==="id"&&(ne=Ee({},m),ne.id=ne.$id,delete ne.$id),ce&&K&&this.addMetaSchema(ne,ne[te],!1)}defaultMeta(){let{meta:K,schemaId:ce}=this.opts;return this.opts.defaultMeta=typeof K=="object"?K[ce]||K:void 0}validate(K,ce){let te;if(typeof K=="string"){if(te=this.getSchema(K),!te)throw new Error('no schema with key or ref "'.concat(K,'"'))}else te=this.compile(K);let ne=te(ce);return"$async"in te||(this.errors=te.errors),ne}compile(K,ce){let te=this._addSchema(K,ce);return te.validate||this._compileSchemaEnv(te)}compileAsync(K,ce){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:te}=this.opts;return ne.call(this,K,ce);async function ne(me,Ae){await pe.call(this,me.$schema);let Ue=this._addSchema(me,Ae);return Ue.validate||xe.call(this,Ue)}async function pe(me){me&&!this.getSchema(me)&&await ne.call(this,{$ref:me},!0)}async function xe(me){try{return this._compileSchemaEnv(me)}catch(Ae){if(!(Ae instanceof n.default))throw Ae;return Te.call(this,Ae),await fe.call(this,Ae.missingSchema),xe.call(this,me)}}function Te({missingSchema:me,missingRef:Ae}){if(this.refs[me])throw new Error("AnySchema ".concat(me," is loaded but ").concat(Ae," cannot be resolved"))}async function fe(me){let Ae=await Pe.call(this,me);this.refs[me]||await pe.call(this,Ae.$schema),this.refs[me]||this.addSchema(Ae,me,ce)}async function Pe(me){let Ae=this._loading[me];if(Ae)return Ae;try{return await(this._loading[me]=te(me))}finally{delete this._loading[me]}}}addSchema(K,ce,te,ne=this.opts.validateSchema){if(Array.isArray(K)){for(let xe of K)this.addSchema(xe,void 0,te,ne);return this}let pe;if(typeof K=="object"){let{schemaId:xe}=this.opts;if(pe=K[xe],pe!==void 0&&typeof pe!="string")throw new Error("schema ".concat(xe," must be string"))}return ce=(0,u.normalizeId)(ce||pe),this._checkUnique(ce),this.schemas[ce]=this._addSchema(K,te,ce,ne,!0),this}addMetaSchema(K,ce,te=this.opts.validateSchema){return this.addSchema(K,ce,!0,te),this}validateSchema(K,ce){if(typeof K=="boolean")return!0;let te;if(te=K.$schema,te!==void 0&&typeof te!="string")throw new Error("$schema must be a string");if(te=te||this.opts.defaultMeta||this.defaultMeta(),!te)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let ne=this.validate(te,K);if(!ne&&ce){let pe="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(pe);else throw new Error(pe)}return ne}getSchema(K){let ce;for(;typeof(ce=k.call(this,K))=="string";)K=ce;if(ce===void 0){let{schemaId:te}=this.opts,ne=new o.SchemaEnv({schema:{},schemaId:te});if(ce=o.resolveSchema.call(this,ne,K),!ce)return;this.refs[K]=ce}return ce.validate||this._compileSchemaEnv(ce)}removeSchema(K){if(K instanceof RegExp)return this._removeAllSchemas(this.schemas,K),this._removeAllSchemas(this.refs,K),this;switch(typeof K){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let ce=k.call(this,K);return typeof ce=="object"&&this._cache.delete(ce.schema),delete this.schemas[K],delete this.refs[K],this}case"object":{let ce=K;this._cache.delete(ce);let te=K[this.opts.schemaId];return te&&(te=(0,u.normalizeId)(te),delete this.schemas[te],delete this.refs[te]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(K){for(let ce of K)this.addKeyword(ce);return this}addKeyword(K,ce){let te;if(typeof K=="string")te=K,typeof ce=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),ce.keyword=te);else if(typeof K=="object"&&ce===void 0){if(ce=K,te=ce.keyword,Array.isArray(te)&&!te.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(oe.call(this,te,ce),!ce)return(0,p.eachItem)(te,pe=>Y.call(this,pe)),this;Q.call(this,ce);let ne=vt(Ee({},ce),{type:(0,c.getJSONTypes)(ce.type),schemaType:(0,c.getJSONTypes)(ce.schemaType)});return(0,p.eachItem)(te,ne.type.length===0?pe=>Y.call(this,pe,ne):pe=>ne.type.forEach(xe=>Y.call(this,pe,ne,xe))),this}getKeyword(K){let ce=this.RULES.all[K];return typeof ce=="object"?ce.definition:!!ce}removeKeyword(K){let{RULES:ce}=this;delete ce.keywords[K],delete ce.all[K];for(let te of ce.rules){let ne=te.rules.findIndex(pe=>pe.keyword===K);ne>=0&&te.rules.splice(ne,1)}return this}addFormat(K,ce){return typeof ce=="string"&&(ce=new RegExp(ce)),this.formats[K]=ce,this}errorsText(K=this.errors,{separator:ce=", ",dataVar:te="data"}={}){return!K||K.length===0?"No errors":K.map(ne=>"".concat(te).concat(ne.instancePath," ").concat(ne.message)).reduce((ne,pe)=>ne+ce+pe)}$dataMetaSchema(K,ce){let te=this.RULES.all;K=JSON.parse(JSON.stringify(K));for(let ne of ce){let pe=ne.split("/").slice(1),xe=K;for(let Te of pe)xe=xe[Te];for(let Te in te){let fe=te[Te];if(typeof fe!="object")continue;let{$data:Pe}=fe.definition,me=xe[Te];Pe&&me&&(xe[Te]=ee(me))}}return K}_removeAllSchemas(K,ce){for(let te in K){let ne=K[te];(!ce||ce.test(te))&&(typeof ne=="string"?delete K[te]:ne&&!ne.meta&&(this._cache.delete(ne.schema),delete K[te]))}}_addSchema(K,ce,te,ne=this.opts.validateSchema,pe=this.opts.addUsedSchema){let xe,{schemaId:Te}=this.opts;if(typeof K=="object")xe=K[Te];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof K!="boolean")throw new Error("schema must be object or boolean")}let fe=this._cache.get(K);if(fe!==void 0)return fe;te=(0,u.normalizeId)(xe||te);let Pe=u.getSchemaRefs.call(this,K,te);return fe=new o.SchemaEnv({schema:K,schemaId:Te,meta:ce,baseId:te,localRefs:Pe}),this._cache.set(fe.schema,fe),pe&&!te.startsWith("#")&&(te&&this._checkUnique(te),this.refs[te]=fe),ne&&this.validateSchema(K,!0),fe}_checkUnique(K){if(this.schemas[K]||this.refs[K])throw new Error('schema with key or id "'.concat(K,'" already exists'))}_compileSchemaEnv(K){if(K.meta?this._compileMetaSchema(K):o.compileSchema.call(this,K),!K.validate)throw new Error("ajv implementation error");return K.validate}_compileMetaSchema(K){let ce=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,K)}finally{this.opts=ce}}};s(T,"Ajv");var O=T;O.ValidationError=i.default,O.MissingRefError=n.default,t.default=O;function F(le,K,ce,te="error"){for(let ne in le){let pe=ne;pe in K&&this.logger[te]("".concat(ce,": option ").concat(ne,". ").concat(le[pe]))}}s(F,"checkOptions");function k(le){return le=(0,u.normalizeId)(le),this.schemas[le]||this.refs[le]}s(k,"getSchEnv");function B(){let le=this.opts.schemas;if(le)if(Array.isArray(le))this.addSchema(le);else for(let K in le)this.addSchema(le[K],K)}s(B,"addInitialSchemas");function U(){for(let le in this.opts.formats){let K=this.opts.formats[le];K&&this.addFormat(le,K)}}s(U,"addInitialFormats");function z(le){if(Array.isArray(le)){this.addVocabulary(le);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let K in le){let ce=le[K];ce.keyword||(ce.keyword=K),this.addKeyword(ce)}}s(z,"addInitialKeywords");function q(){let le=Ee({},this.opts);for(let K of w)delete le[K];return le}s(q,"getMetaSchemaOptions");var W={log(){},warn(){},error(){}};function J(le){if(le===!1)return W;if(le===void 0)return console;if(le.log&&le.warn&&le.error)return le;throw new Error("logger must implement log, warn and error methods")}s(J,"getLogger");var V=/^[a-z_$][a-z0-9_$:-]*$/i;function oe(le,K){let{RULES:ce}=this;if((0,p.eachItem)(le,te=>{if(ce.keywords[te])throw new Error("Keyword ".concat(te," is already defined"));if(!V.test(te))throw new Error("Keyword ".concat(te," has invalid name"))}),!!K&&K.$data&&!("code"in K||"validate"in K))throw new Error('$data keyword must have "code" or "validate" function')}s(oe,"checkKeyword");function Y(le,K,ce){var te;let ne=K==null?void 0:K.post;if(ce&&ne)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:pe}=this,xe=ne?pe.post:pe.rules.find(({type:fe})=>fe===ce);if(xe||(xe={type:ce,rules:[]},pe.rules.push(xe)),pe.keywords[le]=!0,!K)return;let Te={keyword:le,definition:vt(Ee({},K),{type:(0,c.getJSONTypes)(K.type),schemaType:(0,c.getJSONTypes)(K.schemaType)})};K.before?he.call(this,xe,Te,K.before):xe.rules.push(Te),pe.all[le]=Te,(te=K.implements)===null||te===void 0||te.forEach(fe=>this.addKeyword(fe))}s(Y,"addRule");function he(le,K,ce){let te=le.rules.findIndex(ne=>ne.keyword===ce);te>=0?le.rules.splice(te,0,K):(le.rules.push(K),this.logger.warn("rule ".concat(ce," is not defined")))}s(he,"addBeforeRule");function Q(le){let{metaSchema:K}=le;K!==void 0&&(le.$data&&this.opts.$data&&(K=ee(K)),le.validateSchema=this.compile(K,!0))}s(Q,"keywordMetaschema");var ae={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ee(le){return{anyOf:[le,ae]}}s(ee,"schemaOrData")}),Lqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=e}),Dqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;var e=qP(),r=Kh(),i=on(),n=cg(),a=tz(),o=Bn(),l,u={keyword:"$ref",schemaType:"string",code(C){let{gen:T,schema:O,it:F}=C,{baseId:k,schemaEnv:B,validateName:U,opts:z,self:q}=F,{root:W}=B;if((O==="#"||O==="#/")&&k===W.baseId)return V();let J=a.resolveRef.call(q,W,k,O);if(J===void 0)throw new e.default(F.opts.uriResolver,k,O);if(J instanceof a.SchemaEnv)return oe(J);return Y(J);function V(){if(B===W)return P(C,U,B,B.$async);let he=T.scopeValue("root",{ref:W});return P(C,(0,i._)(l||(l=je(["",".validate"])),he),W,W.$async)}function oe(he){let Q=p(C,he);P(C,Q,he,he.$async)}function Y(he){let Q=T.scopeValue("schema",z.code.source===!0?{ref:he,code:(0,i.stringify)(he)}:{ref:he}),ae=T.name("valid"),ee=C.subschema({schema:he,dataTypes:[],schemaPath:i.nil,topSchemaRef:Q,errSchemaPath:O},ae);C.mergeEvaluated(ee),C.ok(ae)}}},c;function p(C,T){let{gen:O}=C;return T.validate?O.scopeValue("validate",{ref:T.validate}):(0,i._)(c||(c=je(["",".validate"])),O.scopeValue("wrapper",{ref:T}))}s(p,"getValidate"),t.getValidate=p;var m,y,v,w,E,M,I;function P(C,T,O,F){let{gen:k,it:B}=C,{allErrors:U,schemaEnv:z,opts:q}=B,W=q.passContext?n.default.this:i.nil;F?J():V();function J(){if(!z.$async)throw new Error("async schema referenced by sync schema");let he=k.let("valid");k.try(()=>{k.code((0,i._)(m||(m=je(["await ",""])),(0,r.callValidateCode)(C,T,W))),Y(T),U||k.assign(he,!0)},Q=>{k.if((0,i._)(y||(y=je(["!("," instanceof ",")"])),Q,B.ValidationError),()=>k.throw(Q)),oe(Q),U||k.assign(he,!1)}),C.ok(he)}s(J,"callAsyncRef");function V(){C.result((0,r.callValidateCode)(C,T,W),()=>Y(T),()=>oe(T))}s(V,"callSyncRef");function oe(he){let Q=(0,i._)(v||(v=je(["",".errors"])),he);k.assign(n.default.vErrors,(0,i._)(w||(w=je([""," === null ? "," : ",".concat(",")"])),n.default.vErrors,Q,n.default.vErrors,Q)),k.assign(n.default.errors,(0,i._)(E||(E=je(["",".length"])),n.default.vErrors))}s(oe,"addErrorsFrom");function Y(he){var Q;if(!B.opts.unevaluated)return;let ae=(Q=O==null?void 0:O.validate)===null||Q===void 0?void 0:Q.evaluated;if(B.props!==!0)if(ae&&!ae.dynamicProps)ae.props!==void 0&&(B.props=o.mergeEvaluated.props(k,ae.props,B.props));else{let ee=k.var("props",(0,i._)(M||(M=je(["",".evaluated.props"])),he));B.props=o.mergeEvaluated.props(k,ee,B.props,i.Name)}if(B.items!==!0)if(ae&&!ae.dynamicItems)ae.items!==void 0&&(B.items=o.mergeEvaluated.items(k,ae.items,B.items));else{let ee=k.var("items",(0,i._)(I||(I=je(["",".evaluated.items"])),he));B.items=o.mergeEvaluated.items(k,ee,B.items,i.Name)}}s(Y,"addEvaluatedFrom")}s(P,"callRef"),t.callRef=P,t.default=u}),Rqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Lqe(),r=Dqe(),i=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",e.default,r.default];t.default=i}),Oqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=e.operators,i={maximum:{okStr:"<=",ok:r.LTE,fail:r.GT},minimum:{okStr:">=",ok:r.GTE,fail:r.LT},exclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},exclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},n,a,o={message:s(({keyword:c,schemaCode:p})=>(0,e.str)(n||(n=je(["must be "," ",""])),i[c].okStr,p),"message"),params:s(({keyword:c,schemaCode:p})=>(0,e._)(a||(a=je(["{comparison: ",", limit: ","}"])),i[c].okStr,p),"params")},l,u={keyword:Object.keys(i),type:"number",schemaType:"number",$data:!0,error:o,code(c){let{keyword:p,data:m,schemaCode:y}=c;c.fail$data((0,e._)(l||(l=je([""," "," "," || isNaN(",")"])),m,i[p].fail,y,m))}};t.default=u}),kqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r,i,n={message:s(({schemaCode:c})=>(0,e.str)(r||(r=je(["must be multiple of ",""])),c),"message"),params:s(({schemaCode:c})=>(0,e._)(i||(i=je(["{multipleOf: ","}"])),c),"params")},a,o,l,u={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:n,code(c){let{gen:p,data:m,schemaCode:y,it:v}=c,w=v.opts.multipleOfPrecision,E=p.let("res"),M=w?(0,e._)(a||(a=je(["Math.abs(Math.round(",") - ",") > 1e-",""])),E,E,w):(0,e._)(o||(o=je([""," !== parseInt(",")"])),E,E);c.fail$data((0,e._)(l||(l=je(["("," === 0 || ("," = ","/",", ","))"])),y,E,m,y,M))}};t.default=u}),Nqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});function e(r){let i=r.length,n=0,a=0,o;for(;a<i;)n++,o=r.charCodeAt(a++),o>=55296&&o<=56319&&a<i&&(o=r.charCodeAt(a),(o&64512)===56320&&a++);return n}s(e,"ucs2length"),t.default=e,e.code='require("ajv/dist/runtime/ucs2length").default'}),Fqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i=Nqe(),n,a,o={message({keyword:m,schemaCode:y}){let v=m==="maxLength"?"more":"fewer";return(0,e.str)(n||(n=je(["must NOT have "," than "," characters"])),v,y)},params:s(({schemaCode:m})=>(0,e._)(a||(a=je(["{limit: ","}"])),m),"params")},l,u,c,p={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:o,code(m){let{keyword:y,data:v,schemaCode:w,it:E}=m,M=y==="maxLength"?e.operators.GT:e.operators.LT,I=E.opts.unicode===!1?(0,e._)(l||(l=je(["",".length"])),v):(0,e._)(u||(u=je(["","(",")"])),(0,r.useFunc)(m.gen,i.default),v);m.fail$data((0,e._)(c||(c=je([""," "," ",""])),I,M,w))}};t.default=p}),Bqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=on(),i,n,a={message:s(({schemaCode:c})=>(0,r.str)(i||(i=je(['must match pattern "','"'])),c),"message"),params:s(({schemaCode:c})=>(0,r._)(n||(n=je(["{pattern: ","}"])),c),"params")},o,l,u={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:a,code(c){let{data:p,$data:m,schema:y,schemaCode:v,it:w}=c,E=w.opts.unicodeRegExp?"u":"",M=m?(0,r._)(o||(o=je(["(new RegExp(",", ","))"])),v,E):(0,e.usePattern)(c,y);c.fail$data((0,r._)(l||(l=je(["!",".test(",")"])),M,p))}};t.default=u}),zqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r,i,n={message({keyword:l,schemaCode:u}){let c=l==="maxProperties"?"more":"fewer";return(0,e.str)(r||(r=je(["must NOT have "," than "," properties"])),c,u)},params:s(({schemaCode:l})=>(0,e._)(i||(i=je(["{limit: ","}"])),l),"params")},a,o={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:n,code(l){let{keyword:u,data:c,schemaCode:p}=l,m=u==="maxProperties"?e.operators.GT:e.operators.LT;l.fail$data((0,e._)(a||(a=je(["Object.keys(",").length "," ",""])),c,m,p))}};t.default=o}),Uqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=on(),i=Bn(),n,a,o={message:s(({params:{missingProperty:u}})=>(0,r.str)(n||(n=je(["must have required property '","'"])),u),"message"),params:s(({params:{missingProperty:u}})=>(0,r._)(a||(a=je(["{missingProperty: ","}"])),u),"params")},l={keyword:"required",type:"object",schemaType:"array",$data:!0,error:o,code(u){let{gen:c,schema:p,schemaCode:m,data:y,$data:v,it:w}=u,{opts:E}=w;if(!v&&p.length===0)return;let M=p.length>=E.loopRequired;if(w.allErrors?I():P(),E.strictRequired){let O=u.parentSchema.properties,{definedProperties:F}=u.it;for(let k of p)if((O==null?void 0:O[k])===void 0&&!F.has(k)){let B=w.schemaEnv.baseId+w.errSchemaPath,U='required property "'.concat(k,'" is not defined at "').concat(B,'" (strictRequired)');(0,i.checkStrictMode)(w,U,w.opts.strictRequired)}}function I(){if(M||v)u.block$data(r.nil,C);else for(let O of p)(0,e.checkReportMissingProp)(u,O)}s(I,"allErrorsMode");function P(){let O=c.let("missing");if(M||v){let F=c.let("valid",!0);u.block$data(F,()=>T(O,F)),u.ok(F)}else c.if((0,e.checkMissingProp)(u,p,O)),(0,e.reportMissingProp)(u,O),c.else()}s(P,"exitOnErrorMode");function C(){c.forOf("prop",m,O=>{u.setParams({missingProperty:O}),c.if((0,e.noPropertyInData)(c,y,O,E.ownProperties),()=>u.error())})}s(C,"loopAllRequired");function T(O,F){u.setParams({missingProperty:O}),c.forOf(O,m,()=>{c.assign(F,(0,e.propertyInData)(c,y,O,E.ownProperties)),c.if((0,r.not)(F),()=>{u.error(),c.break()})},r.nil)}s(T,"loopUntilMissing")}};t.default=l}),Vqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r,i,n={message({keyword:l,schemaCode:u}){let c=l==="maxItems"?"more":"fewer";return(0,e.str)(r||(r=je(["must NOT have "," than "," items"])),c,u)},params:s(({schemaCode:l})=>(0,e._)(i||(i=je(["{limit: ","}"])),l),"params")},a,o={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:n,code(l){let{keyword:u,data:c,schemaCode:p}=l,m=u==="maxItems"?e.operators.GT:e.operators.LT;l.fail$data((0,e._)(a||(a=je(["",".length "," ",""])),c,m,p))}};t.default=o}),rz=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=aye();e.code='require("ajv/dist/runtime/equal").default',t.default=e}),jqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=iT(),r=on(),i=Bn(),n=rz(),a,o,l={message:s(({params:{i:B,j:U}})=>(0,r.str)(a||(a=je(["must NOT have duplicate items (items ## "," and "," are identical)"])),U,B),"message"),params:s(({params:{i:B,j:U}})=>(0,r._)(o||(o=je(["{i: ",", j: ","}"])),B,U),"params")},u,c,p,m,y,v,w,E,M,I,P,C,T,O,F,k={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:l,code(B){let{gen:U,data:z,$data:q,schema:W,parentSchema:J,schemaCode:V,it:oe}=B;if(!q&&!W)return;let Y=U.let("valid"),he=J.items?(0,e.getSchemaTypes)(J.items):[];B.block$data(Y,Q,(0,r._)(u||(u=je([""," === false"])),V)),B.ok(Y);function Q(){let K=U.let("i",(0,r._)(c||(c=je(["",".length"])),z)),ce=U.let("j");B.setParams({i:K,j:ce}),U.assign(Y,!0),U.if((0,r._)(p||(p=je([""," > 1"])),K),()=>(ae()?ee:le)(K,ce))}s(Q,"validateUniqueItems");function ae(){return he.length>0&&!he.some(K=>K==="object"||K==="array")}s(ae,"canOptimize");function ee(K,ce){let te=U.name("item"),ne=(0,e.checkDataTypes)(he,te,oe.opts.strictNumbers,e.DataType.Wrong),pe=U.const("indices",(0,r._)(m||(m=je(["{}"]))));U.for((0,r._)(y||(y=je([";","--;"])),K),()=>{U.let(te,(0,r._)(v||(v=je(["","[","]"])),z,K)),U.if(ne,(0,r._)(w||(w=je(["continue"])))),he.length>1&&U.if((0,r._)(E||(E=je(["typeof ",' == "string"'])),te),(0,r._)(M||(M=je(["",' += "_"'])),te)),U.if((0,r._)(I||(I=je(["typeof ","[",'] == "number"'])),pe,te),()=>{U.assign(ce,(0,r._)(P||(P=je(["","[","]"])),pe,te)),B.error(),U.assign(Y,!1).break()}).code((0,r._)(C||(C=je(["","[","] = ",""])),pe,te,K))})}s(ee,"loopN");function le(K,ce){let te=(0,i.useFunc)(U,n.default),ne=U.name("outer");U.label(ne).for((0,r._)(T||(T=je([";","--;"])),K),()=>U.for((0,r._)(O||(O=je([""," = ","; ","--;"])),ce,K,ce),()=>U.if((0,r._)(F||(F=je(["","(","[","], ","[","])"])),te,z,K,z,ce),()=>{B.error(),U.assign(Y,!1).break(ne)})))}s(le,"loopN2")}};t.default=k}),$qe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i=rz(),n,a={message:"must be equal to constant",params:s(({schemaCode:c})=>(0,e._)(n||(n=je(["{allowedValue: ","}"])),c),"params")},o,l,u={keyword:"const",$data:!0,error:a,code(c){let{gen:p,data:m,$data:y,schemaCode:v,schema:w}=c;y||w&&typeof w=="object"?c.fail$data((0,e._)(o||(o=je(["!","(",", ",")"])),(0,r.useFunc)(p,i.default),m,v)):c.fail((0,e._)(l||(l=je([""," !== ",""])),w,m))}};t.default=u}),Gqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i=rz(),n,a={message:"must be equal to one of the allowed values",params:s(({schemaCode:p})=>(0,e._)(n||(n=je(["{allowedValues: ","}"])),p),"params")},o,l,u,c={keyword:"enum",schemaType:"array",$data:!0,error:a,code(p){let{gen:m,data:y,$data:v,schema:w,schemaCode:E,it:M}=p;if(!v&&w.length===0)throw new Error("enum must have non-empty array");let I=w.length>=M.opts.loopEnum,P,C=s(()=>P??(P=(0,r.useFunc)(m,i.default)),"getEql"),T;if(I||v)T=m.let("valid"),p.block$data(T,O);else{if(!Array.isArray(w))throw new Error("ajv implementation error");let k=m.const("vSchema",E);T=(0,e.or)(...w.map((B,U)=>F(k,U)))}p.pass(T);function O(){m.assign(T,!1),m.forOf("v",E,k=>m.if((0,e._)(o||(o=je(["","(",", ",")"])),C(),y,k),()=>m.assign(T,!0).break()))}s(O,"loopEnum");function F(k,B){let U=w[B];return typeof U=="object"&&U!==null?(0,e._)(l||(l=je(["","(",", ","[","])"])),C(),y,k,B):(0,e._)(u||(u=je([""," === ",""])),y,U)}s(F,"equalCode")}};t.default=c}),Hqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Oqe(),r=kqe(),i=Fqe(),n=Bqe(),a=zqe(),o=Uqe(),l=Vqe(),u=jqe(),c=$qe(),p=Gqe(),m=[e.default,r.default,i.default,n.default,a.default,o.default,l.default,u.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},c.default,p.default];t.default=m}),oye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;var e=on(),r=Bn(),i,n,a={message:s(({params:{len:m}})=>(0,e.str)(i||(i=je(["must NOT have more than "," items"])),m),"message"),params:s(({params:{len:m}})=>(0,e._)(n||(n=je(["{limit: ","}"])),m),"params")},o={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:a,code(m){let{parentSchema:y,it:v}=m,{items:w}=y;if(!Array.isArray(w)){(0,r.checkStrictMode)(v,'"additionalItems" is ignored when "items" is not an array of schemas');return}p(m,w)}},l,u,c;function p(m,y){let{gen:v,schema:w,data:E,keyword:M,it:I}=m;I.items=!0;let P=v.const("len",(0,e._)(l||(l=je(["",".length"])),E));if(w===!1)m.setParams({len:y.length}),m.pass((0,e._)(u||(u=je([""," <= ",""])),P,y.length));else if(typeof w=="object"&&!(0,r.alwaysValidSchema)(I,w)){let T=v.var("valid",(0,e._)(c||(c=je([""," <= ",""])),P,y.length));v.if((0,e.not)(T),()=>C(T)),m.ok(T)}function C(T){v.forRange("i",y.length,P,O=>{m.subschema({keyword:M,dataProp:O,dataPropType:r.Type.Num},T),I.allErrors||v.if((0,e.not)(T),()=>v.break())})}s(C,"validateItems")}s(p,"validateAdditionalItems"),t.validateAdditionalItems=p,t.default=o}),sye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;var e=on(),r=Bn(),i=Kh(),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(u){let{schema:c,it:p}=u;if(Array.isArray(c))return l(u,"additionalItems",c);p.items=!0,!(0,r.alwaysValidSchema)(p,c)&&u.ok((0,i.validateArray)(u))}},a,o;function l(u,c,p=u.schema){let{gen:m,parentSchema:y,data:v,keyword:w,it:E}=u;P(y),E.opts.unevaluated&&p.length&&E.items!==!0&&(E.items=r.mergeEvaluated.items(m,p.length,E.items));let M=m.name("valid"),I=m.const("len",(0,e._)(a||(a=je(["",".length"])),v));p.forEach((C,T)=>{(0,r.alwaysValidSchema)(E,C)||(m.if((0,e._)(o||(o=je([""," > ",""])),I,T),()=>u.subschema({keyword:w,schemaProp:T,dataProp:T},M)),u.ok(M))});function P(C){let{opts:T,errSchemaPath:O}=E,F=p.length,k=F===C.minItems&&(F===C.maxItems||C[c]===!1);if(T.strictTuples&&!k){let B='"'.concat(w,'" is ').concat(F,"-tuple, but minItems or maxItems/").concat(c,' are not specified or different at path "').concat(O,'"');(0,r.checkStrictMode)(E,B,T.strictTuples)}}s(P,"checkStrictTuple")}s(l,"validateTuple"),t.validateTuple=l,t.default=n}),qqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=sye(),r={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:s(i=>(0,e.validateTuple)(i,"items"),"code")};t.default=r}),Wqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i=Kh(),n=oye(),a,o,l={message:s(({params:{len:c}})=>(0,e.str)(a||(a=je(["must NOT have more than "," items"])),c),"message"),params:s(({params:{len:c}})=>(0,e._)(o||(o=je(["{limit: ","}"])),c),"params")},u={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:l,code(c){let{schema:p,parentSchema:m,it:y}=c,{prefixItems:v}=m;y.items=!0,!(0,r.alwaysValidSchema)(y,p)&&(v?(0,n.validateAdditionalItems)(c,v):c.ok((0,i.validateArray)(c)))}};t.default=u}),Xqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i,n,a,o,l={message:s(({params:{min:I,max:P}})=>P===void 0?(0,e.str)(i||(i=je(["must contain at least "," valid item(s)"])),I):(0,e.str)(n||(n=je(["must contain at least "," and no more than "," valid item(s)"])),I,P),"message"),params:s(({params:{min:I,max:P}})=>P===void 0?(0,e._)(a||(a=je(["{minContains: ","}"])),I):(0,e._)(o||(o=je(["{minContains: ",", maxContains: ","}"])),I,P),"params")},u,c,p,m,y,v,w,E,M={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:l,code(I){let{gen:P,schema:C,parentSchema:T,data:O,it:F}=I,k,B,{minContains:U,maxContains:z}=T;F.opts.next?(k=U===void 0?1:U,B=z):k=1;let q=P.const("len",(0,e._)(u||(u=je(["",".length"])),O));if(I.setParams({min:k,max:B}),B===void 0&&k===0){(0,r.checkStrictMode)(F,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(B!==void 0&&k>B){(0,r.checkStrictMode)(F,'"minContains" > "maxContains" is always invalid'),I.fail();return}if((0,r.alwaysValidSchema)(F,C)){let Y=(0,e._)(c||(c=je([""," >= ",""])),q,k);B!==void 0&&(Y=(0,e._)(p||(p=je([""," && "," <= ",""])),Y,q,B)),I.pass(Y);return}F.items=!0;let W=P.name("valid");B===void 0&&k===1?V(W,()=>P.if(W,()=>P.break())):k===0?(P.let(W,!0),B!==void 0&&P.if((0,e._)(m||(m=je(["",".length > 0"])),O),J)):(P.let(W,!1),J()),I.result(W,()=>I.reset());function J(){let Y=P.name("_valid"),he=P.let("count",0);V(Y,()=>P.if(Y,()=>oe(he)))}s(J,"validateItemsWithCount");function V(Y,he){P.forRange("i",0,q,Q=>{I.subschema({keyword:"contains",dataProp:Q,dataPropType:r.Type.Num,compositeRule:!0},Y),he()})}s(V,"validateItems");function oe(Y){P.code((0,e._)(y||(y=je(["","++"])),Y)),B===void 0?P.if((0,e._)(v||(v=je([""," >= ",""])),Y,k),()=>P.assign(W,!0).break()):(P.if((0,e._)(w||(w=je([""," > ",""])),Y,B),()=>P.assign(W,!1).break()),k===1?P.assign(W,!0):P.if((0,e._)(E||(E=je([""," >= ",""])),Y,k),()=>P.assign(W,!0)))}s(oe,"checkLimits")}};t.default=M}),Zqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;var e=on(),r=Bn(),i=Kh(),n,a;t.error={message:s(({params:{property:m,depsCount:y,deps:v}})=>{let w=y===1?"property":"properties";return(0,e.str)(n||(n=je(["must have "," "," when property "," is present"])),w,v,m)},"message"),params:s(({params:{property:m,depsCount:y,deps:v,missingProperty:w}})=>(0,e._)(a||(a=je(["{property: ",`,
    missingProperty: `,`,
    depsCount: `,`,
    deps: `,"}"])),m,w,y,v),"params")};var o={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(m){let[y,v]=l(m);c(m,y),p(m,v)}};function l({schema:m}){let y={},v={};for(let w in m){if(w==="__proto__")continue;let E=Array.isArray(m[w])?y:v;E[w]=m[w]}return[y,v]}s(l,"splitDependencies");var u;function c(m,y=m.schema){let{gen:v,data:w,it:E}=m;if(Object.keys(y).length===0)return;let M=v.let("missing");for(let I in y){let P=y[I];if(P.length===0)continue;let C=(0,i.propertyInData)(v,w,I,E.opts.ownProperties);m.setParams({property:I,depsCount:P.length,deps:P.join(", ")}),E.allErrors?v.if(C,()=>{for(let T of P)(0,i.checkReportMissingProp)(m,T)}):(v.if((0,e._)(u||(u=je([""," && (",")"])),C,(0,i.checkMissingProp)(m,P,M))),(0,i.reportMissingProp)(m,M),v.else())}}s(c,"validatePropertyDeps"),t.validatePropertyDeps=c;function p(m,y=m.schema){let{gen:v,data:w,keyword:E,it:M}=m,I=v.name("valid");for(let P in y)(0,r.alwaysValidSchema)(M,y[P])||(v.if((0,i.propertyInData)(v,w,P,M.opts.ownProperties),()=>{let C=m.subschema({keyword:E,schemaProp:P},I);m.mergeValidEvaluated(C,I)},()=>v.var(I,!0)),m.ok(I))}s(p,"validateSchemaDeps"),t.validateSchemaDeps=p,t.default=o}),Yqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i,n={message:"property name must be valid",params:s(({params:o})=>(0,e._)(i||(i=je(["{propertyName: ","}"])),o.propertyName),"params")},a={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:n,code(o){let{gen:l,schema:u,data:c,it:p}=o;if((0,r.alwaysValidSchema)(p,u))return;let m=l.name("valid");l.forIn("key",c,y=>{o.setParams({propertyName:y}),o.subschema({keyword:"propertyNames",data:y,dataTypes:["string"],propertyName:y,compositeRule:!0},m),l.if((0,e.not)(m),()=>{o.error(!0),p.allErrors||l.break()})}),o.ok(m)}};t.default=a}),lye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=on(),i=cg(),n=Bn(),a,o={message:"must NOT have additional properties",params:s(({params:y})=>(0,r._)(a||(a=je(["{additionalProperty: ","}"])),y.additionalProperty),"params")},l,u,c,p,m={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:o,code(y){let{gen:v,schema:w,parentSchema:E,data:M,errsCount:I,it:P}=y;if(!I)throw new Error("ajv implementation error");let{allErrors:C,opts:T}=P;if(P.props=!0,T.removeAdditional!=="all"&&(0,n.alwaysValidSchema)(P,w))return;let O=(0,e.allSchemaProperties)(E.properties),F=(0,e.allSchemaProperties)(E.patternProperties);k(),y.ok((0,r._)(l||(l=je([""," === ",""])),I,i.default.errors));function k(){v.forIn("key",M,W=>{!O.length&&!F.length?z(W):v.if(B(W),()=>z(W))})}s(k,"checkAdditionalProperties");function B(W){let J;if(O.length>8){let V=(0,n.schemaRefOrVal)(P,E.properties,"properties");J=(0,e.isOwnProperty)(v,V,W)}else O.length?J=(0,r.or)(...O.map(V=>(0,r._)(u||(u=je([""," === ",""])),W,V))):J=r.nil;return F.length&&(J=(0,r.or)(J,...F.map(V=>(0,r._)(c||(c=je(["",".test(",")"])),(0,e.usePattern)(y,V),W)))),(0,r.not)(J)}s(B,"isAdditional");function U(W){v.code((0,r._)(p||(p=je(["delete ","[","]"])),M,W))}s(U,"deleteAdditional");function z(W){if(T.removeAdditional==="all"||T.removeAdditional&&w===!1){U(W);return}if(w===!1){y.setParams({additionalProperty:W}),y.error(),C||v.break();return}if(typeof w=="object"&&!(0,n.alwaysValidSchema)(P,w)){let J=v.name("valid");T.removeAdditional==="failing"?(q(W,J,!1),v.if((0,r.not)(J),()=>{y.reset(),U(W)})):(q(W,J),C||v.if((0,r.not)(J),()=>v.break()))}}s(z,"additionalPropertyCode");function q(W,J,V){let oe={keyword:"additionalProperties",dataProp:W,dataPropType:n.Type.Str};V===!1&&Object.assign(oe,{compositeRule:!0,createErrors:!1,allErrors:!1}),y.subschema(oe,J)}s(q,"applyAdditionalSchema")}};t.default=m}),Kqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=HP(),r=Kh(),i=Bn(),n=lye(),a={keyword:"properties",type:"object",schemaType:"object",code(o){let{gen:l,schema:u,parentSchema:c,data:p,it:m}=o;m.opts.removeAdditional==="all"&&c.additionalProperties===void 0&&n.default.code(new e.KeywordCxt(m,n.default,"additionalProperties"));let y=(0,r.allSchemaProperties)(u);for(let I of y)m.definedProperties.add(I);m.opts.unevaluated&&y.length&&m.props!==!0&&(m.props=i.mergeEvaluated.props(l,(0,i.toHash)(y),m.props));let v=y.filter(I=>!(0,i.alwaysValidSchema)(m,u[I]));if(v.length===0)return;let w=l.name("valid");for(let I of v)E(I)?M(I):(l.if((0,r.propertyInData)(l,p,I,m.opts.ownProperties)),M(I),m.allErrors||l.else().var(w,!0),l.endIf()),o.it.definedProperties.add(I),o.ok(w);function E(I){return m.opts.useDefaults&&!m.compositeRule&&u[I].default!==void 0}s(E,"hasDefault");function M(I){o.subschema({keyword:"properties",schemaProp:I,dataProp:I},w)}s(M,"applyPropertySchema")}};t.default=a}),Jqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=on(),i=Bn(),n=Bn(),a,o,l={keyword:"patternProperties",type:"object",schemaType:"object",code(u){let{gen:c,schema:p,data:m,parentSchema:y,it:v}=u,{opts:w}=v,E=(0,e.allSchemaProperties)(p),M=E.filter(k=>(0,i.alwaysValidSchema)(v,p[k]));if(E.length===0||M.length===E.length&&(!v.opts.unevaluated||v.props===!0))return;let I=w.strictSchema&&!w.allowMatchingProperties&&y.properties,P=c.name("valid");v.props!==!0&&!(v.props instanceof r.Name)&&(v.props=(0,n.evaluatedPropsToName)(c,v.props));let{props:C}=v;T();function T(){for(let k of E)I&&O(k),v.allErrors?F(k):(c.var(P,!0),F(k),c.if(P))}s(T,"validatePatternProperties");function O(k){for(let B in I)new RegExp(k).test(B)&&(0,i.checkStrictMode)(v,"property ".concat(B," matches pattern ").concat(k," (use allowMatchingProperties)"))}s(O,"checkMatchingProperties");function F(k){c.forIn("key",m,B=>{c.if((0,r._)(a||(a=je(["",".test(",")"])),(0,e.usePattern)(u,k),B),()=>{let U=M.includes(k);U||u.subschema({keyword:"patternProperties",schemaProp:k,dataProp:B,dataPropType:n.Type.Str},P),v.opts.unevaluated&&C!==!0?c.assign((0,r._)(o||(o=je(["","[","]"])),C,B),!0):!U&&!v.allErrors&&c.if((0,r.not)(P),()=>c.break())})})}s(F,"validateProperties")}};t.default=l}),Qqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Bn(),r={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(i){let{gen:n,schema:a,it:o}=i;if((0,e.alwaysValidSchema)(o,a)){i.fail();return}let l=n.name("valid");i.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},l),i.failResult(l,()=>i.reset(),()=>i.error())},error:{message:"must NOT be valid"}};t.default=r}),eWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:e.validateUnion,error:{message:"must match a schema in anyOf"}};t.default=r}),tWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i,n={message:"must match exactly one schema in oneOf",params:s(({params:u})=>(0,e._)(i||(i=je(["{passingSchemas: ","}"])),u.passing),"params")},a,o,l={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:n,code(u){let{gen:c,schema:p,parentSchema:m,it:y}=u;if(!Array.isArray(p))throw new Error("ajv implementation error");if(y.opts.discriminator&&m.discriminator)return;let v=p,w=c.let("valid",!1),E=c.let("passing",null),M=c.name("_valid");u.setParams({passing:E}),c.block(I),u.result(w,()=>u.reset(),()=>u.error(!0));function I(){v.forEach((P,C)=>{let T;(0,r.alwaysValidSchema)(y,P)?c.var(M,!0):T=u.subschema({keyword:"oneOf",schemaProp:C,compositeRule:!0},M),C>0&&c.if((0,e._)(a||(a=je([""," && ",""])),M,w)).assign(w,!1).assign(E,(0,e._)(o||(o=je(["[",", ","]"])),E,C)).else(),c.if(M,()=>{c.assign(w,!0),c.assign(E,C),T&&u.mergeEvaluated(T,e.Name)})})}s(I,"validateOneOf")}};t.default=l}),rWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Bn(),r={keyword:"allOf",schemaType:"array",code(i){let{gen:n,schema:a,it:o}=i;if(!Array.isArray(a))throw new Error("ajv implementation error");let l=n.name("valid");a.forEach((u,c)=>{if((0,e.alwaysValidSchema)(o,u))return;let p=i.subschema({keyword:"allOf",schemaProp:c},l);i.ok(l),i.mergeEvaluated(p)})}};t.default=r}),iWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=Bn(),i,n,a={message:s(({params:c})=>(0,e.str)(i||(i=je(['must match "','" schema'])),c.ifClause),"message"),params:s(({params:c})=>(0,e._)(n||(n=je(["{failingKeyword: ","}"])),c.ifClause),"params")},o,l={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:a,code(c){let{gen:p,parentSchema:m,it:y}=c;m.then===void 0&&m.else===void 0&&(0,r.checkStrictMode)(y,'"if" without "then" and "else" is ignored');let v=u(y,"then"),w=u(y,"else");if(!v&&!w)return;let E=p.let("valid",!0),M=p.name("_valid");if(I(),c.reset(),v&&w){let C=p.let("ifClause");c.setParams({ifClause:C}),p.if(M,P("then",C),P("else",C))}else v?p.if(M,P("then")):p.if((0,e.not)(M),P("else"));c.pass(E,()=>c.error(!0));function I(){let C=c.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},M);c.mergeEvaluated(C)}s(I,"validateIf");function P(C,T){return()=>{let O=c.subschema({keyword:C},M);p.assign(E,M),c.mergeValidEvaluated(O,E),T?p.assign(T,(0,e._)(o||(o=je(["",""])),C)):c.setParams({ifClause:C})}}s(P,"validateClause")}};function u(c,p){let m=c.schema[p];return m!==void 0&&!(0,r.alwaysValidSchema)(c,m)}s(u,"hasSchema"),t.default=l}),nWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Bn(),r={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:i,parentSchema:n,it:a}){n.if===void 0&&(0,e.checkStrictMode)(a,'"'.concat(i,'" without "if" is ignored'))}};t.default=r}),aWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=oye(),r=qqe(),i=sye(),n=Wqe(),a=Xqe(),o=Zqe(),l=Yqe(),u=lye(),c=Kqe(),p=Jqe(),m=Qqe(),y=eWe(),v=tWe(),w=rWe(),E=iWe(),M=nWe();function I(P=!1){let C=[m.default,y.default,v.default,w.default,E.default,M.default,l.default,u.default,o.default,c.default,p.default];return P?C.push(r.default,n.default):C.push(e.default,i.default),C.push(a.default),C}s(I,"getApplicator"),t.default=I}),oWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r,i,n={message:s(({schemaCode:O})=>(0,e.str)(r||(r=je(['must match format "','"'])),O),"message"),params:s(({schemaCode:O})=>(0,e._)(i||(i=je(["{format: ","}"])),O),"params")},a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:n,code(O,F){let{gen:k,data:B,$data:U,schema:z,schemaCode:q,it:W}=O,{opts:J,errSchemaPath:V,schemaEnv:oe,self:Y}=W;if(!J.validateFormats)return;U?he():Q();function he(){let ae=k.scopeValue("formats",{ref:Y.formats,code:J.code.formats}),ee=k.const("fDef",(0,e._)(a||(a=je(["","[","]"])),ae,q)),le=k.let("fType"),K=k.let("format");k.if((0,e._)(o||(o=je(["typeof ",' == "object" && !('," instanceof RegExp)"])),ee,ee),()=>k.assign(le,(0,e._)(l||(l=je(["",'.type || "string"'])),ee)).assign(K,(0,e._)(u||(u=je(["",".validate"])),ee)),()=>k.assign(le,(0,e._)(c||(c=je(['"string"'])))).assign(K,ee)),O.fail$data((0,e.or)(ce(),te()));function ce(){return J.strictSchema===!1?e.nil:(0,e._)(p||(p=je([""," && !",""])),q,K)}s(ce,"unknownFmt");function te(){let ne=oe.$async?(0,e._)(m||(m=je(["(",".async ? await ","(",") : ","(","))"])),ee,K,B,K,B):(0,e._)(y||(y=je(["","(",")"])),K,B),pe=(0,e._)(v||(v=je(["(typeof ",' == "function" ? '," : ",".test(","))"])),K,ne,K,B);return(0,e._)(w||(w=je([""," && "," !== true && "," === "," && !",""])),K,K,le,F,pe)}s(te,"invalidFmt")}s(he,"validate$DataFormat");function Q(){let ae=Y.formats[z];if(!ae){ce();return}if(ae===!0)return;let[ee,le,K]=te(ae);ee===F&&O.pass(ne());function ce(){if(J.strictSchema===!1){Y.logger.warn(pe());return}throw new Error(pe());function pe(){return'unknown format "'.concat(z,'" ignored in schema at path "').concat(V,'"')}}s(ce,"unknownFormat");function te(pe){let xe=pe instanceof RegExp?(0,e.regexpCode)(pe):J.code.formats?(0,e._)(E||(E=je(["","",""])),J.code.formats,(0,e.getProperty)(z)):void 0,Te=k.scopeValue("formats",{key:z,ref:pe,code:xe});return typeof pe=="object"&&!(pe instanceof RegExp)?[pe.type||"string",pe.validate,(0,e._)(M||(M=je(["",".validate"])),Te)]:["string",pe,Te]}s(te,"getFormat");function ne(){if(typeof ae=="object"&&!(ae instanceof RegExp)&&ae.async){if(!oe.$async)throw new Error("async format in sync schema");return(0,e._)(I||(I=je(["await ","(",")"])),K,B)}return typeof le=="function"?(0,e._)(P||(P=je(["","(",")"])),K,B):(0,e._)(C||(C=je(["",".test(",")"])),K,B)}s(ne,"validCondition")}s(Q,"validateFormat")}};t.default=T}),sWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=oWe(),r=[e.default];t.default=r}),lWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]}),uWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Rqe(),r=Hqe(),i=aWe(),n=sWe(),a=lWe(),o=[e.default,r.default,(0,i.default)(),n.default,a.metadataVocabulary,a.contentVocabulary];t.default=o}),cWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0;var e;(function(r){r.Tag="tag",r.Mapping="mapping"})(e||(t.DiscrError=e={}))}),hWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=on(),r=cWe(),i=tz(),n=qP(),a=Bn(),o,l={message:s(({params:{discrError:y,tagName:v}})=>y===r.DiscrError.Tag?'tag "'.concat(v,'" must be string'):'value of tag "'.concat(v,'" must be in oneOf'),"message"),params:s(({params:{discrError:y,tag:v,tagName:w}})=>(0,e._)(o||(o=je(["{error: ",", tag: ",", tagValue: ","}"])),y,w,v),"params")},u,c,p,m={keyword:"discriminator",type:"object",schemaType:"object",error:l,code(y){let{gen:v,data:w,schema:E,parentSchema:M,it:I}=y,{oneOf:P}=M;if(!I.opts.discriminator)throw new Error("discriminator: requires discriminator option");let C=E.propertyName;if(typeof C!="string")throw new Error("discriminator: requires propertyName");if(E.mapping)throw new Error("discriminator: mapping is not supported");if(!P)throw new Error("discriminator: requires oneOf keyword");let T=v.let("valid",!1),O=v.const("tag",(0,e._)(u||(u=je(["","",""])),w,(0,e.getProperty)(C)));v.if((0,e._)(c||(c=je(["typeof ",' == "string"'])),O),()=>F(),()=>y.error(!1,{discrError:r.DiscrError.Tag,tag:O,tagName:C})),y.ok(T);function F(){let U=B();v.if(!1);for(let z in U)v.elseIf((0,e._)(p||(p=je([""," === ",""])),O,z)),v.assign(T,k(U[z]));v.else(),y.error(!1,{discrError:r.DiscrError.Mapping,tag:O,tagName:C}),v.endIf()}s(F,"validateMapping");function k(U){let z=v.name("valid"),q=y.subschema({keyword:"oneOf",schemaProp:U},z);return y.mergeEvaluated(q,e.Name),z}s(k,"applyTagSchema");function B(){var U;let z={},q=J(M),W=!0;for(let Y=0;Y<P.length;Y++){let he=P[Y];if(he!=null&&he.$ref&&!(0,a.schemaHasRulesButRef)(he,I.self.RULES)){let ae=he.$ref;if(he=i.resolveRef.call(I.self,I.schemaEnv.root,I.baseId,ae),he instanceof i.SchemaEnv&&(he=he.schema),he===void 0)throw new n.default(I.opts.uriResolver,I.baseId,ae)}let Q=(U=he==null?void 0:he.properties)===null||U===void 0?void 0:U[C];if(typeof Q!="object")throw new Error('discriminator: oneOf subschemas (or referenced schemas) must have "properties/'.concat(C,'"'));W=W&&(q||J(he)),V(Q,Y)}if(!W)throw new Error('discriminator: "'.concat(C,'" must be required'));return z;function J({required:Y}){return Array.isArray(Y)&&Y.includes(C)}function V(Y,he){if(Y.const)oe(Y.const,he);else if(Y.enum)for(let Q of Y.enum)oe(Q,he);else throw new Error('discriminator: "properties/'.concat(C,'" must have "const" or "enum"'))}function oe(Y,he){if(typeof Y!="string"||Y in z)throw new Error('discriminator: "'.concat(C,'" values must be unique strings'));z[Y]=he}}s(B,"getMapping")}};t.default=m}),pWe=bt((t,e)=>{e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}}),uye=bt((t,e)=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;var r=Pqe(),i=uWe(),n=hWe(),a=pWe(),o=["/properties"],l="http://json-schema.org/draft-07/schema",u=class extends r.default{_addVocabularies(){super._addVocabularies(),i.default.forEach(E=>this.addVocabulary(E)),this.opts.discriminator&&this.addKeyword(n.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let E=this.opts.$data?this.$dataMetaSchema(a,o):a;this.addMetaSchema(E,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}};s(u,"Ajv");var c=u;t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var p=HP();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:s(function(){return p.KeywordCxt},"get")});var m=on();Object.defineProperty(t,"_",{enumerable:!0,get:s(function(){return m._},"get")}),Object.defineProperty(t,"str",{enumerable:!0,get:s(function(){return m.str},"get")}),Object.defineProperty(t,"stringify",{enumerable:!0,get:s(function(){return m.stringify},"get")}),Object.defineProperty(t,"nil",{enumerable:!0,get:s(function(){return m.nil},"get")}),Object.defineProperty(t,"Name",{enumerable:!0,get:s(function(){return m.Name},"get")}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:s(function(){return m.CodeGen},"get")});var y=ez();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:s(function(){return y.default},"get")});var v=qP();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:s(function(){return v.default},"get")})}),dWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(U,z){return{validate:U,compare:z}}s(e,"fmtDef"),t.fullFormats={date:e(a,o),time:e(u,c),"date-time":e(m,y),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:E,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:new RegExp("^(?:https?|ftp):\\/\\/(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)(?:\\.(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$","iu"),email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:B,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:I,int32:{type:"number",validate:T},int64:{type:"number",validate:O},float:{type:"number",validate:F},double:{type:"number",validate:F},password:!0,binary:!0},t.fastFormats=vt(Ee({},t.fullFormats),{date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,y),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i}),t.formatNames=Object.keys(t.fullFormats);function r(U){return U%4===0&&(U%100!==0||U%400===0)}s(r,"isLeapYear");var i=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a(U){let z=i.exec(U);if(!z)return!1;let q=+z[1],W=+z[2],J=+z[3];return W>=1&&W<=12&&J>=1&&J<=(W===2&&r(q)?29:n[W])}s(a,"date");function o(U,z){if(U&&z)return U>z?1:U<z?-1:0}s(o,"compareDate");var l=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function u(U,z){let q=l.exec(U);if(!q)return!1;let W=+q[1],J=+q[2],V=+q[3],oe=q[5];return(W<=23&&J<=59&&V<=59||W===23&&J===59&&V===60)&&(!z||oe!=="")}s(u,"time");function c(U,z){if(!(U&&z))return;let q=l.exec(U),W=l.exec(z);if(q&&W)return U=q[1]+q[2]+q[3]+(q[4]||""),z=W[1]+W[2]+W[3]+(W[4]||""),U>z?1:U<z?-1:0}s(c,"compareTime");var p=/t|\s/i;function m(U){let z=U.split(p);return z.length===2&&a(z[0])&&u(z[1],!0)}s(m,"date_time");function y(U,z){if(!(U&&z))return;let[q,W]=U.split(p),[J,V]=z.split(p),oe=o(q,J);if(oe!==void 0)return oe||c(W,V)}s(y,"compareDateTime");var v=/\/|:/,w=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function E(U){return v.test(U)&&w.test(U)}s(E,"uri");var M=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function I(U){return M.lastIndex=0,M.test(U)}s(I,"byte");var P=-2147483648,C=2**31-1;function T(U){return Number.isInteger(U)&&U<=C&&U>=P}s(T,"validateInt32");function O(U){return Number.isInteger(U)}s(O,"validateInt64");function F(){return!0}s(F,"validateNumber");var k=/[^\\]\\Z/;function B(U){if(k.test(U))return!1;try{return new RegExp(U),!0}catch{return!1}}s(B,"regex")}),fWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;var e=uye(),r=on(),i=r.operators,n={formatMaximum:{okStr:"<=",ok:i.LTE,fail:i.GT},formatMinimum:{okStr:">=",ok:i.GTE,fail:i.LT},formatExclusiveMaximum:{okStr:"<",ok:i.LT,fail:i.GTE},formatExclusiveMinimum:{okStr:">",ok:i.GT,fail:i.LTE}},a,o,l={message:s(({keyword:E,schemaCode:M})=>r.str(a||(a=je(["should be "," ",""])),n[E].okStr,M),"message"),params:s(({keyword:E,schemaCode:M})=>r._(o||(o=je(["{comparison: ",", limit: ","}"])),n[E].okStr,M),"params")},u,c,p,m,y,v;t.formatLimitDefinition={keyword:Object.keys(n),type:"string",schemaType:"string",$data:!0,error:l,code(E){let{gen:M,data:I,schemaCode:P,keyword:C,it:T}=E,{opts:O,self:F}=T;if(!O.validateFormats)return;let k=new e.KeywordCxt(T,F.RULES.all.format.definition,"format");k.$data?B():U();function B(){let q=M.scopeValue("formats",{ref:F.formats,code:O.code.formats}),W=M.const("fmt",r._(u||(u=je(["","[","]"])),q,k.schemaCode));E.fail$data(r.or(r._(c||(c=je(["typeof ",' != "object"'])),W),r._(p||(p=je([""," instanceof RegExp"])),W),r._(m||(m=je(["typeof ",'.compare != "function"'])),W),z(W)))}s(B,"validate$DataFormat");function U(){let q=k.schema,W=F.formats[q];if(!W||W===!0)return;if(typeof W!="object"||W instanceof RegExp||typeof W.compare!="function")throw new Error('"'.concat(C,'": format "').concat(q,'" does not define "compare" function'));let J=M.scopeValue("formats",{key:q,ref:W,code:O.code.formats?r._(y||(y=je(["","",""])),O.code.formats,r.getProperty(q)):void 0});E.fail$data(z(J))}s(U,"validateFormat");function z(q){return r._(v||(v=je(["",".compare(",", ",") "," 0"])),q,I,P,n[C].fail)}s(z,"compareCode")},dependencies:["format"]};var w=s(E=>(E.addKeyword(t.formatLimitDefinition),E),"formatLimitPlugin");t.default=w}),mWe=bt((t,e)=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var r=dWe(),i=fWe(),n=on(),a=new n.Name("fullFormats"),o=new n.Name("fastFormats"),l=s((p,m={keywords:!0})=>{if(Array.isArray(m))return c(p,m,r.fullFormats,a),p;let[y,v]=m.mode==="fast"?[r.fastFormats,o]:[r.fullFormats,a],w=m.formats||r.formatNames;return c(p,w,y,v),m.keywords&&i.default(p),p},"formatsPlugin");l.get=(p,m="full")=>{let y=(m==="fast"?r.fastFormats:r.fullFormats)[p];if(!y)throw new Error('Unknown format "'.concat(p,'"'));return y};var u;function c(p,m,y,v){var w,E;(w=(E=p.opts.code).formats)!==null&&w!==void 0||(E.formats=n._(u||(u=je(['require("ajv-formats/dist/formats").',""])),v));for(let M of m)p.addFormat(M,y[M])}s(c,"addFormats"),e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l}),gWe=bt((t,e)=>{N();var r=S9();r.default&&(r=r.default),e.exports=i,e.exports.default=i;function i(c,p,m){p=p||1;for(var y,v,w,E,M=0;M<c[0].length;M++){var I=c[0][M];(!M||I[0]<y)&&(y=I[0]),(!M||I[1]<v)&&(v=I[1]),(!M||I[0]>w)&&(w=I[0]),(!M||I[1]>E)&&(E=I[1])}var P=w-y,C=E-v,T=Math.min(P,C),O=T/2;if(T===0){var F=[y,v];return F.distance=0,F}for(var k=new r(void 0,n),B=y;B<w;B+=T)for(var U=v;U<E;U+=T)k.push(new a(B+O,U+O,O,c));var z=l(c),q=new a(y+P/2,v+C/2,0,c);q.d>z.d&&(z=q);for(var W=k.length;k.length;){var J=k.pop();J.d>z.d&&(z=J,m&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,W)),!(J.max-z.d<=p)&&(O=J.h/2,k.push(new a(J.x-O,J.y-O,O,c)),k.push(new a(J.x+O,J.y-O,O,c)),k.push(new a(J.x-O,J.y+O,O,c)),k.push(new a(J.x+O,J.y+O,O,c)),W+=4)}m&&(console.log("num probes: "+W),console.log("best distance: "+z.d));var V=[z.x,z.y];return V.distance=z.d,V}s(i,"polylabel");function n(c,p){return p.max-c.max}s(n,"compareMax");function a(c,p,m,y){this.x=c,this.y=p,this.h=m,this.d=o(c,p,y),this.max=this.d+this.h*Math.SQRT2}s(a,"Cell");function o(c,p,m){for(var y=!1,v=1/0,w=0;w<m.length;w++)for(var E=m[w],M=0,I=E.length,P=I-1;M<I;P=M++){var C=E[M],T=E[P];C[1]>p!=T[1]>p&&c<(T[0]-C[0])*(p-C[1])/(T[1]-C[1])+C[0]&&(y=!y),v=Math.min(v,u(c,p,C,T))}return v===0?0:(y?1:-1)*Math.sqrt(v)}s(o,"pointToPolygonDist");function l(c){for(var p=0,m=0,y=0,v=c[0],w=0,E=v.length,M=E-1;w<E;M=w++){var I=v[w],P=v[M],C=I[0]*P[1]-P[0]*I[1];m+=(I[0]+P[0])*C,y+=(I[1]+P[1])*C,p+=C*3}return p===0?new a(v[0][0],v[0][1],0,c):new a(m/p,y/p,0,c)}s(l,"getCentroidCell");function u(c,p,m,y){var v=m[0],w=m[1],E=y[0]-v,M=y[1]-w;if(E!==0||M!==0){var I=((c-v)*E+(p-w)*M)/(E*E+M*M);I>1?(v=y[0],w=y[1]):I>0&&(v+=E*I,w+=M*I)}return E=c-v,M=p-w,E*E+M*M}s(u,"getSegDistSq")}),cye=bt((t,e)=>{N();var r=200,i="__lodash_hash_undefined__",n=800,a=16,o=9007199254740991,l="[object Arguments]",u="[object Array]",c="[object AsyncFunction]",p="[object Boolean]",m="[object Date]",y="[object Error]",v="[object Function]",w="[object GeneratorFunction]",E="[object Map]",M="[object Number]",I="[object Null]",P="[object Object]",C="[object Proxy]",T="[object RegExp]",O="[object Set]",F="[object String]",k="[object Undefined]",B="[object WeakMap]",U="[object ArrayBuffer]",z="[object DataView]",q="[object Float32Array]",W="[object Float64Array]",J="[object Int8Array]",V="[object Int16Array]",oe="[object Int32Array]",Y="[object Uint8Array]",he="[object Uint8ClampedArray]",Q="[object Uint16Array]",ae="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,le=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,ce={};ce[q]=ce[W]=ce[J]=ce[V]=ce[oe]=ce[Y]=ce[he]=ce[Q]=ce[ae]=!0,ce[l]=ce[u]=ce[U]=ce[p]=ce[z]=ce[m]=ce[y]=ce[v]=ce[E]=ce[M]=ce[P]=ce[T]=ce[O]=ce[F]=ce[B]=!1;var te=typeof global=="object"&&global&&global.Object===Object&&global,ne=typeof self=="object"&&self&&self.Object===Object&&self,pe=te||ne||Function("return this")(),xe=typeof t=="object"&&t&&!t.nodeType&&t,Te=xe&&typeof e=="object"&&e&&!e.nodeType&&e,fe=Te&&Te.exports===xe,Pe=fe&&te.process,me=function(){try{var Ve=Te&&Te.require&&Te.require("util").types;return Ve||Pe&&Pe.binding&&Pe.binding("util")}catch{}}(),Ae=me&&me.isTypedArray;function Ue(Ve,et,be){switch(be.length){case 0:return Ve.call(et);case 1:return Ve.call(et,be[0]);case 2:return Ve.call(et,be[0],be[1]);case 3:return Ve.call(et,be[0],be[1],be[2])}return Ve.apply(et,be)}s(Ue,"apply");function _e(Ve,et){for(var be=-1,Ge=Array(Ve);++be<Ve;)Ge[be]=et(be);return Ge}s(_e,"baseTimes");function lt(Ve){return function(et){return Ve(et)}}s(lt,"baseUnary");function tt(Ve,et){return Ve==null?void 0:Ve[et]}s(tt,"getValue");function We(Ve,et){return function(be){return Ve(et(be))}}s(We,"overArg");var at=Array.prototype,Lt=Function.prototype,dt=Object.prototype,Me=pe["__core-js_shared__"],ve=Lt.toString,Ze=dt.hasOwnProperty,It=function(){var Ve=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return Ve?"Symbol(src)_1."+Ve:""}(),Rt=dt.toString,Et=ve.call(Object),pt=RegExp("^"+ve.call(Ze).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yt=fe?pe.Buffer:void 0,Kt=pe.Symbol,$t=pe.Uint8Array,jt=Yt?Yt.allocUnsafe:void 0,Nt=We(Object.getPrototypeOf,Object),Fe=Object.create,Xe=dt.propertyIsEnumerable,ht=at.splice,rr=Kt?Kt.toStringTag:void 0,ar=function(){try{var Ve=qr(Object,"defineProperty");return Ve({},"",{}),Ve}catch{}}(),Vr=Yt?Yt.isBuffer:void 0,Qe=Math.max,er=Date.now,Oe=qr(pe,"Map"),se=qr(Object,"create"),ue=function(){function Ve(){}return s(Ve,"object"),function(et){if(!_o(et))return{};if(Fe)return Fe(et);Ve.prototype=et;var be=new Ve;return Ve.prototype=void 0,be}}();function Se(Ve){var et=-1,be=Ve==null?0:Ve.length;for(this.clear();++et<be;){var Ge=Ve[et];this.set(Ge[0],Ge[1])}}s(Se,"Hash");function ze(){this.__data__=se?se(null):{},this.size=0}s(ze,"hashClear");function Re(Ve){var et=this.has(Ve)&&delete this.__data__[Ve];return this.size-=et?1:0,et}s(Re,"hashDelete");function yt(Ve){var et=this.__data__;if(se){var be=et[Ve];return be===i?void 0:be}return Ze.call(et,Ve)?et[Ve]:void 0}s(yt,"hashGet");function st(Ve){var et=this.__data__;return se?et[Ve]!==void 0:Ze.call(et,Ve)}s(st,"hashHas");function kt(Ve,et){var be=this.__data__;return this.size+=this.has(Ve)?0:1,be[Ve]=se&&et===void 0?i:et,this}s(kt,"hashSet"),Se.prototype.clear=ze,Se.prototype.delete=Re,Se.prototype.get=yt,Se.prototype.has=st,Se.prototype.set=kt;function mt(Ve){var et=-1,be=Ve==null?0:Ve.length;for(this.clear();++et<be;){var Ge=Ve[et];this.set(Ge[0],Ge[1])}}s(mt,"ListCache");function Gt(){this.__data__=[],this.size=0}s(Gt,"listCacheClear");function ke(Ve){var et=this.__data__,be=ft(et,Ve);if(be<0)return!1;var Ge=et.length-1;return be==Ge?et.pop():ht.call(et,be,1),--this.size,!0}s(ke,"listCacheDelete");function $e(Ve){var et=this.__data__,be=ft(et,Ve);return be<0?void 0:et[be][1]}s($e,"listCacheGet");function ot(Ve){return ft(this.__data__,Ve)>-1}s(ot,"listCacheHas");function Ft(Ve,et){var be=this.__data__,Ge=ft(be,Ve);return Ge<0?(++this.size,be.push([Ve,et])):be[Ge][1]=et,this}s(Ft,"listCacheSet"),mt.prototype.clear=Gt,mt.prototype.delete=ke,mt.prototype.get=$e,mt.prototype.has=ot,mt.prototype.set=Ft;function Ht(Ve){var et=-1,be=Ve==null?0:Ve.length;for(this.clear();++et<be;){var Ge=Ve[et];this.set(Ge[0],Ge[1])}}s(Ht,"MapCache");function fr(){this.size=0,this.__data__={hash:new Se,map:new(Oe||mt),string:new Se}}s(fr,"mapCacheClear");function nr(Ve){var et=Vi(this,Ve).delete(Ve);return this.size-=et?1:0,et}s(nr,"mapCacheDelete");function Kr(Ve){return Vi(this,Ve).get(Ve)}s(Kr,"mapCacheGet");function ai(Ve){return Vi(this,Ve).has(Ve)}s(ai,"mapCacheHas");function Jr(Ve,et){var be=Vi(this,Ve),Ge=be.size;return be.set(Ve,et),this.size+=be.size==Ge?0:1,this}s(Jr,"mapCacheSet"),Ht.prototype.clear=fr,Ht.prototype.delete=nr,Ht.prototype.get=Kr,Ht.prototype.has=ai,Ht.prototype.set=Jr;function Cr(Ve){var et=this.__data__=new mt(Ve);this.size=et.size}s(Cr,"Stack");function Ei(){this.__data__=new mt,this.size=0}s(Ei,"stackClear");function Hr(Ve){var et=this.__data__,be=et.delete(Ve);return this.size=et.size,be}s(Hr,"stackDelete");function en(Ve){return this.__data__.get(Ve)}s(en,"stackGet");function Hi(Ve){return this.__data__.has(Ve)}s(Hi,"stackHas");function En(Ve,et){var be=this.__data__;if(be instanceof mt){var Ge=be.__data__;if(!Oe||Ge.length<r-1)return Ge.push([Ve,et]),this.size=++be.size,this;be=this.__data__=new Ht(Ge)}return be.set(Ve,et),this.size=be.size,this}s(En,"stackSet"),Cr.prototype.clear=Ei,Cr.prototype.delete=Hr,Cr.prototype.get=en,Cr.prototype.has=Hi,Cr.prototype.set=En;function Ie(Ve,et){var be=sn(Ve),Ge=!be&&Er(Ve),nt=!be&&!Ge&&zl(Ve),Wt=!be&&!Ge&&!nt&&pl(Ve),Br=be||Ge||nt||Wt,Or=Br?_e(Ve.length,String):[],ci=Or.length;for(var gi in Ve)(et||Ze.call(Ve,gi))&&!(Br&&(gi=="length"||nt&&(gi=="offset"||gi=="parent")||Wt&&(gi=="buffer"||gi=="byteLength"||gi=="byteOffset")||j(gi,ci)))&&Or.push(gi);return Or}s(Ie,"arrayLikeKeys");function Je(Ve,et,be){(be!==void 0&&!lr(Ve[et],be)||be===void 0&&!(et in Ve))&&rt(Ve,et,be)}s(Je,"assignMergeValue");function wt(Ve,et,be){var Ge=Ve[et];(!(Ze.call(Ve,et)&&lr(Ge,be))||be===void 0&&!(et in Ve))&&rt(Ve,et,be)}s(wt,"assignValue");function ft(Ve,et){for(var be=Ve.length;be--;)if(lr(Ve[be][0],et))return be;return-1}s(ft,"assocIndexOf");function rt(Ve,et,be){et=="__proto__"&&ar?ar(Ve,et,{configurable:!0,enumerable:!0,value:be,writable:!0}):Ve[et]=be}s(rt,"baseAssignValue");var zt=ta();function cr(Ve){return Ve==null?Ve===void 0?k:I:rr&&rr in Object(Ve)?S(Ve):ct(Ve)}s(cr,"baseGetTag");function ur(Ve){return Ni(Ve)&&cr(Ve)==l}s(ur,"baseIsArguments");function Ar(Ve){if(!_o(Ve)||we(Ve))return!1;var et=la(Ve)?pt:le;return et.test(xr(Ve))}s(Ar,"baseIsNative");function Fr(Ve){return Ni(Ve)&&ui(Ve.length)&&!!ce[cr(Ve)]}s(Fr,"baseIsTypedArray");function Xr(Ve){if(!_o(Ve))return Le(Ve);var et=Ce(Ve),be=[];for(var Ge in Ve)Ge=="constructor"&&(et||!Ze.call(Ve,Ge))||be.push(Ge);return be}s(Xr,"baseKeysIn");function Zr(Ve,et,be,Ge,nt){Ve!==et&&zt(et,function(Wt,Br){if(nt||(nt=new Cr),_o(Wt))_i(Ve,et,Br,be,Zr,Ge,nt);else{var Or=Ge?Ge(qt(Ve,Br),Wt,Br+"",Ve,et,nt):void 0;Or===void 0&&(Or=Wt),Je(Ve,Br,Or)}},Ta)}s(Zr,"baseMerge");function _i(Ve,et,be,Ge,nt,Wt,Br){var Or=qt(Ve,be),ci=qt(et,be),gi=Br.get(ci);if(gi){Je(Ve,be,gi);return}var Fi=Wt?Wt(Or,ci,be+"",Ve,et,Br):void 0,cn=Fi===void 0;if(cn){var Vn=sn(ci),Xn=!Vn&&zl(ci),dl=!Vn&&!Xn&&pl(ci);Fi=ci,Vn||Xn||dl?sn(Or)?Fi=Or:ln(Or)?Fi=$r(Or):Xn?(cn=!1,Fi=vi(ci,!0)):dl?(cn=!1,Fi=Yr(ci,!0)):Fi=[]:xo(ci)||Er(ci)?(Fi=Or,Er(Or)?Fi=un(Or):(!_o(Or)||la(Or))&&(Fi=R(ci))):cn=!1}cn&&(Br.set(ci,Fi),nt(Fi,ci,Ge,Wt,Br),Br.delete(ci)),Je(Ve,be,Fi)}s(_i,"baseMergeDeep");function Di(Ve,et){return sr(_t(Ve,et,ys),Ve+"")}s(Di,"baseRest");var jr=ar?function(Ve,et){return ar(Ve,"toString",{configurable:!0,enumerable:!1,value:ka(et),writable:!0})}:ys;function vi(Ve,et){if(et)return Ve.slice();var be=Ve.length,Ge=jt?jt(be):new Ve.constructor(be);return Ve.copy(Ge),Ge}s(vi,"cloneBuffer");function wi(Ve){var et=new Ve.constructor(Ve.byteLength);return new $t(et).set(new $t(Ve)),et}s(wi,"cloneArrayBuffer");function Yr(Ve,et){var be=et?wi(Ve.buffer):Ve.buffer;return new Ve.constructor(be,Ve.byteOffset,Ve.length)}s(Yr,"cloneTypedArray");function $r(Ve,et){var be=-1,Ge=Ve.length;for(et||(et=Array(Ge));++be<Ge;)et[be]=Ve[be];return et}s($r,"copyArray");function li(Ve,et,be,Ge){var nt=!be;be||(be={});for(var Wt=-1,Br=et.length;++Wt<Br;){var Or=et[Wt],ci=Ge?Ge(be[Or],Ve[Or],Or,be,Ve):void 0;ci===void 0&&(ci=Ve[Or]),nt?rt(be,Or,ci):wt(be,Or,ci)}return be}s(li,"copyObject");function sa(Ve){return Di(function(et,be){var Ge=-1,nt=be.length,Wt=nt>1?be[nt-1]:void 0,Br=nt>2?be[2]:void 0;for(Wt=Ve.length>3&&typeof Wt=="function"?(nt--,Wt):void 0,Br&&Z(be[0],be[1],Br)&&(Wt=nt<3?void 0:Wt,nt=1),et=Object(et);++Ge<nt;){var Or=be[Ge];Or&&Ve(et,Or,Ge,Wt)}return et})}s(sa,"createAssigner");function ta(Ve){return function(et,be,Ge){for(var nt=-1,Wt=Object(et),Br=Ge(et),Or=Br.length;Or--;){var ci=Br[Ve?Or:++nt];if(be(Wt[ci],ci,Wt)===!1)break}return et}}s(ta,"createBaseFor");function Vi(Ve,et){var be=Ve.__data__;return ie(et)?be[typeof et=="string"?"string":"hash"]:be.map}s(Vi,"getMapData");function qr(Ve,et){var be=tt(Ve,et);return Ar(be)?be:void 0}s(qr,"getNative");function S(Ve){var et=Ze.call(Ve,rr),be=Ve[rr];try{Ve[rr]=void 0;var Ge=!0}catch{}var nt=Rt.call(Ve);return Ge&&(et?Ve[rr]=be:delete Ve[rr]),nt}s(S,"getRawTag");function R(Ve){return typeof Ve.constructor=="function"&&!Ce(Ve)?ue(Nt(Ve)):{}}s(R,"initCloneObject");function j(Ve,et){var be=typeof Ve;return et=et??o,!!et&&(be=="number"||be!="symbol"&&K.test(Ve))&&Ve>-1&&Ve%1==0&&Ve<et}s(j,"isIndex");function Z(Ve,et,be){if(!_o(be))return!1;var Ge=typeof et;return(Ge=="number"?ra(be)&&j(et,be.length):Ge=="string"&&et in be)?lr(be[et],Ve):!1}s(Z,"isIterateeCall");function ie(Ve){var et=typeof Ve;return et=="string"||et=="number"||et=="symbol"||et=="boolean"?Ve!=="__proto__":Ve===null}s(ie,"isKeyable");function we(Ve){return!!It&&It in Ve}s(we,"isMasked");function Ce(Ve){var et=Ve&&Ve.constructor,be=typeof et=="function"&&et.prototype||dt;return Ve===be}s(Ce,"isPrototype");function Le(Ve){var et=[];if(Ve!=null)for(var be in Object(Ve))et.push(be);return et}s(Le,"nativeKeysIn");function ct(Ve){return Rt.call(Ve)}s(ct,"objectToString");function _t(Ve,et,be){return et=Qe(et===void 0?Ve.length-1:et,0),function(){for(var Ge=arguments,nt=-1,Wt=Qe(Ge.length-et,0),Br=Array(Wt);++nt<Wt;)Br[nt]=Ge[et+nt];nt=-1;for(var Or=Array(et+1);++nt<et;)Or[nt]=Ge[nt];return Or[et]=be(Br),Ue(Ve,this,Or)}}s(_t,"overRest");function qt(Ve,et){if(!(et==="constructor"&&typeof Ve[et]=="function")&&et!="__proto__")return Ve[et]}s(qt,"safeGet");var sr=mr(jr);function mr(Ve){var et=0,be=0;return function(){var Ge=er(),nt=a-(Ge-be);if(be=Ge,nt>0){if(++et>=n)return arguments[0]}else et=0;return Ve.apply(void 0,arguments)}}s(mr,"shortOut");function xr(Ve){if(Ve!=null){try{return ve.call(Ve)}catch{}try{return Ve+""}catch{}}return""}s(xr,"toSource");function lr(Ve,et){return Ve===et||Ve!==Ve&&et!==et}s(lr,"eq");var Er=ur(function(){return arguments}())?ur:function(Ve){return Ni(Ve)&&Ze.call(Ve,"callee")&&!Xe.call(Ve,"callee")},sn=Array.isArray;function ra(Ve){return Ve!=null&&ui(Ve.length)&&!la(Ve)}s(ra,"isArrayLike");function ln(Ve){return Ni(Ve)&&ra(Ve)}s(ln,"isArrayLikeObject");var zl=Vr||Wn;function la(Ve){if(!_o(Ve))return!1;var et=cr(Ve);return et==v||et==w||et==c||et==C}s(la,"isFunction");function ui(Ve){return typeof Ve=="number"&&Ve>-1&&Ve%1==0&&Ve<=o}s(ui,"isLength");function _o(Ve){var et=typeof Ve;return Ve!=null&&(et=="object"||et=="function")}s(_o,"isObject");function Ni(Ve){return Ve!=null&&typeof Ve=="object"}s(Ni,"isObjectLike");function xo(Ve){if(!Ni(Ve)||cr(Ve)!=P)return!1;var et=Nt(Ve);if(et===null)return!0;var be=Ze.call(et,"constructor")&&et.constructor;return typeof be=="function"&&be instanceof be&&ve.call(be)==Et}s(xo,"isPlainObject");var pl=Ae?lt(Ae):Fr;function un(Ve){return li(Ve,Ta(Ve))}s(un,"toPlainObject");function Ta(Ve){return ra(Ve)?Ie(Ve,!0):Xr(Ve)}s(Ta,"keysIn");var Ul=sa(function(Ve,et,be){Zr(Ve,et,be)});function ka(Ve){return function(){return Ve}}s(ka,"constant");function ys(Ve){return Ve}s(ys,"identity");function Wn(){return!1}s(Wn,"stubFalse"),e.exports=Ul}),hye=bt((t,e)=>{N();var r=200,i="__lodash_hash_undefined__",n=800,a=16,o=9007199254740991,l="[object Arguments]",u="[object Array]",c="[object AsyncFunction]",p="[object Boolean]",m="[object Date]",y="[object Error]",v="[object Function]",w="[object GeneratorFunction]",E="[object Map]",M="[object Number]",I="[object Null]",P="[object Object]",C="[object Proxy]",T="[object RegExp]",O="[object Set]",F="[object String]",k="[object Undefined]",B="[object WeakMap]",U="[object ArrayBuffer]",z="[object DataView]",q="[object Float32Array]",W="[object Float64Array]",J="[object Int8Array]",V="[object Int16Array]",oe="[object Int32Array]",Y="[object Uint8Array]",he="[object Uint8ClampedArray]",Q="[object Uint16Array]",ae="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,le=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,ce={};ce[q]=ce[W]=ce[J]=ce[V]=ce[oe]=ce[Y]=ce[he]=ce[Q]=ce[ae]=!0,ce[l]=ce[u]=ce[U]=ce[p]=ce[z]=ce[m]=ce[y]=ce[v]=ce[E]=ce[M]=ce[P]=ce[T]=ce[O]=ce[F]=ce[B]=!1;var te=typeof global=="object"&&global&&global.Object===Object&&global,ne=typeof self=="object"&&self&&self.Object===Object&&self,pe=te||ne||Function("return this")(),xe=typeof t=="object"&&t&&!t.nodeType&&t,Te=xe&&typeof e=="object"&&e&&!e.nodeType&&e,fe=Te&&Te.exports===xe,Pe=fe&&te.process,me=function(){try{var be=Te&&Te.require&&Te.require("util").types;return be||Pe&&Pe.binding&&Pe.binding("util")}catch{}}(),Ae=me&&me.isTypedArray;function Ue(be,Ge,nt){switch(nt.length){case 0:return be.call(Ge);case 1:return be.call(Ge,nt[0]);case 2:return be.call(Ge,nt[0],nt[1]);case 3:return be.call(Ge,nt[0],nt[1],nt[2])}return be.apply(Ge,nt)}s(Ue,"apply");function _e(be,Ge){for(var nt=-1,Wt=Array(be);++nt<be;)Wt[nt]=Ge(nt);return Wt}s(_e,"baseTimes");function lt(be){return function(Ge){return be(Ge)}}s(lt,"baseUnary");function tt(be,Ge){return be==null?void 0:be[Ge]}s(tt,"getValue");function We(be,Ge){return function(nt){return be(Ge(nt))}}s(We,"overArg");var at=Array.prototype,Lt=Function.prototype,dt=Object.prototype,Me=pe["__core-js_shared__"],ve=Lt.toString,Ze=dt.hasOwnProperty,It=function(){var be=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return be?"Symbol(src)_1."+be:""}(),Rt=dt.toString,Et=ve.call(Object),pt=RegExp("^"+ve.call(Ze).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yt=fe?pe.Buffer:void 0,Kt=pe.Symbol,$t=pe.Uint8Array,jt=Yt?Yt.allocUnsafe:void 0,Nt=We(Object.getPrototypeOf,Object),Fe=Object.create,Xe=dt.propertyIsEnumerable,ht=at.splice,rr=Kt?Kt.toStringTag:void 0,ar=function(){try{var be=S(Object,"defineProperty");return be({},"",{}),be}catch{}}(),Vr=Yt?Yt.isBuffer:void 0,Qe=Math.max,er=Date.now,Oe=S(pe,"Map"),se=S(Object,"create"),ue=function(){function be(){}return s(be,"object"),function(Ge){if(!Ni(Ge))return{};if(Fe)return Fe(Ge);be.prototype=Ge;var nt=new be;return be.prototype=void 0,nt}}();function Se(be){var Ge=-1,nt=be==null?0:be.length;for(this.clear();++Ge<nt;){var Wt=be[Ge];this.set(Wt[0],Wt[1])}}s(Se,"Hash");function ze(){this.__data__=se?se(null):{},this.size=0}s(ze,"hashClear");function Re(be){var Ge=this.has(be)&&delete this.__data__[be];return this.size-=Ge?1:0,Ge}s(Re,"hashDelete");function yt(be){var Ge=this.__data__;if(se){var nt=Ge[be];return nt===i?void 0:nt}return Ze.call(Ge,be)?Ge[be]:void 0}s(yt,"hashGet");function st(be){var Ge=this.__data__;return se?Ge[be]!==void 0:Ze.call(Ge,be)}s(st,"hashHas");function kt(be,Ge){var nt=this.__data__;return this.size+=this.has(be)?0:1,nt[be]=se&&Ge===void 0?i:Ge,this}s(kt,"hashSet"),Se.prototype.clear=ze,Se.prototype.delete=Re,Se.prototype.get=yt,Se.prototype.has=st,Se.prototype.set=kt;function mt(be){var Ge=-1,nt=be==null?0:be.length;for(this.clear();++Ge<nt;){var Wt=be[Ge];this.set(Wt[0],Wt[1])}}s(mt,"ListCache");function Gt(){this.__data__=[],this.size=0}s(Gt,"listCacheClear");function ke(be){var Ge=this.__data__,nt=ft(Ge,be);if(nt<0)return!1;var Wt=Ge.length-1;return nt==Wt?Ge.pop():ht.call(Ge,nt,1),--this.size,!0}s(ke,"listCacheDelete");function $e(be){var Ge=this.__data__,nt=ft(Ge,be);return nt<0?void 0:Ge[nt][1]}s($e,"listCacheGet");function ot(be){return ft(this.__data__,be)>-1}s(ot,"listCacheHas");function Ft(be,Ge){var nt=this.__data__,Wt=ft(nt,be);return Wt<0?(++this.size,nt.push([be,Ge])):nt[Wt][1]=Ge,this}s(Ft,"listCacheSet"),mt.prototype.clear=Gt,mt.prototype.delete=ke,mt.prototype.get=$e,mt.prototype.has=ot,mt.prototype.set=Ft;function Ht(be){var Ge=-1,nt=be==null?0:be.length;for(this.clear();++Ge<nt;){var Wt=be[Ge];this.set(Wt[0],Wt[1])}}s(Ht,"MapCache");function fr(){this.size=0,this.__data__={hash:new Se,map:new(Oe||mt),string:new Se}}s(fr,"mapCacheClear");function nr(be){var Ge=qr(this,be).delete(be);return this.size-=Ge?1:0,Ge}s(nr,"mapCacheDelete");function Kr(be){return qr(this,be).get(be)}s(Kr,"mapCacheGet");function ai(be){return qr(this,be).has(be)}s(ai,"mapCacheHas");function Jr(be,Ge){var nt=qr(this,be),Wt=nt.size;return nt.set(be,Ge),this.size+=nt.size==Wt?0:1,this}s(Jr,"mapCacheSet"),Ht.prototype.clear=fr,Ht.prototype.delete=nr,Ht.prototype.get=Kr,Ht.prototype.has=ai,Ht.prototype.set=Jr;function Cr(be){var Ge=this.__data__=new mt(be);this.size=Ge.size}s(Cr,"Stack");function Ei(){this.__data__=new mt,this.size=0}s(Ei,"stackClear");function Hr(be){var Ge=this.__data__,nt=Ge.delete(be);return this.size=Ge.size,nt}s(Hr,"stackDelete");function en(be){return this.__data__.get(be)}s(en,"stackGet");function Hi(be){return this.__data__.has(be)}s(Hi,"stackHas");function En(be,Ge){var nt=this.__data__;if(nt instanceof mt){var Wt=nt.__data__;if(!Oe||Wt.length<r-1)return Wt.push([be,Ge]),this.size=++nt.size,this;nt=this.__data__=new Ht(Wt)}return nt.set(be,Ge),this.size=nt.size,this}s(En,"stackSet"),Cr.prototype.clear=Ei,Cr.prototype.delete=Hr,Cr.prototype.get=en,Cr.prototype.has=Hi,Cr.prototype.set=En;function Ie(be,Ge){var nt=ra(be),Wt=!nt&&sn(be),Br=!nt&&!Wt&&la(be),Or=!nt&&!Wt&&!Br&&un(be),ci=nt||Wt||Br||Or,gi=ci?_e(be.length,String):[],Fi=gi.length;for(var cn in be)(Ge||Ze.call(be,cn))&&!(ci&&(cn=="length"||Br&&(cn=="offset"||cn=="parent")||Or&&(cn=="buffer"||cn=="byteLength"||cn=="byteOffset")||Z(cn,Fi)))&&gi.push(cn);return gi}s(Ie,"arrayLikeKeys");function Je(be,Ge,nt){(nt!==void 0&&!Er(be[Ge],nt)||nt===void 0&&!(Ge in be))&&rt(be,Ge,nt)}s(Je,"assignMergeValue");function wt(be,Ge,nt){var Wt=be[Ge];(!(Ze.call(be,Ge)&&Er(Wt,nt))||nt===void 0&&!(Ge in be))&&rt(be,Ge,nt)}s(wt,"assignValue");function ft(be,Ge){for(var nt=be.length;nt--;)if(Er(be[nt][0],Ge))return nt;return-1}s(ft,"assocIndexOf");function rt(be,Ge,nt){Ge=="__proto__"&&ar?ar(be,Ge,{configurable:!0,enumerable:!0,value:nt,writable:!0}):be[Ge]=nt}s(rt,"baseAssignValue");var zt=ta();function cr(be){return be==null?be===void 0?k:I:rr&&rr in Object(be)?R(be):_t(be)}s(cr,"baseGetTag");function ur(be){return xo(be)&&cr(be)==l}s(ur,"baseIsArguments");function Ar(be){if(!Ni(be)||Ce(be))return!1;var Ge=ui(be)?pt:le;return Ge.test(lr(be))}s(Ar,"baseIsNative");function Fr(be){return xo(be)&&_o(be.length)&&!!ce[cr(be)]}s(Fr,"baseIsTypedArray");function Xr(be){if(!Ni(be))return ct(be);var Ge=Le(be),nt=[];for(var Wt in be)Wt=="constructor"&&(Ge||!Ze.call(be,Wt))||nt.push(Wt);return nt}s(Xr,"baseKeysIn");function Zr(be,Ge,nt,Wt,Br){be!==Ge&&zt(Ge,function(Or,ci){if(Br||(Br=new Cr),Ni(Or))_i(be,Ge,ci,nt,Zr,Wt,Br);else{var gi=Wt?Wt(sr(be,ci),Or,ci+"",be,Ge,Br):void 0;gi===void 0&&(gi=Or),Je(be,ci,gi)}},ka)}s(Zr,"baseMerge");function _i(be,Ge,nt,Wt,Br,Or,ci){var gi=sr(be,nt),Fi=sr(Ge,nt),cn=ci.get(Fi);if(cn){Je(be,nt,cn);return}var Vn=Or?Or(gi,Fi,nt+"",be,Ge,ci):void 0,Xn=Vn===void 0;if(Xn){var dl=ra(Fi),Ws=!dl&&la(Fi),ip=!dl&&!Ws&&un(Fi);Vn=Fi,dl||Ws||ip?ra(gi)?Vn=gi:zl(gi)?Vn=$r(gi):Ws?(Xn=!1,Vn=vi(Fi,!0)):ip?(Xn=!1,Vn=Yr(Fi,!0)):Vn=[]:pl(Fi)||sn(Fi)?(Vn=gi,sn(gi)?Vn=Ta(gi):(!Ni(gi)||ui(gi))&&(Vn=j(Fi))):Xn=!1}Xn&&(ci.set(Fi,Vn),Br(Vn,Fi,Wt,Or,ci),ci.delete(Fi)),Je(be,nt,Vn)}s(_i,"baseMergeDeep");function Di(be,Ge){return mr(qt(be,Ge,Ve),be+"")}s(Di,"baseRest");var jr=ar?function(be,Ge){return ar(be,"toString",{configurable:!0,enumerable:!1,value:Wn(Ge),writable:!0})}:Ve;function vi(be,Ge){if(Ge)return be.slice();var nt=be.length,Wt=jt?jt(nt):new be.constructor(nt);return be.copy(Wt),Wt}s(vi,"cloneBuffer");function wi(be){var Ge=new be.constructor(be.byteLength);return new $t(Ge).set(new $t(be)),Ge}s(wi,"cloneArrayBuffer");function Yr(be,Ge){var nt=Ge?wi(be.buffer):be.buffer;return new be.constructor(nt,be.byteOffset,be.length)}s(Yr,"cloneTypedArray");function $r(be,Ge){var nt=-1,Wt=be.length;for(Ge||(Ge=Array(Wt));++nt<Wt;)Ge[nt]=be[nt];return Ge}s($r,"copyArray");function li(be,Ge,nt,Wt){var Br=!nt;nt||(nt={});for(var Or=-1,ci=Ge.length;++Or<ci;){var gi=Ge[Or],Fi=Wt?Wt(nt[gi],be[gi],gi,nt,be):void 0;Fi===void 0&&(Fi=be[gi]),Br?rt(nt,gi,Fi):wt(nt,gi,Fi)}return nt}s(li,"copyObject");function sa(be){return Di(function(Ge,nt){var Wt=-1,Br=nt.length,Or=Br>1?nt[Br-1]:void 0,ci=Br>2?nt[2]:void 0;for(Or=be.length>3&&typeof Or=="function"?(Br--,Or):void 0,ci&&ie(nt[0],nt[1],ci)&&(Or=Br<3?void 0:Or,Br=1),Ge=Object(Ge);++Wt<Br;){var gi=nt[Wt];gi&&be(Ge,gi,Wt,Or)}return Ge})}s(sa,"createAssigner");function ta(be){return function(Ge,nt,Wt){for(var Br=-1,Or=Object(Ge),ci=Wt(Ge),gi=ci.length;gi--;){var Fi=ci[be?gi:++Br];if(nt(Or[Fi],Fi,Or)===!1)break}return Ge}}s(ta,"createBaseFor");function Vi(be,Ge,nt,Wt,Br,Or){return Ni(be)&&Ni(Ge)&&(Or.set(Ge,be),Zr(be,Ge,void 0,Vi,Or),Or.delete(Ge)),be}s(Vi,"customDefaultsMerge");function qr(be,Ge){var nt=be.__data__;return we(Ge)?nt[typeof Ge=="string"?"string":"hash"]:nt.map}s(qr,"getMapData");function S(be,Ge){var nt=tt(be,Ge);return Ar(nt)?nt:void 0}s(S,"getNative");function R(be){var Ge=Ze.call(be,rr),nt=be[rr];try{be[rr]=void 0;var Wt=!0}catch{}var Br=Rt.call(be);return Wt&&(Ge?be[rr]=nt:delete be[rr]),Br}s(R,"getRawTag");function j(be){return typeof be.constructor=="function"&&!Le(be)?ue(Nt(be)):{}}s(j,"initCloneObject");function Z(be,Ge){var nt=typeof be;return Ge=Ge??o,!!Ge&&(nt=="number"||nt!="symbol"&&K.test(be))&&be>-1&&be%1==0&&be<Ge}s(Z,"isIndex");function ie(be,Ge,nt){if(!Ni(nt))return!1;var Wt=typeof Ge;return(Wt=="number"?ln(nt)&&Z(Ge,nt.length):Wt=="string"&&Ge in nt)?Er(nt[Ge],be):!1}s(ie,"isIterateeCall");function we(be){var Ge=typeof be;return Ge=="string"||Ge=="number"||Ge=="symbol"||Ge=="boolean"?be!=="__proto__":be===null}s(we,"isKeyable");function Ce(be){return!!It&&It in be}s(Ce,"isMasked");function Le(be){var Ge=be&&be.constructor,nt=typeof Ge=="function"&&Ge.prototype||dt;return be===nt}s(Le,"isPrototype");function ct(be){var Ge=[];if(be!=null)for(var nt in Object(be))Ge.push(nt);return Ge}s(ct,"nativeKeysIn");function _t(be){return Rt.call(be)}s(_t,"objectToString");function qt(be,Ge,nt){return Ge=Qe(Ge===void 0?be.length-1:Ge,0),function(){for(var Wt=arguments,Br=-1,Or=Qe(Wt.length-Ge,0),ci=Array(Or);++Br<Or;)ci[Br]=Wt[Ge+Br];Br=-1;for(var gi=Array(Ge+1);++Br<Ge;)gi[Br]=Wt[Br];return gi[Ge]=nt(ci),Ue(be,this,gi)}}s(qt,"overRest");function sr(be,Ge){if(!(Ge==="constructor"&&typeof be[Ge]=="function")&&Ge!="__proto__")return be[Ge]}s(sr,"safeGet");var mr=xr(jr);function xr(be){var Ge=0,nt=0;return function(){var Wt=er(),Br=a-(Wt-nt);if(nt=Wt,Br>0){if(++Ge>=n)return arguments[0]}else Ge=0;return be.apply(void 0,arguments)}}s(xr,"shortOut");function lr(be){if(be!=null){try{return ve.call(be)}catch{}try{return be+""}catch{}}return""}s(lr,"toSource");function Er(be,Ge){return be===Ge||be!==be&&Ge!==Ge}s(Er,"eq");var sn=ur(function(){return arguments}())?ur:function(be){return xo(be)&&Ze.call(be,"callee")&&!Xe.call(be,"callee")},ra=Array.isArray;function ln(be){return be!=null&&_o(be.length)&&!ui(be)}s(ln,"isArrayLike");function zl(be){return xo(be)&&ln(be)}s(zl,"isArrayLikeObject");var la=Vr||et;function ui(be){if(!Ni(be))return!1;var Ge=cr(be);return Ge==v||Ge==w||Ge==c||Ge==C}s(ui,"isFunction");function _o(be){return typeof be=="number"&&be>-1&&be%1==0&&be<=o}s(_o,"isLength");function Ni(be){var Ge=typeof be;return be!=null&&(Ge=="object"||Ge=="function")}s(Ni,"isObject");function xo(be){return be!=null&&typeof be=="object"}s(xo,"isObjectLike");function pl(be){if(!xo(be)||cr(be)!=P)return!1;var Ge=Nt(be);if(Ge===null)return!0;var nt=Ze.call(Ge,"constructor")&&Ge.constructor;return typeof nt=="function"&&nt instanceof nt&&ve.call(nt)==Et}s(pl,"isPlainObject");var un=Ae?lt(Ae):Fr;function Ta(be){return li(be,ka(be))}s(Ta,"toPlainObject");var Ul=Di(function(be){return be.push(void 0,Vi),Ue(ys,void 0,be)});function ka(be){return ln(be)?Ie(be,!0):Xr(be)}s(ka,"keysIn");var ys=sa(function(be,Ge,nt,Wt){Zr(be,Ge,nt,Wt)});function Wn(be){return function(){return be}}s(Wn,"constant");function Ve(be){return be}s(Ve,"identity");function et(){return!1}s(et,"stubFalse"),e.exports=Ul}),yWe=bt((t,e)=>{N();var r=!1,i={},n=!1;typeof e<"u"&&e.exports?(e.exports=i,n=!0):typeof document<"u"?window.ClipperLib=i:self.ClipperLib=i;var a;n?(o="chrome",a="Netscape"):(o=navigator.userAgent.toString().toLowerCase(),a=navigator.appName);var o,l={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?l.chrome=1:l.chrome=0,o.indexOf("chromium")!=-1?l.chromium=1:l.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?l.safari=1:l.safari=0,o.indexOf("firefox")!=-1?l.firefox=1:l.firefox=0,o.indexOf("firefox/17")!=-1?l.firefox17=1:l.firefox17=0,o.indexOf("firefox/15")!=-1?l.firefox15=1:l.firefox15=0,o.indexOf("firefox/3")!=-1?l.firefox3=1:l.firefox3=0,o.indexOf("opera")!=-1?l.opera=1:l.opera=0,o.indexOf("msie 10")!=-1?l.msie10=1:l.msie10=0,o.indexOf("msie 9")!=-1?l.msie9=1:l.msie9=0,o.indexOf("msie 8")!=-1?l.msie8=1:l.msie8=0,o.indexOf("msie 7")!=-1?l.msie7=1:l.msie7=0,o.indexOf("msie ")!=-1?l.msie=1:l.msie=0,i.biginteger_used=null;var u;function c(S,R,j){i.biginteger_used=1,S!=null&&(typeof S=="number"&&typeof R>"u"?this.fromInt(S):typeof S=="number"?this.fromNumber(S,R,j):R==null&&typeof S!="string"?this.fromString(S,256):this.fromString(S,R))}s(c,"BigInteger");function p(){return new c(null)}s(p,"nbi");function m(S,R,j,Z,ie,we){for(;--we>=0;){var Ce=R*this[S++]+j[Z]+ie;ie=Math.floor(Ce/67108864),j[Z++]=Ce&67108863}return ie}s(m,"am1");function y(S,R,j,Z,ie,we){for(var Ce=R&32767,Le=R>>15;--we>=0;){var ct=this[S]&32767,_t=this[S++]>>15,qt=Le*ct+_t*Ce;ct=Ce*ct+((qt&32767)<<15)+j[Z]+(ie&1073741823),ie=(ct>>>30)+(qt>>>15)+Le*_t+(ie>>>30),j[Z++]=ct&1073741823}return ie}s(y,"am2");function v(S,R,j,Z,ie,we){for(var Ce=R&16383,Le=R>>14;--we>=0;){var ct=this[S]&16383,_t=this[S++]>>14,qt=Le*ct+_t*Ce;ct=Ce*ct+((qt&16383)<<14)+j[Z]+ie,ie=(ct>>28)+(qt>>14)+Le*_t,j[Z++]=ct&268435455}return ie}s(v,"am3"),a=="Microsoft Internet Explorer"?(c.prototype.am=y,u=30):a!="Netscape"?(c.prototype.am=m,u=26):(c.prototype.am=v,u=28),c.prototype.DB=u,c.prototype.DM=(1<<u)-1,c.prototype.DV=1<<u;var w=52;c.prototype.FV=Math.pow(2,w),c.prototype.F1=w-u,c.prototype.F2=2*u-w;var E="0123456789abcdefghijklmnopqrstuvwxyz",M=new Array,I,P;for(I=48,P=0;P<=9;++P)M[I++]=P;for(I=97,P=10;P<36;++P)M[I++]=P;for(I=65,P=10;P<36;++P)M[I++]=P;function C(S){return E.charAt(S)}s(C,"int2char");function T(S,R){var j=M[S.charCodeAt(R)];return j??-1}s(T,"intAt");function O(S){for(var R=this.t-1;R>=0;--R)S[R]=this[R];S.t=this.t,S.s=this.s}s(O,"bnpCopyTo");function F(S){this.t=1,this.s=S<0?-1:0,S>0?this[0]=S:S<-1?this[0]=S+this.DV:this.t=0}s(F,"bnpFromInt");function k(S){var R=p();return R.fromInt(S),R}s(k,"nbv");function B(S,R){var j;if(R==16)j=4;else if(R==8)j=3;else if(R==256)j=8;else if(R==2)j=1;else if(R==32)j=5;else if(R==4)j=2;else{this.fromRadix(S,R);return}this.t=0,this.s=0;for(var Z=S.length,ie=!1,we=0;--Z>=0;){var Ce=j==8?S[Z]&255:T(S,Z);if(Ce<0){S.charAt(Z)=="-"&&(ie=!0);continue}ie=!1,we==0?this[this.t++]=Ce:we+j>this.DB?(this[this.t-1]|=(Ce&(1<<this.DB-we)-1)<<we,this[this.t++]=Ce>>this.DB-we):this[this.t-1]|=Ce<<we,we+=j,we>=this.DB&&(we-=this.DB)}j==8&&(S[0]&128)!=0&&(this.s=-1,we>0&&(this[this.t-1]|=(1<<this.DB-we)-1<<we)),this.clamp(),ie&&c.ZERO.subTo(this,this)}s(B,"bnpFromString");function U(){for(var S=this.s&this.DM;this.t>0&&this[this.t-1]==S;)--this.t}s(U,"bnpClamp");function z(S){if(this.s<0)return"-"+this.negate().toString(S);var R;if(S==16)R=4;else if(S==8)R=3;else if(S==2)R=1;else if(S==32)R=5;else if(S==4)R=2;else return this.toRadix(S);var j=(1<<R)-1,Z,ie=!1,we="",Ce=this.t,Le=this.DB-Ce*this.DB%R;if(Ce-- >0)for(Le<this.DB&&(Z=this[Ce]>>Le)>0&&(ie=!0,we=C(Z));Ce>=0;)Le<R?(Z=(this[Ce]&(1<<Le)-1)<<R-Le,Z|=this[--Ce]>>(Le+=this.DB-R)):(Z=this[Ce]>>(Le-=R)&j,Le<=0&&(Le+=this.DB,--Ce)),Z>0&&(ie=!0),ie&&(we+=C(Z));return ie?we:"0"}s(z,"bnToString");function q(){var S=p();return c.ZERO.subTo(this,S),S}s(q,"bnNegate");function W(){return this.s<0?this.negate():this}s(W,"bnAbs");function J(S){var R=this.s-S.s;if(R!=0)return R;var j=this.t;if(R=j-S.t,R!=0)return this.s<0?-R:R;for(;--j>=0;)if((R=this[j]-S[j])!=0)return R;return 0}s(J,"bnCompareTo");function V(S){var R=1,j;return(j=S>>>16)!=0&&(S=j,R+=16),(j=S>>8)!=0&&(S=j,R+=8),(j=S>>4)!=0&&(S=j,R+=4),(j=S>>2)!=0&&(S=j,R+=2),(j=S>>1)!=0&&(S=j,R+=1),R}s(V,"nbits");function oe(){return this.t<=0?0:this.DB*(this.t-1)+V(this[this.t-1]^this.s&this.DM)}s(oe,"bnBitLength");function Y(S,R){var j;for(j=this.t-1;j>=0;--j)R[j+S]=this[j];for(j=S-1;j>=0;--j)R[j]=0;R.t=this.t+S,R.s=this.s}s(Y,"bnpDLShiftTo");function he(S,R){for(var j=S;j<this.t;++j)R[j-S]=this[j];R.t=Math.max(this.t-S,0),R.s=this.s}s(he,"bnpDRShiftTo");function Q(S,R){var j=S%this.DB,Z=this.DB-j,ie=(1<<Z)-1,we=Math.floor(S/this.DB),Ce=this.s<<j&this.DM,Le;for(Le=this.t-1;Le>=0;--Le)R[Le+we+1]=this[Le]>>Z|Ce,Ce=(this[Le]&ie)<<j;for(Le=we-1;Le>=0;--Le)R[Le]=0;R[we]=Ce,R.t=this.t+we+1,R.s=this.s,R.clamp()}s(Q,"bnpLShiftTo");function ae(S,R){R.s=this.s;var j=Math.floor(S/this.DB);if(j>=this.t){R.t=0;return}var Z=S%this.DB,ie=this.DB-Z,we=(1<<Z)-1;R[0]=this[j]>>Z;for(var Ce=j+1;Ce<this.t;++Ce)R[Ce-j-1]|=(this[Ce]&we)<<ie,R[Ce-j]=this[Ce]>>Z;Z>0&&(R[this.t-j-1]|=(this.s&we)<<ie),R.t=this.t-j,R.clamp()}s(ae,"bnpRShiftTo");function ee(S,R){for(var j=0,Z=0,ie=Math.min(S.t,this.t);j<ie;)Z+=this[j]-S[j],R[j++]=Z&this.DM,Z>>=this.DB;if(S.t<this.t){for(Z-=S.s;j<this.t;)Z+=this[j],R[j++]=Z&this.DM,Z>>=this.DB;Z+=this.s}else{for(Z+=this.s;j<S.t;)Z-=S[j],R[j++]=Z&this.DM,Z>>=this.DB;Z-=S.s}R.s=Z<0?-1:0,Z<-1?R[j++]=this.DV+Z:Z>0&&(R[j++]=Z),R.t=j,R.clamp()}s(ee,"bnpSubTo");function le(S,R){var j=this.abs(),Z=S.abs(),ie=j.t;for(R.t=ie+Z.t;--ie>=0;)R[ie]=0;for(ie=0;ie<Z.t;++ie)R[ie+j.t]=j.am(0,Z[ie],R,ie,0,j.t);R.s=0,R.clamp(),this.s!=S.s&&c.ZERO.subTo(R,R)}s(le,"bnpMultiplyTo");function K(S){for(var R=this.abs(),j=S.t=2*R.t;--j>=0;)S[j]=0;for(j=0;j<R.t-1;++j){var Z=R.am(j,R[j],S,2*j,0,1);(S[j+R.t]+=R.am(j+1,2*R[j],S,2*j+1,Z,R.t-j-1))>=R.DV&&(S[j+R.t]-=R.DV,S[j+R.t+1]=1)}S.t>0&&(S[S.t-1]+=R.am(j,R[j],S,2*j,0,1)),S.s=0,S.clamp()}s(K,"bnpSquareTo");function ce(S,R,j){var Z=S.abs();if(!(Z.t<=0)){var ie=this.abs();if(ie.t<Z.t){R!=null&&R.fromInt(0),j!=null&&this.copyTo(j);return}j==null&&(j=p());var we=p(),Ce=this.s,Le=S.s,ct=this.DB-V(Z[Z.t-1]);ct>0?(Z.lShiftTo(ct,we),ie.lShiftTo(ct,j)):(Z.copyTo(we),ie.copyTo(j));var _t=we.t,qt=we[_t-1];if(qt!=0){var sr=qt*(1<<this.F1)+(_t>1?we[_t-2]>>this.F2:0),mr=this.FV/sr,xr=(1<<this.F1)/sr,lr=1<<this.F2,Er=j.t,sn=Er-_t,ra=R??p();for(we.dlShiftTo(sn,ra),j.compareTo(ra)>=0&&(j[j.t++]=1,j.subTo(ra,j)),c.ONE.dlShiftTo(_t,ra),ra.subTo(we,we);we.t<_t;)we[we.t++]=0;for(;--sn>=0;){var ln=j[--Er]==qt?this.DM:Math.floor(j[Er]*mr+(j[Er-1]+lr)*xr);if((j[Er]+=we.am(0,ln,j,sn,0,_t))<ln)for(we.dlShiftTo(sn,ra),j.subTo(ra,j);j[Er]<--ln;)j.subTo(ra,j)}R!=null&&(j.drShiftTo(_t,R),Ce!=Le&&c.ZERO.subTo(R,R)),j.t=_t,j.clamp(),ct>0&&j.rShiftTo(ct,j),Ce<0&&c.ZERO.subTo(j,j)}}}s(ce,"bnpDivRemTo");function te(S){var R=p();return this.abs().divRemTo(S,null,R),this.s<0&&R.compareTo(c.ZERO)>0&&S.subTo(R,R),R}s(te,"bnMod");function ne(S){this.m=S}s(ne,"Classic");function pe(S){return S.s<0||S.compareTo(this.m)>=0?S.mod(this.m):S}s(pe,"cConvert");function xe(S){return S}s(xe,"cRevert");function Te(S){S.divRemTo(this.m,null,S)}s(Te,"cReduce");function fe(S,R,j){S.multiplyTo(R,j),this.reduce(j)}s(fe,"cMulTo");function Pe(S,R){S.squareTo(R),this.reduce(R)}s(Pe,"cSqrTo"),ne.prototype.convert=pe,ne.prototype.revert=xe,ne.prototype.reduce=Te,ne.prototype.mulTo=fe,ne.prototype.sqrTo=Pe;function me(){if(this.t<1)return 0;var S=this[0];if((S&1)==0)return 0;var R=S&3;return R=R*(2-(S&15)*R)&15,R=R*(2-(S&255)*R)&255,R=R*(2-((S&65535)*R&65535))&65535,R=R*(2-S*R%this.DV)%this.DV,R>0?this.DV-R:-R}s(me,"bnpInvDigit");function Ae(S){this.m=S,this.mp=S.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<S.DB-15)-1,this.mt2=2*S.t}s(Ae,"Montgomery");function Ue(S){var R=p();return S.abs().dlShiftTo(this.m.t,R),R.divRemTo(this.m,null,R),S.s<0&&R.compareTo(c.ZERO)>0&&this.m.subTo(R,R),R}s(Ue,"montConvert");function _e(S){var R=p();return S.copyTo(R),this.reduce(R),R}s(_e,"montRevert");function lt(S){for(;S.t<=this.mt2;)S[S.t++]=0;for(var R=0;R<this.m.t;++R){var j=S[R]&32767,Z=j*this.mpl+((j*this.mph+(S[R]>>15)*this.mpl&this.um)<<15)&S.DM;for(j=R+this.m.t,S[j]+=this.m.am(0,Z,S,R,0,this.m.t);S[j]>=S.DV;)S[j]-=S.DV,S[++j]++}S.clamp(),S.drShiftTo(this.m.t,S),S.compareTo(this.m)>=0&&S.subTo(this.m,S)}s(lt,"montReduce");function tt(S,R){S.squareTo(R),this.reduce(R)}s(tt,"montSqrTo");function We(S,R,j){S.multiplyTo(R,j),this.reduce(j)}s(We,"montMulTo"),Ae.prototype.convert=Ue,Ae.prototype.revert=_e,Ae.prototype.reduce=lt,Ae.prototype.mulTo=We,Ae.prototype.sqrTo=tt;function at(){return(this.t>0?this[0]&1:this.s)==0}s(at,"bnpIsEven");function Lt(S,R){if(S>4294967295||S<1)return c.ONE;var j=p(),Z=p(),ie=R.convert(this),we=V(S)-1;for(ie.copyTo(j);--we>=0;)if(R.sqrTo(j,Z),(S&1<<we)>0)R.mulTo(Z,ie,j);else{var Ce=j;j=Z,Z=Ce}return R.revert(j)}s(Lt,"bnpExp");function dt(S,R){var j;return S<256||R.isEven()?j=new ne(R):j=new Ae(R),this.exp(S,j)}s(dt,"bnModPowInt"),c.prototype.copyTo=O,c.prototype.fromInt=F,c.prototype.fromString=B,c.prototype.clamp=U,c.prototype.dlShiftTo=Y,c.prototype.drShiftTo=he,c.prototype.lShiftTo=Q,c.prototype.rShiftTo=ae,c.prototype.subTo=ee,c.prototype.multiplyTo=le,c.prototype.squareTo=K,c.prototype.divRemTo=ce,c.prototype.invDigit=me,c.prototype.isEven=at,c.prototype.exp=Lt,c.prototype.toString=z,c.prototype.negate=q,c.prototype.abs=W,c.prototype.compareTo=J,c.prototype.bitLength=oe,c.prototype.mod=te,c.prototype.modPowInt=dt,c.ZERO=k(0),c.ONE=k(1);function Me(){var S=p();return this.copyTo(S),S}s(Me,"bnClone");function ve(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}s(ve,"bnIntValue");function Ze(){return this.t==0?this.s:this[0]<<24>>24}s(Ze,"bnByteValue");function It(){return this.t==0?this.s:this[0]<<16>>16}s(It,"bnShortValue");function Rt(S){return Math.floor(Math.LN2*this.DB/Math.log(S))}s(Rt,"bnpChunkSize");function Et(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}s(Et,"bnSigNum");function pt(S){if(S==null&&(S=10),this.signum()==0||S<2||S>36)return"0";var R=this.chunkSize(S),j=Math.pow(S,R),Z=k(j),ie=p(),we=p(),Ce="";for(this.divRemTo(Z,ie,we);ie.signum()>0;)Ce=(j+we.intValue()).toString(S).substr(1)+Ce,ie.divRemTo(Z,ie,we);return we.intValue().toString(S)+Ce}s(pt,"bnpToRadix");function Yt(S,R){this.fromInt(0),R==null&&(R=10);for(var j=this.chunkSize(R),Z=Math.pow(R,j),ie=!1,we=0,Ce=0,Le=0;Le<S.length;++Le){var ct=T(S,Le);if(ct<0){S.charAt(Le)=="-"&&this.signum()==0&&(ie=!0);continue}Ce=R*Ce+ct,++we>=j&&(this.dMultiply(Z),this.dAddOffset(Ce,0),we=0,Ce=0)}we>0&&(this.dMultiply(Math.pow(R,we)),this.dAddOffset(Ce,0)),ie&&c.ZERO.subTo(this,this)}s(Yt,"bnpFromRadix");function Kt(S,R,j){if(typeof R=="number")if(S<2)this.fromInt(1);else for(this.fromNumber(S,j),this.testBit(S-1)||this.bitwiseTo(c.ONE.shiftLeft(S-1),ar,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(R);)this.dAddOffset(2,0),this.bitLength()>S&&this.subTo(c.ONE.shiftLeft(S-1),this);else{var Z=new Array,ie=S&7;Z.length=(S>>3)+1,R.nextBytes(Z),ie>0?Z[0]&=(1<<ie)-1:Z[0]=0,this.fromString(Z,256)}}s(Kt,"bnpFromNumber");function $t(){var S=this.t,R=new Array;R[0]=this.s;var j=this.DB-S*this.DB%8,Z,ie=0;if(S-- >0)for(j<this.DB&&(Z=this[S]>>j)!=(this.s&this.DM)>>j&&(R[ie++]=Z|this.s<<this.DB-j);S>=0;)j<8?(Z=(this[S]&(1<<j)-1)<<8-j,Z|=this[--S]>>(j+=this.DB-8)):(Z=this[S]>>(j-=8)&255,j<=0&&(j+=this.DB,--S)),(Z&128)!=0&&(Z|=-256),ie==0&&(this.s&128)!=(Z&128)&&++ie,(ie>0||Z!=this.s)&&(R[ie++]=Z);return R}s($t,"bnToByteArray");function jt(S){return this.compareTo(S)==0}s(jt,"bnEquals");function Nt(S){return this.compareTo(S)<0?this:S}s(Nt,"bnMin");function Fe(S){return this.compareTo(S)>0?this:S}s(Fe,"bnMax");function Xe(S,R,j){var Z,ie,we=Math.min(S.t,this.t);for(Z=0;Z<we;++Z)j[Z]=R(this[Z],S[Z]);if(S.t<this.t){for(ie=S.s&this.DM,Z=we;Z<this.t;++Z)j[Z]=R(this[Z],ie);j.t=this.t}else{for(ie=this.s&this.DM,Z=we;Z<S.t;++Z)j[Z]=R(ie,S[Z]);j.t=S.t}j.s=R(this.s,S.s),j.clamp()}s(Xe,"bnpBitwiseTo");function ht(S,R){return S&R}s(ht,"op_and");function rr(S){var R=p();return this.bitwiseTo(S,ht,R),R}s(rr,"bnAnd");function ar(S,R){return S|R}s(ar,"op_or");function Vr(S){var R=p();return this.bitwiseTo(S,ar,R),R}s(Vr,"bnOr");function Qe(S,R){return S^R}s(Qe,"op_xor");function er(S){var R=p();return this.bitwiseTo(S,Qe,R),R}s(er,"bnXor");function Oe(S,R){return S&~R}s(Oe,"op_andnot");function se(S){var R=p();return this.bitwiseTo(S,Oe,R),R}s(se,"bnAndNot");function ue(){for(var S=p(),R=0;R<this.t;++R)S[R]=this.DM&~this[R];return S.t=this.t,S.s=~this.s,S}s(ue,"bnNot");function Se(S){var R=p();return S<0?this.rShiftTo(-S,R):this.lShiftTo(S,R),R}s(Se,"bnShiftLeft");function ze(S){var R=p();return S<0?this.lShiftTo(-S,R):this.rShiftTo(S,R),R}s(ze,"bnShiftRight");function Re(S){if(S==0)return-1;var R=0;return(S&65535)==0&&(S>>=16,R+=16),(S&255)==0&&(S>>=8,R+=8),(S&15)==0&&(S>>=4,R+=4),(S&3)==0&&(S>>=2,R+=2),(S&1)==0&&++R,R}s(Re,"lbit");function yt(){for(var S=0;S<this.t;++S)if(this[S]!=0)return S*this.DB+Re(this[S]);return this.s<0?this.t*this.DB:-1}s(yt,"bnGetLowestSetBit");function st(S){for(var R=0;S!=0;)S&=S-1,++R;return R}s(st,"cbit");function kt(){for(var S=0,R=this.s&this.DM,j=0;j<this.t;++j)S+=st(this[j]^R);return S}s(kt,"bnBitCount");function mt(S){var R=Math.floor(S/this.DB);return R>=this.t?this.s!=0:(this[R]&1<<S%this.DB)!=0}s(mt,"bnTestBit");function Gt(S,R){var j=c.ONE.shiftLeft(S);return this.bitwiseTo(j,R,j),j}s(Gt,"bnpChangeBit");function ke(S){return this.changeBit(S,ar)}s(ke,"bnSetBit");function $e(S){return this.changeBit(S,Oe)}s($e,"bnClearBit");function ot(S){return this.changeBit(S,Qe)}s(ot,"bnFlipBit");function Ft(S,R){for(var j=0,Z=0,ie=Math.min(S.t,this.t);j<ie;)Z+=this[j]+S[j],R[j++]=Z&this.DM,Z>>=this.DB;if(S.t<this.t){for(Z+=S.s;j<this.t;)Z+=this[j],R[j++]=Z&this.DM,Z>>=this.DB;Z+=this.s}else{for(Z+=this.s;j<S.t;)Z+=S[j],R[j++]=Z&this.DM,Z>>=this.DB;Z+=S.s}R.s=Z<0?-1:0,Z>0?R[j++]=Z:Z<-1&&(R[j++]=this.DV+Z),R.t=j,R.clamp()}s(Ft,"bnpAddTo");function Ht(S){var R=p();return this.addTo(S,R),R}s(Ht,"bnAdd");function fr(S){var R=p();return this.subTo(S,R),R}s(fr,"bnSubtract");function nr(S){var R=p();return this.multiplyTo(S,R),R}s(nr,"bnMultiply");function Kr(){var S=p();return this.squareTo(S),S}s(Kr,"bnSquare");function ai(S){var R=p();return this.divRemTo(S,R,null),R}s(ai,"bnDivide");function Jr(S){var R=p();return this.divRemTo(S,null,R),R}s(Jr,"bnRemainder");function Cr(S){var R=p(),j=p();return this.divRemTo(S,R,j),new Array(R,j)}s(Cr,"bnDivideAndRemainder");function Ei(S){this[this.t]=this.am(0,S-1,this,0,0,this.t),++this.t,this.clamp()}s(Ei,"bnpDMultiply");function Hr(S,R){if(S!=0){for(;this.t<=R;)this[this.t++]=0;for(this[R]+=S;this[R]>=this.DV;)this[R]-=this.DV,++R>=this.t&&(this[this.t++]=0),++this[R]}}s(Hr,"bnpDAddOffset");function en(){}s(en,"NullExp");function Hi(S){return S}s(Hi,"nNop");function En(S,R,j){S.multiplyTo(R,j)}s(En,"nMulTo");function Ie(S,R){S.squareTo(R)}s(Ie,"nSqrTo"),en.prototype.convert=Hi,en.prototype.revert=Hi,en.prototype.mulTo=En,en.prototype.sqrTo=Ie;function Je(S){return this.exp(S,new en)}s(Je,"bnPow");function wt(S,R,j){var Z=Math.min(this.t+S.t,R);for(j.s=0,j.t=Z;Z>0;)j[--Z]=0;var ie;for(ie=j.t-this.t;Z<ie;++Z)j[Z+this.t]=this.am(0,S[Z],j,Z,0,this.t);for(ie=Math.min(S.t,R);Z<ie;++Z)this.am(0,S[Z],j,Z,0,R-Z);j.clamp()}s(wt,"bnpMultiplyLowerTo");function ft(S,R,j){--R;var Z=j.t=this.t+S.t-R;for(j.s=0;--Z>=0;)j[Z]=0;for(Z=Math.max(R-this.t,0);Z<S.t;++Z)j[this.t+Z-R]=this.am(R-Z,S[Z],j,0,0,this.t+Z-R);j.clamp(),j.drShiftTo(1,j)}s(ft,"bnpMultiplyUpperTo");function rt(S){this.r2=p(),this.q3=p(),c.ONE.dlShiftTo(2*S.t,this.r2),this.mu=this.r2.divide(S),this.m=S}s(rt,"Barrett");function zt(S){if(S.s<0||S.t>2*this.m.t)return S.mod(this.m);if(S.compareTo(this.m)<0)return S;var R=p();return S.copyTo(R),this.reduce(R),R}s(zt,"barrettConvert");function cr(S){return S}s(cr,"barrettRevert");function ur(S){for(S.drShiftTo(this.m.t-1,this.r2),S.t>this.m.t+1&&(S.t=this.m.t+1,S.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);S.compareTo(this.r2)<0;)S.dAddOffset(1,this.m.t+1);for(S.subTo(this.r2,S);S.compareTo(this.m)>=0;)S.subTo(this.m,S)}s(ur,"barrettReduce");function Ar(S,R){S.squareTo(R),this.reduce(R)}s(Ar,"barrettSqrTo");function Fr(S,R,j){S.multiplyTo(R,j),this.reduce(j)}s(Fr,"barrettMulTo"),rt.prototype.convert=zt,rt.prototype.revert=cr,rt.prototype.reduce=ur,rt.prototype.mulTo=Fr,rt.prototype.sqrTo=Ar;function Xr(S,R){var j=S.bitLength(),Z,ie=k(1),we;if(j<=0)return ie;j<18?Z=1:j<48?Z=3:j<144?Z=4:j<768?Z=5:Z=6,j<8?we=new ne(R):R.isEven()?we=new rt(R):we=new Ae(R);var Ce=new Array,Le=3,ct=Z-1,_t=(1<<Z)-1;if(Ce[1]=we.convert(this),Z>1){var qt=p();for(we.sqrTo(Ce[1],qt);Le<=_t;)Ce[Le]=p(),we.mulTo(qt,Ce[Le-2],Ce[Le]),Le+=2}var sr=S.t-1,mr,xr=!0,lr=p(),Er;for(j=V(S[sr])-1;sr>=0;){for(j>=ct?mr=S[sr]>>j-ct&_t:(mr=(S[sr]&(1<<j+1)-1)<<ct-j,sr>0&&(mr|=S[sr-1]>>this.DB+j-ct)),Le=Z;(mr&1)==0;)mr>>=1,--Le;if((j-=Le)<0&&(j+=this.DB,--sr),xr)Ce[mr].copyTo(ie),xr=!1;else{for(;Le>1;)we.sqrTo(ie,lr),we.sqrTo(lr,ie),Le-=2;Le>0?we.sqrTo(ie,lr):(Er=ie,ie=lr,lr=Er),we.mulTo(lr,Ce[mr],ie)}for(;sr>=0&&(S[sr]&1<<j)==0;)we.sqrTo(ie,lr),Er=ie,ie=lr,lr=Er,--j<0&&(j=this.DB-1,--sr)}return we.revert(ie)}s(Xr,"bnModPow");function Zr(S){var R=this.s<0?this.negate():this.clone(),j=S.s<0?S.negate():S.clone();if(R.compareTo(j)<0){var Z=R;R=j,j=Z}var ie=R.getLowestSetBit(),we=j.getLowestSetBit();if(we<0)return R;for(ie<we&&(we=ie),we>0&&(R.rShiftTo(we,R),j.rShiftTo(we,j));R.signum()>0;)(ie=R.getLowestSetBit())>0&&R.rShiftTo(ie,R),(ie=j.getLowestSetBit())>0&&j.rShiftTo(ie,j),R.compareTo(j)>=0?(R.subTo(j,R),R.rShiftTo(1,R)):(j.subTo(R,j),j.rShiftTo(1,j));return we>0&&j.lShiftTo(we,j),j}s(Zr,"bnGCD");function _i(S){if(S<=0)return 0;var R=this.DV%S,j=this.s<0?S-1:0;if(this.t>0)if(R==0)j=this[0]%S;else for(var Z=this.t-1;Z>=0;--Z)j=(R*j+this[Z])%S;return j}s(_i,"bnpModInt");function Di(S){var R=S.isEven();if(this.isEven()&&R||S.signum()==0)return c.ZERO;for(var j=S.clone(),Z=this.clone(),ie=k(1),we=k(0),Ce=k(0),Le=k(1);j.signum()!=0;){for(;j.isEven();)j.rShiftTo(1,j),R?((!ie.isEven()||!we.isEven())&&(ie.addTo(this,ie),we.subTo(S,we)),ie.rShiftTo(1,ie)):we.isEven()||we.subTo(S,we),we.rShiftTo(1,we);for(;Z.isEven();)Z.rShiftTo(1,Z),R?((!Ce.isEven()||!Le.isEven())&&(Ce.addTo(this,Ce),Le.subTo(S,Le)),Ce.rShiftTo(1,Ce)):Le.isEven()||Le.subTo(S,Le),Le.rShiftTo(1,Le);j.compareTo(Z)>=0?(j.subTo(Z,j),R&&ie.subTo(Ce,ie),we.subTo(Le,we)):(Z.subTo(j,Z),R&&Ce.subTo(ie,Ce),Le.subTo(we,Le))}if(Z.compareTo(c.ONE)!=0)return c.ZERO;if(Le.compareTo(S)>=0)return Le.subtract(S);if(Le.signum()<0)Le.addTo(S,Le);else return Le;return Le.signum()<0?Le.add(S):Le}s(Di,"bnModInverse");var jr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],vi=(1<<26)/jr[jr.length-1];function wi(S){var R,j=this.abs();if(j.t==1&&j[0]<=jr[jr.length-1]){for(R=0;R<jr.length;++R)if(j[0]==jr[R])return!0;return!1}if(j.isEven())return!1;for(R=1;R<jr.length;){for(var Z=jr[R],ie=R+1;ie<jr.length&&Z<vi;)Z*=jr[ie++];for(Z=j.modInt(Z);R<ie;)if(Z%jr[R++]==0)return!1}return j.millerRabin(S)}s(wi,"bnIsProbablePrime");function Yr(S){var R=this.subtract(c.ONE),j=R.getLowestSetBit();if(j<=0)return!1;var Z=R.shiftRight(j);S=S+1>>1,S>jr.length&&(S=jr.length);for(var ie=p(),we=0;we<S;++we){ie.fromInt(jr[Math.floor(Math.random()*jr.length)]);var Ce=ie.modPow(Z,this);if(Ce.compareTo(c.ONE)!=0&&Ce.compareTo(R)!=0){for(var Le=1;Le++<j&&Ce.compareTo(R)!=0;)if(Ce=Ce.modPowInt(2,this),Ce.compareTo(c.ONE)==0)return!1;if(Ce.compareTo(R)!=0)return!1}}return!0}s(Yr,"bnpMillerRabin"),c.prototype.chunkSize=Rt,c.prototype.toRadix=pt,c.prototype.fromRadix=Yt,c.prototype.fromNumber=Kt,c.prototype.bitwiseTo=Xe,c.prototype.changeBit=Gt,c.prototype.addTo=Ft,c.prototype.dMultiply=Ei,c.prototype.dAddOffset=Hr,c.prototype.multiplyLowerTo=wt,c.prototype.multiplyUpperTo=ft,c.prototype.modInt=_i,c.prototype.millerRabin=Yr,c.prototype.clone=Me,c.prototype.intValue=ve,c.prototype.byteValue=Ze,c.prototype.shortValue=It,c.prototype.signum=Et,c.prototype.toByteArray=$t,c.prototype.equals=jt,c.prototype.min=Nt,c.prototype.max=Fe,c.prototype.and=rr,c.prototype.or=Vr,c.prototype.xor=er,c.prototype.andNot=se,c.prototype.not=ue,c.prototype.shiftLeft=Se,c.prototype.shiftRight=ze,c.prototype.getLowestSetBit=yt,c.prototype.bitCount=kt,c.prototype.testBit=mt,c.prototype.setBit=ke,c.prototype.clearBit=$e,c.prototype.flipBit=ot,c.prototype.add=Ht,c.prototype.subtract=fr,c.prototype.multiply=nr,c.prototype.divide=ai,c.prototype.remainder=Jr,c.prototype.divideAndRemainder=Cr,c.prototype.modPow=Xr,c.prototype.modInverse=Di,c.prototype.pow=Je,c.prototype.gcd=Zr,c.prototype.isProbablePrime=wi,c.prototype.square=Kr;var $r=c;$r.prototype.IsNegative=function(){return this.compareTo($r.ZERO)==-1},$r.op_Equality=function(S,R){return S.compareTo(R)==0},$r.op_Inequality=function(S,R){return S.compareTo(R)!=0},$r.op_GreaterThan=function(S,R){return S.compareTo(R)>0},$r.op_LessThan=function(S,R){return S.compareTo(R)<0},$r.op_Addition=function(S,R){return new $r(S).add(new $r(R))},$r.op_Subtraction=function(S,R){return new $r(S).subtract(new $r(R))},$r.Int128Mul=function(S,R){return new $r(S).multiply(new $r(R))},$r.op_Division=function(S,R){return S.divide(R)},$r.prototype.ToDouble=function(){return parseFloat(this.toString())},typeof li>"u"&&(li=s(function(S,R){var j;if(typeof Object.getOwnPropertyNames>"u"){for(j in R.prototype)(typeof S.prototype[j]>"u"||S.prototype[j]==Object.prototype[j])&&(S.prototype[j]=R.prototype[j]);for(j in R)typeof S[j]>"u"&&(S[j]=R[j]);S.$baseCtor=R}else{for(var Z=Object.getOwnPropertyNames(R.prototype),ie=0;ie<Z.length;ie++)typeof Object.getOwnPropertyDescriptor(S.prototype,Z[ie])>"u"&&Object.defineProperty(S.prototype,Z[ie],Object.getOwnPropertyDescriptor(R.prototype,Z[ie]));for(j in R)typeof S[j]>"u"&&(S[j]=R[j]);S.$baseCtor=R}},"Inherit"));var li;i.Path=function(){return[]},i.Paths=function(){return[]},i.DoublePoint=function(){var S=arguments;this.X=0,this.Y=0,S.length==1?(this.X=S[0].X,this.Y=S[0].Y):S.length==2&&(this.X=S[0],this.Y=S[1])},i.DoublePoint0=function(){this.X=0,this.Y=0},i.DoublePoint1=function(S){this.X=S.X,this.Y=S.Y},i.DoublePoint2=function(S,R){this.X=S,this.Y=R},i.PolyNode=function(){this.m_Parent=null,this.m_polygon=new i.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},i.PolyNode.prototype.IsHoleNode=function(){for(var S=!0,R=this.m_Parent;R!==null;)S=!S,R=R.m_Parent;return S},i.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},i.PolyNode.prototype.Contour=function(){return this.m_polygon},i.PolyNode.prototype.AddChild=function(S){var R=this.m_Childs.length;this.m_Childs.push(S),S.m_Parent=this,S.m_Index=R},i.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},i.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},i.PolyNode.prototype.Childs=function(){return this.m_Childs},i.PolyNode.prototype.Parent=function(){return this.m_Parent},i.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},i.PolyTree=function(){this.m_AllPolys=[],i.PolyNode.call(this)},i.PolyTree.prototype.Clear=function(){for(var S=0,R=this.m_AllPolys.length;S<R;S++)this.m_AllPolys[S]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},i.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},i.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},li(i.PolyTree,i.PolyNode),i.Math_Abs_Int64=i.Math_Abs_Int32=i.Math_Abs_Double=function(S){return Math.abs(S)},i.Math_Max_Int32_Int32=function(S,R){return Math.max(S,R)},l.msie||l.opera||l.safari?i.Cast_Int32=function(S){return S|0}:i.Cast_Int32=function(S){return~~S},l.chrome?i.Cast_Int64=function(S){return S<-2147483648||S>2147483647?S<0?Math.ceil(S):Math.floor(S):~~S}:l.firefox&&typeof Number.toInteger=="function"?i.Cast_Int64=function(S){return Number.toInteger(S)}:l.msie7||l.msie8?i.Cast_Int64=function(S){return parseInt(S,10)}:l.msie?i.Cast_Int64=function(S){return S<-2147483648||S>2147483647?S<0?Math.ceil(S):Math.floor(S):S|0}:i.Cast_Int64=function(S){return S<0?Math.ceil(S):Math.floor(S)},i.Clear=function(S){S.length=0},i.PI=3.141592653589793,i.PI2=2*3.141592653589793,i.IntPoint=function(){var S=arguments,R=S.length,j,Z;if(this.X=0,this.Y=0,!r)if(R==2)this.X=S[0],this.Y=S[1];else if(R==1)if(S[0]instanceof i.DoublePoint){var j=S[0];this.X=i.Clipper.Round(j.X),this.Y=i.Clipper.Round(j.Y)}else{var Z=S[0];this.X=Z.X,this.Y=Z.Y}else this.X=0,this.Y=0},i.IntPoint.op_Equality=function(S,R){return S.X==R.X&&S.Y==R.Y},i.IntPoint.op_Inequality=function(S,R){return S.X!=R.X||S.Y!=R.Y},i.IntPoint0=function(){this.X=0,this.Y=0},i.IntPoint1=function(S){this.X=S.X,this.Y=S.Y},i.IntPoint1dp=function(S){this.X=i.Clipper.Round(S.X),this.Y=i.Clipper.Round(S.Y)},i.IntPoint2=function(S,R){this.X=S,this.Y=R},i.IntRect=function(){var S=arguments,R=S.length;R==4?(this.left=S[0],this.top=S[1],this.right=S[2],this.bottom=S[3]):R==1?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},i.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},i.IntRect1=function(S){this.left=S.left,this.top=S.top,this.right=S.right,this.bottom=S.bottom},i.IntRect4=function(S,R,j,Z){this.left=S,this.top=R,this.right=j,this.bottom=Z},i.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},i.PolyType={ptSubject:0,ptClip:1},i.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},i.JoinType={jtSquare:0,jtRound:1,jtMiter:2},i.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},i.EdgeSide={esLeft:0,esRight:1},i.Direction={dRightToLeft:0,dLeftToRight:1},i.TEdge=function(){this.Bot=new i.IntPoint,this.Curr=new i.IntPoint,this.Top=new i.IntPoint,this.Delta=new i.IntPoint,this.Dx=0,this.PolyTyp=i.PolyType.ptSubject,this.Side=i.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},i.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new i.IntPoint},i.MyIntersectNodeSort=function(){},i.MyIntersectNodeSort.Compare=function(S,R){return R.Pt.Y-S.Pt.Y},i.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},i.Scanbeam=function(){this.Y=0,this.Next=null},i.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},i.OutPt=function(){this.Idx=0,this.Pt=new i.IntPoint,this.Next=null,this.Prev=null},i.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new i.IntPoint},i.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},i.ClipperBase.horizontal=-9007199254740992,i.ClipperBase.Skip=-2,i.ClipperBase.Unassigned=-1,i.ClipperBase.tolerance=1e-20,i.ClipperBase.loRange=47453132,i.ClipperBase.hiRange=0xfffffffffffff,i.ClipperBase.near_zero=function(S){return S>-i.ClipperBase.tolerance&&S<i.ClipperBase.tolerance},i.ClipperBase.IsHorizontal=function(S){return S.Delta.Y===0},i.ClipperBase.prototype.PointIsVertex=function(S,R){var j=R;do{if(i.IntPoint.op_Equality(j.Pt,S))return!0;j=j.Next}while(j!=R);return!1},i.ClipperBase.prototype.PointOnLineSegment=function(S,R,j,Z){return Z?S.X==R.X&&S.Y==R.Y||S.X==j.X&&S.Y==j.Y||S.X>R.X==S.X<j.X&&S.Y>R.Y==S.Y<j.Y&&$r.op_Equality($r.Int128Mul(S.X-R.X,j.Y-R.Y),$r.Int128Mul(j.X-R.X,S.Y-R.Y)):S.X==R.X&&S.Y==R.Y||S.X==j.X&&S.Y==j.Y||S.X>R.X==S.X<j.X&&S.Y>R.Y==S.Y<j.Y&&(S.X-R.X)*(j.Y-R.Y)==(j.X-R.X)*(S.Y-R.Y)},i.ClipperBase.prototype.PointOnPolygon=function(S,R,j){for(var Z=R;;){if(this.PointOnLineSegment(S,Z.Pt,Z.Next.Pt,j))return!0;if(Z=Z.Next,Z==R)break}return!1},i.ClipperBase.prototype.SlopesEqual=i.ClipperBase.SlopesEqual=function(){var S=arguments,R=S.length,j,Z,ie,we,Ce,Le,ct;return R==3?(j=S[0],Z=S[1],ct=S[2],ct?$r.op_Equality($r.Int128Mul(j.Delta.Y,Z.Delta.X),$r.Int128Mul(j.Delta.X,Z.Delta.Y)):i.Cast_Int64(j.Delta.Y*Z.Delta.X)==i.Cast_Int64(j.Delta.X*Z.Delta.Y)):R==4?(ie=S[0],we=S[1],Ce=S[2],ct=S[3],ct?$r.op_Equality($r.Int128Mul(ie.Y-we.Y,we.X-Ce.X),$r.Int128Mul(ie.X-we.X,we.Y-Ce.Y)):i.Cast_Int64((ie.Y-we.Y)*(we.X-Ce.X))-i.Cast_Int64((ie.X-we.X)*(we.Y-Ce.Y))===0):(ie=S[0],we=S[1],Ce=S[2],Le=S[3],ct=S[4],ct?$r.op_Equality($r.Int128Mul(ie.Y-we.Y,Ce.X-Le.X),$r.Int128Mul(ie.X-we.X,Ce.Y-Le.Y)):i.Cast_Int64((ie.Y-we.Y)*(Ce.X-Le.X))-i.Cast_Int64((ie.X-we.X)*(Ce.Y-Le.Y))===0)},i.ClipperBase.SlopesEqual3=function(S,R,j){return j?$r.op_Equality($r.Int128Mul(S.Delta.Y,R.Delta.X),$r.Int128Mul(S.Delta.X,R.Delta.Y)):i.Cast_Int64(S.Delta.Y*R.Delta.X)==i.Cast_Int64(S.Delta.X*R.Delta.Y)},i.ClipperBase.SlopesEqual4=function(S,R,j,Z){return Z?$r.op_Equality($r.Int128Mul(S.Y-R.Y,R.X-j.X),$r.Int128Mul(S.X-R.X,R.Y-j.Y)):i.Cast_Int64((S.Y-R.Y)*(R.X-j.X))-i.Cast_Int64((S.X-R.X)*(R.Y-j.Y))===0},i.ClipperBase.SlopesEqual5=function(S,R,j,Z,ie){return ie?$r.op_Equality($r.Int128Mul(S.Y-R.Y,j.X-Z.X),$r.Int128Mul(S.X-R.X,j.Y-Z.Y)):i.Cast_Int64((S.Y-R.Y)*(j.X-Z.X))-i.Cast_Int64((S.X-R.X)*(j.Y-Z.Y))===0},i.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var S=0,R=this.m_edges.length;S<R;++S){for(var j=0,Z=this.m_edges[S].length;j<Z;++j)this.m_edges[S][j]=null;i.Clear(this.m_edges[S])}i.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},i.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var S=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=S}this.m_CurrentLM=null},i.ClipperBase.prototype.RangeTest=function(S,R){R.Value?(S.X>i.ClipperBase.hiRange||S.Y>i.ClipperBase.hiRange||-S.X>i.ClipperBase.hiRange||-S.Y>i.ClipperBase.hiRange)&&i.Error("Coordinate outside allowed range in RangeTest()."):(S.X>i.ClipperBase.loRange||S.Y>i.ClipperBase.loRange||-S.X>i.ClipperBase.loRange||-S.Y>i.ClipperBase.loRange)&&(R.Value=!0,this.RangeTest(S,R))},i.ClipperBase.prototype.InitEdge=function(S,R,j,Z){S.Next=R,S.Prev=j,S.Curr.X=Z.X,S.Curr.Y=Z.Y,S.OutIdx=-1},i.ClipperBase.prototype.InitEdge2=function(S,R){S.Curr.Y>=S.Next.Curr.Y?(S.Bot.X=S.Curr.X,S.Bot.Y=S.Curr.Y,S.Top.X=S.Next.Curr.X,S.Top.Y=S.Next.Curr.Y):(S.Top.X=S.Curr.X,S.Top.Y=S.Curr.Y,S.Bot.X=S.Next.Curr.X,S.Bot.Y=S.Next.Curr.Y),this.SetDx(S),S.PolyTyp=R},i.ClipperBase.prototype.FindNextLocMin=function(S){for(var R;;){for(;i.IntPoint.op_Inequality(S.Bot,S.Prev.Bot)||i.IntPoint.op_Equality(S.Curr,S.Top);)S=S.Next;if(S.Dx!=i.ClipperBase.horizontal&&S.Prev.Dx!=i.ClipperBase.horizontal)break;for(;S.Prev.Dx==i.ClipperBase.horizontal;)S=S.Prev;for(R=S;S.Dx==i.ClipperBase.horizontal;)S=S.Next;if(S.Top.Y!=S.Prev.Bot.Y){R.Prev.Bot.X<S.Bot.X&&(S=R);break}}return S},i.ClipperBase.prototype.ProcessBound=function(S,R){var j=S,Z=S,ie,we;if(S.Dx==i.ClipperBase.horizontal&&(R?we=S.Prev.Bot.X:we=S.Next.Bot.X,S.Bot.X!=we&&this.ReverseHorizontal(S)),Z.OutIdx!=i.ClipperBase.Skip)if(R){for(;Z.Top.Y==Z.Next.Bot.Y&&Z.Next.OutIdx!=i.ClipperBase.Skip;)Z=Z.Next;if(Z.Dx==i.ClipperBase.horizontal&&Z.Next.OutIdx!=i.ClipperBase.Skip){for(ie=Z;ie.Prev.Dx==i.ClipperBase.horizontal;)ie=ie.Prev;ie.Prev.Top.X==Z.Next.Top.X?R||(Z=ie.Prev):ie.Prev.Top.X>Z.Next.Top.X&&(Z=ie.Prev)}for(;S!=Z;)S.NextInLML=S.Next,S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Prev.Top.X&&this.ReverseHorizontal(S),S=S.Next;S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Prev.Top.X&&this.ReverseHorizontal(S),Z=Z.Next}else{for(;Z.Top.Y==Z.Prev.Bot.Y&&Z.Prev.OutIdx!=i.ClipperBase.Skip;)Z=Z.Prev;if(Z.Dx==i.ClipperBase.horizontal&&Z.Prev.OutIdx!=i.ClipperBase.Skip){for(ie=Z;ie.Next.Dx==i.ClipperBase.horizontal;)ie=ie.Next;ie.Next.Top.X==Z.Prev.Top.X?R||(Z=ie.Next):ie.Next.Top.X>Z.Prev.Top.X&&(Z=ie.Next)}for(;S!=Z;)S.NextInLML=S.Prev,S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Next.Top.X&&this.ReverseHorizontal(S),S=S.Prev;S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Next.Top.X&&this.ReverseHorizontal(S),Z=Z.Prev}if(Z.OutIdx==i.ClipperBase.Skip){if(S=Z,R){for(;S.Top.Y==S.Next.Bot.Y;)S=S.Next;for(;S!=Z&&S.Dx==i.ClipperBase.horizontal;)S=S.Prev}else{for(;S.Top.Y==S.Prev.Bot.Y;)S=S.Prev;for(;S!=Z&&S.Dx==i.ClipperBase.horizontal;)S=S.Next}if(S==Z)R?Z=S.Next:Z=S.Prev;else{R?S=Z.Next:S=Z.Prev;var Ce=new i.LocalMinima;Ce.Next=null,Ce.Y=S.Bot.Y,Ce.LeftBound=null,Ce.RightBound=S,Ce.RightBound.WindDelta=0,Z=this.ProcessBound(Ce.RightBound,R),this.InsertLocalMinima(Ce)}}return Z},i.ClipperBase.prototype.AddPath=function(S,R,j){!j&&R==i.PolyType.ptClip&&i.Error("AddPath: Open paths must be subject.");var Z=S.length-1;if(j)for(;Z>0&&i.IntPoint.op_Equality(S[Z],S[0]);)--Z;for(;Z>0&&i.IntPoint.op_Equality(S[Z],S[Z-1]);)--Z;if(j&&Z<2||!j&&Z<1)return!1;for(var ie=new Array,we=0;we<=Z;we++)ie.push(new i.TEdge);var Ce=!0;ie[1].Curr.X=S[1].X,ie[1].Curr.Y=S[1].Y;var Le={Value:this.m_UseFullRange};this.RangeTest(S[0],Le),this.m_UseFullRange=Le.Value,Le.Value=this.m_UseFullRange,this.RangeTest(S[Z],Le),this.m_UseFullRange=Le.Value,this.InitEdge(ie[0],ie[1],ie[Z],S[0]),this.InitEdge(ie[Z],ie[0],ie[Z-1],S[Z]);for(var we=Z-1;we>=1;--we)Le.Value=this.m_UseFullRange,this.RangeTest(S[we],Le),this.m_UseFullRange=Le.Value,this.InitEdge(ie[we],ie[we+1],ie[we-1],S[we]);for(var ct=ie[0],_t=ct,qt=ct;;){if(i.IntPoint.op_Equality(_t.Curr,_t.Next.Curr)){if(_t==_t.Next)break;_t==ct&&(ct=_t.Next),_t=this.RemoveEdge(_t),qt=_t;continue}if(_t.Prev==_t.Next)break;if(j&&i.ClipperBase.SlopesEqual(_t.Prev.Curr,_t.Curr,_t.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(_t.Prev.Curr,_t.Curr,_t.Next.Curr))){_t==ct&&(ct=_t.Next),_t=this.RemoveEdge(_t),_t=_t.Prev,qt=_t;continue}if(_t=_t.Next,_t==qt)break}if(!j&&_t==_t.Next||j&&_t.Prev==_t.Next)return!1;j||(this.m_HasOpenPaths=!0,ct.Prev.OutIdx=i.ClipperBase.Skip),_t=ct;do this.InitEdge2(_t,R),_t=_t.Next,Ce&&_t.Curr.Y!=ct.Curr.Y&&(Ce=!1);while(_t!=ct);if(Ce){if(j)return!1;_t.Prev.OutIdx=i.ClipperBase.Skip,_t.Prev.Bot.X<_t.Prev.Top.X&&this.ReverseHorizontal(_t.Prev);var sr=new i.LocalMinima;for(sr.Next=null,sr.Y=_t.Bot.Y,sr.LeftBound=null,sr.RightBound=_t,sr.RightBound.Side=i.EdgeSide.esRight,sr.RightBound.WindDelta=0;_t.Next.OutIdx!=i.ClipperBase.Skip;)_t.NextInLML=_t.Next,_t.Bot.X!=_t.Prev.Top.X&&this.ReverseHorizontal(_t),_t=_t.Next;return this.InsertLocalMinima(sr),this.m_edges.push(ie),!0}this.m_edges.push(ie);for(var mr,xr=null;_t=this.FindNextLocMin(_t),_t!=xr;){xr==null&&(xr=_t);var sr=new i.LocalMinima;sr.Next=null,sr.Y=_t.Bot.Y,_t.Dx<_t.Prev.Dx?(sr.LeftBound=_t.Prev,sr.RightBound=_t,mr=!1):(sr.LeftBound=_t,sr.RightBound=_t.Prev,mr=!0),sr.LeftBound.Side=i.EdgeSide.esLeft,sr.RightBound.Side=i.EdgeSide.esRight,j?sr.LeftBound.Next==sr.RightBound?sr.LeftBound.WindDelta=-1:sr.LeftBound.WindDelta=1:sr.LeftBound.WindDelta=0,sr.RightBound.WindDelta=-sr.LeftBound.WindDelta,_t=this.ProcessBound(sr.LeftBound,mr);var lr=this.ProcessBound(sr.RightBound,!mr);sr.LeftBound.OutIdx==i.ClipperBase.Skip?sr.LeftBound=null:sr.RightBound.OutIdx==i.ClipperBase.Skip&&(sr.RightBound=null),this.InsertLocalMinima(sr),mr||(_t=lr)}return!0},i.ClipperBase.prototype.AddPaths=function(S,R,j){for(var Z=!1,ie=0,we=S.length;ie<we;++ie)this.AddPath(S[ie],R,j)&&(Z=!0);return Z},i.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(S,R,j){return i.IntPoint.op_Equality(S,j)||i.IntPoint.op_Equality(S,R)||i.IntPoint.op_Equality(j,R)?!1:S.X!=j.X?R.X>S.X==R.X<j.X:R.Y>S.Y==R.Y<j.Y},i.ClipperBase.prototype.RemoveEdge=function(S){S.Prev.Next=S.Next,S.Next.Prev=S.Prev;var R=S.Next;return S.Prev=null,R},i.ClipperBase.prototype.SetDx=function(S){S.Delta.X=S.Top.X-S.Bot.X,S.Delta.Y=S.Top.Y-S.Bot.Y,S.Delta.Y===0?S.Dx=i.ClipperBase.horizontal:S.Dx=S.Delta.X/S.Delta.Y},i.ClipperBase.prototype.InsertLocalMinima=function(S){if(this.m_MinimaList===null)this.m_MinimaList=S;else if(S.Y>=this.m_MinimaList.Y)S.Next=this.m_MinimaList,this.m_MinimaList=S;else{for(var R=this.m_MinimaList;R.Next!==null&&S.Y<R.Next.Y;)R=R.Next;S.Next=R.Next,R.Next=S}},i.ClipperBase.prototype.PopLocalMinima=function(){this.m_CurrentLM!==null&&(this.m_CurrentLM=this.m_CurrentLM.Next)},i.ClipperBase.prototype.ReverseHorizontal=function(S){var R=S.Top.X;S.Top.X=S.Bot.X,S.Bot.X=R},i.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!=null)for(var S=this.m_MinimaList;S!=null;){var R=S.LeftBound;R!=null&&(R.Curr.X=R.Bot.X,R.Curr.Y=R.Bot.Y,R.Side=i.EdgeSide.esLeft,R.OutIdx=i.ClipperBase.Unassigned),R=S.RightBound,R!=null&&(R.Curr.X=R.Bot.X,R.Curr.Y=R.Bot.Y,R.Side=i.EdgeSide.esRight,R.OutIdx=i.ClipperBase.Unassigned),S=S.Next}},i.Clipper=function(S){typeof S>"u"&&(S=0),this.m_PolyOuts=null,this.m_ClipType=i.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=i.PolyFillType.pftEvenOdd,this.m_SubjFillType=i.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,i.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=i.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&S)!==0,this.StrictlySimple=(2&S)!==0,this.PreserveCollinear=(4&S)!==0},i.Clipper.ioReverseSolution=1,i.Clipper.ioStrictlySimple=2,i.Clipper.ioPreserveCollinear=4,i.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),i.ClipperBase.prototype.Clear.call(this))},i.Clipper.prototype.DisposeScanbeamList=function(){for(;this.m_Scanbeam!==null;){var S=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=S}},i.Clipper.prototype.Reset=function(){i.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var S=this.m_MinimaList;S!==null;)this.InsertScanbeam(S.Y),S=S.Next},i.Clipper.prototype.InsertScanbeam=function(S){if(this.m_Scanbeam===null)this.m_Scanbeam=new i.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=S;else if(S>this.m_Scanbeam.Y){var R=new i.Scanbeam;R.Y=S,R.Next=this.m_Scanbeam,this.m_Scanbeam=R}else{for(var j=this.m_Scanbeam;j.Next!==null&&S<=j.Next.Y;)j=j.Next;if(S==j.Y)return;var R=new i.Scanbeam;R.Y=S,R.Next=j.Next,j.Next=R}},i.Clipper.prototype.Execute=function(){var S=arguments,R=S.length,j=S[1]instanceof i.PolyTree;if(R==4&&!j){var Z=S[0],ie=S[1],we=S[2],Ce=S[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&i.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,i.Clear(ie),this.m_SubjFillType=we,this.m_ClipFillType=Ce,this.m_ClipType=Z,this.m_UsingPolyTree=!1;try{var Le=this.ExecuteInternal();Le&&this.BuildResult(ie)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return Le}else if(R==4&&j){var Z=S[0],ct=S[1],we=S[2],Ce=S[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=we,this.m_ClipFillType=Ce,this.m_ClipType=Z,this.m_UsingPolyTree=!0;try{var Le=this.ExecuteInternal();Le&&this.BuildResult2(ct)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return Le}else if(R==2&&!j){var Z=S[0],ie=S[1];return this.Execute(Z,ie,i.PolyFillType.pftEvenOdd,i.PolyFillType.pftEvenOdd)}else if(R==2&&j){var Z=S[0],ct=S[1];return this.Execute(Z,ct,i.PolyFillType.pftEvenOdd,i.PolyFillType.pftEvenOdd)}},i.Clipper.prototype.FixHoleLinkage=function(S){if(!(S.FirstLeft===null||S.IsHole!=S.FirstLeft.IsHole&&S.FirstLeft.Pts!==null)){for(var R=S.FirstLeft;R!==null&&(R.IsHole==S.IsHole||R.Pts===null);)R=R.FirstLeft;S.FirstLeft=R}},i.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),this.m_CurrentLM===null)return!1;var S=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(S),i.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),this.m_Scanbeam===null)break;var R=this.PopScanbeam();if(!this.ProcessIntersections(S,R))return!1;this.ProcessEdgesAtTopOfScanbeam(R),S=R}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var j=0,Z=this.m_PolyOuts.length;j<Z;j++){var ie=this.m_PolyOuts[j];ie.Pts===null||ie.IsOpen||(ie.IsHole^this.ReverseSolution)==this.Area(ie)>0&&this.ReversePolyPtLinks(ie.Pts)}this.JoinCommonEdges();for(var j=0,Z=this.m_PolyOuts.length;j<Z;j++){var ie=this.m_PolyOuts[j];ie.Pts!==null&&!ie.IsOpen&&this.FixupOutPolygon(ie)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{i.Clear(this.m_Joins),i.Clear(this.m_GhostJoins)}},i.Clipper.prototype.PopScanbeam=function(){var S=this.m_Scanbeam.Y;return this.m_Scanbeam,this.m_Scanbeam=this.m_Scanbeam.Next,S},i.Clipper.prototype.DisposeAllPolyPts=function(){for(var S=0,R=this.m_PolyOuts.length;S<R;++S)this.DisposeOutRec(S);i.Clear(this.m_PolyOuts)},i.Clipper.prototype.DisposeOutRec=function(S){var R=this.m_PolyOuts[S];R.Pts!==null&&this.DisposeOutPts(R.Pts),R=null,this.m_PolyOuts[S]=null},i.Clipper.prototype.DisposeOutPts=function(S){if(S!==null)for(S.Prev.Next=null;S!==null;)S=S.Next},i.Clipper.prototype.AddJoin=function(S,R,j){var Z=new i.Join;Z.OutPt1=S,Z.OutPt2=R,Z.OffPt.X=j.X,Z.OffPt.Y=j.Y,this.m_Joins.push(Z)},i.Clipper.prototype.AddGhostJoin=function(S,R){var j=new i.Join;j.OutPt1=S,j.OffPt.X=R.X,j.OffPt.Y=R.Y,this.m_GhostJoins.push(j)},i.Clipper.prototype.InsertLocalMinimaIntoAEL=function(S){for(;this.m_CurrentLM!==null&&this.m_CurrentLM.Y==S;){var R=this.m_CurrentLM.LeftBound,j=this.m_CurrentLM.RightBound;this.PopLocalMinima();var Z=null;if(R===null?(this.InsertEdgeIntoAEL(j,null),this.SetWindingCount(j),this.IsContributing(j)&&(Z=this.AddOutPt(j,j.Bot))):j==null?(this.InsertEdgeIntoAEL(R,null),this.SetWindingCount(R),this.IsContributing(R)&&(Z=this.AddOutPt(R,R.Bot)),this.InsertScanbeam(R.Top.Y)):(this.InsertEdgeIntoAEL(R,null),this.InsertEdgeIntoAEL(j,R),this.SetWindingCount(R),j.WindCnt=R.WindCnt,j.WindCnt2=R.WindCnt2,this.IsContributing(R)&&(Z=this.AddLocalMinPoly(R,j,R.Bot)),this.InsertScanbeam(R.Top.Y)),j!=null&&(i.ClipperBase.IsHorizontal(j)?this.AddEdgeToSEL(j):this.InsertScanbeam(j.Top.Y)),!(R==null||j==null)){if(Z!==null&&i.ClipperBase.IsHorizontal(j)&&this.m_GhostJoins.length>0&&j.WindDelta!==0)for(var ie=0,we=this.m_GhostJoins.length;ie<we;ie++){var Ce=this.m_GhostJoins[ie];this.HorzSegmentsOverlap(Ce.OutPt1.Pt,Ce.OffPt,j.Bot,j.Top)&&this.AddJoin(Ce.OutPt1,Z,Ce.OffPt)}if(R.OutIdx>=0&&R.PrevInAEL!==null&&R.PrevInAEL.Curr.X==R.Bot.X&&R.PrevInAEL.OutIdx>=0&&i.ClipperBase.SlopesEqual(R.PrevInAEL,R,this.m_UseFullRange)&&R.WindDelta!==0&&R.PrevInAEL.WindDelta!==0){var Le=this.AddOutPt(R.PrevInAEL,R.Bot);this.AddJoin(Z,Le,R.Top)}if(R.NextInAEL!=j){if(j.OutIdx>=0&&j.PrevInAEL.OutIdx>=0&&i.ClipperBase.SlopesEqual(j.PrevInAEL,j,this.m_UseFullRange)&&j.WindDelta!==0&&j.PrevInAEL.WindDelta!==0){var Le=this.AddOutPt(j.PrevInAEL,j.Bot);this.AddJoin(Z,Le,j.Top)}var ct=R.NextInAEL;if(ct!==null)for(;ct!=j;)this.IntersectEdges(j,ct,R.Curr,!1),ct=ct.NextInAEL}}}},i.Clipper.prototype.InsertEdgeIntoAEL=function(S,R){if(this.m_ActiveEdges===null)S.PrevInAEL=null,S.NextInAEL=null,this.m_ActiveEdges=S;else if(R===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,S))S.PrevInAEL=null,S.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=S,this.m_ActiveEdges=S;else{for(R===null&&(R=this.m_ActiveEdges);R.NextInAEL!==null&&!this.E2InsertsBeforeE1(R.NextInAEL,S);)R=R.NextInAEL;S.NextInAEL=R.NextInAEL,R.NextInAEL!==null&&(R.NextInAEL.PrevInAEL=S),S.PrevInAEL=R,R.NextInAEL=S}},i.Clipper.prototype.E2InsertsBeforeE1=function(S,R){return R.Curr.X==S.Curr.X?R.Top.Y>S.Top.Y?R.Top.X<i.Clipper.TopX(S,R.Top.Y):S.Top.X>i.Clipper.TopX(R,S.Top.Y):R.Curr.X<S.Curr.X},i.Clipper.prototype.IsEvenOddFillType=function(S){return S.PolyTyp==i.PolyType.ptSubject?this.m_SubjFillType==i.PolyFillType.pftEvenOdd:this.m_ClipFillType==i.PolyFillType.pftEvenOdd},i.Clipper.prototype.IsEvenOddAltFillType=function(S){return S.PolyTyp==i.PolyType.ptSubject?this.m_ClipFillType==i.PolyFillType.pftEvenOdd:this.m_SubjFillType==i.PolyFillType.pftEvenOdd},i.Clipper.prototype.IsContributing=function(S){var R,j;switch(S.PolyTyp==i.PolyType.ptSubject?(R=this.m_SubjFillType,j=this.m_ClipFillType):(R=this.m_ClipFillType,j=this.m_SubjFillType),R){case i.PolyFillType.pftEvenOdd:if(S.WindDelta===0&&S.WindCnt!=1)return!1;break;case i.PolyFillType.pftNonZero:if(Math.abs(S.WindCnt)!=1)return!1;break;case i.PolyFillType.pftPositive:if(S.WindCnt!=1)return!1;break;default:if(S.WindCnt!=-1)return!1;break}switch(this.m_ClipType){case i.ClipType.ctIntersection:switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2!==0;case i.PolyFillType.pftPositive:return S.WindCnt2>0;default:return S.WindCnt2<0}case i.ClipType.ctUnion:switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2===0;case i.PolyFillType.pftPositive:return S.WindCnt2<=0;default:return S.WindCnt2>=0}case i.ClipType.ctDifference:if(S.PolyTyp==i.PolyType.ptSubject)switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2===0;case i.PolyFillType.pftPositive:return S.WindCnt2<=0;default:return S.WindCnt2>=0}else switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2!==0;case i.PolyFillType.pftPositive:return S.WindCnt2>0;default:return S.WindCnt2<0}case i.ClipType.ctXor:if(S.WindDelta===0)switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2===0;case i.PolyFillType.pftPositive:return S.WindCnt2<=0;default:return S.WindCnt2>=0}else return!0}return!0},i.Clipper.prototype.SetWindingCount=function(S){for(var R=S.PrevInAEL;R!==null&&(R.PolyTyp!=S.PolyTyp||R.WindDelta===0);)R=R.PrevInAEL;if(R===null)S.WindCnt=S.WindDelta===0?1:S.WindDelta,S.WindCnt2=0,R=this.m_ActiveEdges;else if(S.WindDelta===0&&this.m_ClipType!=i.ClipType.ctUnion)S.WindCnt=1,S.WindCnt2=R.WindCnt2,R=R.NextInAEL;else if(this.IsEvenOddFillType(S)){if(S.WindDelta===0){for(var j=!0,Z=R.PrevInAEL;Z!==null;)Z.PolyTyp==R.PolyTyp&&Z.WindDelta!==0&&(j=!j),Z=Z.PrevInAEL;S.WindCnt=j?0:1}else S.WindCnt=S.WindDelta;S.WindCnt2=R.WindCnt2,R=R.NextInAEL}else R.WindCnt*R.WindDelta<0?Math.abs(R.WindCnt)>1?R.WindDelta*S.WindDelta<0?S.WindCnt=R.WindCnt:S.WindCnt=R.WindCnt+S.WindDelta:S.WindCnt=S.WindDelta===0?1:S.WindDelta:S.WindDelta===0?S.WindCnt=R.WindCnt<0?R.WindCnt-1:R.WindCnt+1:R.WindDelta*S.WindDelta<0?S.WindCnt=R.WindCnt:S.WindCnt=R.WindCnt+S.WindDelta,S.WindCnt2=R.WindCnt2,R=R.NextInAEL;if(this.IsEvenOddAltFillType(S))for(;R!=S;)R.WindDelta!==0&&(S.WindCnt2=S.WindCnt2===0?1:0),R=R.NextInAEL;else for(;R!=S;)S.WindCnt2+=R.WindDelta,R=R.NextInAEL},i.Clipper.prototype.AddEdgeToSEL=function(S){this.m_SortedEdges===null?(this.m_SortedEdges=S,S.PrevInSEL=null,S.NextInSEL=null):(S.NextInSEL=this.m_SortedEdges,S.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=S,this.m_SortedEdges=S)},i.Clipper.prototype.CopyAELToSEL=function(){var S=this.m_ActiveEdges;for(this.m_SortedEdges=S;S!==null;)S.PrevInSEL=S.PrevInAEL,S.NextInSEL=S.NextInAEL,S=S.NextInAEL},i.Clipper.prototype.SwapPositionsInAEL=function(S,R){if(!(S.NextInAEL==S.PrevInAEL||R.NextInAEL==R.PrevInAEL)){if(S.NextInAEL==R){var j=R.NextInAEL;j!==null&&(j.PrevInAEL=S);var Z=S.PrevInAEL;Z!==null&&(Z.NextInAEL=R),R.PrevInAEL=Z,R.NextInAEL=S,S.PrevInAEL=R,S.NextInAEL=j}else if(R.NextInAEL==S){var j=S.NextInAEL;j!==null&&(j.PrevInAEL=R);var Z=R.PrevInAEL;Z!==null&&(Z.NextInAEL=S),S.PrevInAEL=Z,S.NextInAEL=R,R.PrevInAEL=S,R.NextInAEL=j}else{var j=S.NextInAEL,Z=S.PrevInAEL;S.NextInAEL=R.NextInAEL,S.NextInAEL!==null&&(S.NextInAEL.PrevInAEL=S),S.PrevInAEL=R.PrevInAEL,S.PrevInAEL!==null&&(S.PrevInAEL.NextInAEL=S),R.NextInAEL=j,R.NextInAEL!==null&&(R.NextInAEL.PrevInAEL=R),R.PrevInAEL=Z,R.PrevInAEL!==null&&(R.PrevInAEL.NextInAEL=R)}S.PrevInAEL===null?this.m_ActiveEdges=S:R.PrevInAEL===null&&(this.m_ActiveEdges=R)}},i.Clipper.prototype.SwapPositionsInSEL=function(S,R){if(!(S.NextInSEL===null&&S.PrevInSEL===null)&&!(R.NextInSEL===null&&R.PrevInSEL===null)){if(S.NextInSEL==R){var j=R.NextInSEL;j!==null&&(j.PrevInSEL=S);var Z=S.PrevInSEL;Z!==null&&(Z.NextInSEL=R),R.PrevInSEL=Z,R.NextInSEL=S,S.PrevInSEL=R,S.NextInSEL=j}else if(R.NextInSEL==S){var j=S.NextInSEL;j!==null&&(j.PrevInSEL=R);var Z=R.PrevInSEL;Z!==null&&(Z.NextInSEL=S),S.PrevInSEL=Z,S.NextInSEL=R,R.PrevInSEL=S,R.NextInSEL=j}else{var j=S.NextInSEL,Z=S.PrevInSEL;S.NextInSEL=R.NextInSEL,S.NextInSEL!==null&&(S.NextInSEL.PrevInSEL=S),S.PrevInSEL=R.PrevInSEL,S.PrevInSEL!==null&&(S.PrevInSEL.NextInSEL=S),R.NextInSEL=j,R.NextInSEL!==null&&(R.NextInSEL.PrevInSEL=R),R.PrevInSEL=Z,R.PrevInSEL!==null&&(R.PrevInSEL.NextInSEL=R)}S.PrevInSEL===null?this.m_SortedEdges=S:R.PrevInSEL===null&&(this.m_SortedEdges=R)}},i.Clipper.prototype.AddLocalMaxPoly=function(S,R,j){this.AddOutPt(S,j),R.WindDelta==0&&this.AddOutPt(R,j),S.OutIdx==R.OutIdx?(S.OutIdx=-1,R.OutIdx=-1):S.OutIdx<R.OutIdx?this.AppendPolygon(S,R):this.AppendPolygon(R,S)},i.Clipper.prototype.AddLocalMinPoly=function(S,R,j){var Z,ie,we;if(i.ClipperBase.IsHorizontal(R)||S.Dx>R.Dx?(Z=this.AddOutPt(S,j),R.OutIdx=S.OutIdx,S.Side=i.EdgeSide.esLeft,R.Side=i.EdgeSide.esRight,ie=S,ie.PrevInAEL==R?we=R.PrevInAEL:we=ie.PrevInAEL):(Z=this.AddOutPt(R,j),S.OutIdx=R.OutIdx,S.Side=i.EdgeSide.esRight,R.Side=i.EdgeSide.esLeft,ie=R,ie.PrevInAEL==S?we=S.PrevInAEL:we=ie.PrevInAEL),we!==null&&we.OutIdx>=0&&i.Clipper.TopX(we,j.Y)==i.Clipper.TopX(ie,j.Y)&&i.ClipperBase.SlopesEqual(ie,we,this.m_UseFullRange)&&ie.WindDelta!==0&&we.WindDelta!==0){var Ce=this.AddOutPt(we,j);this.AddJoin(Z,Ce,ie.Top)}return Z},i.Clipper.prototype.CreateOutRec=function(){var S=new i.OutRec;return S.Idx=-1,S.IsHole=!1,S.IsOpen=!1,S.FirstLeft=null,S.Pts=null,S.BottomPt=null,S.PolyNode=null,this.m_PolyOuts.push(S),S.Idx=this.m_PolyOuts.length-1,S},i.Clipper.prototype.AddOutPt=function(S,R){var j=S.Side==i.EdgeSide.esLeft;if(S.OutIdx<0){var Z=this.CreateOutRec();Z.IsOpen=S.WindDelta===0;var ie=new i.OutPt;return Z.Pts=ie,ie.Idx=Z.Idx,ie.Pt.X=R.X,ie.Pt.Y=R.Y,ie.Next=ie,ie.Prev=ie,Z.IsOpen||this.SetHoleState(S,Z),S.OutIdx=Z.Idx,ie}else{var Z=this.m_PolyOuts[S.OutIdx],we=Z.Pts;if(j&&i.IntPoint.op_Equality(R,we.Pt))return we;if(!j&&i.IntPoint.op_Equality(R,we.Prev.Pt))return we.Prev;var ie=new i.OutPt;return ie.Idx=Z.Idx,ie.Pt.X=R.X,ie.Pt.Y=R.Y,ie.Next=we,ie.Prev=we.Prev,ie.Prev.Next=ie,we.Prev=ie,j&&(Z.Pts=ie),ie}},i.Clipper.prototype.SwapPoints=function(S,R){var j=new i.IntPoint(S.Value);S.Value.X=R.Value.X,S.Value.Y=R.Value.Y,R.Value.X=j.X,R.Value.Y=j.Y},i.Clipper.prototype.HorzSegmentsOverlap=function(S,R,j,Z){return S.X>j.X==S.X<Z.X||R.X>j.X==R.X<Z.X||j.X>S.X==j.X<R.X||Z.X>S.X==Z.X<R.X||S.X==j.X&&R.X==Z.X?!0:S.X==Z.X&&R.X==j.X},i.Clipper.prototype.InsertPolyPtBetween=function(S,R,j){var Z=new i.OutPt;return Z.Pt.X=j.X,Z.Pt.Y=j.Y,R==S.Next?(S.Next=Z,R.Prev=Z,Z.Next=R,Z.Prev=S):(R.Next=Z,S.Prev=Z,Z.Next=S,Z.Prev=R),Z},i.Clipper.prototype.SetHoleState=function(S,R){for(var j=!1,Z=S.PrevInAEL;Z!==null;)Z.OutIdx>=0&&Z.WindDelta!=0&&(j=!j,R.FirstLeft===null&&(R.FirstLeft=this.m_PolyOuts[Z.OutIdx])),Z=Z.PrevInAEL;j&&(R.IsHole=!0)},i.Clipper.prototype.GetDx=function(S,R){return S.Y==R.Y?i.ClipperBase.horizontal:(R.X-S.X)/(R.Y-S.Y)},i.Clipper.prototype.FirstIsBottomPt=function(S,R){for(var j=S.Prev;i.IntPoint.op_Equality(j.Pt,S.Pt)&&j!=S;)j=j.Prev;var Z=Math.abs(this.GetDx(S.Pt,j.Pt));for(j=S.Next;i.IntPoint.op_Equality(j.Pt,S.Pt)&&j!=S;)j=j.Next;var ie=Math.abs(this.GetDx(S.Pt,j.Pt));for(j=R.Prev;i.IntPoint.op_Equality(j.Pt,R.Pt)&&j!=R;)j=j.Prev;var we=Math.abs(this.GetDx(R.Pt,j.Pt));for(j=R.Next;i.IntPoint.op_Equality(j.Pt,R.Pt)&&j!=R;)j=j.Next;var Ce=Math.abs(this.GetDx(R.Pt,j.Pt));return Z>=we&&Z>=Ce||ie>=we&&ie>=Ce},i.Clipper.prototype.GetBottomPt=function(S){for(var R=null,j=S.Next;j!=S;)j.Pt.Y>S.Pt.Y?(S=j,R=null):j.Pt.Y==S.Pt.Y&&j.Pt.X<=S.Pt.X&&(j.Pt.X<S.Pt.X?(R=null,S=j):j.Next!=S&&j.Prev!=S&&(R=j)),j=j.Next;if(R!==null)for(;R!=j;)for(this.FirstIsBottomPt(j,R)||(S=R),R=R.Next;i.IntPoint.op_Inequality(R.Pt,S.Pt);)R=R.Next;return S},i.Clipper.prototype.GetLowermostRec=function(S,R){S.BottomPt===null&&(S.BottomPt=this.GetBottomPt(S.Pts)),R.BottomPt===null&&(R.BottomPt=this.GetBottomPt(R.Pts));var j=S.BottomPt,Z=R.BottomPt;return j.Pt.Y>Z.Pt.Y?S:j.Pt.Y<Z.Pt.Y?R:j.Pt.X<Z.Pt.X?S:j.Pt.X>Z.Pt.X||j.Next==j?R:Z.Next==Z||this.FirstIsBottomPt(j,Z)?S:R},i.Clipper.prototype.Param1RightOfParam2=function(S,R){do if(S=S.FirstLeft,S==R)return!0;while(S!==null);return!1},i.Clipper.prototype.GetOutRec=function(S){for(var R=this.m_PolyOuts[S];R!=this.m_PolyOuts[R.Idx];)R=this.m_PolyOuts[R.Idx];return R},i.Clipper.prototype.AppendPolygon=function(S,R){var j=this.m_PolyOuts[S.OutIdx],Z=this.m_PolyOuts[R.OutIdx],ie;this.Param1RightOfParam2(j,Z)?ie=Z:this.Param1RightOfParam2(Z,j)?ie=j:ie=this.GetLowermostRec(j,Z);var we=j.Pts,Ce=we.Prev,Le=Z.Pts,ct=Le.Prev,_t;S.Side==i.EdgeSide.esLeft?(R.Side==i.EdgeSide.esLeft?(this.ReversePolyPtLinks(Le),Le.Next=we,we.Prev=Le,Ce.Next=ct,ct.Prev=Ce,j.Pts=ct):(ct.Next=we,we.Prev=ct,Le.Prev=Ce,Ce.Next=Le,j.Pts=Le),_t=i.EdgeSide.esLeft):(R.Side==i.EdgeSide.esRight?(this.ReversePolyPtLinks(Le),Ce.Next=ct,ct.Prev=Ce,Le.Next=we,we.Prev=Le):(Ce.Next=Le,Le.Prev=Ce,we.Prev=ct,ct.Next=we),_t=i.EdgeSide.esRight),j.BottomPt=null,ie==Z&&(Z.FirstLeft!=j&&(j.FirstLeft=Z.FirstLeft),j.IsHole=Z.IsHole),Z.Pts=null,Z.BottomPt=null,Z.FirstLeft=j;var qt=S.OutIdx,sr=R.OutIdx;S.OutIdx=-1,R.OutIdx=-1;for(var mr=this.m_ActiveEdges;mr!==null;){if(mr.OutIdx==sr){mr.OutIdx=qt,mr.Side=_t;break}mr=mr.NextInAEL}Z.Idx=j.Idx},i.Clipper.prototype.ReversePolyPtLinks=function(S){if(S!==null){var R,j;R=S;do j=R.Next,R.Next=R.Prev,R.Prev=j,R=j;while(R!=S)}},i.Clipper.SwapSides=function(S,R){var j=S.Side;S.Side=R.Side,R.Side=j},i.Clipper.SwapPolyIndexes=function(S,R){var j=S.OutIdx;S.OutIdx=R.OutIdx,R.OutIdx=j},i.Clipper.prototype.IntersectEdges=function(S,R,j,Z){var ie=!Z&&S.NextInLML===null&&S.Top.X==j.X&&S.Top.Y==j.Y,we=!Z&&R.NextInLML===null&&R.Top.X==j.X&&R.Top.Y==j.Y,Ce=S.OutIdx>=0,Le=R.OutIdx>=0;if(S.WindDelta===0||R.WindDelta===0){S.WindDelta===0&&R.WindDelta===0?(ie||we)&&Ce&&Le&&this.AddLocalMaxPoly(S,R,j):S.PolyTyp==R.PolyTyp&&S.WindDelta!=R.WindDelta&&this.m_ClipType==i.ClipType.ctUnion?S.WindDelta===0?Le&&(this.AddOutPt(S,j),Ce&&(S.OutIdx=-1)):Ce&&(this.AddOutPt(R,j),Le&&(R.OutIdx=-1)):S.PolyTyp!=R.PolyTyp&&(S.WindDelta===0&&Math.abs(R.WindCnt)==1&&(this.m_ClipType!=i.ClipType.ctUnion||R.WindCnt2===0)?(this.AddOutPt(S,j),Ce&&(S.OutIdx=-1)):R.WindDelta===0&&Math.abs(S.WindCnt)==1&&(this.m_ClipType!=i.ClipType.ctUnion||S.WindCnt2===0)&&(this.AddOutPt(R,j),Le&&(R.OutIdx=-1))),ie&&(S.OutIdx<0?this.DeleteFromAEL(S):i.Error("Error intersecting polylines")),we&&(R.OutIdx<0?this.DeleteFromAEL(R):i.Error("Error intersecting polylines"));return}if(S.PolyTyp==R.PolyTyp)if(this.IsEvenOddFillType(S)){var ct=S.WindCnt;S.WindCnt=R.WindCnt,R.WindCnt=ct}else S.WindCnt+R.WindDelta===0?S.WindCnt=-S.WindCnt:S.WindCnt+=R.WindDelta,R.WindCnt-S.WindDelta===0?R.WindCnt=-R.WindCnt:R.WindCnt-=S.WindDelta;else this.IsEvenOddFillType(R)?S.WindCnt2=S.WindCnt2===0?1:0:S.WindCnt2+=R.WindDelta,this.IsEvenOddFillType(S)?R.WindCnt2=R.WindCnt2===0?1:0:R.WindCnt2-=S.WindDelta;var _t,qt,sr,mr;S.PolyTyp==i.PolyType.ptSubject?(_t=this.m_SubjFillType,sr=this.m_ClipFillType):(_t=this.m_ClipFillType,sr=this.m_SubjFillType),R.PolyTyp==i.PolyType.ptSubject?(qt=this.m_SubjFillType,mr=this.m_ClipFillType):(qt=this.m_ClipFillType,mr=this.m_SubjFillType);var xr,lr;switch(_t){case i.PolyFillType.pftPositive:xr=S.WindCnt;break;case i.PolyFillType.pftNegative:xr=-S.WindCnt;break;default:xr=Math.abs(S.WindCnt);break}switch(qt){case i.PolyFillType.pftPositive:lr=R.WindCnt;break;case i.PolyFillType.pftNegative:lr=-R.WindCnt;break;default:lr=Math.abs(R.WindCnt);break}if(Ce&&Le)ie||we||xr!==0&&xr!=1||lr!==0&&lr!=1||S.PolyTyp!=R.PolyTyp&&this.m_ClipType!=i.ClipType.ctXor?this.AddLocalMaxPoly(S,R,j):(this.AddOutPt(S,j),this.AddOutPt(R,j),i.Clipper.SwapSides(S,R),i.Clipper.SwapPolyIndexes(S,R));else if(Ce)(lr===0||lr==1)&&(this.AddOutPt(S,j),i.Clipper.SwapSides(S,R),i.Clipper.SwapPolyIndexes(S,R));else if(Le)(xr===0||xr==1)&&(this.AddOutPt(R,j),i.Clipper.SwapSides(S,R),i.Clipper.SwapPolyIndexes(S,R));else if((xr===0||xr==1)&&(lr===0||lr==1)&&!ie&&!we){var Er,sn;switch(sr){case i.PolyFillType.pftPositive:Er=S.WindCnt2;break;case i.PolyFillType.pftNegative:Er=-S.WindCnt2;break;default:Er=Math.abs(S.WindCnt2);break}switch(mr){case i.PolyFillType.pftPositive:sn=R.WindCnt2;break;case i.PolyFillType.pftNegative:sn=-R.WindCnt2;break;default:sn=Math.abs(R.WindCnt2);break}if(S.PolyTyp!=R.PolyTyp)this.AddLocalMinPoly(S,R,j);else if(xr==1&&lr==1)switch(this.m_ClipType){case i.ClipType.ctIntersection:Er>0&&sn>0&&this.AddLocalMinPoly(S,R,j);break;case i.ClipType.ctUnion:Er<=0&&sn<=0&&this.AddLocalMinPoly(S,R,j);break;case i.ClipType.ctDifference:(S.PolyTyp==i.PolyType.ptClip&&Er>0&&sn>0||S.PolyTyp==i.PolyType.ptSubject&&Er<=0&&sn<=0)&&this.AddLocalMinPoly(S,R,j);break;case i.ClipType.ctXor:this.AddLocalMinPoly(S,R,j);break}else i.Clipper.SwapSides(S,R)}ie!=we&&(ie&&S.OutIdx>=0||we&&R.OutIdx>=0)&&(i.Clipper.SwapSides(S,R),i.Clipper.SwapPolyIndexes(S,R)),ie&&this.DeleteFromAEL(S),we&&this.DeleteFromAEL(R)},i.Clipper.prototype.DeleteFromAEL=function(S){var R=S.PrevInAEL,j=S.NextInAEL;R===null&&j===null&&S!=this.m_ActiveEdges||(R!==null?R.NextInAEL=j:this.m_ActiveEdges=j,j!==null&&(j.PrevInAEL=R),S.NextInAEL=null,S.PrevInAEL=null)},i.Clipper.prototype.DeleteFromSEL=function(S){var R=S.PrevInSEL,j=S.NextInSEL;R===null&&j===null&&S!=this.m_SortedEdges||(R!==null?R.NextInSEL=j:this.m_SortedEdges=j,j!==null&&(j.PrevInSEL=R),S.NextInSEL=null,S.PrevInSEL=null)},i.Clipper.prototype.UpdateEdgeIntoAEL=function(S){S.NextInLML===null&&i.Error("UpdateEdgeIntoAEL: invalid call");var R=S.PrevInAEL,j=S.NextInAEL;return S.NextInLML.OutIdx=S.OutIdx,R!==null?R.NextInAEL=S.NextInLML:this.m_ActiveEdges=S.NextInLML,j!==null&&(j.PrevInAEL=S.NextInLML),S.NextInLML.Side=S.Side,S.NextInLML.WindDelta=S.WindDelta,S.NextInLML.WindCnt=S.WindCnt,S.NextInLML.WindCnt2=S.WindCnt2,S=S.NextInLML,S.Curr.X=S.Bot.X,S.Curr.Y=S.Bot.Y,S.PrevInAEL=R,S.NextInAEL=j,i.ClipperBase.IsHorizontal(S)||this.InsertScanbeam(S.Top.Y),S},i.Clipper.prototype.ProcessHorizontals=function(S){for(var R=this.m_SortedEdges;R!==null;)this.DeleteFromSEL(R),this.ProcessHorizontal(R,S),R=this.m_SortedEdges},i.Clipper.prototype.GetHorzDirection=function(S,R){S.Bot.X<S.Top.X?(R.Left=S.Bot.X,R.Right=S.Top.X,R.Dir=i.Direction.dLeftToRight):(R.Left=S.Top.X,R.Right=S.Bot.X,R.Dir=i.Direction.dRightToLeft)},i.Clipper.prototype.PrepareHorzJoins=function(S,R){var j=this.m_PolyOuts[S.OutIdx].Pts;S.Side!=i.EdgeSide.esLeft&&(j=j.Prev),R&&(i.IntPoint.op_Equality(j.Pt,S.Top)?this.AddGhostJoin(j,S.Bot):this.AddGhostJoin(j,S.Top))},i.Clipper.prototype.ProcessHorizontal=function(S,R){var j={Dir:null,Left:null,Right:null};this.GetHorzDirection(S,j);for(var Z=j.Dir,ie=j.Left,we=j.Right,Ce=S,Le=null;Ce.NextInLML!==null&&i.ClipperBase.IsHorizontal(Ce.NextInLML);)Ce=Ce.NextInLML;for(Ce.NextInLML===null&&(Le=this.GetMaximaPair(Ce));;){for(var ct=S==Ce,_t=this.GetNextInAEL(S,Z);_t!==null&&!(_t.Curr.X==S.Top.X&&S.NextInLML!==null&&_t.Dx<S.NextInLML.Dx);){var qt=this.GetNextInAEL(_t,Z);if(Z==i.Direction.dLeftToRight&&_t.Curr.X<=we||Z==i.Direction.dRightToLeft&&_t.Curr.X>=ie){if(S.OutIdx>=0&&S.WindDelta!=0&&this.PrepareHorzJoins(S,R),_t==Le&&ct){Z==i.Direction.dLeftToRight?this.IntersectEdges(S,_t,_t.Top,!1):this.IntersectEdges(_t,S,_t.Top,!1),Le.OutIdx>=0&&i.Error("ProcessHorizontal error");return}else if(Z==i.Direction.dLeftToRight){var sr=new i.IntPoint(_t.Curr.X,S.Curr.Y);this.IntersectEdges(S,_t,sr,!0)}else{var sr=new i.IntPoint(_t.Curr.X,S.Curr.Y);this.IntersectEdges(_t,S,sr,!0)}this.SwapPositionsInAEL(S,_t)}else if(Z==i.Direction.dLeftToRight&&_t.Curr.X>=we||Z==i.Direction.dRightToLeft&&_t.Curr.X<=ie)break;_t=qt}if(S.OutIdx>=0&&S.WindDelta!==0&&this.PrepareHorzJoins(S,R),S.NextInLML!==null&&i.ClipperBase.IsHorizontal(S.NextInLML)){S=this.UpdateEdgeIntoAEL(S),S.OutIdx>=0&&this.AddOutPt(S,S.Bot);var j={Dir:Z,Left:ie,Right:we};this.GetHorzDirection(S,j),Z=j.Dir,ie=j.Left,we=j.Right}else break}if(S.NextInLML!==null)if(S.OutIdx>=0){var mr=this.AddOutPt(S,S.Top);if(S=this.UpdateEdgeIntoAEL(S),S.WindDelta===0)return;var xr=S.PrevInAEL,qt=S.NextInAEL;if(xr!==null&&xr.Curr.X==S.Bot.X&&xr.Curr.Y==S.Bot.Y&&xr.WindDelta!==0&&xr.OutIdx>=0&&xr.Curr.Y>xr.Top.Y&&i.ClipperBase.SlopesEqual(S,xr,this.m_UseFullRange)){var lr=this.AddOutPt(xr,S.Bot);this.AddJoin(mr,lr,S.Top)}else if(qt!==null&&qt.Curr.X==S.Bot.X&&qt.Curr.Y==S.Bot.Y&&qt.WindDelta!==0&&qt.OutIdx>=0&&qt.Curr.Y>qt.Top.Y&&i.ClipperBase.SlopesEqual(S,qt,this.m_UseFullRange)){var lr=this.AddOutPt(qt,S.Bot);this.AddJoin(mr,lr,S.Top)}}else S=this.UpdateEdgeIntoAEL(S);else Le!==null?Le.OutIdx>=0?(Z==i.Direction.dLeftToRight?this.IntersectEdges(S,Le,S.Top,!1):this.IntersectEdges(Le,S,S.Top,!1),Le.OutIdx>=0&&i.Error("ProcessHorizontal error")):(this.DeleteFromAEL(S),this.DeleteFromAEL(Le)):(S.OutIdx>=0&&this.AddOutPt(S,S.Top),this.DeleteFromAEL(S))},i.Clipper.prototype.GetNextInAEL=function(S,R){return R==i.Direction.dLeftToRight?S.NextInAEL:S.PrevInAEL},i.Clipper.prototype.IsMinima=function(S){return S!==null&&S.Prev.NextInLML!=S&&S.Next.NextInLML!=S},i.Clipper.prototype.IsMaxima=function(S,R){return S!==null&&S.Top.Y==R&&S.NextInLML===null},i.Clipper.prototype.IsIntermediate=function(S,R){return S.Top.Y==R&&S.NextInLML!==null},i.Clipper.prototype.GetMaximaPair=function(S){var R=null;return i.IntPoint.op_Equality(S.Next.Top,S.Top)&&S.Next.NextInLML===null?R=S.Next:i.IntPoint.op_Equality(S.Prev.Top,S.Top)&&S.Prev.NextInLML===null&&(R=S.Prev),R!==null&&(R.OutIdx==-2||R.NextInAEL==R.PrevInAEL&&!i.ClipperBase.IsHorizontal(R))?null:R},i.Clipper.prototype.ProcessIntersections=function(S,R){if(this.m_ActiveEdges==null)return!0;try{if(this.BuildIntersectList(S,R),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,i.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},i.Clipper.prototype.BuildIntersectList=function(S,R){if(this.m_ActiveEdges!==null){var j=this.m_ActiveEdges;for(this.m_SortedEdges=j;j!==null;)j.PrevInSEL=j.PrevInAEL,j.NextInSEL=j.NextInAEL,j.Curr.X=i.Clipper.TopX(j,R),j=j.NextInAEL;for(var Z=!0;Z&&this.m_SortedEdges!==null;){for(Z=!1,j=this.m_SortedEdges;j.NextInSEL!==null;){var ie=j.NextInSEL,we=new i.IntPoint;if(j.Curr.X>ie.Curr.X){!this.IntersectPoint(j,ie,we)&&j.Curr.X>ie.Curr.X+1&&i.Error("Intersection error"),we.Y>S&&(we.Y=S,Math.abs(j.Dx)>Math.abs(ie.Dx)?we.X=i.Clipper.TopX(ie,S):we.X=i.Clipper.TopX(j,S));var Ce=new i.IntersectNode;Ce.Edge1=j,Ce.Edge2=ie,Ce.Pt.X=we.X,Ce.Pt.Y=we.Y,this.m_IntersectList.push(Ce),this.SwapPositionsInSEL(j,ie),Z=!0}else j=ie}if(j.PrevInSEL!==null)j.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},i.Clipper.prototype.EdgesAdjacent=function(S){return S.Edge1.NextInSEL==S.Edge2||S.Edge1.PrevInSEL==S.Edge2},i.Clipper.IntersectNodeSort=function(S,R){return R.Pt.Y-S.Pt.Y},i.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var S=this.m_IntersectList.length,R=0;R<S;R++){if(!this.EdgesAdjacent(this.m_IntersectList[R])){for(var j=R+1;j<S&&!this.EdgesAdjacent(this.m_IntersectList[j]);)j++;if(j==S)return!1;var Z=this.m_IntersectList[R];this.m_IntersectList[R]=this.m_IntersectList[j],this.m_IntersectList[j]=Z}this.SwapPositionsInSEL(this.m_IntersectList[R].Edge1,this.m_IntersectList[R].Edge2)}return!0},i.Clipper.prototype.ProcessIntersectList=function(){for(var S=0,R=this.m_IntersectList.length;S<R;S++){var j=this.m_IntersectList[S];this.IntersectEdges(j.Edge1,j.Edge2,j.Pt,!0),this.SwapPositionsInAEL(j.Edge1,j.Edge2)}this.m_IntersectList.length=0};var sa=s(function(S){return S<0?Math.ceil(S-.5):Math.round(S)},"R1"),ta=s(function(S){return S<0?Math.ceil(S-.5):Math.floor(S+.5)},"R2"),Vi=s(function(S){return S<0?-Math.round(Math.abs(S)):Math.round(S)},"R3"),qr=s(function(S){return S<0?(S-=.5,S<-2147483648?Math.ceil(S):S|0):(S+=.5,S>2147483647?Math.floor(S):S|0)},"R4");l.msie?i.Clipper.Round=sa:l.chromium?i.Clipper.Round=Vi:l.safari?i.Clipper.Round=qr:i.Clipper.Round=ta,i.Clipper.TopX=function(S,R){return R==S.Top.Y?S.Top.X:S.Bot.X+i.Clipper.Round(S.Dx*(R-S.Bot.Y))},i.Clipper.prototype.IntersectPoint=function(S,R,j){j.X=0,j.Y=0;var Z,ie;if(i.ClipperBase.SlopesEqual(S,R,this.m_UseFullRange)||S.Dx==R.Dx)return R.Bot.Y>S.Bot.Y?(j.X=R.Bot.X,j.Y=R.Bot.Y):(j.X=S.Bot.X,j.Y=S.Bot.Y),!1;if(S.Delta.X===0)j.X=S.Bot.X,i.ClipperBase.IsHorizontal(R)?j.Y=R.Bot.Y:(ie=R.Bot.Y-R.Bot.X/R.Dx,j.Y=i.Clipper.Round(j.X/R.Dx+ie));else if(R.Delta.X===0)j.X=R.Bot.X,i.ClipperBase.IsHorizontal(S)?j.Y=S.Bot.Y:(Z=S.Bot.Y-S.Bot.X/S.Dx,j.Y=i.Clipper.Round(j.X/S.Dx+Z));else{Z=S.Bot.X-S.Bot.Y*S.Dx,ie=R.Bot.X-R.Bot.Y*R.Dx;var we=(ie-Z)/(S.Dx-R.Dx);j.Y=i.Clipper.Round(we),Math.abs(S.Dx)<Math.abs(R.Dx)?j.X=i.Clipper.Round(S.Dx*we+Z):j.X=i.Clipper.Round(R.Dx*we+ie)}if(j.Y<S.Top.Y||j.Y<R.Top.Y){if(S.Top.Y>R.Top.Y)return j.Y=S.Top.Y,j.X=i.Clipper.TopX(R,S.Top.Y),j.X<S.Top.X;j.Y=R.Top.Y,Math.abs(S.Dx)<Math.abs(R.Dx)?j.X=i.Clipper.TopX(S,j.Y):j.X=i.Clipper.TopX(R,j.Y)}return!0},i.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(S){for(var R=this.m_ActiveEdges;R!==null;){var j=this.IsMaxima(R,S);if(j){var Z=this.GetMaximaPair(R);j=Z===null||!i.ClipperBase.IsHorizontal(Z)}if(j){var ie=R.PrevInAEL;this.DoMaxima(R),ie===null?R=this.m_ActiveEdges:R=ie.NextInAEL}else{if(this.IsIntermediate(R,S)&&i.ClipperBase.IsHorizontal(R.NextInLML)?(R=this.UpdateEdgeIntoAEL(R),R.OutIdx>=0&&this.AddOutPt(R,R.Bot),this.AddEdgeToSEL(R)):(R.Curr.X=i.Clipper.TopX(R,S),R.Curr.Y=S),this.StrictlySimple){var ie=R.PrevInAEL;if(R.OutIdx>=0&&R.WindDelta!==0&&ie!==null&&ie.OutIdx>=0&&ie.Curr.X==R.Curr.X&&ie.WindDelta!==0){var we=this.AddOutPt(ie,R.Curr),Ce=this.AddOutPt(R,R.Curr);this.AddJoin(we,Ce,R.Curr)}}R=R.NextInAEL}}for(this.ProcessHorizontals(!0),R=this.m_ActiveEdges;R!==null;){if(this.IsIntermediate(R,S)){var we=null;R.OutIdx>=0&&(we=this.AddOutPt(R,R.Top)),R=this.UpdateEdgeIntoAEL(R);var ie=R.PrevInAEL,Le=R.NextInAEL;if(ie!==null&&ie.Curr.X==R.Bot.X&&ie.Curr.Y==R.Bot.Y&&we!==null&&ie.OutIdx>=0&&ie.Curr.Y>ie.Top.Y&&i.ClipperBase.SlopesEqual(R,ie,this.m_UseFullRange)&&R.WindDelta!==0&&ie.WindDelta!==0){var Ce=this.AddOutPt(ie,R.Bot);this.AddJoin(we,Ce,R.Top)}else if(Le!==null&&Le.Curr.X==R.Bot.X&&Le.Curr.Y==R.Bot.Y&&we!==null&&Le.OutIdx>=0&&Le.Curr.Y>Le.Top.Y&&i.ClipperBase.SlopesEqual(R,Le,this.m_UseFullRange)&&R.WindDelta!==0&&Le.WindDelta!==0){var Ce=this.AddOutPt(Le,R.Bot);this.AddJoin(we,Ce,R.Top)}}R=R.NextInAEL}},i.Clipper.prototype.DoMaxima=function(S){var R=this.GetMaximaPair(S);if(R===null){S.OutIdx>=0&&this.AddOutPt(S,S.Top),this.DeleteFromAEL(S);return}for(var j=S.NextInAEL,Z=!0;j!==null&&j!=R;)this.IntersectEdges(S,j,S.Top,!0),this.SwapPositionsInAEL(S,j),j=S.NextInAEL;S.OutIdx==-1&&R.OutIdx==-1?(this.DeleteFromAEL(S),this.DeleteFromAEL(R)):S.OutIdx>=0&&R.OutIdx>=0?this.IntersectEdges(S,R,S.Top,!1):Z&&S.WindDelta===0?(S.OutIdx>=0&&(this.AddOutPt(S,S.Top),S.OutIdx=-1),this.DeleteFromAEL(S),R.OutIdx>=0&&(this.AddOutPt(R,S.Top),R.OutIdx=-1),this.DeleteFromAEL(R)):i.Error("DoMaxima error")},i.Clipper.ReversePaths=function(S){for(var R=0,j=S.length;R<j;R++)S[R].reverse()},i.Clipper.Orientation=function(S){return i.Clipper.Area(S)>=0},i.Clipper.prototype.PointCount=function(S){if(S===null)return 0;var R=0,j=S;do R++,j=j.Next;while(j!=S);return R},i.Clipper.prototype.BuildResult=function(S){i.Clear(S);for(var R=0,j=this.m_PolyOuts.length;R<j;R++){var Z=this.m_PolyOuts[R];if(Z.Pts!==null){var ie=Z.Pts.Prev,we=this.PointCount(ie);if(!(we<2)){for(var Ce=new Array(we),Le=0;Le<we;Le++)Ce[Le]=ie.Pt,ie=ie.Prev;S.push(Ce)}}}},i.Clipper.prototype.BuildResult2=function(S){S.Clear();for(var R=0,j=this.m_PolyOuts.length;R<j;R++){var Z=this.m_PolyOuts[R],ie=this.PointCount(Z.Pts);if(!(Z.IsOpen&&ie<2||!Z.IsOpen&&ie<3)){this.FixHoleLinkage(Z);var we=new i.PolyNode;S.m_AllPolys.push(we),Z.PolyNode=we,we.m_polygon.length=ie;for(var Ce=Z.Pts.Prev,Le=0;Le<ie;Le++)we.m_polygon[Le]=Ce.Pt,Ce=Ce.Prev}}for(var R=0,j=this.m_PolyOuts.length;R<j;R++){var Z=this.m_PolyOuts[R];Z.PolyNode!==null&&(Z.IsOpen?(Z.PolyNode.IsOpen=!0,S.AddChild(Z.PolyNode)):Z.FirstLeft!==null&&Z.FirstLeft.PolyNode!=null?Z.FirstLeft.PolyNode.AddChild(Z.PolyNode):S.AddChild(Z.PolyNode))}},i.Clipper.prototype.FixupOutPolygon=function(S){var R=null;S.BottomPt=null;for(var j=S.Pts;;){if(j.Prev==j||j.Prev==j.Next){this.DisposeOutPts(j),S.Pts=null;return}if(i.IntPoint.op_Equality(j.Pt,j.Next.Pt)||i.IntPoint.op_Equality(j.Pt,j.Prev.Pt)||i.ClipperBase.SlopesEqual(j.Prev.Pt,j.Pt,j.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(j.Prev.Pt,j.Pt,j.Next.Pt)))R=null,j.Prev.Next=j.Next,j.Next.Prev=j.Prev,j=j.Prev;else{if(j==R)break;R===null&&(R=j),j=j.Next}}S.Pts=j},i.Clipper.prototype.DupOutPt=function(S,R){var j=new i.OutPt;return j.Pt.X=S.Pt.X,j.Pt.Y=S.Pt.Y,j.Idx=S.Idx,R?(j.Next=S.Next,j.Prev=S,S.Next.Prev=j,S.Next=j):(j.Prev=S.Prev,j.Next=S,S.Prev.Next=j,S.Prev=j),j},i.Clipper.prototype.GetOverlap=function(S,R,j,Z,ie){return S<R?j<Z?(ie.Left=Math.max(S,j),ie.Right=Math.min(R,Z)):(ie.Left=Math.max(S,Z),ie.Right=Math.min(R,j)):j<Z?(ie.Left=Math.max(R,j),ie.Right=Math.min(S,Z)):(ie.Left=Math.max(R,Z),ie.Right=Math.min(S,j)),ie.Left<ie.Right},i.Clipper.prototype.JoinHorz=function(S,R,j,Z,ie,we){var Ce=S.Pt.X>R.Pt.X?i.Direction.dRightToLeft:i.Direction.dLeftToRight,Le=j.Pt.X>Z.Pt.X?i.Direction.dRightToLeft:i.Direction.dLeftToRight;if(Ce==Le)return!1;if(Ce==i.Direction.dLeftToRight){for(;S.Next.Pt.X<=ie.X&&S.Next.Pt.X>=S.Pt.X&&S.Next.Pt.Y==ie.Y;)S=S.Next;we&&S.Pt.X!=ie.X&&(S=S.Next),R=this.DupOutPt(S,!we),i.IntPoint.op_Inequality(R.Pt,ie)&&(S=R,S.Pt.X=ie.X,S.Pt.Y=ie.Y,R=this.DupOutPt(S,!we))}else{for(;S.Next.Pt.X>=ie.X&&S.Next.Pt.X<=S.Pt.X&&S.Next.Pt.Y==ie.Y;)S=S.Next;!we&&S.Pt.X!=ie.X&&(S=S.Next),R=this.DupOutPt(S,we),i.IntPoint.op_Inequality(R.Pt,ie)&&(S=R,S.Pt.X=ie.X,S.Pt.Y=ie.Y,R=this.DupOutPt(S,we))}if(Le==i.Direction.dLeftToRight){for(;j.Next.Pt.X<=ie.X&&j.Next.Pt.X>=j.Pt.X&&j.Next.Pt.Y==ie.Y;)j=j.Next;we&&j.Pt.X!=ie.X&&(j=j.Next),Z=this.DupOutPt(j,!we),i.IntPoint.op_Inequality(Z.Pt,ie)&&(j=Z,j.Pt.X=ie.X,j.Pt.Y=ie.Y,Z=this.DupOutPt(j,!we))}else{for(;j.Next.Pt.X>=ie.X&&j.Next.Pt.X<=j.Pt.X&&j.Next.Pt.Y==ie.Y;)j=j.Next;!we&&j.Pt.X!=ie.X&&(j=j.Next),Z=this.DupOutPt(j,we),i.IntPoint.op_Inequality(Z.Pt,ie)&&(j=Z,j.Pt.X=ie.X,j.Pt.Y=ie.Y,Z=this.DupOutPt(j,we))}return Ce==i.Direction.dLeftToRight==we?(S.Prev=j,j.Next=S,R.Next=Z,Z.Prev=R):(S.Next=j,j.Prev=S,R.Prev=Z,Z.Next=R),!0},i.Clipper.prototype.JoinPoints=function(S,R,j){var Z=S.OutPt1,ie=new i.OutPt,we=S.OutPt2,Ce=new i.OutPt,Le=S.OutPt1.Pt.Y==S.OffPt.Y;if(Le&&i.IntPoint.op_Equality(S.OffPt,S.OutPt1.Pt)&&i.IntPoint.op_Equality(S.OffPt,S.OutPt2.Pt)){for(ie=S.OutPt1.Next;ie!=Z&&i.IntPoint.op_Equality(ie.Pt,S.OffPt);)ie=ie.Next;var ct=ie.Pt.Y>S.OffPt.Y;for(Ce=S.OutPt2.Next;Ce!=we&&i.IntPoint.op_Equality(Ce.Pt,S.OffPt);)Ce=Ce.Next;var _t=Ce.Pt.Y>S.OffPt.Y;return ct==_t?!1:ct?(ie=this.DupOutPt(Z,!1),Ce=this.DupOutPt(we,!0),Z.Prev=we,we.Next=Z,ie.Next=Ce,Ce.Prev=ie,S.OutPt1=Z,S.OutPt2=ie,!0):(ie=this.DupOutPt(Z,!0),Ce=this.DupOutPt(we,!1),Z.Next=we,we.Prev=Z,ie.Prev=Ce,Ce.Next=ie,S.OutPt1=Z,S.OutPt2=ie,!0)}else if(Le){for(ie=Z;Z.Prev.Pt.Y==Z.Pt.Y&&Z.Prev!=ie&&Z.Prev!=we;)Z=Z.Prev;for(;ie.Next.Pt.Y==ie.Pt.Y&&ie.Next!=Z&&ie.Next!=we;)ie=ie.Next;if(ie.Next==Z||ie.Next==we)return!1;for(Ce=we;we.Prev.Pt.Y==we.Pt.Y&&we.Prev!=Ce&&we.Prev!=ie;)we=we.Prev;for(;Ce.Next.Pt.Y==Ce.Pt.Y&&Ce.Next!=we&&Ce.Next!=Z;)Ce=Ce.Next;if(Ce.Next==we||Ce.Next==Z)return!1;var qt={Left:null,Right:null};if(!this.GetOverlap(Z.Pt.X,ie.Pt.X,we.Pt.X,Ce.Pt.X,qt))return!1;var sr=qt.Left,mr=qt.Right,xr=new i.IntPoint,lr;return Z.Pt.X>=sr&&Z.Pt.X<=mr?(xr.X=Z.Pt.X,xr.Y=Z.Pt.Y,lr=Z.Pt.X>ie.Pt.X):we.Pt.X>=sr&&we.Pt.X<=mr?(xr.X=we.Pt.X,xr.Y=we.Pt.Y,lr=we.Pt.X>Ce.Pt.X):ie.Pt.X>=sr&&ie.Pt.X<=mr?(xr.X=ie.Pt.X,xr.Y=ie.Pt.Y,lr=ie.Pt.X>Z.Pt.X):(xr.X=Ce.Pt.X,xr.Y=Ce.Pt.Y,lr=Ce.Pt.X>we.Pt.X),S.OutPt1=Z,S.OutPt2=we,this.JoinHorz(Z,ie,we,Ce,xr,lr)}else{for(ie=Z.Next;i.IntPoint.op_Equality(ie.Pt,Z.Pt)&&ie!=Z;)ie=ie.Next;var Er=ie.Pt.Y>Z.Pt.Y||!i.ClipperBase.SlopesEqual(Z.Pt,ie.Pt,S.OffPt,this.m_UseFullRange);if(Er){for(ie=Z.Prev;i.IntPoint.op_Equality(ie.Pt,Z.Pt)&&ie!=Z;)ie=ie.Prev;if(ie.Pt.Y>Z.Pt.Y||!i.ClipperBase.SlopesEqual(Z.Pt,ie.Pt,S.OffPt,this.m_UseFullRange))return!1}for(Ce=we.Next;i.IntPoint.op_Equality(Ce.Pt,we.Pt)&&Ce!=we;)Ce=Ce.Next;var sn=Ce.Pt.Y>we.Pt.Y||!i.ClipperBase.SlopesEqual(we.Pt,Ce.Pt,S.OffPt,this.m_UseFullRange);if(sn){for(Ce=we.Prev;i.IntPoint.op_Equality(Ce.Pt,we.Pt)&&Ce!=we;)Ce=Ce.Prev;if(Ce.Pt.Y>we.Pt.Y||!i.ClipperBase.SlopesEqual(we.Pt,Ce.Pt,S.OffPt,this.m_UseFullRange))return!1}return ie==Z||Ce==we||ie==Ce||R==j&&Er==sn?!1:Er?(ie=this.DupOutPt(Z,!1),Ce=this.DupOutPt(we,!0),Z.Prev=we,we.Next=Z,ie.Next=Ce,Ce.Prev=ie,S.OutPt1=Z,S.OutPt2=ie,!0):(ie=this.DupOutPt(Z,!0),Ce=this.DupOutPt(we,!1),Z.Next=we,we.Prev=Z,ie.Prev=Ce,Ce.Next=ie,S.OutPt1=Z,S.OutPt2=ie,!0)}},i.Clipper.GetBounds=function(S){for(var R=0,j=S.length;R<j&&S[R].length==0;)R++;if(R==j)return new i.IntRect(0,0,0,0);var Z=new i.IntRect;for(Z.left=S[R][0].X,Z.right=Z.left,Z.top=S[R][0].Y,Z.bottom=Z.top;R<j;R++)for(var ie=0,we=S[R].length;ie<we;ie++)S[R][ie].X<Z.left?Z.left=S[R][ie].X:S[R][ie].X>Z.right&&(Z.right=S[R][ie].X),S[R][ie].Y<Z.top?Z.top=S[R][ie].Y:S[R][ie].Y>Z.bottom&&(Z.bottom=S[R][ie].Y);return Z},i.Clipper.prototype.GetBounds2=function(S){var R=S,j=new i.IntRect;for(j.left=S.Pt.X,j.right=S.Pt.X,j.top=S.Pt.Y,j.bottom=S.Pt.Y,S=S.Next;S!=R;)S.Pt.X<j.left&&(j.left=S.Pt.X),S.Pt.X>j.right&&(j.right=S.Pt.X),S.Pt.Y<j.top&&(j.top=S.Pt.Y),S.Pt.Y>j.bottom&&(j.bottom=S.Pt.Y),S=S.Next;return j},i.Clipper.PointInPolygon=function(S,R){var j=0,Z=R.length;if(Z<3)return 0;for(var ie=R[0],we=1;we<=Z;++we){var Ce=we==Z?R[0]:R[we];if(Ce.Y==S.Y&&(Ce.X==S.X||ie.Y==S.Y&&Ce.X>S.X==ie.X<S.X))return-1;if(ie.Y<S.Y!=Ce.Y<S.Y){if(ie.X>=S.X)if(Ce.X>S.X)j=1-j;else{var Le=(ie.X-S.X)*(Ce.Y-S.Y)-(Ce.X-S.X)*(ie.Y-S.Y);if(Le==0)return-1;Le>0==Ce.Y>ie.Y&&(j=1-j)}else if(Ce.X>S.X){var Le=(ie.X-S.X)*(Ce.Y-S.Y)-(Ce.X-S.X)*(ie.Y-S.Y);if(Le==0)return-1;Le>0==Ce.Y>ie.Y&&(j=1-j)}}ie=Ce}return j},i.Clipper.prototype.PointInPolygon=function(S,R){for(var j=0,Z=R;;){var ie=R.Pt.X,we=R.Pt.Y,Ce=R.Next.Pt.X,Le=R.Next.Pt.Y;if(Le==S.Y&&(Ce==S.X||we==S.Y&&Ce>S.X==ie<S.X))return-1;if(we<S.Y!=Le<S.Y){if(ie>=S.X)if(Ce>S.X)j=1-j;else{var ct=(ie-S.X)*(Le-S.Y)-(Ce-S.X)*(we-S.Y);if(ct==0)return-1;ct>0==Le>we&&(j=1-j)}else if(Ce>S.X){var ct=(ie-S.X)*(Le-S.Y)-(Ce-S.X)*(we-S.Y);if(ct==0)return-1;ct>0==Le>we&&(j=1-j)}}if(R=R.Next,Z==R)break}return j},i.Clipper.prototype.Poly2ContainsPoly1=function(S,R){var j=S;do{var Z=this.PointInPolygon(j.Pt,R);if(Z>=0)return Z!=0;j=j.Next}while(j!=S);return!0},i.Clipper.prototype.FixupFirstLefts1=function(S,R){for(var j=0,Z=this.m_PolyOuts.length;j<Z;j++){var ie=this.m_PolyOuts[j];ie.Pts!==null&&ie.FirstLeft==S&&this.Poly2ContainsPoly1(ie.Pts,R.Pts)&&(ie.FirstLeft=R)}},i.Clipper.prototype.FixupFirstLefts2=function(S,R){for(var j=0,Z=this.m_PolyOuts,ie=Z.length,we=Z[j];j<ie;j++,we=Z[j])we.FirstLeft==S&&(we.FirstLeft=R)},i.Clipper.ParseFirstLeft=function(S){for(;S!=null&&S.Pts==null;)S=S.FirstLeft;return S},i.Clipper.prototype.JoinCommonEdges=function(){for(var S=0,R=this.m_Joins.length;S<R;S++){var j=this.m_Joins[S],Z=this.GetOutRec(j.OutPt1.Idx),ie=this.GetOutRec(j.OutPt2.Idx);if(!(Z.Pts==null||ie.Pts==null)){var we;if(Z==ie?we=Z:this.Param1RightOfParam2(Z,ie)?we=ie:this.Param1RightOfParam2(ie,Z)?we=Z:we=this.GetLowermostRec(Z,ie),!!this.JoinPoints(j,Z,ie))if(Z==ie){if(Z.Pts=j.OutPt1,Z.BottomPt=null,ie=this.CreateOutRec(),ie.Pts=j.OutPt2,this.UpdateOutPtIdxs(ie),this.m_UsingPolyTree)for(var Ce=0,Le=this.m_PolyOuts.length;Ce<Le-1;Ce++){var ct=this.m_PolyOuts[Ce];ct.Pts==null||i.Clipper.ParseFirstLeft(ct.FirstLeft)!=Z||ct.IsHole==Z.IsHole||this.Poly2ContainsPoly1(ct.Pts,j.OutPt2)&&(ct.FirstLeft=ie)}this.Poly2ContainsPoly1(ie.Pts,Z.Pts)?(ie.IsHole=!Z.IsHole,ie.FirstLeft=Z,this.m_UsingPolyTree&&this.FixupFirstLefts2(ie,Z),(ie.IsHole^this.ReverseSolution)==this.Area(ie)>0&&this.ReversePolyPtLinks(ie.Pts)):this.Poly2ContainsPoly1(Z.Pts,ie.Pts)?(ie.IsHole=Z.IsHole,Z.IsHole=!ie.IsHole,ie.FirstLeft=Z.FirstLeft,Z.FirstLeft=ie,this.m_UsingPolyTree&&this.FixupFirstLefts2(Z,ie),(Z.IsHole^this.ReverseSolution)==this.Area(Z)>0&&this.ReversePolyPtLinks(Z.Pts)):(ie.IsHole=Z.IsHole,ie.FirstLeft=Z.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(Z,ie))}else ie.Pts=null,ie.BottomPt=null,ie.Idx=Z.Idx,Z.IsHole=we.IsHole,we==ie&&(Z.FirstLeft=ie.FirstLeft),ie.FirstLeft=Z,this.m_UsingPolyTree&&this.FixupFirstLefts2(ie,Z)}}},i.Clipper.prototype.UpdateOutPtIdxs=function(S){var R=S.Pts;do R.Idx=S.Idx,R=R.Prev;while(R!=S.Pts)},i.Clipper.prototype.DoSimplePolygons=function(){for(var S=0;S<this.m_PolyOuts.length;){var R=this.m_PolyOuts[S++],j=R.Pts;if(j!==null)do{for(var Z=j.Next;Z!=R.Pts;){if(i.IntPoint.op_Equality(j.Pt,Z.Pt)&&Z.Next!=j&&Z.Prev!=j){var ie=j.Prev,we=Z.Prev;j.Prev=we,we.Next=j,Z.Prev=ie,ie.Next=Z,R.Pts=j;var Ce=this.CreateOutRec();Ce.Pts=Z,this.UpdateOutPtIdxs(Ce),this.Poly2ContainsPoly1(Ce.Pts,R.Pts)?(Ce.IsHole=!R.IsHole,Ce.FirstLeft=R):this.Poly2ContainsPoly1(R.Pts,Ce.Pts)?(Ce.IsHole=R.IsHole,R.IsHole=!Ce.IsHole,Ce.FirstLeft=R.FirstLeft,R.FirstLeft=Ce):(Ce.IsHole=R.IsHole,Ce.FirstLeft=R.FirstLeft),Z=j}Z=Z.Next}j=j.Next}while(j!=R.Pts)}},i.Clipper.Area=function(S){var R=S.length;if(R<3)return 0;for(var j=0,Z=0,ie=R-1;Z<R;++Z)j+=(S[ie].X+S[Z].X)*(S[ie].Y-S[Z].Y),ie=Z;return-j*.5},i.Clipper.prototype.Area=function(S){var R=S.Pts;if(R==null)return 0;var j=0;do j=j+(R.Prev.Pt.X+R.Pt.X)*(R.Prev.Pt.Y-R.Pt.Y),R=R.Next;while(R!=S.Pts);return j*.5},i.Clipper.SimplifyPolygon=function(S,R){var j=new Array,Z=new i.Clipper(0);return Z.StrictlySimple=!0,Z.AddPath(S,i.PolyType.ptSubject,!0),Z.Execute(i.ClipType.ctUnion,j,R,R),j},i.Clipper.SimplifyPolygons=function(S,R){typeof R>"u"&&(R=i.PolyFillType.pftEvenOdd);var j=new Array,Z=new i.Clipper(0);return Z.StrictlySimple=!0,Z.AddPaths(S,i.PolyType.ptSubject,!0),Z.Execute(i.ClipType.ctUnion,j,R,R),j},i.Clipper.DistanceSqrd=function(S,R){var j=S.X-R.X,Z=S.Y-R.Y;return j*j+Z*Z},i.Clipper.DistanceFromLineSqrd=function(S,R,j){var Z=R.Y-j.Y,ie=j.X-R.X,we=Z*R.X+ie*R.Y;return we=Z*S.X+ie*S.Y-we,we*we/(Z*Z+ie*ie)},i.Clipper.SlopesNearCollinear=function(S,R,j,Z){return i.Clipper.DistanceFromLineSqrd(R,S,j)<Z},i.Clipper.PointsAreClose=function(S,R,j){var Z=S.X-R.X,ie=S.Y-R.Y;return Z*Z+ie*ie<=j},i.Clipper.ExcludeOp=function(S){var R=S.Prev;return R.Next=S.Next,S.Next.Prev=R,R.Idx=0,R},i.Clipper.CleanPolygon=function(S,R){typeof R>"u"&&(R=1.415);var j=S.length;if(j==0)return new Array;for(var Z=new Array(j),ie=0;ie<j;++ie)Z[ie]=new i.OutPt;for(var ie=0;ie<j;++ie)Z[ie].Pt=S[ie],Z[ie].Next=Z[(ie+1)%j],Z[ie].Next.Prev=Z[ie],Z[ie].Idx=0;for(var we=R*R,Ce=Z[0];Ce.Idx==0&&Ce.Next!=Ce.Prev;)i.Clipper.PointsAreClose(Ce.Pt,Ce.Prev.Pt,we)?(Ce=i.Clipper.ExcludeOp(Ce),j--):i.Clipper.PointsAreClose(Ce.Prev.Pt,Ce.Next.Pt,we)?(i.Clipper.ExcludeOp(Ce.Next),Ce=i.Clipper.ExcludeOp(Ce),j-=2):i.Clipper.SlopesNearCollinear(Ce.Prev.Pt,Ce.Pt,Ce.Next.Pt,we)?(Ce=i.Clipper.ExcludeOp(Ce),j--):(Ce.Idx=1,Ce=Ce.Next);j<3&&(j=0);for(var Le=new Array(j),ie=0;ie<j;++ie)Le[ie]=new i.IntPoint(Ce.Pt),Ce=Ce.Next;return Z=null,Le},i.Clipper.CleanPolygons=function(S,R){for(var j=new Array(S.length),Z=0,ie=S.length;Z<ie;Z++)j[Z]=i.Clipper.CleanPolygon(S[Z],R);return j},i.Clipper.Minkowski=function(S,R,j,Z){var ie=Z?1:0,we=S.length,Ce=R.length,Le=new Array;if(j)for(var ct=0;ct<Ce;ct++){for(var _t=new Array(we),qt=0,sr=S.length,mr=S[qt];qt<sr;qt++,mr=S[qt])_t[qt]=new i.IntPoint(R[ct].X+mr.X,R[ct].Y+mr.Y);Le.push(_t)}else for(var ct=0;ct<Ce;ct++){for(var _t=new Array(we),qt=0,sr=S.length,mr=S[qt];qt<sr;qt++,mr=S[qt])_t[qt]=new i.IntPoint(R[ct].X-mr.X,R[ct].Y-mr.Y);Le.push(_t)}for(var xr=new Array,ct=0;ct<Ce-1+ie;ct++)for(var qt=0;qt<we;qt++){var lr=new Array;lr.push(Le[ct%Ce][qt%we]),lr.push(Le[(ct+1)%Ce][qt%we]),lr.push(Le[(ct+1)%Ce][(qt+1)%we]),lr.push(Le[ct%Ce][(qt+1)%we]),i.Clipper.Orientation(lr)||lr.reverse(),xr.push(lr)}var Er=new i.Clipper(0);return Er.AddPaths(xr,i.PolyType.ptSubject,!0),Er.Execute(i.ClipType.ctUnion,Le,i.PolyFillType.pftNonZero,i.PolyFillType.pftNonZero),Le},i.Clipper.MinkowskiSum=function(){var S=arguments,R=S.length;if(R==3){var j=S[0],Z=S[1],ie=S[2];return i.Clipper.Minkowski(j,Z,!0,ie)}else if(R==4){for(var j=S[0],we=S[1],Ce=S[2],ie=S[3],Le=new i.Clipper,ct,_t=0,qt=we.length;_t<qt;++_t){var ct=i.Clipper.Minkowski(j,we[_t],!0,ie);Le.AddPaths(ct,i.PolyType.ptSubject,!0)}ie&&Le.AddPaths(we,i.PolyType.ptClip,!0);var sr=new i.Paths;return Le.Execute(i.ClipType.ctUnion,sr,Ce,Ce),sr}},i.Clipper.MinkowskiDiff=function(S,R,j){return i.Clipper.Minkowski(S,R,!1,j)},i.Clipper.PolyTreeToPaths=function(S){var R=new Array;return i.Clipper.AddPolyNodeToPaths(S,i.Clipper.NodeType.ntAny,R),R},i.Clipper.AddPolyNodeToPaths=function(S,R,j){var Z=!0;switch(R){case i.Clipper.NodeType.ntOpen:return;case i.Clipper.NodeType.ntClosed:Z=!S.IsOpen;break}S.m_polygon.length>0&&Z&&j.push(S.m_polygon);for(var ie=0,we=S.Childs(),Ce=we.length,Le=we[ie];ie<Ce;ie++,Le=we[ie])i.Clipper.AddPolyNodeToPaths(Le,R,j)},i.Clipper.OpenPathsFromPolyTree=function(S){for(var R=new i.Paths,j=0,Z=S.ChildCount();j<Z;j++)S.Childs()[j].IsOpen&&R.push(S.Childs()[j].m_polygon);return R},i.Clipper.ClosedPathsFromPolyTree=function(S){var R=new i.Paths;return i.Clipper.AddPolyNodeToPaths(S,i.Clipper.NodeType.ntClosed,R),R},li(i.Clipper,i.ClipperBase),i.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},i.ClipperOffset=function(S,R){typeof S>"u"&&(S=2),typeof R>"u"&&(R=i.ClipperOffset.def_arc_tolerance),this.m_destPolys=new i.Paths,this.m_srcPoly=new i.Path,this.m_destPoly=new i.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new i.IntPoint,this.m_polyNodes=new i.PolyNode,this.MiterLimit=S,this.ArcTolerance=R,this.m_lowest.X=-1},i.ClipperOffset.two_pi=6.28318530717959,i.ClipperOffset.def_arc_tolerance=.25,i.ClipperOffset.prototype.Clear=function(){i.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},i.ClipperOffset.Round=i.Clipper.Round,i.ClipperOffset.prototype.AddPath=function(S,R,j){var Z=S.length-1;if(!(Z<0)){var ie=new i.PolyNode;if(ie.m_jointype=R,ie.m_endtype=j,j==i.EndType.etClosedLine||j==i.EndType.etClosedPolygon)for(;Z>0&&i.IntPoint.op_Equality(S[0],S[Z]);)Z--;ie.m_polygon.push(S[0]);for(var we=0,Ce=0,Le=1;Le<=Z;Le++)i.IntPoint.op_Inequality(ie.m_polygon[we],S[Le])&&(we++,ie.m_polygon.push(S[Le]),(S[Le].Y>ie.m_polygon[Ce].Y||S[Le].Y==ie.m_polygon[Ce].Y&&S[Le].X<ie.m_polygon[Ce].X)&&(Ce=we));if(!(j==i.EndType.etClosedPolygon&&we<2||j!=i.EndType.etClosedPolygon&&we<0)&&(this.m_polyNodes.AddChild(ie),j==i.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new i.IntPoint(0,Ce);else{var ct=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(ie.m_polygon[Ce].Y>ct.Y||ie.m_polygon[Ce].Y==ct.Y&&ie.m_polygon[Ce].X<ct.X)&&(this.m_lowest=new i.IntPoint(this.m_polyNodes.ChildCount()-1,Ce))}}},i.ClipperOffset.prototype.AddPaths=function(S,R,j){for(var Z=0,ie=S.length;Z<ie;Z++)this.AddPath(S[Z],R,j)},i.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!i.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var S=0;S<this.m_polyNodes.ChildCount();S++){var R=this.m_polyNodes.Childs()[S];(R.m_endtype==i.EndType.etClosedPolygon||R.m_endtype==i.EndType.etClosedLine&&i.Clipper.Orientation(R.m_polygon))&&R.m_polygon.reverse()}else for(var S=0;S<this.m_polyNodes.ChildCount();S++){var R=this.m_polyNodes.Childs()[S];R.m_endtype==i.EndType.etClosedLine&&!i.Clipper.Orientation(R.m_polygon)&&R.m_polygon.reverse()}},i.ClipperOffset.GetUnitNormal=function(S,R){var j=R.X-S.X,Z=R.Y-S.Y;if(j==0&&Z==0)return new i.DoublePoint(0,0);var ie=1/Math.sqrt(j*j+Z*Z);return j*=ie,Z*=ie,new i.DoublePoint(Z,-j)},i.ClipperOffset.prototype.DoOffset=function(S){if(this.m_destPolys=new Array,this.m_delta=S,i.ClipperBase.near_zero(S)){for(var R=0;R<this.m_polyNodes.ChildCount();R++){var j=this.m_polyNodes.Childs()[R];j.m_endtype==i.EndType.etClosedPolygon&&this.m_destPolys.push(j.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var Z;this.ArcTolerance<=0?Z=i.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(S)*i.ClipperOffset.def_arc_tolerance?Z=Math.abs(S)*i.ClipperOffset.def_arc_tolerance:Z=this.ArcTolerance;var ie=3.14159265358979/Math.acos(1-Z/Math.abs(S));this.m_sin=Math.sin(i.ClipperOffset.two_pi/ie),this.m_cos=Math.cos(i.ClipperOffset.two_pi/ie),this.m_StepsPerRad=ie/i.ClipperOffset.two_pi,S<0&&(this.m_sin=-this.m_sin);for(var R=0;R<this.m_polyNodes.ChildCount();R++){var j=this.m_polyNodes.Childs()[R];this.m_srcPoly=j.m_polygon;var we=this.m_srcPoly.length;if(!(we==0||S<=0&&(we<3||j.m_endtype!=i.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,we==1){if(j.m_jointype==i.JoinType.jtRound)for(var Ce=1,Le=0,ct=1;ct<=ie;ct++){this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+Ce*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y+Le*S)));var _t=Ce;Ce=Ce*this.m_cos-this.m_sin*Le,Le=_t*this.m_sin+Le*this.m_cos}else for(var Ce=-1,Le=-1,ct=0;ct<4;++ct)this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+Ce*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y+Le*S))),Ce<0?Ce=1:Le<0?Le=1:Ce=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var ct=0;ct<we-1;ct++)this.m_normals.push(i.ClipperOffset.GetUnitNormal(this.m_srcPoly[ct],this.m_srcPoly[ct+1]));if(j.m_endtype==i.EndType.etClosedLine||j.m_endtype==i.EndType.etClosedPolygon?this.m_normals.push(i.ClipperOffset.GetUnitNormal(this.m_srcPoly[we-1],this.m_srcPoly[0])):this.m_normals.push(new i.DoublePoint(this.m_normals[we-2])),j.m_endtype==i.EndType.etClosedPolygon){for(var qt=we-1,ct=0;ct<we;ct++)qt=this.OffsetPoint(ct,qt,j.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(j.m_endtype==i.EndType.etClosedLine){for(var qt=we-1,ct=0;ct<we;ct++)qt=this.OffsetPoint(ct,qt,j.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var sr=this.m_normals[we-1],ct=we-1;ct>0;ct--)this.m_normals[ct]=new i.DoublePoint(-this.m_normals[ct-1].X,-this.m_normals[ct-1].Y);this.m_normals[0]=new i.DoublePoint(-sr.X,-sr.Y),qt=0;for(var ct=we-1;ct>=0;ct--)qt=this.OffsetPoint(ct,qt,j.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var qt=0,ct=1;ct<we-1;++ct)qt=this.OffsetPoint(ct,qt,j.m_jointype);var mr;if(j.m_endtype==i.EndType.etOpenButt){var ct=we-1;mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[ct].X+this.m_normals[ct].X*S),i.ClipperOffset.Round(this.m_srcPoly[ct].Y+this.m_normals[ct].Y*S)),this.m_destPoly.push(mr),mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[ct].X-this.m_normals[ct].X*S),i.ClipperOffset.Round(this.m_srcPoly[ct].Y-this.m_normals[ct].Y*S)),this.m_destPoly.push(mr)}else{var ct=we-1;qt=we-2,this.m_sinA=0,this.m_normals[ct]=new i.DoublePoint(-this.m_normals[ct].X,-this.m_normals[ct].Y),j.m_endtype==i.EndType.etOpenSquare?this.DoSquare(ct,qt):this.DoRound(ct,qt)}for(var ct=we-1;ct>0;ct--)this.m_normals[ct]=new i.DoublePoint(-this.m_normals[ct-1].X,-this.m_normals[ct-1].Y);this.m_normals[0]=new i.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),qt=we-1;for(var ct=qt-1;ct>0;--ct)qt=this.OffsetPoint(ct,qt,j.m_jointype);j.m_endtype==i.EndType.etOpenButt?(mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*S)),this.m_destPoly.push(mr),mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*S)),this.m_destPoly.push(mr)):(qt=1,this.m_sinA=0,j.m_endtype==i.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},i.ClipperOffset.prototype.Execute=function(){var S=arguments,R=S[0]instanceof i.PolyTree;if(R){var j=S[0],Z=S[1];j.Clear(),this.FixOrientations(),this.DoOffset(Z);var ie=new i.Clipper(0);if(ie.AddPaths(this.m_destPolys,i.PolyType.ptSubject,!0),Z>0)ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftPositive,i.PolyFillType.pftPositive);else{var we=i.Clipper.GetBounds(this.m_destPolys),Ce=new i.Path;if(Ce.push(new i.IntPoint(we.left-10,we.bottom+10)),Ce.push(new i.IntPoint(we.right+10,we.bottom+10)),Ce.push(new i.IntPoint(we.right+10,we.top-10)),Ce.push(new i.IntPoint(we.left-10,we.top-10)),ie.AddPath(Ce,i.PolyType.ptSubject,!0),ie.ReverseSolution=!0,ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftNegative,i.PolyFillType.pftNegative),j.ChildCount()==1&&j.Childs()[0].ChildCount()>0){var Le=j.Childs()[0];j.Childs()[0]=Le.Childs()[0];for(var ct=1;ct<Le.ChildCount();ct++)j.AddChild(Le.Childs()[ct])}else j.Clear()}}else{var j=S[0],Z=S[1];i.Clear(j),this.FixOrientations(),this.DoOffset(Z);var ie=new i.Clipper(0);if(ie.AddPaths(this.m_destPolys,i.PolyType.ptSubject,!0),Z>0)ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftPositive,i.PolyFillType.pftPositive);else{var we=i.Clipper.GetBounds(this.m_destPolys),Ce=new i.Path;Ce.push(new i.IntPoint(we.left-10,we.bottom+10)),Ce.push(new i.IntPoint(we.right+10,we.bottom+10)),Ce.push(new i.IntPoint(we.right+10,we.top-10)),Ce.push(new i.IntPoint(we.left-10,we.top-10)),ie.AddPath(Ce,i.PolyType.ptSubject,!0),ie.ReverseSolution=!0,ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftNegative,i.PolyFillType.pftNegative),j.length>0&&j.splice(0,1)}}},i.ClipperOffset.prototype.OffsetPoint=function(S,R,j){if(this.m_sinA=this.m_normals[R].X*this.m_normals[S].Y-this.m_normals[S].X*this.m_normals[R].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return R;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_normals[R].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_normals[R].Y*this.m_delta))),this.m_destPoly.push(new i.IntPoint(this.m_srcPoly[S])),this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_normals[S].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_normals[S].Y*this.m_delta)));else switch(j){case i.JoinType.jtMiter:{var Z=1+(this.m_normals[S].X*this.m_normals[R].X+this.m_normals[S].Y*this.m_normals[R].Y);Z>=this.m_miterLim?this.DoMiter(S,R,Z):this.DoSquare(S,R);break}case i.JoinType.jtSquare:this.DoSquare(S,R);break;case i.JoinType.jtRound:this.DoRound(S,R);break}return R=S,R},i.ClipperOffset.prototype.DoSquare=function(S,R){var j=Math.tan(Math.atan2(this.m_sinA,this.m_normals[R].X*this.m_normals[S].X+this.m_normals[R].Y*this.m_normals[S].Y)/4);this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_delta*(this.m_normals[R].X-this.m_normals[R].Y*j)),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_delta*(this.m_normals[R].Y+this.m_normals[R].X*j)))),this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_delta*(this.m_normals[S].X+this.m_normals[S].Y*j)),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_delta*(this.m_normals[S].Y-this.m_normals[S].X*j))))},i.ClipperOffset.prototype.DoMiter=function(S,R,j){var Z=this.m_delta/j;this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+(this.m_normals[R].X+this.m_normals[S].X)*Z),i.ClipperOffset.Round(this.m_srcPoly[S].Y+(this.m_normals[R].Y+this.m_normals[S].Y)*Z)))},i.ClipperOffset.prototype.DoRound=function(S,R){for(var j=Math.atan2(this.m_sinA,this.m_normals[R].X*this.m_normals[S].X+this.m_normals[R].Y*this.m_normals[S].Y),Z=i.Cast_Int32(i.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(j))),ie=this.m_normals[R].X,we=this.m_normals[R].Y,Ce,Le=0;Le<Z;++Le)this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+ie*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+we*this.m_delta))),Ce=ie,ie=ie*this.m_cos-this.m_sin*we,we=Ce*this.m_sin+we*this.m_cos;this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_normals[S].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_normals[S].Y*this.m_delta)))},i.Error=function(S){try{throw new Error(S)}catch(R){alert(R.message)}},i.JS={},i.JS.AreaOfPolygon=function(S,R){return R||(R=1),i.Clipper.Area(S)/(R*R)},i.JS.AreaOfPolygons=function(S,R){R||(R=1);for(var j=0,Z=0;Z<S.length;Z++)j+=i.Clipper.Area(S[Z]);return j/(R*R)},i.JS.BoundsOfPath=function(S,R){return i.JS.BoundsOfPaths([S],R)},i.JS.BoundsOfPaths=function(S,R){R||(R=1);var j=i.Clipper.GetBounds(S);return j.left/=R,j.bottom/=R,j.right/=R,j.top/=R,j},i.JS.Clean=function(Z,R){if(!(Z instanceof Array))return[];var j=Z[0]instanceof Array,Z=i.JS.Clone(Z);if(typeof R!="number"||R===null)return i.Error("Delta is not a number in Clean()."),Z;if(Z.length===0||Z.length==1&&Z[0].length===0||R<0)return Z;j||(Z=[Z]);for(var ie=Z.length,we,Ce,Le,ct,_t,qt,sr,mr=[],xr=0;xr<ie;xr++)if(Ce=Z[xr],we=Ce.length,we!==0){if(we<3){Le=Ce,mr.push(Le);continue}for(Le=Ce,ct=R*R,_t=Ce[0],qt=1,sr=1;sr<we;sr++)(Ce[sr].X-_t.X)*(Ce[sr].X-_t.X)+(Ce[sr].Y-_t.Y)*(Ce[sr].Y-_t.Y)<=ct||(Le[qt]=Ce[sr],_t=Ce[sr],qt++);_t=Ce[qt-1],(Ce[0].X-_t.X)*(Ce[0].X-_t.X)+(Ce[0].Y-_t.Y)*(Ce[0].Y-_t.Y)<=ct&&qt--,qt<we&&Le.splice(qt,we-qt),Le.length&&mr.push(Le)}return!j&&mr.length?mr=mr[0]:!j&&mr.length===0?mr=[]:j&&mr.length===0&&(mr=[[]]),mr},i.JS.Clone=function(S){if(!(S instanceof Array))return[];if(S.length===0)return[];if(S.length==1&&S[0].length===0)return[[]];var R=S[0]instanceof Array;R||(S=[S]);var j=S.length,Z,ie,we,Ce,Le=new Array(j);for(ie=0;ie<j;ie++){for(Z=S[ie].length,Ce=new Array(Z),we=0;we<Z;we++)Ce[we]={X:S[ie][we].X,Y:S[ie][we].Y};Le[ie]=Ce}return R||(Le=Le[0]),Le},i.JS.Lighten=function(S,R){if(!(S instanceof Array))return[];if(typeof R!="number"||R===null)return i.Error("Tolerance is not a number in Lighten()."),i.JS.Clone(S);if(S.length===0||S.length==1&&S[0].length===0||R<0)return i.JS.Clone(S);S[0]instanceof Array||(S=[S]);var j,Z,ie,we,Ce,Le,ct,_t,qt,sr,mr,xr,lr,Er,sn,ra,ln,zl=S.length,la=R*R,ui=[];for(j=0;j<zl;j++)if(ie=S[j],Le=ie.length,Le!=0){for(we=0;we<1e6;we++){for(Ce=[],Le=ie.length,ie[Le-1].X!=ie[0].X||ie[Le-1].Y!=ie[0].Y?(xr=1,ie.push({X:ie[0].X,Y:ie[0].Y}),Le=ie.length):xr=0,mr=[],Z=0;Z<Le-2;Z++)ct=ie[Z],qt=ie[Z+1],_t=ie[Z+2],ra=ct.X,ln=ct.Y,lr=_t.X-ra,Er=_t.Y-ln,(lr!==0||Er!==0)&&(sn=((qt.X-ra)*lr+(qt.Y-ln)*Er)/(lr*lr+Er*Er),sn>1?(ra=_t.X,ln=_t.Y):sn>0&&(ra+=lr*sn,ln+=Er*sn)),lr=qt.X-ra,Er=qt.Y-ln,sr=lr*lr+Er*Er,sr<=la&&(mr[Z+1]=1,Z++);for(Ce.push({X:ie[0].X,Y:ie[0].Y}),Z=1;Z<Le-1;Z++)mr[Z]||Ce.push({X:ie[Z].X,Y:ie[Z].Y});if(Ce.push({X:ie[Le-1].X,Y:ie[Le-1].Y}),xr&&ie.pop(),mr.length)ie=Ce;else break}Le=Ce.length,Ce[Le-1].X==Ce[0].X&&Ce[Le-1].Y==Ce[0].Y&&Ce.pop(),Ce.length>2&&ui.push(Ce)}return!S[0]instanceof Array&&(ui=ui[0]),typeof ui>"u"&&(ui=[[]]),ui},i.JS.PerimeterOfPath=function(S,R,j){if(typeof S>"u")return 0;var Z=Math.sqrt,ie=0,we,Ce,Le=0,ct=0,_t=0,qt=0,sr=S.length;if(sr<2)return 0;for(R&&(S[sr]=S[0],sr++);--sr;)we=S[sr],Le=we.X,ct=we.Y,Ce=S[sr-1],_t=Ce.X,qt=Ce.Y,ie+=Z((Le-_t)*(Le-_t)+(ct-qt)*(ct-qt));return R&&S.pop(),ie/j},i.JS.PerimeterOfPaths=function(S,R,j){j||(j=1);for(var Z=0,ie=0;ie<S.length;ie++)Z+=i.JS.PerimeterOfPath(S[ie],R,j);return Z},i.JS.ScaleDownPath=function(S,R){var j,Z;for(R||(R=1),j=S.length;j--;)Z=S[j],Z.X=Z.X/R,Z.Y=Z.Y/R},i.JS.ScaleDownPaths=function(S,R){var j,Z,ie;for(R||(R=1),j=S.length;j--;)for(Z=S[j].length;Z--;)ie=S[j][Z],ie.X=ie.X/R,ie.Y=ie.Y/R},i.JS.ScaleUpPath=function(S,R){var j,Z,ie=Math.round;for(R||(R=1),j=S.length;j--;)Z=S[j],Z.X=ie(Z.X*R),Z.Y=ie(Z.Y*R)},i.JS.ScaleUpPaths=function(S,R){var j,Z,ie,we=Math.round;for(R||(R=1),j=S.length;j--;)for(Z=S[j].length;Z--;)ie=S[j][Z],ie.X=we(ie.X*R),ie.Y=we(ie.Y*R)},i.ExPolygons=function(){return[]},i.ExPolygon=function(){this.outer=null,this.holes=null},i.JS.AddOuterPolyNodeToExPolygons=function(S,R){var j=new i.ExPolygon;j.outer=S.Contour();var Z=S.Childs(),ie=Z.length;j.holes=new Array(ie);var we,Ce,Le,ct,_t,qt;for(Le=0;Le<ie;Le++)for(we=Z[Le],j.holes[Le]=we.Contour(),ct=0,_t=we.Childs(),qt=_t.length;ct<qt;ct++)Ce=_t[ct],i.JS.AddOuterPolyNodeToExPolygons(Ce,R);R.push(j)},i.JS.ExPolygonsToPaths=function(S){var R,j,Z,ie,we=new i.Paths;for(R=0,Z=S.length;R<Z;R++)for(we.push(S[R].outer),j=0,ie=S[R].holes.length;j<ie;j++)we.push(S[R].holes[j]);return we},i.JS.PolyTreeToExPolygons=function(S){var R=new i.ExPolygons,j,Z,ie,we;for(Z=0,ie=S.Childs(),we=ie.length;Z<we;Z++)j=ie[Z],i.JS.AddOuterPolyNodeToExPolygons(j,R);return R},e.exports=i}),vWe=bt((t,e)=>{N(),function(){function r(u,c){var p=u.x-c.x,m=u.y-c.y;return p*p+m*m}s(r,"getSqDist");function i(u,c,p){var m=c.x,y=c.y,v=p.x-m,w=p.y-y;if(v!==0||w!==0){var E=((u.x-m)*v+(u.y-y)*w)/(v*v+w*w);E>1?(m=p.x,y=p.y):E>0&&(m+=v*E,y+=w*E)}return v=u.x-m,w=u.y-y,v*v+w*w}s(i,"getSqSegDist");function n(u,c){for(var p=u[0],m=[p],y,v=1,w=u.length;v<w;v++)y=u[v],r(y,p)>c&&(m.push(y),p=y);return p!==y&&m.push(y),m}s(n,"simplifyRadialDist");function a(u,c,p,m,y){for(var v=m,w,E=c+1;E<p;E++){var M=i(u[E],u[c],u[p]);M>v&&(w=E,v=M)}v>m&&(w-c>1&&a(u,c,w,m,y),y.push(u[w]),p-w>1&&a(u,w,p,m,y))}s(a,"simplifyDPStep");function o(u,c){var p=u.length-1,m=[u[0]];return a(u,0,p,c,m),m.push(u[p]),m}s(o,"simplifyDouglasPeucker");function l(u,c,p){if(u.length<=2)return u;var m=c!==void 0?c*c:1;return u=p?u:n(u,m),u=o(u,m),u}s(l,"simplify"),typeof define=="function"&&define.amd?define(function(){return l}):typeof e<"u"?(e.exports=l,e.exports.default=l):typeof self<"u"?self.simplify=l:window.simplify=l}()});N();N();var HO=class mC{constructor(e,r,i){$(this,"__type",mC.__type),$(this,"id",ya()),$(this,"latitude"),$(this,"longitude"),$(this,"floorId"),$(this,"verticalOffset");var n;if(typeof e=="object")this.latitude=e.latitude,this.longitude=e.longitude,this.floorId=e.floorId,this.verticalOffset=(n=e.verticalOffset)!=null?n:0;else{if(r==null)throw new Error("Coordinate longitude is required.");this.latitude=e,this.longitude=r,this.floorId=i,this.verticalOffset=0}}static is(e){return e.__type===mC.__type}get anchorTarget(){return this}get focusTarget(){return this}isEqual(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.floorId===e.floorId}toJSON(){return{__type:mC.__type,latitude:this.latitude,longitude:this.longitude,floor:this.floorId,verticalOffset:this.verticalOffset}}destroy(){}};s(HO,"Coordinate"),$(HO,"__type","coordinate");var _We=HO,On=_We;N();var pye=class{constructor(e){$(this,"id"),this.id=e}};s(pye,"BaseMetaData");var hg=pye,Od,wu,O0,qg,qO=class gC extends hg{constructor(e,r){super(r.mvfData.properties.id),$(this,"__type",gC.__type),Be(this,Od),Be(this,wu,{}),Be(this,O0),Be(this,qg),He(this,Od,e),He(this,O0,r.floorId),He(this,qg,r.mvfData)}static is(e){return e.__type===gC.__type}get locations(){return b(this,wu).locations?b(this,wu).locations:(b(this,wu).locations=(b(this,Od).locationIdsByNodeId[this.id]||[]).map(e=>b(this,Od).getById("enterprise-location",e)).filter(Boolean),b(this,wu).locations)}get space(){var e;return b(this,Od).getById("space",(e=b(this,Od).spaceIdsByNodeId[this.id])==null?void 0:e[0])}get floor(){let e=b(this,Od).getById("floor",b(this,O0));if(e==null)throw new Error("Floor ".concat(b(this,O0)," not found!"));return e}get coordinate(){if(b(this,wu).coordinate==null){let[e,r]=b(this,qg).geometry.coordinates;b(this,wu).coordinate=new On(r,e,b(this,O0))}return b(this,wu).coordinate}get externalId(){var e;return(e=b(this,qg).properties.externalId)!=null?e:""}get neighbors(){if(b(this,wu).neighbours==null){let e=b(this,qg).properties.neighbors.map(r=>{let i=b(this,Od).getById("node",r.id);if(i==null)throw new Error("Node ".concat(r.id," not found!"));return i});b(this,wu).neighbours=e}return b(this,wu).neighbours}get geoJSON(){return vt(Ee({},b(this,qg)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:gC.__type,id:this.id,floor:this.floor.id,coordinate:this.coordinate.toJSON(),neighbors:this.neighbors.map(e=>e.id)}}destroy(){for(let e of Object.keys(b(this,wu)))delete b(this,wu)[e]}};Od=new WeakMap,wu=new WeakMap,O0=new WeakMap,qg=new WeakMap,s(qO,"Node"),$(qO,"__type","node");var xWe=qO,WP=xWe;N();N();var k0,dye=class{constructor(e,r){$(this,"id"),Be(this,k0),this.id=e}get geoJSONBoundingBox(){return b(this,k0)?b(this,k0):"bbox"in this.geoJSON.geometry&&this.geoJSON.geometry.bbox?this.geoJSON.geometry.bbox:(He(this,k0,VA(this.geoJSON)),b(this,k0))}get geoJSON(){return{properties:null,type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}};k0=new WeakMap,s(dye,"BaseMapData");var XP=dye,gy,wh,Mp,_2,yC,WO,XO=class vC extends XP{constructor(e,r){super(r.mvfData.id,e),Be(this,yC),$(this,"__type",vC.__type),Be(this,gy),Be(this,wh,{}),Be(this,Mp),Be(this,_2),He(this,gy,e),He(this,Mp,r.mvfData),He(this,_2,r.facadeId)}static is(e){return e.__type===vC.__type}get type(){return b(this,Mp).type}get name(){var e;return(e=dr(this,yC,WO).call(this,"name"))!=null?e:""}get shortName(){var e;return(e=dr(this,yC,WO).call(this,"shortName"))!=null?e:""}get externalId(){var e;return(e=b(this,Mp).externalId)!=null?e:""}get floors(){var e,r;if(b(this,wh).floors==null){let i=((r=(e=b(this,Mp).floors)!=null?e:b(this,Mp).maps)!=null?r:[]).reduce((n,a)=>{let o=b(this,gy).floorsById[a];return o&&n.push(o),n},[]);i.length===0&&Vt.error("Floor stack ".concat(this.id," has no floors")),b(this,wh).floors=i}return b(this,wh).floors}get defaultFloor(){if(b(this,wh).defaultFloor!=null)return b(this,wh).defaultFloor;let e=b(this,Mp).defaultFloor?b(this,gy).getById("floor",b(this,Mp).defaultFloor):void 0;return b(this,wh).defaultFloor=e||this.floors.reduce((r,i)=>Math.abs(i.elevation)<Math.abs(r.elevation)?i:r),b(this,wh).defaultFloor}get facade(){return b(this,_2)?b(this,gy).facadesById[b(this,_2)]:void 0}toJSON(){return{__type:vC.__type,id:this.id,name:this.name,shortName:this.shortName,type:this.type,floors:this.floors.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(b(this,wh)))delete b(this,wh)[e]}};gy=new WeakMap,wh=new WeakMap,Mp=new WeakMap,_2=new WeakMap,yC=new WeakSet,WO=s(function(t){return b(this,gy).getPropTranslation(this.__type,t,this.id,b(this,Mp)[t])},"#translate"),s(XO,"FloorStack"),$(XO,"__type","floor-stack");var bWe=XO,fye=bWe;N();N();N();N();N();N();var _C,fm,ZO=class xC extends hg{constructor(e){super(String(ya())),$(this,"__type",xC.__type),Be(this,_C,{}),Be(this,fm),He(this,fm,e.mvfData)}static is(e){return e.__type===xC.__type}get url(){return b(this,fm).url}get name(){if("displayName"in b(this,fm))return b(this,fm).displayName;if("label"in b(this,fm))return b(this,fm).label}toJSON(){return{__type:xC.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(b(this,_C)))delete b(this,_C)[e]}};_C=new WeakMap,fm=new WeakMap,s(ZO,"Hyperlink"),$(ZO,"__type","hyperlink");var wWe=ZO,nT=wWe;N();N();function aT(t){return typeof t=="string"?t:t.id}s(aT,"getId");function iz(t){return Array.isArray(t)&&Number.isFinite(t[0])&&Number.isFinite(t[1])}s(iz,"isPosition");var L6=8,fx=s(t=>typeof t=="number"?t.toFixed(L6):iz(t)?t[1].toFixed(L6)+"-"+t[0].toFixed(L6):t.map(e=>fx(e)).join("-"),"serializeCoords"),AWe=s(t=>{let e=/^https:\/\/cdn\.mappedin\.com\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/,r=/^https:\/\/cdn-staging\.mappedin\.net\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/;return e.test(t)||r.test(t)},"isPrivateCdnAsset"),mye=s(t=>{if(!AWe(t))return null;let e="";t.startsWith("https://")?(e="https://",t=t.slice(8)):t.startsWith("http://")&&(e="http://",t=t.slice(7));let[r,i,n]=t.split("/");return{origin:e+r,mapId:i,fileName:n}},"parseCdnAssetUrl"),bC,Wg,N0,YO=class wC extends hg{constructor(e){super(String(ya())),$(this,"__type",wC.__type),Be(this,bC,{}),Be(this,Wg),Be(this,N0),He(this,Wg,e.mvfData),He(this,N0,e.mapData)}static is(e){return e.__type===wC.__type}get url(){let e=b(this,Wg).url;if(b(this,N0).tokenManager==null)return e;let r=mye(b(this,Wg).url);if(r==null)return e;let i=r.mapId;try{if(b(this,N0).tokenManager.isEnterpriseMode())return e;let n=b(this,N0).tokenManager.getSasToken(i).token;if(n==null||n==="")throw new Error("SAS token empty!");return"".concat(e,"?").concat(n)}catch(n){return Vt.error("Error getting SAS token for image",{error:n,url:e}),e}}get name(){return b(this,Wg).altText}get altText(){return b(this,Wg).altText}toJSON(){return{__type:wC.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(b(this,bC)))delete b(this,bC)[e]}};bC=new WeakMap,Wg=new WeakMap,N0=new WeakMap,s(YO,"ImageMetaData"),$(YO,"__type","image");var SWe=YO,oT=SWe,x2,gp,mm,gye=class extends XP{constructor(e,r){super(r.properties.id,e),Be(this,x2),Be(this,gp),Be(this,mm,{}),He(this,x2,e),He(this,gp,r)}get externalId(){var e;return(e=b(this,gp).properties.externalId)!=null?e:""}get name(){var e,r,i,n,a;let o="";return"details"in b(this,gp).properties||(o=(e=b(this,gp).properties.externalId)!=null?e:""),o===""&&(o=(i=(r=b(this,gp).properties.details)==null?void 0:r.name)!=null?i:""),o===""&&(o=(a=(n=this.locationProfiles.find(l=>l.name&&l.name.length>0))==null?void 0:n.name)!=null?a:""),o}get description(){var e,r,i,n;let a=(r=(e=b(this,gp).properties.details)==null?void 0:e.description)!=null?r:"";return a===""&&(a=(n=(i=this.locationProfiles.find(o=>o.description&&o.description.length>0))==null?void 0:i.description)!=null?n:""),a}get images(){var e,r,i,n,a;if(b(this,mm).images!=null)return b(this,mm).images;let o=(i=(r=(e=b(this,gp).properties.details)==null?void 0:e.images)==null?void 0:r.map(l=>new oT({mvfData:l,mapData:b(this,x2)})))!=null?i:[];return(o==null||o.length===0)&&(o=(a=(n=this.locationProfiles.find(l=>l.images.length>0))==null?void 0:n.images)!=null?a:[]),b(this,mm).images=o,o}get links(){var e,r,i,n,a;if(b(this,mm).links!=null)return b(this,mm).links;let o=(i=(r=(e=b(this,gp).properties.details)==null?void 0:e.links)==null?void 0:r.map(l=>new nT({mvfData:l})))!=null?i:[];return(o==null||o.length===0)&&(o=(a=(n=this.locationProfiles.find(l=>l.links.length>0))==null?void 0:n.links)!=null?a:[]),b(this,mm).links=o,o}get locationProfiles(){var e;return(e=b(this,x2).locationProfilesByAttachedFeatureId[this.id])!=null?e:[]}};x2=new WeakMap,gp=new WeakMap,mm=new WeakMap,s(gye,"DetailedMapData");var mv=gye,AC,F0,b2,w2,KO=class SC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",SC.__type),Be(this,AC),Be(this,F0),Be(this,b2,{}),Be(this,w2),He(this,AC,e),He(this,F0,r.floorId),He(this,w2,r.mvfData)}static is(e){return e.__type===SC.__type}get center(){var e;if(b(this,b2).center==null){let[r,i]=(e=b(this,w2).properties.center)!=null?e:[0,0];b(this,b2).center=new On(i,r,b(this,F0))}return b(this,b2).center}get floor(){let e=b(this,AC).getById("floor",b(this,F0));if(e==null)throw new Error("Floor ".concat(b(this,F0)," not found!"));return e}get geoJSON(){return vt(Ee({},b(this,w2)),{properties:null})}get focusTarget(){return this}get anchorTarget(){return this.center}toJSON(){return{__type:SC.__type,id:this.id,name:this.name,floor:this.floor.id}}destroy(){}};AC=new WeakMap,F0=new WeakMap,b2=new WeakMap,w2=new WeakMap,s(KO,"Area"),$(KO,"__type","area");var MWe=KO,ZP=MWe;N();var B0,gm,z0,A2,JO=class MC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",MC.__type),Be(this,B0),Be(this,gm),Be(this,z0),Be(this,A2),He(this,gm,{}),He(this,A2,r.mvfData),He(this,B0,e),He(this,z0,r.floorId)}static is(e){return e.__type===MC.__type}get floor(){let e=b(this,B0).getById("floor",b(this,z0));if(e==null)throw new Error("Floor ".concat(b(this,z0)," not found!"));return e}get center(){if(b(this,gm).center==null){let[[e,r],[i,n]]=b(this,A2).geometry.coordinates,a=(e+i)/2,o=(r+n)/2;b(this,gm).center=new On(o,a,b(this,z0))}return b(this,gm).center}get isExterior(){var e;let r=b(this,B0).obstructionIdByEntranceId[this.id],i=b(this,B0).getMVFFeatureById("obstruction",r);return(e=i==null?void 0:i.properties.footprintComponent)!=null?e:!1}get geoJSON(){return vt(Ee({},b(this,A2)),{properties:null})}get focusTarget(){return this.center}get anchorTarget(){return this.center}toJSON(){return{__type:MC.__type,id:this.id,name:this.name,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(b(this,gm)))delete b(this,gm)[e]}};B0=new WeakMap,gm=new WeakMap,z0=new WeakMap,A2=new WeakMap,s(JO,"Door"),$(JO,"__type","door");var EWe=JO,HA=EWe;N();var Xg,U0,$c,kd,QO=class EC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",EC.__type),Be(this,Xg),Be(this,U0),Be(this,$c,{}),Be(this,kd),He(this,Xg,e),He(this,U0,r.floorId),He(this,kd,r.mvfData)}getMvfData(){return b(this,kd)}static is(e){return e.__type===EC.__type}get type(){return yye(b(this,kd).properties.kind)}get locations(){if(b(this,$c).locations)return b(this,$c).locations;b(this,$c).locations=[];let e=b(this,Xg).mvfLocationsBySpaceId[b(this,kd).properties.id];if((e==null?void 0:e.length)>0)for(let r of e){let i=b(this,Xg).getById("enterprise-location",r.id);i&&b(this,$c).locations.push(i)}return b(this,$c).locations}get floor(){let e=b(this,Xg).getById("floor",b(this,U0));if(e==null)throw new Error("Floor ".concat(b(this,U0)," not found!"));return e}get doors(){return b(this,kd).properties.destinationNodes.reduce((e,r)=>{let i=b(this,Xg).doorsByNodeId[r];return i&&e.push(i),e},[])}get center(){var e;if(b(this,$c).center==null){let[r,i]=(e=b(this,kd).properties.center)!=null?e:[0,0];b(this,$c).center=new On(i,r,b(this,U0))}return b(this,$c).center}get geoJSON(){return vt(Ee({},b(this,kd)),{properties:null})}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}get anchorTarget(){return this.center}toJSON(){return{__type:EC.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(b(this,$c)))delete b(this,$c)[e]}};Xg=new WeakMap,U0=new WeakMap,$c=new WeakMap,kd=new WeakMap,s(QO,"Space"),$(QO,"__type","space");var CWe=QO,IWe=["room","hallway","exterior","void","connection.stairs","connection.elevator","poi"];function yye(t){if(t==null||t==="default")return"room";let e=t.toLowerCase();return IWe.includes(e)?e:"room"}s(yye,"validateSpaceType");var Zp=CWe;N();N();N();N();function rg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}s(rg,"getCoord");function gf(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}s(gf,"getCoords");function vye(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}s(vye,"featureOf");function qA(t){return t.type==="Feature"?t.geometry:t}s(qA,"getGeom");function _ye(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}s(_ye,"getType");kr(HB(),1);N();kr(OHe(),1);N();N();function yf(t,e,r){if(r===void 0&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=rg(t),n=qA(e),a=n.type,o=e.bbox,l=n.coordinates;if(o&&xye(i,o)===!1)return!1;a==="Polygon"&&(l=[l]);for(var u=!1,c=0;c<l.length&&!u;c++)if(ek(i,l[c][0],r.ignoreBoundary)){for(var p=!1,m=1;m<l[c].length&&!p;)ek(i,l[c][m],!r.ignoreBoundary)&&(p=!0),m++;p||(u=!0)}return u}s(yf,"booleanPointInPolygon");function ek(t,e,r){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],l=e[n][1],u=e[a][0],c=e[a][1],p=t[1]*(o-u)+l*(u-t[0])+c*(t[0]-o)===0&&(o-t[0])*(u-t[0])<=0&&(l-t[1])*(c-t[1])<=0;if(p)return!r;var m=l>t[1]!=c>t[1]&&t[0]<(u-o)*(t[1]-l)/(c-l)+o;m&&(i=!i)}return i}s(ek,"inRing");function xye(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}s(xye,"inBBox");N();N();function bye(t,e,r){r===void 0&&(r={});var i=rg(t),n=rg(e),a=eh(n[1]-i[1]),o=eh(n[0]-i[0]),l=eh(i[1]),u=eh(n[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(l)*Math.cos(u);return Kme(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)}s(bye,"distance");var V0=bye;N();(function(){function t(e,r,i){this.a=e,this.b=r,this.c=i;var n=r.x-e.x,a=r.y-e.y,o=i.x-e.x,l=i.y-e.y,u=n*(e.x+r.x)+a*(e.y+r.y),c=o*(e.x+i.x)+l*(e.y+i.y),p=2*(n*(i.y-r.y)-a*(i.x-r.x)),m,y;this.x=(l*u-a*c)/p,this.y=(n*c-o*u)/p,m=this.x-e.x,y=this.y-e.y,this.r=m*m+y*y}return s(t,"Triangle"),t})();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();kr(Dge(),1);N();N();N();N();N();(function(){function t(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var r=0;r<this.length;r++)this.points[r].z=this.points[r].z||0;for(var r=0;r<this.length-1;r++){var i=this.points[r],n=this.points[r+1];this.centers.push({x:(i.x+n.x)/2,y:(i.y+n.y)/2,z:(i.z+n.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var r=0;r<this.centers.length-1;r++){var a=this.points[r+1].x-(this.centers[r].x+this.centers[r+1].x)/2,o=this.points[r+1].y-(this.centers[r].y+this.centers[r+1].y)/2,l=this.points[r+1].z-(this.centers[r].y+this.centers[r+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[r+1].x+this.sharpness*(this.centers[r].x+a),y:(1-this.sharpness)*this.points[r+1].y+this.sharpness*(this.centers[r].y+o),z:(1-this.sharpness)*this.points[r+1].z+this.sharpness*(this.centers[r].z+l)},{x:(1-this.sharpness)*this.points[r+1].x+this.sharpness*(this.centers[r+1].x+a),y:(1-this.sharpness)*this.points[r+1].y+this.sharpness*(this.centers[r+1].y+o),z:(1-this.sharpness)*this.points[r+1].z+this.sharpness*(this.centers[r+1].z+l)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return s(t,"Spline"),t.prototype.cacheSteps=function(e){var r=[],i=this.pos(0);r.push(0);for(var n=0;n<this.duration;n+=10){var a=this.pos(n),o=Math.sqrt((a.x-i.x)*(a.x-i.x)+(a.y-i.y)*(a.y-i.y)+(a.z-i.z)*(a.z-i.z));o>e&&(r.push(n),i=a)}return r},t.prototype.vector=function(e){var r=this.pos(e+10),i=this.pos(e-10);return{angle:180*Math.atan2(r.y-i.y,r.x-i.x)/3.14,speed:Math.sqrt((i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y)+(i.z-r.z)*(i.z-r.z))}},t.prototype.pos=function(e){var r=e-this.delay;r<0&&(r=0),r>this.duration&&(r=this.duration-1);var i=r/this.duration;if(i>=1)return this.points[this.length-1];var n=Math.floor((this.points.length-1)*i),a=(this.length-1)*i-n;return wye(a,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])},t})();function wye(t,e,r,i,n){var a=Aye(t),o={x:n.x*a[0]+i.x*a[1]+r.x*a[2]+e.x*a[3],y:n.y*a[0]+i.y*a[1]+r.y*a[2]+e.y*a[3],z:n.z*a[0]+i.z*a[1]+r.z*a[2]+e.z*a[3]};return o}s(wye,"bezier");function Aye(t){var e=t*t,r=e*t;return[r,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}s(Aye,"B");N();N();N();N();function Sye(t,e){e===void 0&&(e={});var r=Number(t[0]),i=Number(t[1]),n=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[r,i],l=[r,a],u=[n,a],c=[n,i];return u_([[o,c,u,l,o]],e.properties,{bbox:t,id:e.id})}s(Sye,"bboxPolygon");function Mye(t){return Sye(VA(t))}s(Mye,"envelope");var TWe=Mye;N();N();N();function Nw(t,e,r,i){i===void 0&&(i={});var n=rg(t),a=eh(n[0]),o=eh(n[1]),l=eh(r),u=Jme(e,i.units),c=Math.asin(Math.sin(o)*Math.cos(u)+Math.cos(o)*Math.sin(u)*Math.cos(l)),p=a+Math.atan2(Math.sin(l)*Math.sin(u)*Math.cos(o),Math.cos(u)-Math.sin(o)*Math.sin(c)),m=Q3(p),y=Q3(c);return hf([m,y],i.properties)}s(Nw,"destination");N();N();function nz(t,e,r){if(r===void 0&&(r={}),r.final===!0)return Eye(t,e);var i=rg(t),n=rg(e),a=eh(i[0]),o=eh(n[0]),l=eh(i[1]),u=eh(n[1]),c=Math.sin(o-a)*Math.cos(u),p=Math.cos(l)*Math.sin(u)-Math.sin(l)*Math.cos(u)*Math.cos(o-a);return Q3(Math.atan2(c,p))}s(nz,"bearing");function Eye(t,e){var r=nz(e,t);return r=(r+180)%360,r}s(Eye,"calculateFinalBearing");N();function Cye(t,e){e===void 0&&(e={});var r=VA(t),i=(r[0]+r[2])/2,n=(r[1]+r[3])/2;return hf([i,n],e.properties,e)}s(Cye,"center");var az=Cye;N();N();N();N();N();kr(A9(),1);N();N();N();N();function Iye(t){if(!t)throw new Error("geojson is required");var e=[];return mf(t,function(r){Tye(r,e)}),Rw(e)}s(Iye,"lineSegment");function Tye(t,e){var r=[],i=t.geometry;if(i!==null){switch(i.type){case"Polygon":r=gf(i);break;case"LineString":r=[gf(i)]}r.forEach(function(n){var a=Pye(n,t.properties);a.forEach(function(o){o.id=e.length,e.push(o)})})}}s(Tye,"lineSegmentFeature");function Pye(t,e){var r=[];return t.reduce(function(i,n){var a=tg([i,n],e);return a.bbox=Lye(i,n),r.push(a),n}),r}s(Pye,"createSegments");function Lye(t,e){var r=t[0],i=t[1],n=e[0],a=e[1],o=r<n?r:n,l=i<a?i:a,u=r>n?r:n,c=i>a?i:a;return[o,l,u,c]}s(Lye,"bbox");var EW=Iye,PWe=kr(qB(),1);function Dye(t,e){var r={},i=[];if(t.type==="LineString"&&(t=Vh(t)),e.type==="LineString"&&(e=Vh(e)),t.type==="Feature"&&e.type==="Feature"&&t.geometry!==null&&e.geometry!==null&&t.geometry.type==="LineString"&&e.geometry.type==="LineString"&&t.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var n=tk(t,e);return n&&i.push(n),Rw(i)}var a=(0,PWe.default)();return a.load(EW(e)),BO(EW(t),function(o){BO(a.search(o),function(l){var u=tk(o,l);if(u){var c=gf(u).join(",");r[c]||(r[c]=!0,i.push(u))}})}),Rw(i)}s(Dye,"lineIntersect");function tk(t,e){var r=gf(t),i=gf(e);if(r.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(i.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=r[0][0],a=r[0][1],o=r[1][0],l=r[1][1],u=i[0][0],c=i[0][1],p=i[1][0],m=i[1][1],y=(m-c)*(o-n)-(p-u)*(l-a),v=(p-u)*(a-c)-(m-c)*(n-u),w=(o-n)*(a-c)-(l-a)*(n-u);if(y===0)return null;var E=v/y,M=w/y;if(E>=0&&E<=1&&M>=0&&M<=1){var I=n+E*(o-n),P=a+E*(l-a);return hf([I,P])}return null}s(tk,"intersects");var YP=Dye;function Rye(t,e,r){r===void 0&&(r={});var i=hf([1/0,1/0],{dist:1/0}),n=0;return mf(t,function(a){for(var o=gf(a),l=0;l<o.length-1;l++){var u=hf(o[l]);u.properties.dist=V0(e,u,r);var c=hf(o[l+1]);c.properties.dist=V0(e,c,r);var p=V0(u,c,r),m=Math.max(u.properties.dist,c.properties.dist),y=nz(u,c),v=Nw(e,m,y+90,r),w=Nw(e,m,y-90,r),E=YP(tg([v.geometry.coordinates,w.geometry.coordinates]),tg([u.geometry.coordinates,c.geometry.coordinates])),M=null;E.features.length>0&&(M=E.features[0],M.properties.dist=V0(e,M,r),M.properties.location=n+V0(u,M,r)),u.properties.dist<i.properties.dist&&(i=u,i.properties.index=l,i.properties.location=n),c.properties.dist<i.properties.dist&&(i=c,i.properties.index=l+1,i.properties.location=n+p),M&&M.properties.dist<i.properties.dist&&(i=M,i.properties.index=l),n+=p}}),i}s(Rye,"nearestPointOnLine");var rk=Rye;N();N();N();kr(HB(),1);N();N();N();N();N();N();function ik(t,e){return e===void 0&&(e={}),rge(t,function(r,i){var n=i.geometry.coordinates;return r+V0(n[0],n[1],e)},0)}s(ik,"length");N();function Oye(t,e,r){var i=gf(r);if(_ye(r)!=="LineString")throw new Error("line must be a LineString");var n=rk(r,t),a=rk(r,e),o;n.properties.index<=a.properties.index?o=[n,a]:o=[a,n];for(var l=[o[0].geometry.coordinates],u=o[0].properties.index+1;u<o[1].properties.index+1;u++)l.push(i[u]);return l.push(o[1].geometry.coordinates),tg(l,r.properties)}s(Oye,"lineSlice");var CW=Oye;N();N();N();N();function kye(t,e,r){r===void 0&&(r={});for(var i=rg(t),n=gf(e),a=0;a<n.length-1;a++){var o=!1;if(r.ignoreEndVertices&&(a===0&&(o="start"),a===n.length-2&&(o="end"),a===0&&a+1===n.length-1&&(o="both")),Nye(n[a],n[a+1],i,o,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}s(kye,"booleanPointOnLine");function Nye(t,e,r,i,n){var a=r[0],o=r[1],l=t[0],u=t[1],c=e[0],p=e[1],m=r[0]-l,y=r[1]-u,v=c-l,w=p-u,E=m*w-y*v;if(n!==null){if(Math.abs(E)>n)return!1}else if(E!==0)return!1;if(i){if(i==="start")return Math.abs(v)>=Math.abs(w)?v>0?l<a&&a<=c:c<=a&&a<l:w>0?u<o&&o<=p:p<=o&&o<u;if(i==="end")return Math.abs(v)>=Math.abs(w)?v>0?l<=a&&a<c:c<a&&a<=l:w>0?u<=o&&o<p:p<o&&o<=u;if(i==="both")return Math.abs(v)>=Math.abs(w)?v>0?l<a&&a<c:c<a&&a<l:w>0?u<o&&o<p:p<o&&o<u}else return Math.abs(v)>=Math.abs(w)?v>0?l<=a&&a<=c:c<=a&&a<=l:w>0?u<=o&&o<=p:p<=o&&o<=u;return!1}s(Nye,"isPointOnLineSegment");var LWe=kye;N();N();N();N();kr(Dge(),1);N();var IW=Math.PI/180,TW=180/Math.PI,Fw=s(function(t,e){this.lon=t,this.lat=e,this.x=IW*t,this.y=IW*e},"Coord");Fw.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Fw.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Fw(e,t)};var Fye=s(function(){this.coords=[],this.length=0},"LineString");Fye.prototype.move_to=function(t){this.length++,this.coords.push(t)};var oz=s(function(t){this.properties=t||{},this.geometries=[]},"Arc");oz.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}};oz.prototype.wkt=function(){for(var t="",e="LINESTRING(",r=s(function(a){e+=a[0]+" "+a[1]+","},"collect"),i=0;i<this.geometries.length;i++){if(this.geometries[i].coords.length===0)return"LINESTRING(empty)";var n=this.geometries[i].coords;n.forEach(r),t+=e.substring(0,e.length-1)+")"}return t};var Bye=s(function(t,e,r){if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Fw(t.x,t.y),this.end=new Fw(e.x,e.y),this.properties=r||{};var i=this.start.x-this.end.x,n=this.start.y-this.end.y,a=Math.pow(Math.sin(n/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)},"GreatCircle");Bye.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),r=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+r*Math.cos(this.end.y)*Math.cos(this.end.x),n=e*Math.cos(this.start.y)*Math.sin(this.start.x)+r*Math.cos(this.end.y)*Math.sin(this.end.x),a=e*Math.sin(this.start.y)+r*Math.sin(this.end.y),o=TW*Math.atan2(a,Math.sqrt(Math.pow(i,2)+Math.pow(n,2))),l=TW*Math.atan2(n,i);return[l,o]};Bye.prototype.Arc=function(t,e){var r=[];if(!t||t<=2)r.push([this.start.lon,this.start.lat]),r.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),n=0;n<t;++n){var a=i*n,o=this.interpolate(a);r.push(o)}for(var l=!1,u=0,c=e&&e.offset?e.offset:10,p=180-c,m=-180+c,y=360-c,v=1;v<r.length;++v){var w=r[v-1][0],E=r[v][0],M=Math.abs(E-w);M>y&&(E>p&&w<m||w>p&&E<m)?l=!0:M>u&&(u=M)}var I=[];if(l&&u<c){var P=[];I.push(P);for(var C=0;C<r.length;++C){var T=parseFloat(r[C][0]);if(C>0&&Math.abs(T-r[C-1][0])>y){var O=parseFloat(r[C-1][0]),F=parseFloat(r[C-1][1]),k=parseFloat(r[C][0]),B=parseFloat(r[C][1]);if(O>-180&&O<m&&k===180&&C+1<r.length&&r[C-1][0]>-180&&r[C-1][0]<m){P.push([-180,r[C][1]]),C++,P.push([r[C][0],r[C][1]]);continue}else if(O>p&&O<180&&k===-180&&C+1<r.length&&r[C-1][0]>p&&r[C-1][0]<180){P.push([180,r[C][1]]),C++,P.push([r[C][0],r[C][1]]);continue}if(O<m&&k>p){var U=O;O=k,k=U;var z=F;F=B,B=z}if(O>p&&k<m&&(k+=360),O<=180&&k>=180&&O<k){var q=(180-O)/(k-O),W=q*B+(1-q)*F;P.push([r[C-1][0]>p?180:-180,W]),P=[],P.push([r[C-1][0]>p?-180:180,W]),I.push(P)}else P=[],I.push(P);P.push([T,r[C][1]])}else P.push([r[C][0],r[C][1]])}}else{var J=[];I.push(J);for(var V=0;V<r.length;++V)J.push([r[V][0],r[V][1]])}for(var oe=new oz(this.properties),Y=0;Y<I.length;++Y){var he=new Fye;oe.geometries.push(he);for(var Q=I[Y],ae=0;ae<Q.length;++ae)he.move_to(Q[ae])}return oe};N();kr(qB(),1);N();N();function sT(t,e){e===void 0&&(e={});var r=qA(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),r.type){case"Polygon":return zye(r,e);case"MultiPolygon":return Uye(r,e);default:throw new Error("invalid poly")}}s(sT,"default");function zye(t,e){e===void 0&&(e={});var r=qA(t),i=r.coordinates,n=e.properties?e.properties:t.type==="Feature"?t.properties:{};return sz(i,n)}s(zye,"polygonToLine");function Uye(t,e){e===void 0&&(e={});var r=qA(t),i=r.coordinates,n=e.properties?e.properties:t.type==="Feature"?t.properties:{},a=[];return i.forEach(function(o){a.push(sz(o,n))}),Rw(a)}s(Uye,"multiPolygonToLine");function sz(t,e){return t.length>1?Xme(t,e):tg(t[0],e)}s(sz,"coordsToLine");N();N();N();N();kr(qB(),1);kr(Jge(),1);N();N();N();N();N();N();N();kr(HB(),1);s(function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},"p00");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},"p01");s(function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},"p02");s(function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},"p03");s(function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},"p04");s(function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},"p05");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},"p06");s(function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},"p07");s(function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},"p08");s(function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},"p09");s(function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},"p10");s(function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},"p11");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},"p12");s(function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},"p13");s(function(){return[[0,0],[0,1],[1,1],[1,0]]},"p14");s(function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},"p15");s(function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},"p16");s(function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},"p17");s(function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},"p18");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},"p19");s(function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},"p20");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},"p21");s(function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},"p22");s(function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p23");s(function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},"p24");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},"p25");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},"p26");s(function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},"p27");s(function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},"p28");s(function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},"p29");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},"p30");s(function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},"p31");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p32");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},"p33");s(function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},"p34");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p35");s(function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},"p36");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},"p37");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p38");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},"p39");N();N();N();N();N();N();N();N();function Vye(t){return(t>0)-(t<0)||+t}s(Vye,"mathSign");function KP(t,e,r){var i=e[0]-t[0],n=e[1]-t[1],a=r[0]-e[0],o=r[1]-e[1];return Vye(i*o-a*n)}s(KP,"orientationIndex");function jye(t,e){var r=t.geometry.coordinates[0].map(function(o){return o[0]}),i=t.geometry.coordinates[0].map(function(o){return o[1]}),n=e.geometry.coordinates[0].map(function(o){return o[0]}),a=e.geometry.coordinates[0].map(function(o){return o[1]});return Math.max.apply(null,r)===Math.max.apply(null,n)&&Math.max.apply(null,i)===Math.max.apply(null,a)&&Math.min.apply(null,r)===Math.min.apply(null,n)&&Math.min.apply(null,i)===Math.min.apply(null,a)}s(jye,"envelopeIsEqual");function nk(t,e){return e.geometry.coordinates[0].every(function(r){return yf(hf(r),t)})}s(nk,"envelopeContains");function $ye(t,e){return t[0]===e[0]&&t[1]===e[1]}s($ye,"coordinatesEqual");var DWe=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return s(t,"Node"),t.buildId=function(e){return e.join(",")},t.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(r){return r.from.id!==e.from.id})},t.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(r){return r.to.id!==e.to.id})},t.prototype.addOuterEdge=function(e){this.outerEdges.push(e),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var e=this;this.outerEdgesSorted||(this.outerEdges.sort(function(r,i){var n=r.to,a=i.to;if(n.coordinates[0]-e.coordinates[0]>=0&&a.coordinates[0]-e.coordinates[0]<0)return 1;if(n.coordinates[0]-e.coordinates[0]<0&&a.coordinates[0]-e.coordinates[0]>=0)return-1;if(n.coordinates[0]-e.coordinates[0]===0&&a.coordinates[0]-e.coordinates[0]===0)return n.coordinates[1]-e.coordinates[1]>=0||a.coordinates[1]-e.coordinates[1]>=0?n.coordinates[1]-a.coordinates[1]:a.coordinates[1]-n.coordinates[1];var o=KP(e.coordinates,n.coordinates,a.coordinates);if(o<0)return 1;if(o>0)return-1;var l=Math.pow(n.coordinates[0]-e.coordinates[0],2)+Math.pow(n.coordinates[1]-e.coordinates[1],2),u=Math.pow(a.coordinates[0]-e.coordinates[0],2)+Math.pow(a.coordinates[1]-e.coordinates[1],2);return l-u}),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(e){return this.sortOuterEdges(),this.outerEdges[e]},t.prototype.addInnerEdge=function(e){this.innerEdges.push(e)},t}(),PW=DWe;N();var RWe=function(){function t(e,r){this.from=e,this.to=r,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return s(t,"Edge"),t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(e){return this.from.id===e.from.id&&this.to.id===e.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return tg([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(e){return KP(e.from.coordinates,e.to.coordinates,this.to.coordinates)},t}(),OWe=RWe;N();var kWe=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return s(t,"EdgeRing"),t.prototype.push=function(e){this.edges.push(e),this.polygon=this.envelope=void 0},t.prototype.get=function(e){return this.edges[e]},Object.defineProperty(t.prototype,"length",{get:s(function(){return this.edges.length},"get"),enumerable:!0,configurable:!0}),t.prototype.forEach=function(e){this.edges.forEach(e)},t.prototype.map=function(e){return this.edges.map(e)},t.prototype.some=function(e){return this.edges.some(e)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var e=this,r=this.edges.reduce(function(o,l,u){return l.from.coordinates[1]>e.edges[o].from.coordinates[1]&&(o=u),o},0),i=(r===0?this.length:r)-1,n=(r+1)%this.length,a=KP(this.edges[i].from.coordinates,this.edges[r].from.coordinates,this.edges[n].from.coordinates);return a===0?this.edges[i].from.coordinates[0]>this.edges[n].from.coordinates[0]:a>0},t.prototype.toMultiPoint=function(){return Zme(this.edges.map(function(e){return e.from.coordinates}))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var e=this.edges.map(function(r){return r.from.coordinates});return e.push(this.edges[0].from.coordinates),this.polygon=u_([e])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=TWe(this.toPolygon())},t.findEdgeRingContaining=function(e,r){var i=e.getEnvelope(),n,a;return r.forEach(function(o){var l=o.getEnvelope();if(a&&(n=a.getEnvelope()),!jye(l,i)&&nk(l,i)){for(var u=e.map(function(w){return w.from.coordinates}),c=void 0,p=s(function(w){o.some(function(E){return $ye(w,E.from.coordinates)})||(c=w)},"_loop_1"),m=0,y=u;m<y.length;m++){var v=y[m];p(v)}c&&o.inside(hf(c))&&(!a||nk(n,l))&&(a=o)}}),a},t.prototype.inside=function(e){return yf(e,this.toPolygon())},t}(),NWe=kWe;function Gye(t){if(!t)throw new Error("No geojson passed");if(t.type!=="FeatureCollection"&&t.type!=="GeometryCollection"&&t.type!=="MultiLineString"&&t.type!=="LineString"&&t.type!=="Feature")throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}s(Gye,"validateGeoJson");(function(){function t(){this.edges=[],this.nodes={}}return s(t,"Graph"),t.fromGeoJson=function(e){Gye(e);var r=new t;return mf(e,function(i){vye(i,"LineString","Graph::fromGeoJson"),Qme(i,function(n,a){if(n){var o=r.getNode(n),l=r.getNode(a);r.addEdge(o,l)}return a})}),r},t.prototype.getNode=function(e){var r=PW.buildId(e),i=this.nodes[r];return i||(i=this.nodes[r]=new PW(e)),i},t.prototype.addEdge=function(e,r){var i=new OWe(e,r),n=i.getSymetric();this.edges.push(i),this.edges.push(n)},t.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(r){return e.nodes[r]}).forEach(function(r){return e._removeIfDangle(r)})},t.prototype._removeIfDangle=function(e){var r=this;if(e.innerEdges.length<=1){var i=e.getOuterEdges().map(function(n){return n.to});this.removeNode(e),i.forEach(function(n){return r._removeIfDangle(n)})}},t.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(r){r.label===r.symetric.label&&(e.removeEdge(r.symetric),e.removeEdge(r))})},t.prototype._computeNextCWEdges=function(e){var r=this;typeof e>"u"?Object.keys(this.nodes).forEach(function(i){return r._computeNextCWEdges(r.nodes[i])}):e.getOuterEdges().forEach(function(i,n){e.getOuterEdge((n===0?e.getOuterEdges().length:n)-1).symetric.next=i})},t.prototype._computeNextCCWEdges=function(e,r){for(var i=e.getOuterEdges(),n,a,o=i.length-1;o>=0;--o){var l=i[o],u=l.symetric,c=void 0,p=void 0;l.label===r&&(c=l),u.label===r&&(p=u),!(!c||!p)&&(p&&(a=p),c&&(a&&(a.next=c,a=void 0),n||(n=c)))}a&&(a.next=n)},t.prototype._findLabeledEdgeRings=function(){var e=[],r=0;return this.edges.forEach(function(i){if(!(i.label>=0)){e.push(i);var n=i;do n.label=r,n=n.next;while(!i.isEqual(n));r++}}),e},t.prototype.getEdgeRings=function(){var e=this;this._computeNextCWEdges(),this.edges.forEach(function(i){i.label=void 0}),this._findLabeledEdgeRings().forEach(function(i){e._findIntersectionNodes(i).forEach(function(n){e._computeNextCCWEdges(n,i.label)})});var r=[];return this.edges.forEach(function(i){i.ring||r.push(e._findEdgeRing(i))}),r},t.prototype._findIntersectionNodes=function(e){var r=[],i=e,n=s(function(){var a=0;i.from.getOuterEdges().forEach(function(o){o.label===e.label&&++a}),a>1&&r.push(i.from),i=i.next},"_loop_1");do n();while(!e.isEqual(i));return r},t.prototype._findEdgeRing=function(e){var r=e,i=new NWe;do i.push(r),r.ring=i,r=r.next;while(!e.isEqual(r));return i},t.prototype.removeNode=function(e){var r=this;e.getOuterEdges().forEach(function(i){return r.removeEdge(i)}),e.innerEdges.forEach(function(i){return r.removeEdge(i)}),delete this.nodes[e.id]},t.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(r){return!r.isEqual(e)}),e.deleteEdge()},t})();N();function Hye(t,e){var r=!0;return mf(t,function(i){mf(e,function(n){if(r===!1)return!1;r=qye(i.geometry,n.geometry)})}),r}s(Hye,"booleanDisjoint");function qye(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!Yye(t.coordinates,e.coordinates);case"LineString":return!ak(e,t);case"Polygon":return!yf(t,e)}break;case"LineString":switch(e.type){case"Point":return!ak(t,e);case"LineString":return!Wye(t,e);case"Polygon":return!ok(e,t)}break;case"Polygon":switch(e.type){case"Point":return!yf(e,t);case"LineString":return!ok(t,e);case"Polygon":return!Xye(e,t)}}return!1}s(qye,"disjoint");function ak(t,e){for(var r=0;r<t.coordinates.length-1;r++)if(Zye(t.coordinates[r],t.coordinates[r+1],e.coordinates))return!0;return!1}s(ak,"isPointOnLine");function Wye(t,e){var r=YP(t,e);return r.features.length>0}s(Wye,"isLineOnLine");function ok(t,e){for(var r=0,i=e.coordinates;r<i.length;r++){var n=i[r];if(yf(n,t))return!0}var a=YP(e,sT(t));return a.features.length>0}s(ok,"isLineInPoly");function Xye(t,e){for(var r=0,i=t.coordinates[0];r<i.length;r++){var n=i[r];if(yf(n,e))return!0}for(var a=0,o=e.coordinates[0];a<o.length;a++){var l=o[a];if(yf(l,t))return!0}var u=YP(sT(t),sT(e));return u.features.length>0}s(Xye,"isPolyInPoly");function Zye(t,e,r){var i=r[0]-t[0],n=r[1]-t[1],a=e[0]-t[0],o=e[1]-t[1],l=i*o-n*a;return l!==0?!1:Math.abs(a)>=Math.abs(o)?a>0?t[0]<=r[0]&&r[0]<=e[0]:e[0]<=r[0]&&r[0]<=t[0]:o>0?t[1]<=r[1]&&r[1]<=e[1]:e[1]<=r[1]&&r[1]<=t[1]}s(Zye,"isPointOnLineSegment");function Yye(t,e){return t[0]===e[0]&&t[1]===e[1]}s(Yye,"compareCoords");var FWe=Hye;N();N();N();kr(Qge(),1);N();kr(Qge(),1);N();function Kye(t,e){var r=!1;return mf(t,function(i){mf(e,function(n){if(r===!0)return!0;r=!FWe(i.geometry,n.geometry)})}),r}s(Kye,"booleanIntersects");N();kr(mqe(),1);N();kr(yqe(),1);N();N();function sk(t){for(var e=t,r=[];e.parent;)r.unshift(e),e=e.parent;return r}s(sk,"pathTo");function Jye(){return new uz(function(t){return t.f})}s(Jye,"getHeap");var lz={search:s(function(t,e,r,i){t.cleanDirty(),i=i||{};var n=i.heuristic||lz.heuristics.manhattan,a=i.closest||!1,o=Jye(),l=e;for(e.h=n(e,r),o.push(e);o.size()>0;){var u=o.pop();if(u===r)return sk(u);u.closed=!0;for(var c=t.neighbors(u),p=0,m=c.length;p<m;++p){var y=c[p];if(!(y.closed||y.isWall())){var v=u.g+y.getCost(u),w=y.visited;(!w||v<y.g)&&(y.visited=!0,y.parent=u,y.h=y.h||n(y,r),y.g=v,y.f=y.g+y.h,t.markDirty(y),a&&(y.h<l.h||y.h===l.h&&y.g<l.g)&&(l=y),w?o.rescoreElement(y):o.push(y))}}}return a?sk(l):[]},"search"),heuristics:{manhattan:s(function(t,e){var r=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return r+i},"manhattan"),diagonal:s(function(t,e){var r=1,i=Math.sqrt(2),n=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);return r*(n+a)+(i-2*r)*Math.min(n,a)},"diagonal")},cleanNode:s(function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null},"cleanNode")};function mx(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var r=0;r<t.length;r++){this.grid[r]=[];for(var i=0,n=t[r];i<n.length;i++){var a=new WA(r,i,n[i]);this.grid[r][i]=a,this.nodes.push(a)}}this.init()}s(mx,"Graph");mx.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)lz.cleanNode(this.nodes[t])};mx.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)lz.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]};mx.prototype.markDirty=function(t){this.dirtyNodes.push(t)};mx.prototype.neighbors=function(t){var e=[],r=t.x,i=t.y,n=this.grid;return n[r-1]&&n[r-1][i]&&e.push(n[r-1][i]),n[r+1]&&n[r+1][i]&&e.push(n[r+1][i]),n[r]&&n[r][i-1]&&e.push(n[r][i-1]),n[r]&&n[r][i+1]&&e.push(n[r][i+1]),this.diagonal&&(n[r-1]&&n[r-1][i-1]&&e.push(n[r-1][i-1]),n[r+1]&&n[r+1][i-1]&&e.push(n[r+1][i-1]),n[r-1]&&n[r-1][i+1]&&e.push(n[r-1][i+1]),n[r+1]&&n[r+1][i+1]&&e.push(n[r+1][i+1])),e};mx.prototype.toString=function(){for(var t=[],e=this.grid,r,i,n,a,o=0,l=e.length;o<l;o++){for(r=[],i=e[o],n=0,a=i.length;n<a;n++)r.push(i[n].weight);t.push(r.join(" "))}return t.join(`
`)};function WA(t,e,r){this.x=t,this.y=e,this.weight=r}s(WA,"GridNode");WA.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};WA.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?this.weight*1.41421:this.weight};WA.prototype.isWall=function(){return this.weight===0};function uz(t){this.content=[],this.scoreFunction=t}s(uz,"BinaryHeap");uz.prototype={push:s(function(t){this.content.push(t),this.sinkDown(this.content.length-1)},"push"),pop:s(function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},"pop"),remove:s(function(t){var e=this.content.indexOf(t),r=this.content.pop();e!==this.content.length-1&&(this.content[e]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},"remove"),size:s(function(){return this.content.length},"size"),rescoreElement:s(function(t){this.sinkDown(this.content.indexOf(t))},"rescoreElement"),sinkDown:s(function(t){for(var e=this.content[t];t>0;){var r=(t+1>>1)-1,i=this.content[r];if(this.scoreFunction(e)<this.scoreFunction(i))this.content[r]=e,this.content[t]=i,t=r;else break}},"sinkDown"),bubbleUp:s(function(t){for(var e=this.content.length,r=this.content[t],i=this.scoreFunction(r);;){var n=t+1<<1,a=n-1,o=null,l;if(a<e){var u=this.content[a];l=this.scoreFunction(u),l<i&&(o=a)}if(n<e){var c=this.content[n],p=this.scoreFunction(c);p<(o===null?i:l)&&(o=n)}if(o!==null)this.content[t]=this.content[o],this.content[o]=r,t=o;else break}},"bubbleUp")};N();N();N();N();N();N();N();N();function lT(){this._=null}s(lT,"RedBlackTree");function XA(t){t.U=t.C=t.L=t.R=t.P=t.N=null}s(XA,"RedBlackNode");lT.prototype={constructor:lT,insert:s(function(t,e){var r,i,n;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;r=t}else this._?(t=lk(this._),e.P=null,e.N=t,t.P=t.L=e,r=t):(e.P=e.N=null,this._=e,r=null);for(e.L=e.R=null,e.U=r,e.C=!0,t=e;r&&r.C;)i=r.U,r===i.L?(n=i.R,n&&n.C?(r.C=n.C=!1,i.C=!0,t=i):(t===r.R&&(j0(this,r),t=r,r=t.U),r.C=!1,i.C=!0,$0(this,i))):(n=i.L,n&&n.C?(r.C=n.C=!1,i.C=!0,t=i):(t===r.L&&($0(this,r),t=r,r=t.U),r.C=!1,i.C=!0,j0(this,i))),r=t.U;this._.C=!1},"insert"),remove:s(function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,r,i=t.L,n=t.R,a,o;if(i?n?a=lk(n):a=i:a=n,e?e.L===t?e.L=a:e.R=a:this._=a,i&&n?(o=a.C,a.C=t.C,a.L=i,i.U=a,a!==n?(e=a.U,a.U=t.U,t=a.R,e.L=t,a.R=n,n.U=a):(a.U=e,e=a,t=a.R)):(o=t.C,t=a),t&&(t.U=e),!o){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(r=e.R,r.C&&(r.C=!1,e.C=!0,j0(this,e),r=e.R),r.L&&r.L.C||r.R&&r.R.C){(!r.R||!r.R.C)&&(r.L.C=!1,r.C=!0,$0(this,r),r=e.R),r.C=e.C,e.C=r.R.C=!1,j0(this,e),t=this._;break}}else if(r=e.L,r.C&&(r.C=!1,e.C=!0,$0(this,e),r=e.L),r.L&&r.L.C||r.R&&r.R.C){(!r.L||!r.L.C)&&(r.R.C=!1,r.C=!0,j0(this,r),r=e.L),r.C=e.C,e.C=r.L.C=!1,$0(this,e),t=this._;break}r.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}},"remove")};function j0(t,e){var r=e,i=e.R,n=r.U;n?n.L===r?n.L=i:n.R=i:t._=i,i.U=n,r.U=i,r.R=i.L,r.R&&(r.R.U=r),i.L=r}s(j0,"RedBlackRotateLeft");function $0(t,e){var r=e,i=e.L,n=r.U;n?n.L===r?n.L=i:n.R=i:t._=i,i.U=n,r.U=i,r.L=i.R,r.L&&(r.L.U=r),i.R=r}s($0,"RedBlackRotateRight");function lk(t){for(;t.L;)t=t.L;return t}s(lk,"RedBlackFirst");var LW=lT;N();N();function B1(t,e,r,i){var n=[null,null],a=Tl.push(n)-1;return n.left=t,n.right=e,r&&Bw(n,t,e,r),i&&Bw(n,e,t,i),dc[t.index].halfedges.push(a),dc[e.index].halfedges.push(a),n}s(B1,"createEdge");function G0(t,e,r){var i=[e,r];return i.left=t,i}s(G0,"createBorderEdge");function Bw(t,e,r,i){!t[0]&&!t[1]?(t[0]=i,t.left=e,t.right=r):t.left===r?t[1]=i:t[0]=i}s(Bw,"setEdgeEnd");function Qye(t,e,r,i,n){var a=t[0],o=t[1],l=a[0],u=a[1],c=o[0],p=o[1],m=0,y=1,v=c-l,w=p-u,E;if(E=e-l,!(!v&&E>0)){if(E/=v,v<0){if(E<m)return;E<y&&(y=E)}else if(v>0){if(E>y)return;E>m&&(m=E)}if(E=i-l,!(!v&&E<0)){if(E/=v,v<0){if(E>y)return;E>m&&(m=E)}else if(v>0){if(E<m)return;E<y&&(y=E)}if(E=r-u,!(!w&&E>0)){if(E/=w,w<0){if(E<m)return;E<y&&(y=E)}else if(w>0){if(E>y)return;E>m&&(m=E)}if(E=n-u,!(!w&&E<0)){if(E/=w,w<0){if(E>y)return;E>m&&(m=E)}else if(w>0){if(E<m)return;E<y&&(y=E)}return!(m>0)&&!(y<1)||(m>0&&(t[0]=[l+m*v,u+m*w]),y<1&&(t[1]=[l+y*v,u+y*w])),!0}}}}}s(Qye,"clipEdge");function eve(t,e,r,i,n){var a=t[1];if(a)return!0;var o=t[0],l=t.left,u=t.right,c=l[0],p=l[1],m=u[0],y=u[1],v=(c+m)/2,w=(p+y)/2,E,M;if(y===p){if(v<e||v>=i)return;if(c>m){if(!o)o=[v,r];else if(o[1]>=n)return;a=[v,n]}else{if(!o)o=[v,n];else if(o[1]<r)return;a=[v,r]}}else if(E=(c-m)/(y-p),M=w-E*v,E<-1||E>1)if(c>m){if(!o)o=[(r-M)/E,r];else if(o[1]>=n)return;a=[(n-M)/E,n]}else{if(!o)o=[(n-M)/E,n];else if(o[1]<r)return;a=[(r-M)/E,r]}else if(p<y){if(!o)o=[e,E*e+M];else if(o[0]>=i)return;a=[i,E*i+M]}else{if(!o)o=[i,E*i+M];else if(o[0]<e)return;a=[e,E*e+M]}return t[0]=o,t[1]=a,!0}s(eve,"connectEdge");function tve(t,e,r,i){for(var n=Tl.length,a;n--;)(!eve(a=Tl[n],t,e,r,i)||!Qye(a,t,e,r,i)||!(Math.abs(a[0][0]-a[1][0])>Ya||Math.abs(a[0][1]-a[1][1])>Ya))&&delete Tl[n]}s(tve,"clipEdges");function rve(t){return dc[t.index]={site:t,halfedges:[]}}s(rve,"createCell");function ive(t,e){var r=t.site,i=e.left,n=e.right;return r===n&&(n=i,i=r),n?Math.atan2(n[1]-i[1],n[0]-i[0]):(r===i?(i=e[1],n=e[0]):(i=e[0],n=e[1]),Math.atan2(i[0]-n[0],n[1]-i[1]))}s(ive,"cellHalfedgeAngle");function cz(t,e){return e[+(e.left!==t.site)]}s(cz,"cellHalfedgeStart");function nve(t,e){return e[+(e.left===t.site)]}s(nve,"cellHalfedgeEnd");function ave(){for(var t=0,e=dc.length,r,i,n,a;t<e;++t)if((r=dc[t])&&(a=(i=r.halfedges).length)){var o=new Array(a),l=new Array(a);for(n=0;n<a;++n)o[n]=n,l[n]=ive(r,Tl[i[n]]);for(o.sort(function(u,c){return l[c]-l[u]}),n=0;n<a;++n)l[n]=i[o[n]];for(n=0;n<a;++n)i[n]=l[n]}}s(ave,"sortCellHalfedges");function ove(t,e,r,i){var n=dc.length,a,o,l,u,c,p,m,y,v,w,E,M,I=!0;for(a=0;a<n;++a)if(o=dc[a]){for(l=o.site,c=o.halfedges,u=c.length;u--;)Tl[c[u]]||c.splice(u,1);for(u=0,p=c.length;u<p;)w=nve(o,Tl[c[u]]),E=w[0],M=w[1],m=cz(o,Tl[c[++u%p]]),y=m[0],v=m[1],(Math.abs(E-y)>Ya||Math.abs(M-v)>Ya)&&(c.splice(u,0,Tl.push(G0(l,w,Math.abs(E-t)<Ya&&i-M>Ya?[t,Math.abs(y-t)<Ya?v:i]:Math.abs(M-i)<Ya&&r-E>Ya?[Math.abs(v-i)<Ya?y:r,i]:Math.abs(E-r)<Ya&&M-e>Ya?[r,Math.abs(y-r)<Ya?v:e]:Math.abs(M-e)<Ya&&E-t>Ya?[Math.abs(v-e)<Ya?y:t,e]:null))-1),++p);p&&(I=!1)}if(I){var P,C,T,O=1/0;for(a=0,I=null;a<n;++a)(o=dc[a])&&(l=o.site,P=l[0]-t,C=l[1]-e,T=P*P+C*C,T<O&&(O=T,I=o));if(I){var F=[t,e],k=[t,i],B=[r,i],U=[r,e];I.halfedges.push(Tl.push(G0(l=I.site,F,k))-1,Tl.push(G0(l,k,B))-1,Tl.push(G0(l,B,U))-1,Tl.push(G0(l,U,F))-1)}}for(a=0;a<n;++a)(o=dc[a])&&(o.halfedges.length||delete dc[a])}s(ove,"clipCells");N();var sve=[],hz;function lve(){XA(this),this.x=this.y=this.arc=this.site=this.cy=null}s(lve,"Circle");function Iy(t){var e=t.P,r=t.N;if(!(!e||!r)){var i=e.site,n=t.site,a=r.site;if(i!==a){var o=n[0],l=n[1],u=i[0]-o,c=i[1]-l,p=a[0]-o,m=a[1]-l,y=2*(u*m-c*p);if(!(y>=-1e-12)){var v=u*u+c*c,w=p*p+m*m,E=(m*v-c*w)/y,M=(u*w-p*v)/y,I=sve.pop()||new lve;I.arc=t,I.site=n,I.x=E+o,I.y=(I.cy=M+l)+Math.sqrt(E*E+M*M),t.circle=I;for(var P=null,C=zw._;C;)if(I.y<C.y||I.y===C.y&&I.x<=C.x)if(C.L)C=C.L;else{P=C.P;break}else if(C.R)C=C.R;else{P=C;break}zw.insert(P,I),P||(hz=I)}}}}s(Iy,"attachCircle");function Fy(t){var e=t.circle;e&&(e.P||(hz=e.N),zw.remove(e),sve.push(e),XA(e),t.circle=null)}s(Fy,"detachCircle");var uve=[];function cve(){XA(this),this.edge=this.site=this.circle=null}s(cve,"Beach");function uk(t){var e=uve.pop()||new cve;return e.site=t,e}s(uk,"createBeach");function CC(t){Fy(t),h_.remove(t),uve.push(t),XA(t)}s(CC,"detachBeach");function hve(t){var e=t.circle,r=e.x,i=e.cy,n=[r,i],a=t.P,o=t.N,l=[t];CC(t);for(var u=a;u.circle&&Math.abs(r-u.circle.x)<Ya&&Math.abs(i-u.circle.cy)<Ya;)a=u.P,l.unshift(u),CC(u),u=a;l.unshift(u),Fy(u);for(var c=o;c.circle&&Math.abs(r-c.circle.x)<Ya&&Math.abs(i-c.circle.cy)<Ya;)o=c.N,l.push(c),CC(c),c=o;l.push(c),Fy(c);var p=l.length,m;for(m=1;m<p;++m)c=l[m],u=l[m-1],Bw(c.edge,u.site,c.site,n);u=l[0],c=l[p-1],c.edge=B1(u.site,c.site,null,n),Iy(u),Iy(c)}s(hve,"removeBeach");function pve(t){for(var e=t[0],r=t[1],i,n,a,o,l=h_._;l;)if(a=pz(l,r)-e,a>Ya)l=l.L;else if(o=e-dve(l,r),o>Ya){if(!l.R){i=l;break}l=l.R}else{a>-Ya?(i=l.P,n=l):o>-Ya?(i=l,n=l.N):i=n=l;break}rve(t);var u=uk(t);if(h_.insert(i,u),!(!i&&!n)){if(i===n){Fy(i),n=uk(i.site),h_.insert(u,n),u.edge=n.edge=B1(i.site,u.site),Iy(i),Iy(n);return}if(!n){u.edge=B1(i.site,u.site);return}Fy(i),Fy(n);var c=i.site,p=c[0],m=c[1],y=t[0]-p,v=t[1]-m,w=n.site,E=w[0]-p,M=w[1]-m,I=2*(y*M-v*E),P=y*y+v*v,C=E*E+M*M,T=[(M*P-v*C)/I+p,(y*C-E*P)/I+m];Bw(n.edge,c,w,T),u.edge=B1(c,t,null,T),n.edge=B1(t,w,null,T),Iy(i),Iy(n)}}s(pve,"addBeach");function pz(t,e){var r=t.site,i=r[0],n=r[1],a=n-e;if(!a)return i;var o=t.P;if(!o)return-1/0;r=o.site;var l=r[0],u=r[1],c=u-e;if(!c)return l;var p=l-i,m=1/a-1/c,y=p/c;return m?(-y+Math.sqrt(y*y-2*m*(p*p/(-2*c)-u+c/2+n-a/2)))/m+i:(i+l)/2}s(pz,"leftBreakPoint");function dve(t,e){var r=t.N;if(r)return pz(r,e);var i=t.site;return i[1]===e?i[0]:1/0}s(dve,"rightBreakPoint");var Ya=1e-6,h_,dc,zw,Tl;function fve(t,e,r){return(t[0]-r[0])*(e[1]-t[1])-(t[0]-e[0])*(r[1]-t[1])}s(fve,"triangleArea");function mve(t,e){return e[1]-t[1]||e[0]-t[0]}s(mve,"lexicographic");function ck(t,e){var r=t.sort(mve).pop(),i,n,a;for(Tl=[],dc=new Array(t.length),h_=new LW,zw=new LW;;)if(a=hz,r&&(!a||r[1]<a.y||r[1]===a.y&&r[0]<a.x))(r[0]!==i||r[1]!==n)&&(pve(r),i=r[0],n=r[1]),r=t.pop();else if(a)hve(a.arc);else break;if(ave(),e){var o=+e[0][0],l=+e[0][1],u=+e[1][0],c=+e[1][1];tve(o,l,u,c),ove(o,l,u,c)}this.edges=Tl,this.cells=dc,h_=zw=Tl=dc=null}s(ck,"Diagram");ck.prototype={constructor:ck,polygons:s(function(){var t=this.edges;return this.cells.map(function(e){var r=e.halfedges.map(function(i){return cz(e,t[i])});return r.data=e.site.data,r})},"polygons"),triangles:s(function(){var t=[],e=this.edges;return this.cells.forEach(function(r,i){if(l=(a=r.halfedges).length)for(var n=r.site,a,o=-1,l,u,c=e[a[l-1]],p=c.left===n?c.right:c.left;++o<l;)u=p,c=e[a[o]],p=c.left===n?c.right:c.left,u&&p&&i<u.index&&i<p.index&&fve(n,u,p)<0&&t.push([n.data,u.data,p.data])}),t},"triangles"),links:s(function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},"links"),find:s(function(t,e,r){for(var i=this,n,a=i._found||0,o=i.cells.length,l;!(l=i.cells[a]);)if(++a>=o)return null;var u=t-l.site[0],c=e-l.site[1],p=u*u+c*c;do l=i.cells[n=a],a=null,l.halfedges.forEach(function(m){var y=i.edges[m],v=y.left;if(!((v===l.site||!v)&&!(v=y.right))){var w=t-v[0],E=e-v[1],M=w*w+E*E;M<p&&(p=M,a=v.index)}});while(a!==null);return i._found=n,r==null||p<=r*r?l.site:null},"find")};N();N();N();N();N();N();N();N();N();N();N();N();kr(GA(),1);N();kr(vqe(),1);N();N();N();function Sf(){return new Uw}s(Sf,"default");function Uw(){this.reset()}s(Uw,"Adder");Uw.prototype={constructor:Uw,reset:s(function(){this.s=this.t=0},"reset"),add:s(function(t){hk(vE,t,this.t),hk(this,vE.s,this.s),this.s?this.t+=vE.t:this.s=vE.t},"add"),valueOf:s(function(){return this.s},"valueOf")};var vE=new Uw;function hk(t,e,r){var i=t.s=e+r,n=i-e,a=i-n;t.t=e-a+(r-n)}s(hk,"add");N();var Ql=1e-6,Ho=Math.PI,vc=Ho/2,DW=Ho/4,uT=Ho*2,RW=Ho/180,lf=Math.abs,ZA=Math.atan,gve=Math.atan2,Rl=Math.cos,yve=Math.exp,vve=Math.log,Wo=Math.sin,dz=Math.sqrt,_ve=Math.tan;function xve(t){return t>1?0:t<-1?Ho:Math.acos(t)}s(xve,"acos");function YA(t){return t>1?vc:t<-1?-vc:Math.asin(t)}s(YA,"asin");N();function fz(){}s(fz,"noop");N();Sf();Sf();N();N();function pk(t){var e=t[0],r=t[1],i=Rl(r);return[i*Rl(e),i*Wo(e),Wo(r)]}s(pk,"cartesian");function dk(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}s(dk,"cartesianCross");function fk(t){var e=dz(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}s(fk,"cartesianNormalizeInPlace");Sf();N();N();N();N();N();function mk(t,e){return[t>Ho?t-uT:t<-Ho?t+uT:t,e]}s(mk,"rotationIdentity");mk.invert=mk;N();N();function bve(){var t=[],e;return{point:s(function(r,i){e.push([r,i])},"point"),lineStart:s(function(){t.push(e=[])},"lineStart"),lineEnd:fz,rejoin:s(function(){t.length>1&&t.push(t.pop().concat(t.shift()))},"rejoin"),result:s(function(){var r=t;return t=[],e=null,r},"result")}}s(bve,"default");N();N();N();function wve(t,e){return lf(t[0]-e[0])<Ql&&lf(t[1]-e[1])<Ql}s(wve,"default");function S2(t,e,r,i){this.x=t,this.z=e,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}s(S2,"Intersection");function Ave(t,e,r,i,n){var a=[],o=[],l,u;if(t.forEach(function(w){if(!((E=w.length-1)<=0)){var E,M=w[0],I=w[E],P;if(wve(M,I)){for(n.lineStart(),l=0;l<E;++l)n.point((M=w[l])[0],M[1]);n.lineEnd();return}a.push(P=new S2(M,w,null,!0)),o.push(P.o=new S2(M,null,P,!1)),a.push(P=new S2(I,w,null,!1)),o.push(P.o=new S2(I,null,P,!0))}}),!!a.length){for(o.sort(e),gk(a),gk(o),l=0,u=o.length;l<u;++l)o[l].e=r=!r;for(var c=a[0],p,m;;){for(var y=c,v=!0;y.v;)if((y=y.n)===c)return;p=y.z,n.lineStart();do{if(y.v=y.o.v=!0,y.e){if(v)for(l=0,u=p.length;l<u;++l)n.point((m=p[l])[0],m[1]);else i(y.x,y.n.x,1,n);y=y.n}else{if(v)for(p=y.p.z,l=p.length-1;l>=0;--l)n.point((m=p[l])[0],m[1]);else i(y.x,y.p.x,-1,n);y=y.p}y=y.o,p=y.z,v=!v}while(!y.v);n.lineEnd()}}}s(Ave,"default");function gk(t){if(e=t.length){for(var e,r=0,i=t[0],n;++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}s(gk,"link");N();N();N();function mz(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}s(mz,"default");N();function Sve(t){return t.length===1&&(t=Mve(t)),{left:s(function(e,r,i,n){for(i==null&&(i=0),n==null&&(n=e.length);i<n;){var a=i+n>>>1;t(e[a],r)<0?i=a+1:n=a}return i},"left"),right:s(function(e,r,i,n){for(i==null&&(i=0),n==null&&(n=e.length);i<n;){var a=i+n>>>1;t(e[a],r)>0?n=a:i=a+1}return i},"right")}}s(Sve,"default");function Mve(t){return function(e,r){return mz(t(e),r)}}s(Mve,"ascendingComparator");var Eve=Sve(mz);Eve.right;Eve.left;N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();function Cve(t){for(var e=t.length,r,i=-1,n=0,a,o;++i<e;)n+=t[i].length;for(a=new Array(n);--e>=0;)for(o=t[e],r=o.length;--r>=0;)a[--n]=o[r];return a}s(Cve,"default");N();N();N();N();N();N();N();N();N();var D6=Sf();function Ive(t,e){var r=e[0],i=e[1],n=[Wo(r),-Rl(r),0],a=0,o=0;D6.reset();for(var l=0,u=t.length;l<u;++l)if(p=(c=t[l]).length)for(var c,p,m=c[p-1],y=m[0],v=m[1]/2+DW,w=Wo(v),E=Rl(v),M=0;M<p;++M,y=P,w=T,E=O,m=I){var I=c[M],P=I[0],C=I[1]/2+DW,T=Wo(C),O=Rl(C),F=P-y,k=F>=0?1:-1,B=k*F,U=B>Ho,z=w*T;if(D6.add(gve(z*k*Wo(B),E*O+z*Rl(B))),a+=U?F+k*uT:F,U^y>=r^P>=r){var q=dk(pk(m),pk(I));fk(q);var W=dk(n,q);fk(W);var J=(U^F>=0?-1:1)*YA(W[2]);(i>J||i===J&&(q[0]||q[1]))&&(o+=U^F>=0?1:-1)}}return(a<-Ql||a<Ql&&D6<-Ql)^o&1}s(Ive,"default");N();N();Sf();N();N();N();N();N();Sf();Sf();N();N();N();function Tve(t){this._context=t}s(Tve,"PathContext");Tve.prototype={_radius:4.5,pointRadius:s(function(t){return this._radius=t,this},"pointRadius"),polygonStart:s(function(){this._line=0},"polygonStart"),polygonEnd:s(function(){this._line=NaN},"polygonEnd"),lineStart:s(function(){this._point=0},"lineStart"),lineEnd:s(function(){this._line===0&&this._context.closePath(),this._point=NaN},"lineEnd"),point:s(function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,uT);break}}},"point"),result:fz};N();Sf();N();function Pve(){this._string=[]}s(Pve,"PathString");Pve.prototype={_radius:4.5,_circle:yk(4.5),pointRadius:s(function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},"pointRadius"),polygonStart:s(function(){this._line=0},"polygonStart"),polygonEnd:s(function(){this._line=NaN},"polygonEnd"),lineStart:s(function(){this._point=0},"lineStart"),lineEnd:s(function(){this._line===0&&this._string.push("Z"),this._point=NaN},"lineEnd"),point:s(function(t,e){switch(this._point){case 0:{this._string.push("M",t,",",e),this._point=1;break}case 1:{this._string.push("L",t,",",e);break}default:{this._circle==null&&(this._circle=yk(this._radius)),this._string.push("M",t,",",e,this._circle);break}}},"point"),result:s(function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}else return null},"result")};function yk(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}s(yk,"circle");N();N();N();N();N();N();function BWe(t,e,r,i){return function(n,a){var o=e(a),l=n.invert(i[0],i[1]),u=bve(),c=e(u),p=!1,m,y,v,w={point:E,lineStart:I,lineEnd:P,polygonStart:s(function(){w.point=C,w.lineStart=T,w.lineEnd=O,y=[],m=[]},"polygonStart"),polygonEnd:s(function(){w.point=E,w.lineStart=I,w.lineEnd=P,y=Cve(y);var F=Ive(m,l);y.length?(p||(a.polygonStart(),p=!0),Ave(y,Dve,F,r,a)):F&&(p||(a.polygonStart(),p=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),p&&(a.polygonEnd(),p=!1),y=m=null},"polygonEnd"),sphere:s(function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()},"sphere")};function E(F,k){var B=n(F,k);t(F=B[0],k=B[1])&&a.point(F,k)}s(E,"point");function M(F,k){var B=n(F,k);o.point(B[0],B[1])}s(M,"pointLine");function I(){w.point=M,o.lineStart()}s(I,"lineStart");function P(){w.point=E,o.lineEnd()}s(P,"lineEnd");function C(F,k){v.push([F,k]);var B=n(F,k);c.point(B[0],B[1])}s(C,"pointRing");function T(){c.lineStart(),v=[]}s(T,"ringStart");function O(){C(v[0][0],v[0][1]),c.lineEnd();var F=c.clean(),k=u.result(),B,U=k.length,z,q,W;if(v.pop(),m.push(v),v=null,!!U){if(F&1){if(q=k[0],(z=q.length-1)>0){for(p||(a.polygonStart(),p=!0),a.lineStart(),B=0;B<z;++B)a.point((W=q[B])[0],W[1]);a.lineEnd()}return}U>1&&F&2&&k.push(k.pop().concat(k.shift())),y.push(k.filter(Lve))}}return s(O,"ringEnd"),w}}s(BWe,"default");function Lve(t){return t.length>1}s(Lve,"validSegment");function Dve(t,e){return((t=t.x)[0]<0?t[1]-vc-Ql:vc-t[1])-((e=e.x)[0]<0?e[1]-vc-Ql:vc-e[1])}s(Dve,"compareIntersection");function zWe(t){var e=NaN,r=NaN,i=NaN,n;return{lineStart:s(function(){t.lineStart(),n=1},"lineStart"),point:s(function(a,o){var l=a>0?Ho:-Ho,u=lf(a-e);lf(u-Ho)<Ql?(t.point(e,r=(r+o)/2>0?vc:-vc),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(a,r),n=0):i!==l&&u>=Ho&&(lf(e-i)<Ql&&(e-=i*Ql),lf(a-l)<Ql&&(a-=l*Ql),r=Rve(e,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),n=0),t.point(e=a,r=o),i=l},"point"),lineEnd:s(function(){t.lineEnd(),e=r=NaN},"lineEnd"),clean:s(function(){return 2-n},"clean")}}s(zWe,"clipAntimeridianLine");function Rve(t,e,r,i){var n,a,o=Wo(t-r);return lf(o)>Ql?ZA((Wo(e)*(a=Rl(i))*Wo(r)-Wo(i)*(n=Rl(e))*Wo(t))/(n*a*o)):(e+i)/2}s(Rve,"clipAntimeridianIntersect");function UWe(t,e,r,i){var n;if(t==null)n=r*vc,i.point(-Ho,n),i.point(0,n),i.point(Ho,n),i.point(Ho,0),i.point(Ho,-n),i.point(0,-n),i.point(-Ho,-n),i.point(-Ho,0),i.point(-Ho,n);else if(lf(t[0]-e[0])>Ql){var a=t[0]<e[0]?Ho:-Ho;n=r*a/2,i.point(-a,n),i.point(0,n),i.point(a,n)}else i.point(e[0],e[1])}s(UWe,"clipAntimeridianInterpolate");N();N();function Ove(t){return function(e){var r=new cT;for(var i in t)r[i]=t[i];return r.stream=e,r}}s(Ove,"transformer");function cT(){}s(cT,"TransformStream");cT.prototype={constructor:cT,point:s(function(t,e){this.stream.point(t,e)},"point"),sphere:s(function(){this.stream.sphere()},"sphere"),lineStart:s(function(){this.stream.lineStart()},"lineStart"),lineEnd:s(function(){this.stream.lineEnd()},"lineEnd"),polygonStart:s(function(){this.stream.polygonStart()},"polygonStart"),polygonEnd:s(function(){this.stream.polygonEnd()},"polygonEnd")};N();N();Ove({point:s(function(t,e){this.stream.point(t*RW,e*RW)},"point")});N();N();N();N();function gz(t){return function(e,r){var i=Rl(e),n=Rl(r),a=t(i*n);return[a*n*Wo(e),a*Wo(r)]}}s(gz,"azimuthalRaw");function gx(t){return function(e,r){var i=dz(e*e+r*r),n=t(i),a=Wo(n),o=Rl(n);return[gve(e*a,i*o),YA(i&&r*a/i)]}}s(gx,"azimuthalInvert");var VWe=gz(function(t){return dz(2/(1+t))});VWe.invert=gx(function(t){return 2*YA(t/2)});N();var jWe=gz(function(t){return(t=xve(t))&&t/Wo(t)});jWe.invert=gx(function(t){return t});N();N();function kve(t,e){return[t,vve(_ve((vc+e)/2))]}s(kve,"mercatorRaw");kve.invert=function(t,e){return[t,2*ZA(yve(e))-vc]};N();N();function vk(t,e){return[t,e]}s(vk,"equirectangularRaw");vk.invert=vk;N();function Nve(t,e){var r=Rl(e),i=Rl(t)*r;return[r*Wo(t)/i,Wo(e)/i]}s(Nve,"gnomonicRaw");Nve.invert=gx(ZA);N();N();function Fve(t,e){var r=e*e,i=r*r;return[t*(.8707-.131979*r+i*(-.013791+i*(.003971*r-.001529*i))),e*(1.007226+r*(.015085+i*(-.044475+.028874*r-.005916*i)))]}s(Fve,"naturalEarth1Raw");Fve.invert=function(t,e){var r=e,i=25,n;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-e)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(lf(n)>Ql&&--i>0);return[t/(.8707+(a=r*r)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),r]};N();function Bve(t,e){return[Rl(e)*Wo(t),Wo(e)]}s(Bve,"orthographicRaw");Bve.invert=gx(YA);N();function zve(t,e){var r=Rl(e),i=1+Rl(t)*r;return[r*Wo(t)/i,Wo(e)/i]}s(zve,"stereographicRaw");zve.invert=gx(function(t){return 2*ZA(t)});N();function Uve(t,e){return[vve(_ve((vc+e)/2)),-t]}s(Uve,"transverseMercatorRaw");Uve.invert=function(t,e){return[-e,2*ZA(yve(t))-vc]};N();kr(GA(),1);N();kr(GA(),1);N();kr(GA(),1);N();N();kr(GA(),1);N();N();N();N();var Lh,oa,Xc,IC,_k,xk=class TC extends XP{constructor(e,r){super(r.mvfData.properties.id,e),Be(this,IC),$(this,"__type",TC.__type),Be(this,Lh),Be(this,oa,{}),Be(this,Xc),He(this,Lh,e),He(this,Xc,r.mvfData)}static is(e){return e.__type===TC.__type}get focusTarget(){return this}get name(){var e,r;return"name"in b(this,Xc).properties?(r=dr(this,IC,_k).call(this,"name"))!=null?r:"":(e=b(this,Xc).properties.externalId)!=null?e:""}get shortName(){var e,r;return"shortName"in b(this,Xc).properties?(r=dr(this,IC,_k).call(this,"shortName"))!=null?r:"":(e=b(this,Xc).properties.externalId)!=null?e:""}get externalId(){var e;return(e=b(this,Xc).properties.externalId)!=null?e:""}get elevation(){return b(this,Xc).properties.elevation}get spaces(){if(b(this,oa).spaces==null){let e=b(this,Lh).spaces.filter(r=>r.floor.id===this.id);b(this,oa).spaces=e}return b(this,oa).spaces}get geoJSON(){var e;return{type:"Feature",properties:null,geometry:(e=b(this,Xc).geometry)!=null?e:{type:"Polygon",coordinates:[]}}}get objects(){if(b(this,oa).objects==null){let e=b(this,Lh).objects.filter(r=>r.floor.id===this.id);b(this,oa).objects=e}return b(this,oa).objects}get connections(){if(b(this,oa).connections==null){let e=b(this,Lh).connections.filter(r=>r.floors.includes(this));b(this,oa).connections=e}return b(this,oa).connections}get doors(){if(b(this,oa).doors==null){let e=b(this,Lh).doors.filter(r=>r.floor.id===this.id);b(this,oa).doors=e}return b(this,oa).doors}get annotations(){if(b(this,oa).annotations==null){let e=b(this,Lh).annotations.filter(r=>r.floor.id===this.id);b(this,oa).annotations=e}return b(this,oa).annotations}get pois(){if(b(this,oa).pois==null){let e=b(this,Lh).pointsOfInterest.filter(r=>r.floor.id===this.id);b(this,oa).pois=e}return b(this,oa).pois}get floorStack(){if(b(this,oa).floorStack==null){let e=b(this,Lh).floorStacks.find(r=>r.floors.includes(this));b(this,oa).floorStack=e}return b(this,oa).floorStack}get center(){if(b(this,oa).center==null){let e=b(this,Xc).geometry;if(e==null)b(this,oa).center=new On({latitude:0,longitude:0,floorId:this.id});else{let r=az(e);b(this,oa).center=new On({latitude:r.geometry.coordinates[1],longitude:r.geometry.coordinates[0],floorId:this.id})}}return b(this,oa).center}toJSON(){return{__type:TC.__type,id:this.id,name:this.name,shortName:this.shortName,elevation:this.elevation,spaces:this.spaces.map(e=>e.id),objects:this.objects.map(e=>e.id),connections:this.connections.map(e=>e.id),doors:this.doors.map(e=>e.id),annotations:this.annotations.map(e=>e.id),pois:this.pois.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(b(this,oa)))delete b(this,oa)[e]}};Lh=new WeakMap,oa=new WeakMap,Xc=new WeakMap,IC=new WeakSet,_k=s(function(t){let e=b(this,Xc).properties[t];return b(this,Lh).getPropTranslation(this.__type,t,this.id,e)},"#translate"),s(xk,"Floor"),$(xk,"__type","floor");var $We=xk,jp=$We;N();N();N();var Vve=s(t=>t!=null,"notNull");N();function hT(t){let e;if(Zp.is(t)||HA.is(t)||Ky.is(t)||ZP.is(t)||tx.is(t))e=t.center;else if(e5.is(t)||t5.is(t))e=t.coordinate;else if(On.is(t))e=t;else if(WP.is(t))e=t.coordinate;else if(Vw.is(t))e=t.coordinates[0];else return;return e}s(hT,"getCoordinateFromStuffs");N();N();var M2={auto:!0,debug:!1,pitch:45,bearing:0,antialiasing:{enabled:!0},shadingAndOutlines:!0,outdoorView:{layersHiddenByGeometry:["building","building-top"]},imagePlacementOptions:{mode:"default"},flipImagesToFaceCamera:!0,multiFloorView:{enabled:!1,floorHeight:10}},F_="ExteriorWalls",JP="Walls",GWe=0,yz="InteriorDoors",vz="ExteriorDoors",il="GeometryLayer",B_="LabelsLayer",By="MarkersLayer",bk="FootprintLayer",pT="OcclusionLayer",HWe="ImagesLayer",pw="FacadesLayer",qWe=["https://mappedin.auth0.com","https://mappedin-staging.auth0.com"],WWe={orange:"#F26336",teal:"#057685",lightTeal:"#5DC7D0"};function jve(t){var e,r;(e=t.outdoorView)!=null&&e.enabled&&!((r=t.outdoorView)!=null&&r.token)&&Vt.error("Enable outdoor view requires a token. Provide token in `options.outdoorView.token`")}s(jve,"validateOptions");function $ve(t,e){var r,i,n,a,o,l;let u=((r=t==null?void 0:t.outdoorView)==null?void 0:r.token)||e.outdoorViewToken,c=vt(Ee(Ee({},M2),t),{outdoorView:Ee({enabled:((i=t==null?void 0:t.outdoorView)==null?void 0:i.enabled)===void 0?!!u:(n=t==null?void 0:t.outdoorView)==null?void 0:n.enabled,layersHiddenByGeometry:(a=M2.outdoorView)==null?void 0:a.layersHiddenByGeometry},t==null?void 0:t.outdoorView),bearing:(l=(o=t==null?void 0:t.bearing)!=null?o:e.naturalBearing)!=null?l:0,imagePlacementOptions:Ee(Ee({},M2.imagePlacementOptions),t==null?void 0:t.imagePlacementOptions),multiFloorView:Ee(Ee({},M2.multiFloorView),t==null?void 0:t.multiFloorView)});return u&&c.outdoorView&&(c.outdoorView.token=u),c}s($ve,"handleShow3DMapOptionDefault");function Gve(t){let e={remove_watermark:!1};if(t)try{let r=OB(t);Object.assign(e,r.capabilities)}catch(r){Vt.error("Error decoding capabilities from token",r)}return e}s(Gve,"handleTokenCapabilities");var Zg,Ah,ym,wk=class PC extends mv{constructor(e,r){let i=Object.values(r.mvfDataByFloorId)[0];super(e,i),$(this,"__type",PC.__type),Be(this,Zg),Be(this,Ah),Be(this,ym),He(this,Ah,{}),He(this,Zg,e),He(this,ym,r.mvfDataByFloorId)}static is(e){return e.__type===PC.__type}get accessible(){var e;return(e=Object.values(b(this,ym))[0].properties.accessible)!=null?e:!1}get type(){var e,r;return(r=(e=Object.values(b(this,ym))[0].properties.kind)==null?void 0:e.split(".")[1])!=null?r:"unknown"}get extra(){return Object.values(b(this,ym))[0].properties.extra}get coordinates(){return b(this,Ah).coordinates==null&&(b(this,Ah).coordinates=Object.entries(b(this,ym)).map(([e,r])=>new On(r.geometry.coordinates[1],r.geometry.coordinates[0],e))),b(this,Ah).coordinates}get nodes(){return Object.values(b(this,ym))[0].properties.nodes.map(e=>b(this,Zg).getById("node",e))}get floors(){return this.coordinates.map(e=>e.floorId?b(this,Zg).getById("floor",e.floorId):void 0).filter(Vve)}get locationProfiles(){var e,r,i,n,a;if(b(this,Ah).locationProfiles!=null)return b(this,Ah).locationProfiles;let o=super.locationProfiles;if(o==null||o.length===0){let l=[(r=(e=this.coordinates[0])==null?void 0:e.longitude)!=null?r:0,(n=(i=this.coordinates[0])==null?void 0:i.latitude)!=null?n:0],u=fx(l),c=(a=b(this,Zg).mvfConnectionIdsByLatLon[u])!=null?a:[];for(let p of c){let m=b(this,Zg).locationProfilesByAttachedFeatureId[p];if(m!=null){o=m;break}}}return b(this,Ah).locationProfiles=o??[],o}get focusTarget(){return this.coordinates}toJSON(){return{__type:PC.__type,id:this.id,name:this.name,type:this.type,externalId:this.externalId,coordinates:this.coordinates.map(e=>e.toJSON()),floors:this.floors.map(e=>e.id),extra:this.extra}}destroy(){for(let e of Object.keys(b(this,Ah)))delete b(this,Ah)[e]}};Zg=new WeakMap,Ah=new WeakMap,ym=new WeakMap,s(wk,"Connection"),$(wk,"__type","connection");var XWe=wk,QP=XWe;N();var LC,H0,Yg,q0,Ak=class DC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",DC.__type),Be(this,LC),Be(this,H0),Be(this,Yg,{}),Be(this,q0),He(this,LC,e),He(this,H0,r.floorId),He(this,q0,r.mvfData)}static is(e){return e.__type===DC.__type}get type(){let e=b(this,q0).properties.kind;return e==null&&(e="object"),e==="Desks"&&(e="desk"),e.toLowerCase()}get floor(){let e=b(this,LC).getById("floor",b(this,H0));if(e==null)throw new Error("Floor ".concat(b(this,H0)," not found!"));return e}get center(){var e;if(b(this,Yg).center==null){let[r,i]=(e=b(this,q0).properties.center)!=null?e:[0,0];b(this,Yg).center=new On(i,r,b(this,H0))}return b(this,Yg).center}get geoJSON(){return vt(Ee({},b(this,q0)),{properties:null})}get anchorTarget(){return this.center}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}toJSON(){return{__type:DC.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of globalThis.Object.keys(b(this,Yg)))b(this,Yg)[e]=null}};LC=new WeakMap,H0=new WeakMap,Yg=new WeakMap,q0=new WeakMap,s(Ak,"MapObject"),$(Ak,"__type","object");var ZWe=Ak,Ky=ZWe;N();var RC,W0,Kg,E2,Sk=class OC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",OC.__type),Be(this,RC),Be(this,W0),Be(this,Kg,{}),Be(this,E2),He(this,RC,e),He(this,E2,r.mvfData),He(this,W0,r.floorId)}static is(e){return e.__type===OC.__type}get floor(){let e=b(this,RC).getById("floor",b(this,W0));if(e==null)throw new Error("Floor ".concat(b(this,W0)," not found!"));return e}get coordinate(){var e;if(b(this,Kg).coordinate==null){let[r,i]=(e=b(this,E2).geometry.coordinates)!=null?e:[0,0];b(this,Kg).coordinate=new On(i,r,b(this,W0))}return b(this,Kg).coordinate}get geoJSON(){return vt(Ee({},b(this,E2)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:OC.__type,id:this.id,name:this.name,floor:this.floor.id,coordinate:this.coordinate.toJSON()}}destroy(){for(let e in b(this,Kg))b(this,Kg)[e]=null}};RC=new WeakMap,W0=new WeakMap,Kg=new WeakMap,E2=new WeakMap,s(Sk,"PointOfInterest"),$(Sk,"__type","point-of-interest");var YWe=Sk,e5=YWe;N();var kC,X0,Jg,z1,NC,Mk,Ek=class FC extends mv{constructor(e,r){super(e,r.mvfData),Be(this,NC),$(this,"__type",FC.__type),Be(this,kC),Be(this,X0),Be(this,Jg,{}),Be(this,z1),He(this,kC,e),He(this,X0,r.floorId),He(this,z1,r.mvfData)}static is(e){return e.__type===FC.__type}get group(){return dr(this,NC,Mk).call(this).group}get type(){return dr(this,NC,Mk).call(this).type}get coordinate(){if(b(this,Jg).coordinate==null){let[e,r]=b(this,z1).geometry.coordinates;b(this,Jg).coordinate=new On(r,e,b(this,X0))}return b(this,Jg).coordinate}get floor(){let e=b(this,kC).getById("floor",b(this,X0));if(e==null)throw new Error("Floor ".concat(b(this,X0)," not found!"));return e}get geoJSON(){return vt(Ee({},b(this,z1)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:FC.__type,id:this.id,group:this.group,type:this.type,coordinate:this.coordinate.toJSON()}}destroy(){for(let e of Object.keys(b(this,Jg)))delete b(this,Jg)[e]}};kC=new WeakMap,X0=new WeakMap,Jg=new WeakMap,z1=new WeakMap,NC=new WeakSet,Mk=s(function(){let[t,e]=b(this,z1).properties.symbolId.split("--");return{group:t,type:e}},"#getGroupAndTypeFromSymbolId"),s(Ek,"Annotation"),$(Ek,"__type","annotation");var KWe=Ek,t5=KWe;N();var JWe=s((t,e)=>{var r,i,n,a,o,l,u,c,p,m,y;let v={},w={},E={},M={},I={},P={};for(let C of t["location.json"]||[]){let T=new Ij(e,{mvfData:C});if(v[C.id]=T,C.externalId&&(M[C.externalId]==null&&(M[C.externalId]=[]),M[C.externalId].push(T)),C.categories)for(let F of C.categories)I[F]==null&&(I[F]=[]),I[F].push(T);let O=[...(i=(r=C.obstructions)==null?void 0:r.map(F=>F.id))!=null?i:[],...(a=(n=C.spaces)==null?void 0:n.map(F=>F.id))!=null?a:[],...(l=(o=C.annotations)==null?void 0:o.map(F=>F.id))!=null?l:[],...(u=C.connections)!=null?u:[],...(p=(c=C.entrances)==null?void 0:c.map(F=>F.id))!=null?p:[],...(y=(m=C.areas)==null?void 0:m.map(F=>F.id))!=null?y:[]];for(let F of O)F&&(P[F]==null&&(P[F]=[]),P[F].push(T))}for(let C of t["category.json"]||[]){let T=new _De(e,{mvfData:C});w[C.id]=T,C.parent&&(E[C.parent]==null&&(E[C.parent]=[]),E[C.parent].push(T))}return{locationCategoriesByParentId:E,locationProfilesById:v,locationCategoriesById:w,locationProfilesByExternalId:M,locationProfilesByCategoryId:I,locationProfilesByAttachedFeatureId:P}},"processMVFLocationProfilesAndCategories"),QWe=s((t,e,r)=>{var i,n;let a={},o={},l={},u={},c={},p={},m={},y={},v={},w={},E={},M={},I=globalThis.Object.keys(t.space);for(let P of I){let C=t.space[P];if(C!=null)for(let T of C.features){M[T.properties.id]=P,m[T.properties.id]=T;for(let O of T.properties.destinationNodes)c[O]==null&&(c[O]=[]),c[O].push(T.properties.id);if(T.properties.kind==="desk-entrance"&&(p[T.properties.externalId]==null&&(p[T.properties.externalId]=[]),p[T.properties.externalId].push(...T.properties.destinationNodes)),!["void","desk-entrance"].includes((i=T.properties.kind)!=null?i:"")){if((n=T.properties.kind)!=null&&n.includes("connection")){let O=fx(T.geometry.coordinates);w[O]==null&&(w[O]=[]),w[O].push(T.properties.id);continue}if(T.properties.kind==="poi"){let O=new e5(r,{floorId:P,mvfData:T});l[T.properties.id]=O,v[P]||(v[P]=[]),v[P].push(T),T.properties.externalId&&(u[T.properties.externalId]==null&&(u[T.properties.externalId]=[]),u[T.properties.externalId].push(O))}else{let O=new Zp(r,{floorId:P,mvfData:T});a[T.properties.id]=O,T.properties.externalId&&(o[T.properties.externalId]==null&&(o[T.properties.externalId]=[]),o[T.properties.externalId].push(O)),y[P]||(y[P]=[]),y[P].push(T)}}}}for(let P in w){let C=w[P],T={};for(let F of C){let k=M[F],B=m[F],U=e==null?void 0:e["n_"+B.properties.id.split("s_")[1]];T[k]=vt(Ee({},B),{properties:vt(Ee({},B.properties),{accessible:(U==null?void 0:U.accessible)===!0})})}let O=new QP(r,{mvfDataByFloorId:T});E[O.id]=O}return{spacesById:a,spacesByExternalId:o,poisById:l,poisByExternalId:u,connectionsById:E,spaceIdsByDestinationNodeId:c,objectEntranceNodeIdsByObstructionId:p,mvfSpacesById:m,connectionIdsByLatLon:w,mvfSpacesByFloorId:y,mvfPoisByFloorId:v}},"processMVFSpaces"),eXe=s((t,e)=>{var r,i;let n={},a={},o={},l={};for(let u of t["node.geojson"].features){o[u.properties.id]=u;let c=new WP(e,{mvfData:u,floorId:(r=u.properties.floor)!=null?r:u.properties.map});n[u.properties.id]=c,u.properties.externalId&&(a[u.properties.externalId]==null&&(a[u.properties.externalId]=[]),a[u.properties.externalId].push(c));let p=(i=u.properties.floor)!=null?i:u.properties.map;l[p]||(l[p]=[]),l[p].push(u)}return{nodesById:n,nodesByExternalId:a,mvfNodesById:o,mvfNodesByFloorId:l}},"processMVFNodes"),tXe=s((t,e)=>{let r={},i={},n={},a={},o=globalThis.Object.keys(t.obstruction);for(let l of o){let u=t.obstruction[l];if(u!=null)for(let c of u.features){n[c.properties.id]=c;for(let m of c.properties.entrances)a[m]=c.properties.id;if(c.properties.kind==="Wall")continue;let p=new Ky(e,{floorId:l,mvfData:c});r[c.properties.id]=p,c.properties.externalId&&(i[c.properties.externalId]==null&&(i[c.properties.externalId]=[]),i[c.properties.externalId].push(p))}}return{objectsById:r,objectsByExternalId:i,mvfObstructionById:n,obstructionIdByEntranceId:a}},"processMVFObstructions"),rXe=s((t,e)=>{let r={},i={},n={};if("floor.geojson"in t&&t["floor.geojson"]!=null)for(let a of t["floor.geojson"].features){n[a.properties.id]=a.properties;let o=new jp(e,{mvfData:a});r[a.properties.id]=o,a.properties.externalId&&(i[a.properties.externalId]==null&&(i[a.properties.externalId]=[]),i[a.properties.externalId].push(o))}else for(let a of t["map.geojson"]){n[a.id]=a;let o=new jp(e,{mvfData:{properties:a}});r[a.id]=o}return{floorsById:r,floorsByExternalId:i,mvfFloorsById:n}},"processMVFFloors"),iXe=s((t,e)=>{var r;let i={},n={},a={},o={},l={},u=t["floorstack.json"]||t["mapstack.json"]||t["mapstack.geojson"];if(u!=null)for(let c of u){let p=(r=t.facade)==null?void 0:r[c.id],m=new fye(e,{mvfData:c,facadeId:p==null?void 0:p.id});if(i[c.id]=m,c.externalId&&(n[c.externalId]==null&&(n[c.externalId]=[]),n[c.externalId].push(m)),a[c.id]=c,p){let y=new tx(e,{mvfData:p,floorStackId:c.id});o[p.id]=y;for(let v of p.spaces)l[v.spaceId]=y}}return{floorStacksById:i,floorStacksByExternalId:n,mvfFloorStacksById:a,facadesById:o,facadesBySpaceId:l}},"processMVFFloorStacks"),nXe=s((t,e)=>{let r={},i={},n=t["connection.json"].reduce((a,o)=>{o.nodes.forEach(u=>a[u]=o),r[o.id]=o;let l=e==null?void 0:e[o.nodes[0]];if(l!=null){let u=fx(l.geometry.coordinates);i[u]==null&&(i[u]=[]),i[u].push(o.id)}return a},{});return{mvfConnectionsById:r,mvfConnectionsByNodeId:n,mvfConnectionIdsByLatLon:i}},"processMVFConnections"),aXe=s((t,e)=>{let r={},i={},n={},a={},o={},l=globalThis.Object.keys(t.entrance);for(let u of l){let c=t.entrance[u];if(c!=null)for(let p of c.features){a[p.properties.id]=p;let m=new HA(e,{floorId:u,mvfData:p});p.properties.node&&(n[p.properties.node]=m),r[p.properties.id]=m,p.properties.externalId&&(i[p.properties.externalId]==null&&(i[p.properties.externalId]=[]),i[p.properties.externalId].push(m)),o[u]||(o[u]=[]),o[u].push(p)}}return{doorsById:r,doorsByExternalId:i,doorsByNodeId:n,mvfEntrancesById:a,mvfEntrancesByFloorId:o}},"processMVFEntrances"),oXe=s((t,e,r)=>{var i;if(t.textAreas!=null)for(let n in t.textAreas){let a=(i=t.textAreas[n])==null?void 0:i.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let l=o==null?void 0:o.properties,u=e[l.anchorId]||r[l.anchorId];if(u!=null&&l!=null){let c=u.properties;c.textArea=l,c.textArea&&(c.textArea.position=o.geometry.coordinates)}}}}},"processMVFTextAreas"),sXe=s((t,e,r)=>{var i;if(t.floorImages!=null)for(let n in t.floorImages){let a=(i=t.floorImages[n])==null?void 0:i.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let l=o==null?void 0:o.properties,u=e[l.anchorId]||r[l.anchorId];if(u!=null&&l!=null){let c=u.properties;c.image=l,c.image&&(c.image.position=o.geometry.coordinates)}}}}},"processMVFPolygonImages"),lXe=s((t,e)=>{var r,i;if(((r=t.enterprise)==null?void 0:r.enterpriseStyles)==null)return;let n=(i=t.enterprise)==null?void 0:i.enterpriseStyles;for(let a in n){let o=n[a];o.geometryAnchors.forEach(l=>{let u=e[l.geometryId];if(u!=null){let c=u.properties;c.style={styleId:a,edgeOffset:o.edgeOffset}}})}},"processMVFEnterprisePolygonStyles"),uXe=s((t,e,r)=>{if(!(t.enterprise==null||t.enterprise.textures==null))for(let i of t.enterprise.textures)for(let n of i.geometryAnchors){let a=e[n.geometryId]||r[n.geometryId];if(a!=null){let o=a.properties;o.textures==null&&(o.textures=[]),o.textures.push(i)}}},"processMVFEnterpriseTextures"),cXe=s((t,e)=>{let r={},i={},n={};if(t.annotation==null)return{annotationsById:r,mvfAnnotationsById:i,mvfAnnotationsByFloorId:n};let a=globalThis.Object.keys(t.annotation);for(let o of a){let l=t.annotation[o];if(l!=null)for(let u of l.features){i[u.properties.id]=u;let c=new t5(e,{floorId:o,mvfData:u});r[u.properties.id]=c,n[o]||(n[o]=[]),n[o].push(u)}}return{annotationsById:r,mvfAnnotationsById:i,mvfAnnotationsByFloorId:n}},"processMVFAnnotations"),hXe=s((t,e)=>{let r={},i={},n={};if(t.area==null)return{areasById:r,areasByExternalId:i,mvfAreasById:n};let a=globalThis.Object.keys(t.area);for(let o of a){let l=t.area[o];if(l!=null)for(let u of l.features){n[u.properties.id]=u;let c=new ZP(e,{floorId:o,mvfData:u});r[u.properties.id]=c,u.properties.externalId&&(i[u.properties.externalId]==null&&(i[u.properties.externalId]=[]),i[u.properties.externalId].push(c))}}return{areasById:r,areasByExternalId:i,mvfAreasById:n}},"processMVFAreas"),pXe=s((t,e)=>{var r,i,n,a,o,l,u,c,p,m,y,v,w;let E={},M={},I={},P={},C=((i=(r=t.enterprise)==null?void 0:r.locations)!=null?i:[]).reduce((V,oe)=>(V[oe.id]=oe,V),{}),T={},O={},F={},k={},B={},U={},z=((n=t.enterprise)==null?void 0:n.venue)||{},q={},W={};for(let V of(o=(a=t.enterprise)==null?void 0:a.categories)!=null?o:[]){let oe=new i0e(e,{mvfData:V});T[V.id]=oe,V.externalId&&(O[V.externalId]==null&&(O[V.externalId]=[]),O[V.externalId].push(oe)),F[V.id]=V,V.locations.forEach(Y=>{B[Y]==null&&(B[Y]=[]),B[Y].push(V.id)})}let J={};for(let V of(u=(l=t.enterprise)==null?void 0:l.locationInstances)!=null?u:[]){let oe=C[V.parent],Y=Object.keys(oe),he={};for(let ae of Y)he[ae]=void 0;let Q=Ee(vt(Ee({},he),{polygons:[],nodes:[]}),V);J[Q.parent]==null&&(J[Q.parent]=[]),J[Q.parent].push(new Vw(e,{mvfData:Q,categoryIds:((p=(c=t.enterprise)==null?void 0:c.categoryPriorities)==null?void 0:p[Q.id])||B[Q.id],parentId:V.parent})),q[Q.id]=V}for(let V in t.space){let oe=t.space[V];if(oe!=null)for(let Y of oe.features)for(let he of Y.properties.destinationNodes)W[he]==null&&(W[he]=[]),W[he].push(Y.properties.id)}for(let V of(y=(m=t.enterprise)==null?void 0:m.locations)!=null?y:[]){let oe=new Vw(e,{mvfData:V,categoryIds:((w=(v=t.enterprise)==null?void 0:v.categoryPriorities)==null?void 0:w[V.id])||B[V.id],locationInstances:J[V.id]});I[V.id]=oe,V.externalId&&(P[V.externalId]==null&&(P[V.externalId]=[]),P[V.externalId].push(oe)),V.nodes.forEach(Y=>{U[Y.id]==null&&(U[Y.id]=[]),U[Y.id].push(V.id)});for(let Y of V.polygons)k[Y.id]==null&&(k[Y.id]=[]),k[Y.id].push(V)}if(e.enterpriseMode===!0){for(let V in e.mvfConnectionsById){let oe={},Y=e.mvfConnectionsById[V];for(let he of e.mvfConnectionsById[V].nodes){let Q=e.nodesById[he];Q!=null&&(oe[Q.floor.id]={type:"Feature",geometry:{type:"Point",coordinates:[Q.coordinate.longitude,Q.coordinate.latitude]},properties:{id:V,externalId:Y.externalId,kind:"enterprise."+Y.type,destinationNodes:[],flags:"",type:Y.type,nodes:Y.nodes,accessible:Y.accessible,extra:Y.extra,details:Y.details}})}Object.keys(oe).length>0&&(E[V]=new QP(e,{mvfDataByFloorId:oe}),Y.externalId&&(M[Y.externalId]==null&&(M[Y.externalId]=[]),M[Y.externalId].push(E[V])))}e.connectionsById=E}return{spaceIdsByNodeId:W,connectionsByExternalId:M,locationIdsByNodeId:U,mvfLocationsBySpaceId:k,mvfLocationsById:C,mvfCategoriesById:F,locationsById:I,locationsByExternalId:P,locationInstancesById:q,categoriesById:T,categoriesByExternalId:O,venue:z}},"createEnterpriseDataFromMVF"),dXe=s((t,e)=>{let{nodesById:r,nodesByExternalId:i,mvfNodesById:n,mvfNodesByFloorId:a}=eXe(t,e),{mvfConnectionsById:o,mvfConnectionsByNodeId:l,mvfConnectionIdsByLatLon:u}=nXe(t,n),{spacesById:c,spacesByExternalId:p,spaceIdsByDestinationNodeId:m,poisById:y,poisByExternalId:v,mvfSpacesById:w,objectEntranceNodeIdsByObstructionId:E,connectionsById:M,connectionIdsByLatLon:I,mvfSpacesByFloorId:P,mvfPoisByFloorId:C}=QWe(t,l,e),{objectsById:T,objectsByExternalId:O,mvfObstructionById:F,obstructionIdByEntranceId:k}=tXe(t,e),{floorsById:B,floorsByExternalId:U,mvfFloorsById:z}=rXe(t,e),{floorStacksById:q,floorStacksByExternalId:W,mvfFloorStacksById:J,facadesById:V,facadesBySpaceId:oe}=iXe(t,e),{doorsById:Y,doorsByExternalId:he,doorsByNodeId:Q,mvfEntrancesById:ae,mvfEntrancesByFloorId:ee}=aXe(t,e),{annotationsById:le,mvfAnnotationsById:K,mvfAnnotationsByFloorId:ce}=cXe(t,e),{areasById:te,areasByExternalId:ne,mvfAreasById:pe}=hXe(t,e);sXe(t,w,F),oXe(t,w,F),lXe(t,w),uXe(t,w,F);let{locationCategoriesByParentId:xe,locationProfilesById:Te,locationCategoriesById:fe,locationProfilesByExternalId:Pe,locationProfilesByCategoryId:me,locationProfilesByAttachedFeatureId:Ae}=JWe(t,e);return{spacesById:c,spacesByExternalId:p,nodesById:r,nodesByExternalId:i,objectsById:T,objectsByExternalId:O,floorsById:B,floorsByExternalId:U,floorStacksById:q,floorStacksByExternalId:W,facadesById:V,facadesBySpaceId:oe,connectionsById:M,doorsById:Y,doorsByExternalId:he,doorsByNodeId:Q,poisById:y,poisByExternalId:v,annotationsById:le,areasById:te,areasByExternalId:ne,spaceIdsByDestinationNodeId:m,objectEntranceNodeIdsByObstructionId:E,obstructionIdByEntranceId:k,connectionIdsByLatLon:I,locationProfilesById:Te,locationCategoriesById:fe,locationProfilesByExternalId:Pe,locationProfilesByCategoryId:me,locationCategoriesByParentId:xe,mvfSpacesById:w,mvfNodesById:n,mvfObstructionById:F,mvfFloorsById:z,mvfFloorStacksById:J,mvfConnectionsById:o,mvfConnectionsByNodeId:l,mvfEntrancesById:ae,mvfAnnotationsById:K,mvfNodesByFloorId:a,mvfSpacesByFloorId:P,mvfPoisByFloorId:C,mvfAreasById:pe,mvfEntrancesByFloorId:ee,mvfAnnotationsByFloorId:ce,locationProfilesByAttachedFeatureId:Ae,mvfConnectionIdsByLatLon:u}},"createDataFromMVF");N();N();N();var fXe=s(function(){let t=globalThis.fetch;return{fetch(...e){if(!Vve(t))throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return t==null?void 0:t(...e)},setFetch(e){t=e}}},"createFetchControl")(),mXe=fXe.fetch,Hve=["websdk","web","webv2","kiosk-v2","mobile","iossdk","androidsdk","reactnativesdk","gen7","bespoke"],qve=Hve[0],Wve="https://api-gateway.mappedin.com/track-analytics/a/",Xve="deny-watchposition",Zve="load-mapview",Yve="load-mapdata",Kve="change-language",Jve="query-directions",Nd,Sh,Qg,Ck,BC,Qve=class{constructor(){Be(this,Qg),Be(this,Nd,Object.freeze({})),Be(this,Sh),$(this,"oneTimeEventsSent",new Set),$(this,"sendGetDirectionsEvent",Pme((e,r)=>this.sendAnalyticEvent(Jve,{start:e,end:r,type:"location_to_location"}),2500)),He(this,Sh,dr(this,Qg,BC).call(this,b(this,Nd)))}init(e){this.reset(),this.updateStateWithOptions(e)}reset(){He(this,Nd,{}),He(this,Sh,dr(this,Qg,BC).call(this,{})),this.oneTimeEventsSent.clear()}updateStateWithOptions(e){return He(this,Nd,Object.freeze(Object.assign({},b(this,Nd),e))),He(this,Sh,dr(this,Qg,BC).call(this,e)),dr(this,Qg,Ck).call(this,b(this,Sh)),b(this,Sh)}updateState(e){let r=Ee({},e);r.mapId&&(r.analyticsBaseUrl=dT(vt(Ee({},b(this,Sh)),{mapId:r.mapId}))),r.context&&(r.context=bz(r.context)),r.baseUri&&(r.analyticsBaseUrl=dT({baseUri:r.baseUri,mapId:b(this,Sh).mapId})),Object.assign(b(this,Sh),r),this.handleStateUpdate(e),dr(this,Qg,Ck).call(this,r)}handleStateUpdate(e){var r;(r=e.userPosition)!=null&&r.floorLevel?this.sendBlueDotEvents("found-floor"):e.userPosition&&this.sendBlueDotEvents("found-position")}get authReady(){let{key:e,secret:r,accessToken:i}=this.getState();return!!(e&&r)||!!i}getState(){return b(this,Sh)}getContext(){return this.getState().context||b(this,Nd).context||qve}getSessionId(){return this.getState().sessionId||b(this,Nd).sessionId||xz()}getDeviceId(){return this.getState().deviceId||b(this,Nd).deviceId||_z()}sendAnalyticEvent(e,r={}){let i=this.getState(),n=t0e(i.analyticsBaseUrl,e),a={"mi-context":this.getContext(),"mi-session":this.getSessionId(),"mi-device":this.getDeviceId()};if(i.logEvents&&Vt.log("Analytics.track",n,a),!i.sendEvents)return Promise.resolve();if(!this.authReady)return Vt.warn("Auth needs to be ready to send analytics.");let o=vt(Ee({},r),{g:i.geolocationMode,sdk_version:i.version});return i.userPosition&&Object.assign(o,i.userPosition),a["Content-Type"]="application/json",i.accessToken?a.Authorization="Bearer ".concat(i.accessToken):i.noAuth||i.secret&&i.key&&(a["x-mappedin-key"]=btoa(i.key),a["x-mappedin-secret"]=btoa(i.secret)),mXe(n,{method:"POST",mode:"cors",headers:a,body:JSON.stringify(o)})}capture(e,r){if(yXe.includes(e))return Vt.warn("".concat(e," event is sent internally.")),Promise.resolve();let i=gXe.includes(e)?e.slice(1):e;return this.sendAnalyticEvent(i,r)}sendGetMapDataEvent(e){return this.sendAnalyticEvent(Yve,e)}sendChangeLanguageEvent(e){return this.sendAnalyticEvent(Kve,e)}sendWatchPositionDenied(){return this.sendAnalyticEvent(Xve)}sendMapViewLoadedEvent({firstRenderDuration:e,dimension:r}){return this.sendAnalyticEvent(Zve,{type:"3d",firstRenderDuration:e,width:r.width,height:r.height,devicePixelRatio:globalThis.devicePixelRatio||1})}sendBlueDotEvents(e){if(!((e==="found-floor"||e==="found-position")&&this.oneTimeEventsSent.has(e)))return this.oneTimeEventsSent.add(e),this.sendAnalyticEvent(e)}};Nd=new WeakMap,Sh=new WeakMap,Qg=new WeakSet,Ck=s(function(t){t.sessionId&&k_.getInstance().saveSessionData("id",t.sessionId),t.deviceId&&k_.getInstance().saveLocalData("deviceId",t.deviceId)},"#saveStateToStorage"),BC=s(function(t){var e,r,i,n;let a=(e=t.baseUri)!=null?e:Wve;return{baseUri:a,analyticsBaseUrl:dT(vt(Ee({},t),{baseUri:a})),version:((r=$a==null?void 0:$a.env)==null?void 0:r.npm_package_version)||"v6",deviceId:t.deviceId||_z(),accessToken:t.accessToken,mapId:t.mapId,sessionId:t.sessionId||xz(),platformString:t.platformString||"",context:bz(t.context)||qve,geolocationMode:!1,sendEvents:(i=t.sendEvents)!=null?i:!0,logEvents:(n=t.logEvents)!=null?n:!1,noAuth:t.noAuth||!1,key:t.key,secret:t.secret}},"#getStateWithOption"),s(Qve,"AnalyticsInternal");var e0e=Qve;function dT({mapId:t,baseUri:e=Wve}){return"".concat(e).concat(t,"/")}s(dT,"getBaseUrl");function _z(){return k_.getInstance().loadLocalData("deviceId")}s(_z,"getDeviceIDFromStorage");function xz(){return k_.getInstance().loadSessionData("id")}s(xz,"getSessionIDFromStorage");function t0e(t,e){return t+e}s(t0e,"buildUrl");function bz(t){return Hve.find(e=>e===t)}s(bz,"getValidContext");var gXe=["$select-location","$select-category","$query-suggest","$query-search"],yXe=[Zve,Yve,Jve,Xve,Kve];new e0e;var Mh,r0e=class{constructor(e){Be(this,Mh),$(this,"capture"),$(this,"updateState"),He(this,Mh,e),this.capture=b(this,Mh).capture.bind(b(this,Mh)),this.updateState=b(this,Mh).updateState.bind(b(this,Mh))}getState(){let e=b(this,Mh).getState(),{sessionId:r,deviceId:i}=e;return Nh(e,["sessionId","deviceId"])}getContext(){return b(this,Mh).getContext()}getSessionId(){return b(this,Mh).getSessionId()}getDeviceId(){return b(this,Mh).getDeviceId()}};Mh=new WeakMap,s(r0e,"Analytics");var vXe=r0e;N();var _Xe=new Set(["polygons"]),yp,po,oc,zC,Ik=class UC extends hg{constructor(e,r){super(r.mvfData.externalId),$(this,"__type",UC.__type),$(this,"description"),$(this,"name",""),$(this,"amenity"),$(this,"externalId",""),$(this,"extra"),$(this,"gallery"),$(this,"instances"),$(this,"logo"),$(this,"operationHours"),$(this,"phone"),$(this,"picture"),$(this,"shortName"),$(this,"showFloatingLabelWhenImagePresent"),$(this,"showLogo"),$(this,"siblingGroups"),$(this,"social"),$(this,"sortOrder",-1),$(this,"states"),$(this,"tags"),$(this,"type",""),$(this,"hidden",!1),Be(this,yp),Be(this,po,{}),Be(this,oc),Be(this,zC),He(this,yp,e),He(this,oc,r.mvfData),He(this,zC,r.categoryIds||[]),this.instances=r.locationInstances||[];for(let i in r.mvfData)!_Xe.has(i)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)&&Object.defineProperty(this,i,{enumerable:!0,get(){if(r.parentId){let n=b(this,yp).locationsById[r.parentId];return b(this,oc)[i]!=null?b(this,yp).getPropTranslation(this.__type,i,b(this,oc).id,b(this,oc)[i]):b(this,yp).getPropTranslation(this.__type,i,b(this,oc).id,n[i])}return b(this,yp).getPropTranslation(this.__type,i,b(this,oc).id,b(this,oc)[i])}})}static is(e){return e.__type===UC.__type}get focusTarget(){return this.spaces}get categories(){return b(this,po).categories?b(this,po).categories:(b(this,po).categories=(b(this,zC).map(e=>b(this,yp).getById("enterprise-category",e))||[]).filter(Boolean),b(this,po).categories)}get coordinates(){if(b(this,po).coordinates)return b(this,po).coordinates;b(this,po).coordinates=[];for(let e=0;e<this.nodes.length;e++)b(this,po).coordinates.push(this.nodes[e].coordinate);return b(this,po).coordinates}get nodes(){if(b(this,po).nodes)return b(this,po).nodes;b(this,po).nodes=[];for(let e=0;e<b(this,oc).nodes.length;e++){let r=b(this,yp).getById("node",b(this,oc).nodes[e].id);r&&b(this,po).nodes.push(r)}return b(this,po).nodes}get spaces(){if(b(this,po).spaces)return b(this,po).spaces;b(this,po).spaces=[];for(let e=0;e<b(this,oc).polygons.length;e++){let r=b(this,yp).getById("space",b(this,oc).polygons[e].id);r&&b(this,po).spaces.push(r)}return b(this,po).spaces}toJSON(){return{__type:UC.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(b(this,po)))delete b(this,po)[e]}};yp=new WeakMap,po=new WeakMap,oc=new WeakMap,zC=new WeakMap,s(Ik,"EnterpriseLocation"),$(Ik,"__type","enterprise-location");var xXe=Ik,Vw=xXe;N();var bXe=new Set,Z0,Au,Fd,Tk=class VC extends hg{constructor(e,r){super(r.mvfData.externalId),$(this,"__type",VC.__type),$(this,"name",""),$(this,"color"),$(this,"externalId",""),$(this,"extra"),$(this,"icon"),$(this,"iconFromDefaultList"),$(this,"sortOrder",-1),$(this,"picture"),Be(this,Z0),Be(this,Au,{}),Be(this,Fd),He(this,Z0,e),He(this,Fd,r.mvfData);for(let i in r.mvfData)!bXe.has(i)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)&&Object.defineProperty(this,i,{get(){return b(this,Z0).getPropTranslation(this.__type,i,b(this,Fd).id,b(this,Fd)[i])}})}static is(e){return e.__type===VC.__type}get children(){if(b(this,Au).children)return b(this,Au).children;b(this,Au).children=[];for(let e=0;e<b(this,Fd).children.length;e++){let r=b(this,Z0).getById("enterprise-category",b(this,Fd).children[e]);r&&b(this,Au).children.push(r)}return b(this,Au).children}get locations(){if(b(this,Au).locations)return b(this,Au).locations;b(this,Au).locations=[];for(let e=0;e<b(this,Fd).locations.length;e++){let r=b(this,Z0).getById("enterprise-location",b(this,Fd).locations[e]);r&&b(this,Au).locations.push(r)}return b(this,Au).locations}toJSON(){return{__type:VC.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(b(this,Au)))delete b(this,Au)[e]}};Z0=new WeakMap,Au=new WeakMap,Fd=new WeakMap,s(Tk,"EnterpriseCategory"),$(Tk,"__type","enterprise-category");var wXe=Tk,i0e=wXe;N();var AXe=new Set,jC,$C,Pk=class GC extends hg{constructor(e,r){super(r.mvfData.externalId),$(this,"__type",GC.__type),$(this,"countrycode"),$(this,"externalId",""),$(this,"defaultLanguage",{code:"en",name:"English"}),$(this,"defaultMap"),$(this,"extra"),$(this,"icon"),$(this,"languages",[]),$(this,"links",[]),$(this,"logo"),$(this,"mappedinWebUrl"),$(this,"slug",""),$(this,"topLocations"),$(this,"tzid"),Be(this,jC,{}),Be(this,$C),He(this,$C,r.mvfData);for(let i in r.mvfData)!AXe.has(i)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)&&(this[i]=r.mvfData[i])}static is(e){return e.__type===GC.__type}get name(){var e;return(e=b(this,$C).name)!=null?e:""}toJSON(){return{__type:GC.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(b(this,jC)))delete b(this,jC)[e]}};jC=new WeakMap,$C=new WeakMap,s(Pk,"EnterpriseVenue"),$(Pk,"__type","enterprise-venue");var SXe=Pk,n0e=SXe;N();N();N();N();N();N();var MXe=kr(uye(),1),EXe=kr(mWe(),1);N();var CXe=s(t=>{var e;let r=t;return((e=r==null?void 0:r.allOf)==null?void 0:e.length)===2},"isPotentiallyBadSchema");function fT(t){if(typeof t!="object"||t===null)return t;if(Array.isArray(t))return t.map(fT);let e=Ee({},t);for(let[r,i]of Object.entries(e))if(typeof i=="object"&&i!==null){let n=fT(i);if(CXe(n)){let a=n.allOf.findIndex(l=>l.type==="array"),o=n.allOf.findIndex(l=>l.type==="object");if(a!==-1&&o!==-1){e[r]=vt(Ee({},n),{allOf:[n.allOf[a]]});continue}}e[r]=n}return e}s(fT,"cleanupInvalidArrayAllOf");var IXe={$ref:"#/definitions/ParsedMVF",$schema:"http://json-schema.org/draft-07/schema#",definitions:{AnchoredFloorTextProperties:{additionalProperties:!1,properties:{align:{default:"center",description:"Horizontal alignment of multi-line text.",enum:["left","center","right"],type:"string"},color:{default:"black",description:"The color of the text in CSS format (e.g. `#000000`, `rgb(0, 0, 0)`, `black`).",type:"string"},fontFamily:{default:"Droid Sans",description:"The font family of the text.",type:"string"},fontSize:{default:12,description:"The em-height (multiplier of the font's height) at which to render the font, in meters. The font height is the distance between the ascender (highest point, height of an A) and descender (lowest point, bottom of a g) of the font. For example, if the font-size is 12, the space for a single character will be 12 meters high.",type:"number"},geometryId:{anyOf:[{$ref:"#/definitions/SpaceId"},{$ref:"#/definitions/ObstructionId"}],description:"The geometry to which this text belongs. It will be displayed on top of it."},rotation:{description:"Rotation in degrees, about the center of the text. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},text:{description:"The text to display. Newline characters are supported.",type:"string"},visible:{default:!0,description:"Whether the text is visible.",type:"boolean"}},required:["align","color","fontFamily","fontSize","geometryId","rotation","text","visible"],type:"object"},AnchoredImageProperties:{additionalProperties:!1,properties:{anchorId:{anyOf:[{$ref:"#/definitions/SpaceId"},{$ref:"#/definitions/ObstructionId"}],description:"The geometry to which this image belongs. It will be displayed on top of it."},height:{description:"The height of the image when represented on the map, in meters.",minimum:0,type:"number"},path:{description:"The path to the image. This will be a remote URL.",type:"string"},rotation:{description:"Rotation in degrees, about the center of the image. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},width:{description:"The width of the image when represented on the map, in meters.",minimum:0,type:"number"}},required:["anchorId","height","path","rotation","width"],type:"object"},AnchoredTextAreaProperties:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/TextAreaAlignment",description:"The alignment of the text within the label. 'Near' means the text will be aligned up against the position. Typically in the SDK the text will be rotated to always be upright, so either the start or end of the text will be up against the position. 'Center' means it will be centered in the middle of the area."},anchorId:{anyOf:[{$ref:"#/definitions/SpaceId"},{$ref:"#/definitions/ObstructionId"}],description:"The geometry to which this text area belongs. It will be displayed on top of it."},maxHeight:{description:"The maximum height of the label, in meters. Half the height will be above the feature's position, half below.",exclusiveMinimum:0,type:"number"},maxWidth:{description:"The maximum width of the label, in meters. The left edge will start at the feature's position and extend in the rotation direction.",exclusiveMinimum:0,type:"number"},rotation:{description:"Rotation in degrees relative to north, about the position of the label. North is 0, east is 90.",maximum:360,minimum:0,type:"number"}},required:["align","anchorId","maxHeight","maxWidth","rotation"],type:"object"},AnnotationCollection:{additionalProperties:!1,properties:{features:{items:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/AnnotationProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},AnnotationId:{pattern:"^a_[A-Za-z0-9_-]{8,}$",type:"string"},AnnotationProperties:{additionalProperties:!1,properties:{externalId:{type:"string"},id:{$ref:"#/definitions/AnnotationId"},symbolId:{type:"string"}},required:["id","symbolId"],type:"object"},Area:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Polygon"},properties:{$ref:"#/definitions/AreaProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},AreaCollection:{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Area"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},AreaId:{pattern:"^ar_[A-Za-z0-9_-]{8,}$",type:"string"},AreaProperties:{additionalProperties:!1,properties:{center:{$ref:"#/definitions/Position",description:"The center of mass of this area."},destinationNodes:{description:"A list of node IDs which can be used to navigate to this area.",items:{$ref:"#/definitions/NodeId"},type:"array"},details:{$ref:"#/definitions/Details"},externalId:{type:"string"},id:{$ref:"#/definitions/AreaId"}},required:["id"],type:"object"},Category:{additionalProperties:!1,properties:{icon:{description:"The category's icon",format:"uri",type:"string"},id:{$ref:"#/definitions/CategoryId"},name:{type:"string"},parent:{$ref:"#/definitions/CategoryId"}},required:["id","name","icon"],type:"object"},CategoryId:{description:"A category ID",pattern:"^cat_[A-Za-z0-9_-]{8,}$",type:"string"},Connection:{additionalProperties:!1,properties:{accessible:{type:"boolean"},details:{additionalProperties:!1,properties:{name:{type:"string"}},type:"object"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},id:{$ref:"#/definitions/ConnectionId"},metadata:{$ref:"#/definitions/Metadata"},nodes:{description:"A list of node IDs corresponding to nodes that are a part of this connection.",items:{$ref:"#/definitions/NodeId"},type:"array"},type:{type:"string"}},required:["id","type","nodes","externalId"],type:"object"},ConnectionId:{pattern:"^c_[A-Za-z0-9_-]{8,}$",type:"string"},Connections:{items:{$ref:"#/definitions/Connection"},type:"array"},Day:{enum:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],type:"string"},DayOrPublicHoliday:{anyOf:[{$ref:"#/definitions/Day"},{const:"PublicHolidays",type:"string"}]},Details:{additionalProperties:!1,description:"Additional information about a given entity.",properties:{description:{type:"string"},images:{items:{$ref:"#/definitions/Image"},type:"array"},links:{items:{$ref:"#/definitions/Hyperlink"},type:"array"},name:{type:"string"}},type:"object"},EnterpriseCategory:{additionalProperties:!1,properties:{children:{items:{$ref:"#/definitions/EnterpriseCategoryId"},type:"array"},color:{type:"string"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},icon:{description:"The category's icon",format:"uri",type:"string"},iconFromDefaultList:{type:["string","null"]},id:{$ref:"#/definitions/EnterpriseCategoryId"},locations:{items:{$ref:"#/definitions/EnterpriseLocationId"},type:"array"},name:{type:"string"},picture:{description:"The category's picture",format:"uri",type:"string"},sortOrder:{type:"number"}},required:["children","externalId","id","locations","name","sortOrder"],type:"object"},EnterpriseCategoryId:{description:"An ID for an enterprise category",pattern:"^ec_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseCategoryPriority:{additionalProperties:{items:{$ref:"#/definitions/EnterpriseCategoryId"},type:"array"},description:"The ordered list of category ids that this location belongs to The order here determines the priority of the categories, with the first category being the highest priority for determining application logic like icon and color preference.",propertyNames:{description:"An ID for an enterprise location",pattern:"^el_[A-Za-z0-9_-]{8,}$"},type:"object"},EnterpriseCollection:{additionalProperties:!1,properties:{categories:{items:{$ref:"#/definitions/EnterpriseCategory"},type:"array"},categoryPriorities:{$ref:"#/definitions/EnterpriseCategoryPriority"},enterpriseStyles:{$ref:"#/definitions/EnterpriseStyles"},floorText:{$ref:"#/definitions/EnterpriseFloorText"},layers:{items:{$ref:"#/definitions/EnterpriseLayer"},type:"array"},locationInstances:{items:{$ref:"#/definitions/EnterpriseLocationInstance"},type:"array"},locations:{items:{$ref:"#/definitions/EnterpriseLocation"},type:"array"},textures:{items:{$ref:"#/definitions/EnterpriseTexture"},type:"array"},venue:{$ref:"#/definitions/EnterpriseVenue"}},required:["locations","categories","venue","locationInstances","layers"],type:"object"},EnterpriseFloorText:{additionalProperties:{anyOf:[{$ref:"#/definitions/FloorTextFeatureCollection"},{not:{}}]},description:"The text to display on a map, split into  feature collection per floor.",type:"object"},EnterpriseLayer:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/EnterpriseLayerId"},name:{type:"string"},spaces:{items:{$ref:"#/definitions/EnterpriseLayerSpace"},minItems:1,type:"array"}},required:["id","name","spaces"],type:"object"},EnterpriseLayerId:{pattern:"^ely_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseLayerSpace:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},spaceId:{$ref:"#/definitions/SpaceId"}},required:["floorId","spaceId"],type:"object"},EnterpriseLocation:{additionalProperties:!1,properties:{amenity:{description:"The location's amenity type. Only set if the location is an amenity",type:"string"},description:{type:"string"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},gallery:{description:"The location's image gallery",items:{additionalProperties:!1,properties:{caption:{type:["string","null"]},embeddedUrl:{description:"The URL to link from the image",format:"uri",type:["string","null"]},image:{type:"string"}},required:["image"],type:"object"},type:"array"},hidden:{description:"Whether to show the location in applications",type:"boolean"},id:{$ref:"#/definitions/EnterpriseLocationId"},links:{description:"Web links for the location",items:{additionalProperties:!1,properties:{label:{type:"string"},url:{description:"The URL of the link",format:"uri",type:"string"}},required:["label","url"],type:"object"},type:"array"},logo:{description:"The location's logo",format:"uri",type:"string"},name:{type:"string"},nodes:{deprecated:"Use `spaces` instead. A location's nodes that are not attached to a polygon will be in the spaces array as a point space. Nodes that are attached to one of it's polygons will be destinationNodes on that polygon's space",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/NodeId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},operationHours:{items:{$ref:"#/definitions/OperationHours"},type:"array"},phone:{additionalProperties:!1,properties:{extension:{type:"string"},number:{type:"string"}},required:["number"],type:"object"},picture:{description:"The picture of the location",format:"uri",type:"string"},polygons:{deprecated:"Use `spaces` instead. All of a location's polygons will be in the spaces array.",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/SpaceId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},shortName:{type:"string"},showFloatingLabelWhenImagePresent:{description:"Whether to show the flat label when an image is present",type:"boolean"},showLogo:{description:"Whether to show the logo of the location",type:"boolean"},siblingGroups:{description:"Locations that are related to this location in some manner (described by the label)",items:{$ref:"#/definitions/SiblingGroup"},type:"array"},social:{additionalProperties:!1,description:"The location's social media links",properties:{facebook:{type:"string"},instagram:{type:"string"},twitter:{type:"string"},website:{type:"string"}},type:"object"},sortOrder:{type:"number"},spaces:{description:`The places that this location is anchored to in the physical world. These are either Polygon or Point spaces. A location can be attached to many spaces, and a space can be attached to many locations.

If there are different properties for the location on those spaces, they will show up in the location's  {@link  EnterpriseLocation.instances instances }  property`,items:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/SpaceId"}},required:["floor","id"],type:"object"},type:"array"},states:{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set",items:{$ref:"#/definitions/LocationState"},type:"array"},tags:{items:{type:"string"},type:"array"},type:{type:"string"}},required:["externalId","id","name","nodes","polygons","sortOrder","spaces","type"],type:"object"},EnterpriseLocationId:{description:"An ID for an enterprise location",pattern:"^el_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseLocationInstance:{additionalProperties:!1,description:`A locationInstance is a particular instace of an Enterprise Location that has some properties different from the parent. Eg, it may have different hours, or a slightly different name.

A LocationInstance:
- MUST have a parent, referring to an Enterprise Location.
- MUST have a unique ID, for localization to work.
- SHOULD have AT LEAST ONE polygon or node to anchor it in space.
- SHOULD have AT LEAST ONE other Enterprise Location property set.

It is otherwise a Partial<EnterpriseLocation>

Usage examples:
- A locationInstance for a location with a different externalId so a customer can identify them individually.
- A locationInstance with different operationHours, that might indicate different hours for that particular entrace.`,properties:{amenity:{description:"The location's amenity type. Only set if the location is an amenity",type:"string"},description:{type:"string"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},gallery:{description:"The location's image gallery",items:{additionalProperties:!1,properties:{caption:{type:["string","null"]},embeddedUrl:{description:"The URL to link from the image",format:"uri",type:["string","null"]},image:{type:"string"}},required:["image"],type:"object"},type:"array"},hidden:{description:"Whether to show the location in applications",type:"boolean"},id:{$ref:"#/definitions/EnterpriseLocationInstanceId"},links:{description:"Web links for the location",items:{additionalProperties:!1,properties:{label:{type:"string"},url:{description:"The URL of the link",format:"uri",type:"string"}},required:["label","url"],type:"object"},type:"array"},logo:{description:"The location's logo",format:"uri",type:"string"},name:{type:"string"},nodes:{deprecated:"Use `spaces` instead. A location's nodes that are not attached to a polygon will be in the spaces array as a point space. Nodes that are attached to one of it's polygons will be destinationNodes on that polygon's space",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/NodeId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},operationHours:{items:{$ref:"#/definitions/OperationHours"},type:"array"},parent:{$ref:"#/definitions/EnterpriseLocationId"},phone:{additionalProperties:!1,properties:{extension:{type:"string"},number:{type:"string"}},required:["number"],type:"object"},picture:{description:"The picture of the location",format:"uri",type:"string"},polygons:{deprecated:"Use `spaces` instead. All of a location's polygons will be in the spaces array.",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/SpaceId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},shortName:{type:"string"},showFloatingLabelWhenImagePresent:{description:"Whether to show the flat label when an image is present",type:"boolean"},showLogo:{description:"Whether to show the logo of the location",type:"boolean"},siblingGroups:{description:"Locations that are related to this location in some manner (described by the label)",items:{$ref:"#/definitions/SiblingGroup"},type:"array"},social:{additionalProperties:!1,description:"The location's social media links",properties:{facebook:{type:"string"},instagram:{type:"string"},twitter:{type:"string"},website:{type:"string"}},type:"object"},sortOrder:{type:"number"},spaces:{description:`The places that this location is anchored to in the physical world. These are either Polygon or Point spaces. A location can be attached to many spaces, and a space can be attached to many locations.

If there are different properties for the location on those spaces, they will show up in the location's  {@link  EnterpriseLocation.instances instances }  property`,items:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/SpaceId"}},required:["floor","id"],type:"object"},type:"array"},states:{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set",items:{$ref:"#/definitions/LocationState"},type:"array"},tags:{items:{type:"string"},type:"array"},type:{type:"string"}},required:["id","parent"],type:"object"},EnterpriseLocationInstanceId:{description:"An ID for an enterprise location instance",pattern:"^eli_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseStyles:{additionalProperties:{additionalProperties:!1,properties:{edgeOffset:{type:"number"},geometryAnchors:{items:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},geometryId:{$ref:"#/definitions/SpaceId"}},required:["geometryId","floorId"],type:"object"},type:"array"}},required:["geometryAnchors"],type:"object"},type:"object"},EnterpriseTexture:{additionalProperties:!1,properties:{bounds:{description:"Coordinates of the texture's bounding box in format: [minLon, minLat, maxLon, maxLat].",items:{type:"number"},maxItems:4,minItems:4,type:"array"},face:{$ref:"#/definitions/EnterpriseTextureFace",description:`Face of the polygon that the texture will be applied to.

'top' means that the texture will be applied to the upward-pointing face of the polygon.

'side' means that the texture will be applied to every side face of the polygon.`},geometryAnchors:{description:"Anchors for the texture on the geometry of the polygon.",items:{$ref:"#/definitions/EnterpriseTextureGeometryAnchor"},minItems:1,type:"array"},offset:{$ref:"#/definitions/EnterpriseTextureUV",description:"Controls the starting position of the texture on the surface. The u value shifts the texture horizontally and v shifts vertically."},path:{description:"Path to the texture image. Must be either a PNG or JPG format.",type:"string"},repeat:{$ref:"#/definitions/EnterpriseTextureUV",description:"Controls how many times the texture repeats across the surface. The u value controls horizontal repetition and v controls vertical repetition."},rotation:{description:`Rotation of the texture in degrees clockwise.

For top textures this is relative to north. North is 0, east is 90.

For side textures this is relative to the upward direction, with 0 degrees being upright.`,maximum:360,minimum:0,type:"number"},surface:{$ref:"#/definitions/EnterpriseTextureSurface",description:`Surface of the polygon that the texture will be applied to.

'inside' means that the texture will only be applied to the interior surface of the polygon.

'outside' means that the texture will only be applied to the exterior surface of the polygon.

'both' means that the texture will be applied to both interior and exterior surfaces of the polygon.`}},required:["repeat","offset","rotation","path","face","surface","bounds","geometryAnchors"],type:"object"},EnterpriseTextureFace:{enum:["top","side"],type:"string"},EnterpriseTextureGeometryAnchor:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},geometryId:{$ref:"#/definitions/SpaceId"}},required:["geometryId","floorId"],type:"object"},EnterpriseTextureSurface:{enum:["inside","outside","both"],type:"string"},EnterpriseTextureUV:{additionalProperties:!1,properties:{u:{type:"number"},v:{type:"number"}},required:["u","v"],type:"object"},EnterpriseVenue:{additionalProperties:!1,properties:{countrycode:{description:"The ISO 3166-1 alpha-2 country code of the venue, if known\n\nEg. `US` or `GB`",type:"string"},coverImage:{description:"The venue's cover image",format:"uri",type:"string"},defaultFloor:{$ref:"#/definitions/FloorId",description:"The venue's default floor"},defaultLanguage:{$ref:"#/definitions/Language"},defaultMap:{$ref:"#/definitions/FloorId",deprecated:"Use `defaultFloor` instead"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},icon:{description:"The venue's icon",format:"uri",type:"string"},languages:{items:{$ref:"#/definitions/Language"},type:"array"},logo:{description:"The venue's logo",format:"uri",type:"string"},mappedinWebUrl:{description:`The base URL for Mappedin Web for this venue

Better name?`,type:"string"},name:{type:"string"},operationHours:{description:"When this venue is open.",items:{$ref:"#/definitions/OperationHours"},type:"array"},slug:{type:"string"},topLocations:{items:{$ref:"#/definitions/EnterpriseLocationId"},type:"array"},tzid:{description:"The venue's timezone, from the IANA Time Zone Database. Should be in the format of `America/New_York`",pattern:"^[A-Za-z0-9\\/_-]+$",type:"string"}},required:["defaultLanguage","externalId","languages","name","slug"],type:"object"},EntranceCollection:{$ref:"#/definitions/FeatureCollection%3CLineString%2CEntranceProperties%3E"},EntranceId:{pattern:"^e_[A-Za-z0-9_-]{8,}$",type:"string"},EntranceProperties:{additionalProperties:!1,properties:{details:{$ref:"#/definitions/Details"},externalId:{type:"string"},id:{$ref:"#/definitions/EntranceId"},isExterior:{type:"boolean"},metadata:{$ref:"#/definitions/Metadata"},node:{$ref:"#/definitions/NodeId"}},required:["id","externalId"],type:"object"},Facade:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/FacadeId"},spaces:{items:{$ref:"#/definitions/FacadeSpace"},minItems:1,type:"array"}},required:["id","spaces"],type:"object"},FacadeId:{pattern:"^fc_[A-Za-z0-9_-]{8,}$",type:"string"},FacadeSpace:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},spaceId:{$ref:"#/definitions/SpaceId"}},required:["floorId","spaceId"],type:"object"},"Feature<(Polygon|LineString),ObstructionProperties>":{additionalProperties:!1,properties:{geometry:{anyOf:[{$ref:"#/definitions/Polygon"},{$ref:"#/definitions/LineString"}]},properties:{$ref:"#/definitions/ObstructionProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<(Polygon|LineString|Point),SpaceProperties>":{additionalProperties:!1,properties:{geometry:{anyOf:[{$ref:"#/definitions/Polygon"},{$ref:"#/definitions/LineString"},{$ref:"#/definitions/Point"}]},properties:{$ref:"#/definitions/SpaceProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<(Polygon|MultiPolygon|null),FloorProperties>":{additionalProperties:!1,properties:{geometry:{anyOf:[{$ref:"#/definitions/Polygon"},{$ref:"#/definitions/MultiPolygon"},{type:"null"}]},properties:{$ref:"#/definitions/FloorProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<LineString,EntranceProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/LineString"},properties:{$ref:"#/definitions/EntranceProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,FloorImageProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/FloorImageProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,FloorTextProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/FloorTextProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,NodeProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/NodeProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,TextAreaProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/TextAreaProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Polygon,FloorStackFootprintProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Polygon"},properties:{$ref:"#/definitions/FloorStackFootprintProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"FeatureCollection<(Polygon|LineString),ObstructionProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3C(Polygon%7CLineString)%2CObstructionProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<(Polygon|LineString|Point),SpaceProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3C(Polygon%7CLineString%7CPoint)%2CSpaceProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<(Polygon|MultiPolygon|null),FloorProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3C(Polygon%7CMultiPolygon%7Cnull)%2CFloorProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<LineString,EntranceProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CLineString%2CEntranceProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,FloorImageProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CFloorImageProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,FloorTextProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CFloorTextProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,NodeProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CNodeProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,TextAreaProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CTextAreaProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Polygon,FloorStackFootprintProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPolygon%2CFloorStackFootprintProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},FeatureCollectionType:{const:"FeatureCollection",description:"The type field used for a collection of GeoJSON features.",type:"string"},FeatureType:{const:"Feature",description:"The type field used for individual GeoJSON features.",type:"string"},FloatingFloorTextProperties:{additionalProperties:!1,properties:{align:{default:"center",description:"Horizontal alignment of multi-line text.",enum:["left","center","right"],type:"string"},color:{default:"black",description:"The color of the text in CSS format (e.g. `#000000`, `rgb(0, 0, 0)`, `black`).",type:"string"},fontFamily:{default:"Droid Sans",description:"The font family of the text.",type:"string"},fontSize:{default:12,description:"The em-height (multiplier of the font's height) at which to render the font, in meters. The font height is the distance between the ascender (highest point, height of an A) and descender (lowest point, bottom of a g) of the font. For example, if the font-size is 12, the space for a single character will be 12 meters high.",type:"number"},rotation:{description:"Rotation in degrees, about the center of the text. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},text:{description:"The text to display. Newline characters are supported.",type:"string"},verticalOffset:{description:"The vertical offset of the text, in meters.",type:"number"},visible:{default:!0,description:"Whether the text is visible.",type:"boolean"}},required:["align","color","fontFamily","fontSize","rotation","text","verticalOffset","visible"],type:"object"},FloatingImageProperties:{additionalProperties:!1,properties:{height:{description:"The height of the image when represented on the map, in meters.",minimum:0,type:"number"},path:{description:"The path to the image. This will be a remote URL.",type:"string"},rotation:{description:"Rotation in degrees, about the center of the image. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},verticalOffset:{description:"How high to position the image, in meters, relative to the ground plane.",minimum:0,type:"number"},width:{description:"The width of the image when represented on the map, in meters.",minimum:0,type:"number"}},required:["height","path","rotation","verticalOffset","width"],type:"object"},FloatingTextAreaProperties:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/TextAreaAlignment",description:"The alignment of the text within the label. 'Near' means the text will be aligned up against the position. Typically in the SDK the text will be rotated to always be upright, so either the start or end of the text will be up against the position. 'Center' means it will be centered in the middle of the area."},maxHeight:{description:"The maximum height of the label, in meters. Half the height will be above the feature's position, half below.",exclusiveMinimum:0,type:"number"},maxWidth:{description:"The maximum width of the label, in meters. The left edge will start at the feature's position and extend in the rotation direction.",exclusiveMinimum:0,type:"number"},rotation:{description:"Rotation in degrees relative to north, about the position of the label. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},verticalOffset:{description:"How high to position the text area, in meters, relative to the ground plane.",minimum:0,type:"number"}},required:["align","maxHeight","maxWidth","rotation","verticalOffset"],type:"object"},FloorCollection:{$ref:"#/definitions/FeatureCollection%3C(Polygon%7CMultiPolygon%7Cnull)%2CFloorProperties%3E"},FloorId:{description:"The m_ prefix is deprecated, from when floors were previously called maps. Use f_ as the prefix instead.",pattern:"^[mf]_[A-Za-z0-9_-]{8,}$",type:"string"},FloorImageFeatureCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CFloorImageProperties%3E",description:"A collection of images to be displayed on a map. They are either attached to a polygon or are floating in space."},FloorImageProperties:{anyOf:[{$ref:"#/definitions/AnchoredImageProperties"},{$ref:"#/definitions/FloatingImageProperties"}]},FloorProperties:{additionalProperties:!1,properties:{elevation:{description:"The elevation of this map relative to other maps in the stack. Must be an integer.",type:"integer"},externalId:{description:"Use of this property as the name of the map is deprecated. Use the name property instead.",type:"string"},id:{$ref:"#/definitions/FloorId"},metadata:{$ref:"#/definitions/Metadata"},name:{type:"string"},shortName:{description:"A short name for the map, if it exists. Usually one or two characters (eg, 3, F1, L, etc.) For display in very small spaces, like a floor selector dropdown. Might line up with what is shown on elevator buttons in the physical world.",type:"string"},subtitle:{description:`A subtitle for the map, for display in larger spaces, usually beneath the full name. Provides additional context for what is actually on the map, if the name is not clear. For example, if the full name is "Level 1", the subtitle might be "Arrivals and Baggage Claim".

Should be no more than a few words.`,type:"string"}},required:["id","externalId","elevation"],type:"object"},FloorStack:{additionalProperties:!1,properties:{defaultFloor:{$ref:"#/definitions/FloorId",description:"The default floor to use when a floor is not specified."},externalId:{type:"string"},floors:{description:"A list of floor IDs that belong to this floor stack.",items:{$ref:"#/definitions/FloorId"},type:"array"},footprint:{$ref:"#/definitions/FeatureCollection%3CPolygon%2CFloorStackFootprintProperties%3E",description:"Provides a footprint for the map stack based on the geometry of the maps it contains. This is useful for rendering a map stack without loading all of its maps."},id:{$ref:"#/definitions/FloorStackId"},maps:{deprecated:"Use `floors` instead.",description:"A list of floor IDs that belong to this floor stack.",items:{$ref:"#/definitions/FloorId"},type:"array"},metadata:{$ref:"#/definitions/Metadata"},name:{type:"string"},shortName:{description:"A short name for the map stack, if it exists. For display in small spaces, like a floor selector dropdown.",type:"string"},type:{description:"The type of MapStack, e.g. Building, Outdoor. Defaults to Building.",enum:["Building","Outdoor"],type:"string"}},required:["id","externalId","name","maps"],type:"object"},FloorStackFootprintProperties:{additionalProperties:{not:{}},type:"object"},FloorStackId:{description:"The mg_ prefix is deprecated, from when floor stacks were previously called map groups. Use fs_ as the prefix instead.",pattern:"^fs_[A-Za-z0-9_-]{8,}$",type:"string"},FloorStacks:{items:{$ref:"#/definitions/FloorStack"},type:"array"},FloorTextFeatureCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CFloorTextProperties%3E",description:"A collection of text to be displayed on a map. They are either attached to a space or are floating."},FloorTextProperties:{anyOf:[{$ref:"#/definitions/AnchoredFloorTextProperties"},{$ref:"#/definitions/FloatingFloorTextProperties"}]},Hyperlink:{additionalProperties:!1,properties:{displayName:{type:"string"},url:{type:"string"}},required:["url"],type:"object"},Image:{additionalProperties:!1,properties:{altText:{type:"string"},url:{type:"string"}},required:["url"],type:"object"},Language:{additionalProperties:!1,properties:{code:{type:"string"},name:{type:"string"}},required:["name","code"],type:"object"},Latitude:{description:"A WGS 84-compatible latitude coordinate value.",maximum:90,minimum:-90,type:"number"},LineString:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON LineString geometry.",properties:{coordinates:{items:{$ref:"#/definitions/Position"},minItems:2,type:"array"},type:{const:"LineString",type:"string"}},required:["coordinates","type"],type:"object"},LineStringStyle:{additionalProperties:!1,properties:{altitude:{description:'How far off the "ground" the objects belonging to this layer should be drawn, in meters.',minimum:0,type:"number"},color:{description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB",pattern:"^#[0-9a-fA-F]{6}$",type:"string"},height:{description:"The height of the objects belonging to this layer, in meters.",minimum:0,type:"number"},lineStrings:{description:"The line strings which this style applies to.",items:{anyOf:[{$ref:"#/definitions/EntranceId"},{$ref:"#/definitions/ObstructionId"},{$ref:"#/definitions/SpaceId"}]},type:"array"},opacity:{maximum:1,minimum:0,type:"number"},width:{description:"The thickness of the line when rendered, in meters, measured from the center to the edge.",exclusiveMinimum:0,type:"number"}},required:["altitude","color","height","lineStrings","opacity","width"],type:"object"},LocalPosition:{description:"A position for a local coordinate system, measured in metres.",items:{type:"number"},maxItems:2,minItems:2,type:"array"},Location:{additionalProperties:!1,properties:{annotations:{items:{$ref:"#/definitions/LocationAnnotationMapping"},type:"array"},areas:{items:{$ref:"#/definitions/LocationAreaMapping"},type:"array"},categories:{items:{$ref:"#/definitions/CategoryId"},type:"array"},connections:{items:{$ref:"#/definitions/ConnectionId"},type:"array"},description:{type:"string"},entrances:{items:{$ref:"#/definitions/LocationEntranceMapping"},type:"array"},externalId:{type:"string"},icon:{description:"The location's icon, one of picture/category/logo",format:"uri",type:"string"},id:{$ref:"#/definitions/LocationId"},links:{description:"Web links for the location",items:{$ref:"#/definitions/LocationLink"},type:"array"},logo:{description:"The location's logo",format:"uri",type:"string"},name:{type:"string"},obstructions:{items:{$ref:"#/definitions/LocationObstructionMapping"},type:"array"},openingHoursSpecification:{description:"The location's opening hours",items:{$ref:"#/definitions/OpeningHoursSpecification"},type:"array"},phone:{type:"string"},pictures:{description:"The location's pictures",items:{$ref:"#/definitions/LocationPicture"},type:"array"},social:{description:"The location's social media links.",items:{$ref:"#/definitions/LocationSocial"},type:"array"},spaces:{items:{$ref:"#/definitions/LocationSpaceMapping"},type:"array"},website:{$ref:"#/definitions/LocationLink",description:"The location's website"}},required:["id","name","categories","spaces","obstructions","entrances","connections","annotations","areas","social","pictures","links","openingHoursSpecification"],type:"object"},LocationAnnotationMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/AnnotationId"}},required:["floor","id"],type:"object"},LocationAreaMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/AreaId"}},required:["floor","id"],type:"object"},LocationEntranceMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/EntranceId"}},required:["floor","id"],type:"object"},LocationId:{description:"An ID for a location",pattern:"^loc_[A-Za-z0-9_-]{8,}$",type:"string"},LocationLink:{additionalProperties:!1,properties:{label:{type:"string"},url:{description:"The URL of the link",format:"uri",type:"string"}},required:["label","url"],type:"object"},LocationObstructionMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/ObstructionId"}},required:["floor","id"],type:"object"},LocationPicture:{additionalProperties:!1,description:"The location's pictures Single-field object, because it's plausible we might add captions or comments in the future",properties:{url:{format:"uri",type:"string"}},type:"object"},LocationSocial:{additionalProperties:!1,properties:{name:{description:"The name of the social media platform.",type:"string"},url:{description:"The URL of the social media profile",format:"uri",type:"string"}},required:["name","url"],type:"object"},LocationSpaceMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/SpaceId"}},required:["floor","id"],type:"object"},LocationState:{additionalProperties:!1,description:"The state of a location. Start and end dates are optional.",properties:{end:{description:"The start date of the state",format:"date",type:"string"},start:{description:"The start date of the state",format:"date",type:"string"},type:{description:`The type of the location state. Technically not limited, but should be one of the following:
- closed-temporarily
- new
- pop-up
- coming-soon
- relocated`,type:"string"}},required:["type"],type:"object"},Longitude:{description:"A WGS 84-compatible longitude coordinate value.",maximum:180,minimum:-180,type:"number"},ManifestCollection:{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/ManifestFeature"},maxItems:1,minItems:1,type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},ManifestFeature:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/ManifestProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},ManifestFile:{additionalProperties:!1,properties:{name:{type:"string"},type:{const:"file",type:"string"}},required:["type","name"],type:"object"},ManifestFolder:{additionalProperties:!1,properties:{children:{items:{$ref:"#/definitions/ManifestFile"},minItems:1,type:"array"},name:{type:"string"},type:{const:"folder",type:"string"}},required:["type","name","children"],type:"object"},ManifestProperties:{additionalProperties:!1,properties:{folder_struct:{items:{anyOf:[{$ref:"#/definitions/ManifestFolder"},{$ref:"#/definitions/ManifestFile"}]},type:"array"},language:{description:"The RFC 5646 language tag of the MVF. https://datatracker.ietf.org/doc/html/rfc5646",examples:["en-US"],type:"string"},map:{description:"The identifier of the map that this MVF is for.",type:"string"},name:{type:"string"},naturalBearing:{description:'The angle, in degrees, the map is considered to be "naturally oriented" as, rather than facing directly north. 90 degrees means East is "up"',maximum:360,minimum:0,type:"number"},org_id:{type:"string"},time:{description:"An ISO 8601 date-time string, including timezone offset.",format:"date-time",type:"string"},tzid:{description:"The map's timezone, from the IANA Time Zone Database. Should be in the format of `America/New_York`",examples:["America/New_York"],pattern:"^[A-Za-z0-9_-]+\\/[A-Za-z0-9_-]+$",type:"string"},version:{const:"2.0.0",type:"string"}},required:["name","folder_struct","version","time"],type:"object"},Maps:{deprecated:"This is only present on `map.geojson` which is deprecated. Use\nthe collection on `floor.geojson` instead.",items:{$ref:"#/definitions/FloorProperties"},type:"array"},Material:{additionalProperties:!1,description:`The color and/or texture that should be applied to an instance of a Shape.

If both a color and a texture are provided, the color will be applied to the texture via a multiply operation. If neither are provided, the shape will be white.`,properties:{color:{description:"The color of this mateial as a hex code.",pattern:"^#[0-9a-fA-F]{6}$",type:"string"},texture:{$ref:"#/definitions/Texture"}},type:"object"},Metadata:{additionalProperties:{},description:"Can be any extra metadata that is not part of the main MVF spec. Presence of any key or value is not guaranteed. Values are expected to be JSON-serializable.",type:"object"},ModelInstance:{additionalProperties:!1,description:"An instance of a 3D model.",properties:{altitude:{description:"The distance above ground, in metres, where this Decoration's origin point should be placed.",type:"number"},path:{description:"The path to this asset, relative to the MVF's models folder. Supports GLTF and OBJ.",minLength:1,type:"string"},position:{$ref:"#/definitions/Position",description:"The long/lat point that the Decoration's origin point correponds to."},rotation:{$ref:"#/definitions/Vector3",description:"The rotation, in Euler angles in XYZ order, that will be applied to this Decoration."},scale:{$ref:"#/definitions/Vector3",description:"The X, Y and Z scale that will be applied to this Decoration."}},required:["altitude","path","position","rotation","scale"],type:"object"},ModelInstanceCollection:{additionalProperties:{$ref:"#/definitions/ModelInstance"},description:"A map of model instances, where keys are valid polygon or obstruction IDs. Replaces the specified polygon.",type:"object"},MultiPolygon:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON MultiPolygon geometry.",properties:{coordinates:{items:{items:{items:{$ref:"#/definitions/Position"},type:"array"},type:"array"},type:"array"},type:{const:"MultiPolygon",type:"string"}},required:["coordinates","type"],type:"object"},NodeCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CNodeProperties%3E"},NodeId:{pattern:"^n_[A-Za-z0-9_-]{8,}$",type:"string"},NodeProperties:{additionalProperties:!1,properties:{externalId:{type:"string"},floor:{$ref:"#/definitions/FloorId",description:"The ID of the floor this node is found on."},id:{$ref:"#/definitions/NodeId"},map:{$ref:"#/definitions/FloorId",deprecated:"use `floor` instead.",description:"The ID of the floor this node is found on."},neighbors:{description:"A list of nodes that can be navigated to from this node.",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/NodeId"},weight:{description:"The cost of navigating to this node.",minimum:0,type:"number"}},required:["id","weight"],type:"object"},type:"array"},preventSmoothing:{description:"Flag that may optionally indicate that a node is part of a custom path network rather than auto generated and should not be removed during smoothing/simplifcation.",type:"boolean"},space:{description:"The IDs of any spaces this node may be contained within.",items:{$ref:"#/definitions/SpaceId"},type:"array"}},required:["id","externalId","map","space","neighbors"],type:"object"},ObstructionCollection:{$ref:"#/definitions/FeatureCollection%3C(Polygon%7CLineString)%2CObstructionProperties%3E"},ObstructionId:{pattern:"^o_[A-Za-z0-9_-]{8,}$",type:"string"},ObstructionProperties:{additionalProperties:!1,properties:{center:{$ref:"#/definitions/Position",description:"The center of mass of this obstruction, if it is a polygon. This is undefined for line strings as this can be trivially derived."},details:{$ref:"#/definitions/Details"},entrances:{description:"A list of entrance IDs corresponding to entrances that can be used to navigate through this obstruction.",items:{$ref:"#/definitions/EntranceId"},type:"array"},externalId:{type:"string"},footprintComponent:{description:"Indicates whether this obstruction is considered part of the footprint of the building it is a part of. For example, an exterior wall would be considered part of the building footprint.",type:"boolean"},id:{$ref:"#/definitions/ObstructionId"},kind:{type:"string"},metadata:{$ref:"#/definitions/Metadata"}},required:["id","externalId","entrances"],type:"object"},OpeningHoursSpecification:{additionalProperties:!1,description:`We (almost) follow this schema (http://schema.org/OpeningHoursSpecification) The only difference is that we (like Google: https://developers.google.com/search/docs/data-types/local-businesses) accept dayOfWeek as an array as well as an individual day.

Behavioral notes:
- if the "opens" property is not present, the location is closed, and the closes property is ignored (Schema.org style)
- if opens/closes are both set to 00:00, the location is closed (Google style)
- If special hours do not specifiy certain weekdays being open, those weekdays are closed.
- Not specifying dayOfWeek is equivalent to specifying every day of the week.
- we will omit the '@type' property when producing MVFs. But we won't reject 3rd party MVFs that include it.`,properties:{"@type":{const:"OpeningHoursSpecification",default:"OpeningHoursSpecification",description:"The type of opening hours",type:"string"},closes:{$ref:"#/definitions/Time",description:"The time the opening hours end"},dayOfWeek:{anyOf:[{$ref:"#/definitions/DayOrPublicHoliday"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},maxItems:1,minItems:1,type:"array"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},type:"array"}],description:"The days of the week the opening hours apply to"},opens:{$ref:"#/definitions/Time",description:"The time the opening hours start"},validFrom:{description:"The date the opening hours start, in ISO 8601 format",format:"date-time",type:"string"},validThrough:{description:"The date the opening hours end, in ISO 8601 format",format:"date-time",type:"string"}},type:"object"},OperationHours:{additionalProperties:!1,description:"We (almost) follow this schema (http://schema.org/OpeningHoursSpecification) The only difference is that we (like Google: https://developers.google.com/search/docs/data-types/local-businesses) accept dayOfWeek as an array as well as an individual day.",properties:{"@type":{const:"OpeningHoursSpecification",default:"OpeningHoursSpecification",description:"The type of operation hours",type:"string"},closes:{$ref:"#/definitions/Time",description:"The time the operation hours end"},dayOfWeek:{anyOf:[{$ref:"#/definitions/DayOrPublicHoliday"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},maxItems:1,minItems:1,type:"array"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},type:"array"}],description:"The days of the week the operation hours apply to"},opens:{$ref:"#/definitions/Time",description:"The time the operation hours start"},validFrom:{description:"The date the operation hours start, in ISO 8601 format",format:"date-time",type:"string"},validThrough:{description:"The date the operation hours end, in ISO 8601 format",format:"date-time",type:"string"}},type:"object"},ParsedMVF:{additionalProperties:!1,properties:{annotation:{additionalProperties:{anyOf:[{$ref:"#/definitions/AnnotationCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},area:{additionalProperties:{anyOf:[{$ref:"#/definitions/AreaCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"category.json":{items:{$ref:"#/definitions/Category"},type:"array"},"connection.json":{$ref:"#/definitions/Connections"},enterprise:{$ref:"#/definitions/EnterpriseCollection"},entrance:{additionalProperties:{anyOf:[{$ref:"#/definitions/EntranceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},facade:{additionalProperties:{anyOf:[{$ref:"#/definitions/Facade"},{not:{}}]},propertyNames:{pattern:"^fs_[A-Za-z0-9_-]{8,}$"},type:"object"},"floor.geojson":{$ref:"#/definitions/FloorCollection"},floorImages:{additionalProperties:{anyOf:[{$ref:"#/definitions/FloorImageFeatureCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"floorstack.json":{$ref:"#/definitions/FloorStacks"},"location.json":{items:{$ref:"#/definitions/Location"},type:"array"},"manifest.geojson":{$ref:"#/definitions/ManifestCollection"},"map.geojson":{$ref:"#/definitions/Maps",deprecated:"Use `floor.geojson` instead."},"mapstack.geojson":{$ref:"#/definitions/FloorStacks",deprecated:"Use `floorstack.json` instead."},"mapstack.json":{$ref:"#/definitions/FloorStacks",deprecated:"Use `floorstack.json` instead."},modelInstances:{additionalProperties:{anyOf:[{$ref:"#/definitions/ModelInstanceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"node.geojson":{$ref:"#/definitions/NodeCollection"},obstruction:{additionalProperties:{anyOf:[{$ref:"#/definitions/ObstructionCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},shapeInstances:{additionalProperties:{anyOf:[{$ref:"#/definitions/ShapeInstanceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"shapes.json":{$ref:"#/definitions/ShapeCollection"},space:{additionalProperties:{anyOf:[{$ref:"#/definitions/SpaceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"styles.json":{$ref:"#/definitions/StyleCollection"},textAreas:{additionalProperties:{anyOf:[{$ref:"#/definitions/TextAreaFeatureCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"tileset.json":{$ref:"#/definitions/TilesetCollection"},window:{additionalProperties:{anyOf:[{$ref:"#/definitions/WindowCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"}},required:["manifest.geojson","mapstack.geojson","map.geojson","space","obstruction","connection.json","node.geojson","entrance"],type:"object"},Point:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON Point geometry.",properties:{coordinates:{$ref:"#/definitions/Position"},type:{const:"Point",type:"string"}},required:["coordinates","type"],type:"object"},PointStyle:{additionalProperties:!1,properties:{points:{description:"The points which this style applies to.",items:{$ref:"#/definitions/SpaceId"},type:"array"},showImage:{description:"Whether or not the first image attached to the space or obstruction should be displayed on the point.",type:"boolean"}},required:["points"],type:"object"},Polygon:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON Polygon geometry.",properties:{coordinates:{items:{items:{$ref:"#/definitions/Position"},type:"array"},type:"array"},type:{const:"Polygon",type:"string"}},required:["coordinates","type"],type:"object"},PolygonStyle:{additionalProperties:!1,properties:{altitude:{description:'How far off the "ground" the objects belonging to this layer should be drawn, in meters.',minimum:0,type:"number"},color:{description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB",pattern:"^#[0-9a-fA-F]{6}$",type:"string"},height:{description:"The height of the objects belonging to this layer, in meters.",minimum:0,type:"number"},opacity:{maximum:1,minimum:0,type:"number"},polygons:{description:"The polygons which this style applies to.",items:{anyOf:[{$ref:"#/definitions/ObstructionId"},{$ref:"#/definitions/SpaceId"}]},type:"array"},showImage:{description:"Whether or not the first image attached to the space or obstruction should be displayed on the polygon.",type:"boolean"}},required:["altitude","color","height","opacity","polygons"],type:"object"},Position:{description:"A valid WGS 84 position consisting of a longitude coodinate, followed by a latitude coordinate.",items:[{$ref:"#/definitions/Longitude"},{$ref:"#/definitions/Latitude"}],maxItems:2,minItems:2,type:"array"},Ring:{description:"A simple shape for part of a complex polygon",items:{$ref:"#/definitions/LocalPosition"},minItems:3,type:"array"},Shape:{description:"A 3D object made from extruded 2D polygons, that can be rendered to the map as a ShapeInstance.",items:{$ref:"#/definitions/ShapeComponent"},minItems:1,type:"array"},ShapeCollection:{additionalProperties:{$ref:"#/definitions/Shape"},description:"A group of Shapes, without any information as to how they will be placed in a scene.",propertyNames:{pattern:"^sh_[A-Za-z0-9_-]{8,}$"},type:"object"},ShapeComponent:{additionalProperties:!1,description:"A single extruded 2D polygon.",properties:{altitude:{description:"In metres.",type:"number"},geometry:{description:"Can contain holes, like GeoJSON.",items:{$ref:"#/definitions/Ring"},minItems:1,type:"array"},height:{description:"In metres.",exclusiveMinimum:0,type:"number"}},required:["geometry","altitude","height"],type:"object"},ShapeId:{pattern:"^sh_[A-Za-z0-9_-]{8,}$",type:"string"},ShapeInstance:{additionalProperties:!1,description:"An instance of a Shape.",properties:{altitude:{description:"The distance above ground, in metres, where this Decoration's origin point should be placed.",type:"number"},id:{$ref:"#/definitions/ShapeId",description:"The identifier of the Shape to be placed."},material:{$ref:"#/definitions/Material",description:"The color and/or texture to apply to this shape instance."},position:{$ref:"#/definitions/Position",description:"The long/lat point that the Decoration's origin point correponds to."},rotation:{$ref:"#/definitions/Vector3",description:"The rotation, in Euler angles in XYZ order, that will be applied to this Decoration."},scale:{$ref:"#/definitions/Vector3",description:"The X, Y and Z scale that will be applied to this Decoration."}},required:["altitude","id","material","position","rotation","scale"],type:"object"},ShapeInstanceCollection:{additionalProperties:{$ref:"#/definitions/ShapeInstance"},description:"A map of shape instances, where keys are valid polygon or obstruction IDs. Replaces the specified polygon.",type:"object"},SiblingGroup:{additionalProperties:!1,properties:{label:{type:"string"},siblings:{items:{$ref:"#/definitions/EnterpriseLocationId"},type:"array"}},required:["label","siblings"],type:"object"},SpaceCollection:{$ref:"#/definitions/FeatureCollection%3C(Polygon%7CLineString%7CPoint)%2CSpaceProperties%3E"},SpaceId:{pattern:"^s_[A-Za-z0-9_-]{8,}$",type:"string"},SpaceProperties:{additionalProperties:!1,properties:{center:{$ref:"#/definitions/Position",description:"The center of mass of this space, if it is a polygon. This is undefined for line string and point spaces as these can be trivially derived."},destinationNodes:{description:"A list of node IDs which can be used to navigate to this space.",items:{$ref:"#/definitions/NodeId"},type:"array"},details:{$ref:"#/definitions/Details"},externalId:{type:"string"},id:{$ref:"#/definitions/SpaceId"},kind:{type:"string"},metadata:{$ref:"#/definitions/Metadata"},tags:{description:"A list of tags that may apply to categorize the space, e.g. Void",items:{type:"string"},type:"array"}},required:["id","externalId","destinationNodes"],type:"object"},StyleCollection:{additionalProperties:{anyOf:[{$ref:"#/definitions/PolygonStyle"},{$ref:"#/definitions/LineStringStyle"},{$ref:"#/definitions/PointStyle"},{not:{}}]},description:"A map of layer styles, where keys represent the group IDs of each style.",type:"object"},TextAreaAlignment:{enum:["near","center"],type:"string"},TextAreaFeatureCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CTextAreaProperties%3E",description:"A collection of text areas to be displayed on a map. They are either attached to a polygon or are floating in space."},TextAreaProperties:{anyOf:[{$ref:"#/definitions/AnchoredTextAreaProperties"},{$ref:"#/definitions/FloatingTextAreaProperties"}]},Texture:{additionalProperties:!1,description:"A reference to an image texture and how it should be applied to a Component.",properties:{path:{description:"The path to this asset, relative to the MVF's images folder.",minLength:1,type:"string"},repeat:{$ref:"#/definitions/TextureRepeat"}},required:["path"],type:"object"},TextureRepeat:{additionalProperties:!1,description:"How a texture should be placed on a Component.",properties:{u:{type:"number"},v:{type:"number"}},required:["u","v"],type:"object"},TilesetCollection:{additionalProperties:!1,description:"Collection of tileset styles",properties:{default:{$ref:"#/definitions/TilesetStyle",description:"Default tileset style that should be used"},others:{description:"Additional tileset styles that can be used",items:{$ref:"#/definitions/TilesetStyle"},type:"array"}},required:["default"],type:"object"},TilesetStyle:{additionalProperties:!1,description:"A tileset style definition",properties:{key:{description:"Unique identifier for this tileset style",minLength:1,type:"string"},name:{description:"Display name for this tileset style",minLength:1,type:"string"},url:{description:"URL to the tileset style definition. This should be a JSON file matching the MapLibre style specification.",format:"uri",type:"string"}},required:["key","name","url"],type:"object"},Time:{description:"A time in the format of HH:MM:SS",pattern:"^[0-2][0-9]:[0-6][0-9](:[0-6][0-9])?$",type:"string"},Vector3:{description:"A three-number tuple.",items:{type:"number"},maxItems:3,minItems:3,type:"array"},WindowCollection:{additionalProperties:!1,properties:{features:{items:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/LineString"},properties:{$ref:"#/definitions/WindowProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},WindowId:{pattern:"^w_[A-Za-z0-9_-]{8,}$",type:"string"},WindowProperties:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/WindowId"}},required:["id"],type:"object"}}};EXe.default.default(new MXe.default.default).compile(fT(IXe));N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();var ja={};Nl(ja,{HasPropertyKey:()=>a0e,IsArray:()=>Ec,IsAsyncIterator:()=>wz,IsBigInt:()=>r5,IsBoolean:()=>yx,IsDate:()=>KA,IsFunction:()=>Az,IsIterator:()=>Sz,IsNull:()=>Mz,IsNumber:()=>vf,IsObject:()=>io,IsRegExp:()=>i5,IsString:()=>Ko,IsSymbol:()=>Ez,IsUint8Array:()=>gv,IsUndefined:()=>ll});N();function a0e(t,e){return e in t}s(a0e,"HasPropertyKey");function wz(t){return io(t)&&!Ec(t)&&!gv(t)&&Symbol.asyncIterator in t}s(wz,"IsAsyncIterator");function Ec(t){return Array.isArray(t)}s(Ec,"IsArray");function r5(t){return typeof t=="bigint"}s(r5,"IsBigInt");function yx(t){return typeof t=="boolean"}s(yx,"IsBoolean");function KA(t){return t instanceof globalThis.Date}s(KA,"IsDate");function Az(t){return typeof t=="function"}s(Az,"IsFunction");function Sz(t){return io(t)&&!Ec(t)&&!gv(t)&&Symbol.iterator in t}s(Sz,"IsIterator");function Mz(t){return t===null}s(Mz,"IsNull");function vf(t){return typeof t=="number"}s(vf,"IsNumber");function io(t){return typeof t=="object"&&t!==null}s(io,"IsObject");function i5(t){return t instanceof globalThis.RegExp}s(i5,"IsRegExp");function Ko(t){return typeof t=="string"}s(Ko,"IsString");function Ez(t){return typeof t=="symbol"}s(Ez,"IsSymbol");function gv(t){return t instanceof globalThis.Uint8Array}s(gv,"IsUint8Array");function ll(t){return t===void 0}s(ll,"IsUndefined");function o0e(t){return t.map(e=>jw(e))}s(o0e,"ArrayType");function s0e(t){return new Date(t.getTime())}s(s0e,"DateType");function l0e(t){return new Uint8Array(t)}s(l0e,"Uint8ArrayType");function u0e(t){return new RegExp(t.source,t.flags)}s(u0e,"RegExpType");function c0e(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=jw(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=jw(t[r]);return e}s(c0e,"ObjectType");function jw(t){return Ec(t)?o0e(t):KA(t)?s0e(t):gv(t)?l0e(t):i5(t)?u0e(t):io(t)?c0e(t):t}s(jw,"Visit");function Bu(t){return jw(t)}s(Bu,"Clone");function h0e(t){return t.map(e=>n5(e))}s(h0e,"CloneRest");function n5(t,e){return Bu(e===void 0?t:Ee(Ee({},e),t))}s(n5,"CloneType");N();N();N();function Cz(t){return kn(t)&&Symbol.asyncIterator in t}s(Cz,"IsAsyncIterator");function Iz(t){return kn(t)&&Symbol.iterator in t}s(Iz,"IsIterator");function Tz(t){return kn(t)&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}s(Tz,"IsStandardObject");function Pz(t){return t instanceof Promise}s(Pz,"IsPromise");function Mf(t){return t instanceof Date&&Number.isFinite(t.getTime())}s(Mf,"IsDate");function p0e(t){return t instanceof globalThis.Map}s(p0e,"IsMap");function d0e(t){return t instanceof globalThis.Set}s(d0e,"IsSet");function Ef(t){return ArrayBuffer.isView(t)}s(Ef,"IsTypedArray");function a5(t){return t instanceof globalThis.Uint8Array}s(a5,"IsUint8Array");function ki(t,e){return e in t}s(ki,"HasPropertyKey");function kn(t){return t!==null&&typeof t=="object"}s(kn,"IsObject");function zn(t){return Array.isArray(t)&&!ArrayBuffer.isView(t)}s(zn,"IsArray");function Hu(t){return t===void 0}s(Hu,"IsUndefined");function vx(t){return t===null}s(vx,"IsNull");function yv(t){return typeof t=="boolean"}s(yv,"IsBoolean");function bi(t){return typeof t=="number"}s(bi,"IsNumber");function Lz(t){return Number.isInteger(t)}s(Lz,"IsInteger");function fc(t){return typeof t=="bigint"}s(fc,"IsBigInt");function _a(t){return typeof t=="string"}s(_a,"IsString");function JA(t){return typeof t=="function"}s(JA,"IsFunction");function _x(t){return typeof t=="symbol"}s(_x,"IsSymbol");function od(t){return fc(t)||yv(t)||vx(t)||bi(t)||_a(t)||_x(t)||Hu(t)}s(od,"IsValueType");var Io;(function(t){t.InstanceMode="default",t.ExactOptionalPropertyTypes=!1,t.AllowArrayObject=!1,t.AllowNaN=!1,t.AllowNullVoid=!1;function e(o,l){return t.ExactOptionalPropertyTypes?l in o:o[l]!==void 0}s(e,"IsExactOptionalProperty"),t.IsExactOptionalProperty=e;function r(o){let l=kn(o);return t.AllowArrayObject?l:l&&!zn(o)}s(r,"IsObjectLike"),t.IsObjectLike=r;function i(o){return r(o)&&!(o instanceof Date)&&!(o instanceof Uint8Array)}s(i,"IsRecordLike"),t.IsRecordLike=i;function n(o){return t.AllowNaN?bi(o):Number.isFinite(o)}s(n,"IsNumberLike"),t.IsNumberLike=n;function a(o){let l=Hu(o);return t.AllowNullVoid?l||o===null:l}s(a,"IsVoidLike"),t.IsVoidLike=a})(Io||(Io={}));N();function f0e(t){return globalThis.Object.freeze(t).map(e=>$w(e))}s(f0e,"ImmutableArray");function m0e(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=$w(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=$w(t[r]);return globalThis.Object.freeze(e)}s(m0e,"ImmutableObject");function $w(t){return Ec(t)?f0e(t):KA(t)||gv(t)||i5(t)?t:io(t)?m0e(t):t}s($w,"Immutable");function ii(t,e){let r=e!==void 0?Ee(Ee({},e),t):t;switch(Io.InstanceMode){case"freeze":return $w(r);case"clone":return Bu(r);default:return r}}s(ii,"CreateType");N();var g0e=class extends Error{constructor(e){super(e)}};s(g0e,"TypeBoxError");var Ia=g0e;N();N();N();var Du=Symbol.for("TypeBox.Transform"),QA=Symbol.for("TypeBox.Readonly"),pg=Symbol.for("TypeBox.Optional"),z_=Symbol.for("TypeBox.Hint"),br=Symbol.for("TypeBox.Kind");function y0e(t){return io(t)&&t[QA]==="Readonly"}s(y0e,"IsReadonly");function vv(t){return io(t)&&t[pg]==="Optional"}s(vv,"IsOptional");function Dz(t){return Mn(t,"Any")}s(Dz,"IsAny");function xx(t){return Mn(t,"Array")}s(xx,"IsArray");function o5(t){return Mn(t,"AsyncIterator")}s(o5,"IsAsyncIterator");function Rz(t){return Mn(t,"BigInt")}s(Rz,"IsBigInt");function Oz(t){return Mn(t,"Boolean")}s(Oz,"IsBoolean");function s5(t){return Mn(t,"Constructor")}s(s5,"IsConstructor");function v0e(t){return Mn(t,"Date")}s(v0e,"IsDate");function l5(t){return Mn(t,"Function")}s(l5,"IsFunction");function eS(t){return Mn(t,"Integer")}s(eS,"IsInteger");function oh(t){return Mn(t,"Intersect")}s(oh,"IsIntersect");function u5(t){return Mn(t,"Iterator")}s(u5,"IsIterator");function Mn(t,e){return io(t)&&br in t&&t[br]===e}s(Mn,"IsKindOf");function bx(t){return Mn(t,"Literal")}s(bx,"IsLiteral");function dg(t){return Mn(t,"MappedKey")}s(dg,"IsMappedKey");function qu(t){return Mn(t,"MappedResult")}s(qu,"IsMappedResult");function wx(t){return Mn(t,"Never")}s(wx,"IsNever");function _0e(t){return Mn(t,"Not")}s(_0e,"IsNot");function x0e(t){return Mn(t,"Null")}s(x0e,"IsNull");function tS(t){return Mn(t,"Number")}s(tS,"IsNumber");function Jh(t){return Mn(t,"Object")}s(Jh,"IsObject");function rS(t){return Mn(t,"Promise")}s(rS,"IsPromise");function kz(t){return Mn(t,"Record")}s(kz,"IsRecord");function Nz(t){return Mn(t,"Ref")}s(Nz,"IsRef");function Fz(t){return Mn(t,"RegExp")}s(Fz,"IsRegExp");function c5(t){return Mn(t,"String")}s(c5,"IsString");function b0e(t){return Mn(t,"Symbol")}s(b0e,"IsSymbol");function fg(t){return Mn(t,"TemplateLiteral")}s(fg,"IsTemplateLiteral");function w0e(t){return Mn(t,"This")}s(w0e,"IsThis");function h5(t){return io(t)&&Du in t}s(h5,"IsTransform");function _v(t){return Mn(t,"Tuple")}s(_v,"IsTuple");function A0e(t){return Mn(t,"Undefined")}s(A0e,"IsUndefined");function Hs(t){return Mn(t,"Union")}s(Hs,"IsUnion");function S0e(t){return Mn(t,"Uint8Array")}s(S0e,"IsUint8Array");function M0e(t){return Mn(t,"Unknown")}s(M0e,"IsUnknown");function E0e(t){return Mn(t,"Unsafe")}s(E0e,"IsUnsafe");function C0e(t){return Mn(t,"Void")}s(C0e,"IsVoid");function xv(t){return io(t)&&br in t&&Ko(t[br])}s(xv,"IsKind");function Jy(t){return Dz(t)||xx(t)||Oz(t)||Rz(t)||o5(t)||s5(t)||v0e(t)||l5(t)||eS(t)||oh(t)||u5(t)||bx(t)||dg(t)||qu(t)||wx(t)||_0e(t)||x0e(t)||tS(t)||Jh(t)||rS(t)||kz(t)||Nz(t)||Fz(t)||c5(t)||b0e(t)||fg(t)||w0e(t)||_v(t)||A0e(t)||Hs(t)||S0e(t)||M0e(t)||E0e(t)||C0e(t)||xv(t)}s(Jy,"IsSchema");var it={};Nl(it,{IsAny:()=>Vz,IsArray:()=>jz,IsAsyncIterator:()=>$z,IsBigInt:()=>Gz,IsBoolean:()=>Hz,IsConstructor:()=>qz,IsDate:()=>Wz,IsFunction:()=>Xz,IsInteger:()=>Zz,IsIntersect:()=>Yz,IsIterator:()=>Kz,IsKind:()=>bU,IsKindOf:()=>xn,IsLiteral:()=>Ax,IsLiteralBoolean:()=>R0e,IsLiteralNumber:()=>Qz,IsLiteralString:()=>Jz,IsLiteralValue:()=>eU,IsMappedKey:()=>tU,IsMappedResult:()=>rU,IsNever:()=>iU,IsNot:()=>nU,IsNull:()=>aU,IsNumber:()=>oU,IsObject:()=>sU,IsOptional:()=>D0e,IsPromise:()=>lU,IsProperties:()=>f5,IsReadonly:()=>L0e,IsRecord:()=>uU,IsRecursive:()=>O0e,IsRef:()=>cU,IsRegExp:()=>hU,IsSchema:()=>Hn,IsString:()=>pU,IsSymbol:()=>dU,IsTemplateLiteral:()=>fU,IsThis:()=>mU,IsTransform:()=>no,IsTuple:()=>gU,IsUint8Array:()=>yU,IsUndefined:()=>iS,IsUnion:()=>m5,IsUnionLiteral:()=>k0e,IsUnknown:()=>vU,IsUnsafe:()=>_U,IsVoid:()=>xU,TypeGuardUnknownTypeError:()=>TXe});N();var I0e=class extends Ia{};s(I0e,"TypeGuardUnknownTypeError");var TXe=I0e,PXe=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function Bz(t){try{return new RegExp(t),!0}catch{return!1}}s(Bz,"IsPattern");function p5(t){if(!Ko(t))return!1;for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);if(r>=7&&r<=13||r===27||r===127)return!1}return!0}s(p5,"IsControlCharacterFree");function zz(t){return d5(t)||Hn(t)}s(zz,"IsAdditionalProperties");function Y0(t){return ll(t)||r5(t)}s(Y0,"IsOptionalBigInt");function va(t){return ll(t)||vf(t)}s(va,"IsOptionalNumber");function d5(t){return ll(t)||yx(t)}s(d5,"IsOptionalBoolean");function ea(t){return ll(t)||Ko(t)}s(ea,"IsOptionalString");function T0e(t){return ll(t)||Ko(t)&&p5(t)&&Bz(t)}s(T0e,"IsOptionalPattern");function P0e(t){return ll(t)||Ko(t)&&p5(t)}s(P0e,"IsOptionalFormat");function Uz(t){return ll(t)||Hn(t)}s(Uz,"IsOptionalSchema");function L0e(t){return io(t)&&t[QA]==="Readonly"}s(L0e,"IsReadonly");function D0e(t){return io(t)&&t[pg]==="Optional"}s(D0e,"IsOptional");function Vz(t){return xn(t,"Any")&&ea(t.$id)}s(Vz,"IsAny");function jz(t){return xn(t,"Array")&&t.type==="array"&&ea(t.$id)&&Hn(t.items)&&va(t.minItems)&&va(t.maxItems)&&d5(t.uniqueItems)&&Uz(t.contains)&&va(t.minContains)&&va(t.maxContains)}s(jz,"IsArray");function $z(t){return xn(t,"AsyncIterator")&&t.type==="AsyncIterator"&&ea(t.$id)&&Hn(t.items)}s($z,"IsAsyncIterator");function Gz(t){return xn(t,"BigInt")&&t.type==="bigint"&&ea(t.$id)&&Y0(t.exclusiveMaximum)&&Y0(t.exclusiveMinimum)&&Y0(t.maximum)&&Y0(t.minimum)&&Y0(t.multipleOf)}s(Gz,"IsBigInt");function Hz(t){return xn(t,"Boolean")&&t.type==="boolean"&&ea(t.$id)}s(Hz,"IsBoolean");function qz(t){return xn(t,"Constructor")&&t.type==="Constructor"&&ea(t.$id)&&Ec(t.parameters)&&t.parameters.every(e=>Hn(e))&&Hn(t.returns)}s(qz,"IsConstructor");function Wz(t){return xn(t,"Date")&&t.type==="Date"&&ea(t.$id)&&va(t.exclusiveMaximumTimestamp)&&va(t.exclusiveMinimumTimestamp)&&va(t.maximumTimestamp)&&va(t.minimumTimestamp)&&va(t.multipleOfTimestamp)}s(Wz,"IsDate");function Xz(t){return xn(t,"Function")&&t.type==="Function"&&ea(t.$id)&&Ec(t.parameters)&&t.parameters.every(e=>Hn(e))&&Hn(t.returns)}s(Xz,"IsFunction");function Zz(t){return xn(t,"Integer")&&t.type==="integer"&&ea(t.$id)&&va(t.exclusiveMaximum)&&va(t.exclusiveMinimum)&&va(t.maximum)&&va(t.minimum)&&va(t.multipleOf)}s(Zz,"IsInteger");function f5(t){return io(t)&&Object.entries(t).every(([e,r])=>p5(e)&&Hn(r))}s(f5,"IsProperties");function Yz(t){return xn(t,"Intersect")&&!(Ko(t.type)&&t.type!=="object")&&Ec(t.allOf)&&t.allOf.every(e=>Hn(e)&&!no(e))&&ea(t.type)&&(d5(t.unevaluatedProperties)||Uz(t.unevaluatedProperties))&&ea(t.$id)}s(Yz,"IsIntersect");function Kz(t){return xn(t,"Iterator")&&t.type==="Iterator"&&ea(t.$id)&&Hn(t.items)}s(Kz,"IsIterator");function xn(t,e){return io(t)&&br in t&&t[br]===e}s(xn,"IsKindOf");function Jz(t){return Ax(t)&&Ko(t.const)}s(Jz,"IsLiteralString");function Qz(t){return Ax(t)&&vf(t.const)}s(Qz,"IsLiteralNumber");function R0e(t){return Ax(t)&&yx(t.const)}s(R0e,"IsLiteralBoolean");function Ax(t){return xn(t,"Literal")&&ea(t.$id)&&eU(t.const)}s(Ax,"IsLiteral");function eU(t){return yx(t)||vf(t)||Ko(t)}s(eU,"IsLiteralValue");function tU(t){return xn(t,"MappedKey")&&Ec(t.keys)&&t.keys.every(e=>vf(e)||Ko(e))}s(tU,"IsMappedKey");function rU(t){return xn(t,"MappedResult")&&f5(t.properties)}s(rU,"IsMappedResult");function iU(t){return xn(t,"Never")&&io(t.not)&&Object.getOwnPropertyNames(t.not).length===0}s(iU,"IsNever");function nU(t){return xn(t,"Not")&&Hn(t.not)}s(nU,"IsNot");function aU(t){return xn(t,"Null")&&t.type==="null"&&ea(t.$id)}s(aU,"IsNull");function oU(t){return xn(t,"Number")&&t.type==="number"&&ea(t.$id)&&va(t.exclusiveMaximum)&&va(t.exclusiveMinimum)&&va(t.maximum)&&va(t.minimum)&&va(t.multipleOf)}s(oU,"IsNumber");function sU(t){return xn(t,"Object")&&t.type==="object"&&ea(t.$id)&&f5(t.properties)&&zz(t.additionalProperties)&&va(t.minProperties)&&va(t.maxProperties)}s(sU,"IsObject");function lU(t){return xn(t,"Promise")&&t.type==="Promise"&&ea(t.$id)&&Hn(t.item)}s(lU,"IsPromise");function uU(t){return xn(t,"Record")&&t.type==="object"&&ea(t.$id)&&zz(t.additionalProperties)&&io(t.patternProperties)&&(e=>{let r=Object.getOwnPropertyNames(e.patternProperties);return r.length===1&&Bz(r[0])&&io(e.patternProperties)&&Hn(e.patternProperties[r[0]])})(t)}s(uU,"IsRecord");function O0e(t){return io(t)&&z_ in t&&t[z_]==="Recursive"}s(O0e,"IsRecursive");function cU(t){return xn(t,"Ref")&&ea(t.$id)&&Ko(t.$ref)}s(cU,"IsRef");function hU(t){return xn(t,"RegExp")&&ea(t.$id)&&Ko(t.source)&&Ko(t.flags)&&va(t.maxLength)&&va(t.minLength)}s(hU,"IsRegExp");function pU(t){return xn(t,"String")&&t.type==="string"&&ea(t.$id)&&va(t.minLength)&&va(t.maxLength)&&T0e(t.pattern)&&P0e(t.format)}s(pU,"IsString");function dU(t){return xn(t,"Symbol")&&t.type==="symbol"&&ea(t.$id)}s(dU,"IsSymbol");function fU(t){return xn(t,"TemplateLiteral")&&t.type==="string"&&Ko(t.pattern)&&t.pattern[0]==="^"&&t.pattern[t.pattern.length-1]==="$"}s(fU,"IsTemplateLiteral");function mU(t){return xn(t,"This")&&ea(t.$id)&&Ko(t.$ref)}s(mU,"IsThis");function no(t){return io(t)&&Du in t}s(no,"IsTransform");function gU(t){return xn(t,"Tuple")&&t.type==="array"&&ea(t.$id)&&vf(t.minItems)&&vf(t.maxItems)&&t.minItems===t.maxItems&&(ll(t.items)&&ll(t.additionalItems)&&t.minItems===0||Ec(t.items)&&t.items.every(e=>Hn(e)))}s(gU,"IsTuple");function iS(t){return xn(t,"Undefined")&&t.type==="undefined"&&ea(t.$id)}s(iS,"IsUndefined");function k0e(t){return m5(t)&&t.anyOf.every(e=>Jz(e)||Qz(e))}s(k0e,"IsUnionLiteral");function m5(t){return xn(t,"Union")&&ea(t.$id)&&io(t)&&Ec(t.anyOf)&&t.anyOf.every(e=>Hn(e))}s(m5,"IsUnion");function yU(t){return xn(t,"Uint8Array")&&t.type==="Uint8Array"&&ea(t.$id)&&va(t.minByteLength)&&va(t.maxByteLength)}s(yU,"IsUint8Array");function vU(t){return xn(t,"Unknown")&&ea(t.$id)}s(vU,"IsUnknown");function _U(t){return xn(t,"Unsafe")}s(_U,"IsUnsafe");function xU(t){return xn(t,"Void")&&t.type==="void"&&ea(t.$id)}s(xU,"IsVoid");function bU(t){return io(t)&&br in t&&Ko(t[br])&&!PXe.includes(t[br])}s(bU,"IsKind");function Hn(t){return io(t)&&(Vz(t)||jz(t)||Hz(t)||Gz(t)||$z(t)||qz(t)||Wz(t)||Xz(t)||Zz(t)||Yz(t)||Kz(t)||Ax(t)||tU(t)||rU(t)||iU(t)||nU(t)||aU(t)||oU(t)||sU(t)||lU(t)||uU(t)||cU(t)||hU(t)||pU(t)||dU(t)||fU(t)||mU(t)||gU(t)||iS(t)||m5(t)||yU(t)||vU(t)||_U(t)||xU(t)||bU(t))}s(Hn,"IsSchema");N();var LXe="(true|false)",HC="(0|[1-9][0-9]*)",N0e="(.*)",DXe="(?!.*)",U_="^".concat(HC,"$"),V_="^".concat(N0e,"$"),RXe="^".concat(DXe,"$");N();var _f={};Nl(_f,{Clear:()=>B0e,Delete:()=>z0e,Entries:()=>F0e,Get:()=>j0e,Has:()=>U0e,Set:()=>V0e});N();var Sx=new Map;function F0e(){return new Map(Sx)}s(F0e,"Entries");function B0e(){return Sx.clear()}s(B0e,"Clear");function z0e(t){return Sx.delete(t)}s(z0e,"Delete");function U0e(t){return Sx.has(t)}s(U0e,"Has");function V0e(t,e){Sx.set(t,e)}s(V0e,"Set");function j0e(t){return Sx.get(t)}s(j0e,"Get");var rh={};Nl(rh,{Clear:()=>G0e,Delete:()=>H0e,Entries:()=>$0e,Get:()=>X0e,Has:()=>q0e,Set:()=>W0e});N();var Mx=new Map;function $0e(){return new Map(Mx)}s($0e,"Entries");function G0e(){return Mx.clear()}s(G0e,"Clear");function H0e(t){return Mx.delete(t)}s(H0e,"Delete");function q0e(t){return Mx.has(t)}s(q0e,"Has");function W0e(t,e){Mx.set(t,e)}s(W0e,"Set");function X0e(t){return Mx.get(t)}s(X0e,"Get");N();function Z0e(t,e){return t.includes(e)}s(Z0e,"SetIncludes");function Y0e(t){return[...new Set(t)]}s(Y0e,"SetDistinct");function K0e(t,e){return t.filter(r=>e.includes(r))}s(K0e,"SetIntersect");function J0e(t,e){return t.reduce((r,i)=>K0e(r,i),e)}s(J0e,"SetIntersectManyResolve");function Q0e(t){return t.length===1?t[0]:t.length>1?J0e(t.slice(1),t[0]):[]}s(Q0e,"SetIntersectMany");function e1e(t){let e=[];for(let r of t)e.push(...r);return e}s(e1e,"SetUnionMany");N();function j_(t){return ii({[br]:"Any"},t)}s(j_,"Any");N();function wU(t,e){return ii({[br]:"Array",type:"array",items:t},e)}s(wU,"Array");N();function AU(t,e){return ii({[br]:"AsyncIterator",type:"AsyncIterator",items:t},e)}s(AU,"AsyncIterator");N();N();N();function t1e(t,e){let r=t,{[e]:i}=r;return Nh(r,[JX(e)])}s(t1e,"DiscardKey");function Ac(t,e){return e.reduce((r,i)=>t1e(r,i),t)}s(Ac,"Discard");N();function cl(t){return ii({[br]:"Never",not:{}},t)}s(cl,"Never");N();N();function qs(t){return ii({[br]:"MappedResult",properties:t})}s(qs,"MappedResult");N();N();function SU(t,e,r){return ii({[br]:"Constructor",type:"Constructor",parameters:t,returns:e},r)}s(SU,"Constructor");N();function nS(t,e,r){return ii({[br]:"Function",type:"Function",parameters:t,returns:e},r)}s(nS,"Function");N();N();N();N();function mT(t,e){return ii({[br]:"Union",anyOf:t},e)}s(mT,"UnionCreate");function r1e(t){return t.some(e=>vv(e))}s(r1e,"IsUnionOptional");function Lk(t){return t.map(e=>vv(e)?i1e(e):e)}s(Lk,"RemoveOptionalFromRest");function i1e(t){return Ac(t,[pg])}s(i1e,"RemoveOptionalFromType");function n1e(t,e){return r1e(t)?gg(mT(Lk(t),e)):mT(Lk(t),e)}s(n1e,"ResolveUnion");function bv(t,e){return t.length===0?cl(e):t.length===1?ii(t[0],e):n1e(t,e)}s(bv,"UnionEvaluated");N();function Bl(t,e){return t.length===0?cl(e):t.length===1?ii(t[0],e):mT(t,e)}s(Bl,"Union");N();N();N();var a1e=class extends Ia{};s(a1e,"TemplateLiteralParserError");var OW=a1e;function o1e(t){return t.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}s(o1e,"Unescape");function g5(t,e,r){return t[e]===r&&t.charCodeAt(e-1)!==92}s(g5,"IsNonEscaped");function $p(t,e){return g5(t,e,"(")}s($p,"IsOpenParen");function $_(t,e){return g5(t,e,")")}s($_,"IsCloseParen");function MU(t,e){return g5(t,e,"|")}s(MU,"IsSeparator");function s1e(t){if(!($p(t,0)&&$_(t,t.length-1)))return!1;let e=0;for(let r=0;r<t.length;r++)if($p(t,r)&&(e+=1),$_(t,r)&&(e-=1),e===0&&r!==t.length-1)return!1;return!0}s(s1e,"IsGroup");function l1e(t){return t.slice(1,t.length-1)}s(l1e,"InGroup");function u1e(t){let e=0;for(let r=0;r<t.length;r++)if($p(t,r)&&(e+=1),$_(t,r)&&(e-=1),MU(t,r)&&e===0)return!0;return!1}s(u1e,"IsPrecedenceOr");function c1e(t){for(let e=0;e<t.length;e++)if($p(t,e))return!0;return!1}s(c1e,"IsPrecedenceAnd");function h1e(t){let[e,r]=[0,0],i=[];for(let a=0;a<t.length;a++)if($p(t,a)&&(e+=1),$_(t,a)&&(e-=1),MU(t,a)&&e===0){let o=t.slice(r,a);o.length>0&&i.push(Qy(o)),r=a+1}let n=t.slice(r);return n.length>0&&i.push(Qy(n)),i.length===0?{type:"const",const:""}:i.length===1?i[0]:{type:"or",expr:i}}s(h1e,"Or");function p1e(t){function e(n,a){if(!$p(n,a))throw new OW("TemplateLiteralParser: Index must point to open parens");let o=0;for(let l=a;l<n.length;l++)if($p(n,l)&&(o+=1),$_(n,l)&&(o-=1),o===0)return[a,l];throw new OW("TemplateLiteralParser: Unclosed group parens in expression")}s(e,"Group");function r(n,a){for(let o=a;o<n.length;o++)if($p(n,o))return[a,o];return[a,n.length]}s(r,"Range");let i=[];for(let n=0;n<t.length;n++)if($p(t,n)){let[a,o]=e(t,n),l=t.slice(a,o+1);i.push(Qy(l)),n=o}else{let[a,o]=r(t,n),l=t.slice(a,o);l.length>0&&i.push(Qy(l)),n=o-1}return i.length===0?{type:"const",const:""}:i.length===1?i[0]:{type:"and",expr:i}}s(p1e,"And");function Qy(t){return s1e(t)?Qy(l1e(t)):u1e(t)?h1e(t):c1e(t)?p1e(t):{type:"const",const:o1e(t)}}s(Qy,"TemplateLiteralParse");function y5(t){return Qy(t.slice(1,t.length-1))}s(y5,"TemplateLiteralParseExact");var d1e=class extends Ia{};s(d1e,"TemplateLiteralFiniteError");var OXe=d1e;function f1e(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="0"&&t.expr[1].type==="const"&&t.expr[1].const==="[1-9][0-9]*"}s(f1e,"IsNumberExpression");function m1e(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="true"&&t.expr[1].type==="const"&&t.expr[1].const==="false"}s(m1e,"IsBooleanExpression");function g1e(t){return t.type==="const"&&t.const===".*"}s(g1e,"IsStringExpression");function G_(t){return f1e(t)||g1e(t)?!1:m1e(t)?!0:t.type==="and"?t.expr.every(e=>G_(e)):t.type==="or"?t.expr.every(e=>G_(e)):t.type==="const"?!0:(()=>{throw new OXe("Unknown expression type")})()}s(G_,"IsTemplateLiteralExpressionFinite");function EU(t){let e=y5(t.pattern);return G_(e)}s(EU,"IsTemplateLiteralFinite");N();var y1e=class extends Ia{};s(y1e,"TemplateLiteralGenerateError");var kXe=y1e;function*CU(t){if(t.length===1)return yield*vr(t[0]);for(let e of t[0])for(let r of CU(t.slice(1)))yield"".concat(e).concat(r)}s(CU,"GenerateReduce");function*v1e(t){return yield*vr(CU(t.expr.map(e=>[...aS(e)])))}s(v1e,"GenerateAnd");function*_1e(t){for(let e of t.expr)yield*vr(aS(e))}s(_1e,"GenerateOr");function*x1e(t){return yield t.const}s(x1e,"GenerateConst");function*aS(t){return t.type==="and"?yield*vr(v1e(t)):t.type==="or"?yield*vr(_1e(t)):t.type==="const"?yield*vr(x1e(t)):(()=>{throw new kXe("Unknown expression")})()}s(aS,"TemplateLiteralExpressionGenerate");function v5(t){let e=y5(t.pattern);return G_(e)?[...aS(e)]:[]}s(v5,"TemplateLiteralGenerate");N();N();function Po(t,e){return ii({[br]:"Literal",const:t,type:typeof t},e)}s(Po,"Literal");N();function IU(t){return ii({[br]:"Boolean",type:"boolean"},t)}s(IU,"Boolean");N();function _5(t){return ii({[br]:"BigInt",type:"bigint"},t)}s(_5,"BigInt");N();function wv(t){return ii({[br]:"Number",type:"number"},t)}s(wv,"Number");N();function xf(t){return ii({[br]:"String",type:"string"},t)}s(xf,"String");function*b1e(t){let e=t.trim().replace(/"|'/g,"");return e==="boolean"?yield IU():e==="number"?yield wv():e==="bigint"?yield _5():e==="string"?yield xf():yield(()=>{let r=e.split("|").map(i=>Po(i.trim()));return r.length===0?cl():r.length===1?r[0]:bv(r)})()}s(b1e,"FromUnion");function*w1e(t){if(t[1]!=="{"){let e=Po("$"),r=gT(t.slice(1));return yield*vr([e,...r])}for(let e=2;e<t.length;e++)if(t[e]==="}"){let r=b1e(t.slice(2,e)),i=gT(t.slice(e+1));return yield*vr([...r,...i])}yield Po(t)}s(w1e,"FromTerminal");function*gT(t){for(let e=0;e<t.length;e++)if(t[e]==="$"){let r=Po(t.slice(0,e)),i=w1e(t.slice(e));return yield*vr([r,...i])}yield Po(t)}s(gT,"FromSyntax");function A1e(t){return[...gT(t)]}s(A1e,"TemplateLiteralSyntax");N();var S1e=class extends Ia{};s(S1e,"TemplateLiteralPatternError");var NXe=S1e;function M1e(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}s(M1e,"Escape");function TU(t,e){return fg(t)?t.pattern.slice(1,t.pattern.length-1):Hs(t)?"(".concat(t.anyOf.map(r=>TU(r,e)).join("|"),")"):tS(t)||eS(t)||Rz(t)?"".concat(e).concat(HC):c5(t)?"".concat(e).concat(N0e):bx(t)?"".concat(e).concat(M1e(t.const.toString())):Oz(t)?"".concat(e).concat(LXe):(()=>{throw new NXe("Unexpected Kind '".concat(t[br],"'"))})()}s(TU,"Visit");function Dk(t){return"^".concat(t.map(e=>TU(e,"")).join(""),"$")}s(Dk,"TemplateLiteralPattern");N();function Gw(t){let e=v5(t).map(r=>Po(r));return bv(e)}s(Gw,"TemplateLiteralToUnion");N();function PU(t,e){let r=Ko(t)?Dk(A1e(t)):Dk(t);return ii({[br]:"TemplateLiteral",type:"string",pattern:r},e)}s(PU,"TemplateLiteral");function E1e(t){return v5(t).map(e=>e.toString())}s(E1e,"FromTemplateLiteral");function C1e(t){let e=[];for(let r of t)e.push(...Cf(r));return e}s(C1e,"FromUnion");function I1e(t){return[t.toString()]}s(I1e,"FromLiteral");function Cf(t){return[...new Set(fg(t)?E1e(t):Hs(t)?C1e(t.anyOf):bx(t)?I1e(t.const):tS(t)?["[number]"]:eS(t)?["[number]"]:[])]}s(Cf,"IndexPropertyKeys");N();function T1e(t,e,r){let i={};for(let n of Object.getOwnPropertyNames(e))i[n]=b5(t,Cf(e[n]),r);return i}s(T1e,"FromProperties");function P1e(t,e,r){return T1e(t,e.properties,r)}s(P1e,"FromMappedResult");function L1e(t,e,r){let i=P1e(t,e,r);return qs(i)}s(L1e,"IndexFromMappedResult");function LU(t,e){return t.map(r=>DU(r,e))}s(LU,"FromRest");function D1e(t){return t.filter(e=>!wx(e))}s(D1e,"FromIntersectRest");function R1e(t,e){return NU(D1e(LU(t,e)))}s(R1e,"FromIntersect");function O1e(t){return t.some(e=>wx(e))?[]:t}s(O1e,"FromUnionRest");function k1e(t,e){return bv(O1e(LU(t,e)))}s(k1e,"FromUnion");function N1e(t,e){return e in t?t[e]:e==="[number]"?bv(t):cl()}s(N1e,"FromTuple");function F1e(t,e){return e==="[number]"?t:cl()}s(F1e,"FromArray");function B1e(t,e){return e in t?t[e]:cl()}s(B1e,"FromProperty");function DU(t,e){var r;return oh(t)?R1e(t.allOf,e):Hs(t)?k1e(t.anyOf,e):_v(t)?N1e((r=t.items)!=null?r:[],e):xx(t)?F1e(t.items,e):Jh(t)?B1e(t.properties,e):cl()}s(DU,"IndexFromPropertyKey");function x5(t,e){return e.map(r=>DU(t,r))}s(x5,"IndexFromPropertyKeys");function Rk(t,e){return bv(x5(t,e))}s(Rk,"FromSchema");function b5(t,e,r){return qu(e)?L1e(t,e,r):dg(e)?j1e(t,e,r):ii(Jy(e)?Rk(t,Cf(e)):Rk(t,e),r)}s(b5,"Index");function z1e(t,e,r){return{[e]:b5(t,[e],Bu(r))}}s(z1e,"MappedIndexPropertyKey");function U1e(t,e,r){return e.reduce((i,n)=>Ee(Ee({},i),z1e(t,n,r)),{})}s(U1e,"MappedIndexPropertyKeys");function V1e(t,e,r){return U1e(t,e.keys,r)}s(V1e,"MappedIndexProperties");function j1e(t,e,r){let i=V1e(t,e,r);return qs(i)}s(j1e,"IndexFromMappedKey");N();function RU(t,e){return ii({[br]:"Iterator",type:"Iterator",items:t},e)}s(RU,"Iterator");N();function $1e(t){let e=[];for(let r in t)vv(t[r])||e.push(r);return e}s($1e,"RequiredKeys");function G1e(t,e){let r=$1e(t),i=r.length>0?{[br]:"Object",type:"object",properties:t,required:r}:{[br]:"Object",type:"object",properties:t};return ii(i,e)}s(G1e,"_Object");var $s=G1e;N();function OU(t,e){return ii({[br]:"Promise",type:"Promise",item:t},e)}s(OU,"Promise");N();N();function H1e(t){return ii(Ac(t,[QA]))}s(H1e,"RemoveReadonly");function q1e(t){return ii(vt(Ee({},t),{[QA]:"Readonly"}))}s(q1e,"AddReadonly");function W1e(t,e){return e===!1?H1e(t):q1e(t)}s(W1e,"ReadonlyWithFlag");function mg(t,e){let r=e??!0;return qu(t)?Y1e(t,r):W1e(t,r)}s(mg,"Readonly");function X1e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=mg(t[i],e);return r}s(X1e,"FromProperties");function Z1e(t,e){return X1e(t.properties,e)}s(Z1e,"FromMappedResult");function Y1e(t,e){let r=Z1e(t,e);return qs(r)}s(Y1e,"ReadonlyFromMappedResult");N();function Ex(t,e){return ii(t.length>0?{[br]:"Tuple",type:"array",items:t,additionalItems:!1,minItems:t.length,maxItems:t.length}:{[br]:"Tuple",type:"array",minItems:t.length,maxItems:t.length},e)}s(Ex,"Tuple");function kU(t,e){return t in e?pc(t,e[t]):qs(e)}s(kU,"FromMappedResult");function K1e(t){return{[t]:Po(t)}}s(K1e,"MappedKeyToKnownMappedResultProperties");function J1e(t){let e={};for(let r of t)e[r]=Po(r);return e}s(J1e,"MappedKeyToUnknownMappedResultProperties");function Q1e(t,e){return Z0e(e,t)?K1e(t):J1e(e)}s(Q1e,"MappedKeyToMappedResultProperties");function e_e(t,e){let r=Q1e(t,e);return kU(t,r)}s(e_e,"FromMappedKey");function K0(t,e){return e.map(r=>pc(t,r))}s(K0,"FromRest");function t_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(e))r[i]=pc(t,e[i]);return r}s(t_e,"FromProperties");function pc(t,e){var r;let i=Ee({},e);return vv(e)?gg(pc(t,Ac(e,[pg]))):y0e(e)?mg(pc(t,Ac(e,[QA]))):qu(e)?kU(t,e.properties):dg(e)?e_e(t,e.keys):s5(e)?SU(K0(t,e.parameters),pc(t,e.returns),i):l5(e)?nS(K0(t,e.parameters),pc(t,e.returns),i):o5(e)?AU(pc(t,e.items),i):u5(e)?RU(pc(t,e.items),i):oh(e)?yg(K0(t,e.allOf),i):Hs(e)?Bl(K0(t,e.anyOf),i):_v(e)?Ex(K0(t,(r=e.items)!=null?r:[]),i):Jh(e)?$s(t_e(t,e.properties),i):xx(e)?wU(pc(t,e.items),i):rS(e)?OU(pc(t,e.item),i):e}s(pc,"FromSchemaType");function r_e(t,e){let r={};for(let i of t)r[i]=pc(i,e);return r}s(r_e,"MappedFunctionReturnType");function i_e(t,e,r){let i=Jy(t)?Cf(t):t,n=e({[br]:"MappedKey",keys:i}),a=r_e(i,n);return $s(a,r)}s(i_e,"Mapped");N();function n_e(t){return ii(Ac(t,[pg]))}s(n_e,"RemoveOptional");function a_e(t){return ii(vt(Ee({},t),{[pg]:"Optional"}))}s(a_e,"AddOptional");function o_e(t,e){return e===!1?n_e(t):a_e(t)}s(o_e,"OptionalWithFlag");function gg(t,e){let r=e??!0;return qu(t)?u_e(t,r):o_e(t,r)}s(gg,"Optional");function s_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=gg(t[i],e);return r}s(s_e,"FromProperties");function l_e(t,e){return s_e(t.properties,e)}s(l_e,"FromMappedResult");function u_e(t,e){let r=l_e(t,e);return qs(r)}s(u_e,"OptionalFromMappedResult");N();function yT(t,e={}){let r=t.every(n=>Jh(n)),i=Jy(e.unevaluatedProperties)?{unevaluatedProperties:e.unevaluatedProperties}:{};return ii(e.unevaluatedProperties===!1||Jy(e.unevaluatedProperties)||r?vt(Ee({},i),{[br]:"Intersect",type:"object",allOf:t}):vt(Ee({},i),{[br]:"Intersect",allOf:t}),e)}s(yT,"IntersectCreate");function c_e(t){return t.every(e=>vv(e))}s(c_e,"IsIntersectOptional");function h_e(t){return Ac(t,[pg])}s(h_e,"RemoveOptionalFromType");function Ok(t){return t.map(e=>vv(e)?h_e(e):e)}s(Ok,"RemoveOptionalFromRest");function p_e(t,e){return c_e(t)?gg(yT(Ok(t),e)):yT(Ok(t),e)}s(p_e,"ResolveIntersect");function NU(t,e={}){if(t.length===0)return cl(e);if(t.length===1)return ii(t[0],e);if(t.some(r=>h5(r)))throw new Error("Cannot intersect transform types");return p_e(t,e)}s(NU,"IntersectEvaluated");N();function yg(t,e){if(t.length===0)return cl(e);if(t.length===1)return ii(t[0],e);if(t.some(r=>h5(r)))throw new Error("Cannot intersect transform types");return yT(t,e)}s(yg,"Intersect");function FU(t){return t.map(e=>w5(e))}s(FU,"FromRest");function d_e(t){return yg(FU(t))}s(d_e,"FromIntersect");function f_e(t){return Bl(FU(t))}s(f_e,"FromUnion");function m_e(t){return w5(t)}s(m_e,"FromPromise");function w5(t){return oh(t)?d_e(t.allOf):Hs(t)?f_e(t.anyOf):rS(t)?m_e(t.item):t}s(w5,"AwaitedResolve");function g_e(t,e){return ii(w5(t),e)}s(g_e,"Awaited");N();N();N();N();function BU(t){let e=[];for(let r of t)e.push(Qh(r));return e}s(BU,"FromRest");function y_e(t){let e=BU(t);return e1e(e)}s(y_e,"FromIntersect");function v_e(t){let e=BU(t);return Q0e(e)}s(v_e,"FromUnion");function __e(t){return t.map((e,r)=>r.toString())}s(__e,"FromTuple");function x_e(t){return["[number]"]}s(x_e,"FromArray");function b_e(t){return globalThis.Object.getOwnPropertyNames(t)}s(b_e,"FromProperties");function w_e(t){return kk?globalThis.Object.getOwnPropertyNames(t).map(e=>e[0]==="^"&&e[e.length-1]==="$"?e.slice(1,e.length-1):e):[]}s(w_e,"FromPatternProperties");function Qh(t){var e;return oh(t)?y_e(t.allOf):Hs(t)?v_e(t.anyOf):_v(t)?__e((e=t.items)!=null?e:[]):xx(t)?x_e(t.items):Jh(t)?b_e(t.properties):kz(t)?w_e(t.patternProperties):[]}s(Qh,"KeyOfPropertyKeys");var kk=!1;function ev(t){kk=!0;let e=Qh(t);kk=!1;let r=e.map(i=>"(".concat(i,")"));return"^(".concat(r.join("|"),")$")}s(ev,"KeyOfPattern");function A_e(t){return t.map(e=>e==="[number]"?wv():Po(e))}s(A_e,"KeyOfPropertyKeysToRest");function zU(t,e){if(qu(t))return E_e(t,e);{let r=Qh(t),i=A_e(r),n=bv(i);return ii(n,e)}}s(zU,"KeyOf");function S_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=zU(t[i],Bu(e));return r}s(S_e,"FromProperties");function M_e(t,e){return S_e(t.properties,e)}s(M_e,"FromMappedResult");function E_e(t,e){let r=M_e(t,e);return qs(r)}s(E_e,"KeyOfFromMappedResult");N();function oS(t){let e=Qh(t),r=x5(t,e);return e.map((i,n)=>[e[n],r[n]])}s(oS,"KeyOfPropertyEntries");function C_e(t){let e=[];for(let r of t)e.push(...Qh(r));return Y0e(e)}s(C_e,"CompositeKeys");function I_e(t){return t.filter(e=>!wx(e))}s(I_e,"FilterNever");function T_e(t,e){let r=[];for(let i of t)r.push(...x5(i,[e]));return I_e(r)}s(T_e,"CompositeProperty");function P_e(t,e){let r={};for(let i of e)r[i]=NU(T_e(t,i));return r}s(P_e,"CompositeProperties");function L_e(t,e){let r=C_e(t),i=P_e(t,r);return $s(i,e)}s(L_e,"Composite");N();N();function UU(t){return ii({[br]:"Date",type:"Date"},t)}s(UU,"Date");N();function VU(t){return ii({[br]:"Null",type:"null"},t)}s(VU,"Null");N();function jU(t){return ii({[br]:"Symbol",type:"symbol"},t)}s(jU,"Symbol");N();function $U(t){return ii({[br]:"Undefined",type:"undefined"},t)}s($U,"Undefined");N();function GU(t){return ii({[br]:"Uint8Array",type:"Uint8Array"},t)}s(GU,"Uint8Array");N();function Cx(t){return ii({[br]:"Unknown"},t)}s(Cx,"Unknown");function D_e(t){return t.map(e=>A5(e,!1))}s(D_e,"FromArray");function R_e(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=mg(A5(t[r],!1));return e}s(R_e,"FromProperties");function C2(t,e){return e===!0?t:mg(t)}s(C2,"ConditionalReadonly");function A5(t,e){return wz(t)||Sz(t)?C2(j_(),e):Ec(t)?mg(Ex(D_e(t))):gv(t)?GU():KA(t)?UU():io(t)?C2($s(R_e(t)),e):Az(t)?C2(nS([],Cx()),e):ll(t)?$U():Mz(t)?VU():Ez(t)?jU():r5(t)?_5():vf(t)||yx(t)||Ko(t)?Po(t):$s({})}s(A5,"FromValue");function O_e(t,e){return ii(A5(t,!0),e)}s(O_e,"Const");N();function k_e(t,e){return Ex(t.parameters,e)}s(k_e,"ConstructorParameters");N();function Ix(t,e){return t.map(r=>ep(r,e))}s(Ix,"FromRest");function N_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=ep(t[i],e);return r}s(N_e,"FromProperties");function F_e(t,e){return t.parameters=Ix(t.parameters,e),t.returns=ep(t.returns,e),t}s(F_e,"FromConstructor");function B_e(t,e){return t.parameters=Ix(t.parameters,e),t.returns=ep(t.returns,e),t}s(B_e,"FromFunction");function z_e(t,e){return t.allOf=Ix(t.allOf,e),t}s(z_e,"FromIntersect");function U_e(t,e){return t.anyOf=Ix(t.anyOf,e),t}s(U_e,"FromUnion");function V_e(t,e){return ll(t.items)||(t.items=Ix(t.items,e)),t}s(V_e,"FromTuple");function j_e(t,e){return t.items=ep(t.items,e),t}s(j_e,"FromArray");function $_e(t,e){return t.properties=N_e(t.properties,e),t}s($_e,"FromObject");function G_e(t,e){return t.item=ep(t.item,e),t}s(G_e,"FromPromise");function H_e(t,e){return t.items=ep(t.items,e),t}s(H_e,"FromAsyncIterator");function q_e(t,e){return t.items=ep(t.items,e),t}s(q_e,"FromIterator");function W_e(t,e){let r=e.find(n=>n.$id===t.$ref);if(r===void 0)throw Error("Unable to dereference schema with $id ".concat(t.$ref));let i=Ac(r,["$id"]);return ep(i,e)}s(W_e,"FromRef");function X_e(t,e){return s5(t)?F_e(t,e):l5(t)?B_e(t,e):oh(t)?z_e(t,e):Hs(t)?U_e(t,e):_v(t)?V_e(t,e):xx(t)?j_e(t,e):Jh(t)?$_e(t,e):rS(t)?G_e(t,e):o5(t)?H_e(t,e):u5(t)?q_e(t,e):Nz(t)?W_e(t,e):t}s(X_e,"DerefResolve");function ep(t,e){return X_e(n5(t),h0e(e))}s(ep,"Deref");N();function Z_e(t,e){if(ll(t))throw new Error("Enum undefined or empty");let r=globalThis.Object.getOwnPropertyNames(t).filter(n=>isNaN(n)).map(n=>t[n]),i=[...new Set(r)].map(n=>Po(n));return Bl(i,vt(Ee({},e),{[z_]:"Enum"}))}s(Z_e,"Enum");N();N();N();var Y_e=class extends Ia{};s(Y_e,"ExtendsResolverError");var FXe=Y_e,Zt;(function(t){t[t.Union=0]="Union",t[t.True=1]="True",t[t.False=2]="False"})(Zt||(Zt={}));function Sc(t){return t===Zt.False?t:Zt.True}s(Sc,"IntoBooleanResult");function Av(t){throw new FXe(t)}s(Av,"Throw");function Jo(t){return it.IsNever(t)||it.IsIntersect(t)||it.IsUnion(t)||it.IsUnknown(t)||it.IsAny(t)}s(Jo,"IsStructuralRight");function Qo(t,e){return it.IsNever(e)?WU():it.IsIntersect(e)?sS(t,e):it.IsUnion(e)?M5(t,e):it.IsUnknown(e)?KU():it.IsAny(e)?S5():Av("StructuralRight")}s(Qo,"StructuralRight");function S5(t,e){return Zt.True}s(S5,"FromAnyRight");function K_e(t,e){return it.IsIntersect(e)?sS(t,e):it.IsUnion(e)&&e.anyOf.some(r=>it.IsAny(r)||it.IsUnknown(r))?Zt.True:it.IsUnion(e)?Zt.Union:it.IsUnknown(e)||it.IsAny(e)?Zt.True:Zt.Union}s(K_e,"FromAny");function J_e(t,e){return it.IsUnknown(t)?Zt.False:it.IsAny(t)?Zt.Union:it.IsNever(t)?Zt.True:Zt.False}s(J_e,"FromArrayRight");function Q_e(t,e){return it.IsObject(e)&&lS(e)?Zt.True:Jo(e)?Qo(t,e):it.IsArray(e)?Sc(xa(t.items,e.items)):Zt.False}s(Q_e,"FromArray");function exe(t,e){return Jo(e)?Qo(t,e):it.IsAsyncIterator(e)?Sc(xa(t.items,e.items)):Zt.False}s(exe,"FromAsyncIterator");function txe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsBigInt(e)?Zt.True:Zt.False}s(txe,"FromBigInt");function HU(t,e){return it.IsLiteralBoolean(t)||it.IsBoolean(t)?Zt.True:Zt.False}s(HU,"FromBooleanRight");function rxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsBoolean(e)?Zt.True:Zt.False}s(rxe,"FromBoolean");function ixe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsConstructor(e)?t.parameters.length>e.parameters.length?Zt.False:t.parameters.every((r,i)=>Sc(xa(e.parameters[i],r))===Zt.True)?Sc(xa(t.returns,e.returns)):Zt.False:Zt.False}s(ixe,"FromConstructor");function nxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsDate(e)?Zt.True:Zt.False}s(nxe,"FromDate");function axe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsFunction(e)?t.parameters.length>e.parameters.length?Zt.False:t.parameters.every((r,i)=>Sc(xa(e.parameters[i],r))===Zt.True)?Sc(xa(t.returns,e.returns)):Zt.False:Zt.False}s(axe,"FromFunction");function qU(t,e){return it.IsLiteral(t)&&ja.IsNumber(t.const)||it.IsNumber(t)||it.IsInteger(t)?Zt.True:Zt.False}s(qU,"FromIntegerRight");function oxe(t,e){return it.IsInteger(e)||it.IsNumber(e)?Zt.True:Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):Zt.False}s(oxe,"FromInteger");function sS(t,e){return e.allOf.every(r=>xa(t,r)===Zt.True)?Zt.True:Zt.False}s(sS,"FromIntersectRight");function sxe(t,e){return t.allOf.some(r=>xa(r,e)===Zt.True)?Zt.True:Zt.False}s(sxe,"FromIntersect");function lxe(t,e){return Jo(e)?Qo(t,e):it.IsIterator(e)?Sc(xa(t.items,e.items)):Zt.False}s(lxe,"FromIterator");function uxe(t,e){return it.IsLiteral(e)&&e.const===t.const?Zt.True:Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsString(e)?YU(t):it.IsNumber(e)?XU(t):it.IsInteger(e)?qU(t):it.IsBoolean(e)?HU(t):Zt.False}s(uxe,"FromLiteral");function WU(t,e){return Zt.False}s(WU,"FromNeverRight");function cxe(t,e){return Zt.True}s(cxe,"FromNever");function Nk(t){let[e,r]=[t,0];for(;it.IsNot(e);)e=e.not,r+=1;return r%2===0?e:Cx()}s(Nk,"UnwrapTNot");function hxe(t,e){return it.IsNot(t)?xa(Nk(t),e):it.IsNot(e)?xa(t,Nk(e)):Av("Invalid fallthrough for Not")}s(hxe,"FromNot");function pxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsNull(e)?Zt.True:Zt.False}s(pxe,"FromNull");function XU(t,e){return it.IsLiteralNumber(t)||it.IsNumber(t)||it.IsInteger(t)?Zt.True:Zt.False}s(XU,"FromNumberRight");function dxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsInteger(e)||it.IsNumber(e)?Zt.True:Zt.False}s(dxe,"FromNumber");function iu(t,e){return Object.getOwnPropertyNames(t.properties).length===e}s(iu,"IsObjectPropertyCount");function Fk(t){return lS(t)}s(Fk,"IsObjectStringLike");function Bk(t){return iu(t,0)||iu(t,1)&&"description"in t.properties&&it.IsUnion(t.properties.description)&&t.properties.description.anyOf.length===2&&(it.IsString(t.properties.description.anyOf[0])&&it.IsUndefined(t.properties.description.anyOf[1])||it.IsString(t.properties.description.anyOf[1])&&it.IsUndefined(t.properties.description.anyOf[0]))}s(Bk,"IsObjectSymbolLike");function qC(t){return iu(t,0)}s(qC,"IsObjectNumberLike");function zk(t){return iu(t,0)}s(zk,"IsObjectBooleanLike");function fxe(t){return iu(t,0)}s(fxe,"IsObjectBigIntLike");function mxe(t){return iu(t,0)}s(mxe,"IsObjectDateLike");function gxe(t){return lS(t)}s(gxe,"IsObjectUint8ArrayLike");function yxe(t){let e=wv();return iu(t,0)||iu(t,1)&&"length"in t.properties&&Sc(xa(t.properties.length,e))===Zt.True}s(yxe,"IsObjectFunctionLike");function vxe(t){return iu(t,0)}s(vxe,"IsObjectConstructorLike");function lS(t){let e=wv();return iu(t,0)||iu(t,1)&&"length"in t.properties&&Sc(xa(t.properties.length,e))===Zt.True}s(lS,"IsObjectArrayLike");function _xe(t){let e=nS([j_()],j_());return iu(t,0)||iu(t,1)&&"then"in t.properties&&Sc(xa(t.properties.then,e))===Zt.True}s(_xe,"IsObjectPromiseLike");function ZU(t,e){return xa(t,e)===Zt.False||it.IsOptional(t)&&!it.IsOptional(e)?Zt.False:Zt.True}s(ZU,"Property");function hl(t,e){return it.IsUnknown(t)?Zt.False:it.IsAny(t)?Zt.Union:it.IsNever(t)||it.IsLiteralString(t)&&Fk(e)||it.IsLiteralNumber(t)&&qC(e)||it.IsLiteralBoolean(t)&&zk(e)||it.IsSymbol(t)&&Bk(e)||it.IsBigInt(t)&&fxe(e)||it.IsString(t)&&Fk(e)||it.IsSymbol(t)&&Bk(e)||it.IsNumber(t)&&qC(e)||it.IsInteger(t)&&qC(e)||it.IsBoolean(t)&&zk(e)||it.IsUint8Array(t)&&gxe(e)||it.IsDate(t)&&mxe(e)||it.IsConstructor(t)&&vxe(e)||it.IsFunction(t)&&yxe(e)?Zt.True:it.IsRecord(t)&&it.IsString(vT(t))?e[z_]==="Record"?Zt.True:Zt.False:it.IsRecord(t)&&it.IsNumber(vT(t))&&iu(e,0)?Zt.True:Zt.False}s(hl,"FromObjectRight");function xxe(t,e){return Jo(e)?Qo(t,e):it.IsRecord(e)?Cc(t,e):it.IsObject(e)?(()=>{for(let r of Object.getOwnPropertyNames(e.properties)){if(!(r in t.properties)&&!it.IsOptional(e.properties[r]))return Zt.False;if(it.IsOptional(e.properties[r]))return Zt.True;if(ZU(t.properties[r],e.properties[r])===Zt.False)return Zt.False}return Zt.True})():Zt.False}s(xxe,"FromObject");function bxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)&&_xe(e)?Zt.True:it.IsPromise(e)?Sc(xa(t.item,e.item)):Zt.False}s(bxe,"FromPromise");function vT(t){return U_ in t.patternProperties?wv():V_ in t.patternProperties?xf():Av("Unknown record key pattern")}s(vT,"RecordKey");function _T(t){return U_ in t.patternProperties?t.patternProperties[U_]:V_ in t.patternProperties?t.patternProperties[V_]:Av("Unable to get record value schema")}s(_T,"RecordValue");function Cc(t,e){let[r,i]=[vT(e),_T(e)];return it.IsLiteralString(t)&&it.IsNumber(r)&&Sc(xa(t,i))===Zt.True?Zt.True:it.IsUint8Array(t)&&it.IsNumber(r)||it.IsString(t)&&it.IsNumber(r)||it.IsArray(t)&&it.IsNumber(r)?xa(t,i):it.IsObject(t)?(()=>{for(let n of Object.getOwnPropertyNames(t.properties))if(ZU(i,t.properties[n])===Zt.False)return Zt.False;return Zt.True})():Zt.False}s(Cc,"FromRecordRight");function wxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?xa(_T(t),_T(e)):Zt.False}s(wxe,"FromRecord");function Axe(t,e){let r=it.IsRegExp(t)?xf():t,i=it.IsRegExp(e)?xf():e;return xa(r,i)}s(Axe,"FromRegExp");function YU(t,e){return it.IsLiteral(t)&&ja.IsString(t.const)||it.IsString(t)?Zt.True:Zt.False}s(YU,"FromStringRight");function Sxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsString(e)?Zt.True:Zt.False}s(Sxe,"FromString");function Mxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsSymbol(e)?Zt.True:Zt.False}s(Mxe,"FromSymbol");function Exe(t,e){return it.IsTemplateLiteral(t)?xa(Gw(t),e):it.IsTemplateLiteral(e)?xa(t,Gw(e)):Av("Invalid fallthrough for TemplateLiteral")}s(Exe,"FromTemplateLiteral");function Cxe(t,e){return it.IsArray(e)&&t.items!==void 0&&t.items.every(r=>xa(r,e.items)===Zt.True)}s(Cxe,"IsArrayOfTuple");function Ixe(t,e){return it.IsNever(t)?Zt.True:it.IsUnknown(t)?Zt.False:it.IsAny(t)?Zt.Union:Zt.False}s(Ixe,"FromTupleRight");function Txe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)&&lS(e)||it.IsArray(e)&&Cxe(t,e)?Zt.True:it.IsTuple(e)?ja.IsUndefined(t.items)&&!ja.IsUndefined(e.items)||!ja.IsUndefined(t.items)&&ja.IsUndefined(e.items)?Zt.False:ja.IsUndefined(t.items)&&!ja.IsUndefined(e.items)||t.items.every((r,i)=>xa(r,e.items[i])===Zt.True)?Zt.True:Zt.False:Zt.False}s(Txe,"FromTuple");function Pxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsUint8Array(e)?Zt.True:Zt.False}s(Pxe,"FromUint8Array");function Lxe(t,e){return Jo(e)?Qo(t,e):it.IsObject(e)?hl(t,e):it.IsRecord(e)?Cc(t,e):it.IsVoid(e)?Oxe(t):it.IsUndefined(e)?Zt.True:Zt.False}s(Lxe,"FromUndefined");function M5(t,e){return e.anyOf.some(r=>xa(t,r)===Zt.True)?Zt.True:Zt.False}s(M5,"FromUnionRight");function Dxe(t,e){return t.anyOf.every(r=>xa(r,e)===Zt.True)?Zt.True:Zt.False}s(Dxe,"FromUnion");function KU(t,e){return Zt.True}s(KU,"FromUnknownRight");function Rxe(t,e){return it.IsNever(e)?WU():it.IsIntersect(e)?sS(t,e):it.IsUnion(e)?M5(t,e):it.IsAny(e)?S5():it.IsString(e)?YU(t):it.IsNumber(e)?XU(t):it.IsInteger(e)?qU(t):it.IsBoolean(e)?HU(t):it.IsArray(e)?J_e(t):it.IsTuple(e)?Ixe(t):it.IsObject(e)?hl(t,e):it.IsUnknown(e)?Zt.True:Zt.False}s(Rxe,"FromUnknown");function Oxe(t,e){return it.IsUndefined(t)||it.IsUndefined(t)?Zt.True:Zt.False}s(Oxe,"FromVoidRight");function kxe(t,e){return it.IsIntersect(e)?sS(t,e):it.IsUnion(e)?M5(t,e):it.IsUnknown(e)?KU():it.IsAny(e)?S5():it.IsObject(e)?hl(t,e):it.IsVoid(e)?Zt.True:Zt.False}s(kxe,"FromVoid");function xa(t,e){return it.IsTemplateLiteral(t)||it.IsTemplateLiteral(e)?Exe(t,e):it.IsRegExp(t)||it.IsRegExp(e)?Axe(t,e):it.IsNot(t)||it.IsNot(e)?hxe(t,e):it.IsAny(t)?K_e(t,e):it.IsArray(t)?Q_e(t,e):it.IsBigInt(t)?txe(t,e):it.IsBoolean(t)?rxe(t,e):it.IsAsyncIterator(t)?exe(t,e):it.IsConstructor(t)?ixe(t,e):it.IsDate(t)?nxe(t,e):it.IsFunction(t)?axe(t,e):it.IsInteger(t)?oxe(t,e):it.IsIntersect(t)?sxe(t,e):it.IsIterator(t)?lxe(t,e):it.IsLiteral(t)?uxe(t,e):it.IsNever(t)?cxe():it.IsNull(t)?pxe(t,e):it.IsNumber(t)?dxe(t,e):it.IsObject(t)?xxe(t,e):it.IsRecord(t)?wxe(t,e):it.IsString(t)?Sxe(t,e):it.IsSymbol(t)?Mxe(t,e):it.IsTuple(t)?Txe(t,e):it.IsPromise(t)?bxe(t,e):it.IsUint8Array(t)?Pxe(t,e):it.IsUndefined(t)?Lxe(t,e):it.IsUnion(t)?Dxe(t,e):it.IsUnknown(t)?Rxe(t,e):it.IsVoid(t)?kxe(t,e):Av("Unknown left type operand '".concat(t[br],"'"))}s(xa,"Visit");function Tx(t,e){return xa(t,e)}s(Tx,"ExtendsCheck");N();N();N();function Nxe(t,e,r,i,n){let a={};for(let o of globalThis.Object.getOwnPropertyNames(t))a[o]=E5(t[o],e,r,i,Bu(n));return a}s(Nxe,"FromProperties");function Fxe(t,e,r,i,n){return Nxe(t.properties,e,r,i,n)}s(Fxe,"FromMappedResult");function Bxe(t,e,r,i,n){let a=Fxe(t,e,r,i,n);return qs(a)}s(Bxe,"ExtendsFromMappedResult");function zxe(t,e,r,i){let n=Tx(t,e);return n===Zt.Union?Bl([r,i]):n===Zt.True?r:i}s(zxe,"ExtendsResolve");function E5(t,e,r,i,n){return qu(t)?Bxe(t,e,r,i,n):dg(t)?ii($xe(t,e,r,i,n)):ii(zxe(t,e,r,i),n)}s(E5,"Extends");function Uxe(t,e,r,i,n){return{[t]:E5(Po(t),e,r,i,Bu(n))}}s(Uxe,"FromPropertyKey");function Vxe(t,e,r,i,n){return t.reduce((a,o)=>Ee(Ee({},a),Uxe(o,e,r,i,n)),{})}s(Vxe,"FromPropertyKeys");function jxe(t,e,r,i,n){return Vxe(t.keys,e,r,i,n)}s(jxe,"FromMappedKey");function $xe(t,e,r,i,n){let a=jxe(t,e,r,i,n);return qs(a)}s($xe,"ExtendsFromMappedKey");N();function Gxe(t){return t.allOf.every(e=>Sv(e))}s(Gxe,"Intersect");function Hxe(t){return t.anyOf.some(e=>Sv(e))}s(Hxe,"Union");function qxe(t){return!Sv(t.not)}s(qxe,"Not");function Sv(t){return t[br]==="Intersect"?Gxe(t):t[br]==="Union"?Hxe(t):t[br]==="Not"?qxe(t):t[br]==="Undefined"}s(Sv,"ExtendsUndefinedCheck");N();function Wxe(t,e){return C5(Gw(t),e)}s(Wxe,"ExcludeFromTemplateLiteral");function Xxe(t,e){let r=t.filter(i=>Tx(i,e)===Zt.False);return r.length===1?r[0]:Bl(r)}s(Xxe,"ExcludeRest");function C5(t,e,r={}){return fg(t)?ii(Wxe(t,e),r):qu(t)?ii(Kxe(t,e),r):ii(Hs(t)?Xxe(t.anyOf,e):Tx(t,e)!==Zt.False?cl():t,r)}s(C5,"Exclude");function Zxe(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=C5(t[i],e);return r}s(Zxe,"FromProperties");function Yxe(t,e){return Zxe(t.properties,e)}s(Yxe,"FromMappedResult");function Kxe(t,e){let r=Yxe(t,e);return qs(r)}s(Kxe,"ExcludeFromMappedResult");N();N();N();function Jxe(t,e){return I5(Gw(t),e)}s(Jxe,"ExtractFromTemplateLiteral");function Qxe(t,e){let r=t.filter(i=>Tx(i,e)!==Zt.False);return r.length===1?r[0]:Bl(r)}s(Qxe,"ExtractRest");function I5(t,e,r){return fg(t)?ii(Jxe(t,e),r):qu(t)?ii(rbe(t,e),r):ii(Hs(t)?Qxe(t.anyOf,e):Tx(t,e)!==Zt.False?t:cl(),r)}s(I5,"Extract");function ebe(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=I5(t[i],e);return r}s(ebe,"FromProperties");function tbe(t,e){return ebe(t.properties,e)}s(tbe,"FromMappedResult");function rbe(t,e){let r=tbe(t,e);return qs(r)}s(rbe,"ExtractFromMappedResult");N();function ibe(t,e){return ii(t.returns,e)}s(ibe,"InstanceType");N();function nbe(t){return ii({[br]:"Integer",type:"integer"},t)}s(nbe,"Integer");N();N();N();function abe(t,e,r){return{[t]:Mv(Po(t),e,Bu(r))}}s(abe,"MappedIntrinsicPropertyKey");function obe(t,e,r){return t.reduce((i,n)=>Ee(Ee({},i),abe(n,e,r)),{})}s(obe,"MappedIntrinsicPropertyKeys");function sbe(t,e,r){return obe(t.keys,e,r)}s(sbe,"MappedIntrinsicProperties");function lbe(t,e,r){let i=sbe(t,e,r);return qs(i)}s(lbe,"IntrinsicFromMappedKey");function ube(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toLowerCase(),r].join("")}s(ube,"ApplyUncapitalize");function cbe(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toUpperCase(),r].join("")}s(cbe,"ApplyCapitalize");function hbe(t){return t.toUpperCase()}s(hbe,"ApplyUppercase");function pbe(t){return t.toLowerCase()}s(pbe,"ApplyLowercase");function dbe(t,e,r){let i=y5(t.pattern);if(!G_(i))return vt(Ee({},t),{pattern:JU(t.pattern,e)});let n=[...aS(i)].map(l=>Po(l)),a=QU(n,e),o=Bl(a);return PU([o],r)}s(dbe,"FromTemplateLiteral");function JU(t,e){return typeof t=="string"?e==="Uncapitalize"?ube(t):e==="Capitalize"?cbe(t):e==="Uppercase"?hbe(t):e==="Lowercase"?pbe(t):t:t.toString()}s(JU,"FromLiteralValue");function QU(t,e){return t.map(r=>Mv(r,e))}s(QU,"FromRest");function Mv(t,e,r={}){return dg(t)?lbe(t,e,r):fg(t)?dbe(t,e,r):Hs(t)?Bl(QU(t.anyOf,e),r):bx(t)?Po(JU(t.const,e),r):ii(t,r)}s(Mv,"Intrinsic");function fbe(t,e={}){return Mv(t,"Capitalize",e)}s(fbe,"Capitalize");N();function mbe(t,e={}){return Mv(t,"Lowercase",e)}s(mbe,"Lowercase");N();function gbe(t,e={}){return Mv(t,"Uncapitalize",e)}s(gbe,"Uncapitalize");N();function ybe(t,e={}){return Mv(t,"Uppercase",e)}s(ybe,"Uppercase");N();function vbe(t,e){return ii({[br]:"Not",not:t},e)}s(vbe,"Not");N();N();N();function _be(t,e,r){let i={};for(let n of globalThis.Object.getOwnPropertyNames(t))i[n]=P5(t[n],e,Bu(r));return i}s(_be,"FromProperties");function xbe(t,e,r){return _be(t.properties,e,r)}s(xbe,"FromMappedResult");function bbe(t,e,r){let i=xbe(t,e,r);return qs(i)}s(bbe,"OmitFromMappedResult");function wbe(t,e){return t.map(r=>T5(r,e))}s(wbe,"FromIntersect");function Abe(t,e){return t.map(r=>T5(r,e))}s(Abe,"FromUnion");function Sbe(t,e){let r=t,{[e]:i}=r;return Nh(r,[JX(e)])}s(Sbe,"FromProperty");function Mbe(t,e){return e.reduce((r,i)=>Sbe(r,i),t)}s(Mbe,"FromProperties");function Ebe(t,e){let r=Ac(t,[Du,"$id","required","properties"]),i=Mbe(t.properties,e);return $s(i,r)}s(Ebe,"FromObject");function T5(t,e){return oh(t)?yg(wbe(t.allOf,e)):Hs(t)?Bl(Abe(t.anyOf,e)):Jh(t)?Ebe(t,e):$s({})}s(T5,"OmitResolve");function P5(t,e,r){if(dg(e))return Pbe(t,e,r);if(qu(t))return bbe(t,e,r);let i=Jy(e)?Cf(e):e;return ii(Ee(Ee({},T5(t,i)),r))}s(P5,"Omit");function Cbe(t,e,r){return{[e]:P5(t,[e],Bu(r))}}s(Cbe,"FromPropertyKey");function Ibe(t,e,r){return e.reduce((i,n)=>Ee(Ee({},i),Cbe(t,n,r)),{})}s(Ibe,"FromPropertyKeys");function Tbe(t,e,r){return Ibe(t,e.keys,r)}s(Tbe,"FromMappedKey");function Pbe(t,e,r){let i=Tbe(t,e,r);return qs(i)}s(Pbe,"OmitFromMappedKey");N();function Lbe(t,e){return Ex(t.parameters,e)}s(Lbe,"Parameters");N();N();function Uk(t){return t.map(e=>eV(e))}s(Uk,"FromRest");function Dbe(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=gg(t[r]);return e}s(Dbe,"FromProperties");function Rbe(t){let e=Ac(t,[Du,"$id","required","properties"]),r=Dbe(t.properties);return $s(r,e)}s(Rbe,"FromObject");function eV(t){return oh(t)?yg(Uk(t.allOf)):Hs(t)?Bl(Uk(t.anyOf)):Jh(t)?Rbe(t):$s({})}s(eV,"PartialResolve");function tV(t,e){return qu(t)?Nbe(t,e):ii(Ee(Ee({},eV(t)),e))}s(tV,"Partial");function Obe(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=tV(t[i],Bu(e));return r}s(Obe,"FromProperties");function kbe(t,e){return Obe(t.properties,e)}s(kbe,"FromMappedResult");function Nbe(t,e){let r=kbe(t,e);return qs(r)}s(Nbe,"PartialFromMappedResult");N();N();N();function Fbe(t,e,r){let i={};for(let n of globalThis.Object.getOwnPropertyNames(t))i[n]=D5(t[n],e,Bu(r));return i}s(Fbe,"FromProperties");function Bbe(t,e,r){return Fbe(t.properties,e,r)}s(Bbe,"FromMappedResult");function zbe(t,e,r){let i=Bbe(t,e,r);return qs(i)}s(zbe,"PickFromMappedResult");function Ube(t,e){return t.map(r=>L5(r,e))}s(Ube,"FromIntersect");function Vbe(t,e){return t.map(r=>L5(r,e))}s(Vbe,"FromUnion");function jbe(t,e){let r={};for(let i of e)i in t&&(r[i]=t[i]);return r}s(jbe,"FromProperties");function $be(t,e){let r=Ac(t,[Du,"$id","required","properties"]),i=jbe(t.properties,e);return $s(i,r)}s($be,"FromObject");function L5(t,e){return oh(t)?yg(Ube(t.allOf,e)):Hs(t)?Bl(Vbe(t.anyOf,e)):Jh(t)?$be(t,e):$s({})}s(L5,"PickResolve");function D5(t,e,r){if(dg(e))return Wbe(t,e,r);if(qu(t))return zbe(t,e,r);let i=Jy(e)?Cf(e):e;return ii(Ee(Ee({},L5(t,i)),r))}s(D5,"Pick");function Gbe(t,e,r){return{[e]:D5(t,[e],Bu(r))}}s(Gbe,"FromPropertyKey");function Hbe(t,e,r){return e.reduce((i,n)=>Ee(Ee({},i),Gbe(t,n,r)),{})}s(Hbe,"FromPropertyKeys");function qbe(t,e,r){return Hbe(t,e.keys,r)}s(qbe,"FromMappedKey");function Wbe(t,e,r){let i=qbe(t,e,r);return qs(i)}s(Wbe,"PickFromMappedKey");N();function Xbe(t){return mg(gg(t))}s(Xbe,"ReadonlyOptional");N();function vg(t,e,r){return ii({[br]:"Record",type:"object",patternProperties:{[t]:e}},r)}s(vg,"RecordCreateFromPattern");function R5(t,e,r){let i={};for(let n of t)i[n]=e;return $s(i,vt(Ee({},r),{[z_]:"Record"}))}s(R5,"RecordCreateFromKeys");function Zbe(t,e,r){return EU(t)?R5(Cf(t),e,r):vg(t.pattern,e,r)}s(Zbe,"FromTemplateLiteralKey");function Ybe(t,e,r){return R5(Cf(Bl(t)),e,r)}s(Ybe,"FromUnionKey");function Kbe(t,e,r){return R5([t.toString()],e,r)}s(Kbe,"FromLiteralKey");function Jbe(t,e,r){return vg(t.source,e,r)}s(Jbe,"FromRegExpKey");function Qbe(t,e,r){let i=ll(t.pattern)?V_:t.pattern;return vg(i,e,r)}s(Qbe,"FromStringKey");function e2e(t,e,r){return vg(V_,e,r)}s(e2e,"FromAnyKey");function t2e(t,e,r){return vg(RXe,e,r)}s(t2e,"FromNeverKey");function r2e(t,e,r){return vg(U_,e,r)}s(r2e,"FromIntegerKey");function i2e(t,e,r){return vg(U_,e,r)}s(i2e,"FromNumberKey");function n2e(t,e,r={}){return Hs(t)?Ybe(t.anyOf,e,r):fg(t)?Zbe(t,e,r):bx(t)?Kbe(t.const,e,r):eS(t)?r2e(t,e,r):tS(t)?i2e(t,e,r):Fz(t)?Jbe(t,e,r):c5(t)?Qbe(t,e,r):Dz(t)?e2e(t,e,r):wx(t)?t2e(t,e,r):cl(r)}s(n2e,"Record");N();var BXe=0;function a2e(t,e={}){ll(e.$id)&&(e.$id="T".concat(BXe++));let r=n5(t({[br]:"This",$ref:"".concat(e.$id)}));return r.$id=e.$id,ii(Ee({[z_]:"Recursive"},r),e)}s(a2e,"Recursive");N();function o2e(t,e){if(Ko(t))return ii({[br]:"Ref",$ref:t},e);if(ll(t.$id))throw new Error("Reference target type must specify an $id");return ii({[br]:"Ref",$ref:t.$id},e)}s(o2e,"Ref");N();function s2e(t,e){let r=Ko(t)?new globalThis.RegExp(t):t;return ii({[br]:"RegExp",type:"RegExp",source:r.source,flags:r.flags},e)}s(s2e,"RegExp");N();N();function Vk(t){return t.map(e=>rV(e))}s(Vk,"FromRest");function l2e(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=Ac(t[r],[pg]);return e}s(l2e,"FromProperties");function u2e(t){let e=Ac(t,[Du,"$id","required","properties"]),r=l2e(t.properties);return $s(r,e)}s(u2e,"FromObject");function rV(t){return oh(t)?yg(Vk(t.allOf)):Hs(t)?Bl(Vk(t.anyOf)):Jh(t)?u2e(t):$s({})}s(rV,"RequiredResolve");function iV(t,e){return qu(t)?p2e(t,e):ii(Ee(Ee({},rV(t)),e))}s(iV,"Required");function c2e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=iV(t[i],e);return r}s(c2e,"FromProperties");function h2e(t,e){return c2e(t.properties,e)}s(h2e,"FromMappedResult");function p2e(t,e){let r=h2e(t,e);return qs(r)}s(p2e,"RequiredFromMappedResult");N();function d2e(t){var e;return oh(t)?t.allOf:Hs(t)?t.anyOf:_v(t)?(e=t.items)!=null?e:[]:[]}s(d2e,"RestResolve");function f2e(t){return d2e(t)}s(f2e,"Rest");N();function m2e(t,e){return ii(t.returns,e)}s(m2e,"ReturnType");N();function g2e(t){return JSON.parse(JSON.stringify(t))}s(g2e,"Strict");N();var y2e=class{constructor(e){this.schema=e}Decode(e){return new UXe(this.schema,e)}};s(y2e,"TransformDecodeBuilder");var zXe=y2e,v2e=class{constructor(e,r){this.schema=e,this.decode=r}EncodeTransform(e,r){let i={Encode:s(n=>r[Du].Encode(e(n)),"Encode"),Decode:s(n=>this.decode(r[Du].Decode(n)),"Decode")};return vt(Ee({},r),{[Du]:i})}EncodeSchema(e,r){let i={Decode:this.decode,Encode:e};return vt(Ee({},r),{[Du]:i})}Encode(e){return h5(this.schema)?this.EncodeTransform(e,this.schema):this.EncodeSchema(e,this.schema)}};s(v2e,"TransformEncodeBuilder");var UXe=v2e;function _2e(t){return new zXe(t)}s(_2e,"Transform");N();function nV(t={}){var e;return ii({[br]:(e=t[br])!=null?e:"Unsafe"},t)}s(nV,"Unsafe");N();function x2e(t){return ii({[br]:"Void",type:"void"},t)}s(x2e,"Void");N();var b2e={};Nl(b2e,{Any:()=>j_,Array:()=>wU,AsyncIterator:()=>AU,Awaited:()=>g_e,BigInt:()=>_5,Boolean:()=>IU,Capitalize:()=>fbe,Composite:()=>L_e,Const:()=>O_e,Constructor:()=>SU,ConstructorParameters:()=>k_e,Date:()=>UU,Deref:()=>ep,Enum:()=>Z_e,Exclude:()=>C5,Extends:()=>E5,Extract:()=>I5,Function:()=>nS,Index:()=>b5,InstanceType:()=>ibe,Integer:()=>nbe,Intersect:()=>yg,Iterator:()=>RU,KeyOf:()=>zU,Literal:()=>Po,Lowercase:()=>mbe,Mapped:()=>i_e,Never:()=>cl,Not:()=>vbe,Null:()=>VU,Number:()=>wv,Object:()=>$s,Omit:()=>P5,Optional:()=>gg,Parameters:()=>Lbe,Partial:()=>tV,Pick:()=>D5,Promise:()=>OU,Readonly:()=>mg,ReadonlyOptional:()=>Xbe,Record:()=>n2e,Recursive:()=>a2e,Ref:()=>o2e,RegExp:()=>s2e,Required:()=>iV,Rest:()=>f2e,ReturnType:()=>m2e,Strict:()=>g2e,String:()=>xf,Symbol:()=>jU,TemplateLiteral:()=>PU,Transform:()=>_2e,Tuple:()=>Ex,Uint8Array:()=>GU,Uncapitalize:()=>gbe,Undefined:()=>$U,Union:()=>Bl,Unknown:()=>Cx,Unsafe:()=>nV,Uppercase:()=>ybe,Void:()=>x2e});N();var de=b2e,au=s((t,e)=>de.Unsafe(de.String({$id:e,pattern:"^".concat(t,"_[A-Za-z0-9-]{8,}$")})),"Ident"),If=au("g","GeometryId"),Gs=au("f","FloorId"),VXe=[If,Gs];N();N();var xT=de.Object({externalId:de.String({description:"An identifier that can be used to link this entity to data outside of the MVF."}),name:de.String({description:"The name of the entity."}),shortName:de.String({description:"A short name for the entity."}),description:de.String({description:"A description of the entity."}),icon:de.String({format:"uri",description:"A URL to an icon for the entity."})},{$id:"BaseDetails",description:"Additional information about a given entity."}),w2e=de.Partial(xT,{$id:"Details",description:"Additional information about a given entity."}),uS=de.Object({details:de.Optional(de.Ref(w2e))},{$id:"WithDetails"}),aV=s(t=>{let e=[...t].sort(),r=de.Pick(xT,t),i=de.Omit(xT,t);return de.Object({details:de.Intersect([r,de.Partial(i)])},{$id:"WithRequiredDetails_".concat(e.join("_"))})},"WithRequiredDetails"),jXe=[xT,w2e];N();N();var A2e=de.Record(de.String(),de.Unknown(),{$id:"Extra"}),cS=de.Object({extra:de.Optional(de.Ref(A2e))}),$Xe=[A2e];N();N();var O5=de.Object({geometryId:de.Ref(If),floorId:de.Ref(Gs)},{$id:"GeometryAnchor"});de.Object({geometryAnchor:de.Ref(O5)});var oV=s((t,e)=>de.Object({geometryAnchors:de.Array(de.Ref(O5),t)},e),"WithGeometryAnchors"),GXe=[O5];N();N();N();N();N();var bT=de.Number({$id:"Longitude",minimum:-180,maximum:180,description:"A WGS 84-compatible longitude coordinate value."}),wT=de.Number({$id:"Latitude",minimum:-90,maximum:90,description:"A WGS 84-compatible latitude coordinate value."}),Px=de.Tuple([de.Ref(bT),de.Ref(wT)],{$id:"Position",minItems:2,maxItems:2,description:"A valid WGS 84 position consisting of a longitude value, followed by a latitude value."}),Tf=de.Object({type:de.Literal("Point"),coordinates:de.Ref(Px)},{$id:"Point",description:"An RFC-7946 compatible GeoJSON Point geometry."}),S2e=de.Object({type:de.Literal("MultiPoint"),coordinates:de.Array(de.Ref(Px))},{$id:"MultiPoint",description:"An RFC-7946 compatible GeoJSON MultiPoint geometry."}),M2e=de.Object({type:de.Literal("LineString"),coordinates:de.Array(de.Ref(Px),{minItems:2,description:"At least two positions are required."})},{$id:"LineString",description:"An RFC-7946 compatible GeoJSON LineString geometry."}),E2e=de.Object({type:de.Literal("MultiLineString"),coordinates:de.Array(de.Array(de.Ref(Px),{minItems:2}))},{$id:"MultiLineString",description:"An RFC-7946 compatible GeoJSON MultiLineString geometry."}),C2e=de.Array(de.Ref(Px),{$id:"LinearRing",minItems:4,description:"A linear ring is a building block of a polygon or multi-polygon."}),sV=de.Array(de.Ref(C2e),{$id:"LinearRings",minItems:1,description:"A collection of linear rings, at least one of which is the exterior ring of a polygon."}),lV=de.Object({type:de.Literal("Polygon"),coordinates:de.Ref(sV)},{$id:"Polygon",description:"An RFC-7946 compatible GeoJSON Polygon geometry."}),uV=de.Object({type:de.Literal("MultiPolygon"),coordinates:de.Array(de.Ref(sV))},{$id:"MultiPolygon",description:"An RFC-7946 compatible GeoJSON MultiPolygon geometry."}),Pf=s((t,e,r)=>de.Object({type:de.Literal("Feature"),geometry:t,properties:e},r),"Feature"),Ev=s((t,e,r)=>de.Object({type:de.Literal("FeatureCollection"),features:de.Array(t,r)},e),"FeatureCollection"),HXe=[bT,wT,Px,Tf,S2e,M2e,E2e,C2e,sV,lV,uV],I2e=de.Intersect([de.Object({id:de.Ref(Gs),elevation:de.Integer({description:"An ordinal representing the elevation of this map relative to other maps in the stack."}),subtitle:de.Optional(de.String({description:"The subtitle of the floor."}))}),uS],{$id:"FloorProperties"}),T2e=Pf(de.Union([de.Ref(lV),de.Ref(uV),de.Null()]),de.Ref(I2e),{$id:"FloorFeature"}),P2e=Ev(de.Ref(T2e),{$id:"FloorCollection"}),qXe=de.Object({floors:de.Ref(P2e)}),WXe={name:"core:floors",intoBundle:s(function*(t){t.floors!=null&&(yield{path:"floors.geojson",contents:t.floors})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="floors.geojson")return{floors:r(e)}},"fromBundle"),schema:qXe,references:[I2e,T2e,P2e]};N();N();N();var L2e=class{constructor(e){$(this,"_value"),this._value=e}[Symbol.iterator](){return this}next(){if(this._value==null)return{done:!0,value:void 0};let e=this._value;return this._value=null,{done:!1,value:e}}};s(L2e,"OptionIterator");var D2e=L2e,R2e=class{constructor(e){$(this,"_tag","Some"),$(this,"_value"),this._value=e}get value(){return this._value}isSome(){return!0}isSomeAnd(e){return e(this.value)}isNone(){return!1}equals(e){return e.isSome()&&e.value===this.value}expect(e){return this.value}unwrap(){return this.value}unwrapOr(e){return this.value}unwrapOrElse(e){return this.value}inspect(e){return e(this.value),this}inspectNone(e){return this}map(e){return kW(e(this.value))}mapAsync(e){return e(this.value).then(r=>kW(r))}mapOr(e,r){return this.map(e).unwrapOr(r)}mapOrAsync(e,r){return this.mapAsync(e).then(i=>i.unwrapOr(r))}mapOrElse(e,r){return this.map(e).unwrapOrElse(r)}mapOrElseAsync(e,r){return this.mapAsync(e).then(i=>i.unwrapOrElse(r))}and(e){return e}andThen(e){return e(this.value)}andThenAsync(e){return e(this.value)}filter(e){return e(this.value)?this:Ty()}or(e){return this}orElse(e){return this}xor(e){return e.isSome()?Ty():this}toString(){return"Some(".concat(this.value,")")}okOr(e){return Pi(this.value)}okOrElse(e){return Pi(this.value)}iter(){return new D2e(this.value)}[Symbol.iterator](){return this.iter()}zip(e){return e.isSome()?Hw([this.value,e.value]):Ty()}zipWith(e,r){return e.isSome()?Hw(r(this.value,e.value)):Ty()}get[Symbol.toStringTag](){return"Some"}};s(R2e,"Some");var O2e=R2e,k2e=class{constructor(){$(this,"_tag","None")}get value(){return null}isSome(){return!1}isSomeAnd(e){return!1}isNone(){return!0}equals(e){return e.isNone()}expect(e){throw new Error(e)}unwrap(){throw new Error("Tried to unwrap a None value!")}unwrapOr(e){return e}unwrapOrElse(e){return e()}inspect(e){return this}inspectNone(e){return e(),this}map(e){return this}mapAsync(e){return Promise.resolve(this)}mapOr(e,r){return r}mapOrAsync(e,r){return Promise.resolve(r)}mapOrElse(e,r){return r()}mapOrElseAsync(e,r){return r()}and(e){return this}andThen(e){return this}andThenAsync(e){return Promise.resolve(this)}filter(e){return this}or(e){return e}orElse(e){return e()}xor(e){return e}toString(){return"None"}okOr(e){return Ri(e)}okOrElse(e){return Ri(e())}iter(){return new D2e(null)}[Symbol.iterator](){return this.iter()}zip(e){return this}zipWith(e,r){return this}get[Symbol.toStringTag](){return"None"}};s(k2e,"None");var N2e=k2e,Hw=s(t=>new O2e(t),"some"),Ty=s(()=>new N2e,"none"),kW=s(t=>t instanceof O2e||t instanceof N2e?t:t==null?Ty():Hw(t),"option"),F2e=class{constructor(e){$(this,"_value"),this._value=e}[Symbol.iterator](){return this}next(){if(this._value==null)return{done:!0,value:void 0};let e=this._value;return this._value=null,{done:!1,value:e}}};s(F2e,"ResultIterator");var B2e=F2e,z2e=class{constructor(e){$(this,"_tag","Ok"),$(this,"_value"),this._value=e}get value(){return this._value}get error(){return null}isOk(){return!0}isOkAnd(e){return e(this.value)}isErr(){return!1}isErrAnd(e){return!1}ok(){return Hw(this.value)}err(){return Ty()}expect(e){return this.value}expectErr(e){throw new Error(e)}unwrap(){return this.value}unwrapOr(e){return this.value}unwrapOrElse(e){return this.value}inspect(e){return e(this.value),this}inspectErr(){return this}map(e){return Pi(e(this.value))}async mapAsync(e){return e(this.value).then(Pi)}mapOr(e,r){return e(this.value)}async mapOrAsync(e,r){return e(this.value)}mapOrElse(e,r){return e(this.value)}async mapOrElseAsync(e,r){return e(this.value)}mapErr(e){return this}iter(){return new B2e(this.value)}[Symbol.iterator](){return this.iter()}and(e){return e}andThen(e){return e(this.value)}or(e){return this}orElse(e){return this}async andThenAsync(e){return e(this.value)}toString(){return"Ok(".concat(this.value,")")}get[Symbol.toStringTag](){return"Ok"}};s(z2e,"Ok");var XXe=z2e,U2e=class V2e{constructor(e){$(this,"_tag","Err"),$(this,"_error"),this._error=e}get value(){return null}get error(){return this._error}isOk(){return!1}isOkAnd(e){return!1}isErr(){return!0}isErrAnd(e){return e(this.error)}ok(){return Ty()}err(){return Hw(this.error)}expect(e){throw new Error(e)}expectErr(e){return this.error}unwrap(){throw this.error}unwrapOr(e){return e}unwrapOrElse(e){return e()}inspect(){return this}inspectErr(e){return e(this.error),this}map(e){return this}iter(){return new B2e(null)}[Symbol.iterator](){return this.iter()}async mapAsync(e){return this}mapOr(e,r){return r}async mapOrAsync(e,r){return r}mapOrElse(e,r){return r()}async mapOrElseAsync(e,r){return r()}mapErr(e){return new V2e(e(this.error))}and(e){return this}andThen(e){return this}async andThenAsync(e){return this}or(e){return e}orElse(e){return e(this.error)}toString(){return"Err(".concat(this.error,")")}get[Symbol.toStringTag](){return"Err"}};s(U2e,"Err");var ZXe=U2e,Pi=s(t=>new XXe(t),"ok"),Ri=s(t=>new ZXe(t),"err");N();var tv;(function(t){t.GeometryMissingError="GeometryMissingError",t.FloorMissingError="FloorMissingError",t.UnknownFloorError="UnknownFloorError",t.UnknownGeometryError="UnknownGeometryError"})(tv||(tv={}));var YXe=s(t=>{var e,r;return new Map((r=(e=t.floors)==null?void 0:e.features.map(i=>[i.properties.id,i]))!=null?r:[])},"createFloorMap"),k5=s(t=>{let e=YXe(t);return s(r=>{let i=e.get(r);return i==null?Ri({kind:tv.UnknownFloorError,properties:{floorId:r}}):Pi(i)},"floorLookup")},"createFloorLookup");N();N();N();N();var zu=s(t=>de.Unsafe(t),"PartialRecord");N();var ds=s(t=>Object.keys(t),"typedKeys");N();var KXe=s(t=>{if(t.floors==null)return Ri({kind:tv.FloorMissingError,properties:null});if(t.geometry==null)return Ri({kind:tv.GeometryMissingError,properties:null});let e=k5(t);for(let r of ds(t.geometry)){let i=e(r);if(i.isErr())return i}return Pi(!0)},"validateGeometry"),j2e=de.Intersect([de.Object({id:de.Ref(If)}),uS],{$id:"GeometryProperties"}),$2e=Pf(de.Union([de.Ref(Tf),de.Ref(S2e),de.Ref(M2e),de.Ref(E2e),de.Ref(lV),de.Ref(uV)]),de.Ref(j2e),{$id:"GeometryFeature"}),G2e=Ev(de.Ref($2e),{$id:"GeometryCollection"}),JXe=de.Object({geometry:zu(de.Record(Gs,de.Ref(G2e),{additionalProperties:!1}))},{$id:"GeometrySchema"}),QXe=/^geometry\/(.*)\.geojson$/,eZe={name:"core:geometry",schema:JXe,intoBundle:s(function*(t){if(t.geometry!=null)for(let e of ds(t.geometry))yield{path:"geometry/".concat(e,".geojson"),contents:t.geometry[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(QXe))==null?void 0:i[1];if(n)return{geometry:{[n]:r(e)}}},"fromBundle"),references:[j2e,$2e,G2e],integrityCheck:KXe};N();N();var Cs=s(t=>Object.entries(t),"typedEntries"),tZe=s(t=>{var e;let r=new Map;for(let[i,n]of Cs((e=t.geometry)!=null?e:{}))r.set(i,new Map(n==null?void 0:n.features.map(a=>[a.properties.id,a])));return r},"createLookupMap"),Lf=s(t=>{let e=tZe(t);return s((r,i)=>{let n=e.get(r);if(n==null)return Ri({kind:tv.UnknownFloorError,properties:{floorId:r}});let a=n.get(i);return a==null?Ri({kind:tv.UnknownGeometryError,properties:{floorId:r,geometryId:i}}):Pi(a)},"geometryLookup")},"createGeometryLookup");N();var cV=de.Object({type:de.Literal("file"),name:de.String({description:"The name of the file."})},{$id:"ManifestFile"}),H2e=de.Recursive(t=>de.Object({type:de.Literal("folder"),name:de.String({description:"The name of the folder."}),children:de.Array(de.Union([t,de.Ref(cV)]),{minItems:1,description:"The children of the folder."})}),{$id:"ManifestFolder"}),q2e=de.Object({name:de.String({description:"The name of the map."}),version:de.Literal("3.0.0",{description:"The version of the manifest."}),orgId:de.Optional(de.String({description:"The identifier of the organization that the map this MVF is for belongs to."})),mapId:de.Optional(de.String({description:"The identifier of the map that this MVF is for."})),contents:de.Array(de.Union([de.Ref(H2e),de.Ref(cV)]),{minItems:1,description:"The contents of the MVF bundle."}),time:de.String({format:"date-time",description:"An ISO 8601 date-time string, including timezone offset."}),tzid:de.Optional(de.Unsafe(de.String({description:"A valid IANA timezone identifier.",pattern:"^[A-Za-z0-9_-]+/[A-Za-z0-9_-]+$"}))),naturalBearing:de.Optional(de.Number({minimum:0,maximum:360,description:'The angle, in degrees, the map is considered to be "naturally oriented" as, rather than facing directly north. 90 degrees means East is "up"'})),defaultFloor:de.Optional(de.Ref(Gs,{description:"The default floor ID of the map."})),language:de.Optional(de.String({description:"The language code of the map."}))},{$id:"ManifestProperties"}),W2e=Ev(Pf(Tf,de.Ref(q2e)),{$id:"ManifestCollection"},{minItems:1,maxItems:1}),rZe=de.Object({manifest:de.Ref(W2e)}),iZe={name:"core:manifest",intoBundle:s(function*(t){t.manifest!=null&&(yield{path:"manifest.geojson",contents:t.manifest})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="manifest.geojson")return{manifest:r(e)}},"fromBundle"),schema:rZe,references:[cV,H2e,q2e,W2e]},Lx=de.Object({geometryId:de.Ref(If)},{$id:"WithGeometryId"}),X2e=de.Object({geometryIds:de.Array(de.Ref(If))},{$id:"WithGeometryIds"}),nZe=[Lx,X2e];N();N();var aZe=s((t,e)=>de.Unsafe(de.Transform(de.String(e)).Decode(r=>t.includes(r)?r:"unknown").Encode(r=>r)),"SafeStringEnumSchema"),Cv=s((t,e)=>{let r=aZe(t,e),i=[...t,"unknown"],n=Object.freeze(Object.fromEntries([...t,"unknown"].map(a=>[a,a])));return{schema:r,values:i,record:n}},"SafeStringEnum");N();N();N();var AT;(function(t){t.AnnotationNonPointGeometryError="AnnotationNonPointGeometryError",t.AnnotationUnknownSymbolError="AnnotationUnknownSymbolError"})(AT||(AT={}));var oZe=s(t=>{var e;if(t.annotations==null)return Pi(!0);let r=Lf(t),i=new Set(ds((e=t.annotationSymbols)!=null?e:{}));for(let n of ds(t.annotations)){let a=t.annotations[n];if(a!=null)for(let o of a){if(!i.has(o.symbolKey))return Ri({kind:AT.AnnotationUnknownSymbolError,properties:{annotationId:o.id,symbolKey:o.symbolKey}});let l=r(n,o.geometryId);if(l.isErr())return l;if(l.value.geometry.type!=="Point")return Ri({kind:AT.AnnotationNonPointGeometryError,properties:{annotationId:o.id,floorId:n,geometryId:o.geometryId}})}}return Pi(!0)},"validateAnnotations"),Z2e=au("a","AnnotationId"),jk=de.Intersect([Lx,de.Object({id:de.Ref(Z2e,{description:"The unique identifier for the annotation."}),externalId:de.Optional(de.String({description:"The external identifier for the annotation."})),symbolKey:de.String({description:"The symbol identifier for the annotation."})})],{$id:"AnnotationProperties"}),Y2e=de.Object({url:de.String({format:"uri",description:"The URL for the symbol."}),name:de.String({description:"The name of the symbol."})},{$id:"AnnotationSymbol"}),sZe=de.Object({annotations:zu(de.Record(Gs,de.Array(de.Ref(jk)),{additionalProperties:!1})),annotationSymbols:zu(de.Record(de.Index(jk,["symbolKey"]),de.Ref(Y2e)))},{$id:"AnnotationsSchema"}),lZe=/^annotations\/(.*)\.json$/,uZe={name:"ext:mvf-annotations",schema:sZe,intoBundle:s(function*(t){if(t.annotations!=null)for(let e of ds(t.annotations))yield{path:"annotations/".concat(e,".json"),contents:t.annotations[e]};t.annotationSymbols!=null&&(yield{path:"annotation-symbols.json",contents:t.annotationSymbols})},"intoBundle"),fromBundle:s((t,e,r)=>{var i;if(t==="annotation-symbols.json")return{annotationSymbols:r(e)};let n=(i=t.match(lZe))==null?void 0:i[1];if(n)return{annotations:{[n]:r(e)}}},"fromBundle"),references:[Z2e,jk,Y2e],integrityCheck:oZe};N();N();N();N();N();N();N();N();var K2e=class extends Ia{constructor(e){super("Duplicate type kind '".concat(e,"' detected"))}};s(K2e,"TypeSystemDuplicateTypeKind");var cZe=K2e,J2e=class extends Ia{constructor(e){super("Duplicate string format '".concat(e,"' detected"))}};s(J2e,"TypeSystemDuplicateFormat");var Q2e=J2e,$k;(function(t){function e(i,n){if(rh.Has(i))throw new cZe(i);return rh.Set(i,n),(a={})=>nV(vt(Ee({},a),{[br]:i}))}s(e,"Type"),t.Type=e;function r(i,n){if(_f.Has(i))throw new Q2e(i);return _f.Set(i,n),i}s(r,"Format"),t.Format=r})($k||($k={}));N();N();N();function ewe(t){switch(t.errorType){case Bt.ArrayContains:return"Expected array to contain at least one matching value";case Bt.ArrayMaxContains:return"Expected array to contain no more than ".concat(t.schema.maxContains," matching values");case Bt.ArrayMinContains:return"Expected array to contain at least ".concat(t.schema.minContains," matching values");case Bt.ArrayMaxItems:return"Expected array length to be less or equal to ".concat(t.schema.maxItems);case Bt.ArrayMinItems:return"Expected array length to be greater or equal to ".concat(t.schema.minItems);case Bt.ArrayUniqueItems:return"Expected array elements to be unique";case Bt.Array:return"Expected array";case Bt.AsyncIterator:return"Expected AsyncIterator";case Bt.BigIntExclusiveMaximum:return"Expected bigint to be less than ".concat(t.schema.exclusiveMaximum);case Bt.BigIntExclusiveMinimum:return"Expected bigint to be greater than ".concat(t.schema.exclusiveMinimum);case Bt.BigIntMaximum:return"Expected bigint to be less or equal to ".concat(t.schema.maximum);case Bt.BigIntMinimum:return"Expected bigint to be greater or equal to ".concat(t.schema.minimum);case Bt.BigIntMultipleOf:return"Expected bigint to be a multiple of ".concat(t.schema.multipleOf);case Bt.BigInt:return"Expected bigint";case Bt.Boolean:return"Expected boolean";case Bt.DateExclusiveMinimumTimestamp:return"Expected Date timestamp to be greater than ".concat(t.schema.exclusiveMinimumTimestamp);case Bt.DateExclusiveMaximumTimestamp:return"Expected Date timestamp to be less than ".concat(t.schema.exclusiveMaximumTimestamp);case Bt.DateMinimumTimestamp:return"Expected Date timestamp to be greater or equal to ".concat(t.schema.minimumTimestamp);case Bt.DateMaximumTimestamp:return"Expected Date timestamp to be less or equal to ".concat(t.schema.maximumTimestamp);case Bt.DateMultipleOfTimestamp:return"Expected Date timestamp to be a multiple of ".concat(t.schema.multipleOfTimestamp);case Bt.Date:return"Expected Date";case Bt.Function:return"Expected function";case Bt.IntegerExclusiveMaximum:return"Expected integer to be less than ".concat(t.schema.exclusiveMaximum);case Bt.IntegerExclusiveMinimum:return"Expected integer to be greater than ".concat(t.schema.exclusiveMinimum);case Bt.IntegerMaximum:return"Expected integer to be less or equal to ".concat(t.schema.maximum);case Bt.IntegerMinimum:return"Expected integer to be greater or equal to ".concat(t.schema.minimum);case Bt.IntegerMultipleOf:return"Expected integer to be a multiple of ".concat(t.schema.multipleOf);case Bt.Integer:return"Expected integer";case Bt.IntersectUnevaluatedProperties:return"Unexpected property";case Bt.Intersect:return"Expected all values to match";case Bt.Iterator:return"Expected Iterator";case Bt.Literal:return"Expected ".concat(typeof t.schema.const=="string"?"'".concat(t.schema.const,"'"):t.schema.const);case Bt.Never:return"Never";case Bt.Not:return"Value should not match";case Bt.Null:return"Expected null";case Bt.NumberExclusiveMaximum:return"Expected number to be less than ".concat(t.schema.exclusiveMaximum);case Bt.NumberExclusiveMinimum:return"Expected number to be greater than ".concat(t.schema.exclusiveMinimum);case Bt.NumberMaximum:return"Expected number to be less or equal to ".concat(t.schema.maximum);case Bt.NumberMinimum:return"Expected number to be greater or equal to ".concat(t.schema.minimum);case Bt.NumberMultipleOf:return"Expected number to be a multiple of ".concat(t.schema.multipleOf);case Bt.Number:return"Expected number";case Bt.Object:return"Expected object";case Bt.ObjectAdditionalProperties:return"Unexpected property";case Bt.ObjectMaxProperties:return"Expected object to have no more than ".concat(t.schema.maxProperties," properties");case Bt.ObjectMinProperties:return"Expected object to have at least ".concat(t.schema.minProperties," properties");case Bt.ObjectRequiredProperty:return"Expected required property";case Bt.Promise:return"Expected Promise";case Bt.RegExp:return"Expected string to match regular expression";case Bt.StringFormatUnknown:return"Unknown format '".concat(t.schema.format,"'");case Bt.StringFormat:return"Expected string to match '".concat(t.schema.format,"' format");case Bt.StringMaxLength:return"Expected string length less or equal to ".concat(t.schema.maxLength);case Bt.StringMinLength:return"Expected string length greater or equal to ".concat(t.schema.minLength);case Bt.StringPattern:return"Expected string to match '".concat(t.schema.pattern,"'");case Bt.String:return"Expected string";case Bt.Symbol:return"Expected symbol";case Bt.TupleLength:return"Expected tuple to have ".concat(t.schema.maxItems||0," elements");case Bt.Tuple:return"Expected tuple";case Bt.Uint8ArrayMaxByteLength:return"Expected byte length less or equal to ".concat(t.schema.maxByteLength);case Bt.Uint8ArrayMinByteLength:return"Expected byte length greater or equal to ".concat(t.schema.minByteLength);case Bt.Uint8Array:return"Expected Uint8Array";case Bt.Undefined:return"Expected undefined";case Bt.Union:return"Expected union value";case Bt.Void:return"Expected void";case Bt.Kind:return"Expected kind '".concat(t.schema[br],"'");default:return"Unknown error type"}}s(ewe,"DefaultErrorFunction");var hZe=ewe;function twe(){return hZe}s(twe,"GetErrorFunction");N();var rwe=class extends Ia{constructor(e){super("Unable to dereference schema with $id '".concat(e.$ref,"'")),this.schema=e}};s(rwe,"TypeDereferenceError");var pZe=rwe;function iwe(t,e){let r=e.find(i=>i.$id===t.$ref);if(r===void 0)throw new pZe(t);return oo(r,e)}s(iwe,"Resolve");function Iv(t,e){return!_a(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}s(Iv,"Pushref");function oo(t,e){return t[br]==="This"||t[br]==="Ref"?iwe(t,e):t}s(oo,"Deref");N();var nwe=class extends Ia{constructor(e){super("Unable to hash value"),this.value=e}};s(nwe,"ValueHashError");var dZe=nwe,Mc;(function(t){t[t.Undefined=0]="Undefined",t[t.Null=1]="Null",t[t.Boolean=2]="Boolean",t[t.Number=3]="Number",t[t.String=4]="String",t[t.Object=5]="Object",t[t.Array=6]="Array",t[t.Date=7]="Date",t[t.Uint8Array=8]="Uint8Array",t[t.Symbol=9]="Symbol",t[t.BigInt=10]="BigInt"})(Mc||(Mc={}));var U1=BigInt("14695981039346656037"),[fZe,mZe]=[BigInt("1099511628211"),BigInt("18446744073709551616")],gZe=Array.from({length:256}).map((t,e)=>BigInt(e)),awe=new Float64Array(1),owe=new DataView(awe.buffer),swe=new Uint8Array(awe.buffer);function*lwe(t){let e=t===0?1:Math.ceil(Math.floor(Math.log2(t)+1)/8);for(let r=0;r<e;r++)yield t>>8*(e-1-r)&255}s(lwe,"NumberToBytes");function uwe(t){ul(Mc.Array);for(let e of t)rv(e)}s(uwe,"ArrayType");function cwe(t){ul(Mc.Boolean),ul(t?1:0)}s(cwe,"BooleanType");function hwe(t){ul(Mc.BigInt),owe.setBigInt64(0,t);for(let e of swe)ul(e)}s(hwe,"BigIntType");function pwe(t){ul(Mc.Date),rv(t.getTime())}s(pwe,"DateType");function dwe(t){ul(Mc.Null)}s(dwe,"NullType");function fwe(t){ul(Mc.Number),owe.setFloat64(0,t);for(let e of swe)ul(e)}s(fwe,"NumberType");function mwe(t){ul(Mc.Object);for(let e of globalThis.Object.getOwnPropertyNames(t).sort())rv(e),rv(t[e])}s(mwe,"ObjectType");function gwe(t){ul(Mc.String);for(let e=0;e<t.length;e++)for(let r of lwe(t.charCodeAt(e)))ul(r)}s(gwe,"StringType");function ywe(t){ul(Mc.Symbol),rv(t.description)}s(ywe,"SymbolType");function vwe(t){ul(Mc.Uint8Array);for(let e=0;e<t.length;e++)ul(t[e])}s(vwe,"Uint8ArrayType");function _we(t){return ul(Mc.Undefined)}s(_we,"UndefinedType");function rv(t){if(zn(t))return uwe(t);if(yv(t))return cwe(t);if(fc(t))return hwe(t);if(Mf(t))return pwe(t);if(vx(t))return dwe();if(bi(t))return fwe(t);if(kn(t))return mwe(t);if(_a(t))return gwe(t);if(_x(t))return ywe(t);if(a5(t))return vwe(t);if(Hu(t))return _we();throw new dZe(t)}s(rv,"Visit");function ul(t){U1=U1^gZe[t],U1=U1*fZe%mZe}s(ul,"FNV1A64");function hS(t){return U1=BigInt("14695981039346656037"),rv(t),U1}s(hS,"Hash");N();var xwe=class extends Ia{constructor(e){super("Unknown type"),this.schema=e}};s(xwe,"ValueCheckUnknownTypeError");var yZe=xwe;function bwe(t){return t[br]==="Any"||t[br]==="Unknown"}s(bwe,"IsAnyOrUnknown");function dn(t){return t!==void 0}s(dn,"IsDefined");function wwe(t,e,r){return!0}s(wwe,"FromAny");function Awe(t,e,r){if(!zn(r)||dn(t.minItems)&&!(r.length>=t.minItems)||dn(t.maxItems)&&!(r.length<=t.maxItems)||!r.every(a=>Us(t.items,e,a))||t.uniqueItems===!0&&!function(){let a=new Set;for(let o of r){let l=hS(o);if(a.has(l))return!1;a.add(l)}return!0}())return!1;if(!(dn(t.contains)||bi(t.minContains)||bi(t.maxContains)))return!0;let i=dn(t.contains)?t.contains:cl(),n=r.reduce((a,o)=>Us(i,e,o)?a+1:a,0);return!(n===0||bi(t.minContains)&&n<t.minContains||bi(t.maxContains)&&n>t.maxContains)}s(Awe,"FromArray");function Swe(t,e,r){return Cz(r)}s(Swe,"FromAsyncIterator");function Mwe(t,e,r){return!(!fc(r)||dn(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||dn(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||dn(t.maximum)&&!(r<=t.maximum)||dn(t.minimum)&&!(r>=t.minimum)||dn(t.multipleOf)&&r%t.multipleOf!==BigInt(0))}s(Mwe,"FromBigInt");function Ewe(t,e,r){return yv(r)}s(Ewe,"FromBoolean");function Cwe(t,e,r){return Us(t.returns,e,r.prototype)}s(Cwe,"FromConstructor");function Iwe(t,e,r){return!(!Mf(r)||dn(t.exclusiveMaximumTimestamp)&&!(r.getTime()<t.exclusiveMaximumTimestamp)||dn(t.exclusiveMinimumTimestamp)&&!(r.getTime()>t.exclusiveMinimumTimestamp)||dn(t.maximumTimestamp)&&!(r.getTime()<=t.maximumTimestamp)||dn(t.minimumTimestamp)&&!(r.getTime()>=t.minimumTimestamp)||dn(t.multipleOfTimestamp)&&r.getTime()%t.multipleOfTimestamp!==0)}s(Iwe,"FromDate");function Twe(t,e,r){return JA(r)}s(Twe,"FromFunction");function Pwe(t,e,r){return!(!Lz(r)||dn(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||dn(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||dn(t.maximum)&&!(r<=t.maximum)||dn(t.minimum)&&!(r>=t.minimum)||dn(t.multipleOf)&&r%t.multipleOf!==0)}s(Pwe,"FromInteger");function Lwe(t,e,r){let i=t.allOf.every(n=>Us(n,e,r));if(t.unevaluatedProperties===!1){let n=new RegExp(ev(t)),a=Object.getOwnPropertyNames(r).every(o=>n.test(o));return i&&a}else if(Hn(t.unevaluatedProperties)){let n=new RegExp(ev(t)),a=Object.getOwnPropertyNames(r).every(o=>n.test(o)||Us(t.unevaluatedProperties,e,r[o]));return i&&a}else return i}s(Lwe,"FromIntersect");function Dwe(t,e,r){return Iz(r)}s(Dwe,"FromIterator");function Rwe(t,e,r){return r===t.const}s(Rwe,"FromLiteral");function Owe(t,e,r){return!1}s(Owe,"FromNever");function kwe(t,e,r){return!Us(t.not,e,r)}s(kwe,"FromNot");function Nwe(t,e,r){return vx(r)}s(Nwe,"FromNull");function Fwe(t,e,r){return!(!Io.IsNumberLike(r)||dn(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||dn(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||dn(t.minimum)&&!(r>=t.minimum)||dn(t.maximum)&&!(r<=t.maximum)||dn(t.multipleOf)&&r%t.multipleOf!==0)}s(Fwe,"FromNumber");function Bwe(t,e,r){if(!Io.IsObjectLike(r)||dn(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||dn(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let i=Object.getOwnPropertyNames(t.properties);for(let n of i){let a=t.properties[n];if(t.required&&t.required.includes(n)){if(!Us(a,e,r[n])||(Sv(a)||bwe(a))&&!(n in r))return!1}else if(Io.IsExactOptionalProperty(r,n)&&!Us(a,e,r[n]))return!1}if(t.additionalProperties===!1){let n=Object.getOwnPropertyNames(r);return t.required&&t.required.length===i.length&&n.length===i.length?!0:n.every(a=>i.includes(a))}else return typeof t.additionalProperties=="object"?Object.getOwnPropertyNames(r).every(n=>i.includes(n)||Us(t.additionalProperties,e,r[n])):!0}s(Bwe,"FromObject");function zwe(t,e,r){return Pz(r)}s(zwe,"FromPromise");function Uwe(t,e,r){if(!Io.IsRecordLike(r)||dn(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||dn(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let[i,n]=Object.entries(t.patternProperties)[0],a=new RegExp(i),o=Object.entries(r).every(([c,p])=>a.test(c)?Us(n,e,p):!0),l=typeof t.additionalProperties=="object"?Object.entries(r).every(([c,p])=>a.test(c)?!0:Us(t.additionalProperties,e,p)):!0,u=t.additionalProperties===!1?Object.getOwnPropertyNames(r).every(c=>a.test(c)):!0;return o&&l&&u}s(Uwe,"FromRecord");function Vwe(t,e,r){return Us(oo(t,e),e,r)}s(Vwe,"FromRef");function jwe(t,e,r){let i=new RegExp(t.source,t.flags);return dn(t.minLength)&&!(r.length>=t.minLength)||dn(t.maxLength)&&!(r.length<=t.maxLength)?!1:i.test(r)}s(jwe,"FromRegExp");function $we(t,e,r){return!_a(r)||dn(t.minLength)&&!(r.length>=t.minLength)||dn(t.maxLength)&&!(r.length<=t.maxLength)||dn(t.pattern)&&!new RegExp(t.pattern).test(r)?!1:dn(t.format)?_f.Has(t.format)?_f.Get(t.format)(r):!1:!0}s($we,"FromString");function Gwe(t,e,r){return _x(r)}s(Gwe,"FromSymbol");function Hwe(t,e,r){return _a(r)&&new RegExp(t.pattern).test(r)}s(Hwe,"FromTemplateLiteral");function qwe(t,e,r){return Us(oo(t,e),e,r)}s(qwe,"FromThis");function Wwe(t,e,r){if(!zn(r)||t.items===void 0&&r.length!==0||r.length!==t.maxItems)return!1;if(!t.items)return!0;for(let i=0;i<t.items.length;i++)if(!Us(t.items[i],e,r[i]))return!1;return!0}s(Wwe,"FromTuple");function Xwe(t,e,r){return Hu(r)}s(Xwe,"FromUndefined");function Zwe(t,e,r){return t.anyOf.some(i=>Us(i,e,r))}s(Zwe,"FromUnion");function Ywe(t,e,r){return!(!a5(r)||dn(t.maxByteLength)&&!(r.length<=t.maxByteLength)||dn(t.minByteLength)&&!(r.length>=t.minByteLength))}s(Ywe,"FromUint8Array");function Kwe(t,e,r){return!0}s(Kwe,"FromUnknown");function Jwe(t,e,r){return Io.IsVoidLike(r)}s(Jwe,"FromVoid");function Qwe(t,e,r){return rh.Has(t[br])?rh.Get(t[br])(t,r):!1}s(Qwe,"FromKind");function Us(t,e,r){let i=dn(t.$id)?[...e,t]:e,n=t;switch(n[br]){case"Any":return wwe();case"Array":return Awe(n,i,r);case"AsyncIterator":return Swe(n,i,r);case"BigInt":return Mwe(n,i,r);case"Boolean":return Ewe(n,i,r);case"Constructor":return Cwe(n,i,r);case"Date":return Iwe(n,i,r);case"Function":return Twe(n,i,r);case"Integer":return Pwe(n,i,r);case"Intersect":return Lwe(n,i,r);case"Iterator":return Dwe(n,i,r);case"Literal":return Rwe(n,i,r);case"Never":return Owe();case"Not":return kwe(n,i,r);case"Null":return Nwe(n,i,r);case"Number":return Fwe(n,i,r);case"Object":return Bwe(n,i,r);case"Promise":return zwe(n,i,r);case"Record":return Uwe(n,i,r);case"Ref":return Vwe(n,i,r);case"RegExp":return jwe(n,i,r);case"String":return $we(n,i,r);case"Symbol":return Gwe(n,i,r);case"TemplateLiteral":return Hwe(n,i,r);case"This":return qwe(n,i,r);case"Tuple":return Wwe(n,i,r);case"Undefined":return Xwe(n,i,r);case"Union":return Zwe(n,i,r);case"Uint8Array":return Ywe(n,i,r);case"Unknown":return Kwe();case"Void":return Jwe(n,i,r);default:if(!rh.Has(n[br]))throw new yZe(n);return Qwe(n,i,r)}}s(Us,"Visit");function ba(...t){return t.length===3?Us(t[0],t[1],t[2]):Us(t[0],[],t[1])}s(ba,"Check");var Bt;(function(t){t[t.ArrayContains=0]="ArrayContains",t[t.ArrayMaxContains=1]="ArrayMaxContains",t[t.ArrayMaxItems=2]="ArrayMaxItems",t[t.ArrayMinContains=3]="ArrayMinContains",t[t.ArrayMinItems=4]="ArrayMinItems",t[t.ArrayUniqueItems=5]="ArrayUniqueItems",t[t.Array=6]="Array",t[t.AsyncIterator=7]="AsyncIterator",t[t.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",t[t.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",t[t.BigIntMaximum=10]="BigIntMaximum",t[t.BigIntMinimum=11]="BigIntMinimum",t[t.BigIntMultipleOf=12]="BigIntMultipleOf",t[t.BigInt=13]="BigInt",t[t.Boolean=14]="Boolean",t[t.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",t[t.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",t[t.DateMaximumTimestamp=17]="DateMaximumTimestamp",t[t.DateMinimumTimestamp=18]="DateMinimumTimestamp",t[t.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",t[t.Date=20]="Date",t[t.Function=21]="Function",t[t.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",t[t.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",t[t.IntegerMaximum=24]="IntegerMaximum",t[t.IntegerMinimum=25]="IntegerMinimum",t[t.IntegerMultipleOf=26]="IntegerMultipleOf",t[t.Integer=27]="Integer",t[t.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",t[t.Intersect=29]="Intersect",t[t.Iterator=30]="Iterator",t[t.Kind=31]="Kind",t[t.Literal=32]="Literal",t[t.Never=33]="Never",t[t.Not=34]="Not",t[t.Null=35]="Null",t[t.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",t[t.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",t[t.NumberMaximum=38]="NumberMaximum",t[t.NumberMinimum=39]="NumberMinimum",t[t.NumberMultipleOf=40]="NumberMultipleOf",t[t.Number=41]="Number",t[t.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",t[t.ObjectMaxProperties=43]="ObjectMaxProperties",t[t.ObjectMinProperties=44]="ObjectMinProperties",t[t.ObjectRequiredProperty=45]="ObjectRequiredProperty",t[t.Object=46]="Object",t[t.Promise=47]="Promise",t[t.RegExp=48]="RegExp",t[t.StringFormatUnknown=49]="StringFormatUnknown",t[t.StringFormat=50]="StringFormat",t[t.StringMaxLength=51]="StringMaxLength",t[t.StringMinLength=52]="StringMinLength",t[t.StringPattern=53]="StringPattern",t[t.String=54]="String",t[t.Symbol=55]="Symbol",t[t.TupleLength=56]="TupleLength",t[t.Tuple=57]="Tuple",t[t.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",t[t.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",t[t.Uint8Array=60]="Uint8Array",t[t.Undefined=61]="Undefined",t[t.Union=62]="Union",t[t.Void=63]="Void"})(Bt||(Bt={}));var eAe=class extends Ia{constructor(e){super("Unknown type"),this.schema=e}};s(eAe,"ValueErrorsUnknownTypeError");var vZe=eAe;function Dp(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}s(Dp,"EscapeKey");function pn(t){return t!==void 0}s(pn,"IsDefined");var tAe=class{constructor(e){this.iterator=e}[Symbol.iterator](){return this.iterator}First(){let e=this.iterator.next();return e.done?void 0:e.value}};s(tAe,"ValueErrorIterator");var Dx=tAe;function Tr(t,e,r,i,n=[]){return{type:t,schema:e,path:r,value:i,message:twe()({errorType:t,path:r,schema:e,value:i,errors:n}),errors:n}}s(Tr,"Create");function*rAe(t,e,r,i){}s(rAe,"FromAny");function*iAe(t,e,r,i){if(!zn(i))return yield Tr(Bt.Array,t,r,i);pn(t.minItems)&&!(i.length>=t.minItems)&&(yield Tr(Bt.ArrayMinItems,t,r,i)),pn(t.maxItems)&&!(i.length<=t.maxItems)&&(yield Tr(Bt.ArrayMaxItems,t,r,i));for(let o=0;o<i.length;o++)yield*vr(Vs(t.items,e,"".concat(r,"/").concat(o),i[o]));if(t.uniqueItems===!0&&!function(){let o=new Set;for(let l of i){let u=hS(l);if(o.has(u))return!1;o.add(u)}return!0}()&&(yield Tr(Bt.ArrayUniqueItems,t,r,i)),!(pn(t.contains)||pn(t.minContains)||pn(t.maxContains)))return;let n=pn(t.contains)?t.contains:cl(),a=i.reduce((o,l,u)=>Vs(n,e,"".concat(r).concat(u),l).next().done===!0?o+1:o,0);a===0&&(yield Tr(Bt.ArrayContains,t,r,i)),bi(t.minContains)&&a<t.minContains&&(yield Tr(Bt.ArrayMinContains,t,r,i)),bi(t.maxContains)&&a>t.maxContains&&(yield Tr(Bt.ArrayMaxContains,t,r,i))}s(iAe,"FromArray");function*nAe(t,e,r,i){Cz(i)||(yield Tr(Bt.AsyncIterator,t,r,i))}s(nAe,"FromAsyncIterator");function*aAe(t,e,r,i){if(!fc(i))return yield Tr(Bt.BigInt,t,r,i);pn(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)&&(yield Tr(Bt.BigIntExclusiveMaximum,t,r,i)),pn(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)&&(yield Tr(Bt.BigIntExclusiveMinimum,t,r,i)),pn(t.maximum)&&!(i<=t.maximum)&&(yield Tr(Bt.BigIntMaximum,t,r,i)),pn(t.minimum)&&!(i>=t.minimum)&&(yield Tr(Bt.BigIntMinimum,t,r,i)),pn(t.multipleOf)&&i%t.multipleOf!==BigInt(0)&&(yield Tr(Bt.BigIntMultipleOf,t,r,i))}s(aAe,"FromBigInt");function*oAe(t,e,r,i){yv(i)||(yield Tr(Bt.Boolean,t,r,i))}s(oAe,"FromBoolean");function*sAe(t,e,r,i){yield*vr(Vs(t.returns,e,r,i.prototype))}s(sAe,"FromConstructor");function*lAe(t,e,r,i){if(!Mf(i))return yield Tr(Bt.Date,t,r,i);pn(t.exclusiveMaximumTimestamp)&&!(i.getTime()<t.exclusiveMaximumTimestamp)&&(yield Tr(Bt.DateExclusiveMaximumTimestamp,t,r,i)),pn(t.exclusiveMinimumTimestamp)&&!(i.getTime()>t.exclusiveMinimumTimestamp)&&(yield Tr(Bt.DateExclusiveMinimumTimestamp,t,r,i)),pn(t.maximumTimestamp)&&!(i.getTime()<=t.maximumTimestamp)&&(yield Tr(Bt.DateMaximumTimestamp,t,r,i)),pn(t.minimumTimestamp)&&!(i.getTime()>=t.minimumTimestamp)&&(yield Tr(Bt.DateMinimumTimestamp,t,r,i)),pn(t.multipleOfTimestamp)&&i.getTime()%t.multipleOfTimestamp!==0&&(yield Tr(Bt.DateMultipleOfTimestamp,t,r,i))}s(lAe,"FromDate");function*uAe(t,e,r,i){JA(i)||(yield Tr(Bt.Function,t,r,i))}s(uAe,"FromFunction");function*cAe(t,e,r,i){if(!Lz(i))return yield Tr(Bt.Integer,t,r,i);pn(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)&&(yield Tr(Bt.IntegerExclusiveMaximum,t,r,i)),pn(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)&&(yield Tr(Bt.IntegerExclusiveMinimum,t,r,i)),pn(t.maximum)&&!(i<=t.maximum)&&(yield Tr(Bt.IntegerMaximum,t,r,i)),pn(t.minimum)&&!(i>=t.minimum)&&(yield Tr(Bt.IntegerMinimum,t,r,i)),pn(t.multipleOf)&&i%t.multipleOf!==0&&(yield Tr(Bt.IntegerMultipleOf,t,r,i))}s(cAe,"FromInteger");function*hAe(t,e,r,i){let n=!1;for(let a of t.allOf)for(let o of Vs(a,e,r,i))n=!0,yield o;if(n)return yield Tr(Bt.Intersect,t,r,i);if(t.unevaluatedProperties===!1){let a=new RegExp(ev(t));for(let o of Object.getOwnPropertyNames(i))a.test(o)||(yield Tr(Bt.IntersectUnevaluatedProperties,t,"".concat(r,"/").concat(o),i))}if(typeof t.unevaluatedProperties=="object"){let a=new RegExp(ev(t));for(let o of Object.getOwnPropertyNames(i))if(!a.test(o)){let l=Vs(t.unevaluatedProperties,e,"".concat(r,"/").concat(o),i[o]).next();l.done||(yield l.value)}}}s(hAe,"FromIntersect");function*pAe(t,e,r,i){Iz(i)||(yield Tr(Bt.Iterator,t,r,i))}s(pAe,"FromIterator");function*dAe(t,e,r,i){i!==t.const&&(yield Tr(Bt.Literal,t,r,i))}s(dAe,"FromLiteral");function*fAe(t,e,r,i){yield Tr(Bt.Never,t,r,i)}s(fAe,"FromNever");function*mAe(t,e,r,i){Vs(t.not,e,r,i).next().done===!0&&(yield Tr(Bt.Not,t,r,i))}s(mAe,"FromNot");function*gAe(t,e,r,i){vx(i)||(yield Tr(Bt.Null,t,r,i))}s(gAe,"FromNull");function*yAe(t,e,r,i){if(!Io.IsNumberLike(i))return yield Tr(Bt.Number,t,r,i);pn(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)&&(yield Tr(Bt.NumberExclusiveMaximum,t,r,i)),pn(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)&&(yield Tr(Bt.NumberExclusiveMinimum,t,r,i)),pn(t.maximum)&&!(i<=t.maximum)&&(yield Tr(Bt.NumberMaximum,t,r,i)),pn(t.minimum)&&!(i>=t.minimum)&&(yield Tr(Bt.NumberMinimum,t,r,i)),pn(t.multipleOf)&&i%t.multipleOf!==0&&(yield Tr(Bt.NumberMultipleOf,t,r,i))}s(yAe,"FromNumber");function*vAe(t,e,r,i){if(!Io.IsObjectLike(i))return yield Tr(Bt.Object,t,r,i);pn(t.minProperties)&&!(Object.getOwnPropertyNames(i).length>=t.minProperties)&&(yield Tr(Bt.ObjectMinProperties,t,r,i)),pn(t.maxProperties)&&!(Object.getOwnPropertyNames(i).length<=t.maxProperties)&&(yield Tr(Bt.ObjectMaxProperties,t,r,i));let n=Array.isArray(t.required)?t.required:[],a=Object.getOwnPropertyNames(t.properties),o=Object.getOwnPropertyNames(i);for(let l of n)o.includes(l)||(yield Tr(Bt.ObjectRequiredProperty,t.properties[l],"".concat(r,"/").concat(Dp(l)),void 0));if(t.additionalProperties===!1)for(let l of o)a.includes(l)||(yield Tr(Bt.ObjectAdditionalProperties,t,"".concat(r,"/").concat(Dp(l)),i[l]));if(typeof t.additionalProperties=="object")for(let l of o)a.includes(l)||(yield*vr(Vs(t.additionalProperties,e,"".concat(r,"/").concat(Dp(l)),i[l])));for(let l of a){let u=t.properties[l];t.required&&t.required.includes(l)?(yield*vr(Vs(u,e,"".concat(r,"/").concat(Dp(l)),i[l])),Sv(t)&&!(l in i)&&(yield Tr(Bt.ObjectRequiredProperty,u,"".concat(r,"/").concat(Dp(l)),void 0))):Io.IsExactOptionalProperty(i,l)&&(yield*vr(Vs(u,e,"".concat(r,"/").concat(Dp(l)),i[l])))}}s(vAe,"FromObject");function*_Ae(t,e,r,i){Pz(i)||(yield Tr(Bt.Promise,t,r,i))}s(_Ae,"FromPromise");function*xAe(t,e,r,i){if(!Io.IsRecordLike(i))return yield Tr(Bt.Object,t,r,i);pn(t.minProperties)&&!(Object.getOwnPropertyNames(i).length>=t.minProperties)&&(yield Tr(Bt.ObjectMinProperties,t,r,i)),pn(t.maxProperties)&&!(Object.getOwnPropertyNames(i).length<=t.maxProperties)&&(yield Tr(Bt.ObjectMaxProperties,t,r,i));let[n,a]=Object.entries(t.patternProperties)[0],o=new RegExp(n);for(let[l,u]of Object.entries(i))o.test(l)&&(yield*vr(Vs(a,e,"".concat(r,"/").concat(Dp(l)),u)));if(typeof t.additionalProperties=="object")for(let[l,u]of Object.entries(i))o.test(l)||(yield*vr(Vs(t.additionalProperties,e,"".concat(r,"/").concat(Dp(l)),u)));if(t.additionalProperties===!1){for(let[l,u]of Object.entries(i))if(!o.test(l))return yield Tr(Bt.ObjectAdditionalProperties,t,"".concat(r,"/").concat(Dp(l)),u)}}s(xAe,"FromRecord");function*bAe(t,e,r,i){yield*vr(Vs(oo(t,e),e,r,i))}s(bAe,"FromRef");function*wAe(t,e,r,i){if(!_a(i))return yield Tr(Bt.String,t,r,i);if(pn(t.minLength)&&!(i.length>=t.minLength)&&(yield Tr(Bt.StringMinLength,t,r,i)),pn(t.maxLength)&&!(i.length<=t.maxLength)&&(yield Tr(Bt.StringMaxLength,t,r,i)),!new RegExp(t.source,t.flags).test(i))return yield Tr(Bt.RegExp,t,r,i)}s(wAe,"FromRegExp");function*AAe(t,e,r,i){if(!_a(i))return yield Tr(Bt.String,t,r,i);pn(t.minLength)&&!(i.length>=t.minLength)&&(yield Tr(Bt.StringMinLength,t,r,i)),pn(t.maxLength)&&!(i.length<=t.maxLength)&&(yield Tr(Bt.StringMaxLength,t,r,i)),_a(t.pattern)&&(new RegExp(t.pattern).test(i)||(yield Tr(Bt.StringPattern,t,r,i))),_a(t.format)&&(_f.Has(t.format)?_f.Get(t.format)(i)||(yield Tr(Bt.StringFormat,t,r,i)):yield Tr(Bt.StringFormatUnknown,t,r,i))}s(AAe,"FromString");function*SAe(t,e,r,i){_x(i)||(yield Tr(Bt.Symbol,t,r,i))}s(SAe,"FromSymbol");function*MAe(t,e,r,i){if(!_a(i))return yield Tr(Bt.String,t,r,i);new RegExp(t.pattern).test(i)||(yield Tr(Bt.StringPattern,t,r,i))}s(MAe,"FromTemplateLiteral");function*EAe(t,e,r,i){yield*vr(Vs(oo(t,e),e,r,i))}s(EAe,"FromThis");function*CAe(t,e,r,i){if(!zn(i))return yield Tr(Bt.Tuple,t,r,i);if(t.items===void 0&&i.length!==0)return yield Tr(Bt.TupleLength,t,r,i);if(i.length!==t.maxItems)return yield Tr(Bt.TupleLength,t,r,i);if(t.items)for(let n=0;n<t.items.length;n++)yield*vr(Vs(t.items[n],e,"".concat(r,"/").concat(n),i[n]))}s(CAe,"FromTuple");function*IAe(t,e,r,i){Hu(i)||(yield Tr(Bt.Undefined,t,r,i))}s(IAe,"FromUndefined");function*TAe(t,e,r,i){if(ba(t,e,i))return;let n=t.anyOf.map(a=>new Dx(Vs(a,e,r,i)));yield Tr(Bt.Union,t,r,i,n)}s(TAe,"FromUnion");function*PAe(t,e,r,i){if(!a5(i))return yield Tr(Bt.Uint8Array,t,r,i);pn(t.maxByteLength)&&!(i.length<=t.maxByteLength)&&(yield Tr(Bt.Uint8ArrayMaxByteLength,t,r,i)),pn(t.minByteLength)&&!(i.length>=t.minByteLength)&&(yield Tr(Bt.Uint8ArrayMinByteLength,t,r,i))}s(PAe,"FromUint8Array");function*LAe(t,e,r,i){}s(LAe,"FromUnknown");function*DAe(t,e,r,i){Io.IsVoidLike(i)||(yield Tr(Bt.Void,t,r,i))}s(DAe,"FromVoid");function*RAe(t,e,r,i){rh.Get(t[br])(t,i)||(yield Tr(Bt.Kind,t,r,i))}s(RAe,"FromKind");function*Vs(t,e,r,i){let n=pn(t.$id)?[...e,t]:e,a=t;switch(a[br]){case"Any":return yield*vr(rAe());case"Array":return yield*vr(iAe(a,n,r,i));case"AsyncIterator":return yield*vr(nAe(a,n,r,i));case"BigInt":return yield*vr(aAe(a,n,r,i));case"Boolean":return yield*vr(oAe(a,n,r,i));case"Constructor":return yield*vr(sAe(a,n,r,i));case"Date":return yield*vr(lAe(a,n,r,i));case"Function":return yield*vr(uAe(a,n,r,i));case"Integer":return yield*vr(cAe(a,n,r,i));case"Intersect":return yield*vr(hAe(a,n,r,i));case"Iterator":return yield*vr(pAe(a,n,r,i));case"Literal":return yield*vr(dAe(a,n,r,i));case"Never":return yield*vr(fAe(a,n,r,i));case"Not":return yield*vr(mAe(a,n,r,i));case"Null":return yield*vr(gAe(a,n,r,i));case"Number":return yield*vr(yAe(a,n,r,i));case"Object":return yield*vr(vAe(a,n,r,i));case"Promise":return yield*vr(_Ae(a,n,r,i));case"Record":return yield*vr(xAe(a,n,r,i));case"Ref":return yield*vr(bAe(a,n,r,i));case"RegExp":return yield*vr(wAe(a,n,r,i));case"String":return yield*vr(AAe(a,n,r,i));case"Symbol":return yield*vr(SAe(a,n,r,i));case"TemplateLiteral":return yield*vr(MAe(a,n,r,i));case"This":return yield*vr(EAe(a,n,r,i));case"Tuple":return yield*vr(CAe(a,n,r,i));case"Undefined":return yield*vr(IAe(a,n,r,i));case"Union":return yield*vr(TAe(a,n,r,i));case"Uint8Array":return yield*vr(PAe(a,n,r,i));case"Unknown":return yield*vr(LAe());case"Void":return yield*vr(DAe(a,n,r,i));default:if(!rh.Has(a[br]))throw new vZe(t);return yield*vr(RAe(a,n,r,i))}}s(Vs,"Visit");function Rx(...t){let e=t.length===3?Vs(t[0],t[1],"",t[2]):Vs(t[0],[],"",t[1]);return new Dx(e)}s(Rx,"Errors");N();var _Ze=function(t,e,r,i,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},OAe=function(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)},Gk,ST,kAe,NAe=class extends Ia{constructor(e){let r=e.First();super(r===void 0?"Invalid Value":r.message),Gk.add(this),ST.set(this,void 0),_Ze(this,ST,e),this.error=r}Errors(){return new Dx(OAe(this,Gk,"m",kAe).call(this))}};s(NAe,"AssertError");var xZe=NAe;ST=new WeakMap,Gk=new WeakSet,kAe=s(function*(){this.error&&(yield this.error),yield*vr(OAe(this,ST,"f"))},"_AssertError_Iterator");function Hk(t,e,r){if(!ba(t,e,r))throw new xZe(Rx(t,e,r))}s(Hk,"AssertValue");function hV(...t){return t.length===3?Hk(t[0],t[1],t[2]):Hk(t[0],[],t[1])}s(hV,"Assert");N();N();N();function FAe(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=Ra(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=Ra(t[r]);return e}s(FAe,"FromObject");function BAe(t){return t.map(e=>Ra(e))}s(BAe,"FromArray");function zAe(t){return t.slice()}s(zAe,"FromTypedArray");function UAe(t){return new Map(Ra([...t.entries()]))}s(UAe,"FromMap");function VAe(t){return new Set(Ra([...t.entries()]))}s(VAe,"FromSet");function jAe(t){return new Date(t.toISOString())}s(jAe,"FromDate");function Ra(t){if(zn(t))return BAe(t);if(Mf(t))return jAe(t);if(Ef(t))return zAe(t);if(p0e(t))return UAe(t);if(d0e(t))return VAe(t);if(kn(t))return FAe(t);if(od(t))return t;throw new Error("ValueClone: Unable to clone value")}s(Ra,"Clone");var $Ae=class extends Ia{constructor(e,r){super(r),this.schema=e}};s($Ae,"ValueCreateError");var jh=$Ae;function Sn(t){return JA(t)?t():Ra(t)}s(Sn,"FromDefault");function GAe(t,e){return ki(t,"default")?Sn(t.default):{}}s(GAe,"FromAny");function HAe(t,e){if(t.uniqueItems===!0&&!ki(t,"default"))throw new jh(t,"Array with the uniqueItems constraint requires a default value");if("contains"in t&&!ki(t,"default"))throw new jh(t,"Array with the contains constraint requires a default value");return"default"in t?Sn(t.default):t.minItems!==void 0?Array.from({length:t.minItems}).map(r=>Uu(t.items,e)):[]}s(HAe,"FromArray");function qAe(t,e){return ki(t,"default")?Sn(t.default):function(){return iOe(this,null,function*(){})}()}s(qAe,"FromAsyncIterator");function WAe(t,e){return ki(t,"default")?Sn(t.default):BigInt(0)}s(WAe,"FromBigInt");function XAe(t,e){return ki(t,"default")?Sn(t.default):!1}s(XAe,"FromBoolean");function ZAe(t,e){if(ki(t,"default"))return Sn(t.default);{let r=Uu(t.returns,e);return typeof r=="object"&&!Array.isArray(r)?class{constructor(){for(let[i,n]of Object.entries(r)){let a=this;a[i]=n}}}:class{}}}s(ZAe,"FromConstructor");function YAe(t,e){return ki(t,"default")?Sn(t.default):t.minimumTimestamp!==void 0?new Date(t.minimumTimestamp):new Date}s(YAe,"FromDate");function KAe(t,e){return ki(t,"default")?Sn(t.default):()=>Uu(t.returns,e)}s(KAe,"FromFunction");function JAe(t,e){return ki(t,"default")?Sn(t.default):t.minimum!==void 0?t.minimum:0}s(JAe,"FromInteger");function QAe(t,e){if(ki(t,"default"))return Sn(t.default);{let r=t.allOf.reduce((i,n)=>{let a=Uu(n,e);return typeof a=="object"?Ee(Ee({},i),a):a},{});if(!ba(t,e,r))throw new jh(t,"Intersect produced invalid value. Consider using a default value.");return r}}s(QAe,"FromIntersect");function eSe(t,e){return ki(t,"default")?Sn(t.default):function*(){}()}s(eSe,"FromIterator");function tSe(t,e){return ki(t,"default")?Sn(t.default):t.const}s(tSe,"FromLiteral");function rSe(t,e){if(ki(t,"default"))return Sn(t.default);throw new jh(t,"Never types cannot be created. Consider using a default value.")}s(rSe,"FromNever");function iSe(t,e){if(ki(t,"default"))return Sn(t.default);throw new jh(t,"Not types must have a default value")}s(iSe,"FromNot");function nSe(t,e){return ki(t,"default")?Sn(t.default):null}s(nSe,"FromNull");function aSe(t,e){return ki(t,"default")?Sn(t.default):t.minimum!==void 0?t.minimum:0}s(aSe,"FromNumber");function oSe(t,e){if(ki(t,"default"))return Sn(t.default);{let r=new Set(t.required),i={};for(let[n,a]of Object.entries(t.properties))r.has(n)&&(i[n]=Uu(a,e));return i}}s(oSe,"FromObject");function sSe(t,e){return ki(t,"default")?Sn(t.default):Promise.resolve(Uu(t.item,e))}s(sSe,"FromPromise");function lSe(t,e){let[r,i]=Object.entries(t.patternProperties)[0];if(ki(t,"default"))return Sn(t.default);if(r===V_||r===U_)return{};{let n=r.slice(1,r.length-1).split("|"),a={};for(let o of n)a[o]=Uu(i,e);return a}}s(lSe,"FromRecord");function uSe(t,e){return ki(t,"default")?Sn(t.default):Uu(oo(t,e),e)}s(uSe,"FromRef");function cSe(t,e){if(ki(t,"default"))return Sn(t.default);throw new jh(t,"RegExp types cannot be created. Consider using a default value.")}s(cSe,"FromRegExp");function hSe(t,e){if(t.pattern!==void 0){if(ki(t,"default"))return Sn(t.default);throw new jh(t,"String types with patterns must specify a default value")}else if(t.format!==void 0){if(ki(t,"default"))return Sn(t.default);throw new jh(t,"String types with formats must specify a default value")}else return ki(t,"default")?Sn(t.default):t.minLength!==void 0?Array.from({length:t.minLength}).map(()=>" ").join(""):""}s(hSe,"FromString");function pSe(t,e){return ki(t,"default")?Sn(t.default):"value"in t?Symbol.for(t.value):Symbol()}s(pSe,"FromSymbol");function dSe(t,e){if(ki(t,"default"))return Sn(t.default);if(!EU(t))throw new jh(t,"Can only create template literals that produce a finite variants. Consider using a default value.");return v5(t)[0]}s(dSe,"FromTemplateLiteral");function fSe(t,e){if(wSe++>bZe)throw new jh(t,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");return ki(t,"default")?Sn(t.default):Uu(oo(t,e),e)}s(fSe,"FromThis");function mSe(t,e){return ki(t,"default")?Sn(t.default):t.items===void 0?[]:Array.from({length:t.minItems}).map((r,i)=>Uu(t.items[i],e))}s(mSe,"FromTuple");function gSe(t,e){if(ki(t,"default"))return Sn(t.default)}s(gSe,"FromUndefined");function ySe(t,e){if(ki(t,"default"))return Sn(t.default);if(t.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");return Uu(t.anyOf[0],e)}s(ySe,"FromUnion");function vSe(t,e){return ki(t,"default")?Sn(t.default):t.minByteLength!==void 0?new Uint8Array(t.minByteLength):new Uint8Array(0)}s(vSe,"FromUint8Array");function _Se(t,e){return ki(t,"default")?Sn(t.default):{}}s(_Se,"FromUnknown");function xSe(t,e){if(ki(t,"default"))return Sn(t.default)}s(xSe,"FromVoid");function bSe(t,e){if(ki(t,"default"))return Sn(t.default);throw new Error("User defined types must specify a default value")}s(bSe,"FromKind");function Uu(t,e){let r=Iv(t,e),i=t;switch(i[br]){case"Any":return GAe(i);case"Array":return HAe(i,r);case"AsyncIterator":return qAe(i);case"BigInt":return WAe(i);case"Boolean":return XAe(i);case"Constructor":return ZAe(i,r);case"Date":return YAe(i);case"Function":return KAe(i,r);case"Integer":return JAe(i);case"Intersect":return QAe(i,r);case"Iterator":return eSe(i);case"Literal":return tSe(i);case"Never":return rSe(i);case"Not":return iSe(i);case"Null":return nSe(i);case"Number":return aSe(i);case"Object":return oSe(i,r);case"Promise":return sSe(i,r);case"Record":return lSe(i,r);case"Ref":return uSe(i,r);case"RegExp":return cSe(i);case"String":return hSe(i);case"Symbol":return pSe(i);case"TemplateLiteral":return dSe(i);case"This":return fSe(i,r);case"Tuple":return mSe(i,r);case"Undefined":return gSe(i);case"Union":return ySe(i,r);case"Uint8Array":return vSe(i);case"Unknown":return _Se(i);case"Void":return xSe(i);default:if(!rh.Has(i[br]))throw new jh(i,"Unknown type");return bSe(i)}}s(Uu,"Visit");var bZe=512,wSe=0;function $h(...t){return wSe=0,t.length===2?Uu(t[0],t[1]):Uu(t[0],[])}s($h,"Create");var ASe=class extends Ia{constructor(e,r){super(r),this.schema=e}};s(ASe,"ValueCastError");var SSe=ASe;function MSe(t,e,r){if(t[br]==="Object"&&typeof r=="object"&&!vx(r)){let i=t,n=Object.getOwnPropertyNames(r),a=Object.entries(i.properties),[o,l]=[1/a.length,a.length];return a.reduce((u,[c,p])=>{let m=p[br]==="Literal"&&p.const===r[c]?l:0,y=ba(p,e,r[c])?o:0,v=n.includes(c)?o:0;return u+(m+y+v)},0)}else return ba(t,e,r)?1:0}s(MSe,"ScoreUnion");function ESe(t,e,r){let i=t.anyOf.map(o=>oo(o,e)),[n,a]=[i[0],0];for(let o of i){let l=MSe(o,e,r);l>a&&(n=o,a=l)}return n}s(ESe,"SelectUnion");function CSe(t,e,r){if("default"in t)return typeof r=="function"?t.default:Ra(t.default);{let i=ESe(t,e,r);return pV(i,e,r)}}s(CSe,"CastUnion");function ISe(t,e,r){return ba(t,e,r)?Ra(r):$h(t,e)}s(ISe,"DefaultClone");function TSe(t,e,r){return ba(t,e,r)?r:$h(t,e)}s(TSe,"Default");function PSe(t,e,r){if(ba(t,e,r))return Ra(r);let i=zn(r)?Ra(r):$h(t,e),n=bi(t.minItems)&&i.length<t.minItems?[...i,...Array.from({length:t.minItems-i.length},()=>null)]:i,a=(bi(t.maxItems)&&n.length>t.maxItems?n.slice(0,t.maxItems):n).map(l=>Gh(t.items,e,l));if(t.uniqueItems!==!0)return a;let o=[...new Set(a)];if(!ba(t,e,o))throw new SSe(t,"Array cast produced invalid data due to uniqueItems constraint");return o}s(PSe,"FromArray");function LSe(t,e,r){if(ba(t,e,r))return $h(t,e);let i=new Set(t.returns.required||[]),n=s(function(){},"result");for(let[a,o]of Object.entries(t.returns.properties))!i.has(a)&&r.prototype[a]===void 0||(n.prototype[a]=Gh(o,e,r.prototype[a]));return n}s(LSe,"FromConstructor");function DSe(t,e,r){let i=$h(t,e),n=kn(i)&&kn(r)?Ee(Ee({},i),r):r;return ba(t,e,n)?n:$h(t,e)}s(DSe,"FromIntersect");function RSe(t,e,r){throw new SSe(t,"Never types cannot be cast")}s(RSe,"FromNever");function OSe(t,e,r){if(ba(t,e,r))return r;if(r===null||typeof r!="object")return $h(t,e);let i=new Set(t.required||[]),n={};for(let[a,o]of Object.entries(t.properties))!i.has(a)&&r[a]===void 0||(n[a]=Gh(o,e,r[a]));if(typeof t.additionalProperties=="object"){let a=Object.getOwnPropertyNames(t.properties);for(let o of Object.getOwnPropertyNames(r))a.includes(o)||(n[o]=Gh(t.additionalProperties,e,r[o]))}return n}s(OSe,"FromObject");function kSe(t,e,r){if(ba(t,e,r))return Ra(r);if(r===null||typeof r!="object"||Array.isArray(r)||r instanceof Date)return $h(t,e);let i=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[i],a={};for(let[o,l]of Object.entries(r))a[o]=Gh(n,e,l);return a}s(kSe,"FromRecord");function NSe(t,e,r){return Gh(oo(t,e),e,r)}s(NSe,"FromRef");function FSe(t,e,r){return Gh(oo(t,e),e,r)}s(FSe,"FromThis");function BSe(t,e,r){return ba(t,e,r)?Ra(r):zn(r)?t.items===void 0?[]:t.items.map((i,n)=>Gh(i,e,r[n])):$h(t,e)}s(BSe,"FromTuple");function zSe(t,e,r){return ba(t,e,r)?Ra(r):CSe(t,e,r)}s(zSe,"FromUnion");function Gh(t,e,r){let i=_a(t.$id)?[...e,t]:e,n=t;switch(t[br]){case"Array":return PSe(n,i,r);case"Constructor":return LSe(n,i,r);case"Intersect":return DSe(n,i,r);case"Never":return RSe(n);case"Object":return OSe(n,i,r);case"Record":return kSe(n,i,r);case"Ref":return NSe(n,i,r);case"This":return FSe(n,i,r);case"Tuple":return BSe(n,i,r);case"Union":return zSe(n,i,r);case"Date":case"Symbol":case"Uint8Array":return ISe(t,e,r);default:return TSe(n,i,r)}}s(Gh,"Visit");function pV(...t){return t.length===3?Gh(t[0],t[1],t[2]):Gh(t[0],[],t[1])}s(pV,"Cast");N();function USe(t){return xv(t)&&t[br]!=="Unsafe"}s(USe,"IsCheckable");function VSe(t,e,r){return zn(r)?r.map(i=>Vu(t.items,e,i)):r}s(VSe,"FromArray");function jSe(t,e,r){let i=t.unevaluatedProperties,n=t.allOf.map(o=>Vu(o,e,Ra(r))).reduce((o,l)=>kn(l)?Ee(Ee({},o),l):l,{});if(!kn(r)||!kn(n)||!xv(i))return n;let a=Qh(t);for(let o of Object.getOwnPropertyNames(r))a.includes(o)||ba(i,e,r[o])&&(n[o]=Vu(i,e,r[o]));return n}s(jSe,"FromIntersect");function $Se(t,e,r){if(!kn(r)||zn(r))return r;let i=t.additionalProperties;for(let n of Object.getOwnPropertyNames(r)){if(ki(t.properties,n)){r[n]=Vu(t.properties[n],e,r[n]);continue}if(xv(i)&&ba(i,e,r[n])){r[n]=Vu(i,e,r[n]);continue}delete r[n]}return r}s($Se,"FromObject");function GSe(t,e,r){if(!kn(r))return r;let i=t.additionalProperties,n=Object.getOwnPropertyNames(r),[a,o]=Object.entries(t.patternProperties)[0],l=new RegExp(a);for(let u of n){if(l.test(u)){r[u]=Vu(o,e,r[u]);continue}if(xv(i)&&ba(i,e,r[u])){r[u]=Vu(i,e,r[u]);continue}delete r[u]}return r}s(GSe,"FromRecord");function HSe(t,e,r){return Vu(oo(t,e),e,r)}s(HSe,"FromRef");function qSe(t,e,r){return Vu(oo(t,e),e,r)}s(qSe,"FromThis");function WSe(t,e,r){if(!zn(r))return r;if(Hu(t.items))return[];let i=Math.min(r.length,t.items.length);for(let n=0;n<i;n++)r[n]=Vu(t.items[n],e,r[n]);return r.length>i?r.slice(0,i):r}s(WSe,"FromTuple");function XSe(t,e,r){for(let i of t.anyOf)if(USe(i)&&ba(i,e,r))return Vu(i,e,r);return r}s(XSe,"FromUnion");function Vu(t,e,r){let i=_a(t.$id)?[...e,t]:e,n=t;switch(n[br]){case"Array":return VSe(n,i,r);case"Intersect":return jSe(n,i,r);case"Object":return $Se(n,i,r);case"Record":return GSe(n,i,r);case"Ref":return HSe(n,i,r);case"This":return qSe(n,i,r);case"Tuple":return WSe(n,i,r);case"Union":return XSe(n,i,r);default:return r}}s(Vu,"Visit");function dV(...t){return t.length===3?Vu(t[0],t[1],t[2]):Vu(t[0],[],t[1])}s(dV,"Clean");N();function pS(t){return _a(t)&&!isNaN(t)&&!isNaN(parseFloat(t))}s(pS,"IsStringNumeric");function ZSe(t){return fc(t)||yv(t)||bi(t)}s(ZSe,"IsValueToString");function Ox(t){return t===!0||bi(t)&&t===1||fc(t)&&t===BigInt("1")||_a(t)&&(t.toLowerCase()==="true"||t==="1")}s(Ox,"IsValueTrue");function kx(t){return t===!1||bi(t)&&(t===0||Object.is(t,-0))||fc(t)&&t===BigInt("0")||_a(t)&&(t.toLowerCase()==="false"||t==="0"||t==="-0")}s(kx,"IsValueFalse");function YSe(t){return _a(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}s(YSe,"IsTimeStringWithTimeZone");function KSe(t){return _a(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}s(KSe,"IsTimeStringWithoutTimeZone");function JSe(t){return _a(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}s(JSe,"IsDateTimeStringWithTimeZone");function QSe(t){return _a(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}s(QSe,"IsDateTimeStringWithoutTimeZone");function eMe(t){return _a(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(t)}s(eMe,"IsDateString");function tMe(t,e){let r=mV(t);return r===e?r:t}s(tMe,"TryConvertLiteralString");function rMe(t,e){let r=gV(t);return r===e?r:t}s(rMe,"TryConvertLiteralNumber");function iMe(t,e){let r=fV(t);return r===e?r:t}s(iMe,"TryConvertLiteralBoolean");function nMe(t,e){return _a(t.const)?tMe(e,t.const):bi(t.const)?rMe(e,t.const):yv(t.const)?iMe(e,t.const):e}s(nMe,"TryConvertLiteral");function fV(t){return Ox(t)?!0:kx(t)?!1:t}s(fV,"TryConvertBoolean");function aMe(t){let e=s(r=>r.split(".")[0],"truncateInteger");return pS(t)?BigInt(e(t)):bi(t)?BigInt(Math.trunc(t)):kx(t)?BigInt(0):Ox(t)?BigInt(1):t}s(aMe,"TryConvertBigInt");function mV(t){return ZSe(t)?t.toString():_x(t)&&t.description!==void 0?t.description.toString():t}s(mV,"TryConvertString");function gV(t){return pS(t)?parseFloat(t):Ox(t)?1:kx(t)?0:t}s(gV,"TryConvertNumber");function oMe(t){return pS(t)?parseInt(t):bi(t)?t|0:Ox(t)?1:kx(t)?0:t}s(oMe,"TryConvertInteger");function sMe(t){return _a(t)&&t.toLowerCase()==="null"?null:t}s(sMe,"TryConvertNull");function lMe(t){return _a(t)&&t==="undefined"?void 0:t}s(lMe,"TryConvertUndefined");function uMe(t){return Mf(t)?t:bi(t)?new Date(t):Ox(t)?new Date(1):kx(t)?new Date(0):pS(t)?new Date(parseInt(t)):KSe(t)?new Date("1970-01-01T".concat(t,".000Z")):YSe(t)?new Date("1970-01-01T".concat(t)):QSe(t)?new Date("".concat(t,".000Z")):JSe(t)?new Date(t):eMe(t)?new Date("".concat(t,"T00:00:00.000Z")):t}s(uMe,"TryConvertDate");function cMe(t,e,r){return(zn(r)?r:[r]).map(i=>Hh(t.items,e,i))}s(cMe,"FromArray");function hMe(t,e,r){return aMe(r)}s(hMe,"FromBigInt");function pMe(t,e,r){return fV(r)}s(pMe,"FromBoolean");function dMe(t,e,r){return uMe(r)}s(dMe,"FromDate");function fMe(t,e,r){return oMe(r)}s(fMe,"FromInteger");function mMe(t,e,r){return t.allOf.reduce((i,n)=>Hh(n,e,i),r)}s(mMe,"FromIntersect");function gMe(t,e,r){return nMe(t,r)}s(gMe,"FromLiteral");function yMe(t,e,r){return sMe(r)}s(yMe,"FromNull");function vMe(t,e,r){return gV(r)}s(vMe,"FromNumber");function _Me(t,e,r){if(!kn(r))return r;for(let i of Object.getOwnPropertyNames(t.properties))ki(r,i)&&(r[i]=Hh(t.properties[i],e,r[i]));return r}s(_Me,"FromObject");function xMe(t,e,r){if(!kn(r))return r;let i=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[i];for(let[a,o]of Object.entries(r))r[a]=Hh(n,e,o);return r}s(xMe,"FromRecord");function bMe(t,e,r){return Hh(oo(t,e),e,r)}s(bMe,"FromRef");function wMe(t,e,r){return mV(r)}s(wMe,"FromString");function AMe(t,e,r){return _a(r)||bi(r)?Symbol(r):r}s(AMe,"FromSymbol");function SMe(t,e,r){return Hh(oo(t,e),e,r)}s(SMe,"FromThis");function MMe(t,e,r){return zn(r)&&!Hu(t.items)?r.map((i,n)=>n<t.items.length?Hh(t.items[n],e,i):i):r}s(MMe,"FromTuple");function EMe(t,e,r){return lMe(r)}s(EMe,"FromUndefined");function CMe(t,e,r){for(let i of t.anyOf){let n=Hh(i,e,Ra(r));if(ba(i,e,n))return n}return r}s(CMe,"FromUnion");function Hh(t,e,r){let i=Iv(t,e),n=t;switch(t[br]){case"Array":return cMe(n,i,r);case"BigInt":return hMe(n,i,r);case"Boolean":return pMe(n,i,r);case"Date":return dMe(n,i,r);case"Integer":return fMe(n,i,r);case"Intersect":return mMe(n,i,r);case"Literal":return gMe(n,i,r);case"Null":return yMe(n,i,r);case"Number":return vMe(n,i,r);case"Object":return _Me(n,i,r);case"Record":return xMe(n,i,r);case"Ref":return bMe(n,i,r);case"String":return wMe(n,i,r);case"Symbol":return AMe(n,i,r);case"This":return SMe(n,i,r);case"Tuple":return MMe(n,i,r);case"Undefined":return EMe(n,i,r);case"Union":return CMe(n,i,r);default:return r}}s(Hh,"Visit");function yV(...t){return t.length===3?Hh(t[0],t[1],t[2]):Hh(t[0],[],t[1])}s(yV,"Convert");N();N();var IMe=class extends Ia{constructor(e,r,i){super("Unable to decode value as it does not match the expected schema"),this.schema=e,this.value=r,this.error=i}};s(IMe,"TransformDecodeCheckError");var TMe=IMe,PMe=class extends Ia{constructor(e,r,i,n){super(n instanceof Error?n.message:"Unknown error"),this.schema=e,this.path=r,this.value=i,this.error=n}};s(PMe,"TransformDecodeError");var vV=PMe;function eo(t,e,r){try{return no(t)?t[Du].Decode(r):r}catch(i){throw new vV(t,e,r,i)}}s(eo,"Default");function LMe(t,e,r,i){return zn(i)?eo(t,r,i.map((n,a)=>tp(t.items,e,"".concat(r,"/").concat(a),n))):eo(t,r,i)}s(LMe,"FromArray");function DMe(t,e,r,i){if(!kn(i)||od(i))return eo(t,r,i);let n=oS(t),a=n.map(p=>p[0]),o=Ee({},i);for(let[p,m]of n)p in o&&(o[p]=tp(m,e,"".concat(r,"/").concat(p),o[p]));if(!no(t.unevaluatedProperties))return eo(t,r,o);let l=Object.getOwnPropertyNames(o),u=t.unevaluatedProperties,c=Ee({},o);for(let p of l)a.includes(p)||(c[p]=eo(u,"".concat(r,"/").concat(p),c[p]));return eo(t,r,c)}s(DMe,"FromIntersect");function RMe(t,e,r,i){return eo(t,r,tp(t.not,e,r,i))}s(RMe,"FromNot");function OMe(t,e,r,i){if(!kn(i))return eo(t,r,i);let n=Qh(t),a=Ee({},i);for(let c of n)ki(a,c)&&(Hu(a[c])&&(!iS(t.properties[c])||Io.IsExactOptionalProperty(a,c))||(a[c]=tp(t.properties[c],e,"".concat(r,"/").concat(c),a[c])));if(!Hn(t.additionalProperties))return eo(t,r,a);let o=Object.getOwnPropertyNames(a),l=t.additionalProperties,u=Ee({},a);for(let c of o)n.includes(c)||(u[c]=eo(l,"".concat(r,"/").concat(c),u[c]));return eo(t,r,u)}s(OMe,"FromObject");function kMe(t,e,r,i){if(!kn(i))return eo(t,r,i);let n=Object.getOwnPropertyNames(t.patternProperties)[0],a=new RegExp(n),o=Ee({},i);for(let p of Object.getOwnPropertyNames(i))a.test(p)&&(o[p]=tp(t.patternProperties[n],e,"".concat(r,"/").concat(p),o[p]));if(!Hn(t.additionalProperties))return eo(t,r,o);let l=Object.getOwnPropertyNames(o),u=t.additionalProperties,c=Ee({},o);for(let p of l)a.test(p)||(c[p]=eo(u,"".concat(r,"/").concat(p),c[p]));return eo(t,r,c)}s(kMe,"FromRecord");function NMe(t,e,r,i){let n=oo(t,e);return eo(t,r,tp(n,e,r,i))}s(NMe,"FromRef");function FMe(t,e,r,i){let n=oo(t,e);return eo(t,r,tp(n,e,r,i))}s(FMe,"FromThis");function BMe(t,e,r,i){return zn(i)&&zn(t.items)?eo(t,r,t.items.map((n,a)=>tp(n,e,"".concat(r,"/").concat(a),i[a]))):eo(t,r,i)}s(BMe,"FromTuple");function zMe(t,e,r,i){for(let n of t.anyOf){if(!ba(n,e,i))continue;let a=tp(n,e,r,i);return eo(t,r,a)}return eo(t,r,i)}s(zMe,"FromUnion");function tp(t,e,r,i){let n=Iv(t,e),a=t;switch(t[br]){case"Array":return LMe(a,n,r,i);case"Intersect":return DMe(a,n,r,i);case"Not":return RMe(a,n,r,i);case"Object":return OMe(a,n,r,i);case"Record":return kMe(a,n,r,i);case"Ref":return NMe(a,n,r,i);case"Symbol":return eo(a,r,i);case"This":return FMe(a,n,r,i);case"Tuple":return BMe(a,n,r,i);case"Union":return zMe(a,n,r,i);default:return eo(a,r,i)}}s(tp,"Visit");function N5(t,e,r){return tp(t,e,"",r)}s(N5,"TransformDecode");N();var UMe=class extends Ia{constructor(e,r,i){super("The encoded value does not match the expected schema"),this.schema=e,this.value=r,this.error=i}};s(UMe,"TransformEncodeCheckError");var VMe=UMe,jMe=class extends Ia{constructor(e,r,i,n){super("".concat(n instanceof Error?n.message:"Unknown error")),this.schema=e,this.path=r,this.value=i,this.error=n}};s(jMe,"TransformEncodeError");var _V=jMe;function ol(t,e,r){try{return no(t)?t[Du].Encode(r):r}catch(i){throw new _V(t,e,r,i)}}s(ol,"Default");function $Me(t,e,r,i){let n=ol(t,r,i);return zn(n)?n.map((a,o)=>qh(t.items,e,"".concat(r,"/").concat(o),a)):n}s($Me,"FromArray");function GMe(t,e,r,i){let n=ol(t,r,i);if(!kn(i)||od(i))return n;let a=oS(t),o=a.map(m=>m[0]),l=Ee({},n);for(let[m,y]of a)m in l&&(l[m]=qh(y,e,"".concat(r,"/").concat(m),l[m]));if(!no(t.unevaluatedProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.unevaluatedProperties,p=Ee({},l);for(let m of u)o.includes(m)||(p[m]=ol(c,"".concat(r,"/").concat(m),p[m]));return p}s(GMe,"FromIntersect");function HMe(t,e,r,i){return ol(t.not,r,ol(t,r,i))}s(HMe,"FromNot");function qMe(t,e,r,i){let n=ol(t,r,i);if(!kn(n))return n;let a=Qh(t),o=Ee({},n);for(let p of a)ki(o,p)&&(Hu(o[p])&&(!iS(t.properties[p])||Io.IsExactOptionalProperty(o,p))||(o[p]=qh(t.properties[p],e,"".concat(r,"/").concat(p),o[p])));if(!Hn(t.additionalProperties))return o;let l=Object.getOwnPropertyNames(o),u=t.additionalProperties,c=Ee({},o);for(let p of l)a.includes(p)||(c[p]=ol(u,"".concat(r,"/").concat(p),c[p]));return c}s(qMe,"FromObject");function WMe(t,e,r,i){let n=ol(t,r,i);if(!kn(i))return n;let a=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(a),l=Ee({},n);for(let m of Object.getOwnPropertyNames(i))o.test(m)&&(l[m]=qh(t.patternProperties[a],e,"".concat(r,"/").concat(m),l[m]));if(!Hn(t.additionalProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,p=Ee({},l);for(let m of u)o.test(m)||(p[m]=ol(c,"".concat(r,"/").concat(m),p[m]));return p}s(WMe,"FromRecord");function XMe(t,e,r,i){let n=oo(t,e),a=qh(n,e,r,i);return ol(t,r,a)}s(XMe,"FromRef");function ZMe(t,e,r,i){let n=oo(t,e),a=qh(n,e,r,i);return ol(t,r,a)}s(ZMe,"FromThis");function YMe(t,e,r,i){let n=ol(t,r,i);return zn(t.items)?t.items.map((a,o)=>qh(a,e,"".concat(r,"/").concat(o),n[o])):[]}s(YMe,"FromTuple");function KMe(t,e,r,i){for(let n of t.anyOf){if(!ba(n,e,i))continue;let a=qh(n,e,r,i);return ol(t,r,a)}for(let n of t.anyOf){let a=qh(n,e,r,i);if(ba(t,e,a))return ol(t,r,a)}return ol(t,r,i)}s(KMe,"FromUnion");function qh(t,e,r,i){let n=Iv(t,e),a=t;switch(t[br]){case"Array":return $Me(a,n,r,i);case"Intersect":return GMe(a,n,r,i);case"Not":return HMe(a,n,r,i);case"Object":return qMe(a,n,r,i);case"Record":return WMe(a,n,r,i);case"Ref":return XMe(a,n,r,i);case"This":return ZMe(a,n,r,i);case"Tuple":return YMe(a,n,r,i);case"Union":return KMe(a,n,r,i);default:return ol(a,r,i)}}s(qh,"Visit");function xV(t,e,r){return qh(t,e,"",r)}s(xV,"TransformEncode");N();function JMe(t,e){return no(t)||Is(t.items,e)}s(JMe,"FromArray");function QMe(t,e){return no(t)||Is(t.items,e)}s(QMe,"FromAsyncIterator");function eEe(t,e){return no(t)||Is(t.returns,e)||t.parameters.some(r=>Is(r,e))}s(eEe,"FromConstructor");function tEe(t,e){return no(t)||Is(t.returns,e)||t.parameters.some(r=>Is(r,e))}s(tEe,"FromFunction");function rEe(t,e){return no(t)||no(t.unevaluatedProperties)||t.allOf.some(r=>Is(r,e))}s(rEe,"FromIntersect");function iEe(t,e){return no(t)||Is(t.items,e)}s(iEe,"FromIterator");function nEe(t,e){return no(t)||Is(t.not,e)}s(nEe,"FromNot");function aEe(t,e){return no(t)||Object.values(t.properties).some(r=>Is(r,e))||Hn(t.additionalProperties)&&Is(t.additionalProperties,e)}s(aEe,"FromObject");function oEe(t,e){return no(t)||Is(t.item,e)}s(oEe,"FromPromise");function sEe(t,e){let r=Object.getOwnPropertyNames(t.patternProperties)[0],i=t.patternProperties[r];return no(t)||Is(i,e)||Hn(t.additionalProperties)&&no(t.additionalProperties)}s(sEe,"FromRecord");function lEe(t,e){return no(t)?!0:Is(oo(t,e),e)}s(lEe,"FromRef");function uEe(t,e){return no(t)?!0:Is(oo(t,e),e)}s(uEe,"FromThis");function cEe(t,e){return no(t)||!Hu(t.items)&&t.items.some(r=>Is(r,e))}s(cEe,"FromTuple");function hEe(t,e){return no(t)||t.anyOf.some(r=>Is(r,e))}s(hEe,"FromUnion");function Is(t,e){let r=Iv(t,e),i=t;if(t.$id&&qk.has(t.$id))return!1;switch(t.$id&&qk.add(t.$id),t[br]){case"Array":return JMe(i,r);case"AsyncIterator":return QMe(i,r);case"Constructor":return eEe(i,r);case"Function":return tEe(i,r);case"Intersect":return rEe(i,r);case"Iterator":return iEe(i,r);case"Not":return nEe(i,r);case"Object":return aEe(i,r);case"Promise":return oEe(i,r);case"Record":return sEe(i,r);case"Ref":return lEe(i,r);case"This":return uEe(i,r);case"Tuple":return cEe(i,r);case"Union":return hEe(i,r);default:return no(t)}}s(Is,"Visit");var qk=new Set;function Nx(t,e){return qk.clear(),Is(t,e)}s(Nx,"HasTransform");function pEe(...t){let[e,r,i]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]];if(!ba(e,r,i))throw new TMe(e,i,Rx(e,r,i).First());return Nx(e,r)?N5(e,r,i):i}s(pEe,"Decode");N();function sd(t,e){let r=ki(t,"default")?t.default:void 0,i=JA(r)?r():Ra(r);return Hu(e)?i:kn(e)&&kn(i)?Object.assign(i,e):e}s(sd,"ValueOrDefault");function MT(t){return xv(t)&&"default"in t}s(MT,"HasDefaultProperty");function dEe(t,e,r){let i=sd(t,r);if(!zn(i))return i;for(let n=0;n<i.length;n++)i[n]=Ou(t.items,e,i[n]);return i}s(dEe,"FromArray");function fEe(t,e,r){return Mf(r)?r:sd(t,r)}s(fEe,"FromDate");function mEe(t,e,r){let i=sd(t,r);return t.allOf.reduce((n,a)=>{let o=Ou(a,e,i);return kn(o)?Ee(Ee({},n),o):o},{})}s(mEe,"FromIntersect");function gEe(t,e,r){let i=sd(t,r);if(!kn(i))return i;let n=Object.getOwnPropertyNames(t.properties);for(let a of n){let o=Ou(t.properties[a],e,i[a]);Hu(o)||(i[a]=Ou(t.properties[a],e,i[a]))}if(!MT(t.additionalProperties))return i;for(let a of Object.getOwnPropertyNames(i))n.includes(a)||(i[a]=Ou(t.additionalProperties,e,i[a]));return i}s(gEe,"FromObject");function yEe(t,e,r){let i=sd(t,r);if(!kn(i))return i;let n=t.additionalProperties,[a,o]=Object.entries(t.patternProperties)[0],l=new RegExp(a);for(let u of Object.getOwnPropertyNames(i))l.test(u)&&MT(o)&&(i[u]=Ou(o,e,i[u]));if(!MT(n))return i;for(let u of Object.getOwnPropertyNames(i))l.test(u)||(i[u]=Ou(n,e,i[u]));return i}s(yEe,"FromRecord");function vEe(t,e,r){return Ou(oo(t,e),e,sd(t,r))}s(vEe,"FromRef");function _Ee(t,e,r){return Ou(oo(t,e),e,r)}s(_Ee,"FromThis");function xEe(t,e,r){let i=sd(t,r);if(!zn(i)||Hu(t.items))return i;let[n,a]=[t.items,Math.max(t.items.length,i.length)];for(let o=0;o<a;o++)o<n.length&&(i[o]=Ou(n[o],e,i[o]));return i}s(xEe,"FromTuple");function bEe(t,e,r){let i=sd(t,r);for(let n of t.anyOf){let a=Ou(n,e,Ra(i));if(ba(n,e,a))return a}return i}s(bEe,"FromUnion");function Ou(t,e,r){let i=Iv(t,e),n=t;switch(n[br]){case"Array":return dEe(n,i,r);case"Date":return fEe(n,i,r);case"Intersect":return mEe(n,i,r);case"Object":return gEe(n,i,r);case"Record":return yEe(n,i,r);case"Ref":return vEe(n,i,r);case"This":return _Ee(n,i,r);case"Tuple":return xEe(n,i,r);case"Union":return bEe(n,i,r);default:return sd(n,r)}}s(Ou,"Visit");function bV(...t){return t.length===3?Ou(t[0],t[1],t[2]):Ou(t[0],[],t[1])}s(bV,"Default");N();N();var Wm={};Nl(Wm,{Delete:()=>CEe,Format:()=>Fx,Get:()=>TEe,Has:()=>IEe,Set:()=>EEe,ValuePointerRootDeleteError:()=>MEe,ValuePointerRootSetError:()=>AEe});N();var wEe=class extends Ia{constructor(e,r,i){super("Cannot set root value"),this.value=e,this.path=r,this.update=i}};s(wEe,"ValuePointerRootSetError");var AEe=wEe,SEe=class extends Ia{constructor(e,r){super("Cannot delete root value"),this.value=e,this.path=r}};s(SEe,"ValuePointerRootDeleteError");var MEe=SEe;function Wk(t){return t.indexOf("~")===-1?t:t.replace(/~1/g,"/").replace(/~0/g,"~")}s(Wk,"Escape");function*Fx(t){if(t==="")return;let[e,r]=[0,0];for(let i=0;i<t.length;i++)t.charAt(i)==="/"?(i===0||(r=i,yield Wk(t.slice(e,r))),e=i+1):r=i;yield Wk(t.slice(e))}s(Fx,"Format");function EEe(t,e,r){if(e==="")throw new AEe(t,e,r);let[i,n,a]=[null,t,""];for(let o of Fx(e))n[o]===void 0&&(n[o]={}),i=n,n=n[o],a=o;i[a]=r}s(EEe,"Set");function CEe(t,e){if(e==="")throw new MEe(t,e);let[r,i,n]=[null,t,""];for(let a of Fx(e)){if(i[a]===void 0||i[a]===null)return;r=i,i=i[a],n=a}if(Array.isArray(r)){let a=parseInt(n);r.splice(a,1)}else delete r[n]}s(CEe,"Delete");function IEe(t,e){if(e==="")return!0;let[r,i,n]=[null,t,""];for(let a of Fx(e)){if(i[a]===void 0)return!1;r=i,i=i[a],n=a}return Object.getOwnPropertyNames(r).includes(n)}s(IEe,"Has");function TEe(t,e){if(e==="")return t;let r=t;for(let i of Fx(e)){if(r[i]===void 0)return;r=r[i]}return r}s(TEe,"Get");N();function PEe(t,e){if(!kn(e))return!1;let r=[...Object.keys(t),...Object.getOwnPropertySymbols(t)],i=[...Object.keys(e),...Object.getOwnPropertySymbols(e)];return r.length!==i.length?!1:r.every(n=>Bx(t[n],e[n]))}s(PEe,"ObjectType");function LEe(t,e){return Mf(e)&&t.getTime()===e.getTime()}s(LEe,"DateType");function DEe(t,e){return!zn(e)||t.length!==e.length?!1:t.every((r,i)=>Bx(r,e[i]))}s(DEe,"ArrayType");function REe(t,e){return!Ef(e)||t.length!==e.length||Object.getPrototypeOf(t).constructor.name!==Object.getPrototypeOf(e).constructor.name?!1:t.every((r,i)=>Bx(r,e[i]))}s(REe,"TypedArrayType");function OEe(t,e){return t===e}s(OEe,"ValueType");function Bx(t,e){if(Mf(t))return LEe(t,e);if(Ef(t))return REe(t,e);if(zn(t))return DEe(t,e);if(kn(t))return PEe(t,e);if(od(t))return OEe(t,e);throw new Error("ValueEquals: Unable to compare value")}s(Bx,"Equal");var wZe=$s({type:Po("insert"),path:xf(),value:Cx()}),AZe=$s({type:Po("update"),path:xf(),value:Cx()}),SZe=$s({type:Po("delete"),path:xf()}),MZe=Bl([wZe,AZe,SZe]),kEe=class extends Ia{constructor(e,r){super(r),this.value=e}};s(kEe,"ValueDiffError");var NEe=kEe;function dS(t,e){return{type:"update",path:t,value:e}}s(dS,"CreateUpdate");function wV(t,e){return{type:"insert",path:t,value:e}}s(wV,"CreateInsert");function AV(t){return{type:"delete",path:t}}s(AV,"CreateDelete");function Xk(t){if(globalThis.Object.getOwnPropertySymbols(t).length>0)throw new NEe(t,"Cannot diff objects with symbols")}s(Xk,"AssertDiffable");function*FEe(t,e,r){if(Xk(e),Xk(r),!Tz(r))return yield dS(t,r);let i=globalThis.Object.getOwnPropertyNames(e),n=globalThis.Object.getOwnPropertyNames(r);for(let a of n)ki(e,a)||(yield wV("".concat(t,"/").concat(a),r[a]));for(let a of i)ki(r,a)&&(Bx(e,r)||(yield*vr(fS("".concat(t,"/").concat(a),e[a],r[a]))));for(let a of i)ki(r,a)||(yield AV("".concat(t,"/").concat(a)))}s(FEe,"ObjectType");function*BEe(t,e,r){if(!zn(r))return yield dS(t,r);for(let i=0;i<Math.min(e.length,r.length);i++)yield*vr(fS("".concat(t,"/").concat(i),e[i],r[i]));for(let i=0;i<r.length;i++)i<e.length||(yield wV("".concat(t,"/").concat(i),r[i]));for(let i=e.length-1;i>=0;i--)i<r.length||(yield AV("".concat(t,"/").concat(i)))}s(BEe,"ArrayType");function*zEe(t,e,r){if(!Ef(r)||e.length!==r.length||globalThis.Object.getPrototypeOf(e).constructor.name!==globalThis.Object.getPrototypeOf(r).constructor.name)return yield dS(t,r);for(let i=0;i<Math.min(e.length,r.length);i++)yield*vr(fS("".concat(t,"/").concat(i),e[i],r[i]))}s(zEe,"TypedArrayType");function*UEe(t,e,r){e!==r&&(yield dS(t,r))}s(UEe,"ValueType");function*fS(t,e,r){if(Tz(e))return yield*vr(FEe(t,e,r));if(zn(e))return yield*vr(BEe(t,e,r));if(Ef(e))return yield*vr(zEe(t,e,r));if(od(e))return yield*vr(UEe(t,e,r));throw new NEe(e,"Unable to diff value")}s(fS,"Visit");function VEe(t,e){return[...fS("",t,e)]}s(VEe,"Diff");function jEe(t){return t.length>0&&t[0].path===""&&t[0].type==="update"}s(jEe,"IsRootUpdate");function $Ee(t){return t.length===0}s($Ee,"IsIdentity");function GEe(t,e){if(jEe(e))return Ra(e[0].value);if($Ee(e))return Ra(t);let r=Ra(t);for(let i of e)switch(i.type){case"insert":{Wm.Set(r,i.path,i.value);break}case"update":{Wm.Set(r,i.path,i.value);break}case"delete":{Wm.Delete(r,i.path);break}}return r}s(GEe,"Patch");N();function HEe(...t){let[e,r,i]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]],n=Nx(e,r)?xV(e,r,i):i;if(!ba(e,r,n))throw new VMe(e,n,Rx(e,r,n).First());return n}s(HEe,"Encode");N();var qEe=class extends Ia{constructor(e){super(e)}};s(qEe,"ValueMutateError");var NW=qEe;function WEe(t,e,r,i){if(!kn(r))Wm.Set(t,e,Ra(i));else{let n=Object.getOwnPropertyNames(r),a=Object.getOwnPropertyNames(i);for(let o of n)a.includes(o)||delete r[o];for(let o of a)n.includes(o)||(r[o]=null);for(let o of a)F5(t,"".concat(e,"/").concat(o),r[o],i[o])}}s(WEe,"ObjectType");function XEe(t,e,r,i){if(!zn(r))Wm.Set(t,e,Ra(i));else{for(let n=0;n<i.length;n++)F5(t,"".concat(e,"/").concat(n),r[n],i[n]);r.splice(i.length)}}s(XEe,"ArrayType");function ZEe(t,e,r,i){if(Ef(r)&&r.length===i.length)for(let n=0;n<r.length;n++)r[n]=i[n];else Wm.Set(t,e,Ra(i))}s(ZEe,"TypedArrayType");function YEe(t,e,r,i){r!==i&&Wm.Set(t,e,i)}s(YEe,"ValueType");function F5(t,e,r,i){if(zn(i))return XEe(t,e,r,i);if(Ef(i))return ZEe(t,e,r,i);if(kn(i))return WEe(t,e,r,i);if(od(i))return YEe(t,e,r,i)}s(F5,"Visit");function Zk(t){return Ef(t)||od(t)}s(Zk,"IsNonMutableValue");function KEe(t,e){return kn(t)&&zn(e)||zn(t)&&kn(e)}s(KEe,"IsMismatchedValue");function JEe(t,e){if(Zk(t)||Zk(e))throw new NW("Only object and array types can be mutated at the root level");if(KEe(t,e))throw new NW("Cannot assign due type mismatch of assignable values");F5(t,"",t,e)}s(JEe,"Mutate");N();var EZe=[(t,e,r)=>Ra(r),(t,e,r)=>bV(t,e,r),(t,e,r)=>dV(t,e,r),(t,e,r)=>yV(t,e,r),(t,e,r)=>(hV(t,e,r),r),(t,e,r)=>Nx(t,e)?N5(t,e,r):r];function Yk(t,e,r){return EZe.reduce((i,n)=>n(t,e,i),r)}s(Yk,"ParseValue");function QEe(...t){return t.length===3?Yk(t[0],t[1],t[2]):Yk(t[0],[],t[1])}s(QEe,"Parse");N();var ET={};Nl(ET,{Assert:()=>hV,Cast:()=>pV,Check:()=>ba,Clean:()=>dV,Clone:()=>Ra,Convert:()=>yV,Create:()=>$h,Decode:()=>pEe,Default:()=>bV,Diff:()=>VEe,Edit:()=>MZe,Encode:()=>HEe,Equal:()=>Bx,Errors:()=>Rx,Hash:()=>hS,Mutate:()=>JEe,Parse:()=>QEe,Patch:()=>GEe,ValueErrorIterator:()=>Dx});N();N();var eCe=class extends Ia{constructor(e){super("Unable to dereference schema with $id '".concat(e.$ref,"'")),$(this,"schema"),this.schema=e}};s(eCe,"TypeDereferenceError");var CZe=eCe;function tCe(t,e){let r=e.find(i=>i.$id===t.$ref);if(r===void 0)throw new CZe(t);return zx(r,e)}s(tCe,"Resolve");function SV(t,e){return!ja.IsString(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}s(SV,"Pushref");function zx(t,e){return t[br]==="This"||t[br]==="Ref"?tCe(t,e):t}s(zx,"Deref");N();function rCe(t,e,r){let i=t.get(e);if(i!==void 0)return i;let n=Nx(e,r);return t.set(e,n),n}s(rCe,"HasTransformCached");function MV(){let t=new WeakMap;return{HasTransform:s((e,r)=>rCe(t,e,r),"HasTransform")}}s(MV,"CreateTransformCache");function to(t,e,r){try{return it.IsTransform(t)?t[Du].Decode(r):r}catch(i){throw new vV(t,e,r,i)}}s(to,"Default");function iCe(t,e,r,i,n){return ja.IsArray(i)?to(t,r,i.map((a,o)=>rp(t.items,e,"".concat(r,"/").concat(o),a,n))):to(t,r,i)}s(iCe,"FromArray");function nCe(t,e,r,i,n){if(!ja.IsObject(i)||od(i))return to(t,r,i);let a=oS(t),o=a.map(m=>m[0]),l=Ee({},i);for(let[m,y]of a)m in l&&(l[m]=rp(y,e,"".concat(r,"/").concat(m),l[m],n));if(!it.IsTransform(t.unevaluatedProperties))return to(t,r,l);let u=Object.getOwnPropertyNames(l),c=t.unevaluatedProperties,p=Ee({},l);for(let m of u)o.includes(m)||(p[m]=to(c,"".concat(r,"/").concat(m),p[m]));return to(t,r,p)}s(nCe,"FromIntersect");function aCe(t,e,r,i,n){return to(t,r,rp(t.not,e,r,i,n))}s(aCe,"FromNot");function oCe(t,e,r,i,n){if(!ja.IsObject(i))return to(t,r,i);let a=Qh(t),o=Ee({},i);for(let p of a)ja.HasPropertyKey(o,p)&&(ja.IsUndefined(o[p])&&(!it.IsUndefined(t.properties[p])||Io.IsExactOptionalProperty(o,p))||(o[p]=rp(t.properties[p],e,"".concat(r,"/").concat(p),o[p],n)));if(!it.IsSchema(t.additionalProperties))return to(t,r,o);let l=Object.getOwnPropertyNames(o),u=t.additionalProperties,c=Ee({},o);for(let p of l)a.includes(p)||(c[p]=to(u,"".concat(r,"/").concat(p),c[p]));return to(t,r,c)}s(oCe,"FromObject");function sCe(t,e,r,i,n){if(!ja.IsObject(i))return to(t,r,i);let a=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(a),l=Ee({},i);for(let m of Object.getOwnPropertyNames(i))o.test(m)&&(l[m]=rp(t.patternProperties[a],e,"".concat(r,"/").concat(m),l[m],n));if(!it.IsSchema(t.additionalProperties))return to(t,r,l);let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,p=Ee({},l);for(let m of u)o.test(m)||(p[m]=to(c,"".concat(r,"/").concat(m),p[m]));return to(t,r,p)}s(sCe,"FromRecord");function lCe(t,e,r,i,n){let a=zx(t,e);return to(t,r,rp(a,e,r,i,n))}s(lCe,"FromRef");function uCe(t,e,r,i,n){let a=zx(t,e);return to(t,r,rp(a,e,r,i,n))}s(uCe,"FromThis");function cCe(t,e,r,i,n){return ja.IsArray(i)&&ja.IsArray(t.items)?to(t,r,t.items.map((a,o)=>rp(a,e,"".concat(r,"/").concat(o),i[o],n))):to(t,r,i)}s(cCe,"FromTuple");function hCe(t,e,r,i,n){for(let a of t.anyOf){if(!ET.Check(a,e,i))continue;let o=rp(a,e,r,i,n);return to(t,r,o)}return to(t,r,i)}s(hCe,"FromUnion");function rp(t,e,r,i,n){if(!n.HasTransform(t,e))return i;let a=SV(t,e),o=t;switch(t[br]){case"Array":return iCe(o,a,r,i,n);case"Intersect":return nCe(o,a,r,i,n);case"Not":return aCe(o,a,r,i,n);case"Object":return oCe(o,a,r,i,n);case"Record":return sCe(o,a,r,i,n);case"Ref":return lCe(o,a,r,i,n);case"Symbol":return to(o,r,i);case"This":return uCe(o,a,r,i,n);case"Tuple":return cCe(o,a,r,i,n);case"Union":return hCe(o,a,r,i,n);default:return to(o,r,i)}}s(rp,"Visit");function pCe(t,e,r){let i=MV();return rp(t,e,"",r,i)}s(pCe,"FastTransformDecode");N();function sl(t,e,r){try{return it.IsTransform(t)?t[Du].Encode(r):r}catch(i){throw new _V(t,e,r,i)}}s(sl,"Default");function dCe(t,e,r,i,n){let a=sl(t,r,i);return ja.IsArray(a)?a.map((o,l)=>Wh(t.items,e,"".concat(r,"/").concat(l),o,n)):a}s(dCe,"FromArray");function fCe(t,e,r,i,n){let a=sl(t,r,i);if(!ja.IsObject(i)||od(i))return a;let o=oS(t),l=o.map(y=>y[0]),u=Ee({},a);for(let[y,v]of o)y in u&&(u[y]=Wh(v,e,"".concat(r,"/").concat(y),u[y],n));if(!it.IsTransform(t.unevaluatedProperties))return u;let c=Object.getOwnPropertyNames(u),p=t.unevaluatedProperties,m=Ee({},u);for(let y of c)l.includes(y)||(m[y]=sl(p,"".concat(r,"/").concat(y),m[y]));return m}s(fCe,"FromIntersect");function mCe(t,e,r,i){return sl(t.not,r,sl(t,r,i))}s(mCe,"FromNot");function gCe(t,e,r,i,n){let a=sl(t,r,i);if(!ja.IsObject(a))return a;let o=Qh(t),l=Ee({},a);for(let m of o)ja.HasPropertyKey(l,m)&&(ja.IsUndefined(l[m])&&(!it.IsUndefined(t.properties[m])||Io.IsExactOptionalProperty(l,m))||(l[m]=Wh(t.properties[m],e,"".concat(r,"/").concat(m),l[m],n)));if(!it.IsSchema(t.additionalProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,p=Ee({},l);for(let m of u)o.includes(m)||(p[m]=sl(c,"".concat(r,"/").concat(m),p[m]));return p}s(gCe,"FromObject");function yCe(t,e,r,i,n){let a=sl(t,r,i);if(!ja.IsObject(i))return a;let o=Object.getOwnPropertyNames(t.patternProperties)[0],l=new RegExp(o),u=Ee({},a);for(let y of Object.getOwnPropertyNames(i))l.test(y)&&(u[y]=Wh(t.patternProperties[o],e,"".concat(r,"/").concat(y),u[y],n));if(!it.IsSchema(t.additionalProperties))return u;let c=Object.getOwnPropertyNames(u),p=t.additionalProperties,m=Ee({},u);for(let y of c)l.test(y)||(m[y]=sl(p,"".concat(r,"/").concat(y),m[y]));return m}s(yCe,"FromRecord");function vCe(t,e,r,i,n){let a=zx(t,e),o=Wh(a,e,r,i,n);return sl(t,r,o)}s(vCe,"FromRef");function _Ce(t,e,r,i,n){let a=zx(t,e),o=Wh(a,e,r,i,n);return sl(t,r,o)}s(_Ce,"FromThis");function xCe(t,e,r,i,n){let a=sl(t,r,i);return ja.IsArray(t.items)?t.items.map((o,l)=>Wh(o,e,"".concat(r,"/").concat(l),a[l],n)):[]}s(xCe,"FromTuple");function bCe(t,e,r,i,n){for(let a of t.anyOf){if(!ET.Check(a,e,i))continue;let o=Wh(a,e,r,i,n);return sl(t,r,o)}for(let a of t.anyOf){let o=Wh(a,e,r,i,n);if(ET.Check(t,e,o))return sl(t,r,o)}return sl(t,r,i)}s(bCe,"FromUnion");function Wh(t,e,r,i,n){if(!n.HasTransform(t,e))return i;let a=SV(t,e),o=t;switch(t[br]){case"Array":return dCe(o,a,r,i,n);case"Intersect":return fCe(o,a,r,i,n);case"Not":return mCe(o,a,r,i);case"Object":return gCe(o,a,r,i,n);case"Record":return yCe(o,a,r,i,n);case"Ref":return vCe(o,a,r,i,n);case"This":return _Ce(o,a,r,i,n);case"Tuple":return xCe(o,a,r,i,n);case"Union":return bCe(o,a,r,i,n);default:return sl(o,r,i)}}s(Wh,"Visit");function wCe(t,e,r){let i=MV();return Wh(t,e,"",r,i)}s(wCe,"FastTransformEncode");N();var ACe=class{constructor(e,r,i,n){this.schema=e,this.references=r,this.checkFunc=i,this.code=n,this.hasTransform=Nx(e,r)}Code(){return this.code}Errors(e){return Rx(this.schema,this.references,e)}Check(e){return this.checkFunc(e)}Decode(e){if(!this.checkFunc(e))throw new TMe(this.schema,e,this.Errors(e).First());return this.hasTransform?N5(this.schema,this.references,e):e}Encode(e){let r=this.hasTransform?xV(this.schema,this.references,e):e;if(!this.checkFunc(r))throw new VMe(this.schema,e,this.Errors(e).First());return r}};s(ACe,"TypeCheck");var IZe=ACe,nf;(function(t){function e(a){return a===36}s(e,"DollarSign"),t.DollarSign=e;function r(a){return a===95}s(r,"IsUnderscore"),t.IsUnderscore=r;function i(a){return a>=65&&a<=90||a>=97&&a<=122}s(i,"IsAlpha"),t.IsAlpha=i;function n(a){return a>=48&&a<=57}s(n,"IsNumeric"),t.IsNumeric=n})(nf||(nf={}));var CT;(function(t){function e(a){return a.length===0?!1:nf.IsNumeric(a.charCodeAt(0))}s(e,"IsFirstCharacterNumeric");function r(a){if(e(a))return!1;for(let o=0;o<a.length;o++){let l=a.charCodeAt(o);if(!(nf.IsAlpha(l)||nf.IsNumeric(l)||nf.DollarSign(l)||nf.IsUnderscore(l)))return!1}return!0}s(r,"IsAccessor");function i(a){return a.replace(/'/g,"\\'")}s(i,"EscapeHyphen");function n(a,o){return r(o)?"".concat(a,".").concat(o):"".concat(a,"['").concat(i(o),"']")}s(n,"Encode"),t.Encode=n})(CT||(CT={}));var Kk;(function(t){function e(r){let i=[];for(let n=0;n<r.length;n++){let a=r.charCodeAt(n);nf.IsNumeric(a)||nf.IsAlpha(a)?i.push(r.charAt(n)):i.push("_".concat(a,"_"))}return i.join("").replace(/__/g,"_")}s(e,"Encode"),t.Encode=e})(Kk||(Kk={}));var Jk;(function(t){function e(r){return r.replace(/'/g,"\\'")}s(e,"Escape"),t.Escape=e})(Jk||(Jk={}));var SCe=class extends Ia{constructor(e){super("Unknown type"),this.schema=e}};s(SCe,"TypeCompilerUnknownTypeError");var TZe=SCe,MCe=class extends Ia{constructor(e){super("Preflight validation check failed to guard for the given schema"),this.schema=e}};s(MCe,"TypeCompilerTypeGuardError");var FW=MCe,yy;(function(t){function e(o,l,u){return Io.ExactOptionalPropertyTypes?"('".concat(l,"' in ").concat(o," ? ").concat(u," : true)"):"(".concat(CT.Encode(o,l)," !== undefined ? ").concat(u," : true)")}s(e,"IsExactOptionalProperty"),t.IsExactOptionalProperty=e;function r(o){return Io.AllowArrayObject?"(typeof ".concat(o," === 'object' && ").concat(o," !== null)"):"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !Array.isArray(").concat(o,"))")}s(r,"IsObjectLike"),t.IsObjectLike=r;function i(o){return Io.AllowArrayObject?"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !(").concat(o," instanceof Date) && !(").concat(o," instanceof Uint8Array))"):"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !Array.isArray(").concat(o,") && !(").concat(o," instanceof Date) && !(").concat(o," instanceof Uint8Array))")}s(i,"IsRecordLike"),t.IsRecordLike=i;function n(o){return Io.AllowNaN?"typeof ".concat(o," === 'number'"):"Number.isFinite(".concat(o,")")}s(n,"IsNumberLike"),t.IsNumberLike=n;function a(o){return Io.AllowNullVoid?"(".concat(o," === undefined || ").concat(o," === null)"):"".concat(o," === undefined")}s(a,"IsVoidLike"),t.IsVoidLike=a})(yy||(yy={}));var Qk;(function(t){function e(fe){return fe[br]==="Any"||fe[br]==="Unknown"}s(e,"IsAnyOrUnknown");function*r(fe,Pe,me){yield"true"}s(r,"FromAny");function*i(fe,Pe,me){yield"Array.isArray(".concat(me,")");let[Ae,Ue]=[te("value","any"),te("acc","number")];bi(fe.maxItems)&&(yield"".concat(me,".length <= ").concat(fe.maxItems)),bi(fe.minItems)&&(yield"".concat(me,".length >= ").concat(fe.minItems));let _e=ee(fe.items,Pe,"value");if(yield"".concat(me,".every((").concat(Ae,") => ").concat(_e,")"),Hn(fe.contains)||bi(fe.minContains)||bi(fe.maxContains)){let lt=Hn(fe.contains)?fe.contains:cl(),tt=ee(lt,Pe,"value"),We=bi(fe.minContains)?["(count >= ".concat(fe.minContains,")")]:[],at=bi(fe.maxContains)?["(count <= ".concat(fe.maxContains,")")]:[],Lt="const count = value.reduce((".concat(Ue,", ").concat(Ae,") => ").concat(tt," ? acc + 1 : acc, 0)"),dt=["(count > 0)",...We,...at].join(" && ");yield"((".concat(Ae,") => { ").concat(Lt,"; return ").concat(dt,"})(").concat(me,")")}if(fe.uniqueItems===!0){let lt="const set = new Set(); for(const element of value) { ".concat("const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true"," }");yield"((".concat(Ae,") => { ").concat(lt," )(").concat(me,")")}}s(i,"FromArray");function*n(fe,Pe,me){yield"(typeof value === 'object' && Symbol.asyncIterator in ".concat(me,")")}s(n,"FromAsyncIterator");function*a(fe,Pe,me){yield"(typeof ".concat(me," === 'bigint')"),fc(fe.exclusiveMaximum)&&(yield"".concat(me," < BigInt(").concat(fe.exclusiveMaximum,")")),fc(fe.exclusiveMinimum)&&(yield"".concat(me," > BigInt(").concat(fe.exclusiveMinimum,")")),fc(fe.maximum)&&(yield"".concat(me," <= BigInt(").concat(fe.maximum,")")),fc(fe.minimum)&&(yield"".concat(me," >= BigInt(").concat(fe.minimum,")")),fc(fe.multipleOf)&&(yield"(".concat(me," % BigInt(").concat(fe.multipleOf,")) === 0"))}s(a,"FromBigInt");function*o(fe,Pe,me){yield"(typeof ".concat(me," === 'boolean')")}s(o,"FromBoolean");function*l(fe,Pe,me){yield*vr(Q(fe.returns,Pe,"".concat(me,".prototype")))}s(l,"FromConstructor");function*u(fe,Pe,me){yield"(".concat(me," instanceof Date) && Number.isFinite(").concat(me,".getTime())"),bi(fe.exclusiveMaximumTimestamp)&&(yield"".concat(me,".getTime() < ").concat(fe.exclusiveMaximumTimestamp)),bi(fe.exclusiveMinimumTimestamp)&&(yield"".concat(me,".getTime() > ").concat(fe.exclusiveMinimumTimestamp)),bi(fe.maximumTimestamp)&&(yield"".concat(me,".getTime() <= ").concat(fe.maximumTimestamp)),bi(fe.minimumTimestamp)&&(yield"".concat(me,".getTime() >= ").concat(fe.minimumTimestamp)),bi(fe.multipleOfTimestamp)&&(yield"(".concat(me,".getTime() % ").concat(fe.multipleOfTimestamp,") === 0"))}s(u,"FromDate");function*c(fe,Pe,me){yield"(typeof ".concat(me," === 'function')")}s(c,"FromFunction");function*p(fe,Pe,me){yield"Number.isInteger(".concat(me,")"),bi(fe.exclusiveMaximum)&&(yield"".concat(me," < ").concat(fe.exclusiveMaximum)),bi(fe.exclusiveMinimum)&&(yield"".concat(me," > ").concat(fe.exclusiveMinimum)),bi(fe.maximum)&&(yield"".concat(me," <= ").concat(fe.maximum)),bi(fe.minimum)&&(yield"".concat(me," >= ").concat(fe.minimum)),bi(fe.multipleOf)&&(yield"(".concat(me," % ").concat(fe.multipleOf,") === 0"))}s(p,"FromInteger");function*m(fe,Pe,me){let Ae=fe.allOf.map(Ue=>ee(Ue,Pe,me)).join(" && ");if(fe.unevaluatedProperties===!1){let Ue=K("".concat(new RegExp(ev(fe)),";")),_e="Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(Ue,".test(key))");yield"(".concat(Ae," && ").concat(_e,")")}else if(Hn(fe.unevaluatedProperties)){let Ue=K("".concat(new RegExp(ev(fe)),";")),_e="Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(Ue,".test(key) || ").concat(ee(fe.unevaluatedProperties,Pe,"".concat(me,"[key]")),")");yield"(".concat(Ae," && ").concat(_e,")")}else yield"(".concat(Ae,")")}s(m,"FromIntersect");function*y(fe,Pe,me){yield"(typeof value === 'object' && Symbol.iterator in ".concat(me,")")}s(y,"FromIterator");function*v(fe,Pe,me){typeof fe.const=="number"||typeof fe.const=="boolean"?yield"(".concat(me," === ").concat(fe.const,")"):yield"(".concat(me," === '").concat(Jk.Escape(fe.const),"')")}s(v,"FromLiteral");function*w(fe,Pe,me){yield"false"}s(w,"FromNever");function*E(fe,Pe,me){let Ae=ee(fe.not,Pe,me);yield"(!".concat(Ae,")")}s(E,"FromNot");function*M(fe,Pe,me){yield"(".concat(me," === null)")}s(M,"FromNull");function*I(fe,Pe,me){yield yy.IsNumberLike(me),bi(fe.exclusiveMaximum)&&(yield"".concat(me," < ").concat(fe.exclusiveMaximum)),bi(fe.exclusiveMinimum)&&(yield"".concat(me," > ").concat(fe.exclusiveMinimum)),bi(fe.maximum)&&(yield"".concat(me," <= ").concat(fe.maximum)),bi(fe.minimum)&&(yield"".concat(me," >= ").concat(fe.minimum)),bi(fe.multipleOf)&&(yield"(".concat(me," % ").concat(fe.multipleOf,") === 0"))}s(I,"FromNumber");function*P(fe,Pe,me){yield yy.IsObjectLike(me),bi(fe.minProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length >= ").concat(fe.minProperties)),bi(fe.maxProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length <= ").concat(fe.maxProperties));let Ae=Object.getOwnPropertyNames(fe.properties);for(let Ue of Ae){let _e=CT.Encode(me,Ue),lt=fe.properties[Ue];if(fe.required&&fe.required.includes(Ue))yield*vr(Q(lt,Pe,_e)),(Sv(lt)||e(lt))&&(yield"('".concat(Ue,"' in ").concat(me,")"));else{let tt=ee(lt,Pe,_e);yield yy.IsExactOptionalProperty(me,Ue,tt)}}if(fe.additionalProperties===!1)if(fe.required&&fe.required.length===Ae.length)yield"Object.getOwnPropertyNames(".concat(me,").length === ").concat(Ae.length);else{let Ue="[".concat(Ae.map(_e=>"'".concat(_e,"'")).join(", "),"]");yield"Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(Ue,".includes(key))")}if(typeof fe.additionalProperties=="object"){let Ue=ee(fe.additionalProperties,Pe,"".concat(me,"[key]")),_e="[".concat(Ae.map(lt=>"'".concat(lt,"'")).join(", "),"]");yield"(Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(_e,".includes(key) || ").concat(Ue,"))")}}s(P,"FromObject");function*C(fe,Pe,me){yield"(typeof value === 'object' && typeof ".concat(me,".then === 'function')")}s(C,"FromPromise");function*T(fe,Pe,me){yield yy.IsRecordLike(me),bi(fe.minProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length >= ").concat(fe.minProperties)),bi(fe.maxProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length <= ").concat(fe.maxProperties));let[Ae,Ue]=Object.entries(fe.patternProperties)[0],_e=K("".concat(new RegExp(Ae))),lt=ee(Ue,Pe,"value"),tt=Hn(fe.additionalProperties)?ee(fe.additionalProperties,Pe,me):fe.additionalProperties===!1?"false":"true",We="(".concat(_e,".test(key) ? ").concat(lt," : ").concat(tt,")");yield"(Object.entries(".concat(me,").every(([key, value]) => ").concat(We,"))")}s(T,"FromRecord");function*O(fe,Pe,me){let Ae=oo(fe,Pe);if(ae.functions.has(fe.$ref))return yield"".concat(le(fe.$ref),"(").concat(me,")");yield*vr(Q(Ae,Pe,me))}s(O,"FromRef");function*F(fe,Pe,me){let Ae=K("".concat(new RegExp(fe.source,fe.flags),";"));yield"(typeof ".concat(me," === 'string')"),bi(fe.maxLength)&&(yield"".concat(me,".length <= ").concat(fe.maxLength)),bi(fe.minLength)&&(yield"".concat(me,".length >= ").concat(fe.minLength)),yield"".concat(Ae,".test(").concat(me,")")}s(F,"FromRegExp");function*k(fe,Pe,me){if(yield"(typeof ".concat(me," === 'string')"),bi(fe.maxLength)&&(yield"".concat(me,".length <= ").concat(fe.maxLength)),bi(fe.minLength)&&(yield"".concat(me,".length >= ").concat(fe.minLength)),fe.pattern!==void 0){let Ae=K("".concat(new RegExp(fe.pattern),";"));yield"".concat(Ae,".test(").concat(me,")")}fe.format!==void 0&&(yield"format('".concat(fe.format,"', ").concat(me,")"))}s(k,"FromString");function*B(fe,Pe,me){yield"(typeof ".concat(me," === 'symbol')")}s(B,"FromSymbol");function*U(fe,Pe,me){yield"(typeof ".concat(me," === 'string')");let Ae=K("".concat(new RegExp(fe.pattern),";"));yield"".concat(Ae,".test(").concat(me,")")}s(U,"FromTemplateLiteral");function*z(fe,Pe,me){yield"".concat(le(fe.$ref),"(").concat(me,")")}s(z,"FromThis");function*q(fe,Pe,me){if(yield"Array.isArray(".concat(me,")"),fe.items===void 0)return yield"".concat(me,".length === 0");yield"(".concat(me,".length === ").concat(fe.maxItems,")");for(let Ae=0;Ae<fe.items.length;Ae++){let Ue=ee(fe.items[Ae],Pe,"".concat(me,"[").concat(Ae,"]"));yield"".concat(Ue)}}s(q,"FromTuple");function*W(fe,Pe,me){yield"".concat(me," === undefined")}s(W,"FromUndefined");function*J(fe,Pe,me){let Ae=fe.anyOf.map(Ue=>ee(Ue,Pe,me));yield"(".concat(Ae.join(" || "),")")}s(J,"FromUnion");function*V(fe,Pe,me){yield"".concat(me," instanceof Uint8Array"),bi(fe.maxByteLength)&&(yield"(".concat(me,".length <= ").concat(fe.maxByteLength,")")),bi(fe.minByteLength)&&(yield"(".concat(me,".length >= ").concat(fe.minByteLength,")"))}s(V,"FromUint8Array");function*oe(fe,Pe,me){yield"true"}s(oe,"FromUnknown");function*Y(fe,Pe,me){yield yy.IsVoidLike(me)}s(Y,"FromVoid");function*he(fe,Pe,me){let Ae=ae.instances.size;ae.instances.set(Ae,fe),yield"kind('".concat(fe[br],"', ").concat(Ae,", ").concat(me,")")}s(he,"FromKind");function*Q(fe,Pe,me,Ae=!0){let Ue=_a(fe.$id)?[...Pe,fe]:Pe,_e=fe;if(Ae&&_a(fe.$id)){let lt=le(fe.$id);if(ae.functions.has(lt))return yield"".concat(lt,"(").concat(me,")");{let tt=ce(lt,fe,Pe,"value",!1);return ae.functions.set(lt,tt),yield"".concat(lt,"(").concat(me,")")}}switch(_e[br]){case"Any":return yield*vr(r());case"Array":return yield*vr(i(_e,Ue,me));case"AsyncIterator":return yield*vr(n(_e,Ue,me));case"BigInt":return yield*vr(a(_e,Ue,me));case"Boolean":return yield*vr(o(_e,Ue,me));case"Constructor":return yield*vr(l(_e,Ue,me));case"Date":return yield*vr(u(_e,Ue,me));case"Function":return yield*vr(c(_e,Ue,me));case"Integer":return yield*vr(p(_e,Ue,me));case"Intersect":return yield*vr(m(_e,Ue,me));case"Iterator":return yield*vr(y(_e,Ue,me));case"Literal":return yield*vr(v(_e,Ue,me));case"Never":return yield*vr(w());case"Not":return yield*vr(E(_e,Ue,me));case"Null":return yield*vr(M(_e,Ue,me));case"Number":return yield*vr(I(_e,Ue,me));case"Object":return yield*vr(P(_e,Ue,me));case"Promise":return yield*vr(C(_e,Ue,me));case"Record":return yield*vr(T(_e,Ue,me));case"Ref":return yield*vr(O(_e,Ue,me));case"RegExp":return yield*vr(F(_e,Ue,me));case"String":return yield*vr(k(_e,Ue,me));case"Symbol":return yield*vr(B(_e,Ue,me));case"TemplateLiteral":return yield*vr(U(_e,Ue,me));case"This":return yield*vr(z(_e,Ue,me));case"Tuple":return yield*vr(q(_e,Ue,me));case"Undefined":return yield*vr(W(_e,Ue,me));case"Union":return yield*vr(J(_e,Ue,me));case"Uint8Array":return yield*vr(V(_e,Ue,me));case"Unknown":return yield*vr(oe());case"Void":return yield*vr(Y(_e,Ue,me));default:if(!rh.Has(_e[br]))throw new TZe(fe);return yield*vr(he(_e,Ue,me))}}s(Q,"Visit");let ae={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function ee(fe,Pe,me,Ae=!0){return"(".concat([...Q(fe,Pe,me,Ae)].join(" && "),")")}s(ee,"CreateExpression");function le(fe){return"check_".concat(Kk.Encode(fe))}s(le,"CreateFunctionName");function K(fe){let Pe="local_".concat(ae.variables.size);return ae.variables.set(Pe,"const ".concat(Pe," = ").concat(fe)),Pe}s(K,"CreateVariable");function ce(fe,Pe,me,Ae,Ue=!0){let[_e,lt]=[`
`,Lt=>"".padStart(Lt," ")],tt=te("value","any"),We=ne("boolean"),at=[...Q(Pe,me,Ae,Ue)].map(Lt=>"".concat(lt(4)).concat(Lt)).join(" &&".concat(_e));return"function ".concat(fe,"(").concat(tt,")").concat(We," {").concat(_e).concat(lt(2),"return (").concat(_e).concat(at).concat(_e).concat(lt(2),`)
}`)}s(ce,"CreateFunction");function te(fe,Pe){let me=ae.language==="typescript"?": ".concat(Pe):"";return"".concat(fe).concat(me)}s(te,"CreateParameter");function ne(fe){return ae.language==="typescript"?": ".concat(fe):""}s(ne,"CreateReturns");function pe(fe,Pe,me){let Ae=ce("check",fe,Pe,"value"),Ue=te("value","any"),_e=ne("boolean"),lt=[...ae.functions.values()],tt=[...ae.variables.values()],We=_a(fe.$id)?"return function check(".concat(Ue,")").concat(_e,` {
  return `).concat(le(fe.$id),`(value)
}`):"return ".concat(Ae);return[...tt,...lt,We].join(`
`)}s(pe,"Build");function xe(...fe){let Pe={language:"javascript"},[me,Ae,Ue]=fe.length===2&&zn(fe[1])?[fe[0],fe[1],Pe]:fe.length===2&&!zn(fe[1])?[fe[0],[],fe[1]]:fe.length===3?[fe[0],fe[1],fe[2]]:fe.length===1?[fe[0],[],Pe]:[null,[],Pe];if(ae.language=Ue.language,ae.variables.clear(),ae.functions.clear(),ae.instances.clear(),!Hn(me))throw new FW(me);for(let _e of Ae)if(!Hn(_e))throw new FW(_e);return pe(me,Ae)}s(xe,"Code"),t.Code=xe;function Te(fe,Pe=[]){let me=xe(fe,Pe,{language:"javascript"}),Ae=globalThis.Function("kind","format","hash",me),Ue=new Map(ae.instances);function _e(at,Lt,dt){if(!rh.Has(at)||!Ue.has(Lt))return!1;let Me=rh.Get(at),ve=Ue.get(Lt);return Me(ve,dt)}s(_e,"typeRegistryFunction");function lt(at,Lt){return _f.Has(at)?_f.Get(at)(Lt):!1}s(lt,"formatRegistryFunction");function tt(at){return hS(at)}s(tt,"hashFunction");let We=Ae(_e,lt,tt);return new IZe(fe,Pe,We,me)}s(Te,"Compile"),t.Compile=Te})(Qk||(Qk={}));N();N();var BW={},PZe=s(function(t,e,r,i,n){var a=new Worker(BW[e]||(BW[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(o){var l=o.data,u=l.$e$;if(u){var c=new Error(u[0]);c.code=u[1],c.stack=u[2],n(c,null)}else n(null,l)},a.postMessage(r,i),a},"wk"),Da=Uint8Array,eu=Uint16Array,mS=Int32Array,Ux=new Da([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Vx=new Da([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),qw=new Da([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ECe=s(function(t,e){for(var r=new eu(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new mS(r[30]),i=1;i<30;++i)for(var a=r[i];a<r[i+1];++a)n[a]=a-r[i]<<5|i;return{b:r,r:n}},"freb"),CCe=ECe(Ux,2),EV=CCe.b,IT=CCe.r;EV[28]=258,IT[258]=28;var ICe=ECe(Vx,0),TCe=ICe.b,e8=ICe.r,Ww=new eu(32768);for(qn=0;qn<32768;++qn)Ld=(qn&43690)>>1|(qn&21845)<<1,Ld=(Ld&52428)>>2|(Ld&13107)<<2,Ld=(Ld&61680)>>4|(Ld&3855)<<4,Ww[qn]=((Ld&65280)>>8|(Ld&255)<<8)>>1;var Ld,qn,ih=s(function(t,e,r){for(var i=t.length,n=0,a=new eu(e);n<i;++n)t[n]&&++a[t[n]-1];var o=new eu(e);for(n=1;n<e;++n)o[n]=o[n-1]+a[n-1]<<1;var l;if(r){l=new eu(1<<e);var u=15-e;for(n=0;n<i;++n)if(t[n])for(var c=n<<4|t[n],p=e-t[n],m=o[t[n]-1]++<<p,y=m|(1<<p)-1;m<=y;++m)l[Ww[m]>>u]=c}else for(l=new eu(i),n=0;n<i;++n)t[n]&&(l[n]=Ww[o[t[n]-1]++]>>15-t[n]);return l},"hMap"),bf=new Da(288);for(qn=0;qn<144;++qn)bf[qn]=8;var qn;for(qn=144;qn<256;++qn)bf[qn]=9;var qn;for(qn=256;qn<280;++qn)bf[qn]=7;var qn;for(qn=280;qn<288;++qn)bf[qn]=8;var qn,H_=new Da(32);for(qn=0;qn<32;++qn)H_[qn]=5;var qn,PCe=ih(bf,9,0),LCe=ih(bf,9,1),DCe=ih(H_,5,0),RCe=ih(H_,5,1),WC=s(function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},"max"),Gc=s(function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&r},"bits"),XC=s(function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},"bits16"),gS=s(function(t){return(t+7)/8|0},"shft"),Tv=s(function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new Da(t.subarray(e,r))},"slc"),OCe={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14},kCe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],hs=s(function(t,e,r){var i=new Error(e||kCe[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,hs),!r)throw i;return i},"err"),NCe=s(function(t,e,r,i){var n=t.length,a=i?i.length:0;if(!n||e.f&&!e.l)return r||new Da(0);var o=!r,l=o||e.i!=2,u=e.i;o&&(r=new Da(n*3));var c=s(function(me){var Ae=r.length;if(me>Ae){var Ue=new Da(Math.max(Ae*2,me));Ue.set(r),r=Ue}},"cbuf"),p=e.f||0,m=e.p||0,y=e.b||0,v=e.l,w=e.d,E=e.m,M=e.n,I=n*8;do{if(!v){p=Gc(t,m,1);var P=Gc(t,m+1,3);if(m+=3,P)if(P==1)v=LCe,w=RCe,E=9,M=5;else if(P==2){var C=Gc(t,m,31)+257,T=Gc(t,m+10,15)+4,O=C+Gc(t,m+5,31)+1;m+=14;for(var F=new Da(O),k=new Da(19),B=0;B<T;++B)k[qw[B]]=Gc(t,m+B*3,7);m+=T*3;for(var U=WC(k),z=(1<<U)-1,q=ih(k,U,1),B=0;B<O;){var W=q[Gc(t,m,z)];m+=W&15;var J=W>>4;if(J<16)F[B++]=J;else{var V=0,oe=0;for(J==16?(oe=3+Gc(t,m,3),m+=2,V=F[B-1]):J==17?(oe=3+Gc(t,m,7),m+=3):J==18&&(oe=11+Gc(t,m,127),m+=7);oe--;)F[B++]=V}}var Y=F.subarray(0,C),he=F.subarray(C);E=WC(Y),M=WC(he),v=ih(Y,E,1),w=ih(he,M,1)}else hs(1);else{var J=gS(m)+4,Q=t[J-4]|t[J-3]<<8,ae=J+Q;if(ae>n){u&&hs(0);break}l&&c(y+Q),r.set(t.subarray(J,ae),y),e.b=y+=Q,e.p=m=ae*8,e.f=p;continue}if(m>I){u&&hs(0);break}}l&&c(y+131072);for(var ee=(1<<E)-1,le=(1<<M)-1,K=m;;K=m){var V=v[XC(t,m)&ee],ce=V>>4;if(m+=V&15,m>I){u&&hs(0);break}if(V||hs(2),ce<256)r[y++]=ce;else if(ce==256){K=m,v=null;break}else{var te=ce-254;if(ce>264){var B=ce-257,ne=Ux[B];te=Gc(t,m,(1<<ne)-1)+EV[B],m+=ne}var pe=w[XC(t,m)&le],xe=pe>>4;pe||hs(3),m+=pe&15;var he=TCe[xe];if(xe>3){var ne=Vx[xe];he+=XC(t,m)&(1<<ne)-1,m+=ne}if(m>I){u&&hs(0);break}l&&c(y+131072);var Te=y+te;if(y<he){var fe=a-he,Pe=Math.min(he,Te);for(fe+y<0&&hs(3);y<Pe;++y)r[y]=i[fe+y]}for(;y<Te;++y)r[y]=r[y-he]}}e.l=v,e.p=K,e.b=y,e.f=p,v&&(p=1,e.m=E,e.d=w,e.n=M)}while(!p);return y!=r.length&&o?Tv(r,0,y):r.subarray(0,y)},"inflt"),vp=s(function(t,e,r){r<<=e&7;var i=e/8|0;t[i]|=r,t[i+1]|=r>>8},"wbits"),J0=s(function(t,e,r){r<<=e&7;var i=e/8|0;t[i]|=r,t[i+1]|=r>>8,t[i+2]|=r>>16},"wbits16"),ZC=s(function(t,e){for(var r=[],i=0;i<t.length;++i)t[i]&&r.push({s:i,f:t[i]});var n=r.length,a=r.slice();if(!n)return{t:IV,l:0};if(n==1){var o=new Da(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(O,F){return O.f-F.f}),r.push({s:-1,f:25001});var l=r[0],u=r[1],c=0,p=1,m=2;for(r[0]={s:-1,f:l.f+u.f,l,r:u};p!=n-1;)l=r[r[c].f<r[m].f?c++:m++],u=r[c!=p&&r[c].f<r[m].f?c++:m++],r[p++]={s:-1,f:l.f+u.f,l,r:u};for(var y=a[0].s,i=1;i<n;++i)a[i].s>y&&(y=a[i].s);var v=new eu(y+1),w=TT(r[p-1],v,0);if(w>e){var i=0,E=0,M=w-e,I=1<<M;for(a.sort(function(F,k){return v[k.s]-v[F.s]||F.f-k.f});i<n;++i){var P=a[i].s;if(v[P]>e)E+=I-(1<<w-v[P]),v[P]=e;else break}for(E>>=M;E>0;){var C=a[i].s;v[C]<e?E-=1<<e-v[C]++-1:++i}for(;i>=0&&E;--i){var T=a[i].s;v[T]==e&&(--v[T],++E)}w=e}return{t:new Da(v),l:w}},"hTree"),TT=s(function(t,e,r){return t.s==-1?Math.max(TT(t.l,e,r+1),TT(t.r,e,r+1)):e[t.s]=r},"ln"),t8=s(function(t){for(var e=t.length;e&&!t[--e];);for(var r=new eu(++e),i=0,n=t[0],a=1,o=s(function(u){r[i++]=u},"w"),l=1;l<=e;++l)if(t[l]==n&&l!=e)++a;else{if(!n&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(n),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(n);a=1,n=t[l]}return{c:r.subarray(0,i),n:e}},"lc"),Q0=s(function(t,e){for(var r=0,i=0;i<e.length;++i)r+=t[i]*e[i];return r},"clen"),CV=s(function(t,e,r){var i=r.length,n=gS(e+2);t[n]=i&255,t[n+1]=i>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var a=0;a<i;++a)t[n+a+4]=r[a];return(n+4+i)*8},"wfblk"),r8=s(function(t,e,r,i,n,a,o,l,u,c,p){vp(e,p++,r),++n[256];for(var m=ZC(n,15),y=m.t,v=m.l,w=ZC(a,15),E=w.t,M=w.l,I=t8(y),P=I.c,C=I.n,T=t8(E),O=T.c,F=T.n,k=new eu(19),B=0;B<P.length;++B)++k[P[B]&31];for(var B=0;B<O.length;++B)++k[O[B]&31];for(var U=ZC(k,7),z=U.t,q=U.l,W=19;W>4&&!z[qw[W-1]];--W);var J=c+5<<3,V=Q0(n,bf)+Q0(a,H_)+o,oe=Q0(n,y)+Q0(a,E)+o+14+3*W+Q0(k,z)+2*k[16]+3*k[17]+7*k[18];if(u>=0&&J<=V&&J<=oe)return CV(e,p,t.subarray(u,u+c));var Y,he,Q,ae;if(vp(e,p,1+(oe<V)),p+=2,oe<V){Y=ih(y,v,0),he=y,Q=ih(E,M,0),ae=E;var ee=ih(z,q,0);vp(e,p,C-257),vp(e,p+5,F-1),vp(e,p+10,W-4),p+=14;for(var B=0;B<W;++B)vp(e,p+3*B,z[qw[B]]);p+=3*W;for(var le=[P,O],K=0;K<2;++K)for(var ce=le[K],B=0;B<ce.length;++B){var te=ce[B]&31;vp(e,p,ee[te]),p+=z[te],te>15&&(vp(e,p,ce[B]>>5&127),p+=ce[B]>>12)}}else Y=PCe,he=bf,Q=DCe,ae=H_;for(var B=0;B<l;++B){var ne=i[B];if(ne>255){var te=ne>>18&31;J0(e,p,Y[te+257]),p+=he[te+257],te>7&&(vp(e,p,ne>>23&31),p+=Ux[te]);var pe=ne&31;J0(e,p,Q[pe]),p+=ae[pe],pe>3&&(J0(e,p,ne>>5&8191),p+=Vx[pe])}else J0(e,p,Y[ne]),p+=he[ne]}return J0(e,p,Y[256]),p+he[256]},"wblk"),FCe=new mS([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),IV=new Da(0),BCe=s(function(t,e,r,i,n,a){var o=a.z||t.length,l=new Da(i+o+5*(1+Math.ceil(o/7e3))+n),u=l.subarray(i,l.length-n),c=a.l,p=(a.r||0)&7;if(e){p&&(u[0]=a.r>>3);for(var m=FCe[e-1],y=m>>13,v=m&8191,w=(1<<r)-1,E=a.p||new eu(32768),M=a.h||new eu(w+1),I=Math.ceil(r/3),P=2*I,C=s(function(_e){return(t[_e]^t[_e+1]<<I^t[_e+2]<<P)&w},"hsh"),T=new mS(25e3),O=new eu(288),F=new eu(32),k=0,B=0,U=a.i||0,z=0,q=a.w||0,W=0;U+2<o;++U){var J=C(U),V=U&32767,oe=M[J];if(E[V]=oe,M[J]=V,q<=U){var Y=o-U;if((k>7e3||z>24576)&&(Y>423||!c)){p=r8(t,u,0,T,O,F,B,z,W,U-W,p),z=k=B=0,W=U;for(var he=0;he<286;++he)O[he]=0;for(var he=0;he<30;++he)F[he]=0}var Q=2,ae=0,ee=v,le=V-oe&32767;if(Y>2&&J==C(U-le))for(var K=Math.min(y,Y)-1,ce=Math.min(32767,U),te=Math.min(258,Y);le<=ce&&--ee&&V!=oe;){if(t[U+Q]==t[U+Q-le]){for(var ne=0;ne<te&&t[U+ne]==t[U+ne-le];++ne);if(ne>Q){if(Q=ne,ae=le,ne>K)break;for(var pe=Math.min(le,ne-2),xe=0,he=0;he<pe;++he){var Te=U-le+he&32767,fe=E[Te],Pe=Te-fe&32767;Pe>xe&&(xe=Pe,oe=Te)}}}V=oe,oe=E[V],le+=V-oe&32767}if(ae){T[z++]=268435456|IT[Q]<<18|e8[ae];var me=IT[Q]&31,Ae=e8[ae]&31;B+=Ux[me]+Vx[Ae],++O[257+me],++F[Ae],q=U+Q,++k}else T[z++]=t[U],++O[t[U]]}}for(U=Math.max(U,q);U<o;++U)T[z++]=t[U],++O[t[U]];p=r8(t,u,c,T,O,F,B,z,W,U-W,p),c||(a.r=p&7|u[p/8|0]<<3,p-=7,a.h=M,a.p=E,a.i=U,a.w=q)}else{for(var U=a.w||0;U<o+c;U+=65535){var Ue=U+65535;Ue>=o&&(u[p/8|0]=c,Ue=o),p=CV(u,p+1,t.subarray(U,Ue))}a.i=o}return Tv(l,0,i+gS(p)+n)},"dflt"),LZe=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,i=9;--i;)r=(r&1&&-306674912)^r>>>1;t[e]=r}return t}(),DZe=s(function(){var t=-1;return{p:s(function(e){for(var r=t,i=0;i<e.length;++i)r=LZe[r&255^e[i]]^r>>>8;t=r},"p"),d:s(function(){return~t},"d")}},"crc"),zCe=s(function(t,e,r,i,n){if(!n&&(n={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Da(a.length+t.length);o.set(a),o.set(t,a.length),t=o,n.w=a.length}return BCe(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,i,n)},"dopt"),TV=s(function(t,e){var r={};for(var i in t)r[i]=t[i];for(var i in e)r[i]=e[i];return r},"mrg"),zW=s(function(t,e,r){for(var i=t(),n=t.toString(),a=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<i.length;++o){var l=i[o],u=a[o];if(typeof l=="function"){e+=";"+u+"=";var c=l.toString();if(l.prototype)if(c.indexOf("[native code]")!=-1){var p=c.indexOf(" ",8)+1;e+=c.slice(p,c.indexOf("(",p))}else{e+=c;for(var m in l.prototype)e+=";"+u+".prototype."+m+"="+l.prototype[m].toString()}else e+=c}else r[u]=l}return e},"wcln"),_E=[],RZe=s(function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},"cbfs"),OZe=s(function(t,e,r,i){if(!_E[r]){for(var n="",a={},o=t.length-1,l=0;l<o;++l)n=zW(t[l],n,a);_E[r]={c:zW(t[o],n,a),e:a}}var u=TV({},_E[r].e);return PZe(_E[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,u,RZe(u),i)},"wrkr"),kZe=s(function(){return[Da,eu,mS,Ux,Vx,qw,EV,TCe,LCe,RCe,Ww,kCe,ih,WC,Gc,XC,gS,Tv,hs,NCe,U5,B5,UCe]},"bInflt"),NZe=s(function(){return[Da,eu,mS,Ux,Vx,qw,IT,e8,PCe,bf,DCe,H_,Ww,FCe,IV,ih,vp,J0,ZC,TT,t8,Q0,CV,r8,gS,Tv,BCe,zCe,z5,B5]},"bDflt"),B5=s(function(t){return postMessage(t,[t.buffer])},"pbf"),UCe=s(function(t){return t&&{out:t.size&&new Da(t.size),dictionary:t.dictionary}},"gopt"),VCe=s(function(t,e,r,i,n,a){var o=OZe(r,i,n,function(l,u){o.terminate(),a(l,u)});return o.postMessage([t,e],e.consume?[t.buffer]:[]),function(){o.terminate()}},"cbify"),Bp=s(function(t,e){return t[e]|t[e+1]<<8},"b2"),Rh=s(function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},"b4"),R6=s(function(t,e){return Rh(t,e)+Rh(t,e+4)*4294967296},"b8"),rl=s(function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},"wbytes");function jCe(t,e,r){return r||(r=e,e={}),typeof r!="function"&&hs(7),VCe(t,e,[NZe],function(i){return B5(z5(i.data[0],i.data[1]))},0,r)}s(jCe,"deflate");function z5(t,e){return zCe(t,e||{},0,0)}s(z5,"deflateSync");function $Ce(t,e,r){return r||(r=e,e={}),typeof r!="function"&&hs(7),VCe(t,e,[kZe],function(i){return B5(U5(i.data[0],UCe(i.data[1])))},1,r)}s($Ce,"inflate");function U5(t,e){return NCe(t,{i:2},e&&e.out,e&&e.dictionary)}s(U5,"inflateSync");var GCe=s(function(t,e,r,i){for(var n in t){var a=t[n],o=e+n,l=i;Array.isArray(a)&&(l=TV(i,a[1]),a=a[0]),a instanceof Da?r[o]=[a,l]:(r[o+="/"]=[new Da(0),l],GCe(a,o,r,i))}},"fltn"),UW=typeof TextEncoder<"u"&&new TextEncoder,i8=typeof TextDecoder<"u"&&new TextDecoder,FZe=0;try{i8.decode(IV,{stream:!0}),FZe=1}catch{}var BZe=s(function(t){for(var e="",r=0;;){var i=t[r++],n=(i>127)+(i>223)+(i>239);if(r+n>t.length)return{s:e,r:Tv(t,r-1)};n?n==3?(i=((i&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):n&1?e+=String.fromCharCode((i&31)<<6|t[r++]&63):e+=String.fromCharCode((i&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(i)}},"dutf8");function PT(t,e){if(e){for(var r=new Da(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}if(UW)return UW.encode(t);for(var n=t.length,a=new Da(t.length+(t.length>>1)),o=0,l=s(function(m){a[o++]=m},"w"),i=0;i<n;++i){if(o+5>a.length){var u=new Da(o+8+(n-i<<1));u.set(a),a=u}var c=t.charCodeAt(i);c<128||e?l(c):c<2048?(l(192|c>>6),l(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|t.charCodeAt(++i)&1023,l(240|c>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|c&63)):(l(224|c>>12),l(128|c>>6&63),l(128|c&63))}return Tv(a,0,o)}s(PT,"strToU8");function PV(t,e){if(e){for(var r="",i=0;i<t.length;i+=16384)r+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return r}else{if(i8)return i8.decode(t);var n=BZe(t),a=n.s,r=n.r;return r.length&&hs(8),a}}s(PV,"strFromU8");var zZe=s(function(t,e){return e+30+Bp(t,e+26)+Bp(t,e+28)},"slzh"),UZe=s(function(t,e,r){var i=Bp(t,e+28),n=PV(t.subarray(e+46,e+46+i),!(Bp(t,e+8)&2048)),a=e+46+i,o=Rh(t,e+20),l=r&&o==4294967295?VZe(t,a):[o,Rh(t,e+24),Rh(t,e+42)],u=l[0],c=l[1],p=l[2];return[Bp(t,e+10),u,c,n,a+Bp(t,e+30)+Bp(t,e+32),p]},"zh"),VZe=s(function(t,e){for(;Bp(t,e)!=1;e+=4+Bp(t,e+2));return[R6(t,e+12),R6(t,e+4),R6(t,e+20)]},"z64e"),n8=s(function(t){var e=0;if(t)for(var r in t){var i=t[r].length;i>65535&&hs(9),e+=i+4}return e},"exfl"),VW=s(function(t,e,r,i,n,a,o,l){var u=i.length,c=r.extra,p=l&&l.length,m=n8(c);rl(t,e,o!=null?33639248:67324752),e+=4,o!=null&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(a<0&&8),t[e++]=n&&8,t[e++]=r.compression&255,t[e++]=r.compression>>8;var y=new Date(r.mtime==null?Date.now():r.mtime),v=y.getFullYear()-1980;if((v<0||v>119)&&hs(10),rl(t,e,v<<25|y.getMonth()+1<<21|y.getDate()<<16|y.getHours()<<11|y.getMinutes()<<5|y.getSeconds()>>1),e+=4,a!=-1&&(rl(t,e,r.crc),rl(t,e+4,a<0?-a-2:a),rl(t,e+8,r.size)),rl(t,e+12,u),rl(t,e+14,m),e+=16,o!=null&&(rl(t,e,p),rl(t,e+6,r.attrs),rl(t,e+10,o),e+=14),t.set(i,e),e+=u,m)for(var w in c){var E=c[w],M=E.length;rl(t,e,+w),rl(t,e+2,M),t.set(E,e+4),e+=4+M}return p&&(t.set(l,e),e+=p),e},"wzh"),jZe=s(function(t,e,r,i,n){rl(t,e,101010256),rl(t,e+8,r),rl(t,e+10,r),rl(t,e+12,i),rl(t,e+16,n)},"wzf");function HCe(t,e,r){r||(r=e,e={}),typeof r!="function"&&hs(7);var i={};GCe(t,"",i,e);var n=Object.keys(i),a=n.length,o=0,l=0,u=a,c=new Array(a),p=[],m=s(function(){for(var M=0;M<p.length;++M)p[M]()},"tAll"),y=s(function(M,I){LT(function(){r(M,I)})},"cbd");LT(function(){y=r});var v=s(function(){var M=new Da(l+22),I=o,P=l-o;l=0;for(var C=0;C<u;++C){var T=c[C];try{var O=T.c.length;VW(M,l,T,T.f,T.u,O);var F=30+T.f.length+n8(T.extra),k=l+F;M.set(T.c,k),VW(M,o,T,T.f,T.u,O,l,T.m),o+=16+F+(T.m?T.m.length:0),l=k+O}catch(B){return y(B,null)}}jZe(M,o,c.length,P,I),y(null,M)},"cbf");a||v();for(var w=s(function(M){var I=n[M],P=i[I],C=P[0],T=P[1],O=DZe(),F=C.length;O.p(C);var k=PT(I),B=k.length,U=T.comment,z=U&&PT(U),q=z&&z.length,W=n8(T.extra),J=T.level==0?0:8,V=s(function(oe,Y){if(oe)m(),y(oe,null);else{var he=Y.length;c[M]=TV(T,{size:F,crc:O.d(),c:Y,f:k,m:z,u:B!=I.length||z&&U.length!=q,compression:J}),o+=30+B+W+he,l+=76+2*(B+W)+(q||0)+he,--a||v()}},"cbl");if(B>65535&&V(hs(11,0,1),null),!J)V(null,C);else if(F<16e4)try{V(null,z5(C,T))}catch(oe){V(oe,null)}else p.push(jCe(C,T,V))},"_loop_1"),E=0;E<u;++E)w(E);return m}s(HCe,"zip");var LT=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(t){t()};function qCe(t,e,r){r||(r=e,e={}),typeof r!="function"&&hs(7);var i=[],n=s(function(){for(var M=0;M<i.length;++M)i[M]()},"tAll"),a={},o=s(function(M,I){LT(function(){r(M,I)})},"cbd");LT(function(){o=r});for(var l=t.length-22;Rh(t,l)!=101010256;--l)if(!l||t.length-l>65558)return o(hs(13,0,1),null),n;var u=Bp(t,l+8);if(u){var c=u,p=Rh(t,l+16),m=p==4294967295||c==65535;if(m){var y=Rh(t,l-12);m=Rh(t,y)==101075792,m&&(c=u=Rh(t,y+32),p=Rh(t,y+48))}for(var v=e&&e.filter,w=s(function(M){var I=UZe(t,p,m),P=I[0],C=I[1],T=I[2],O=I[3],F=I[4],k=I[5],B=zZe(t,k);p=F;var U=s(function(q,W){q?(n(),o(q,null)):(W&&(a[O]=W),--u||o(null,a))},"cbl");if(!v||v({name:O,size:C,originalSize:T,compression:P}))if(!P)U(null,Tv(t,B,B+C));else if(P==8){var z=t.subarray(B,B+C);if(T<524288||C>.8*T)try{U(null,U5(z,{out:new Da(T)}))}catch(q){U(q,null)}else i.push($Ce(z,{size:T},U))}else U(hs(14,"unknown compression type "+P,1),null);else U(null,null)},"_loop_3"),E=0;E<c;++E)w(E)}else o(null,{});return n}s(qCe,"unzip");N();var $Ze=s(t=>{if(t!=null)return t.trim()===""?void 0:t},"maybePath"),GZe=s(t=>t!=null,"notNull"),YC=s((t,e,r=0)=>{var i;if(it.IsNull(t))return"null";if(it.IsUndefined(t))return"undefined";if(it.IsString(t))return"<string>";if(it.IsNumber(t))return"<number>";if(it.IsBoolean(t))return"<boolean>";if(it.IsLiteral(t))return typeof t.const=="string"?"'".concat(t.const,"'"):"".concat(t.const);if(it.IsRef(t)){let n=e.find(a=>a.$id===t.$ref);return n==null?t.$ref:YC(n,e,r)}if(it.IsArray(t))return"".concat(YC(t.items,e,r+1),"[]");if(it.IsUnion(t)&&(!(t.anyOf.length>5)||t.$id==null)){let n="".concat(t.anyOf.map(a=>YC(a,e,r+1)).filter(GZe).join(" | "));return r>0?"(".concat(n,")"):n}return(i=t.$id)!=null?i:""},"resolveSchemaIdent"),HZe=s((t,e,r)=>{var i;let n=e.message;it.IsUnion(e.schema)&&(n="Expected one of: ".concat(YC(e.schema,r)));let a="#/definitions/".concat(t).concat((i=$Ze(e.path))!=null?i:"");return"".concat(a,": ").concat(n)},"errorHandler"),WCe=s((t,e,r)=>{let i=e.First();if(i!=null)return HZe(t,i,r)},"shortError"),q_;(function(t){t.Archive="Archive",t.Validate="Validate",t.Encode="Encode",t.Unknown="Unknown"})(q_||(q_={}));var XCe=class extends Error{constructor(e,r){super(r),$(this,"name"),$(this,"kind"),this.name="CompressError",this.kind=e}};s(XCe,"CompressError");var V5=XCe,qZe=s(t=>new V5(q_.Archive,t.message),"flateErrorIntoCompressError"),WZe=s(t=>{let e=Object.values(OCe);return t instanceof Error&&"code"in t&&typeof t.code=="number"&&e.includes(t.code)},"isFlateError"),XZe=s((t,e,r)=>{var i;return new V5(q_.Validate,(i=WCe(t,e,r))!=null?i:"Unknown validate error")},"checkErrorIntoCompressError"),ZZe=s(t=>new V5(q_.Encode,t.message),"encodeErrorIntoCompressError"),YZe=s(t=>new V5(q_.Unknown,t instanceof Error?t.message:String(t)),"unknownErrorIntoCompressError"),jW=s((t,e,r)=>e instanceof _V?ZZe(e):e instanceof Dx?XZe(t,e,r):WZe(e)?qZe(e):YZe(e),"intoCompressError");N();var W_;(function(t){t.Unarchive="Unarchive",t.Validate="Validate",t.Decode="Decode",t.Unknown="Unknown"})(W_||(W_={}));var ZCe=class extends Error{constructor(e,r){super(r),$(this,"name"),$(this,"kind"),this.name="DecompressError",this.kind=e}};s(ZCe,"DecompressError");var j5=ZCe,KZe=s(t=>new j5(W_.Unarchive,t.message),"flateErrorIntoDecompressError"),JZe=s(t=>{let e=Object.values(OCe);return t instanceof Error&&"code"in t&&typeof t.code=="number"&&e.includes(t.code)},"isFlateError"),QZe=s((t,e,r)=>{var i;return new j5(W_.Validate,(i=WCe(t,e,r))!=null?i:"Unknown validate error")},"checkErrorIntoDecompressError"),eYe=s(t=>new j5(W_.Decode,t.message),"decodeErrorIntoDecompressError"),tYe=s(t=>new j5(W_.Unknown,t instanceof Error?t.message:String(t)),"unknownErrorIntoDecompressError"),$W=s((t,e,r)=>e instanceof vV?eYe(e):e instanceof Dx?QZe(t,e,r):JZe(e)?KZe(e):tYe(e),"intoDecompressError");N();N();N();var rYe=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,iYe=[0,31,28,31,30,31,30,31,31,30,31,30,31],nYe=s(t=>t%4===0&&(t%100!==0||t%400===0),"isLeapYear"),YCe=s(t=>{let e=rYe.exec(t);if(!e)return!1;let r=+e[1],i=+e[2],n=+e[3];return i>=1&&i<=12&&n>=1&&n<=(i===2&&nYe(r)?29:iYe[i])},"date");N();var aYe=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i,KCe=s(t=>{let e=aYe.exec(t);if(!e)return!1;let r=+e[1],i=+e[2],n=+e[3],a=e[4],o=e[5]==="-"?-1:1,l=+(e[6]||0),u=+(e[7]||0);if(l>23||u>59||!a)return!1;if(r<=23&&i<=59&&n<60)return!0;let c=i-u*o,p=r-l*o-(c<0?1:0);return(p===23||p===-1)&&(c===59||c===-1)&&n<61},"time"),oYe=/t|\s/i,sYe=s(t=>{let e=t.split(oYe);return e.length===2&&YCe(e[0])&&KCe(e[1])},"dateTime");N();var lYe=/\/|:/,uYe=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,cYe=s(t=>lYe.test(t)&&uYe.test(t),"uri"),hYe=[["date",YCe],["time",KCe],["date-time",sYe],["uri",cYe]],pYe=s(()=>{for(let[t,e]of hYe)try{$k.Format(t,e)}catch(r){if(r instanceof Q2e)continue;throw r}},"registerFormats");N();N();N();var dYe=s(t=>t instanceof Error?t:new Error(String(t)),"asError"),JCe=s(t=>(...e)=>{try{return Pi(t(...e))}catch(r){return Ri(dYe(r))}},"safeFn"),fYe=JCe((t,e)=>{let r={};for(let i of e)for(let n of i.intoBundle(t))r[n.path]=PT(JSON.stringify(n.contents));return r}),GW=s(async(t,e,r)=>fYe(t,e).andThenAsync(i=>new Promise(n=>{HCe(i,vt(Ee({},r),{consume:!0}),(a,o)=>{n(a?Ri(a):Pi(o))})})),"compress");N();N();function DT(t,e,r=[]){let i=Ee({},t);for(let[n,a]of Object.entries(e))if(a!==void 0)if(n in i){let o=n;if(Array.isArray(a)&&a.length>0){let l=QCe(a[0],r);if(l){let u=i[o];if(!Array.isArray(u))throw new Error("Expected array at ".concat(n,", got ").concat(typeof u));let c=new Map(a.map(m=>[a8(m,l),m])),p=u.map(m=>{let y=c.get(a8(m,l));return y?DT(m,y,r):m});i[o]=p}else i[o]=a}else{let l=i[o];typeof l=="object"&&l!==null&&typeof a=="object"&&a!==null?Object.keys(a).length===0?i[o]=a:i[o]=DT(l,a,r):i[n]=a}}else i[n]=a;return i}s(DT,"deepMergeOn");function QCe(t,e){function r(i){if(typeof i!="object"||i===null)return null;for(let n of e)if(n in i&&typeof i[n]<"u")return[n];if(Array.isArray(i))return null;for(let[n,a]of Object.entries(i)){let o=r(a);if(o)return[n,...o]}return null}return s(r,"search"),r(t)}s(QCe,"findIdentifierKey");function a8(t,e){return e.reduce((r,i)=>{if(r&&typeof r=="object")return r[i]},t)}s(a8,"getValueByKeyPath");var mYe=s(t=>t,"identity"),gYe=s(t=>JSON.parse(PV(t)),"jsonDecode"),yYe=s((t,e)=>e.some(r=>r.fromBundle(t.name,new Uint8Array,mYe)!==void 0),"isFileExpected"),vYe=JCe((t,e)=>{let r={};for(let i of Object.keys(t)){let n=t[i];for(let a of e){let o=a.fromBundle(i,n,gYe);if(o){r=DT(r,o,[]);break}}}return r}),HW=s(async(t,e)=>new Promise(r=>qCe(t,{filter:s(i=>yYe(i,e),"filter")},(i,n)=>{r(i?Ri(i):Pi(n))})).then(r=>r.andThen(i=>vYe(i,e))),"decompress");N();var _Ye=s(t=>typeof t=="object"&&t!=null&&"$ref"in t&&typeof t.$ref=="string","isRef"),xYe=s(t=>{if(t.length<2)return!1;let e=t.filter(_Ye);if(e.length!==t.length)return!1;let r=e[0].$ref;return e.slice(1).every(i=>i.$ref===r)},"isDuplicateRef"),o8=s(t=>typeof t=="object"&&t!=null&&"allOf"in t&&Array.isArray(t.allOf)&&xYe(t.allOf)?t.allOf[0]:typeof t=="object"&&t!=null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o8(r)])):Array.isArray(t)?t.map(o8):t,"fixDuplicateAllOf");N();var s8=s(t=>typeof t=="object"&&t!=null&&"$ref"in t?vt(Ee({},t),{$ref:"#/definitions/".concat(t.$ref)}):typeof t=="object"&&t!=null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,s8(r)])):Array.isArray(t)?t.map(s8):t,"prefixReferences"),p_;(function(t){t.InvalidTypeboxSchema="InvalidTypeboxSchema",t.MissingReferenceId="MissingReferenceId",t.DuplicateReferenceId="DuplicateReferenceId",t.TypeboxError="TypeboxError",t.UnknownError="UnknownError"})(p_||(p_={}));var bYe=s(t=>({next(){for(let e of t){let r=e.next();if(!r.done)return r}return{done:!0,value:void 0}},[Symbol.iterator](){return this}}),"join"),wYe=s((...t)=>{let e=new Map;for(let r of bYe(t)){if(!r.$id)continue;let i=e.get(r.$id);if(i!=null&&i!==r)return Ri({kind:p_.DuplicateReferenceId,message:"Failed to register a reference for a schema with an $id that has already been used",schema:r});e.set(r.$id,r)}return Pi(e)},"computeReferenceMap"),Eh,e1,vm,_p,eIe=class tIe{constructor(e,r,i,n){Be(this,Eh),Be(this,e1),Be(this,vm,[]),Be(this,_p),He(this,Eh,e),He(this,e1,r),He(this,vm,i),He(this,_p,n),this.is=this.is.bind(this),this.parse=this.parse.bind(this),this.verify=this.verify.bind(this),this.jsonSchema=this.jsonSchema.bind(this),this.compress=this.compress.bind(this),this.decompress=this.decompress.bind(this)}static create(e,r="CoreMVF"){let i=de.Composite(e.extensions.map(a=>a.schema),{$id:r});if(!it.IsSchema(i))return Ri({kind:p_.InvalidTypeboxSchema,message:"Attempting to merge schemas produced an invalid schema",schema:i});let n=wYe(HXe.values(),VXe.values(),jXe.values(),$Xe.values(),GXe.values(),nZe.values(),e.extensions.flatMap(a=>{var o;return(o=a.references)!=null?o:[]}).values());if(!n.isOk())return n;try{pYe();let a=Qk.Compile(i,[...n.value.values()]);return Pi(new tIe(i,a,e.extensions,n.value))}catch(a){return a instanceof Ia?Ri({kind:p_.TypeboxError,message:a.message,original:a}):Ri({kind:p_.UnknownError,message:"An unknown error occurred while compiling the schema",original:a})}}is(e){return b(this,e1).Check(e)}parse(e){return b(this,e1).Check(e)?Pi(e):Ri(b(this,e1).Errors(e))}decode(e){try{return Pi(pCe(b(this,Eh),[...b(this,_p).values()],e))}catch(r){return Ri(r)}}encode(e){try{return Pi(wCe(b(this,Eh),[...b(this,_p).values()],e))}catch(r){return Ri(r)}}verify(e){for(let r of b(this,vm))if(r.integrityCheck){let i=r.integrityCheck(e);if(i.isErr())return Ri(i.error)}return Pi(!0)}jsonSchema(){var e;let r=JSON.parse(JSON.stringify([b(this,Eh),...b(this,_p).values()])),i=o8(s8({$id:"#/definitions/".concat((e=b(this,Eh).$id)!=null?e:"CoreMVF"),$schema:"http://json-schema.org/draft-07/schema#",references:r}));return JSON.stringify(i,null,2)}async compress(e){return this.encode(e).andThen(r=>this.parse(r)).andThenAsync(r=>GW(r,b(this,vm))).then(r=>r.mapErr(i=>{var n;return jW((n=b(this,Eh).$id)!=null?n:"CoreMVF",i,[...b(this,_p).values()])}))}async compressUnsafe(e){return this.encode(e).andThenAsync(r=>GW(r,b(this,vm))).then(r=>r.mapErr(i=>{var n;return jW((n=b(this,Eh).$id)!=null?n:"CoreMVF",i,[...b(this,_p).values()])}))}async decompress(e){return HW(e,b(this,vm)).then(r=>r.andThen(i=>this.parse(i)).andThen(i=>this.decode(i)).mapErr(i=>{var n;return $W((n=b(this,Eh).$id)!=null?n:"CoreMVF",i,[...b(this,_p).values()])}))}async decompressUnsafe(e){return HW(e,b(this,vm)).then(r=>r.andThen(i=>this.decode(i)).mapErr(i=>{var n;return $W((n=b(this,Eh).$id)!=null?n:"CoreMVF",i,[...b(this,_p).values()])}))}};Eh=new WeakMap,e1=new WeakMap,vm=new WeakMap,_p=new WeakMap,s(eIe,"MVFParser");var AYe=eIe,I2,rIe=class{constructor(){Be(this,I2,[]),this.extend=this.extend.bind(this)}extend(e){return b(this,I2).push(e),this}extendOptional(e){let r=vt(Ee({},e),{schema:de.Partial(e.schema)});return b(this,I2).push(r),this}build(){return AYe.create(this)}get extensions(){return b(this,I2)}};I2=new WeakMap,s(rIe,"MVFParserBuilder");var SYe=rIe,MYe=s(()=>new SYe().extend(WXe).extend(eZe).extend(iZe),"createParser"),Xw=au("lcat","LocationCategoryId"),iIe=de.Intersect([de.Object({id:de.Ref(Xw),parent:de.Optional(de.Ref(Xw))}),aV(["name"]),cS],{$id:"LocationCategory"}),EYe=[Xw,iIe];N();N();var V1;(function(t){t.UnknownCategoryError="UnknownCategoryError",t.UnknownParentCategoryError="UnknownParentCategoryError",t.UnknownParentLocationError="UnknownParentLocationError"})(V1||(V1={}));var CYe=s(t=>{var e,r,i,n,a,o,l,u,c;if(t.locationCategories==null&&t.locations==null)return Pi(!0);let p=new Set((r=(e=t.locationCategories)==null?void 0:e.map(v=>v.id))!=null?r:[]);for(let v of(i=t.locationCategories)!=null?i:[])if(v.parent!=null&&!p.has(v.parent))return Ri({kind:V1.UnknownParentCategoryError,properties:{categoryId:v.id,parentCategoryId:v.parent}});let m=Lf(t);for(let v of(n=t.locations)!=null?n:[]){for(let w of v.categories)if(!p.has(w))return Ri({kind:V1.UnknownCategoryError,properties:{locationId:v.id,categoryId:w}});for(let w of v.geometryAnchors){let E=m(w.floorId,w.geometryId);if(E.isErr())return E}}let y=new Set((o=(a=t.locations)==null?void 0:a.map(v=>v.id))!=null?o:[]);for(let v of(l=t.locationInstances)!=null?l:[]){if(!y.has(v.parentId))return Ri({kind:V1.UnknownParentLocationError,properties:{locationInstanceId:v.id,parentLocationId:v.parentId}});for(let w of(u=v.categories)!=null?u:[])if(!p.has(w))return Ri({kind:V1.UnknownCategoryError,properties:{locationId:v.id,categoryId:w}});for(let w of(c=v.geometryAnchors)!=null?c:[]){let E=m(w.floorId,w.geometryId);if(E.isErr())return E}}return Pi(!0)},"validateLocations");N();var yS=au("loc","LocationId"),LV=au("loci","LocationInstanceId"),nIe=de.Object({name:de.String(),url:de.String({format:"uri"})},{$id:"LocationSocial"}),aIe=de.Object({url:de.String({format:"uri"})},{$id:"LocationImage"}),l8=de.Object({label:de.String(),url:de.String({format:"uri"})},{$id:"LocationLink"}),u8=de.String({pattern:"^[0-2][0-9]:[0-6][0-9](:[0-6][0-9])?$",$id:"OpeningHoursTime"}),oIe=de.Union([de.Literal("Sunday"),de.Literal("Monday"),de.Literal("Tuesday"),de.Literal("Wednesday"),de.Literal("Thursday"),de.Literal("Friday"),de.Literal("Saturday")],{$id:"OpeningHoursDay"}),IYe="PublicHolidays",c8=de.Union([oIe,de.Literal(IYe)],{$id:"OpeningHoursDayOrPublicHoliday"}),DV=de.Object({"@type":de.Optional(de.Literal("OpeningHoursSpecification",{description:"The type of opening hours"})),opens:de.Optional(de.Ref(u8,{description:"The time the opening hours start"})),closes:de.Optional(de.Ref(u8,{description:"The time the opening hours end"})),dayOfWeek:de.Optional(de.Union([de.Ref(c8),de.Array(de.Ref(c8))],{description:"The days of the week the opening hours apply to"})),validFrom:de.Optional(de.String({format:"date-time",description:"The date the opening hours start, in ISO 8601 format"})),validTo:de.Optional(de.String({format:"date-time",description:"The date the opening hours end, in ISO 8601 format"}))},{$id:"OpeningHoursSpecification"}),RV=de.Intersect([de.Object({id:de.Ref(yS),categories:de.Array(de.Ref(Xw)),logo:de.Optional(de.String({format:"uri"})),phone:de.Optional(de.String()),social:de.Array(de.Ref(nIe)),images:de.Array(de.Ref(aIe)),links:de.Array(de.Ref(l8)),website:de.Optional(de.Ref(l8)),openingHours:de.Optional(de.Array(de.Ref(DV)))}),aV(["name"]),oV(),cS],{$id:"Location"}),sIe=de.Intersect([de.Object({id:de.Ref(LV),parentId:de.Ref(yS)}),de.Partial(de.Omit(RV,["id","parentId"]))],{$id:"LocationInstance"}),lIe=[yS,LV,nIe,aIe,l8,u8,oIe,c8,DV,RV,sIe],TYe=de.Object({locations:de.Array(de.Ref(RV)),locationCategories:de.Array(de.Ref(iIe)),locationInstances:de.Optional(de.Array(de.Ref(sIe)))},{$id:"LocationsExtensionSchema"}),qW="locations.json",WW="location-categories.json",XW="location-instances.json",PYe={name:"ext:locations",schema:TYe,intoBundle:s(function*(t){t.locations!=null&&(yield{path:qW,contents:t.locations}),t.locationCategories!=null&&(yield{path:WW,contents:t.locationCategories}),t.locationInstances!=null&&(yield{path:XW,contents:t.locationInstances})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===qW)return{locations:r(e)};if(t===WW)return{locationCategories:r(e)};if(t===XW)return{locationInstances:r(e)}},"fromBundle"),references:[...EYe,...lIe],integrityCheck:CYe};N();N();var Zd;(function(t){t.UnknownEnterpriseLocationError="UnknownEnterpriseLocationError",t.EnterpriseLocationWithUnknownLocationError="EnterpriseLocationWithUnknownLocationError",t.EnterpriseCategoryWithUnknownLocationCategoryError="EnterpriseCategoryWithUnknownLocationCategoryError",t.InstanceWithUnknownLocationInstanceError="InstanceWithUnknownLocationInstanceError",t.InstanceWithUnknownEnterpriseLocationError="InstanceWithUnknownEnterpriseLocationError",t.EnterpriseLocationWithUnknownSibling="EnterpriseLocationWithUnknownSibling",t.EnterpriseLocationInstanceWithUnknownSibling="EnterpriseLocationInstanceWithUnknownSibling"})(Zd||(Zd={}));var LYe=s(t=>{var e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T;if(t.enterprise==null)return Pi(!0);let O=t.enterprise,F=new Set((r=(e=t.locationCategories)==null?void 0:e.map(W=>W.id))!=null?r:[]);for(let W of(i=O.categories)!=null?i:[])if(!F.has(W.categoryId))return Ri({kind:Zd.EnterpriseCategoryWithUnknownLocationCategoryError,properties:{enterpriseCategoryId:W.id,locationCategoryId:W.categoryId}});let k=new Set((a=(n=t.locations)==null?void 0:n.map(W=>W.id))!=null?a:[]);for(let W of(o=O.locations)!=null?o:[]){if(!k.has(W.locationId))return Ri({kind:Zd.EnterpriseLocationWithUnknownLocationError,properties:{enterpriseLocationId:W.id,locationId:W.locationId}});for(let J of(l=W.siblingGroups)!=null?l:[])for(let V of(u=J.siblings)!=null?u:[])if(!k.has(V))return Ri({kind:Zd.EnterpriseLocationWithUnknownSibling,properties:{enterpriseLocationId:W.id,siblingLocationId:V,label:J.label}})}let B=new Set((p=(c=t.enterprise.locations)==null?void 0:c.map(W=>W.id))!=null?p:[]);if(((m=O.venue)==null?void 0:m.topLocations)!=null){for(let W of O.venue.topLocations)if(!B.has(W))return Ri({kind:Zd.UnknownEnterpriseLocationError,properties:{enterpriseLocationId:W}})}let U=new Set((v=(y=t.locationInstances)==null?void 0:y.map(W=>W.id))!=null?v:[]);for(let W of(w=O.locationInstances)!=null?w:[]){if(!B.has(W.parentId))return Ri({kind:Zd.InstanceWithUnknownEnterpriseLocationError,properties:{enterpriseLocationInstanceId:W.id,enterpriseLocationId:W.parentId}});if(!U.has(W.locationInstanceId))return Ri({kind:Zd.InstanceWithUnknownLocationInstanceError,properties:{enterpriseLocationInstanceId:W.id,locationInstanceId:W.locationInstanceId}});for(let J of(E=W.siblingGroups)!=null?E:[])for(let V of(M=J.siblings)!=null?M:[])if(!k.has(V))return Ri({kind:Zd.EnterpriseLocationInstanceWithUnknownSibling,properties:{enterpriseLocationInstanceId:W.id,siblingLocationId:V,label:J.label}})}let z=k5(t),q=Lf(t);for(let[W,J]of Cs((I=O.floorText)!=null?I:{})){let V=z(W);if(V.isErr())return V;for(let oe of J.features){if(!("geometryId"in oe.properties))continue;let Y=q(W,oe.properties.geometryId);if(Y.isErr())return Y}}for(let[W,J]of Cs((P=O.textures)!=null?P:{})){let V=z(W);if(V.isErr())return V;for(let oe of J){let Y=q(W,oe.geometryId);if(Y.isErr())return Y}}for(let[W,J]of Cs((C=O.layers)!=null?C:{})){let V=z(W);if(V.isErr())return V;for(let oe of ds(J??{})){let Y=q(W,oe);if(Y.isErr())return Y}}for(let[W,J]of Cs((T=O.textAreas)!=null?T:{})){let V=z(W);if(V.isErr())return V;for(let oe of J.features)if("geometryId"in oe.properties){let Y=q(W,oe.properties.geometryId);if(Y.isErr())return Y}}return Pi(!0)},"validateCMS");N();N();var $5=au("el","EnterpriseLocationId"),uIe=au("ec","EnterpriseCategoryId"),cIe=au("eli","EnterpriseLocationInstanceId"),hIe=au("ev","EnterpriseVenueId"),pIe=au("eft","EnterpriseFloorTextId"),DYe=[$5,uIe,cIe,hIe,pIe],dIe=de.Object({id:de.Ref(uIe),categoryId:de.Ref(Xw),color:de.Optional(de.String()),sortOrder:de.Number(),iconFromDefaultList:de.Optional(de.Union([de.String(),de.Null()])),picture:de.Optional(de.String({format:"uri",description:"The category's picture"}))},{$id:"EnterpriseCategory"}),fIe=de.Object({categories:de.Optional(de.Array(de.Ref(dIe)))},{$id:"EnterpriseCategoriesSchema"}),RYe=[dIe,fIe];N();var mIe=Cv(["left","center","right"]),OYe=mIe.schema;mIe.values;var OV=de.Object({id:de.Ref(pIe),text:de.String(),visible:de.Boolean({default:!0}),fontSize:de.Number({default:12,minimum:1}),fontFamily:de.String({default:"Droid Sans"}),color:de.String({default:"black"}),rotation:de.Number({minimum:0,maximum:360}),align:OYe},{$id:"FloorTextCommonProperties"}),kV=de.Intersect([de.Ref(OV),Lx],{$id:"AnchoredFloorTextProperties"}),NV=de.Intersect([de.Ref(OV),de.Object({verticalOffset:de.Number()})],{$id:"FloatingFloorTextProperties"}),gIe=de.Union([de.Ref(kV),de.Ref(NV)],{$id:"FloorTextProperties"}),yIe=Pf(Tf,de.Ref(gIe),{$id:"FloorTextFeature"}),kYe=Pf(Tf,de.Ref(kV),{$id:"AnchoredFloorTextFeature"}),NYe=Pf(Tf,de.Ref(NV),{$id:"FloatingFloorTextFeature"}),vIe=Ev(de.Ref(yIe),{$id:"EnterpriseFloorTextFeatureCollection"}),_Ie=de.Record(Gs,de.Ref(vIe),{$id:"EnterpriseFloorTextCollectionsByFloor",additionalProperties:!1}),xIe=de.Object({floorText:de.Optional(de.Ref(_Ie))},{$id:"EnterpriseFloorTextSchema"}),FYe=[OV,kV,NV,gIe,yIe,kYe,NYe,vIe,_Ie,xIe];N();var bIe=zu(de.Record(If,de.String({minLength:1}),{additionalProperties:!1,$id:"EnterpriseLayers"})),wIe=zu(de.Record(Gs,de.Ref(bIe),{additionalProperties:!1,$id:"EnterpriseLayersByFloor"})),AIe=de.Object({layers:de.Optional(de.Ref(wIe))},{$id:"EnterpriseLayersSchema"}),BYe=[bIe,wIe,AIe];N();N();N();var FV=Cv(["closed-temporarily","new","pop-up","coming-soon","relocated"]),zYe=FV.schema;FV.values;FV.record;var SIe=de.Object({type:zYe,start:de.Optional(de.String({format:"date",description:"The start date of the state"})),end:de.Optional(de.String({format:"date",description:"The end date of the state"}))},{$id:"LocationState",description:"The state of a location. Start and end dates are optional."}),MIe=de.Object({label:de.String(),siblings:de.Array(de.Ref(yS))},{$id:"SiblingGroup"}),h8=de.Object({name:de.String(),code:de.String()},{$id:"Language"}),UYe=[SIe,MIe,h8],BV=de.Object({id:de.Ref($5),locationId:de.Ref(yS),type:de.String(),sortOrder:de.Number(),tags:de.Optional(de.Array(de.String())),picture:de.Optional(de.String({format:"uri",description:"The picture of the location"})),states:de.Optional(de.Array(de.Ref(SIe),{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set"})),siblingGroups:de.Optional(de.Array(de.Ref(MIe))),gallery:de.Optional(de.Array(de.Object({caption:de.Optional(de.String()),image:de.String({format:"uri"}),embeddedUrl:de.Optional(de.String({format:"uri",description:"The URL to link from the image"}))},{description:"The location's image gallery"}),{description:"The location's image gallery"})),showFloatingLabelWhenImagePresent:de.Optional(de.Boolean({description:"Whether to show the flat label when an image is present"})),amenity:de.Optional(de.String({description:"The location's amenity type. Only set if the location is an amenity"})),showLogo:de.Optional(de.Boolean({description:"Whether to show the logo of the location"}))},{$id:"EnterpriseLocation"}),EIe=de.Object({locations:de.Optional(de.Array(de.Ref(BV)))},{$id:"EnterpriseLocationsSchema"}),VYe=[BV,EIe],CIe=de.Intersect([de.Object({id:de.Ref(cIe),parentId:de.Ref($5),locationInstanceId:de.Ref(LV)}),de.Partial(de.Omit(BV,["id","parentId","locationId"]))],{$id:"EnterpriseLocationInstance",description:"A locationInstance is a particular instance of an Enterprise Location that has some properties different from the parent."}),IIe=de.Object({locationInstances:de.Optional(de.Array(de.Ref(CIe)))},{$id:"EnterpriseLocationInstancesSchema"}),jYe=[CIe,IIe];N();var zV=Cv(["near","center"],{$id:"EnterpriseTextAreaAlignment"}),TIe=zV.schema;zV.values;zV.record;var UV=de.Object({maxWidth:de.Number({exclusiveMinimum:0,description:"The maximum width of the label, in meters."}),maxHeight:de.Number({exclusiveMinimum:0,description:"The maximum height of the label, in meters."}),align:de.Ref(TIe),rotation:de.Number({minimum:0,maximum:360,description:"Rotation in degrees, about the center of the image. North is 0, east is 90."})},{$id:"EnterpriseBaseTextAreaProperties"}),PIe=de.Intersect([de.Ref(UV),Lx],{$id:"EnterpriseAnchoredTextAreaProperties"}),LIe=de.Intersect([de.Ref(UV),de.Object({verticalOffset:de.Number({minimum:0,description:"How high to position the image, in meters, relative to the ground plane."})})],{$id:"EnterpriseFloatingTextAreaProperties"}),DIe=de.Union([PIe,LIe],{$id:"EnterpriseTextAreaProperties"}),RIe=Pf(de.Ref(Tf),DIe,{$id:"EnterpriseTextAreaFeature"}),OIe=Ev(de.Ref(RIe),{$id:"EnterpriseTextAreaCollection"}),kIe=de.Record(Gs,de.Ref(OIe),{$id:"EnterpriseTextAreasByFloor",additionalProperties:!1}),$Ye=de.Object({textAreas:de.Optional(de.Ref(kIe))},{$id:"EnterpriseTextAreasSchema"}),GYe=[TIe,UV,PIe,LIe,DIe,RIe,OIe,kIe];N();var p8=de.Object({u:de.Number(),v:de.Number()},{$id:"EnterpriseTextureUV"}),VV=Cv(["top","side"],{$id:"EnterpriseTextureFace"}),NIe=VV.schema;VV.values;VV.record;var jV=Cv(["inside","outside","both"],{$id:"EnterpriseTextureSurface"}),FIe=jV.schema;jV.values;jV.record;var BIe=de.Tuple([bT,wT,bT,wT],{$id:"EnterpriseTextureBounds"}),zIe=de.Intersect([de.Object({repeat:de.Ref(p8),offset:de.Ref(p8),rotation:de.Number({minimum:0,maximum:360}),path:de.String({format:"uri"}),face:de.Ref(NIe),surface:de.Ref(FIe),bounds:de.Ref(BIe)},{$id:"EnterpriseTextureProperties"}),Lx],{$id:"EnterpriseTexture"}),UIe=de.Array(de.Ref(zIe),{$id:"EnterpriseTextures"}),VIe=de.Record(Gs,de.Ref(UIe),{$id:"EnterpriseTexturesByFloor",additionalProperties:!1}),jIe=de.Object({textures:de.Optional(de.Ref(VIe))},{$id:"EnterpriseTexturesSchema"}),HYe=[zIe,UIe,jIe,p8,NIe,FIe,BIe,VIe];N();var $Ie=de.Intersect([de.Object({id:de.Ref(hIe),slug:de.String(),defaultLanguage:de.Ref(h8),languages:de.Array(de.Ref(h8)),countrycode:de.Optional(de.String()),logo:de.Optional(de.String({format:"uri"})),mappedinWebUrl:de.Optional(de.String({format:"uri"})),topLocations:de.Optional(de.Array(de.Ref($5))),operationHours:de.Optional(de.Array(de.Ref(DV))),coverImage:de.Optional(de.String({format:"uri"}))}),aV(["name"]),cS],{$id:"EnterpriseVenue"}),GIe=de.Object({venue:de.Optional(de.Ref($Ie))},{$id:"EnterpriseVenueSchema"}),qYe=[$Ie,GIe],HIe=de.Intersect([GIe,EIe,IIe,fIe,jIe,xIe,AIe,$Ye],{$id:"EnterpriseProperties"}),ZW=de.Object({enterprise:de.Optional(de.Ref(HIe))},{$id:"CMSExtensionSchema"}),WYe=/^enterprise\/(?:([^/]+)\/)?([^/]+)\.(?:json|geojson)$/,XYe={name:"ext:cms",schema:ZW,intoBundle:s(function*(t){var e,r,i,n,a,o;if(t.enterprise==null)return;let l=t.enterprise;for(let u of ds(l))switch(u){case"floorText":for(let c of ds((e=l.floorText)!=null?e:{}))yield{path:"enterprise/floorText/".concat(c,".geojson"),contents:((r=l.floorText)!=null?r:{})[c]};continue;case"textures":for(let c of ds((i=l.textures)!=null?i:{}))yield{path:"enterprise/textures/".concat(c,".json"),contents:((n=l.textures)!=null?n:{})[c]};continue;case"textAreas":for(let c of ds((a=l.textAreas)!=null?a:{}))yield{path:"enterprise/textAreas/".concat(c,".geojson"),contents:((o=l.textAreas)!=null?o:{})[c]};continue;default:yield{path:"enterprise/".concat(u,".json"),contents:l[u]};continue}},"intoBundle"),fromBundle:s((t,e,r)=>{let i=t.match(WYe);if(!i)return;let[,n,a]=i,o=r(e);switch(n){case"floorText":case"textures":case"textAreas":return{enterprise:{[n]:{[a]:o}}};default:return{enterprise:{[a]:o}}}},"fromBundle"),references:[HIe,ZW,...qYe,...VYe,...jYe,...RYe,...HYe,...BYe,...FYe,...GYe,...DYe,...UYe,...lIe],integrityCheck:LYe};N();N();N();N();var uf;(function(t){t.NavigationFlagMissingDeclaration="NavigationFlagMissingDeclaration",t.NavigationFlagDuplicateBit="NavigationFlagDuplicateBit",t.NavigationFlagIncorrectFlagsLength="NavigationFlagIncorrectFlagsLength",t.NavigationFlagValueTooBig="NavigationFlagValueTooBig"})(uf||(uf={}));var ZYe=s(t=>{let{navigationFlags:e}=t;if(!e||Object.keys(e).length===0)return Pi(!0);let r=Object.entries(e).map(([a,o])=>Ee({key:a},o)).sort((a,o)=>a.index!==o.index?a.index-o.index:a.bit-o.bit),i=0,n=-1;for(let a of r){if(a.bit===n)return Ri({kind:uf.NavigationFlagDuplicateBit,properties:{index:a.index,bit:a.bit,path:"navigationFlags.".concat(a.key)}});if(a.index!=i){if(n!=31)return Ri({kind:uf.NavigationFlagMissingDeclaration,properties:{index:i,bit:n+1,path:"navigationFlags"}});if(a.index!=i+1||a.bit!=0)return Ri({kind:uf.NavigationFlagMissingDeclaration,properties:{index:i+1,bit:0,path:"navigationFlags"}});i=a.index,n=0}else{if(a.bit!==n+1)return Ri({kind:uf.NavigationFlagMissingDeclaration,properties:{index:a.index,bit:n+1,path:"navigationFlags"}});n=a.bit}}return Pi(!0)},"validateNavigationFlags");N();function Zw(t,e){return e&&(t.flags[e.index]&1<<e.bit)!==0}s(Zw,"hasFlag");N();var YW=2**32-1,qIe=s(t=>{var e;let r=Object.keys((e=t.navigationFlags)!=null?e:{}).length;if(r===0)return{index:-1,flag:0};let i=Math.floor(r/32),n=r%32;return{index:i,flag:2**n-1}},"determineMaxNavigationFlags"),d8=s((t,e,r)=>{if(e.index==-1&&t.length===0)return Pi(!0);let i=e.flag>0||e.index===-1?e.index+1:e.index;if(t.length!==i)return Ri({kind:uf.NavigationFlagIncorrectFlagsLength,properties:{expected:i,actual:t.length,path:r}});for(let n=0;n<t.length;n++){let a=t[n];if(n<e.index){if(a>YW)return Ri({kind:uf.NavigationFlagValueTooBig,properties:{index:n,flagValue:a,expectedMaxFlagValue:YW,path:r}});continue}else if(a>e.flag)return Ri({kind:uf.NavigationFlagValueTooBig,properties:{index:n,flagValue:a,expectedMaxFlagValue:e.flag,path:r}})}return Pi(!0)},"validateFlags"),YYe=de.Object({index:de.Integer({description:"The index of the flag in a flags array.",minimum:0}),bit:de.Integer({description:"The bit position of the flag in a flag's bitfield.",minimum:0,maximum:31})},{$id:"NavigationFlagDeclarationCore"}),WIe=de.Intersect([YYe,uS],{$id:"NavigationFlagDeclaration",description:'A NavigationFlagDeclaration describes the relationship between a "key" that a developer might use to wayfind using that flag, and the index and bit position in an object\'s `flags` array.'}),KW={accessible:"accessible",outdoors:"outdoors"},XIe=de.Record(de.String(),WIe,{$id:"NavigationFlagDeclarations",description:"Any well known and custom flags present in the MVF"}),KYe=de.Object({navigationFlags:de.Ref(XIe)},{$id:"NavigationFlagsSchema"}),$V=de.Array(de.Integer({minimum:0,maximum:Math.pow(2,32)-1}),{$id:"Flags"}),ZIe=de.Object({flags:de.Ref($V)},{$id:"WithFlags"}),X_=de.Intersect([O5,ZIe],{$id:"FlaggedGeometryAnchor"}),JYe=de.Object({geometryAnchor:X_},{$id:"WithFlaggedGeometryAnchor"}),QYe=de.Object({geometryAnchors:de.Array(X_)},{$id:"WithFlaggedGeometryAnchors"}),eKe={name:"ext:mvf-navigation-flags",schema:KYe,intoBundle:s(function*(t){t.navigationFlags!=null&&(yield{path:"navigationFlags.json",contents:t.navigationFlags})},"intoBundle"),fromBundle:s((t,e,r)=>t!=="navigationFlags.json"?void 0:{navigationFlags:r(e)},"fromBundle"),references:[WIe,XIe,$V,X_,JYe,QYe],integrityCheck:ZYe};N();var tKe=s(t=>{if(t.connections==null)return Pi(!0);let e=Lf(t),r=qIe(t);for(let[i,n]of t.connections.entries()){for(let[a,o]of n.entrances.entries()){let l=e(o.floorId,o.geometryId);if(l.isErr())return l;let u=d8(o.flags,r,"connections[".concat(i,"].entrances[").concat(a,"]"));if(u.isErr())return u}for(let[a,o]of n.exits.entries()){let l=e(o.floorId,o.geometryId);if(l.isErr())return l;let u=d8(o.flags,r,"connections[".concat(i,"].exits[").concat(a,"]"));if(u.isErr())return u}}return Pi(!0)},"validateConnections"),YIe=au("c","ConnectionId"),{schema:rKe,values:xdt,record:iKe}=Cv(["elevator","escalator","travelator","stairs","door","ramp"],{$id:"ConnectionType"}),KIe=rKe,JIe=iKe,QIe=de.Intersect([de.Object({id:de.Ref(YIe,{description:"The unique identifier for the connection."}),entrances:de.Array(de.Ref(X_)),exits:de.Array(de.Ref(X_)),entryCost:de.Number({description:"The cost to enter the connection.",minimum:0}),floorCostMultiplier:de.Number({description:"The cost multiplier for each floor transitioned.",minimum:1}),type:de.Ref(KIe,{description:"The type of connection."})}),uS,cS],{$id:"ConnectionsProperties"}),e3e=de.Array(de.Ref(QIe),{$id:"ConnectionsCollection"}),nKe=de.Object({connections:de.Ref(e3e)},{$id:"ConnectionsExtensionSchema"}),JW="connections.json",aKe={name:"ext:connections",schema:nKe,intoBundle:s(function*(t){t.connections!=null&&(yield{path:JW,contents:t.connections})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===JW)return{connections:r(e)}},"fromBundle"),references:[QIe,e3e,KIe,YIe,X_,$V],integrityCheck:tKe};N();N();var oKe=s(t=>{if(t.defaultStyle==null)return Pi(!0);let e=Lf(t);for(let r of Object.values(t.defaultStyle))if(r!=null)for(let i of r.geometryAnchors){let n=e(i.floorId,i.geometryId);if(n.isErr())return n}return Pi(!0)},"validateDefaultStyle"),t3e=de.Intersect([oV(),cS,de.Object({altitude:de.Number({description:"How far off the bottom of the floor the objects with this style should be drawn, in meters."}),color:de.String({pattern:"^#[0-9a-fA-F]{6}$",description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB"}),height:de.Number({minimum:0,description:"The height of the objects belonging to this layer, in meters."}),opacity:de.Number({minimum:0,maximum:1,description:"The opacity of the objects belonging to this layer, from 0 to 1."}),buffer:de.Number({description:"The buffer amount to apply to the geometry, in meters. This can be used to inflate line string geometry for walls, but might also be applicable as a way to grow or shrink polygon geometry for aesthetic purposes. Can be negative."}),hidden:de.Optional(de.Boolean({description:"Whether or not the objects with this style should be hidden."}))})],{$id:"DefaultStyle"}),r3e=de.Record(de.String(),de.Ref(t3e),{$id:"DefaultStyleCollection",additionalProperties:!1}),sKe=de.Object({defaultStyle:de.Ref(r3e)},{$id:"DefaultStyleSchema"}),lKe={name:"ext:mvf-default-style",schema:sKe,intoBundle:s(function*(t){t.defaultStyle!=null&&(yield{path:"default-style.json",contents:t.defaultStyle})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="default-style.json")return{defaultStyle:r(e)}},"fromBundle"),references:[t3e,r3e],integrityCheck:oKe};N();N();N();N();var f8;(function(t){t.InvalidDefaultFloorError="InvalidDefaultFloorError"})(f8||(f8={}));var uKe=s(t=>{if(t.floorStacks==null)return Pi(!0);let e=k5(t);for(let r of t.floorStacks){for(let i of r.floors){let n=e(i);if(n.isErr())return n}if(r.defaultFloor!=null&&!r.floors.includes(r.defaultFloor))return Ri({kind:f8.InvalidDefaultFloorError,properties:{floorStackId:r.id,floorId:r.defaultFloor}})}return Pi(!0)},"validateFloorStacks"),GV=au("fs","FloorStackId"),i3e=de.Intersect([de.Object({id:de.Ref(GV,{description:"The unique identifier for the floor stack."}),floors:de.Array(de.Ref(Gs),{uniqueItems:!0,minItems:1,description:"The floors that are part of this floor stack."}),defaultFloor:de.Optional(de.Ref(Gs,{description:"The default floor for the floor stack."}))}),uS],{$id:"FloorStacksProperties"}),n3e=de.Array(de.Ref(i3e),{$id:"FloorStackCollection"}),cKe=de.Object({floorStacks:de.Ref(n3e)},{$id:"FloorStackExtensionSchema"}),QW="floor-stacks.json",hKe={name:"ext:floor-stacks",schema:cKe,intoBundle:s(function*(t){t.floorStacks!=null&&(yield{path:QW,contents:t.floorStacks})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===QW)return{floorStacks:r(e)}},"fromBundle"),references:[GV,i3e,n3e],integrityCheck:uKe};N();N();var RT;(function(t){t.MissingFloorStackError="MissingFloorStackError",t.UnknownFloorStackError="UnknownFloorStackError"})(RT||(RT={}));var pKe=s(t=>{if(t.facade==null)return Pi(!0);if(t.floorStacks==null)return Ri({kind:RT.MissingFloorStackError,properties:null});let e=new Set(t.floorStacks.map(i=>i.id)),r=Lf(t);for(let[i,n]of Cs(t.facade))if(n!=null){if(!e.has(i))return Ri({kind:RT.UnknownFloorStackError,properties:{floorStackId:i}});for(let a of n.geometryAnchors){let o=r(a.floorId,a.geometryId);if(o.isErr())return o}}return Pi(!0)},"validateFacade"),a3e=au("fc","FacadeId"),o3e=de.Intersect([de.Object({id:de.Ref(a3e)}),oV({minItems:1})],{$id:"FacadeProperties"}),dKe=de.Object({facade:zu(de.Record(GV,de.Ref(o3e),{additionalProperties:!1}))},{$id:"FacadeExtensionSchema"}),fKe=/^facade\/(.*)\.json$/,mKe={name:"ext:facade",schema:dKe,intoBundle:s(function*(t){if(t.facade!=null)for(let e of ds(t.facade))yield{path:"facade/".concat(e,".json"),contents:t.facade[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(fKe))==null?void 0:i[1];if(n)return{facade:{[n]:r(e)}}},"fromBundle"),references:[a3e,o3e],integrityCheck:pKe};N();N();var gKe=s(t=>{if(t.floorImages==null)return Pi(!0);let e=Lf(t);for(let[r,i]of Cs(t.floorImages))if(i!=null)for(let n of i.features){if(!("geometryId"in n.properties))continue;let a=n.properties.geometryId,o=e(r,a);if(o.isErr())return o}return Pi(!0)},"validateFloorImages"),HV=de.Object({path:de.String({format:"uri",description:"The path to the image. This will be a remote URL."}),width:de.Number({minimum:0,description:"The width of the image when represented on the map, in meters."}),height:de.Number({minimum:0,description:"The height of the image when represented on the map, in meters."}),rotation:de.Number({minimum:0,maximum:360,description:"Rotation in degrees, about the center of the image. North is 0, east is 90."})},{$id:"BaseFloorImageProperties"}),s3e=de.Intersect([de.Ref(HV),Lx],{$id:"AnchoredFloorImageProperties"}),l3e=de.Intersect([de.Ref(HV),de.Object({verticalOffset:de.Number({minimum:0,description:"How high to position the image, in meters, relative to the ground plane."})})],{$id:"FloatingFloorImageProperties"}),u3e=de.Union([s3e,l3e],{$id:"FloorImageProperties"}),c3e=Pf(de.Ref(Tf),u3e,{$id:"FloorImageFeature"}),h3e=Ev(de.Ref(c3e),{$id:"FloorImageCollection"}),yKe=de.Object({floorImages:zu(de.Record(Gs,de.Ref(h3e),{additionalProperties:!1}))},{$id:"FloorImagesExtensionSchema"}),vKe=/^floorImages\/(.*)\.geojson$/,_Ke={name:"ext:floor-images",schema:yKe,intoBundle:s(function*(t){if(t.floorImages!=null)for(let e of ds(t.floorImages))yield{path:"floorImages/".concat(e,".geojson"),contents:t.floorImages[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(vKe))==null?void 0:i[1];if(n)return{floorImages:{[n]:r(e)}}},"fromBundle"),references:[HV,s3e,l3e,u3e,c3e,h3e],integrityCheck:gKe};N();N();var xKe=s(t=>{if(t.kinds==null)return Pi(!0);let e=Lf(t);for(let[r,i]of Cs(t.kinds))if(i!=null)for(let n of ds(i)){let a=e(r,n);if(a.isErr())return a}return Pi(!0)},"validateKinds"),{values:bdt,schema:bKe,record:wdt}=Cv(["room","hallway","wall","desk","poi","area","window"],{$id:"Kind"}),p3e=bKe,d3e=zu(de.Record(If,de.Ref(p3e),{additionalProperties:!1,$id:"GeometryKinds"})),wKe=de.Object({kinds:zu(de.Record(Gs,de.Ref(d3e),{additionalProperties:!1}))},{$id:"KindsExtensionSchema"}),AKe=/^kinds\/(.*)\.json$/,SKe={name:"ext:kinds",schema:wKe,intoBundle:s(function*(t){if(t.kinds!=null)for(let e of ds(t.kinds))yield{path:"kinds/".concat(e,".json"),contents:t.kinds[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(AKe))==null?void 0:i[1];if(n)return{kinds:{[n]:r(e)}}},"fromBundle"),references:[p3e,d3e],integrityCheck:xKe};N();N();N();var m8;(function(t){t.UnknownNeighbor="UnknownNeighbor"})(m8||(m8={}));var MKe=s(t=>{if(t.nodes==null)return Pi(!0);let e=Lf(t),r=qIe(t);for(let[i,n]of Cs(t.nodes)){if(n==null)continue;let a=new Set(n.features.map(o=>o.properties.id));for(let[o,l]of n.features.entries()){for(let u of l.properties.geometryIds){let c=e(i,u);if(c.isErr())return c}for(let[u,c]of l.properties.neighbors.entries()){if(!a.has(c.id))return Ri({kind:m8.UnknownNeighbor,properties:{floorId:i,nodeId:l.properties.id,neighborId:c.id}});let p=d8(c.flags,r,'nodes["'.concat(i,'"].features[').concat(o,"].properties.neighbors[").concat(u,"]"));if(p.isErr())return p}}}return Pi(!0)},"validateNodes"),qV=au("n","NodeId"),f3e=de.Intersect([de.Object({id:de.Ref(qV,{description:"The unique identifier for the node."}),extraCost:de.Number({minimum:0,description:"The extra cost to traverse to the node, above the straight-line distance."})}),ZIe],{$id:"NodeNeighbor"}),m3e=de.Intersect([de.Object({id:de.Ref(qV,{description:"The unique identifier for the node."}),neighbors:de.Array(de.Ref(f3e),{description:"The neighbors of the node."})}),X2e],{$id:"NodeProperties"}),g3e=Pf(de.Ref(Tf),m3e,{$id:"NodeFeature"}),y3e=Ev(de.Ref(g3e),{$id:"NodeCollection"}),EKe=de.Object({nodes:zu(de.Record(Gs,de.Ref(y3e),{additionalProperties:!1}))},{$id:"NodesExtensionSchema"}),CKe=/^nodes\/(.*)\.json$/,IKe={name:"ext:nodes",schema:EKe,intoBundle:s(function*(t){if(t.nodes!=null)for(let e of ds(t.nodes))yield{path:"nodes/".concat(e,".json"),contents:t.nodes[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(CKe))==null?void 0:i[1];if(n)return{nodes:{[n]:r(e)}}},"fromBundle"),references:[qV,f3e,m3e,g3e,y3e],integrityCheck:MKe};N();N();N();var g8;(function(t){t.FloorInFloorStackError="FloorInFloorStackError"})(g8||(g8={}));var TKe=s(t=>{if(t.outdoors==null)return Pi(!0);let e=k5(t);for(let r of t.outdoors.floors){let i=e(r);if(i.isErr())return i;if(t.floorStacks!=null){for(let n of t.floorStacks)if(n.floors.includes(r))return Ri({kind:g8.FloorInFloorStackError,properties:{floorId:r,floorStackId:n.id}})}}return Pi(!0)},"validateOutdoors"),v3e=de.Object({floors:de.Array(de.Ref(Gs),{uniqueItems:!0,description:"A list of floor IDs that should be considered to contain outdoor features."})},{$id:"Outdoors"}),PKe=de.Object({outdoors:de.Ref(v3e)},{$id:"OutdoorsExtensionSchema"}),eX="outdoors.json",LKe={name:"ext:outdoors",schema:PKe,intoBundle:s(function*(t){t.outdoors!=null&&(yield{path:eX,contents:t.outdoors})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===eX)return{outdoors:r(e)}},"fromBundle"),references:[v3e],integrityCheck:TKe};N();N();N();var y8;(function(t){t.TilesetDuplicateKeyError="TilesetDuplicateKeyError"})(y8||(y8={}));var DKe=s(t=>{if(t.tileset==null)return Pi(!0);let e=new Set;if(e.add(t.tileset.default.key),t.tileset.others)for(let r of t.tileset.others){if(e.has(r.key))return Ri({kind:y8.TilesetDuplicateKeyError,properties:{key:r.key}});e.add(r.key)}return Pi(!0)},"validateTilesets"),v8=de.Object({key:de.String({minLength:1,description:"Unique identifier for the tileset style."}),name:de.String({minLength:1,description:"Display name of the tileset style."}),url:de.String({format:"uri",description:"URL of the tileset style."})},{$id:"TilesetStyle",description:"A tileset style definition."}),_3e=de.Object({default:de.Ref(v8,{description:"The default tileset style, which should be used."}),others:de.Optional(de.Array(de.Ref(v8,{description:"Additional tileset styles that can be used."})))},{$id:"TilesetCollection"}),RKe=de.Object({tileset:de.Ref(_3e)},{$id:"TilesetExtensionSchema"}),OKe={name:"ext:mvf-tileset",schema:RKe,intoBundle:s(function*(t){t.tileset!=null&&(yield{path:"tileset.json",contents:t.tileset})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="tileset.json")return{tileset:r(e)}},"fromBundle"),references:[v8,_3e],integrityCheck:DKe};N();var x3e=de.Object({},{$id:"WalkableProperties"}),b3e=de.Object({},{$id:"NonWalkableProperties"}),w3e=zu(de.Record(If,de.Ref(x3e),{$id:"WalkableGeometries",additionalProperties:!1})),A3e=zu(de.Record(If,de.Ref(b3e),{$id:"NonWalkableGeometries",additionalProperties:!1})),kKe=de.Object({walkable:zu(de.Record(Gs,de.Ref(w3e),{additionalProperties:!1})),nonwalkable:zu(de.Record(Gs,de.Ref(A3e),{additionalProperties:!1}))},{$id:"TraversabilitySchema"}),NKe=/^walkable\/(.*)\.json$/,FKe=/^nonwalkable\/(.*)\.json$/,BKe={name:"ext:mvf-traversability",schema:kKe,intoBundle:s(function*(t){if(t.walkable!=null)for(let e of ds(t.walkable))yield{path:"walkable/".concat(e,".json"),contents:t.walkable[e]};if(t.nonwalkable!=null)for(let e of ds(t.nonwalkable))yield{path:"nonwalkable/".concat(e,".json"),contents:t.nonwalkable[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i,n;let a=(i=t.match(NKe))==null?void 0:i[1];if(a!=null)return{walkable:{[a]:r(e)}};let o=(n=t.match(FKe))==null?void 0:n[1];if(o!=null)return{nonwalkable:{[o]:r(e)}}},"fromBundle"),references:[x3e,b3e,w3e,A3e]};N();N();function _8(t){return t.replace(/^g_/,"s_")}s(_8,"toSpaceId");function S3e(t){return t.replace(/^g_/,"o_")}s(S3e,"toObstructionId");function M3e(t){return t.replace(/^g_/,"w_")}s(M3e,"toWindowId");function E3e(t){return t.replace(/^g_/,"ar_")}s(E3e,"convertAreaId");function C3e(t,e,r){switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":{let i=[],n=0,a=t.geometry.type.replace("Multi","");for(let o of t.geometry.coordinates)i.push(vt(Ee({},t),{geometry:{type:a,coordinates:o},properties:vt(Ee({},t.properties),{id:"".concat(e,"-").concat(n++),kind:r})}));return i}default:return[vt(Ee({},t),{properties:vt(Ee({},t.properties),{id:e,kind:r})})]}}s(C3e,"splitMultiPartGeometryFeatureWithNewId");function t1(t,e,r,i){let n=new Map;for(let{feature:a,floorId:o}of t){let l=a.properties.id,u=i.get(l);if(e.has(l)){let c=C3e(a,r(l),u),p=c.map(y=>y.properties.id),m=p.map(y=>({geometryId:y,floorId:o}));n.set(l,{ids:p,features:c,anchors:m})}}return n}s(t1,"mapGeometryToOtherIds");function I3e(t){var e,r,i;let n={space:new Map,obstruction:new Map,area:new Map,window:new Map};if(!t.geometry)return n;let a=new Map(Object.values((e=t.kinds)!=null?e:{}).filter(m=>m!==void 0).flatMap(Cs)),o=Cs(t.geometry).flatMap(([m,y])=>{var v;return((v=y==null?void 0:y.features)!=null?v:[]).map(w=>({feature:w,floorId:m}))}).flat(),l=new Set(Object.values((r=t.walkable)!=null?r:{}).filter(m=>m!==void 0).flatMap(ds)),u=new Set(Object.values((i=t.nonwalkable)!=null?i:{}).filter(m=>m!==void 0).flatMap(ds)),c=new Set(Array.from(a.entries()).filter(([m,y])=>y==="area").map(([m])=>m)),p=new Set(Array.from(a.entries()).filter(([m,y])=>y==="window").map(([m])=>m));return l.size>0&&(n.space=t1(o,l,_8,a)),u.size>0&&(n.obstruction=t1(o,u,S3e,a)),c.size>0&&(n.area=t1(o,c,E3e,a)),p.size>0&&(n.window=t1(o,p,M3e,a)),l.size===0&&u.size===0&&c.size===0&&(n.space=t1(o,new Set(o.map(m=>m.feature.properties.id)),_8,a)),n}s(I3e,"createGeometryMaps");function T3e(t){let e=P3e(t),r=I3e(t),i=L3e(t);return{geometryMaps:r,nodesByGeometryId:e,geometryFeatureById:i}}s(T3e,"buildBuilderOptions");function P3e(t){var e,r,i;let n=new Map;for(let a of Object.values((e=t.nodes)!=null?e:{}))for(let o of(r=a==null?void 0:a.features)!=null?r:[])if(o.properties.geometryIds.length>0)for(let l of o.properties.geometryIds){let u=(i=n.get(l))!=null?i:[];u.push(o.properties.id),n.set(l,u)}return n}s(P3e,"buildNodesByGeometryId");function L3e(t){var e,r;let i=new Map;for(let n of Object.values((e=t.geometry)!=null?e:{}))for(let a of(r=n==null?void 0:n.features)!=null?r:[])i.set(a.properties.id,a);return i}s(L3e,"buildGeometryFeatureById");N();function D3e(t,e){if(!t.annotations||!t.annotationSymbols||!t.geometry)return{};let r={};for(let[i,n]of Cs(t.annotations)){if(!n||n.length===0||!t.geometry[i]||t.geometry[i].features.length===0)continue;let a=new Map(t.geometry[i].features.map(l=>[l.properties.id,l])),o={type:"FeatureCollection",features:[]};for(let l of n){let u=a.get(l.geometryId);if(!u||u.geometry.type!=="Point")continue;let c={id:l.id,externalId:l.externalId,symbolId:l.symbolKey};o.features.push({type:"Feature",geometry:u.geometry,properties:c})}r[i]=o}return{annotation:r}}s(D3e,"buildAnnotations");N();function R3e(t,{nodesByGeometryId:e}){var r,i,n,a,o,l,u;let c={"connection.json":[],entrance:{}},p=(r=t.navigationFlags)==null?void 0:r[KW.accessible],m=(i=t.navigationFlags)==null?void 0:i[KW.outdoors],y=new Map(Object.values((n=t.geometry)!=null?n:{}).flatMap(v=>{var w;return(w=v==null?void 0:v.features)!=null?w:[]}).map(v=>[v.properties.id,v]));for(let v of(a=t.connections)!=null?a:[]){if(WV(v,y)){let I=O3e(v,y,e,m);for(let[P,C]of I)c.entrance[P]||(c.entrance[P]={type:"FeatureCollection",features:[]}),c.entrance[P].features.push(C);continue}let w=p!=null&&v.entrances.every(I=>Zw(I,p))&&v.exits.every(I=>Zw(I,p)),E=Array.from(new Set([...v.entrances.map(I=>e.get(I.geometryId)),...v.exits.map(I=>e.get(I.geometryId))].flat().filter(I=>I!=null))),M={id:v.id,externalId:(l=(o=v.details)==null?void 0:o.externalId)!=null?l:"",type:v.type,accessible:w,nodes:E};(u=v.details)!=null&&u.name&&(M.details={name:v.details.name}),v.extra&&(M.extra=v.extra),c["connection.json"].push(M)}return c}s(R3e,"buildConnections");function WV(t,e){return t.type==JIe.door&&t.entrances.every(r=>{let i=e.get(r.geometryId);return(i==null?void 0:i.geometry.type)==="LineString"})}s(WV,"isLineDoor");function O3e(t,e,r,i){var n,a;if(t.type!==JIe.door)return[];let o=[];for(let l of t.entrances){let u=e.get(l.geometryId);if((u==null?void 0:u.geometry.type)==="LineString"){let c={type:"Feature",geometry:u.geometry,properties:{id:t.id,externalId:(a=(n=t.details)==null?void 0:n.externalId)!=null?a:"",isExterior:k3e(t,i)}},p=t.details;p&&(c.properties.details={name:p.name,description:p.description},p.icon&&(c.properties.details.images=[{url:p.icon,altText:"".concat(p.name," icon")}]));let m=r.get(l.geometryId);m&&m.length>0&&(c.properties.node=m[0]),o.push([l.floorId,c])}}return o}s(O3e,"buildEntranceFeaturesFromConnection");function k3e(t,e){return t.entrances.some(r=>Zw(r,e))||t.exits.some(r=>Zw(r,e))}s(k3e,"isExterior");N();function N3e(t,{geometryMaps:e,nodesByGeometryId:r}){var i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T,O,F,k,B,U;if(!t.enterprise)return{};let z={categories:[],locations:[],locationInstances:[],layers:[],venue:{slug:"",name:"",externalId:"",defaultLanguage:{name:"",code:""},languages:[]}},q=(i=t.manifest)==null?void 0:i.features[0];if(q&&(z.venue.defaultFloor=q.properties.defaultFloor,z.venue.tzid=q.properties.tzid,z.venue.name=q.properties.name),t.enterprise.venue){let ne=t.enterprise.venue;z.venue=vt(Ee({},z.venue),{slug:ne.slug,name:(n=ne.details.name)!=null?n:z.venue.name,externalId:(a=ne.details.externalId)!=null?a:"",defaultLanguage:ne.defaultLanguage,languages:ne.languages,countrycode:ne.countrycode,coverImage:ne.coverImage,logo:ne.logo,icon:ne.details.icon,extra:ne.extra,mappedinWebUrl:ne.mappedinWebUrl,operationHours:ne.operationHours,topLocations:ne.topLocations})}let W=new Map,J=new Map,V=t.locations,oe=t.enterprise.locations;if(V&&oe){let ne=new Map(V.map(pe=>[pe.id,pe]));for(let pe of oe){let xe=ne.get(pe.locationId);if(xe){let Te=xe.details,fe={id:pe.id,name:Te.name,externalId:(o=Te.externalId)!=null?o:"",type:pe.type,sortOrder:pe.sortOrder,amenity:pe.amenity,description:Te.description,extra:xe.extra,links:xe.links,operationHours:xe.openingHours,gallery:pe.gallery,logo:xe.logo,shortName:Te.shortName,picture:pe.picture,showFloatingLabelWhenImagePresent:pe.showFloatingLabelWhenImagePresent,showLogo:pe.showLogo,siblingGroups:pe.siblingGroups,states:pe.states,tags:pe.tags,spaces:[],nodes:[],polygons:[]};xe.phone&&(fe.phone={number:xe.phone});let Pe=x8(xe.social);xe.website&&(Pe.website=xe.website.url),fe.social=Pe;for(let me of xe.geometryAnchors){let Ae=e.space.get(me.geometryId);if(Ae){let _e=new Set(Ae.features.filter(lt=>lt.geometry.type==="Polygon").map(lt=>lt.properties.id));for(let lt of Ae.anchors)fe.spaces.push({floor:lt.floorId,id:lt.geometryId}),_e.has(lt.geometryId)&&fe.polygons.push({map:lt.floorId,id:lt.geometryId})}let Ue=r.get(me.geometryId);for(let _e of Ue??[])fe.nodes.push({map:me.floorId,id:_e})}z.locations.push(fe);for(let me of xe.categories)W.set(me,[...(l=W.get(me))!=null?l:[],pe.id]);J.set(pe.id,xe.categories)}}}let Y=t.enterprise.locationInstances,he=t.locationInstances;if(Y&&he){let ne=new Map(he.map(xe=>[xe.id,xe])),pe=[];for(let xe of Y){let Te=ne.get(xe.locationInstanceId);if(Te){let fe={id:xe.id,parent:xe.parentId,name:(u=Te.details)==null?void 0:u.name,externalId:(c=Te.details)==null?void 0:c.externalId,type:xe.type,sortOrder:xe.sortOrder,amenity:xe.amenity,description:(p=Te.details)==null?void 0:p.description,extra:Te.extra,links:Te.links,operationHours:Te.openingHours,gallery:xe.gallery,picture:xe.picture,showFloatingLabelWhenImagePresent:xe.showFloatingLabelWhenImagePresent,showLogo:xe.showLogo,siblingGroups:xe.siblingGroups,states:xe.states,tags:xe.tags,logo:Te.logo,shortName:(m=Te.details)==null?void 0:m.shortName};Te.phone&&(fe.phone={number:Te.phone});let Pe=x8((y=Te.social)!=null?y:[]);if(Te.website&&(Pe.website=Te.website.url),Object.keys(Pe).length>0&&(fe.social=Pe),(v=Te.geometryAnchors)!=null&&v.length){let me=Te.geometryAnchors.flatMap(Ae=>{var Ue,_e;return(_e=(Ue=e.space.get(Ae.geometryId))==null?void 0:Ue.anchors)!=null?_e:[]});me.length>0&&(fe.spaces=me.map(Ae=>({floor:Ae.floorId,id:Ae.geometryId})))}if(Te.geometryAnchors){fe.spaces=[],fe.polygons=[],fe.nodes=[];for(let me of Te.geometryAnchors){let Ae=e.space.get(me.geometryId);if(Ae){let _e=new Set(Ae.features.filter(lt=>lt.geometry.type==="Polygon").map(lt=>lt.properties.id));for(let lt of Ae.anchors)fe.spaces.push({floor:lt.floorId,id:lt.geometryId}),_e.has(lt.geometryId)&&fe.polygons.push({map:lt.floorId,id:lt.geometryId})}let Ue=r.get(me.geometryId);for(let _e of Ue??[])fe.nodes.push({map:me.floorId,id:_e})}}pe.push(fe)}}pe.length>0&&(z.locationInstances=pe)}let Q=t.locationCategories,ae=t.enterprise.categories;if(Q&&ae){let ne=[],pe=new Map(Q.map(Pe=>[Pe.id,Pe])),xe=new Map(ae.map(Pe=>[Pe.categoryId,Pe.id])),Te=new Map;for(let Pe of Q){let me=xe.get(Pe.parent);if(me){let Ae=(w=Te.get(me))!=null?w:[];Ae.push(Pe.id),Te.set(me,Ae)}}for(let Pe of ae){let me=pe.get(Pe.categoryId);if(me){let Ae=((E=Te.get(Pe.id))!=null?E:[]).map(_e=>xe.get(_e)).filter(_e=>_e!==void 0),Ue={id:Pe.id,name:me.details.name,externalId:(M=me.details.externalId)!=null?M:"",sortOrder:Pe.sortOrder,children:Ae,locations:(I=W.get(Pe.categoryId))!=null?I:[],icon:me.details.icon,picture:Pe.picture,color:Pe.color,extra:me.extra,iconFromDefaultList:Pe.iconFromDefaultList};ne.push(Ue)}}z.categories=ne;let fe={};for(let[Pe,me]of J.entries())fe[Pe]=me.map(Ae=>xe.get(Ae)).filter(Ae=>Ae!==void 0);z.categoryPriorities=fe}let ee={};for(let[ne,pe]of Object.entries((P=t.defaultStyle)!=null?P:{}))if(pe.buffer>0){let xe=pe.geometryAnchors.flatMap(Te=>{var fe,Pe;return(Pe=(fe=e.space.get(Te.geometryId))==null?void 0:fe.anchors)!=null?Pe:[]});ee[ne]={edgeOffset:pe.buffer,geometryAnchors:xe}}Object.keys(ee).length>0&&(z.enterpriseStyles=ee);let le=new Map;for(let ne of Object.values((C=t.enterprise.layers)!=null?C:{}))if(ne)for(let[pe,xe]of Cs(ne)){if(typeof xe!="string")continue;let Te=(T=le.get(xe))!=null?T:{name:xe,id:"ely_".concat(xe),spaces:[]};Te.spaces.push(...(F=(O=e.space.get(pe))==null?void 0:O.anchors.map(fe=>({floorId:fe.floorId,spaceId:fe.geometryId})))!=null?F:[]),le.set(xe,Te)}le.size>0&&(z.layers=Array.from(le.values()));let K=[];for(let ne of Object.values((k=t.enterprise.textures)!=null?k:{}))for(let pe of ne){let xe=(B=e.space.get(pe.geometryId))==null?void 0:B.anchors;!xe||xe.length<1||pe.face==="unknown"||pe.surface==="unknown"||K.push({repeat:pe.repeat,offset:pe.offset,rotation:pe.rotation,path:pe.path,face:pe.face,surface:pe.surface,bounds:pe.bounds,geometryAnchors:xe})}K.length>0&&(z.textures=K);let ce={};for(let[ne,pe]of Object.entries((U=t.enterprise.floorText)!=null?U:{})){let xe={type:"FeatureCollection",features:[]};for(let Te of pe.features){if(Te.properties.align==="unknown")continue;let fe={align:Te.properties.align,color:Te.properties.color,fontFamily:Te.properties.fontFamily,fontSize:Te.properties.fontSize,rotation:Te.properties.rotation,text:Te.properties.text,visible:Te.properties.visible};"geometryId"in Te.properties?fe.geometryId=Te.properties.geometryId:fe.verticalOffset=Te.properties.verticalOffset,xe.features.push({type:"Feature",geometry:Te.geometry,properties:fe})}xe.features.length>0&&(ce[ne]=xe)}Object.keys(ce).length>0&&(z.floorText=ce);let te={enterprise:z};if(t.enterprise.textAreas){let ne={};for(let[pe,xe]of Cs(t.enterprise.textAreas)){let Te={type:"FeatureCollection",features:[]};for(let fe of xe.features){if(fe.properties.align==="unknown")continue;let Pe={align:fe.properties.align,maxWidth:fe.properties.maxWidth,maxHeight:fe.properties.maxHeight,rotation:fe.properties.rotation};"geometryId"in fe.properties?Pe.anchorId=fe.properties.geometryId:Pe.verticalOffset=fe.properties.verticalOffset;let me={type:"Feature",geometry:fe.geometry,properties:Pe};Te.features.push(me)}ne[pe]=Te}te.textAreas=ne}return te}s(N3e,"buildEnterprise");var zKe=["facebook","instagram","twitter"];function x8(t){let e={};for(let{name:r,url:i}of t){let n=r.toLowerCase();zKe.includes(n)&&(e[n]=i)}return e}s(x8,"convertSocials");N();function F3e(t,{geometryMaps:e}){if(!t.facade)return{};let r={},i={};for(let[n,a]of Cs(t.facade))a&&(i[n]={id:a.id,spaces:a.geometryAnchors.flatMap(({floorId:o,geometryId:l})=>{var u;return(u=e.space.get(l))==null?void 0:u.ids.map(c=>({floorId:o,spaceId:c}))}).filter(o=>o!==void 0)});return Object.keys(i).length>0&&(r.facade=i),r}s(F3e,"buildFacade");N();function B3e(t,e={}){var r,i,n,a,o,l,u,c,p,m,y,v;let w={type:"FeatureCollection",features:[]},E=[];for(let M of t.floors.features)E.push({id:M.properties.id.replace(/^f_/,"m_"),externalId:(i=(r=M.properties.details)==null?void 0:r.externalId)!=null?i:"",elevation:M.properties.elevation,name:(a=(n=M.properties.details)==null?void 0:n.name)!=null?a:"",shortName:(l=(o=M.properties.details)==null?void 0:o.shortName)!=null?l:"",subtitle:M.properties.subtitle}),w.features.push({type:"Feature",geometry:M.geometry,properties:{id:M.properties.id,externalId:(c=(u=M.properties.details)==null?void 0:u.externalId)!=null?c:"",elevation:M.properties.elevation,name:(m=(p=M.properties.details)==null?void 0:p.name)!=null?m:"",shortName:(v=(y=M.properties.details)==null?void 0:y.shortName)!=null?v:"",subtitle:M.properties.subtitle}});return{"floor.geojson":w,"map.geojson":E}}s(B3e,"buildFloors");N();function z3e(t,{geometryMaps:e}){var r,i,n,a,o;let l={},u={};for(let[c,p]of Cs((r=t.floorImages)!=null?r:{})){let m={features:[],type:"FeatureCollection"};for(let y of(i=p==null?void 0:p.features)!=null?i:[])if("verticalOffset"in y.properties)m.features.push(y);else{let v=y.properties,{geometryId:w}=v,E=Nh(v,["geometryId"]),M=(o=(n=e.space.get(w))==null?void 0:n.ids[0])!=null?o:(a=e.obstruction.get(w))==null?void 0:a.ids[0];if(!M)continue;let I={geometry:y.geometry,properties:vt(Ee({},E),{anchorId:M}),type:y.type};m.features.push(I)}u[c]=m}return Object.keys(u).length>0&&(l.floorImages=u),l}s(z3e,"buildFloorImages");N();function U3e(t,e={}){var r,i,n,a,o,l,u;let c=[];for(let p of(r=t==null?void 0:t.floorStacks)!=null?r:[]){let m={id:p.id,floors:p.floors,maps:p.floors,externalId:(n=(i=p.details)==null?void 0:i.externalId)!=null?n:"",name:(o=(a=p.details)==null?void 0:a.name)!=null?o:"",shortName:(u=(l=p.details)==null?void 0:l.shortName)!=null?u:"",type:"Building"};p.defaultFloor&&(m.defaultFloor=p.defaultFloor),c.push(m)}if(t.outdoors){let p={id:"outdoors",floors:t.outdoors.floors,maps:t.outdoors.floors,type:"Outdoor",name:"Outdoors",externalId:"outdoors"};c.push(p)}return{"floorstack.json":c,"mapstack.geojson":c}}s(U3e,"buildFloorStacks");N();N();var UKe=kr(gWe(),1),VKe=s(t=>{let e=t.geometry.coordinates[0],r=0;for(let i=0;i<e.length-1;i++)r+=e[i][0]*e[i+1][1]-e[i+1][0]*e[i][1];return Math.abs(r/2)},"calculateArea"),jKe=s((t,e)=>{let[r,i]=t,n=e.geometry.coordinates[0],a=!1;for(let o=0,l=n.length-1;o<n.length;l=o++){let[u,c]=n[o],[p,m]=n[l];c>i!=m>i&&r<(p-u)*(i-c)/(m-c)+u&&(a=!a)}return a},"pointInPolygon"),$Ke=s(t=>{let e=t.geometry.coordinates[0],r=0,i=0;for(let n=0;n<e.length-1;n++)r+=e[n][0],i+=e[n][1];return{geometry:{coordinates:[r/(e.length-1),i/(e.length-1)]}}},"calculateCenterOfMass"),GKe=s(t=>{let e=VKe(t),r=Number.isFinite(e)?Math.max(e,1):1;return Math.sqrt(r)*1e-6},"estimatePrecision"),XV=s(t=>{try{let e=$Ke(t).geometry.coordinates;if(!jKe(e,t)){let r=(0,UKe.default)(t.geometry.coordinates,GKe(t));return Pi([r[0],r[1]])}return Pi(e)}catch{return Ri(new Error("Unable to calculate center of polygon"))}},"labelCenter");function G5(t){var e;return((e=t==null?void 0:t.geometry)==null?void 0:e.type)==="Polygon"}s(G5,"isPolygonFeature");function V3e(t,{geometryMaps:e,nodesByGeometryId:r}){var i,n,a,o,l,u,c,p,m;let y=q3e(t.defaultStyle),v={},w={},E={},M={};for(let P of ds(t.geometry)){let C=t.geometry[P];if(!C)continue;let T=[],O=[],F=[],k=[];for(let B of C.features){let U=B.properties.id,z=y.has(U),q=(i=r.get(U))!=null?i:[];for(let W of(a=(n=e.space.get(U))==null?void 0:n.features)!=null?a:[])T.push(j3e(W,q));for(let W of(l=(o=e.obstruction.get(U))==null?void 0:o.features)!=null?l:[])O.push($3e(W,z));for(let W of(c=(u=e.area.get(U))==null?void 0:u.features)!=null?c:[])F.push(G3e(W,q));for(let W of(m=(p=e.window.get(U))==null?void 0:p.features)!=null?m:[])k.push(H3e(W))}T.length>0&&(v[P]={type:"FeatureCollection",features:T.filter(B=>B!==null)}),O.length>0&&(w[P]={type:"FeatureCollection",features:O.filter(B=>B!==null)}),F.length>0&&(E[P]={type:"FeatureCollection",features:F.filter(B=>B!==null)}),k.length>0&&(M[P]={type:"FeatureCollection",features:k.filter(B=>B!==null)})}let I={space:v,obstruction:w};return Object.keys(E).length>0&&(I.area=E),Object.keys(M).length>0&&(I.window=M),I}s(V3e,"buildGeometry");function j3e(t,e){var r,i;switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":return null}let n={type:"Feature",geometry:t.geometry,properties:{destinationNodes:e,id:t.properties.id,externalId:(i=(r=t.properties.details)==null?void 0:r.externalId)!=null?i:"",kind:t.properties.kind}};return t.properties.details&&(n.properties.details={name:t.properties.details.name,description:t.properties.details.description,images:t.properties.details.icon?[{url:t.properties.details.icon,altText:t.properties.details.name?"".concat(t.properties.details.name," icon"):"icon"}]:void 0}),G5(n)&&(n.properties.center=XV(n).unwrapOr(void 0)),n}s(j3e,"buildSpace");function $3e(t,e){var r,i;switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"Point":return null}let n=t.properties,a={type:"Feature",geometry:t.geometry,properties:{id:n.id,externalId:(i=(r=n.details)==null?void 0:r.externalId)!=null?i:"",entrances:[],kind:n.kind,footprintComponent:e}};return G5(a)&&(a.properties.center=XV(a).unwrapOr(void 0)),n.details&&(a.properties.details={name:n.details.name,description:n.details.description,images:n.details.icon?[{url:n.details.icon,altText:n.details.name?"".concat(n.details.name," icon"):"icon"}]:void 0}),a}s($3e,"buildObstruction");function G3e(t,e){var r,i;if(t.geometry.type!=="Polygon")return null;let n=t.properties,a={type:"Feature",geometry:t.geometry,properties:{id:n.id,externalId:(i=(r=n.details)==null?void 0:r.externalId)!=null?i:"",destinationNodes:e}};return G5(a)&&(a.properties.center=XV(a).unwrapOr(void 0)),n.details&&(a.properties.details={name:n.details.name,description:n.details.description,images:n.details.icon?[{url:n.details.icon,altText:n.details.name?"".concat(n.details.name," icon"):"icon"}]:void 0}),a}s(G3e,"buildArea");function H3e(t){return t.geometry.type!=="LineString"?null:{type:"Feature",geometry:t.geometry,properties:{id:t.properties.id}}}s(H3e,"buildWindow");function q3e(t){var e,r,i,n;let a=[...(r=(e=t==null?void 0:t.ExteriorWalls)==null?void 0:e.geometryAnchors)!=null?r:[],...(n=(i=t==null?void 0:t.Walls)==null?void 0:i.geometryAnchors)!=null?n:[]];return new Set(a.map(o=>o.geometryId))}s(q3e,"calculateFootprintGeometry");N();function W3e(t,{geometryMaps:e,geometryFeatureById:r}){var i,n,a,o,l,u,c,p,m,y,v,w,E;if(!t.locationCategories&&!t.locations)return{};let M={};if((i=t.locationCategories)!=null&&i.length){let I=[];for(let P of t.locationCategories){let C={id:P.id,name:P.details.name,icon:(n=P.details.icon)!=null?n:""};P.parent&&(C.parent=P.parent),I.push(C)}M["category.json"]=I}if((a=t.locations)!=null&&a.length){let I=X3e(t,{geometryFeatureById:r}),P=[];for(let C of t.locations){let T={id:C.id,name:C.details.name,categories:C.categories,spaces:[],obstructions:[],areas:[],annotations:[],connections:[],entrances:[],links:C.links,openingHoursSpecification:(o=C.openingHours)!=null?o:[],pictures:C.images,social:C.social,description:C.details.description,externalId:C.details.externalId,icon:C.details.icon,logo:C.logo,phone:C.phone,website:C.website};P.push(T);for(let{geometryId:O,floorId:F}of C.geometryAnchors)T.spaces.push(...(u=(l=e.space.get(O))==null?void 0:l.ids.map(k=>({id:k,floor:F})))!=null?u:[]),T.obstructions.push(...(p=(c=e.obstruction.get(O))==null?void 0:c.ids.map(k=>({id:k,floor:F})))!=null?p:[]),T.areas.push(...(y=(m=e.area.get(O))==null?void 0:m.ids.map(k=>({id:k,floor:F})))!=null?y:[]),T.entrances.push(...(v=I.entrancesByGeometryId.get(O))!=null?v:[]),T.connections.push(...(w=I.connectionsByGeometryId.get(O))!=null?w:[]),T.annotations.push(...(E=I.annotationsByGeometryId.get(O))!=null?E:[])}M["location.json"]=P}return M}s(W3e,"buildLocations");function X3e(t,{geometryFeatureById:e}){var r,i,n;let a={annotationsByGeometryId:new Map,connectionsByGeometryId:new Map,entrancesByGeometryId:new Map};if(t.annotations)for(let[o,l]of Cs(t.annotations))for(let u of l??[]){let c=u.geometryId,p=u.id,m=(r=a.annotationsByGeometryId.get(c))!=null?r:[];m.push({floor:o,id:p}),a.annotationsByGeometryId.set(c,m)}if(t.connections)for(let o of t.connections){let l=WV(o,e),u=Array.from(new Map([...o.entrances,...o.exits].map(c=>["".concat(c.geometryId,"_").concat(c.floorId),c])).values());for(let c of u){let p=c.geometryId;if(l){let m=(i=a.entrancesByGeometryId.get(p))!=null?i:[];m.push({floor:c.floorId,id:o.id}),a.entrancesByGeometryId.set(p,m)}else{let m=(n=a.connectionsByGeometryId.get(p))!=null?n:[];m.push(o.id),a.connectionsByGeometryId.set(p,m)}}}return a}s(X3e,"buildLocationAttachmentMaps");N();function Z3e(t,e){let r={features:[],type:"FeatureCollection"},i={"manifest.geojson":r},n=t.manifest;if(n.features.length>0){let a=n.features[0],o=a.properties,l={type:"Feature",geometry:a.geometry,properties:{folder_struct:[],version:"2.0.0",time:o.time,name:o.name,naturalBearing:o.naturalBearing,tzid:o.tzid,map:o.mapId,org_id:o.orgId,language:o.language}};r.features.push(l)}return i}s(Z3e,"buildManifest");N();function Y3e(t,{geometryMaps:e}){var r,i,n,a,o,l,u,c,p,m,y,v,w,E,M;let I={"node.geojson":{type:"FeatureCollection",features:[]}},P=I["node.geojson"].features,C=new Map;for(let F of(i=(r=t.floors)==null?void 0:r.features)!=null?i:[])C.set(F.properties.id,F.properties.elevation);let T=new Map;for(let F of Object.values((n=t.nodes)!=null?n:{}))for(let k of(a=F==null?void 0:F.features)!=null?a:[])for(let B of k.properties.geometryIds)T.set(B,[...(o=T.get(B))!=null?o:[],k.properties.id]);let O=new Map;for(let F of(l=t.connections)!=null?l:[]){let k=F.exits.map(B=>{var U;return vt(Ee({},B),{nodes:(U=T.get(B.geometryId))!=null?U:[]})});for(let B of F.entrances){let U=(u=T.get(B.geometryId))!=null?u:[];for(let z of U)for(let q of k){let W=Math.abs(((c=C.get(B.floorId))!=null?c:0)-((p=C.get(q.floorId))!=null?p:0))*F.floorCostMultiplier,J=(m=O.get(z))!=null?m:[];J.push(...q.nodes.map(V=>({id:V,weight:W+F.entryCost}))),O.set(z,J)}}}for(let[F,k]of Cs((y=t.nodes)!=null?y:{}))for(let B of(v=k==null?void 0:k.features)!=null?v:[]){let U=(w=e.space.get(B.properties.geometryIds[0]))==null?void 0:w.features[0],z=(U==null?void 0:U.geometry.type)==="Point"&&(E=U==null?void 0:U.properties.details)!=null&&E.externalId?U.properties.details.externalId:"",q={type:"Feature",geometry:B.geometry,properties:{id:B.properties.id,floor:F,space:B.properties.geometryIds.map(W=>{var J;return(J=e.space.get(W))==null?void 0:J.ids}).flat().filter(W=>W!==void 0),neighbors:[...B.properties.neighbors.map(W=>({id:W.id,weight:W.extraCost})),...(M=O.get(B.properties.id))!=null?M:[]],map:F,externalId:z}};P.push(q)}return I}s(Y3e,"buildNodes");N();function K3e(t,e){let r={};for(let i of t){let n=e.get(i);n&&(r[n]!=null||(r[n]=[]),r[n].push(i))}return r}s(K3e,"groupGeometryByType");function J3e(t,{geometryMaps:e}){var r,i,n;if(!t.defaultStyle)return{};let a={},o={};a["styles.json"]=o;let l=[...Array.from(e.space.values()).map(c=>c.features),...Array.from(e.obstruction.values()).map(c=>c.features)],u=new Map(l.flatMap(c=>c.map(p=>[p.properties.id,p.geometry.type])));for(let[c,p]of Cs(t.defaultStyle)){let m=K3e(p.geometryAnchors.flatMap(y=>{var v,w,E,M;return[...(w=(v=e.space.get(y.geometryId))==null?void 0:v.ids)!=null?w:[],...(M=(E=e.obstruction.get(y.geometryId))==null?void 0:E.ids)!=null?M:[]]}),u);if(m.Point&&m.Point.length>0){let y={points:Array.from(m.Point.values()),showImage:((r=p.extra)==null?void 0:r.showImage)!==void 0?((i=p.extra)==null?void 0:i.showImage)===!0:p.opacity!==0};o["".concat(c,".Point")]=y}if(m.LineString&&m.LineString.length>0){let y={lineStrings:Array.from(m.LineString.values()),altitude:p.altitude,color:p.color,height:p.height,opacity:p.opacity,width:p.buffer};o["".concat(c,".LineString")]=y}if(m.Polygon&&m.Polygon.length>0){let y={polygons:Array.from(m.Polygon.values()),altitude:p.altitude,color:p.color,height:p.height,opacity:p.opacity};((n=p.extra)==null?void 0:n.showImage)!==void 0&&(y.showImage=p.extra.showImage===!0),o["".concat(c,".Polygon")]=y}}return a}s(J3e,"buildStyles");var HKe=MYe().extendOptional(eKe).extendOptional(IKe).extendOptional(aKe).extendOptional(SKe).extendOptional(BKe).extendOptional(lKe).extendOptional(hKe).extendOptional(LKe).extendOptional(OKe).extendOptional(_Ke).extendOptional(mKe).extendOptional(uZe).extendOptional(PYe).extendOptional(XYe).build().expect("Invalid parser, this should never happen. Likely a bug in the MVFv2 library, or one of the extensions.");function Q3e(t){let e=T3e(t),r=B3e(t,e),i=V3e(t,e),n=Y3e(t,e),a=R3e(t,e),o=J3e(t,e),l=U3e(t,e),u=z3e(t,e),c=F3e(t,e),p=D3e(t),m=W3e(t,e),y=N3e(t,e),v=Z3e(t);return Ee(Ee(Ee(Ee(Ee(Ee(vt(Ee(Ee(Ee(Ee(Ee(Ee({},r),i),n),a),o),l),{"tileset.json":t.tileset}),u),c),p),m),y),v)}s(Q3e,"convertUnzippedStandardMVFv3ToParsedMVFv2");async function eTe(t){let e=await HKe.decompress(t);return e.isOk()?Pi(Q3e(e.value)):Ri(e.error)}s(eTe,"extractAndConvertMVFv3");N();function H5(t){return t.endsWith("/")?t:"".concat(t,"/")}s(H5,"normalizeUrl");N();var ZV="https://app.mappedin.com/",qKe="https://auth.mappedin.com/";N();N();var WKe=s(t=>{let e=Date.now();return t-e},"fromNow"),tTe=s((t,e)=>WKe(t)<=e*60*1e3,"shouldRefreshToken"),rTe=60,XKe=rTe*60*1e3,tX="accessTokens";async function YV(t,e=!1){let r="".concat(t.key),i=k_.getInstance(),n=(i==null?void 0:i.loadSessionData(tX))||{},a=Math.floor(Date.now()/1e3);if(n[r]&&!tTe(n[r].expiresTimestamp*1e3,rTe))return n[r];let o=e?await iTe(t,a):await nTe(t,a),l=vt(Ee({},n),{[r]:o});return i==null||i.saveSessionData(tX,l),o}s(YV,"getAccessToken");async function iTe(t,e){var r;let i="".concat((r=t.baseAuthUri)!=null?r:qKe,"oauth2/token"),n=await ld()(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials",client_id:t.key,client_secret:t.secret})});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText,": ").concat(await n.text()));let a=await n.json();return{accessToken:a.access_token,expiresTimestamp:e+a.expires_in}}s(iTe,"fetchAccessTokenEnterprise");async function nTe(t,e){let r="".concat(t.baseAuthUri?H5(t.baseAuthUri):ZV,"api/api-key/token"),i=await ld()(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t.key,secret:t.secret})});if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText,": ").concat(await i.text()));let n=await i.json();return{accessToken:n.access_token,expiresTimestamp:e+n.expires_in}}s(nTe,"fetchAccessToken");N();var aTe=60,ZKe=aTe*60*1e3,rX="miSasTokens";async function oTe(t,e){let r="".concat(e,"__").concat(t.mapId),i=k_.getInstance(),n=(i==null?void 0:i.loadSessionData(rX))||{};if(n[r]&&!tTe(n[r].expires,aTe))return n[r];let a=await sTe(t,e),o=vt(Ee({},n),{[r]:{token:a.token,expires:new Date(a.expires).getTime()}});return i==null||i.saveSessionData(rX,o),a}s(oTe,"getSasToken");async function sTe(t,e){let r="".concat(t.baseUri?H5(t.baseUri):ZV,"api/v1/venue/").concat(t.mapId,"/sas-token"),i=await ld()(r,{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText,": ").concat(await i.text()));let n=await i.json();return{token:n.token,expires:new Date(n.expires).getTime()}}s(sTe,"fetchSasToken");var iX=globalThis.fetch,nX,YKe=(nX=$a==null?void 0:$a.env)==null?void 0:nX.npm_package_version;function ld(){if(iX==null)throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return iX}s(ld,"isomorphicFetch");var b8={supplementaryUrl:"https://api-gateway.mappedin.com/analytics/",headers:{},accessToken:"",clientId:"",noAuth:!1,includeHidden:!0,clientSecret:"",apiGateway:"",authorization:"",perspective:"Website",language:"",venue:""};function lTe(t){var e;let r=Ee(Ee({},b8),t);return r.headers=vt(Ee({},r.headers),{"mappedin-sdk-version":YKe}),r.things=[],"platformString"in t&&(r.headers=vt(Ee({},r.headers),{"mappedin-platform-version":t.platformString})),r.noAuth||(r.accessToken?r.authorization="Bearer ".concat(r.accessToken):r.clientId&&r.clientSecret&&(r.authorization="Basic ".concat(globalThis.btoa("".concat(r.clientId,":").concat(r.clientSecret))))),r.language=(e=r.language)==null?void 0:e.toLowerCase(),r}s(lTe,"parseOptions");function uTe(t,e,r=!1){t.language,t.clientId,t.clientSecret;let{headers:i}=t;i["Content-Type"]=i["Content-Type"]||"text/json",t.accessToken?i.Authorization="Bearer ".concat(t.accessToken):t.noAuth||t.clientId&&t.clientSecret&&(i["x-mappedin-key"]=btoa(t.clientId),i["x-mappedin-secret"]=btoa(t.clientSecret));let n={method:"GET",headers:i};return t.secure&&(e+="&withcdntoken"),{req:n,url:e}}s(uTe,"constructParamsForRequest");async function cTe(t,e,r=!1){let i=uTe(t,e,r),n=await ld()(i.url,i.req);if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText));return n.json()}s(cTe,"generateAPIRequest");var KKe=s(t=>{let e=t!=null&&typeof t=="object"&&"perspectives"in t&&t.perspectives!=null&&typeof t.perspectives=="object"?t.perspectives:null;if(e==null||Object.keys(e).length===0)return Vt.warn("No perspectives available in response!"),null;let r={};for(let[i,n]of Object.entries(e)){let a="url"in n&&typeof n.url=="string"?n.url:null,o="locale_packs"in n&&typeof n.locale_packs=="object"?n.locale_packs:null;if(a==null||o==null){Vt.warn("Perspective ".concat(i," is missing url or locale_packs!"));continue}r[i]={url:a,locale_packs:o}}return r},"getPerspectivesFromResponse");async function hTe(t,e="exports/mvf/1/bundle"){var r,i;let n=lTe(Ee(Ee({baseUri:"https://api-gateway.mappedin.com/"},b8),t)),a="".concat(n.baseUri+e,"?venue=").concat(n.venue,"&version=").concat((r=n.version)!=null?r:"2.0.0");n.headers["Content-Type"]="application/zip";let o=await cTe(n,a),l=o.url,u=o.locale_packs,c=(i=n.perspective)!=null?i:b8.perspective,p=KKe(o);if(c!=null&&c!==""&&p!=null){let m=p[c];m==null?Vt.warn("Perspective ".concat(c," not found in response! Loading default perspective instead.")):(Vt.log('Loading perspective "'.concat(c,'"')),l=m.url,u=m.locale_packs)}return{url:l,localePacks:u,updated_at:o.updated_at}}s(hTe,"getVenueMVFURL");var Ub=function(){let t;return()=>(t||(t=new TextDecoder),t)}();async function w8(t,{signal:e}){let r=await(await ld()(t,{signal:e})).arrayBuffer();return new Uint8Array(r)}s(w8,"getLanguagePackUnitArray");async function q5(t){let e=(await ag(async()=>{const{unzipSync:i}=await import("./browser-CR4WWHP7-Dr7RN6H_.js");return{unzipSync:i}},[])).unzipSync(t),r={};if(e["enterprise/"]!=null){r.enterprise={};let i=e["enterprise/locations.json"];i&&(r.enterprise.locations=JSON.parse(Ub().decode(i)));let n=e["enterprise/categories.json"];n&&(r.enterprise.categories=JSON.parse(Ub().decode(n)))}return e["floorstack.json"]&&(r["floorstack.json"]=JSON.parse(Ub().decode(e["floorstack.json"]))),e["floor.geojson"]&&(r["floor.geojson"]=JSON.parse(Ub().decode(e["floor.geojson"]))),e["manifest.json"]&&(r["manifest.geojson"]=JSON.parse(Ub().decode(e["manifest.json"]))),r}s(q5,"parseLanguagePack");async function pTe(t,{signal:e}){try{let r=await(await ld()(t,{signal:e})).arrayBuffer();if(e.aborted)return;let i=new Uint8Array(r);return await q5(i)}catch(r){let i=new Error("downloadLanguagePack failed");throw i.cause=r,i}}s(pTe,"downloadLanguagePack");async function dTe(t){return new Promise(async(e,r)=>{try{let i=t.useDraftData?"exports/mvf2-draft/1/bundle":"exports/mvf2/1/bundle",{url:n,localePacks:a}=await hTe(t,i),o=await ld()(n).then(u=>u.arrayBuffer()),l=new Uint8Array(o);e({compressed:l,localePacks:a})}catch(i){r(i)}})}s(dTe,"downloadVenueBundleMVFAPIGateway");async function fTe(t,e){return new Promise(async(r,i)=>{try{let{url:n}=await mTe(t,e),a=await ld()(n).then(l=>l.arrayBuffer()),o=new Uint8Array(a);r(o)}catch(n){i(n)}})}s(fTe,"downloadMVF");async function mTe(t,e){let r=new URL("".concat(t.baseUri?H5(t.baseUri):ZV,"api/venue/").concat(t.mapId,"/mvf"));t.viewId&&r.searchParams.set("configId",t.viewId),t.mvfVersion&&r.searchParams.set("version",t.mvfVersion);let i=await ld()(r.toString(),{headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText));return i.json()}s(mTe,"getMakerBundleURL");function KV(t){var e,r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P;let C=new TextDecoder,T=C.decode.bind(C);try{let O={"connection.json":JSON.parse(T(t["connection.json"])),"manifest.geojson":JSON.parse(T(t["manifest.geojson"])),"map.geojson":t["map.geojson"]?JSON.parse(T(t["map.geojson"])):void 0,"mapstack.geojson":t["mapstack.geojson"]?JSON.parse(T(t["mapstack.geojson"])):void 0,"node.geojson":JSON.parse(T(t["node.geojson"])),obstruction:{},space:{},entrance:{},facade:{},"tileset.json":t["tileset.json"]?JSON.parse(T(t["tileset.json"])):void 0};if(t.enterprise!=null&&(O.enterprise={},(e=t.enterprise)!=null&&e["locations.json"]&&(O.enterprise.locations=JSON.parse(T((r=t.enterprise)==null?void 0:r["locations.json"]))),(i=t.enterprise)!=null&&i["categories.json"]&&(O.enterprise.categories=JSON.parse(T((n=t.enterprise)==null?void 0:n["categories.json"]))),(a=t.enterprise)!=null&&a["venue.json"]&&(O.enterprise.venue=JSON.parse(T((o=t.enterprise)==null?void 0:o["venue.json"]))),(l=t.enterprise)!=null&&l["layers.json"]&&(O.enterprise.layers=JSON.parse(T((u=t.enterprise)==null?void 0:u["layers.json"]))),(c=t.enterprise)!=null&&c["locationInstances.json"]&&(O.enterprise.locationInstances=JSON.parse(T((p=t.enterprise)==null?void 0:p["locationInstances.json"]))),(m=t.enterprise)!=null&&m["enterpriseStyles.json"]&&(O.enterprise.enterpriseStyles=JSON.parse(T((y=t.enterprise)==null?void 0:y["enterpriseStyles.json"]))),(v=t.enterprise)!=null&&v["textures.json"]&&(O.enterprise.textures=JSON.parse(T((w=t.enterprise)==null?void 0:w["textures.json"]))),(E=t.enterprise)!=null&&E["floorText.json"]&&(O.enterprise.floorText=JSON.parse(T((M=t.enterprise)==null?void 0:M["floorText.json"]))),(I=t.enterprise)!=null&&I["categoryPriorities.json"]&&(O.enterprise.categoryPriorities=JSON.parse(T((P=t.enterprise)==null?void 0:P["categoryPriorities.json"])))),t["floorstack.json"]!=null?O["floorstack.json"]=JSON.parse(T(t["floorstack.json"])):t["mapstack.json"]!=null&&(O["mapstack.json"]=JSON.parse(T(t["mapstack.json"]))),O["floorstack.json"]==null&&O["mapstack.json"]==null&&O["mapstack.geojson"]==null)throw new Error("MVF is missing floorstack.json or mapstack.json/mapstack.geojson");if(t["floor.geojson"]&&(O["floor.geojson"]=JSON.parse(T(t["floor.geojson"]))),O["floor.geojson"]==null&&O["map.geojson"]==null)throw new Error("MVF is missing floor.geojson or map.geojson");if("styles.json"in t&&(O["styles.json"]=JSON.parse(T(t["styles.json"]))),"shapes.json"in t&&(O["shapes.json"]=JSON.parse(T(t["shapes.json"]))),"location.json"in t&&(O["location.json"]=JSON.parse(T(t["location.json"]))),"category.json"in t&&(O["category.json"]=JSON.parse(T(t["category.json"]))),t.annotation!=null){O.annotation={};let k=Object.keys(t.annotation);for(let B of k){let U=B.replace(/\.json|\.geojson/g,"");O.annotation[U]=JSON.parse(T(t.annotation[B]))}}let F=Object.keys(t.space);for(let k of F){let B=k.replace(/\.json|\.geojson/g,"");O.space[B]=JSON.parse(T(t.space[k]))}if(t.obstruction!=null){let k=Object.keys(t.obstruction);for(let B of k){let U=B.replace(/\.json|\.geojson/g,"");O.obstruction[U]=JSON.parse(T(t.obstruction[B]))}}else O.obstruction={};if(t.entrance!=null){let k=Object.keys(t.entrance);for(let B of k){let U=B.replace(/\.json|\.geojson/g,"");O.entrance[U]=JSON.parse(T(t.entrance[B]))}}else O.entrance={};if("floorImages"in t&&t.floorImages!=null){O.floorImages={};for(let k of Object.keys(t.floorImages)){let B=k.replace(/\.json|\.geojson/g,"");O.floorImages[B]=JSON.parse(T(t.floorImages[k]))}}if("textAreas"in t&&t.textAreas!=null){O.textAreas={};for(let k of Object.keys(t.textAreas)){let B=k.replace(/\.json|\.geojson/g,"");O.textAreas[B]=JSON.parse(T(t.textAreas[k]))}}if("facade"in t&&t.facade!=null){O.facade={};for(let k of Object.keys(t.facade)){let B=k.replace(/\.json|\.geojson/g,"");O.facade[B]=JSON.parse(T(t.facade[k]))}}if("area"in t&&t.area!=null){O.area={};for(let k of Object.keys(t.area)){let B=k.replace(/\.json|\.geojson/g,"");O.area[B]=JSON.parse(T(t.area[k]))}}return O}catch(O){throw Vt.error(O),new Error("MVF parsing failed! Probably encountered a bad file.")}}s(KV,"parseMVF");function gTe(t){if(t==null||typeof t!="object")return!1;let e=["connection.json","manifest.geojson","floor.geojson"in t?"floor.geojson":"map.geojson","node.geojson","floorstack.json"in t?"floorstack.json":"mapstack.json"in t?"mapstack.json":"mapstack.geojson"];"styles.json"in t&&e.push("styles.json"),"shapes.json"in t&&e.push("shapes.json");for(let r of e)if(t[r]==null||t[r][Symbol.toStringTag]!=="Uint8Array")return!1;return!0}s(gTe,"validateStaticMVFFiles");async function JV(t){return new Promise(async(e,r)=>{try{if(t==null||typeof t!="object")throw new Error("Error parsing data! Unzipping failed.");if(t[Symbol.toStringTag]!=="Uint8Array")throw new Error("Unexpected file type! Unzipping failed.");let i=(await ag(async()=>{const{unzipSync:o}=await import("./browser-CR4WWHP7-Dr7RN6H_.js");return{unzipSync:o}},[])).unzipSync(t);if(!gTe(i))throw new Error("MVF is missing some expect static files. Unzipping failed.");let n={},a=Object.keys(i);for(let o of a){if(i[o].length===0)continue;let l=o.split("/");if(l.length<0)throw new Error("Encounted a file with no name! Unzipping failed.");if(l.length>2)throw new Error("Encountered unexpected nesting in MVF! Unzipping failed.");if(l.length===1){n[l[0]]=i[o];continue}if(l[0]==="image"){Vt.warn("MVF unzipping encountered an image. Ignoring as this case has not been implemented.");continue}else n[l[0]]==null&&(n[l[0]]={}),n[l[0]][l[1]]=i[o]}e(n)}catch(i){r(i)}})}s(JV,"unzipMVF");function vS(){let t="us",e={};function r(){return vTe(_Te(t),e)}return s(r,"getState"),{updateByUserOption(i){var n,a;i.environment&&(t=i.environment),i.baseUri&&(e.baseUri=i.baseUri),i.baseAuthUri&&(e.baseAuthUri=i.baseAuthUri),(n=i.analytics)!=null&&n.baseUri&&(e.analyticsBaseUri=(a=i.analytics)==null?void 0:a.baseUri)},updateTileServerBaseUrl(i){e.tileServerUri=i},updateEnvironment(i){t=i},getBaseUri(i){return t==="us"&&i?aX.baseUri:r().baseUri},getBaseAuthUri(i=!1){return t==="us"&&i?aX.baseAuthUri:r().baseAuthUri},getAnalyticsBaseUri(){return r().analyticsBaseUri},getTileServerUri(){return r().tileServerUri},reset(){t="us",e={}},__getState:r}}s(vS,"createEnvControl");var yTe=Object.freeze({baseUri:"https://app.mappedin.com/",baseAuthUri:"https://app.mappedin.com/",analyticsBaseUri:"https://api-gateway.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),aX=Object.freeze(vt(Ee({},yTe),{baseUri:"https://api-gateway.mappedin.com/",baseAuthUri:"https://auth.mappedin.com/"})),JKe=Object.freeze({baseUri:"https://api-gateway.eu.mappedin.com/",baseAuthUri:"https://auth.eu.mappedin.com/",analyticsBaseUri:"https://api-gateway.eu.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.eu.mappedin.com/styles/mappedin/style.json"}),QKe=Object.freeze({baseUri:"https://api-gateway-staging.mappedin.net/",baseAuthUri:"https://auth-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),eJe=Object.freeze({baseUri:"https://app-staging.mappedin.net/",baseAuthUri:"https://app-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"});function vTe(t,e){return Ee(Ee({},t),e)}s(vTe,"getAuthStateByEnvironment");var tJe={eu:JKe,us:yTe,"us-staging-enterprise":QKe,"us-staging-self-serve":eJe};function _Te(t){return tJe[t]}s(_Te,"getEnvironmentAuthState");var xTe=s(t=>{var e,r;let i=Object.values((r=(e=t["floorstack.json"])!=null?e:t["mapstack.json"])!=null?r:{});return i.length===1?[]:i.filter(n=>n.type!=="Outdoor").map(n=>n.id.replace("fs_","").replace("ms_",""))},"getBuildingIds"),oX=s(async t=>{let e=performance.now(),r=await eTe(t);return Vt.log("Parsed MVFv3 in ".concat(performance.now()-e,"ms")),r.inspectErr(i=>{throw Vt.error(i),new Error("MVFv3 parsing failed!")}),r.unwrap()},"unzipAndParseMVFv3ToMVFv2");async function QV(t,e="2.0.0"){switch(e){case"2.0.0":try{let r=await JV(t);return KV(r)}catch{return oX(t)}case"3.0.0":return oX(t);default:throw new Error("Unsupported MVF version: ".concat(e))}}s(QV,"unzipAndParseMVFv2");N();function A8(t){var e,r,i,n,a,o;let l=((r=(e=t.enterprise)==null?void 0:e.locations)==null?void 0:r.reduce((p,m)=>(p[m.id]=m,p),{}))||{};for(let p of((i=t.enterprise)==null?void 0:i.locationInstances)||[])l[p.id]=p;let u={};for(let p of t["floorstack.json"]||[])u[p.id]=p;let c={};for(let p of((n=t["floor.geojson"])==null?void 0:n.features)||[])p.properties&&p.properties.id&&(c[p.properties.id]=p.properties);return{type:"downloaded",data:t,optimized:{"enterprise-location":l,"enterprise-category":((o=(a=t.enterprise)==null?void 0:a.categories)==null?void 0:o.reduce((p,m)=>(p[m.id]=m,p),{}))||{},"floor-stack":u,floor:c}}}s(A8,"parseLocalePackToLanguagePack");function bTe(t){return/^https?:\/\/cdn\.mappedin\.com/.test(t)}s(bTe,"isMappedinCdnUrl");function wTe(t){let e=t.split("?")[1];return!!(e!=null&&e.includes("sv="))}s(wTe,"hasSasToken");N();N();N();N();N();N();N();var ATe=class{constructor({origin:e,destination:r,distance:i=0,angle:n=0,pathWeight:a=0,multiplicativeDistanceWeightScaling:o=!0}){if($(this,"origin"),$(this,"destination"),$(this,"distance"),$(this,"angle"),$(this,"weight"),this.origin=e,this.destination=r,this.distance=i,this.angle=n,this.weight=a||0,o?e.properties.floor===r.properties.floor&&(this.weight=(this.weight>=0?this.distance*this.weight:0)+this.distance):e.properties.map===r.properties.map&&(this.weight=this.weight>=0?this.distance+this.weight:0),isNaN(this.angle))throw new Error("Invalid angle: Expected a numeric value, but received NaN.")}};s(ATe,"Edge");var S8=ATe;N();N();N();N();function zy([t,e],[r,i]){let n=e-i,a=t-r;return(Math.atan2(a,n)+Math.PI*3)%(Math.PI*2)}s(zy,"getAngle");N();var rJe=63710088e-1;function Xm(t,e){let[r,i]=t.map(p=>p*Math.PI/180),[n,a]=e.map(p=>p*Math.PI/180),o=a-i,l=n-r,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i)*Math.cos(a)*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return rJe*c}s(Xm,"getDistance");N();N();function KC(t,e,r,i){let[n,a]=t,[o,l]=e,[u,c]=r,[p,m]=i;if(a===l&&n===o||c===m&&u===p)return null;let y=(p-u)*(l-a)-(m-c)*(o-n);if(y===0)return null;let v=((m-c)*(n-u)-(p-u)*(a-c))/y,w=((l-a)*(n-u)-(o-n)*(a-c))/y;if(v<0||v>1||w<0||w>1)return null;let E=a+v*(l-a);return[n+v*(o-n),E]}s(KC,"getLineIntersection");N();function M8(t,e,r,i){let n=Nw(t,r/1e3,i),a=Nw(e,r/1e3,i);return[n.geometry.coordinates,a.geometry.coordinates]}s(M8,"getOffsetLine");N();function E8(t){let e=t*(180/Math.PI);return e=e%360,e>180?e-=360:e<-180&&(e+=360),Object.is(e,-0)?0:e}s(E8,"radToDegNormalized");var sX=111e3;function STe(t,e,r=[],i=0){let n=!0,a=t.geometry.coordinates,o=e.geometry.coordinates,l=E8(zy(a,o)-Math.PI/2),u=E8(zy(a,o)+Math.PI/2),c=i/sX,p=i/(sX*Math.cos(a[1]*Math.PI/180)),m=Math.min(a[1],o[1])-c,y=Math.max(a[1],o[1])+c,v=Math.min(a[0],o[0])-p,w=Math.max(a[0],o[0])+p;for(let E of r)if(!(Math.max(E[0][1],E[1][1])<m||Math.min(E[0][1],E[1][1])>y||Math.max(E[0][0],E[1][0])<v||Math.min(E[0][0],E[1][0])>w)){if(i>0){let M=M8(a,o,i,l),I=M8(a,o,i,u);if(KC(M[0],M[1],E[0],E[1])||KC(I[0],I[1],E[0],E[1])){n=!1;return}}else if(KC(a,o,E[0],E[1])){n=!1;return}}return n}s(STe,"hasLineOfSight");var r1,xp,C8,MTe,ETe,CTe,ITe,TTe,PTe,I8,LTe=class{constructor({nodes:e,groupBy:r,multiplicativeDistanceWeightScaling:i}){Be(this,xp),$(this,"edges",{}),$(this,"nodesById"),$(this,"nodesByGroup",new Map),Be(this,r1),Be(this,I8,s((a,o)=>{let l=0;for(let u of o)(!u[b(this,r1)]||u[b(this,r1)]===a.properties[b(this,r1)])&&yf(a.geometry.coordinates,u.geometry.geometry)&&(l+=Math.max(0,u.cost));return l},"#getZonalCost")),He(this,r1,r);let{features:n}=e;this.nodesById=dr(this,xp,MTe).call(this,n),dr(this,xp,ETe).call(this),dr(this,xp,CTe).call(this,n,r,{multiplicativeDistanceWeightScaling:i})}getShortestEuclideanDistance(e,r){return r.reduce((i,n)=>{let a=Xm(e.geometry.coordinates,n.geometry.coordinates);return Math.min(i,a)},Number.MAX_VALUE)}aStar({originIds:e,destinationNodeIds:r,excludedNodeIds:i,disabledConnectionNodeIds:n,zones:a,overrideEdgeWeights:o}){var l;let u=dr(this,xp,C8).call(this,e),c=dr(this,xp,C8).call(this,r);if(u.length===0||c.length===0)return[];let{frontier:p,cameFrom:m,costSoFar:y}=dr(this,xp,ITe).call(this,u,c);for(;p.length>0;){let v=p.shift();if(!v)break;if(dr(this,xp,TTe).call(this,v.origin,c))return dr(this,xp,PTe).call(this,m,v.origin.properties.id);for(let w of this.edges[v.origin.properties.id]){let E=(l=o==null?void 0:o.get(w))!=null?l:w.weight;if(n!=null&&n.has(w.origin.properties.id)&&w.destination.properties.map!==w.origin.properties.map)continue;let M=y[v.origin.properties.id]+E+b(this,I8).call(this,w.destination,a);if(!(M===1/0||i!=null&&i.has(w.destination.properties.id))&&(y[w.destination.properties.id]==null||M<y[w.destination.properties.id])){let I=M+this.getShortestEuclideanDistance(w.destination,c);y[w.destination.properties.id]=M,m[w.destination.properties.id]=w,p.push({origin:w.destination,priority:I})}}p.sort((w,E)=>w.priority-E.priority)}return[]}};r1=new WeakMap,xp=new WeakSet,C8=s(function(t){return t.map(e=>this.nodesById[e]).filter(Boolean)},"#filterValidNodes"),MTe=s(function(t){return t.reduce((e,r)=>(e[r.properties.id]=r,e),{})},"#createNodesById"),ETe=s(function(){for(let t in this.nodesById)this.nodesById.hasOwnProperty(t)&&(this.nodesById[t].properties.neighbors=this.nodesById[t].properties.neighbors.filter(({id:e})=>!!this.nodesById[e]))},"#removeInvalidNeighbors"),CTe=s(function(t,e,r){t.forEach(i=>{let n=e==="default"?e:i.properties[e];this.nodesByGroup.has(n)||this.nodesByGroup.set(n,[]),this.nodesByGroup.get(n).push(i),this.edges[i.properties.id]=i.properties.neighbors.map(({id:a,weight:o})=>{let l=this.nodesById[a],u=Xm(i.geometry.coordinates,l.geometry.coordinates),c=zy(i.geometry.coordinates,l.geometry.coordinates);return new S8({origin:i,destination:l,pathWeight:o,distance:u,angle:c,multiplicativeDistanceWeightScaling:r==null?void 0:r.multiplicativeDistanceWeightScaling})})})},"#initializeEdgesAndGroups"),ITe=s(function(t,e){let r=[],i={},n={};return t.forEach(a=>{let o=this.getShortestEuclideanDistance(a,e);r.push({origin:a,priority:o}),i[a.properties.id]=null,n[a.properties.id]=0}),r.sort((a,o)=>a.priority-o.priority),{frontier:r,cameFrom:i,costSoFar:n}},"#initializeSearch"),TTe=s(function(t,e){return e.some(r=>r.properties.id===t.properties.id)},"#isDestinationNode"),PTe=s(function(t,e){let r=[],i=t[e];for(;i;)r.push(i),i=t[i.origin.properties.id];return r.reverse()},"#reconstructPath"),I8=new WeakMap,s(LTe,"NavigationGraph");var iJe=LTe,nJe=.4,DTe=class{constructor({nodes:e,geojsonCollection:r,groupBy:i="default",multiplicativeDistanceWeightScaling:n}){$(this,"groupBy"),$(this,"graph"),$(this,"geometryEdgesByMapId",new Map),$(this,"generatePath",s(a=>{let{destination:o}=a[a.length-1],l={type:"FeatureCollection",features:[]};for(let c=0;c<a.length;c++){let{origin:p,destination:m}=a[c],y={id:p.properties.id,angle:a[c].angle,distance:a[c].distance,destination:m.properties.id,edges:this.graph.edges[p.properties.id]};this.groupBy!=="default"&&(y.groupBy=p.properties[this.groupBy]),l.features.push({type:"Feature",geometry:{type:"Point",coordinates:[p.geometry.coordinates[0],p.geometry.coordinates[1]]},properties:y})}let u={id:o.properties.id,edges:this.graph.edges[o.properties.id]};return this.groupBy!=="default"&&(u.groupBy=o.properties[this.groupBy]),l.features.push({type:"Feature",geometry:{type:"Point",coordinates:[o.geometry.coordinates[0],o.geometry.coordinates[1]]},properties:u}),l},"generatePath")),$(this,"getDistance",s((a,o)=>Xm(a,o),"getDistance")),$(this,"getAngle",s((a,o)=>zy(a,o),"getAngle")),this.groupBy=i,this.graph=new iJe({nodes:e,groupBy:this.groupBy,multiplicativeDistanceWeightScaling:n}),((r==null?void 0:r.features)||[]).forEach(a=>{let o=null;if(a.geometry.type==="LineString"?o=a.geometry.coordinates:a.geometry.type==="Polygon"&&(o=a.geometry.coordinates.flat()),o){let l=this.groupBy==="default"?this.groupBy:a.properties[this.groupBy];this.geometryEdgesByMapId.has(l)||this.geometryEdgesByMapId.set(l,[]),o.forEach((u,c)=>{this.geometryEdgesByMapId.get(l).push([u,o[c+1]||o[0]])})}})}getDirections({zones:e,originIds:r,destinationNodeIds:i,excludedNodeIds:n,disabledConnectionNodeIds:a,simplify:o,multiplicativeDistanceWeightScaling:l,overrideEdgeWeights:u}){var c,p;let m=(c=o==null?void 0:o.enabled)!=null?c:!0,y=e??[],v=this.graph.aStar({originIds:r,destinationNodeIds:i,zones:y,excludedNodeIds:new Set(n),disabledConnectionNodeIds:new Set(a),overrideEdgeWeights:u});return v.length===0?{type:"FeatureCollection",features:[]}:(m&&(v=this.simplifyAllSteps(v,(p=o==null?void 0:o.bufferRadius)!=null?p:nJe,l)),this.generatePath(v))}simplifyAllSteps(e,r,i){var n,a;let o=[],l=[e[0]];for(let m=1;m<e.length;m++)if(this.groupBy!=="default"&&e[m].origin.properties[this.groupBy]!==e[m-1].origin.properties[this.groupBy]){let y=e[m-1].origin.properties[this.groupBy],v=(n=this.geometryEdgesByMapId.get(y))!=null?n:[];o.push(...this.simplifySteps(l,v,r,i)),l=[e[m]]}else l.push(e[m]);let u=e[e.length-1],c=this.groupBy==="default"?this.groupBy:u.origin.properties[this.groupBy],p=(a=this.geometryEdgesByMapId.get(c))!=null?a:[];return o.push(...this.simplifySteps(l,p,r,i)),o}simplifySteps(e,r,i,n){if(e.length<3)return e;let a=[e[0]],o=1;for(let l=o+2;l<e.length;l++)if(e[o].origin.properties.preventSmoothing||!STe(e[o].origin,e[l].origin,r,i)){let u=l-1;a.push(new S8(vt(Ee({},e[o]),{destination:e[u].origin,distance:Xm(e[o].origin.geometry.coordinates,e[u].origin.geometry.coordinates),angle:zy(e[o].origin.geometry.coordinates,e[u].origin.geometry.coordinates)}))),o=u}return a.push(new S8(vt(Ee({},e[o]),{destination:e[e.length-1].origin,distance:Xm(e[o].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),angle:zy(e[o].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),multiplicativeDistanceWeightScaling:n})),e[e.length-1]),a}};s(DTe,"Navigator");var aJe=DTe;N();var oJe={};Nl(oJe,{Annotation:()=>t5,Area:()=>ZP,Connection:()=>QP,Coordinate:()=>On,DOORS:()=>zLe,Door:()=>HA,E_SDK_LOG_LEVEL:()=>Dme,EnterpriseCategory:()=>i0e,EnterpriseLocation:()=>Vw,EnterpriseVenue:()=>n0e,Facade:()=>tx,Floor:()=>jp,FloorStack:()=>fye,Hyperlink:()=>nT,ImageMetaData:()=>oT,LocationCategory:()=>_De,LocationProfile:()=>Ij,MAPPEDIN_COLORS:()=>WWe,MapObject:()=>Ky,Node:()=>WP,PointOfInterest:()=>e5,Space:()=>Zp,WALLS:()=>BLe,__setWatermarkOnClickFn:()=>B6e,createMapLibreOverlay:()=>iit,disableText3DWorker:()=>E6e,enableTestMode:()=>zTe,getMapData:()=>Aj,getMapDataEnterprise:()=>rit,hydrateMapData:()=>qrt,hydrateMapDataFromMVF:()=>tit,parseMVF:()=>KV,preloadFont:()=>B5e,setLoggerLevel:()=>kme,setUseEnterpriseAPI:()=>U6e,setWorkersUrl:()=>T6e,show3dMap:()=>Sj,show3dMapGeojson:()=>nit,unzipMVF:()=>JV});N();N();N();N();var JC,QC,eI,RTe=class{constructor(e,r,{enabled:i=!1}={}){Be(this,JC),$(this,"searchInstance"),Be(this,QC),Be(this,eI),$(this,"enabled",!1),He(this,JC,e),He(this,QC,r),He(this,eI,()=>{var n;(n=this.searchInstance)==null||n.then(a=>a.populate())}),i&&this.enable()}async query(e,r={}){if(this.enabled||await this.enable(),!this.searchInstance)return Vt.error("Search should be enabled by now"),{places:[],enterpriseLocations:[],enterpriseCategories:[]};try{return await(await this.searchInstance).search(e,r)}catch(i){return Vt.error("Search.query failed due to",i),{places:[],enterpriseLocations:[],enterpriseCategories:[]}}}async suggest(e,r={}){if(this.enabled||await this.enable(),!this.searchInstance)return Vt.error("Search should be enabled by now"),[];try{return await(await this.searchInstance).suggest(e,r)}catch(i){return Vt.error("Search.suggest failed due to",i),[]}}async enable(){this.enabled||(this.enabled=!0,this.searchInstance||(this.searchInstance=ag(async()=>{const{InternalSearch:e}=await import("./internal-ZUMRQSCJ-DB9Xz3L3.js");return{InternalSearch:e}},[]).then(({InternalSearch:e})=>new e(b(this,JC)))),b(this,QC).on("language-change",b(this,eI)),await this.searchInstance)}};JC=new WeakMap,QC=new WeakMap,eI=new WeakMap,s(RTe,"Search");var sJe=RTe,OTe=new WeakMap,$o,kTe=class extends Wa{constructor(e,{search:r}={}){super(),Be(this,$o),$(this,"Analytics"),$(this,"Search"),$(this,"Query"),$(this,"getDirections",s((i,n,a)=>b(this,$o).getDirections(i,n,a),"getDirections")),$(this,"getDirectionsMultiDestination",s((i,n,a)=>b(this,$o).getDirectionsMultiDestination(i,n,a),"getDirectionsMultiDestination")),He(this,$o,e),OTe.set(this,e),this.Analytics=new vXe(e.Analytics),this.Query=e.Query,this.Search=new sJe(this,e,{enabled:r==null?void 0:r.enabled}),b(this,$o).on("language-change",i=>{this.publish("language-change",i)})}getEnv(){return b(this,$o).getEnv()}getAccessToken(){var e;return(e=b(this,$o).tokenManager)==null?void 0:e.getAccessToken().token}get mapName(){return b(this,$o).mapName}get mapCenter(){return b(this,$o).mapCenter}get organizationId(){return b(this,$o).organizationId}get outdoorViewToken(){return b(this,$o).outdoorViewToken}getByType(e){return b(this,$o).getByType(e)}getById(e,r){return b(this,$o).getById(e,r)}getByExternalId(e,r){return b(this,$o).getByExternalId(e,r)}getGeoJSON(e){return e.geoJSON}async changeLanguage(e){return b(this,$o).changeLanguage(e)}get currentLanguage(){return b(this,$o).currentLanguage}get naturalBearing(){var e;return(e=b(this,$o).naturalBearing)!=null?e:0}getDistance(e,r){return b(this,$o).getDistance(e,r)}toBinaryBundle({downloadLanguagePacks:e=!0}={}){return b(this,$o).toBinaryBundle({downloadLanguagePacks:e})}toJSONBundle({downloadLanguagePacks:e=!0}={}){return b(this,$o).toJSONBundle({downloadLanguagePacks:e})}};$o=new WeakMap,s(kTe,"MapData");var lJe=kTe,ej=lJe;function OT(t){let e=OTe.get(t);if(!e)throw new Error("MapDataInternal not found");return e}s(OT,"getMapDataInternal");N();N();N();N();var uJe=1e-7;function tI(t){return{type:"Point",coordinates:t}}s(tI,"point");function NTe(t,e){let{coordinates:r}=e.geometry,{coordinates:i}=t.geometry,n=r.map(a=>rk(t,tI(a)));return i.reduce((a,o)=>{let l=CW(tI(o),n[0],t),u=CW(tI(o),n[1],t),c=ik(l)<ik(u)?l:u;return c.properties=vt(Ee({},t.properties),{entrances:[]}),a.concat([c])},[])}s(NTe,"splitObstructionByEntrance");function FTe(t,e){return e.reduce((r,i)=>{let n={epsilon:uJe},a=r.obstructions.findIndex(l=>LWe(az(i),l,n)),o=r.obstructions[a];if(o){let[l,u]=NTe(o,i);r.entrances.push(i),r.obstructions.splice(a,1,l,u)}return r},{obstructions:[t],entrances:[]})}s(FTe,"findAndSplitObstructionByAllEntrances");N();N();N();N();(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:s(function(){return this},"get"),configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var cJe="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAkGBwgHBgkICAgKCgkLDhcPDg0NDhwUFREXIh4jIyEeICAlKjUtJScyKCAgLj8vMjc5PDw8JC1CRkE6RjU7PDn/2wBDAQoKCg4MDhsPDxs5JiAmOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTn/wgARCAIABAADAREAAhEBAxEB/8QAGwABAAMBAQEBAAAAAAAAAAAAAAECAwQFBgf/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAP3EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAIAAAJAFAAAAAAAAAAAAAAAAAAAAAAAAABAgAAEgCgAAAAAAAAAAAAAAAAAAAABERLSM1zM4zXMzjMoUIqCCSSS8XNC9mpoaVomharWTQAAAAAAAAAAAAAAAAEREtIoZrnGZkucUKFStQQSTFixdNDStF0TWrmiWqbJoAAAAAAAAAAAAAIgiWkZy4HNLzHLXKcxzpzmFYmRkUKFSCCSSxcuampsbR0HSdK9R1R1HTZvWll0mlAAAAAAAAAAAIiKLnLjHNLynLXKcycxzmNYmJmUKFSCAWLFy5qamxvHQvSdJ0nVHUdFm1aparWKAjNWSKAAAAARBEtYzlyXnjmOSuM4U4q4jjOM5a5k5zAyMjOqFCCCCSSS5c0jU1NzoOk6pew7TtjuO1e0646jezWr2WSaUAAAAAECIqtZco55eY464zhTirhOI5Dks5jAwMTIzqhUqQASWLFzSNTY3Og6V646zsO2O47V7DrjqNzWy9nlZ1c0LlrLEk0EQQVipRczIyMU5q5F4U8+vOPOrgThOOuU5jAxMjMzKpUggigJiSSxY0XQ1Njc6TqjtO49CX0D0T0Y7l7E6JdzU1NEvViSalBAWIqVKLSMjIxOauM4U86vPPOrz04TjrkOYwMTIzKJQqQQCKmBJJYutzQ1Njc6TrOyO475fRPRPQjuXsToXWPn6kkkEkhCkEAgggqVMjlrzzzDy7PMPPrhOQ5jBMqoVIIIAAIAJAAJJJLFzWN16TsO49CPTPUl9Q9A6o1LFiSSSSQpCwQQCCCpVMjlrzzyzy7PMPPrhOM5kwM6zKlQQAAQASAASCxY0NI3XpOw7j0I9M9SX0z0DqjU+UqpQqVIBFgEyixJYuWLFDkrzE8o8yvOONOasipBAAAAAAAAAAABJJY2OiO1fQPUj1T0pewuVKlCCqQsBIUSSSSWLlyTM5K808pPLrzziTnrEqQQAAAAAAAAAAASSWNjojtX0D1I9VfSOuND4uzMzqhQqVIALEli5c1jUuQc1vnp5pwJzVmQQAAAAAAAAAAAAAASSaHTHevpHoHTFjMyM6zKlSpABJJcsaGkamhU5q88804E5qzIIAAAAAAAAAAAAAAJJNDpjvX0j0Dqix8dVDMolSpAqCYElixc0XU0IMjlTlrIqAAAAAAAAAAAAAAAAAWNTqjqXYGZkZpUoQQRSFIsSXLroaGhBkcqctZFQAAAAAAAAAAAAAAAACxqdUdS7EngWQCAAQASACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYFSCCAACCQACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYGIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAJABAAAAAAAAAJBILEli5Y0LlzQ0Lly5csWLAkgFSChUoUMyhmUMyhQqVKkEEAEAAAAAAAAAkEgsSWLljQuXNDQuXLlyxYsCSAVIKFShQzKGZQzKFCpUqQe+ZmZkUKFCpUEEAAkksWLFzQ0NTU2NzY3Og3NzoNzc2NjU1NS5csSAQVKmZmZGRiYmBgYHOYGBgYGBiZGRkUMypUqQCAASSWLFi5oaGpqbG5sbnQbm50G5ubGxqampcuWJAIIKGZmZGRiYmBgYHOYGBgYGR+jmBzmBzmJiZGZQoQQSSWLmhqbGxudB0nSdJ1HSdR1HSdJ0G5qamhcsWJJJBIIIBUqVKFDIyMDA5jmOU5TlOY5TmOc5znMTEyMyhQggFixc0NTY2NzoOk6TpOo6TqOo6TpOg3NTU0LlixJJIJBAIKkFChQyMjAwOY5jlOU5jnP00yMTnOc5zAwMjMoVIJJLmhqbmx0HQdBubmxqXLkkgAAAAAAAAAAAAAEEFTMzMTEwOc5znMDAyMyhUgkkuaGpsbnQdB0G5ubGpcuSSAAAAAAAAAAAAAAQQVKGZ1gAEEEEFSCACSSxJJJIAAAAAAAAAAAAAAAAAAAAAAABBBBBUggAkkksSSSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSSSSAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSWBIAAKFiQAAAAAAAAACCpUoUMzIyMzMzMyhQoVKkEEAgkEkklixYuXNDQ0NTQ1NC5cuWJAAAAAAAAAAIKlShQzMjIzMzMzKFChUqQQQCCQSSSWLFyxoXNDQ1NDU0LljUkkAAAAAAAAAAggggEEAgAAAAAAAAAAAAAEkgkkkkkAAAAAAAAAAgggggEAgAAAAAEgEAAAAAAEkgkkuAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADyyCCCCCCCCAQASCSQWJJJJLEkkkkkgkkEgkAEgAAEAAgEAggEEEEEEEFSCCCCCCAQASCSQWJJJJLEkkkkkgkkEgEgEgAAEAAgEAggEEEEEH5AQQQQVBBAIAAJBIJJJLEkkkkliSSSSSQSSCQSAAAQAQQCCCCCCCCCpBBBBBUEEEAgAAkEgkkksSSSSSWJJJJJJBJIJBIAABABBAIIIIIIIIKg/LCAQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQAQQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQfPgAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAApEAAABQUBAQACAwACAwAAAAABAgQFFQMGERQWEhNAUAAgMGCAkKCw/9oACAEBAAECAP8AwTZznOf3mc5/YZE41xVivFyM6i7C8C8C8zMzMzMyDyDyDyDwV4K7ldSuZV5VgVwqZ/SCca4qxXmcjOouwvAvEzMzMzMzMyDyDyDwV4K7ldSuRVwKgrgf88TDWMrO4VHOo61Hao7ndzvB3k7yZ5M8i8i8zMzMzMyDyDyDyV5K8keSPJHmm8U3em70nam603Mi8qotUDfk5GqZUdfUc6jrUdqjvUeDvB3kzyZ5M8i8i8zMzMzMzMg8g8leSvJHkjyR5pvFN4pu9N2pOtNzIvKqLWA39PX+/saplJlh1tRfVcKrlVdKrrVdqrvVdzu53Y7sZ2M6mdRdRdBdJSUk5SUB0B0B1K6kdSOxHam7Unek70nei7UXWi6UXKk40l9NaRWWuB8/75E41zKjraq+q41nOq6VXas7VXeq71Hc7ud2O7GdRdRdZQXSUlJSUlAdCugOpXUjqR2I7U3em70nek70nai60XSk5UnGkvItIrKoCsC0FwLgXAuBbube3ubm7uiuFcZcZaZYdZUWVl1dwruVdzrulZ0qulVzqOR3EzgZeZcZcK0Vm3t7W1tbW1tgrBYC0q0q4q8jgRxpuVJzoulB0oOlBzoOVBworqa0iwi0i0q4FwLQWAr2trZ2trb3RWiuFcZaZadbUW1l1ZwruVd0rulZ0qulVzqOR3E7gZeZeK4VorNzb29ra2tsFe2CwFpVxVxV5HAjjTcqTnRdKDpQdKDnQcqDhRXU1pFhVm/ISUnKSkrLSsrKyspJyUhvitOtrLq69Q4qHGu41nGqvqLjrDKhUDW+nv1nP+Oc+vYVArFUEVEWUl1FfQcU7imckzinX0VxFoLgXyMlJykrLS0tLS0rKSclI74rjraq6uvUuKhxruNdxqr6i46wysVA1vp79Zz/AI5z6A4VArFUEVkWUl1FfQcU7imcUzinX0VxFoLZKTlJWVlpaXl5eWlpWUB0BzBxkDr669SvUr666stqqz1xqes/j5AxahFFJXRWp1yZemX0F5HCQkpOUlZaWlpeXl5aWB2lQdAcwcZE7hWcFLgpXqF1ZbVVnUDU9Z/HyBi1CV6SuitTrky9MvoLyL5AXEXEXIXIXKSkpKSkpIHIHIHIrkVxK4yJnCsvrra6uqpPVE354GJVpKaCtOtoryuEiZxM5C5C5C5SUnJSclJSQOQORXIrkVxBxM4VV9dbXV1VJ6om/PAxKtFTQVp1tFeRwkRWitFYKvb2tra2draBUCsFgLCrSrQWitOsqqT1RN+jAxKtJTTWFWitMtMtFYKzb29ra2tnaBUCsFZVhVpVoLRWnWVFJ6om/RgYlWkpprAW73v36zn++c+gOFQKv1GoJv04GCp9Rq/T36zn++c+gOFT7fUagm/TgYKn1+3/AKEeMefHjx8/n8vl8vn8/Hjx5xj9bjHnx48fP5/L5fL5/Px48ecY/wAvOPxceQIFIKIJgSAiBAVuK2FaitINAM4MwMwMsJCQkJCQkJCwosws4tAtItQtgtot4oRSCm+Hy8ecfi48gQKQUQTAkBECArcVsK1FaQaAZwZgZgZYSEhISEhISFhRZhZxaBaRahbBbRbxQikFN8BpfMWgWozWLaLcKAUWpq62vr/DX19YEoJARAhBvK2laytRGgjORlIyEYiMJLfJbxLdJbhLbJbRLaJbJbZLbAWxzHMcxzHMcxzHMDbBrYNbJraNbRrbPbh7dPbx7fOwHYjsZ2UzMZoM0maxbRbhQCi1NXW19fX19fW1QSAiBCDeVtK1laiNBGYjKRkIxEYSW+S3iW6S3CW2S2iW0S2S2yW2AtgLY5jmOY5jmOY5gbYNbJrZNbRraPbZ7cPbp7ePb52A7EdjOymZjW4e3D26e3j2+ZgMwmYhYxY4SEhISEBjKxlYiMJGAjAS3iW9TtynblO26dtUrap2zTtmnbNO2SW2S3isRWYGkG0EAItTW1/h8Phr6+rp6AtwtQs5mI9vntw9tHtk9s1LZqWzUto9tnts9uHt09vHt8zAZhMxCxixwkJCQkIDGVjKxEYSMBGAlvEt6nblO3Kdt0rap21TtmnbNO2SWyS2yW8ViKzA1A2ggBFqa2v8Ph8NfW1dPRFuFqMzGYjW+e3D20e2T2zUtk9tHto1tCzHYj2+e3T24e3D24a3DW4Nuc5znOc4FuBbhbcLbhLcJblO3CW4S3iMRGcrYVECcKYB+cJBoCjM2maDsZ7fPbp7cPbh7cNbhrcG3Oc5znOcC3C24W3C24S3CW5TtwluEt4jERnK2FRAnCmAfnCQaAoxb/7ePl8NbU09PT1NYKHy8Y/ZePl8NbU09PT1NYKHy8Y/4Z6+g1tjb3d+Rk5SVlZWVlZSTkd8Fu3s/b6es/pvX0Gtsbe7vyMnKSkrKysrKSciC8Fu3s/YKnrP9gqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqoqsqsqoFIVwqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqkqsqsqsFIV/Hn8XHj5/H4a+traurq6mpqampqampqampqampqampqampqamrq62tr/D4/Lx5/Fx4+fx+Gvra2rq6upqampqampqamrq6upqampqampqamrq6utra/w+Py/wCgEzNTc5OTs7PT09PT8/Pz09PT07Ozk3Ng9TMxLy0rKSclJSMhIb+9vbu9u7u7u7u7u729vb2/vyEjJSUnKSstLzEzNTc5OTs7Oz09PT8/Pz09PT07Ozk5NzUzMS8tKyknJSUjISG/v727vbu7u7u7u7u9u729v78hIyUlJykrLS8x0nR9H0fR9H0XRdF0XRdD0PQ9F0XRdF0XRdF0fR9H0nSdJ0vS9L0vTdN03TdP0/T9P0/T9P0/T9P0/T9R0/T9P0/T9P0/TdN03S9L0vS9J0nSdJ0fR9H0XRdF0PRdD0PQ9D0PRdF0XRdF0XR9H0fSdJ0nS9L0vS9N03TdN0/T9P0/T9P0/T9P0/T9P1HT9P0/T9P0/T9N03TdL0vS9L0vSS8tLy0tLS0rKysrKysrKysrKystLS0vLS8vLy8vMTExMTExMzMzMTMzMzM1NTUzMzMzMzMzMzExMTExMS8vLy8vLy8tKy0tKysrKysrKysrKysrLS0tLy0vLy8vLzExMTExMTMzMzEzMzMzNTU1MzMzMzMzMzMxMTExMTEvLy8vnOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5znOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5z/9YD//xAArEAEAAgIDAQABBAICAQUAAAAAAVICYgNRYQRBEEBQUzFCIDARYICQoLD/2gAIAQEAAz8A/wDgmhCEI/nYQj+RhjH5ccflxw44YMe0dtmzZs2bNmzZs2bIsjtiwlxy45/Ljn8se0fwuPbjj8uOPy44YQxR2izZs2bNmzZs2bNkWR2xYS45cc/lhP5Y9/wEQwj8sIRD1s2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNmyLMZYZMZ/KJ/dRDCPywhjCI/LZs2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNkWYywlhP5RP/ABj9hDGGMIh69bNmzZs2bNmzZsmybJsmybJsmybJsmybJsmybJs2bNmzZs2bNmzZ7+mMsZYyj9hDGGMIj9NmzZs2bNmzZs2bJsmybJsmybJs2TZNk2TZNk2bJs2bNmzZs2bNmzZ6iWMsXr16hiwYMGDBgwYo/T169/T162bNmzZs2TZNk2T2ntPae09pSlKUpSlPae09p7T2mybJsmzZs2bNmz17+nr16hiwYOPtx9uPtx9sO2DBih69evXr1s2bNmzZsmybJsmye09p7T2lKUpSlKU9p7T2ntNk2TZNmzZs2bNmz17+vr1s2bNmzZs2bNmzZs2evXr169bNmye09p7SlKUp/wC6UpSlKe09p7etmzZs9evWzZs2bNmzZs2bNmzZs2bPXr1s9bNmye09p7SlKUp/7pSlKUp7T29bPWz169evWzZs2bNmzZs2bNmzZs2bNmzZs2evU9plM/vJhMJ7T29bNnrZ62bNmzZs2bNmzZs2bNmzZs2bNnr39J7TKZ/eTCYT3+nr162bNnrZs2bJsntNk2TZPabNmzZs2etnr39JlM/wUwmP09etmzZs2bNk2TZNk2TZNk2bNmzZs2bNnv6TKZ/gphMfp69etk9p7T2ntKUpSlKUp7T2nt69e/pMpn+GmH/j9PXr1Pae09pSySlklKU9p7T29evf0mUz/DTCY/T16lP/AHSlKU/xUpSlP/dKUpT/ABUpT/8AQllKWTJl0y6ZdMumXTLpl0y6ZJSn+QlKWTJl0y6ZdMumXTLpl0y6ZJSn/sn9xKWXTLpn0z6Z9M+mXTLplVlVlVlVlVlVlVlVlVlVlRlVlVlRlVlVlVlVlVlVlVl0z6Z9M4/DPpn0z6ZdMkp/byll0y6Z9M+mfTPpn0y6ZVZVZVZVZVZVZVZVZUZVZUZVZVZVZVZVZVZVZVZVZVZdM+mfTOPwz6Z9M+mTJlVlVlVl0yZ9M2fTPpn0z6Z9M+mbPpn0z6Z9M2fTPpl0yqyqyqyqyqyomiaJomiaJomiaJomjRo0aNGjRo0aNGjRNE0TRNE0TRNE0TRNE0ZVZVZVZVZVZVZM+mbPpn0z6Z9M+mfTNn0z6Z9M+mfTPpl0y6ZVZVZVTVlVlRNE0TRlRNE0TRNE0TRo0aNGjRo0aNGjRomiaJomiaJomiaJomqaJqyq0TRNE0TRNE0TVNE1TVNU1TRNE1TVNU0TRNE0TRNGjRo0aNGjRhWHFHTgh88Pmj8Pnj/V89HBRwf1w4f64cNMXFSHFTFxUxcVIcP9cOGkOCkPno+ej55/D55cEuKemHUIo0aNGjRo0TRNE0TRNE0TVNE0TVNE1TVNE1TRNU0TRNE0TRNGjRo0aNGjRhWHFHThh88Pnj8Pnq+ejgo4P64cP9cOKkOKkOKmLipi4aYuH+uHBSHBSHz0fPR88/h88uCXFNWHUIo0aNGjRo4ZcU9MOoRRFGjRo0aNGjRo0aNGjRo0RRhVxR04IcGP4cGP+jij/GEMI/xjCP3+M/5xhxT/AJwhwT/o4Mv9XBk4p6YdQiiKNGjRo0aNGjRo0aNGjRoijGsOKOnBi4Mfw4I/0cUf4whhH+MYR+/xn/OMOKf84Q4J/wBHBP8Ar/zxrDCsOKkOKjhq4auGrhq4auGjipDjpDGsI/k8awwrDipDio4aOGrhq4auGrho4qQ46QxrCP8A0bHcMLQ47w4rw4buCzgs4O3A4HA4XA4HA4HA4O3BZwWcN3Fdx3hhaGNoR/Dx3DC0OO8OK8OG7gs4LODtwOBwOFwOBwOBwODtwWcFnDdxXcd4YWhjaEf88UftoQh4y6ZuRyuVzOZzeudz+uf1z+uf1z+uf1z+uf1zuf1z+uf1z+uf1z+udzR25nM5o7c3rlcrlZsniOkSj9tCEPGXTNyuVy+uZzOb1z+uf1z+uf1z+uf1z+uf1z+udz+uf1z+uf1z+uf1z+ueO3O5nM5vXK5XKzZPEdMUftoYsemHTDpx9OPpxVcVXDVw1cNXDVw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDVw1cNXFVxVcVXFVx9OPph0w6Yo/bQxY9MOnH04+nH04quKrhq4auGrhq4aOGjho4aOGjho4aOGkOGkOGkOGjho4aOGjho4aOGjhq4auGriq4quKriq4+nH0w6Ydf+wHgcLhcLicTjYdww7hh3DDuGPcMe4Y9ww7hh3DDuGHcONxuJxOFwuBwOB8753z2fPZ89nz3fNd893zXfPd893z3fP/Y+e757uC75/wCyHz/2Q+f+yHBd893z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDgcLhcLicTjYdww7hh3DDuGHcMe4Ydww7hh3DDuGHcONxuJxOFwuBwPnfO+d89nz2fPZ893zXfPd813z3fPd893z/2Pnu+e7gu+f8Ash8/9kPn/shwXcF3z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDdu3bt03bt26bpum6bpum6bt27du3bt26bt26bpum6bpum6bpum6bt03TdN26bpum6bpum7dN03TdN03TdN03TdN03Tdum7dum7dN27dum6bpum6bpum6bpum7du3bt03bpu3bpum6bpum6bpum6bpu3TdN03bpum6bpum6bt03TdN03TdN03TdN03TdN03TduysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysmzKzKzKybMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrJT+2lKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpSn9tKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpT/wDrA//EAB0RAAMBAAMBAQEAAAAAAAAAAAABERIwQFAgkMD/2gAIAQIBAT8A/COlKioqKioqKi+zSoqKioqL59Ro0aKyvpVlZWaNFXiVGkaNFZWV9CsrNGjRpFXepo0V8c69Zo0u1pGilfVnJWaNF+NFXNUaNFfmU0aReamkaNPzNM19VlZWaKysrK/XrKzTNGjRWaKyv+u0/8QAHREBAQACAQUAAAAAAAAAAAAAEQBAUCAQITCQwP/aAAgBAwEBPwD1NkRER07eYiIiNMRERGARERGgIiNAREZRERoCIjiYBERqiIwiI1REcCIiIiIjbkREREREfXZ//9k=";N();N();var BTe=!1;function zTe(){BTe=!0}s(zTe,"enableTestMode");function UTe(){return BTe}s(UTe,"isTestMode");var VTe=class{constructor(e){$(this,"backgroundAlpha",1),$(this,"backgroundColor",new si),$(this,"width",0),$(this,"height",0),$(this,"options",{}),$(this,"renderer"),$(this,"enabledLayers",new Set([0,1])),$(this,"handleWebGLContextCreationError",s(l=>{var u,c;(c=(u=this.options).onWebGLContextCreationError)==null||c.call(u,l)},"handleWebGLContextCreationError")),$(this,"handleWebGLContextLost",s(l=>{var u,c;(c=(u=this.options).onWebGLContextLost)==null||c.call(u,l)},"handleWebGLContextLost")),$(this,"handleWebGLContextRestored",s(l=>{var u,c;(c=(u=this.options).onWebGLContextRestored)==null||c.call(u,l)},"handleWebGLContextRestored"));var r,i,n,a,o;try{this.options=e,UTe()?(this.renderer={setSize:s(()=>{},"setSize"),state:{reset:s(()=>{},"reset")},properties:{get:s(()=>{},"get")},getSize:s(()=>({width:window.innerWidth,height:innerHeight}),"getSize"),getDrawingBufferSize:s(()=>({width:window.innerWidth,height:innerHeight}),"getDrawingBufferSize"),getClearAlpha:s(()=>1,"getClearAlpha"),getClearColor:s(()=>new si,"getClearColor"),autoUpdate:!0,shadowMap:{autoUpdate:!0},getContext:s(()=>({getContextAttributes(){return{alpha:!0,antialias:!1,depth:!0,stencil:!1}}}),"getContext"),readRenderTargetPixelsAsync:s(()=>Promise.resolve([]),"readRenderTargetPixelsAsync"),setRenderTarget:s(()=>{},"setRenderTarget"),setClearColor:s(()=>{},"setClearColor"),clear:s(()=>{},"clear"),render:s(()=>{},"render"),clearStencil:s(()=>{},"clearStencil"),clearDepth:s(()=>{},"clearDepth"),domElement:document.createElement("canvas"),capabilities:{isWebGL2:!0}},this.renderer.domElement.style.width="1920px",Object.defineProperty(this.renderer.domElement,"clientWidth",{value:1920}),this.renderer.domElement.style.height="1080px",Object.defineProperty(this.renderer.domElement,"clientHeight",{value:1080})):this.renderer=new wHe({canvas:e.canvas,alpha:e.alpha||!1,stencil:!0,antialias:typeof e.antialias=="boolean"?e.antialias:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0}),this.backgroundColor=new si((r=e.backgroundColor)!=null?r:"#ffffff"),this.backgroundAlpha=(i=e.backgroundAlpha)!=null?i:1}catch(l){Vt.error(l),e.onWebGLRendererError&&e.onWebGLRendererError(l)}(n=this.domElement())==null||n.addEventListener("webglcontextlost",this.handleWebGLContextLost),(a=this.domElement())==null||a.addEventListener("webglcontextrestored",this.handleWebGLContextRestored),(o=this.domElement())==null||o.addEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}destroy(){var e,r,i,n,a;this.renderer&&((r=(e=this.renderer).dispose)==null||r.call(e)),(i=this.domElement())==null||i.removeEventListener("webglcontextlost",this.handleWebGLContextLost),(n=this.domElement())==null||n.removeEventListener("webglcontextrestored",this.handleWebGLContextRestored),(a=this.domElement())==null||a.removeEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}render(e,r){if(this.renderer){this.renderer.state.reset(),r.layers.disableAll();for(let i of this.enabledLayers.values())r.layers.enable(i);this.renderer.clearStencil(),this.renderer.autoClear=!1,this.renderer.setRenderTarget(null),this.renderer.render(e,r),this.renderer.clearDepth(),r.layers.disableAll(),r.layers.enable(mge.ALWAYS_ON_TOP),this.renderer.render(e,r),this.renderer.state.reset()}}clear(){this.renderer&&(this.renderer.setClearColor(this.backgroundColor,this.backgroundAlpha),this.renderer.clear())}setBufferSize(e,r){$a.env.NODE_ENV==="test"||!this.renderer||(this.width=e,this.height=r,this.renderer.setSize(e,r,!1))}setBackgroundColor(e,r){this.backgroundColor=e,this.backgroundAlpha=r}domElement(){var e;return(e=this.renderer)==null?void 0:e.domElement}};s(VTe,"Renderer");var hJe=VTe;N();N();var pJe=`"use strict";(()=>{var G=Object.defineProperty;var J=(n,e,t)=>e in n?G(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>J(n,typeof e!="symbol"?e+"":e,t);function M(n,e){return e.x+e.w<n.x+n.w&&e.x>n.x&&e.y>n.y&&e.y+e.h<n.y+n.h}function j(n,e){let[t,i]=e;return t>=n.x&&t<=n.x+n.w&&i>=n.y&&i<=n.y+n.h}function q(n,e){let t=e.x,i=e.y,o=e.x+e.w,h=e.y+e.h,k=n.x,p=n.y,f=n.x+n.w,g=n.y+n.h;return t<f&&k<o&&i<g&&p<h}function c(n,e){for(let t=0;t<e.length;t++)n.push(e[t])}var s=class{constructor(e,t,i,o,h){l(this,"x");l(this,"y");l(this,"w");l(this,"h");l(this,"userData");this.userData=typeof h>"u"?null:h,this.x=e,this.y=t,this.w=i,this.h=o}contains(e){return e===this?!1:M(this,e)}intersects(e){return q(this,e)}intersectsPoint(e){return j(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.8)",e.fillRect(this.x,this.y,this.w,this.h)}};var w=class n{constructor(e,t){l(this,"topLeft");l(this,"topRight");l(this,"bottomLeft");l(this,"bottomRight");l(this,"divided",!1);l(this,"boundary");l(this,"capacity",16);l(this,"objects",[]);l(this,"parent");this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:i,h:o}=this.boundary;this.topLeft=new n(new s(e,t,i/2,o/2),this),this.topRight=new n(new s(e+i/2,t,i/2,o/2),this),this.bottomLeft=new n(new s(e,t+o/2,i/2,o/2),this),this.bottomRight=new n(new s(e+i/2,t+o/2,i/2,o/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(c(t,this.topLeft.queryRect(e)),c(t,this.topRight.queryRect(e)),c(t,this.bottomLeft.queryRect(e)),c(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(c(t,this.topLeft.queryPoint(e)),c(t,this.topRight.queryPoint(e)),c(t,this.bottomLeft.queryPoint(e)),c(t,this.bottomRight.queryPoint(e))),t}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};var d=200,S=10;function z(n,e,t,i,o,h,k="-1"){let p=1/0,f=1/0,g=-1/0,P=-1/0,O=new s(-S,0,5,t),K=new s(-S,0,e,5),W=new s(e-5,0,e+S,t),V=new s(0,t-5,e,t+S),Q=Z(e,t,i,o,h),Y=[O,K,W,V],E=new s(-d,-d,e+d*2,t+d*2);for(let r of n){let R,T;for(let u=0;u<r.bboxes.length;u++){if(r.bboxes[u]==null||(R=r.bboxes[u].boundingBox,T=r.bboxes[u].index,r.lockedToStrategyIndex!==-1&&T!==r.lockedToStrategyIndex))continue;let[I,a,b,N]=R,[m,F,D,U]=[r.y-I,r.y+a,r.x-b,r.x+N],B=D,L=m,A=U-D,_=F-m;p=Math.min(p,B)-d,f=Math.min(f,L)-d,g=Math.max(g,B+A)+d,P=Math.max(P,L+_)+d,r.bboxes[u].boundingRect=new s(B,L,A,_)}}let y={msgId:k,colliders:new Array(n.length),debug:[]},C=new w(new s(p,f,g-p,P-f)),x;for(let r=0;r<n.length;r++)if(x=n[r],y.colliders[r]=[-1,0],x.enabledAndVisible){let[R,T,u]=[1/0,-1,void 0];for(let{index:I,boundingRect:a}of x.bboxes){if(a==null)continue;let b=[];if(b=C.queryRect(a).filter(m=>a.intersects(m)),x.shouldCollideWithScreenEdges&&Y.forEach(m=>{a.intersects(m)&&b.push(m)}),a.intersects(Q)){y.colliders[r]=[-1,0,a];break}if(b.length<=R&&(u=a,T=I,R=b.length),b.length===0){C.insert(a),y.colliders[r]=[I,E.contains(a)?0:1,a];break}}x.rank===5&&u!=null&&(C.insert(u),y.colliders[r]=[T,E.contains(u)?0:1,u])}else y.colliders[r]=[-1,0];return y}function Z(n,e,t,i,o){switch(o){case"top-right":return new s(n-t,0,t,i);case"bottom-left":return new s(0,e-i,t,i);case"bottom-right":return new s(n-t,e-i,t,i);case"top-left":return new s(0,0,t,i)}}function X(n){let e=n[0].map(t=>{let i=t[0].map(o=>({index:o[4],boundingBox:[o[0],o[1],o[2],o[3]]}));return{enabledAndVisible:t[1]===1,rank:t[2]===1?5:0,x:t[3],y:t[4],shouldCollideWithScreenEdges:t[5]===1,bboxes:i,lockedToStrategyIndex:t[6]}});return{msgId:"-1",totalWidth:n[3],totalHeight:n[2],watermarkWidth:n[4],watermarkHeight:n[5],watermarkPosition:n[6],colliders:e,devicePixelRatio:n[1]}}self.onmessage=n=>{let e=X(n.data);self.postMessage(z(e.colliders,e.totalWidth,e.totalHeight,e.watermarkWidth,e.watermarkHeight,e.watermarkPosition,e.msgId))};})();
`;N();N();N();N();N();function jTe(t,e){return e.x+e.w<t.x+t.w&&e.x>t.x&&e.y>t.y&&e.y+e.h<t.y+t.h}s(jTe,"contains");N();function $Te(t,e){let[r,i]=e;return r>=t.x&&r<=t.x+t.w&&i>=t.y&&i<=t.y+t.h}s($Te,"intersectPoint");N();function GTe(t,e){let r=e.x,i=e.y,n=e.x+e.w,a=e.y+e.h,o=t.x,l=t.y,u=t.x+t.w,c=t.y+t.h;return r<u&&o<n&&i<c&&l<a}s(GTe,"intersects");N();function Bd(t,e){for(let r=0;r<e.length;r++)t.push(e[r])}s(Bd,"appendItems");N();var HTe=class{constructor(e,r,i,n,a){$(this,"x"),$(this,"y"),$(this,"w"),$(this,"h"),$(this,"userData"),this.userData=typeof a>"u"?null:a,this.x=e,this.y=r,this.w=i,this.h=n}contains(e){return e===this?!1:jTe(this,e)}intersects(e){return GTe(this,e)}intersectsPoint(e){return $Te(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.8)",e.fillRect(this.x,this.y,this.w,this.h)}};s(HTe,"Rectangle");var Jc=HTe,qTe=class T2{constructor(e,r){$(this,"topLeft"),$(this,"topRight"),$(this,"bottomLeft"),$(this,"bottomRight"),$(this,"divided",!1),$(this,"boundary"),$(this,"capacity",16),$(this,"objects",[]),$(this,"parent"),this.parent=r,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:r,w:i,h:n}=this.boundary;this.topLeft=new T2(new Jc(e,r,i/2,n/2),this),this.topRight=new T2(new Jc(e+i/2,r,i/2,n/2),this),this.bottomLeft=new T2(new Jc(e,r+n/2,i/2,n/2),this),this.bottomRight=new T2(new Jc(e+i/2,r+n/2,i/2,n/2),this),this.divided=!0}queryRect(e){let r=[];if(this.boundary.intersects(e))r.push(...this.objects);else return[];return this.divided&&(Bd(r,this.topLeft.queryRect(e)),Bd(r,this.topRight.queryRect(e)),Bd(r,this.bottomLeft.queryRect(e)),Bd(r,this.bottomRight.queryRect(e))),r}queryPoint(e){let r=[];if(this.boundary.intersectsPoint(e))r.push(...this.objects);else return[];return this.divided&&(Bd(r,this.topLeft.queryPoint(e)),Bd(r,this.topRight.queryPoint(e)),Bd(r,this.bottomLeft.queryPoint(e)),Bd(r,this.bottomRight.queryPoint(e))),r}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(r=>r.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};s(qTe,"QuadTree");var P2=qTe;N();N();var WTe=["","","low","medium","high","always-visible"];function tj(t){return Math.min(5,Math.max(2,t))}s(tj,"clampTierNumber");function W5(t){if(typeof t=="number")return tj(t);let e=WTe.indexOf(t);return e===-1?3:e}s(W5,"convertCollisionRankingTierToNumber");function L2(t){let e=tj(t);return WTe[e]}s(L2,"convertNumberToCollisionRankingTier");function XTe(t,e,r){let i,n,a,o=null,l=0;r||(r={});let u=s(function(){l=r.leading===!1?0:Date.now(),o=null,a=t.apply(i,n),o||(i=n=null)},"later");return function(){let c=Date.now();!l&&r.leading===!1&&(l=c);let p=e-(c-l);return i=globalThis,n=arguments,p<=0||p>e?(o&&(clearTimeout(o),o=null),l=c,a=t.apply(i,n),o||(i=n=null)):!o&&r.trailing!==!1&&(o=setTimeout(u,p)),a}}s(XTe,"throttle");var Ug=!1,T8="",dJe=150,ZTe=class extends Wa{constructor(e,r,i=T8?new Worker(T8):new Worker(URL.createObjectURL(new Blob([pJe],{type:"text/javascript"})))){super(),$(this,"worker"),$(this,"debugContext"),$(this,"debugCanvas"),$(this,"collidersDirty",!0),$(this,"packedMessage",[[],0,0,0,0,0,"bottom-left"]),$(this,"visibleCollidersQTree",new P2(new Jc(0,0,0,0))),$(this,"interactiveCollidersQTree",new P2(new Jc(0,0,0,0))),$(this,"coreState"),$(this,"postMessage"),$(this,"showCollisionBoxes",s(()=>{Ug=!0,this.debugCanvas.style.display="block"},"showCollisionBoxes")),$(this,"hideCollisionBoxes",s(()=>{Ug=!1,this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugCanvas.style.display="none"},"hideCollisionBoxes")),$(this,"currentMsgId",""),$(this,"working",!1),$(this,"_postMessage",s(()=>{this.worker.postMessage(this.packedMessage)},"_postMessage")),$(this,"componentArray",[]),$(this,"update",s((n,a,o="bottom-left",l=!1)=>{let u=!1;if(this.collidersDirty){this.packedMessage=[[],0,0,0,0,0,"bottom-left"],this.componentArray=[];let c;for(let p of this.coreState.geometry2DIdsInScene){let m=this.coreState.geometry2DMap.get(p);m&&(c=m.components[0],this.componentArray.push(c))}this.resize(n,a,o),this.collidersDirty=!1,u=!0}else u=this.componentArray.some(c=>c.collisionDirty===!0);u&&this.componentArray.sort((c,p)=>p.rank-c.rank);for(let c=0;c<this.componentArray.length;c++)if(this.packedMessage){let p=this.componentArray[c].toPackedMessage(l&&!u);this.packedMessage[0][c]==null&&(this.packedMessage[0][c]=[]),this.packedMessage[0][c][0]==null&&(this.packedMessage[0][c][0]=[]),this.packedMessage[0][c][0]=p.bboxes,this.packedMessage[0][c][1]=p.enabled&&this.componentArray[c].visible&&!this.componentArray[c].isOccluded?1:0,this.packedMessage[0][c][2]=p.rank===5?1:0,this.packedMessage[0][c][3]=p.x,this.packedMessage[0][c][4]=p.y,this.packedMessage[0][c][5]=p.shouldCollideWithScreenEdges?1:0,this.packedMessage[0][c][6]=p.lockedToStrategyIndex}this.working||this.postMessage()},"update")),$(this,"resolve",s(n=>{if(this.working=!1,this.collidersDirty||!n.data)return;let a=n.data.colliders,o=-1,l,u,c;Ug&&(this.visibleCollidersQTree=new P2(new Jc(0,0,this.debugCanvas.width,this.debugCanvas.height))),this.interactiveCollidersQTree=new P2(new Jc(0,0,this.debugCanvas.width,this.debugCanvas.height));for(let p=0;p<this.componentArray.length;p++){let m=this.componentArray[p];a[p]!=null&&(o=a[p][0],l=a[p][2],m.offscreen=a[p][1]===1,o!==-1&&l!=null?(c=new Jc(l.x,l.y,l.w,l.h,{entityId:m.id}),Ug&&this.visibleCollidersQTree.insert(c),u=this.coreState.geometry2DMap.get(m.id),(u==null?void 0:u.components[1])!=null&&this.interactiveCollidersQTree.insert(new Jc(l.x,l.y,l.w,l.h,{entityId:m.id})),(m.canShow===!1||m.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in m&&(m.visibilityNeedsUpdate="show"),o!==-1&&o!==m.currentStrategyIndex&&(m.activeBoundingBox=c,m.onStrategySelected(o))):((m.canShow===!0||m.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in m&&(m.visibilityNeedsUpdate="hide"),o!==-1&&o!==m.currentStrategyIndex&&m.onStrategySelected(o)))}Ug&&this.drawDebug(),this.publish("visibility-changed")},"resolve")),$(this,"drawDebug",s(()=>{Ug&&this.visibleCollidersQTree&&(this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugContext.beginPath(),this.visibleCollidersQTree.drawObjects(this.debugContext))},"drawDebug")),$(this,"destroy",s(()=>{this.worker.terminate()},"destroy")),this.coreState=r,this.debugCanvas=e,this.debugContext=e.getContext("2d"),this.worker=i,this.worker.onmessage=n=>this.resolve(n),this.postMessage=XTe(this._postMessage,dJe,!1),Ug?this.showCollisionBoxes():this.hideCollisionBoxes()}resize(e,r,i){this.packedMessage[6]=i,this.packedMessage[5]=r,this.packedMessage[4]=e,this.packedMessage[3]=this.debugCanvas.width,this.packedMessage[2]=this.debugCanvas.height}};s(ZTe,"CollisionSystem");var fJe=ZTe;function YTe(t){T8=t}s(YTe,"setWorkerUrl");N();N();N();N();var KTe=class{constructor(e){$(this,"type"),$(this,"event"),this.type=0,this.event=e}get timestamp(){return this.event.timeStamp}};s(KTe,"Tap");var mJe=KTe,JTe=class{constructor(){$(this,"taps",[])}add(e){this.lastPointerDown&&e.timestamp-this.lastPointerDown.timestamp<50?this.lastPointerDown.type=1:this.taps.push(e)}get lastPointerDown(){return this.taps.length>=1?this.taps[this.taps.length-1]:void 0}get isSingleTapWithTwoFingers(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===1}get isSingleTapWithOneFinger(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===0}get isDoubleTapWithOneFinger(){var e,r;return this.isDoubleTap&&((e=this.taps[0])==null?void 0:e.type)===0&&((r=this.taps[1])==null?void 0:r.type)===0}get isSingleTap(){return this.taps.length===1}get isDoubleTap(){return this.taps.length===2}discardOutsideOfWaitWindow(e){this.taps=this.taps.filter(r=>e-r.timestamp<300)}flush(){this.taps=[]}get _taps(){return this.taps}destroy(){this.flush()}};s(JTe,"TapsController");var gJe=JTe;N();function QTe(t){let e=new Set;for(let r of t){let i=r.object;for(;i.parent&&!e.has(i.parent);)i=i.parent,i instanceof Kn&&i.type==="group-container"&&i.visible&&i.components[1]&&e.add(i)}return Array.from(e)}s(QTe,"getUniqueIntersectedGroupContainers");var D2,ePe=class extends Wa{constructor(e,r,i,n,a){super(),$(this,"raycaster",new BA),$(this,"state",{hovered3DEntity:void 0,hovered2DEntity:void 0,hovered3DContainers:void 0,lastHover:void 0,interaction:{mouseDownStart:void 0,distanceFromMouseDown:void 0,isPanning:!1}}),$(this,"coreState"),$(this,"camera"),$(this,"worldPlane"),$(this,"_quadtree",new P2(new Jc(0,0,0,0))),$(this,"_container"),$(this,"lastPointerEvent"),$(this,"cursor","grab"),$(this,"touchesCount",0),$(this,"isUserInteracting"),$(this,"hasTouched",!1),Be(this,D2),$(this,"onPointerMoveRaf",s(o=>{this.lastPointerEvent=o,b(this,D2)&&cancelAnimationFrame(b(this,D2)),He(this,D2,requestAnimationFrame(()=>{this.onPointerMove(o)}))},"onPointerMoveRaf")),$(this,"onPointerMove",s(o=>{o.preventDefault(),this.updateInteractionStateIfPanning(o),(o.pointerType!=="touch"||o.pointerType===void 0&&this.hasTouched)&&this.handleHover(o),this.handleCursor()},"onPointerMove")),$(this,"tapsControl",new gJe),$(this,"onPointerDown",s(o=>{o.target===this._container&&(this._container.addEventListener("pointerup",this.onPointerUp,!1),this._container.addEventListener("pointercancel",this.onPointerUp,!1),this.state.interaction.mouseDownStart={time:Date.now(),timestamp:o.timeStamp,clientX:o.clientX,clientY:o.clientY},this.lastPointerEvent=o,this.state.interaction.distanceFromMouseDown=0,this.handleCursor(),o.pointerType==="touch"&&(this.tapsControl.add(new mJe(o)),this.touchesCount=Math.max(0,this.touchesCount+1)))},"onPointerDown")),$(this,"clickTimeout"),$(this,"onPointerUp",s(o=>{this.tapsControl.discardOutsideOfWaitWindow(o.timeStamp),this.lastPointerEvent=o,this.touchesCount=Math.max(0,this.touchesCount-1),this.touchesCount===0&&(this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)),this.updateInteractionStateIfPanning(o);let{mouseDownStart:l}=this.state.interaction;!l||this.state.interaction.distanceFromMouseDown==null||(Date.now()<l.time+300&&(this.tapsControl.isSingleTapWithTwoFingers||this.state.interaction.distanceFromMouseDown<=15)&&(o.pointerType==="touch"?this.tapsControl.isSingleTapWithTwoFingers?(this.publish("singletap-with-twofinger",o),this.flush()):this.tapsControl.isSingleTapWithOneFinger&&this.touchesCount===0?(this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=window.setTimeout(()=>{this.handleClick(o),this.flush()},300)):this.tapsControl.isDoubleTapWithOneFinger&&(this.publish("doubletap-with-onefinger",o),this.flush()):this.handleClick(o)),this.state.interaction.mouseDownStart=void 0,this.state.interaction.distanceFromMouseDown=void 0,this.state.interaction.isPanning=!1,this.handleCursor())},"onPointerUp")),$(this,"dirty3D",!0),$(this,"cachedHitBoxes",{entities:[],groups:[]}),$(this,"ndcPoint",new Jt),$(this,"debugPanel"),this.isUserInteracting=a,this.raycaster.layers.enableAll(),this.raycaster.layers.disable(1),this.camera=i,this._container=e,this.coreState=r,this.worldPlane=n,this._container.addEventListener("pointerdown",this.onPointerDown,!1),this._container.addEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.classList.add("mappedin-interactive")}updateQuadtree(e){this._quadtree=e}setHovered3DEntityInteractionComponentDirty(){if(this.state.hovered3DEntity){let e=this.state.hovered3DEntity.components[2];e&&(e.dirty=!0)}}getThreeDIntersectsFromXY(e){this.raycaster.setFromCamera(e,this.camera),this.raycaster.layers.enable(0);let r=this.raycaster.intersectObjects(this._hitBoxes.entities,!1).filter(n=>{var a,o;return((a=n.object)==null?void 0:a.name)==="worldPlane"||((o=n.object)==null?void 0:o.visible)}),i=r.findIndex(n=>{var a;return((a=n.object)==null?void 0:a.name)==="worldPlane"});return i!==-1&&r.push(r.splice(i,1)[0]),r}getGroupContainerIntersectsFromXY(e){this.raycaster.setFromCamera(e,this.camera),this.raycaster.layers.enable(0);let r=this.raycaster.intersectObjects(this._hitBoxes.groups,!0).filter(n=>n.object.visible),i;return r!=null&&r.length>0&&(i=QTe(r)),i}flush(){this.tapsControl.flush(),this.clickTimeout!=null&&(clearTimeout(this.clickTimeout),this.clickTimeout=void 0)}handleHover(e){let r=e||this.lastPointerEvent;if(this.state.interaction.mouseDownStart||!r||this.isUserInteracting())return;let{entity3D:i,entity2D:n,position:a,groupContainers:o}=this.intersect(r);(this.detect3DEntityHover(i)||this.detect2DEntityHover(n)||this.detect3DContainerHover(o))&&(this.state.hovered3DEntity=i,this.state.lastHover=i,this.state.hovered2DEntity=n,this.state.hovered3DContainers=o,this.publish("hover",{entity2D:this.state.hovered2DEntity,entity3D:this.state.hovered3DEntity,position:a,groupContainers:o})),this.handleCursor()}handleCursor(){var e;let r=!!(this.state.hovered3DEntity&&(e=this.state.hovered3DEntity)!=null&&e.components[2]||this.state.hovered2DEntity),i=!!this.state.interaction.mouseDownStart,n=this.state.interaction.isPanning,a=tPe(r,n,i);this.cursor!==a&&(this.cursor=a,a==="pointer"?this._container.classList.add("mappedin-interaction-hover"):this._container.classList.remove("mappedin-interaction-hover"))}detect2DEntityHover(e){return this.state.hovered2DEntity!==e}handleClick(e){let r=this.intersect(e);this.publish("click",{entity2D:r.entity2D,entity3D:r.entity3D,position:r.position,groupContainers:r.groupContainers,pointerEvent:{button:e.button}})}get _hitBoxes(){if(this.dirty3D){this.cachedHitBoxes.entities=[],this.cachedHitBoxes.groups=[];let e;for(let r of this.coreState.geometry3DIdsInScene)e=this.coreState.geometry3DMap.get(r),(e==null?void 0:e.type)==="geometry"||(e==null?void 0:e.type)==="model"||(e==null?void 0:e.type)==="path"||(e==null?void 0:e.type)==="custom-geometry"?e.components[0].mesh&&!this.cachedHitBoxes.entities.includes(e.components[0].mesh)&&this.cachedHitBoxes.entities.push(e.components[0].mesh):(e==null?void 0:e.type)==="group-container"&&e.components[1]&&!this.cachedHitBoxes.groups.includes(e)&&this.cachedHitBoxes.groups.push(e);return this.dirty3D=!1,this.cachedHitBoxes.entities.push(this.worldPlane),this.cachedHitBoxes}return this.cachedHitBoxes}intersect(e){var r,i,n,a,o;let l=[e.offsetX,e.offsetY],u=this._quadtree.queryPoint(l),[c]=u.filter(T=>T.intersectsPoint(l)),p=this.coreState.containerOffset[0],m=this.coreState.containerOffset[1];this.ndcPoint.x=(e.clientX-m)/this._container.clientWidth*2-1,this.ndcPoint.y=-((e.clientY-p)/this._container.clientHeight)*2+1;let y=this.getThreeDIntersectsFromXY(this.ndcPoint),v=(r=y[0])==null?void 0:r.point,w=[],E=[];for(let T of y.filter(O=>O.object.name!=="worldPlane"))T.object instanceof Pn&&T.object.material.depthTest===!1?w.push(T):E.push(T);let M=(n=(i=w[0])!=null?i:E[0])!=null?n:void 0,I,P;if(M!=null){if(I=iPe(M.object,this.coreState.geometry3DMap),!I){let T=(a=M==null?void 0:M.instanceId)!=null?a:M==null?void 0:M.batchId;I=T!=null&&M!=null&&M.object.userData.entities?this.coreState.geometry3DMap.get(M==null?void 0:M.object.userData.entities[T]):this.coreState.geometry3DMap.get(M==null?void 0:M.object.userData.entityId)}I!=null&&I.components[2]&&(P=I)}let C=this.getGroupContainerIntersectsFromXY(this.ndcPoint);return{entity2D:((o=c==null?void 0:c.userData)==null?void 0:o.entityId)==="watermark"?{id:"watermark"}:this.coreState.geometry2DMap.get(c==null?void 0:c.userData.entityId),entity3D:P,position:v,groupContainers:C}}detect3DEntityHover(e){return this.state.lastHover!==e&&(this.state.lastHover&&P8(this.state.lastHover,!1,this.coreState),e&&P8(e,!0,this.coreState)),this.state.hovered3DEntity!==e}detect3DContainerHover(e){return!jme(this.state.hovered3DContainers,e)}updateInteractionStateIfPanning(e){this.state.interaction.mouseDownStart&&(this.state.interaction.distanceFromMouseDown=Math.sqrt(Math.pow(e.clientX-this.state.interaction.mouseDownStart.clientX,2)+Math.pow(e.clientY-this.state.interaction.mouseDownStart.clientY,2)),!this.state.interaction.isPanning&&this.state.interaction.distanceFromMouseDown>15&&(this.state.interaction.isPanning=!0))}getMouseRayIntersects(){return this.raycaster.intersectObjects([this.worldPlane],!1)}destroy(){this._container.removeEventListener("pointerdown",this.onPointerDown,!1),this._container.removeEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)}enableDebug(){let e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.backgroundColor="white",e.style.padding="10px",document.body.append(e),e.id="interaction-debug-panel",this.debugPanel=e,this.on("doubletap-with-onefinger",()=>{this.queueDebugMessage("doubletap-with-onefinger","#ffadad")}),this.on("singletap-with-twofinger",()=>{this.queueDebugMessage("singletap-with-twofinger","#ffd6a5")}),this.on("click",r=>{var i,n,a;this.queueDebugMessage(`CLICK 
3D: `.concat((i=r.entity3D)==null?void 0:i.id,` 
2D: `).concat((n=r.entity2D)==null?void 0:n.id,` 
Pos: `).concat((a=r.position)==null?void 0:a.toArray().join(", ")),"#fdffb6")}),this.on("hover",r=>{var i,n,a;this.queueDebugMessage(`HOVER 
3D: `.concat((i=r.entity3D)==null?void 0:i.id,` 
2D: `).concat((n=r.entity2D)==null?void 0:n.id,` 
Pos: `).concat((a=r.position)==null?void 0:a.toArray().join(", ")),"#caffbf")})}get _state(){return this.state}queueDebugMessage(e,r){var i;let n=document.createElement("pre");n.style.maxWidth="300px",n.style.transition="opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)",n.style.backgroundColor=r,n.textContent=e,(i=this.debugPanel)==null||i.prepend(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},500)},2500)}getCursor(){return this.cursor}};D2=new WeakMap,s(ePe,"InteractionSystem");var yJe=ePe;function P8(t,e,r){var i;let n=t.components[2];n&&n.hover!==!0&&(n.hover=e?"user-interaction":!1,n.dirty=!0);let a=(i=t.components[0].textMesh)==null?void 0:i.userData.entityId;if(!a)return;let o=r.geometry3DMap.get(a);(o==null?void 0:o.type)==="text3d"&&(o.components[1].hoverByPolygon=e,o.components[1].dirty=!0)}s(P8,"updateHover");function tPe(t,e,r){return e?"grabbing":t?"pointer":r?"grabbing":"grab"}s(tPe,"processCursor");function rPe(t){let e=t;for(;e!=null&&e.parent;){if(e instanceof bB)return;if(e.userData.isSingleModel)return e;e=e.parent}}s(rPe,"findModelParent");function iPe(t,e){let r=rPe(t);return r?e.get(r.userData.entityId):void 0}s(iPe,"findModelParentEntity");N();N();N();var xt={};Nl(xt,{BRAND:()=>FJe,DIRTY:()=>j1,EMPTY_PATH:()=>xJe,INVALID:()=>Si,NEVER:()=>xQe,OK:()=>nu,ParseStatus:()=>ju,Schema:()=>Qi,ZodAny:()=>K_,ZodArray:()=>nv,ZodBigInt:()=>Qw,ZodBoolean:()=>eA,ZodBranded:()=>aj,ZodCatch:()=>cA,ZodDate:()=>tA,ZodDefault:()=>uA,ZodDiscriminatedUnion:()=>NPe,ZodEffects:()=>Xh,ZodEnum:()=>_S,ZodError:()=>Uh,ZodFirstPartyTypeKind:()=>Mi,ZodFunction:()=>HPe,ZodIntersection:()=>aA,ZodIssueCode:()=>yr,ZodLazy:()=>oA,ZodLiteral:()=>sA,ZodMap:()=>zT,ZodNaN:()=>VT,ZodNativeEnum:()=>lA,ZodNever:()=>wf,ZodNull:()=>iA,ZodNullable:()=>ng,ZodNumber:()=>Jw,ZodObject:()=>nh,ZodOptional:()=>Yp,ZodParsedType:()=>Ur,ZodPipeline:()=>oj,ZodPromise:()=>J_,ZodReadonly:()=>hA,ZodRecord:()=>VPe,ZodSchema:()=>Qi,ZodSet:()=>UT,ZodString:()=>Y_,ZodSymbol:()=>NT,ZodTransformer:()=>Xh,ZodTuple:()=>ig,ZodType:()=>Qi,ZodUndefined:()=>rA,ZodUnion:()=>nA,ZodUnknown:()=>Uy,ZodVoid:()=>FT,addIssueToContext:()=>Ir,any:()=>qJe,array:()=>YJe,bigint:()=>VJe,boolean:()=>u5e,coerce:()=>_Qe,custom:()=>sj,date:()=>jJe,datetimeRegex:()=>ij,defaultErrorMap:()=>Z_,discriminatedUnion:()=>eQe,effect:()=>uX,enum:()=>uQe,function:()=>oQe,getErrorMap:()=>Yw,getParsedType:()=>Qd,instanceof:()=>zJe,intersection:()=>tQe,isAborted:()=>D8,isAsync:()=>Kw,isDirty:()=>R8,isValid:()=>iv,late:()=>BJe,lazy:()=>sQe,literal:()=>lQe,makeIssue:()=>kT,map:()=>nQe,nan:()=>UJe,nativeEnum:()=>cQe,never:()=>XJe,null:()=>HJe,nullable:()=>dQe,number:()=>l5e,object:()=>KJe,objectUtil:()=>L8,oboolean:()=>vQe,onumber:()=>yQe,optional:()=>pQe,ostring:()=>gQe,pipeline:()=>mQe,preprocess:()=>fQe,promise:()=>hQe,quotelessJson:()=>vJe,record:()=>iQe,set:()=>aQe,setErrorMap:()=>sPe,strictObject:()=>JJe,string:()=>s5e,symbol:()=>$Je,transformer:()=>uX,tuple:()=>rQe,undefined:()=>GJe,union:()=>QJe,unknown:()=>WJe,util:()=>Tn,void:()=>ZJe});N();N();N();N();N();var Tn;(function(t){t.assertEqual=n=>{};function e(n){}s(e,"assertIs"),t.assertIs=e;function r(n){throw new Error}s(r,"assertNever"),t.assertNever=r,t.arrayToEnum=n=>{let a={};for(let o of n)a[o]=o;return a},t.getValidEnumValues=n=>{let a=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of a)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(a){return n[a]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let a=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&a.push(o);return a},t.find=(n,a)=>{for(let o of n)if(a(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function i(n,a=" | "){return n.map(o=>typeof o=="string"?"'".concat(o,"'"):o).join(a)}s(i,"joinValues"),t.joinValues=i,t.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(Tn||(Tn={}));var L8;(function(t){t.mergeShapes=(e,r)=>Ee(Ee({},e),r)})(L8||(L8={}));var Ur=Tn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qd=s(t=>{switch(typeof t){case"undefined":return Ur.undefined;case"string":return Ur.string;case"number":return Number.isNaN(t)?Ur.nan:Ur.number;case"boolean":return Ur.boolean;case"function":return Ur.function;case"bigint":return Ur.bigint;case"symbol":return Ur.symbol;case"object":return Array.isArray(t)?Ur.array:t===null?Ur.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Ur.promise:typeof Map<"u"&&t instanceof Map?Ur.map:typeof Set<"u"&&t instanceof Set?Ur.set:typeof Date<"u"&&t instanceof Date?Ur.date:Ur.object;default:return Ur.unknown}},"getParsedType"),yr=Tn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),vJe=s(t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),"quotelessJson"),nPe=class aPe extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},i={_errors:[]},n=s(a=>{for(let o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)i._errors.push(r(o));else{let l=i,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(r(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}},"processError");return n(this),i}static assert(e){if(!(e instanceof aPe))throw new Error("Not a ZodError: ".concat(e))}toString(){return this.message}get message(){return JSON.stringify(this.issues,Tn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};s(nPe,"ZodError");var Uh=nPe;Uh.create=t=>new Uh(t);var _Je=s((t,e)=>{let r;switch(t.code){case yr.invalid_type:t.received===Ur.undefined?r="Required":r="Expected ".concat(t.expected,", received ").concat(t.received);break;case yr.invalid_literal:r="Invalid literal value, expected ".concat(JSON.stringify(t.expected,Tn.jsonStringifyReplacer));break;case yr.unrecognized_keys:r="Unrecognized key(s) in object: ".concat(Tn.joinValues(t.keys,", "));break;case yr.invalid_union:r="Invalid input";break;case yr.invalid_union_discriminator:r="Invalid discriminator value. Expected ".concat(Tn.joinValues(t.options));break;case yr.invalid_enum_value:r="Invalid enum value. Expected ".concat(Tn.joinValues(t.options),", received '").concat(t.received,"'");break;case yr.invalid_arguments:r="Invalid function arguments";break;case yr.invalid_return_type:r="Invalid function return type";break;case yr.invalid_date:r="Invalid date";break;case yr.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r='Invalid input: must include "'.concat(t.validation.includes,'"'),typeof t.validation.position=="number"&&(r="".concat(r," at one or more positions greater than or equal to ").concat(t.validation.position))):"startsWith"in t.validation?r='Invalid input: must start with "'.concat(t.validation.startsWith,'"'):"endsWith"in t.validation?r='Invalid input: must end with "'.concat(t.validation.endsWith,'"'):Tn.assertNever(t.validation):t.validation!=="regex"?r="Invalid ".concat(t.validation):r="Invalid";break;case yr.too_small:t.type==="array"?r="Array must contain ".concat(t.exact?"exactly":t.inclusive?"at least":"more than"," ").concat(t.minimum," element(s)"):t.type==="string"?r="String must contain ".concat(t.exact?"exactly":t.inclusive?"at least":"over"," ").concat(t.minimum," character(s)"):t.type==="number"?r="Number must be ".concat(t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than ").concat(t.minimum):t.type==="date"?r="Date must be ".concat(t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(t.minimum))):r="Invalid input";break;case yr.too_big:t.type==="array"?r="Array must contain ".concat(t.exact?"exactly":t.inclusive?"at most":"less than"," ").concat(t.maximum," element(s)"):t.type==="string"?r="String must contain ".concat(t.exact?"exactly":t.inclusive?"at most":"under"," ").concat(t.maximum," character(s)"):t.type==="number"?r="Number must be ".concat(t.exact?"exactly":t.inclusive?"less than or equal to":"less than"," ").concat(t.maximum):t.type==="bigint"?r="BigInt must be ".concat(t.exact?"exactly":t.inclusive?"less than or equal to":"less than"," ").concat(t.maximum):t.type==="date"?r="Date must be ".concat(t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(t.maximum))):r="Invalid input";break;case yr.custom:r="Invalid input";break;case yr.invalid_intersection_types:r="Intersection results could not be merged";break;case yr.not_multiple_of:r="Number must be a multiple of ".concat(t.multipleOf);break;case yr.not_finite:r="Number must be finite";break;default:r=e.defaultError,Tn.assertNever(t)}return{message:r}},"errorMap"),Z_=_Je,oPe=Z_;function sPe(t){oPe=t}s(sPe,"setErrorMap");function Yw(){return oPe}s(Yw,"getErrorMap");N();var kT=s(t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,a=[...r,...n.path||[]],o=vt(Ee({},n),{path:a});if(n.message!==void 0)return vt(Ee({},n),{path:a,message:n.message});let l="",u=i.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return vt(Ee({},n),{path:a,message:l})},"makeIssue"),xJe=[];function Ir(t,e){let r=Yw(),i=kT({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Z_?void 0:Z_].filter(n=>!!n)});t.common.issues.push(i)}s(Ir,"addIssueToContext");var lPe=class uPe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return Si;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let a=await n.key,o=await n.value;i.push({key:a,value:o})}return uPe.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:a,value:o}=n;if(a.status==="aborted"||o.status==="aborted")return Si;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(i[a.value]=o.value)}return{status:e.value,value:i}}};s(lPe,"ParseStatus");var ju=lPe,Si=Object.freeze({status:"aborted"}),j1=s(t=>({status:"dirty",value:t}),"DIRTY"),nu=s(t=>({status:"valid",value:t}),"OK"),D8=s(t=>t.status==="aborted","isAborted"),R8=s(t=>t.status==="dirty","isDirty"),iv=s(t=>t.status==="valid","isValid"),Kw=s(t=>typeof Promise<"u"&&t instanceof Promise,"isAsync");N();N();N();var oi;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(oi||(oi={}));var cPe=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}};s(cPe,"ParseInputLazyPath");var td=cPe,lX=s((t,e)=>{if(iv(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Uh(t.common.issues);return this._error=r,this._error}}},"handleResult");function Ui(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:s((a,o)=>{var l,u;let{message:c}=t;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??i)!=null?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??r)!=null?u:o.defaultError}},"customMap"),description:n}}s(Ui,"processCreateParams");var hPe=class{get description(){return this._def.description}_getType(e){return Qd(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Qd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ju,ctx:{common:e.parent.common,data:e.data,parsedType:Qd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Kw(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r==null?void 0:r.async)!=null?i:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qd(e)},a=this._parseSync({data:e,path:n.path,parent:n});return lX(n,a)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qd(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:n});return iv(a)?{value:a.value}:{issues:n.common.issues}}catch(a){(i=(r=a==null?void 0:a.message)==null?void 0:r.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>iv(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qd(e)},n=this._parse({data:e,path:i.path,parent:i}),a=await(Kw(n)?n:Promise.resolve(n));return lX(i,a)}refine(e,r){let i=s(n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r,"getIssueProperties");return this._refinement((n,a)=>{let o=e(n),l=s(()=>a.addIssue(Ee({code:yr.custom},i(n))),"setError");return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new Xh({schema:this,typeName:Mi.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s(r=>this["~validate"](r),"validate")}}optional(){return Yp.create(this,this._def)}nullable(){return ng.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nv.create(this)}promise(){return J_.create(this,this._def)}or(e){return nA.create([this,e],this._def)}and(e){return aA.create(this,e,this._def)}transform(e){return new Xh(vt(Ee({},Ui(this._def)),{schema:this,typeName:Mi.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){let r=typeof e=="function"?e:()=>e;return new uA(vt(Ee({},Ui(this._def)),{innerType:this,defaultValue:r,typeName:Mi.ZodDefault}))}brand(){return new aj(Ee({typeName:Mi.ZodBranded,type:this},Ui(this._def)))}catch(e){let r=typeof e=="function"?e:()=>e;return new cA(vt(Ee({},Ui(this._def)),{innerType:this,catchValue:r,typeName:Mi.ZodCatch}))}describe(e){let r=this.constructor;return new r(vt(Ee({},this._def),{description:e}))}pipe(e){return oj.create(this,e)}readonly(){return hA.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};s(hPe,"ZodType");var Qi=hPe,bJe=/^c[^\s-]{8,}$/i,wJe=/^[0-9a-z]+$/,AJe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,SJe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,MJe=/^[a-z0-9_-]{21}$/i,EJe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,CJe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,IJe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,TJe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",O6,PJe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,LJe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,DJe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,RJe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,OJe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,kJe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,pPe="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",NJe=new RegExp("^".concat(pPe,"$"));function rj(t){let e="[0-5]\\d";t.precision?e="".concat(e,"\\.\\d{").concat(t.precision,"}"):t.precision==null&&(e="".concat(e,"(\\.\\d+)?"));let r=t.precision?"+":"?";return"([01]\\d|2[0-3]):[0-5]\\d(:".concat(e,")").concat(r)}s(rj,"timeRegexSource");function dPe(t){return new RegExp("^".concat(rj(t),"$"))}s(dPe,"timeRegex");function ij(t){let e="".concat(pPe,"T").concat(rj(t)),r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e="".concat(e,"(").concat(r.join("|"),")"),new RegExp("^".concat(e,"$"))}s(ij,"datetimeRegex");function fPe(t,e){return!!((e==="v4"||!e)&&PJe.test(t)||(e==="v6"||!e)&&DJe.test(t))}s(fPe,"isValidIP");function mPe(t,e){if(!EJe.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||e&&n.alg!==e)}catch{return!1}}s(mPe,"isValidJWT");function gPe(t,e){return!!((e==="v4"||!e)&&LJe.test(t)||(e==="v6"||!e)&&RJe.test(t))}s(gPe,"isValidCidr");var yPe=class R2 extends Qi{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ur.string){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_type,expected:Ur.string,received:n.parsedType}),Si}let r=new ju,i;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="max")e.data.length>n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="length"){let a=e.data.length>n.value,o=e.data.length<n.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?Ir(i,{code:yr.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&Ir(i,{code:yr.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),r.dirty())}else if(n.kind==="email")IJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"email",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="emoji")O6||(O6=new RegExp(TJe,"u")),O6.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"emoji",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="uuid")SJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"uuid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="nanoid")MJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"nanoid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid")bJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"cuid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid2")wJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"cuid2",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="ulid")AJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"ulid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),Ir(i,{validation:"url",code:yr.invalid_string,message:n.message}),r.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"regex",code:yr.invalid_string,message:n.message}),r.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),r.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:{startsWith:n.value},message:n.message}),r.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:{endsWith:n.value},message:n.message}),r.dirty()):n.kind==="datetime"?ij(n).test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:"datetime",message:n.message}),r.dirty()):n.kind==="date"?NJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:"date",message:n.message}),r.dirty()):n.kind==="time"?dPe(n).test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:"time",message:n.message}),r.dirty()):n.kind==="duration"?CJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"duration",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="ip"?fPe(e.data,n.version)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"ip",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="jwt"?mPe(e.data,n.alg)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"jwt",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="cidr"?gPe(e.data,n.version)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"cidr",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="base64"?OJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"base64",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="base64url"?kJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"base64url",code:yr.invalid_string,message:n.message}),r.dirty()):Tn.assertNever(n);return{status:r.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),Ee({validation:r,code:yr.invalid_string},oi.errToObj(i)))}_addCheck(e){return new R2(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}email(e){return this._addCheck(Ee({kind:"email"},oi.errToObj(e)))}url(e){return this._addCheck(Ee({kind:"url"},oi.errToObj(e)))}emoji(e){return this._addCheck(Ee({kind:"emoji"},oi.errToObj(e)))}uuid(e){return this._addCheck(Ee({kind:"uuid"},oi.errToObj(e)))}nanoid(e){return this._addCheck(Ee({kind:"nanoid"},oi.errToObj(e)))}cuid(e){return this._addCheck(Ee({kind:"cuid"},oi.errToObj(e)))}cuid2(e){return this._addCheck(Ee({kind:"cuid2"},oi.errToObj(e)))}ulid(e){return this._addCheck(Ee({kind:"ulid"},oi.errToObj(e)))}base64(e){return this._addCheck(Ee({kind:"base64"},oi.errToObj(e)))}base64url(e){return this._addCheck(Ee({kind:"base64url"},oi.errToObj(e)))}jwt(e){return this._addCheck(Ee({kind:"jwt"},oi.errToObj(e)))}ip(e){return this._addCheck(Ee({kind:"ip"},oi.errToObj(e)))}cidr(e){return this._addCheck(Ee({kind:"cidr"},oi.errToObj(e)))}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck(Ee({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!=null?r:!1,local:(i=e==null?void 0:e.local)!=null?i:!1},oi.errToObj(e==null?void 0:e.message)))}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck(Ee({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision},oi.errToObj(e==null?void 0:e.message)))}duration(e){return this._addCheck(Ee({kind:"duration"},oi.errToObj(e)))}regex(e,r){return this._addCheck(Ee({kind:"regex",regex:e},oi.errToObj(r)))}includes(e,r){return this._addCheck(Ee({kind:"includes",value:e,position:r==null?void 0:r.position},oi.errToObj(r==null?void 0:r.message)))}startsWith(e,r){return this._addCheck(Ee({kind:"startsWith",value:e},oi.errToObj(r)))}endsWith(e,r){return this._addCheck(Ee({kind:"endsWith",value:e},oi.errToObj(r)))}min(e,r){return this._addCheck(Ee({kind:"min",value:e},oi.errToObj(r)))}max(e,r){return this._addCheck(Ee({kind:"max",value:e},oi.errToObj(r)))}length(e,r){return this._addCheck(Ee({kind:"length",value:e},oi.errToObj(r)))}nonempty(e){return this.min(1,oi.errToObj(e))}trim(){return new R2(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new R2(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new R2(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};s(yPe,"ZodString");var Y_=yPe;Y_.create=t=>{var e;return new Y_(Ee({checks:[],typeName:Mi.ZodString,coerce:(e=t==null?void 0:t.coerce)!=null?e:!1},Ui(t)))};function vPe(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,a=Number.parseInt(t.toFixed(n).replace(".","")),o=Number.parseInt(e.toFixed(n).replace(".",""));return a%o/10**n}s(vPe,"floatSafeRemainder");var _Pe=class O8 extends Qi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ur.number){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_type,expected:Ur.number,received:n.parsedType}),Si}let r,i=new ju;for(let n of this._def.checks)n.kind==="int"?Tn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.invalid_type,expected:"integer",received:"float",message:n.message}),i.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="multipleOf"?vPe(e.data,n.value)!==0&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.not_finite,message:n.message}),i.dirty()):Tn.assertNever(n);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,oi.toString(r))}gt(e,r){return this.setLimit("min",e,!1,oi.toString(r))}lte(e,r){return this.setLimit("max",e,!0,oi.toString(r))}lt(e,r){return this.setLimit("max",e,!1,oi.toString(r))}setLimit(e,r,i,n){return new O8(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:oi.toString(n)}]}))}_addCheck(e){return new O8(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}int(e){return this._addCheck({kind:"int",message:oi.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:oi.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:oi.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:oi.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:oi.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:oi.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:oi.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:oi.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:oi.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Tn.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};s(_Pe,"ZodNumber");var Jw=_Pe;Jw.create=t=>new Jw(Ee({checks:[],typeName:Mi.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1},Ui(t)));var xPe=class k8 extends Qi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Ur.bigint)return this._getInvalidInput(e);let r,i=new ju;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):Tn.assertNever(n);return{status:i.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.bigint,received:r.parsedType}),Si}gte(e,r){return this.setLimit("min",e,!0,oi.toString(r))}gt(e,r){return this.setLimit("min",e,!1,oi.toString(r))}lte(e,r){return this.setLimit("max",e,!0,oi.toString(r))}lt(e,r){return this.setLimit("max",e,!1,oi.toString(r))}setLimit(e,r,i,n){return new k8(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:oi.toString(n)}]}))}_addCheck(e){return new k8(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:oi.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:oi.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:oi.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:oi.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:oi.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};s(xPe,"ZodBigInt");var Qw=xPe;Qw.create=t=>{var e;return new Qw(Ee({checks:[],typeName:Mi.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!=null?e:!1},Ui(t)))};var bPe=class extends Qi{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ur.boolean){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.boolean,received:r.parsedType}),Si}return nu(e.data)}};s(bPe,"ZodBoolean");var eA=bPe;eA.create=t=>new eA(Ee({typeName:Mi.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1},Ui(t)));var wPe=class APe extends Qi{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Ur.date){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_type,expected:Ur.date,received:n.parsedType}),Si}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_date}),Si}let r=new ju,i;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):Tn.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new APe(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:oi.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:oi.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};s(wPe,"ZodDate");var tA=wPe;tA.create=t=>new tA(Ee({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Mi.ZodDate},Ui(t)));var SPe=class extends Qi{_parse(e){if(this._getType(e)!==Ur.symbol){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.symbol,received:r.parsedType}),Si}return nu(e.data)}};s(SPe,"ZodSymbol");var NT=SPe;NT.create=t=>new NT(Ee({typeName:Mi.ZodSymbol},Ui(t)));var MPe=class extends Qi{_parse(e){if(this._getType(e)!==Ur.undefined){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.undefined,received:r.parsedType}),Si}return nu(e.data)}};s(MPe,"ZodUndefined");var rA=MPe;rA.create=t=>new rA(Ee({typeName:Mi.ZodUndefined},Ui(t)));var EPe=class extends Qi{_parse(e){if(this._getType(e)!==Ur.null){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.null,received:r.parsedType}),Si}return nu(e.data)}};s(EPe,"ZodNull");var iA=EPe;iA.create=t=>new iA(Ee({typeName:Mi.ZodNull},Ui(t)));var CPe=class extends Qi{constructor(){super(...arguments),this._any=!0}_parse(e){return nu(e.data)}};s(CPe,"ZodAny");var K_=CPe;K_.create=t=>new K_(Ee({typeName:Mi.ZodAny},Ui(t)));var IPe=class extends Qi{constructor(){super(...arguments),this._unknown=!0}_parse(e){return nu(e.data)}};s(IPe,"ZodUnknown");var Uy=IPe;Uy.create=t=>new Uy(Ee({typeName:Mi.ZodUnknown},Ui(t)));var TPe=class extends Qi{_parse(e){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.never,received:r.parsedType}),Si}};s(TPe,"ZodNever");var wf=TPe;wf.create=t=>new wf(Ee({typeName:Mi.ZodNever},Ui(t)));var PPe=class extends Qi{_parse(e){if(this._getType(e)!==Ur.undefined){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.void,received:r.parsedType}),Si}return nu(e.data)}};s(PPe,"ZodVoid");var FT=PPe;FT.create=t=>new FT(Ee({typeName:Mi.ZodVoid},Ui(t)));var LPe=class rI extends Qi{_parse(e){let{ctx:r,status:i}=this._processInputParams(e),n=this._def;if(r.parsedType!==Ur.array)return Ir(r,{code:yr.invalid_type,expected:Ur.array,received:r.parsedType}),Si;if(n.exactLength!==null){let o=r.data.length>n.exactLength.value,l=r.data.length<n.exactLength.value;(o||l)&&(Ir(r,{code:o?yr.too_big:yr.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),i.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(Ir(r,{code:yr.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),i.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(Ir(r,{code:yr.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>n.type._parseAsync(new td(r,o,r.path,l)))).then(o=>ju.mergeArray(i,o));let a=[...r.data].map((o,l)=>n.type._parseSync(new td(r,o,r.path,l)));return ju.mergeArray(i,a)}get element(){return this._def.type}min(e,r){return new rI(vt(Ee({},this._def),{minLength:{value:e,message:oi.toString(r)}}))}max(e,r){return new rI(vt(Ee({},this._def),{maxLength:{value:e,message:oi.toString(r)}}))}length(e,r){return new rI(vt(Ee({},this._def),{exactLength:{value:e,message:oi.toString(r)}}))}nonempty(e){return this.min(1,e)}};s(LPe,"ZodArray");var nv=LPe;nv.create=(t,e)=>new nv(Ee({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Mi.ZodArray},Ui(e)));function vy(t){if(t instanceof nh){let e={};for(let r in t.shape){let i=t.shape[r];e[r]=Yp.create(vy(i))}return new nh(vt(Ee({},t._def),{shape:s(()=>e,"shape")}))}else return t instanceof nv?new nv(vt(Ee({},t._def),{type:vy(t.element)})):t instanceof Yp?Yp.create(vy(t.unwrap())):t instanceof ng?ng.create(vy(t.unwrap())):t instanceof ig?ig.create(t.items.map(e=>vy(e))):t}s(vy,"deepPartialify");var DPe=class Ch extends Qi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=Tn.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==Ur.object){let u=this._getOrReturnCtx(e);return Ir(u,{code:yr.invalid_type,expected:Ur.object,received:u.parsedType}),Si}let{status:r,ctx:i}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof wf&&this._def.unknownKeys==="strip"))for(let u in i.data)a.includes(u)||o.push(u);let l=[];for(let u of a){let c=n[u],p=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new td(i,p,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof wf){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")o.length>0&&(Ir(i,{code:yr.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new td(i,p,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,m=await c.value;u.push({key:p,value:m,alwaysSet:c.alwaysSet})}return u}).then(u=>ju.mergeObjectSync(r,u)):ju.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return oi.errToObj,new Ch(Ee(vt(Ee({},this._def),{unknownKeys:"strict"}),e!==void 0?{errorMap:s((r,i)=>{var n,a,o,l;let u=(o=(a=(n=this._def).errorMap)==null?void 0:a.call(n,r,i).message)!=null?o:i.defaultError;return r.code==="unrecognized_keys"?{message:(l=oi.errToObj(e).message)!=null?l:u}:{message:u}},"errorMap")}:{}))}strip(){return new Ch(vt(Ee({},this._def),{unknownKeys:"strip"}))}passthrough(){return new Ch(vt(Ee({},this._def),{unknownKeys:"passthrough"}))}extend(e){return new Ch(vt(Ee({},this._def),{shape:s(()=>Ee(Ee({},this._def.shape()),e),"shape")}))}merge(e){return new Ch({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:s(()=>Ee(Ee({},this._def.shape()),e._def.shape()),"shape"),typeName:Mi.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Ch(vt(Ee({},this._def),{catchall:e}))}pick(e){let r={};for(let i of Tn.objectKeys(e))e[i]&&this.shape[i]&&(r[i]=this.shape[i]);return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}omit(e){let r={};for(let i of Tn.objectKeys(this.shape))e[i]||(r[i]=this.shape[i]);return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}deepPartial(){return vy(this)}partial(e){let r={};for(let i of Tn.objectKeys(this.shape)){let n=this.shape[i];e&&!e[i]?r[i]=n:r[i]=n.optional()}return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}required(e){let r={};for(let i of Tn.objectKeys(this.shape))if(e&&!e[i])r[i]=this.shape[i];else{let n=this.shape[i];for(;n instanceof Yp;)n=n._def.innerType;r[i]=n}return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}keyof(){return nj(Tn.objectKeys(this.shape))}};s(DPe,"ZodObject");var nh=DPe;nh.create=(t,e)=>new nh(Ee({shape:s(()=>t,"shape"),unknownKeys:"strip",catchall:wf.create(),typeName:Mi.ZodObject},Ui(e)));nh.strictCreate=(t,e)=>new nh(Ee({shape:s(()=>t,"shape"),unknownKeys:"strict",catchall:wf.create(),typeName:Mi.ZodObject},Ui(e)));nh.lazycreate=(t,e)=>new nh(Ee({shape:t,unknownKeys:"strip",catchall:wf.create(),typeName:Mi.ZodObject},Ui(e)));var RPe=class extends Qi{_parse(e){let{ctx:r}=this._processInputParams(e),i=this._def.options;function n(a){for(let l of a)if(l.result.status==="valid")return l.result;for(let l of a)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;let o=a.map(l=>new Uh(l.ctx.common.issues));return Ir(r,{code:yr.invalid_union,unionErrors:o}),Si}if(s(n,"handleResults"),r.common.async)return Promise.all(i.map(async a=>{let o=vt(Ee({},r),{common:vt(Ee({},r.common),{issues:[]}),parent:null});return{result:await a._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let a,o=[];for(let u of i){let c=vt(Ee({},r),{common:vt(Ee({},r.common),{issues:[]}),parent:null}),p=u._parseSync({data:r.data,path:r.path,parent:c});if(p.status==="valid")return p;p.status==="dirty"&&!a&&(a={result:p,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;let l=o.map(u=>new Uh(u));return Ir(r,{code:yr.invalid_union,unionErrors:l}),Si}}get options(){return this._def.options}};s(RPe,"ZodUnion");var nA=RPe;nA.create=(t,e)=>new nA(Ee({options:t,typeName:Mi.ZodUnion},Ui(e)));var _m=s(t=>t instanceof oA?_m(t.schema):t instanceof Xh?_m(t.innerType()):t instanceof sA?[t.value]:t instanceof _S?t.options:t instanceof lA?Tn.objectValues(t.enum):t instanceof uA?_m(t._def.innerType):t instanceof rA?[void 0]:t instanceof iA?[null]:t instanceof Yp?[void 0,..._m(t.unwrap())]:t instanceof ng?[null,..._m(t.unwrap())]:t instanceof aj||t instanceof hA?_m(t.unwrap()):t instanceof cA?_m(t._def.innerType):[],"getDiscriminator"),OPe=class kPe extends Qi{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Ur.object)return Ir(r,{code:yr.invalid_type,expected:Ur.object,received:r.parsedType}),Si;let i=this.discriminator,n=r.data[i],a=this.optionsMap.get(n);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(Ir(r,{code:yr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),Si)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,i){let n=new Map;for(let a of r){let o=_m(a.shape[e]);if(!o.length)throw new Error("A discriminator value for key `".concat(e,"` could not be extracted from all schema options"));for(let l of o){if(n.has(l))throw new Error("Discriminator property ".concat(String(e)," has duplicate value ").concat(String(l)));n.set(l,a)}}return new kPe(Ee({typeName:Mi.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:n},Ui(i)))}};s(OPe,"ZodDiscriminatedUnion");var NPe=OPe;function BT(t,e){let r=Qd(t),i=Qd(e);if(t===e)return{valid:!0,data:t};if(r===Ur.object&&i===Ur.object){let n=Tn.objectKeys(e),a=Tn.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o=Ee(Ee({},t),e);for(let l of a){let u=BT(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(r===Ur.array&&i===Ur.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let a=0;a<t.length;a++){let o=t[a],l=e[a],u=BT(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return r===Ur.date&&i===Ur.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}s(BT,"mergeValues");var FPe=class extends Qi{_parse(e){let{status:r,ctx:i}=this._processInputParams(e),n=s((a,o)=>{if(D8(a)||D8(o))return Si;let l=BT(a.value,o.value);return l.valid?((R8(a)||R8(o))&&r.dirty(),{status:r.value,value:l.data}):(Ir(i,{code:yr.invalid_intersection_types}),Si)},"handleParsed");return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([a,o])=>n(a,o)):n(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}};s(FPe,"ZodIntersection");var aA=FPe;aA.create=(t,e,r)=>new aA(Ee({left:t,right:e,typeName:Mi.ZodIntersection},Ui(r)));var BPe=class zPe extends Qi{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ur.array)return Ir(i,{code:yr.invalid_type,expected:Ur.array,received:i.parsedType}),Si;if(i.data.length<this._def.items.length)return Ir(i,{code:yr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Si;!this._def.rest&&i.data.length>this._def.items.length&&(Ir(i,{code:yr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let n=[...i.data].map((a,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new td(i,a,i.path,o)):null}).filter(a=>!!a);return i.common.async?Promise.all(n).then(a=>ju.mergeArray(r,a)):ju.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new zPe(vt(Ee({},this._def),{rest:e}))}};s(BPe,"ZodTuple");var ig=BPe;ig.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ig(Ee({items:t,typeName:Mi.ZodTuple,rest:null},Ui(e)))};var UPe=class N8 extends Qi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ur.object)return Ir(i,{code:yr.invalid_type,expected:Ur.object,received:i.parsedType}),Si;let n=[],a=this._def.keyType,o=this._def.valueType;for(let l in i.data)n.push({key:a._parse(new td(i,l,i.path,l)),value:o._parse(new td(i,i.data[l],i.path,l)),alwaysSet:l in i.data});return i.common.async?ju.mergeObjectAsync(r,n):ju.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(e,r,i){return r instanceof Qi?new N8(Ee({keyType:e,valueType:r,typeName:Mi.ZodRecord},Ui(i))):new N8(Ee({keyType:Y_.create(),valueType:e,typeName:Mi.ZodRecord},Ui(r)))}};s(UPe,"ZodRecord");var VPe=UPe,jPe=class extends Qi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ur.map)return Ir(i,{code:yr.invalid_type,expected:Ur.map,received:i.parsedType}),Si;let n=this._def.keyType,a=this._def.valueType,o=[...i.data.entries()].map(([l,u],c)=>({key:n._parse(new td(i,l,i.path,[c,"key"])),value:a._parse(new td(i,u,i.path,[c,"value"]))}));if(i.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,p=await u.value;if(c.status==="aborted"||p.status==="aborted")return Si;(c.status==="dirty"||p.status==="dirty")&&r.dirty(),l.set(c.value,p.value)}return{status:r.value,value:l}})}else{let l=new Map;for(let u of o){let c=u.key,p=u.value;if(c.status==="aborted"||p.status==="aborted")return Si;(c.status==="dirty"||p.status==="dirty")&&r.dirty(),l.set(c.value,p.value)}return{status:r.value,value:l}}}};s(jPe,"ZodMap");var zT=jPe;zT.create=(t,e,r)=>new zT(Ee({valueType:e,keyType:t,typeName:Mi.ZodMap},Ui(r)));var $Pe=class F8 extends Qi{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Ur.set)return Ir(i,{code:yr.invalid_type,expected:Ur.set,received:i.parsedType}),Si;let n=this._def;n.minSize!==null&&i.data.size<n.minSize.value&&(Ir(i,{code:yr.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&i.data.size>n.maxSize.value&&(Ir(i,{code:yr.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());let a=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return Si;p.status==="dirty"&&r.dirty(),c.add(p.value)}return{status:r.value,value:c}}s(o,"finalizeSet");let l=[...i.data.values()].map((u,c)=>a._parse(new td(i,u,i.path,c)));return i.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,r){return new F8(vt(Ee({},this._def),{minSize:{value:e,message:oi.toString(r)}}))}max(e,r){return new F8(vt(Ee({},this._def),{maxSize:{value:e,message:oi.toString(r)}}))}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};s($Pe,"ZodSet");var UT=$Pe;UT.create=(t,e)=>new UT(Ee({valueType:t,minSize:null,maxSize:null,typeName:Mi.ZodSet},Ui(e)));var GPe=class iI extends Qi{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Ur.function)return Ir(r,{code:yr.invalid_type,expected:Ur.function,received:r.parsedType}),Si;function i(l,u){return kT({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Yw(),Z_].filter(c=>!!c),issueData:{code:yr.invalid_arguments,argumentsError:u}})}s(i,"makeArgsIssue");function n(l,u){return kT({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Yw(),Z_].filter(c=>!!c),issueData:{code:yr.invalid_return_type,returnTypeError:u}})}s(n,"makeReturnsIssue");let a={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof J_){let l=this;return nu(async function(...u){let c=new Uh([]),p=await l._def.args.parseAsync(u,a).catch(y=>{throw c.addIssue(i(u,y)),c}),m=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(m,a).catch(y=>{throw c.addIssue(n(m,y)),c})})}else{let l=this;return nu(function(...u){let c=l._def.args.safeParse(u,a);if(!c.success)throw new Uh([i(u,c.error)]);let p=Reflect.apply(o,this,c.data),m=l._def.returns.safeParse(p,a);if(!m.success)throw new Uh([n(p,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new iI(vt(Ee({},this._def),{args:ig.create(e).rest(Uy.create())}))}returns(e){return new iI(vt(Ee({},this._def),{returns:e}))}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,i){return new iI(Ee({args:e||ig.create([]).rest(Uy.create()),returns:r||Uy.create(),typeName:Mi.ZodFunction},Ui(i)))}};s(GPe,"ZodFunction");var HPe=GPe,qPe=class extends Qi{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};s(qPe,"ZodLazy");var oA=qPe;oA.create=(t,e)=>new oA(Ee({getter:t,typeName:Mi.ZodLazy},Ui(e)));var WPe=class extends Qi{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return Ir(r,{received:r.data,code:yr.invalid_literal,expected:this._def.value}),Si}return{status:"valid",value:e.data}}get value(){return this._def.value}};s(WPe,"ZodLiteral");var sA=WPe;sA.create=(t,e)=>new sA(Ee({value:t,typeName:Mi.ZodLiteral},Ui(e)));function nj(t,e){return new _S(Ee({values:t,typeName:Mi.ZodEnum},Ui(e)))}s(nj,"createZodEnum");var XPe=class B8 extends Qi{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),i=this._def.values;return Ir(r,{expected:Tn.joinValues(i),received:r.parsedType,code:yr.invalid_type}),Si}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),i=this._def.values;return Ir(r,{received:r.data,code:yr.invalid_enum_value,options:i}),Si}return nu(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return B8.create(e,Ee(Ee({},this._def),r))}exclude(e,r=this._def){return B8.create(this.options.filter(i=>!e.includes(i)),Ee(Ee({},this._def),r))}};s(XPe,"ZodEnum");var _S=XPe;_S.create=nj;var ZPe=class extends Qi{_parse(e){let r=Tn.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==Ur.string&&i.parsedType!==Ur.number){let n=Tn.objectValues(r);return Ir(i,{expected:Tn.joinValues(n),received:i.parsedType,code:yr.invalid_type}),Si}if(this._cache||(this._cache=new Set(Tn.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let n=Tn.objectValues(r);return Ir(i,{received:i.data,code:yr.invalid_enum_value,options:n}),Si}return nu(e.data)}get enum(){return this._def.values}};s(ZPe,"ZodNativeEnum");var lA=ZPe;lA.create=(t,e)=>new lA(Ee({values:t,typeName:Mi.ZodNativeEnum},Ui(e)));var YPe=class extends Qi{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Ur.promise&&r.common.async===!1)return Ir(r,{code:yr.invalid_type,expected:Ur.promise,received:r.parsedType}),Si;let i=r.parsedType===Ur.promise?r.data:Promise.resolve(r.data);return nu(i.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}};s(YPe,"ZodPromise");var J_=YPe;J_.create=(t,e)=>new J_(Ee({type:t,typeName:Mi.ZodPromise},Ui(e)));var KPe=class extends Qi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Mi.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:i}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:s(o=>{Ir(i,o),o.fatal?r.abort():r.dirty()},"addIssue"),get path(){return i.path}};if(a.addIssue=a.addIssue.bind(a),n.type==="preprocess"){let o=n.transform(i.data,a);if(i.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return Si;let u=await this._def.schema._parseAsync({data:l,path:i.path,parent:i});return u.status==="aborted"?Si:u.status==="dirty"||r.value==="dirty"?j1(u.value):u});{if(r.value==="aborted")return Si;let l=this._def.schema._parseSync({data:o,path:i.path,parent:i});return l.status==="aborted"?Si:l.status==="dirty"||r.value==="dirty"?j1(l.value):l}}if(n.type==="refinement"){let o=s(l=>{let u=n.refinement(l,a);if(i.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l},"executeRefinement");if(i.common.async===!1){let l=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return l.status==="aborted"?Si:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(l=>l.status==="aborted"?Si:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(n.type==="transform")if(i.common.async===!1){let o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!iv(o))return Si;let l=n.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>iv(o)?Promise.resolve(n.transform(o.value,a)).then(l=>({status:r.value,value:l})):Si);Tn.assertNever(n)}};s(KPe,"ZodEffects");var Xh=KPe;Xh.create=(t,e,r)=>new Xh(Ee({schema:t,typeName:Mi.ZodEffects,effect:e},Ui(r)));Xh.createWithPreprocess=(t,e,r)=>new Xh(Ee({schema:e,effect:{type:"preprocess",transform:t},typeName:Mi.ZodEffects},Ui(r)));var JPe=class extends Qi{_parse(e){return this._getType(e)===Ur.undefined?nu(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};s(JPe,"ZodOptional");var Yp=JPe;Yp.create=(t,e)=>new Yp(Ee({innerType:t,typeName:Mi.ZodOptional},Ui(e)));var QPe=class extends Qi{_parse(e){return this._getType(e)===Ur.null?nu(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};s(QPe,"ZodNullable");var ng=QPe;ng.create=(t,e)=>new ng(Ee({innerType:t,typeName:Mi.ZodNullable},Ui(e)));var e5e=class extends Qi{_parse(e){let{ctx:r}=this._processInputParams(e),i=r.data;return r.parsedType===Ur.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};s(e5e,"ZodDefault");var uA=e5e;uA.create=(t,e)=>new uA(Ee({innerType:t,typeName:Mi.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default},Ui(e)));var t5e=class extends Qi{_parse(e){let{ctx:r}=this._processInputParams(e),i=vt(Ee({},r),{common:vt(Ee({},r.common),{issues:[]})}),n=this._def.innerType._parse({data:i.data,path:i.path,parent:Ee({},i)});return Kw(n)?n.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Uh(i.common.issues)},input:i.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Uh(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}};s(t5e,"ZodCatch");var cA=t5e;cA.create=(t,e)=>new cA(Ee({innerType:t,typeName:Mi.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch},Ui(e)));var r5e=class extends Qi{_parse(e){if(this._getType(e)!==Ur.nan){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Ur.nan,received:r.parsedType}),Si}return{status:"valid",value:e.data}}};s(r5e,"ZodNaN");var VT=r5e;VT.create=t=>new VT(Ee({typeName:Mi.ZodNaN},Ui(t)));var FJe=Symbol("zod_brand"),i5e=class extends Qi{_parse(e){let{ctx:r}=this._processInputParams(e),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}};s(i5e,"ZodBranded");var aj=i5e,n5e=class a5e extends Qi{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.common.async)return s(async()=>{let n=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?Si:n.status==="dirty"?(r.dirty(),j1(n.value)):this._def.out._parseAsync({data:n.value,path:i.path,parent:i})},"handleAsync")();{let n=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?Si:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:i.path,parent:i})}}static create(e,r){return new a5e({in:e,out:r,typeName:Mi.ZodPipeline})}};s(n5e,"ZodPipeline");var oj=n5e,o5e=class extends Qi{_parse(e){let r=this._def.innerType._parse(e),i=s(n=>(iv(n)&&(n.value=Object.freeze(n.value)),n),"freeze");return Kw(r)?r.then(n=>i(n)):i(r)}unwrap(){return this._def.innerType}};s(o5e,"ZodReadonly");var hA=o5e;hA.create=(t,e)=>new hA(Ee({innerType:t,typeName:Mi.ZodReadonly},Ui(e)));function z8(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}s(z8,"cleanParams");function sj(t,e={},r){return t?K_.create().superRefine((i,n)=>{var a,o;let l=t(i);if(l instanceof Promise)return l.then(u=>{var c,p;if(!u){let m=z8(e,i),y=(p=(c=m.fatal)!=null?c:r)!=null?p:!0;n.addIssue(vt(Ee({code:"custom"},m),{fatal:y}))}});if(!l){let u=z8(e,i),c=(o=(a=u.fatal)!=null?a:r)!=null?o:!0;n.addIssue(vt(Ee({code:"custom"},u),{fatal:c}))}}):K_.create()}s(sj,"custom");var BJe={object:nh.lazycreate},Mi;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Mi||(Mi={}));var zJe=s((t,e={message:"Input not instance of ".concat(t.name)})=>sj(r=>r instanceof t,e),"instanceOfType"),s5e=Y_.create,l5e=Jw.create,UJe=VT.create,VJe=Qw.create,u5e=eA.create,jJe=tA.create,$Je=NT.create,GJe=rA.create,HJe=iA.create,qJe=K_.create,WJe=Uy.create,XJe=wf.create,ZJe=FT.create,YJe=nv.create,KJe=nh.create,JJe=nh.strictCreate,QJe=nA.create,eQe=NPe.create,tQe=aA.create,rQe=ig.create,iQe=VPe.create,nQe=zT.create,aQe=UT.create,oQe=HPe.create,sQe=oA.create,lQe=sA.create,uQe=_S.create,cQe=lA.create,hQe=J_.create,uX=Xh.create,pQe=Yp.create,dQe=ng.create,fQe=Xh.createWithPreprocess,mQe=oj.create,gQe=s(()=>s5e().optional(),"ostring"),yQe=s(()=>l5e().optional(),"onumber"),vQe=s(()=>u5e().optional(),"oboolean"),_Qe={string:s(t=>Y_.create(vt(Ee({},t),{coerce:!0})),"string"),number:s(t=>Jw.create(vt(Ee({},t),{coerce:!0})),"number"),boolean:s(t=>eA.create(vt(Ee({},t),{coerce:!0})),"boolean"),bigint:s(t=>Qw.create(vt(Ee({},t),{coerce:!0})),"bigint"),date:s(t=>tA.create(vt(Ee({},t),{coerce:!0})),"date")},xQe=Si,bQe=xt,Zl=bQe,wQe=kr(cye()),Vb=4,AQe=8,SQe="0.6",cX="low-priority-pin",c5e=xt.object({rank:xt.union([xt.enum(["low","medium","high","always-visible"]),xt.number()]).optional(),interactive:xt.union([xt.boolean(),xt.literal("pointer-events-auto")]).optional(),id:xt.string().optional(),anchor:xt.union([xt.enum(["top","bottom","left","right","center","top-left","top-right","bottom-left","bottom-right"]),xt.array(xt.enum(["top","bottom","left","right","center","top-left","top-right","bottom-left","bottom-right"]))]).optional(),dynamicResize:xt.boolean().optional(),zIndex:xt.number().optional(),lowPriorityPin:xt.object({enabled:xt.boolean().optional(),size:xt.number().positive().optional(),color:xt.string().optional()}).optional()});function h5e(t,e,r){xt.array(xt.number()).min(2).max(3).parse(t),xt.string().parse(e),c5e.parse(r)}s(h5e,"validateMarker");var MQe=Object.freeze({enabled:!0,size:AQe,color:"#666"}),U8=class nI{constructor(e,r={}){$(this,"id"),$(this,"type","marker"),$(this,"rank",0),$(this,"initialRank",0),$(this,"activeAnchor","center"),$(this,"pointerEvents","none"),$(this,"options",{rank:"low",interactive:!1,id:"",anchor:"center",dynamicResize:!1,occluderId:0,zIndex:void 0,verticalOffset:0,lowPriorityPin:Ee({},MQe)}),$(this,"projection",new Jt),$(this,"enabled",!0),$(this,"canShow",!1),$(this,"visible",!0),$(this,"isOccluded",!1),$(this,"offscreen",!1),$(this,"strategyIndex",-1),$(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),$(this,"dimensions",{width:0,height:0}),$(this,"markerContainer"),$(this,"containerEl"),$(this,"contentEl",null),$(this,"contentHtml",""),$(this,"style",{top:"0px",left:"0px"}),$(this,"dirty",!1),$(this,"attachedDirty",!0),$(this,"collisionDirty",!0),$(this,"visibilityNeedsUpdate","show"),$(this,"animation",null),$(this,"currentStrategyIndex",-1),$(this,"onStrategySelected",s((o,l=!1)=>{var u,c;if(!(this.currentStrategyIndex===o&&!l)){if(this.currentStrategyIndex=o,o===this.lowPriorityPinStrategyIndex){this.activeAnchor="center",this.markerContainer.setAttribute("data-anchor",cX);let p=this.options.lowPriorityPin,m=p.size,y=p.color;this.markerContainer.style.setProperty("--mappedin-pin-size","".concat(m,"px")),this.markerContainer.style.setProperty("--pin-color",y),this.markerContainer.style.opacity=SQe,this.style.top=-m/2+"px",this.style.left=-m/2+"px"}else{this.activeAnchor=(c=(u=this.strategies[o])==null?void 0:u.name)!=null?c:"center",this.markerContainer.setAttribute("data-anchor",this.activeAnchor),this.markerContainer.style.removeProperty("--mappedin-pin-size"),this.markerContainer.style.removeProperty("--pin-color"),this.markerContainer.style.opacity="1";let{width:p,height:m}=this.dimensions,y=-m/2+"px",v=-p/2+"px";switch(this.style.top=y,this.style.left=v,this.activeAnchor){case"top":{this.style.top=-m+"px";break}case"bottom":{this.style.top="0px";break}case"left":{this.style.left=-p+"px";break}case"right":{this.style.left="0px";break}case"top-left":{this.style.top=-m+"px",this.style.left=-p+"px";break}case"top-right":{this.style.top=-m+"px",this.style.left="0px";break}case"bottom-left":{this.style.top="0px",this.style.left=-p+"px";break}case"bottom-right":{this.style.top="0px",this.style.left="0px";break}default:this.style.top=y,this.style.left=v}}this.markerContainer.style.top=this.style.top,this.markerContainer.style.left=this.style.left}},"onStrategySelected")),$(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],lockedToStrategyIndex:-1,shouldCollideWithScreenEdges:!1});var i,n,a;if(this.id=(r==null?void 0:r.id)||ya(),this.options=(0,wQe.default)(this.options,r),typeof r.rank=="string")this.rank=W5(r.rank);else if(r.rank!=null&&r.rank>0)this.rank=r.rank;else{let o=Math.trunc($a.env.NODE_ENV==="test"?nI.testId:nI.testId*10)/10;nI.testId+=.001,this.rank=o}typeof r.interactive=="string"&&(this.pointerEvents=r.interactive==="pointer-events-auto"?"auto":"none"),this.contentHtml=e,this.initialRank=this.rank,this.markerContainer=document.createElement("div"),this.markerContainer.className="mappedin-marker",this.markerContainer.style.opacity="0",this.markerContainer.innerHTML='<div class="mappedin-marker-content">'.concat(this.contentHtml,"</div>"),this.markerContainer.setAttribute("data-marker-id",this.id.toString()),this.containerEl=(i=this.markerContainer.firstElementChild)!=null?i:null,this.contentEl=(a=(n=this.markerContainer.firstElementChild)==null?void 0:n.firstElementChild)!=null?a:null}updateDimensions(e,r){if(e!=null&&r!=null)this.dimensions={width:e,height:r};else{let{width:i,height:n}=this.markerContainer.getBoundingClientRect();this.dimensions={width:i,height:n}}Object.assign(this.markerContainer,{width:this.dimensions.width+"px",height:this.dimensions.height+"px"}),this.currentStrategyIndex=-1}get strategies(){var e;let{width:r,height:i}=this.dimensions;if(r===0||i===0)return[];let n=(Array.isArray(this.options.anchor)?this.options.anchor:[this.options.anchor]).map(a=>({name:a,getBoundingBox:s(()=>{let o=i/2,l=i/2,u=r/2,c=r/2;switch(a){case"top":{o=i,l=0;break}case"bottom":{o=0,l=i;break}case"left":{u=r,c=0;break}case"right":{u=0,c=r;break}case"top-left":{o=i,u=r,l=0,c=0;break}case"top-right":{o=i,c=r,l=0,u=0;break}case"bottom-left":{l=i,u=r,o=0,c=0;break}case"bottom-right":{l=i,c=r,o=0,u=0;break}}return[o+Vb,l+Vb,u+Vb,c+Vb]},"getBoundingBox")}));if((e=this.options.lowPriorityPin)!=null&&e.enabled&&this.options.rank!=="always-visible"){let a={name:cX,getBoundingBox:s(()=>{let o=Math.max(2,Vb/2);return[this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o]},"getBoundingBox")};n.push(a)}return n}toPackedMessage(e=!1){var r;this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.packedMessage.shouldCollideWithScreenEdges=!0;let i=this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityPinStrategyIndex;if(this.visible&&e&&i&&this.collisionDirty===!1?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,i&&this.currentStrategyIndex!==((r=this.packedMessage.bboxes[0])==null?void 0:r[4])){let n=this.packedMessage.bboxes.findIndex(a=>a[4]===this.currentStrategyIndex);if(n!==-1){let a=this.packedMessage.bboxes.splice(n,1)[0];this.packedMessage.bboxes.unshift(a)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let n=0;n<this.strategies.length;n++){let a=this.strategies[n];n===this.currentStrategyIndex&&i?this.packedMessage.bboxes.unshift([...a.getBoundingBox(),n]):this.packedMessage.bboxes.push([...a.getBoundingBox(),n])}return this.collisionDirty=!1,this.packedMessage}get lowPriorityPinStrategyIndex(){var e;return!((e=this.options.lowPriorityPin)!=null&&e.enabled)||this.options.rank==="always-visible"?-1:Array.isArray(this.options.anchor)?this.options.anchor.length:1}destroy(){}};s(U8,"MarkerComponent"),$(U8,"testId",0);var dw=U8;N();N();N();N();N();var p5e=class{constructor(){$(this,"hover",!1),$(this,"dirty",!1)}};s(p5e,"InteractionComponent");var k6=p5e;N();N();function pA(t){"@babel/helpers - typeof";return pA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pA(t)}s(pA,"_typeof");var EQe=/^\s+/,CQe=/\s+$/;function ni(t,e){if(t=t||"",e=e||{},t instanceof ni)return t;if(!(this instanceof ni))return new ni(t,e);var r=d5e(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}s(ni,"tinycolor");ni.prototype={isDark:s(function(){return this.getBrightness()<128},"isDark"),isLight:s(function(){return!this.isDark()},"isLight"),isValid:s(function(){return this._ok},"isValid"),getOriginalInput:s(function(){return this._originalInput},"getOriginalInput"),getFormat:s(function(){return this._format},"getFormat"),getAlpha:s(function(){return this._a},"getAlpha"),getBrightness:s(function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},"getBrightness"),getLuminance:s(function(){var t=this.toRgb(),e,r,i,n,a,o;return e=t.r/255,r=t.g/255,i=t.b/255,e<=.03928?n=e/12.92:n=Math.pow((e+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*n+.7152*a+.0722*o},"getLuminance"),setAlpha:s(function(t){return this._a=lj(t),this._roundA=Math.round(100*this._a)/100,this},"setAlpha"),toHsv:s(function(){var t=j8(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},"toHsv"),toHsvString:s(function(){var t=j8(this._r,this._g,this._b),e=Math.round(t.h*360),r=Math.round(t.s*100),i=Math.round(t.v*100);return this._a==1?"hsv("+e+", "+r+"%, "+i+"%)":"hsva("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},"toHsvString"),toHsl:s(function(){var t=V8(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},"toHsl"),toHslString:s(function(){var t=V8(this._r,this._g,this._b),e=Math.round(t.h*360),r=Math.round(t.s*100),i=Math.round(t.l*100);return this._a==1?"hsl("+e+", "+r+"%, "+i+"%)":"hsla("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},"toHslString"),toHex:s(function(t){return $8(this._r,this._g,this._b,t)},"toHex"),toHexString:s(function(t){return"#"+this.toHex(t)},"toHexString"),toHex8:s(function(t){return y5e(this._r,this._g,this._b,this._a,t)},"toHex8"),toHex8String:s(function(t){return"#"+this.toHex8(t)},"toHex8String"),toRgb:s(function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},"toRgb"),toRgbString:s(function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},"toRgbString"),toPercentageRgb:s(function(){return{r:Math.round(Va(this._r,255)*100)+"%",g:Math.round(Va(this._g,255)*100)+"%",b:Math.round(Va(this._b,255)*100)+"%",a:this._a}},"toPercentageRgb"),toPercentageRgbString:s(function(){return this._a==1?"rgb("+Math.round(Va(this._r,255)*100)+"%, "+Math.round(Va(this._g,255)*100)+"%, "+Math.round(Va(this._b,255)*100)+"%)":"rgba("+Math.round(Va(this._r,255)*100)+"%, "+Math.round(Va(this._g,255)*100)+"%, "+Math.round(Va(this._b,255)*100)+"%, "+this._roundA+")"},"toPercentageRgbString"),toName:s(function(){return this._a===0?"transparent":this._a<1?!1:IQe[$8(this._r,this._g,this._b,!0)]||!1},"toName"),toFilter:s(function(t){var e="#"+G8(this._r,this._g,this._b,this._a),r=e,i=this._gradientType?"GradientType = 1, ":"";if(t){var n=ni(t);r="#"+G8(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+r+")"},"toFilter"),toString:s(function(t){var e=!!t;t=t||this._format;var r=!1,i=this._a<1&&this._a>=0,n=!e&&i&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return n?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(r=this.toRgbString()),t==="prgb"&&(r=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(r=this.toHexString()),t==="hex3"&&(r=this.toHexString(!0)),t==="hex4"&&(r=this.toHex8String(!0)),t==="hex8"&&(r=this.toHex8String()),t==="name"&&(r=this.toName()),t==="hsl"&&(r=this.toHslString()),t==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},"toString"),clone:s(function(){return ni(this.toString())},"clone"),_applyModification:s(function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},"_applyModification"),lighten:s(function(){return this._applyModification(b5e,arguments)},"lighten"),brighten:s(function(){return this._applyModification(w5e,arguments)},"brighten"),darken:s(function(){return this._applyModification(A5e,arguments)},"darken"),desaturate:s(function(){return this._applyModification(v5e,arguments)},"desaturate"),saturate:s(function(){return this._applyModification(_5e,arguments)},"saturate"),greyscale:s(function(){return this._applyModification(x5e,arguments)},"greyscale"),spin:s(function(){return this._applyModification(S5e,arguments)},"spin"),_applyCombination:s(function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},"_applyCombination"),analogous:s(function(){return this._applyCombination(C5e,arguments)},"analogous"),complement:s(function(){return this._applyCombination(M5e,arguments)},"complement"),monochromatic:s(function(){return this._applyCombination(I5e,arguments)},"monochromatic"),splitcomplement:s(function(){return this._applyCombination(E5e,arguments)},"splitcomplement"),triad:s(function(){return this._applyCombination(H8,[3])},"triad"),tetrad:s(function(){return this._applyCombination(H8,[4])},"tetrad")};ni.fromRatio=function(t,e){if(pA(t)=="object"){var r={};for(var i in t)t.hasOwnProperty(i)&&(i==="a"?r[i]=t[i]:r[i]=$1(t[i]));t=r}return ni(t,e)};function d5e(t){var e={r:0,g:0,b:0},r=1,i=null,n=null,a=null,o=!1,l=!1;return typeof t=="string"&&(t=D5e(t)),pA(t)=="object"&&(bp(t.r)&&bp(t.g)&&bp(t.b)?(e=f5e(t.r,t.g,t.b),o=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):bp(t.h)&&bp(t.s)&&bp(t.v)?(i=$1(t.s),n=$1(t.v),e=g5e(t.h,i,n),o=!0,l="hsv"):bp(t.h)&&bp(t.s)&&bp(t.l)&&(i=$1(t.s),a=$1(t.l),e=m5e(t.h,i,a),o=!0,l="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=lj(r),{ok:o,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}s(d5e,"inputToRGB");function f5e(t,e,r){return{r:Va(t,255)*255,g:Va(e,255)*255,b:Va(r,255)*255}}s(f5e,"rgbToRgb");function V8(t,e,r){t=Va(t,255),e=Va(e,255),r=Va(r,255);var i=Math.max(t,e,r),n=Math.min(t,e,r),a,o,l=(i+n)/2;if(i==n)a=o=0;else{var u=i-n;switch(o=l>.5?u/(2-i-n):u/(i+n),i){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s:o,l}}s(V8,"rgbToHsl");function m5e(t,e,r){var i,n,a;t=Va(t,360),e=Va(e,100),r=Va(r,100);function o(c,p,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?c+(p-c)*6*m:m<1/2?p:m<2/3?c+(p-c)*(2/3-m)*6:c}if(s(o,"hue2rgb"),e===0)i=n=a=r;else{var l=r<.5?r*(1+e):r+e-r*e,u=2*r-l;i=o(u,l,t+1/3),n=o(u,l,t),a=o(u,l,t-1/3)}return{r:i*255,g:n*255,b:a*255}}s(m5e,"hslToRgb");function j8(t,e,r){t=Va(t,255),e=Va(e,255),r=Va(r,255);var i=Math.max(t,e,r),n=Math.min(t,e,r),a,o,l=i,u=i-n;if(o=i===0?0:u/i,i==n)a=0;else{switch(i){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s:o,v:l}}s(j8,"rgbToHsv");function g5e(t,e,r){t=Va(t,360)*6,e=Va(e,100),r=Va(r,100);var i=Math.floor(t),n=t-i,a=r*(1-e),o=r*(1-n*e),l=r*(1-(1-n)*e),u=i%6,c=[r,o,a,a,l,r][u],p=[l,r,r,o,a,a][u],m=[a,a,l,r,r,o][u];return{r:c*255,g:p*255,b:m*255}}s(g5e,"hsvToRgb");function $8(t,e,r,i){var n=[th(Math.round(t).toString(16)),th(Math.round(e).toString(16)),th(Math.round(r).toString(16))];return i&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}s($8,"rgbToHex");function y5e(t,e,r,i,n){var a=[th(Math.round(t).toString(16)),th(Math.round(e).toString(16)),th(Math.round(r).toString(16)),th(uj(i))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}s(y5e,"rgbaToHex");function G8(t,e,r,i){var n=[th(uj(i)),th(Math.round(t).toString(16)),th(Math.round(e).toString(16)),th(Math.round(r).toString(16))];return n.join("")}s(G8,"rgbaToArgbHex");ni.equals=function(t,e){return!t||!e?!1:ni(t).toRgbString()==ni(e).toRgbString()};ni.random=function(){return ni.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function v5e(t,e){e=e===0?0:e||10;var r=ni(t).toHsl();return r.s-=e/100,r.s=xS(r.s),ni(r)}s(v5e,"_desaturate");function _5e(t,e){e=e===0?0:e||10;var r=ni(t).toHsl();return r.s+=e/100,r.s=xS(r.s),ni(r)}s(_5e,"_saturate");function x5e(t){return ni(t).desaturate(100)}s(x5e,"_greyscale");function b5e(t,e){e=e===0?0:e||10;var r=ni(t).toHsl();return r.l+=e/100,r.l=xS(r.l),ni(r)}s(b5e,"_lighten");function w5e(t,e){e=e===0?0:e||10;var r=ni(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),ni(r)}s(w5e,"_brighten");function A5e(t,e){e=e===0?0:e||10;var r=ni(t).toHsl();return r.l-=e/100,r.l=xS(r.l),ni(r)}s(A5e,"_darken");function S5e(t,e){var r=ni(t).toHsl(),i=(r.h+e)%360;return r.h=i<0?360+i:i,ni(r)}s(S5e,"_spin");function M5e(t){var e=ni(t).toHsl();return e.h=(e.h+180)%360,ni(e)}s(M5e,"_complement");function H8(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=ni(t).toHsl(),i=[ni(t)],n=360/e,a=1;a<e;a++)i.push(ni({h:(r.h+a*n)%360,s:r.s,l:r.l}));return i}s(H8,"polyad");function E5e(t){var e=ni(t).toHsl(),r=e.h;return[ni(t),ni({h:(r+72)%360,s:e.s,l:e.l}),ni({h:(r+216)%360,s:e.s,l:e.l})]}s(E5e,"_splitcomplement");function C5e(t,e,r){e=e||6,r=r||30;var i=ni(t).toHsl(),n=360/r,a=[ni(t)];for(i.h=(i.h-(n*e>>1)+720)%360;--e;)i.h=(i.h+n)%360,a.push(ni(i));return a}s(C5e,"_analogous");function I5e(t,e){e=e||6;for(var r=ni(t).toHsv(),i=r.h,n=r.s,a=r.v,o=[],l=1/e;e--;)o.push(ni({h:i,s:n,v:a})),a=(a+l)%1;return o}s(I5e,"_monochromatic");ni.mix=function(t,e,r){r=r===0?0:r||50;var i=ni(t).toRgb(),n=ni(e).toRgb(),a=r/100,o={r:(n.r-i.r)*a+i.r,g:(n.g-i.g)*a+i.g,b:(n.b-i.b)*a+i.b,a:(n.a-i.a)*a+i.a};return ni(o)};ni.readability=function(t,e){var r=ni(t),i=ni(e);return(Math.max(r.getLuminance(),i.getLuminance())+.05)/(Math.min(r.getLuminance(),i.getLuminance())+.05)};ni.isReadable=function(t,e,r){var i=ni.readability(t,e),n,a;switch(a=!1,n=R5e(r),n.level+n.size){case"AAsmall":case"AAAlarge":a=i>=4.5;break;case"AAlarge":a=i>=3;break;case"AAAsmall":a=i>=7;break}return a};ni.mostReadable=function(t,e,r){var i=null,n=0,a,o,l,u;r=r||{},o=r.includeFallbackColors,l=r.level,u=r.size;for(var c=0;c<e.length;c++)a=ni.readability(t,e[c]),a>n&&(n=a,i=ni(e[c]));return ni.isReadable(t,i,{level:l,size:u})||!o?i:(r.includeFallbackColors=!1,ni.mostReadable(t,["#fff","#000"],r))};var q8=ni.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},IQe=ni.hexNames=T5e(q8);function T5e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}s(T5e,"flip");function lj(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}s(lj,"boundAlpha");function Va(t,e){P5e(t)&&(t="100%");var r=L5e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}s(Va,"bound01");function xS(t){return Math.min(1,Math.max(0,t))}s(xS,"clamp01");function Iu(t){return parseInt(t,16)}s(Iu,"parseIntFromHex");function P5e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}s(P5e,"isOnePointZero");function L5e(t){return typeof t=="string"&&t.indexOf("%")!=-1}s(L5e,"isPercentage");function th(t){return t.length==1?"0"+t:""+t}s(th,"pad2");function $1(t){return t<=1&&(t=t*100+"%"),t}s($1,"convertToPercentage");function uj(t){return Math.round(parseFloat(t)*255).toString(16)}s(uj,"convertDecimalToHex");function W8(t){return Iu(t)/255}s(W8,"convertHexToDecimal");var Ih=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function bp(t){return!!Ih.CSS_UNIT.exec(t)}s(bp,"isValidCSSUnit");function D5e(t){t=t.replace(EQe,"").replace(CQe,"").toLowerCase();var e=!1;if(q8[t])t=q8[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=Ih.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=Ih.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Ih.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=Ih.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Ih.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=Ih.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Ih.hex8.exec(t))?{r:Iu(r[1]),g:Iu(r[2]),b:Iu(r[3]),a:W8(r[4]),format:e?"name":"hex8"}:(r=Ih.hex6.exec(t))?{r:Iu(r[1]),g:Iu(r[2]),b:Iu(r[3]),format:e?"name":"hex"}:(r=Ih.hex4.exec(t))?{r:Iu(r[1]+""+r[1]),g:Iu(r[2]+""+r[2]),b:Iu(r[3]+""+r[3]),a:W8(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=Ih.hex3.exec(t))?{r:Iu(r[1]+""+r[1]),g:Iu(r[2]+""+r[2]),b:Iu(r[3]+""+r[3]),format:e?"name":"hex"}:!1}s(D5e,"stringInputToObject");function R5e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}s(R5e,"validateWCAG2Parms");var hX=kr(hye()),O5e=xt.object({rank:xt.union([xt.enum(["low","medium","high","always-visible"]),xt.number()]).optional(),interactive:xt.boolean().optional(),appearance:xt.object({margin:xt.number().min(6).optional(),text:xt.object({numLines:xt.number().optional(),lineHeight:xt.number().optional(),size:xt.number().optional(),maxWidth:xt.number().optional(),foregroundColor:xt.string().optional(),backgroundColor:xt.string().optional()}).optional(),marker:xt.object({size:xt.number().optional(),foregroundColor:xt.object({active:xt.string().optional(),inactive:xt.string().optional()}).optional(),backgroundColor:xt.object({active:xt.string().optional(),inactive:xt.string().optional()}).optional(),iconSizeInterpolation:xt.object({nearZoomLevel:xt.number().optional(),farZoomLevel:xt.number().optional(),nearScale:xt.number().optional(),farScale:xt.number().optional()}).optional()}).optional()}).optional()});function k5e(t,e,r){xt.array(xt.number()).min(2).max(3).parse(t),xt.string().parse(e),O5e.parse(r||{})}s(k5e,"validateLabel");var _0={margin:6,text:{numLines:2,lineHeight:1.2,size:11.5,maxWidth:150,foregroundColor:"white",backgroundColor:"#333"},marker:{size:5,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},TQe={lightOnDark:vt(Ee({},_0),{text:vt(Ee({},_0.text),{foregroundColor:"white",backgroundColor:"#333"}),marker:vt(Ee({},_0.marker),{foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}})}),darkOnLight:vt(Ee({},_0),{text:vt(Ee({},_0.text),{foregroundColor:"#333",backgroundColor:"white"}),marker:vt(Ee({},_0.marker),{foregroundColor:{active:"#333",inactive:void 0},backgroundColor:{active:"white",inactive:void 0}})})},PQe="LOW_PRIORITY",pX=4,LQe=6,DQe=20,RQe=2.5,OQe=2,kQe="cover",NQe=-1/0,dX=6.5,fX={heightAbovePolygon:0,appearance:TQe.darkOnLight},FQe=s((t,e)=>["numLines","lineHeight","size","maxWidth","foregroundColor","backgroundColor"].some(r=>{var i,n,a;return((i=e.text)==null?void 0:i[r])!=null&&((n=t.text)==null?void 0:n[r])!==((a=e.text)==null?void 0:a[r])}),"isOneOfTextDirtyOptions"),BQe=s((t,e)=>["foregroundColor","backgroundColor","icon"].some(r=>{var i,n,a;return((i=e.marker)==null?void 0:i[r])!=null&&((n=t.marker)==null?void 0:n[r])!==((a=e.marker)==null?void 0:a[r])}),"isOneOfMarkerDirtyOptions"),aI,oI,X8=class sI{constructor(e,r,i){$(this,"lines",0),$(this,"id"),$(this,"rank"),$(this,"type","label"),$(this,"initialRank"),$(this,"contextConfigured",!1),$(this,"fillText"),$(this,"newStyle",{}),$(this,"opacity",0),$(this,"visibilityNeedsUpdate",!1),$(this,"text"),$(this,"style",{top:0,left:0,textLabelVisible:!0,pinVisibility:1,textAlign:"left"}),$(this,"projection",new Jt),$(this,"labelCacheId"),$(this,"_cache",{}),$(this,"appearance"),$(this,"options"),$(this,"visible",!0),$(this,"enabled",!0),$(this,"isOccluded",!1),$(this,"offscreen",!1),$(this,"canShow",!1),$(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),$(this,"dimensions",{width:0,height:0}),$(this,"currentStrategyIndex",-1),Be(this,aI,0),$(this,"iconScale",1),Be(this,oI),$(this,"dirty",!0),$(this,"textDirty",!0),$(this,"markerDirty",!0),$(this,"attachedDirty",!0),$(this,"collisionDirty",!0),$(this,"lastTextAlign"),$(this,"imageHash"),$(this,"markerSize",0),$(this,"iconVisible",!1),$(this,"dp"),$(this,"animate",!0),$(this,"onStrategySelected",s(l=>{if(this.currentStrategyIndex===l)return;this.currentStrategyIndex=l;let u=this.strategies[this.currentStrategyIndex];if(u){u.onStrategySelected();let c=this.style;this.style=this.newStyle,this.newStyle=c}},"onStrategySelected")),$(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],shouldCollideWithScreenEdges:!1,lockedToStrategyIndex:-1});var n,a;if(this.id=(n=r.id)!=null?n:ya(),this.options=(0,hX.default)({},r,fX),this.text=e,this.dp=(l=1)=>l*i.pixelRatio,typeof r.rank=="string")this.rank=W5(r.rank),this.initialRank=this.rank;else if(r.rank!=null&&r.rank>0)this.rank=r.rank,this.initialRank=r.rank;else{let l=Math.trunc($a.env.NODE_ENV==="test"?sI.testId:sI.testId*10)/10;sI.testId+=.001,this.rank=l,this.initialRank=l}let o=(0,hX.default)({},this.options.appearance,fX.appearance);this.appearance={margin:o.margin,text:{lineHeight:o.text.lineHeight,numLines:o.text.numLines,size:o.text.size,maxWidth:o.text.maxWidth,foregroundColor:o.text.foregroundColor,backgroundColor:o.text.backgroundColor},marker:{foregroundColor:{active:o.marker.foregroundColor.active,inactive:o.marker.foregroundColor.inactive||ni(o.marker.foregroundColor.active).setAlpha(.5).toRgbString()},backgroundColor:{active:o.marker.backgroundColor.active,inactive:o.marker.backgroundColor.inactive||ni(o.marker.backgroundColor.active).setAlpha(.5).toRgbString()},icon:o.marker.icon,iconSize:o.marker.iconSize||DQe,iconPadding:(a=o.marker.iconPadding)!=null?a:OQe,iconFit:o.marker.iconFit||kQe,iconOverflow:o.marker.iconOverflow||"hidden",iconVisibleAtZoomLevel:o.marker.iconVisibleAtZoomLevel==null?NQe:o.marker.iconVisibleAtZoomLevel,iconSizeInterpolation:o.marker.iconSizeInterpolation}},this.scaledIconPadding=this.appearance.marker.iconPadding}get totalMarkerSize(){return b(this,aI)*this.iconScale}set totalMarkerSize(e){He(this,aI,e)}get scaledIconPadding(){return(b(this,oI)||this.appearance.marker.iconPadding||0)*this.iconScale}set scaledIconPadding(e){He(this,oI,e)}setEntity(){}calculateMarkerSize(){let e=this.dp();this.iconVisible&&typeof this.appearance.marker.iconSize<"u"&&this.imageHash?this.markerSize=this.dp(this.appearance.marker.iconSize):this.markerSize=this.dp(dX),this.totalMarkerSize=Math.ceil((this.markerSize+RQe)/e)}get lowPriorityStrategyIndex(){return this.text===""?-1:3}get strategies(){let{width:e,height:r}=this.dimensions,{margin:i}=this.appearance,n=Math.max(LQe,i),a=this.iconVisible?n/2:0,o=this.iconVisible?this.totalMarkerSize:dX/2,l=[{name:"RIGHT",getBoundingBox:s(()=>{let u=Math.max(this.totalMarkerSize,r);return[u/2+n,u/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+e+n]},"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.textAlign="left",this.newStyle.pinVisibility=1,this.newStyle.top=-r/2,this.newStyle.left=this.totalMarkerSize/2+pX,this.newStyle.textLabelVisible=!0},"onStrategySelected")},{name:"LEFT",getBoundingBox:s(()=>{let u=Math.max(this.totalMarkerSize,r);return[u/2+n,u/2+n,this.totalMarkerSize/2+e+n,this.totalMarkerSize/2+n]},"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.textAlign="right",this.newStyle.pinVisibility=1,this.newStyle.top=-r/2,this.newStyle.left=-e-this.totalMarkerSize/2-pX,this.newStyle.textLabelVisible=!0},"onStrategySelected")},{name:"TOP",getBoundingBox:s(()=>{let u=this.dp();return[r+this.totalMarkerSize/2/u+n,this.totalMarkerSize/2+n,e/2+n,e/2+n]},"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.pinVisibility=1,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-r-this.totalMarkerSize/2,this.newStyle.left=-e/2},"onStrategySelected")},{name:PQe,getBoundingBox:s(()=>[o+a,o+a,o+a,o+a],"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.pinVisibility=.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0},"onStrategySelected")}];return this.text===""?[{name:"ICON_ONLY",getBoundingBox:s(()=>[this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n],"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.pinVisibility=1,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0},"onStrategySelected")}]:l}recomputeCurrentStrategy(e=this.iconScale){if(this.iconScale!==e||this.dirty){let r=this.strategies[this.currentStrategyIndex];if(this.iconScale=e,this.collisionDirty=!0,r){r.onStrategySelected(e);let i=this.style;this.style=this.newStyle,this.newStyle=i}this.dirty=!1}}updatePosition(){}disable(){this.visible=!1}toPackedMessage(e=!1){var r;if(this.visible&&e&&this.collisionDirty===!1&&this.currentStrategyIndex!=null&&this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex&&this.currentStrategyIndex!==((r=this.packedMessage.bboxes[0])==null?void 0:r[4])){let i=this.packedMessage.bboxes.findIndex(n=>n[4]===this.currentStrategyIndex);if(i!==-1){let n=this.packedMessage.bboxes.splice(i,1)[0];this.packedMessage.bboxes.unshift(n)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let i=0;i<this.strategies.length;i++){let n=this.strategies[i];i===this.currentStrategyIndex&&this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex?this.packedMessage.bboxes.unshift([...n.getBoundingBox(),i]):this.packedMessage.bboxes.push([...n.getBoundingBox(),i])}return this.packedMessage.shouldCollideWithScreenEdges=!1,this.collisionDirty=!1,this.packedMessage}destroy(){}};aI=new WeakMap,oI=new WeakMap,s(X8,"LabelComponent"),$(X8,"testId",0);var zQe=X8,d_=zQe;N();N();var N5e=class extends Wa{constructor(e,r){super(),$(this,"rendererState"),$(this,"convertTo3DMapPosition"),$(this,"textSet",new Set),$(this,"batchedTextMap",new Map),$(this,"debugTextAreaMesh",new Map),this.rendererState=e,this.convertTo3DMapPosition=r}remove(e){this.textSet.delete(e)}update(e){var r,i,n;let a,o,l,u=[];for(let c of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(c),(a==null?void 0:a.type)==="text3d"){o=a.components[0],l=a.components[1];let p=(r=o.mesh)==null?void 0:r.parent;if(!p||!(p instanceof Kn)||!(o instanceof lI))continue;if("textArea"in o.feature.properties&&o.mesh!=null&&o.polygonEntityId!=null&&o.textMesh==null&&o.mesh.parent!=null&&((n=(i=o.feature.properties)==null?void 0:i.textArea)==null?void 0:n.position)!=null){if(this.textSet.has(o.polygonEntityId))continue;this.textSet.add(o.polygonEntityId),this.batchedTextMap.has(p)||this.batchedTextMap.set(p,av().then(({BatchedText:v})=>{let w=new v;return w.type="batchedtext",p.add(w),w}));let y=this.batchedTextMap.get(p);if(!y)throw new Error("batched text required");u.push(Z8({entityId:c,textComponent:o,styleComponent:l,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:y,rendererState:this.rendererState,type:"text-area"}).then(()=>{this.publish("render")}))}else if(o.mesh!=null&&o.textMesh==null&&o.mesh.parent!=null){if(this.textSet.has(c.toString()))continue;this.textSet.add(c.toString()),this.batchedTextMap.has(p)||this.batchedTextMap.set(p,av().then(({BatchedText:v})=>{let w=new v;return w.type="batchedtext",p.add(w),w}));let y=this.batchedTextMap.get(p);if(!y)throw new Error("batched text required");u.push(Z8({entityId:c,textComponent:o,styleComponent:l,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:y,rendererState:this.rendererState,type:"point"}).then(()=>{this.publish("render")}))}let m=this.batchedTextMap.get(p);o.textMesh&&m&&o.polygonEntityId!=null&&Promise.all([m,Promise.resolve({meshComponent:o,styleComponent:l})]).then(([y,{meshComponent:v,styleComponent:w}])=>{let{textMesh:E}=v;if(y&&E){let M=cj(y,E);v.visible&&!M?y.add(E):!v.visible&&M&&y.remove(E)}w.flipToFaceCamera&&this.flipIfNeeded(v,e)})}return Promise.all(u)}flipIfNeeded(e,r){let i=e.textMesh;if(!i)return!1;let n=i.rotation.z,a=NO(n+r);a>Math.PI/2&&a<3*Math.PI/2&&(i.rotation.z=NO(n+Math.PI))}showTextAreaMesh(){let e,r;for(let i of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(i),(e==null?void 0:e.type)==="text3d"&&(r=e.components[0],"textArea"in r.feature.properties)){let n=r.feature.properties.textArea;if(!n)continue;let a=new pv(n.maxWidth,n.maxHeight),o=new Pn(a,new ug({color:"pink"})),{textMesh:l}=r;if(!l)continue;let u=this.convertTo3DMapPosition(n.position,jb);o.position.copy(u),o.position.z=l.position.z-.1,o.rotation.z=l.rotation.z,N6.identity(),N6.makeRotationAxis(new qe(0,0,1),l.userData.rotationZ),jb.set(n.maxWidth/2,0,0),jb.applyMatrix4(N6),o.position.x-=jb.x,o.position.y-=jb.y,this.rendererState.entityScene.add(o),this.debugTextAreaMesh.set(i,o)}this.publish("render")}hideTextAreaMesh(){this.debugTextAreaMesh.forEach(e=>{this.rendererState.entityScene.remove(e)}),this.debugTextAreaMesh.clear(),this.publish("render")}};s(N5e,"Text3DSystem");var UQe=N5e;function F5e(t){av().then(({configureTroikaTextBuilder:e})=>{e({useWorker:t})})}s(F5e,"configureWorker");var N6=new Oi,jb=new qe,F6;async function B5e(t){let{preloadFont:e}=await av();return e(t)}s(B5e,"preloadFont");function av(){return F6||(F6=ag(()=>import("./text3d-DNZ77VLG-CUPaQbI_.js"),[]).then(t=>t)),F6}s(av,"getText3DService");async function Z8({entityId:t,textComponent:e,styleComponent:r,convertTo3DMapPosition:i,batchedMeshPromise:n,rendererState:a,type:o="text-area"}){return Promise.all([av(),Promise.resolve({entityId:t,meshComponent:e,styleComponent:r})]).then(([{createTroikaTextPoint:l,createTroikaTextArea:u},c])=>o==="text-area"?u(c.entityId,c.meshComponent,c.styleComponent,i):l(c.entityId,c.meshComponent,c.styleComponent,i)).catch(l=>{Vt.warn("Trouble creating text: ",l)}).then(l=>{if(!(l!=null&&l.text))return;let u=[Promise.resolve(l.text),n,Promise.resolve()];if(e.polygonEntityId){let c=a.geometry3DMap.get(e.polygonEntityId);if((c==null?void 0:c.type)==="geometry"){let p=c.components[0],m=c.components[1];p.textMesh=l.text,p.mesh!=null&&(l.text.position.z=m.altitude+m.height+VQe)}}else u[2]=av().then(({syncText:c})=>c(l.text));return Promise.all(u)}).then(l=>{if(!l)return;let[u,c]=l;c.add(u),e.batchedText||(e.batchedText=c)})}s(Z8,"createText");function cj(t,e){return t._members.has(e)}s(cj,"doesBatchedTextContainsText");var VQe=.5,jQe=xt.object({visible:xt.boolean(),color:xt.string(),flipToFaceCamera:xt.boolean(),font:xt.string().optional(),fontSize:xt.number(),margin:xt.union([xt.number(),xt.tuple([xt.number(),xt.number(),xt.number(),xt.number()])]),outlineColor:xt.string(),outlineOpacity:xt.number(),outlineBlur:xt.union([xt.number(),xt.string()]),outlineWidth:xt.number(),outlineOffsetX:xt.number(),outlineOffsetY:xt.number(),strokeWidth:xt.number(),maxWidth:xt.number().optional(),maxHeight:xt.number().optional(),strokeOpacity:xt.number(),strokeColor:xt.string(),fillOpacity:xt.number(),hoverColor:xt.string().optional(),id:xt.union([xt.string(),xt.number()]),type:xt.literal("text3d"),position:xt.tuple([xt.number(),xt.number(),xt.number()]),content:xt.string()}),z5e=jQe.partial().omit({id:!0,type:!0}).strict(),$Qe=z5e.omit({margin:!0,position:!0,maxWidth:!0,maxHeight:!0,content:!0}).strict(),GQe=xt.object({appearance:z5e.optional(),parentId:xt.string().optional()}).strict(),U5e=class{constructor(e){$(this,"mesh",new hx),$(this,"textMesh"),$(this,"type","text3d"),$(this,"feature"),$(this,"parent"),$(this,"batchedText"),$(this,"polygonEntityId"),this.feature=e}get visible(){return this.batchedText&&this.textMesh?cj(this.batchedText,this.textMesh):this.textMesh?this.textMesh.visible:!1}set visible(e){this.batchedText&&this.textMesh?e?this.batchedText.addText(this.textMesh):this.batchedText.removeText(this.textMesh):this.textMesh&&(this.textMesh.visible=e),this.mesh.visible=e}};s(U5e,"Text3DComponent");var lI=U5e;N();var V5e=class{constructor(e){$(this,"color"),$(this,"dirty",!0),$(this,"visible",!0),$(this,"edgeColors"),$(this,"geometry"),$(this,"ranges"),$(this,"topFaceVerticesIndices"),this.color=e}get currentOpacity(){return this.edgeColors&&this.ranges?this.edgeColors.array[3]:0}get currentColor(){return this.edgeColors&&this.ranges?[this.edgeColors.array[0],this.edgeColors.array[1],this.edgeColors.array[2]]:[0,0,0]}};s(V5e,"OutlineComponent");var j5e=V5e;N();N();N();var $5e=class extends o_{constructor(e){let r=e,i=3,n=i*4;super(new Float32Array(e*n),i,e,Dl,Lu),$(this,"_width"),$(this,"_height"),$(this,"_propertiesLength"),this._width=n,this._height=r,this._propertiesLength=i}setColor(e,r,i){let n=this.image.data,a=e*this._width;n[a]=r.r,n[a+1]=r.g,n[a+2]=r.b,n[a+3]=0,n[a+4]=i.r,n[a+5]=i.g,n[a+6]=i.b,n[a+7]=0,this.needsUpdate=!0}getColor(e){let r=this.image.data,i=e*this._width,n=new si(r[i],r[i+1],r[i+2]),a=new si(r[i+4],r[i+5],r[i+6]);return{color:n,topColor:a}}setTexture(e,r,i){let n=this.image.data,a=e*this._width;n[a+8]=r?1:0,n[a+9]=i?1:0,n[a+10]=0,n[a+11]=0,this.needsUpdate=!0}};s($5e,"BatchedPropertiesTexture");var HQe=$5e;N();var qQe=`#define LAMBERT
varying vec3 vViewPosition;
varying vec4 vPosition;
varying vec2 vUv;
varying vec4 finalPosition;
varying vec3 vWorldPosition;
varying vec3 worldNormal;
varying float vBatchId;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
	
  // To mitigate visual defects on machines such as windows and iOS
	vBatchId = getIndirectIndex(gl_DrawID) + 0.5;
	vViewPosition = - mvPosition.xyz;
	worldNormal = normal;
	vUv = uv;
	vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
}
`;N();var WQe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
uniform float uGradientEnd;
uniform float uGradientIntensity;
uniform float uMinSideAlpha;
uniform float uMaxSideAlpha;
uniform float uGradientStart;
uniform highp sampler2D uPropertiesTexture;
uniform highp sampler2D uTopTexture;
uniform highp sampler2D uTexture;
uniform float uRepeatYFactor;
uniform bool uBlendTexture;
varying float vBatchId;

varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 worldNormal;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

vec3 blendTextureColor(vec3 diffuseColor, vec4 texColor) {
	vec3 texturedColor = diffuseColor * texColor.rgb;
	return mix(diffuseColor, texturedColor, texColor.a);
}

void main() {
	#include <clipping_planes_fragment>

	// get the normalized world normal of vertex fragment
	vec3 surfaceNormal = normalize(worldNormal);

	// get angle relative to Z up
	float angle = degrees(acos(abs(dot(surfaceNormal, vec3(0.0, 0.0, 1.0)))));

	int idx = int(vBatchId) * 1;
	vec3 diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(0, idx), 0).rgb);
	bool shouldShowTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).r > 0.99;

	if(shouldShowTexture) {
		vec4 tex2d = texture2D(uTexture, vec2(vUv.x, vUv.y * uRepeatYFactor));
		diffuse = uBlendTexture ? blendTextureColor(diffuse, tex2d) : tex2d.rgb;
	}

	// if this is a fragment facing upwards, use topColor. Avoid any sort of '==' comparison, due to floating point precision issue
	if(angle < 0.02) {
		bool shouldShowTopTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).g > 0.99;

		if(shouldShowTopTexture) {
			vec4 topTex2d = texture2D(uTopTexture, vUv);
			diffuse = uBlendTexture ? blendTextureColor(diffuse, topTex2d) : topTex2d.rgb;
		} else {
			diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(1, idx), 0).rgb);
		}
	}

	vec4 diffuseColor = vec4(diffuse, opacity);

	// only for vertical surfaces
	if(angle > 89.0 && angle < 91.0) {

		// get the percentage of the z position from the ground, up
		float percentFromZeroZ = max((abs(vWorldPosition.z) - uGradientStart) / uGradientEnd, 0.0);

		// gradient based on percentage
		float alpha = smoothstep(uMinSideAlpha, uMaxSideAlpha, percentFromZeroZ);

		// mix the shadow color with the diffuse color based on the alpha and opacity
		diffuseColor = vec4(mix(diffuseColor.rgb, diffuseColor.rgb * (1.0 - uGradientIntensity), 1.0 - alpha), opacity);
	}

	ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,XQe=-.05,ZQe=1,G5e=class extends O_{constructor(e,r,i=1){super(e),$(this,"propertiesTexture"),$(this,"uniforms",{uGradientIntensity:{value:0},uGradientEnd:{value:0},uGradientStart:{value:0},uTopTexture:{value:null},uTexture:{value:null},uRepeatYFactor:{value:1},uBlendTexture:{value:!1}}),$(this,"colorSpace",nl),$(this,"showTextures",s(n=>{let a=!!this.uniforms.uTexture.value,o=!!this.uniforms.uTopTexture.value;(a||o)&&(this.propertiesTexture.setTexture(n,a,o),this.needsUpdate=!0)},"showTextures")),this.propertiesTexture=new HQe(r),this.uniforms.uRepeatYFactor.value=i,this.onBeforeCompile=n=>{let a=this.uniforms.uGradientIntensity,o=this.uniforms.uGradientEnd,l=this.uniforms.uGradientStart,u=this.uniforms.uTopTexture,c=this.uniforms.uTexture,p=this.uniforms.uRepeatYFactor,m=this.uniforms.uBlendTexture;this.uniforms=n.uniforms,n.vertexShader=qQe,n.fragmentShader=WQe,Object.assign(this.uniforms,{uGradientIntensity:a,uGradientEnd:o,uGradientStart:l,uMinSideAlpha:{value:XQe},uMaxSideAlpha:{value:ZQe},uPropertiesTexture:{value:this.propertiesTexture},uTopTexture:u,uTexture:c,uRepeatYFactor:p,uBlendTexture:m})}}get repeatYFactor(){return this.uniforms.uRepeatYFactor.value}set repeatYFactor(e){e!==this.uniforms.uRepeatYFactor.value&&(this.uniforms.uRepeatYFactor.value=e,this.needsUpdate=!0)}get texture(){return this.uniforms.uTexture.value}set texture(e){e.wrapS=Bh,e.wrapT=Bh,e.colorSpace=this.colorSpace,this.uniforms.uTexture.value=e}get topTexture(){return this.uniforms.uTopTexture.value}set topTexture(e){e.wrapS=Bh,e.wrapT=Bh,e.colorSpace=this.colorSpace,this.uniforms.uTopTexture.value=e}get blendTexture(){return this.uniforms.uBlendTexture.value}set blendTexture(e){e!==this.uniforms.uBlendTexture.value&&(this.uniforms.uBlendTexture.value=e,this.colorSpace=e?Wy:nl,this.texture&&(this.texture.colorSpace=this.colorSpace),this.topTexture&&(this.topTexture.colorSpace=this.colorSpace),this.needsUpdate=!0)}setGradientShading(e,r,i){this.uniforms.uGradientStart.value=e,this.uniforms.uGradientEnd.value=r,this.uniforms.uGradientIntensity.value=i}setColor(e,r,i){this.propertiesTexture.setColor(e,r,i)}getColor(e){return this.propertiesTexture.getColor(e)}hideTextures(e){let r=!!this.uniforms.uTexture.value,i=!!this.uniforms.uTopTexture.value;(r||i)&&(this.propertiesTexture.setTexture(e,!1,!1),this.needsUpdate=!0)}removeSideTexture(e){if(this.texture){this.texture.dispose(),this.uniforms.uTexture.value=null;let r=!!this.uniforms.uTopTexture.value;this.propertiesTexture.setTexture(e,!1,r),this.needsUpdate=!0}}removeTopTexture(e){if(this.topTexture){this.topTexture.dispose(),this.uniforms.uTopTexture.value=null;let r=!!this.uniforms.uTexture.value;this.propertiesTexture.setTexture(e,r,!1),this.needsUpdate=!0}}dispose(){super.dispose(),this.propertiesTexture.dispose()}};s(G5e,"BatchedStandardMaterial");var Y8=G5e;N();function H5e(t,e){var r,i,n;let a=0;for(let p of t)a+=((i=(r=p.components[0])==null?void 0:r.geometry)==null?void 0:i.attributes.position.count)||0;let o=new si(e.color),l;l=new Y8({color:o,side:e.side==="back"?tu:e.side==="front"?Qp:Pu,opacity:(n=e.opacity)!=null?n:1,transparent:e.opacity!==void 0?e.opacity<1:!1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1},t.length);let u=new BB(t.length,a,0,l),c;for(let p of t)c=p.components[0],!(!(c instanceof ru)||!c.geometry)&&(c.mesh=u,c.material=l,c.instanceIndex=u.addGeometry(c.geometry),u.addInstance(c.instanceIndex),u.userData.entities[c.instanceIndex]=p.id,l instanceof Y8&&l.setColor(c.instanceIndex,o,e.topColor?new si(e.topColor):o));return u.perObjectFrustumCulled=!0,u.matrixAutoUpdate=!1,u}s(H5e,"batchGeometries");function hj(t){return ni(t).darken(30).toRgbString()}s(hj,"darkenColorForOutline");function q5e(t,e,r,i){if(e.length<1)return;t.boundingBox||t.computeBoundingBox();let n=t.boundingBox,a=t.getAttribute("position"),o=t.getAttribute("normal"),l=t.getAttribute("uv"),u,c;t.index?(u=t.index.count/3,c=s(function(C,T){return t.index.getX(C*3+T)},"meshIndex")):(u=a.count/3,c=s(function(C,T){return C*3+T},"meshIndex"));let p=new Oi;p.makeRotationFromQuaternion(new ff().setFromEuler(new Nu(0,0,r/180*Math.PI)));let m=e.find(C=>C.face==="top"),y;m&&(y={min:i(m.bounds[1],m.bounds[0],0),max:i(m.bounds[3],m.bounds[2],n.max.z)});let v=e.find(C=>C.face==="side"),w;if(v&&(w={min:i(v.bounds[1],v.bounds[0],0),max:i(v.bounds[3],v.bounds[2],n.max.z)}),!(!w&&!y))for(let C=0;C<u;++C){let T=o.getX(c(C,0))+o.getX(c(C,1))+o.getX(c(C,2)),O=o.getY(c(C,0))+o.getY(c(C,1))+o.getY(c(C,2)),F=o.getZ(c(C,0))+o.getZ(c(C,1))+o.getZ(c(C,2)),k=Math.abs(T),B=Math.abs(O),U=Math.abs(F);var E,M;k<=B&&k<=U?(E="x",B<=U?M="y":M="z"):B<=k&&B<=U?(E="y",k<=U?M="x":M="z"):(E="z",k<=B?M="x":M="y"),E==="z"&&(E=M,M="z");let z,q,W,J,V,oe;if(M==="z"||E==="z"){if(!v||!w)continue;z=v.repeat.u,q=v.repeat.v,W=v.offset.u,J=v.offset.v,V=v.rotation,oe=w}else{if(!m||!y)continue;z=m.repeat.u,q=m.repeat.v,W=m.offset.u,J=m.offset.v,V=(360-r+m.rotation)%360,oe=y}let{min:Y,max:he}=oe,Q=new qa;Q.position.set(Y.x,Y.y,0),Q.updateMatrix(),Q.updateMatrixWorld();let ae=Y.clone().applyMatrix4(p),ee=he.clone().applyMatrix4(p),le=Math.abs(ee.x-ae.x),K=Math.abs(ee.y-ae.y),ce=new qe(le,K,he.z).applyMatrix4(Q.matrixWorld),te=Math.abs(ce[E]-Y[E]),ne=Math.abs(ce[M]-Y[M]),pe=V*Math.PI/180||0,xe=Math.cos(pe),Te=Math.sin(pe),fe=Q.matrixWorld.clone().invert(),Pe=new ff().setFromEuler(new Nu(0,0,r/180*Math.PI));for(let me=0;me<3;me++){let Ae=new qe(a.getX(c(C,me)),a.getY(c(C,me)),a.getZ(c(C,me))).applyMatrix4(fe);Ae.applyQuaternion(Pe);let Ue=Ae.applyMatrix4(Q.matrixWorld),_e=Ue.x,lt=Ue.y,tt=Ue.z;var I,P;E==="x"?I=z*(_e-Y[E])/te+W:E==="y"?I=z*(lt-Y[E])/te+W:I=z*(tt-Y[E])/te+W,M==="x"?P=q*(_e-Y[M])/ne+J:M==="y"?P=q*(lt-Y[M])/ne+J:P=q*(tt-Y[M])/ne+J,I-=.5,P-=.5;let We=I*xe-P*Te+.5,at=I*Te+P*xe+.5;l.setX(c(C,me),We),l.setY(c(C,me),at)}}}s(q5e,"updateUVsLegacy");N();var W5e=class{constructor(){$(this,"focusMesh"),$(this,"dirty",!0)}};s(W5e,"FocusableComponent");var X5e=W5e;function El(t,e,r){if(e!==void 0){if(t.type==="model"||t.type==="path"||t.type==="marker"||t.type==="label"||t.type==="geometry"||t.type==="group-container"||t.type==="custom-geometry")return e===!0?(t instanceof N_&&t.components[1]===void 0?(t.components[1]=new k6,t.components[1].dirty=!0):t instanceof Ua&&t.components[2]===void 0?(t.components[2]=new k6,t.components[2].dirty=!0):t instanceof Kn&&t.components[1]===void 0&&(t.components[1]=new k6,t.components[1].dirty=!0),!0):(t instanceof N_?t.components[1]=void 0:t instanceof Ua?t.components[2]=void 0:t instanceof Kn&&(t.components[1]=void 0),!0);if(t.type==="geometry-group"){let i;for(let n of t.userData.entities3D.values())i=r.geometry3DMap.get(n),El(i,e,r);return!0}}return!1}s(El,"updateInteractivity");function Z5e(t,e,r){if(!(!(r!=null&&r.color)&&!("topColor"in r))){if(r!==void 0&&t.type==="geometry-group"&&t.components[0]!=null){let i,n,a=t.components[0];for(let o of t.userData.entities3D.values())if(i=e.geometry3DMap.get(o),i){n=i.components[1],n.color===a.color&&(n.initialColor=r.color||a.color,n.color=r.color||a.color,n.dirty=!0);let l=i.components[3];l&&(l.color=hj(n.color||a.color),l.dirty=!0),n.topColor===a.topColor&&(n.topColor=r.topColor||a.topColor,n.dirty=!0)}return r.color!==void 0&&(a.color=r.color,a.dirty=!0),"topColor"in r&&(a.topColor=r.topColor,a.dirty=!0),!0}return!1}}s(Z5e,"updateGroupColor");function Y5e(t,e){if(e!==void 0&&t.type==="geometry-group"&&t.components[0]!=null){let r=t.components[0];return r.shading=r.shading||{},r.shading&&(e.start!==r.shading.start||e.end!==r.shading.end||e.intensity!==r.shading.intensity)&&(Object.assign(r.shading,e),t.userData.shadingDirty=!0),!0}return!1}s(Y5e,"updateGroupShading");function K5e(t,e){e!==void 0&&t.type==="geometry"&&(e.showImage!==void 0&&(t.components[1].showImage=e.showImage),e.flipImageToFaceCamera!==void 0&&(t.components[1].flipImageToFaceCamera=e.flipImageToFaceCamera))}s(K5e,"updateImageProps");function K8(t,e,r){if(r!==void 0){if(t.type==="geometry"){let i=t.components[1];if(i.height!==r)return i.height=r,i.dirty=!0,t.components[3]&&(t.components[3].dirty=!0),!0}else if(t.type==="geometry-group"){let i=t.components[0];for(let n of t.userData.entities3D.values()){let a=e.geometry3DMap.get(n),o;((a==null?void 0:a.type)==="geometry"||(a==null?void 0:a.type)==="model")&&(o=a.components[1],o.height===i.height&&(a.components[1].height=r,a.components[1].dirty=!0),a.components[3]&&(a.components[3].dirty=!0))}return t.components[0].height=r,!0}}return!1}s(K8,"updateHeight");function pj(t,e){if(e!==void 0){let r=!1;(t.type==="path"||t.type==="geometry")&&(e.initialColor!==void 0&&e.initialColor!==t.components[1].initialColor&&(t.components[1].initialColor=e.initialColor,r=!0),e.color!==void 0&&e.color!==t.components[1].color&&(t.components[1].color=e.color,r=!0,t.components[3]&&(t.components[3].color=e.color,t.components[3].dirty=!0)),"topColor"in e&&(t.components[1].topColor=e.topColor,r=!0),r&&(t.components[1].dirty=!0))}}s(pj,"updateColor");function J8(t,e,r){e!==void 0&&(t.type==="label"||t.type==="marker"?t.updatePosition(r(e[1],e[0],e[2]||0)):t.type==="custom-geometry"&&t.components[0].position.copy(r(e[1],e[0],e[2]||0)))}s(J8,"updatePosition");function Q8(t,e){var r;return e!==void 0&&(t.type==="marker"||t.type==="label"||t.type==="custom-geometry")&&t.parentObject3D!==e&&t.parentObject3D instanceof Kn?((r=t.parentObject3D)==null||r.removeEntity(t),e.addEntity(t),!0):!1}s(Q8,"updateParent");function J5e(t,e){e!==void 0&&(t.type==="marker"||t.type==="label")&&t.components[0].enabled!==e&&(t.components[0].enabled=e)}s(J5e,"updateEnabled");function Q5e(t,e,r){if(e!==void 0&&t.type==="marker"){let i=t.components[0];if(e.contentHTML!==void 0)return i.containerEl.innerHTML=e.contentHTML,i.contentHtml=e.contentHTML,!0;if(e.anchor!==void 0&&(i.options.anchor=e.anchor,i.collisionDirty=!0),e.dynamicResize!==void 0)return i.options.dynamicResize=e.dynamicResize,!0;if(e.options!=null){try{c5e.parse(e.options||{})}catch(n){return Vt.error(n),!1}return e.options.interactive!=null&&(e.options.interactive==="pointer-events-auto"?(i.pointerEvents="auto",El(t,!1,r)):(i.pointerEvents="none",El(t,e.options.interactive,r))),dj(t,e.options.rank),!0}}return!1}s(Q5e,"updateMarker");function dj(t,e){return e!==void 0&&(t.type==="marker"||t.type==="label")?(t.components[0].rank=W5(e),!0):!1}s(dj,"updateRank");function e4e(t,e,r){var i,n,a,o,l;if(e!==void 0&&t.type==="label"){let u=t.components[0];e.text!==void 0&&e.text!==u.text&&(u.text=e.text,u.textDirty=!0);try{O5e.parse(e.options||{})}catch(c){Vt.error(c);return}FQe(u.appearance,((i=e.options)==null?void 0:i.appearance)||{})&&(u.textDirty=!0),BQe(u.appearance,((n=e.options)==null?void 0:n.appearance)||{})&&(u.markerDirty=!0),$B(u.appearance,((a=e.options)==null?void 0:a.appearance)||{}),El(t,(o=e.options)==null?void 0:o.interactive,r),dj(t,(l=e.options)==null?void 0:l.rank)}}s(e4e,"updateLabel");function t4e(t,e){e!==void 0&&t.type==="geometry"&&(t.components[1].hoverColor=e,t.components[1].dirty=!0)}s(t4e,"updateHoverColor");function r4e(t,e){if(e!==void 0){let r=t.components[2];if(t.type==="geometry"&&r!=null)return r.hover=e,r.dirty=!0,!0}return!1}s(r4e,"updateHovered");function eN(t,e){e!==void 0&&t.type==="image"&&(t.components[1].flipImageToFaceCamera=e)}s(eN,"updateFlipImageToFaceCamera");function Cp(t,e,r){if(r!==void 0){if(t.type==="model"||t.type==="path"||t.type==="geometry"||t.type==="custom-geometry"||t.type==="image"||t.type==="text3d"){r!==t.components[1].visible&&(t.components[1].visible=r,t.components[1].dirty=!0);let i=t.components[3];i&&(i.visible=r,i.dirty=!0)}else t.type==="geometry-group"?t.setVisible(r):t.type==="group-container"?(t.setVisible(r),r===!1&&t.traverse(i=>{if(i instanceof Ow){let n=e.geometry2DMap.get(i.userData.entityId);if(n){let a=n.components[0];a instanceof d_&&(a.canShow=r)}}})):t.type==="label"&&(t.components[0].visible=r);return!0}return!1}s(Cp,"updateVisibility");function tN(t,e,r){if(r!==void 0){if(t.type==="geometry-group"){let i=t.components[0];if(i.opacity!==r){for(let n of t.userData.entities3D.values()){let a=e.geometry3DMap.get(n),o;((a==null?void 0:a.type)==="geometry"||(a==null?void 0:a.type)==="model")&&(o=a.components[1],(!o.opacity||o.opacity===i.opacity)&&(o.opacity=r,o.dirty=!0))}return t.setOpacity(r),i.opacity=r,!0}}else if(t.type==="group-container"&&t.opacity!==r){t.setOpacity(r);let i=1;return t.parent instanceof Kn&&(i=t.parent.opacity),fj(t,e,i),!0}}return!1}s(tN,"updateOpacity");function fj(t,e,r=1){if(t.type==="group-container"&&"children"in t&&t.children.length>0){let i=r*t.opacity;t.userData.computedOpacity=i;for(let n of t.children)(n instanceof Fu&&n.type==="geometry-group"||n instanceof Kn&&n.type==="group-container")&&fj(n,e,i)}else if(t.type==="geometry-group")for(let i of t.userData.entities3D.values()){let n=e.geometry3DMap.get(i),a;((n==null?void 0:n.type)==="geometry"||(n==null?void 0:n.type)==="model")&&(a=n.components[1],a.dirty=!0)}}s(fj,"cascadeOpacity");function i4e(t,e){if(e!==void 0&&t.type==="geometry-group"){let r=t.components[0];(e==null?void 0:e.texture)!=null&&r.texture!==(e==null?void 0:e.texture)&&(r.texture=e.texture,r.dirty=!0),(e==null?void 0:e.topTexture)!=null&&r.topTexture!==(e==null?void 0:e.topTexture)&&(r.topTexture=e.topTexture,r.dirty=!0)}}s(i4e,"updateGroupTexture");function n4e(t,e){if(t.type==="geometry"){let r=!1,i=t.components[1];if((e==null?void 0:e.texture)!=null&&i.texture!==(e==null?void 0:e.texture)&&(i.texture=e.texture,r=!0),(e==null?void 0:e.topTexture)!=null&&i.topTexture!==(e==null?void 0:e.topTexture)&&(i.topTexture=e.topTexture,r=!0),r&&t.components[0]instanceof ru){let n=t.components[0];return n.detached===!1&&(n.detached=!0,n.dirty=!0),t.components[1].dirty=!0,!0}}return!1}s(n4e,"updateIndividualGeometryTexture");function a4e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1];if(r.opacity!==e){r.opacity=e;let i=t.components[0],n=t.components[3];n&&(n.dirty=!0),i.detached===!1&&(i.detached=!0,i.dirty=!0),e===0?r.visible=!1:r.visible=!0,r.dirty=!0;let a=t.parentObject3D;return(a==null?void 0:a.type)==="geometry-group"&&(a.userData.shadingDirty=!0),!0}}return!1}s(a4e,"updateIndividualGeometryOpacity");function uI(t,e){if(e!==void 0){if(t.type==="path"||t.type==="geometry"||t.type==="custom-geometry")t.components[1].altitude=e,t.components[1].dirty=!0;else if(t.type==="group-container"&&t.altitude!==e||t.type==="geometry-group")return t.setAltitude(e),!0}return!1}s(uI,"updateAltitude");function jT(t,e,r){if(r!==void 0){if(t.type==="geometry-group"&&t.components[0]!=null)for(let i of t.userData.entities3D.values()){let n=e.geometry3DMap.get(i);n instanceof Ua&&jT(n,e,r)}else if(t.type==="geometry"){let i=t.components[3],n=t.components[1];!i&&r===!0?t.components[3]=new j5e(n.color):i&&(i.visible=r,i.dirty=!0)}return!0}return!1}s(jT,"updateOutline");function rN(t,e){if(e!==void 0){if(t.type==="geometry"){let r=t.components[0];if(t.type==="geometry"&&r&&r instanceof ru&&r.focusable!==e)return r.focusable=e,!0}else if(t.type==="group-container"){let r=t.components[2]!==void 0;if(e===!0&&!r)return t.components[2]=new X5e,!0;if(e===!1&&r)return t.components[2]=void 0,!0}}return!1}s(rN,"updateFocusable");function o4e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1];if(r.renderOrder!==e){r.renderOrder=e;let i=t.components[0];return i.detached===!1&&(i.detached=!0,i.dirty=!0),i.imageMesh&&(i.imageMesh.renderOrder=e+1),r.dirty=!0,!0}}return!1}s(o4e,"updateIndividualGeometryRenderOrder");function s4e(t,e,r){let{visible:i,color:n}=r;if(t.type!=="path")return;let a=t.components[0];i!=null&&Cp(t,e,i),n!=null&&pj(t,{color:n}),Object.assign(a,mj(r)),_ge(r)||(a.materialDirty=!0,(r.nearRadius!=null||r.farRadius!=null)&&(a.dirty=!0),(r.nearZoomLevel!=null||r.farZoomLevel!=null)&&(a.dirty=!0))}s(s4e,"handlePathUpdate");function mj(t){return Zc(t,YQe)}s(mj,"pickPathOptions");var YQe=["animateArrowsOnPath","displayArrowsOnPath","nearRadius","farRadius","accentColor","completeFraction","nearZoomLevel","farZoomLevel","dashed","visibleThroughGeometry"];function l4e(t){if(!(t instanceof Ua&&t.type==="text3d"))throw new Error("expect target is TextGeometry3D")}s(l4e,"assetGeometryIsText3D");var u4e=["visible","color","strokeWidth","outlineOffsetX","outlineOffsetY","outlineWidth","outlineBlur","outlineOpacity","outlineColor","strokeWidth","strokeColor","strokeOpacity","maxWidth","maxHeight","font","hoverColor","fillOpacity","fontSize","flipToFaceCamera"];function c4e(t,e,r){Cp(t,e,r.visible);let i=t.components[1],n=Zc(r,u4e);"margin"in r&&Vt.warn("update to margin is not supported atm"),"content"in r&&Vt.warn("content update is not supported atm");try{$Qe.parse(n)}catch(a){Vt.error(a);return}Object.keys(n).length>0&&(Object.assign(i,n),i.dirty=!0)}s(c4e,"handleText3DUpdate");var KQe=["color","material","opacity","verticalOffset","rotation","position","scale"];function h4e(t,e){let r=Zc(e,KQe),i=t.components[1],n=t.components[0];Object.keys(r).length>0&&(r.material&&(i.material=r.material),r.opacity!=null&&(i.opacity=r.opacity,r.opacity===0?i.visible=!1:i.visible=!0,i.dirty=!0),r.verticalOffset!=null&&(i.verticalOffset=r.verticalOffset),r.color!=null&&(i.color=r.color),r.position!=null&&(n.feature.geometry.coordinates=r.position,n.positionDirty=!0),r.rotation!=null&&(i.rotation=r.rotation),r.scale!=null&&(i.scale=r.scale),i.dirty=!0)}s(h4e,"handleModelStyleUpdate");var G1,ef,iN,O2,p4e,cI,nN,d4e,f4e,hI,aN,pI,$T,oN,m4e=class{constructor(e){Be(this,O2),Be(this,G1,null),Be(this,ef),$(this,"getCurrentSceneGLTF",s(async r=>{let i=Ee({onlyVisible:!0,binary:!0,light:!0,scale:1},r),n=await dr(this,O2,p4e).call(this),a=b(this,iN).call(this,i),o=await n.parseAsync(a,{trs:!1,maxTextureSize:1/0,onlyVisible:i.onlyVisible,binary:i.binary,scale:i.scale}),l;if(o instanceof ArrayBuffer)l=new Blob([o],{type:"application/octet-stream"});else{let u=JSON.stringify(o,null,2);l=new Blob([u],{type:"text/plain"})}return l},"getCurrentSceneGLTF")),Be(this,iN,s(r=>{let{scale:i,light:n,onlyVisible:a}=r,o=new bB,l=new ro().setFromObject(b(this,ef).entityScene);if(b(this,cI).call(this,b(this,ef).entityScene,o,a),n){let u=new Ade(16777215,.3*Math.PI);u.position.set(0,Math.max(l.max.x,l.max.y)*i*.5,l.max.y*i*4),u.lookAt(0,0,-1),u.target.position.set(0,0,-1),u.add(u.target),o.add(u)}return o},"#getExportedScene")),Be(this,cI,s((r,i,n)=>{r.material&&(r instanceof wB?dr(this,O2,d4e).call(this,r).forEach(a=>i.add(a)):r instanceof NP&&i.add(dr(this,O2,f4e).call(this,r))),r.children.forEach(a=>{(!n||a.visible)&&b(this,cI).call(this,a,i,n)})},"#processObject3D")),Be(this,nN,s((r,i,n)=>{let a=new Bpe({color:new si(r),metalness:0});return a.opacity=i,a.transparent=n,a},"#createStandardMaterial")),Be(this,hI,s(r=>{let{geometry:i,material:n,position:a,rotation:o,quaternion:l,scale:u}=r;if(!(i!=null&&i.isBufferGeometry))return r;let c=i.attributes.position,p=i.attributes.normal,m=i.attributes.uv;return b(this,aN).call(this,c,p),b(this,$T).call(this,a,u,o,l),m&&b(this,oN).call(this,m),n!=null&&n.map&&i.type==="PlaneGeometry"&&(r.side=Pu),r},"#convertGeometry")),Be(this,aN,s((r,i)=>{let n=new qe,a=new qe;for(let o=0;o<r.count;o++)n.fromBufferAttribute(r,o),b(this,pI).call(this,n),r.setXYZ(o,n.x,n.y,n.z),i&&(a.fromBufferAttribute(i,o),b(this,pI).call(this,a),i.setXYZ(o,a.x,a.y,a.z))},"#convertAttributes")),Be(this,pI,s(r=>{let i=r.y;r.y=r.z,r.z=-i},"#convertVector")),Be(this,$T,s((r,i,n,a)=>{let o=r.y;r.y=r.z,r.z=-o;let l=i.y;if(i.y=i.z,i.z=l,n instanceof Nu)n.order="YXZ",n.set(n.x,n.y,n.z,n.order);else{let u=a.y;a.set(a.x,a.z,-u,a.w)}},"#convertObjectProperties")),Be(this,oN,s(r=>{for(let i=0;i<r.count;i++){let n=r.getX(i),a=r.getY(i);r.setXY(i,n,a)}},"#convertUVs")),He(this,ef,e),b(this,ef).entityScene=e.entityScene,b(this,ef).geometry3DMap=e.geometry3DMap}destroy(){He(this,G1,null)}};G1=new WeakMap,ef=new WeakMap,iN=new WeakMap,O2=new WeakSet,p4e=s(async function(){if(!b(this,G1)){let{GLTFExporter:t}=await ag(()=>import("./GLTFExporter-U7TU265Z-S5JV_4lr.js"),[]);He(this,G1,new t)}return b(this,G1)},"#getGLTFExporter"),cI=new WeakMap,nN=new WeakMap,d4e=s(function(t){var e,r;let i=[],n=((e=t.userData)!=null&&e.entities?Object.values((r=t.userData)==null?void 0:r.entities):[]).map(o=>b(this,ef).geometry3DMap.get(o)),a=new Map;return n.forEach(o=>{var l;if(!o||!(o instanceof Ua))return;let u=o.components[1],c=o.components[2];if(!u.visible||u instanceof c_&&u.opacity===0||u instanceof jO||u instanceof Pge)return;let p=c!=null&&c.hover?u.hoverColor||b(this,ef).hoverColor:u.color,m="".concat(p,"-").concat(u.opacity,"-").concat(Number(u.visible));a.has(m)||a.set(m,[]),(l=a.get(m))==null||l.push(o)}),a.forEach((o,l)=>{let[u,c,p]=l.split("-"),m=o.reduce((E,M)=>{if(M.type==="custom-geometry")return E;let I=M.components[0];return"geometry"in I&&I.geometry instanceof js&&E.push(I.geometry),E},[]),y=b(this,nN).call(this,u,Number(c),t.material.transparent),v=fv(m,!0),w=new Pn(v,y);w.position.copy(t.position),w.rotation.copy(t.rotation),w.scale.copy(t.scale),w.visible=!!p,b(this,$T).call(this,w.position,w.scale,w.rotation,w.quaternion),i.push(b(this,hI).call(this,w))}),i},"#processBatchedMesh"),f4e=s(function(t){let e=t.geometry.clone(),r=t.material,i=new ug({color:r.color,side:Pu});i.opacity=r.opacity,i.transparent=r.transparent;let n=new NP(e,i);return n.position.copy(t.position),n.rotation.copy(t.rotation),n.scale.copy(t.scale),n.visible=t.visible,b(this,hI).call(this,n)},"#processLineSegments"),hI=new WeakMap,aN=new WeakMap,pI=new WeakMap,$T=new WeakMap,oN=new WeakMap,s(m4e,"ExporterSystem");var JQe=m4e;N();N();N();var g4e=kr(yWe());function gj(t){this.name="JSClipperError",this.message=t,this.stack=new Error().stack}s(gj,"JSClipperError");gj.prototype=Error.prototype;g4e.default.Error=function(t){throw new gj(t)};var Pl=g4e.default,QQe="gray",eet=.1,$b=100,B6=new Pl.ClipperOffset;function y4e(t,e){B6.Clear(),e/=2;let r=t.map(n=>({X:n.x*$b,Y:n.y*$b}));B6.AddPath(r,Pl.JoinType.jtMiter,Pl.EndType.etClosedPolygon);let i=new Pl.Paths;return B6.Execute(i,e*$b),i.length?i.map(n=>n.map(a=>({x:a.X/$b,y:a.Y/$b}))):[t]}s(y4e,"offset");function yj(t,e,r){var i,n,a,o,l;let{color:u=QQe,opacity:c=1,altitude:p=0,height:m=eet}=r||{};Array.isArray(c)&&(c=1);let y={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},v=t.geometry.coordinates[0].map(M=>{let I=e(M[1],M[0]);return y.min.x=Math.min(y.min.x,I.x),y.min.y=Math.min(y.min.y,I.y),y.max.x=Math.max(y.max.x,I.x),y.max.y=Math.max(y.max.y,I.y),I});((n=(i=t.properties)==null?void 0:i.style)==null?void 0:n.edgeOffset)!=null&&t.properties.style.edgeOffset!==0||((a=t.properties)==null?void 0:a.image)!=null?v=y4e(v,((l=(o=t.properties)==null?void 0:o.style)==null?void 0:l.edgeOffset)||0):v=[v];let w=[];for(let M of v){let I=new sx;I.moveTo(M[0].x,M[0].y),M.slice(1).forEach(O=>I.lineTo(O.x,O.y)),I.lineTo(M[0].x,M[0].y);let P=t.geometry.coordinates.slice(1);I.holes=P.map(O=>{let F=O.map(B=>e(B[1],B[0])),k=new P_;return k.moveTo(F[0].x,F[0].y),F.slice(1).forEach(B=>k.lineTo(B.x,B.y)),k.lineTo(F[0].x,F[0].y),k});let C={bevelEnabled:!1,depth:m},T=new NA(I,C);T.userData={style:{color:u,opacity:c}},w.push(T)}if(w.length===1)return w[0];let E=fv(w);return E.userData={style:{color:u,opacity:c},_split:!0},E}s(yj,"renderPolygonGeometry");N();var tet="gray",ret=.1;function vj(t,e,r){let{color:i=tet,opacity:n=1,altitude:a=0,height:o=ret}=r||{};Array.isArray(n)&&(n=1);let l={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},u={bevelEnabled:!1,depth:o},c=[];t.geometry.coordinates.forEach(m=>{let y=new sx,v=m[0].map(M=>{let I=e(M[1],M[0]);return l.min.x=Math.min(l.min.x,I.x),l.min.y=Math.min(l.min.y,I.y),l.max.x=Math.max(l.max.x,I.x),l.max.y=Math.max(l.max.y,I.y),I});y.moveTo(v[0].x,v[0].y),v.slice(1).forEach(M=>y.lineTo(M.x,M.y)),y.lineTo(v[0].x,v[0].y);let w=m.slice(1);y.holes=w.map(M=>{let I=M.map(C=>e(C[1],C[0])),P=new P_;return P.moveTo(I[0].x,I[0].y),I.slice(1).forEach(C=>P.lineTo(C.x,C.y)),P.lineTo(I[0].x,I[0].y),P});let E=new NA(y,u);c.push(E)});let p=fv(c);return p.translate(0,0,a||0),p.userData={style:{color:i,opacity:n}},p}s(vj,"renderMultiPolygonGeometry");N();var iet="gray",z6=new Pl.ClipperOffset,ql=100;function v4e(t,e,r){let{color:i=iet,opacity:n=1,width:a=1,join:o="round",cap:l="round",height:u=.01,altitude:c=0}=r||{};Array.isArray(n)&&(n=0);let p=[];for(let E=0;E<t.geometry.coordinates.length-1;E++){let M=e(t.geometry.coordinates[E][1],t.geometry.coordinates[E][0]),I=e(t.geometry.coordinates[E+1][1],t.geometry.coordinates[E+1][0]);p.push([M,I])}z6.AddPaths(p.map(E=>E.map(M=>({X:M.x*ql,Y:M.y*ql}))),o==="round"?Pl.JoinType.jsRound:o==="miter"?Pl.JoinType.jsMiter:Pl.JoinType.jsSquare,l==="round"?Pl.EndType.etOpenRound:l==="butt"?Pl.EndType.etOpenButt:Pl.EndType.etOpenSquare);let m=new Pl.PolyTree;z6.Execute(m,a/2*ql);let y=[],v={bevelEnabled:!1,depth:u};for(let E of m.m_AllPolys){let M=new sx;if(E.IsHole())continue;let I=E.m_polygon;M.moveTo(I[0].X/ql,I[0].Y/ql),I.slice(1).forEach(P=>M.lineTo(P.X/ql,P.Y/ql)),M.lineTo(I[0].X/ql,I[0].Y/ql),M.holes=E.m_Childs.map(P=>{let C=new P_,T=P.m_polygon;return C.moveTo(T[0].X/ql,T[0].Y/ql),T.slice(1).forEach(O=>C.lineTo(O.X/ql,O.Y/ql)),C.lineTo(T[0].X/ql,T[0].Y/ql),C}),y.push(new NA(M,v))}let w=fv(y);return w.translate(0,0,c||0),w.userData={style:{color:i,opacity:n}},z6.Clear(),w}s(v4e,"renderLineStringGeometry");N();var Wl=100,net=.22,aet=.01;function _4e(t,e,r={}){let{width:i=net,height:n=aet,color:a="gray",opacity:o=1,altitude:l=0}=r,u={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},c={bevelEnabled:!1,depth:n},p=new Pl.ClipperOffset,m=t.geometry.coordinates.map(E=>E.map(M=>e(M[1],M[0])));p.AddPaths(m.map(E=>E.map(M=>({X:M.x*Wl,Y:M.y*Wl}))),Pl.JoinType.jsMiter,Pl.EndType.etOpenRound);let y=new Pl.PolyTree;p.Execute(y,i/2*Wl);let v=[];for(let E of y.m_AllPolys){let M=new sx;if(E.IsHole())continue;u.min.x=Math.min(u.min.x,E.m_polygon[0].X),u.min.y=Math.min(u.min.y,E.m_polygon[0].Y),u.max.x=Math.max(u.max.x,E.m_polygon[0].X),u.max.y=Math.max(u.max.y,E.m_polygon[0].Y);let I=E.m_polygon;M.moveTo(I[0].X/Wl,I[0].Y/Wl),I.slice(1).forEach(P=>M.lineTo(P.X/Wl,P.Y/Wl)),M.lineTo(I[0].X/Wl,I[0].Y/Wl),M.holes=E.m_Childs.map(P=>{let C=new P_,T=P.m_polygon;return C.moveTo(T[0].X/Wl,T[0].Y/Wl),T.slice(1).forEach(O=>C.lineTo(O.X/Wl,O.Y/Wl)),C.lineTo(T[0].X/Wl,T[0].Y/Wl),C}),v.push(new NA(M,c))}let w=fv(v);return w.translate(0,0,l||0),w.userData={style:{color:a,opacity:o}},p.Clear(),w}s(_4e,"renderMultiLineStringGeometry");N();N();var _j=xt.object({type:xt.enum(["Point"]),coordinates:xt.array(xt.number()).min(2).max(3)}),oet=xt.object({rotation:xt.array(xt.number()).length(3).optional(),altitude:xt.number().optional(),scale:xt.array(xt.number()).length(3).optional(),interactive:xt.boolean().optional(),verticalOffset:xt.number().optional(),id:xt.union([xt.number(),xt.string()]).optional()}),set=xt.object({type:xt.enum(["Feature"]),geometry:_j,properties:oet}),uet=xt.object({type:xt.enum(["FeatureCollection"]),features:xt.array(set)}),cet=xt.object({color:xt.string()}),het=xt.object({url:xt.string(),color:xt.string().optional(),opacity:xt.number().optional(),material:xt.record(xt.string(),cet).optional()});function x4e(t,e,r){xt.union([xt.number(),xt.string()]).parse(t),uet.parse(e),het.parse(r)}s(x4e,"validateModelGroup");var dI,fI,b4e=class{constructor(e){$(this,"mesh"),$(this,"type","model"),$(this,"positionDirty",!0),$(this,"outline"),$(this,"geometry"),$(this,"material"),$(this,"feature"),$(this,"instanceIndex",-1),$(this,"visible",!0),$(this,"color",new si),$(this,"position",new qe),Be(this,dI,0),Be(this,fI,1),this.feature=e}setOpacity(){}setColor(){}get altitude(){return b(this,dI)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,dI,e))}getRotation(){return this.mesh?[this.mesh.rotation.x,this.mesh.rotation.y,this.mesh.rotation.z]:void 0}setRotation(e){this.mesh&&this.mesh.rotation.set(Gn.degToRad(e[0]),Gn.degToRad(e[1]),Gn.degToRad(e[2]))}getScale(){return this.mesh?[this.mesh.scale.x,this.mesh.scale.y,this.mesh.scale.z]:void 0}setScale(e){this.mesh&&this.mesh.scale.set(e[0],e[1],e[2])}get opacity(){return b(this,fI)}set opacity(e){var r,i,n;if(this.mesh){if(this.mesh.children[0]instanceof j3){for(let a of this.mesh.children)if(a instanceof j3){((r=a.userData)==null?void 0:r.originalOpacity)===void 0&&(a.userData.originalOpacity=a.material.opacity);let o=Yy(e,0,(i=a.userData)==null?void 0:i.originalOpacity,0,1);a.material.opacity=o,a.material.transparent=o<1,a.material.needsUpdate=!0}}else(n=this.mesh)==null||n.traverse(a=>{a instanceof Pn&&a.material&&(Array.isArray(a.material)?a.material.forEach(o=>{sN(o,e)}):sN(a.material,e))});He(this,fI,e)}}};dI=new WeakMap,fI=new WeakMap,s(b4e,"ModelComponent");var mI=b4e;function sN(t,e){t.opacity!==e&&(e===1?(t.opacity=1,t.transparent=!1):(t.opacity=e,t.transparent=!0),t.needsUpdate=!0)}s(sN,"updateMaterialOpacity");N();function xj(t){var e,r;let i=t.components[0],n=t.components[1];n.opacity!=null&&n.opacity!==i.opacity&&(i.opacity=n.opacity);let a=n.material,o=n.color;if(a||o){let c=w4e(o,a);(e=i.mesh)==null||e.traverse(p=>{p instanceof Pn&&p.material&&(Array.isArray(p.material)?p.material.forEach(m=>{c[m.name]?m.color.set(c[m.name].color):m.color.set(o)}):c[p.material.name]?p.material.color.set(c[p.material.name].color):p.material.color.set(o))})}let l=(r=i.feature.geometry.coordinates[2])!=null?r:0,u=n.verticalOffset+l;i.altitude!==u&&(i.altitude=u),n.visible!==i.visible&&(i.visible=n.visible),n.rotation&&i.setRotation(n.rotation),n.scale&&i.setScale(n.scale)}s(xj,"applyModelGeometryStyle");function w4e(t,e){let r={};if(t&&Object.assign(r,{Default:{color:t},Fabric:{color:t},Mpdn_Logo:{color:t},CouchLogo:{color:t}}),e)for(let i in e)e[i].color&&(r[i]?r[i].color=e[i].color:r[i]={color:e[i].color});return r}s(w4e,"consolidateColorAndMaterial");function A4e(t,e){var r,i;let n=t.components[0],a=(r=t.components[1].verticalOffset)!=null?r:0,o=n.feature.geometry.coordinates.slice();o[2]=((i=o[2])!=null?i:0)+a,n.mesh?n.mesh.position.copy(e(o)):n.position.copy(e(o))}s(A4e,"applyModelPosition");function S4e(t){let{color:e,opacity:r,topColor:i,texture:n,topTexture:a}=t;return"".concat(e).concat(r).concat(i||"").concat(n||"").concat(a||"")}s(S4e,"generateIndex");var pet=1e4,M4e=class extends Wa{constructor(e,r){super(),$(this,"state"),$(this,"convertTo3DMapPosition"),$(this,"loader"),$(this,"optimizePromise",[]),this.state=e,this.convertTo3DMapPosition=r}async getGLTFLoader(){if(this.loader)return this.loader;let{GLTFLoader:e}=await ag(()=>import("./GLTFLoader-6MJPEGD7-Dp3SSnca.js"),[]);return this.loader=new e,this.loader}createEntityFromFeature(e,r,i){var n,a;let o=new ru(r),l=new Ua(o,new c_(vt(Ee({},i),{url:(a=(n=r.properties)==null?void 0:n.image)==null?void 0:a.path})));return i!=null&&i.outline&&(l.components[3]=new j5e(hj(i.color))),l.id=e,l}createModelFromFeature(e,r,i){let n=new mI(r),a=Ee({},i);r.properties.verticalOffset!=null&&(a.verticalOffset=r.properties.verticalOffset),r.properties.rotation!=null&&(a.rotation=r.properties.rotation),r.properties.scale!=null&&(a.scale=r.properties.scale);let o=new Pge(a),l=new Ua(n,o);return l.id=e,l}populateEntityMesh(e,r){let i=e.components[0];i.geometry=r,i.currentHeight=e.components[1].height,i.dirty=!1}async populateModelGroup(e,r,i){let n=new Oi,a=new Nu,o=new ff,l=new qe,u=new hx,c=await this.getGLTFLoader(),p=new Promise(m=>{c.load(r,y=>{"entities3D"in i.userData&&(i.userData.entities3D.size>1?y.scene.traverse(v=>{let w=v;if("isMesh"in w&&w.isMesh===!0){let E=new j3(w.geometry,w.material,e.size);E.userData={entities:{}},u.add(E),i.add(u)}}):(y.scene.traverse(v=>{"isMesh"in v&&v.isMesh===!0&&(v.position.set(0,0,0),v.rotation.set(0,0,0),v.scale.set(1,1,1),v.updateMatrix())}),u.add(y.scene),i.add(u),u.userData.isSingleModel=!0,u.userData.entityId=e.values().next().value,u.userData.type="model")),m()})});return this.optimizePromise.push(p.then(()=>{var m,y,v,w,E,M,I,P,C,T,O,F;let k=0,B;for(let U of e.values()){if(B=this.state.geometry3DMap.get(U),!B||(B==null?void 0:B.type)!=="model")continue;let z=B.components[0],q=B.components[1],W=B.components[0].feature;z.mesh=u,z.instanceIndex=k,xj(B),B.components[1].dirty=!1;let{x:J,y:V}=this.convertTo3DMapPosition(W.geometry.coordinates[1],W.geometry.coordinates[0],0);z.position.set(J,V,z.altitude),a.set(Gn.degToRad((y=(m=q.rotation)==null?void 0:m[0])!=null?y:pC[0]),Gn.degToRad((w=(v=q.rotation)==null?void 0:v[1])!=null?w:pC[1]),Gn.degToRad((M=(E=q.rotation)==null?void 0:E[2])!=null?M:pC[2])),l.set((P=(I=q.scale)==null?void 0:I[0])!=null?P:hC[0],(T=(C=q.scale)==null?void 0:C[1])!=null?T:hC[1],(F=(O=q.scale)==null?void 0:O[2])!=null?F:hC[2]),o.setFromEuler(a),n.compose(z.position,o,l),u.children.forEach(oe=>{!B||(B==null?void 0:B.type)!=="model"||!(oe instanceof j3)||(oe.setMatrixAt(k,n),oe.userData.entities[k]=B.id)}),z.mesh.userData.isSingleModel&&(z.mesh.matrix.copy(n),z.mesh.matrix.decompose(z.mesh.position,z.mesh.quaternion,z.mesh.scale)),k++}this.publish("model-loaded")})),u}populateEntityGroup(e){var r;let i,n,a,o;for(let l of e.values())o=this.state.geometry3DMap.get(l),o.components[0]instanceof ru&&(n=o.components[0].feature,a=o.components[1],n.geometry.type==="Polygon"?(i=yj(n,this.convertTo3DMapPosition,a),(r=n.properties)!=null&&r.textures&&n.properties.textures.length>0&&q5e(i,n.properties.textures,this.state.naturalBearing,this.convertTo3DMapPosition),this.populateEntityMesh(o,i)):n.geometry.type==="MultiPolygon"?(i=vj(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,i)):n.geometry.type==="LineString"?(i=v4e(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,i)):n.geometry.type==="MultiLineString"&&(i=_4e(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,i)));return e}optimize(e){var r;if((e.visible||e.userData.preloadGeometry)&&(e instanceof Fu||e instanceof Kn)){for(let a of e.children)this.optimize(a);if(e instanceof Kn||e.userData.dirty===!1)return;let i={};if(!e.userData.modelURL&&e.userData.dirty)try{this.populateEntityGroup(e.userData.entities3D)}catch(a){Vt.warn(a)}else e.userData.modelURL&&e.userData.dirty&&(this.populateModelGroup(e.userData.entities3D,e.userData.modelURL,e),e.userData.dirty=!1);let n=0;if(e.userData.dirty){let a=0,o;for(let l of e.userData.entities3D.values()){o=this.state.geometry3DMap.get(l);let u=o==null?void 0:o.components[0];if((o==null?void 0:o.type)==="geometry"){let c=o.components[1];a++,a>=pet&&(a=0,n++);let p=S4e(c)+n;i[p]===void 0&&(i[p]={style:c,entities:[]}),i[p].entities.push(o)}else u&&"mesh"in u&&u.mesh&&((r=u.mesh)==null?void 0:r.parent)!==e&&e.add(u.mesh)}for(let l in i){let u=H5e(i[l].entities,i[l].style);e.add(u),e.userData.dirty=!1}for(let l of e.userData.entities3D.values())if(o=this.state.geometry3DMap.get(l),o!=null&&o.entities2D.size>0)for(let u of o.entities2D.values())u&&(o.attach(u),this.publish("geometry-2d-added"))}}}update(){return this.optimizePromise=[],this.optimize(this.state.entityScene),this.optimizePromise.length>0?Promise.all(this.optimizePromise):void 0}};s(M4e,"MeshCreationAndOptimizationSystem");var det=M4e;N();var E4e=class{constructor(e,r){$(this,"state"),$(this,"dirty",!0),$(this,"domTree"),this.state=e,this.domTree=r}update(){if(this.dirty){let e;for(let r of Array.from(this.domTree.children))if(e=this.state.geometry2DMap.get(r.userData.entityId),e){let i=e.components[0];(!i.enabled||!i.visible||!this.state.geometry2DIdsInScene.has(r.userData.entityId))&&this.domTree.removeChild(r)}else this.domTree.removeChild(r);for(let r of this.state.geometry2DIdsInScene)if(e=this.state.geometry2DMap.get(r),e){let i=e.components[0];i instanceof dw&&i.enabled&&i.markerContainer&&!this.domTree.contains(i.markerContainer)&&(i.markerContainer.userData={entityId:e.id},this.domTree.appendChild(i.markerContainer),i.updateDimensions())}this.dirty=!1}}};s(E4e,"DOMVisibilitySystem");var fet=E4e;N();var C4e=class{constructor(e,r){$(this,"state"),$(this,"project"),this.state=e,this.project=r}update(){let e,r=0,i,n;for(let a of this.state.geometry2DIdsInScene)if(e=this.state.geometry2DMap.get(a),e){n=e.components[0];let o=e.attachedTo?this.state.geometry3DMap.get(e.attachedTo):void 0;if(o instanceof Ua)if(this.state.geometry3DIdsInScene.has(o.id)){i=o.components[1],n=e.components[0],(i.dirty||e.components[0].attachedDirty)&&(r=i.height,e.setAltitude(r));let l=i.visible&&i.opacity>0;n.visible!==l&&(n.visible=l)}else n.visible===!0&&(n.visible=!1);this.project(e.components[0].projection,e.position),e.components[0].attachedDirty=!1}}};s(C4e,"TwoDProjectionSystem");var met=C4e;N();N();var get=s(function(){let t,e;return r=>{if((!e||!e)&&(t=document.createElement("canvas"),t.width=500*r,t.height=500*r,t.style.width="500px",t.style.height="500px",e=t.getContext("2d")),!e)throw new Error("Could not get 2D context");return{measureCanvas:t,measureCanvasContext:e}}},"createMeasureCanvasContext")(),yet=s(({text:t,size:e,maxWidth:r,pixelRatio:i,maxLines:n=2,lineHeight:a=1.2,options:o={strokeText:!0}})=>{let l="bold ".concat(e*i,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),{measureCanvasContext:u}=get(i);u.font=l;let c=[],p=t.split(" "),m=0,y=0,v=0;for(;y<p.length;){let M=p[y];if(m===n&&m>0){c[m-1]+="...";break}if(c[m]==null&&(c[m]=M,y++),p.length===1){c[m]=M;break}if(p[y]==null)break;let{width:I}=u.measureText(c[m]+" "+p[y]);I<=r*i?(c[m]+=" "+p[y],y++):m++}c.forEach(M=>{let{width:I}=u.measureText(M);v=Math.max(I,v)});let w=e*i*a,E=c.length*w;return{maxWidth:v,maxHeight:E,lines:c.length,draw:s((M,I,P)=>{c.length===1?(o.strokeText&&M.strokeText(c[0],I,P),M.fillText(c[0],I,P)):(o.strokeText&&(M.strokeText(c[0],I,P-w/2),M.strokeText(c[1],I,P+w/2)),M.fillText(c[0],I,P-w/2),M.fillText(c[1],I,P+w/2))},"draw")}},"shaveText");N();function I4e(t){let e=new Image;return t&&(/<svg[\s\S]*>/i.test(t)?e.src="data:image/svg+xml;base64,".concat(btoa(t)):e.src=t),e}s(I4e,"createImage");var vet=3.5,_et=2.5,xet=2,bet=5,Gb=2.5,T4e=class extends Wa{constructor(e,r,i){super(),$(this,"dirty",!1),$(this,"state"),$(this,"colliderContext"),$(this,"colliderCanvas"),$(this,"transformRequestFunc"),$(this,"transformRequest",s(async n=>this.transformRequestFunc?await this.transformRequestFunc(n):{url:n},"transformRequest")),$(this,"pinCache",{}),$(this,"imageCache",{}),$(this,"imagePromiseCache",{}),$(this,"imageDimensionsCache",{}),$(this,"textCache",{}),$(this,"update",s(n=>{let a=this.state.pixelRatio;this.colliderContext.clearRect(0,0,this.colliderCanvas.width,this.colliderCanvas.height);let o,l,u,c,p,m,y;for(let v of this.state.geometry2DIdsInScene)if(y=this.state.geometry2DMap.get(v),y!=null&&(m=y.components[0],m instanceof d_&&!y.disposed)){if(p=m.appearance.marker.iconVisibleAtZoomLevel,m.appearance.marker.icon!=null&&p&&n>=p!==m.iconVisible&&(m.iconVisible=n>=p,m.dirty=!0),(m.dirty||this.dirty)&&m.calculateMarkerSize(),l=m.appearance.marker.foregroundColor,u=m.appearance.marker.backgroundColor,c=UA(m.markerSize,2),o="".concat(l.active,"-").concat(l.inactive,"-").concat(u.active,"-").concat(u.inactive,"-").concat(c,"-").concat(m.iconVisible),m.labelCacheId=o,(!this.pinCache[o]||this.dirty)&&(this.prepare(m,o,this.colliderContext),m.dirty=!0),(m.appearance.marker.icon&&(!m.imageHash||m.markerDirty)||this.dirty)&&this.cacheImage(m),this.textCache[m.id]==null||m.textDirty||this.dirty){m.dirty=!0,this.textCache[m.id]={};let{textDrawFn:E,width:M,height:I}=this.processText(m.text,m.appearance.text.size,m.appearance.text.maxWidth,m.appearance.text.numLines,m.appearance.text.lineHeight);["left","center","right"].forEach(P=>{this.textCache[m.id][P]=this.textToCanvas(E,m.appearance.text.size,P,M,I,m.appearance.text.foregroundColor,m.appearance.text.backgroundColor)}),m.dimensions={width:Math.ceil(M/a),height:Math.ceil(I/a)}}let w=1;if(m.appearance.marker.iconSizeInterpolation&&m.appearance.marker.iconSize){let{minZoomLevel:E,maxZoomLevel:M,minScale:I,maxScale:P}=m.appearance.marker.iconSizeInterpolation;w=Yy(n,E,M,I,P)}m.recomputeCurrentStrategy(m.iconVisible?w:1),m.canShow&&m.visible&&(m.enabled||m.visibilityNeedsUpdate!==!1)&&this.draw(m,o,this.colliderContext),m.textDirty=!1,m.markerDirty=!1}this.dirty=!1},"update")),$(this,"processText",s((n,a,o,l,u)=>{let c=this.state.pixelRatio,{draw:p,maxWidth:m,maxHeight:y}=yet({text:n,size:a,pixelRatio:c,maxWidth:o,maxLines:l,lineHeight:u});return{textDrawFn:p,width:m+Gb*c*2,height:y+Gb*c*2}},"processText")),$(this,"textToCanvas",s((n,a,o,l,u,c,p)=>{let m=this.state.pixelRatio,y,v=l,w=u;window.OffscreenCanvas!=null&&!EHe()?y=new OffscreenCanvas(v,w):(y=document.createElement("canvas"),y.width=v,y.height=w,y.style.width=v+"px",y.style.height=w+"px");let E=y.getContext("2d",{willReadFrequently:!0});if(!E)return;E.textAlign=o,E.font="bold ".concat(a*m,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),E.textBaseline="middle",E.lineJoin="miter",E.miterLimit=2,E.strokeStyle="white",E.lineWidth=Gb*m,E.fillStyle=c,E.strokeStyle=p;let M=o==="left"?0:o==="center"?v/2:v-Gb*m/2;return n(E,M,(w+Gb*m/2)/2),y},"textToCanvas")),$(this,"cacheImage",s(n=>{if(!n.appearance.marker.icon)return;let a=Sge(n.appearance.marker.icon);this.imagePromiseCache[a]||(this.imagePromiseCache[a]=new Promise(o=>{this.transformRequest(n.appearance.marker.icon).then(l=>{let u=I4e(l.url);u.onload=()=>{this.imageCache[a]=u,this.publish("img:loaded"),o(u)}})})),n.imageHash!==a&&(n.imageHash=a,this.imagePromiseCache[a].then(()=>{n.dirty=!0}))},"cacheImage")),$(this,"createPinCanvas",s((n,a,o,l,u=1)=>{let c,p=this.state.pixelRatio,m=n.totalMarkerSize*2*p*u;window.OffscreenCanvas!=null?c=new OffscreenCanvas(m,m):(c=document.createElement("canvas"),c.width=m,c.height=m,c.style.width=m/p+"px",c.style.height=m/p+"px");let y=c.getContext("2d");return y.shadowColor="rgba(0,0,0,0.3)",y.shadowOffsetY=xet*p,y.shadowBlur=bet*p,y.beginPath(),y.arc(m/2,m/2,(a/2+_et*p/2)*u,0,2*Math.PI),y.fillStyle=o,y.fill(),y.beginPath(),y.arc(m/2,m/2,a/2*u,0,2*Math.PI),y.shadowColor="transparent",y.fillStyle=l,y.fill(),c},"createPinCanvas")),$(this,"prepare",s((n,a,o)=>{var l,u;let c=this.state.pixelRatio;o.lineWidth=4*c;let p=this.createPinCanvas(n,n.markerSize,n.appearance.marker.backgroundColor.active,n.appearance.marker.foregroundColor.active,(l=n.appearance.marker.iconSizeInterpolation)==null?void 0:l.maxScale),m=this.createPinCanvas(n,n.iconVisible?n.markerSize:vet*c,n.appearance.marker.backgroundColor.inactive,n.appearance.marker.foregroundColor.inactive,(u=n.appearance.marker.iconSizeInterpolation)==null?void 0:u.maxScale);this.pinCache[a]=[p,m]},"prepare")),this.state=e,this.colliderCanvas=r,this.colliderContext=r.getContext("2d"),this.transformRequestFunc=i}draw(e,r,i){var n,a;if(!e.canShow||!e.visible)return;i.save(),i.globalAlpha=e.opacity;let o=this.state.pixelRatio,l=e.projection.x*o,u=e.projection.y*o,c=e.style.pinVisibility===1?this.pinCache[r][0]:this.pinCache[r][1];if(i.drawImage(c,l-e.totalMarkerSize*o,u-e.totalMarkerSize*o,e.totalMarkerSize*2*o,e.totalMarkerSize*2*o),e.appearance.marker.icon&&e.iconVisible&&e.imageHash&&e.appearance.marker.iconSize&&this.imageCache[e.imageHash]){let p=this.imageCache[e.imageHash],m=(e.totalMarkerSize-e.scaledIconPadding)*o,y=e.appearance.marker.iconFit,v=m,w=m,E="".concat(e.imageHash,"_").concat(y);if(this.imageDimensionsCache[E])v=this.imageDimensionsCache[E].width,w=this.imageDimensionsCache[E].height;else{let M=p.width*o,I=p.height*o;if(y==="contain"){let P=Math.sqrt(M**2+I**2),C=m/P;v=M*C,w=I*C}if(y==="cover"){let P=m/M,C=m/I,T=Math.max(P,C);v=M*T,w=I*T}}i.save(),i.beginPath(),i.arc(l,u,m/2,0,2*Math.PI),i.closePath(),((a=(n=e==null?void 0:e.appearance)==null?void 0:n.marker)==null?void 0:a.iconOverflow)!=="visible"&&i.clip(),i.drawImage(p,l-v/2,u-w/2,v,w),i.restore()}e.style.textLabelVisible&&e.style.textAlign!=null&&e.style.left!=null&&e.style.top!=null&&i.drawImage(this.textCache[e.id][e.style.textAlign],l+e.style.left*o,u+e.style.top*o),i.restore()}};s(T4e,"TwoDDrawSystem");var wet=T4e;N();N();var lN=class k2{constructor(){$(this,"loader"),this.loader=new TB}static getInstance(){return k2.instance||(k2.instance=new k2),k2.instance}getLoader(){return this.loader}load(e){return new Promise((r,i)=>{this.loader.load(e,r,void 0,i)})}};s(lN,"TextureLoaderSingleton"),$(lN,"instance");var Aet=lN,X5=Aet.getInstance();function P4e(t,e){let r=t.components[2],i=t.components[1];return r!=null&&r.hover?[i.hoverColor||e,i.hoverColor||e]:[i.color,i.topColor||i.color]}s(P4e,"processColor");var i1,N2,L4e=class extends Wa{constructor(e,r){super(),Be(this,i1),$(this,"state"),$(this,"convertTo3DMapPosition"),$(this,"textureLoadingCache",new Map),this.convertTo3DMapPosition=r,this.state=e}setShading(e,r){e.material&&e.material.setGradientShading(r.start,r.end,r.intensity)}processTextures(e,r,i){var n;if(r.texture!==e.texture&&r.texture!==""&&dr(this,i1,N2).call(this,r.texture,e,"texture"),r.topTexture!==e.topTexture&&r.topTexture!==""&&dr(this,i1,N2).call(this,r.topTexture,e,"topTexture"),(e.texture==null||e.topTexture==null)&&Array.isArray((n=e.feature.properties)==null?void 0:n.textures)&&e.feature.properties.textures.length>0)for(let a of e.feature.properties.textures)a.face==="top"&&e.topTexture!==a.path?dr(this,i1,N2).call(this,a.path,e,"topTexture"):a.face==="side"&&e.texture!==a.path&&dr(this,i1,N2).call(this,a.path,e,"texture"),e.blendTexture=!0;(e.texture!=null||e.topTexture!=null)&&(i!=null&&i.hover&&e.texturesVisible?e.hideTextures():e.texturesVisible||e.showTextures(),r.texture===""&&e.removeSideTexture(),r.topTexture===""&&e.removeTopTexture())}update(){var e,r,i,n,a,o,l,u;let c,p,m;for(let y of this.state.geometry3DIdsInScene)if(m=this.state.geometry3DMap.get(y),m instanceof Fu&&m.type==="geometry-group"){let v=m.components[0];if(m.userData.shadingDirty){let w=m.userData.entities3D.values().next().value;if(w==null)continue;let E=this.state.geometry3DMap.get(w);E instanceof Ua&&(E.type==="geometry"||E.type==="custom-geometry")&&(c=E.components[0],m.userData.shadingDirty&&v.shading&&this.setShading(c,v.shading));let M,I;for(let P of m.userData.entities3D.values())M=this.state.geometry3DMap.get(P),I=M.components[0],M.type==="geometry"&&I.detached&&m.userData.shadingDirty&&v.shading&&this.setShading(I,v.shading);m.userData.shadingDirty=!1}if(v.dirty){let w=m.getfirstChildEntityId();if(w){let M=this.state.geometry3DMap.get(w),I=M==null?void 0:M.components[0];I instanceof ru&&this.processTextures(I,v)}let E=v.opacity*kw(m);m.getOpacity()!==E&&m.setOpacity(E),v.dirty=!1}}else if(m&&(m.type==="geometry"||m.type==="custom-geometry")&&((e=m.components[1])!=null&&e.dirty||(r=m.components[2])!=null&&r.dirty)){let v=m.components[0],w=m.components[1];p=m.components[2];let E=P4e(m,this.state.hoverColor);if(v.setColor(E[0],E[1]),w.visible!==v.visible&&(v.visible=w.visible,v instanceof ru&&v.textMesh)){let I=this.state.geometry3DMap.get(v.textMesh.userData.entityId);(I==null?void 0:I.type)==="text3d"&&I.components[0].polygonEntityId!=null&&(I.components[0].visible=w.visible)}w.altitude!==v.altitude&&(v.altitude=w.altitude);let M=w.opacity*kw(m);M!==v.opacity&&(v.opacity=M),w.renderOrder!==v.renderOrder&&(v.renderOrder=w.renderOrder),w.dirty=!1,v instanceof ru&&this.processTextures(v,w,p),m.components[2]&&(m.components[2].dirty=!1)}else if((m==null?void 0:m.type)==="model")m.components[1].dirty&&(xj(m),m.components[1].dirty=!1),m.components[0].positionDirty&&(A4e(m,this.convertTo3DMapPosition),m.components[0].positionDirty=!1);else if((m==null?void 0:m.type)==="image"&&(i=m.components[1])!=null&&i.dirty){c=m.components[0];let v=m.components[1];v.visible!==c.visible&&(c.visible=v.visible),v.dirty=!1}else if((m==null?void 0:m.type)==="text3d"&&(n=m.components[1])!=null&&n.dirty&&m.components[0].polygonEntityId!=null){c=m.components[0];let v=m.components[1];v.visible!=null&&v.visible!==c.visible&&(c.visible=v.visible);let{textMesh:w}=c;if(w){Object.assign(w,v.getState());let E=(a=v.hoverColor)!=null?a:this.state.text3dHoverColor;w.color=v.hoverByPolygon?E:(o=v.color)!=null?o:hw.color,w.outlineColor=v.hoverByPolygon?E:(l=v.outlineColor)!=null?l:hw.outlineColor,w.strokeColor=v.hoverByPolygon?E:(u=v.strokeColor)!=null?u:hw.strokeColor}v.dirty=!1}}destroy(){this.textureLoadingCache.forEach(async e=>{(await e).dispose()}),this.textureLoadingCache.clear()}};i1=new WeakSet,N2=s(async function(t,e,r){if(!(!t||!e.showTextures))if(this.textureLoadingCache.has(t)){r==="topTexture"?e.topTexture=await this.textureLoadingCache.get(t):e.texture=await this.textureLoadingCache.get(t),e.showTextures();return}else{let i=new Promise((n,a)=>{X5.getLoader().load(t,o=>{r==="topTexture"?e.topTexture=o:e.texture=o,e.showTextures(),this.publish("texture-loaded"),n(o)},void 0,()=>{Vt.error("Failed to load texture: ".concat(t)),a("Failed to load texture: ".concat(t))})});this.textureLoadingCache.set(t,i)}},"#loadTexture"),s(L4e,"DrawSystem");var Met=L4e;N();var D4e=class extends Wa{constructor(e){super(),$(this,"state"),$(this,"animating",new Map),$(this,"isAnimating",!1),$(this,"startTime",-1),$(this,"showDuration",300),$(this,"hideDuration",250),$(this,"update",s(()=>{this.animating.clear();let r,i;for(let n of this.state.geometry2DIdsInScene)r=this.state.geometry2DMap.get(n),r&&(i=r.components[0],i instanceof d_&&(i.visibilityNeedsUpdate==="show"?(i.canShow=!0,this.animating.set(i,[i.opacity,1])):i.visibilityNeedsUpdate==="hide"&&this.animating.set(i,[i.opacity,0])));this.startTime=performance.now(),this.publish("animate:2d")},"update")),$(this,"playAnimations"),this.state=e,this.playAnimations=this._playAnimations}_playAnimations(){let e=performance.now();for(let[r,[i,n]]of this.animating.entries()){let a=n===1?this.showDuration:this.hideDuration,o=(e-this.startTime)/a;r.opacity=Yy(o,0,1,i,n,n===0?Mge:IHe),e-this.startTime>=a&&(n===1?r.canShow=!0:n===0&&(r.canShow=!1),r.visibilityNeedsUpdate=!1,this.animating.delete(r))}this.publish("draw:2d"),this.animating.size>0&&this.publish("animate:2d")}};s(D4e,"TwoDVisibilitySystem");var Eet=D4e;N();var R4e=class extends Wa{constructor(e,r,i,n,a,o,l){super(),$(this,"state"),$(this,"renderer"),$(this,"mode"),$(this,"scene"),$(this,"cameraObject"),$(this,"viewCamera"),$(this,"systems"),$(this,"needs2DRecompute",!1),$(this,"twoDdirty",!0),$(this,"threeDdirty",!0),$(this,"frameId",null),$(this,"twoDFrameId",null),$(this,"animationFrameId",null),$(this,"nextFrame",null),$(this,"update",s((u=!1)=>{var c;if(((c=this.renderer)==null?void 0:c.renderer)==null)return Promise.resolve();if(u){let p=this.commitRenderState();return this.paint(),p}else return this.frameId?Promise.resolve():new Promise(p=>{this.frameId=requestAnimationFrame(()=>{var m,y;return((m=this.renderer)==null?void 0:m.renderer)==null?p():this.mode==="standalone"?(y=this.commitRenderState())==null?void 0:y.then(()=>{this.paint(),p()}):p()})})},"update")),$(this,"animate2D",s(()=>{this.animationFrameId=requestAnimationFrame(()=>{this.animationFrameId=null,this.systems.twoDVisiblitySystem.playAnimations()})},"animate2D")),$(this,"drawEntities2D",s(()=>{this.twoDFrameId||(this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel())}))},"drawEntities2D")),$(this,"updateEntities2D",s(()=>{this.twoDFrameId&&(cancelAnimationFrame(this.twoDFrameId),this.twoDFrameId=null),this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.watermarkSystem.insertIntoQuadTree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.interactionSystem.updateQuadtree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.twoDVisiblitySystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting())})},"updateEntities2D")),$(this,"commitRenderState",s(()=>{try{let u=[];this.frameId=null,this.publish("pre-render"),this.state.tweenGroup.update(),(this.mode==="outdoors-interleaved"||this.mode==="standalone")&&this.systems.cameraSystem.update(),this.state.shouldMeasureCanvas&&(this.state.shouldMeasureCanvas=!1,this.publish("measure-canvas")),this.twoDdirty&&(this.state.geometry2DIdsInScene.clear(),bge(this.state.entityScene,this.state.geometry2DIdsInScene),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.systems.domMutationSystem.dirty=!0,this.systems.panBoundsSystem.dirty=!0,this.twoDdirty=!1),this.threeDdirty&&(this.state.geometry3DIdsInScene.clear(),xge(this.state.entityScene,this.state.geometry3DIdsInScene),this.threeDdirty=!1,this.systems.interactionSystem.dirty3D=!0,this.systems.panBoundsSystem.dirty=!0,this.systems.outlineInterpolationSystem.geometries3DDirty=!0,this.systems.geometryInFocusSystem.focusablesDirty=!0);let c=this.systems.meshOptimizationSystem.update();c&&u.push(c),this.systems.meshModificationSystem.update(),this.systems.meshDetachmentSystem.update(),this.systems.imageSystem.update(this.systems.cameraSystem.getRotation()),u.push(this.systems.text3DSystem.update(this.systems.cameraSystem.getRotation())),this.systems.customGeometrySystem.update(),this.systems.panBoundsSystem.update(),this.systems.geometryInFocusSystem.update(this.systems.cameraSystem.isCameraMoving(),this.systems.cameraSystem.lastCameraStoppedMovingTime()),this.systems.stackSystem.update(),this.systems.outlineInterpolationSystem.update(this.systems.cameraSystem.getZoomLevel(),this.systems.cameraSystem.zoomDirty),this.systems.pathSystem.update(this.systems.cameraSystem.minZoomAltitude,this.systems.cameraSystem.maxZoomAltitude,this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getRotation()),this.systems.cameraSystem.postRender(),this.systems.domVisiblitySystem.update(),this.systems.domMutationSystem.update(),this.systems.twoDProjectionSystem.update(),this.systems.occlusion2DSystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting()),this.systems.watermarkSystem.update();let p=this.needs2DRecompute;return this.nextFrame=requestAnimationFrame(()=>{this.systems.collisionSystem.update(this.systems.watermarkSystem.width,this.systems.watermarkSystem.height,this.systems.watermarkSystem.options.position,!p)}),this.systems.drawSystem.update(),this.systems.cameraSystem.dirty=!1,this.systems.cameraSystem.zoomDirty=!1,this.systems.cameraSystem.rotationDirty=!1,this.publish("post-render"),Promise.all(u)}catch(u){Vt.error("Render failed: ",u)}},"commitRenderState")),this.renderer=e,this.state=r,this.mode=i,this.scene=n,this.cameraObject=a,this.viewCamera=o,this.systems=l,this.systems.collisionSystem.on("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.on("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.on("animate:2d",this.animate2D),this.systems.cameraSystem.on("pan-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-end",()=>this.needs2DRecompute=!0),this.systems.cameraSystem.on("rotate-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("rotate-end",()=>this.needs2DRecompute=!0)}paint(){var e;(e=this.renderer)!=null&&e.renderer&&(this.mode==="standalone"&&this.renderer.clear(),this.renderer.render(this.scene,this.state.useStandaloneCamera||this.mode==="standalone"?this.cameraObject:this.viewCamera))}destroy(){this.frameId&&cancelAnimationFrame(this.frameId),this.twoDFrameId&&cancelAnimationFrame(this.twoDFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.nextFrame&&cancelAnimationFrame(this.nextFrame),this.state.geometry2DIdsInScene.clear(),this.state.geometry3DIdsInScene.clear(),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.update(),this.systems.collisionSystem.off("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.off("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.off("animate:2d",this.animate2D)}};s(R4e,"RenderSystem");var Cet=R4e;N();var Iet=xt.object({interactive:xt.boolean().optional(),id:xt.string().optional(),nearRadius:xt.number().optional(),farRadius:xt.number().optional(),accentColor:xt.string().optional(),displayArrowsOnPath:xt.boolean().optional(),animateArrowsOnPath:xt.boolean().optional(),nearZoomLevel:xt.number().optional(),farZoomLevel:xt.number().optional(),visibleThroughGeometry:xt.boolean().optional(),dashed:xt.boolean().optional()}),Tet=xt.object({type:xt.enum(["Feature"]),geometry:_j,properties:xt.object({parentId:xt.any().optional()})});function O4e(t,e){xt.object({features:xt.array(Tet)}).parse(t),Iet.parse(e)}s(O4e,"validatePath");var gI,k4e=class{constructor(e,r){$(this,"type","path"),$(this,"mesh",new hx),$(this,"material"),$(this,"geometry"),$(this,"outline"),$(this,"feature"),$(this,"options"),$(this,"nearRadius",.2),$(this,"farRadius",.4),$(this,"nearZoomLevel"),$(this,"farZoomLevel"),$(this,"nearZoomAltitude"),$(this,"farZoomAltitude"),$(this,"accentColor","blue"),$(this,"completeFraction",1),$(this,"altitudeAdjustment",1),$(this,"displayArrowsOnPath",!1),$(this,"animateArrowsOnPath",!1),$(this,"visibleThroughGeometry",!1),$(this,"dashed",!1),$(this,"isVertical",!1),$(this,"dirty",!0),$(this,"materialDirty",!0),$(this,"position",new qe),Be(this,gI,0);var i,n,a,o,l,u,c;this.feature=e,this.options=r||{},this.accentColor=(i=r==null?void 0:r.accentColor)!=null?i:this.accentColor,this.nearRadius=(n=r==null?void 0:r.nearRadius)!=null?n:this.nearRadius,this.farRadius=(a=r==null?void 0:r.farRadius)!=null?a:this.farRadius,this.nearZoomLevel=r==null?void 0:r.nearZoomLevel,this.farZoomLevel=r==null?void 0:r.farZoomLevel,this.displayArrowsOnPath=(o=r==null?void 0:r.displayArrowsOnPath)!=null?o:this.displayArrowsOnPath,this.animateArrowsOnPath=(l=r==null?void 0:r.animateArrowsOnPath)!=null?l:this.animateArrowsOnPath,this.visibleThroughGeometry=(u=r==null?void 0:r.visibleThroughGeometry)!=null?u:this.visibleThroughGeometry,this.dashed=(c=r==null?void 0:r.dashed)!=null?c:this.dashed}setColor(){}setOpacity(){}set visible(e){this.mesh&&(this.mesh.visible=e)}get visible(){return this.mesh?this.mesh.visible:!1}get altitude(){return b(this,gI)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,gI,e))}set complete(e){this.material&&(this.material.uniforms.complete.value=e,this.material.needsUpdate=!0)}};gI=new WeakMap,s(k4e,"PathComponent");var yI=k4e;N();var N4e=class{constructor(e){$(this,"rendererState"),this.rendererState=e}update(){let e;for(let r of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(r),e instanceof Kn&&e.components[0]){let i=e.components[0];if(i.dirty){for(let n of e.children)(n instanceof Fu||n instanceof Kn)&&(n.userData.entityId!==e.components[0].activeId?n.setVisible(!1):n.setVisible(!0));i.dirty=!1}}}};s(N4e,"StackSystem");var Pet=N4e;N();N();N();var Ol=Object.freeze({Linear:Object.freeze({None:s(function(t){return t},"None"),In:s(function(t){return t},"In"),Out:s(function(t){return t},"Out"),InOut:s(function(t){return t},"InOut")}),Quadratic:Object.freeze({In:s(function(t){return t*t},"In"),Out:s(function(t){return t*(2-t)},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},"InOut")}),Cubic:Object.freeze({In:s(function(t){return t*t*t},"In"),Out:s(function(t){return--t*t*t+1},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},"InOut")}),Quartic:Object.freeze({In:s(function(t){return t*t*t*t},"In"),Out:s(function(t){return 1- --t*t*t*t},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},"InOut")}),Quintic:Object.freeze({In:s(function(t){return t*t*t*t*t},"In"),Out:s(function(t){return--t*t*t*t*t+1},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},"InOut")}),Sinusoidal:Object.freeze({In:s(function(t){return 1-Math.sin((1-t)*Math.PI/2)},"In"),Out:s(function(t){return Math.sin(t*Math.PI/2)},"Out"),InOut:s(function(t){return .5*(1-Math.sin(Math.PI*(.5-t)))},"InOut")}),Exponential:Object.freeze({In:s(function(t){return t===0?0:Math.pow(1024,t-1)},"In"),Out:s(function(t){return t===1?1:1-Math.pow(2,-10*t)},"Out"),InOut:s(function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)},"InOut")}),Circular:Object.freeze({In:s(function(t){return 1-Math.sqrt(1-t*t)},"In"),Out:s(function(t){return Math.sqrt(1- --t*t)},"Out"),InOut:s(function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},"InOut")}),Elastic:Object.freeze({In:s(function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)},"In"),Out:s(function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1},"Out"),InOut:s(function(t){return t===0?0:t===1?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)},"InOut")}),Back:Object.freeze({In:s(function(t){var e=1.70158;return t===1?1:t*t*((e+1)*t-e)},"In"),Out:s(function(t){var e=1.70158;return t===0?0:--t*t*((e+1)*t+e)+1},"Out"),InOut:s(function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},"InOut")}),Bounce:Object.freeze({In:s(function(t){return 1-Ol.Bounce.Out(1-t)},"In"),Out:s(function(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375},"Out"),InOut:s(function(t){return t<.5?Ol.Bounce.In(t*2)*.5:Ol.Bounce.Out(t*2-1)*.5+.5},"InOut")}),generatePow:s(function(t){return t===void 0&&(t=4),t=t<Number.EPSILON?Number.EPSILON:t,t=t>1e4?1e4:t,{In:s(function(e){return Math.pow(e,t)},"In"),Out:s(function(e){return 1-Math.pow(1-e,t)},"Out"),InOut:s(function(e){return e<.5?Math.pow(e*2,t)/2:(1-Math.pow(2-e*2,t))/2+.5},"InOut")}},"generatePow")}),F2=s(function(){return performance.now()},"now"),F4e=function(){function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return s(t,"Group"),t.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(r){return e._tweens[r]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var n=0,a=r;n<a.length;n++){var o=a[n];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},t.prototype.remove=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=0,n=e;i<n.length;i++){var a=n[i];a._group=void 0,delete this._tweens[a.getId()],delete this._tweensAddedDuringUpdate[a.getId()]}},t.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},t.prototype.update=function(e,r){e===void 0&&(e=F2()),r===void 0&&(r=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var a=this._tweens[i[n]],o=!r;a&&a.update(e,o)===!1&&!r&&this.remove(a)}i=Object.keys(this._tweensAddedDuringUpdate)}},t}(),H1={Linear:s(function(t,e){var r=t.length-1,i=r*e,n=Math.floor(i),a=H1.Utils.Linear;return e<0?a(t[0],t[1],i):e>1?a(t[r],t[r-1],r-i):a(t[n],t[n+1>r?r:n+1],i-n)},"Linear"),Bezier:s(function(t,e){for(var r=0,i=t.length-1,n=Math.pow,a=H1.Utils.Bernstein,o=0;o<=i;o++)r+=n(1-e,i-o)*n(e,o)*t[o]*a(i,o);return r},"Bezier"),CatmullRom:s(function(t,e){var r=t.length-1,i=r*e,n=Math.floor(i),a=H1.Utils.CatmullRom;return t[0]===t[r]?(e<0&&(n=Math.floor(i=r*(1+e))),a(t[(n-1+r)%r],t[n],t[(n+1)%r],t[(n+2)%r],i-n)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[r]-(a(t[r],t[r],t[r-1],t[r-1],i-r)-t[r]):a(t[n?n-1:0],t[n],t[r<n+1?r:n+1],t[r<n+2?r:n+2],i-n)},"CatmullRom"),Utils:{Linear:s(function(t,e,r){return(e-t)*r+t},"Linear"),Bernstein:s(function(t,e){var r=H1.Utils.Factorial;return r(t)/r(e)/r(t-e)},"Bernstein"),Factorial:function(){var t=[1];return function(e){var r=1;if(t[e])return t[e];for(var i=e;i>1;i--)r*=i;return t[e]=r,r}}(),CatmullRom:s(function(t,e,r,i,n){var a=(r-t)*.5,o=(i-e)*.5,l=n*n,u=n*l;return(2*e-2*r+a+o)*u+(-3*e+3*r-2*a-o)*l+a*n+e},"CatmullRom")}},B4e=function(){function t(){}return s(t,"Sequence"),t.nextId=function(){return t._nextId++},t._nextId=0,t}(),uN=new F4e,pf=function(){function t(e,r){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Ol.Linear.None,this._interpolationFunction=H1.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=B4e.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof r=="object"?(this._group=r,r.add(this)):r===!0&&(this._group=uN,uN.add(this))}return s(t,"Tween"),t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.getDuration=function(){return this._duration},t.prototype.to=function(e,r){if(r===void 0&&(r=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=r<0?0:r,this},t.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},t.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},t.prototype.start=function(e,r){if(e===void 0&&(e=F2()),r===void 0&&(r=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||r){if(this._propertiesAreSetUp=!0,!this._isDynamic){var n={};for(var a in this._valuesEnd)n[a]=this._valuesEnd[a];this._valuesEnd=n}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,r)}return this},t.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},t.prototype._setupProperties=function(e,r,i,n,a){for(var o in i){var l=e[o],u=Array.isArray(l),c=u?"array":typeof l,p=!u&&Array.isArray(i[o]);if(!(c==="undefined"||c==="function")){if(p){var m=i[o];if(m.length===0)continue;for(var y=[l],v=0,w=m.length;v<w;v+=1){var E=this._handleRelativeValue(l,m[v]);if(isNaN(E)){p=!1,console.warn("Found invalid interpolation list. Skipping.");break}y.push(E)}p&&(i[o]=y)}if((c==="object"||u)&&l&&!p){r[o]=u?[]:{};var M=l;for(var I in M)r[o][I]=M[I];n[o]=u?[]:{};var m=i[o];if(!this._isDynamic){var P={};for(var I in m)P[I]=m[I];i[o]=m=P}this._setupProperties(M,r[o],m,n[o],a)}else(typeof r[o]>"u"||a)&&(r[o]=l),u||(r[o]*=1),p?n[o]=i[o].slice().reverse():n[o]=r[o]||0}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},t.prototype.pause=function(e){return e===void 0&&(e=F2()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},t.prototype.resume=function(e){return e===void 0&&(e=F2()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},t.prototype.stopChainedTweens=function(){for(var e=0,r=this._chainedTweens.length;e<r;e++)this._chainedTweens[e].stop();return this},t.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},t.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},t.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},t.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},t.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},t.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},t.prototype.easing=function(e){return e===void 0&&(e=Ol.Linear.None),this._easingFunction=e,this},t.prototype.interpolation=function(e){return e===void 0&&(e=H1.Linear),this._interpolationFunction=e,this},t.prototype.chain=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._chainedTweens=e,this},t.prototype.onStart=function(e){return this._onStartCallback=e,this},t.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},t.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},t.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},t.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},t.prototype.onStop=function(e){return this._onStopCallback=e,this},t.prototype.update=function(e,r){var i=this,n;if(e===void 0&&(e=F2()),r===void 0&&(r=t.autoStartOnUpdate),this._isPaused)return!0;var a;if(!this._goToEnd&&!this._isPlaying)if(r)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,l=this._duration+((n=this._repeatDelayTime)!==null&&n!==void 0?n:this._delayTime),u=this._duration+this._repeat*l,c=s(function(){if(i._duration===0||o>u)return 1;var E=Math.trunc(o/l),M=o-E*l,I=Math.min(M/i._duration,1);return I===0&&o===i._duration?1:I},"calculateElapsedPortion"),p=c(),m=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,m),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||o>=this._duration)if(this._repeat>0){var y=Math.min(Math.trunc((o-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=y);for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*y,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,w=this._chainedTweens.length;v<w;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(e,r,i,n){for(var a in i)if(r[a]!==void 0){var o=r[a]||0,l=i[a],u=Array.isArray(e[a]),c=Array.isArray(l),p=!u&&c;p?e[a]=this._interpolationFunction(l,n):typeof l=="object"&&l?this._updateProperties(e[a],o,l,n):(l=this._handleRelativeValue(o,l),typeof l=="number"&&(e[a]=o+(l-o)*n))}},t.prototype._handleRelativeValue=function(e,r){return typeof r!="string"?r:r.charAt(0)==="+"||r.charAt(0)==="-"?e+parseFloat(r):parseFloat(r)},t.prototype._swapEndStartRepeatValues=function(e){var r=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=r},t.autoStartOnUpdate=!1,t}();B4e.nextId;var rd=uN;rd.getAll.bind(rd);rd.removeAll.bind(rd);rd.add.bind(rd);rd.remove.bind(rd);rd.update.bind(rd);N();N();N();var Let=s((t,e)=>(e-t+Math.PI)%(Math.PI*2)+Math.PI*2%(Math.PI*2)-Math.PI,"differenceBetweenAngles"),Det=s((t,e)=>new Jt(t.clientX-e.offsetLeft,t.clientY-e.offsetTop),"getTouchPos"),mX=s((t,e)=>Math.atan2(e.y-t.y,e.x-t.x),"angle"),xE=s((t,e)=>Math.sqrt((e.y-t.y)**2+(e.x-t.x)**2),"distance"),gX=s((t,e)=>new Jt((t.x+e.x)/2,(t.y+e.y)/2),"average"),yX=s(t=>{let e=0,{wheelDelta:r,detail:i}=t;return r!==void 0?e=r:i!==void 0&&(e=-i),e},"getScrollDelta"),z4e=class{constructor(e,r){$(this,"input1"),$(this,"input2"),$(this,"lastAngle"),$(this,"lastDistance"),$(this,"totalDistance"),$(this,"first"),$(this,"second"),this.input1=e,this.input2=r,this.lastAngle=mX(e,r),this.lastDistance=xE(e,r),this.totalDistance=0,this.first=e,this.second=r}update(e,r){let i=xE(e,r);this.input1=e,this.input2=r;let n=mX(e,r);this.lastAngle=n,this.lastDistance=i,this.totalDistance+=(xE(this.first,e)+xE(this.second,r))/2,this.first=gX(this.first,e),this.second=gX(this.second,r)}};s(z4e,"InputSet");var Ret=z4e;N();var U4e=class{constructor(e,r,i){$(this,"touch"),$(this,"camera"),$(this,"cameraPlane"),$(this,"viewCoordinate"),$(this,"snapHolderMatrix"),$(this,"snapCamera"),$(this,"cameraPosition"),$(this,"raycaster"),$(this,"worldCoordinate"),$(this,"snapshotted",!1),this.touch=e,this.camera=r,this.cameraPlane=i,this.viewCoordinate={x:e.x,y:e.y},this.camera.updateMatrixWorld(),this.camera.updateMatrix(),this.snapHolderMatrix=this.camera.matrixWorld.clone(),this.snapCamera=this.camera.clone(),this.snapshotCameraState()}snapshotCameraState(){this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraPosition=this.camera.position.clone();let e=new Jt(this.viewCoordinate.x,this.viewCoordinate.y);this.raycaster=this.raycaster||new BA,this.raycaster.setFromCamera(e,this.snapCamera);let r=this.raycaster.intersectObject(this.cameraPlane,!0);this.worldCoordinate=r&&r.length>0?r[0].point:null,this.snapshotted=!0}updateAnchorState(e,r){this.camera=e,this.snapCamera=e.clone(),this.snapHolderMatrix=e.matrixWorld.clone(),this.updateViewCoordinate(r),this.snapshotCameraState()}updateViewCoordinate(e){this.viewCoordinate={x:e.x,y:e.y}}reUnproject(){var e,r;let i=new Jt(this.viewCoordinate.x,this.viewCoordinate.y);(e=this.raycaster)==null||e.setFromCamera(i,this.snapCamera);let n=(r=this.raycaster)==null?void 0:r.intersectObject(this.cameraPlane,!0)[0];return n?n.point:void 0}};s(U4e,"TouchAnchor");var vX=U4e,_y={};Nl(_y,{BLOCK_MERCATOR_ZOOM_LEVEL:()=>Net,CLIPPING_RADIUS:()=>vI,CONTROL_OPTIONS:()=>ket,DEFAULT_ANIMATION_DURATION:()=>H4e,DEFAULT_BEARING:()=>Vet,DEFAULT_MAX_ZOOM_LEVEL:()=>zet,DEFAULT_MIN_ZOOM_LEVEL:()=>q4e,DEFAULT_PITCH:()=>Uet,DEFAULT_ZOOM_LEVEL:()=>Bet,EVENTS:()=>pN,MAPLIBRE_TILE_SIZE:()=>Oet,MAX_LAT:()=>j4e,MAX_MERCATOR_ZOOM_LEVEL:()=>hN,MIN_LAT:()=>V4e,MIN_MERCATOR_ZOOM_LEVEL:()=>cN,ROOM_MERCATOR_ZOOM_LEVEL:()=>Fet,TWO_PI:()=>$4e,WHEEL_ZOOM_MULTIPLIER:()=>G4e,ZRANGE:()=>B2});N();var Oet=512,V4e=-85.051129,j4e=85.051129,vI=1e4,ket={chain:"chain",cancel:"cancel"},$4e=Math.PI*2,B2=100,G4e=1e4,cN=0,hN=24,Net=17,Fet=20,H4e=200,pN=["change","pan-start","pan-end","rotate-start","rotate-end","zoom-start","zoom-end","multi-start","multi-end","multi-cancel","pedestal-start","pedestal-change","pedestal-end","user-pan-start","user-pedestal-start","user-rotate-start","user-dolly-start","user-zoom-start","user-tilt-start","user-pan-end","user-pedestal-end","user-rotate-end","user-dolly-end","user-zoom-end","user-tilt-end","position-updated","zoom-updated","tilt-updated","rotation-updated"],Bet=18,q4e=12,zet=22,Uet=0,Vet=0;N();function dN(t){t&&(t.map&&(t.map.dispose(),t.map=void 0),t.dispose())}s(dN,"scrubMaterial");function Cl(t){for(let e=t.children.length-1;e>=0;e--)Cl(t.children[e]);"geometry"in t&&t.geometry&&t.geometry.dispose(),t.parent&&t.parent.remove(t),"material"in t&&Array.isArray(t.material)?t.material.forEach(function(e){dN(e)}):"material"in t&&typeof t.material<"u"&&dN(t.material)}s(Cl,"destroyObject3D");var _X=!1,fN,mN=class extends Wa{constructor(e,r,i,n,a){super(),$(this,"dirty",!1),$(this,"zoomDirty",!1),$(this,"rotationDirty",!1),$(this,"panDirty",!1),Be(this,fN,q4e),$(this,"zoomSpeed",5),$(this,"rotateSpeed",100),$(this,"enabled",!0),$(this,"enableZoom",!0),$(this,"enablePan",!0),$(this,"enablePedestal",!1),$(this,"maxPedestal",1/0),$(this,"minPedestal",0),$(this,"enableRotate",!0),$(this,"minZoomAltitude",0),$(this,"maxZoomAltitude",1/0),$(this,"ignoreZoomLimits",!1),$(this,"zoomFactor",1),$(this,"panBounds",{min:new qe(1/0,1/0),max:new qe(-1/0,-1/0),center:new qe(0,0,0),radius:1/0}),$(this,"minTilt",0),$(this,"maxTilt",1.2),$(this,"MOUSE_BUTTONS",{ORBIT:GL.RIGHT,ZOOM:GL.MIDDLE,PAN:GL.LEFT}),$(this,"camera"),$(this,"scene"),$(this,"renderer"),$(this,"elevation"),$(this,"orbit"),$(this,"cameraPlane"),$(this,"raycaster",new BA),$(this,"rendererState"),$(this,"options"),$(this,"state",-1),$(this,"intersection"),$(this,"viewState",null),$(this,"tweens",new Map),$(this,"clock",new hje(!0)),$(this,"coords",{mouse:new Jt,rotateStart:new Jt,rotateEnd:new Jt,rotateDelta:new Jt,panStart:new qe,panCameraStart:new qe,panEnd:new qe,panDelta:new qe,initialShiftPos:new Jt,initialPedestal:0,floorAnchor:new qe}),$(this,"touch",{origin:{offsetLeft:0,offsetTop:0},touches:[],anchor1:null,anchor2:null,inputs:null}),$(this,"scrollTimer",null),$(this,"lastWheelTime",0),$(this,"resetZoom",!1),$(this,"zoomStart"),$(this,"pedestalScaleFactor",1),$(this,"isUserZooming",!1),$(this,"stayInsideBounds",!0),$(this,"userInteracting",!1),$(this,"cameraMoving",!1),$(this,"lastCameraMoveTime",Date.now()),$(this,"raycastToFloor",s(o=>{this.raycaster.setFromCamera(o,this.camera);let l=this.raycaster.intersectObject(this.cameraPlane,!1)[0];return l?l.point:new qe},"raycastToFloor")),$(this,"isUserInteracting",s(()=>this.userInteracting,"isUserInteracting")),$(this,"getPosition",s(()=>new qe(this.orbit.position.x,this.orbit.position.y,this.orbit.position.z),"getPosition")),$(this,"getPedestal",s(()=>this.orbit.position.z,"getPedestal")),$(this,"pan",s((o,l)=>{isNaN(o)||isNaN(l)||(this.setPosition(this.orbit.position.x+o,this.orbit.position.y+l),this.publish("position-updated"))},"pan")),$(this,"postRender",s(()=>{(this.state===2||this.state===6)&&(this.raycaster.setFromCamera(this.coords.mouse,this.camera),this.intersection=this.raycaster.intersectObject(this.cameraPlane,!1)[0],this.intersection&&(this.coords.panStart.set(this.intersection.point.x,this.intersection.point.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0))),this.state===3&&this.resetZoom&&(this.resetZoom=!1,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0)),this.state===7&&this.isAnimating===!1&&(this.state=-1,this.publish("multi-end"))},"postRender")),$(this,"isCameraMoving",s(()=>this.cameraMoving,"isCameraMoving")),$(this,"lastCameraStoppedMovingTime",s(()=>this.lastCameraMoveTime,"lastCameraStoppedMovingTime")),$(this,"setPosition",s((o,l)=>{o===void 0||l===void 0||isNaN(o)||isNaN(l)||(this.state===-1&&this.publish("pan-start"),this.updateCameraPosition(o,l),this.publish("position-updated"),this.publish("change"),this.state===-1&&this.publish("pan-end"),this.dirty=!0)},"setPosition")),$(this,"updateCameraPosition",s((o,l)=>{let u=o-this.panBounds.center.x,c=l-this.panBounds.center.y,p=Math.sqrt(u*u+c*c);if(this.stayInsideBounds&&p>this.panBounds.radius){let m=Math.atan2(c,u),y={x:Math.cos(m)*this.panBounds.radius+this.panBounds.center.x,y:Math.sin(m)*this.panBounds.radius+this.panBounds.center.y};this.orbit.position.x=y.x,this.orbit.position.y=y.y}else this.orbit.position.x=o,this.orbit.position.y=l},"updateCameraPosition")),$(this,"tilt",s(o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let l=this.stayInsideBounds?Math.max(Math.min(o+this.getTilt(),this.maxTilt),this.minTilt):o+this.getTilt();l!==this.elevation.rotation.x&&(this.elevation.rotation.x=l,this.publish("tilt-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end")},"tilt")),$(this,"zoomIn",s((o,l,u)=>{let c=this.getZoomAltitude();this.animateCamera({zoom:c/1.5},o,l,u)},"zoomIn")),$(this,"zoomOut",s((o,l,u)=>{let c=this.getZoomAltitude();this.animateCamera({zoom:c*1.5},o,l,u)},"zoomOut")),$(this,"getRotation",s(()=>(-this.orbit.rotation.z+Math.PI*2)%(Math.PI*2),"getRotation")),$(this,"cancelAnimation",s(()=>{let o=Array.from(this.tweens.keys()),l=o[o.length-1];l.state===7&&this.publish("multi-cancel",{zooming:!0,rotating:!0,tilting:!0}),this.completeTween(l)},"cancelAnimation")),$(this,"animateCamera",s((o,l,u,c,p,m)=>{let y=Ee({interruptible:!0},m),v={},w={},E=this.getPosition();if(o.position!=null&&(o.position.x!==void 0&&(v.x=E.x,w.x=o.position.x),o.position.y!==void 0&&(v.y=E.y,w.y=o.position.y),o.position.z!==void 0&&(v.z=E.z,w.z=o.position.z)),o.zoom!==void 0&&(v.zoom=this.stayInsideBounds?Math.min(Math.max(this.getZoomAltitude(),this.getZoomScaledMin()),this.getZoomScaledMax()):this.getZoomAltitude(),this.viewState==="multi_floor"||!this.stayInsideBounds?w.zoom=o.zoom:w.zoom=Math.min(Math.max(o.zoom,this.getZoomScaledMin()),this.getZoomScaledMax())),o.rotation!==void 0){let{start:k,end:B}=NB(this.getRotation(),o.rotation);v.rotation=k,w.rotation=B}o.tilt!==void 0&&(v.tilt=this.getTilt(),this.viewState==="multi_floor"||!this.stayInsideBounds?w.tilt=o.tilt:w.tilt=Math.max(Math.min(o.tilt,this.maxTilt),this.minTilt));let M=v.zoom!==w.zoom,I=v.rotation!==w.rotation,P=v.tilt!==w.tilt,C=new pf(v).to(w,$a.env.TESTING?0:l).onUpdate(k=>{this.setMulti({x:k.x,y:k.y,z:k.z},k.zoom,k.rotation,k.tilt)}).onComplete(()=>{this.completeTween(C),this.publish("multi-end",{zooming:M,rotating:I,tilting:P}),c&&c()}).onStart(()=>{this.state!==7&&(this.state=7,C.state=7,this.publish("multi-start",{zooming:M,rotating:I,tilting:P})),this.publish("change")});this.rendererState.tweenGroup.add(C);let T=Array.from(this.tweens.entries()),O=T[T.length-1],F=!1;return O!=null&&(O[1].interruptible?(typeof O[1].cancelledCallback=="function"&&O[1].cancelledCallback(),this.completeTween(O[0])):(F=!0,O[0].chain(C))),this.tweens.set(C,{cancelledCallback:p,interruptible:y.interruptible}),u?C.easing(u):C.easing(Ol.Quadratic.In),!o.doNotAutoStart&&!F&&(C.start(),this.publish("change")),C.cameraAnimation=!0,C},"animateCamera")),$(this,"setMulti",s((o,l,u,c,p=!0)=>{this.state===-1&&this.publish("multi-start");let m=!1;o!=null&&(o.x!==void 0&&!isNaN(o.x)&&o.y!==void 0&&!isNaN(o.y)&&(this.updateCameraPosition(o.x,o.y),m=!0),o.z!==void 0&&!isNaN(o.z)&&(this.setPedestal(o.z,!0),m=!0)),m&&this.publish("position-updated");let y={zooming:!1,tilting:!!l,rotating:!1};if(l!==void 0&&!isNaN(l)){let v=this.stayInsideBounds?Math.min(Math.max(l,this.getZoomScaledMin()),this.getZoomScaledMax()):l;v!==this.camera.position.z&&(y.zooming=!0,this.camera.position.z=v,this.publish("zoom-updated"),this.zoomDirty=!0,this.viewState==="multi_floor"?l>vI&&(this.camera.near=l-vI,this.camera.far=l+vI):(this.camera.near=l/B2,this.camera.far=l*B2),this.camera.updateProjectionMatrix())}if(u!==void 0&&!isNaN(u)&&u!==this.getRotation()&&(y.rotating=!0,this.orbit.rotation.z=-u,this.publish("rotation-updated")),c!==void 0&&!isNaN(c)){let v=this.stayInsideBounds?Math.max(Math.min(c,this.maxTilt),this.minTilt):c;v!==this.elevation.rotation.x&&(y.tilting=!0,this.elevation.rotation.x=v,this.publish("tilt-updated"))}p&&this.publish("change"),this.state===-1&&this.publish("multi-end",y)},"setMulti")),$(this,"getZoomScaledMin",s(()=>this.minZoomAltitude*this.zoomFactor,"getZoomScaledMin")),$(this,"getZoomScaledMax",s(()=>{let o=this.minZoomAltitude*this.zoomFactor;return Math.max(this.maxZoomAltitude,o)},"getZoomScaledMax")),$(this,"setRotation",s((o,l)=>{if(isNaN(o))return;this.state===-1&&!l&&this.publish("rotate-start");let u=-(o%$4e);u!==this.orbit.rotation.z&&(this.orbit.rotation.z=u,l||this.publish("rotation-updated")),l||this.publish("change"),this.state===-1&&!l&&this.publish("rotate-end"),this.dirty=!0,this.rotationDirty=!0},"setRotation")),$(this,"setZoomAltitude",s(o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let l=this.stayInsideBounds?Math.min(Math.max(o,this.getZoomScaledMin()),this.getZoomScaledMax()):o;l!==this.camera.position.z&&(this.camera.position.z=l,this.publish("zoom-updated"),this.zoomDirty=!0),this.camera.near=l/B2,this.camera.far=l*B2,this.camera.updateProjectionMatrix(),this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.dirty=!0},"setZoomAltitude")),$(this,"setZoomLevel",s(o=>{this.setZoomAltitude(this.convertZoomLevelToAltitude(o))},"setZoomLevel")),$(this,"getZoomAltitude",s(()=>this.camera.position.z,"getZoomAltitude")),$(this,"getZoomLevel",s(()=>this.convertAltitudeToZoomLevel(this.getZoomAltitude()),"getZoomLevel")),$(this,"setTilt",s((o,l)=>{if(isNaN(o))return;this.state===-1&&!l&&this.publish("rotate-start");let u=this.stayInsideBounds?Math.max(Math.min(o,this.maxTilt),this.minTilt):o;u!==this.elevation.rotation.x&&(this.elevation.rotation.x=u,l||this.publish("tilt-updated")),l||this.publish("change"),this.state===-1&&!l&&this.publish("rotate-end"),this.dirty=!0},"setTilt")),$(this,"getTilt",s(()=>this.elevation.rotation.x,"getTilt")),$(this,"setCameraPlaneElevation",s(o=>{this.cameraPlane.position.z=o},"setCameraPlaneElevation")),$(this,"zoom",s(o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let l=this.getZoomAltitude()-o;this.camera.position.z=this.stayInsideBounds?Math.min(Math.max(l,this.minZoomAltitude*this.zoomFactor),this.maxZoomAltitude*this.zoomFactor):l,this.publish("zoom-updated"),this.zoomDirty=!0,this.publish("change"),this.state===-1&&this.publish("zoom-end")},"zoom")),$(this,"getProjectionScaleFactor",s((o,l,u)=>VO(o,l,u),"getProjectionScaleFactor")),$(this,"update",s(()=>{this.orbit.updateMatrixWorld(),this.lastWheelTime>0&&this.state===3&&this.clock.getElapsedTime()-this.lastWheelTime>.2&&(this.lastWheelTime=0,this.state=-1,this.publish("zoom-end"),this.removeMouseMoveEventListeners())},"update")),$(this,"setPedestal",s((o,l=!1)=>{typeof o=="number"&&!isNaN(o)&&(this.orbit.position.z=o,l&&(this.publishPedestalChangeEvent(o),this.publish("pedestal-change",{pedestal:o})),this.publish("change"),this.dirty=!0)},"setPedestal")),$(this,"dispose",s(()=>{for(let o of pN)o.endsWith("start")?(this.off(o,this.setCameraMoving),o.startsWith("user")&&this.off(o,this.setUserInteracting)):(o.endsWith("end")||o.endsWith("cancel"))&&(this.off(o,this.unsetCameraMoving),o.startsWith("user")&&this.off(o,this.unsetUserInteracting));this.removeEventListeners(),this.scene.remove(this.cameraPlane)},"dispose")),$(this,"createCameraPlane",s(()=>{let o=1e10,l=1,u=new pv(o,o,l,l),c=new ug({color:0,wireframe:_X,visible:_X}),p=new Pn(u,c);return this.scene.add(p),p},"createCameraPlane")),$(this,"addEventListeners",s(()=>{let{domElement:o}=this.renderer;for(let l of pN)l.endsWith("start")?(this.on(l,this.setCameraMoving),l.startsWith("user")&&this.on(l,this.setUserInteracting)):(l.endsWith("end")||l.endsWith("cancel"))&&(this.on(l,this.unsetCameraMoving),l.startsWith("user")&&this.on(l,this.unsetUserInteracting));o.addEventListener("contextmenu",this.onContextMenu,!1),o.addEventListener("mousedown",this.onMouseDown,!1),o.addEventListener("wheel",this.onMouseWheel,{passive:!1}),o.addEventListener("touchstart",this.onTouchStart,!1),o.addEventListener("touchend",this.onTouchEnd,!1),o.addEventListener("touchmove",this.onTouchMove,!1)},"addEventListeners")),$(this,"addMouseEventListeners",s(()=>{this.addMouseMoveEventListeners(),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("mouseout",this.onMouseUp,!1)},"addMouseEventListeners")),$(this,"addMouseMoveEventListeners",s(()=>{this.renderer.domElement.addEventListener("mousemove",this.onMouseMove,!1)},"addMouseMoveEventListeners")),$(this,"removeMouseMoveEventListeners",s(()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1)},"removeMouseMoveEventListeners")),$(this,"removeEventListeners",s(()=>{let{domElement:o}=this.renderer;o.removeEventListener("contextmenu",this.onContextMenu,!1),o.removeEventListener("mousedown",this.onMouseDown,!1),o.removeEventListener("wheel",this.onMouseWheel,!1),o.removeEventListener("touchstart",this.onTouchStart,!1),o.removeEventListener("touchend",this.onTouchEnd,!1),o.removeEventListener("touchmove",this.onTouchMove,!1),o.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)},"removeEventListeners")),$(this,"removeMouseUpEventListeners",s(()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)},"removeMouseUpEventListeners")),$(this,"onContextMenu",s(o=>{o.preventDefault()},"onContextMenu")),$(this,"onMouseUp",s(()=>{if(this.enabled!==!1){switch(this.removeMouseUpEventListeners(),this.state){case 2:this.publish("pan-end"),this.publish("user-pan-end");break;case 1:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}this.state=-1,this.panDirty=!1}},"onMouseUp")),$(this,"onMouseMove",s(o=>{if(this.enabled!==!1)if(o.preventDefault(),this.mouseToScene(o),this.state===0){if(this.enableRotate===!1)return;this.handleMouseMoveRotate(o)}else if(this.state===2){if(this.enablePan===!1)return;this.handleMouseMovePan()}else this.state===3?(this.resetZoom=!0,this.state=-1):this.state===8&&this.handleMouseMovePedestal(o)},"onMouseMove")),$(this,"onTouchStart",s(o=>{if(this.enabled!==!1){switch(this.updateTouchOrigin(),this.touchToScene(o),o.touches.length){case 1:this.enablePedestal?(this.handleTouchStartPedestal(o),this.state=9):this.enablePan&&(this.handleTouchStartPan(o),this.state=6);break;case 2:this.touch.inputs=new Ret(this.touch.touches[0],this.touch.touches[1]);break;default:this.state=-1}this.state}},"onTouchStart")),$(this,"onTouchMove",s(o=>{if(this.enabled!==!1)switch(this.touchToScene(o),o.touches.length){case 2:o.preventDefault(),o.stopPropagation();let l=Ee({},this.touch.inputs.first),u=Ee({},this.touch.inputs.second),c=new Jt(this.touch.touches[0].x,this.touch.touches[0].y),p=new Jt(this.touch.touches[1].x,this.touch.touches[1].y);if(this.touch.inputs.update(this.touch.touches[0],this.touch.touches[1]),this.enableRotate&&this.state===4)this.handleTouchMoveTilt(o);else if(this.state===5)this.handleTouchMoveDolly();else if(this.state!==5&&this.touch.inputs.totalDistance>.05){let m=l.y<c.y&&u.y<p.y,y=l.y>c.y&&u.y>p.y;this.enableRotate&&this.state!==4&&(y||m)?(this.handleTouchStartTilt(o),this.state=4):(this.handleTouchStartDolly(),this.state=5)}break;case 1:(this.enablePedestal||this.enablePan)&&(o.preventDefault(),o.stopPropagation()),this.enablePedestal&&this.state===9?this.handleTouchMovePedestal(o):this.enablePan&&this.state===6&&this.handleTouchMovePan(o);break;default:this.state=-1}},"onTouchMove")),$(this,"onTouchEnd",s(o=>{if(this.enabled!==!1){switch(this.handleTouchEnd(),this.state){case 2:case 6:this.publish("user-pan-end");break;case 4:this.publish("pan-end"),this.publish("user-tilt-end");break;case 1:case 5:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:case 9:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}o.touches.length?this.onTouchStart(o):this.state=-1}},"onTouchEnd")),$(this,"handleTouchMovePan",s(o=>{let l=Object.hasOwn(o,"x")?new Jt(o.x,o.y):this.touch.touches[0],u=this.raycastToFloor(l);this.coords.panEnd.set(u.x,u.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0},"handleTouchMovePan")),$(this,"handleTouchStartDolly",s(()=>{let o=this.touch.touches[0].x-this.touch.touches[1].x,l=this.touch.touches[0].y-this.touch.touches[1].y;this.zoomStart=this.getZoomAltitude();let u=new Jt(this.touch.touches[0].x-o/2,this.touch.touches[0].y-l/2);this.coords.floorAnchor=this.raycastToFloor(u),this.orbit.updateMatrixWorld(),this.touch.anchor1=new vX(this.touch.touches[0],this.camera,this.cameraPlane),this.touch.anchor2=new vX(this.touch.touches[1],this.camera,this.cameraPlane),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-dolly-start"),this.publish("zoom-start"),this.publish("multi-start")},"handleTouchStartDolly")),$(this,"handleMouseMovePan",s(()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panEnd.set(o.x,o.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0},"handleMouseMovePan")),$(this,"handleTouchStartTilt",s(o=>{this.coords.rotateStart.set(o.touches[1].clientX,o.touches[1].clientY),this.publish("user-tilt-start"),this.publish("rotate-start")},"handleTouchStartTilt")),$(this,"handleTouchMovePedestal",s(o=>{this.handleMouseMovePedestal(o.touches[0])},"handleTouchMovePedestal")),$(this,"handleTouchMoveTilt",s(o=>{this.coords.rotateEnd.set(o.touches[1].clientX,o.touches[1].clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd)},"handleTouchMoveTilt")),$(this,"handleTouchMoveDolly",s(()=>{let o=this.touch.inputs.first,l=this.touch.inputs.second;this.touch.anchor1.viewCoordinate={x:o.x,y:o.y},this.touch.anchor2.viewCoordinate={x:l.x,y:l.y};let u=this.makeTransformFromTouchAnchors(this.touch.anchor1,this.touch.anchor2);u&&this.setCameraFromTransformMatrix(u),this.orbit.updateMatrixWorld(),this.touch.anchor1.updateAnchorState(this.camera,o),this.touch.anchor2.updateAnchorState(this.camera,l)},"handleTouchMoveDolly")),$(this,"handleTouchEnd",s(()=>{this.state===4||this.state===5?this.publish("multi-end"):this.state===6&&this.publish("pan-end"),this.panDirty=!1},"handleTouchEnd")),$(this,"handleTouchStartPan",s(o=>{let l=Object.hasOwn(o,"x")?new Jt(o.x,o.y):this.touch.touches[0],u=this.raycastToFloor(l);this.coords.panStart.set(u.x,u.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-pan-start"),this.publish("pan-start")},"handleTouchStartPan")),$(this,"handleTouchStartPedestal",s(o=>{this.handleMouseDownPedestal(o.touches[0])},"handleTouchStartPedestal")),$(this,"onMouseDown",s(o=>{if(this.enabled!==!1){if(this.mouseToScene(o),o.preventDefault(),this.state===3&&this.publish("zoom-end"),o.button===this.MOUSE_BUTTONS.ORBIT){if(this.enableRotate===!1)return;this.handleMouseDownRotate(o),this.state=0}else o.button===this.MOUSE_BUTTONS.PAN&&(this.enablePan?(this.handleMouseDownPan(),this.state=2):this.enablePedestal&&(this.handleMouseDownPedestal(o),this.state=8));this.state!==-1&&this.addMouseEventListeners()}},"onMouseDown")),$(this,"onMouseWheel",s(o=>{this.enabled===!1||this.enableZoom===!1||this.state!==-1&&this.state!==3||(o.preventDefault(),o.stopPropagation(),this.mouseToScene(o),this.canScrollZoom(o)&&(this.lastWheelTime=this.clock.getElapsedTime(),this.publishUserZoomEvent()),this.state!==3&&this.canScrollZoom(o)&&(this.addMouseMoveEventListeners(),this.state=3,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("zoom-start")),this.scrollTimer!=null&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.publish("zoom-end")},50),this.handleMouseWheel(o))},"onMouseWheel")),$(this,"handleMouseWheel",s(o=>{if(this.publish("zoom-start"),!this.canScrollZoom(o)){this.lastWheelTime>0&&this.publish("zoom-end"),this.lastWheelTime=0,this.state=-1;return}let l=this.getZoomAltitude(),u=l-yX(o)*l/G4e*this.zoomSpeed;if(this.setZoomAltitude(u),this.enablePan){let c=u/this.zoomStart;this.coords.panDelta.subVectors(this.coords.floorAnchor,this.coords.panCameraStart).multiplyScalar(1-c),this.setPosition(this.coords.panCameraStart.x+this.coords.panDelta.x,this.coords.panCameraStart.y+this.coords.panDelta.y)}this.publish("change")},"handleMouseWheel")),$(this,"setCameraFromTransformMatrix",s(o=>{this.orbit.updateMatrixWorld();let l=new Nu;l.setFromRotationMatrix(o,"ZYX");let u=(o.elements[14]-this.cameraPlane.position.z)/Math.cos(l.x),c=l.z,p=new qe(0,0,1);p.applyEuler(l),p.setLength(u);let m=new qe;m.setFromMatrixPosition(o),m.sub(p),this.enablePan&&this.setPosition(m.x,m.y),this.enableZoom&&this.setZoomAltitude(u),this.enableRotate&&this.setRotation(-c)},"setCameraFromTransformMatrix")),$(this,"makeTransformFromTouchAnchors",s((o,l)=>{this.orbit.updateMatrixWorld(),this.camera.updateProjectionMatrix();let u=this.camera.projectionMatrix.clone(),c=o.worldCoordinate,p=l.worldCoordinate,m=o.reUnproject(),y=l.reUnproject();if(!m||!y||!c||!p)return null;let v=o.viewCoordinate,w=l.viewCoordinate,E=p.x-c.x,M=p.y-c.y,I=Math.atan2(M,E),P=y.x-m.x,C=y.y-m.y,T=Math.atan2(C,P),O=Let(I,T),F=new Oi;F.makeRotationZ(-O);let k=F.clone();k.multiply(o.snapHolderMatrix);let B=s((Xe,ht,rr)=>Xe.elements[(ht-1)*4+rr-1],"m"),U=B(u,1,1)*B(k,1,1)-v.x*B(u,3,4)*B(k,3,1),z=B(u,1,1)*B(k,1,2)-v.x*B(u,3,4)*B(k,3,2),q=B(u,1,1)*B(k,1,3)-v.x*B(u,3,4)*B(k,3,3),W=c.x*U+c.y*z+c.z*q,J=B(u,2,2)*B(k,2,1)-v.y*B(u,3,4)*B(k,3,1),V=B(u,2,2)*B(k,2,2)-v.y*B(u,3,4)*B(k,3,2),oe=B(u,2,2)*B(k,2,3)-v.y*B(u,3,4)*B(k,3,3),Y=c.x*J+c.y*V+c.z*oe,he=B(u,1,1)*B(k,1,1)-w.x*B(u,3,4)*B(k,3,1),Q=B(u,1,1)*B(k,1,2)-w.x*B(u,3,4)*B(k,3,2),ae=B(u,1,1)*B(k,1,3)-w.x*B(u,3,4)*B(k,3,3),ee=p.x*he+p.y*Q+p.z*ae,le=B(u,2,2)*B(k,2,1)-w.y*B(u,3,4)*B(k,3,1),K=B(u,2,2)*B(k,2,2)-w.y*B(u,3,4)*B(k,3,2),ce=B(u,2,2)*B(k,2,3)-w.y*B(u,3,4)*B(k,3,3),te=p.x*le+p.y*K+p.z*ce,ne=Math.abs(he-U),pe=Math.abs(Q-z),xe=Math.abs(ae-q),Te=Math.abs(he-J),fe=Math.abs(Q-V),Pe=Math.abs(ae-oe),me=Math.abs(le-U),Ae=Math.abs(K-z),Ue=Math.abs(ce-q),_e=Math.abs(le-J),lt=Math.abs(K-V),tt=Math.abs(ce-oe),We=Math.min(ne+pe+xe,Te+fe+Pe),at=Math.min(me+Ae+Ue,_e+lt+tt);We<at&&(he=le,Q=K,ae=ce,ee=te);let Lt=J*q-U*oe,dt=V*q-z*oe,Me=Y*q-W*oe,ve=he*oe-J*ae,Ze=Q*oe-V*ae,It=ee*oe-Y*ae,Rt=(It*dt-Me*Ze)/(ve*dt-Lt*Ze),Et=(It*Lt-Me*ve)/(Ze*Lt-dt*ve),pt=V*U-z*J,Yt=oe*U-q*J,Kt=Y*U-W*J,$t=Q*J-V*he,jt=ae*J-oe*he,Nt=((ee*J-Y*he)*pt-Kt*$t)/(jt*pt-Yt*$t),Fe=k.clone();return Fe.elements[12]=Rt,Fe.elements[13]=Et,Fe.elements[14]=Nt,Nt>0?Fe:null},"makeTransformFromTouchAnchors")),$(this,"updateTouchOrigin",s(()=>{let o=this.renderer.domElement;this.touch.origin.offsetLeft=o.getBoundingClientRect().left,this.touch.origin.offsetTop=o.getBoundingClientRect().top},"updateTouchOrigin")),$(this,"touchToScene",s(o=>{this.touch.touches=[];for(let l=0,u=o.touches.length;l<u;l++){let c=o.touches[l],p=Det(c,this.touch.origin);this.touch.touches.push(new Jt(p.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,-(p.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1))}this.coords.mouse=this.touch.touches[0]},"touchToScene")),$(this,"canScrollZoom",s(o=>{let l=yX(o),u=this.getZoomAltitude();return!(l<0&&u===this.getZoomScaledMax()||l>0&&u===this.getZoomScaledMin())},"canScrollZoom")),$(this,"mouseToScene",s(o=>{let l=this.getMousePos(o);return this.coords.mouse.x=l.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,this.coords.mouse.y=-(l.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1,this.coords.mouse},"mouseToScene")),$(this,"getMousePos",s(o=>({x:o.offsetX,y:o.offsetY}),"getMousePos")),$(this,"handleMouseDownRotate",s(o=>{this.coords.rotateStart.set(o.clientX,o.clientY),this.publish("rotate-start"),this.publish("user-rotate-start")},"handleMouseDownRotate")),$(this,"handleMouseDownPan",s(()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panStart.set(o.x,o.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("pan-start"),this.publish("user-pan-start")},"handleMouseDownPan")),$(this,"handleMouseDownPedestal",s(o=>{let l=new Jt(o.clientX,o.clientY);this.coords.initialShiftPos=l,this.coords.initialPedestal=this.getPedestal(),this.pedestalScaleFactor=VO(this.camera.fov,this.renderer.domElement.clientHeight,this.getZoomAltitude()),this.publish("pedestal-start"),this.publish("user-pedestal-start")},"handleMouseDownPedestal")),$(this,"handleMouseMovePedestal",s(o=>{let l={x:o.clientX,y:o.clientY},u=this.coords.initialPedestal+this.pedestalScaleFactor*(l.y-this.coords.initialShiftPos.y);this.stayInsideBounds&&(u<this.minPedestal?u=Math.max(u,this.minPedestal):u>this.maxPedestal&&(u=Math.min(u,this.maxPedestal))),u!==this.getPedestal()&&this.setPedestal(u,!0)},"handleMouseMovePedestal")),$(this,"handleMouseMoveRotate",s(o=>{this.coords.rotateEnd.set(o.clientX,o.clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setRotation(this.getRotation()+this.coords.rotateDelta.x/this.rotateSpeed),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd),this.publish("change")},"handleMouseMoveRotate")),$(this,"publishUserZoomDebounced",tT(()=>{this.isUserZooming=!1,this.publish("user-zoom-end")},250)),$(this,"publishUserZoomEvent",s(()=>{this.isUserZooming?this.publishUserZoomDebounced():(this.publish("user-zoom-start"),this.isUserZooming=!0,this.publishUserZoomDebounced())},"publishUserZoomEvent")),$(this,"setCameraMoving",s(()=>{this.cameraMoving=!0},"setCameraMoving")),$(this,"unsetCameraMoving",s(()=>{this.cameraMoving=!1,this.lastCameraMoveTime=Date.now()},"unsetCameraMoving")),$(this,"setUserInteracting",s(()=>{this.userInteracting=!0},"setUserInteracting")),$(this,"unsetUserInteracting",s(()=>{this.userInteracting=!1},"unsetUserInteracting")),$(this,"publishPedestalChangeEvent",s(o=>{this.publish("pedestal-change",{pedestal:o,scrolledToTop:this.scrolledToTop,scrolledToBottom:this.scrolledToBottom,scrollPercent:this.scrollPercent})},"publishPedestalChangeEvent")),$(this,"convertAltitudeToZoomLevel",s(o=>{let[,l]=this.center,u=o*2*Math.tan(Gn.degToRad(this.camera.fov)/2)/this.options.canvasHeight,c=Math.cos(Gn.degToRad(l))*2*Math.PI*Zy/u;return Gn.clamp(Math.log2(c/512),cN,hN)},"convertAltitudeToZoomLevel")),$(this,"convertZoomLevelToAltitude",s(o=>{let[,l]=this.center,u=Gn.clamp(o,cN,hN),c=Math.pow(2,u),p=Gn.clamp(l,V4e,j4e),m=c*512;return Math.cos(Gn.degToRad(p))*Math.PI*2*Zy/m*this.options.canvasHeight/2/Math.tan(Gn.degToRad(this.camera.fov)/2)},"convertZoomLevelToAltitude")),$(this,"completeTween",s(o=>{o.isPlaying()&&o.stop(),this.rendererState.tweenGroup.remove(o),this.tweens.delete(o)},"completeTween")),$(this,"debugContainer",new qa),this.camera=e,this.renderer=i,this.rendererState=n,this.scene=r,this.options=a,this.elevation=e.parent,this.orbit=this.elevation.parent,this.cameraPlane=this.createCameraPlane(),this.zoomStart=e.position.z,a.mode!=="outdoors-overlay"&&this.addEventListeners()}get maxZoomLevel(){return this.convertAltitudeToZoomLevel(this.minZoomAltitude)}setMaxZoomLevel(e){this.minZoomAltitude=this.convertZoomLevelToAltitude(e)}get defaultMinZoomLevel(){return b(this,fN)}get minZoomLevel(){return this.convertAltitudeToZoomLevel(this.maxZoomAltitude)}setMinZoomLevel(e){this.maxZoomAltitude=this.convertZoomLevelToAltitude(e)}get scrollPercent(){let e=this.minPedestal,r=this.maxPedestal,i=this.getPedestal();return i=Math.min(i,r),i=Math.max(i,e),(i-e)/(r-e)*100}get fov(){return this.camera.fov}get scrolledToBottom(){return this.minPedestal===0||Math.floor(this.getPedestal())<=this.minPedestal}get scrolledToTop(){return this.maxPedestal===0||Math.ceil(this.getPedestal())>=this.maxPedestal}get center(){var e,r,i,n;let a=this.getPosition(),{lat:o,lon:l}=VB((r=(e=this.rendererState.center)==null?void 0:e[1])!=null?r:0,(n=(i=this.rendererState.center)==null?void 0:i[0])!=null?n:0,a.x,a.y);return[l,o]}setCenter(e,r){var i,n,a,o;let{x:l,y:u}=jB((n=(i=this.rendererState.center)==null?void 0:i[1])!=null?n:0,(o=(a=this.rendererState.center)==null?void 0:a[0])!=null?o:0,r,e);this.setPosition(l,u)}get isAnimating(){return this.rendererState.tweenGroup.getAll().some(e=>e.cameraAnimation)}getCameraFrameForCoordinates(e,r){let i=r.minZoom!==void 0?r.minZoom:this.minZoomAltitude,n=r.maxZoom!==void 0?r.maxZoom:this.maxZoomAltitude,a=this.options.canvasWidth,o=this.options.canvasHeight,l=this.getRotation(),u=this.getTilt(),c=this.getPosition();this.setRotation(r.rotation||l,!0),this.setTilt(r.tilt||u,!0);let p=gN(e,{canvasWidth:a,canvasHeight:o,paddingOption:r.padding,verticalPadding:r.verticalPadding,minZoom:i,maxZoom:n,position:c,camera:this.camera,orbit:this.orbit});return this.setRotation(l,!0),this.setTilt(u,!0),{center:p.position,zoomLevel:this.convertAltitudeToZoomLevel(p.zoom)}}focusOn(e,r){let i=r.curve,n=r.callback,a=r.cancelledCallback,o=r.minZoom!==void 0?r.minZoom:this.minZoomAltitude,l=r.maxZoom!==void 0?r.maxZoom:this.maxZoomAltitude,u=this.options.canvasWidth,c=this.options.canvasHeight,p;r.duration!==void 0?p=r.duration:$a.env.TESTING==="true"?p=0:p=H4e;let m=r.padding,y=this.getRotation(),v=this.getTilt();r.rotation!=null&&this.setRotation(r.rotation),r.tilt!=null&&this.setTilt(r.tilt);let w=gN(e,{canvasHeight:c,paddingOption:m,canvasWidth:u,minZoom:o,maxZoom:l,camera:this.camera,orbit:this.orbit,position:this.getPosition(),verticalPadding:r.verticalPadding});this.setRotation(y),this.setTilt(v),this.animateCamera({position:w.position,tilt:r.tilt,rotation:r.rotation,zoom:w.zoom},p,i,n,a,r)}resize(e,r){this.options.canvasWidth=e,this.options.canvasHeight=r}};fN=new WeakMap,s(mN,"CameraSystem"),$(mN,"CAMERA_FRAME_PADDING_SIDES",["top","bottom","left","right"]);var W4e=mN;function gN(t,{canvasWidth:e,orbit:r,paddingOption:i,verticalPadding:n=0,canvasHeight:a,minZoom:o,maxZoom:l,camera:u,position:c}){let p={zoom:o,position:c};if(t.length===0)return p;for(let _e of W4e.CAMERA_FRAME_PADDING_SIDES)typeof i[_e]!="number"&&(i[_e]=0);let m=i.type==="portion"?{top:i.top*a,bottom:i.bottom*a,left:i.left*e,right:i.right*e}:i;if(m.left+m.right>=e||m.top+m.bottom>=a)return p;r.updateMatrixWorld();let y=u.matrixWorldInverse,v=u.fov*(Math.PI/180)/2,w=v,E=Math.atan(Math.tan(v)*(e/a)),M=new qe(1/0,1/0,1/0),I=new qe(-1/0,-1/0,-1/0),P=new ro,C=new qe;for(let _e=0,lt=t.length;_e<lt;_e++)C.copy(t[_e]),P.expandByPoint(C),C.applyMatrix4(y),M.min(C),I.max(C),C.copy(t[_e]),C.z-=n,C.applyMatrix4(y),M.min(C),I.max(C),C.copy(t[_e]),C.z+=n,C.applyMatrix4(y),M.min(C),I.max(C);let T=I.x-M.x,O=I.y-M.y,F=e-m.left-m.right,k=a-m.top-m.bottom,B=(I.x+M.x)/2,U=(I.y+M.y)/2,z=T/F,q=O/k,W=o,J=l,V=W*Math.tan(E)*2,oe=J*Math.tan(E)*2,Y=V/e,he=oe/e,Q=Math.max(z,q);Q=Gn.clamp(Q,Y,he);let ae=F*Q,ee=k*Q,le={min:{x:B-ae/2-m.left*Q,y:U-ee/2-m.bottom*Q},max:{x:B+ae/2+m.right*Q,y:U+ee/2+m.top*Q}},K=(le.min.x+le.max.x)/2,ce=(le.min.y+le.max.y)/2,te=P.getCenter(new qe),ne=Math.abs(K-le.min.x),pe=Math.abs(ce-le.min.y),xe=ne/Math.tan(E),Te=pe/Math.tan(w),fe=new qe;fe.set(K,ce,I.z+Math.max(xe,Te)),fe.applyMatrix4(u.matrixWorld);let Pe=new qe;Pe.set(K,ce,I.z),Pe.applyMatrix4(u.matrixWorld);let me=new qe().subVectors(Pe,fe),Ae=(te.z-fe.z)/me.z,Ue=new qe().copy(fe).add(me.clone().multiplyScalar(Ae));return Pe.set(Ue.x,Ue.y,Ue.z),fe.sub(Pe),{position:Ue,zoom:fe.length()}}s(gN,"getCameraFrameForPoints");N();var jet=300,_I,xI,X4e=class{constructor(e){$(this,"state"),Be(this,_I,new qe),Be(this,xI,new qe),this.state=e}update(e){var r;let i,n;this.state.cameraObject.getWorldPosition(b(this,xI));for(let a of this.state.geometry2DIdsInScene)if(i=this.state.geometry2DMap.get(a),i&&(n=i.components[0],n&&"containerEl"in n&&n.markerContainer!=null)){if(n.visibilityNeedsUpdate!==!1&&(n.visibilityNeedsUpdate==="show"?n.canShow=!0:n.canShow=!1),(n.canShow&&n.visible===!0||((r=n.animation)==null?void 0:r.pending)===!0)&&!n.offscreen)if(n.options.zIndex!=null)n.markerContainer.style.transform="translate3D(".concat(n.projection.x,"px, ").concat(n.projection.y,"px, ").concat(n.options.zIndex,"px)");else{i.object3d.getWorldPosition(b(this,_I));let o=b(this,xI).distanceTo(b(this,_I));n.markerContainer.style.transform="translate3D(".concat(n.projection.x,"px, ").concat(n.projection.y,"px, ").concat(-o,"px)")}if(n.canShow===!0&&n.visible===!0?n.markerContainer.style.pointerEvents=e?"none":n.pointerEvents:n.markerContainer.style.pointerEvents="none",n.currentStrategyIndex===-1&&n.visible&&n.visibilityNeedsUpdate==="show")continue;n.visibilityNeedsUpdate!==!1&&!n.offscreen&&(n.visibilityNeedsUpdate==="show"&&(n.markerContainer.style.opacity="0"),n.animation&&n.animation.cancel(),n.animation=n.markerContainer.animate([{opacity:n.canShow&&n.visible?"1":"0"}],{duration:jet,easing:"ease-in-out",fill:"forwards"}),n.visibilityNeedsUpdate=!1)}}};_I=new WeakMap,xI=new WeakMap,s(X4e,"DOMDrawSystem");var $et=X4e;N();var Z4e=class{constructor(){$(this,"percentExpanded",0),$(this,"activeId",""),$(this,"gap",20),$(this,"dirty",!0)}};s(Z4e,"StackComponent");var Get=Z4e;N();var Y4e=class extends Wa{constructor(e,r){super(),$(this,"state"),$(this,"dirty",!0),$(this,"domTree"),$(this,"observers",new Map),$(this,"updateDimensions",s(i=>{i.forEach(n=>{var a;let o=(a=n.target.parentElement)==null?void 0:a.getAttribute("data-marker-id");if(o){let l=this.state.geometry2DMap.get(o),u=l==null?void 0:l.components[0];l&&u instanceof dw&&(u.updateDimensions(n.contentRect.width,n.contentRect.height),u.collisionDirty=!0)}}),this.publish("dimensions-update")},"updateDimensions")),this.state=e,this.domTree=r}setupObserver(){var e;if(this.observers){for(let n of this.observers.values())n.disconnect();this.observers.clear()}let r,i;for(let n of this.domTree.children){let a=n.getAttribute("data-marker-id");if(a!=null&&(r=this.state.geometry2DMap.get(a),i=r.components[0],(e=i.options)!=null&&e.dynamicResize)){let o=new ResizeObserver(this.updateDimensions);o.observe(i.containerEl),this.observers.set(n.userData.entityId,o)}}}update(){this.dirty&&(this.setupObserver(),this.dirty=!1)}destroy(){for(let e of this.observers.values())e.disconnect();this.observers.clear()}};s(Y4e,"DOMResizeSystem");var Het=Y4e;N();var qet=0,Wet=90;$a.env.NODE_ENV;var Q_={linear:Ol.Linear.None,"ease-in":Ol.Quadratic.In,"ease-out":Ol.Quadratic.Out,"ease-in-out":Ol.Quadratic.InOut},Xet=-50,hi,Ii,ey,bI,wI,yN,K4e=class{constructor(e,r,i){Be(this,wI),Be(this,hi),Be(this,Ii),Be(this,ey),Be(this,bI),He(this,hi,e),He(this,Ii,r),He(this,ey,i),b(this,Ii).cameraSystem.on("pedestal-change",({pedestal:n})=>{b(this,hi).map&&(b(this,hi).map.transform.elevation=n,b(this,hi).map.transform.minElevationForCurrentTile=Xet,b(this,hi).map.triggerRepaint()),b(this,Ii).cameraSystem.setCameraPlaneElevation(n)})}get center(){return b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?b(this,hi).map.getCenter().toArray():b(this,Ii).cameraSystem.center}setCenter(e){var r;if(b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map){(r=b(this,hi).map)==null||r.setCenter(e),b(this,Ii).interactionSystem.handleHover();return}b(this,Ii).cameraSystem.setCenter(e[0],e[1]),b(this,Ii).interactionSystem.handleHover()}get zoomLevel(){var e;return b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?(e=b(this,hi).map)==null?void 0:e.getZoom():b(this,Ii).cameraSystem.getZoomLevel()}setZoomLevel(e){var r;b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map&&((r=b(this,hi).map)==null||r.setZoom(e)),b(this,Ii).cameraSystem.setZoomLevel(Lp(e,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits."))}get isAnimating(){return b(this,Ii).cameraSystem.isAnimating}cancelAnimation(){b(this,Ii).cameraSystem.cancelAnimation()}get maxZoomLevel(){return b(this,Ii).cameraSystem.maxZoomLevel}get minZoomLevel(){return b(this,Ii).cameraSystem.minZoomLevel}setAutoMinZoomLevel(e){b(this,Ii).panBoundsSystem.autoMinZoomLevel=e,e&&(b(this,Ii).panBoundsSystem.dirty=!0,b(this,Ii).panBoundsSystem.update())}get autoMinZoomLevel(){return b(this,Ii).panBoundsSystem.autoMinZoomLevel}setMinZoomLevel(e,r=!1){var i;r&&this.setAutoMinZoomLevel(!1);let n=Lp(e,_y.MIN_MERCATOR_ZOOM_LEVEL,this.maxZoomLevel,"setMinZoomLevel was clamped. minZoomLevel must be between ".concat(_y.MIN_MERCATOR_ZOOM_LEVEL," and maxZoomLevel."));b(this,Ii).cameraSystem.setMinZoomLevel(n),this.zoomLevel<n&&this.setZoomLevel(n),(i=b(this,hi).map)==null||i.setMinZoom(n)}setMaxZoomLevel(e){var r;let i=Lp(e,this.minZoomLevel,_y.MAX_MERCATOR_ZOOM_LEVEL,"setMaxZoomLevel was clamped. maxZoomLevel must be between minZoomLevel and ".concat(_y.MAX_MERCATOR_ZOOM_LEVEL,"."));b(this,Ii).cameraSystem.setMaxZoomLevel(i),this.zoomLevel>i&&this.setZoomLevel(i),(r=b(this,hi).map)==null||r.setMaxZoom(i)}get maxPitch(){var e;return b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?(e=b(this,hi).map)==null?void 0:e.getMaxPitch():Gn.radToDeg(b(this,Ii).cameraSystem.maxTilt)}get minPitch(){var e;return b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?(e=b(this,hi).map)==null?void 0:e.getMinPitch():Gn.radToDeg(b(this,Ii).cameraSystem.minTilt)}setMinPitch(e){var r;let i=Math.max(qet,e);(r=b(this,hi).map)==null||r.setMinPitch(i),b(this,Ii).cameraSystem.minTilt=Gn.degToRad(i)}setMaxPitch(e){var r;let i=Math.min(Wet,e);(r=b(this,hi).map)==null||r.setMaxPitch(i),b(this,Ii).cameraSystem.maxTilt=Gn.degToRad(i)}get bearing(){var e;return b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?(e=b(this,hi).map)==null?void 0:e.getBearing():Gn.radToDeg(b(this,Ii).cameraSystem.getRotation())}setBearing(e){var r;if(b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map){(r=b(this,hi).map)==null||r.setBearing(e);return}b(this,Ii).cameraSystem.setRotation(Gn.degToRad(e))}get pitch(){var e;return b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?(e=b(this,hi).map)==null?void 0:e.getPitch():Gn.radToDeg(b(this,Ii).cameraSystem.getTilt())}setPitch(e){var r;if(b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map){(r=b(this,hi).map)==null||r.setPitch(e);return}b(this,Ii).cameraSystem.setTilt(Gn.degToRad(Lp(e,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")))}get elevation(){return b(this,Ii).cameraSystem.getPedestal()}setElevation(e){b(this,Ii).cameraSystem.setPedestal(e,!0)}animateElevation(e,r){return b(this,bI)&&b(this,bI).stop(),new Promise(i=>{var n;let a=b(this,Ii).cameraSystem.getPosition();a.z=e,b(this,Ii).cameraSystem.animateCamera({position:a},(r==null?void 0:r.duration)||300,Q_[(r==null?void 0:r.easing)||"ease-in-out"],i,i,{interruptible:(n=r==null?void 0:r.interruptible)!=null?n:!0})})}get insetsPadding(){return b(this,ey).insetsPadding}get panMode(){return b(this,Ii).cameraSystem.enablePan===!1&&b(this,Ii).cameraSystem.enablePedestal===!0?"elevation":"default"}setPanMode(e){if(e!=="default"&&e!=="elevation")throw new Error("Invalid pan mode");e!==this.panMode&&(e==="default"?(b(this,Ii).cameraSystem.enablePan=!0,b(this,Ii).cameraSystem.enablePedestal=!1):(b(this,Ii).cameraSystem.enablePan=!1,b(this,Ii).cameraSystem.enablePedestal=!0))}setInsetPadding(e){b(this,ey).insetsPadding=Object.assign({},zB,e)}animateTo(e){var r,i,n,a,o,l;if(b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map)return(l=b(this,hi).map)==null||l.flyTo({center:(r=e.center)!=null?r:this.center,zoom:(i=e.zoomLevel)!=null?i:this.zoomLevel,bearing:(n=e.bearing)!=null?n:this.bearing,pitch:(a=e.pitch)!=null?a:this.pitch,duration:(o=e.duration)!=null?o:600}),Promise.resolve();let u=e.center?b(this,hi).convertTo3DMapPosition(e.center[1],e.center[0],e.center[2]||this.elevation):void 0,c=e.zoomLevel!==void 0?b(this,Ii).cameraSystem.convertZoomLevelToAltitude(Lp(e.zoomLevel,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits.")):void 0,p=e.bearing!==void 0?Gn.degToRad(e.bearing):void 0,m=e.pitch!==void 0?Gn.degToRad(Lp(e.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0;return new Promise(y=>{var v;b(this,Ii).cameraSystem.animateCamera({position:u,zoom:c,rotation:p,tilt:m},e.duration||0,Q_[e.easing||"ease-in-out"],()=>{b(this,Ii).interactionSystem.handleHover(),y()},y,{interruptible:(v=e==null?void 0:e.interruptible)!=null?v:!0})})}getCameraFrameForCoordinates(e,r){let i=dr(this,wI,yN).call(this,r||{},()=>Promise.resolve()),{pointCloud:n}=vN(e,b(this,hi),b(this,ey).geometry3DMap);if(n.length===0)return Vt.error("No valid coordinates found in targets:",e),{center:this.center,zoomLevel:this.zoomLevel};let{center:a,zoomLevel:o}=b(this,Ii).cameraSystem.getCameraFrameForCoordinates(n,i);return{center:b(this,hi).convert3DMapPositionToCoordinate(a),zoomLevel:o}}focusOn(e,r){var i,n,a,o;let{pointCloud:l,geoBounds:u,firstPosition:c}=vN(e,b(this,hi),b(this,ey).geometry3DMap);return l.length===0?(Vt.error("No valid coordinates found in targets:",e),Promise.resolve()):b(this,hi).mode==="outdoors-overlay"&&b(this,hi).map?(l.length===1&&c?(i=b(this,hi).map)==null||i.flyTo({center:[c[0],c[1]],duration:(r==null?void 0:r.duration)||b(this,hi).map.getBearing(),animate:!0,bearing:(r==null?void 0:r.bearing)===void 0?b(this,hi).map.getBearing():r==null?void 0:r.bearing,pitch:(r==null?void 0:r.pitch)===void 0?b(this,hi).map.getPitch():r==null?void 0:r.pitch,zoom:(r==null?void 0:r.maxZoomLevel)||b(this,hi).map.getMaxZoom()}):(o=b(this,hi).map)==null||o.fitBounds(u,{duration:(n=r==null?void 0:r.duration)!=null?n:_y.DEFAULT_ANIMATION_DURATION,bearing:(r==null?void 0:r.bearing)===void 0?b(this,hi).map.getBearing():r==null?void 0:r.bearing,pitch:(r==null?void 0:r.pitch)===void 0?b(this,hi).map.getPitch():r==null?void 0:r.pitch,maxZoom:(a=r==null?void 0:r.maxZoomLevel)!=null?a:b(this,hi).map.getMaxZoom()}),b(this,Ii).interactionSystem.handleHover(),Promise.resolve()):new Promise(p=>{b(this,Ii).cameraSystem.focusOn(l,dr(this,wI,yN).call(this,r||{},p))})}};hi=new WeakMap,Ii=new WeakMap,ey=new WeakMap,bI=new WeakMap,wI=new WeakSet,yN=s(function(t,e){var r;return{minZoom:(t==null?void 0:t.maxZoomLevel)===void 0?void 0:b(this,Ii).cameraSystem.convertZoomLevelToAltitude(Lp(t.maxZoomLevel,this.minZoomLevel,this.maxZoomLevel,"maxZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMaxZoomLevel() to adjust limits.")),maxZoom:(t==null?void 0:t.minZoomLevel)===void 0?void 0:b(this,Ii).cameraSystem.convertZoomLevelToAltitude(Lp(t.minZoomLevel,this.minZoomLevel,this.maxZoomLevel,"minZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() to adjust limits.")),padding:t!=null&&t.padding?Object.assign({},zB,t==null?void 0:t.padding):this.insetsPadding,curve:Q_[(t==null?void 0:t.easing)||"ease-in-out"],rotation:(t==null?void 0:t.bearing)===void 0?void 0:Gn.degToRad(t.bearing),tilt:(t==null?void 0:t.pitch)!==void 0?Gn.degToRad(Lp(t.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0,duration:t==null?void 0:t.duration,callback:s(()=>{b(this,Ii).interactionSystem.handleHover(),e()},"callback"),cancelledCallback:e,interruptible:(r=t==null?void 0:t.interruptible)!=null?r:!0,verticalPadding:t==null?void 0:t.verticalPadding}},"#convertToLegacy"),s(K4e,"Camera");var Zet=K4e;function AI(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}s(AI,"updateBounds");function vN(t,e,r){var i;let n=[],a=[1/0,1/0,-1/0,-1/0],o=null;if(!t||!Array.isArray(t)||t.length===0)return{pointCloud:n,geoBounds:a,firstPosition:o};let l=e.getSystems().renderSystem;(l.threeDdirty||l.twoDdirty)&&e.renderSync();for(let u of t)if(typeof u=="string"){let c=r.get(u);if(!c){Vt.error("Entity not found with id:",u);continue}let p=new ro;yge(e,"userData"in c&&(i=c.userData.entityId)!=null?i:c.id,n,p,c instanceof Kn?c.position.z:void 0);let m=e.convert3DMapPositionToCoordinate(p.min),y=e.convert3DMapPositionToCoordinate(p.max);AI(a,m),AI(a,y),o||(o=e.convert3DMapPositionToCoordinate(p.getCenter(new qe)))}else n.push(e.convertTo3DMapPosition(u[1],u[0],u[2]||0)),AI(a,u),o||(o=u);return{pointCloud:n,geoBounds:a,firstPosition:o}}s(vN,"processTargets");function Yet(t,e){var r,i,n,a;let o=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]];(r=t.map)!=null&&r.getLayer("bounds-outline")&&t.map.removeLayer("bounds-outline"),(i=t.map)!=null&&i.getSource("bounds-source")&&t.map.removeSource("bounds-source"),(n=t.map)==null||n.addSource("bounds-source",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:o}}}),(a=t.map)==null||a.addLayer({id:"bounds-outline",type:"line",source:"bounds-source",layout:{},paint:{"line-color":"#FF0000","line-width":2,"line-opacity":.8}})}s(Yet,"drawBounds");N();N();var Ket=`uniform vec4 uSize;
varying vec2 vUv;
void main() {
  vUv = uv;
  // Scale the position by the size of the quad
  // and shift to top left corner for 0,0
	vec2 transformed = position.xy * uSize.xy - vec2(1.0, -1.0);
  // Apply width .x and height .y of image
  transformed += vec2(uSize.x, -uSize.y);
  // Apply left .w and top .z offset
  transformed += vec2(uSize.w, -uSize.z) * 2.0;
  gl_Position = vec4(transformed, 1.0, 1.0);
}`;N();var Jet=`varying vec2 vUv;
uniform sampler2D uTexture;
uniform float uOpacity;
void main() {
  #ifndef debug
  vec4 texture = texture2D(uTexture, vUv);
  gl_FragColor = vec4(texture.rgb, texture.a * uOpacity);
  #else
  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  #endif
}`;N();var Qet=4.291666666666667,ett=15,ttt=25,rtt=43/60;N();var xX=["horizontal","icon"],itt=new Map([[xX[0],`<svg viewBox="0 0 206 48">
      <path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z"/>
      <path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z"/>
      <path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z"/>
      <path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z"/>
    </svg>`],[xX[1],`<svg viewBox="0 0 43 60">
      <path d="M14.0291 7.06645C14.0291 10.9691 10.8885 14.1329 7.01453 14.1329C3.14051 14.1329 0 10.9691 0 7.06645C0 3.16376 3.14051 0 7.01453 0C10.8885 0 14.0291 3.16376 14.0291 7.06645Z"/>
      <path d="M28.7335 18.3468H35.1045C36.7455 18.3468 37.5178 19.0599 37.5821 20.6158V57.7309C37.5821 59.2868 36.8099 60 35.1367 60H28.9588C27.1569 60 26.642 59.7406 25.6767 58.282L12.6452 38.282V57.7309C12.6452 59.2868 11.8729 60 10.1997 60H3.82873C2.15554 60 1.3833 59.2868 1.3833 57.7309V20.6158C1.3833 19.0599 2.15554 18.3468 3.82873 18.3468H10.1032C11.9051 18.4116 12.4843 18.671 13.3852 20.0648L26.3524 40.162V20.6158C26.3524 19.0599 27.1247 18.3468 28.7335 18.3468Z"/>
      <path d="M41.5 60C42.3362 60 43 59.3143 43 58.5V58.4914C43 57.6771 42.3448 57 41.5 57C40.6638 57 40 57.6857 40 58.5V58.5086C40 59.3229 40.6552 60 41.5 60ZM41.5 59.8371C40.7414 59.8371 40.1724 59.2371 40.1724 58.5086V58.5C40.1724 57.7714 40.75 57.1629 41.5 57.1629C42.2586 57.1629 42.8276 57.7629 42.8276 58.4914V58.5C42.8276 59.2286 42.25 59.8371 41.5 59.8371ZM40.9138 59.2286H41.2069V58.7057H41.5259L41.8879 59.2286H42.2414L41.8362 58.6543C42.0431 58.5943 42.1897 58.44 42.1897 58.1914C42.1897 57.8743 41.9397 57.7114 41.6034 57.7114H40.9138V59.2286ZM41.2069 58.4657V57.9686H41.5776C41.7759 57.9686 41.8879 58.0543 41.8879 58.2171C41.8879 58.3629 41.7759 58.4657 41.5776 58.4657H41.2069Z"/>
    </svg>`]]),ntt=/<svg([^>]*)>/g;function J4e(t,e,r,i){let n=itt.get(t);return n?n.replace(ntt,'<svg$1 width="'.concat(r,'" height="').concat(i,'" xmlns="http://www.w3.org/2000/svg" style="fill: ').concat(e,';">')):""}s(J4e,"getLogoIcon");var bX=!1,Ea,xm,z2,Bs,Su,n1,wp,zd,Q4e=class extends Wa{constructor(e,r,i){super(),Be(this,Ea,{padding:16,scale:1,iconOnly:!1,position:"bottom-left",color:"dark",onClick:s(()=>{window!=null&&window.open("https://www.mappedin.com")},"onClick"),interactive:!0,visible:!0}),Be(this,xm),Be(this,z2),Be(this,Bs),Be(this,Su),Be(this,n1),Be(this,wp,0),Be(this,zd,0),$(this,"dirty",!0),$(this,"getPositionAlignedCanvasCoordinates",s((n,a)=>({"top-left":{x:0,y:0},"top-right":{x:n,y:0},"bottom-left":{x:0,y:a},"bottom-right":{x:n,y:a},center:{x:n/2,y:a/2},top:{x:n/2,y:0},bottom:{x:n/2,y:a},left:{x:0,y:a/2},right:{x:n,y:a/2}})[b(this,Ea).position],"getPositionAlignedCanvasCoordinates")),$(this,"getPositionAlignedPadding",s(()=>{var n,a,o,l;let u=b(this,Ea).padding;if(typeof u=="number")return{"top-left":{x:u,y:u},"top-right":{x:-u,y:u},"bottom-left":{x:u,y:-u},"bottom-right":{x:-u,y:-u},center:{x:0,y:0},top:{x:0,y:u},bottom:{x:0,y:-u},left:{x:u,y:0},right:{x:-u,y:0}}[b(this,Ea).position];let c={top:(n=u.top)!=null?n:0,right:(a=u.right)!=null?a:0,bottom:(o=u.bottom)!=null?o:0,left:(l=u.left)!=null?l:0};return{x:c.left-c.right,y:c.top-c.bottom}},"getPositionAlignedPadding")),i&&Object.entries(i).forEach(([n,a])=>{a!==void 0&&(b(this,Ea)[n]=a)}),He(this,z2,e),He(this,xm,r)}get color(){return b(this,Ea).color==="light"?"white":"#293136"}get iconName(){return b(this,Ea).iconOnly?"icon":"horizontal"}get minWidth(){return b(this,Ea).iconOnly?ett:75}get defaultWidth(){return b(this,Ea).iconOnly?ttt:150}get aspectRatio(){return b(this,Ea).iconOnly?rtt:Qet}get options(){return Ee({},b(this,Ea))}set options(e){var r,i;He(this,Ea,{padding:e.padding||b(this,Ea).padding,position:e.position||b(this,Ea).position,iconOnly:e.iconOnly||b(this,Ea).iconOnly,color:e.color||b(this,Ea).color,scale:e.scale||b(this,Ea).scale,onClick:b(this,Ea).onClick,interactive:(r=e.interactive)!=null?r:b(this,Ea).interactive,visible:(i=e.visible)!=null?i:b(this,Ea).visible})}get icon(){return J4e(this.iconName,this.color,b(this,wp)*b(this,xm).pixelRatio,b(this,zd)*b(this,xm).pixelRatio)}setSize(e,r){b(this,Su)&&(b(this,Su).uniforms.uSize.value.x=e,b(this,Su).uniforms.uSize.value.y=r)}setXY(e,r){b(this,Su)&&(b(this,Su).uniforms.uSize.value.w=e,b(this,Su).uniforms.uSize.value.z=r)}get width(){return b(this,wp)}get height(){return b(this,zd)}getPositionAlignedOffset(e,r){return{"top-left":{x:0,y:0},"top-right":{x:-e,y:0},"bottom-left":{x:0,y:-r},"bottom-right":{x:-e,y:-r},center:{x:-(e/2),y:-(r/2)},top:{x:-(e/2),y:0},bottom:{x:-(e/2),y:-r},left:{x:0,y:-(r/2)},right:{x:-e,y:-(r/2)}}[b(this,Ea).position]}insertIntoQuadTree(e){b(this,n1)!=null&&typeof b(this,Ea).onClick=="function"&&b(this,Ea).interactive&&e.insert(b(this,n1))}resize(e,r){if(b(this,Ea).visible!==!0)return;let i=this.getPositionAlignedCanvasCoordinates(e,r),n=this.getPositionAlignedPadding(),a=this.getPositionAlignedOffset(b(this,wp),b(this,zd)),o=Math.min(e-b(this,wp),Math.max(0,i.x+n.x+a.x)),l=Math.min(r-b(this,zd),Math.max(0,i.y+n.y+a.y));this.setSize(b(this,wp)/e,b(this,zd)/r),this.setXY(o/e,l/r),He(this,n1,new Jc(o,l,b(this,wp),b(this,zd),{entityId:"watermark"}))}update(){this.dirty&&(b(this,Ea).visible===!0?(He(this,wp,Math.min(b(this,xm).canvasWidth,Math.max(this.minWidth,this.defaultWidth*b(this,Ea).scale))),He(this,zd,b(this,wp)/this.aspectRatio),X5.getLoader().load("data:image/svg+xml;base64,".concat(btoa(this.icon)),e=>{if(He(this,Su,new bc({uniforms:{uTexture:{value:e},uSize:{value:new Qn(0,0,0,0)},uOpacity:{value:.7}},vertexShader:Ket,fragmentShader:Jet,depthWrite:!1,depthTest:!1,defines:{debug:bX},wireframe:bX,transparent:!0,visible:!0})),b(this,Bs))b(this,Bs).visible=!0,b(this,Bs).material=b(this,Su),b(this,Bs).material.needsUpdate=!0;else{let r=new pv(2,2,1,1);He(this,Bs,new Pn(r,b(this,Su))),b(this,Bs).position.set(0,0,-1),b(this,Bs).frustumCulled=!1,b(this,Bs).renderOrder=999;let i=new RA(1,1,1),n=new Pn(i,new ug({transparent:!0,opacity:0,depthTest:!1,depthWrite:!1}));n.frustumCulled=!1,n.layers.set(1),b(this,Bs).add(n),b(this,z2).add(b(this,Bs))}this.resize(b(this,xm).canvasWidth,b(this,xm).canvasHeight),this.publish("texture-loaded")})):b(this,Bs)&&(b(this,Bs).visible=!1),this.dirty=!1)}destroy(){b(this,Bs)&&(b(this,z2).remove(b(this,Bs)),Cl(b(this,Bs))),He(this,Bs,void 0),b(this,Su)&&b(this,Su).dispose(),He(this,Su,void 0),He(this,n1,void 0)}};Ea=new WeakMap,xm=new WeakMap,z2=new WeakMap,Bs=new WeakMap,Su=new WeakMap,n1=new WeakMap,wp=new WeakMap,zd=new WeakMap,s(Q4e,"WatermarkSystem");var att=Q4e;N();var bE=100,ott=!1,eLe=class extends Wa{constructor(e,r){super(),$(this,"currentTotalBoundingBox"),$(this,"state"),$(this,"cameraSystem"),$(this,"debugMesh",null),$(this,"dirty",!0),$(this,"autoMinZoomLevel",!0),this.state=e,this.cameraSystem=r}update(){if(this.dirty){this.currentTotalBoundingBox==null&&(this.currentTotalBoundingBox=new ro,this.state.entityScene.children.length===0?this.currentTotalBoundingBox.setFromCenterAndSize(new qe(0,0,0),new qe(bE*2,bE*2,0)):(this.currentTotalBoundingBox.setFromObject(this.state.entityScene),this.currentTotalBoundingBox.expandByScalar(bE)));let e=new ro().setFromObject(this.state.entityScene);this.currentTotalBoundingBox.union(e);let r=e.getSize(new qe),i=Math.max(r.x,r.y,r.z);for(let a of this.state.geometry2DMap.values())a.positionDirty===!0&&(this.currentTotalBoundingBox.expandByPoint(a.position),a.positionDirty=!1);let n=U6.copy(this.currentTotalBoundingBox).expandByScalar(Math.max(i,bE)).getBoundingSphere(ltt).radius;this.cameraSystem.panBounds={center:this.currentTotalBoundingBox.getCenter(new qe),min:U6.min,max:U6.max,radius:n},this.publish("update"),this.cameraSystem.dirty=!0,this.dirty=!1}}};s(eLe,"PanBoundsSystem");var stt=eLe,U6=new ro,ltt=new Ru;N();var wX=" Mappedin",utt="https://info.mappedin.com/feedback",AX=["top-left","top-right","bottom-left","bottom-right"],ctt=640,htt=s(()=>`<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15' fill-rule='evenodd' viewBox='0 0 20 20'>
						<circle cx='10' cy='10' r='5.9' style='fill:rgba(255,255,255,1);'/>
						<path style='fill:rgba(0,0,0,0.7);' d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/>
					</svg>`,"getAttributionButtonIcon"),V6={custom:[],position:"bottom-right",feedback:!0},tLe=class{constructor(e){$(this,"controlContainerEl"),$(this,"controlPositions"),$(this,"compact"),$(this,"attribContainerEl"),$(this,"attribInnerEl"),$(this,"attribButtonEl"),$(this,"feedbackLinkEl"),$(this,"attribHTML",wX),$(this,"customAttributions",[]),$(this,"toggleAttribution",s(r=>{this.attribContainerEl!=null&&(r.preventDefault(),this.attribContainerEl.classList.contains("mappedin-compact")&&(this.attribContainerEl.classList.contains("mappedin-compact-show")?(this.attribContainerEl.removeAttribute("open"),this.attribContainerEl.classList.remove("mappedin-compact-show")):(this.attribContainerEl.classList.add("mappedin-compact-show"),this.attribContainerEl.setAttribute("open",""))))},"toggleAttribution")),this.controlContainerEl=document.createElement("div"),this.controlContainerEl.classList.add("mappedin-control-container"),e.appendChild(this.controlContainerEl),this.controlPositions=AX.reduce((r,i)=>{let n=document.createElement("div");return n.classList.add("mappedin-ctrl-".concat(i)),this.controlContainerEl.appendChild(n),r[i]=n,r},{})}addAttributionControl(e=V6){var r;let i=e.position&&AX.includes(e.position)?e.position:V6.position;this.attribContainerEl=document.createElement("details"),this.attribContainerEl.classList.add("mappedin-ctrl-attrib","mappedin-ctrl-attrib-".concat(i)),this.attribContainerEl.open=!0,this.attribContainerEl.tabIndex=0,this.attribContainerEl.ariaLabel="Attribution",this.controlPositions[i].appendChild(this.attribContainerEl),this.attribButtonEl=document.createElement("summary"),this.attribButtonEl.addEventListener("click",this.toggleAttribution),this.attribButtonEl.classList.add("mappedin-ctrl-attrib-button"),this.attribButtonEl.title="Toggle attribution",this.attribButtonEl.ariaLabel="Toggle attribution",this.attribButtonEl.tabIndex=0,this.attribButtonEl.innerHTML=htt(),this.attribContainerEl.appendChild(this.attribButtonEl),this.attribInnerEl=document.createElement("div"),this.attribInnerEl.classList.add("mappedin-ctrl-attrib-inner"),this.attribInnerEl.innerHTML=this.attribHTML,this.attribContainerEl.appendChild(this.attribInnerEl),((r=e.feedback)!=null?r:V6.feedback)&&(this.feedbackLinkEl=document.createElement("a"),this.feedbackLinkEl.href=utt,this.feedbackLinkEl.target="_blank",this.feedbackLinkEl.rel="noopener",this.feedbackLinkEl.textContent="Provide Feedback",this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner"),this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner-bold"),this.attribContainerEl.appendChild(this.feedbackLinkEl)),e.custom&&(this.customAttributions=e.custom),this.updateAttributionDisplay()}updateAttribution(e){if(!e.style||!this.attribInnerEl||!this.attribContainerEl)return;let r=[wX],i=e.style.sourceCaches;for(let n in i){let a=i[n];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&r.indexOf(o.attribution)<0&&r.push(o.attribution)}}r=r.filter(n=>String(n).trim()),r=r.filter((n,a)=>{for(let o=a+1;o<r.length;o++)if(r[o].indexOf(n)>=0)return!1;return!0}),this.attribHTML=r.join(" "),this.updateAttributionDisplay()}updateAttributionDisplay(){let e=[...new Set([this.attribHTML,...this.customAttributions])].filter(Boolean).join(" ");this.attribInnerEl&&(this.attribInnerEl.innerHTML=e)}resizeAttribution(e){this.attribContainerEl&&(e<=ctt||this.compact?this.compact===!1?this.attribContainerEl.setAttribute("open",""):!this.attribContainerEl.classList.contains("mappedin-compact")&&!this.attribContainerEl.classList.contains("mappedin-attrib-empty")&&(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.add("mappedin-compact","mappedin-compact-show")):(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.contains("mappedin-compact")&&this.attribContainerEl.classList.remove("mappedin-compact","mappedin-compact-show")))}destroyAttributionControl(){this.attribButtonEl&&this.attribButtonEl.removeEventListener("click",this.toggleAttribution),this.attribContainerEl&&(this.attribContainerEl.remove(),this.attribContainerEl=void 0,this.attribInnerEl=void 0,this.attribButtonEl=void 0)}resize(e){this.resizeAttribution(e)}updateData(e){this.updateAttribution(e)}destroy(){this.destroyAttributionControl(),this.controlContainerEl.remove(),this.compact=void 0}};s(tLe,"HTMLControlsSystem");var ptt=tLe;N();var SI,MI,rLe=class{constructor(e,r){$(this,"mesh"),$(this,"type","custom-geometry"),$(this,"dirty",!0),$(this,"feature"),$(this,"builder"),$(this,"outline"),Be(this,SI,1),$(this,"color",new si),Be(this,MI,0),this.mesh=new hx,this.feature=e,this.builder=r}get visible(){return this.mesh.visible}set visible(e){this.mesh.visible=e}set opacity(e){He(this,SI,e)}get opacity(){return b(this,SI)}setColor(e){this.color.set(e)}get position(){var e;return(e=this.mesh)==null?void 0:e.position}get altitude(){return b(this,MI)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,MI,e))}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}};SI=new WeakMap,MI=new WeakMap,s(rLe,"CustomGeometryComponent");var j6=rLe;N();var iLe=class{constructor(e,r){$(this,"state"),$(this,"convertTo3DMapPosition"),this.state=e,this.convertTo3DMapPosition=r}update(){let e,r;for(let i of this.state.geometry3DIdsInScene){let n=this.state.geometry3DMap.get(i);(n==null?void 0:n.type)==="custom-geometry"&&(e=n.components[0],r=n.components[1],e.dirty&&r.visible!==!1&&(e.position.copy(this.convertTo3DMapPosition(e.feature.geometry.coordinates[1],e.feature.geometry.coordinates[0],r.altitude)),e.builder.setup(e.mesh),e.mesh.traverse(a=>{a.userData={entityId:i,type:"custom-geometry"}}),e.dirty=!1),r.visible!==!1&&e.builder.update(e.mesh))}}};s(iLe,"CustomGeometrySystem");var dtt=iLe;N();N();function nLe(t){return t.children.some(e=>e.userData.isOutline)}s(nLe,"hasOutline");var ftt=80,a1,U2,_N,xN,aLe=class{constructor(e){$(this,"rendererState"),$(this,"outlineOpacitiesDirty",!0),Be(this,a1,!0),Be(this,U2,-1/0),Be(this,_N,new Map),Be(this,xN,new AB({vertexColors:!0,linewidth:1,transparent:!0,opacity:1,side:Qp})),this.rendererState=e}get geometries3DDirty(){return b(this,a1)}set geometries3DDirty(e){He(this,a1,e)}update(e,r=!0){let i;if(this.geometries3DDirty){for(let a of this.rendererState.geometry3DMap.values())if(a instanceof Kn&&(a.visible||a.userData.preloadGeometry)){for(let o of a.children)if(o instanceof Fu&&o.components[0].outline&&(o.visible||a.userData.preloadGeometry)&&!nLe(o)&&o.userData.entities3D.size>0)for(let l of o.userData.entities3D.values()){let u=this.rendererState.geometry3DMap.get(l),c=[];if(u instanceof Ua&&u.type==="geometry"&&u.components[3]&&u.components[3].dirty===!0&&u.components[0].geometry!=null&&u.components[0].material!=null){let M=u.components[0].geometry;if(!M)continue;c.push([u.components[3],new HVe(M,ftt)])}if(c.length===0)continue;let p=fv(c.map(M=>M[1]),!1);if(p==null)continue;let m=p.getAttribute("position"),y=new Float32Array(m.count*4),v=new Yo(y,4);p.setAttribute("color",v);let w=0;for(let M=0;M<c.length;M++){let[I,P]=c[M],C=P.getAttribute("position").count;I.edgeColors=v,I.geometry=p,I.ranges={count:C,start:w},w+=C,P.dispose()}let E=new NP(p,b(this,xN));E.userData.isOutline=!0,o.add(E)}}He(this,a1,!1),this.outlineOpacitiesDirty=!0}for(let a of this.rendererState.geometry3DIdsInScene){let o=this.rendererState.geometry3DMap.get(a);if(o instanceof Ua&&o.type==="geometry"&&o.components[3]&&o.components[3].dirty===!0&&o.components[0].geometry!=null&&o.components[0].material!=null&&o.parentObject3D instanceof Fu){let l=o.components[3].geometry;if(!l)continue;let u=o.components[3];if(!u)continue;let c=u.edgeColors;if(!c)continue;let p=new si(u.color);for(let w=0;w<u.ranges.count;w++){let E=u.ranges.start+w;c.setXYZ(E,p.r,p.g,p.b)}let m=o.components[1].height,y=l.getAttribute("position").array,v=-1/0;for(let w=0;w<u.ranges.count;w++){let E=(u.ranges.start+w)*3,M=y[E+2];v=Math.max(v,M)}for(let w=0;w<u.ranges.count;w++){let E=(u.ranges.start+w)*3,M=y[E+2];Math.abs(M-v)<1e-4&&(y[E+2]=Math.max(m,2e-4))}l.attributes.color.needsUpdate=!0,l.attributes.position.needsUpdate=!0,u.dirty=!1}}let n=r?Yy(e,16,19,0,1):b(this,U2);if((n!==b(this,U2)||this.outlineOpacitiesDirty)&&this.rendererState.geometry3DIdsInScene.size>0){for(let a of this.rendererState.geometry3DIdsInScene)if(i=this.rendererState.geometry3DMap.get(a),(i==null?void 0:i.type)==="geometry"&&i.components[0]instanceof ru){let o=i.components[3];if(o&&o.edgeColors&&o.geometry){let l=o.visible,u=Math.min(n,l?i.components[1].opacity*kw(i):0);if(o.currentOpacity!==u){for(let c=0;c<o.ranges.count;c++){let p=o.ranges.start+c;o.edgeColors.setW(p,u)}o.geometry.attributes.color.needsUpdate=!0}}}}He(this,U2,n),He(this,a1,!1),this.outlineOpacitiesDirty=!1}destroy(){b(this,_N).clear()}};a1=new WeakMap,U2=new WeakMap,_N=new WeakMap,xN=new WeakMap,s(aLe,"OutlineInterpolationSystem");var mtt=aLe;N();N();var oLe=class extends Pn{constructor(){super(...arguments),$(this,"userData",{entityId:""})}};s(oLe,"EntityMesh");var gtt=oLe,ytt=xt.object({flipImageToFaceCamera:xt.boolean().optional(),url:xt.string()}),vtt=xt.object({type:xt.enum(["Feature"]),properties:xt.object({width:xt.number(),height:xt.number(),rotation:xt.number().min(0).max(360).optional(),verticalOffset:xt.number().optional()}),geometry:_j});function sLe(t,e,r){xt.union([xt.number(),xt.string()]).parse(t),vtt.parse(e),ytt.parse(r)}s(sLe,"validateImage");var lLe=class{constructor(e){$(this,"mesh",new hx),$(this,"imageMesh"),$(this,"outline"),$(this,"type","image"),$(this,"instanceIndex",-1),$(this,"geometry"),$(this,"material"),$(this,"feature"),$(this,"position",new qe),this.feature=e}get visible(){var e,r;return(r=(e=this.mesh)==null?void 0:e.visible)!=null?r:!1}set visible(e){this.mesh&&(this.mesh.visible=e)}};s(lLe,"ImageComponent");var _tt=lLe;N();function GT(t,e){return{x:t.x*Math.cos(e)-t.y*Math.sin(e),y:t.x*Math.sin(e)+t.y*Math.cos(e)}}s(GT,"rotatePoint");function uLe(t,e){return t.map(r=>GT(r,e))}s(uLe,"rotatePoints");function cLe(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let a of t)e=Math.min(e,a.x),r=Math.min(r,a.y),i=Math.max(i,a.x),n=Math.max(n,a.y);return{minX:e,minY:r,maxX:i,maxY:n}}s(cLe,"getBounds");function hLe(t,e){let r=!1;for(let i=0,n=e.length-1;i<e.length;n=i++){let a=e[i].x,o=e[i].y,l=e[n].x,u=e[n].y;o>t.y!=u>t.y&&t.x<(l-a)*(t.y-o)/(u-o)+a&&(r=!r)}return r}s(hLe,"pointInPolygon");function bj(t,e,r,i,n){for(let a=0;a<n;a++)for(let o=0;o<i;o++)if(t[r+a][e+o]!==1)return!1;return!0}s(bj,"isValidRectangle");function pLe(t,e,r){let i=t.maxX-t.minX,n=t.maxY-t.minY,a,o,l=Ee({},t);return i/n>e?(o=n/r,a=o*e,l.minX+=(i-a*r)/2):(a=i/r,o=a/e,l.minY+=(n-o*r)/2),{dx:a,dy:o,gridBounds:l}}s(pLe,"calculateGridDimensions");function dLe(t,e,r,i,n){let a=Array(r).fill(0).map(()=>Array(r).fill(0));for(let o=0;o<r;o++)for(let l=0;l<r;l++){let u={x:e.minX+l*i,y:e.minY+o*n};hLe(u,t)&&(a[o][l]=1)}return a}s(dLe,"createAndFillGrid");function fLe(t,e){let r=Array(e).fill(0).map(()=>Array(e).fill(0));for(let i=0;i<e;i++)for(let n=0;n<e;n++)if(t[i][n]===1){let a=0;for(let o=1;o<=Math.min(e-n,e-i)&&bj(t,n,i,o,o);o++)a=o;r[i][n]=a}return r}s(fLe,"calculateRectSizes");function mLe(t,e,r,i,n,a){let o=0,l=0,u=0;for(let c=0;c<i;c++)for(let p=0;p<i;p++)if(t[c][p]===1){let m=Math.pow(e[c][p],2),y=r.minX+p*n,v=r.minY+c*a;o+=m,l+=y*m,u+=v*m}return{x:l/o,y:u/o}}s(mLe,"calculatePolygonCenter");function gLe(t,e,r,i,n,a,o){let l=-1/0,u=null,c=t.length,p=Math.sqrt(Math.pow(e.maxX-e.minX,2)+Math.pow(e.maxY-e.minY,2));for(let m=0;m<c;m++)for(let y=0;y<c;y++)if(t[m][y]===1)for(let v=1;v<=c-y;v++){let w=v;if(!(w>c-m)&&bj(t,y,m,v,w)){let E=v*w,M=e.minX+(y+v/2)*r,I=e.minY+(m+w/2)*i,P={x:M,y:I},C=Math.sqrt(Math.pow(P.x-n.x,2)+Math.pow(P.y-n.y,2))/p,T=E*(1-a)-C*a*E;T>l&&(l=T,u={center:P,width:v*r*o,height:v*i*o})}}return u}s(gLe,"findBestRectangle");function bN(t,e,r,i={}){let{scaleFactor:n=.9,centerPriority:a=.5,resolution:o=100,minimumSizeRatio:l=.5}=i,u=Vp(r),c=t.width/t.height,p=uLe(e,u),m=cLe(p),{dx:y,dy:v,gridBounds:w}=pLe(m,c,o),E=dLe(p,w,o,y,v),M=fLe(E,o),I=mLe(E,M,w,o,y,v),P=gLe(E,w,y,v,I,a,n);return!P||P.width<t.width*l||P.height<t.height*l?t:vt(Ee({},P),{center:GT(P.center,-u),rotation:r,polygonCenter:GT(I,-u)})}s(bN,"findLargestInteriorRectangle");var Hb=Math.PI*2,xtt=Math.PI/2,btt=Math.PI*1.5,wtt=UA(xtt,2),Att=UA(btt,2),Stt=.01,Mtt=!1,yLe=class extends Wa{constructor(e,r,i=0,n=0,a={}){super(),$(this,"rendererState"),$(this,"convertTo3DMapPosition"),$(this,"initialBearing",0),$(this,"naturalBearing",0),$(this,"imagePlacementOptions"),$(this,"imageLoadingCache",new Map),this.rendererState=e,this.convertTo3DMapPosition=r,this.initialBearing=i,this.naturalBearing=n,this.imagePlacementOptions=a}createImageMesh(e,r,i,n=0,a,o){var l,u,c;let p={width:i.width,height:i.height,center:this.convertTo3DMapPosition(a),rotation:(l=i.rotation)!=null?l:0},m=(u=this.imagePlacementOptions.mode)!=null?u:"default",y=(()=>{switch(m){case"fit-nearest-90":let M=(this.initialBearing-this.naturalBearing+360)%180;return M>=45&&M<=135?bN(p,o,p.rotation+90,this.imagePlacementOptions):p;case"fit-initial-bearing":return bN(p,o,this.initialBearing,this.imagePlacementOptions);case"default":case"none":default:return p}})(),v=new O_({transparent:!0,depthWrite:!1,side:Pu}),w=new pv(y.width,y.height),E=new gtt(w);return E.visible=!1,(c=this.getOrDownloadImage(r))==null||c.then(M=>{v.map=M,v.needsUpdate=!0,v.map.colorSpace=nl,E.visible=!0,this.publish("image-loaded")}),E.userData.entityId=e,E.material=v,E.position.set(y.center.x,y.center.y,n+Stt),E.rotation.z=(-Gn.degToRad(y.rotation)+Hb)%Hb,E}getOrDownloadImage(e){var r;if(this.imageLoadingCache.has(e))return(r=this.imageLoadingCache.get(e))==null?void 0:r.promise;{let i=new Promise(n=>{X5.getLoader().load(e,a=>{let o=this.imageLoadingCache.get(e);o&&!o.loaded&&(o.loaded=!0),n(a)})});return this.imageLoadingCache.set(e,{loaded:!1,promise:i}),i}}flipIfNeeded(e,r){if(e.imageMesh==null)return;let i=-r,n=e.imageMesh.rotation.z,a=UA((n-i+Hb)%Hb,2);a>wtt&&a<Att&&(e.imageMesh.rotation.z=(n+Math.PI)%Hb)}update(e){var r,i,n,a,o;let l,u,c;for(let p of this.rendererState.geometry3DIdsInScene)if(l=this.rendererState.geometry3DMap.get(p),(l==null?void 0:l.type)==="image"){if(u=l.components[0],c=l.components[1],c.url&&u.imageMesh==null){let m=this.convertTo3DMapPosition(u.feature.geometry.coordinates),y={x:m.x,y:m.y};u.imageMesh=this.createImageMesh(l.id,c.url,u.feature.properties,u.feature.properties.verticalOffset,u.feature.geometry.coordinates,[y]),u.mesh.add(u.imageMesh),u.position.copy(u.imageMesh.position)}u.imageMesh&&c.flipImageToFaceCamera&&this.flipIfNeeded(u,e)}else if((l==null?void 0:l.type)==="geometry"){if(u=l.components[0],c=l.components[1],c.showImage&&(r=u.feature.properties)!=null&&r.image&&u.imageMesh==null&&u.visible&&u.mesh!=null&&u.mesh.parent!=null&&((i=u.feature.properties)==null?void 0:i.image.position)!=null&&u.feature.geometry.coordinates!=null&&u.feature.geometry.coordinates.length>0){let m=u.feature.geometry.coordinates[0].map(v=>{let w=this.convertTo3DMapPosition(v);return{x:w.x,y:w.y}}),y=this.createImageMesh(p,(n=u.feature.properties)==null?void 0:n.image.path,(a=u.feature.properties)==null?void 0:a.image,c.height,(o=u.feature.properties)==null?void 0:o.image.position,m);u.mesh.parent.add(y),u.imageMesh=y}if(u.imageMesh){if(!u.visible)u.imageMesh.visible=!1;else if(c.showImage&&!u.imageMesh.visible)if(c.url){let m=this.imageLoadingCache.get(c.url);m&&m.loaded&&(u.imageMesh.visible=!0)}else u.imageMesh.visible=!0;else!c.showImage&&u.imageMesh.visible&&(u.imageMesh.visible=!1);c.flipImageToFaceCamera&&this.flipIfNeeded(u,e)}}}};s(yLe,"ImageSystem");var Ett=yLe;N();var Ctt=250,ty,vLe=class extends Wa{constructor(e,r){super(),$(this,"cameraDirty",!0),$(this,"focusablesDirty",!0),$(this,"state"),$(this,"camera"),$(this,"debugEl",null),$(this,"raycasters",[]),$(this,"collisions",new Map),$(this,"focusableEntities",new Set),$(this,"debugRaycasters",!1),Be(this,ty),$(this,"update",s((i=!1,n=Date.now())=>{i||Date.now()-n>Ctt||(b(this,ty)&&cancelAnimationFrame(b(this,ty)),He(this,ty,requestAnimationFrame(()=>{this.updateRaf()})))},"update")),this.state=e,this.camera=r,this.buildRaycasters()}resize(){this.buildRaycasters()}buildRaycasters(){this.debugEl&&this.debugEl.remove();let e=new Jt(this.state.canvasWidth/2,this.state.canvasHeight/2),r=new Jt(e.x/1.2,e.y/1.2),i=new Jt(e.x+(e.x-r.x),r.y),n=new Jt(r.x,e.y+(e.y-r.y)),a=new Jt(i.x,n.y),o=new Jt(e.x,e.y/1.5),l=new Jt(e.x,e.y+(e.y-o.y));this.debugEl=document.createElement("div"),Object.assign(this.debugEl.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"}),document.body.append(this.debugEl),this.raycasters=[e,o,l,r,i,n,a].map((u,c)=>{if(this.debugRaycasters){let w=document.createElement("div");w.style.position="absolute",w.style.top=u.y+"px",w.style.left=u.x+"px",w.style.width="10px",w.style.height="10px",w.style.backgroundColor="red",this.debugEl.append(w)}let p=u.x/this.state.canvasWidth*2-1,m=-(u.y/this.state.canvasHeight)*2+1,y=new Jt(p,m),v=new BA;return v.setFromCamera(y,this.camera),[v,y,c===0?10:c<7?2:1]})}updateFocusableEntities(){this.focusableEntities.clear();let e,r;for(let i of this.state.geometry3DIdsInScene)if(r=this.state.geometry3DMap.get(i),r!=null){if(r.type==="group-container"&&r.components[2]!==void 0&&r.components[2]instanceof X5e){let n=r.components[2];if(n.dirty===!0||n.focusMesh==null){n.focusMesh&&Cl(n.focusMesh);let a=new ro;a.setFromObject(r);let o=new RA(a.max.x-a.min.x,a.max.y-a.min.y,a.max.z-a.min.z),l=new ug({transparent:!0,opacity:this.debugRaycasters?1:0,visible:this.debugRaycasters}),u=new Pn(o,l);u.position.set((a.min.x+a.max.x)/2,(a.min.y+a.max.y)/2,(a.min.z+a.max.z)/2),u.userData={entityId:r.userData.entityId},n.focusMesh=u,r.add(u),r.components[2].dirty=!1}this.focusableEntities.add(n.focusMesh)}else if(r.components[0]&&r.components[0]instanceof ru&&r.components[0].focusable&&r.components[0].geometry!=null&&(e=r.components[0],e instanceof ru&&e.focusable&&e.geometry!=null)){if(e.focusMesh==null){let n=new Pn(e.geometry);n.userData={entityId:r.id},e.focusMesh=n}this.focusableEntities.add(e.focusMesh)}}this.focusablesDirty=!1}updateRaf(){if(this.cameraDirty){if(this.focusablesDirty&&this.updateFocusableEntities(),this.focusableEntities.size===0){this.publish("geometry-in-focus",[]);return}this.raycast()}}raycast(){this.collisions.clear();for(let[r,i]of this.raycasters)r.setFromCamera(i,this.camera);for(let[r,i,n]of this.raycasters)r.intersectObjects(Array.from(this.focusableEntities.values())).forEach(a=>{var o;if((a==null?void 0:a.object)!=null&&"isMesh"in a.object&&a!=null&&a.object.isMesh){let l=a.object.userData.entityId,u=(o=this.collisions.get(l))!=null?o:0;this.collisions.set(l,u+n)}});let e=Array.from(this.collisions,([r,i])=>({entityId:r,weight:i})).sort((r,i)=>i.weight-r.weight).map(({entityId:r})=>r);this.publish("geometry-in-focus",e),this.cameraDirty=!1}showRaycasters(){this.debugRaycasters=!0,this.buildRaycasters()}hideRaycasters(){this.debugRaycasters=!1,this.buildRaycasters()}destroy(){b(this,ty)&&cancelAnimationFrame(b(this,ty)),this.debugEl&&this.debugEl.remove(),this.collisions.clear(),this.focusableEntities.clear(),this.raycasters=[]}};ty=new WeakMap,s(vLe,"GeometryInFocusSystem");var Itt=vLe;N();var SX=20,Ttt=5e3,Th,EI,CI,ry,o1,s1,wN,II,_Le=class{constructor(e){$(this,"dirty",!0),$(this,"map"),$(this,"stylesheetId",""),$(this,"userHiddenLayers",new Set),$(this,"hiddenLayersInStyle",new Set),$(this,"centerPoint"),$(this,"bbox"),$(this,"polygons"),Be(this,Th,null),Be(this,EI,s(()=>{b(this,Th)&&(clearTimeout(b(this,Th)),He(this,Th,null),this.dirty=!1)},"#stopTrying")),Be(this,CI,s(()=>{b(this,Th)&&(clearTimeout(b(this,Th)),He(this,Th,null)),He(this,Th,setTimeout(()=>{b(this,EI).call(this)},Ttt))},"#startTrying")),$(this,"handleRender",s(async()=>{if(!(!this.map||!this.dirty)&&!(!this.hiddenLayersInStyle||this.hiddenLayersInStyle.size===0)){if(b(this,ry)&&(b(this,wN).call(this),He(this,ry,!1)),this.centerPoint){let r=this.map.project(this.centerPoint),i=this.map.queryRenderedFeatures(r,{layers:Array.from(this.hiddenLayersInStyle)});if(i.length>0){for(let n of i)this.expr.push(["!=",["id"],n.id]);this.expr.length>0&&this.hiddenLayersInStyle.forEach(n=>{this.map.setFilter(n,["all",...this.expr])}),this.expr=[],He(this,ry,!1),this.dirty=!1}}else if(this.bbox&&this.polygons){let r=this.map.queryRenderedFeatures([this.map.project([this.bbox[0],this.bbox[1]]),this.map.project([this.bbox[2],this.bbox[3]])],{layers:Array.from(this.hiddenLayersInStyle)});if(r.length>0){He(this,ry,!0);for(let i=0;i<r.length;i+=SX){let n=r.slice(i,i+SX);b(this,o1).push(()=>{for(let a of n)if(a.geometry!=null&&"coordinates"in a.geometry){if(this.polygons==null)return;let o;if(a.geometry.type==="Polygon"?o=u_(a.geometry.coordinates):a.geometry.type==="MultiPolygon"&&(o=Yme(a.geometry.coordinates)),!o)continue;for(let l of this.polygons)if(Kye(l,o)){this.expr.push(["!=",["id"],a.id]);continue}}})}b(this,II).call(this)}}}},"handleRender")),$(this,"expr",[]),Be(this,ry,!1),Be(this,o1,[]),Be(this,s1,null),Be(this,wN,s(()=>{b(this,s1)&&(globalThis.cancelAnimationFrame(b(this,s1)),He(this,s1,null)),He(this,o1,[])},"#cancelJobs")),Be(this,II,s(()=>{let r=b(this,o1).pop();typeof r=="function"&&(r(),b(this,o1).length>0&&He(this,s1,globalThis.requestAnimationFrame(b(this,II)))),this.expr.length>0&&(this.hiddenLayersInStyle.forEach(i=>{this.map.setFilter(i,["all",...this.expr])}),this.dirty=!1),this.expr=[],He(this,ry,!1),b(this,EI).call(this)},"#runJobs")),$(this,"handleStyleChange",s(r=>{var i,n;if(this.map&&r&&r.dataType==="style"&&r.type==="styledata"&&this.userHiddenLayers.size>0){let a=(n=(i=r==null?void 0:r.style)==null?void 0:i.stylesheet)==null?void 0:n.id;(!a||a!==this.stylesheetId)&&(this.stylesheetId=a,this.filterStylesInMap(),this.dirty=!0)}},"handleStyleChange")),e&&(this.map=e,this.map.on("styledata",this.handleStyleChange),this.map.on("render",this.handleRender))}hideLayersUnderPoint(e,r){b(this,CI).call(this),this.centerPoint=e;for(let i of r)this.userHiddenLayers.add(i);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}hideLayersIntersectingPolygons(e,r,i){b(this,Th)&&clearTimeout(b(this,Th)),b(this,CI).call(this),this.bbox=e,this.polygons=r.reduce((n,a)=>{if(a.geometry.type==="Polygon"){let o=u_(a.geometry.coordinates);n.push(o)}else a.geometry.type==="MultiPolygon"&&n.push(...a.geometry.coordinates.map(o=>u_(o)));return n},[]);for(let n of i)this.userHiddenLayers.add(n);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}filterStylesInMap(){if(this.hiddenLayersInStyle=new Set,this.map)for(let e of this.userHiddenLayers)this.map.getLayer(e)&&this.hiddenLayersInStyle.add(e)}destroy(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("render",this.handleRender))}};Th=new WeakMap,EI=new WeakMap,CI=new WeakMap,ry=new WeakMap,o1=new WeakMap,s1=new WeakMap,wN=new WeakMap,II=new WeakMap,s(_Le,"OutdoorLayers");var Ptt=_Le;N();N();N();N();var $6=`attribute float pathDistance;
attribute vec3 pathNormal;
attribute vec3 pathTangent;

uniform vec2 uvScale;
uniform float vertexes;
uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform float nearZoom;
uniform float farZoom;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform vec2 cameraParameters;
uniform float flattenFactor;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping y = mx + b where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main() {
	fragPathDistance = pathDistance;

	// We can get an origin point for the cross-section of the path by
	// subtracting the surface normal times the radius, since the surface normal
	// points strictly away from the centre.
	vec3 origin = position - nearRadius * normal;

	// Inflate the path along its surface normal to increase its radius from
	// 'nearRadius' to 'farRadius' when the camera is at 'farZoom'.
	vec3 adjustedPosition = position;
	zoomLevel = clampRemap(cameraParameters.x, nearZoom, farZoom, 0.0, 1.0);
	adjustedPosition += normal * (farRadius - nearRadius) * zoomLevel;

	// Determine how far the path extends "up" or "down" in the direction of the
	// path normal.
	float height = dot(adjustedPosition - origin, pathNormal);

	// Flatten the bottom half of the path entirely so that it's flat
	// against the floor. This makes the path look nicer when it's
	// semitransparent behind opaque geometry, so you don't see it
	// peeking through.
	float desiredHeight = max(height, 0.0);

	desiredHeight = desiredHeight * flattenFactor;

	float flattenMagnitude = height - desiredHeight;
	adjustedPosition = adjustedPosition - pathNormal * flattenMagnitude;

	// Transform the vertices into NDC.
	vec4 mvPosition = modelViewMatrix * vec4(adjustedPosition, 1.0);
	gl_Position = projectionMatrix * mvPosition;

	fragTexcoord = uv;

	// Compute a texture coordinate for mapping the arrow texture to the path.
	// We don't want to use the u-value that Three.js provides, because the
	// path may end up twisting arbitrarily -- but we want the arrow texture to
	// always be on the top of the path.
	vec3 bitangent = cross(normal, pathTangent);
	fragTopTextureU = -dot(bitangent, pathNormal) * 0.5 + 0.5;

	radius = mix(nearRadius, farRadius, zoomLevel);
}
`;N();var MX=`#define ARROW_FADING_POINT 0.15

uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform vec2 resolution;
uniform vec2 cameraParameters;
uniform vec3 color;
uniform float pathLength;
uniform bool showPulse;
uniform vec3 pulseColor;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform float arrowAnimationTimer;
uniform float opacityMultiplier;
uniform bool dashed;
uniform sampler2D arrowTexture;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// How long the arrow should be, as a factor of pathRadius. Since we've
// mostly flattened the top of the path, values near 2.0 (the diameter)
// will probably look best.
const float arrowLength = 2.0;

// How much of a relative margin the arrow texture should have inside the
// area laid out for it. Useful to pull the arrow away from the edges of the
// path, which slope down.
const float arrowMargin = 0.1;

// How many arrow-lengths of space should be between arrows on a short path.
const float arrowSpacingOnShortPath = 6.0;

// How many arrow-lengths of space should be between arrows on a long path.
const float arrowSpacingOnLongPath = 7.5;

// How long a path must be to be considered "long", as a factor of
// the path radius.
const float longPathLength = 200.;

// How long a path must be to be considered "short", as a factor of the
// path radius.
const float shortPathLength = 75.;

// How much of the path's length the fade-in should comprise when going from
// zero opacity to full opacity.
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping 'y = mx + b' where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// Compute the opacity of the path based on the distance from the current
	// fragment to the 'complete' value as it varies from 0.0 to 1.0.
	// Fragments that are at the 'complete' value or past it will be fully
	// transparent, while fragments that are at 'complete - completeLength'
	// or before it will be fully opaque. However, we adjust the 'complete'
	// value here so that it overshoots by one full 'completeLength', so that
	// the entire path will be opaque when the 'complete' value is at 1.0.
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	// Push in the texture coordinates so that they ramp up
	// at 'arrowMargin' instead of at zero; this remapping looks somewhat
	// like this:
	// 1 ^        ___
	//   |       /
	//   |      /
	//   |     /
	//   |    /
	//   |___/
	// 0 +---------->
	//   0   ^      1
	//       arrowMargin
	// Making the arrows narrower on the path.
	float u = fragTopTextureU;
	u = clamp(
		u * (1. / (1. - arrowMargin * 2.)) - (1. / (1. - arrowMargin * 2.) - 1.) / 2.,
		0.0,
		1.0
	);

	float arrowSpacing = clampRemap(
		pathLength,
		shortPathLength * radius,
		longPathLength * radius,
		arrowSpacingOnShortPath,
		arrowSpacingOnLongPath
	);

	// Reduce the spacing between arrows when the camera zooms out, as increasing
	// the path radius will increase the arrow size and thus be able to fit
	// fewer arrows on in total, and this secondary movement of the arrows
	// "zooming off" the end of the path is unpleasant
	float expandAmount = mix(1.0, farRadius / nearRadius, zoomLevel);
	float effectiveArrowSpacing =
		arrowSpacing * 1.0 / expandAmount +
		arrowMargin * 2.0;

	float effectiveArrowLength = arrowLength * radius * (1. - arrowMargin * 2.0);

	// Adjust the slope of the vertical texture coordinate so that it goes
	// from 0 to 1 along the length of the arrow plus the spacing between
	// arrows, and adjust its x-intercept so that one arrow moves to the
	// exact position of the next arrow as 'arrowAnimationTimer' goes
	// from 0 to 1
	float v = (
		fragTexcoord.x * (pathLength / effectiveArrowLength)
		- arrowAnimationTimer * (1. + effectiveArrowSpacing)
	);

	// Compute a "looping sawtooth" wave for determining the vertical texture
	// coordinates of the arrow texture, roughly as follows:
	// 3 ^              /
	//   |          ___/
	// 2 |         /
	//   |     ___/
	// 1 |    /
	//   |___/
	// 0 +--------------->
	//   0   ^ ^
	//   ^   |_|
	//   |   effectiveArrowLength
	//   |___|
	//   effectiveArrowSpacing
	//
	// This is effectively equivalent to this sort of sawtooth wave:
	//   ^
	// 1 |    /    /    /
	//   |___/ ___/ ___/
	// 0 +--------------->
	//
	// Causing the image of the arrow to repeat, with dead space (the bottom
	// edge of the texture stretched out) between the arrows at the provided
	// spacing. The reason why the "looping" design is preferred is because
	// it takes advantage of WebGL's 'GL_REPEAT' texture wrapping behaviour
	// to avoid the discontinuity that can end up causing visual artifacts.
	if (mod(v, (1. + effectiveArrowSpacing)) < 1.) {
		v = v - effectiveArrowSpacing * floor(v / (1. + effectiveArrowSpacing));
	} else {
		v = ceil(v / (1. + effectiveArrowSpacing));
	}

	// Use the r-component of the texture to determine whether the arrow covers
	// this fragment or not
	vec2 sampleTexcoord = vec2(u, v);
	float arrowAmount = 0.0;
	vec3 secondColor = pulseColor;

	if (displayArrowsOnPath) {
		arrowAmount = texture2D(arrowTexture, sampleTexcoord).r;
		float delta = 1.0 - abs(fragPathDistance * 2.0 - 1.0);
		secondColor = mix(color, pulseColor, 1.0 - smoothstep(ARROW_FADING_POINT, 0.0, delta));
	}

	if (dashed) {
		float dashLength = 0.1; // Adjust this value to change the dash length
		float gapLength = 0.1; // Adjust this value to change the gap length
		float totalLength = dashLength + gapLength;
		float numSegments = ceil(1.0 / totalLength);
		float adjustedTotalLength = 1.0 / numSegments;
		float adjustedDashLength = adjustedTotalLength * (dashLength / (dashLength + gapLength));
		float pattern = mod(fragPathDistance, adjustedTotalLength);
		opacity = pattern < adjustedDashLength ? 1.0 : 0.0;
	}


	if (showPulse) {
		// Add the pulse color to the path by determining how far the current fragment
		// is from 'pulse'
		float pulseLocation = remap(
		pulse,
		0.0,
		1.0,
		-pulseLength,
		1.0 + pulseLength
		);
		float pulseDistance = smoothstep(
		0.0,
		pulseLength,
		abs(fragPathDistance - pulseLocation)
		);

		// Blend the pulse color to the path based on how close this fragment is to
		// the 'pulse' value and whether it's covered by an arrow -- but if it's
		// covered by *both*, then we go back to using the regular path color
		// (making arrows look like "holes" when they're overlapping the pulse.)
		float pulseLevel = abs(1.0 - pulseDistance - arrowAmount);

		gl_FragColor = vec4(mix(color, secondColor, pulseLevel), opacity * opacityMultiplier);
	} else if (displayArrowsOnPath) {
		gl_FragColor = vec4(mix(color, pulseColor, arrowAmount), opacity * opacityMultiplier);
	} else {
		gl_FragColor = vec4(color, opacity * opacityMultiplier);
	}
	#include <colorspace_fragment>
}
`;N();var Ltt=`void main(void) {
	gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
}`,Dtt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAQkHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZpZciQ7rkT/uYpeAicQ5HI4mr0dvOX3ATOl0li3q3SVJkUqFMEBcHc4IuX2///fcf/hK7cSXRatpZXi+cott9h5U/3j63EMPt+fL1/h+fPdeff6NnJMHNPjD2U/7+qcl183aH6eH+/PO52PN7E+B3qZ+Tlgspkjb57X1edAKT7Oh+fvrj3v6/nNdp7ftd057abHnz78npVgLGG8FF3cKSTPz2oXJFaQWuocCz9D0mhnEu8Tx54k6dexc98F77vY+f48n96HwvnyvKB8iNHzfJCvY3cj9HZF4dfM7/6QZ4j+7deb2J2z6jn7sbueC5Eq7rmpl63cd1w4GCrd2wov5Vt4r/fVeFW2OMnYIpuD13ShhUi0T8hhhR5O2Pc4w2SJOe5IuGOMM6Z7rhL+FudNSrZXOFFJz3KpkqtJ1hKn4+tawp233flmqMy8AlfGwGCBOz693Fcn/+b1OtA5Bt0QfH2NFeuKFnCWYZmzn1xFQsJ5xlRufO/LvcGNf5PYRAblhrmywe7HY4gh4Re20s1z4jrx2fkHNYKu5wCEiLmFxYREBnwJSUIJXmPUEIhjJT+dlceU4yADQSSu4A65SamQnBptbu7RcK+NEh+nkRYSIZBGSQ0EIlk5C/jRXMFQlyTZiUgRlSpNekklFymlaDGN6po0q2hR1apNe001V6mlaq211d5iS0iYtNLUtdpa651JO0N37u5c0fuII408ZJSho442+gQ+M0+ZZeqss82+4koL+q+y1K262uo7bKC085Zdtu662+4HrJ108pFTjp562umvWXtm9X3WwofM/T5r4Zk1y1i+1+mvrHFa9WWIYHIiljMyFnMg42oZANDRcuZryDla5ixnvkVIIZGsBbHkrGAZI4N5hygnvObuV+Z+mzcn+Y/yFr/LnLPU/RuZc5a6Z+Y+5+2LrK1+K0q6CTIWWkx9OggbF+zaY+1Wk/766H46wF8ONFY+O8hBMEc7oc4Vdh+8JsE+PUSrVjr70Zz1+H56PH3o9sRR1ql5Ha8bUMQxpe89Tki8Sb0tE23cw3DcfEo+ugnj2G3WEmononVfoag71pVjR+EmAE53eT5tqYfEHl/7ThMusaI+St0jktFa9gKnreiQqCNpZ2mJdSkbaiK6DrovYR4/JhJfRsx5d5EVZnEIPetHnU5KynJPTSuCPuC0lOuXH7n1DNq7DpUtHbhM5lDA0c2bnDCJoOObMnyj+aPjPwx0yiDUxKKsg35VnRnBEVhonKwK5hOk5NttUrhr2+tMOXkPJb1RZ+iAelYjL2MuO3pGRQ78GdxwOOaTAcJZcewq7ilB1RJCSozUdSEdwVJVb6asiBsHH1Bqgbiv3Cmkkis6ktVnZGRRwMNJjUA3Ao2127YWdhAIblxF51hzMcZsVZc0r0dJo5Liqfn41Q+q193SGhhkMkgaLJRNnEpqBtyVvbcVffIk+LE9QPFBTMTQe0aWkMXMnx3dy5sfHreDE60Ql50E+SqRcmfK16L2p0Ol8JFATu3qASXy7SvmiGW2cdMBxsty44CvtLogfGlv7WkCSV0WId2270EaD5Ym40cs+SAwZuNjPSTywAvEfLmzQhtLDntfCnhl/fNmUNnzyA2g76Zn0SP+c+I6bCC0FONUQ4L50e95dif+DH/m9htQjBEhPPpOjYjmm2ChbfEMIUaYtAIxmWJHlilLU8ZRs9pCsHbDpFaRgZljz2QandjDIBPZDGTuoZW1KdlYh52ALzisKJRNWSQmLAWx8iv9mGttT15bBc2oxd57bZtVF98CYtK3UH22Yd/A7WaKa+ZjNTOXEzNhMJ5kmQOvfzsbxbZALJ2xwGBjX2HFQybhi7kpbA7DVpS3RxMJwFyHwGk5gs6a4lrRHVqhYT0QTJC9UZcC9Yrelkn6yXch68NKNtG7CiU3vf/zMZAYXPWdrR9XZ/ctMV1sJQ2wJEGxzaHs7LmmHIwnUwbwnNAapBY9xhE19DNJW3ua0dDk/AjwITacR0PqZxkbyJ+E5jYbxI84x1TBE+y90hwDCYZIM0tqAKPZfCzFrbH8kYCm3eqQkZ2+2GovcL8Suokyg8yyCJes6dcouSLiNSLb0ETJU+/N/WFsBBSOXBbm9Cwp4CzlOag7ro7R2vC19nSsCPmAjIEMiobFwaoVXhjTU2XMpgEsDH/L3Sx54OCTMUSXI/IIA2V4QcLQpwVz12pInI0bY56pIQ2BSGRLL+yLfZ7JkiimbK+aepsbwRStpokx5gCqe1hjdMAwcINbkk5jmedrNRAG5pUXPe0sZIoXy1h7lSDxApzheg24JeDNtDS1oBDBUC4iWZFilBPhZx0Kqx2lihpbG9q4sYidksCN4yRYhNM4nxfBbTi4E3AT6B3igbvs9Gv8ZkHsIfdlep+2HelEDbkJdNjqZQ90B7k6OIoFfkkPNoY+z0gzACa1f2qcBYxVJpT2QQgS19dKQlbC24S92xiEAFRKB5Uy1qrBgOtwIge55G0kRPfIytGx0tMOrGfrijB2FHOk/TKcMjDTMPeBo4FnXD5cQ8vtdgoAN0yuzZQHQI09wm/5vAB6RHyI9rYKiZ6YWC6rbaiLmDtoaToC1bViXQFNtgWsOfEEKCleC3GWPSfgQWRQWMgw/9FDgvOZrFAT3SmsA3DLbqlsSppQG5QeOjPXavUUkxF/qgLM05vW5o7UakuBqo2ZW8Nj0LB7imVJC9QSA+wd7RPztIUZ80xQZq0ROrc8CSVncWzkTA/RwmunldCPAQKjqVC7bhRuTIv0plbk7gOX4m5OAi2YesYZ0KBQRToG8iv9x8dgGtgECYRBeEU87OxoSc8epu+s7Mq/MN0VbBT19dii7ekO66UZwdAMtoAVQd13J5nwZe98OgGslmVqAGBkeLZNVNVlWpV18qihntXKnBZvrDIVgFpx4q5poLqREOVplMPSpTF2KvjBAzDpprkruXIaaUmUD4Xo2yrGWcYlixKIwRFjl0jPQhKznUXZAoSjlg9c/NwAI4p3Q/w5bCNfhUZS7bGfqesHqKAlyZZxZgNrhGevZXccaqBys4NEqB3Vqfptji9uUrhCL6yXFqxtm0hhLyYU3Tjd8I/HZaWD1oyVjnG5hhpCN5yHSf8BQUZlVNd00OP4M0TK+JSM7iqWi01SinFkCQXWxiZJLqqAHiEt3G3I2WYd46KU9pIJIOkoRQYCcEAAPguHo0Y4k8Hl6SW50MoW0uZU8jJOUghKo38Nl5ZSwsJNAUC2/lFZWkfMjrU8dFrTjHpJnUrLCILQIxINiYdQlDXaE/razQ4jjQluN5jW1Eh/S7yYvI5gigSjdLYU9TiFXAcHjISiLhQd9obb3OQmwY+YqVwiBMCkOGLXaK/ljBShh56c1g0uyIb2lBRKO7ZTAFncw5c5UGjGSy3CsI1Jt2mtruZkfhBZmbR+842Yu1eDiWEl0V6LZcGem6Ct+LW4Wy3oAjyNObazKBHomhJ3HMKEKHgiGksH+Ig1nTidfNMyA+oYHqVFaRGLiQreVLc9GvQgftKjW9cfUSKNYL80rqU7Um2rwqQJR1ai31Wq7vzKJEsFHDj0bAEMUKXgvfD5bWbaLPBTKz1Nk/Fg+GUZvUzFw80CLaKtPAACVAWrismh863FU4IJ0716SXBUNVb/SDMVvZgDt34CXoOq1JKvg0n08gPHTwXBNgD5W8pZZ8E9EVWcv1DZMB2NFysIwkqBSaH5QRmsAHdkHB+UANvLJvFpQKAahSmYTLEd2AFO+5rsqRRU6sVv5IP0wsSPLcWsbC1Y95mte71CUm6RJJWwkg6Q4k+xWMM0ByElJPQ6j2ED5hY42ALpZRytx9RlgQlJLijzhKi5eX5JBSIRGfo9o2xhd/0aWku8OS+4D9ZnovHDQMPaYo4qm2mlZbUnd7pR6oQj29Z2BqJ9n3LRT+MTLu3IR+ZP2TCPh3EDw8H1NHpoT7FibNYU8WHd9ESHcY12aDOQCUBddi4Ucp+4yuzz8ybcCCu1h8zvzXhDN4HYLq1R+U0xzUqg5QSA3iSBgdDouy55Ifx0DaeEhgezxBRGmoEJ6AJitVuzwtKPlUskHgU2F0LS7AFIwW5jPu0RUL7sp+fkNk0ee8P6uXYgl40WM+cdCOW21r13e0ivt0ff/mYcUfrQZWs2BiN6G+MDTGz1BKORmUTNQp9YGSHFxAeTkQrKd6FoVUogyytW25OLy3OpaO5oZCQp46aPzb5LnJiFEIwAKkmbYVYIjzVv3vj7rA6HignEeQAXTAHKDhoD7Uujh0QjtsB6fTP1NzO7T1Nzq4F1GnfHdXCG1Yxjwdtjf+PGRGTzEtEAUCz7KLfTdItLwCXuSOAzVjaZB6LvbUZhYGWmifSZlcMDnGHPd6gPeiK9erhpiw7ZP9ahTrMhFDa1J53m9ri2DloziqGETTcVSppCbTDDjExg6RrZ6cPEzB8XArEjQSB29odrUoLyoS/65RfM9fprGGjlHpbhGgbYD8MtmW1eFcAWX5dbcMHcl8sUI2k+H7GPW9VrArw3G+BefcCrCaAT/N53YLvP26Uy0kMFnDEZz0DJkmQqEOlL7SlKweYhH8gxpYeAYi0f9magqPbMYZuUI6007lSZQoyoGfYQHsNRzHXR3MMINTSMZpq1KD2A5MDJgtMLdRU6R4CEOJcKGiIJ7K6P/vAM6xpECHI8rRHsaEj6smkngAUjXTzrRoSI48ZpHOqgOY5OejKVdpnmiYUChQnVdIPa6ekGqRSRgEO119oDHOiIUQ5ciYVgaF1oG8Udo8WYtD+DEi8D/w8rAJE2k2PoyV0oMtpauxreaFjpujAvxFlwBhjuNqM9P0IfI5iD8Nh8y1kG4igjJkDNkOijnlLhItAd9lhRd670yNRTu95cR/Xuu0c5WO4DEFk5YQAPtLvU4TYPGRh4APPEDNiuuwR6SC21JoFbQBBMr+zJmT32QplNI6p16PbculN/pCX1wAyTWGTeJ774aln0gvQikw7TmkfsNbdQNs0adutYUDqNtGc0RqngUYdhUYuHSL1/eLrgvqDTC5neu++vufRkEgP9D2T64Kg/c4n+s7k3dDr3me8nOr0c72MRNmgF7D4WySPP0YAI/bI4eixwc7K13QiRiL85A8fnSsUj+mvTrsZtVUEQZ6sTpVafW8nYJZyaZS0U+0xIb6et9PhhtoObozQbjKAoDf6eiFgx1UUvpUYj1GweH0MNMrofhynfWn7+KYu7n5r83hN9aqm+6qjcH7dUlgvZVLV3xqq4fbP16qv+eofuTz43eomAqfS7GBAB9zEE31WJ37eVIPtdGN5A8nMYPvvLt8t2/V/6gM19G4g/hIL7UXf9JgbuLRZ+AoW//AzyMxTcWyz8BAruLRZ+AgX3r3y2+mT/PwfiN1DoVI+QT3CZDmvb8022JeYb6HiQPQpPPvboFB+i1MZdcqWZqthHmix6vttw0UAI1z8oEnGwVe++c7JamxslC+8xKJE41XJmug1npz+6CUAKyURd9gSxo+kWxvtZth848GBlws/0SKjYhmbZ9IiV+mcGBSdWHk8sqSr2zz5J7QME/0yD+z4Pe+JuGn1MV/vUyZwOHojWPlmPXgf9CuoeN9UAT+FGwaLg44v3dWe6QpvuL3Ln/p3k/2AgqNDcfwHgqUmIIqn+hwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wYRESAMujenGAAAB9FJREFUeNrtnWlsFVUUx899fS1gUoKioEY+WBRUEohGkUhAKxgEjSgGoRGB4AJCNKAIJBJZJSiyGYMKKkIoLlEUKhUraxFkKUE2kU1aCrRgW2jpg9f29R2/sBTo67v3zL2zvfP73MzM+XU6mf+5504BGIZhGIZhGIZhGIZhGMZGGq3JvSmR62++BXHH7Ylbf9ouRMT99yVq/e0PICIiHumUmPV3PooXOf5EItafXoCXOdUn8ep/pgjrUDY40ervX4JXUTEiocoXL5/FawiNEwlU/6hzeB3hqQljQIwJYT3UzEkQA2JiGOslsiAhDIgZ1RiD6NIEMBD8NIKxyQr6vv7FtdgQa31uILg0ig2zsZmv4//yePUj7rjNv/U3yUEJ/r7Xr/XfvBmlOPKwT+vfhpIUdvdj/Wm7UZpTz/mv/g4HUYGyQb5r/+SjEhXD/VV/j5OoSGisj16LRe9iVCY8xTcGxIulSKBmtk8MiKHlSMIn8ViMqkQivojHgfcuIJ0VAc/XPzmMVljrcQOBmdVojY1NvVx/8mcRtEqeh+NxypJatM6+ezxb/7Io6uBwR4/e/1moicJunvz956A2ip/1Xv3Nt6JGSgd6rf47/0KtlHssHrfZi5rxVDwWDx5C7XgoHotHC9AANbO8YqBXERohMt8bv/8X/kNDRDM9cA+IgWVojhWuNxAYXo4mWePyeBwYHUKz5Lo6HidNvICmybvVxfXPqEbz7Gvr2vrn1KAdHH7IpX//8yNoD8dcGY+TM6NoF26MxzLTL26Mx0majtM4q5ed7yhNulVsd5WAxqset/mGS6/d5CIBLXI62/7I6ZKyzjUC0rIfsP+hE3zkxt9c8vy7tPnJbiKfuyP+Xdn8ZDeuiMei+zF0juWOGyBNv+iMxw4bEBkl6CzOxmPx6ll0mryWDtb/ViU6z17H4rEYG0I3cMiheByYFEZ34Ew8Dn5UjW7BiXisY/rFDfGYmgWCCwcngXto0q08z1YBSUsy3NWgb5Qe2WSjgJRlfdy2RJPcNXm9bQIarexpsP5VdxHjcbMcm2Q3/5P64i71U8k/ELuLNsVjcct2cnST+rGg+Jo4XmhLPBZ376GOfoOkAIB5NWTHxuu/nzj9ElkA8gLgA+pLlvF43IU4/VI9G1QEAHnIPjfVaP1PnqRdVngKqAkActDMa2Hw/u9zijjjNg5UBcBr1FbD3jbG6h9QSruk8ovfyFESABnUWSNT8VgMI06/lF7aBqomAJ4n3m+G4nHgbeJfZfHljcCKAqDHcWo87m2g/gnE53LhlS+lqQqATv9S4/FL2u//qcT2T34XoAuAdvuJBspf11z/LOKbyYG6q4bqAqDVTqKByjFa21/U6ZfdaWBNADTdTDQQnqSv/pRMYjrZevVLCUUAiF+JBqpnaqv/J2I+zb3mxZwkAMTPDq8ep1A3P/1y3ZOEJABgiaPxuOnvxLN/B7oEwELq/sPl1utvSdz8VPsl6BMAn1AbBKut1t96F+3ENXOFTgFiehXRwAZL8Vi0JW5+qppW7+HIAgDGnyca2G4hHouOh2knvTARdAuAkedsj8cinTj9Ujka9AuAV87YHI/F08TNT2eHgQkB0I/aIDhGmuIU/YnnKxkAZgTAU8SGHC0eDyJufiqKfTKrAqBrPtFAiXo8HlFBO1VBA7ebZQHQifhUVo7H4p2QgQeOdQHQbp8t8Tg4idj+2dPgwJIGAdBqhw3xmDz9EuelQ4cASP3DeDwOziW+ecdbldEiACDbcDxOWkBs/8QNHpoEAPXjLNFMmfpv+IZ4+PjRU5cAWGwwHqcQNz/J2NUmAMgjavHjMfEPTGpvvz4BQH1MrzMkoHoW2CsAppEaBFskemQUA+HJYLcAeJfQINgpNVuvbiA0FuwXAG8qNwh2S07WqxqQ/saPXgEwRDGu7W8te2Q1A6XSH0HWLAD6nVa5zoPS9asZKJb/DLZuAdDzhPx1Hu2gkobkDRQq/J8w7QJAfstevuI3+WQN1F39dkAAtP9H7jpPdFVtiMgZOKC0Z9aAAEiT+mrbScLQjIyBXWngtABokRf/kKefonRF4xvYqrjmYEQApG6Md8SyvrS+eDwDG5QbzUYExL3QMxnUlZGGD5wFbhEADQ7YVwyhr401YCD6LbhHACyK3SA4N9TK6mhMA5EvwE0CYF6sBkFopLXl8exYq9/gLgHwYf3x+PxoqwMC9RoIvw9uE1D/gH3VeOsjItnSq9/OCqhvwL5qAoABA5XU28qsAHjj2tW8mukABgzEXP12WgAMvrpBEPkYwICB2KvfjguAvnUH7GvnARgwUGRhEt24gLoD9tGvAAwYKLDyySzzAqDzpQH76CIAAwYOWtqNYoMAaH9xwP57AAMG9ljbj2SHALhjJyLijwAGDGyzuCPNFgGQuhlxpfw1yR94dfAxi5cmojI/lRyx+rtaX9XDhADr2CVABc//JycWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWIDToH8FyJUWtVWAALedDoFhGIZhGIZhGIZhGIYxyf+YwEMsIhMo/AAAAABJRU5ErkJggg==",Rtt=new TB;function xLe(t,e,r){let{nearRadius:i,farRadius:n,accentColor:a,completeFraction:o,isVertical:l,visibleThroughGeometry:u,dashed:c}=e,{color:p}=r,m=0,y=1/0,v=e.displayArrowsOnPath,w=!0,E=v,M=i/2+Ott,I=0;t[0].z+=M;for(let xe=1;xe<t.length;++xe){t[xe].z+=M;let Te=t[xe].x-t[xe-1].x,fe=t[xe].z-t[xe-1].z;if(l)I+=Math.sqrt(Te*Te+fe*fe);else{let Pe=t[xe].y-t[xe-1].y;I+=Math.sqrt(Te*Te+Pe*Pe+fe*fe)}}if(!l){let xe=t[0],Te=t[t.length-1];t.push(Te.clone().setZ(Te.z-.01)),t.unshift(xe.clone().setZ(xe.z-.01))}let P=new Gu;E&&(P=Rtt.load(Dtt),P.colorSpace=nl);let C=new si(p),T=new si(a),O={vertexes:{type:"f",value:1},resolution:{type:"v2",value:new Jt(1,1)},cameraParameters:{type:"v2",value:new Jt(m,0)},complete:{type:"f",value:0},color:{type:"c",value:C},pathLength:{type:"f",value:I},nearRadius:{type:"f",value:i},farRadius:{type:"f",value:n},nearZoom:{type:"f",value:m},farZoom:{type:"f",value:y},pulseColor:{type:"c",value:T},pulse:{type:"f",value:0},pulseLength:{type:"f",value:.075},pathIsVertical:{type:"b",value:l},arrowAnimationTimer:{type:"f",value:0},arrowTexture:{type:"t",value:P},displayArrowsOnPath:{type:"b",value:v},showPulse:{type:"b",value:w},opacityMultiplier:{type:"f",value:1},dashed:{type:"b",value:c}},F=new zhe(t);F.curveType="catmullrom",F.tension=0;let k=30,B=8,U=k*t.length,z=new ZVe(F,U,i,B,!1),q=new Float32Array(z.attributes.position.count);for(let xe=t.length;xe<q.length;xe++)q[xe]=xe;z.setAttribute("vertexIndex",new Yo(q,1));let W=new Float32Array(z.attributes.position.count),J=new Yo(W,1);for(let xe=0;xe<=U;xe++)for(let Te=0;Te<=B;++Te)J.setX(xe*(B+1)+Te,xe/U);z.setAttribute("pathDistance",J);let V=new Float32Array(z.attributes.normal.count*3),oe=new Yo(V,3);for(let xe=0;xe<U;xe++){let Te=z.tangents[xe];for(let fe=0;fe<=B;++fe)oe.setXYZ(xe*(B+1)+fe,Te.x,Te.y,Te.z)}z.setAttribute("pathTangent",oe);let Y=new Float32Array(z.attributes.normal.count*3),he=new Yo(Y,3);for(let xe=0;xe<U;xe++){let Te=z.tangents[xe];var Q,ae,ee;l?(Q=Te.x*Te.y,ae=-1+Te.y*Te.y,ee=Te.z*Te.y):(Q=-Te.x*Te.z,ae=-Te.y*Te.z,ee=1-Te.z*Te.z);let fe=Math.sqrt(Q*Q+ae*ae+ee*ee);fe===0&&(fe=1);let Pe=Q/fe,me=ae/fe,Ae=ee/fe;for(let Ue=0;Ue<=B;++Ue)he.setXYZ(xe*(B+1)+Ue,Pe,me,Ae)}z.setAttribute("pathNormal",he);let le=new bc({uniforms:O,vertexShader:$6,fragmentShader:MX});le.transparent=!0,le.alphaTest=.5,O.resolution.value.x=1,O.resolution.value.y=1,O.vertexes.value=q.length,O.arrowTexture.value.wrapS=Bh,O.arrowTexture.value.wrapT=Bh,O.arrowTexture.value.anisotropy=16;let K=new Pn(z,le),ce=K.clone(),te=vt(Ee({},O),{opacityMultiplier:{type:"f",value:.25}});te.complete.value=1,ce.material=new bc({uniforms:te,vertexShader:$6,fragmentShader:MX}),ce.material.transparent=!0,ce.material.alphaTest=.5,ce.material.depthWrite=!1,ce.material.depthTest=!1,te.resolution.value.x=1,te.resolution.value.y=1,te.vertexes.value=q.length,te.arrowTexture.value.wrapS=Bh,te.arrowTexture.value.wrapT=Bh,te.arrowTexture.value.anisotropy=16,te.complete.value=o,K.userData=ce.userData=e.mesh.userData;let ne=e.mesh;if(!u){let xe=new bc({uniforms:O,vertexShader:$6,fragmentShader:Ltt}),Te=new Pn(z,xe);Te.name="stencil",Te.material.colorWrite=!1,Te.material.stencilWrite=!0,Te.material.stencilRef=1,Te.material.stencilFunc=aO,Te.material.stencilZPass=WL,Te.material.stencilZFail=WL,Te.material.stencilFail=WL,Te.material.depthWrite=!1,Te.material.depthTest=!1,ne.add(Te),ne.add(ce)}if(ne.add(K),l){let xe=new ro().setFromObject(K),Te=new qe;xe.getCenter(Te),ne.children.forEach(fe=>{fe.geometry.center(),fe.position.copy(Te)})}u&&(K.material.stencilWrite=!0,K.material.stencilRef=1,K.material.stencilFunc=rVe,K.material.stencilZPass=Jd,K.material.stencilZFail=Jd,K.material.stencilFail=Jd,K.material.needsUpdate=!0,K.layers.disableAll(),K.layers.enable(mge.ALWAYS_ON_TOP)),z.computeBoundingBox();let pe=new qe;return z.boundingBox.getCenter(pe),{mesh:ne,material:le,center:pe}}s(xLe,"buildPath");var Ott=.15,ktt=.5,bLe=class extends Wa{constructor(e,r,i,n){super(),$(this,"rendererState"),$(this,"altitudeDirty",!0),$(this,"convertTo3DMapPosition"),$(this,"getParentContainer"),$(this,"convertZoomLevelToAltitude"),this.rendererState=e,this.convertTo3DMapPosition=r,this.getParentContainer=i,this.convertZoomLevelToAltitude=n}update(e,r,i,n=0){let a,o=!1;for(let l of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(l),a&&a.type==="path"&&a.components[0].type==="path"){let u=a.components[0],c=a.components[1],p=u.isVertical&&this.altitudeDirty;if(!(u instanceof yI))continue;let m=[];if(u.dirty||p){if(u.mesh.parent!=null)for(let y=u.mesh.children.length-1;y>=0;y--)Cl(u.mesh.children[0]);if(u.feature.features.length===2&&u.feature.features[0].properties.parentId&&u.feature.features[1].properties.parentId){let y=u.feature.features[0],v=u.feature.features[u.feature.features.length-1],w,E,M=y.geometry.coordinates[2]||0,I=v.geometry.coordinates[2]||0;y.properties.parentId&&(w=this.getParentContainer(y.properties.parentId,!0),w!=null&&w.altitude!=null&&(M+=w.altitude,u.isVertical=!0)),v.properties.parentId&&(E=this.getParentContainer(v.properties.parentId,!0),E!=null&&E.altitude!=null&&(I+=E.altitude,u.isVertical=!0));let P=this.convertTo3DMapPosition(y.geometry.coordinates[1],y.geometry.coordinates[0],M),C=this.convertTo3DMapPosition(v.geometry.coordinates[1],v.geometry.coordinates[0],I);Math.abs(P.z-C.z)>ktt&&w!=null&&w.visible&&E!=null&&E.visible&&(m=[P,C])}else m=u.feature.features.map(y=>this.convertTo3DMapPosition(y.geometry.coordinates[1],y.geometry.coordinates[0],y.geometry.coordinates[2]||0));if(m.length>1){let{mesh:y,material:v,center:w}=xLe(m,u,{color:c.color});u.mesh=y,u.material=v,u.position=w}u.dirty&&(u.nearZoomLevel!=null&&(u.nearZoomAltitude=this.convertZoomLevelToAltitude(u.nearZoomLevel)),u.farZoomLevel!=null&&(u.farZoomAltitude=this.convertZoomLevelToAltitude(u.farZoomLevel))),u.dirty=!1}c.dirty&&(u.mesh.children.forEach(y=>{y.name!=="stencil"&&(y.material.uniforms.color.value.set(c.color),y.material.visible=c.visible,y.material.needsUpdate=!0)}),u.mesh.position.z=c.altitude,c.dirty=!1),u.isVertical&&u.mesh.children.forEach(y=>{y.rotation.z=-n}),u.material&&(u.mesh.children.forEach(y=>{var v,w;if(y.name==="stencil")return;let E=y.material.uniforms;E.nearZoom.value=(v=u.nearZoomAltitude)!=null?v:e,E.farZoom.value=(w=u.farZoomAltitude)!=null?w:r,E.cameraParameters.value.x=i,u.materialDirty&&(E.nearRadius.value=u.nearRadius,E.displayArrowsOnPath.value=u.displayArrowsOnPath,E.farRadius.value=u.farRadius,E.pulseColor.value.set(u.accentColor),E.complete.value=u.completeFraction),y.material.needsUpdate=!0}),u.displayArrowsOnPath&&u.animateArrowsOnPath&&(u.mesh.children.forEach(y=>{y.name!=="stencil"&&(y.material.uniforms.arrowAnimationTimer.value=performance.now()/3e3,y.material.needsUpdate=!0)}),o=!0),u.materialDirty=!1)}this.altitudeDirty=!1,o&&this.publish("animate:path")}};s(bLe,"PathSystem");var Ntt=bLe;N();var zs,V2,bm,wLe=class{constructor(e){$(this,"rendererState"),$(this,"dirty",!1),Be(this,zs),Be(this,V2),Be(this,bm),this.rendererState=e}updateOne(e){if(e instanceof Ua&&e.components[0]instanceof ru&&e.components[1]instanceof c_&&e.parentObject3D instanceof Fu&&(He(this,zs,e.components[0]),He(this,bm,e.components[1]),b(this,zs).detached&&b(this,zs).dirty&&b(this,zs).geometry!=null&&b(this,zs).material!=null)){He(this,V2,e.parentObject3D),b(this,zs).visible=!1;let r=new si(b(this,bm).color),i=b(this,bm).opacity*kw(e),n=new Y8({color:r,side:Pu,opacity:i??1,transparent:i!==void 0?i<1:!1},1,b(this,zs).material.repeatYFactor),a=new BB(1,b(this,zs).geometry.attributes.position.count||0,0,n),o=a.addGeometry(b(this,zs).geometry);a.addInstance(o),a.userData={entities:{0:e.id},detached:!0},b(this,zs).instanceIndex=o,b(this,zs).material.setColor(b(this,zs).instanceIndex,r,b(this,bm).topColor?new si(b(this,bm).topColor):r),b(this,zs).mesh=a,b(this,zs).material=n,b(this,V2).add(a),b(this,zs).dirty=!1}}update(){if(!this.dirty)return;let e;for(let r of this.rendererState.geometry3DIdsInScene)e=this.rendererState.geometry3DMap.get(r),this.updateOne(e);this.dirty=!1,this.cleanup()}cleanup(){He(this,zs,void 0),He(this,V2,void 0),He(this,bm,void 0)}};zs=new WeakMap,V2=new WeakMap,bm=new WeakMap,s(wLe,"MeshDetachmentSystem");var Ftt=wLe;N();N();function ALe(t,e,r){var i;if(t.geometry!=null){let n=e||1e-4,a=n/t.currentHeight,o=n/r;t.geometry.scale(1,1,a),t.material&&(t.material.repeatYFactor=o),(i=t.mesh)==null||i.setGeometryAt(t.instanceIndex,t.geometry),t.currentHeight=n}}s(ALe,"updateHeight");var l1,iy,SLe=class{constructor(e){$(this,"rendererState"),$(this,"dirty",!1),Be(this,l1),Be(this,iy),this.rendererState=e}updateOne(e){var r;e instanceof Ua&&e.type==="geometry"&&(r=e.components[1])!=null&&r.dirty&&(He(this,l1,e.components[0]),He(this,iy,e.components[1]),e.type==="geometry"&&b(this,iy).height!==b(this,l1).currentHeight&&ALe(b(this,l1),b(this,iy).height,b(this,iy).initialHeight))}update(){let e;for(let r of this.rendererState.geometry3DIdsInScene)e=this.rendererState.geometry3DMap.get(r),this.updateOne(e);this.cleanup()}cleanup(){He(this,l1,void 0),He(this,iy,void 0)}};l1=new WeakMap,iy=new WeakMap,s(SLe,"MeshModificationSystem");var Btt=SLe;N();var ztt={showPolygonLabelTextAreaMesh:!1,showEnvMap:!1,showCollisionBoxes:!1},MLe=class{constructor(e){$(this,"state",ztt),$(this,"core"),this.core=e}update(e){let r={};for(let[i,n]of Object.entries(e))i in this.state&&this.state[i]!==e[i]&&(this.state[i]=n,r[i]=n);this.handleUpdate(r)}handleUpdate(e){e.showPolygonLabelTextAreaMesh!=null&&(e.showPolygonLabelTextAreaMesh?this.core.getSystems().text3DSystem.showTextAreaMesh():this.core.getSystems().text3DSystem.hideTextAreaMesh()),e.showEnvMap!=null&&(e.showEnvMap?this.core.setEnvironment("basic"):this.core.setEnvironment(!1)),e.showCollisionBoxes!=null&&(e.showCollisionBoxes?(this.core.getSystems().collisionSystem.showCollisionBoxes(),this.core.render()):this.core.getSystems().collisionSystem.hideCollisionBoxes())}};s(MLe,"Debug");var Utt=MLe;N();var wE=9,EX=.1;function ELe(t,e,r){for(let i=0;i<e;i++){let n=(r&16711680)>>16,a=(r&65280)>>8,o=r&255;t[i*3]=n/255,t[i*3+1]=a/255,t[i*3+2]=o/255}}s(ELe,"fillArrayWithColor");var CLe=class{constructor(e,r,i){if($(this,"state"),$(this,"renderer"),$(this,"renderService"),$(this,"pickingTexture"),$(this,"pickingMaterial"),$(this,"pixelBuffer"),$(this,"width",0),$(this,"height",0),$(this,"scale",1/2),$(this,"color",1),$(this,"convertTo3DMapPosition"),$(this,"destroyed",!1),$(this,"enabled",!1),$(this,"backgroundId",16777215),$(this,"resize",s(()=>{let n=this.state.pixelRatio;this.width=Math.floor(this.renderer.domElement.width/n*this.scale),this.height=Math.floor(this.renderer.domElement.height/n*this.scale),this.pixelBuffer=new Uint8Array(4*this.width*this.height),this.pickingTexture=new Qm(this.width,this.height,{format:Dl,type:ed,internalFormat:"RGBA"})},"resize")),$(this,"shouldShowByXY",s((n,a,o)=>{if(this.pixelBuffer==null)return!1;let l=n+(this.height-a-1)*this.width,u=this.pixelBuffer[l*4],c=this.pixelBuffer[l*4+1],p=this.pixelBuffer[l*4+2],m=u<<16|c<<8|p;return m===o||m===this.backgroundId},"shouldShowByXY")),$(this,"activeOccluders",new Set),$(this,"update",s(()=>{if(!this.enabled||(this.activeOccluders.clear(),this.activeOccluders.add(this.backgroundId),!this.pickingTexture||!this.pixelBuffer))return;let n,a;for(let l of this.state.geometry3DIdsInScene){let u=this.state.geometry3DMap.get(l);if(u&&u instanceof Kn&&u.userData.occluderFeature!=null&&u.userData.occluderId!=null&&(this.activeOccluders.add(u.userData.occluderId),u.userData.occluderDirty)){if(n=u.userData.occluderFeature,n.geometry.type==="Polygon"){let c=yj(n,this.convertTo3DMapPosition,{color:"white",height:EX});a=this.createOccluderMesh(c,u.userData.occluderId),u.add(a)}else if(n.geometry.type==="MultiPolygon"){let c=vj(n,this.convertTo3DMapPosition,{color:"white",height:EX});a=this.createOccluderMesh(c,u.userData.occluderId),u==null||u.add(a)}u.userData.occluderDirty=!1}}this.renderer.setRenderTarget(this.pickingTexture);let o=new si(this.backgroundId);this.renderer.setClearColor(o),this.renderer.clear(),this.state.cameraObject.layers.disableAll(),this.state.cameraObject.layers.enable(wE),this.renderer.render(this.state.entityScene.parent,this.state.cameraObject),this.renderer.setRenderTarget(null),this.state.cameraObject.layers.disable(wE),this.renderService.enabledLayers.delete(wE),this.renderer.readRenderTargetPixelsAsync(this.pickingTexture,0,0,this.width,this.height,this.pixelBuffer).then(()=>{if(!this.destroyed)for(let l of this.state.geometry2DIdsInScene){let u=this.state.geometry2DMap.get(l);if(u&&(u==null?void 0:u.occluderId)!=null&&this.activeOccluders.has(u==null?void 0:u.occluderId)){let c=u.components[0].projection,p=Math.floor(c.x*this.scale),m=Math.floor(c.y*this.scale),y=this.shouldShowByXY(p,m,u.occluderId);u.components[0].isOccluded=!y}}})},"update")),this.state=e,this.convertTo3DMapPosition=r,(i==null?void 0:i.renderer)==null)throw new Error("No Renderer");this.renderService=i,this.renderer=i.renderer,this.resize(),this.pickingMaterial=new bc({glslVersion:sO,vertexShader:`
				attribute vec3 color;
				varying vec3 vColor;
				void main() {
					vColor = color;
					gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
				}
			`,fragmentShader:`
				varying vec3 vColor;
				out vec4 fragColor;

				void main() {
					fragColor = vec4(vColor, 1.0);
				}
			`})}applyId(e,r){let i=e.attributes.position,n=new Float32Array(i.count*3);ELe(n,i.count,r),e.setAttribute("color",new Yo(n,3))}createOccluderMesh(e,r){let i=new Pn(e,this.pickingMaterial);return i.layers.set(wE),this.applyId(i.geometry,r),i.userData.occluderId=r,i}reserveOccluderId(){return this.color++,this.color}enable(){this.enabled=!0}disable(){this.enabled=!1}destroy(){var e;this.destroyed=!0,(e=this.pickingTexture)==null||e.dispose(),this.pickingMaterial.dispose(),this.pickingTexture=void 0,this.pixelBuffer=void 0}};s(CLe,"Occlusion2DSystem");var Vtt=CLe,CX=new BA,{DEFAULT_PITCH:ILe,DEFAULT_BEARING:TLe,DEFAULT_ZOOM_LEVEL:PLe,DEFAULT_MIN_ZOOM_LEVEL:jtt,DEFAULT_MAX_ZOOM_LEVEL:$tt}=_y,Gtt=Gn.radToDeg(.6435011087932844),Go,Mo,u1,TI,j2,ny,c1,$2,Ph,AN,Tt,ma,Ep,Eo,af,tl,Pt,PI,As,Ca,LLe,DLe,RLe,xy,LI,DI,RI,G2,SN,OI,kI,NI,H2,MN,h1,FI,Mu,Eu,EN,q2,BI,OLe=class extends Wa{constructor(e,r={}){var i,n,a,o,l,u,c,p,m,y,v,w;if(super(),Be(this,Ph),$(this,"options"),$(this,"container"),$(this,"Debug"),Be(this,Go),Be(this,Mo),Be(this,u1),Be(this,TI),Be(this,j2),Be(this,ny),Be(this,c1),Be(this,$2),$(this,"rendererDomElement"),Be(this,Tt,{geometry3DMap:new Map,geometry2DMap:new Map,geometry2DIdsInScene:new Set,geometry3DIdsInScene:new Set,entityScene:new Kn("__scene"),hoverColor:"#f6efff",text3dHoverColor:"white",insetsPadding:zB,shouldMeasureCanvas:!0,pixelRatio:this.resolutionScale,canvasWidth:0,canvasHeight:0,tweenGroup:new F4e,cameraObject:new Kl,naturalBearing:0,containerOffset:[0,0],useStandaloneCamera:!1}),$(this,"camera"),Be(this,ma),Be(this,Ep),Be(this,Eo),Be(this,af),Be(this,tl),Be(this,Pt,{}),Be(this,PI,window.matchMedia("screen and (min-resolution: 2dppx)")),$(this,"map"),Be(this,As,s(()=>{b(this,Pt).renderSystem.twoDdirty=!0},"#invalidate2DEntities")),Be(this,Ca,s(()=>{b(this,Pt).renderSystem.threeDdirty=!0},"#invalidate3DEntities")),Be(this,xy,"standalone"),Be(this,LI,s(k=>Math.trunc(k*10)/10,"#round10")),Be(this,DI,s(()=>{dr(this,Ph,AN).call(this,cw()),b(this,Pt).twoDDrawSystem.dirty=!0,b(this,G2).call(this,void 0,void 0,!0)},"#handlePixelRatioChange")),Be(this,RI,s(()=>{b(this,G2).call(this)},"#handleWindowResizeWithEvent")),Be(this,G2,s((k,B,U=!1)=>{let z=k??this.rendererDomElement.clientWidth,q=B??this.rendererDomElement.clientHeight;if((z===0||q===0)&&!U)return;b(this,Tt).canvasWidth=z,b(this,Tt).canvasHeight=q,dr(this,Ph,AN).call(this,cw()),b(this,H2).call(this),dr(this,Ph,RLe).call(this),b(this,Pt).cameraSystem.resize(this.canvasWidth,this.canvasHeight),b(this,Pt).cameraSystem.dirty=!0,b(this,Pt).watermarkSystem.resize(this.canvasWidth,this.canvasHeight),b(this,Pt).htmlControlsSystem.resize(this.canvasWidth),b(this,Pt).geometryInFocusSystem.resize(),b(this,Pt).occlusion2DSystem.resize();let{top:W,left:J}=this.container.getBoundingClientRect();b(this,Tt).containerOffset=[W,J],this.publish("resize"),this.render()},"#handleWindowResize")),Be(this,SN,s(()=>{this.renderSync()},"#renderFull")),Be(this,OI,new qe),Be(this,kI,s((k,B)=>{let U=this.mode==="standalone"?b(this,Mo):this.viewCamera;if(b(this,Mo).position.z+this.camera.elevation>B.z){b(this,OI).copy(B);let z=b(this,OI).project(U),q=(z.x+1)/2*this.canvasWidth-0/2,W=(-z.y+1)/2*this.canvasHeight-0/2,J=b(this,LI).call(this,q),V=b(this,LI).call(this,W);k.x=J,k.y=V}else k.x=-1e3,k.y=-1e3},"#project")),Be(this,NI,s((k,B)=>{b(this,tl).setBufferSize(k,B),b(this,Mo).aspect=k/B,b(this,Mo).updateProjectionMatrix(),b(this,Mo).updateMatrixWorld(!0),b(this,j2).x=k,b(this,j2).y=B},"#setBufferSize")),Be(this,H2,s(()=>{var k;let B=b(this,Tt).canvasWidth=this.rendererDomElement.clientWidth,U=b(this,Tt).canvasHeight=this.rendererDomElement.clientHeight,z=Math.floor(B*this.resolutionScale),q=Math.floor(U*this.resolutionScale);b(this,NI).call(this,z,q),(k=this.map)==null||k.resize(),b(this,Tt).shouldMeasureCanvas=!1},"#measureCanvas")),$(this,"getParentContainer",s((k,B=!0)=>{if(!k)return B?b(this,Tt).entityScene:void 0;if(typeof k=="string"||typeof k=="number"){let U=b(this,Tt).geometry3DMap.get(k);return U instanceof Kn?U:(Vt.warn("Parent (".concat(typeof k=="object"?k.id:k,") is not a valid container, adding to scene")),B?b(this,Tt).entityScene:void 0)}else if(k.type==="group-container"){let U=b(this,Tt).geometry3DMap.get(k.id);if(U instanceof Kn)return U}return B?b(this,Tt).entityScene:void 0},"getParentContainer")),$(this,"showCollisionBoxes",s(()=>{b(this,Pt).collisionSystem.showCollisionBoxes(),this.render()},"showCollisionBoxes")),$(this,"hideCollisionBoxes",s(()=>{b(this,Pt).collisionSystem.hideCollisionBoxes(),this.render()},"hideCollisionBoxes")),$(this,"projectScreenXYToCoordinate",s((k,B,U=!1)=>{var z,q;let W=b(this,Tt).containerOffset[0],J=b(this,Tt).containerOffset[1],V=(k-J)/b(this,Tt).canvasWidth*2-1,oe=-((B-W)/b(this,Tt).canvasHeight)*2+1,Y=new Jt(V,oe),he,Q;if(U)CX.setFromCamera(Y,b(this,Mo)),he=(z=CX.intersectObject(b(this,ny),!1)[0])==null?void 0:z.point;else{let ae=b(this,Pt).interactionSystem.getThreeDIntersectsFromXY(Y);he=(q=ae==null?void 0:ae[0])==null?void 0:q.point,Q=b(this,Pt).interactionSystem.getGroupContainerIntersectsFromXY(Y)}if(he)return{coordinate:this.convert3DMapPositionToCoordinate(he),groupContainers:Q}},"projectScreenXYToCoordinate")),$(this,"projectCoordinateToScreenXY",s(k=>{let B=this.convertTo3DMapPosition(k[1],k[0],k[2]||0),U=new Jt;return b(this,kI).call(this,U,B),{x:U.x,y:U.y}},"projectCoordinateToScreenXY")),$(this,"convert3DMapPositionToCoordinate",s(k=>{var B,U,z,q;let{lat:W,lon:J}=VB((U=(B=b(this,Tt).center)==null?void 0:B[1])!=null?U:0,(q=(z=b(this,Tt).center)==null?void 0:z[0])!=null?q:0,k.x,k.y);return[J,W,k.z]},"convert3DMapPositionToCoordinate")),$(this,"setBackgroundColor",s((k,B)=>{b(this,tl).setBackgroundColor(k,B)},"setBackgroundColor")),$(this,"getMetresPerPixel",s(()=>{let k=this.container.clientWidth,B=this.container.clientHeight/2,U=this.projectScreenXYToCoordinate(0,B,!0),z=this.projectScreenXYToCoordinate(k,B,!0);return U==null||z==null?void 0:kB(U.coordinate,z.coordinate)/k},"getMetresPerPixel")),$(this,"hideOutdoorLayersUnderPoint",s((k,B)=>{!this.map||(B==null?void 0:B.length)===0||(b(this,Pt).outdoorLayersSystem.hideLayersUnderPoint(k,B),this.render())},"hideOutdoorLayersUnderPoint")),$(this,"hideOutdoorLayersIntersectingPolygons",s((k,B,U)=>{b(this,Pt).outdoorLayersSystem.hideLayersIntersectingPolygons(k,B,U),this.render()},"hideOutdoorLayersIntersectingPolygons")),Be(this,h1,new OA),Be(this,FI,new Oi),$(this,"render",s(()=>{var k;if(((k=b(this,Pt))==null?void 0:k.renderSystem)!=null)if(this.map&&(this.mode==="outdoors-interleaved"||this.mode==="outdoors-overlay"))this.map.triggerRepaint();else return b(this,Pt).renderSystem.update()},"render")),$(this,"renderSync",s(()=>b(this,Pt).renderSystem.update(!0),"renderSync")),Be(this,Mu,tT(()=>{this.publish("user-interaction-start",void 0)},0,!0)),Be(this,Eu,tT(()=>{this.publish("user-interaction-end",void 0),this.render()},0,!0)),$(this,"on",s((k,B)=>{super.on(k,B),["outdoor-view-loaded","outdoor-style-loaded"].includes(k)&&this.mode==="standalone"&&$a.env.NODE_ENV!=="test"&&(Vt.warn('"'.concat(k,'" was subscribed to but outdoor view is disabled. The event has been triggered immediately. Enable outdoor view or remove the listener.')),this.publish(k))},"on")),$(this,"off",s((k,B)=>{super.off(k,B)},"off")),$(this,"getCursor",s(()=>b(this,Pt).interactionSystem.getCursor(),"getCursor")),$(this,"destroy",s(()=>{var k;b(this,Pt)&&(b(this,Pt).cameraSystem.off("user-dolly-start",b(this,Mu)),b(this,Pt).cameraSystem.off("user-pan-start",b(this,Mu)),b(this,Pt).cameraSystem.off("user-rotate-start",b(this,Mu)),b(this,Pt).cameraSystem.off("user-zoom-start",b(this,Mu)),b(this,Pt).cameraSystem.off("user-tilt-start",b(this,Mu)),b(this,Pt).cameraSystem.off("user-pedestal-start",b(this,Mu)),b(this,Pt).cameraSystem.off("user-dolly-end",b(this,Eu)),b(this,Pt).cameraSystem.off("user-pan-end",b(this,Eu)),b(this,Pt).cameraSystem.off("user-rotate-end",b(this,Eu)),b(this,Pt).cameraSystem.off("user-zoom-end",b(this,Eu)),b(this,Pt).cameraSystem.off("user-tilt-end",b(this,Eu)),b(this,Pt).cameraSystem.off("user-pedestal-end",b(this,Eu)),b(this,Pt).renderSystem.off("measure-canvas",b(this,H2)),b(this,Pt).meshOptimizationSystem.off("geometry-2d-added",this.render),b(this,Pt).meshOptimizationSystem.off("model-loaded",this.render),this.remove("__scene"),b(this,As).call(this),b(this,Ca).call(this),this.renderSync(),b(this,Pt).renderSystem.destroy(),b(this,Pt).cameraSystem.off("change",this.render),b(this,Pt).pathSystem.off("animate:path",this.render),b(this,Pt).cameraSystem.dispose(),b(this,Pt).exporterSystem.destroy(),b(this,Pt).outdoorLayersSystem.destroy(),b(this,Pt).drawSystem.destroy(),window.removeEventListener("resize",b(this,RI),!1),b(this,PI).removeEventListener("change",b(this,DI)),b(this,c1)&&b(this,c1).disconnect(),this._subscribers={},b(this,tl).destroy(),(k=b(this,Go))==null||k.traverse(B=>{Cl(B),"dispose"in B&&typeof B.dispose=="function"&&B.dispose()}),He(this,Go,void 0),b(this,Pt).htmlControlsSystem.destroy(),b(this,Pt).collisionSystem.destroy(),b(this,Pt).interactionSystem.destroy(),b(this,Pt).domMutationSystem.destroy(),b(this,Pt).geometryInFocusSystem.destroy(),He(this,Pt,void 0),b(this,xy)!=="outdoors-overlay"&&(this.map&&(this.map.transform.getElevation=void 0,this.map.remove()),this.container.contains(this.rendererDomElement)&&this.container.removeChild(this.rendererDomElement)),this.container.removeChild(b(this,af)),this.container.removeChild(b(this,ma)),He(this,tl,void 0))},"destroy")),Be(this,q2,new qe),Be(this,BI,new qe),b(this,Tt).useStandaloneCamera=(i=r.useStandaloneCamera)!=null?i:!1,b(this,Tt).naturalBearing=(n=r.naturalBearing)!=null?n:0,this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),!e.clientWidth||!e.clientHeight)throw new Error("[MappedinJS] Container width and height must be greater than 0");this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),(r.mode==="outdoors-interleaved"||r.mode==="outdoors-overlay")&&r.map&&(He(this,xy,r.mode),this.map=r.map),b(this,Tt).entityScene.addEventListener("childadded",()=>{b(this,Ca).call(this),b(this,As).call(this)}),b(this,Tt).entityScene.addEventListener("childremoved",()=>{b(this,Ca).call(this),b(this,As).call(this)}),b(this,Tt).geometry3DMap.set(b(this,Tt).entityScene.userData.entityId,b(this,Tt).entityScene),r.center&&(b(this,Tt).center=r.center?[...r.center]:[0,0]),this.options=r,this.container=e,dr(this,Ph,LLe).call(this),dr(this,Ph,DLe).call(this),b(this,Pt).htmlControlsSystem=new ptt(this.container),b(this,xy)!=="outdoors-overlay"&&b(this,Pt).htmlControlsSystem.addAttributionControl(this.options.attribution),window.MappedinDebug||(window.MappedinDebug={}),$a.env.NODE_ENV==="test"&&(window.MappedinDebug.mapViewCoreInstance=this),He(this,tl,new hJe({antialias:typeof r.antialias=="boolean"?r.antialias:!0,alpha:!1,canvas:this.mode!=="standalone"?(a=r.gl)==null?void 0:a.canvas:void 0,onWebGLContextCreationError:r.onWebGLContextCreationError,onWebGLContextLost:r.onWebGLContextLost,onWebGLContextRestored:s(k=>{var B;(B=r.onWebGLContextRestored)==null||B.call(r,k),b(this,As).call(this),b(this,Ca).call(this),this.render()},"onWebGLContextRestored"),onWebGLRendererError:r.onWebGLRendererError,backgroundColor:r.backgroundColor||"#ffffff",backgroundAlpha:(o=r.backgroundAlpha)!=null?o:1})),He(this,Go,new bB),b(this,Go).add(b(this,Tt).entityScene);let E=window.__THREE_DEVTOOLS__;$a.env.NODE_ENV==="dev"&&typeof E<"u"&&(E.dispatchEvent(new CustomEvent("observe",{detail:b(this,Go)})),E.dispatchEvent(new CustomEvent("observe",{detail:b(this,tl)}))),He(this,Mo,new Kl(Gtt,this.aspect,50,1e5)),b(this,Tt).cameraObject=b(this,Mo),He(this,TI,new xB),b(this,Mo).renderOrder=999;let M=new qa;M.add(b(this,Mo)),He(this,$2,new qa),b(this,$2).add(M),b(this,Go).add(b(this,$2)),b(this,Mo).updateProjectionMatrix(),b(this,Mo).updateMatrixWorld(!0),this.referenceMap={scale:1,latitude:0,longitude:0,getNorth:s(()=>0,"getNorth"),georeference:[{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}}]},this.rendererDomElement=b(this,tl).domElement(),He(this,j2,new Jt);let I=new pv(1e6,1e6),P=new ug({color:0,visible:!1});He(this,ny,new Pn(I,P)),b(this,ny).name="worldPlane",b(this,Go).add(b(this,ny)),(l=r.gl)!=null&&l.canvas||e.appendChild(this.rendererDomElement),window.addEventListener("resize",b(this,RI),!1),b(this,PI).addEventListener("change",b(this,DI)),typeof ResizeObserver=="function"&&((u=$a.env)==null?void 0:u.NODE_ENV)!=="test"&&(He(this,c1,new ResizeObserver(LP(k=>{b(this,G2).call(this,k[0].contentRect.width,k[0].contentRect.height)},50))),(c=b(this,c1))==null||c.observe(e)),e.classList.add("mappedin-map"),this.rendererDomElement.style.width=(p=globalThis.MappedinDebug)!=null&&p.TEST_IOS?"1080px":"100%",this.rendererDomElement.style.height=(m=globalThis.MappedinDebug)!=null&&m.TEST_IOS?"1920px":"100%",$a.env.NODE_ENV==="test"&&this.rendererDomElement.setAttribute("data-testid","mappedin-canvas"),b(this,Tt).canvasWidth=this.rendererDomElement.clientWidth,b(this,Tt).canvasHeight=this.rendererDomElement.clientHeight,this.rendererDomElement.style.touchAction="manipulation";let C=this.canvasWidth,T=this.canvasHeight;b(this,Pt).watermarkSystem=new att(b(this,Mo),b(this,Tt),r==null?void 0:r.watermark),b(this,Pt).watermarkSystem.on("texture-loaded",this.render),b(this,Tt).shouldMeasureCanvas=!0,b(this,Tt).pixelRatio=this.resolutionScale,b(this,NI).call(this,Math.floor(C*this.resolutionScale),Math.floor(T*this.resolutionScale));let O=new Ade(16777215,.3*Math.PI);O.position.set(-150,-150,350),b(this,Go).add(O);let F=new uje(16777215,.741*Math.PI);b(this,Go).add(F),b(this,Pt).cameraSystem=new W4e(b(this,Mo),b(this,Go),b(this,tl).renderer,b(this,Tt),{mode:this.mode,canvasHeight:T,canvasWidth:C}),b(this,Pt).cameraSystem.on("user-dolly-start",b(this,Mu)),b(this,Pt).cameraSystem.on("user-pan-start",b(this,Mu)),b(this,Pt).cameraSystem.on("user-rotate-start",b(this,Mu)),b(this,Pt).cameraSystem.on("user-zoom-start",b(this,Mu)),b(this,Pt).cameraSystem.on("user-tilt-start",b(this,Mu)),b(this,Pt).cameraSystem.on("user-pedestal-start",b(this,Mu)),b(this,Pt).cameraSystem.on("user-dolly-end",b(this,Eu)),b(this,Pt).cameraSystem.on("user-pan-end",b(this,Eu)),b(this,Pt).cameraSystem.on("user-rotate-end",b(this,Eu)),b(this,Pt).cameraSystem.on("user-zoom-end",b(this,Eu)),b(this,Pt).cameraSystem.on("user-tilt-end",b(this,Eu)),b(this,Pt).cameraSystem.on("user-pedestal-end",b(this,Eu)),b(this,Pt).cameraSystem.on("change",()=>{this.publish("camera-change",this.camera),b(this,Pt).geometryInFocusSystem&&(b(this,Pt).geometryInFocusSystem.cameraDirty=!0),this.render()}),b(this,Pt).pathSystem=new Ntt(b(this,Tt),this.convertTo3DMapPosition,this.getParentContainer,b(this,Pt).cameraSystem.convertZoomLevelToAltitude),b(this,Pt).pathSystem.on("animate:path",this.render),b(this,Pt).panBoundsSystem=new stt(b(this,Tt),b(this,Pt).cameraSystem),b(this,Pt).panBoundsSystem.on("update",()=>{let{panBounds:k,fov:B,convertAltitudeToZoomLevel:U}=b(this,Pt).cameraSystem;if(b(this,Pt).panBoundsSystem.autoMinZoomLevel){if(k.radius<=0)return;let z=Math.min(b(this,Tt).canvasWidth/b(this,Tt).canvasHeight,1),q=B*Math.PI/180*z,W=Math.tan(q/2),{radius:J,center:V}=b(this,Pt).cameraSystem.panBounds,oe=J/W,Y=this.getThreeCamera().getWorldPosition(new qe),he=V.distanceTo(Y),Q=Math.abs(Y.z-V.z),ae=oe*Q/he,ee=U(ae);Cge(ee,this.camera.minZoomLevel)&&this.camera.setMinZoomLevel(ee)}}),this.camera=new Zet(this,b(this,Pt),b(this,Tt)),this.camera.setZoomLevel((y=r.zoomLevel)!=null?y:PLe),this.camera.setBearing((v=r.bearing)!=null?v:TLe),this.camera.setPitch((w=r.pitch)!=null?w:ILe),this.camera.setMaxZoomLevel($tt),this.camera.setMinZoomLevel(jtt),b(this,Pt).domVisiblitySystem=new fet(b(this,Tt),b(this,af)),b(this,Pt).domMutationSystem=new Het(b(this,Tt),b(this,af)),b(this,Pt).domMutationSystem.on("dimensions-update",()=>{b(this,Pt).collisionSystem.collidersDirty=!0,this.render()}),b(this,Pt).domDrawSystem=new $et(b(this,Tt)),b(this,Pt).collisionSystem=new fJe(b(this,Ep),b(this,Tt)),b(this,Pt).twoDDrawSystem=new wet(b(this,Tt),b(this,Eo),r.transformImageRequest),b(this,Pt).twoDDrawSystem.on("img:loaded",this.render),b(this,Pt).interactionSystem=new yJe(this.rendererDomElement,b(this,Tt),b(this,Mo),b(this,ny),b(this,Pt).cameraSystem.isUserInteracting),b(this,Pt).interactionSystem.on("doubletap-with-onefinger",k=>{var B;this.camera.animateTo({center:(B=this.projectScreenXYToCoordinate(k.clientX,k.clientY))==null?void 0:B.coordinate,zoomLevel:this.camera.zoomLevel+1,duration:AW,easing:"ease-out"})}),b(this,Pt).interactionSystem.on("singletap-with-twofinger",()=>{this.camera.animateTo({zoomLevel:this.camera.zoomLevel-1,duration:AW,easing:"ease-out"})}),b(this,Pt).interactionSystem.on("hover",this.render),b(this,Pt).interactionSystem.on("click",k=>{var B,U,z,q,W,J;if(((B=k.entity2D)==null?void 0:B.id)==="watermark"&&typeof b(this,Pt).watermarkSystem.options.onClick=="function"&&b(this,Pt).watermarkSystem.options.interactive){b(this,Pt).watermarkSystem.options.onClick();return}this.publish("click",{coordinate:this.convert3DMapPositionToCoordinate(k.position),geometry:k.entity3D?[(U=k.entity3D)==null?void 0:U.id]:[],paths:((z=k.entity3D)==null?void 0:z.components[0])instanceof yI?[k.entity3D.id]:[],markers:((q=k.entity2D)==null?void 0:q.components[0])instanceof dw?[k.entity2D.id]:[],models:((W=k.entity3D)==null?void 0:W.components[0])instanceof mI?[k.entity3D.id]:[],labels:((J=k.entity2D)==null?void 0:J.components[0])instanceof d_?[k.entity2D.id]:[],containers:Array.isArray(k.groupContainers)?k.groupContainers.map(V=>V.userData.entityId):[],pointerEvent:k.pointerEvent})}),b(this,Pt).interactionSystem.on("hover",k=>{var B,U,z,q,W,J;k.position&&((B=k.entity2D)==null?void 0:B.id)!=="watermark"&&this.publish("hover",{coordinate:this.convert3DMapPositionToCoordinate(k.position),geometry:k.entity3D?[(U=k.entity3D)==null?void 0:U.id]:[],paths:((z=k.entity3D)==null?void 0:z.components[0])instanceof yI?[k.entity3D.id]:[],markers:((q=k.entity2D)==null?void 0:q.components[0])instanceof dw?[k.entity2D.id]:[],models:((W=k.entity3D)==null?void 0:W.components[0])instanceof mI?[k.entity3D.id]:[],labels:((J=k.entity2D)==null?void 0:J.components[0])instanceof d_?[k.entity2D.id]:[],containers:Array.isArray(k.groupContainers)?k.groupContainers.map(V=>V.userData.entityId):[]})}),b(this,Pt).geometryInFocusSystem=new Itt(b(this,Tt),b(this,Mo)),b(this,Pt).geometryInFocusSystem.on("geometry-in-focus",k=>{this.publish("geometry-in-focus",k)}),b(this,Pt).twoDVisiblitySystem=new Eet(b(this,Tt)),b(this,Pt).drawSystem=new Met(b(this,Tt),this.convertTo3DMapPosition),b(this,Pt).drawSystem.on("texture-loaded",this.render),b(this,Pt).stackSystem=new Pet(b(this,Tt)),b(this,Pt).twoDProjectionSystem=new met(b(this,Tt),b(this,kI)),b(this,Pt).exporterSystem=new JQe(b(this,Tt)),b(this,Pt).meshOptimizationSystem=new det(b(this,Tt),this.convertTo3DMapPosition),b(this,Pt).meshOptimizationSystem.on("model-loaded",this.render),b(this,Pt).meshOptimizationSystem.on("geometry-2d-added",this.render),b(this,Pt).meshDetachmentSystem=new Ftt(b(this,Tt)),b(this,Pt).meshModificationSystem=new Btt(b(this,Tt)),b(this,Pt).customGeometrySystem=new dtt(b(this,Tt),this.convertTo3DMapPosition),b(this,Pt).outlineInterpolationSystem=new mtt(b(this,Tt)),b(this,Pt).renderSystem=new Cet(b(this,tl),b(this,Tt),this.mode,b(this,Go),b(this,Mo),this.viewCamera,b(this,Pt)),b(this,Pt).imageSystem=new Ett(b(this,Tt),this.convertTo3DMapPosition,r.bearing,r.naturalBearing,r.imagePlacementOptions),b(this,Pt).text3DSystem=new UQe(b(this,Tt),this.convertTo3DMapPosition),b(this,Pt).text3DSystem.on("render",this.render),b(this,Pt).imageSystem.on("image-loaded",this.render),b(this,Pt).renderSystem.on("pre-render",()=>this.publish("pre-render")),b(this,Pt).renderSystem.on("post-render",()=>this.publish("post-render")),b(this,Pt).renderSystem.on("measure-canvas",b(this,H2)),b(this,Pt).outdoorLayersSystem=new Ptt(this.map),b(this,Pt).occlusion2DSystem=new Vtt(b(this,Tt),this.convertTo3DMapPosition,b(this,tl)),r.occlusionEnabled&&b(this,Pt).occlusion2DSystem.enable(),this.Debug=new Utt(this),r.environment!==!1&&He(this,u1,dr(this,Ph,EN).call(this)),b(this,SN).call(this)}get viewCamera(){return b(this,TI)}get canvasWidth(){return b(this,Tt).canvasWidth}get canvasHeight(){return b(this,Tt).canvasHeight}get resolutionScale(){var e,r;return(r=(e=this.map)==null?void 0:e._getClampedPixelRatio(this.canvasWidth,this.canvasHeight))!=null?r:cw()}get aspect(){return this.canvasWidth/this.canvasHeight}get mode(){return b(this,xy)}addGroupContainer(e,r,i){if(!b(this,Tt).geometry3DMap.has(e)&&!b(this,Tt).geometry2DMap.has(e)){let n=new Kn(e);n.addEventListener("childadded",()=>{b(this,Ca).call(this),b(this,As).call(this)}),n.addEventListener("childremoved",()=>{b(this,Ca).call(this),b(this,As).call(this)}),(r==null?void 0:r.visible)!==void 0&&(n.visible=r.visible),(r==null?void 0:r.altitude)!==void 0&&n.setAltitude(r.altitude),(r==null?void 0:r.interactive)!==void 0&&El(n,r.interactive,b(this,Tt)),(r==null?void 0:r.focusable)!==void 0&&rN(n,r.focusable),(r==null?void 0:r.preloadGeometry)!==void 0&&(n.userData.preloadGeometry=r.preloadGeometry),b(this,Tt).geometry3DMap.set(e,n);let a=this.getParentContainer(i);a instanceof Kn&&a.addEntity(n),b(this,Ca).call(this),this.render()}else Vt.error("Group container with ID '".concat(e,"' already exists. The group container cannot be added."));return{id:e,type:"group-container"}}addStackContainer(e,r,i){if(b(this,Tt).geometry3DMap.has(e))Vt.error("Stack container with ID '".concat(e,"' already exists. The stack container cannot be added."));else{let n=new Kn(e);n.addEventListener("childadded",()=>{b(this,Ca).call(this),b(this,As).call(this)}),n.addEventListener("childremoved",()=>{b(this,Ca).call(this),b(this,As).call(this)}),n.components[0]=new Get,(r==null?void 0:r.visible)!==void 0&&(n.visible=r.visible),b(this,Tt).geometry3DMap.set(e,n);let a=this.getParentContainer(i);a instanceof Kn&&a.addEntity(n)}return{id:e,type:"stack-container"}}addCustomGeometry(e,r,i,n,a){if(b(this,Tt).geometry3DMap.has(e))Vt.error("Custom geometry with ID '".concat(e,"' already exists. The custom geometry cannot be added."));else{let o=new j6(r,i),l=new Ua(o,new c_(n));(n==null?void 0:n.interactive)!==void 0&&El(l,n.interactive,b(this,Tt)),l.id=e,o.mesh.userData={entityId:e,type:"custom-geometry"},b(this,Tt).geometry3DMap.set(l.id,l);let u=this.getParentContainer(a);u instanceof Kn&&u.addEntity(l),b(this,Ca).call(this),this.render()}return{id:e,type:"custom-geometry"}}addGeometryGroup(e,r,i,n){var a,o;if(!b(this,Tt).geometry3DMap.has(e)&&!b(this,Tt).geometry2DMap.has(e)){let l=new Fu(e,new UO(i));l.addEventListener("childadded",()=>{b(this,Ca).call(this),b(this,As).call(this)}),l.addEventListener("childremoved",()=>{b(this,Ca).call(this),b(this,As).call(this)}),l.userData.dirty=!0,b(this,Tt).geometry3DMap.set(e,l);for(let c of r.features){if(c.geometry==null||!["Polygon","MultiPolygon","LineString","MultiLineString"].includes(c.geometry.type))continue;let p=(c==null?void 0:c.id)||((a=c==null?void 0:c.properties)==null?void 0:a.id)||ya(),m=i||{color:zO},{visible:y}=m,v=Nh(m,["visible"]),w=b(this,Pt).meshOptimizationSystem.createEntityFromFeature(p,c,vt(Ee({},v),{outline:!0}));b(this,Tt).geometry3DMap.set(p,w),l.userData.entities3D.add(p)}l.setVisible((o=i==null?void 0:i.visible)!=null?o:!0),(i==null?void 0:i.altitude)!=null&&l.setAltitude(i.altitude);let u=this.getParentContainer(n);u instanceof Kn&&u.addEntity(l),b(this,Ca).call(this),this.render()}else Vt.error("Geometry group with ID '".concat(e,"' already exists. The geometry group cannot be added."));return b(this,Pt).outlineInterpolationSystem.geometries3DDirty=!0,{id:e,type:"geometry-group"}}addOccluder(e,r){let i=this.getParentContainer(r),n=b(this,Pt).occlusion2DSystem.reserveOccluderId();return i==null||i.addOccluderFeature(e,n),n}addImage(e,r,i,n){try{sLe(e,r,i)}catch(a){Vt.error(a);return}if(!b(this,Tt).geometry3DMap.has(e)&&!b(this,Tt).geometry2DMap.has(e)){let a=new _tt(r),o=new Ua(a,new c_(i));o.id=e||ya(),a.mesh.userData={entityId:o.id,type:"path"},b(this,Tt).geometry3DMap.set(o.id,o);let l=this.getParentContainer(n);l instanceof Kn&&l.addEntity(o),b(this,Ca).call(this),this.render()}else Vt.error("Image with ID '".concat(e,"' already exists. The image cannot be added."));return{id:e,type:"image"}}addModelGroup(e,r,i,{parent:n,onComplete:a}={}){var o,l;try{x4e(e,r,i)}catch(u){Vt.error(u);return}if(!b(this,Tt).geometry3DMap.has(e)&&!b(this,Tt).geometry2DMap.has(e)){let u=new Fu(e,new UO(vt(Ee({},i),{outline:!1})));u.addEventListener("childadded",()=>{b(this,Ca).call(this),b(this,As).call(this)}),u.addEventListener("childremoved",()=>{b(this,Ca).call(this),b(this,As).call(this)}),b(this,Tt).geometry3DMap.set(e,u),u.userData.dirty=!0,u.userData.modelURL=i.url;for(let p of r.features){let m=p.id||p.properties.id||ya(),y=b(this,Pt).meshOptimizationSystem.createModelFromFeature(m,p,i);(p.properties.interactive!==void 0||i.interactive!=null)&&El(y,(o=p.properties.interactive)!=null?o:i.interactive,b(this,Tt)),b(this,Tt).geometry3DMap.set(m,y),u.userData.entities3D.add(m)}let c=this.getParentContainer(n);c instanceof Kn&&c.addEntity(u),b(this,Ca).call(this),(l=this.render())==null||l.then(a)}else Vt.error("Model group with ID '".concat(e,"' already exists. The model group cannot be added."));return{id:e,type:"geometry-group"}}addMarker2D(e,r,i,n){var a;let o=i==null?void 0:i.id;try{h5e(e,r,i||{})}catch(l){Vt.error(l);return}if(o===void 0||!b(this,Tt).geometry2DMap.has(o)&&!b(this,Tt).geometry3DMap.has(o)){let l=dr(this,Ph,MN).call(this,e,new dw(r,i),i==null?void 0:i.occluderId,i==null?void 0:i.verticalOffset);l.id=o||String(l.id),o=l.id,(i==null?void 0:i.interactive)!=null&&i.interactive!=="pointer-events-auto"&&El(l,i==null?void 0:i.interactive,b(this,Tt));let u=typeof(i==null?void 0:i.attachTo)=="string"||typeof(i==null?void 0:i.attachTo)=="number"?b(this,Tt).geometry3DMap.get(i.attachTo):void 0;u instanceof Ua&&u.attach(l),(a=this.getParentContainer(n))==null||a.addEntity(l),this.render()}else Vt.error("Marker2D with ID '".concat(o,"' already exists. The marker cannot be added."));return{id:o,type:"marker"}}addText3D(e,r,i,n){if(!b(this,Tt).geometry3DMap.has(e)&&!b(this,Tt).geometry2DMap.has(e)){let a=new lI(vt(Ee({},r),{properties:vt(Ee({},r.properties),{id:e,content:r.properties.text})})),o=new Ua(a,new jO(i==null?void 0:i.appearance));o.id=e,a.mesh.userData.entityId=e.toString(),a.mesh.userData.type="text3d",b(this,Tt).geometry3DMap.set(e,o);let l=this.getParentContainer(n);l instanceof Kn&&l.addEntity(o),b(this,Ca).call(this),this.render()}else Vt.error("Text3D with ID '".concat(e,"' already exists. The text3d cannot be added."));return{id:e,type:"text3d"}}labelText3D(e,r,i={}){var n,a;try{if(!r||!e)throw new Error("content and meshGeometryId are required");GQe.parse(i)}catch(p){Vt.error(p);return}let o=b(this,Tt).geometry3DMap.get(e);if((o==null?void 0:o.type)!=="geometry"){Vt.error(".labelText3D failed: target incorrect");return}let l=o==null?void 0:o.components[0];if(!l.feature.properties.textArea)return;if(l.textEntityId){let p=b(this,Tt).geometry3DMap.get(l.textEntityId);if((p==null?void 0:p.type)!=="text3d"){Vt.error(".labelText3D failed: existing text3d not found");return}return{id:p.id,type:p.type}}let u=new lI({type:"Feature",geometry:{coordinates:(n=l.feature.properties.textArea)==null?void 0:n.position,type:"Point"},properties:{textArea:l.feature.properties.textArea,content:r,id:ya()}});u.polygonEntityId=e;let c=new Ua(u,new jO(i==null?void 0:i.appearance));return l.textEntityId=c.id.toString(),u.mesh.userData.entityId=c.id.toString(),u.mesh.userData.type="text3d",b(this,Tt).geometry3DMap.set(c.id.toString(),c),i.parentId&&((a=this.getParentContainer(i.parentId))==null||a.addEntity(c)),this.render(),{id:c.id,type:"text3d"}}addLabel2D(e,r,i,n){var a;let o=i==null?void 0:i.id;try{k5e(e,r,i||{})}catch(l){Vt.error(l);return}if(o===void 0||!b(this,Tt).geometry2DMap.has(o)&&!b(this,Tt).geometry3DMap.has(o)){let l=dr(this,Ph,MN).call(this,e,new d_(r,i||{},b(this,Tt)),i==null?void 0:i.occluderId,i==null?void 0:i.verticalOffset);l.id=o||String(l.id),o=l.id,(i==null?void 0:i.interactive)!=null&&El(l,i==null?void 0:i.interactive,b(this,Tt));let u=typeof(i==null?void 0:i.attachTo)=="string"||typeof(i==null?void 0:i.attachTo)=="number"?b(this,Tt).geometry3DMap.get(i.attachTo):void 0;u instanceof Ua&&u.attach(l),(a=this.getParentContainer(n))==null||a.addEntity(l),b(this,As).call(this),this.render()}else Vt.error("Label2D with ID '".concat(o,"' already exists. The label cannot be added."));return{id:o,type:"label"}}addPath(e,r={},i){var n;try{O4e(e,r||{})}catch(u){Vt.error(u);return}let a=new yI(e,mj(r)),o=new Ua(a,new c_({color:(n=r==null?void 0:r.color)!=null?n:"#ff834c"}));o.id=(r==null?void 0:r.id)||ya(),a.mesh.userData={entityId:o.id,type:"path"},b(this,Tt).geometry3DMap.set(o.id,o),(r==null?void 0:r.interactive)!=null&&El(o,r==null?void 0:r.interactive,b(this,Tt));let l=this.getParentContainer(i);return l instanceof Kn&&l.addEntity(o),b(this,Ca).call(this),this.render(),{id:o.id,type:"path"}}updateWatermark(e){b(this,Pt).watermarkSystem.options=e,b(this,Pt).watermarkSystem.dirty=!0,b(this,Pt).collisionSystem.collidersDirty=!0,this.render()}remove(e){var r;let i;if(typeof e=="string"||typeof e=="number"?(i=b(this,Tt).geometry2DMap.get(e),i==null&&(i=b(this,Tt).geometry3DMap.get(e))):typeof e.id=="string"||typeof e.id=="number"?(i=b(this,Tt).geometry2DMap.get(e.id),i==null&&(i=b(this,Tt).geometry3DMap.get(e.id))):i=e,i!=null){if(i.type==="custom-geometry")b(this,Tt).geometry3DMap.delete(i.id),i.object3d&&Cl(i.object3d);else if(i.type==="group-container"){b(this,Tt).geometry3DMap.delete(i.userData.entityId);for(let a of i.childrenIds.values())this.remove(a),i.userData.entities2D.delete(a);let n=i.components[2];n&&n.focusMesh&&Cl(n.focusMesh),Cl(i)}else if(i.type==="geometry-group"){b(this,Tt).geometry3DMap.delete(i.userData.entityId);for(let n of i.userData.entities3D.values())this.remove(n),i.userData.entities3D.delete(n);Cl(i)}else if(i.type==="geometry"||i.type==="model"||i.type==="path"){let n=i.components[0];if(i.entities2D.size>0){for(let a of i.entities2D.values())this.remove(a);i.removeAllEntities()}if(i.object3d&&(((r=i.parentObject3D)==null?void 0:r.type)==="geometry-group"&&i.parentObject3D.userData.entities3D.delete(i.id),Cl(i.object3d)),i.type==="geometry"){let a=i.components[3];a&&(a.visible=!1,a.dirty=!0)}"focusMesh"in n&&n.focusMesh!=null&&Cl(n.focusMesh),"textMesh"in n&&n.textMesh!=null&&this.remove(n.textMesh.userData.entityId),b(this,Tt).geometry3DMap.delete(i.id)}else if(i.type==="marker"||i.type==="label"){let n=i.attachedTo;if(n){let a=b(this,Tt).geometry3DMap.get(n);a instanceof Ua&&a.detach(i)}i.object3d&&Cl(i.object3d),i.type==="label"&&delete b(this,Pt).twoDDrawSystem.textCache[i.id],b(this,Tt).geometry2DMap.delete(i.id)}else if(i.type==="image")i.object3d&&Cl(i.object3d),b(this,Tt).geometry3DMap.delete(i.id);else if(i.type==="text3d"){Cl(i.object3d);let{batchedText:n,textMesh:a,polygonEntityId:o}=i.components[0];if(a&&(n&&n.removeText(a),Cl(a)),o){b(this,Pt).text3DSystem.remove(o);let l=b(this,Tt).geometry3DMap.get(o);(l==null?void 0:l.type)==="geometry"&&(l.components[0].textMesh=void 0,l.components[0].textEntityId=void 0)}b(this,Tt).geometry3DMap.delete(i.id)}b(this,Ca).call(this),b(this,As).call(this),this.render()}}getScene(){return this.getState("__scene")}getThreeScene(){return b(this,Go)}getThreeCamera(){return b(this,Mo)}async setEnvironment(e){if(b(this,Go))if(e==="basic"){b(this,u1)||He(this,u1,dr(this,Ph,EN).call(this));let r=await b(this,u1);b(this,Go).environment=r}else b(this,Go).environment=null}getEnvironment(){var e;return(e=b(this,Go))!=null&&e.environment?"basic":!1}getCurrentSceneGLTF(e){return b(this,Pt).exporterSystem.getCurrentSceneGLTF(e)}getBoundingArea(e){(b(this,Pt).renderSystem.threeDdirty||b(this,Pt).renderSystem.twoDdirty)&&this.renderSync();let r=new ro;if(e==null)r.setFromObject(b(this,Tt).entityScene);else{let i=F1(b(this,Tt),e);if((i==null?void 0:i.type)==="geometry"&&(i==null?void 0:i.object3d)!=null){let n=i.components[0],a=n instanceof ru?n.geometry:void 0;n.mesh instanceof wB&&a?(a.computeBoundingBox(),a.boundingBox&&r.union(a.boundingBox)):r.setFromObject(i.object3d)}else((i==null?void 0:i.type)==="geometry-group"||(i==null?void 0:i.type)==="group-container")&&(i==null?void 0:i.userData.entityId)!=null&&r.setFromObject(i)}if(J3(r))return gge(r).map(this.convert3DMapPositionToCoordinate)}getState(e){var r,i,n,a,o,l,u,c,p,m;if(e==null)return{type:"map-view",hoverColor:b(this,Tt).hoverColor,text3dHoverColor:b(this,Tt).text3dHoverColor};let y=F1(b(this,Tt),e);if((y==null?void 0:y.type)==="custom-geometry"){let v=y.components[0],w=y.components[1];return{id:y.id,type:"custom-geometry",visible:w.visible,altitude:w.altitude,parent:(r=y.parentObject3D)==null?void 0:r.userData.entityId,position:this.convert3DMapPositionToCoordinate(v.position)}}else if((y==null?void 0:y.type)==="geometry-group"){let v=[];for(let E of y.userData.entities3D.values()){let M=this.getState(E);((M==null?void 0:M.type)==="geometry"||(M==null?void 0:M.type)==="model")&&v.push(M)}let w=y.components[0];return{id:y.userData.entityId,type:"geometry-group",visible:y.visible,opacity:w.opacity,color:w.color,initialColor:w.initialColor,height:w.height,altitude:y.altitude,topColor:w.topColor,outline:w.outline,shading:w.shading,texture:w.texture,topTexture:w.topTexture,interactive:Array.from(y.userData.entities3D.values()).map(E=>b(this,Tt).geometry3DMap.get(E)).every(E=>E&&E.components[2]!=null),children:Array.from(y.userData.entities3D.values()).map(E=>this.getState(E)).filter(Boolean)}}else{if((y==null?void 0:y.type)==="group-container")return{id:y.userData.entityId,type:"group-container",visible:y.visible,altitude:y.altitude,opacity:y.opacity,interactive:!!y.components[1],children:Array.from(y.childrenIds.values()).map(v=>this.getState(v)).filter(Boolean)};if((y==null?void 0:y.type)==="label"){let v=y.components[0],w=y.object3d.parent,E=w==null?void 0:w.userData.entityId;return{id:y.id,type:"label",text:v.text||"",parent:{id:E,type:w==null?void 0:w.type},position:this.convert3DMapPositionToCoordinate(y.position),enabled:v.enabled,visible:v.visible,initialRank:L2(v.initialRank),options:{rank:L2(v.rank),appearance:v.appearance,interactive:y.components[1]!=null,verticalOffset:y.verticalOffset,attachTo:y.attachedTo}}}else if((y==null?void 0:y.type)==="marker"){let v=y.components[0],w=y.object3d.parent,E=w==null?void 0:w.userData.entityId;return{id:y.id,type:"marker",enabled:v.enabled,visible:v.visible,anchor:v.options.anchor,dynamicResize:v.options.dynamicResize,parent:{id:E,type:w==null?void 0:w.type},position:this.convert3DMapPositionToCoordinate(y.position),element:v.containerEl,initialRank:L2(v.initialRank),options:{rank:L2(v.rank),interactive:y.components[1]!=null||!1,verticalOffset:y.verticalOffset,attachTo:y.attachedTo,lowPriorityPin:v.options.lowPriorityPin}}}else if((y==null?void 0:y.type)==="geometry"){let{color:v,hoverColor:w,initialColor:E,initialTopColor:M,topColor:I}=y.components[1],P=y.components[0],C=y.components[1],T=y.components[2],O=y.components[3],F=y.parentObject3D;return{id:y.id,type:"geometry",opacity:C.opacity,initialColor:E,color:v,focusable:P.focusable,initialTopColor:M,topColor:I,hoverColor:w,hovered:!!(T!=null&&T.hover),height:C.height,visible:C.visible,outline:O==null?void 0:O.visible,showImage:C.showImage,texture:C.texture,topTexture:C.topTexture,flipImageToFaceCamera:C.flipImageToFaceCamera,parent:{id:F==null?void 0:F.userData.entityId,type:F==null?void 0:F.type},position:this.convert3DMapPositionToCoordinate(P.position),interactive:y.components[2]!=null}}else if((y==null?void 0:y.type)==="model"){let v=y.components[0],w=y.components[1],E=y.components[2];return{id:y.id,type:"model",position:v.mesh?this.convert3DMapPositionToCoordinate((i=v.mesh)==null?void 0:i.getWorldPosition(new qe)):this.convert3DMapPositionToCoordinate(v.position),interactive:E!=null,material:w.material,parent:(n=y.parentObject3D)!=null&&n.parent?{id:y.parentObject3D.parent.userData.entityId,type:y.parentObject3D.parent.type}:void 0,visible:w.visible,verticalOffset:w.verticalOffset,color:w.color,opacity:w.opacity,rotation:(a=w.rotation)!=null?a:pC,scale:(o=w.scale)!=null?o:hC}}else if((y==null?void 0:y.type)==="path"){let v=y.components[0],w=y.components[2],E=y.components[1];return{id:y.id,type:"path",position:this.convert3DMapPositionToCoordinate(v.position),visible:E.visible,interactive:w!=null,completeFraction:v.completeFraction,color:E.color,accentColor:v.accentColor,nearRadius:v.nearRadius,farRadius:v.farRadius,animateArrowsOnPath:v.animateArrowsOnPath,displayArrowsOnPath:v.displayArrowsOnPath,nearZoomLevel:v.nearZoomLevel,farZoomLevel:v.farZoomLevel}}else if((y==null?void 0:y.type)==="image"){let v=y.components[0];return{id:y.id,type:"image",position:this.convert3DMapPositionToCoordinate(v.position),visible:y.components[1].visible,verticalOffset:(l=v.feature.properties.verticalOffset)!=null?l:0,flipImageToFaceCamera:y.components[1].flipImageToFaceCamera}}else if((y==null?void 0:y.type)==="text3d"&&y.components[0]instanceof lI&&"textArea"in y.components[0].feature.properties){l4e(y);let v=y.components[0],w=y.components[1],{textMesh:E}=v,M=(u=v.mesh)==null?void 0:u.parent;M instanceof Kn&&((c=M.children.find(P=>P.type==="batchedtext"))==null||c.getWorldPosition(b(this,BI))),b(this,q2).set(0,0,0);let I=E?E.getWorldPosition(b(this,q2)):b(this,q2);return Object.assign({},hw,w.getState(),{id:y.id,type:"text3d",position:this.convert3DMapPositionToCoordinate(I.add(b(this,BI))),visible:(p=v.visible)!=null?p:!1,content:(m=v.feature.properties.content)!=null?m:""})}else return}}setState(e,r){var i,n;if(typeof e=="object"&&r==null){"hoverColor"in e&&(b(this,Tt).hoverColor=(i=e.hoverColor)!=null?i:b(this,Tt).hoverColor),"text3dHoverColor"in e&&(b(this,Tt).text3dHoverColor=(n=e.text3dHoverColor)!=null?n:b(this,Tt).text3dHoverColor);return}let a=F1(b(this,Tt),e);if(a!=null){if(a.type==="custom-geometry"){let o=b(this,Tt).geometry3DMap.get(a.id);if(o instanceof Ua&&o.components[0]instanceof j6){let l=r;Cp(a,b(this,Tt),l.visible),uI(a,l.altitude),J8(a,l.position,this.convertTo3DMapPosition),Q8(a,this.getParentContainer(l.parent,!1))}}else if(a.type==="path"){let o=r;El(a,o.interactive,b(this,Tt))&&b(this,Ca).call(this),uI(a,o.altitude),s4e(a,b(this,Tt),o)}else if(a.type==="model"){let o=r;El(a,o.interactive,b(this,Tt))&&b(this,Ca).call(this),Cp(a,b(this,Tt),o.visible),h4e(a,o)}else if(a.type==="group-container"){let o=r;Cp(a,b(this,Tt),o.visible)&&(b(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0,b(this,Pt).pathSystem.altitudeDirty=!0),uI(a,o.altitude)&&(b(this,Pt).pathSystem.altitudeDirty=!0),El(a,o.interactive,b(this,Tt))&&b(this,Ca).call(this),tN(a,b(this,Tt),o.opacity)&&(b(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),o.preloadGeometry&&a.userData.preloadGeometry!==!0&&(a.userData.preloadGeometry=!0,b(this,Pt).outlineInterpolationSystem.geometries3DDirty=!0)}else if(a.type==="geometry-group"){let o=r;Cp(a,b(this,Tt),o.visible)&&(b(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),Z5e(a,b(this,Tt),o),jT(a,b(this,Tt),o.outline),o.height!=null&&K8(a,b(this,Tt),o.height),o.altitude!=null&&a.setAltitude(o.altitude),i4e(a,o),Y5e(a,o.shading),tN(a,b(this,Tt),o.opacity)&&(b(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),El(a,o.interactive,b(this,Tt))&&(b(this,Ca).call(this),b(this,As).call(this))}else if(a.type==="geometry"){if(a.components[0]instanceof ru){let o=r;Cp(a,b(this,Tt),o.visible)&&(b(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),jT(a,b(this,Tt),o.outline),K5e(a,o),rN(a,o.focusable)&&(b(this,Pt).geometryInFocusSystem.focusablesDirty=!0),o4e(a,o.renderOrder)&&(b(this,Pt).meshDetachmentSystem.dirty=!0),a4e(a,o.opacity)&&(b(this,Pt).meshDetachmentSystem.dirty=!0,b(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),eN(a,o.flipImageToFaceCamera),o.height!=null&&K8(a,b(this,Tt),o.height),n4e(a,o)&&(b(this,Pt).meshDetachmentSystem.dirty=!0),pj(a,o),t4e(a,o.hoverColor),El(a,o.interactive,b(this,Tt)),r4e(a,o.hovered)}b(this,Ca).call(this)}else if(a.type==="label"||a.type==="marker"){let o=r;e4e(a,r,b(this,Tt)),Q5e(a,r,b(this,Tt))&&(b(this,As).call(this),b(this,Pt).domMutationSystem.dirty=!0),J8(a,o.position,this.convertTo3DMapPosition),Q8(a,this.getParentContainer(o.parent,!1))&&(b(this,As).call(this),b(this,Pt).panBoundsSystem.dirty=!0),J5e(a,o.enabled),Cp(a,b(this,Tt),o.visible)}else if(a.type==="image"){let o=r;Cp(a,b(this,Tt),o.visible),eN(a,o.flipImageToFaceCamera)}else if(a.type==="text3d"){let o=r;c4e(a,b(this,Tt),o)}this.render()}}convertTo3DMapPosition(e,r,i=0,n){var a,o,l,u,c;if(Array.isArray(e))return this.convertTo3DMapPosition(e[1],e[0],(a=e[2])!=null?a:i,typeof r=="function"?r:void 0);if(typeof r!="number")throw new Error("convertTo3DMapPosition failed: longitude must be a number");let{x:p,y:m}=jB((l=(o=b(this,Tt).center)==null?void 0:o[1])!=null?l:0,(c=(u=b(this,Tt).center)==null?void 0:u[0])!=null?c:0,e,r);return n?(n.set(p,m,i),n):new qe(p,m,i)}get backgroundColor(){return typeof b(this,tl).backgroundColor=="string"?b(this,tl).backgroundColor:"#".concat(b(this,tl).backgroundColor.getHexString())}get backgroundAlpha(){return b(this,tl).backgroundAlpha}getThreeRenderer(){return b(this,tl)}getCenter(e){let r=Array.isArray(e)?e:this.getBoundingArea(e);return r?Ege(r):void 0}isInView(e){let r=F1(b(this,Tt),e);if(b(this,FI).identity().multiply(b(this,Mo).projectionMatrix).multiply(b(this,Mo).matrixWorldInverse),b(this,h1).setFromProjectionMatrix(b(this,FI)),r instanceof N_)return b(this,h1).containsPoint(r.position);if(r instanceof Ua){let i=r==null?void 0:r.components[0];if(i instanceof j6||i instanceof mI)return b(this,h1).containsPoint(this.convertTo3DMapPosition(i.feature.geometry.coordinates));if(i instanceof ru){let n=new ro(this.convertTo3DMapPosition(i.featureBbox[1],i.featureBbox[0],0),this.convertTo3DMapPosition(i.featureBbox[3],i.featureBbox[2],0));return b(this,h1).intersectsBox(n)}}return!1}getSystems(){return b(this,Pt)}getInternalState(){return b(this,Tt)}getTweenGroup(){return b(this,Tt).tweenGroup}};Go=new WeakMap,Mo=new WeakMap,u1=new WeakMap,TI=new WeakMap,j2=new WeakMap,ny=new WeakMap,c1=new WeakMap,$2=new WeakMap,Ph=new WeakSet,AN=s(function(t){var e;b(this,xy)!=="outdoors-overlay"&&((e=this.map)==null||e.setPixelRatio(t)),b(this,Tt).pixelRatio=this.resolutionScale},"#setResolutionScale"),Tt=new WeakMap,ma=new WeakMap,Ep=new WeakMap,Eo=new WeakMap,af=new WeakMap,tl=new WeakMap,Pt=new WeakMap,PI=new WeakMap,As=new WeakMap,Ca=new WeakMap,LLe=s(function(){He(this,ma,document.createElement("div")),b(this,ma).classList.add("mappedin__smart-collision-engine__container"),He(this,Ep,document.createElement("canvas")),b(this,Ep).classList.add("mappedin__smart-collision-engine-debug__container"),this.container.appendChild(b(this,ma)),He(this,Eo,document.createElement("canvas")),b(this,Eo).classList.add("mappedin__smart-collision-engine__container"),b(this,Eo).width=b(this,ma).clientWidth*this.resolutionScale,b(this,Eo).height=b(this,ma).clientHeight*this.resolutionScale,b(this,Eo).style.width=b(this,ma).clientWidth+"px",b(this,Eo).style.height=b(this,ma).clientHeight+"px",b(this,ma).appendChild(b(this,Ep)),b(this,ma).appendChild(b(this,Eo)),b(this,Ep).width=b(this,ma).clientWidth,b(this,Ep).height=b(this,ma).clientHeight,b(this,Eo).width=b(this,ma).clientWidth*this.resolutionScale,b(this,Eo).height=b(this,ma).clientHeight*this.resolutionScale,b(this,Eo).style.width=b(this,ma).clientWidth+"px",b(this,Eo).style.height=b(this,ma).clientHeight+"px"},"#renderEntity2DContainer"),DLe=s(function(){He(this,af,document.createElement("div")),b(this,af).classList.add("mappedin-2d-entities"),Object.assign(b(this,af).style,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",pointerEvents:"none","transform-style":"preserve-3d"}),this.container.appendChild(b(this,af))},"#renderEntityDOMContainer"),RLe=s(function(){b(this,Eo).width=b(this,ma).clientWidth*this.resolutionScale,b(this,Eo).height=b(this,ma).clientHeight*this.resolutionScale,b(this,Eo).style.width=b(this,ma).clientWidth+"px",b(this,Eo).style.height=b(this,ma).clientHeight+"px",b(this,Ep).width=b(this,ma).clientWidth,b(this,Ep).height=b(this,ma).clientHeight,b(this,Eo).width=b(this,ma).clientWidth*this.resolutionScale,b(this,Eo).height=b(this,ma).clientHeight*this.resolutionScale,b(this,Eo).style.width=b(this,ma).clientWidth+"px",b(this,Eo).style.height=b(this,ma).clientHeight+"px",b(this,Pt).collisionSystem.collidersDirty=!0},"#resizeCollisionCanvas"),xy=new WeakMap,LI=new WeakMap,DI=new WeakMap,RI=new WeakMap,G2=new WeakMap,SN=new WeakMap,OI=new WeakMap,kI=new WeakMap,NI=new WeakMap,H2=new WeakMap,MN=s(function(t,e,r,i){let n=new N_(e,this.convertTo3DMapPosition(t[1],t[0],t[2]||0),i);return n.occluderId=r??b(this,Pt).occlusion2DSystem.backgroundId,b(this,Tt).geometry2DMap.set(n.id,n),n},"#createEntity2D"),h1=new WeakMap,FI=new WeakMap,Mu=new WeakMap,Eu=new WeakMap,EN=s(async function(){return X5.load(cJe).then(t=>{var e;return b(this,Go)&&((e=b(this,Go).environment)==null||e.dispose(),t.mapping=B3,b(this,Go).environment=t,this.render()),t})},"#loadEnvMap"),q2=new WeakMap,BI=new WeakMap,s(OLe,"Core");var Htt=OLe,CN=Htt;N();function qtt(t,e){kLe(t,e)(t.getScene(),e),NLe(t,e),e.addFolder("Export").add({export:s(async()=>{let n=await t.getCurrentSceneGLTF({binary:!0}),a=new Blob([n],{type:"application/octet-stream"});var o=document.createElement("a");document.body.appendChild(o),o.style.display="none";let l=window.URL.createObjectURL(a);o.href=l,o.download="scene.glb",o.click(),window.URL.revokeObjectURL(l)},"export")},"export");let r=e.addFolder("Camera"),i={get bearing(){return t.camera.bearing},set bearing(n){t.camera.setBearing(n)},get pitch(){return t.camera.pitch},set pitch(n){t.camera.setPitch(n)},get zoomLevel(){return t.camera.zoomLevel},set zoomLevel(n){t.camera.setZoomLevel(n)}};r.add(i,"bearing",-359,359,1),r.add(i,"pitch",t.camera.minPitch,t.camera.maxPitch,1),r.add(i,"zoomLevel",t.camera.minZoomLevel,t.camera.maxZoomLevel,.1)}s(qtt,"mountSceneGraphVisualizer");function kLe(t,e){let r=e;return s(function i(n,a){let o=a.addFolder("".concat([n.type]," ").concat(n.id.slice(0,16)));if(a.close(),n.type==="geometry"||n.type==="model"||n.type==="path"||n.type==="image"){let l={get height(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"?u.height:0},set height(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(n,{height:u})},set flipImageToFaceCamera(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="image"&&t.setState(n,{flipImageToFaceCamera:u})},get flipImageToFaceCamera(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="image"?u.flipImageToFaceCamera:!1},set visible(u){let c=t.getState(n.id);((c==null?void 0:c.type)==="geometry"||(c==null?void 0:c.type)==="path"||(c==null?void 0:c.type)==="image")&&t.setState(n,{visible:u})},get visible(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="path"||(u==null?void 0:u.type)==="image"?u.visible:!1},set outline(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(n,{outline:u})},get outline(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"?u.outline:!1},get opacity(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"?u.opacity:1},set opacity(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(c,{opacity:u})},get color(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"&&u.color?ni(u.color).toHexString():"#ffffff"},set color(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(c,{color:u})},set interactive(u){let c=t.getState(n.id);((c==null?void 0:c.type)==="geometry"||(c==null?void 0:c.type)==="model"||(c==null?void 0:c.type)==="path")&&(t.setState(n,{interactive:u}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get interactive(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="model"||(u==null?void 0:u.type)==="path"?u.interactive:!1},get completeFraction(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="path"?u.completeFraction:1},set completeFraction(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="path"&&t.setState(c,{completeFraction:u})},focus:s(()=>{},"focus")};o.add(l,"focus").onChange(()=>{let u=t.getState(n.id);(u==null?void 0:u.type)==="model"||(u==null?void 0:u.type)==="path"||(u==null?void 0:u.type)==="image"?t.camera.focusOn([u.position]):(u==null?void 0:u.type)==="geometry"&&t.camera.focusOn(t.getBoundingArea(u))}),o.add(l,"visible"),n.type==="image"?o.add(l,"flipImageToFaceCamera"):(o.add(l,"interactive"),n.type==="path"&&o.add(l,"completeFraction",0,1,.1),n.type!=="model"&&(o.addColor(l,"color"),o.add(l,"outline"))),n.type==="geometry"&&(o.add(l,"height"),o.add(l,"opacity",0,1,.1))}else if(n.type==="marker"){let l={get interactive(){var u;let c=t.getState(n.id);return(c==null?void 0:c.type)==="marker"?(u=c.options)==null?void 0:u.interactive:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="marker"&&(t.setState(c,{options:{interactive:u}}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},focus:s(()=>{},"focus")};o.add(l,"focus").onChange(()=>{let u=t.getState(n.id);(u==null?void 0:u.type)==="marker"&&t.camera.focusOn([u.position])}),o.add(l,"interactive")}else if(n.type==="label"){let l={get interactive(){var u;let c=t.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=c.options)==null?void 0:u.interactive:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&(t.setState(c,{options:{interactive:u}}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get text(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="label"?u.text:""},set text(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(c,{text:u})},get"Text Color"(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=p.options.appearance)==null?void 0:u.text)==null?void 0:c.foregroundColor:"#000000"},set"Text Color"(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(n.id,{text:l.text,options:{appearance:{text:{foregroundColor:u}}}})},get"Text Size"(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=p.options.appearance)==null?void 0:u.text)==null?void 0:c.size:10},set"Text Size"(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(c,{text:l.text,options:{appearance:{text:{size:u}}}})},get"Icon Size"(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.iconSize:10},set"Icon Size"(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(c,{text:l.text,options:{appearance:{marker:{iconSize:u}}}})},get"Active Foreground Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor)==null?void 0:p.active:"#000000"},set"Active Foreground Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{foregroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.foregroundColor),{active:u})}}}})},get"Inactive Foreground Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor)==null?void 0:p.inactive:"#000000"},set"Inactive Foreground Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{foregroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.foregroundColor),{inactive:u})}}}})},get"Active Background Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor)==null?void 0:p.active:"#000000"},set"Active Background Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{backgroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.backgroundColor),{active:u})}}}})},get"Inactive Background Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor)==null?void 0:p.inactive:"#000000"},set"Inactive Background Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{backgroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.backgroundColor),{inactive:u})}}}})},focus:s(()=>{},"focus")};o.add(l,"focus").onChange(()=>{let u=t.getState(n.id);(u==null?void 0:u.type)==="label"&&t.camera.focusOn([u.position])}),o.add(l,"interactive"),o.add(l,"text"),o.add(l,"Text Size",10,50),o.add(l,"Icon Size",10,50),o.addColor(l,"Text Color"),o.addColor(l,"Active Background Color"),o.addColor(l,"Inactive Background Color"),o.addColor(l,"Active Foreground Color"),o.addColor(l,"Inactive Foreground Color")}else if(n.type==="geometry-group"){let l={get opacity(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.opacity:1},set opacity(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(n,{opacity:u})},set visible(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(n,{visible:u})},get visible(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.visible:!1},set outline(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(n,{outline:u})},get outline(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.outline:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&(t.setState(n,{interactive:u}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get interactive(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.interactive:!1},get shadingStart(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="geometry-group"&&(c=(u=p.shading)==null?void 0:u.start)!=null?c:0},set shadingStart(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(c,{shading:{start:u}})},get shadingEnd(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="geometry-group"&&(c=(u=p.shading)==null?void 0:u.end)!=null?c:0},set shadingEnd(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(c,{shading:{end:u}})},get shadingIntensity(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="geometry-group"&&(c=(u=p.shading)==null?void 0:u.intensity)!=null?c:0},set shadingIntensity(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(c,{shading:{intensity:u}})}};o.add(l,"visible"),o.add(l,"opacity",0,1,.1),o.add(l,"interactive"),o.add(l,"outline"),o.add(l,"shadingStart",0,1,.1),o.add(l,"shadingEnd",0,1,.1),o.add(l,"shadingIntensity",0,1,.1)}else if(n.type==="group-container"){let l={set visible(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="group-container"&&t.setState(n,{visible:u})},get visible(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="group-container"?u.visible:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="group-container"&&(t.setState(c,{interactive:u}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get interactive(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="group-container"?u.interactive:!1}};o.add(l,"visible"),o.add(l,"interactive")}if(o.close(),n.children)for(let l of n.children.values())i(l,o)},"parseChild")}s(kLe,"createParseChild");function NLe(t,e){let r=e.addFolder("Watermark"),i={padding:16,iconOnly:!1,position:"bottom-left",color:"dark",scale:1};r.add(i,"padding",0,100,1),r.add(i,"scale",.5,1.5,.1),r.add(i,"color",["dark","light"]),r.add(i,"position",["top-left","top-right","bottom-left","bottom-right","center","top","bottom","left","right"]),r.add(i,"iconOnly"),r.onChange(()=>{t.updateWatermark(i)})}s(NLe,"createWatermarkChild");var IX="https://tiles-cdn.mappedin.com/styles/mappedin/style.json",Wtt="https://auth.mappedin.com/oauth2/token";async function FLe(t,e){var r,i,n,a,o,l;if((r=e==null?void 0:e.outdoorView)!=null&&r.enabled){let{Map:u,MercatorCoordinate:c}=await ag(()=>import("./outdoor-context-v4-ME4STCCK-C-iYkjFk.js"),[]),p=e.outdoorView.headers;p==null&&(p=await Age(Wtt));let m=e.center||[0,0],y=new u({container:t,style:e.outdoorView.style||IX,center:m,attributionControl:!1,zoom:(i=e.zoomLevel)!=null?i:PLe,pitch:(n=e.pitch)!=null?n:ILe,bearing:(a=e.bearing)!=null?a:TLe,transformRequest:CHe(p),trackResize:!1,pixelRatio:e.outdoorView.lowDpi?1:cw(),antialias:typeof e.antialias=="boolean"?e.antialias:!0,boxZoom:!1,doubleClickZoom:!1,scrollZoom:!1,dragPan:!1,dragRotate:!1,keyboard:!1,touchZoomRotate:!1}),v=y.painter.context.gl,w=new CN(t,{center:m,zoomLevel:y.getZoom(),pitch:y.getPitch(),bearing:y.getBearing(),gl:v,map:y,mode:"outdoors-interleaved",watermark:e.watermark,attribution:e.attribution,antialias:e.antialias,occlusionEnabled:e.occlusionEnabled,transformImageRequest:e.transformImageRequest,naturalBearing:(o=e.naturalBearing)!=null?o:0,imagePlacementOptions:e.imagePlacementOptions,onWebGLContextCreationError:e.onWebGLContextCreationError,onWebGLContextLost:e.onWebGLContextLost,onWebGLContextRestored:e.onWebGLContextRestored,onWebGLRendererError:e.onWebGLRendererError,useStandaloneCamera:(l=e.useStandaloneCamera)!=null?l:!1}),E={center:y.getCenter().toArray(),zoom:y.getZoom(),bearing:y.getBearing(),pitch:y.getPitch()};y.setMinZoom(w.camera.minZoomLevel),y.setMaxZoom(w.camera.maxZoomLevel),w.on("camera-change",O=>{E.center=O.center,E.zoom=O.zoomLevel,E.bearing=O.bearing,E.pitch=O.pitch,y.jumpTo(E)});let M=c.fromLngLat(m,0),I=GB(M,w.viewCamera,w.camera,()=>{w.renderSync()});y.on("style.load",async()=>{y&&(y.addLayer(I),w.renderSync())});let P=!1,C=!1;y.on("idle",()=>{y&&(P||(w.publish("outdoor-view-loaded"),P=!0),C||(C=!0,w.publish("outdoor-style-loaded")))});let T=s(O=>{O&&(O.sourceDataType==="metadata"||O.sourceDataType==="visibility"||O.dataType==="style"||O.type==="terrain")&&w.getSystems().htmlControlsSystem.updateData(y)},"updateData");return y.on("styledata",O=>{y&&O&&O.dataType==="style"&&O.type==="styledata"&&(C=!1),T(O)}),y.on("sourcedata",T),y.on("terrain",T),y.on("error",O=>{var F;if(((F=O.error)==null?void 0:F.url)===IX){Vt.error('Failed to load outdoor view style, possibly due to invalid token "'.concat(p["x-mappedin-tiles-key"],'"'));return}Vt.warn(O)}),w}else return new CN(t,e)}s(FLe,"createRenderer");N();N();N();var BLe=(t=>(t.Exterior="exterior-walls",t.Interior="interior-walls",t))(BLe||{}),zLe=(t=>(t.Interior="interior-doors",t.Exterior="exterior-doors",t))(zLe||{});N();N();var IN=class TN{constructor(e,r,i){$(this,"id"),$(this,"text"),$(this,"target"),$(this,"__type",TN.__type),this.id=e,this.text=r,this.target=i}static is(e){return e.__type===TN.__type}get focusTarget(){return this.target.anchorTarget}};s(IN,"Label"),$(IN,"__type","Label");var PN=IN;N();var p1,LN=class DN{constructor(e,r,i){$(this,"id"),Be(this,p1),$(this,"__type",DN.__type),$(this,"contentEl"),this.id=e,this.contentEl=r,He(this,p1,i)}get target(){return b(this,p1)}get coordinate(){return b(this,p1).anchorTarget}static is(e){return e.__type===DN.__type}get focusTarget(){return this.target.anchorTarget}updateTarget(e){He(this,p1,e)}};p1=new WeakMap,s(LN,"Marker"),$(LN,"__type","Marker");var wj=LN;N();var zI,UI,RN=class ON{constructor(e,r,i){Be(this,zI),Be(this,UI),$(this,"target"),$(this,"__type",ON.__type),He(this,zI,e),He(this,UI,r),this.target=i}static is(e){return e.__type===ON.__type}get id(){return b(this,zI)}get url(){return b(this,UI)}};zI=new WeakMap,UI=new WeakMap,s(RN,"Image"),$(RN,"__type","Image");var Xtt=RN;N();var W2,kN=class NN{constructor(e,r,i){$(this,"id"),$(this,"groupId"),$(this,"__type",NN.__type),Be(this,W2),this.id=e,this.groupId=r,He(this,W2,i)}get target(){return b(this,W2)}static is(e){return e.__type===NN.__type}updateTarget(e){He(this,W2,e)}};W2=new WeakMap,s(kN,"Model"),$(kN,"__type","Model");var ULe=kN;N();var FN=class BN{constructor(e,r){$(this,"id"),$(this,"coordinates"),$(this,"__type",BN.__type),this.id=e,this.coordinates=r}static is(e){return e.__type===BN.__type}get focusTarget(){return this.coordinates}};s(FN,"PathSegment"),$(FN,"__type","PathSegment");var VLe=FN,zN=class UN{constructor(e,r,i,n){$(this,"id"),$(this,"animation"),$(this,"coordinates"),$(this,"segments"),$(this,"__type",UN.__type),this.id=e,this.animation=r,this.coordinates=i,this.segments=n.map(({id:a,coordinates:o})=>new VLe(a.toString(),o))}static is(e){return e.__type===UN.__type}get focusTarget(){return this.coordinates}};s(zN,"Path"),$(zN,"__type","Path");var dA=zN;N();var ay,jLe=class{constructor(e){Be(this,ay),He(this,ay,e)}get center(){return b(this,ay).center}get bearing(){return b(this,ay).bearing}get pitch(){return b(this,ay).pitch}get zoomLevel(){return b(this,ay).zoomLevel}};ay=new WeakMap,s(jLe,"CameraTransform");var Ztt=jLe;N();var VN=class jN{constructor(e){$(this,"id"),$(this,"__type",jN.__type),this.id=e}static is(e){return e.__type===jN.__type}get focusTarget(){return this}};s(VN,"Shape"),$(VN,"__type","Shape");var $N=VN;N();var GN=class $Le{constructor(e,r){$(this,"id"),$(this,"target"),$(this,"__type","Text3D"),this.id=e,this.target=r}static is(e){return e.__type===$Le.__type}};s(GN,"Text3D"),$(GN,"__type","Text3D");var HN=GN;N();N();N();var Ytt=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				// Do not change these to fillRule or clipRule, since they need to be rendered as actual SVGs in labels, not React SVGs
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),Ktt=/<svg([^>]*)>/g;function GLe(t,e,r){let i=Ytt.get(t);return i?i.replace(Ktt,'<svg$1 style="fill:'.concat(e,"; width:").concat(r,"px; height:").concat(r,'px">')):""}s(GLe,"getStyledIcon");var Jtt=s(t=>`
		<div class="pin-shadow" style="background: `.concat(t,`"></div>
		<svg width="`).concat(20*.9,'px" height="').concat(48*.9,`px" viewBox="0 0 20 48">
			<path
				d="M1.37965 29.3246C1.5778 31.2167 2.27661 33.0694 3.83078 33.775C4.0998 37.1861 4.7451 40.2227 5.65918 42.4784C6.14556 43.6787 6.72883 44.71 7.41453 45.4578C8.10027 46.2056 8.97065 46.7527 9.99989 46.7527C11.0292 46.7527 11.8995 46.2055 12.585 45.4576C13.2706 44.7098 13.8536 43.6785 14.3398 42.4783C15.2536 40.2226 15.8988 37.186 16.1688 33.7752C17.7232 33.0697 18.422 31.2169 18.6201 29.3247C18.8386 27.2385 18.5165 24.6502 17.6475 22.0285L17.6473 22.0278C16.9657 19.9761 16.0319 18.1622 14.9848 16.7474C17.0884 15.1587 18.4471 12.5964 18.4471 9.7152C18.4471 4.93539 14.6967 1 9.99966 1C5.30272 1 1.54993 4.93527 1.54993 9.7152C1.54993 12.5961 2.90839 15.1583 5.01167 16.747C3.9635 18.1625 3.03185 19.977 2.3522 22.0286C1.48319 24.6503 1.16118 27.2385 1.37965 29.3246Z"
				fill="`).concat(t,`"
				stroke="white"
				strokeWidth="2"
			/>
		</svg>
	`),"getDeparturePin"),Qtt=s(t=>`
		<div class="pin-shadow" style="background: `.concat(t,`"></div>
		<svg width="36" height="42" viewBox="-2 -2 40 46">
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="none"
				stroke="white"
				strokeWidth="4"
			/>
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="`).concat(t,`"
			/>
		</svg>
    `),"getDestinationPin"),HLe="#722ED1",qLe="#1890FF",ert=s(({type:t="departure",color:e=qLe})=>`<div class="dropped-pin-wrapper">
			`.concat(t==="departure"?Jtt(e):Qtt(e),`
		</div>`),"DroppedPin"),trt=s(t=>{switch(t){case"default":return 28;case"selection":return 28;case"navigation":return 32}},"getSize"),rrt=s(({type:t="stairs",color:e=HLe,direction:r="up"})=>{let i=trt("default"),n=i/2+2,a=r&&r!=="none";return`<div class="mappedin-connection-marker">
			<div class="connection-circle"
				role="button"
                style="background:`.concat(e,"; width:").concat(i,"px; height:").concat(i,`px;"
			>
                `).concat(GLe("connection-"+t+"-16x16","white",n)||"",`
			</div>
			`).concat(a?'<div style="margin-left: -'.concat(i*.2,`px;">
					<div class="bouncey">
						<div class="connection-circle"
							role="button"
							style="width: `).concat(i,"px; height: ").concat(i,`px;">
							<div class="`).concat(r==="up"?"":"arrow--down",`">
                                <svg viewBox="0 0 16 16" style="fill: white; width: `).concat(n,"px; height: ").concat(n,`px">
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
                                        stroke="none"
                                    />
                                </svg>
							</div>
						</div>
					</div>
				</div>`):"",`
		</div>`)},"ConnectionMarker");N();var irt=s(async t=>new Promise(e=>setTimeout(e,t)),"ms"),nrt={drawDuration:1e3,color:"#40A9FF",interactive:!1,accentColor:"blue",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1,animateArrowsOnPath:!1},art={drawDuration:1e3,color:"#B3DDFF",interactive:!1,accentColor:"#40A9FF",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1,animateArrowsOnPath:!1},wm={setMapOnConnectionClick:!0,setMapToDeparture:!0,createMarkers:{departure:!0,destination:!0,connection:!0},pathOptions:nrt,inactivePathOptions:art,markerOptions:{departureColor:qLe,destinationColor:HLe},animatePathDrawing:!0},Fm,zp,km,wn,VI,Bm,d1,Ss,Rp,cc,Op,by,Il,TX,WLe,qN,jI,q1,WN,fw,XLe=class{constructor(e,r,i){Be(this,Il),Be(this,Fm,new Map),Be(this,zp),Be(this,km),Be(this,wn,wm),Be(this,VI),Be(this,Bm),Be(this,d1),Be(this,Ss,[]),Be(this,Rp),Be(this,cc,new Map),Be(this,Op,new Map),Be(this,by,new Map),Be(this,fw,s(n=>{var a;if((a=b(this,wn).createMarkers)!=null&&a.connection&&n.markers.length>0){let{instruction:o}=b(this,Fm).get(n.markers[0]);o!=null&&o.action.toFloor&&(b(this,wn).setMapOnConnectionClick&&this.currentMap.setFloor(o.action.toFloor.id,"navigation-connection-click"),this.currentMap.publish("navigation-connection-click",{instruction:o,fromFloor:o.action.fromFloor,toFloor:o.action.toFloor}))}},"#handleClick")),He(this,zp,e),He(this,VI,i),He(this,km,r)}get currentMap(){return b(this,VI).call(this)}get isMultiFloor(){if(!b(this,Ss).length)return!1;let e=new Set;for(let r of b(this,Ss))for(let i of r.coordinates)if(i.floorId&&(e.add(i.floorId),e.size>1))return!0;return!1}getPathById(e){return b(this,cc).get(e)}getMarkerById(e){return b(this,Fm).get(e)}get paths(){let e=new Set;return b(this,cc).forEach(({path:r})=>e.add(r)),Array.from(e)}get activeDirections(){return b(this,by).get(b(this,Rp))}get activePath(){var e;if(b(this,Rp))return(e=b(this,cc).get(b(this,Rp).id))==null?void 0:e.path}get floorStacks(){let e=b(this,km).getMapData();if(!b(this,Ss).length||!e)return[];let r=new Set;for(let i of b(this,Ss))for(let n of i.coordinates)if(n.floorId){let a=e.getById("floor",n.floorId);a&&r.add(a.floorStack)}return Array.from(r)}get floors(){let e=b(this,km).getMapData();if(!b(this,Ss).length||!e)return[];let r=new Set;for(let i of b(this,Ss))for(let n of i.coordinates)if(n.floorId){let a=e.getById("floor",n.floorId);a&&r.add(a)}return Array.from(r)}setActivePathByIndex(e){let r=b(this,Ss)[e];if(!b(this,Ss).length){Vt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!b(this,Ss)[e]){Vt.warn("Direction #".concat(e," does not exist"));return}let i=b(this,Op).get(r);if(!i){Vt.warn("The direction is not a part of muli-direcional path");return}dr(this,Il,jI).call(this,i)}setActivePath(e){if(!b(this,Ss).length){Vt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!b(this,by).get(e)){Vt.warn('Path "'.concat(e.id,'" is not a part of muli-direcional path'));return}dr(this,Il,jI).call(this,e)}setActivePathByDirections(e){if(!b(this,Ss).length){Vt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}let r=b(this,Op).get(e);if(!r){Vt.warn("The direction is not a part of muli-direcional path");return}dr(this,Il,jI).call(this,r)}drawSync(e,r={}){var i,n,a;b(this,d1)&&this.clear(),He(this,d1,!0),dr(this,Il,qN).call(this,r);let o=Array.isArray(e)?e:[e],l=o[0],u=o[o.length-1],c=l.coordinates[0];He(this,Ss,o),c.floorId&&b(this,wn).setMapToDeparture&&this.currentMap.setFloor(c.floorId),(i=b(this,wn).createMarkers)!=null&&i.departure&&dr(this,Il,q1).call(this,l.coordinates[0],"departure",l.instructions[0]);for(let p=0;p<o.length;p++){let m=o[p],y=p?Ee({},b(this,wn).inactivePathOptions):Ee({},b(this,wn).pathOptions);if(m.coordinates.length<2){Vt.warn("Directions must have at least 2 coordinates");return}let v=this.currentMap.Paths.add(m.coordinates,vt(Ee({},y),{animateDrawing:b(this,wn).animatePathDrawing})),w=v.paths.map(M=>M.id.toString()),E=new dA(ya(),v.animation,m.coordinates,v.paths);for(let M of w){b(this,cc).set(M,{path:E,entityIds:w});let I=p?vt(Ee({},b(this,wn).inactivePathOptions),{altitude:0}):vt(Ee({},b(this,wn).pathOptions),{altitude:.05});b(this,zp).setState(M,I)}b(this,cc).set(E.id,{path:E,entityIds:w}),b(this,Op).set(m,E),b(this,by).set(E,m),(n=b(this,wn).createMarkers)!=null&&n.connection&&dr(this,Il,WN).call(this,m.instructions,"connection"),p===0&&(He(this,Rp,b(this,Op).get(b(this,Ss)[0])),b(this,zp).on("click",b(this,fw)))}(a=b(this,wn).createMarkers)!=null&&a.destination&&dr(this,Il,q1).call(this,u.coordinates[u.coordinates.length-1],"destination",u.instructions[u.instructions.length-1]),b(this,km).mapObjects.forEach(p=>{p.processFloorChange(p.currentFloorId)})}async draw(e,r={}){b(this,Bm)&&this.clear(),dr(this,Il,qN).call(this,r);let i=Array.isArray(e)?e:[e],n=i[0].coordinates[0];return He(this,Ss,i),n.floorId&&b(this,wn).setMapToDeparture&&this.currentMap.setFloor(n.floorId),dr(this,Il,WLe).call(this,i)}clear(){b(this,Fm).forEach((e,r)=>{this.currentMap.Markers.remove(r.toString())}),b(this,Fm).clear(),b(this,cc).forEach(({path:e,entityIds:r})=>{b(this,cc).delete(e.id),r.forEach(i=>b(this,cc).delete(i)),this.currentMap.Paths.remove(r)}),b(this,Bm)&&(b(this,Bm).cancel(),He(this,Bm,void 0)),b(this,d1)&&He(this,d1,!1),He(this,Ss,[]),b(this,Op).clear(),b(this,by).clear(),He(this,Rp,void 0),b(this,zp).off("click",b(this,fw)),b(this,km).mapObjects.forEach(e=>{e.processFloorChange(e.currentFloorId)})}};Fm=new WeakMap,zp=new WeakMap,km=new WeakMap,wn=new WeakMap,VI=new WeakMap,Bm=new WeakMap,d1=new WeakMap,Ss=new WeakMap,Rp=new WeakMap,cc=new WeakMap,Op=new WeakMap,by=new WeakMap,Il=new WeakSet,TX=s(function(t){return t!=null&&["TakeConnection","ExitConnection","TakeVortex","ExitVortex"].includes(t.type)},"#isVortexAction"),WLe=s(function(t){let e=t[0],r=t[t.length-1],i=!1;return He(this,Bm,{promise:new Promise(async n=>{var a,o,l;if($a.env.NODE_ENV!=="test"&&await irt(500),i||!t.length){n();return}(a=b(this,wn).createMarkers)!=null&&a.departure&&dr(this,Il,q1).call(this,e.coordinates[0],"departure",e.instructions[0]);for(let u=0;u<t.length;u++){let c=t[u],p=u?Ee({},b(this,wn).inactivePathOptions):Ee({},b(this,wn).pathOptions);if(c.coordinates.length<2){Vt.warn("Directions must have at least 2 coordinates"),n();return}let m=this.currentMap.Paths.add(c.coordinates,vt(Ee({},p),{animateDrawing:b(this,wn).animatePathDrawing})),y=m.paths.map(w=>w.id.toString()),v=new dA(ya(),m.animation,c.coordinates,m.paths);for(let w of y){b(this,cc).set(w,{path:v,entityIds:y});let E=u?vt(Ee({},b(this,wn).inactivePathOptions),{altitude:0}):vt(Ee({},b(this,wn).pathOptions),{altitude:.05});b(this,zp).setState(w,E)}if(b(this,cc).set(v.id,{path:v,entityIds:y}),b(this,Op).set(c,v),b(this,by).set(v,c),$a.env.NODE_ENV!=="test"&&await m.animation,i){n();return}(o=b(this,wn).createMarkers)!=null&&o.connection&&dr(this,Il,WN).call(this,c.instructions,"connection"),u===0&&(He(this,Rp,b(this,Op).get(b(this,Ss)[0])),b(this,zp).on("click",b(this,fw)))}if((l=b(this,wn).createMarkers)!=null&&l.destination&&dr(this,Il,q1).call(this,r.coordinates[r.coordinates.length-1],"destination",r.instructions[r.instructions.length-1]),i){n();return}b(this,km).mapObjects.forEach(u=>{u.processFloorChange(u.currentFloorId)}),n()}),cancel:s(()=>{i=!0},"cancel")}),b(this,Bm).promise},"#drawAsync"),qN=s(function(t){var e,r,i;He(this,wn,{setMapOnConnectionClick:(e=t.setMapOnConnectionClick)!=null?e:wm.setMapOnConnectionClick,setMapToDeparture:(r=t.setMapToDeparture)!=null?r:wm.setMapToDeparture,pathOptions:Ee(Ee({},wm.pathOptions),t.pathOptions),inactivePathOptions:Ee(Ee({},wm.inactivePathOptions),t.inactivePathOptions),createMarkers:Ee(Ee({},wm.createMarkers),t.createMarkers),markerOptions:Ee(Ee({},wm.markerOptions),t.markerOptions),animatePathDrawing:(i=t.animatePathDrawing)!=null?i:wm.animatePathDrawing})},"#setupOptions"),jI=s(function(t){He(this,Rp,t),b(this,Ss).forEach(e=>{let r=b(this,Op).get(e);if(r){let i=b(this,cc).get(r.id),n=i.path.id===b(this,Rp).id?vt(Ee({},b(this,wn).pathOptions),{altitude:.05}):vt(Ee({},b(this,wn).inactivePathOptions),{altitude:0});i.entityIds.forEach(a=>{b(this,zp).setState(a,n)})}}),this.currentMap.publish("navigation-active-path-change",{directions:this.activeDirections,path:this.activePath})},"#setActiveDirections"),q1=s(function(t,e,r){var i,n,a,o,l;if(e==="connection"&&r){let u=r.action.type==="ExitConnection"?b(this,wn).markerOptions.departureColor:b(this,wn).markerOptions.destinationColor,c;if(typeof((i=b(this,wn).createMarkers)==null?void 0:i.connection)=="function"){let m=b(this,wn).createMarkers.connection(r);b(this,zp).setState(m.id.toString(),{options:{interactive:!0}}),c={id:m.id,type:"marker"}}else c=this.currentMap.Markers.add(r.coordinate,rrt({type:(a=(n=r.action.connection)==null?void 0:n.type)!=null?a:r.action.connectionType,color:u,direction:r.action.direction}),{interactive:!0,anchor:"top",rank:"always-visible"});let p=this.currentMap.Markers.getContentEl(c.id.toString());if(!p)throw new Error("marker component should exist");b(this,Fm).set(c.id,{instruction:r,marker:new wj(c.id.toString(),p,r.coordinate)})}else{let u=e==="departure"?b(this,wn).markerOptions.departureColor:b(this,wn).markerOptions.destinationColor,c;typeof((o=b(this,wn).createMarkers)==null?void 0:o.departure)=="function"&&e==="departure"?c={id:b(this,wn).createMarkers.departure(r).id,type:"marker"}:typeof((l=b(this,wn).createMarkers)==null?void 0:l.destination)=="function"&&e==="destination"?c={id:b(this,wn).createMarkers.destination(r).id,type:"marker"}:c=this.currentMap.Markers.add(t,ert({type:e,color:u}),{anchor:"top",rank:"always-visible"}),b(this,Fm).set(c.id,void 0)}},"#addMarker"),WN=s(function(t,e){t.filter(r=>dr(this,Il,TX).call(this,r.action)).forEach(r=>{dr(this,Il,q1).call(this,r.coordinate,e,r)})},"#addMarkers"),fw=new WeakMap,s(XLe,"Navigation");var ort=XLe;N();N();N();var srt=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),lrt=/<svg([^>]*)>/g;function ZLe(t,e,r){let i=srt.get(t);return i?i.replace(lrt,'<svg$1 xmlns="http://www.w3.org/2000/svg" style="fill:'.concat(e,"; width:").concat(r,"px; height:").concat(r,'px">')):""}s(ZLe,"getStyledIcon");var f1,X2,tf,XN,PX,LX,G6,DX,YLe=class{constructor(e,r){Be(this,tf),Be(this,f1),Be(this,X2),$(this,"colors",{default:"#3D5676",connection:"#128387",washroom:"#3161B4",point:"#AD468F"}),He(this,f1,e),He(this,X2,r)}auto(){let e=[],r=b(this,X2)[Object.keys(b(this,X2))[0]];return[...r.getByType("connection"),...r.getByType("point-of-interest"),...r.getByType("space")].forEach(i=>{if(i.__type==="connection")i.coordinates.forEach(n=>{let a=i.name||i.externalId;if(a){let o=b(this,f1).Labels.add(n,a,dr(this,tf,XN).call(this,i));e.push(o)}});else{i.__type==="space"&&i.name!==""&&b(this,f1).updateState(i,{interactive:!0,hoverColor:"#F0F0F0"});let n=i.name;if(n){let a=b(this,f1).Labels.add(i,n,dr(this,tf,XN).call(this,i));e.push(a)}}}),{labels:e}}};f1=new WeakMap,X2=new WeakMap,tf=new WeakSet,XN=s(function(t){let e=ZLe(dr(this,tf,PX).call(this,t),"white",12);return{appearance:{text:{foregroundColor:dr(this,tf,G6).call(this,t)},marker:{foregroundColor:{active:dr(this,tf,G6).call(this,t)},icon:e,iconSize:12}},interactive:!0,rank:dr(this,tf,DX).call(this,t)}},"#generatLabelAppearance"),PX=s(function(t){return t.__type==="connection"?dr(this,tf,LX).call(this,t.type):t.name.includes("Washroom")?"washroom-14x14":t.__type==="point-of-interest"?"point-of-interest-12x12":""},"#getIconName"),LX=s(function(t){let e="";switch(t){case"elevator":e="connection-elevator-12x12";break;case"escalator":e="connection-escalator-12x12";break;case"stairs":e="connection-stairs-12x12";break}return e},"#attemptIconNameForConnection"),G6=s(function(t){return t.__type==="connection"?this.colors.connection:t.__type==="point-of-interest"?this.colors.point:"name"in t&&t.name.includes("Washroom")?this.colors.washroom:this.colors.default},"#getLabelColor"),DX=s(function(t){return t.__type==="connection"?"high":(t.__type,"medium")},"#getDefaultLabelRank"),s(YLe,"Labels");var urt=YLe,KLe=class{constructor(e,r){$(this,"Labels"),$(this,"auto",s(()=>this.Labels.auto(),"auto")),this.Labels=new urt(e,r)}};s(KLe,"DefaultTheme");var crt=KLe;N();var Ti,HT,Py,AE,ZN,JLe=class{constructor(e){Be(this,Py),Be(this,Ti),Be(this,HT),$(this,"interactions",{set:s(r=>{(r==null?void 0:r.pan)!=null&&(b(this,Ti).getSystems().cameraSystem.enablePan=r.pan),(r==null?void 0:r.zoom)!=null&&(b(this,Ti).getSystems().cameraSystem.enableZoom=r.zoom),(r==null?void 0:r.bearingAndPitch)!=null&&(b(this,Ti).getSystems().cameraSystem.enableRotate=r.bearingAndPitch)},"set"),enable:s(()=>{b(this,Ti).getSystems().cameraSystem.enablePan=!0,b(this,Ti).getSystems().cameraSystem.enableZoom=!0,b(this,Ti).getSystems().cameraSystem.enableRotate=!0},"enable"),disable:s(()=>{b(this,Ti).getSystems().cameraSystem.enablePan=!1,b(this,Ti).getSystems().cameraSystem.enableZoom=!1,b(this,Ti).getSystems().cameraSystem.enableRotate=!1},"disable")}),$(this,"setMinPitch",s(r=>{b(this,Ti).camera.setMinPitch(r)},"setMinPitch")),$(this,"setMaxPitch",s(r=>{b(this,Ti).camera.setMaxPitch(r)},"setMaxPitch")),$(this,"setMinZoomLevel",s(r=>{b(this,Ti).camera.setMinZoomLevel(r,!0)},"setMinZoomLevel")),$(this,"setMaxZoomLevel",s(r=>{b(this,Ti).camera.setMaxZoomLevel(r)},"setMaxZoomLevel")),He(this,HT,e),He(this,Ti,e.core)}setScreenOffsets(e){b(this,Ti).camera.setInsetPadding(e)}get screenOffsets(){return b(this,Ti).camera.insetsPadding}get panMode(){return b(this,Ti).camera.panMode}setPanMode(e){if(e!=="default"&&e!=="elevation")throw new Error("Invalid pan mode");e!==this.panMode&&b(this,Ti).camera.setPanMode(e)}getFocusOnTransform(e,r){var i;let n=b(this,Ti).camera.getCameraFrameForCoordinates(dr(this,Py,ZN).call(this,e),{pitch:r==null?void 0:r.pitch,bearing:r==null?void 0:r.bearing,padding:(r==null?void 0:r.screenOffsets)||this.screenOffsets,maxZoomLevel:r==null?void 0:r.maxZoomLevel,verticalPadding:(i=r==null?void 0:r.axisAlignedPadding)==null?void 0:i.vertical,minZoomLevel:r==null?void 0:r.minZoomLevel,duration:r==null?void 0:r.duration,easing:r==null?void 0:r.easing});return{center:new On(n.center[1],n.center[0]),zoomLevel:n.zoomLevel}}focusOn(e,r){var i;return b(this,Ti).camera.focusOn(dr(this,Py,ZN).call(this,e),{pitch:r==null?void 0:r.pitch,bearing:r==null?void 0:r.bearing,padding:(r==null?void 0:r.screenOffsets)||this.screenOffsets,maxZoomLevel:r==null?void 0:r.maxZoomLevel,minZoomLevel:r==null?void 0:r.minZoomLevel,duration:r==null?void 0:r.duration,verticalPadding:(i=r==null?void 0:r.axisAlignedPadding)==null?void 0:i.vertical,easing:r==null?void 0:r.easing})}animateTo(e,r){var i;let{center:n,zoomLevel:a,bearing:o,pitch:l}=e,u=n??this.center;return b(this,Ti).camera.animateTo({center:n!=null?[u.longitude,u.latitude,b(this,Ti).camera.elevation]:void 0,zoomLevel:a,bearing:o,pitch:l,duration:(i=r==null?void 0:r.duration)!=null?i:600,easing:r==null?void 0:r.easing})}set(e){let{center:r=this.center,zoomLevel:i=this.zoomLevel,bearing:n=this.bearing,pitch:a=this.pitch}=e,o=[r.longitude,r.latitude];b(this,Ti).camera.setCenter(o),b(this,Ti).camera.setZoomLevel(i),b(this,Ti).camera.setBearing(n),b(this,Ti).camera.setPitch(a)}get center(){let e=b(this,Ti).camera.center;return new On(e[1],e[0],void 0)}setAutoMinZoomLevel(e){b(this,Ti).camera.setAutoMinZoomLevel(e)}get autoMinZoomLevel(){return b(this,Ti).camera.autoMinZoomLevel}get zoomLevel(){return b(this,Ti).camera.zoomLevel}get pitch(){return b(this,Ti).camera.pitch}get minPitch(){return b(this,Ti).camera.minPitch}get maxPitch(){return b(this,Ti).camera.maxPitch}get bearing(){let e=b(this,Ti).camera.bearing;return(e<0?e+360:e)%360}get minZoomLevel(){return b(this,Ti).camera.minZoomLevel}get maxZoomLevel(){return b(this,Ti).camera.maxZoomLevel}setElevation(e){b(this,Ti).camera.setElevation(e)}get elevation(){return b(this,Ti).camera.elevation}animateElevation(e,r){return b(this,Ti).camera.animateElevation(e,r)}updateFacadesInView(){b(this,Ti).getSystems().geometryInFocusSystem.raycast()}};Ti=new WeakMap,HT=new WeakMap,Py=new WeakSet,AE=s(function(t){var e,r,i,n,a,o;let l=b(this,Ti).camera.elevation;return On.is(t)&&t.floorId!=null?(r=(e=b(this,Ti).getState(t.floorId))==null?void 0:e.altitude)!=null?r:l:jp.is(t)?(n=(i=b(this,Ti).getState(t.id))==null?void 0:i.altitude)!=null?n:l:"floor"in t&&jp.is(t.floor)&&(o=(a=b(this,Ti).getState(t.floor.id))==null?void 0:a.altitude)!=null?o:l},"#getFloorAltitude"),ZN=s(function(t){var e;let r=[],i=(Array.isArray(t)?t:[t]).flatMap(n=>{var a;return(a=n==null?void 0:n.focusTarget)!=null?a:[n]});for(let n of i)if(n!=null)if(On.is(n)){let a=dr(this,Py,AE).call(this,n);r.push([n.longitude,n.latitude,a])}else if((n==null?void 0:n.id)!=null){let a=dr(this,Py,AE).call(this,n);if(jp.is(n)&&(e=b(this,HT).getMapDataInternal())!=null&&e.enterpriseMode){r.push(n.id);continue}else if("geoJSON"in n&&n.geoJSON.geometry.coordinates.length>0){cx(n.geoJSON,l=>{r.push([l[0],l[1],a])});continue}let o=b(this,Ti).getBoundingArea(n.id);if(o)r.push(...o.map(l=>[l[0],l[1],a]));else if("geoJSONBoundingBox"in n){let l=dr(this,Py,AE).call(this,n);if(n.geoJSONBoundingBox!=null){let u=[[n.geoJSONBoundingBox[0],n.geoJSONBoundingBox[1],l],[n.geoJSONBoundingBox[2],n.geoJSONBoundingBox[3],l]];r.push(...u)}}}else iz(n)&&r.push(n);return r},"#computeCoordinateCloud"),s(JLe,"Camera");var hrt=JLe;N();var Z2,QLe=class{constructor({currentMapGetter:e}){Be(this,Z2),He(this,Z2,e)}get currentMap(){return b(this,Z2).call(this)}async getCurrentSceneGLTF(e){let r=b(this,Z2).call(this);return r?r==null?void 0:r.Exporter.getCurrentSceneGLTF(e):(Vt.error("There is no map to export. Please load a map first."),new Blob)}};Z2=new WeakMap,s(QLe,"Exporter");var prt=QLe;N();var Ud,$I,e6e=class{constructor({currentMapGetter:e}){Be(this,Ud,new Map),Be(this,$I),He(this,$I,e)}get currentMap(){return b(this,$I).call(this)}getById(e){return b(this,Ud).get(e)}add(e,r,i){let n=e.anchorTarget,a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Labels.add(n,r,vt(Ee({},i),{attachTo:Z5(e),rank:(i==null?void 0:i.rank)==null||(i==null?void 0:i.rank)==="initial"?"medium":i.rank})),l=new PN(o.id.toString(),r,e);return b(this,Ud).set(l.id,{label:l,entityId:l.id}),l}all(e){var r;let i=[];return(r=this.currentMap)==null||r.Labels.all({onCreate:s((n,a,o)=>{let l=new PN(n.toString(),a,o);b(this,Ud).set(l.id,{label:l,entityId:l.id}),i.push(l)},"onCreate"),labelOptions:e}),i}remove(e){var r;let i=b(this,Ud).get(e.id);i&&((r=this.currentMap)==null||r.Labels.remove(i),b(this,Ud).delete(e.id.toString()))}removeAll(){let e=[];return b(this,Ud).forEach(({label:r})=>{this.remove(r),e.push(r),b(this,Ud).delete(r.id.toString())}),e}};Ud=new WeakMap,$I=new WeakMap,s(e6e,"Labels");var drt=e6e;N();N();var H6={altitude:0,height:1,color:"#ffffff",opacity:1,width:.15},RX={opacity:.25,color:"#a7d1ec",height:.8,width:.05,altitude:.1,cap:"square",visible:!1},OX=.5,t6e=class{constructor(e,r,i=new Map){$(this,"containerId"),$(this,"layers"),$(this,"renderer"),this.containerId=r,this.layers=i,this.renderer=e}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(e){this.renderer.setState(this.containerId,{visible:e})}};s(t6e,"Layer");var Vg=t6e,m1,r6e=class{constructor(e,r,i,n,a,o,l,u){$(this,"id"),$(this,"name"),$(this,"elevation"),$(this,"containerId"),$(this,"externalId"),$(this,"metadata"),$(this,"shortName"),$(this,"subtitle"),$(this,"occluderId"),$(this,"loaded",!1),$(this,"styleMap",{}),$(this,"obstructions"),$(this,"entrances"),$(this,"spaces"),$(this,"floorImages"),$(this,"floorText"),$(this,"renderer"),$(this,"options"),$(this,"layers",new Map),$(this,"footprint"),$(this,"floorStackId"),$(this,"multiFloorView"),$(this,"mapDataInternal"),$(this,"facadesByStyleId",new Map),Be(this,m1),$(this,"load",s(()=>{var E,M,I,P,C,T,O,F,k,B,U,z,q,W;if(this.loaded||this.obstructions==null&&this.spaces==null)return this;this.loaded=!0;let J=this.renderer.addGroupContainer("".concat(B_,"-").concat(this.id),{},this.id);this.layers.set(B_,new Vg(this.renderer,J.id.toString()));let V=this.renderer.addGroupContainer("".concat(By,"-").concat(this.id),{},this.id);this.layers.set(By,new Vg(this.renderer,V.id.toString()));let oe=this.renderer.addGroupContainer("".concat(il,"-").concat(this.id),{},this.id);if(this.layers.set(il,new Vg(this.renderer,oe.id.toString())),((E=this.footprint)==null?void 0:E.geometry)!=null&&((M=this.footprint)==null?void 0:M.geometry.coordinates.length)!==0){let Y=H6;if(this.obstructions!=null&&this.obstructions.features.length>0){let ae=this.obstructions.features.filter(ee=>ee.geometry.type==="LineString"&&ee.properties.kind==="Wall"&&ee.properties.footprintComponent===!0);ae!=null&&ae.length>0&&(Y=this.styleMap[(I=ae[0].properties)==null?void 0:I.id])}let he=this.renderer.addGeometryGroup("Footprint-".concat(this.id),{features:[{geometry:this.footprint.geometry,properties:{id:"Footprint-Floor-".concat(this.id)}}]},vt(Ee({},Y),{height:(C=(P=this.multiFloorView)==null?void 0:P.floorHeight)!=null?C:10,altitude:0,visible:!1,opacity:this.elevation<0?1:.4,side:this.elevation<0?"back":"front",color:this.elevation<0?"#F0EEE8":Y.color,renderOrder:2}),this.id);this.layers.set(bk,new Vg(this.renderer,he.id.toString()));let Q=this.renderer.addGroupContainer("".concat(pT,"-").concat(this.id),{},this.id);this.layers.set(pT,new Vg(this.renderer,Q.id.toString())),this.occluderId=this.renderer.addOccluder(this.footprint,Q.id)}if(this.spaces!=null&&this.spaces.features.length>0){let Y=[],he=new Map;this.spaces.features.filter(le=>{var K;return le.geometry.type==="Polygon"&&((K=le.properties.kind)==null?void 0:K.toLowerCase())!=="void"}).forEach(le=>{var K;let ce=(K=this.mapDataInternal)==null?void 0:K.facadesBySpaceId[le.properties.id];if(ce){let te=he.get(ce.id)||[];he.set(ce.id,[...te,le])}else Y.push(le)});let Q=f3(Y,this.styleMap),ae=this.renderer.addGroupContainer("spaces-".concat(this.id),{},oe),ee=0;for(let[le,K]of Q){let ce=this.renderer.addGeometryGroup("Spaces-".concat(this.id,"-").concat(ee),{features:K},E1(le,this.options),ae);ee++;let te=ae.id.toString();this.layers.get(il).layers.set(le.id||te,ce.id.toString())}if(he.size>0){let le=this.renderer.addGroupContainer("".concat(pw,"-").concat(this.id),{},this.id);this.layers.set(pw,new Vg(this.renderer,le.id.toString()));for(let[K,ce]of he){let te=this.renderer.addGroupContainer(K,{focusable:!0},le),ne=this.renderer.addGroupContainer("".concat(K,"-geometry"),{},te),pe=f3(ce,this.styleMap),xe=0;for(let[Te,fe]of pe){let Pe=this.renderer.addGeometryGroup("Facades-".concat(this.id,"-").concat(K,"-").concat(xe),{features:fe},vt(Ee({},E1(Te,this.options)),{renderOrder:3}),ne);xe++;let me=Te.id||Pe.id.toString();this.layers.get(pw).layers.set("".concat(K,"-").concat(me),Pe.id.toString()),this.facadesByStyleId.has(me)?(T=this.facadesByStyleId.get(me))==null||T.push(K):this.facadesByStyleId.set(me,[K])}}}}if(this.obstructions!=null&&this.obstructions.features.length>0){let Y=this.obstructions.features.filter(ne=>ne.geometry.type==="Polygon"&&ne.properties.kind==="object"),he=f3(Y,this.styleMap),Q=this.renderer.addGroupContainer("objects-".concat(this.id),{},oe),ae=0;for(let[ne,pe]of he){let xe=this.renderer.addGeometryGroup("Objects-".concat(this.id,"-").concat(ae),{features:pe},E1(ne,this.options),Q);ae++;let Te=Q.id.toString();this.layers.get(il).layers.set(ne.id||Te,xe.id.toString())}let ee=this.obstructions.features.filter(ne=>ne.geometry.type==="LineString"&&ne.properties.kind==="Wall"&&ne.properties.footprintComponent===!1),le=this.obstructions.features.filter(ne=>ne.geometry.type==="LineString"&&ne.properties.kind==="Wall"&&ne.properties.footprintComponent===!0),K=this.entrances,ce=H6,te=H6;if(ee!=null&&ee.length>0){let ne=this.styleMap[(O=ee[0].properties)==null?void 0:O.id];ne!=null&&(ce=Ee({},ne)),te=ce;let{walls:pe,entrances:xe}=HX(ee,(K==null?void 0:K.features)||[]),Te=Math.max(ce.height-.11,OX),fe=vt(Ee({},RX),{height:Te}),Pe=this.renderer.addGeometryGroup("InteriorDoors-".concat(this.id),xe,fe,oe);this.layers.get(il).layers.set(yz,Pe.id.toString());let me=this.renderer.addGeometryGroup("Walls-".concat(this.id),{features:[pe]},E1(ce,this.options),oe);this.layers.get(il).layers.set(JP,me.id.toString())}if(le!=null&&le.length>0){let ne=this.styleMap[(F=le[0].properties)==null?void 0:F.id];ne!=null&&(te=vt(Ee({},ne),{id:F_}));let{walls:pe,entrances:xe}=HX(le,(K==null?void 0:K.features)||[]),Te=Math.max(te.height-.11,OX),fe=vt(Ee({},RX),{height:Te}),Pe=this.renderer.addGeometryGroup("ExteriorDoors-".concat(this.id),xe,fe,oe);this.layers.get(il).layers.set(vz,Pe.id.toString());let me=this.renderer.addGeometryGroup("ExteriorWalls-".concat(this.id),{features:[pe]},E1(te,this.options),oe);this.layers.get(il).layers.set(F_,me.id.toString())}}if(this.floorImages!=null){let Y=this.renderer.addGroupContainer("images-".concat(this.id),{},this.id);for(let he of this.floorImages.features||[])"anchorId"in he.properties||"anchorId"in he.properties&&((k=he.properties)==null?void 0:k.anchorId)==null||this.renderer.addImage(ya(),he,{url:he.properties.path,flipImageToFaceCamera:(B=this.options.flipImagesToFaceCamera)!=null?B:!0},Y);this.layers.set(HWe,new Vg(this.renderer,Y.id.toString()))}if(this.floorText!=null)for(let Y of this.floorText.features||[]){let he=0;"geometryId"in Y.properties?he=(z=(U=this.renderer.getState(Y.properties.geometryId))==null?void 0:U.height)!=null?z:0:he=(q=Y.properties.verticalOffset)!=null?q:0,this.renderer.addText3D(ya(),vt(Ee({},Y),{properties:vt(Ee({},Y.properties),{verticalOffset:he})}),{},this.id)}return(W=this.multiFloorView)!=null&&W.enabled&&this.renderer.setState(this.id,{altitude:this.elevation*this.multiFloorView.floorHeight}),this.renderer.render(),this},"load"));var c,p,m,y,v;this.id=r.id,this.options=a;let w=i.addGroupContainer(this.id,{visible:!1,interactive:!0,preloadGeometry:(c=a.preloadFloors)==null?void 0:c.map(E=>E.id).includes(r.id)},e);this.containerId=w.id.toString(),this.externalId=r.externalId,this.metadata=r.metadata,this.shortName=r.shortName,this.subtitle=r.subtitle,this.name=r.name,this.elevation=r.elevation,o!=null&&l!=null&&(this.styleMap=l,this.spaces=o.space[this.id],this.entrances=o.entrance[this.id],this.obstructions=o.obstruction[this.id],this.floorImages=(p=o.floorImages)==null?void 0:p[this.id],this.floorText=(y=(m=o.enterprise)==null?void 0:m.floorText)==null?void 0:y[this.id],this.footprint=(v=o["floor.geojson"])==null?void 0:v.features.find(E=>E.properties.id===r.id)),this.renderer=i,this.floorStackId=e,this.multiFloorView=n,this.mapDataInternal=u}get geoJSONBoundingBox(){if(b(this,m1))return b(this,m1);if(!this.footprint){Vt.warn("Attempting to get bounding box with no footprint for floor ".concat(this.id));return}return He(this,m1,Mj(this.footprint)),b(this,m1)}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(e){this.renderer.setState(this.containerId,{visible:e})}};m1=new WeakMap,s(r6e,"FloorObject");var kX=r6e;N();var q6=50,NX=!1,frt=1e3,fo,Y2,Vd,Ap,Ml,GI,oy,K2,g1,Yd,YN,y1,HI,qI,WI,XI,Am,i6e,ZI,wy,KN,FX,n6e,v1,a6e=class extends Wa{constructor({currentMapGetter:e}){super(),Be(this,Yd),Be(this,fo),Be(this,Y2,0),Be(this,Vd),Be(this,Ap,!1),Be(this,Ml,[]),Be(this,GI,0),Be(this,oy,q6),Be(this,K2,!1),Be(this,g1,"collapsed"),$(this,"expandedFactor",0),Be(this,y1,"all-floors"),Be(this,HI,s(()=>{let i=b(this,fo).call(this);if(b(this,GI)===this.expandedFactor||i==null||!b(this,Ap))return;He(this,GI,this.expandedFactor);let n=Yy(this.expandedFactor,0,1,0,this.distanceBetweenFloors),a=Yy(this.expandedFactor,0,.1,0,1)===0;b(this,Ml).forEach((o,l)=>{i.api.updateState(o.containerId,{visible:a?o.id===i.currentFloorId:!0,altitude:n*l})}),this.expandedFactor===0?(He(this,Ap,!1),i.renderer.camera.setPanMode("default"),b(this,wy)&&b(this,wy).call(this)):this.expandedFactor===1&&(He(this,Ap,!1),b(this,wy)&&b(this,wy).call(this))},"#handlePreRender")),Be(this,qI,s(()=>{var i,n,a;this.expanded&&He(this,Y2,(n=(i=b(this,fo).call(this))==null?void 0:i.renderer.camera.elevation)!=null?n:0),(a=b(this,fo).call(this))==null||a.renderer.on("user-interaction-end",b(this,XI))},"#handleUserInteractionStart")),Be(this,WI,s(()=>{var i;let n=b(this,fo).call(this);if(n!=null&&this.expanded&&b(this,K2)&&!b(this,Ap)){let a=n.currentFloorId,o=[1/0,n.currentFloorId];for(let l=0;l<b(this,Ml).length;l++){let u=b(this,Ml)[l],c=Math.abs(((i=n.renderer.camera.elevation)!=null?i:0)-l*this.distanceBetweenFloors);c<this.distanceBetweenFloors/3&&(o[0]=c,o[1]=u.id)}o[1]!==n.currentFloorId&&(n.currentFloorId=o[1],b(this,Ml).forEach(l=>{n.api.updateState(l.containerId,{visible:b(this,y1)==="all-floors"?!0:n.currentFloor.id===l.id})}),n.publish("floor-change",{reason:"stacked-maps-elevation-change",floorId:n.currentFloorId,previousFloorId:a}))}},"#determineCurrentMapBasedOnElevation")),Be(this,XI,s(()=>{var i,n;let a=b(this,fo).call(this);if(this.expanded&&a&&b(this,Y2)!==((i=a.renderer.camera.elevation)!=null?i:0)){let o=[1/0,a.currentFloorId,0];for(let l=0;l<b(this,Ml).length;l++){let u=b(this,Ml)[l],c=Math.abs(((n=a.renderer.camera.elevation)!=null?n:0)-l*this.distanceBetweenFloors);c<o[0]&&(o[0]=c,o[1]=u.id,o[2]=l*this.distanceBetweenFloors)}b(this,K2)&&dr(this,Yd,i6e).call(this,o[2]),He(this,Y2,0),a.renderer.off("user-interaction-end",b(this,XI))}},"#handleUserInteractionEnd")),Be(this,Am,null),Be(this,ZI,null),Be(this,wy),Be(this,v1),He(this,fo,e);let r=b(this,fo).call(this);r!=null&&r.id!=="outdoors"&&(r.renderer.on("user-interaction-start",b(this,qI)),r.renderer.on("camera-change",b(this,WI)),r.renderer.on("pre-render",b(this,HI)))}get state(){return b(this,g1)}get expanded(){return b(this,g1)!=="collapsed"}get distanceBetweenFloors(){if(b(this,oy)==="auto"){if(b(this,v1)!=null)return b(this,v1);let e=dr(this,Yd,n6e).call(this);if(e)return He(this,v1,e),e}return typeof b(this,oy)=="number"?b(this,oy):q6}clearCachedFloorSeparationDistance(){He(this,v1,void 0)}get includedFloors(){var e;return(e=b(this,Yd,YN))!=null&&e.api.mapData?b(this,Ml).map(r=>{var i,n;return(n=(i=b(this,Yd,YN))==null?void 0:i.api.mapData)==null?void 0:n.getById("floor",r.id)}).filter(Boolean):[]}get floorVisibilityMode(){return b(this,y1)}setFloorVisiblityMode(e){He(this,y1,e);let r=b(this,fo).call(this);r!=null&&b(this,Ml).forEach(i=>{r.api.updateState(i.containerId,{visible:b(this,y1)==="all-floors"?!0:r.currentFloor.id===i.id})})}changeFloorOnElevationChanges(e){He(this,K2,e)}async expand(e){var r,i,n;let a=b(this,fo).call(this);if(a!=null)return(e==null?void 0:e.distanceBetweenFloors)==="auto"?He(this,oy,"auto"):He(this,oy,(r=e==null?void 0:e.distanceBetweenFloors)!=null?r:q6),He(this,Ml,(e==null?void 0:e.includedFloors)!=null&&(e==null?void 0:e.includedFloors.length)>0?e==null?void 0:e.includedFloors.map(o=>a.floorsById.get(o.id)).filter(Boolean):a.currentFloorStack.floorObjects),b(this,Ml).sort((o,l)=>o.elevation-l.elevation),b(this,Ml).length<=1||this.expanded===!0?Promise.resolve():(He(this,Ap,!0),a.api.Camera.setPanMode((i=e==null?void 0:e.cameraPanMode)!=null?i:"elevation"),this.changeFloorOnElevationChanges((n=e==null?void 0:e.changeFloorOnElevationChanges)!=null?n:!0),dr(this,Yd,KN).call(this,"expand",e).then(()=>{He(this,g1,"expanded"),this.publish("stacked-maps-state-change",{state:"expanded"})}).finally(()=>{He(this,Ap,!1)}))}async collapse(e){let r=b(this,fo).call(this);if(r!=null)return this.expanded===!0?(He(this,Ap,!0),r.api.Camera.setPanMode("default"),this.changeFloorOnElevationChanges(!1),dr(this,Yd,KN).call(this,"collapse",e).then(()=>{He(this,g1,"collapsed"),this.publish("stacked-maps-state-change",{state:"collapsed"})}).finally(()=>{He(this,Ap,!1)})):Promise.resolve()}destroy(){let e=b(this,fo).call(this);e!=null&&(e.renderer.off("user-interaction-start",b(this,qI)),e.renderer.off("camera-change",b(this,WI)),e.renderer.off("pre-render",b(this,HI)))}};fo=new WeakMap,Y2=new WeakMap,Vd=new WeakMap,Ap=new WeakMap,Ml=new WeakMap,GI=new WeakMap,oy=new WeakMap,K2=new WeakMap,g1=new WeakMap,Yd=new WeakSet,YN=s(function(){return b(this,fo).call(this)},"#currentMap"),y1=new WeakMap,HI=new WeakMap,qI=new WeakMap,WI=new WeakMap,XI=new WeakMap,Am=new WeakMap,i6e=s(function(t){var e,r,i;b(this,Am)&&b(this,Am).stop();let n=b(this,fo).call(this);n!=null&&(He(this,Am,new pf({elevation:(e=n.renderer.camera.elevation)!=null?e:0}).to({elevation:t},150).easing(Ol.Quadratic.Out).onComplete(()=>{var a;b(this,Am)&&((a=b(this,fo).call(this))==null||a.renderer.getTweenGroup().remove(b(this,Am)))}).onUpdate(({elevation:a})=>{n.renderer.camera.setElevation(a)}).start()),(r=b(this,fo).call(this))==null||r.renderer.getTweenGroup().add(b(this,Am)),(i=b(this,fo).call(this))==null||i.renderer.render())},"#animateElevationTo"),ZI=new WeakMap,wy=new WeakMap,KN=s(function(t,e){var r,i,n,a;b(this,Vd)&&b(this,Vd).stop();let o=b(this,fo).call(this);if(o==null)return Promise.reject(new Error("No current map"));let l=b(this,Ml).indexOf(o.currentFloor),u=(r=o.renderer.camera.elevation)!=null?r:0;return He(this,ZI,new Promise(c=>{He(this,wy,c)})),He(this,Vd,new pf({percentExpanded:this.expandedFactor}).to({percentExpanded:t==="expand"?1:0},(i=e==null?void 0:e.duration)!=null?i:frt).easing(Q_[(e==null?void 0:e.easing)||"ease-in-out"]).onUpdate(({percentExpanded:c})=>{this.expandedFactor=c;let p=l*this.distanceBetweenFloors;o.renderer.camera.setElevation(t==="expand"?p*c:u*c)}).onComplete(()=>{var c;b(this,Vd)&&((c=b(this,fo).call(this))==null||c.renderer.getTweenGroup().remove(b(this,Vd)))}).start()),b(this,Vd).cameraAnimation=!0,(n=b(this,fo).call(this))==null||n.renderer.getTweenGroup().add(b(this,Vd)),(a=b(this,fo).call(this))==null||a.renderer.render(),b(this,ZI)},"#animate"),FX=s(function(t,e,r,i){let n=YI(t,r),a=e.clone(),o=YI(a,r);if(!J3(n)||!J3(o))return-1;let l=0,u;do{if(l>1e4)return-1;l+=20,a.position.z=l,a.updateMatrixWorld(),o.makeEmpty(),YI(a,r,o),u=n.intersectsBox(o)}while(u);return l},"#computeMinZOffsetToSeparateFirstTwoFloors"),n6e=s(function(){let t=b(this,fo).call(this);if(!t)return;let e=t.renderer,r=e.getThreeScene();if(!t.api.mapData||!r)return;let i=b(this,Ml).length>0?b(this,Ml):t.currentFloorStack.floorObjects;if(i.length<2)return;let n=e.getInternalState().geometry3DMap.get(i[0].id),a=e.getInternalState().geometry3DMap.get(i[1].id);if(!n||!a)return;OO(n,"group-container"),OO(a,"group-container");let o=dr(this,Yd,FX).call(this,n,a,e.getThreeCamera(),e.container);if(o!==-1)return o},"#computeZOffsetSeparatesFirstTwoFloorsInClipSpace"),v1=new WeakMap,s(a6e,"StackedMaps");var mrt=a6e,um=new qe,BX=new Jt;function YI(t,e,r=new Ode){return t.traverse(i=>{if(i instanceof Pn){let n=i.geometry.attributes.position;if(e.position.distanceTo(i.position)<e.near)return;for(let a=0;a<n.count;a++)um.fromBufferAttribute(n,a),um.applyMatrix4(i.matrixWorld),um.applyMatrix4(e.matrixWorldInverse),um.applyMatrix4(e.projectionMatrix),um.z<1&&um.z>0&&(BX.set(um.x,um.y),r.expandByPoint(BX))}}),r}s(YI,"projectToBox2D");function JN(t,e){let r=e.clientWidth,i=e.clientHeight;return new Jt((t.x+1)*r/2,(1-t.y)*i/2)}s(JN,"ndcToScreen");function grt(t,e,r){let i=document.createElement("div");i.style.position="absolute",i.style.border="2px solid ".concat(e),i.style.pointerEvents="none";let n=JN(new Jt(t.min.x,t.min.y),r),a=JN(new Jt(t.max.x,t.max.y),r);i.style.left="".concat(n.x,"px"),i.style.top="".concat(a.y,"px");let o=Math.abs(a.x-n.x),l=Math.abs(a.y-n.y);return i.style.width="".concat(o,"px"),i.style.height="".concat(l,"px"),r.appendChild(i),i}s(grt,"drawProjectedBox");N();N();function o6e(t,e){return"".concat(e," ").concat(t)}s(o6e,"formatMessage");var s6e=class extends Error{constructor(e,r=Lme){super(o6e(e,r)),this.name="MappedinError"}};s(s6e,"MappedinError");var Oh=s6e,J2,l6e=class{constructor(e,r,i,n){$(this,"id"),$(this,"externalId"),$(this,"name"),$(this,"type"),$(this,"floorIds"),$(this,"defaultFloorId"),$(this,"floorObjects",[]),$(this,"floorObjectsByElevation",new Map),$(this,"metadata"),$(this,"containerId"),$(this,"facade"),$(this,"renderer"),Be(this,J2);var a;this.id=e.id,this.externalId=e.externalId,this.name=e.name,this.type=e.type,this.metadata=e.metadata,this.floorIds=(a=e.floors)!=null?a:e.maps,this.defaultFloorId=e.defaultFloor,this.renderer=i;let o=i.addGroupContainer(this.id,{visible:!0,interactive:!0},r);this.containerId=o.id.toString(),this.facade=n}get defaultFloor(){if(b(this,J2)==null){if(this.floorObjects.length===0)throw new Oh("No floors in floor stack (".concat(this.id,"). Could not get default floor."));let e;this.defaultFloorId&&(e=this.floorObjects.find(r=>r.id===this.defaultFloorId)),e||(e=this.floorObjects.reduce((r,i)=>Math.abs(i.elevation)<Math.abs(r.elevation)?i:r)),He(this,J2,e)}return b(this,J2)}addFloor(e){if(this.floorObjectsByElevation.has(e.elevation)){Vt.error("Floor with same elevation ".concat(e.elevation," already exists in Stack (").concat(this.id,"). Floor (").concat(e.id,") will not be added."));return}e.load(),this.floorObjects.push(e),this.floorObjectsByElevation.set(e.elevation,e)}setFacadeVisible(e){var r,i;(i=(r=this.facade)==null?void 0:r.spaces)==null||i.forEach(n=>{this.renderer.setState(n.spaceId,{visible:e})})}};J2=new WeakMap,s(l6e,"FloorStackObject");var zX=l6e;N();function u6e(t,e,r,i){let n={outdoorOpacity:1,floorStates:[]},a=t.sort((p,m)=>p.elevation-m.elevation),o=Math.min(0,a[0].elevation),l=a[a.length-1].elevation,u,c;for(let p=o;p<=l;p++){let m=a.find(M=>M.elevation===p);if(m==null){p>=0&&(u==null?u=p:c=p);continue}let y=0,v=p<0?Math.abs(m.elevation)*r:r,w=!1;if(u===0&&c!=null){let M=r*c;y=-M,v=M,w=!0}else if(u!=null&&c!=null){let M=u,I=t.find(C=>C.elevation===M-1),P=n.floorStates.find(C=>C.floor===I);if(P){let C=r*(c-u+2);P.state.footprint=vt(Ee({},P.state.footprint),{altitude:0,height:C,visible:!0})}}u=void 0,c=void 0;let E={floor:m,state:{type:"floor",visible:!1,geometry:{visible:!1},labels:{enabled:!1},markers:{enabled:!1},footprint:{visible:!1},occlusion:{enabled:!1}}};n.floorStates.push(E),m.id===e.id?(E.state.visible=!0,E.state.geometry.visible=!0,E.state.labels.enabled=!0,E.state.markers.enabled=!0,E.state.occlusion.enabled=!0,(m.elevation<0||w)&&(m.elevation<0&&(n.outdoorOpacity=.2),E.state.footprint.height=v,E.state.footprint.altitude=y,E.state.footprint.visible=!0)):i.includes(m.id)&&m.elevation<e.elevation?(E.state.visible=!0,E.state.geometry.visible=!0,E.state.markers.enabled=!0,E.state.occlusion.enabled=!0,E.state.footprint.visible=!0,m.elevation<0?(E.state.footprint.height=v,E.state.footprint.altitude=y,n.outdoorOpacity=.2):(E.state.footprint.height=v,E.state.footprint.altitude=y)):e.elevation>0&&m.elevation<e.elevation&&m.elevation>=0&&(E.state.visible=!0,E.state.footprint.visible=!0,E.state.footprint.height=r,E.state.footprint.altitude=y)}return n}s(u6e,"getVisiblityState");var yrt={linear:Ol.Linear.None,easeIn:Ol.Quadratic.In,easeOut:Ol.Quadratic.Out,easeInOut:Ol.Quadratic.InOut},jd,c6e=class extends Wa{constructor(e,r,i,n){var a,o,l,u;super(),$(this,"floorStacksById",new Map),$(this,"floorsById",new Map),$(this,"currentFloorId",""),$(this,"currentFloorStackId",""),$(this,"outdoorFloorStacks",new Set),$(this,"id"),$(this,"renderer"),$(this,"api"),$(this,"mvf"),$(this,"options",{}),$(this,"styleMap"),$(this,"StackedMaps"),$(this,"animations",new Map),$(this,"Models",{add:s((y,v,w)=>{let E=w,{floorId:M,scale:I}=E,P=Nh(E,["floorId","scale"]),C=M?this.floorsById.get(M):this.currentFloor,T=Ee({},P);I!=null&&(T.scale=Array.isArray(w.scale)?w.scale:[w.scale,w.scale,w.scale]);let O=this.renderer.addModelGroup(y,{type:"FeatureCollection",features:v.map(F=>{var k;return{type:"Feature",properties:{id:ya(),rotation:w.rotation,scale:T.scale,interactive:w.interactive,verticalOffset:F.verticalOffset+((k=w.verticalOffset)!=null?k:0)},geometry:{type:"Point",coordinates:Np(F)}}})},T,{parent:C.id});if(O==null)throw new Oh("error creating model");return this.renderer.getState(O).children},"add"),remove:s((y,v)=>{this.renderer.remove(y),this.renderer.getState(v).children.length===0&&this.renderer.remove(v)},"remove")}),$(this,"Images",{add:s((y,v,w)=>{let E=w,{floorId:M,flipImageToFaceCamera:I}=E,P=Nh(E,["floorId","flipImageToFaceCamera"]),C=M?this.floorsById.get(M):this.currentFloor,T={type:"Feature",properties:P,geometry:{type:"Point",coordinates:y}};return this.renderer.addImage(ya(),T,{url:v,flipImageToFaceCamera:I??!1},C.id)},"add"),remove:s(y=>{this.renderer.remove(y)},"remove"),removeAll:s(()=>{},"removeAll")}),$(this,"Markers",{add:s((y,v,w)=>{let E=p9(y,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),M=w,{attachTo:I}=M,P=Nh(M,["attachTo"]),C=P;P.rank==="initial"&&(C.rank="medium");let T=E.layers.get(By),O=this.renderer.addMarker2D(Np(y),v,vt(Ee({},C),{occluderId:E==null?void 0:E.occluderId,attachTo:I}),T==null?void 0:T.containerId);if(!O)throw new Oh("Failed to create Marker");return O},"add"),remove:s(y=>{this.renderer.remove(y)},"remove"),getContentEl:s(y=>{let v=this.renderer.getState(y);if((v==null?void 0:v.type)==="marker")return v.element},"getContentEl"),removeAll:s(()=>{},"removeAll"),setPosition:s((y,v,w)=>{var E;let M=this.renderer.getState(y),I=w?this.floorsById.get(w):this.currentFloor;if(!M){Vt.error('Failed to retrieve state for Marker with id "'.concat(y,'".'));return}if(M.type!=="marker"){Vt.error('Geometry with id "'.concat(y,'" is not of type "marker".'));return}this.renderer.setState(M,{position:v,parent:(E=I==null?void 0:I.layers.get(By))==null?void 0:E.containerId})},"setPosition"),animateTo:s((y,v,w,E)=>{let M=this.renderer.getState(y),I=w?this.floorsById.get(w):this.currentFloor;if(!M)return Vt.error('Failed to retrieve state for Marker with id "'.concat(y,'".')),Promise.resolve();if(M.type!=="marker")return Vt.error('Geometry with id "'.concat(y,'" is not of type "marker".')),Promise.resolve();let P=Ee({duration:1e3,easing:"ease-in-out"},E);this.cancelAnimation(y);let C=new pf({lon:M.position[0],lat:M.position[1]}).to({lon:v[0],lat:v[1]},P.duration).easing(yrt[P.easing]).onUpdate(({lon:T,lat:O})=>{var F;if(!this.renderer.getState(y))this.cancelAnimation(y);else{let k=(F=I==null?void 0:I.layers.get(By))==null?void 0:F.containerId;k&&this.Markers.setPosition(y,[T,O],k)}}).start();return this.renderer.getTweenGroup().add(C),this.renderer.render(),this.animations.set(y,C),h9(C).then(()=>{this.animations.delete(y)})},"animateTo")}),$(this,"Exporter",{getCurrentSceneGLTF:s(async y=>this.renderer.getCurrentSceneGLTF(y),"getCurrentSceneGLTF")}),$(this,"Shapes",{add:s((y,v,w)=>{let E=w!=null&&w.floorId?this.floorsById.get(w==null?void 0:w.floorId):this.currentFloor,M=ya();return this.renderer.addGeometryGroup(M,y,v,E.id),M},"add"),remove:s(y=>(this.renderer.remove(y.id),y.id),"remove")}),$(this,"Text3D",{label:s((y,v,w)=>{var E;if(!((E=this.api.getMapDataInternal())!=null&&E.enterpriseMode)){Vt.warn("Enterprise mode is not enabled, skipping label creation");return}let M=QN(this.renderer,y,v,w);if(M)return{textInfo:M,target:y}},"label"),labelAll:s((y={})=>{var v;if(!((v=this.api.getMapDataInternal())!=null&&v.enterpriseMode))return Vt.warn("Enterprise mode is not enabled, skipping label creation"),[];let w=this.api.getMapData();if(!w)return[];let E=[];return w.getByType("space").forEach(M=>{var I,P;if(M.locations[0]){let C=QN(this.renderer,M,(P=(I=M.locations[0])==null?void 0:I.name)!=null?P:M.name,y);C&&E.push({textInfo:C,target:M})}}),E},"labelAll"),remove:s(y=>{var v;if(!((v=this.api.getMapDataInternal())!=null&&v.enterpriseMode)){Vt.warn("Remove text label only works in enterprise mode");return}return this.renderer.remove(y),y},"remove")}),$(this,"Labels",{all:s(({onCreate:y,labelOptions:v={}})=>{for(let w of Object.entries(this.mvf.space)){let[E,M]=w;M&&M.features.forEach(I=>{var P,C,T,O,F;let k=(P=this.api.getMapData())==null?void 0:P.getById("space",I.properties.id);if(!k)return;let B=(C=this.styleMap[I.properties.id])==null?void 0:C.showImage,U=(T=I.properties.details)==null?void 0:T.images,z=B&&(O=U==null?void 0:U[0])!=null&&O.url?{icon:U[0].url}:{},q=Ee({marker:Ee(Ee({},z),(F=v.appearance)==null?void 0:F.marker)},v.appearance),W=(E?this.floorsById.get(E):this.currentFloor).layers.get(B_);if(I.properties.center&&k.name!==""){let J=this.renderer.addLabel2D(I.properties.center,k.name,vt(Ee({id:I.properties.id+"-label"},v),{appearance:q,rank:v.rank,attachTo:Z5(k)}),Zp.is(k)?k.id:W==null?void 0:W.containerId);J&&y(J.id,k.name,k)}})}},"all"),add:s((y,v,w={})=>{let E=w,{attachTo:M}=E,I=Nh(E,["attachTo"]),P=p9(y,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),C=P.layers.get(B_),T=this.renderer.addLabel2D(Np(y),v,vt(Ee({},I),{occluderId:P.occluderId,attachTo:M}),C==null?void 0:C.containerId);if(!T)throw new Oh("label creating failed");return T},"add"),remove:s(({entityId:y})=>{this.renderer.remove(y)},"remove"),removeAll:s(()=>{},"removeAll")}),$(this,"Paths",{add:s((y,v)=>{var w;let E=(w=v==null?void 0:v.animateDrawing)!=null?w:!0,M=[],I=y[0].floorId||"root",P=0;for(let T of y){let{floorId:O="root",latitude:F,longitude:k}=T;O!==I&&(P++,I=O),M[P]==null&&M.push({floorId:O,coordinates:[]});let B=O===T.floorId?T:new On({longitude:k,latitude:F,floorId:O});M[P].coordinates.push(B)}let C=M.reduce((T,{floorId:O,coordinates:F},k)=>{if(k!==0){let U=M[k-1],z=U.coordinates[U.coordinates.length-1],q=F[0],W=Np(z),J=Np(q),V=this.renderer.addPath({type:"FeatureCollection",features:[{type:"Feature",properties:{parentId:U.floorId},geometry:{type:"Point",coordinates:W}},{type:"Feature",properties:{parentId:O},geometry:{type:"Point",coordinates:J}}]},v,this.id);V&&(v!=null&&v.animateDrawing&&this.renderer.setState(V.id,{completeFraction:0}),T.push(vt(Ee({},V),{coordinates:[z,q]})))}let B=this.renderer.addPath({type:"FeatureCollection",features:F.map(U=>({type:"Feature",properties:{},geometry:{type:"Point",coordinates:Np(U)}}))},v,O);return B&&(v!=null&&v.animateDrawing&&this.renderer.setState(B.id,{completeFraction:0}),T.push(vt(Ee({},B),{coordinates:F}))),T},[]);if(E){let T=[],O=this.api.getMapData();return C.forEach(F=>{var k;let B=Y6e(F,O,this.api);T.push(new pf({fraction:0}).to({fraction:1},B===!1?0:(k=v==null?void 0:v.drawDuration)!=null?k:1500).onUpdate(U=>{this.renderer.setState(F.id,{completeFraction:U.fraction})}))}),T.forEach((F,k)=>{k<T.length-1&&F.chain(T[k+1]),this.renderer.getTweenGroup().add(F)}),T[0].start(),this.renderer.render(),this.animations.set(C[0].id.toString(),T[0]),{paths:C,animation:h9(T[T.length-1]).then(()=>{this.animations.delete(C[0].id.toString())})}}else return{paths:C,animation:Promise.resolve()}},"add"),remove:s(y=>{y.forEach(v=>{this.cancelAnimation(v),this.renderer.remove(v)})},"remove")}),Be(this,jd,{enabled:!1,floorHeight:10,updateCameraElevationOnFloorChange:!0}),this.renderer=n.core,this.api=n,this.id=e,this.renderer.addGroupContainer(e,{},"root"),this.options=i??{},this.StackedMaps=new mrt({currentMapGetter:s(()=>this,"currentMapGetter")}),this.mvf=(a=r==null?void 0:r.mvf)!=null?a:{};let c=W6e(this.mvf["styles.json"]||{});if(this.styleMap=c,He(this,jd,Ee({enabled:!1,floorHeight:10,updateCameraElevationOnFloorChange:!0},i==null?void 0:i.multiFloorView)),!r){this.id!=="outdoors-container"&&Vt.warn("Map (".concat(this.id,") created with no data."));let y=new zX({id:"default-stack",externalId:"default-stack",name:"Default Stack",maps:["default-floor"]},this.id,this.renderer);this.floorStacksById.set(y.id,y),this.currentFloorStackId=y.id;let v=new kX(y.id,{id:"default-floor",externalId:"default-floor",name:"Default Floor",elevation:0},this.renderer,b(this,jd),i??{});y.addFloor(v),this.floorsById.set(v.id,v),this.setFloor(v.id);return}let p=r.getMVFFeatureByType("floor-stack");if(p==null||p.length===0)throw new Oh("MVF does not contain any Floor Stacks.");for(let y of p){let v=new zX(y,this.id,this.renderer,(o=this.mvf.facade)==null?void 0:o[y.id]);if(v.floorIds.length!==0){for(let w of v.floorIds){let E=r.getMVFFeatureById("floor",w);if(E!=null){let M=this.mvf.space[E.id],I=this.mvf.obstruction[E.id];if((M==null||M.features.length===0)&&(I==null||I.features.length===0))continue;let P=new kX(v.id,E,this.renderer,b(this,jd),i??{},this.mvf,c,r);v.addFloor(P),this.floorsById.set(P.id,P)}}this.floorStacksById.set(y.id,v),this.currentFloorStackId||(this.currentFloorStackId=y.id)}}for(let[y]of Object.entries(r.facadesBySpaceId)){let v=r.getById("space",y);v&&(this.outdoorFloorStacks.add(v.floor.floorStack.id),(l=this.floorsById.get(v.floor.id))==null||l.setVisible(!0))}let m=(u=this.mvf.enterprise)==null?void 0:u.venue.defaultMap;if(i!=null&&i.initialFloor){let y=aT(i.initialFloor);y&&this.floorsById.has(y)?m=y:Vt.error("Invalid initial floor specified (".concat(i.initialFloor,"), using default behavior instead"))}m||(m=this.currentFloorStack.defaultFloor.id),this.setFloor(m)}get currentFloorStack(){let e=this.floorStacksById.get(this.currentFloorStackId);if(!e)throw new Oh('Current floor stack with id "'.concat(this.currentFloorStackId,'" not found'));return e}setFloorStack(e,r){if(this.currentFloorStackId===e)return;let i=this.floorStacksById.get(e);if(i==null){Vt.error("Invalid floor stack passed to setFloorStack (".concat(e,"), the floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}if(i.floorObjects.length===0){Vt.error("Floor stack (".concat(e,") has no floors. The floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}this.setFloor(i.defaultFloor.id,r)}get currentFloor(){let e=this.floorsById.get(this.currentFloorId);if(!e)throw new Oh('Floor with id "'.concat(this.currentFloorId,'" not found'));return e}get floors(){return Array.from(this.floorsById.values())}processFloorChange(e){var r,i,n,a,o;if(this.api.manualFloorVisibility===!0||this.StackedMaps.expandedFactor!==0)return;let l=this.floorsById.get(e),u=this.floorStacksById.get(this.currentFloorStackId);if(l&&u)if(!((r=b(this,jd))!=null&&r.enabled)||l.floorStackId!==(u==null?void 0:u.id))for(let c of this.floorStacksById.values())c.floorObjects.forEach(p=>{p.id!==e&&p.setVisible(!1)});else{let c=u6e(this.currentFloorStack.floorObjects,l,b(this,jd).floorHeight,((n=(i=this.api.Navigation)==null?void 0:i.floors)==null?void 0:n.map(p=>p.id))||[]);(o=(a=this.api)==null?void 0:a.Outdoor)==null||o.setOpacity(c.outdoorOpacity),c.floorStates.forEach(p=>{p.floor&&this.api.updateState(p.floor.id,p.state)}),b(this,jd).updateCameraElevationOnFloorChange&&this.api.Camera.setElevation(l.elevation*b(this,jd).floorHeight)}}setFloor(e,r){if(this.currentFloorId===e)return;if(!this.floorsById.get(e)){Vt.error("Invalid floor passed to setFloor (".concat(e,"), the floor was not changed. Current floor is still ").concat(this.currentFloor.id));return}let i=this.currentFloorId;this.publish("floor-change-start",{previousFloorId:i,floorId:e,reason:r}),!this.StackedMaps.expanded&&this.currentFloorStack&&this.processFloorChange(e),this.currentFloorId=e,this.currentFloorStackId=this.currentFloor.floorStackId,this.currentFloor.setVisible(!0),this.publish("floor-change",{reason:r,floorId:this.currentFloor.id,previousFloorId:i})}cancelAnimation(e){let r=this.animations.get(e);r&&(r.stop(),this.animations.delete(e),this.renderer.getTweenGroup().remove(r))}};jd=new WeakMap,s(c6e,"GeojsonApiMapObject");var UX=c6e;function QN(t,e,r,i){return t.labelText3D(e.id,r??e.name,vt(Ee({},i),{parentId:e.floor.id}))}s(QN,"labelSpace");N();var Sp,KI,h6e=class{constructor({currentMapGetter:e}){Be(this,Sp,new Map),Be(this,KI),He(this,KI,e)}get currentMap(){return b(this,KI).call(this)}getById(e){return b(this,Sp).get(e)}add(e,r,i){let n=e.anchorTarget;if(!n)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Markers.add(n,r,vt(Ee({},i),{rank:(i==null?void 0:i.rank)||"medium",dynamicResize:(i==null?void 0:i.dynamicResize)||!1,attachTo:Z5(e)}));if(o==null)throw new Error("error creating marker");let l=a.Markers.getContentEl(o.id.toString());if(!l)throw new Error("marker component should exist");let u=new wj(o.id.toString(),l,e);return b(this,Sp).set(u.id,{marker:u,entityId:o.id.toString()}),u}remove(e){var r;let i=b(this,Sp).get(e.id);i&&((r=this.currentMap)==null||r.Markers.remove(i.entityId),b(this,Sp).delete(e.id.toString()))}removeAll(){let e=[];return b(this,Sp).forEach(({marker:r})=>{this.remove(r),e.push(r),b(this,Sp).delete(r.id.toString())}),e}setPosition(e,r){var i;let n=r.anchorTarget;if(!n){Vt.error("Cannot determine coordinate from target.");return}let a=this.currentMap;if(!a){Vt.error("Cannot determine the current map.");return}let o=b(this,Sp).get(e.id);if(!o){Vt.error('Cannot find the Marker with id "'.concat(e.id,'".'));return}a.Markers.setPosition(o.entityId,Np(n),(i=n.floorId)!=null?i:a.currentFloorId),o.marker.updateTarget(r)}animateTo(e,r,i){var n;let a=r.anchorTarget;if(!a)return Vt.error("Cannot determine coordinate from target."),Promise.resolve();let o=this.currentMap;if(!o)return Vt.error("Cannot determine the current map."),Promise.resolve();let l=b(this,Sp).get(e.id);return l?(l.marker.updateTarget(r),o.Markers.animateTo(l.entityId,Np(a),(n=a.floorId)!=null?n:o.currentFloorId,i)):(Vt.error('Cannot find the Marker with id "'.concat(e.id,'".')),Promise.resolve())}};Sp=new WeakMap,KI=new WeakMap,s(h6e,"Markers");var vrt=h6e;N();var Sm,JI,p6e=class{constructor({currentMapGetter:e}){Be(this,Sm,new Map),Be(this,JI),He(this,JI,e)}get currentMap(){return b(this,JI).call(this)}getById(e){return b(this,Sm).get(e)}add(e,r,i){var n;let a=e.anchorTarget;if(!a)throw new Error("Target does not implement IAnchorable.");let o=this.currentMap;if(!o)throw new Error("currentMap should exist");let l=o.Images.add(Np(a),r,vt(Ee({},i),{floorId:a.floorId,verticalOffset:a.verticalOffset+((n=i.verticalOffset)!=null?n:0)}));if(!l)throw new Error("image component should exist");let u=new Xtt(l.id.toString(),r,e);return b(this,Sm).set(u.id,{image:u,entityId:l.id.toString()}),u}remove(e){var r;let i=b(this,Sm).get(e.id);i&&((r=this.currentMap)==null||r.Images.remove(i.entityId),b(this,Sm).delete(e.id.toString()))}removeAll(){let e=[];return b(this,Sm).forEach(({image:r})=>{this.remove(r),e.push(r),b(this,Sm).delete(r.id.toString())}),e}};Sm=new WeakMap,JI=new WeakMap,s(p6e,"Images");var _rt=p6e;N();var $d,QI,d6e=class{constructor({currentMapGetter:e}){Be(this,$d,new Map),Be(this,QI),He(this,QI,e)}get currentMap(){return b(this,QI).call(this)}getById(e){return b(this,$d).get(e)}add(e,r,i){let n=[e],a=n.reduce((u,c)=>{var p;return c?(u.has(c.floorId)||u.set(c.floorId,[]),(p=u.get(c.floorId))==null||p.push(c),u):(Vt.error("Cannot determine coordinate from options."),u)},new Map);if(!n.length)throw new Error("targets should not be empty when adding a model");let o=this.currentMap;if(!o)throw new Error("currentMap should exist");let l=[];return a.forEach((u,c)=>{let p=ya();o.Models.add(p,u,vt(Ee({},i),{url:r,floorId:c})).forEach(({id:m})=>{let y=new ULe(m.toString(),p,u[0]);b(this,$d).set(y.id,{model:y,entityId:m.toString(),groupId:p}),l.push(y)})}),l[0]}remove(e){var r;let i=b(this,$d).get(e.id);i&&((r=this.currentMap)==null||r.Models.remove(i.entityId,i.groupId),b(this,$d).delete(e.id.toString()))}removeAll(){let e=[];return b(this,$d).forEach(({model:r})=>{var i;let n=b(this,$d).get(r.id);n&&(e.push(r),(i=this.currentMap)==null||i.Models.remove(n.entityId,n.groupId),b(this,$d).delete(r.id.toString()))}),e}};$d=new WeakMap,QI=new WeakMap,s(d6e,"Models");var xrt=d6e;N();var Gd,e3,f6e=class{constructor({currentMapGetter:e}){Be(this,Gd,new Map),Be(this,e3),He(this,e3,e)}get currentMap(){return b(this,e3).call(this)}getById(e){return b(this,Gd).get(e)}add(e,r){let i=this.currentMap;if(!i)throw new Error("currentMap should exist");let n=i.Paths.add(e,r),a=n.paths.map(l=>l.id.toString()),o=new dA(ya(),n.animation,e,n.paths);for(let l of a)b(this,Gd).set(l,{path:o,entityIds:a});return b(this,Gd).set(o.id,{path:o,entityIds:a}),o}remove(e){var r;let i=b(this,Gd).get(e.id);i&&((r=this.currentMap)==null||r.Paths.remove(i.entityIds),b(this,Gd).delete(e.id),i.entityIds.forEach(n=>b(this,Gd).delete(n)))}removeAll(){let e=[];return b(this,Gd).forEach(({path:r})=>{this.remove(r),e.push(r)}),e}};Gd=new WeakMap,e3=new WeakMap,s(f6e,"Paths");var brt=f6e;N();var wrt=kr(hye(),1);N();var W6="#2266ff",Art="#808080",Srt="#f5f5f5",Mrt={radius:10,color:W6,inactiveColor:Art,heading:{color:W6,opacity:.7},accuracyRing:{color:W6,opacity:.3},timeout:3e4,watchDevicePosition:!0,debug:!1};N();var Ert="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAkklEQVRoge3awQ3AIAxD0VAMYf+F0yUixbL8JshXuLSwIqJCwDc9QBeZEOy9p2doAQDTM7TQ2cg5Z3qGFjpHS2YjDiGDe+/0DC0cwkYpJKdnaIFMkY1kymzEIVQcwsYhbPDem56hhc5GHELGIWwcwsYhbJS+2R1CxSFsdH5iO4SMr97Y6FxPqxytVVV+HcTEIWx+9mcIqHSOm9QAAAAASUVORK5CYII=";N();var Crt=s((t,e,r=0)=>{if(Math.abs(t)>=Math.PI)throw new Error("Sector angle too wide!");let i=r/Math.tan(t/2),n=r/Math.sin(t/2),a=n+e,o=10,l=new sx;l.moveTo(-n*Math.sin(t/2),n*Math.cos(t/2)-i);for(let u=0;u<o;u++)l.lineTo(-(a*Math.sin(t/2-t/o*u)),a*Math.cos(t/2-t/o*u)-i);for(let u=0;u<o;u++)l.lineTo(-(r*Math.sin(Math.PI/-2+Math.PI/o*u)),r*Math.cos(Math.PI/-2+Math.PI/o*u));return new NA(l,{depth:.1,bevelEnabled:!1,UVGenerator:Irt(e)})},"createSectorGeometry"),X6=s((t,e,r)=>{let i=Math.sqrt(Math.pow(t,2)+Math.pow(e,2))/r;return i>1?i=1:i<0&&(i=0),new Jt(0,i)},"generateRadialUV"),Irt=s(t=>({generateTopUV:s((e,r,i,n,a)=>{let o=r[i*3],l=r[i*3+1],u=r[n*3],c=r[n*3+1],p=r[a*3],m=r[a*3+1];return[X6(o,l,t),X6(u,c,t),X6(p,m,t)]},"generateTopUV"),generateSideWallUV:s(()=>[new Jt(0,1),new Jt(0,1),new Jt(0,1),new Jt(0,1)],"generateSideWallUV")}),"radialUVGenerator");function m6e(t,e){if(e==null)return t;let r={latitude:t==null?void 0:t.latitude,longitude:t==null?void 0:t.longitude,accuracy:t==null?void 0:t.accuracy,floor:t==null?void 0:t.floor,heading:t==null?void 0:t.heading};return"latitude"in e&&(r.latitude=(e==null?void 0:e.latitude)==null||e.latitude==="device"?t==null?void 0:t.latitude:e.latitude),"longitude"in e&&(r.longitude=e.longitude==null||e.longitude==="device"?t==null?void 0:t.longitude:e.longitude),"accuracy"in e&&(r.accuracy=e.accuracy==="device"?t==null?void 0:t.accuracy:e.accuracy),"floor"in e&&(r.floor=e.floor==="device"?t==null?void 0:t.floor:e.floor),"heading"in e&&(r.heading=e.heading==="device"?t==null?void 0:t.heading:e.heading),r}s(m6e,"getPositionWithOverrides");function g6e([t,e],[r,i],[n,a]){let o=r-t,l=i-e,u=o**2+l**2;if(u===0)return;let c=((n-t)*o+(a-e)*l)/u,p;c<=0?p=[t,e]:c>=1?p=[r,i]:p=[t+c*o,e+c*l];let m=kB([n,a],p);return{proportion:Math.max(0,Math.min(1,c)),intersection:p,distance:m}}s(g6e,"getPointLineIntersection");function y6e(t,e){if(t==null||t.length<2)return;let r=Number.MAX_SAFE_INTEGER,i,n=0,a=0;for(let o=0;o<t.length-1;o++){let l=t[o],u=t[o+1],c=g6e(l,u,e);c!=null&&c.distance<r&&(r=c.distance,i=c.intersection,n=o,a=c.proportion)}if(i)return{intersection:i,distance:r,segmentIndex:n,proportion:a}}s(y6e,"findBlueDotOnPath");function v6e(t,e){let r=new O_({color:t,opacity:e,transparent:!0,depthTest:!1,depthWrite:!1}),i=.35,n=.35*4,a=Crt(Math.PI/6,n,i);new TB().load(Ert,l=>{r.alphaMap=l,r.needsUpdate=!0});let o=new Pn(a,r);return o.position.z=-.05,o.renderOrder=0,o}s(v6e,"createHeadingCone");function _6e(t,e){let r=new pO(1,1,.05,32),i=new O_({transparent:!0,color:t,opacity:e,depthTest:!1,depthWrite:!1}),n=new Pn(r,i);return n.scale.set(0,0,.05),n.renderOrder=1,n.rotation.x=Math.PI/2,n}s(_6e,"createAccuracyRing");function x6e(t){let e=new pO(.35,.35,.07,32),r=new O_({transparent:!0,color:Srt,depthTest:!1,depthWrite:!1}),i=new Pn(e,r);i.renderOrder=2;let n=new pO(.35*.8,.35*.8,.01,32),a=new O_({transparent:!0,color:t,depthTest:!1,depthWrite:!1}),o=new Pn(n,a);return o.renderOrder=3,i.rotation.x=Math.PI/2,i.position.z=.07/2,o.rotation.x=Math.PI/2,o.position.z=.07,{outerMesh:i,innerMesh:o}}s(x6e,"createBlueDot");var Trt=kr(vWe(),1),e9="blue-dot",_1,Mm,Hc,qc,Em,x1,b1,w1,ls,sc,t3,Cm,r3,i3,n3,a3,t9,Hd,Im,r9,A1,o3,qd,b6e=class extends Wa{constructor(e,r){super(),this.core=e,this.geoJSONApi=r,Be(this,_1,null),$(this,"geometry"),Be(this,Mm),Be(this,Hc),Be(this,qc),Be(this,Em),Be(this,x1),Be(this,b1),Be(this,w1),Be(this,ls,Mrt),Be(this,sc,1),Be(this,t3),Be(this,Cm),$(this,"state","disabled"),$(this,"following",!1),Be(this,r3,s(i=>{var n;return(n=this.geoJSONApi.getMapData())==null?void 0:n.getById("floor",i)},"#getFloorByFloorId")),Be(this,i3,s(i=>{var n;let a;if(i!=null){let o=(n=this.geoJSONApi.currentMap)==null?void 0:n.currentFloorStack.floorObjectsByElevation.get(i);a=o?b(this,r3).call(this,o.id):void 0}return a},"#getFloorByFloorLevel")),Be(this,n3,s(i=>{if(this.state==="hidden"||this.state==="disabled")return;let[n,a,o,l]=i.children;if(b(this,t9).call(this),a.scale.set(b(this,sc),b(this,sc),b(this,sc)),a.position.z=.07/2*b(this,sc),o.scale.set(b(this,sc),b(this,sc),b(this,sc)),o.position.z=.07*b(this,sc),this.state==="active"){o.material.color.set(b(this,ls).color);let u=this.accuracy;u!=null?(n.visible=!0,b(this,b1)&&b(this,b1).stop(),He(this,b1,new pf({scale:n.scale.x}).to({scale:u/2},150).onUpdate(({scale:p})=>{n.scale.set(p,1,p)}).start()),this.core.getTweenGroup().add(b(this,b1))):n.visible=!1;let c=this.heading;if(c!=null){l.visible=!0,b(this,w1)&&b(this,w1).stop();let{start:p,end:m}=NB(l.rotation.z,-Gn.degToRad(c));He(this,w1,new pf({rotation:p}).to({rotation:m},150).onUpdate(({rotation:y})=>{l.rotation.z=y}).start()),this.core.getTweenGroup().add(b(this,w1)),l.scale.set(b(this,sc),b(this,sc),1)}else l.visible=!1}else this.state==="inactive"&&(o.material.color.set(b(this,ls).inactiveColor),l.visible=!1,n.visible=!1)},"#updateGeometryPerFrame")),Be(this,a3,s(i=>{var n,a;let o;try{o=Rrt.parse(m6e(i,b(this,Hc)))}catch(c){b(this,Hd).call(this,"error"),Vt.error("BlueDot: Position parse failed",c instanceof xt.ZodError?c.message:String(c)),this.publish("error");return}b(this,ls).debug&&Vt.log("BlueDot: Parsed position",o),He(this,qc,o),b(this,Hd).call(this,"position-update"),b(this,Em)&&clearTimeout(b(this,Em)),typeof b(this,ls).timeout=="number"&&b(this,ls).timeout<1/0&&He(this,Em,setTimeout(()=>{b(this,ls).debug&&Vt.log("BlueDot: Position timed out after ".concat(b(this,ls).timeout,"ms")),b(this,Hd).call(this,"timeout"),this.core.render()},b(this,ls).timeout)),(a=this.geoJSONApi.getMapDataInternal())==null||a.Analytics.updateState({userPosition:{bluedotTimestamp:Date.now(),latitude:o.latitude,longitude:o.longitude,floorLevel:(n=o.floor)==null?void 0:n.elevation,accuracy:o.accuracy}});let l=o.floor!=null?o.floor.id:this.geoJSONApi.currentFloor.id||"outdoors-container",u=[o.longitude,o.latitude];if(!this.geometry)this.geometry=this.core.addCustomGeometry(e9,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:u}},{setup:s(c=>{let p=_6e(b(this,ls).accuracyRing.color,b(this,ls).accuracyRing.opacity),{outerMesh:m,innerMesh:y}=x6e(b(this,ls).color),v=v6e(b(this,ls).heading.color,b(this,ls).heading.opacity);c.add(p),p.visible=!1,c.add(m),c.add(y),c.add(v),v.visible=!1,b(this,n3).call(this,c)},"setup"),update:b(this,n3)},{visible:!0,interactive:!0},l);else{let c=this.core.getState(this.geometry);u=[c.position[0],c.position[1]]}b(this,x1)&&b(this,x1).stop(),He(this,x1,new pf(u).to([o.longitude,o.latitude],1e3).easing(Ol.Cubic.Out).onUpdate(c=>{if(this.geometry){let p={position:[c[0],c[1]]};p.parent=l,this.core.setState(this.geometry,p)}}).start()),this.core.getTweenGroup().add(b(this,x1)),this.publish("position-update",{floor:this.floor,heading:this.heading,accuracy:this.accuracy,coordinate:this.coordinate}),this.core.render()},"#setPosition")),$(this,"onPositionUpdate",s(i=>{var n,a,o,l,u;if(this.state!=="disabled"){try{Drt.parse(i)}catch(c){b(this,Hd).call(this,"error"),Vt.error("BlueDot: Browser sent invalid position",c instanceof xt.ZodError?c.message:String(c)),this.publish("error");return}He(this,Mm,{latitude:(n=i.coords)==null?void 0:n.latitude,longitude:(a=i.coords)==null?void 0:a.longitude,accuracy:(o=i.coords)==null?void 0:o.accuracy,heading:(l=i.coords)==null?void 0:l.heading,floor:b(this,i3).call(this,(u=i.coords)==null?void 0:u.floorLevel)}),b(this,a3).call(this,b(this,Mm))}},"onPositionUpdate")),$(this,"onPositionError",s(i=>{var n;switch(b(this,Hd).call(this,"error"),i.code){case i.PERMISSION_DENIED:Vt.error("Geolocation permission denied by the user.",i),(n=this.geoJSONApi.getMapDataInternal())==null||n.Analytics.sendWatchPositionDenied();break;case i.POSITION_UNAVAILABLE:Vt.error("Geolocation position unavailable.",i);break;case i.TIMEOUT:Vt.error("Geolocation request timed out.",i);break;default:Vt.error("An unknown geolocation error occurred.",i);break}this.publish("error",i)},"onPositionError")),Be(this,t9,s(()=>{var i;let n=Math.round(this.core.camera.zoomLevel*1e5);if(n!==b(this,t3)){He(this,t3,n);let a=(i=this.core.getMetresPerPixel())!=null?i:1;He(this,sc,Math.max(b(this,ls).radius/(.35/a),1))}},"#updateScale")),Be(this,Hd,s(i=>{let n=Lrt[this.state].actions[i];if(n){switch(b(this,ls).debug&&Vt.log("BlueDot: Transitioning from ".concat(this.state," to ").concat(n," using ").concat(i)),n){case"hidden":case"disabled":this.geometry&&this.core.setState(this.geometry,{visible:!1});break;case"active":this.geometry&&this.core.setState(this.geometry,{visible:!0});break}this.state!==n&&(this.publish("state-change",{state:n,action:i}),this.state=n)}else Vt.warn("BlueDot: Invalid state transition from ".concat(this.state," to ").concat(n," using ").concat(i))},"#transitionAction")),Be(this,Im),Be(this,r9,s(()=>{if(b(this,Im)==null&&this.geoJSONApi.Navigation.activeDirections!=null){let i=(Array.isArray(this.geoJSONApi.Navigation.activeDirections)?this.geoJSONApi.Navigation.activeDirections.flatMap(n=>n.coordinates):this.geoJSONApi.Navigation.activeDirections.coordinates).filter(n=>n.floorId===this.geoJSONApi.currentFloor.id);He(this,Im,(0,Trt.default)(i.map(n=>({x:n.longitude,y:n.latitude})),1e-5).map(n=>[n.x,n.y]))}return b(this,Im)},"#getSimplifiedDirections")),Be(this,A1,s(()=>{this.core.camera.isAnimating&&this.core.camera.cancelAnimation(),b(this,qd)&&(this.off("position-update",b(this,qd)),He(this,qd,void 0)),this.following=!1,He(this,Im,void 0),this.core.off("user-interaction-start",b(this,A1)),this.geoJSONApi.currentMap.off("navigation-active-path-change",b(this,o3)),this.publish("follow-change",{following:!1})},"#cancelFollow")),Be(this,o3,s(()=>{He(this,Im,void 0)},"#pathChangeHandler")),Be(this,qd),$(this,"follow",s((i,n)=>{var a,o,l,u;if(i===!1){b(this,A1).call(this);return}i!=="position-only"&&(n==null?void 0:n.bearing)!=null&&Vt.warn("BlueDot: Camera bearing option will be ignored in follow mode '".concat(i,"'. To control the bearing manually, use mode 'position-only'."));let c={zoomLevel:(a=n==null?void 0:n.zoomLevel)!=null?a:21,bearing:i==="position-only"?n==null?void 0:n.bearing:void 0,pitch:(o=n==null?void 0:n.pitch)!=null?o:45,duration:(l=n==null?void 0:n.duration)!=null?l:1e3,easing:(u=n==null?void 0:n.easing)!=null?u:"ease-in-out"};this.following?b(this,qd)&&this.off("position-update",b(this,qd)):(this.following=!0,this.core.on("user-interaction-start",b(this,A1)),this.geoJSONApi.currentMap.on("navigation-active-path-change",b(this,o3))),He(this,qd,p=>{let{coordinate:m,heading:y,floor:v}=p;if(c.center=[m.longitude,m.latitude],v!=null&&v.id!==this.geoJSONApi.currentFloor.id&&(this.geoJSONApi.currentMap.setFloor(v.id),He(this,Im,void 0)),i==="position-and-heading")c.bearing=y??void 0;else if(i==="position-and-path-direction"){let w=b(this,r9).call(this);if(w!=null){let E=y6e(w,[m.longitude,m.latitude]);if(E!=null){let M=w[E.segmentIndex],I=w[E.segmentIndex+1];c.bearing=Vme(M,I)}}}this.core.camera.animateTo(c)}),this.on("position-update",b(this,qd)),this.publish("follow-change",{following:!0,mode:i})},"follow"))}get heading(){var e;return(e=b(this,qc))==null?void 0:e.heading}get accuracy(){var e;return(e=b(this,qc))==null?void 0:e.accuracy}get coordinate(){var e,r;if(b(this,qc)!=null)return(b(this,Cm)==null||((e=this.floor)==null?void 0:e.id)!==b(this,Cm).floorId||b(this,qc).latitude!==b(this,Cm).latitude||b(this,qc).longitude!==b(this,Cm).longitude)&&He(this,Cm,new On(b(this,qc).latitude,b(this,qc).longitude,(r=this.floor)==null?void 0:r.id)),b(this,Cm)}get floor(){var e;return(e=b(this,qc))==null?void 0:e.floor}enable(e){He(this,ls,(0,wrt.default)({},e,b(this,ls))),b(this,Hd).call(this,"enable"),this.watchDevicePosition(b(this,ls).watchDevicePosition)}disable(){this.geometry&&(this.core.remove(this.geometry.id),this.geometry=void 0),b(this,Em)&&(clearTimeout(b(this,Em)),He(this,Em,void 0)),this.following&&b(this,A1).call(this),this.watchDevicePosition(!1),He(this,qc,void 0),He(this,Hc,void 0),b(this,Hd).call(this,"disable")}watchDevicePosition(e){if(b(this,_1)&&(navigator.geolocation.clearWatch(b(this,_1)),He(this,_1,null)),b(this,Mm)&&He(this,Mm,void 0),e){if(this.state==="disabled"){Vt.warn("BlueDot must be enabled before watching browser position.");return}He(this,_1,navigator.geolocation.watchPosition(this.onPositionUpdate,this.onPositionError,{enableHighAccuracy:!0}))}}update(e){var r,i;e==null?He(this,Hc,void 0):"coords"in e?He(this,Hc,Object.assign({},b(this,Hc),{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,heading:e.coords.heading,floor:b(this,i3).call(this,e.coords.floorLevel)})):(He(this,Hc,Object.assign({},b(this,Hc),e)),"floorOrFloorId"in e&&(b(this,Hc).floor=typeof e.floorOrFloorId=="string"&&e.floorOrFloorId!=="device"?b(this,r3).call(this,e.floorOrFloorId):e.floorOrFloorId)),(((r=b(this,Hc))==null?void 0:r.latitude)!=null&&((i=b(this,Hc))==null?void 0:i.longitude)!=null||b(this,Mm)!=null)&&b(this,a3).call(this,b(this,Mm))}};_1=new WeakMap,Mm=new WeakMap,Hc=new WeakMap,qc=new WeakMap,Em=new WeakMap,x1=new WeakMap,b1=new WeakMap,w1=new WeakMap,ls=new WeakMap,sc=new WeakMap,t3=new WeakMap,Cm=new WeakMap,r3=new WeakMap,i3=new WeakMap,n3=new WeakMap,a3=new WeakMap,t9=new WeakMap,Hd=new WeakMap,Im=new WeakMap,r9=new WeakMap,A1=new WeakMap,o3=new WeakMap,qd=new WeakMap,s(b6e,"BlueDot");var Prt=b6e,Lrt={hidden:{actions:{enable:"hidden",error:"hidden","position-update":"active",disable:"disabled",timeout:"hidden"}},active:{actions:{enable:"active",disable:"disabled","position-update":"active",error:"inactive",timeout:"inactive"}},inactive:{actions:{enable:"inactive",disable:"disabled","position-update":"active",error:"inactive",timeout:"inactive"}},disabled:{actions:{enable:"hidden",disable:"disabled"}}},Drt=xt.object({coords:xt.object({latitude:xt.number(),longitude:xt.number(),accuracy:xt.number(),altitude:xt.number().optional().nullable(),altitudeAccuracy:xt.number().optional().nullable(),heading:xt.number().optional().nullable(),speed:xt.number().optional().nullable(),floorLevel:xt.number().optional().nullable()}),timestamp:xt.number()}),Rrt=xt.object({latitude:xt.number(),longitude:xt.number(),floor:xt.custom().optional(),accuracy:xt.number().optional(),heading:xt.number().optional().nullable()});N();var Tm,s3,w6e=class{constructor({currentMapGetter:e}){Be(this,Tm,new Map),Be(this,s3),He(this,s3,e)}get currentMap(){return b(this,s3).call(this)}getById(e){return b(this,Tm).get(e)}add(e,r,i){let n=this.currentMap;if(!n)throw new Error("currentMap should exist");let a=n.Shapes.add(e,r||{},{floorId:i==null?void 0:i.id}),o=new $N(a);return b(this,Tm).set(o.id,o),o}remove(e){var r;b(this,Tm).get(e.id)&&((r=this.currentMap)==null||r.Shapes.remove(e),b(this,Tm).delete(e.id.toString()))}removeAll(){let e=[];return b(this,Tm).forEach(r=>{this.remove(r),e.push(r.id),b(this,Tm).delete(r.id.toString())}),e}};Tm=new WeakMap,s3=new WeakMap,s(w6e,"Shapes");var Ort=w6e;N();var l3,A6e=class{constructor({currentMapGetter:e}){Be(this,l3),He(this,l3,e)}get currentMap(){return b(this,l3).call(this)}setFromStyleCollection(e){var r,i,n,a;for(let o in e)for(let l of((r=this.currentMap)==null?void 0:r.floors)||[]){if(e[o]==null||!l.layers.has(il))continue;let u=l.layers.get(il);if(u!=null&&u.layers.has(o)&&"color"in e[o]){let m=u.layers.get(o);m&&((i=this.currentMap)==null||i.renderer.setState(m,{color:e[o].color}))}if(u&&o===JP&&!(F_ in e)){let m=u.layers.get(F_);m&&"color"in e[o]&&((n=this.currentMap)==null||n.renderer.setState(m,{color:e[o].color}))}if(!l.layers.has(pw))continue;let c=l.layers.get(pw),p=l.facadesByStyleId.get(o);if(p&&p.length>0)for(let m of p){let y=c.layers.get("".concat(m,"-").concat(o));y&&"color"in e[o]&&((a=this.currentMap)==null||a.renderer.setState(y,{color:e[o].color}))}}}};l3=new WeakMap,s(A6e,"Style");var krt=A6e;N();var Z6={opacity:1},Xl,u3,c3,Ly,Pm,Q2,i9,S6e,M6e=class{constructor(e,r){Be(this,Q2),Be(this,Xl),Be(this,u3,[]),Be(this,c3,{opacity:"initial"}),Be(this,Ly,{opacity:new Map}),Be(this,Pm,new Set),He(this,Xl,e),He(this,u3,r||[]);let i=b(this,Xl).map;i&&i.on("idle",()=>{b(this,Ly).opacity.size||dr(this,Q2,i9).call(this,i)})}setStyle(e){var r,i;if(b(this,Xl).map){(r=b(this,Xl).map)==null||r.setStyle(e),b(this,Pm).size&&(b(this,Pm).clear(),this.hide()),dr(this,Q2,S6e).call(this),dr(this,Q2,i9).call(this,b(this,Xl).map),this.setOpacity(b(this,c3).opacity),(i=b(this,Xl).map)==null||i.moveLayer(fge);for(let[n,a,o]of b(this,u3)||[])b(this,Xl).hideOutdoorLayersIntersectingPolygons(n,a,o)}}get map(){return b(this,Xl).map}get enabled(){return!!b(this,Xl).map}get visible(){return b(this,Pm).size===0}show(){let e=b(this,Xl).map;if(!e)return;let r=e.getStyle().layers;r&&(r.forEach(i=>{b(this,Pm).has(i.id)&&e.setLayoutProperty(i.id,"visibility","visible")}),b(this,Pm).clear())}hide(e=[]){let r=b(this,Xl).map;if(!r)return;let i=r.getStyle().layers;i&&i.forEach(n=>{let a=r.getLayoutProperty(n.id,"visibility");!e.includes(n.id)&&a!=="none"&&(r.setLayoutProperty(n.id,"visibility","none"),b(this,Pm).add(n.id))})}setOpacity(e,r=[]){var i,n;let a=b(this,Xl).map;if(!a)return;let o=(n=(i=b(this,Xl).map)==null?void 0:i.getStyle())==null?void 0:n.layers;o&&a.once("idle",()=>{o.forEach(l=>{let u=a.getLayoutProperty(l.id,"visibility");if(!r.includes(l.id)&&u!=="none")try{let c=b(this,Ly).opacity.get(l.id);c!==void 0&&(l.id==="background"||(l.type==="symbol"?(a.setPaintProperty(l.id,"icon-opacity",e==="initial"?c[0]:e),a.setPaintProperty(l.id,"text-opacity",e==="initial"?c[1]:e)):a.setPaintProperty(l.id,"".concat(l.type,"-opacity"),e==="initial"?c[0]:e)),b(this,c3).opacity=e)}catch(c){Vt.warn("Error setting opacity:",c)}})})}};Xl=new WeakMap,u3=new WeakMap,c3=new WeakMap,Ly=new WeakMap,Pm=new WeakMap,Q2=new WeakSet,i9=s(function(t){let e=t.getStyle().layers;e&&e.forEach(r=>{var i,n,a;t.getLayoutProperty(r.id,"visibility")!=="none"&&(r.id==="background"||(r.type==="symbol"?b(this,Ly).opacity.set(r.id,[(i=t.getPaintProperty(r.id,"icon-opacity"))!=null?i:Z6.opacity,(n=t.getPaintProperty(r.id,"text-opacity"))!=null?n:Z6.opacity]):b(this,Ly).opacity.set(r.id,[(a=t.getPaintProperty(r.id,"".concat(r.type,"-opacity")))!=null?a:Z6.opacity,void 0])))})},"#setInitialStyle"),S6e=s(function(){Object.values(b(this,Ly)).forEach(t=>t.clear())},"#clearInitialStyle"),s(M6e,"Outdoor");var Nrt=M6e;N();function E6e(){F5e(!1)}s(E6e,"disableText3DWorker");var Lm,Dm,sy,C6e=class{constructor({currentMapGetter:e}){Be(this,Lm),Be(this,Dm,new Map),Be(this,sy,new Map),He(this,Lm,e)}labelAll(e={}){var r,i;let n=[],a=new Set;return(i=(r=b(this,Lm).call(this))==null?void 0:r.Text3D.labelAll(e))==null||i.forEach(({textInfo:o,target:l})=>{let u=o.id.toString(),c=b(this,sy).get(u);if(c){a.has(u)||n.push(c.text3DView),a.add(u);return}a.add(u);let p=new HN(u,l);b(this,Dm).set(p.id,{targetId:l.id,text3d:u,text3DView:p}),b(this,sy).set(u,{text3DView:p}),n.push(p)}),n}label(e,r,i={}){var n;if(b(this,Lm).call(this))if(Zp.is(e)){let a=(n=b(this,Lm).call(this))==null?void 0:n.Text3D.label(e,r,i);if(!a)return;let o=a.textInfo.id.toString(),l=b(this,sy).get(o);if(l)return l.text3DView;let u=new HN(o,a.target);return b(this,Dm).set(u.id,{targetId:a.target.id,text3d:o,text3DView:u}),b(this,sy).set(o,{text3DView:u}),u}else throw new Error("Non-space target is not supported")}remove(e){var r;let i=typeof e=="string"?e:e.id,n=b(this,Dm).get(i);n&&((r=b(this,Lm).call(this))==null||r.Text3D.remove(n.text3d),b(this,Dm).delete(i),b(this,sy).delete(n.text3d))}removeAll(){b(this,Dm).forEach(e=>{var r;(r=b(this,Lm).call(this))==null||r.Text3D.remove(e.text3d)}),b(this,Dm).clear()}};Lm=new WeakMap,Dm=new WeakMap,sy=new WeakMap,s(C6e,"Text3D");var Frt=C6e,SE=.05,I6e=class{constructor(e,r){$(this,"core"),$(this,"mapObjects",[]),$(this,"id"),$(this,"mapDataExternal",{}),$(this,"mapsByFloorId",{}),$(this,"mapData"),$(this,"currentMap"),$(this,"hiddenOutdoorGeometries",[]),$(this,"lastFacadeIntersected"),$(this,"manualFloorVisibility",!1),$(this,"mapView"),$(this,"Camera"),$(this,"Labels"),$(this,"Text3D"),$(this,"Markers"),$(this,"Models"),$(this,"Paths"),$(this,"Exporter"),$(this,"Navigation"),$(this,"Outdoor"),$(this,"BlueDot"),$(this,"Shapes"),$(this,"Style"),$(this,"Images"),$(this,"update",s(()=>{this.core.render()},"update")),this.core=e,this.mapView=r,this.Camera=new hrt(this),this.id=this.core.addGroupContainer("root").id.toString();let i=new UX("outdoors-container",void 0,void 0,this);this.mapObjects.push(i),this.currentMap=i,this.core.on("pre-render",()=>{this.mapView.publish("pre-render")}),this.core.on("post-render",()=>{this.mapView.publish("post-render")}),this.core.on("resize",()=>{this.mapView.publish("resize")}),this.core.on("geometry-in-focus",u=>{this.mapView.publish("facades-in-view-change",{facades:u.map(c=>{var p;return(p=this.getMapDataInternal())==null?void 0:p.facadesById[c]}).filter(c=>c!=null)})});let n=new Ztt(this.Camera);this.core.on("camera-change",()=>{this.mapView.publish("camera-change",n)});let a=s(u=>c=>{var p,m,y;let v=[],w=[],E=[],M=[];c.labels.forEach(U=>{let z=this.Labels.getById(U.toString());z&&v.push(z.label)}),c.markers.forEach(U=>{let z=this.Markers.getById(U.toString())||this.Navigation.getMarkerById(U.toString());z&&w.push(z.marker)}),c.models.forEach(U=>{let z=this.Models.getById(U.toString());z&&E.push(z.model)}),c.paths.forEach(U=>{let z=this.Paths.getById(U.toString())||this.Navigation.getPathById(U.toString());z&&M.push(z.path)});let I=c.geometry.includes(e9),P=c.geometry.filter(U=>U!==e9)[0],C;P&&(C=(p=this.getMapDataInternal())==null?void 0:p.getById("space",P)),C||(C=(m=this.getMapDataInternal())==null?void 0:m.getById("object",P));let T=c.containers.reduce((U,z)=>{var q;let W=(q=this.getMapDataInternal())==null?void 0:q.getById("floor",z);return W&&jp.is(W)&&U.push(W),U},[]),O,F=0;if(T.length>0){O=T[0].id;let U=this.core.getState(O);F=c.coordinate[2]?c.coordinate[2]-U.altitude:F}let k;this.lastFacadeIntersected&&this.lastFacadeIntersected.spaces.forEach(U=>{this.core.setState(U.id,{hovered:!1})}),C&&Zp.is(C)&&(k=(y=this.getMapDataInternal())==null?void 0:y.facadesBySpaceId[P],k&&k.spaces.forEach(U=>{this.core.setState(U.id,{hovered:!0})})),this.lastFacadeIntersected=k;let B={coordinate:new On({latitude:c.coordinate[1],longitude:c.coordinate[0],floorId:O,verticalOffset:F}),spaces:C&&Zp.is(C)?[C]:[],objects:C&&Ky.is(C)?[C]:[],markers:w,labels:v,models:E,paths:M,blueDot:I,floors:T,facades:k?[k]:[]};"pointerEvent"in c&&(B.pointerEvent=c.pointerEvent),this.mapView.publish(u,B)},"createHandler");this.core.on("hover",a("hover")),this.core.on("click",a("click")),this.core.on("user-interaction-start",()=>{this.mapView.publish("user-interaction-start")}),this.core.on("user-interaction-end",()=>{this.mapView.publish("user-interaction-end")});let o={currentMapGetter:s(()=>this.currentMap,"currentMapGetter")};this.Markers=new vrt(o),this.Models=new xrt(o),this.Labels=new drt(o),this.Text3D=new Frt(o),this.Exporter=new prt(o),this.Paths=new brt(o),this.Navigation=new ort(this.core,this,o.currentMapGetter),this.BlueDot=new Prt(this.core,this),this.BlueDot.on("position-update",u=>{this.mapView.publish("blue-dot-position-update",u)}),this.BlueDot.on("state-change",u=>{this.mapView.publish("blue-dot-state-change",u)}),this.BlueDot.on("error",u=>{this.mapView.publish("blue-dot-error",u)}),this.BlueDot.on("follow-change",u=>{this.mapView.publish("blue-dot-follow-change",u)}),this.Outdoor=new Nrt(this.core,this.hiddenOutdoorGeometries),this.Outdoor.enabled&&(this.core.on("outdoor-view-loaded",()=>{this.mapView.publish("outdoor-view-loaded")}),this.core.on("outdoor-style-loaded",()=>{this.mapView.publish("outdoor-style-loaded")})),this.Images=new _rt(o),this.Shapes=new Ort(o),this.Style=new krt(o);let l=new crt(r,this.mapDataExternal);this.auto=l.auto}get StackedMaps(){return this.currentMap.StackedMaps}preloadFloors(e){e.forEach(r=>{r instanceof jp&&this.core.setState(r.id,{preloadGeometry:!0})})}updateState(e,r){if(e==="interior-walls"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(il);if(a){let o=a.layers.get(JP);o&&this.core.setState(o,c9(r,this.core.getState(o)))}});return}else if(e==="exterior-walls"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(il);if(a){let o=a.layers.get(F_);o&&this.core.setState(o,c9(r,this.core.getState(o)))}});return}else if(e==="interior-doors"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(il);if(a){let o=a.layers.get(yz);o&&this.core.setState(o,d3(r,this.core.getState(o)))}});return}else if(e==="exterior-doors"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(il);if(a){let o=a.layers.get(vz);o&&this.core.setState(o,d3(r,this.core.getState(o)))}});return}let i=typeof e=="string"?this.getMapDataObject(e):e;if(i){if(PN.is(i))return this.core.setState(i.id,j6e(vt(Ee({},r),{type:"label"}),this.core.getState(i.id)));if(wj.is(i))return this.core.setState(i.id,$6e(vt(Ee({},r),{type:"marker"}),this.core.getState(i.id)));if((Zp.is(i)||Ky.is(i))&&this.core.setState(i.id,G6e(vt(Ee({},r),{type:"geometry"}),this.core.getState(i.id))),HA.is(i)&&this.core.setState(i.id,d3(vt(Ee({},r),{type:"doors"}),this.core.getState(i.id))),$N.is(i)&&this.core.setState(i.id,Zc(r,["altitude","color","opacity"])),ULe.is(i)){let n=r,{position:a,scale:o}=n,l=Nh(n,["position","scale"]);a&&(l.position=[a.longitude,a.latitude,a.verticalOffset]),o!=null&&(Array.isArray(o)?l.scale=o:l.scale=[o,o,o]),a&&i.updateTarget(a),this.core.setState(i.id,l)}if(jp.is(i)){let n=this.currentMap.floorsById.get(i.id);if(n==null)return;this.core.setState(i.id,Zc(r,["visible","altitude"]));let a=n.layers.get(il);a!=null&&"geometry"in r&&this.core.setState(a.containerId,Zc(r.geometry,["opacity","visible"]));let o=n.layers.get(B_);o!=null&&"labels"in r&&"enabled"in r.labels&&typeof r.labels.enabled=="boolean"&&o.setVisible(r.labels.enabled);let l=n.layers.get(By);l!=null&&"markers"in r&&"enabled"in r.markers&&typeof r.markers.enabled=="boolean"&&l.setVisible(r.markers.enabled);let u=n.layers.get(bk);u!=null&&"footprint"in r&&this.core.setState(u.containerId,Zc(r.footprint,["visible","height","opacity","side","color","altitude"]));let c=n.layers.get(pT);c!=null&&"occlusion"in r&&"enabled"in r.occlusion&&typeof r.occlusion.enabled=="boolean"&&c.setVisible(r.occlusion.enabled)}if(tx.is(i)){let n=this.core.getState(i.id);for(let a of n.children)a.type==="group-container"&&this.core.setState(a.id,Zc(r,["opacity","visible"]))}if(HN.is(i)&&this.core.setState(i.id,Zc(r,u4e)),dA.is(i))for(let n of i.segments)this.core.setState(n.id,Zc(r,["color","nearRadius","farRadius","visible","completeFraction"]));VLe.is(i)&&this.core.setState(i.id,Zc(r,["color"]))}}getMapDataObject(e){var r;return(r=this.getMapDataInternal())==null?void 0:r.getMapDataById(e)}getMapDataInternal(){if(this.mapData)return OT(this.mapData)}getMapData(){return this.mapData}addMap(e,r){return new Promise(i=>{var n,a,o,l;let u;try{u=OT(e)}catch(E){Vt.error("Error adding map",E),i(e);return}this.mapDataExternal[e.mapName]=e;let{mvf:c}=u,p=c["manifest.geojson"].features[0].geometry.coordinates;this.core.mode!=="outdoors-overlay"&&this.Camera.set({center:new On(p[1],p[0])});let m=c["manifest.geojson"].features[0].properties.name,y=new UX("mapObject-".concat(m),u,r,this),v=this.core.getBoundingArea(y.currentFloor.id);v==null&&Vt.error("Could not determine bounding box for map:",y.currentFloor.id);let w=(a=(n=r==null?void 0:r.outdoorView)==null?void 0:n.layersHiddenByGeometry)!=null?a:[];if(w.length>0){let E,M=[];for(let I of y.floorStacksById.values())if(I.defaultFloor.footprint&&I.defaultFloor.footprint.geometry!=null&&((o=I.defaultFloor.footprint.geometry)==null?void 0:o.coordinates.length)>0){let P=I.defaultFloor.footprint,C=Mj(P);E==null?E=C:X6e(E,C),M.push(P)}M.length>0&&E!=null&&(this.core.hideOutdoorLayersIntersectingPolygons(E,M,w),this.hiddenOutdoorGeometries.push([E,M,w]))}if(this.mapObjects.push(y),u.getMVFFeatureByType("floor").forEach(E=>{this.mapsByFloorId[E.id]=y}),y.on("navigation-connection-click",E=>{this.mapView.publish("navigation-connection-click",E)}),y.on("navigation-active-path-change",E=>{this.mapView.publish("navigation-active-path-change",E)}),y.StackedMaps.on("stacked-maps-state-change",({state:E})=>{this.mapView.publish("stacked-maps-state-change",{state:E})}),y.on("floor-change-start",E=>{var M,I,P,C;this.mapView.publish("floor-change-start",{reason:E.reason,floor:(I=(M=this.getMapDataInternal())==null?void 0:M.getById("floor",E.floorId))!=null?I:this.currentFloor,previousFloor:(C=(P=this.getMapDataInternal())==null?void 0:P.getById("floor",E.previousFloorId))!=null?C:this.currentFloor})}),y.on("floor-change",E=>{var M,I;this.mapView.publish("floor-change",{reason:E.reason,floor:this.currentFloor,previousFloor:(I=(M=this.getMapDataInternal())==null?void 0:M.getById("floor",E.previousFloorId))!=null?I:this.currentFloor})}),this.currentMap=y,this.mapData=e,(r==null?void 0:r.zoomLevel)!=null)this.core.camera.setZoomLevel(r.zoomLevel),i(e);else if(this.core.mode!=="outdoors-overlay"&&v){let E=(l=r==null?void 0:r.screenOffsets)!=null?l:{top:SE*this.core.canvasHeight,left:SE*this.core.canvasWidth,right:SE*this.core.canvasWidth,bottom:SE*this.core.canvasHeight};this.core.camera.focusOn(v,{duration:GWe,padding:E}).then(()=>{i(e)})}else i(e)})}setFloor(e,r){return this.currentMap.setFloor(aT(e),r)}setFloorStack(e,r){return this.currentMap.setFloorStack(aT(e),r)}updateWatermark(e){this.core.updateWatermark(e)}get currentFloorStack(){var e;let r=this.currentMap.currentFloorStack.id;if(!r)throw new Oh("Missing currentFloorStack.");let i=(e=this.mapData)==null?void 0:e.getById("floor-stack",r);if(!i)throw new Oh("FloorStack was not found in map data.");return i}get currentFloor(){var e;let r=this.currentMap.currentFloor.id;if(!r)throw new Oh("Missing currentFloor object from GeoJsonApi");let i=(e=this.mapData)==null?void 0:e.getById("floor",r);if(!i)throw new Oh("Missing currentFloor");return i}getState(e){var r,i,n,a,o,l,u,c,p,m,y,v,w,E,M,I,P,C,T,O;typeof e=="object"&&dA.is(e)&&Vt.warn("Cannot get state of a Path directly. Use getState() on individual segments within Path.segments[] instead.");let F=ait(e,this),k=this.core.getState(F);if(k)if(["interior-walls","exterior-walls"].includes(e)){let{color:B,topColor:U,texture:z,topTexture:q,visible:W,height:J,opacity:V}=k;return{type:"walls",visible:W,color:B,topColor:U,texture:z?{url:z}:void 0,topTexture:q?{url:q}:void 0,height:J,opacity:V}}else if(["interior-doors","exterior-doors"].includes(e)){let{color:B,topColor:U,texture:z,topTexture:q,visible:W,opacity:J}=k;return{type:"doors",visible:W,color:B,topColor:U,opacity:J,texture:z?{url:z}:void 0,topTexture:q?{url:q}:void 0}}else{if(k.type==="geometry")return{type:"geometry",interactive:k.interactive,hoverColor:k.hoverColor,color:k.color,visible:k.visible,opacity:k.opacity,height:k.height,texture:k.texture?{url:k.texture}:void 0,topTexture:k.topTexture?{url:k.topTexture}:void 0,flipImageToFaceCamera:k.flipImageToFaceCamera,topColor:k.topColor};if(k.type==="label"&&k.options.appearance&&k.options.rank!==void 0&&k.options.interactive!==void 0)return{type:"label",text:k.text,appearance:k.options.appearance,rank:k.options.rank,enabled:k.enabled,interactive:k.options.interactive};if(k.type==="marker"&&((r=k.options)==null?void 0:r.rank)!==void 0&&k.options.interactive!==void 0){let B=typeof k.parent=="object"?k.parent.id:k.parent,U=this.Markers.getById(k.id.toString()),z=U!=null&&U.marker.target?U==null?void 0:U.marker.target.anchorTarget:void 0;return z==null&&(z=new On(k.position[1],k.position[0],B.toString())),{type:"marker",rank:k.options.rank,interactive:k.options.interactive,enabled:k.enabled,element:k.element,anchor:k.anchor,zIndex:k.options.zIndex,dynamicResize:k.dynamicResize,lowPriorityPin:k.options.lowPriorityPin}}else if(k.type==="model"){let B=k!=null&&typeof k.parent=="object"?k.parent.id.toString():(i=k.parent)==null?void 0:i.toString();return delete k.parent,vt(Ee({},k),{position:new On({latitude:k.position[1],longitude:k.position[0],verticalOffset:k.position[2],floorId:B}),type:"model"})}else{if(k.type==="image")return{type:"image"};if(k.type==="text3d")return k;if(k.type==="geometry-group"&&e&&typeof e!="string"&&$N.is(e)){let[B]=k.children;if(B.type!=="geometry")throw new Error("expect shape first child to be geometry");return{type:"Shape",altitude:(n=k.altitude)!=null?n:0,visible:k.visible,color:k.color,height:B.height,opacity:k.opacity}}else{if(k.type==="path")return{type:"path",color:k.color,visible:k.visible,nearRadius:k.nearRadius,farRadius:k.farRadius,completeFraction:k.completeFraction};if(k.type==="group-container"&&typeof e!="string"&&jp.is(e)){let B=(a=this.currentMap.floorsById.get(e.id))==null?void 0:a.layers.get(il),U=B?this.core.getState(B.containerId):void 0,z=(o=this.currentMap.floorsById.get(e.id))==null?void 0:o.layers.get(B_),q=(l=this.currentMap.floorsById.get(e.id))==null?void 0:l.layers.get(By),W=(u=this.currentMap.floorsById.get(e.id))==null?void 0:u.layers.get(bk),J=W?this.core.getState(W.containerId):void 0,V=(c=this.currentMap.floorsById.get(e.id))==null?void 0:c.layers.get(pT),oe=V?this.core.getState(V.containerId):void 0;return{type:"floor",geometry:{opacity:(p=U==null?void 0:U.opacity)!=null?p:0,visible:(m=U==null?void 0:U.visible)!=null?m:!0},labels:{enabled:(y=z==null?void 0:z.visible)!=null?y:!1},markers:{enabled:(v=q==null?void 0:q.visible)!=null?v:!1},footprint:{altitude:(w=J==null?void 0:J.altitude)!=null?w:0,visible:(E=J==null?void 0:J.visible)!=null?E:!1,height:(M=J==null?void 0:J.height)!=null?M:0,opacity:(I=J==null?void 0:J.opacity)!=null?I:0,side:(P=J==null?void 0:J.side)!=null?P:"double",color:(C=J==null?void 0:J.color)!=null?C:"white"},occlusion:{enabled:(T=oe==null?void 0:oe.visible)!=null?T:!1},visible:k.visible,altitude:(O=k.altitude)!=null?O:0}}else if(k.type==="group-container"&&k.children.length>0&&typeof e!="string"&&tx.is(e)){let B=this.core.getState(k.children[0].id);return{type:"facade",opacity:B.opacity,visible:B.visible}}}}}}setHoverColor(e){this.core.setState({hoverColor:e})}getHoverColor(){let e=this.core.getState();return(e==null?void 0:e.type)==="map-view"?e.hoverColor:void 0}createCoordinateFromScreenCoordinate(e,r,i){var n;if(i!=null){let c=this.core.projectScreenXYToCoordinate(e,r,!0);return c?new On(c.coordinate[1],c.coordinate[0],i.id):void 0}let a=this.core.projectScreenXYToCoordinate(e,r);if(a==null||a.coordinate==null)return;let{coordinate:o,groupContainers:l}=a,u=(n=l==null?void 0:l.find(c=>{let p=c.userData.entityId.toString();return p.includes("f_")||p.includes("m_")}))==null?void 0:n.userData.entityId.toString();return new On(o[1],o[0],u)}getScreenCoordinateFromCoordinate(e){var r,i,n;let a=0;if(e.floorId!=null){let o=(r=this.mapData)==null?void 0:r.getById("floor",e.floorId);o!=null&&(a=(n=(i=this.getState(o))==null?void 0:i.altitude)!=null?n:0)}return this.core.projectCoordinateToScreenXY([e.longitude,e.latitude,a])}isInView(e){return this.core.isInView(typeof e=="string"?e:e.id)}auto(){return{labels:this.Labels.all()}}tween(e){let r=new pf(e);return this.core.getTweenGroup().add(r),this.core.render(),r}removeTween(e){this.core.getTweenGroup().remove(e)}get __core(){return this.core}clear(){this.Navigation.clear(),this.BlueDot.disable(),this.Shapes.removeAll(),this.Paths.removeAll(),this.Models.removeAll(),this.Markers.removeAll(),this.Images.removeAll(),this.Labels.removeAll()}destroy(){this.clear(),this.core.destroy()}};s(I6e,"GeoJsonApi");var Brt=I6e;function T6e(t){Cue("".concat(t,"/maplibre-worker.csp.js")),YTe("".concat(t,"/collision-worker.csp.js"))}s(T6e,"setWorkersUrl");N();N();var P6e=class{constructor(e){$(this,"state"),$(this,"update"),this.update=e.Debug.update.bind(e.Debug),this.state=e.Debug.state}};s(P6e,"Debug");var zrt=P6e;N();var Urt=Zl.object({environment:Zl.union([Zl.literal("basic"),Zl.literal(!1)]).optional(),text3d:Zl.object({hoverColor:Zl.string().optional()}).optional(),geometry:Zl.object({hoverColor:Zl.string().optional()}).optional(),backgroundColor:Zl.string().optional(),backgroundAlpha:Zl.number().optional()}).strict();N();var VX=kr(cye(),1),jX=s(t=>{if(["#","rgb(","rgba(","hsl(","hsla("].some(r=>t.startsWith(r)))return!0;let e=console.warn;return console.warn=()=>{},t==="white"||n9(t).some(r=>r<1)?!0:(console.warn=e,!1)},"isProbablyColor"),n9=s(t=>{let e=new si(t);return[e.r,e.g,e.b]},"stringToRgbArray"),Vrt=s(t=>{let e=new si;return e.setRGB(t[0],t[1],t[2],nl),"#"+e.getHexString()},"rgbArrayToString"),jrt=s((t,e)=>{let r={},i=s((n,a,o)=>{for(let l in a){let u=n[l],c=a[l];typeof c=="object"&&!Array.isArray(c)&&c!==null&&typeof u=="object"&&!Array.isArray(u)&&u!==null?(o[l]={},i(u,c,o[l])):o[l]=u}},"processObject");return i(t,e,r),r},"extractProperties"),$rt=s((t,e)=>{let r=jrt(t,e),i=(0,VX.default)({},r,e),n=s((a,o,l)=>{for(let u in o){let c=a[u],p=o[u];if(typeof p=="number"&&typeof c=="number")a[u]=c+(p-c)*l;else if(typeof p=="string"&&typeof c=="string"){if(jX(c)&&jX(p)){let m=n9(c),y=n9(p);m&&y?a[u]=Vrt([m[0]+(y[0]-m[0])*l,m[1]+(y[1]-m[1])*l,m[2]+(y[2]-m[2])*l]):Vt.warn('Color "'.concat(u,'" could not be animated!'))}}else typeof p=="object"&&p!==null&&typeof c=="object"&&c!==null?n(c,p,l):Vt.warn('Value "'.concat(u,'" could not be animated!'))}},"interpolate");return a=>{if(a=Math.min(Math.max(a,0),1),a===0)return t;if(a===1)return i;let o=(0,VX.default)({},r);return n(o,e,a),o}},"animationFactory"),h3,ei,Rm,L6e=class extends Wa{constructor(e){super(),Be(this,h3,{}),Be(this,ei),Be(this,Rm),$(this,"Camera"),$(this,"Labels"),$(this,"Text3D"),$(this,"Markers"),$(this,"Images"),$(this,"Models"),$(this,"Paths"),$(this,"Exporter"),$(this,"Navigation"),$(this,"BlueDot"),$(this,"Style"),$(this,"Shapes"),$(this,"Outdoor"),$(this,"update",s(()=>{b(this,ei).core.render()},"update")),$(this,"getDirections",s((i,n,a)=>{var o;return(o=b(this,ei).getMapData())==null?void 0:o.getDirections(i,n,a)},"getDirections")),$(this,"getDirectionsMultiDestination",s((i,n,a)=>{var o;return(o=b(this,ei).getMapData())==null?void 0:o.getDirectionsMultiDestination(i,n,a)},"getDirectionsMultiDestination")),$(this,"on",s((i,n)=>{super.on(i,n)},"on")),$(this,"off",s((i,n)=>{super.off(i,n)},"off")),$(this,"Debug"),He(this,Rm,e);let r=new Brt(e,this);He(this,ei,r),this.Camera=b(this,ei).Camera,He(this,h3,b(this,ei).mapDataExternal),this.Markers=b(this,ei).Markers,this.Models=b(this,ei).Models,this.Labels=b(this,ei).Labels,this.Text3D=b(this,ei).Text3D,this.Exporter=b(this,ei).Exporter,this.Paths=b(this,ei).Paths,this.Navigation=b(this,ei).Navigation,this.BlueDot=b(this,ei).BlueDot,this.Shapes=b(this,ei).Shapes,this.Style=b(this,ei).Style,this.auto=b(this,ei).auto,this.Outdoor=b(this,ei).Outdoor,this.Images=b(this,ei).Images,b(this,Rm).container.dataset.version=$a.env.npm_package_version,this.Debug=new zrt(b(this,ei).core)}get StackedMaps(){return b(this,ei).currentMap.StackedMaps}updateState(e,r){return b(this,ei).updateState(e,r)}animateState(e,r,i){var n;let a=b(this,ei).getState(e);if(a==null)return Vt.warn("Cannot animate state of ".concat(e,".")),new Promise(c=>c());let o=$rt(a,r),l=b(this,ei).tween({percent:0}).to({percent:1},(n=i==null?void 0:i.duration)!=null?n:1e3).onUpdate(({percent:c})=>{b(this,ei).updateState(e,o(c))});i!=null&&i.easing&&i.easing in Q_&&l.easing(Q_[i.easing]);let u=new Promise(c=>{l.onComplete(()=>{b(this,ei).removeTween(l),c()}).onStop(()=>{b(this,ei).removeTween(l),c()}),l.start()});return u.cancel=()=>{l.stop(),b(this,ei).updateState(e,o(0))},u}updateGlobalState(e){var r,i,n,a;try{Urt.parse(e)}catch(o){Vt.error("updateGlobalState",o);return}if(typeof e=="object"){let o={};if((r=e.text3d)!=null&&r.hoverColor&&(o.text3dHoverColor=e.text3d.hoverColor),(i=e.geometry)!=null&&i.hoverColor&&(o.hoverColor=e.geometry.hoverColor),e.backgroundColor||e.backgroundAlpha!==void 0){let l=(n=e.backgroundColor)!=null?n:b(this,ei).core.backgroundColor,u=(a=e.backgroundAlpha)!=null?a:b(this,ei).core.backgroundAlpha;b(this,ei).core.setBackgroundColor(l,u)}e.environment!=null&&b(this,ei).core.setEnvironment(e.environment),b(this,ei).core.setState(o)}}getGlobalState(){let e=b(this,ei).core.getState();return{backgroundColor:b(this,ei).core.backgroundColor,backgroundAlpha:b(this,ei).core.backgroundAlpha,environment:b(this,ei).core.getEnvironment(),geometry:{hoverColor:e.hoverColor},text3d:{hoverColor:e.text3dHoverColor}}}getMapData(){return b(this,h3)}getDimensions(){return{width:b(this,Rm).canvasWidth,height:b(this,Rm).canvasHeight}}expand(e){var r;return(r=b(this,ei).currentMap)==null?void 0:r.StackedMaps.expand(e)}collapse(e){var r;return(r=b(this,ei).currentMap)==null?void 0:r.StackedMaps.collapse(e)}addMap(e,r){return b(this,ei).addMap(e,r)}setFloor(e,r){return b(this,ei).setFloor(e,r==null?void 0:r.context)}setFloorStack(e,r){return b(this,ei).setFloorStack(e,r==null?void 0:r.context)}preloadFloors(e){b(this,ei).preloadFloors(e)}tween(e){return b(this,ei).tween(e)}removeTween(e){b(this,ei).removeTween(e)}get currentFloorStack(){return b(this,ei).currentFloorStack}get currentFloor(){return b(this,ei).currentFloor}updateWatermark(e){b(this,ei).updateWatermark(e)}getState(e){return b(this,ei).getState(e)}setHoverColor(e){b(this,ei).setHoverColor(e)}getHoverColor(){return b(this,ei).getHoverColor()}convertAltitudeToMercatorZoomLevel(e){return b(this,ei).core.getSystems().cameraSystem.convertAltitudeToZoomLevel(e)}convertMercatorZoomLevelToAltitude(e){return b(this,ei).core.getSystems().cameraSystem.convertZoomLevelToAltitude(e)}isInView(e){return b(this,ei).isInView(e)}getDistance(e,r){var i;return(i=b(this,ei).getMapData())==null?void 0:i.getDistance(e,r)}createCoordinate(e,r,i){return typeof e=="object"?new On(e):new On(e,r,i==null?void 0:i.id)}createCoordinateFromScreenCoordinate(e,r,i){return b(this,ei).createCoordinateFromScreenCoordinate(e,r,i)}getScreenCoordinateFromCoordinate(e){return b(this,ei).getScreenCoordinateFromCoordinate(e)}auto(){return{labels:this.Labels.all()}}get __core(){if($a.env.INTERNAL==="true")return b(this,ei).core;throw new Error("__core is not available.")}clear(){b(this,ei).clear()}destroy(){b(this,ei).destroy()}async enableDebug(e={}){let{Inspector:r}=await ag(()=>import("./inspector-U6M4QW4R-kDrJZEjE.js"),[]);await new r(this,b(this,ei)).enable(e)}async takeScreenshot(){return await b(this,Rm).renderSync(),b(this,Rm).rendererDomElement.toDataURL("image/png")}get manualFloorVisibility(){return b(this,ei).manualFloorVisibility}set manualFloorVisibility(e){b(this,ei).manualFloorVisibility=e}};h3=new WeakMap,ei=new WeakMap,Rm=new WeakMap,s(L6e,"MapView");var D6e=L6e;N();N();var R6e=class extends Wa{constructor(e){super(),$(this,"gl"),$(this,"el",document.createElement("div")),$(this,"core"),$(this,"origin"),$(this,"map"),$(this,"layer"),$(this,"handleStyleChange",s(()=>{!this.map||!this.layer||this.map.getLayer(this.layer.id)||(this.map.addLayer(this.layer),this.core.camera.setMinZoomLevel(this.map.getMinZoom()),this.core.camera.setMaxZoomLevel(this.map.getMaxZoom()),this.core.camera.setMinPitch(this.map.getMinPitch()),this.core.camera.setMaxPitch(this.map.getMaxPitch()))},"handleStyleChange")),$(this,"handleMove",s(()=>{if(!this.map)return;let[r,i]=this.map.getCenter().toArray();this.core.getSystems().cameraSystem.setCenter(r,i),this.core.getSystems().cameraSystem.setZoomLevel(this.map.getZoom()),this.core.getSystems().cameraSystem.setRotation(Gn.degToRad(this.map.getBearing())),this.core.getSystems().cameraSystem.setTilt(Gn.degToRad(this.map.getPitch()))},"handleMove")),$(this,"handleError",s(r=>{Vt.warn(r)},"handleError")),this.origin=e}onAdd(e){this.origin=this.origin||e.getCenter().toArray(),this.gl=e.painter.context.gl,this.core=new CN(e._container,{center:this.origin,zoomLevel:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing(),gl:this.gl,map:e,mode:"outdoors-overlay"}),this.map=e,this.core.camera.setMinZoomLevel(e.getMinZoom()),this.core.camera.setMaxZoomLevel(e.getMaxZoom()),this.core.camera.setMinPitch(e.getMinPitch()),this.core.camera.setMaxPitch(e.getMaxPitch()),this.map.on("error",this.handleError);let r=al.fromLngLat(this.origin,0);return this.layer=GB(r,this.core.viewCamera,this.core.camera,()=>{this.core.renderSync()}),this.map.on("styledata",this.handleStyleChange),this.map.on("move",this.handleMove),this.handleStyleChange(),this.el}onRemove(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("move",this.handleMove),this.map.off("error",this.handleError),this.layer&&this.map.removeLayer(this.layer.id)),this.layer=void 0,this.map=void 0,this.core&&this.core.destroy(),this.core=void 0}};s(R6e,"MapLibreOverlay");var Grt=R6e,S1,ew,ly,M1,a9=class O6e extends Wa{constructor(e,r,i){super(),Be(this,S1),Be(this,ew),Be(this,ly),Be(this,M1),$(this,"on",s((n,a)=>{super.on(n,a)},"on")),$(this,"off",s((n,a)=>{super.off(n,a)},"off")),He(this,M1,new Grt(e)),He(this,S1,r),He(this,ew,i)}onAdd(e){var r,i;let n=b(this,M1).onAdd(e),a=vt(Ee(Ee({},M2),(r=b(this,ew))!=null?r:{}),{outdoorView:Ee({token:b(this,S1).outdoorViewToken},(i=b(this,ew))==null?void 0:i.outdoorView)});return He(this,ly,new D6e(b(this,M1).core)),b(this,ly).addMap(b(this,S1),a).then(()=>{this.publish("loaded",{mapView:b(this,ly),mapData:b(this,S1)})}),n}onRemove(){b(this,ly)&&b(this,ly).clear(),O6e.instance=null,b(this,M1).onRemove()}};S1=new WeakMap,ew=new WeakMap,ly=new WeakMap,M1=new WeakMap,s(a9,"MappedinMapLibreOverlay"),$(a9,"instance");var Y6=a9;N();var Hrt=1e3*60*60*2,Dy,mw,za,Ip,Tp,Dh,kp,tw,rw,p3,cs,o9,$X,GX,f_,qT,s9,l9,u9,k6e=class{constructor(e,r){Be(this,cs),Be(this,Dy,new Wa),Be(this,mw),Be(this,za),Be(this,Ip),Be(this,Tp),Be(this,Dh),Be(this,kp),Be(this,tw),Be(this,rw),Be(this,p3,s(()=>{"key"in b(this,za)&&"secret"in b(this,za)&&dr(this,cs,f_).call(this),dr(this,cs,qT).call(this)},"#handleWindowFocus")),$(this,"on",s((i,n)=>b(this,Dy).on(i,n),"on")),$(this,"off",s((i,n)=>b(this,Dy).off(i,n),"off")),He(this,mw,e),He(this,za,r)}setMapIds(e){He(this,mw,e)}setEnterprise(e){b(this,za).enterprise=e}async readySync(){if((!("key"in b(this,za))||!("secret"in b(this,za)))&&!("accessToken"in b(this,za))){Vt.error("No API keys or access token provided! Cannot preload tokens.");return}let e=[dr(this,cs,f_).call(this),null];b(this,za).enterprise||(e[1]=this.getSasTokensAsync());let[r,i]=await Promise.all(e);dr(this,cs,u9).call(this),dr(this,cs,s9).call(this,r),i!=null&&dr(this,cs,l9).call(this,i),dr(this,cs,o9).call(this)&&globalThis.addEventListener("focus",b(this,p3))}async refreshing(){let e=[];return b(this,Ip)!=null&&e.push(b(this,Ip)),b(this,Tp)!=null&&e.push(b(this,Tp)),Promise.all(e)}getAccessTokenAsync(){return dr(this,cs,f_).call(this)}getSasTokensAsync(){return dr(this,cs,qT).call(this)}getAccessToken(){return b(this,Dh)==null?(Vt.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):b(this,Dh)}getSasToken(e){return this.isEnterpriseMode()?(Vt.error("SAS tokens are not available in the enterprise mode!"),{token:""}):b(this,kp)==null?(Vt.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):e in b(this,kp).tokens?b(this,kp).tokens[e]:(Vt.error("SAS token for map ".concat(e," not found!")),{token:""})}isEnterpriseMode(){var e;return(e=b(this,za).enterprise)!=null?e:!1}destroy(){dr(this,cs,u9).call(this),b(this,Dy).destroy(),dr(this,cs,o9).call(this)&&globalThis.removeEventListener("focus",b(this,p3))}};Dy=new WeakMap,mw=new WeakMap,za=new WeakMap,Ip=new WeakMap,Tp=new WeakMap,Dh=new WeakMap,kp=new WeakMap,tw=new WeakMap,rw=new WeakMap,p3=new WeakMap,cs=new WeakSet,o9=s(function(){return typeof window<"u"&&window!==null},"#isBrowser"),$X=s(function(t){var e;let r=t.token!==((e=b(this,Dh))==null?void 0:e.token);He(this,Dh,t),r&&b(this,Dy).publish("access-token-refreshed",{accessToken:t})},"#setAccessToken"),GX=s(function(t){var e;let r=JSON.stringify(t.tokens)!==JSON.stringify((e=b(this,kp))==null?void 0:e.tokens);He(this,kp,t),r&&b(this,Dy).publish("sas-tokens-refreshed",{sasTokens:t.tokens})},"#setSasTokens"),f_=s(async function(t=!1){var e;if("accessToken"in b(this,za)&&typeof b(this,za).accessToken=="string"){let r={token:b(this,za).accessToken,expires:Date.now()+72e5};return He(this,Dh,r),r}if(!("key"in b(this,za))||!("secret"in b(this,za))||typeof b(this,za).key!="string"||typeof b(this,za).secret!="string")throw new Error("No API keys or access token provided!");return b(this,Ip)!=null?b(this,Ip):b(this,Dh)!=null&&b(this,Dh).expires!=null&&b(this,Dh).expires>Date.now()&&!t?b(this,Dh):(He(this,Ip,YV(vt(Ee({},b(this,za)),{key:b(this,za).key,secret:b(this,za).secret}),(e=b(this,za).enterprise)!=null?e:!1).then(r=>{let i={token:r.accessToken,expires:r.expiresTimestamp*1e3};return dr(this,cs,$X).call(this,i),i})),b(this,Ip).finally(()=>{He(this,Ip,void 0)}),b(this,Ip))},"#refreshAccessToken"),qT=s(async function(t=!1){return this.isEnterpriseMode()?{tokens:{},expires:1/0}:b(this,Tp)!=null?b(this,Tp):b(this,kp)!=null&&b(this,kp).expires>Date.now()&&!t?b(this,kp):(He(this,Tp,new Promise((e,r)=>{dr(this,cs,f_).call(this).then(i=>{let n={},a=b(this,mw).map(o=>oTe(vt(Ee({},b(this,za)),{mapId:o}),i.token).then(l=>{n[o]={token:l.token,expires:l.expires}}).catch(l=>{Vt.error("Error getting SAS token for map ".concat(o,":"),l)}));Promise.all(a).then(()=>{let o={tokens:n,expires:Math.min(...Object.values(n).map(l=>{var u;return(u=l.expires)!=null?u:1/0}))};dr(this,cs,GX).call(this,o),e(o)})}).catch(i=>{r(i)})})),b(this,Tp).catch(e=>{throw e}).finally(()=>{He(this,Tp,void 0)}),b(this,Tp))},"#refreshSasTokens"),s9=s(function(t){if(!("key"in b(this,za))||!("secret"in b(this,za)))return;let e=t.expires!=null?t.expires-Date.now():Hrt;isFinite(e)&&He(this,tw,setTimeout(()=>{dr(this,cs,f_).call(this,!0).then(r=>{dr(this,cs,s9).call(this,r)})},e-XKe))},"#setAccessTokenRefresh"),l9=s(function(t){let e=t.expires-Date.now();isFinite(e)&&He(this,rw,setTimeout(()=>{dr(this,cs,qT).call(this,!0).then(r=>{dr(this,cs,l9).call(this,r)})},e-ZKe))},"#setSasTokensRefresh"),u9=s(function(){b(this,tw)!=null&&clearTimeout(b(this,tw)),b(this,rw)!=null&&clearTimeout(b(this,rw))},"#stopRefreshing"),s(k6e,"TokenManager");var N6e=k6e;N();var qrt=s(async(t,e)=>{var r,i,n,a,o,l,u;let c=(n="mvfVersion"in(e??{})?e==null?void 0:e.mvfVersion:void 0)!=null?n:"options"in t&&"version"in((r=t.options)!=null?r:{})?(i=t.options)==null?void 0:i.version:void 0,p=vt(Ee({},e||{}),{mvfVersion:c}),m,y=vS();y.updateByUserOption(p);let v={};if("type"in t&&typeof t.type=="string"){if(v.enterprise=(a=t.options)==null?void 0:a.enterprise,t.type==="binary"&&t.main instanceof Uint8Array){m=await QV(t.main,p.mvfVersion),v.languagePacks=[];for(let T of(o=t.languagePacks)!=null?o:[])T.localePack instanceof Uint8Array&&v.languagePacks.push({language:T.language,localePack:await q5(T.localePack)})}else if(t.type==="json")m=t.main,v.languagePacks=(l=t.languagePacks)!=null?l:[];else throw new Error("Invalid backup type");t.type==="binary"&&t.main instanceof Uint8Array&&(v.binaryBundle=t.main)}else m=t,v.enterprise=m.enterprise!=null;let w=xTe(m),E=w.length>0?w:[p.mapId],M=new N6e(E,vt(Ee({},p),{enterprise:v.enterprise})),I;if("accessToken"in p)I=p.accessToken;else if("key"in p&&"secret"in p){p.baseAuthUri=y.getBaseAuthUri(v.enterprise);let T=await M.getAccessTokenAsync();I=(T==null?void 0:T.token)||""}v.outdoorViewToken=I,v.env=y,v.getMapDataOptions=p;try{await M.readySync()}catch(T){Vt.error("Failed to ready token manager!",T)}let P=new Tj(m,v);I&&P.Analytics.init(vt(Ee({accessToken:I,mapId:p.mapId,key:"key"in p?p.key:void 0,secret:"secret"in p?p.secret:void 0},p.analytics),{baseUri:y.getAnalyticsBaseUri(),context:(u=p.analytics)==null?void 0:u.context}));let C=new ej(P);if("language"in p)try{await C.changeLanguage(p.language)}catch{}return typeof(e==null?void 0:e.onMVFParsed)=="function"&&e.onMVFParsed(m),C},"hydrateMapData");N();var Wrt=s((t,{id:e}={})=>{let r=Array.isArray(t)?t:[t];if(!r.every(a=>typeof a=="string"))return;let i=r.join(""),n=null;if(e){let a=document.getElementById(e);a instanceof HTMLStyleElement&&(n=a)}n==null&&(n=document.createElement("style")),e&&e!==""&&(n.id=e),n.textContent=i,document.head.appendChild(n)},"injectCSS"),Xrt=`:root {
	--pin-shadow-hover-scale: 0.9;
	--pin-shadow-width: 12px;
	--pin-shadow-height: 5px;
	--pin-shadow-opacity: 0.35;
	--pin-drop-animation-duration-ms: 250ms;
}

@keyframes drop-pin {
	0% {
		transform: translateY(-200%);
	}

	100% {
		transform: translateY(0);
	}
}

@keyframes pin-shadow {
	0% {
		transform: scale(var(--pin-shadow-hover-scale));
	}

	100% {
		transform: scale(1);
	}
}

.mappedin-dropped-pin-wrapper {
	position: relative;

	width: fit-content;
	height: fit-content;
	width: 36px;
	height: 42px;

	& svg {
		position: absolute;
		left: calc(50% - var(--pin-shadow-width));
		animation: drop-pin var(--pin-drop-animation-duration-ms) ease-in;
	}

	& > .pin-shadow {
		position: absolute;
		left: calc(50% - (var(--pin-shadow-width) / 2));
		bottom: 0;

		height: var(--pin-shadow-height);
		width: var(--pin-shadow-width);
		border-radius: 100%;

		opacity: var(--pin-shadow-opacity);

		animation: pin-shadow 250ms ease-in;
	}
}

@keyframes bounce {
	0% {
		transform: translateY(-10px);
		opacity: 0;
	}
	12.5% {
		transform: translateY(0);
		opacity: 1;
	}
	25% {
		transform: translateY(0);
	}
	37.5% {
		transform: translateY(-10px);
	}
	50% {
		transform: translateY(0);
	}
	62.5% {
		transform: translateY(-10px);
	}
	75% {
		transform: translateY(0);
	}
	87.5% {
		transform: translateY(-10px);
	}
	100% {
		transform: translateY(0);
	}
}

.mappedin-connection-marker {
	position: relative;
	display: flex;

	.bouncey {
		animation: bounce 2.5s linear;
	}

	.arrow--down {
		transform: rotate(180deg);
	}

	.connection-circle {
		display: flex;
		box-sizing: border-box;
		justify-content: center;
		align-items: center;
		border-radius: 50%;
		border: 2px solid white;
		box-shadow: 0px 2px 8px 0px rgba(0, 0, 0, 0.15);
		background: #595959;
	}
}
`,Zrt=`.mappedin-marker {
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
	font-weight: normal;
	top: 0;
	position: absolute;
	font-weight: bold;
	color: black;
	display: flex;
	flex-direction: row;
	will-change: transform, opacity;
	transition: opacity 150ms ease-in-out;
	justify-content: center;
	opacity: 0;
}

/* Low priority pin strategy styles */

/* Hide all content including text nodes by setting font-size to 0 */
.mappedin-marker[data-anchor="low-priority-pin"] {
	font-size: 0;
	line-height: 0;
}

/* Hide child elements as well */
.mappedin-marker[data-anchor="low-priority-pin"]>* {
	visibility: hidden;
}

/* Create the pin using ::before pseudo-element */
.mappedin-marker[data-anchor="low-priority-pin"]::before {
	content: '';
	display: block;
	border-radius: 50%;
	position: relative;
	/* Default values - will be overridden by inline styles */
	width: var(--mappedin-pin-size, 2px);
	height: var(--mappedin-pin-size, 2px);
	background-color: var(--pin-color, #666);
}
`,Yrt=`.mappedin__smart-collision-engine__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	pointer-events: none;
	/* Enables colliders to use translate3D */
	transform-style: preserve-3d;
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
}

.mappedin__smart-collision-engine-debug__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	transition: opacity 300ms ease-in-out;
	pointer-events: none;
	will-change: opacity;
	&.interacting {
		opacity: 0.2;
	}
}
`,Krt=`.mappedin-map {
	.mappedin-interactive {
		cursor: grab;

		&:active {
			cursor: grabbing;
		}

		&.mappedin-interaction-hover {
			cursor: pointer;
		}
	}
}
`,Jrt=`.mappedin-map {
	.mappedin-control-container {
		position: absolute;
		left: 0px;
		top: 0px;
		bottom: 0px;
		right: 0px;
		pointer-events: none;
		font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;

		.mappedin-ctrl-top-left,
		.mappedin-ctrl-top-right,
		.mappedin-ctrl-bottom-left,
		.mappedin-ctrl-bottom-right {
			position: absolute;
			pointer-events: none;
		}

		.mappedin-ctrl-top-left {
			top: 0;
			left: 0;
		}

		.mappedin-ctrl-top-right {
			top: 0;
			right: 0;
		}

		.mappedin-ctrl-bottom-left {
			bottom: 0;
			left: 0;
		}

		.mappedin-ctrl-bottom-right {
			bottom: 0;
			right: 0;
		}

		.mappedin-ctrl-attrib {
			display: block;
			position: relative;
			pointer-events: auto;
			font: 9px/11px 'InterUI-Regular', Helvetica, Arial, sans-serif;
			padding: 3px 5px 1px 5px;
			background-color: rgba(255, 255, 255, 0.5);
			margin: 0;
			min-width: 11px;
			min-height: 11px;
			user-select: none;

			summary.mappedin-ctrl-attrib-button {
				appearance: none;
				list-style: none;
			}

			summary.mappedin-ctrl-attrib-button::-webkit-details-marker {
				display: none;
			}

			&.mappedin-compact .mappedin-ctrl-attrib-button,
			&.mappedin-compact-show .mappedin-ctrl-attrib-inner {
				display: inline-block;
			}

			&.mappedin-compact {
				background-color: transparent;
			}

			&.mappedin-compact-show {
				min-width: 15px;
				min-height: 15px;
				box-sizing: border-box;
				background-color: rgba(255, 255, 255, 0.5);
			}
		}

		.mappedin-ctrl-attrib-top-left {
			float: left;
			border-bottom-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-top-right {
			float: right;
			border-bottom-left-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-left {
			float: left;
			border-top-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-right {
			float: right;
			border-top-left-radius: 4px;
		}
		.mappedin-ctrl-attrib-top-left,
		.mappedin-ctrl-attrib-bottom-left {
			padding: 3px 5px 1px 20px;
		}

		.mappedin-ctrl-attrib-inner {
			display: inline-block;
			margin-right: 12px;
		}

		.mappedin-ctrl-attrib-inner,
		.mappedin-ctrl-attrib-inner a {
			color: rgba(0, 0, 0, 0.75);
			text-decoration: none;
		}

		.mappedin-ctrl-attrib-inner-bold,
		.mappedin-ctrl-attrib-inner-bold a {
			font-weight: bold;
		}

		.mappedin-ctrl-attrib-inner a:hover {
			color: #017ef1;
			text-decoration: underline;
			cursor: pointer;
		}

		.mappedin-ctrl-attrib-button {
			display: none;
			cursor: pointer;
			position: absolute;
			width: 15px;
			height: 15px;
			box-sizing: border-box;
			border-radius: 50%;
			top: 0;
			right: 2px;
			border: 1px;
		}
		.mappedin-ctrl-attrib-top-left .mappedin-ctrl-attrib-button,
		.mappedin-ctrl-attrib-bottom-left .mappedin-ctrl-attrib-button {
			left: 2px;
		}
	}
}
`,Qrt=`.maplibregl-map {
    font: 12px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
    overflow: hidden;
    position: relative;
    -webkit-tap-highlight-color: rgb(0 0 0 / 0%);
}

.maplibregl-canvas {
    position: absolute;
    left: 0;
    top: 0;
}

.maplibregl-map:fullscreen {
    width: 100%;
    height: 100%;
}

.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-interactive,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    cursor: grab;
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer {
    cursor: pointer;
}

.maplibregl-canvas-container.maplibregl-interactive:active,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active {
    cursor: grabbing;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: pinch-zoom;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,
.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-ctrl-top-left,
.maplibregl-ctrl-top-right,
.maplibregl-ctrl-bottom-left,
.maplibregl-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }

.maplibregl-ctrl-top-left { top: 0; left: 0; }

.maplibregl-ctrl-top-right { top: 0; right: 0; }

.maplibregl-ctrl-bottom-left { bottom: 0; left: 0; }

.maplibregl-ctrl-bottom-right { right: 0; bottom: 0; }

.maplibregl-ctrl {
    clear: both;
    pointer-events: auto;

    /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
    transform: translate(0, 0);
}

.maplibregl-ctrl-top-left .maplibregl-ctrl { margin: 10px 0 0 10px; float: left; }

.maplibregl-ctrl-top-right .maplibregl-ctrl { margin: 10px 10px 0 0; float: right; }

.maplibregl-ctrl-bottom-left .maplibregl-ctrl { margin: 0 0 10px 10px; float: left; }

.maplibregl-ctrl-bottom-right .maplibregl-ctrl { margin: 0 10px 10px 0; float: right; }

.maplibregl-ctrl-group {
    border-radius: 4px;
    background: #fff;
}

.maplibregl-ctrl-group:not(:empty) {
    box-shadow: 0 0 0 2px rgb(0 0 0 / 10%);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl-group:not(:empty) {
        box-shadow: 0 0 0 2px ButtonText;
    }
}

.maplibregl-ctrl-group button {
    width: 29px;
    height: 29px;
    display: block;
    padding: 0;
    outline: none;
    border: 0;
    box-sizing: border-box;
    background-color: transparent;
    cursor: pointer;
}

.maplibregl-ctrl-group button + button {
    border-top: 1px solid #ddd;
}

.maplibregl-ctrl button .maplibregl-ctrl-icon {
    display: block;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: center center;
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl-icon {
        background-color: transparent;
    }

    .maplibregl-ctrl-group button + button {
        border-top: 1px solid ButtonText;
    }
}

/* https://bugzilla.mozilla.org/show_bug.cgi?id=140562 */
.maplibregl-ctrl button::-moz-focus-inner {
    border: 0;
    padding: 0;
}

.maplibregl-ctrl-attrib-button:focus,
.maplibregl-ctrl-group button:focus {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl button:disabled {
    cursor: not-allowed;
}

.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon {
    opacity: 0.25;
}

.maplibregl-ctrl button:not(:disabled):hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-ctrl-group button:focus:focus-visible {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl-group button:focus:not(:focus-visible) {
    box-shadow: none;
}

.maplibregl-ctrl-group button:focus:first-child {
    border-radius: 4px 4px 0 0;
}

.maplibregl-ctrl-group button:focus:last-child {
    border-radius: 0 0 4px 4px;
}

.maplibregl-ctrl-group button:focus:only-child {
    border-radius: inherit;
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #333);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #fff);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-shrink.svg");
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #fff);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #333);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        @svg-load ctrl-compass-white url("svg/maplibregl-ctrl-compass.svg") {
            fill: #fff;
            #south { fill: #999; }
        }

        background-image: svg-inline(ctrl-compass-white);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #000);
    }
}

@svg-load ctrl-terrain url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-terrain-enabled url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain);
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain-enabled);
}

@svg-load ctrl-geolocate url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #fff;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #000;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-disabled url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #aaa;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #999;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #666;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-active url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-active-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e58978;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-background url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
    #dot { display: none; }
}

@svg-load ctrl-geolocate-background-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e54e33;
    #stroke { display: none; }
    #dot { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-disabled);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon {
    animation: maplibregl-spin 2s infinite linear;
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active-error);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background-error);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-black);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-black);
    }
}

@keyframes maplibregl-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

a.maplibregl-ctrl-logo {
    width: 88px;
    height: 23px;
    margin: 0 0 -4px -4px;
    display: block;
    background-repeat: no-repeat;
    cursor: pointer;
    overflow: hidden;
    background-image: svg-load("svg/maplibregl-ctrl-logo.svg");
}

a.maplibregl-ctrl-logo.maplibregl-compact {
    width: 14px;
}

@media (-ms-high-contrast: active) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-white url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; }
            #fill { opacity: 1; }
        }

        background-color: transparent;
        background-image: svg-inline(ctrl-logo-white);
    }
}

@media (-ms-high-contrast: black-on-white) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-black url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; fill: #fff; stroke: #fff; }
            #fill { opacity: 1; fill: #000; }
        }

        background-image: svg-inline(ctrl-logo-black);
    }
}

.maplibregl-ctrl.maplibregl-ctrl-attrib {
    padding: 0 5px;
    background-color: rgb(255 255 255 / 50%);
    margin: 0;
}

@media screen {
    .maplibregl-ctrl-attrib.maplibregl-compact {
        min-height: 20px;
        padding: 2px 24px 2px 0;
        margin: 10px;
        position: relative;
        background-color: #fff;
        color: #000;
        border-radius: 12px;
        box-sizing: content-box;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 28px 2px 8px;
        visibility: visible;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact-show,
    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 8px 2px 28px;
        border-radius: 12px;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner {
        display: none;
    }

    .maplibregl-ctrl-attrib-button {
        display: none;
        cursor: pointer;
        position: absolute;
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
        background-color: rgb(255 255 255 / 50%);
        width: 24px;
        height: 24px;
        box-sizing: border-box;
        border-radius: 12px;
        outline: none;
        top: 0;
        right: 0;
        border: 0;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button {
        appearance: none;
        list-style: none;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker {
        display: none;
    }

    .maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button {
        left: 0;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner {
        display: block;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button {
        background-color: rgb(0 0 0 / 5%);
    }

    .maplibregl-ctrl-bottom-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        left: 0;
    }

    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        left: 0;
    }
}

@media screen and (-ms-high-contrast: active) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg", fill=#fff);
    }
}

@media screen and (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
    }
}

.maplibregl-ctrl-attrib a {
    color: rgb(0 0 0 / 75%);
    text-decoration: none;
}

.maplibregl-ctrl-attrib a:hover {
    color: inherit;
    text-decoration: underline;
}

.maplibregl-attrib-empty {
    display: none;
}

.maplibregl-ctrl-scale {
    background-color: rgb(255 255 255 / 75%);
    font-size: 10px;
    border-width: medium 2px 2px;
    border-style: none solid solid;
    border-color: #333;
    padding: 0 5px;
    color: #333;
    box-sizing: border-box;
}

.maplibregl-popup {
    position: absolute;
    top: 0;
    left: 0;
    display: flex;
    will-change: transform;
    pointer-events: none;
}

.maplibregl-popup-anchor-top,
.maplibregl-popup-anchor-top-left,
.maplibregl-popup-anchor-top-right {
    flex-direction: column;
}

.maplibregl-popup-anchor-bottom,
.maplibregl-popup-anchor-bottom-left,
.maplibregl-popup-anchor-bottom-right {
    flex-direction: column-reverse;
}

.maplibregl-popup-anchor-left {
    flex-direction: row;
}

.maplibregl-popup-anchor-right {
    flex-direction: row-reverse;
}

.maplibregl-popup-tip {
    width: 0;
    height: 0;
    border: 10px solid transparent;
    z-index: 1;
}

.maplibregl-popup-anchor-top .maplibregl-popup-tip {
    align-self: center;
    border-top: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-top: none;
    border-left: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-top: none;
    border-right: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-bottom .maplibregl-popup-tip {
    align-self: center;
    border-bottom: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-bottom: none;
    border-left: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-bottom: none;
    border-right: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-left .maplibregl-popup-tip {
    align-self: center;
    border-left: none;
    border-right-color: #fff;
}

.maplibregl-popup-anchor-right .maplibregl-popup-tip {
    align-self: center;
    border-right: none;
    border-left-color: #fff;
}

.maplibregl-popup-close-button {
    position: absolute;
    right: 0;
    top: 0;
    border: 0;
    border-radius: 0 3px 0 0;
    cursor: pointer;
    background-color: transparent;
}

.maplibregl-popup-close-button:hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-popup-content {
    position: relative;
    background: #fff;
    border-radius: 3px;
    box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
    padding: 15px 10px;
    pointer-events: auto;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-content {
    border-top-left-radius: 0;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-content {
    border-top-right-radius: 0;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content {
    border-bottom-left-radius: 0;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content {
    border-bottom-right-radius: 0;
}

.maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-popup-track-pointer * {
    pointer-events: none;
    user-select: none;
}

.maplibregl-map:hover .maplibregl-popup-track-pointer {
    display: flex;
}

.maplibregl-map:active .maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-marker {
    position: absolute;
    top: 0;
    left: 0;
    will-change: transform;
    transition: opacity 0.2s;
}

.maplibregl-user-location-dot {
    background-color: #1da1f2;
    width: 15px;
    height: 15px;
    border-radius: 50%;
}

.maplibregl-user-location-dot::before {
    background-color: #1da1f2;
    content: "";
    width: 15px;
    height: 15px;
    border-radius: 50%;
    position: absolute;
    animation: maplibregl-user-location-dot-pulse 2s infinite;
}

.maplibregl-user-location-dot::after {
    border-radius: 50%;
    border: 2px solid #fff;
    content: "";
    height: 19px;
    left: -2px;
    position: absolute;
    top: -2px;
    width: 19px;
    box-sizing: border-box;
    box-shadow: 0 0 3px rgb(0 0 0 / 35%);
}

@keyframes maplibregl-user-location-dot-pulse {
    0%   { transform: scale(1); opacity: 1; }
    70%  { transform: scale(3); opacity: 0; }
    100% { transform: scale(1); opacity: 0; }
}

.maplibregl-user-location-dot-stale {
    background-color: #aaa;
}

.maplibregl-user-location-dot-stale::after {
    display: none;
}

.maplibregl-user-location-accuracy-circle {
    background-color: #1da1f233;
    width: 1px;
    height: 1px;
    border-radius: 100%;
}

.maplibregl-crosshair,
.maplibregl-crosshair .maplibregl-interactive,
.maplibregl-crosshair .maplibregl-interactive:active {
    cursor: crosshair;
}

.maplibregl-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
}

.maplibregl-cooperative-gesture-screen {
    background: rgba(0 0 0 / 40%);
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    padding: 1rem;
    font-size: 1.4em;
    line-height: 1.2;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1s ease 1s;
    z-index: 99999;
}

.maplibregl-cooperative-gesture-screen.maplibregl-show {
    opacity: 1;
    transition: opacity 0.05s;
}

.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
    display: none;
}

@media (hover: none), (width <= 480px) {
    .maplibregl-cooperative-gesture-screen .maplibregl-desktop-message {
        display: none;
    }

    .maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
        display: block;
    }
}

.maplibregl-pseudo-fullscreen {
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    top: 0 !important;
    left: 0 !important;
    z-index: 99999;
}
`,eit=[Xrt,Zrt,Yrt,Krt,Jrt,Qrt],F6e;function B6e(t){F6e=t}s(B6e,"__setWatermarkOnClickFn");var tit=s(async(t,e)=>{let r,i=vS();e&&i.updateByUserOption(e);try{e&&(r=(await YV(vt(Ee({},e),{baseAuthUri:i.getBaseAuthUri()}))).accessToken)}catch(a){Vt.warn("Getting access token failed. Outdoor map disabled.",a)}let n=new Tj(t,{outdoorViewToken:r,languagePacks:e==null?void 0:e.languagePacks,env:i});return new ej(n)},"hydrateMapDataFromMVF"),z6e=!1;function U6e(t){z6e=t}s(U6e,"setUseEnterpriseAPI");var Aj=s(async t=>{var e;let r=z6e,i,n=vS();n.updateByUserOption(t);let a=Ee({},t),o=new N6e([a.mapId],a);if("accessToken"in a){i=a.accessToken;let{aud:M,sub:I}=OB(i);(qWe.some(P=>M.includes(P))||I&&I.startsWith("client"))&&(r=!0,o.setEnterprise(r))}else if("key"in a&&"secret"in a)a.key.startsWith("mik_")||(r=!0,o.setEnterprise(r)),a.baseAuthUri=n.getBaseAuthUri(r),i=(await o.getAccessTokenAsync()).token;else throw new Error("Missing key or secret.");a.layoutId!=null&&(r?a.layoutId!=="draft"&&Vt.warn('Invalid layoutId! Use "draft" to load draft data or leave unspecified to load live data.'):Vt.warn("layoutId is currently unsupported!")),a.baseUri=n.getBaseUri(r);let l=performance.now(),u,c;if(r){let M=vt(Ee({},a),{venue:a.mapId,clientId:a.key,clientSecret:a.secret,version:"1.0.0",perspective:a.viewId,useDraftData:a.layoutId==="draft"}),I=await dTe(M);u=I.compressed,c=I.localePacks}else u=await fTe(a,i);let p=performance.now(),m=await QV(u,a.mvfVersion),y=performance.now();typeof t.onMVFParsed=="function"&&t.onMVFParsed(m);let v=xTe(m);v.length>0?o.setMapIds(v):o.setMapIds([a.mapId]);try{await o.readySync()}catch(M){Vt.error("Failed to ready token manager!",M)}let w=new Tj(m,{env:n,outdoorViewToken:i,tokenManager:o,enterprise:r,localePacksUrls:c,binaryBundle:u,getMapDataOptions:a}),E=new ej(w,{search:t.search});if(w.Analytics.init(vt(Ee({accessToken:i,mapId:a.mapId,key:"key"in a?a.key:void 0,secret:"secret"in a?a.secret:void 0},a.analytics),{baseUri:n.getAnalyticsBaseUri(),context:(e=a.analytics)==null?void 0:e.context})),w.Analytics.sendGetMapDataEvent({parseDuration:y-p,downloadDuration:p-l,viewId:a.viewId}),"language"in a)try{await E.changeLanguage(a.language)}catch{}return E},"getMapData"),rit=Aj,iit=s((t,e)=>{Y6.instance!=null&&Vt.warn("Only a single map venue is supported at this time.");let r=new Y6([t.mapCenter.longitude,t.mapCenter.latitude],t,e);return Y6.instance=r,r},"createMapLibreOverlay"),Sj=s(async(t,e,r)=>{var i,n,a,o,l,u,c,p,m,y,v,w,E,M,I;let P=performance.now(),C=$ve(r,e);C&&jve(C),((i=C.injectStyles)==null||i)&&Wrt(eit,{id:"mappedin__styles"});let T=Gve((n=e.outdoorViewToken)!=null?n:""),O=OT(e);(a=C.outdoorView)!=null&&a.style&&O.envControl.updateTileServerBaseUrl((o=C.outdoorView)==null?void 0:o.style);let F=await FLe(t,{center:[e.mapCenter.longitude,e.mapCenter.latitude],bearing:C.bearing,pitch:C.pitch,zoomLevel:C.zoomLevel,backgroundAlpha:(l=C.style)==null?void 0:l.backgroundAlpha,backgroundColor:(u=C.style)==null?void 0:u.backgroundColor,outdoorView:(c=C.outdoorView)!=null&&c.token?{headers:{"x-mappedin-tiles-key":(p=C.outdoorView)==null?void 0:p.token},style:e.getEnv().tileServerUri,enabled:!!((m=C.outdoorView)!=null&&m.enabled),lowDpi:(y=C.outdoorView)==null?void 0:y.lowDpi}:void 0,watermark:vt(Ee({},C.watermark),{visible:(w=(v=C.watermark)==null?void 0:v.visible)!=null?w:!O.enterpriseMode&&!T.remove_watermark,onClick:F6e||void 0}),attribution:C.attribution,antialias:typeof C.antialiasing=="boolean"?C.antialiasing:!!((E=C.antialiasing)!=null&&E.enabled),accessToken:e.outdoorViewToken,occlusionEnabled:(M=C.occlusion)==null?void 0:M.enabled,transformImageRequest:O.enterpriseMode?void 0:O.transformImageRequest,naturalBearing:e.naturalBearing,imagePlacementOptions:C.imagePlacementOptions,onWebGLContextCreationError:C.onWebGLContextCreationError,onWebGLContextLost:C.onWebGLContextLost,onWebGLContextRestored:C.onWebGLContextRestored,onWebGLRendererError:C.onWebGLRendererError,useStandaloneCamera:(I=C.useStandaloneCamera)!=null?I:!1}),k=new D6e(F);return await k.addMap(e,C),O.Analytics.sendMapViewLoadedEvent({firstRenderDuration:performance.now()-P,dimension:k.getDimensions()}),k},"show3dMap"),nit=Sj;function Np(t){return t.verticalOffset===0?[t.longitude,t.latitude]:[t.longitude,t.latitude,t.verticalOffset]}s(Np,"convertCoordinateToPosition");function V6e(t){return new Map(t.map(e=>{let{properties:r}=e,{id:i}=r;return[i,e]}))}s(V6e,"getEntranceMap");var HX=s((t,e)=>{let r=V6e(e),i={entrances:{type:"FeatureCollection",features:[]},walls:{type:"Feature",properties:{id:t[0].properties.id},geometry:{type:"MultiLineString",coordinates:[]}}};for(let n of t){let a=[n.geometry.coordinates],o=(n.properties.entrances||[]).reduce((l,u)=>(r.has(u)&&l.push(r.get(u)),l),[]);if(o.length){let{entrances:l,obstructions:u}=FTe(n,o);a=u.map(c=>c.geometry.coordinates),i.entrances.features.push(...l)}i.walls.geometry.coordinates.push(...a)}return i},"cutEntrancesFromLineStrings");function j6e(t,e){let r={options:{}};if(!r.options)throw new Error("options should exist");return t.text&&(r.text=t.text),t.appearance&&(r.options.appearance=t.appearance),t.rank!=null&&(t.rank==="initial"?r.options.rank=e.initialRank||2:r.options.rank=t.rank),t.enabled!==void 0&&(r.enabled=t.enabled),t.interactive!==null&&(r.options.interactive=t.interactive),t.enabled!==null&&(r.enabled=t.enabled),r}s(j6e,"translateLabelStateToGeojsonCore");function $6e(t,e){let r={options:{}};if(!r.options)throw new Error("options should exist");return t.rank!=null&&(t.rank==="initial"?r.options.rank=e.initialRank||2:r.options.rank=t.rank),t.enabled!=null&&(r.enabled=t.enabled),t.interactive!=null&&(r.options.interactive=t.interactive),t.enabled!==null&&(r.enabled=t.enabled),r}s($6e,"translateMarkerStateToGeojsonCore");function d3(t,e){var r,i;let n={};return e==null||(t.color&&(t.color==="initial"?n.color=e.initialColor:n.color=t.color),t.topColor&&(t.topColor==="initial"?n.topColor=e.initialTopColor:n.topColor=t.topColor),t.visible!==void 0&&(n.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(n.texture=t.texture.url),((i=t.topTexture)==null?void 0:i.url)!==void 0&&(n.topTexture=t.topTexture.url),t.opacity!==void 0&&(n.opacity=t.opacity)),n}s(d3,"translateDoorsStateToGeojsonCore");function c9(t,e){var r,i;let n={};return e==null||(t.color&&(t.color==="initial"?n.color=e.initialColor:n.color=t.color),t.topColor&&(t.topColor==="initial"?n.topColor=e.initialTopColor:n.topColor=t.topColor),t.visible!==void 0&&(n.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(n.texture=t.texture.url),((i=t.topTexture)==null?void 0:i.url)!==void 0&&(n.topTexture=t.topTexture.url),t.height!==void 0&&(n.height=t.height),t.opacity!==void 0&&(n.opacity=t.opacity)),n}s(c9,"translateWallsStateToGeojsonCore");function G6e(t,e){var r,i;let n={};return e==null||(t.color&&(t.color==="initial"?n.color=e.initialColor:n.color=t.color),t.topColor&&(t.topColor==="initial"?n.topColor=e.initialTopColor:n.topColor=t.topColor),t.visible!==void 0&&(n.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(n.texture=t.texture.url),((i=t.topTexture)==null?void 0:i.url)!==void 0&&(n.topTexture=t.topTexture.url),t.hoverColor!==void 0&&(n.hoverColor=t.hoverColor),t.interactive!==void 0&&(n.interactive=t.interactive),t.height!==void 0&&(n.height=t.height),t.opacity!==void 0&&(n.opacity=t.opacity),t.flipImageToFaceCamera!==void 0&&(n.flipImageToFaceCamera=t.flipImageToFaceCamera)),n}s(G6e,"translateSpaceStateToGeojsonCore");function H6e(t,e){return((e-t+Math.PI)%(Math.PI*2)+Math.PI*2)%(Math.PI*2)-Math.PI}s(H6e,"differenceBetweenAngles");function q6e(t,e){let r="Left";return t<=-Math.PI/4?r="Right":t<=-e?r="SlightRight":t<=e?r="Straight":t<=Math.PI/4?r="SlightLeft":r="Left",r}s(q6e,"getRelativeBearing");function W6e(t){let e={};for(let r in t){let i=t[r];if(i!=null){if(i.id=r,"polygons"in i)for(let n of i.polygons)e[n]=i;else if("lineStrings"in i)for(let n of i.lineStrings)e[n]=i;else if("points"in i)for(let n of i.points)e[n]=i}}return e}s(W6e,"extractStyleMap");function f3(t,e){return t.reduce((r,i)=>{let n=e[i.properties.id];if(n==null)return r;if("textures"in i.properties&&Array.isArray(i.properties.textures)&&i.properties.textures.length>0){let a=vt(Ee({},n),{id:n.id+"-textures"});r.set(a,[i])}else r.has(n)||r.set(n,[]),r.get(n).push(i);return r},new Map)}s(f3,"groupGeometryByStyle");function E1(t,e={}){var r,i,n,a,o,l,u;let c=vt(Ee({},t),{flipImageToFaceCamera:(r=e==null?void 0:e.flipImagesToFaceCamera)!=null?r:!0}),p=(n=(i=e==null?void 0:e.style)==null?void 0:i.shading)!=null?n:e==null?void 0:e.shadingAndOutlines;if(p===!0?c.shading={start:.1,end:.15,intensity:.4}:typeof p=="object"&&(c.shading={start:p.start,end:p.end,intensity:p.intensity}),c.outline=(o=(a=e==null?void 0:e.style)==null?void 0:a.outlines)!=null?o:e==null?void 0:e.shadingAndOutlines,"lineStrings"in t){let m=(u=(l=e==null?void 0:e.style)==null?void 0:l.wallTopColor)!=null?u:e==null?void 0:e.wallTopColor;m!=null&&(c.topColor=m)}return c}s(E1,"translateToCoreStyle");var ait=s((t,e)=>{var r;let i=((r=e.currentMap)==null?void 0:r.currentFloor).layers.get(il);switch(t){case"interior-walls":return i==null?void 0:i.layers.get(JP);case"exterior-walls":return i==null?void 0:i.layers.get(F_);case"interior-doors":return i==null?void 0:i.layers.get(yz);case"exterior-doors":return i==null?void 0:i.layers.get(vz);default:return typeof t=="string"?t:t.id}},"getTargetID");function h9(t){return new Promise(e=>{t.onComplete(e),t.onStop(e)})}s(h9,"tweenToPromise");function Mj(t){return t.bbox?t.bbox:VA(t)}s(Mj,"getBoundingBox");function X6e(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.max(t[2],e[2]),Math.max(t[3],e[3])]}s(X6e,"expandBbox");function Z6e(t){return[...new Set(t)]}s(Z6e,"unique");function p9(t,e,r){return t.floorId&&e.has(t.floorId)?e.get(t.floorId):r}s(p9,"getTargetFloorObject");function Z5(t){if(Zp.is(t)||Ky.is(t))return t.id}s(Z5,"getAttachableGeometryId");function Y6e(t,e,r){var i,n,a,o,l,u;let c=t.coordinates.length===2,p=!0;if(c&&t.coordinates[0].floorId!=null&&t.coordinates[1].floorId!=null){let m=e==null?void 0:e.getById("floor",t.coordinates[0].floorId),y=e==null?void 0:e.getById("floor",t.coordinates[1].floorId);m&&y&&(p=((n=(i=r.getState(m))==null?void 0:i.visible)!=null?n:!0)&&((o=(a=r.getState(y))==null?void 0:a.visible)!=null?o:!0))}else{let m=t.coordinates[0].floorId!=null?e==null?void 0:e.getById("floor",t.coordinates[0].floorId):void 0;p=m&&(u=(l=r.getState(m))==null?void 0:l.visible)!=null?u:!0}return p}s(Y6e,"determineFloorVisibleBasedOnPath");var qX=Math.PI*.1,us,Yl,Cu,C1,I1,Om,T1,iw,Kd,K6e,x0,WX,J6e=class{constructor(e,r,i,n){Be(this,Kd),Be(this,us,{}),Be(this,Yl),Be(this,Cu),Be(this,C1),Be(this,I1),Be(this,Om),Be(this,T1),Be(this,iw),He(this,Yl,r),He(this,Cu,e.features),He(this,C1,i),He(this,I1,n)}get path(){return b(this,Cu).map(e=>b(this,Yl).getById("node",e.properties.id)).filter(Boolean)}get departure(){if(b(this,us).departure)return b(this,us).departure;let e=b(this,Cu)[0].properties.id,r=b(this,C1)[0];if(b(this,C1).length>1){for(let i of b(this,C1))if(ex(i,b(this,Yl)).includes(e)){r=i;break}}return b(this,us).departure=r,r}get destination(){if(b(this,us).destination)return b(this,us).destination;let e=b(this,Cu)[b(this,Cu).length-1].properties.id,r=b(this,I1)[0];if(b(this,I1).length>1){for(let i of b(this,I1))if(ex(i,b(this,Yl)).includes(e)){r=i;break}}return b(this,us).destination=r,r}get coordinates(){return b(this,us).coordinates?b(this,us).coordinates:(b(this,us).coordinates=b(this,Cu).map(e=>new On(e.geometry.coordinates[1],e.geometry.coordinates[0],e.properties.groupBy)),b(this,us).coordinates)}get distance(){return b(this,us).distance?b(this,us).distance:(b(this,us).distance=b(this,Cu).reduce((e,r)=>e+(r.properties.distance||0),0),b(this,us).distance)}get instructions(){if(b(this,Cu).length<2)return[];if(b(this,us).instructions)return b(this,us).instructions;let e=[],r=0;for(let i=0;i<b(this,Cu).length;i++){let n=b(this,Cu)[i],a=b(this,Cu)[i-1],o=b(this,Cu)[i+1],l=new On(n.geometry.coordinates[1],n.geometry.coordinates[0],n.properties.groupBy),u=dr(this,Kd,K6e).call(this,{prevDirection:a,direction:n,nextDirection:o});r+=(a==null?void 0:a.properties.distance)||0;for(let c of u)c&&(e.push({action:c,distance:r,coordinate:l,node:b(this,Yl).getById("node",n.properties.id)}),r=0)}return b(this,us).instructions=e,b(this,us).instructions}};us=new WeakMap,Yl=new WeakMap,Cu=new WeakMap,C1=new WeakMap,I1=new WeakMap,Om=new WeakMap,T1=new WeakMap,iw=new WeakMap,Kd=new WeakSet,K6e=s(function(t){var e,r;let{prevDirection:i,direction:n,nextDirection:a}=t,o=i&&b(this,Yl).getById("floor",i.properties.groupBy),l=b(this,Yl).getById("floor",n.properties.groupBy),u=a&&b(this,Yl).getById("floor",a.properties.groupBy),c=[];i||c.push({type:"Departure"});let p=b(this,Yl).getMVFFeatureByNodeId("connection",n.properties.id),m=p?b(this,Yl).getById("connection",p.id):void 0,y=p&&p.nodes.length>1,v=b(this,Yl).enterpriseMode&&(!n.properties.destination||!(p!=null&&p.nodes.includes(n.properties.destination))||!(p!=null&&p.nodes.includes(n.properties.id)));if(p&&!(!y||v))if(!b(this,Om)||b(this,Om)==="exit")c.push(dr(this,Kd,x0).call(this,"TakeConnection",l,u,m,p)),He(this,Om,"take"),He(this,T1,m),He(this,iw,p);else{let w=b(this,Yl).getMVFFeatureByNodeId("connection",(e=i==null?void 0:i.properties.id)!=null?e:""),E=b(this,Yl).getById("connection",(r=w==null?void 0:w.id)!=null?r:"");c.push(dr(this,Kd,x0).call(this,"ExitConnection",l,o,E,w)),He(this,Om,"exit"),He(this,T1,m),He(this,iw,p)}else b(this,Om)==="take"?(c.push(dr(this,Kd,x0).call(this,"ExitConnection",l,o,b(this,T1),b(this,iw))),He(this,Om,"exit"),He(this,T1,m)):u&&l.id!==u.id?c.push(dr(this,Kd,x0).call(this,"TakeConnection",l,u,m)):o&&o.id!==l.id?c.push(dr(this,Kd,x0).call(this,"ExitConnection",l,o,m)):c.push(dr(this,Kd,WX).call(this,i,n));return a||c.push({type:"Arrival"}),c},"#getActions"),x0=s(function(t,e,r,i,n){var a,o;let l="none";if(e.elevation!=null&&(r==null?void 0:r.elevation)!=null){let c=e.elevation-r.elevation;c>0?l="down":c<0&&(l="up")}let u=(o=(a=i==null?void 0:i.type)!=null?a:n==null?void 0:n.type)!=null?o:"stairs";return{type:t,fromFloor:e,toFloor:r,direction:l,connection:i,connectionType:u}},"#createConnectionAction"),WX=s(function(t,e){let r=e.properties.edges;if(!r||r.filter(n=>n.destination.properties.id!==(t==null?void 0:t.properties.id)&&n.destination.properties.id!==e.properties.destination).length===0)return null;let i=t?-H6e(t.properties.angle,e.properties.angle):0;return Math.abs(i)>=qX?{type:"Turn",bearing:q6e(i,qX),referencePosition:"At"}:null},"#createTurnAction"),s(J6e,"Directions");var oit=J6e,Q6e=class{constructor({nodes:e,geojsonCollection:r,connections:i,groupBy:n,multiplicativeDistanceWeightScaling:a}){$(this,"navigator"),$(this,"connections"),$(this,"getDirections",s((o,l,u,c)=>{let{accessible:p,smoothing:{enabled:m,radius:y},connectionIdWeightMap:v}=u,w=o.flatMap(O=>ex(O,c)),E=l.flatMap(O=>ex(O,c)),M=this.getExcludedNodeIds(u.excludedConnections).filter(O=>!w.includes(O)&&!E.includes(O)),I=this.getDisabledConnectionNodeIds(p).filter(O=>!w.includes(O)&&!E.includes(O)),P=new Map;for(let O in v){let F=c.getMVFFeatureById("connection",O);if(!F)continue;let k=this.navigator.graph.edges[F.nodes[0]];if(k){let B=k.find(U=>U.destination.properties.id===F.nodes[1]);B&&P.set(B,v[O])}}let C=this.navigator.getDirections({zones:u.zones.map(O=>{var F;return{geometry:O.geometry,cost:O.cost,map:(F=O.floor)==null?void 0:F.id}}),originIds:w,destinationNodeIds:E,excludedNodeIds:M,disabledConnectionNodeIds:I,simplify:{enabled:m,bufferRadius:y},overrideEdgeWeights:P,multiplicativeDistanceWeightScaling:!c.enterpriseMode});this.addCoordinateDirections(C,o,l);let T=new oit(C,c,o,l);if(!(T.distance===0&&new Set([...w,...E]).size===w.length+E.length))return T},"getDirections")),$(this,"getExcludedNodeIds",s(o=>{if(o.length===0)return[];let l=new Set(o.map(u=>u.id));return this.connections.reduce((u,c)=>l.has(c.id)?u.concat(c.nodes):u,[])},"getExcludedNodeIds")),$(this,"getDisabledConnectionNodeIds",s(o=>o===!1?[]:this.connections.reduce((l,u)=>u.accessible?l:l.concat(u.nodes),[]),"getDisabledConnectionNodeIds")),$(this,"addCoordinateDirections",s((o,[l],[u])=>{if(o.features.length){if(On.is(l)){let c=this.createDirectionFeature(l,this.navigator.getAngle([l.longitude,l.latitude],o.features[0].geometry.coordinates),this.navigator.getDistance([l.longitude,l.latitude],o.features[0].geometry.coordinates));o.features.splice(0,0,c)}if(On.is(u)){let c=this.createDirectionFeature(u,0,0),p=o.features[o.features.length-1];p.properties.distance=this.navigator.getDistance(p.geometry.coordinates,[u.longitude,u.latitude]),p.properties.angle=this.navigator.getAngle(p.geometry.coordinates,[u.longitude,u.latitude]),o.features.push(c)}}},"addCoordinateDirections")),$(this,"createDirectionFeature",s((o,l,u)=>({type:"Feature",geometry:{type:"Point",coordinates:[o.longitude,o.latitude]},properties:{groupBy:o.floorId,id:o.id,angle:l,distance:u,edges:[]}}),"createDirectionFeature")),this.navigator=new aJe({nodes:e,geojsonCollection:this.createCollection(r),groupBy:n,multiplicativeDistanceWeightScaling:a}),this.connections=i}createCollection(e){return{type:"FeatureCollection",features:Object.entries(e).reduce((r,[i,n])=>r.concat(n.features.map(a=>(a.properties.map=i,a))),[])}}};s(Q6e,"DirectionsInternal");var sit=Q6e;function ex(t,e){var r,i,n,a;if(Ij.is(t))return t.navigationTarget.flatMap(o=>ex(o,e));if(t5.is(t)){let o=e.Query.nearest(t,{types:["node"]});return(r=o==null?void 0:o[0])!=null&&r.feature.id?[o[0].feature.id]:[]}else if(On.is(t)){let o=e.Query.nearest(t,{types:["node"]});return(i=o==null?void 0:o[0])!=null&&i.feature.id?[o[0].feature.id]:[]}else if(e5.is(t)){let o=e.Query.nearest(t,{types:["node"]});return(n=o==null?void 0:o[0])!=null&&n.feature.id?[o[0].feature.id]:[]}else if(HA.is(t)){let o=e==null?void 0:e.getMVFFeatureById("entrance",t.id);return o!=null&&o.properties.node?[o==null?void 0:o.properties.node]:[]}else if(ZP.is(t)){let o=e==null?void 0:e.getMVFFeatureById("area",t.id);return(a=o==null?void 0:o.properties.destinationNodes)!=null?a:[]}else if(Zp.is(t)){let o=e==null?void 0:e.getMVFFeatureById("space",t.id);return o==null?[]:o.properties.destinationNodes}else{if(QP.is(t))return t.coordinates.reduce((o,l)=>{var u;let c=e.Query.nearest(l,{types:["node"]});return(u=c==null?void 0:c[0])!=null&&u.feature.id&&o.push(c[0].feature.id),o},[]);if(Ky.is(t)){let o=e==null?void 0:e.objectEntranceNodeIdsByObstructionId[t.id];return o??[]}else return tx.is(t)?t.spaces.flatMap(o=>{var l,u;return(u=(l=e==null?void 0:e.getMVFFeatureById("space",o.id))==null?void 0:l.properties.destinationNodes)!=null?u:[]}).filter(o=>typeof o=="string"):Vw.is(t)?t.nodes.map(o=>o.id):WP.is(t)?[t.id]:[]}}s(ex,"getNodesFromTarget");N();N();N();N();N();N();function eDe(t){let e=+this._x.call(null,t),r=+this._y.call(null,t);return Ej(this.cover(e,r),e,r,t)}s(eDe,"default");function Ej(t,e,r,i){if(isNaN(e)||isNaN(r))return t;var n,a=t._root,o={data:i},l=t._x0,u=t._y0,c=t._x1,p=t._y1,m,y,v,w,E,M,I,P;if(!a)return t._root=o,t;for(;a.length;)if((E=e>=(m=(l+c)/2))?l=m:c=m,(M=r>=(y=(u+p)/2))?u=y:p=y,n=a,!(a=a[I=M<<1|E]))return n[I]=o,t;if(v=+t._x.call(null,a.data),w=+t._y.call(null,a.data),e===v&&r===w)return o.next=a,n?n[I]=o:t._root=o,t;do n=n?n[I]=new Array(4):t._root=new Array(4),(E=e>=(m=(l+c)/2))?l=m:c=m,(M=r>=(y=(u+p)/2))?u=y:p=y;while((I=M<<1|E)===(P=(w>=y)<<1|v>=m));return n[P]=a,n[I]=o,t}s(Ej,"add");function tDe(t){var e,r,i=t.length,n,a,o=new Array(i),l=new Array(i),u=1/0,c=1/0,p=-1/0,m=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(a=+this._y.call(null,e))||(o[r]=n,l[r]=a,n<u&&(u=n),n>p&&(p=n),a<c&&(c=a),a>m&&(m=a));if(u>p||c>m)return this;for(this.cover(u,c).cover(p,m),r=0;r<i;++r)Ej(this,o[r],l[r],t[r]);return this}s(tDe,"addAll");N();function rDe(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,i=this._y0,n=this._x1,a=this._y1;if(isNaN(r))n=(r=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var o=n-r||1,l=this._root,u,c;r>t||t>=n||i>e||e>=a;)switch(c=(e<i)<<1|t<r,u=new Array(4),u[c]=l,l=u,o*=2,c){case 0:n=r+o,a=i+o;break;case 1:r=n-o,a=i+o;break;case 2:n=r+o,i=a-o;break;case 3:r=n-o,i=a-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=r,this._y0=i,this._x1=n,this._y1=a,this}s(rDe,"default");N();function iDe(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}s(iDe,"default");N();function nDe(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}s(nDe,"default");N();N();function Ll(t,e,r,i,n){this.node=t,this.x0=e,this.y0=r,this.x1=i,this.y1=n}s(Ll,"default");function aDe(t,e,r){var i,n=this._x0,a=this._y0,o,l,u,c,p=this._x1,m=this._y1,y=[],v=this._root,w,E;for(v&&y.push(new Ll(v,n,a,p,m)),r==null?r=1/0:(n=t-r,a=e-r,p=t+r,m=e+r,r*=r);w=y.pop();)if(!(!(v=w.node)||(o=w.x0)>p||(l=w.y0)>m||(u=w.x1)<n||(c=w.y1)<a))if(v.length){var M=(o+u)/2,I=(l+c)/2;y.push(new Ll(v[3],M,I,u,c),new Ll(v[2],o,I,M,c),new Ll(v[1],M,l,u,I),new Ll(v[0],o,l,M,I)),(E=(e>=I)<<1|t>=M)&&(w=y[y.length-1],y[y.length-1]=y[y.length-1-E],y[y.length-1-E]=w)}else{var P=t-+this._x.call(null,v.data),C=e-+this._y.call(null,v.data),T=P*P+C*C;if(T<r){var O=Math.sqrt(r=T);n=t-O,a=e-O,p=t+O,m=e+O,i=v.data}}return i}s(aDe,"default");N();function oDe(t){if(isNaN(p=+this._x.call(null,t))||isNaN(m=+this._y.call(null,t)))return this;var e,r=this._root,i,n,a,o=this._x0,l=this._y0,u=this._x1,c=this._y1,p,m,y,v,w,E,M,I;if(!r)return this;if(r.length)for(;;){if((w=p>=(y=(o+u)/2))?o=y:u=y,(E=m>=(v=(l+c)/2))?l=v:c=v,e=r,!(r=r[M=E<<1|w]))return this;if(!r.length)break;(e[M+1&3]||e[M+2&3]||e[M+3&3])&&(i=e,I=M)}for(;r.data!==t;)if(n=r,!(r=r.next))return this;return(a=r.next)&&delete r.next,n?(a?n.next=a:delete n.next,this):e?(a?e[M]=a:delete e[M],(r=e[0]||e[1]||e[2]||e[3])&&r===(e[3]||e[2]||e[1]||e[0])&&!r.length&&(i?i[I]=r:this._root=r),this):(this._root=a,this)}s(oDe,"default");function sDe(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this}s(sDe,"removeAll");N();function lDe(){return this._root}s(lDe,"default");N();function uDe(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}s(uDe,"default");N();function cDe(t){var e=[],r,i=this._root,n,a,o,l,u;for(i&&e.push(new Ll(i,this._x0,this._y0,this._x1,this._y1));r=e.pop();)if(!t(i=r.node,a=r.x0,o=r.y0,l=r.x1,u=r.y1)&&i.length){var c=(a+l)/2,p=(o+u)/2;(n=i[3])&&e.push(new Ll(n,c,p,l,u)),(n=i[2])&&e.push(new Ll(n,a,p,c,u)),(n=i[1])&&e.push(new Ll(n,c,o,l,p)),(n=i[0])&&e.push(new Ll(n,a,o,c,p))}return this}s(cDe,"default");N();function hDe(t){var e=[],r=[],i;for(this._root&&e.push(new Ll(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var n=i.node;if(n.length){var a,o=i.x0,l=i.y0,u=i.x1,c=i.y1,p=(o+u)/2,m=(l+c)/2;(a=n[0])&&e.push(new Ll(a,o,l,p,m)),(a=n[1])&&e.push(new Ll(a,p,l,u,m)),(a=n[2])&&e.push(new Ll(a,o,m,p,c)),(a=n[3])&&e.push(new Ll(a,p,m,u,c))}r.push(i)}for(;i=r.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}s(hDe,"default");N();function pDe(t){return t[0]}s(pDe,"defaultX");function dDe(t){return arguments.length?(this._x=t,this):this._x}s(dDe,"default");N();function fDe(t){return t[1]}s(fDe,"defaultY");function mDe(t){return arguments.length?(this._y=t,this):this._y}s(mDe,"default");function Cj(t,e,r){var i=new Y5(e??pDe,r??fDe,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}s(Cj,"quadtree");function Y5(t,e,r,i,n,a){this._x=t,this._y=e,this._x0=r,this._y0=i,this._x1=n,this._y1=a,this._root=void 0}s(Y5,"Quadtree");function d9(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}s(d9,"leaf_copy");var ou=Cj.prototype=Y5.prototype;ou.copy=function(){var t=new Y5(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,r,i;if(!e)return t;if(!e.length)return t._root=d9(e),t;for(r=[{source:e,target:t._root=new Array(4)}];e=r.pop();)for(var n=0;n<4;++n)(i=e.source[n])&&(i.length?r.push({source:i,target:e.target[n]=new Array(4)}):e.target[n]=d9(i));return t};ou.add=eDe;ou.addAll=tDe;ou.cover=rDe;ou.data=iDe;ou.extent=nDe;ou.find=aDe;ou.remove=oDe;ou.removeAll=sDe;ou.root=lDe;ou.size=uDe;ou.visit=cDe;ou.visitAfter=hDe;ou.x=dDe;ou.y=mDe;var Wc,uy,gDe=class{constructor(e){Be(this,Wc,{}),Be(this,uy),He(this,uy,e)}getTreeByType(e,r,i){var n;if(b(this,Wc)[e]||(b(this,Wc)[e]={}),b(this,Wc)[e][r]&&b(this,Wc)[e][r][i])return b(this,Wc)[e][r][i];b(this,Wc)[e][r]||(b(this,Wc)[e][r]={}),b(this,Wc)[e][r][i]||(b(this,Wc)[e][r][i]=Cj());let a=b(this,Wc)[e][r][i];a.x(l=>l.geometry.coordinates[1]),a.y(l=>l.geometry.coordinates[0]);let o=[];switch(e){case"node":o=((n=b(this,uy).directions.navigator.graph.nodesByGroup.get(i))==null?void 0:n.filter(l=>l.properties.neighbors.length>0))||[];break;case"point-of-interest":o=b(this,uy).mvfPoisByFloorId[i]||[];break;case"door":o=b(this,uy).mvfEntrancesByFloorId[i]||[];break;case"annotation":o=b(this,uy).mvfAnnotationsByFloorId[i]||[];break}return(o==null?void 0:o.length)>0&&a.addAll(o),a}};Wc=new WeakMap,uy=new WeakMap,s(gDe,"QueryCache");var lit=gDe,uit=Zl.object({limit:Zl.enum(["same-floor","same-elevation"]).optional(),radius:Zl.number().optional(),types:Zl.array(Zl.enum(["node","point-of-interest"])).min(1)}),Wd,m3,yDe=class{constructor(e){Be(this,Wd),Be(this,m3),He(this,Wd,e),He(this,m3,new lit(b(this,Wd)))}nearest(e,r){try{uit.parse(r)}catch(o){Vt.error(o);return}let i=hT(e);if(!i)return;let n=i.floorId?[i.floorId]:[];if(i.floorId==null)for(let o of b(this,Wd).getByType("floor-stack")){let l=o.defaultFloor;l&&n.push(l.id)}else if(r.limit==="same-elevation"){let o=b(this,Wd).floorsById[i.floorId];if(o){let l=o==null?void 0:o.elevation;l&&(n=b(this,Wd).getByType("floor-stack").map(u=>{var c;return(c=u.floors.find(p=>p.elevation===l))==null?void 0:c.id}).filter(Boolean))}}let a=[];for(let o of Z6e(r.types))for(let l of n){let u=b(this,m3).getTreeByType(o,b(this,Wd).mapName,l).find(i.latitude,i.longitude,r.radius);if(u){let c=b(this,Wd).getById(o,u==null?void 0:u.properties.id);c&&a.push({distance:Xm([i.longitude,i.latitude],u.geometry.coordinates),feature:c})}}return a.sort((o,l)=>o.distance-l.distance)}};Wd=new WeakMap,m3=new WeakMap,s(yDe,"Query");var cit=yDe;N();N();var g3,vDe=class{constructor(e){Be(this,g3),He(this,g3,e||[])}get raw(){return b(this,g3)}};g3=new WeakMap,s(vDe,"OpeningHours");var hit=vDe,Al,ri,La,f9=class y3 extends hg{constructor(e,r){super(r.mvfData.id),$(this,"__type",y3.__type),$(this,"id","loc_"),$(this,"name",""),$(this,"externalId"),$(this,"description"),$(this,"logo"),$(this,"phone"),$(this,"social",[]),$(this,"images",[]),$(this,"links",[]),$(this,"website"),$(this,"icon"),Be(this,Al),Be(this,ri,{}),Be(this,La),He(this,Al,e),He(this,La,r.mvfData);for(let i in r.mvfData)i==="links"?this.links=r.mvfData.links.map(n=>new nT({mvfData:n})):i==="pictures"?this.images=r.mvfData.pictures.map(n=>{var a;return n.url?new oT({mvfData:vt(Ee({},n),{url:(a=n.url)!=null?a:""}),mapData:b(this,Al)}):void 0}).filter(n=>n!=null):i==="website"?r.mvfData.website&&(this.website=new nT({mvfData:r.mvfData.website})):i==="icon"?r.mvfData.icon&&(this.icon=new oT({mvfData:{url:r.mvfData.icon},mapData:b(this,Al)})):Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)||Object.defineProperty(this,i,{enumerable:!0,get(){return b(this,La)[i]}})}static is(e){return e.__type===y3.__type}get spaces(){if(b(this,ri).spaces)return b(this,ri).spaces;if(b(this,La).spaces==null)return b(this,ri).spaces=[],b(this,ri).spaces;b(this,ri).spaces=[];for(let e=0;e<b(this,La).spaces.length;e++){let r=b(this,Al).getById("space",b(this,La).spaces[e].id);r&&b(this,ri).spaces.push(r)}return b(this,ri).spaces}get points(){if(b(this,ri).points)return b(this,ri).points;if(b(this,La).spaces==null)return b(this,ri).points=[],b(this,ri).points;b(this,ri).points=[];for(let e=0;e<b(this,La).spaces.length;e++){let r=b(this,Al).getById("point-of-interest",b(this,La).spaces[e].id);r&&b(this,ri).points.push(r)}return b(this,ri).points}get doors(){if(b(this,ri).doors)return b(this,ri).doors;if(b(this,La).entrances==null)return b(this,ri).doors=[],b(this,ri).doors;b(this,ri).doors=[];for(let e=0;e<b(this,La).entrances.length;e++){let r=b(this,Al).getById("door",b(this,La).entrances[e].id);r&&b(this,ri).doors.push(r)}return b(this,ri).doors}get connections(){var e;if(b(this,ri).connections)return b(this,ri).connections;if(b(this,La).connections==null)return b(this,ri).connections=[],b(this,ri).connections;let r=new Set;for(let i=0;i<b(this,La).connections.length;i++){let n=b(this,La).connections[i],a=b(this,Al).mvfConnectionsById[n],o=(a==null?[]:a.nodes).map(l=>b(this,Al).getById("node",l)).filter(Boolean);for(let l of o){if(l==null)continue;let u=fx([l.coordinate.longitude,l.coordinate.latitude]),c=((e=b(this,Al).connectionSpaceIdsByLatLon[u])!=null?e:[]).map(p=>b(this,Al).connectionsById[p]).filter(p=>p!=null);for(let p of c)r.add(p)}}return b(this,ri).connections=Array.from(r),b(this,ri).connections}get annotations(){if(b(this,ri).annotations)return b(this,ri).annotations;if(b(this,La).annotations==null)return b(this,ri).annotations=[],b(this,ri).annotations;b(this,ri).annotations=[];for(let e=0;e<b(this,La).annotations.length;e++){let r=b(this,Al).getById("annotation",b(this,La).annotations[e].id);r&&b(this,ri).annotations.push(r)}return b(this,ri).annotations}get categories(){return b(this,ri).categories?b(this,ri).categories:b(this,La).categories==null?(b(this,ri).categories=[],b(this,ri).categories):(b(this,ri).categories=b(this,La).categories.map(e=>b(this,Al).getById("location-category",e)).filter(e=>e!=null),b(this,ri).categories)}get mapObjects(){return b(this,ri).mapObjects?b(this,ri).mapObjects:b(this,La).obstructions==null?(b(this,ri).mapObjects=[],b(this,ri).mapObjects):(b(this,ri).mapObjects=b(this,La).obstructions.map(e=>b(this,Al).getById("object",e.id)).filter(e=>e!=null),b(this,ri).mapObjects)}get areas(){return b(this,ri).areas?b(this,ri).areas:b(this,La).areas==null?(b(this,ri).areas=[],b(this,ri).areas):(b(this,ri).areas=b(this,La).areas.map(e=>b(this,Al).getById("area",e.id)).filter(e=>e!=null),b(this,ri).areas)}get focusTarget(){if(b(this,ri).focusTarget)return b(this,ri).focusTarget;let e=[];for(let r of this.spaces)e.push(r);for(let r of this.connections)e.push(...r.coordinates);for(let r of this.doors)e.push(r.focusTarget);for(let r of this.mapObjects)e.push(r.focusTarget);for(let r of this.annotations)e.push(r.focusTarget);return b(this,ri).focusTarget=e,e}get openingHours(){var e;return b(this,ri).openingHours?b(this,ri).openingHours:(b(this,ri).openingHours=new hit((e=b(this,La).openingHoursSpecification)!=null?e:[]),b(this,ri).openingHours)}get navigationTarget(){if(b(this,ri).navigationTarget)return b(this,ri).navigationTarget;let e=[];for(let r of this.spaces)e.push(r);for(let r of this.connections)e.push(...r.coordinates);for(let r of this.doors)e.push(r.focusTarget);for(let r of this.mapObjects)e.push(r.focusTarget);for(let r of this.annotations)e.push(r.focusTarget);for(let r of this.points)e.push(r.focusTarget);return b(this,ri).navigationTarget=e,e}toJSON(){return{__type:y3.__type,id:this.id,name:this.name}}};Al=new WeakMap,ri=new WeakMap,La=new WeakMap,s(f9,"LocationProfile"),$(f9,"__type","location-profile");var pit=f9,Ij=pit;N();var cy,lc,P1,m9=class v3 extends hg{constructor(e,r){super(r.mvfData.id),$(this,"__type",v3.__type),$(this,"id","cat_"),$(this,"name",""),$(this,"icon",""),Be(this,cy),Be(this,lc,{}),Be(this,P1),He(this,cy,e),He(this,P1,r.mvfData);for(let i in r.mvfData)Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)||Object.defineProperty(this,i,{enumerable:!0,get(){return b(this,P1)[i]}})}static is(e){return e.__type===v3.__type}get parent(){return b(this,lc).parent?b(this,lc).parent:(b(this,lc).parent=b(this,P1).parent?b(this,cy).getById("location-category",b(this,P1).parent):void 0,b(this,lc).parent)}get children(){return b(this,lc).children?b(this,lc).children:(b(this,lc).children=b(this,cy).locationCategoriesByParentId[this.id]||[],b(this,lc).children)}get locationProfiles(){if(b(this,lc).locationProfiles)return b(this,lc).locationProfiles;let e=[];for(let r of b(this,cy).locationProfilesByCategoryId[this.id]||[]){let i=b(this,cy).getById("location-profile",r.id);i&&e.push(i)}return b(this,lc).locationProfiles=e,e}toJSON(){return{__type:v3.__type,id:this.id,name:this.name}}};cy=new WeakMap,lc=new WeakMap,P1=new WeakMap,s(m9,"LocationCategory"),$(m9,"__type","location-category");var dit=m9,_De=dit,yi,g9,xDe,nw,bDe=class extends Wa{constructor(e,r){var i,n,a,o,l;super(),Be(this,g9),$(this,"Analytics"),Be(this,yi,{}),$(this,"Query"),$(this,"mvf"),$(this,"outdoorViewToken"),$(this,"spaceIdsByDestinationNodeId"),$(this,"objectEntranceNodeIdsByObstructionId"),$(this,"obstructionIdByEntranceId"),$(this,"venue"),$(this,"tokenManager"),$(this,"directions"),$(this,"enterpriseMode",!1),$(this,"nodesById"),$(this,"spacesById"),$(this,"floorsById"),$(this,"floorStacksById"),$(this,"facadesById"),$(this,"facadesBySpaceId"),$(this,"connectionsById"),$(this,"objectsById"),$(this,"doorsById"),$(this,"pointsOfInterestById"),$(this,"annotationsById"),$(this,"areasById"),$(this,"locationProfilesById"),$(this,"locationCategoriesById"),$(this,"locationProfilesByExternalId"),$(this,"locationsById"),$(this,"locationProfilesByCategoryId"),$(this,"locationCategoriesByParentId"),$(this,"categoriesById"),$(this,"doorsByNodeId"),$(this,"mvfLocationsBySpaceId"),$(this,"locationIdsByNodeId"),$(this,"spaceIdsByNodeId"),$(this,"mvfAnnotationsById"),$(this,"mvfConnectionsById"),$(this,"mvfConnectionsByNodeId"),$(this,"mvfConnectionIdsByLatLon"),$(this,"mvfEntrancesById"),$(this,"mvfNodesById"),$(this,"mvfObstructionById"),$(this,"mvfSpacesById"),$(this,"mvfFloorsById"),$(this,"mvfFloorStacksById"),$(this,"mvfAreasById"),$(this,"connectionSpaceIdsByLatLon"),$(this,"locationProfilesByAttachedFeatureId"),$(this,"spacesByExternalId"),$(this,"nodesByExternalId"),$(this,"objectsByExternalId"),$(this,"poisByExternalId"),$(this,"floorsByExternalId"),$(this,"floorStacksByExternalId"),$(this,"doorsByExternalId"),$(this,"areasByExternalId"),$(this,"connectionsByExternalId"),$(this,"locationsByExternalId"),$(this,"categoriesByExternalId"),$(this,"mvfNodesByFloorId"),$(this,"mvfSpacesByFloorId"),$(this,"mvfPoisByFloorId"),$(this,"mvfEntrancesByFloorId"),$(this,"mvfAnnotationsByFloorId"),$(this,"localePacksUrls"),$(this,"currentLanguage"),$(this,"languagePacks",{}),$(this,"tilesets",{}),$(this,"binaryBundle"),$(this,"envControl"),$(this,"getMapDataOptions"),Be(this,nw),$(this,"getDirectionsMultiDestination",s((m,y,v)=>this.getDirections(m,y,vt(Ee({},v),{multiDestination:!0})),"getDirectionsMultiDestination")),$(this,"getDirections",s((m,y,v)=>{let{accessible:w=!1,smoothing:E=!0,multiDestination:M=!1}=v||{},I=typeof E=="object"?E.enabled:E,P=typeof E=="object"?E.radius:void 0,C=(v==null?void 0:v.zones)||[],T={accessible:w,zones:C,smoothing:{enabled:I??!0,radius:P??.75},excludedConnections:(v==null?void 0:v.excludedConnections)||[],connectionIdWeightMap:(v==null?void 0:v.connectionIdWeightMap)||{}};if(M&&Array.isArray(y)){let O=Array.isArray(m)?m:[m],F=[];for(let k of y){let B=Array.isArray(k)?k:[k],U=this.directions.getDirections(O,B,T,this);if(!U){Vt.error("getDirections failed due to missing directions for one of the segments");return}O=B,F.push(U)}return F}else{let O=Array.isArray(m)?m:[m],F=Array.isArray(y)?y:[y];if(Array.isArray(F[0])){Vt.error("getDirections does not support multi-destination without multisegment option");return}return O[0].id&&F[0].id&&this.Analytics.sendGetDirectionsEvent(O[0].id,F[0].id),this.directions.getDirections(O,F,T,this)}},"getDirections")),$(this,"transformImageRequest",s(async m=>{var y;if(this.enterpriseMode||!this.getMapDataOptions)return{url:m};if(!bTe(m))return{url:m};if(wTe(m))return{url:m};let v=mye(m);if(!v)return{url:m};try{let w=await((y=this.tokenManager)==null?void 0:y.getSasTokensAsync()),E=w==null?void 0:w[v.mapId];if(E==null)throw new Error("SAS token not found");let[M]=m.split("?");return{url:"".concat(M,"?").concat(E.token)}}catch(w){return Vt.error("Failed to append SAS token to image request. Requests for private images may fail.",w),{url:m}}},"transformImageRequest"));let u=(i=r==null?void 0:r.env)!=null?i:vS();if(this.envControl=u,this.binaryBundle=r==null?void 0:r.binaryBundle,this.Analytics=new e0e,this.localePacksUrls=(n=r==null?void 0:r.localePacksUrls)!=null?n:{},this.mvf=e,this.outdoorViewToken=r==null?void 0:r.outdoorViewToken,this.getMapDataOptions=r==null?void 0:r.getMapDataOptions,((a=e["tileset.json"])==null?void 0:a.default)!=null&&(this.tilesets[e["tileset.json"].default.key]=e["tileset.json"].default,u.updateTileServerBaseUrl(e["tileset.json"].default.url),e["tileset.json"].others!=null))for(let m of e["tileset.json"].others)this.tilesets[m.key]=m;this.enterpriseMode=(o=r==null?void 0:r.enterprise)!=null?o:!1,this.tokenManager=r==null?void 0:r.tokenManager;let c=dXe(e,this);this.nodesById=c.nodesById,this.spacesById=c.spacesById,this.floorsById=c.floorsById,this.floorStacksById=c.floorStacksById,this.facadesById=c.facadesById,this.facadesBySpaceId=c.facadesBySpaceId,this.connectionsById=c.connectionsById,this.objectsById=c.objectsById,this.doorsById=c.doorsById,this.pointsOfInterestById=c.poisById,this.annotationsById=c.annotationsById,this.areasById=c.areasById,this.locationProfilesById=c.locationProfilesById,this.locationCategoriesById=c.locationCategoriesById,this.locationProfilesByCategoryId=c.locationProfilesByCategoryId,this.locationCategoriesByParentId=c.locationCategoriesByParentId,this.spacesByExternalId=c.spacesByExternalId,this.nodesByExternalId=c.nodesByExternalId,this.objectsByExternalId=c.objectsByExternalId,this.floorsByExternalId=c.floorsByExternalId,this.locationProfilesByExternalId=c.locationProfilesByExternalId,this.floorStacksByExternalId=c.floorStacksByExternalId,this.poisByExternalId=c.poisByExternalId,this.doorsByExternalId=c.doorsByExternalId,this.areasByExternalId=c.areasByExternalId,this.mvfAnnotationsById=c.mvfAnnotationsById,this.mvfConnectionsById=c.mvfConnectionsById,this.mvfConnectionsByNodeId=c.mvfConnectionsByNodeId,this.mvfConnectionIdsByLatLon=c.mvfConnectionIdsByLatLon,this.mvfEntrancesById=c.mvfEntrancesById,this.mvfNodesById=c.mvfNodesById,this.mvfObstructionById=c.mvfObstructionById,this.mvfSpacesById=c.mvfSpacesById,this.mvfFloorsById=c.mvfFloorsById,this.mvfFloorStacksById=c.mvfFloorStacksById,this.mvfNodesByFloorId=c.mvfNodesByFloorId,this.mvfSpacesByFloorId=c.mvfSpacesByFloorId,this.mvfPoisByFloorId=c.mvfPoisByFloorId,this.mvfEntrancesByFloorId=c.mvfEntrancesByFloorId,this.mvfAnnotationsByFloorId=c.mvfAnnotationsByFloorId,this.mvfAreasById=c.mvfAreasById,this.doorsByNodeId=c.doorsByNodeId,this.spaceIdsByDestinationNodeId=c.spaceIdsByDestinationNodeId,this.objectEntranceNodeIdsByObstructionId=c.objectEntranceNodeIdsByObstructionId,this.obstructionIdByEntranceId=c.obstructionIdByEntranceId;let p=pXe(e,this);if(this.locationsById=p.locationsById,this.categoriesById=p.categoriesById,this.mvfLocationsBySpaceId=p.mvfLocationsBySpaceId,this.locationIdsByNodeId=p.locationIdsByNodeId,this.connectionSpaceIdsByLatLon=c.connectionIdsByLatLon,this.locationProfilesByAttachedFeatureId=c.locationProfilesByAttachedFeatureId,this.spaceIdsByNodeId=p.spaceIdsByNodeId,this.connectionsByExternalId=p.connectionsByExternalId,this.locationsByExternalId=p.locationsByExternalId,this.categoriesByExternalId=p.categoriesByExternalId,p.venue.name!=null){this.venue=new n0e(this,{mvfData:p.venue});let m={};for(let y in p.mvfLocationsById)m[y]=p.mvfLocationsById[y];for(let y in p.locationInstancesById)m[y]=p.locationInstancesById[y];this.languagePacks[this.venue.defaultLanguage.code]={type:"initial",optimized:{"enterprise-location":m,"enterprise-category":p.mvfCategoriesById,"floor-stack":c.mvfFloorStacksById,floor:c.mvfFloorsById}},(l=r==null?void 0:r.languagePacks)==null||l.forEach(({language:y,localePack:v})=>{this.languagePacks[y.code]=A8(v)}),this.currentLanguage=this.venue.defaultLanguage}this.Query=new cit(this),this.directions=new sit({nodes:e["node.geojson"],geojsonCollection:e.enterprise?e.space:e.obstruction,connections:e["connection.json"],groupBy:"map",multiplicativeDistanceWeightScaling:!this.enterpriseMode})}getEnv(){let e=this;return{get baseUri(){var r;return e.envControl.getBaseUri((r=e.enterpriseMode)!=null?r:!1)},get baseAuthUri(){return e.envControl.getBaseAuthUri()},get analyticsBaseUri(){return e.envControl.getAnalyticsBaseUri()},get tileServerUri(){return e.envControl.getTileServerUri()}}}get mapName(){return this.mvf["manifest.geojson"].features[0].properties.name}get organizationId(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.org_id)!=null?e:""}get mapCenter(){return new On(this.mvf["manifest.geojson"].features[0].geometry.coordinates[1],this.mvf["manifest.geojson"].features[0].geometry.coordinates[0])}get naturalBearing(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.naturalBearing)!=null?e:0}get spaces(){return b(this,yi).spaces==null&&(b(this,yi).spaces=globalThis.Object.values(this.spacesById)),b(this,yi).spaces}get objects(){return b(this,yi).objects==null&&(b(this,yi).objects=globalThis.Object.values(this.objectsById)),b(this,yi).objects}get connections(){return b(this,yi).connections==null&&(b(this,yi).connections=globalThis.Object.values(this.connectionsById)),b(this,yi).connections}get floors(){return b(this,yi).floors==null&&(b(this,yi).floors=globalThis.Object.values(this.floorsById)),b(this,yi).floors}get floorStacks(){return b(this,yi).floorStacks==null&&(b(this,yi).floorStacks=globalThis.Object.values(this.floorStacksById)),b(this,yi).floorStacks}get facades(){return b(this,yi).facades==null&&(b(this,yi).facades=globalThis.Object.values(this.facadesById)),b(this,yi).facades}get doors(){return b(this,yi).doors==null&&(b(this,yi).doors=globalThis.Object.values(this.doorsById)),b(this,yi).doors}get pointsOfInterest(){return b(this,yi).pointsOfInterest==null&&(b(this,yi).pointsOfInterest=globalThis.Object.values(this.pointsOfInterestById)),b(this,yi).pointsOfInterest}get annotations(){return b(this,yi).annotations==null&&(b(this,yi).annotations=globalThis.Object.values(this.annotationsById)),b(this,yi).annotations}get areas(){return b(this,yi).areas==null&&(b(this,yi).areas=globalThis.Object.values(this.areasById)),b(this,yi).areas}get nodes(){return b(this,yi).nodes==null&&(b(this,yi).nodes=globalThis.Object.values(this.nodesById)),b(this,yi).nodes}get locations(){return b(this,yi).locations==null&&(b(this,yi).locations=globalThis.Object.values(this.locationsById)),globalThis.Object.values(this.locationsById)}get categories(){return b(this,yi).categories==null&&(b(this,yi).categories=globalThis.Object.values(this.categoriesById)),globalThis.Object.values(this.categoriesById)}get locationProfiles(){return b(this,yi).locationProfiles==null&&(b(this,yi).locationProfiles=globalThis.Object.values(this.locationProfilesById)),b(this,yi).locationProfiles}get locationCategories(){return b(this,yi).locationCategories==null&&(b(this,yi).locationCategories=globalThis.Object.values(this.locationCategoriesById)),b(this,yi).locationCategories}get mvfFloors(){return b(this,yi).mvfFloors==null&&(b(this,yi).mvfFloors=globalThis.Object.values(this.mvfFloorsById)),b(this,yi).mvfFloors}get mvfFloorStacks(){return b(this,yi).mvfFloorStacks==null&&(b(this,yi).mvfFloorStacks=globalThis.Object.values(this.mvfFloorStacksById)),b(this,yi).mvfFloorStacks}getByType(e){switch(e){case"location-profile":return this.locationProfiles;case"location-category":return this.locationCategories;case"area":return this.areas;case"node":return this.nodes;case"space":return this.spaces;case"door":return this.doors;case"floor":return this.floors;case"floor-stack":return this.floorStacks;case"connection":return this.connections;case"object":return this.objects;case"point-of-interest":return this.pointsOfInterest;case"annotation":return this.annotations;case"enterprise-location":return this.locations;case"enterprise-category":return this.categories;case"enterprise-venue":return this.venue;case"facade":return this.facades;default:return[]}}getById(e,r){switch(e){case"location-profile":return this.locationProfilesById[r];case"location-category":return this.locationCategoriesById[r];case"space":return this.spacesById[r];case"floor":return this.floorsById[r];case"floor-stack":return this.floorStacksById[r];case"facade":return this.facadesById[r];case"node":return this.nodesById[r];case"door":return this.doorsById[r];case"connection":let i=this.connectionsById[r];return i==null&&(i=dr(this,g9,xDe).call(this,this.mvfConnectionsById[r])),i;case"object":return this.objectsById[r];case"point-of-interest":return this.pointsOfInterestById[r];case"annotation":return this.annotationsById[r];case"area":return this.areasById[r];case"enterprise-location":return this.locationsById[r];case"enterprise-category":return this.categoriesById[r];default:return}}getByExternalId(e,r){var i,n,a,o,l,u,c,p,m,y,v,w;switch(e){case"location-profile":return(i=this.locationProfilesByExternalId[r])!=null?i:[];case"location-category":return[];case"space":return(n=this.spacesByExternalId[r])!=null?n:[];case"floor":return(a=this.floorsByExternalId[r])!=null?a:[];case"floor-stack":return(o=this.floorStacksByExternalId[r])!=null?o:[];case"node":return(l=this.nodesByExternalId[r])!=null?l:[];case"door":return(u=this.doorsByExternalId[r])!=null?u:[];case"connection":return(c=this.connectionsByExternalId[r])!=null?c:[];case"object":return(p=this.objectsByExternalId[r])!=null?p:[];case"point-of-interest":return(m=this.poisByExternalId[r])!=null?m:[];case"area":return(y=this.areasByExternalId[r])!=null?y:[];case"enterprise-location":return(v=this.locationsByExternalId[r])!=null?v:[];case"enterprise-category":return(w=this.categoriesByExternalId[r])!=null?w:[];default:return[]}}getMapDataById(e){var r,i,n,a,o,l,u,c,p,m;return(m=(p=(c=(u=(l=(o=(a=(n=(i=(r=this.spacesById[e])!=null?r:this.floorsById[e])!=null?i:this.floorStacksById[e])!=null?n:this.facadesById[e])!=null?a:this.nodesById[e])!=null?o:this.doorsById[e])!=null?l:this.connectionsById[e])!=null?u:this.objectsById[e])!=null?c:this.pointsOfInterestById[e])!=null?p:this.annotationsById[e])!=null?m:this.areasById[e]}getMVFFeatureById(e,r){switch(e){case"space":return this.mvfSpacesById[r];case"node":return this.mvfNodesById[r];case"obstruction":return this.mvfObstructionById[r];case"floor":return this.mvfFloorsById[r];case"floor-stack":return this.mvfFloorStacksById[r];case"connection":return this.mvfConnectionsById[r];case"entrance":return this.mvfEntrancesById[r];case"annotation":return this.mvfAnnotationsById[r];case"area":return this.mvfAreasById[r];default:throw new Error("Unknown MVF feature type: ".concat(e))}}getMVFFeatureByNodeId(e,r){switch(e){case"connection":return this.mvfConnectionsByNodeId[r];default:throw new Error("Unsupported MVF feature type: ".concat(e))}}getMVFFeatureByType(e){switch(e){case"floor-stack":return this.mvfFloorStacks;case"floor":return this.mvfFloors;default:throw new Error("Unsupported MVF feature type: ".concat(e))}}getPropTranslation(e,r,i,n){var a,o;if(!this.currentLanguage)return n;let{code:l}=this.currentLanguage,u=(o=(a=this.languagePacks[l])==null?void 0:a.optimized)==null?void 0:o[e];if(u){let c=u[i];if(c!=null&&c[r]!==void 0)return c[r]}return n}async changeLanguage(e){var r;let i=e.toLowerCase();if(!i){Vt.error("language code must be defined");return}if(!this.currentLanguage){Vt.error("languageCode feature is not supported");return}let n=this.currentLanguage.code,a=(r=this.venue)==null?void 0:r.languages.find(({code:l})=>l.toLowerCase()===i.toLowerCase());if(!a){Vt.warn("language not found");return}if(n===a.code)return;let o=this.languagePacks[a.code];if(!o){let l=this.localePacksUrls[a.code];if(!l){Vt.error("locale packs url not found for ".concat(a.code));return}b(this,nw)&&b(this,nw).abort();let u=new AbortController;He(this,nw,u);let c;try{c=await pTe(l,{signal:u.signal})}catch(p){Vt.error("failed downloading language pack",p);return}if(!c||u.signal.aborted)return;o=A8(c),this.languagePacks[a.code]=o}this.Analytics.sendChangeLanguageEvent({fromLanguage:this.currentLanguage.code}),this.currentLanguage=a,this.publish("language-change",this.currentLanguage)}getDistance(e,r){let i=hT(e),n=hT(r);return Xm([i.longitude,i.latitude],[n.longitude,n.latitude])}async toJSONBundle({downloadLanguagePacks:e=!0}={}){var r;let i=[];if(e&&this.enterpriseMode){let n=new AbortController;for(let a of((r=this.venue)==null?void 0:r.languages)||[])try{if(this.localePacksUrls[a.code]){let o=await w8(this.localePacksUrls[a.code],{signal:n.signal}),l=await q5(o);l&&i.push({language:{code:a.code,name:a.name},localePack:l})}}catch(o){Vt.warn("failed downloading language pack",o)}}return{type:"json",options:{enterprise:this.enterpriseMode},languagePacks:i,main:this.mvf}}async toBinaryBundle({downloadLanguagePacks:e=!0}={}){var r;if(!this.binaryBundle){Vt.error("binary bundle not found");return}let i=[];if(e&&this.enterpriseMode){let n=new AbortController;for(let a of((r=this.venue)==null?void 0:r.languages)||[])try{if(this.localePacksUrls[a.code]){let o=await w8(this.localePacksUrls[a.code],{signal:n.signal});o&&i.push({language:{code:a.code,name:a.name},localePack:o})}}catch(o){Vt.warn("failed downloading language pack",o)}}return{type:"binary",options:{enterprise:this.enterpriseMode},languagePacks:i,main:this.binaryBundle}}destroy(){for(let e of globalThis.Object.keys(b(this,yi)))b(this,yi)[e]=null}};yi=new WeakMap,g9=new WeakSet,xDe=s(function(t){var e;let r=(e=t==null?void 0:t.nodes)==null?void 0:e[0],i=this.getById("node",r);if(i==null)return;let n=fx([i.coordinate.longitude,i.coordinate.latitude]),a=this.connectionSpaceIdsByLatLon[n];return a==null?void 0:a.map(o=>this.connectionsById[o]).find(o=>o!=null)},"#getConnectionFromMVFConnection"),nw=new WeakMap,s(bDe,"MapDataInternal");var Tj=bDe,aw,L1,_3,Xd,y9=class v9 extends XP{constructor(e,r){super(r.mvfData.id,e),$(this,"__type",v9.__type),Be(this,aw),Be(this,L1),Be(this,_3),Be(this,Xd,{}),He(this,aw,r.mvfData),He(this,L1,e),He(this,_3,r.floorStackId)}static is(e){return e.__type===v9.__type}get floorStack(){return b(this,L1).getById("floor-stack",b(this,_3))}get spaces(){if(!b(this,Xd).spaces){b(this,Xd).spaces=[];for(let e of b(this,aw).spaces){let r=b(this,L1).getById("space",e.spaceId);r&&b(this,Xd).spaces.push(r)}}return b(this,Xd).spaces}get center(){if(!b(this,Xd).center){let e={type:"FeatureCollection",features:[]};for(let i of this.spaces){let n=b(this,L1).mvfSpacesById[i.id];n&&e.features.push(n)}if(e.features.length===0)throw new Error("No geometry found for facade!");let r=az(e);b(this,Xd).center=new On(r.geometry.coordinates[1],r.geometry.coordinates[0],b(this,aw).spaces[0].floorId)}return b(this,Xd).center}get focusTarget(){return this.spaces}get anchorTarget(){return this.center}};aw=new WeakMap,L1=new WeakMap,_3=new WeakMap,Xd=new WeakMap,s(y9,"Facade"),$(y9,"__type","facade");var fit=y9,tx=fit,mit=YX();N();N();N();N();var wDe=class extends Error{constructor(e){super("".concat(e," must be used within a MapView component."))}};s(wDe,"MapViewNullError");var _g=wDe,ud=Dr.createContext({mapData:void 0,mapView:void 0});function ADe(){let{mapData:t,mapView:e}=Dr.useContext(ud);if(!t||!e)throw new _g("useMap");return{mapData:t,mapView:e}}s(ADe,"useMap");N();function Pv(t,e){Dr.useEffect(()=>{e!=null&&typeof t=="function"&&t(e)},[t,e])}s(Pv,"useOnLoad");function SDe(t){let{mapView:e}=Dr.useContext(ud),r=Dr.useRef(),[i,n]=Dr.useState(null);return Dr.useEffect(()=>{if(e==null)throw new _g("Marker");return r.current=e.Markers.add(t.target,"",vt(Ee({},t.options),{dynamicResize:!0})),n(r.current),()=>{e==null||r.current==null||e.Markers.remove(r.current)}},[e,t.target]),Dr.useEffect(()=>{i&&(e==null||e.updateState(i,Ee({},t.options)))},[t.options]),Pv(t.onLoad,i),e==null||i==null?null:mit.createPortal(t.children,i.contentEl,i.id)}s(SDe,"Marker");function git(t){let{mapView:e}=Dr.useContext(ud),[r,i]=Dr.useState(null),n=Dr.useRef(ya()),a=Dr.useRef(t.target),o=Dr.useCallback(u=>{var c;i(u),(c=t.onLoad)==null||c.call(t,u)},[t.onLoad]);Dr.useEffect(()=>{if(e==null)throw new _g("Marker");if(r&&r.target!==t.target){let{duration:u=300,easing:c="linear"}=t;e.Markers.animateTo(r,t.target,{duration:u,easing:c})}},[e,t.target,r]);let l=Dr.useMemo(()=>vt(Ee({},t),{duration:void 0,easing:void 0}),[t.duration,t.easing]);return qb.createElement(SDe,vt(Ee({},l),{key:n.current,target:a.current,onLoad:o}))}s(git,"AnimatedMarker");N();function yit(t){let{mapView:e}=Dr.useContext(ud),r=Dr.useRef(),[i,n]=Dr.useState(void 0);return Dr.useEffect(()=>{if(e==null)throw new _g("Label");return r.current=e.Labels.add(t.target,t.text,t.options),n(r.current),()=>{e==null||r.current==null||e.Labels.remove(r.current)}},[e,t.target]),Dr.useEffect(()=>{r.current&&(e==null||e.updateState(r.current,Ee({text:t.text},t.options)))},[t.text,t.options]),Pv(t.onLoad,i),null}s(yit,"Label");N();function vit(t,e){let{mapView:r}=Dr.useContext(ud),i=Dr.useCallback(n=>e(n),[e]);Dr.useEffect(()=>{if(r==null)throw new _g("useEvent");return r.on(t,i),()=>{r!=null&&r.off(t,i)}},[r,t,e])}s(vit,"useEvent");N();function _it(t){let{mapView:e}=Dr.useContext(ud),r=Dr.useRef(),[i,n]=Dr.useState(void 0);return Dr.useEffect(()=>{if(e==null)throw new _g("Path");let a=e.Paths.add(t.coordinate,t.options);return a.animation.then(()=>{var o;(o=t.onDrawComplete)==null||o.call(t)}),n(a),r.current=a,()=>{r.current&&e.Paths.remove(r.current)}},[e,t.coordinate,t.options]),Pv(t.onLoad,i),null}s(_it,"Path");N();var xit={width:"100%",height:"100%",position:"relative"};function MDe(t){let e=t,{mapData:r,options:i,style:n,fallback:a,children:o}=e,l=Nh(e,["mapData","options","style","fallback","children"]),u=Dr.useRef(!1),[c,p]=Dr.useState(void 0),[m,y]=Dr.useState(!0),v=Dr.useRef(null),w=Dr.useMemo(()=>i,[]),E=Dr.useCallback(()=>{if(r&&v!=null&&v.current){if(c)return;Sj(v.current,r,w).then(M=>{p(M)}).catch(M=>{Vt.error("Failed to render MapView",M)}).finally(()=>{y(!1)})}},[r,v.current,w]);return Dr.useEffect(()=>{u.current||(u.current=!0,E())},[E]),Pv(t.onLoad,c),qb.createElement(ud.Provider,{value:{mapData:r,mapView:c}},qb.createElement("div",Ee({"data-testid":"mappedin-map",ref:v,style:Ee(Ee({},xit),n)},l)),m?qb.createElement(qb.Fragment,null,a):o)}s(MDe,"MapView");N();function bit(t){let{mapView:e}=Dr.useContext(ud),[r,i]=Dr.useState(!1);return Dr.useEffect(()=>{if(e==null)throw new _g("Navigation");return e.Navigation.draw(t.directions,t.options).then(()=>{var n;i(!0),(n=t.onDrawComplete)==null||n.call(t)}),()=>{e.Navigation.clear()}},[e,t.directions,t.options]),Dr.useEffect(()=>{r!==!1&&typeof t.onLoad=="function"&&t.onLoad()},[t.onLoad,r]),null}s(bit,"Navigation");N();function wit(t){let{mapView:e}=Dr.useContext(ud),r=Dr.useRef(),[i,n]=Dr.useState(void 0);return Dr.useEffect(()=>{if(e==null)throw new Error("MapView not initialized");return r.current=e.Shapes.add(t.geometry,t.style,t.floor),n(r.current),()=>{e==null||r.current==null||e.Shapes.remove(r.current)}},[e,t.geometry,t.style,t.floor]),Pv(t.onLoad,i),null}s(wit,"Shape");N();function Ait(t){let{mapView:e}=Dr.useContext(ud),r=Dr.useRef(),[i,n]=Dr.useState(void 0);return Dr.useEffect(()=>{if(e==null)throw new _g("Model");return r.current=e.Models.add(t.target,t.url,t.options),n(r.current),()=>{e==null||r.current==null||e.Models.remove(r.current)}},[e,t.url]),Dr.useEffect(()=>{r.current&&(e==null||e.updateState(r.current,Ee({position:t.target},t.options)))},[t.options,t.target]),Pv(t.onLoad,i),null}s(Ait,"Model");N();function EDe(t){let[e,r]=Dr.useState(void 0),[i,n]=Dr.useState(!0),[a,o]=Dr.useState(void 0),l=Dr.useRef(0),u=Dr.useMemo(()=>t,[]),c=Dr.useCallback(()=>{let p=++l.current;n(!0),o(void 0),Aj(u).then(m=>{l.current===p&&r(m)}).catch(m=>{l.current===p&&(Vt.error("Failed to fetch MapData",m),o(m))}).finally(()=>{l.current===p&&n(!1)})},[u]);return Dr.useEffect(()=>{c()},[c]),{mapData:e,isLoading:i,error:a}}s(EDe,"useMapData");/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sit=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mit=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,i)=>i?i.toUpperCase():r.toLowerCase()),XX=t=>{const e=Mit(t);return e.charAt(0).toUpperCase()+e.slice(1)},CDe=(...t)=>t.filter((e,r,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===r).join(" ").trim(),Eit=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cit={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iit=Dr.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:n="",children:a,iconNode:o,...l},u)=>Dr.createElement("svg",{ref:u,...Cit,width:e,height:e,stroke:t,strokeWidth:i?Number(r)*24/Number(e):r,className:CDe("lucide",n),...!a&&!Eit(l)&&{"aria-hidden":"true"},...l},[...o.map(([c,p])=>Dr.createElement(c,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=(t,e)=>{const r=Dr.forwardRef(({className:i,...n},a)=>Dr.createElement(Iit,{ref:a,iconNode:e,className:CDe(`lucide-${Sit(XX(t))}`,`lucide-${t}`,i),...n}));return r.displayName=XX(t),r};/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tit=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Pit=Lv("layers",Tit);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lit=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Dit=Lv("map-pin",Lit);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rit=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Oit=Lv("menu",Rit);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kit=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Nit=Lv("navigation",kit);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fit=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Bit=Lv("route",Fit);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zit=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Uit=Lv("trash-2",zit);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vit=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ZX=Lv("x",Vit);function jit(){const{mapView:t,mapData:e}=ADe(),[r,i]=Dr.useState([]),[n,a]=Dr.useState(""),[o,l]=Dr.useState(!1),[u,c]=Dr.useState(null),[p,m]=Dr.useState(null),[y,v]=Dr.useState(!1),[w,E]=Dr.useState({show:!1,message:"",type:""}),[M,I]=Dr.useState(""),[P,C]=Dr.useState(""),[T,O]=Dr.useState(null),[F,k]=Dr.useState(null),[B,U]=Dr.useState(!1),[z,q]=Dr.useState(null),W=()=>{l(!o)},J=(te,ne="info")=>{E({show:!0,message:te,type:ne}),setTimeout(()=>{E({show:!1,message:"",type:""})},3e3)},V=()=>{if(U(!0),k(null),!navigator.geolocation){k("Geolocation is not supported by this browser"),U(!1),J("Geolocation not supported","error");return}const te={enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4};navigator.geolocation.getCurrentPosition(ne=>{const{latitude:pe,longitude:xe,accuracy:Te}=ne.coords;O({latitude:pe,longitude:xe,accuracy:Te}),U(!1),J(`Location acquired (${Math.round(Te)}m accuracy)`,"success"),Y(pe,xe)},ne=>{let pe="Unable to get location";switch(ne.code){case ne.PERMISSION_DENIED:pe="Location access denied by user";break;case ne.POSITION_UNAVAILABLE:pe="Location information unavailable";break;case ne.TIMEOUT:pe="Location request timed out";break}k(pe),U(!1),J(pe,"error")},te)},oe=(te,ne,pe,xe)=>{const fe=(pe-te)*Math.PI/180,Pe=(xe-ne)*Math.PI/180,me=Math.sin(fe/2)*Math.sin(fe/2)+Math.cos(te*Math.PI/180)*Math.cos(pe*Math.PI/180)*Math.sin(Pe/2)*Math.sin(Pe/2);return 6371e3*(2*Math.atan2(Math.sqrt(me),Math.sqrt(1-me)))},Y=(te,ne)=>{if(!e){J("Map data not available","error");return}const pe=e.getByType("space"),xe=pe.filter(Pe=>Pe.name&&Pe.name.trim()!==""&&Pe.center&&Pe.center.latitude&&Pe.center.longitude);if(xe.length===0){J("No valid spaces found with coordinates","error"),console.log("Available spaces:",pe.map(Pe=>({name:Pe.name,hasCoords:!!Pe.center.latitude&&!!Pe.center.longitude})));return}let Te=null,fe=1/0;xe.forEach(Pe=>{const me=oe(te,ne,Pe.center.latitude,Pe.center.longitude);me<fe&&(fe=me,Te=Pe)}),Te?(c(Te),I(Te.name),q({name:Te.name,distance:fe}),J(`Starting from nearest space: ${Te.name} (${Math.round(fe)}m away)`,"success"),console.log("Nearest space found:",{name:Te.name,distance:Math.round(fe),coordinates:{lat:Te.center.latitude,lng:Te.center.longitude}})):J("Could not find any nearby spaces","error")},he=te=>{if(!t||!e)return;e.getByType("space").forEach(pe=>{try{t.updateState(pe,{interactive:te,hoverColor:te?"rgba(83, 97, 228)":void 0})}catch(xe){console.warn("Could not update state for space:",pe.name,xe)}})},Q=()=>{if(!P.trim()){J("Please enter a destination","error");return}if(!u){J("Please get your location first or select a starting point","error");return}const ne=e.getByType("space").find(Te=>Te.name&&Te.name.toLowerCase().includes(P.toLowerCase().trim()));if(!ne){J(`Destination "${P}" not found`,"error");return}const pe=e.getDirections(u,ne);if(!pe){J("No path found between these locations","error");return}p&&t.Paths.removeAll();const xe=t.Paths.add(pe.coordinates,{nearRadius:.5,farRadius:.5,color:"#1871fb"});m(xe),v(!1),he(!1),J(`Path created from ${u.name} to ${ne.name}`,"success"),l(!1)},ae=()=>{if(!M.trim()||!P.trim()){J("Please enter both from and to locations","error");return}const te=e.getByType("space"),ne=te.find(fe=>fe.name&&fe.name.toLowerCase().includes(M.toLowerCase().trim())),pe=te.find(fe=>fe.name&&fe.name.toLowerCase().includes(P.toLowerCase().trim()));if(!ne){J(`Location "${M}" not found`,"error");return}if(!pe){J(`Location "${P}" not found`,"error");return}const xe=e.getDirections(ne,pe);if(!xe){J("No path found between these locations","error");return}p&&t.Paths.removeAll();const Te=t.Paths.add(xe.coordinates,{nearRadius:.5,farRadius:.5,color:"#1871fb"});m(Te),c(ne),he(!1),J(`Path created from ${ne.name} to ${pe.name}`,"success"),l(!1)},ee=()=>{p&&t.Paths.removeAll(),c(null),m(null),v(!1),he(!0),I(""),C(""),J("All paths cleared","info")};Dr.useEffect(()=>{if(!t||!e)return;t.Outdoor.setOpacity(0),t.currentFloor&&!n&&a(t.currentFloor.id),e.getByType("space").forEach(pe=>{if(pe.name)try{t.Markers.add(pe,pe.name,{interactive:!0})}catch(xe){console.warn("Could not add marker for space:",pe.name,xe)}try{t.updateState(pe,{interactive:!0,hoverColor:"rgba(83, 97, 228)"})}catch(xe){console.warn("Could not update state for space:",pe.name,xe)}}),t.Camera.set({zoomLevel:20.5,pitch:50});const ne=async pe=>{if(pe)if(y)if(!u)pe.spaces&&pe.spaces.length>0&&(c(pe.spaces[0]),I(pe.spaces[0].name||"Selected Space"),J(`Start point selected: ${pe.spaces[0].name}
Click destination space`,"success"),console.log("Start point selected: "+pe.spaces[0].name));else if(!p&&pe.spaces&&pe.spaces[0]){const xe=e.getDirections(u,pe.spaces[0]);if(!xe){J("No path found between these spaces","error");return}const Te=t.Paths.add(xe.coordinates,{nearRadius:.5,farRadius:.5,color:"#1871fb"});m(Te),he(!1),C(pe.spaces[0].name||"Selected Destination"),J(`Path created to: ${pe.spaces[0].name}`,"success"),console.log("Path created")}else p&&(ee(),console.log("Path removed"));else pe.spaces&&pe.spaces.length>0&&(J(`Clicked: ${pe.spaces[0].name}`,"info"),console.log("Clicked on Space: "+pe.spaces[0].name)),pe.spaces[0].center&&console.log("Clicked space center coordinates:",{latitude:pe.spaces[0].center.latitude,longitude:pe.spaces[0].center.longitude})};return t.on("click",ne),()=>{try{t.off("click",ne)}catch(pe){console.warn("Error removing click listener:",pe)}}},[t,e,u,p,y]);const le=te=>{if(!e)return[];try{const ne=e.getById("floor-stack",te);return!ne||!ne.floors?[]:ne.floors.sort((pe,xe)=>xe.elevation-pe.elevation)}catch(ne){return console.warn("Error getting floor stack:",ne),[]}},K=te=>{if(!(!t||!te))try{const ne=e.getById("floor",te);ne&&(t.setFloor(ne),a(te))}catch(ne){console.warn("Error changing floor:",ne)}},ce=e?e.getByType("floor-stack"):[];return Lr.jsxs(Lr.Fragment,{children:[Lr.jsx("div",{className:"mobile-menu-toggle",children:Lr.jsx("button",{onClick:W,className:"toggle-btn","aria-label":"Toggle navigation menu",children:o?Lr.jsx(ZX,{size:24}):Lr.jsx(Oit,{size:24})})}),Lr.jsxs("div",{className:`nav-container ${o?"mobile-open":""}`,children:[o&&Lr.jsx("div",{className:"mobile-overlay",onClick:()=>l(!1)}),Lr.jsxs("div",{className:"nav-content",children:[Lr.jsxs("div",{className:"nav-header",children:[Lr.jsx("h3",{children:" Navigation"}),Lr.jsx("button",{className:"close-btn",onClick:()=>l(!1),children:Lr.jsx(ZX,{size:20})})]}),ce.length>0&&Lr.jsxs("div",{className:"nav-section",children:[Lr.jsxs("div",{className:"section-title",children:[Lr.jsx(Pit,{size:16}),Lr.jsx("span",{children:"Floor Selection"})]}),Lr.jsx("select",{value:n,onChange:te=>K(te.target.value),className:"nav-select",children:ce[0]&&le(ce[0].id).map(te=>Lr.jsxs("option",{value:te.id,children:[" ",te.name]},te.id))})]}),Lr.jsxs("div",{className:"nav-section",children:[Lr.jsxs("div",{className:"section-title",children:[Lr.jsx(Dit,{size:16}),Lr.jsx("span",{children:"Location"})]}),Lr.jsx("button",{onClick:V,disabled:B,className:`nav-btn primary ${T?"success":""}`,children:B?"Getting Location...":T?" Location Found":" Get My Location"})]}),T&&Lr.jsxs("div",{className:"location-info",children:[Lr.jsx("strong",{children:" GPS Location:"}),Lr.jsx("br",{}),T.latitude.toFixed(6),","," ",T.longitude.toFixed(6),Lr.jsx("br",{}),Lr.jsx("strong",{children:"Accuracy:"})," ",Math.round(T.accuracy),"m",z&&Lr.jsxs(Lr.Fragment,{children:[Lr.jsx("br",{}),Lr.jsx("strong",{children:"Nearest:"})," ",z.name,"(",Math.round(z.distance),"m away)"]})]}),F&&Lr.jsxs("div",{className:"error-info",children:[Lr.jsx("strong",{children:" Location Error:"}),Lr.jsx("br",{}),F]}),Lr.jsxs("div",{className:"nav-section",children:[Lr.jsxs("div",{className:"section-title",children:[Lr.jsx(Nit,{size:16}),Lr.jsx("span",{children:"GPS Navigation"})]}),Lr.jsxs("select",{value:P,onChange:te=>C(te.target.value),className:"nav-select",children:[Lr.jsx("option",{value:"",children:" Where do you want to go?"}),e&&e.getByType("space").filter(te=>te.name&&te.name.trim()!=="").sort((te,ne)=>te.name.localeCompare(ne.name)).map(te=>Lr.jsxs("option",{value:te.name,children:[" ",te.name]},te.id))]}),Lr.jsx("button",{onClick:Q,disabled:!T&&!u,className:"nav-btn secondary",children:" Navigate from My Location"})]}),Lr.jsxs("div",{className:"nav-section",children:[Lr.jsxs("div",{className:"section-title",children:[Lr.jsx(Bit,{size:16}),Lr.jsx("span",{children:"Manual Path"})]}),Lr.jsxs("select",{value:M,onChange:te=>I(te.target.value),className:"nav-select",children:[Lr.jsx("option",{value:"",children:"Select starting location..."}),e&&e.getByType("space").filter(te=>te.name&&te.name.trim()!=="").sort((te,ne)=>te.name.localeCompare(ne.name)).map(te=>Lr.jsxs("option",{value:te.name,children:[" ",te.name]},te.id))]}),Lr.jsxs("select",{value:P,onChange:te=>C(te.target.value),className:"nav-select",children:[Lr.jsx("option",{value:"",children:"Select destination..."}),e&&e.getByType("space").filter(te=>te.name&&te.name.trim()!=="").sort((te,ne)=>te.name.localeCompare(ne.name)).map(te=>Lr.jsxs("option",{value:te.name,children:[" ",te.name]},te.id))]}),Lr.jsx("button",{onClick:ae,className:"nav-btn success",children:" Find Path"})]}),Lr.jsxs("div",{className:"nav-section",children:[Lr.jsx("div",{className:"section-title",children:Lr.jsx("span",{children:"Controls"})}),Lr.jsx("button",{onClick:()=>{v(!y),y&&p?ee():y||J("Pathfinding enabled. Click a space to start","success")},className:`nav-btn ${y?"danger":"primary"}`,children:y?" Disable Click Mode":" Enable Click Mode"}),(p||u)&&Lr.jsxs("button",{onClick:ee,className:"nav-btn warning",children:[Lr.jsx(Uit,{size:16}),"Clear All Paths"]})]})]})]}),w.show&&Lr.jsx("div",{className:`notification ${w.type}`,children:w.message}),Lr.jsx("style",{jsx:!0,children:`
        .mobile-menu-toggle {
          position: fixed;
          top: 20px;
          left: 20px;
          z-index: 1001;
          display: none;
        }

        .toggle-btn {
          background: rgba(20, 20, 30, 0.6);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 20px;
          padding: 14px;
          cursor: pointer;
          box-shadow: 
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          display: flex;
          align-items: center;
          justify-content: center;
          color: rgba(255, 255, 255, 0.9);
        }

        .toggle-btn:hover {
          background: rgba(30, 30, 40, 0.7);
          transform: translateY(-2px);
          box-shadow: 
            0 12px 40px rgba(0, 0, 0, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .nav-container {
          position: fixed;
          top: 20px;
          left: 20px;
          z-index: 1000;
          background: rgba(15, 15, 25, 0.4);
          backdrop-filter: blur(25px);
          border-radius: 24px;
          box-shadow: 
            0 8px 32px rgba(0, 0, 0, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.05),
            0 0 0 1px rgba(255, 255, 255, 0.03);
          max-height: calc(100vh - 40px);
          overflow-y: auto;
          overflow-x: hidden;
          transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
          width: 340px;
          border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-container::-webkit-scrollbar {
          width: 4px;
        }

        .nav-container::-webkit-scrollbar-track {
          background: transparent;
        }

        .nav-container::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.15);
          border-radius: 2px;
        }

        .nav-container::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.25);
        }

        .mobile-overlay {
          display: none;
        }

        .nav-content {
          padding: 24px;
          min-width: 280px;
        }

        .nav-header {
          display: none;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 24px;
          padding-bottom: 20px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .nav-header h3 {
          margin: 0;
          color: rgba(255, 255, 255, 0.9);
          font-size: 20px;
          font-weight: 600;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }

        .close-btn {
          background: rgba(30, 30, 40, 0.6);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.08);
          cursor: pointer;
          padding: 8px;
          color: rgba(255, 255, 255, 0.7);
          border-radius: 12px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .close-btn:hover {
          background: rgba(40, 40, 50, 0.7);
          color: rgba(255, 255, 255, 0.9);
          transform: scale(1.05);
        }

        .nav-section {
          margin-bottom: 24px;
        }

        .section-title {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-bottom: 16px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.9);
          font-size: 15px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .nav-btn {
          width: 100%;
          padding: 14px 18px;
          border-radius: 16px;
          border: 1px solid rgba(255, 255, 255, 0.1);
          cursor: pointer;
          font-size: 14px;
          font-weight: 500;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          margin-bottom: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 10px;
          backdrop-filter: blur(10px);
          position: relative;
          overflow: hidden;
        }

        .nav-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
          opacity: 0;
          transition: opacity 0.3s ease;
        }

        .nav-btn:hover::before {
          opacity: 1;
        }

        .nav-btn:last-child {
          margin-bottom: 0;
        }

        .nav-btn:hover:not(:disabled) {
          transform: translateY(-2px);
          box-shadow: 
            0 8px 25px rgba(0, 0, 0, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
          border-color: rgba(255, 255, 255, 0.2);
        }

        .nav-btn:active {
          transform: translateY(0);
        }

        .nav-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: none;
        }

        .nav-btn.primary {
          background: linear-gradient(135deg, rgba(59, 130, 246, 0.6) 0%, rgba(37, 99, 235, 0.6) 100%);
          color: white;
          border-color: rgba(59, 130, 246, 0.3);
          box-shadow: 
            0 4px 15px rgba(59, 130, 246, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .nav-btn.primary:hover:not(:disabled) {
          background: linear-gradient(135deg, rgba(59, 130, 246, 0.8) 0%, rgba(37, 99, 235, 0.8) 100%);
          box-shadow: 
            0 8px 25px rgba(59, 130, 246, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.25);
        }

        .nav-btn.secondary {
          background: linear-gradient(135deg, rgba(107, 114, 128, 0.6) 0%, rgba(75, 85, 99, 0.6) 100%);
          color: white;
          border-color: rgba(107, 114, 128, 0.3);
          box-shadow: 
            0 4px 15px rgba(107, 114, 128, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .nav-btn.success {
          background: linear-gradient(135deg, rgba(34, 197, 94, 0.6) 0%, rgba(22, 163, 74, 0.6) 100%);
          color: white;
          border-color: rgba(34, 197, 94, 0.3);
          box-shadow: 
            0 4px 15px rgba(34, 197, 94, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .nav-btn.danger {
          background: linear-gradient(135deg, rgba(239, 68, 68, 0.6) 0%, rgba(220, 38, 38, 0.6) 100%);
          color: white;
          border-color: rgba(239, 68, 68, 0.3);
          box-shadow: 
            0 4px 15px rgba(239, 68, 68, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .nav-btn.warning {
          background: linear-gradient(135deg, rgba(245, 158, 11, 0.6) 0%, rgba(217, 119, 6, 0.6) 100%);
          color: white;
          border-color: rgba(245, 158, 11, 0.3);
          box-shadow: 
            0 4px 15px rgba(245, 158, 11, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .nav-input {
          width: 100%;
          padding: 14px 18px;
          border-radius: 16px;
          border: 1px solid rgba(255, 255, 255, 0.08);
          margin-bottom: 10px;
          font-size: 14px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          background: rgba(20, 20, 30, 0.4);
          backdrop-filter: blur(10px);
          color: rgba(255, 255, 255, 0.9);
        }

        .nav-input::placeholder {
          color: rgba(255, 255, 255, 0.4);
        }

        .nav-input:focus {
          outline: none;
          border-color: rgba(59, 130, 246, 0.4);
          box-shadow: 
            0 0 0 3px rgba(59, 130, 246, 0.08),
            0 4px 15px rgba(59, 130, 246, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
          background: rgba(25, 25, 35, 0.5);
        }

        .nav-select {
          width: 100%;
          padding: 14px 18px;
          border-radius: 16px;
          border: 1px solid rgba(255, 255, 255, 0.08);
          font-size: 14px;
          background: rgba(20, 20, 30, 0.4);
          backdrop-filter: blur(10px);
          color: rgba(255, 255, 255, 0.9);
          cursor: pointer;
          margin-bottom: 10px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-select option {
          background: rgba(20, 20, 30, 0.95);
          color: white;
          padding: 10px;
        }

        .nav-select:focus {
          outline: none;
          border-color: rgba(59, 130, 246, 0.4);
          box-shadow: 
            0 0 0 3px rgba(59, 130, 246, 0.08),
            0 4px 15px rgba(59, 130, 246, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
          background: rgba(25, 25, 35, 0.5);
        }

        .location-info {
          background: rgba(34, 197, 94, 0.1);
          backdrop-filter: blur(10px);
          padding: 16px;
          margin-bottom: 20px;
          border-radius: 16px;
          font-size: 13px;
          color: rgba(34, 197, 94, 0.9);
          border: 1px solid rgba(34, 197, 94, 0.2);
          box-shadow: 
            0 4px 15px rgba(34, 197, 94, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .error-info {
          background: rgba(239, 68, 68, 0.1);
          backdrop-filter: blur(10px);
          padding: 16px;
          margin-bottom: 20px;
          border-radius: 16px;
          font-size: 13px;
          color: rgba(239, 68, 68, 0.9);
          border: 1px solid rgba(239, 68, 68, 0.2);
          box-shadow: 
            0 4px 15px rgba(239, 68, 68, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .notification {
          position: fixed;
          top: 4vh;
          left: 50%;
          transform: translate(-50%, -50%);
          padding: 18px 24px;
          border-radius: 20px;
          backdrop-filter: blur(25px);
          box-shadow: 
            0 8px 32px rgba(0, 0, 0, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
          z-index: 3000;
          font-size: 16px;
          font-weight: 600;
          text-align: center;
          min-width: 280px;
          max-width: 420px;
          animation: slideInOut 3s cubic-bezier(0.4, 0, 0.2, 1);
          white-space: pre-line;
          border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .notification.error {
          background: rgba(239, 68, 68, 0.9);
          color: white;
          border-color: rgba(239, 68, 68, 0.3);
        }

        .notification.success {
          background: rgba(34, 197, 94, 0.9);
          color: white;
          border-color: rgba(34, 197, 94, 0.3);
        }

        .notification.warning {
          background: rgba(245, 158, 11, 0.9);
          color: white;
          border-color: rgba(245, 158, 11, 0.3);
        }

        .notification.info {
          background: rgba(59, 130, 246, 0.9);
          color: white;
          border-color: rgba(59, 130, 246, 0.3);
        }

        @keyframes slideInOut {
          0% {
            opacity: 0;
            transform: translate(-50%, -60%) scale(0.8);
            filter: blur(10px);
          }
          10% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            filter: blur(0px);
          }
          90% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            filter: blur(0px);
          }
          100% {
            opacity: 0;
            transform: translate(-50%, -40%) scale(0.8);
            filter: blur(10px);
          }
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
          .mobile-menu-toggle {
            display: block;
          }

          .nav-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 20, 0.6);
            backdrop-filter: blur(25px);
            border-radius: 0;
            box-shadow: none;
            max-height: 100vh;
            transform: translateX(-100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
          }

          .nav-container.mobile-open {
            transform: translateX(0);
          }

          .mobile-overlay {
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: -1;
          }

          .nav-content {
            padding: 24px;
            min-width: auto;
            max-width: 100%;
            height: 100%;
            overflow-y: auto;
          }

          .nav-header {
            display: flex;
          }

          .nav-btn {
            padding: 16px 20px;
            font-size: 16px;
            margin-bottom: 12px;
            border-radius: 18px;
          }

          .nav-input {
            padding: 16px 20px;
            font-size: 16px;
            margin-bottom: 12px;
            border-radius: 18px;
          }

          .nav-select {
            padding: 16px 20px;
            font-size: 16px;
            border-radius: 18px;
          }

          .section-title {
            font-size: 16px;
            margin-bottom: 18px;
          }

          .nav-section {
            margin-bottom: 28px;
          }

          .location-info,
          .error-info {
            font-size: 14px;
            padding: 18px;
            margin-bottom: 24px;
            border-radius: 18px;
          }

          .notification {
            left: 50%;
            top: 6%;
            transform: translateY(-50%);
            max-width: none;
            min-width: auto;
            border-radius: 18px;
          }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
          .nav-content {
            padding: 20px;
          }

          .nav-btn {
            padding: 18px;
            font-size: 15px;
          }

          .nav-input {
            padding: 18px;
            font-size: 15px;
          }

          .nav-select {
            padding: 18px;
            font-size: 15px;
          }

          .toggle-btn {
            padding: 12px;
            border-radius: 16px;
          }
        }
      `})]})}function $it(){const{isLoading:t,error:e,mapData:r}=EDe({key:"mik_yeBk0Vf0nNJtpesfu560e07e5",secret:"mis_2g9ST8ZcSFb5R9fPnsvYhrX3RyRwPtDGbMGweCYKEq385431022",mapId:"64ef49e662fd90fe020bee61"});return t?Lr.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px",backgroundColor:"#f8f9fa"},children:[Lr.jsx("div",{style:{width:"50px",height:"50px",border:"5px solid #e3e3e3",borderTop:"5px solid #007bff",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"20px"}}),Lr.jsx("div",{children:"Loading map..."}),Lr.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `})]}):e?Lr.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",color:"#dc3545",fontSize:"16px",backgroundColor:"#f8f9fa",padding:"20px",textAlign:"center"},children:[Lr.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:""}),Lr.jsx("div",{style:{marginBottom:"10px",fontWeight:"bold"},children:"Error loading map"}),Lr.jsx("div",{style:{fontSize:"14px",color:"#6c757d"},children:e.message})]}):r?Lr.jsx(MDe,{mapData:r,style:{width:"100%",height:"100%"},options:{outdoorView:{style:"https://tiles-cdn.mappedin.com/styles/midnightblue/style.json"}},children:Lr.jsx(jit,{})}):null}qRe.createRoot(document.getElementById("root")).render(Lr.jsx(Dr.StrictMode,{children:Lr.jsx($it,{})}));export{Qn as $,Ru as A,N as B,Ee as C,fye as D,Zq as E,tx as F,s as G,Yi as H,qe as I,$a as J,ff as K,Pme as L,$ as M,Yo as N,Lu as O,b as P,Be as Q,He as R,dr as S,lB as T,Vw as U,Oi as V,ict as W,fce as X,Nm as Y,Gn as Z,ag as _,kr as a,Jlt as a$,Co as a0,z3 as a1,bB as a2,nl as a3,_c as a4,ZUe as a5,BM as a6,HL as a7,Ey as a8,My as a9,Che as aA,Jut as aB,tct as aC,eE as aD,Kl as aE,xde as aF,Vut as aG,zct as aH,DVe as aI,zP as aJ,Nut as aK,Z3 as aL,X3 as aM,Rn as aN,Qp as aO,BP as aP,iut as aQ,T9 as aR,jze as aS,uze as aT,_9e as aU,Fze as aV,Lze as aW,Oze as aX,kze as aY,ZBe as aZ,Fl as a_,Bh as aa,LR as ab,nO as ac,FA as ad,oht as ae,Gct as af,wct as ag,Wy as ah,Kct as ai,eht as aj,Ade as ak,j3 as al,qa as am,TB as an,cht as ao,kut as ap,UVe as aq,lg as ar,AB as as,Bpe as at,js as au,But as av,THe as aw,JUe as ax,Sq as ay,NP as az,hye as b,y9e as b0,Xlt as b1,KBe as b2,Cw as b3,Eze as b4,Ki as b5,Km as b6,$ze as b7,jlt as b8,Kc as b9,gUe as bA,yUe as bB,h9e as bC,vOe as bD,mUe as bE,uUe as bF,dUe as bG,Cue as bH,qtt as bI,Zp as bJ,On as bK,Wa as bL,DM as ba,aze as bb,mq as bc,al as bd,Glt as be,rut as bf,g9e as bg,Pae as bh,Ylt as bi,Pze as bj,cq as bk,eut as bl,Sze as bm,wze as bn,xze as bo,Nze as bp,d9e as bq,v9e as br,yOe as bs,Bot as bt,p9e as bu,wc as bv,fUe as bw,cUe as bx,hUe as by,pUe as bz,WP as c,vt as d,ro as e,Dl as f,i0e as g,si as h,nut as i,hw as j,o_ as k,xt as l,lht as m,Up as n,Jt as o,nn as p,Pu as q,pv as r,KVe as s,YVe as t,NO as u,ug as v,Gu as w,eVe as x,Pn as y,MVe as z};
