(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();function RRe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var bL={exports:{}},bb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dH;function ORe(){if(dH)return bb;dH=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(i,n,a){var o=null;if(a!==void 0&&(o=""+a),n.key!==void 0&&(o=""+n.key),"key"in n){a={};for(var l in n)l!=="key"&&(a[l]=n[l])}else a=n;return n=a.ref,{$$typeof:t,type:i,key:o,ref:n!==void 0?n:null,props:a}}return bb.Fragment=e,bb.jsx=r,bb.jsxs=r,bb}var fH;function kRe(){return fH||(fH=1,bL.exports=ORe()),bL.exports}var Iu=kRe(),wL={exports:{}},Hi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mH;function NRe(){if(mH)return Hi;mH=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function y(ee){return ee===null||typeof ee!="object"?null:(ee=m&&ee[m]||ee["@@iterator"],typeof ee=="function"?ee:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,E={};function M(ee,ue,K){this.props=ee,this.context=ue,this.refs=E,this.updater=K||v}M.prototype.isReactComponent={},M.prototype.setState=function(ee,ue){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,ue,"setState")},M.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function I(){}I.prototype=M.prototype;function P(ee,ue,K){this.props=ee,this.context=ue,this.refs=E,this.updater=K||v}var C=P.prototype=new I;C.constructor=P,x(C,M.prototype),C.isPureReactComponent=!0;var T=Array.isArray,D={H:null,A:null,T:null,S:null,V:null},F=Object.prototype.hasOwnProperty;function k(ee,ue,K,ce,re,se){return K=se.ref,{$$typeof:t,type:ee,key:ue,ref:K!==void 0?K:null,props:se}}function B(ee,ue){return k(ee.type,ue,void 0,void 0,void 0,ee.props)}function U(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function z(ee){var ue={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(K){return ue[K]})}var q=/\/+/g;function Z(ee,ue){return typeof ee=="object"&&ee!==null&&ee.key!=null?z(""+ee.key):ue.toString(36)}function Q(){}function V(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(Q,Q):(ee.status="pending",ee.then(function(ue){ee.status==="pending"&&(ee.status="fulfilled",ee.value=ue)},function(ue){ee.status==="pending"&&(ee.status="rejected",ee.reason=ue)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function ae(ee,ue,K,ce,re){var se=typeof ee;(se==="undefined"||se==="boolean")&&(ee=null);var de=!1;if(ee===null)de=!0;else switch(se){case"bigint":case"string":case"number":de=!0;break;case"object":switch(ee.$$typeof){case t:case e:de=!0;break;case p:return de=ee._init,ae(de(ee._payload),ue,K,ce,re)}}if(de)return re=re(ee),de=ce===""?"."+Z(ee,0):ce,T(re)?(K="",de!=null&&(K=de.replace(q,"$&/")+"/"),ae(re,ue,K,"",function(fe){return fe})):re!=null&&(U(re)&&(re=B(re,K+(re.key==null||ee&&ee.key===re.key?"":(""+re.key).replace(q,"$&/")+"/")+de)),ue.push(re)),1;de=0;var we=ce===""?".":ce+":";if(T(ee))for(var Le=0;Le<ee.length;Le++)ce=ee[Le],se=we+Z(ce,Le),de+=ae(ce,ue,K,se,re);else if(Le=y(ee),typeof Le=="function")for(ee=Le.call(ee),Le=0;!(ce=ee.next()).done;)ce=ce.value,se=we+Z(ce,Le++),de+=ae(ce,ue,K,se,re);else if(se==="object"){if(typeof ee.then=="function")return ae(V(ee),ue,K,ce,re);throw ue=String(ee),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return de}function Y(ee,ue,K){if(ee==null)return ee;var ce=[],re=0;return ae(ee,ce,"","",function(se){return ue.call(K,se,re++)}),ce}function he(ee){if(ee._status===-1){var ue=ee._result;ue=ue(),ue.then(function(K){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=K)},function(K){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=K)}),ee._status===-1&&(ee._status=0,ee._result=ue)}if(ee._status===1)return ee._result.default;throw ee._result}var J=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)};function ne(){}return Hi.Children={map:Y,forEach:function(ee,ue,K){Y(ee,function(){ue.apply(this,arguments)},K)},count:function(ee){var ue=0;return Y(ee,function(){ue++}),ue},toArray:function(ee){return Y(ee,function(ue){return ue})||[]},only:function(ee){if(!U(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},Hi.Component=M,Hi.Fragment=r,Hi.Profiler=n,Hi.PureComponent=P,Hi.StrictMode=i,Hi.Suspense=u,Hi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Hi.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return D.H.useMemoCache(ee)}},Hi.cache=function(ee){return function(){return ee.apply(null,arguments)}},Hi.cloneElement=function(ee,ue,K){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var ce=x({},ee.props),re=ee.key,se=void 0;if(ue!=null)for(de in ue.ref!==void 0&&(se=void 0),ue.key!==void 0&&(re=""+ue.key),ue)!F.call(ue,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&ue.ref===void 0||(ce[de]=ue[de]);var de=arguments.length-2;if(de===1)ce.children=K;else if(1<de){for(var we=Array(de),Le=0;Le<de;Le++)we[Le]=arguments[Le+2];ce.children=we}return k(ee.type,re,void 0,void 0,se,ce)},Hi.createContext=function(ee){return ee={$$typeof:o,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:a,_context:ee},ee},Hi.createElement=function(ee,ue,K){var ce,re={},se=null;if(ue!=null)for(ce in ue.key!==void 0&&(se=""+ue.key),ue)F.call(ue,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(re[ce]=ue[ce]);var de=arguments.length-2;if(de===1)re.children=K;else if(1<de){for(var we=Array(de),Le=0;Le<de;Le++)we[Le]=arguments[Le+2];re.children=we}if(ee&&ee.defaultProps)for(ce in de=ee.defaultProps,de)re[ce]===void 0&&(re[ce]=de[ce]);return k(ee,se,void 0,void 0,null,re)},Hi.createRef=function(){return{current:null}},Hi.forwardRef=function(ee){return{$$typeof:l,render:ee}},Hi.isValidElement=U,Hi.lazy=function(ee){return{$$typeof:p,_payload:{_status:-1,_result:ee},_init:he}},Hi.memo=function(ee,ue){return{$$typeof:c,type:ee,compare:ue===void 0?null:ue}},Hi.startTransition=function(ee){var ue=D.T,K={};D.T=K;try{var ce=ee(),re=D.S;re!==null&&re(K,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(ne,J)}catch(se){J(se)}finally{D.T=ue}},Hi.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Hi.use=function(ee){return D.H.use(ee)},Hi.useActionState=function(ee,ue,K){return D.H.useActionState(ee,ue,K)},Hi.useCallback=function(ee,ue){return D.H.useCallback(ee,ue)},Hi.useContext=function(ee){return D.H.useContext(ee)},Hi.useDebugValue=function(){},Hi.useDeferredValue=function(ee,ue){return D.H.useDeferredValue(ee,ue)},Hi.useEffect=function(ee,ue,K){var ce=D.H;if(typeof K=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ce.useEffect(ee,ue)},Hi.useId=function(){return D.H.useId()},Hi.useImperativeHandle=function(ee,ue,K){return D.H.useImperativeHandle(ee,ue,K)},Hi.useInsertionEffect=function(ee,ue){return D.H.useInsertionEffect(ee,ue)},Hi.useLayoutEffect=function(ee,ue){return D.H.useLayoutEffect(ee,ue)},Hi.useMemo=function(ee,ue){return D.H.useMemo(ee,ue)},Hi.useOptimistic=function(ee,ue){return D.H.useOptimistic(ee,ue)},Hi.useReducer=function(ee,ue,K){return D.H.useReducer(ee,ue,K)},Hi.useRef=function(ee){return D.H.useRef(ee)},Hi.useState=function(ee){return D.H.useState(ee)},Hi.useSyncExternalStore=function(ee,ue,K){return D.H.useSyncExternalStore(ee,ue,K)},Hi.useTransition=function(){return D.H.useTransition()},Hi.version="19.1.0",Hi}var gH;function v9(){return gH||(gH=1,wL.exports=NRe()),wL.exports}var ti=v9();const Hb=RRe(ti);var AL={exports:{}},wb={},SL={exports:{}},ML={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yH;function FRe(){return yH||(yH=1,function(t){function e(Y,he){var J=Y.length;Y.push(he);e:for(;0<J;){var ne=J-1>>>1,ee=Y[ne];if(0<n(ee,he))Y[ne]=he,Y[J]=ee,J=ne;else break e}}function r(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var he=Y[0],J=Y.pop();if(J!==he){Y[0]=J;e:for(var ne=0,ee=Y.length,ue=ee>>>1;ne<ue;){var K=2*(ne+1)-1,ce=Y[K],re=K+1,se=Y[re];if(0>n(ce,J))re<ee&&0>n(se,ce)?(Y[ne]=se,Y[re]=J,ne=re):(Y[ne]=ce,Y[K]=J,ne=K);else if(re<ee&&0>n(se,J))Y[ne]=se,Y[re]=J,ne=re;else break e}}return he}function n(Y,he){var J=Y.sortIndex-he.sortIndex;return J!==0?J:Y.id-he.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],p=1,m=null,y=3,v=!1,x=!1,E=!1,M=!1,I=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function T(Y){for(var he=r(c);he!==null;){if(he.callback===null)i(c);else if(he.startTime<=Y)i(c),he.sortIndex=he.expirationTime,e(u,he);else break;he=r(c)}}function D(Y){if(E=!1,T(Y),!x)if(r(u)!==null)x=!0,F||(F=!0,Z());else{var he=r(c);he!==null&&ae(D,he.startTime-Y)}}var F=!1,k=-1,B=5,U=-1;function z(){return M?!0:!(t.unstable_now()-U<B)}function q(){if(M=!1,F){var Y=t.unstable_now();U=Y;var he=!0;try{e:{x=!1,E&&(E=!1,P(k),k=-1),v=!0;var J=y;try{t:{for(T(Y),m=r(u);m!==null&&!(m.expirationTime>Y&&z());){var ne=m.callback;if(typeof ne=="function"){m.callback=null,y=m.priorityLevel;var ee=ne(m.expirationTime<=Y);if(Y=t.unstable_now(),typeof ee=="function"){m.callback=ee,T(Y),he=!0;break t}m===r(u)&&i(u),T(Y)}else i(u);m=r(u)}if(m!==null)he=!0;else{var ue=r(c);ue!==null&&ae(D,ue.startTime-Y),he=!1}}break e}finally{m=null,y=J,v=!1}he=void 0}}finally{he?Z():F=!1}}}var Z;if(typeof C=="function")Z=function(){C(q)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,V=Q.port2;Q.port1.onmessage=q,Z=function(){V.postMessage(null)}}else Z=function(){I(q,0)};function ae(Y,he){k=I(function(){Y(t.unstable_now())},he)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(Y){switch(y){case 1:case 2:case 3:var he=3;break;default:he=y}var J=y;y=he;try{return Y()}finally{y=J}},t.unstable_requestPaint=function(){M=!0},t.unstable_runWithPriority=function(Y,he){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var J=y;y=Y;try{return he()}finally{y=J}},t.unstable_scheduleCallback=function(Y,he,J){var ne=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ne+J:ne):J=ne,Y){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=J+ee,Y={id:p++,callback:he,priorityLevel:Y,startTime:J,expirationTime:ee,sortIndex:-1},J>ne?(Y.sortIndex=J,e(c,Y),r(u)===null&&Y===r(c)&&(E?(P(k),k=-1):E=!0,ae(D,J-ne))):(Y.sortIndex=ee,e(u,Y),x||v||(x=!0,F||(F=!0,Z()))),Y},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(Y){var he=y;return function(){var J=y;y=he;try{return Y.apply(this,arguments)}finally{y=J}}}}(ML)),ML}var vH;function BRe(){return vH||(vH=1,SL.exports=FRe()),SL.exports}var EL={exports:{}},vl={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _H;function zRe(){if(_H)return vl;_H=1;var t=v9();function e(u){var c="https://react.dev/errors/"+u;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function a(u,c,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:m==null?null:""+m,children:u,containerInfo:c,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,c){if(u==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return vl.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vl.createPortal=function(u,c){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return a(u,c,null,p)},vl.flushSync=function(u){var c=o.T,p=i.p;try{if(o.T=null,i.p=2,u)return u()}finally{o.T=c,i.p=p,i.d.f()}},vl.preconnect=function(u,c){typeof u=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(u,c))},vl.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},vl.preinit=function(u,c){if(typeof u=="string"&&c&&typeof c.as=="string"){var p=c.as,m=l(p,c.crossOrigin),y=typeof c.integrity=="string"?c.integrity:void 0,v=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;p==="style"?i.d.S(u,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:v}):p==="script"&&i.d.X(u,{crossOrigin:m,integrity:y,fetchPriority:v,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},vl.preinitModule=function(u,c){if(typeof u=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var p=l(c.as,c.crossOrigin);i.d.M(u,{crossOrigin:p,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(u)},vl.preload=function(u,c){if(typeof u=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var p=c.as,m=l(p,c.crossOrigin);i.d.L(u,p,{crossOrigin:m,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},vl.preloadModule=function(u,c){if(typeof u=="string")if(c){var p=l(c.as,c.crossOrigin);i.d.m(u,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:p,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(u)},vl.requestFormReset=function(u){i.d.r(u)},vl.unstable_batchedUpdates=function(u,c){return u(c)},vl.useFormState=function(u,c,p){return o.H.useFormState(u,c,p)},vl.useFormStatus=function(){return o.H.useHostTransitionStatus()},vl.version="19.1.0",vl}var xH;function WX(){if(xH)return EL.exports;xH=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),EL.exports=zRe(),EL.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bH;function URe(){if(bH)return wb;bH=1;var t=BRe(),e=v9(),r=WX();function i(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var g=d,b=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,(g.flags&4098)!==0&&(b=g.return),d=g.return;while(d)}return g.tag===3?b:null}function o(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function l(d){if(a(d)!==d)throw Error(i(188))}function u(d){var g=d.alternate;if(!g){if(g=a(d),g===null)throw Error(i(188));return g!==d?null:d}for(var b=d,L=g;;){var G=b.return;if(G===null)break;var W=G.alternate;if(W===null){if(L=G.return,L!==null){b=L;continue}break}if(G.child===W.child){for(W=G.child;W;){if(W===b)return l(G),d;if(W===L)return l(G),g;W=W.sibling}throw Error(i(188))}if(b.return!==L.return)b=G,L=W;else{for(var ye=!1,Pe=G.child;Pe;){if(Pe===b){ye=!0,b=G,L=W;break}if(Pe===L){ye=!0,L=G,b=W;break}Pe=Pe.sibling}if(!ye){for(Pe=W.child;Pe;){if(Pe===b){ye=!0,b=W,L=G;break}if(Pe===L){ye=!0,L=W,b=G;break}Pe=Pe.sibling}if(!ye)throw Error(i(189))}}if(b.alternate!==L)throw Error(i(190))}if(b.tag!==3)throw Error(i(188));return b.stateNode.current===b?d:g}function c(d){var g=d.tag;if(g===5||g===26||g===27||g===6)return d;for(d=d.child;d!==null;){if(g=c(d),g!==null)return g;d=d.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),P=Symbol.for("react.consumer"),C=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function Z(d){return d===null||typeof d!="object"?null:(d=q&&d[q]||d["@@iterator"],typeof d=="function"?d:null)}var Q=Symbol.for("react.client.reference");function V(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===Q?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case x:return"Fragment";case M:return"Profiler";case E:return"StrictMode";case D:return"Suspense";case F:return"SuspenseList";case U:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case v:return"Portal";case C:return(d.displayName||"Context")+".Provider";case P:return(d._context.displayName||"Context")+".Consumer";case T:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case k:return g=d.displayName||null,g!==null?g:V(d.type)||"Memo";case B:g=d._payload,d=d._init;try{return V(d(g))}catch{}}return null}var ae=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},ne=[],ee=-1;function ue(d){return{current:d}}function K(d){0>ee||(d.current=ne[ee],ne[ee]=null,ee--)}function ce(d,g){ee++,ne[ee]=d.current,d.current=g}var re=ue(null),se=ue(null),de=ue(null),we=ue(null);function Le(d,g){switch(ce(de,g),ce(se,d),ce(re,null),g.nodeType){case 9:case 11:d=(d=g.documentElement)&&(d=d.namespaceURI)?VG(d):0;break;default:if(d=g.tagName,g=g.namespaceURI)g=VG(g),d=jG(g,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}K(re),ce(re,d)}function fe(){K(re),K(se),K(de)}function Re(d){d.memoizedState!==null&&ce(we,d);var g=re.current,b=jG(g,d.type);g!==b&&(ce(se,d),ce(re,b))}function me(d){se.current===d&&(K(re),K(se)),we.current===d&&(K(we),gb._currentValue=J)}var Ae=Object.prototype.hasOwnProperty,Ue=t.unstable_scheduleCallback,_e=t.unstable_cancelCallback,lt=t.unstable_shouldYield,tt=t.unstable_requestPaint,We=t.unstable_now,at=t.unstable_getCurrentPriorityLevel,Lt=t.unstable_ImmediatePriority,dt=t.unstable_UserBlockingPriority,Me=t.unstable_NormalPriority,ve=t.unstable_LowPriority,Ze=t.unstable_IdlePriority,It=t.log,Rt=t.unstable_setDisableYieldValue,Et=null,pt=null;function Yt(d){if(typeof It=="function"&&Rt(d),pt&&typeof pt.setStrictMode=="function")try{pt.setStrictMode(Et,d)}catch{}}var Kt=Math.clz32?Math.clz32:Nt,$t=Math.log,jt=Math.LN2;function Nt(d){return d>>>=0,d===0?32:31-($t(d)/jt|0)|0}var Fe=256,Xe=4194304;function ht(d){var g=d&42;if(g!==0)return g;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function rr(d,g,b){var L=d.pendingLanes;if(L===0)return 0;var G=0,W=d.suspendedLanes,ye=d.pingedLanes;d=d.warmLanes;var Pe=L&134217727;return Pe!==0?(L=Pe&~W,L!==0?G=ht(L):(ye&=Pe,ye!==0?G=ht(ye):b||(b=Pe&~d,b!==0&&(G=ht(b))))):(Pe=L&~W,Pe!==0?G=ht(Pe):ye!==0?G=ht(ye):b||(b=L&~d,b!==0&&(G=ht(b)))),G===0?0:g!==0&&g!==G&&(g&W)===0&&(W=G&-G,b=g&-g,W>=b||W===32&&(b&4194048)!==0)?g:G}function ar(d,g){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&g)===0}function zr(d,g){switch(d){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qe(){var d=Fe;return Fe<<=1,(Fe&4194048)===0&&(Fe=256),d}function er(){var d=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),d}function Oe(d){for(var g=[],b=0;31>b;b++)g.push(d);return g}function oe(d,g){d.pendingLanes|=g,g!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function le(d,g,b,L,G,W){var ye=d.pendingLanes;d.pendingLanes=b,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=b,d.entangledLanes&=b,d.errorRecoveryDisabledLanes&=b,d.shellSuspendCounter=0;var Pe=d.entanglements,Ke=d.expirationTimes,Ct=d.hiddenUpdates;for(b=ye&~b;0<b;){var Xt=31-Kt(b),tr=1<<Xt;Pe[Xt]=0,Ke[Xt]=-1;var Dt=Ct[Xt];if(Dt!==null)for(Ct[Xt]=null,Xt=0;Xt<Dt.length;Xt++){var Ot=Dt[Xt];Ot!==null&&(Ot.lane&=-536870913)}b&=~tr}L!==0&&Se(d,L,0),W!==0&&G===0&&d.tag!==0&&(d.suspendedLanes|=W&~(ye&~g))}function Se(d,g,b){d.pendingLanes|=g,d.suspendedLanes&=~g;var L=31-Kt(g);d.entangledLanes|=g,d.entanglements[L]=d.entanglements[L]|1073741824|b&4194090}function ze(d,g){var b=d.entangledLanes|=g;for(d=d.entanglements;b;){var L=31-Kt(b),G=1<<L;G&g|d[L]&g&&(d[L]|=g),b&=~G}}function De(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function yt(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function st(){var d=he.p;return d!==0?d:(d=window.event,d===void 0?32:sH(d.type))}function kt(d,g){var b=he.p;try{return he.p=d,g()}finally{he.p=b}}var mt=Math.random().toString(36).slice(2),Gt="__reactFiber$"+mt,ke="__reactProps$"+mt,$e="__reactContainer$"+mt,ot="__reactEvents$"+mt,Ft="__reactListeners$"+mt,Ht="__reactHandles$"+mt,fr="__reactResources$"+mt,nr="__reactMarker$"+mt;function Zr(d){delete d[Gt],delete d[ke],delete d[ot],delete d[Ft],delete d[Ht]}function ni(d){var g=d[Gt];if(g)return g;for(var b=d.parentNode;b;){if(g=b[$e]||b[Gt]){if(b=g.alternate,g.child!==null||b!==null&&b.child!==null)for(d=qG(d);d!==null;){if(b=d[Gt])return b;d=qG(d)}return g}d=b,b=d.parentNode}return null}function Yr(d){if(d=d[Gt]||d[$e]){var g=d.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return d}return null}function Cr(d){var g=d.tag;if(g===5||g===26||g===27||g===6)return d.stateNode;throw Error(i(33))}function Mi(d){var g=d[fr];return g||(g=d[fr]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function $r(d){d[nr]=!0}var Qi=new Set,Gi={};function Mn(d,g){Ie(d,g),Ie(d+"Capture",g)}function Ie(d,g){for(Gi[d]=g,d=0;d<g.length;d++)Qi.add(g[d])}var Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wt={},ft={};function rt(d){return Ae.call(ft,d)?!0:Ae.call(wt,d)?!1:Je.test(d)?ft[d]=!0:(wt[d]=!0,!1)}function zt(d,g,b){if(rt(g))if(b===null)d.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":d.removeAttribute(g);return;case"boolean":var L=g.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){d.removeAttribute(g);return}}d.setAttribute(g,""+b)}}function cr(d,g,b){if(b===null)d.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(g);return}d.setAttribute(g,""+b)}}function ur(d,g,b,L){if(L===null)d.removeAttribute(b);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(b);return}d.setAttributeNS(g,b,""+L)}}var Ar,kr;function qr(d){if(Ar===void 0)try{throw Error()}catch(b){var g=b.stack.trim().match(/\n( *(at )?)/);Ar=g&&g[1]||"",kr=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ar+d+kr}var Wr=!1;function vi(d,g){if(!d||Wr)return"";Wr=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(g){var tr=function(){throw Error()};if(Object.defineProperty(tr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(tr,[])}catch(Ot){var Dt=Ot}Reflect.construct(d,[],tr)}else{try{tr.call()}catch(Ot){Dt=Ot}d.call(tr.prototype)}}else{try{throw Error()}catch(Ot){Dt=Ot}(tr=d())&&typeof tr.catch=="function"&&tr.catch(function(){})}}catch(Ot){if(Ot&&Dt&&typeof Ot.stack=="string")return[Ot.stack,Dt.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var G=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");G&&G.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var W=L.DetermineComponentFrameRoot(),ye=W[0],Pe=W[1];if(ye&&Pe){var Ke=ye.split(`
`),Ct=Pe.split(`
`);for(G=L=0;L<Ke.length&&!Ke[L].includes("DetermineComponentFrameRoot");)L++;for(;G<Ct.length&&!Ct[G].includes("DetermineComponentFrameRoot");)G++;if(L===Ke.length||G===Ct.length)for(L=Ke.length-1,G=Ct.length-1;1<=L&&0<=G&&Ke[L]!==Ct[G];)G--;for(;1<=L&&0<=G;L--,G--)if(Ke[L]!==Ct[G]){if(L!==1||G!==1)do if(L--,G--,0>G||Ke[L]!==Ct[G]){var Xt=`
`+Ke[L].replace(" at new "," at ");return d.displayName&&Xt.includes("<anonymous>")&&(Xt=Xt.replace("<anonymous>",d.displayName)),Xt}while(1<=L&&0<=G);break}}}finally{Wr=!1,Error.prepareStackTrace=b}return(b=d?d.displayName||d.name:"")?qr(b):""}function Li(d){switch(d.tag){case 26:case 27:case 5:return qr(d.type);case 16:return qr("Lazy");case 13:return qr("Suspense");case 19:return qr("SuspenseList");case 0:case 15:return vi(d.type,!1);case 11:return vi(d.type.render,!1);case 1:return vi(d.type,!0);case 31:return qr("Activity");default:return""}}function Ur(d){try{var g="";do g+=Li(d),d=d.return;while(d);return g}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function yi(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function bi(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Xr(d){var g=bi(d)?"checked":"value",b=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),L=""+d[g];if(!d.hasOwnProperty(g)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var G=b.get,W=b.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return G.call(this)},set:function(ye){L=""+ye,W.call(this,ye)}}),Object.defineProperty(d,g,{enumerable:b.enumerable}),{getValue:function(){return L},setValue:function(ye){L=""+ye},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function Vr(d){d._valueTracker||(d._valueTracker=Xr(d))}function si(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var b=g.getValue(),L="";return d&&(L=bi(d)?d.checked?"true":"false":d.value),d=L,d!==b?(g.setValue(d),!0):!1}function oa(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ea=/[\n"\\]/g;function Ui(d){return d.replace(ea,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Gr(d,g,b,L,G,W,ye,Pe){d.name="",ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"?d.type=ye:d.removeAttribute("type"),g!=null?ye==="number"?(g===0&&d.value===""||d.value!=g)&&(d.value=""+yi(g)):d.value!==""+yi(g)&&(d.value=""+yi(g)):ye!=="submit"&&ye!=="reset"||d.removeAttribute("value"),g!=null?O(d,ye,yi(g)):b!=null?O(d,ye,yi(b)):L!=null&&d.removeAttribute("value"),G==null&&W!=null&&(d.defaultChecked=!!W),G!=null&&(d.checked=G&&typeof G!="function"&&typeof G!="symbol"),Pe!=null&&typeof Pe!="function"&&typeof Pe!="symbol"&&typeof Pe!="boolean"?d.name=""+yi(Pe):d.removeAttribute("name")}function S(d,g,b,L,G,W,ye,Pe){if(W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(d.type=W),g!=null||b!=null){if(!(W!=="submit"&&W!=="reset"||g!=null))return;b=b!=null?""+yi(b):"",g=g!=null?""+yi(g):b,Pe||g===d.value||(d.value=g),d.defaultValue=g}L=L??G,L=typeof L!="function"&&typeof L!="symbol"&&!!L,d.checked=Pe?d.checked:!!L,d.defaultChecked=!!L,ye!=null&&typeof ye!="function"&&typeof ye!="symbol"&&typeof ye!="boolean"&&(d.name=ye)}function O(d,g,b){g==="number"&&oa(d.ownerDocument)===d||d.defaultValue===""+b||(d.defaultValue=""+b)}function j(d,g,b,L){if(d=d.options,g){g={};for(var G=0;G<b.length;G++)g["$"+b[G]]=!0;for(b=0;b<d.length;b++)G=g.hasOwnProperty("$"+d[b].value),d[b].selected!==G&&(d[b].selected=G),G&&L&&(d[b].defaultSelected=!0)}else{for(b=""+yi(b),g=null,G=0;G<d.length;G++){if(d[G].value===b){d[G].selected=!0,L&&(d[G].defaultSelected=!0);return}g!==null||d[G].disabled||(g=d[G])}g!==null&&(g.selected=!0)}}function X(d,g,b){if(g!=null&&(g=""+yi(g),g!==d.value&&(d.value=g),b==null)){d.defaultValue!==g&&(d.defaultValue=g);return}d.defaultValue=b!=null?""+yi(b):""}function ie(d,g,b,L){if(g==null){if(L!=null){if(b!=null)throw Error(i(92));if(ae(L)){if(1<L.length)throw Error(i(93));L=L[0]}b=L}b==null&&(b=""),g=b}b=yi(g),d.defaultValue=b,L=d.textContent,L===b&&L!==""&&L!==null&&(d.value=L)}function be(d,g){if(g){var b=d.firstChild;if(b&&b===d.lastChild&&b.nodeType===3){b.nodeValue=g;return}}d.textContent=g}var Ce=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Te(d,g,b){var L=g.indexOf("--")===0;b==null||typeof b=="boolean"||b===""?L?d.setProperty(g,""):g==="float"?d.cssFloat="":d[g]="":L?d.setProperty(g,b):typeof b!="number"||b===0||Ce.has(g)?g==="float"?d.cssFloat=b:d[g]=(""+b).trim():d[g]=b+"px"}function ct(d,g,b){if(g!=null&&typeof g!="object")throw Error(i(62));if(d=d.style,b!=null){for(var L in b)!b.hasOwnProperty(L)||g!=null&&g.hasOwnProperty(L)||(L.indexOf("--")===0?d.setProperty(L,""):L==="float"?d.cssFloat="":d[L]="");for(var G in g)L=g[G],g.hasOwnProperty(G)&&b[G]!==L&&Te(d,G,L)}else for(var W in g)g.hasOwnProperty(W)&&Te(d,W,g[W])}function _t(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),sr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mr(d){return sr.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var xr=null;function lr(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Er=null,on=null;function ta(d){var g=Yr(d);if(g&&(d=g.stateNode)){var b=d[ke]||null;e:switch(d=g.stateNode,g.type){case"input":if(Gr(d,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name),g=b.name,b.type==="radio"&&g!=null){for(b=d;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll('input[name="'+Ui(""+g)+'"][type="radio"]'),g=0;g<b.length;g++){var L=b[g];if(L!==d&&L.form===d.form){var G=L[ke]||null;if(!G)throw Error(i(90));Gr(L,G.value,G.defaultValue,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name)}}for(g=0;g<b.length;g++)L=b[g],L.form===d.form&&si(L)}break e;case"textarea":X(d,b.value,b.defaultValue);break e;case"select":g=b.value,g!=null&&j(d,!!b.multiple,g,!1)}}}var sn=!1;function Bl(d,g,b){if(sn)return d(g,b);sn=!0;try{var L=d(g);return L}finally{if(sn=!1,(Er!==null||on!==null)&&(JS(),Er&&(g=Er,d=on,on=Er=null,ta(g),d)))for(g=0;g<d.length;g++)ta(d[g])}}function sa(d,g){var b=d.stateNode;if(b===null)return null;var L=b[ke]||null;if(L===null)return null;b=L[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(d=d.type,L=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!L;break e;default:d=!1}if(d)return null;if(b&&typeof b!="function")throw Error(i(231,g,typeof b));return b}var li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vo=!1;if(li)try{var ki={};Object.defineProperty(ki,"passive",{get:function(){vo=!0}}),window.addEventListener("test",ki,ki),window.removeEventListener("test",ki,ki)}catch{vo=!1}var _o=null,hl=null,ln=null;function Ia(){if(ln)return ln;var d,g=hl,b=g.length,L,G="value"in _o?_o.value:_o.textContent,W=G.length;for(d=0;d<b&&g[d]===G[d];d++);var ye=b-d;for(L=1;L<=ye&&g[b-L]===G[W-L];L++);return ln=G.slice(d,1<L?1-L:void 0)}function zl(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function Oa(){return!0}function gs(){return!1}function qn(d){function g(b,L,G,W,ye){this._reactName=b,this._targetInst=G,this.type=L,this.nativeEvent=W,this.target=ye,this.currentTarget=null;for(var Pe in d)d.hasOwnProperty(Pe)&&(b=d[Pe],this[Pe]=b?b(W):W[Pe]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?Oa:gs,this.isPropagationStopped=gs,this}return p(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=Oa)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=Oa)},persist:function(){},isPersistent:Oa}),g}var Ve={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},et=qn(Ve),xe=p({},Ve,{view:0,detail:0}),Ge=qn(xe),nt,Wt,Nr,Dr=p({},xe,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ic,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Nr&&(Nr&&d.type==="mousemove"?(nt=d.screenX-Nr.screenX,Wt=d.screenY-Nr.screenY):Wt=nt=0,Nr=d),nt)},movementY:function(d){return"movementY"in d?d.movementY:Wt}}),ui=qn(Dr),mi=p({},Dr,{dataTransfer:0}),Ni=qn(mi),un=p({},xe,{relatedTarget:0}),Un=qn(un),Wn=p({},Ve,{animationName:0,elapsedTime:0,pseudoElement:0}),pl=qn(Wn),qs=p({},Ve,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),ip=qn(qs),ba=p({},Ve,{data:0}),jr=qn(ba),xS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Is={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ou(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=Is[d])?!!g[d]:!1}function Ic(){return ou}var bg=p({},xe,{key:function(d){if(d.key){var g=xS[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=zl(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?xg[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ic,charCode:function(d){return d.type==="keypress"?zl(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?zl(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Vx=qn(bg),bS=p({},Dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wi=qn(bS),Tc=p({},xe,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ic}),la=qn(Tc),wg=p({},Ve,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ws=qn(wg),wS=p({},Dr,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Fi=qn(wS),cd=p({},Ve,{newState:0,oldState:0}),Vn=qn(cd),Ag=[9,13,27,32],Po=li&&"CompositionEvent"in window,Wu=null;li&&"documentMode"in document&&(Wu=document.documentMode);var AS=li&&"TextEvent"in window&&!Wu,sh=li&&(!Po||Wu&&8<Wu&&11>=Wu),Xi=" ",Xs=!1;function hd(d,g){switch(d){case"keyup":return Ag.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function su(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var xo=!1;function Lo(d,g){switch(d){case"compositionend":return su(g);case"keypress":return g.which!==32?null:(Xs=!0,Xi);case"textInput":return d=g.data,d===Xi&&Xs?null:d;default:return null}}function Y4(d,g){if(xo)return d==="compositionend"||!Po&&hd(d,g)?(d=Ia(),ln=hl=_o=null,xo=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return sh&&g.locale!=="ko"?null:g.data;default:return null}}var SS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pc(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!SS[d.type]:g==="textarea"}function dl(d,g,b,L){Er?on?on.push(L):on=[L]:Er=L,g=nM(g,"onChange"),0<g.length&&(b=new et("onChange","change",null,b,L),d.push({event:b,listeners:g}))}var lu=null,Do=null;function uu(d){NG(d,0)}function fl(d){var g=Cr(d);if(si(g))return d}function lh(d,g){if(d==="change")return g}var Xu=!1;if(li){var Wa;if(li){var Lv="oninput"in document;if(!Lv){var Sg=document.createElement("div");Sg.setAttribute("oninput","return;"),Lv=typeof Sg.oninput=="function"}Wa=Lv}else Wa=!1;Xu=Wa&&(!document.documentMode||9<document.documentMode)}function Ro(){lu&&(lu.detachEvent("onpropertychange",Lc),Do=lu=null)}function Lc(d){if(d.propertyName==="value"&&fl(Do)){var g=[];dl(g,Do,d,lr(d)),Bl(uu,g)}}function cu(d,g,b){d==="focusin"?(Ro(),lu=g,Do=b,lu.attachEvent("onpropertychange",Lc)):d==="focusout"&&Ro()}function MS(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return fl(Do)}function ys(d,g){if(d==="click")return fl(g)}function ES(d,g){if(d==="input"||d==="change")return fl(g)}function Mg(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var Qo=typeof Object.is=="function"?Object.is:Mg;function Df(d,g){if(Qo(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var b=Object.keys(d),L=Object.keys(g);if(b.length!==L.length)return!1;for(L=0;L<b.length;L++){var G=b[L];if(!Ae.call(g,G)||!Qo(d[G],g[G]))return!1}return!0}function jx(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function np(d,g){var b=jx(d);d=0;for(var L;b;){if(b.nodeType===3){if(L=d+b.textContent.length,d<=g&&L>=g)return{node:b,offset:g-d};d=L}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=jx(b)}}function hu(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?hu(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function oo(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var g=oa(d.document);g instanceof d.HTMLIFrameElement;){try{var b=typeof g.contentWindow.location.href=="string"}catch{b=!1}if(b)d=g.contentWindow;else break;g=oa(d.document)}return g}function ap(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}var es=li&&"documentMode"in document&&11>=document.documentMode,Ts=null,Dc=null,pd=null,uh=!1;function Rc(d,g,b){var L=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;uh||Ts==null||Ts!==oa(L)||(L=Ts,"selectionStart"in L&&ap(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),pd&&Df(pd,L)||(pd=L,L=nM(Dc,"onSelect"),0<L.length&&(g=new et("onSelect","select",null,g,b),d.push({event:g,listeners:L}),g.target=Ts)))}function Ps(d,g){var b={};return b[d.toLowerCase()]=g.toLowerCase(),b["Webkit"+d]="webkit"+g,b["Moz"+d]="moz"+g,b}var wa={animationend:Ps("Animation","AnimationEnd"),animationiteration:Ps("Animation","AnimationIteration"),animationstart:Ps("Animation","AnimationStart"),transitionrun:Ps("Transition","TransitionRun"),transitionstart:Ps("Transition","TransitionStart"),transitioncancel:Ps("Transition","TransitionCancel"),transitionend:Ps("Transition","TransitionEnd")},Zs={},Oo={};li&&(Oo=document.createElement("div").style,"AnimationEvent"in window||(delete wa.animationend.animation,delete wa.animationiteration.animation,delete wa.animationstart.animation),"TransitionEvent"in window||delete wa.transitionend.transition);function op(d){if(Zs[d])return Zs[d];if(!wa[d])return d;var g=wa[d],b;for(b in g)if(g.hasOwnProperty(b)&&b in Oo)return Zs[d]=g[b];return d}var Oc=op("animationend"),sp=op("animationiteration"),so=op("animationstart"),ko=op("transitionrun"),pu=op("transitionstart"),ml=op("transitioncancel"),Dv=op("transitionend"),lp=new Map,Zu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zu.push("scrollEnd");function ua(d,g){lp.set(d,g),Mn(g,[d])}var Rv=new WeakMap;function Pn(d,g){if(typeof d=="object"&&d!==null){var b=Rv.get(d);return b!==void 0?b:(g={value:d,source:g,stack:Ur(g)},Rv.set(d,g),g)}return{value:d,source:g,stack:Ur(g)}}var gl=[],vs=0,ka=0;function Ls(){for(var d=vs,g=ka=vs=0;g<d;){var b=gl[g];gl[g++]=null;var L=gl[g];gl[g++]=null;var G=gl[g];gl[g++]=null;var W=gl[g];if(gl[g++]=null,L!==null&&G!==null){var ye=L.pending;ye===null?G.next=G:(G.next=ye.next,ye.next=G),L.pending=G}W!==0&&up(b,G,W)}}function Yu(d,g,b,L){gl[vs++]=d,gl[vs++]=g,gl[vs++]=b,gl[vs++]=L,ka|=L,d.lanes|=L,d=d.alternate,d!==null&&(d.lanes|=L)}function ch(d,g,b,L){return Yu(d,g,b,L),bo(d)}function _s(d,g){return Yu(d,null,null,g),bo(d)}function up(d,g,b){d.lanes|=b;var L=d.alternate;L!==null&&(L.lanes|=b);for(var G=!1,W=d.return;W!==null;)W.childLanes|=b,L=W.alternate,L!==null&&(L.childLanes|=b),W.tag===22&&(d=W.stateNode,d===null||d._visibility&1||(G=!0)),d=W,W=W.return;return d.tag===3?(W=d.stateNode,G&&g!==null&&(G=31-Kt(b),d=W.hiddenUpdates,L=d[G],L===null?d[G]=[g]:L.push(g),g.lane=b|536870912),W):null}function bo(d){if(50<lb)throw lb=0,H5=null,Error(i(185));for(var g=d.return;g!==null;)d=g,g=d.return;return d.tag===3?d.stateNode:null}var Ds={};function Aa(d,g,b,L){this.tag=d,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yl(d,g,b,L){return new Aa(d,g,b,L)}function Ov(d){return d=d.prototype,!(!d||!d.isReactComponent)}function ca(d,g){var b=d.alternate;return b===null?(b=yl(d.tag,g,d.key,d.mode),b.elementType=d.elementType,b.type=d.type,b.stateNode=d.stateNode,b.alternate=d,d.alternate=b):(b.pendingProps=g,b.type=d.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=d.flags&65011712,b.childLanes=d.childLanes,b.lanes=d.lanes,b.child=d.child,b.memoizedProps=d.memoizedProps,b.memoizedState=d.memoizedState,b.updateQueue=d.updateQueue,g=d.dependencies,b.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},b.sibling=d.sibling,b.index=d.index,b.ref=d.ref,b.refCleanup=d.refCleanup,b}function kc(d,g){d.flags&=65011714;var b=d.alternate;return b===null?(d.childLanes=0,d.lanes=g,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=b.childLanes,d.lanes=b.lanes,d.child=b.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=b.memoizedProps,d.memoizedState=b.memoizedState,d.updateQueue=b.updateQueue,d.type=b.type,g=b.dependencies,d.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),d}function Rf(d,g,b,L,G,W){var ye=0;if(L=d,typeof d=="function")Ov(d)&&(ye=1);else if(typeof d=="string")ye=xRe(d,b,re.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case U:return d=yl(31,b,g,G),d.elementType=U,d.lanes=W,d;case x:return Ul(b.children,G,W,g);case E:ye=8,G|=24;break;case M:return d=yl(12,b,g,G|2),d.elementType=M,d.lanes=W,d;case D:return d=yl(13,b,g,G),d.elementType=D,d.lanes=W,d;case F:return d=yl(19,b,g,G),d.elementType=F,d.lanes=W,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case I:case C:ye=10;break e;case P:ye=9;break e;case T:ye=11;break e;case k:ye=14;break e;case B:ye=16,L=null;break e}ye=29,b=Error(i(130,d===null?"null":typeof d,"")),L=null}return g=yl(ye,b,g,G),g.elementType=d,g.type=L,g.lanes=W,g}function Ul(d,g,b,L){return d=yl(7,d,L,g),d.lanes=b,d}function Ku(d,g,b){return d=yl(6,d,null,g),d.lanes=b,d}function Na(d,g,b){return g=yl(4,d.children!==null?d.children:[],d.key,g),g.lanes=b,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}var Fa=[],Nc=0,No=null,Of=0,Ys=[],Ln=0,dd=null,Fo=1,Fc="";function Ju(d,g){Fa[Nc++]=Of,Fa[Nc++]=No,No=d,Of=g}function CS(d,g,b){Ys[Ln++]=Fo,Ys[Ln++]=Fc,Ys[Ln++]=dd,dd=d;var L=Fo;d=Fc;var G=32-Kt(L)-1;L&=~(1<<G),b+=1;var W=32-Kt(g)+G;if(30<W){var ye=G-G%5;W=(L&(1<<ye)-1).toString(32),L>>=ye,G-=ye,Fo=1<<32-Kt(g)+G|b<<G|L,Fc=W+d}else Fo=1<<W|b<<G|L,Fc=d}function $x(d){d.return!==null&&(Ju(d,1),CS(d,1,0))}function Vl(d){for(;d===No;)No=Fa[--Nc],Fa[Nc]=null,Of=Fa[--Nc],Fa[Nc]=null;for(;d===dd;)dd=Ys[--Ln],Ys[Ln]=null,Fc=Ys[--Ln],Ys[Ln]=null,Fo=Ys[--Ln],Ys[Ln]=null}var wo=null,ra=null,xn=!1,du=null,xs=!1,fd=Error(i(519));function fu(d){var g=Error(i(418,""));throw Bo(Pn(g,d)),fd}function hh(d){var g=d.stateNode,b=d.type,L=d.memoizedProps;switch(g[Gt]=d,g[ke]=L,b){case"dialog":fn("cancel",g),fn("close",g);break;case"iframe":case"object":case"embed":fn("load",g);break;case"video":case"audio":for(b=0;b<cb.length;b++)fn(cb[b],g);break;case"source":fn("error",g);break;case"img":case"image":case"link":fn("error",g),fn("load",g);break;case"details":fn("toggle",g);break;case"input":fn("invalid",g),S(g,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),Vr(g);break;case"select":fn("invalid",g);break;case"textarea":fn("invalid",g),ie(g,L.value,L.defaultValue,L.children),Vr(g)}b=L.children,typeof b!="string"&&typeof b!="number"&&typeof b!="bigint"||g.textContent===""+b||L.suppressHydrationWarning===!0||UG(g.textContent,b)?(L.popover!=null&&(fn("beforetoggle",g),fn("toggle",g)),L.onScroll!=null&&fn("scroll",g),L.onScrollEnd!=null&&fn("scrollend",g),L.onClick!=null&&(g.onclick=aM),g=!0):g=!1,g||fu(d)}function fi(d){for(wo=d.return;wo;)switch(wo.tag){case 5:case 13:xs=!1;return;case 27:case 3:xs=!0;return;default:wo=wo.return}}function jl(d){if(d!==wo)return!1;if(!xn)return fi(d),xn=!0,!1;var g=d.tag,b;if((b=g!==3&&g!==27)&&((b=g===5)&&(b=d.type,b=!(b!=="form"&&b!=="button")||sL(d.type,d.memoizedProps)),b=!b),b&&ra&&fu(d),fi(d),g===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8)if(b=d.data,b==="/$"){if(g===0){ra=gh(d.nextSibling);break e}g--}else b!=="$"&&b!=="$!"&&b!=="$?"||g++;d=d.nextSibling}ra=null}}else g===27?(g=ra,Zf(d.type)?(d=hL,hL=null,ra=d):ra=g):ra=wo?gh(d.stateNode.nextSibling):null;return!0}function Bc(){ra=wo=null,xn=!1}function ph(){var d=du;return d!==null&&(vu===null?vu=d:vu.push.apply(vu,d),du=null),d}function Bo(d){du===null?du=[d]:du.push(d)}var kv=ue(null),lo=null,En=null;function dh(d,g,b){ce(kv,g._currentValue),g._currentValue=b}function $l(d){d._currentValue=kv.current,K(kv)}function h(d,g,b){for(;d!==null;){var L=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,L!==null&&(L.childLanes|=g)):L!==null&&(L.childLanes&g)!==g&&(L.childLanes|=g),d===b)break;d=d.return}}function f(d,g,b,L){var G=d.child;for(G!==null&&(G.return=d);G!==null;){var W=G.dependencies;if(W!==null){var ye=G.child;W=W.firstContext;e:for(;W!==null;){var Pe=W;W=G;for(var Ke=0;Ke<g.length;Ke++)if(Pe.context===g[Ke]){W.lanes|=b,Pe=W.alternate,Pe!==null&&(Pe.lanes|=b),h(W.return,b,d),L||(ye=null);break e}W=Pe.next}}else if(G.tag===18){if(ye=G.return,ye===null)throw Error(i(341));ye.lanes|=b,W=ye.alternate,W!==null&&(W.lanes|=b),h(ye,b,d),ye=null}else ye=G.child;if(ye!==null)ye.return=G;else for(ye=G;ye!==null;){if(ye===d){ye=null;break}if(G=ye.sibling,G!==null){G.return=ye.return,ye=G;break}ye=ye.return}G=ye}}function _(d,g,b,L){d=null;for(var G=g,W=!1;G!==null;){if(!W){if((G.flags&524288)!==0)W=!0;else if((G.flags&262144)!==0)break}if(G.tag===10){var ye=G.alternate;if(ye===null)throw Error(i(387));if(ye=ye.memoizedProps,ye!==null){var Pe=G.type;Qo(G.pendingProps.value,ye.value)||(d!==null?d.push(Pe):d=[Pe])}}else if(G===we.current){if(ye=G.alternate,ye===null)throw Error(i(387));ye.memoizedState.memoizedState!==G.memoizedState.memoizedState&&(d!==null?d.push(gb):d=[gb])}G=G.return}d!==null&&f(g,d,b,L),g.flags|=262144}function A(d){for(d=d.firstContext;d!==null;){if(!Qo(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function R(d){lo=d,En=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function H(d){return ge(lo,d)}function te(d,g){return lo===null&&R(d),ge(d,g)}function ge(d,g){var b=g._currentValue;if(g={context:g,memoizedValue:b,next:null},En===null){if(d===null)throw Error(i(308));En=g,d.dependencies={lanes:0,firstContext:g},d.flags|=524288}else En=En.next=g;return b}var Ne=typeof AbortController<"u"?AbortController:function(){var d=[],g=this.signal={aborted:!1,addEventListener:function(b,L){d.push(L)}};this.abort=function(){g.aborted=!0,d.forEach(function(b){return b()})}},Ye=t.unstable_scheduleCallback,Mt=t.unstable_NormalPriority,At={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hr(){return{controller:new Ne,data:new Map,refCount:0}}function gr(d){d.refCount--,d.refCount===0&&Ye(Mt,function(){d.controller.abort()})}var Sr=null,Kr=0,Vi=0,jn=null;function ts(d,g){if(Sr===null){var b=Sr=[];Kr=0,Vi=J5(),jn={status:"pending",value:void 0,then:function(L){b.push(L)}}}return Kr++,g.then(mu,mu),g}function mu(){if(--Kr===0&&Sr!==null){jn!==null&&(jn.status="fulfilled");var d=Sr;Sr=null,Vi=0,jn=null;for(var g=0;g<d.length;g++)(0,d[g])()}}function fh(d,g){var b=[],L={status:"pending",value:null,reason:null,then:function(G){b.push(G)}};return d.then(function(){L.status="fulfilled",L.value=g;for(var G=0;G<b.length;G++)(0,b[G])(g)},function(G){for(L.status="rejected",L.reason=G,G=0;G<b.length;G++)(0,b[G])(void 0)}),L}var Nv=Y.S;Y.S=function(d,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&ts(d,g),Nv!==null&&Nv(d,g)};var Eg=ue(null);function K4(){var d=Eg.current;return d!==null?d:Ta.pooledCache}function IS(d,g){g===null?ce(Eg,Eg.current):ce(Eg,g.pool)}function Tj(){var d=K4();return d===null?null:{parent:At._currentValue,pool:d}}var Gx=Error(i(460)),Pj=Error(i(474)),TS=Error(i(542)),J4={then:function(){}};function Lj(d){return d=d.status,d==="fulfilled"||d==="rejected"}function PS(){}function Dj(d,g,b){switch(b=d[b],b===void 0?d.push(g):b!==g&&(g.then(PS,PS),g=b),g.status){case"fulfilled":return g.value;case"rejected":throw d=g.reason,Oj(d),d;default:if(typeof g.status=="string")g.then(PS,PS);else{if(d=Ta,d!==null&&100<d.shellSuspendCounter)throw Error(i(482));d=g,d.status="pending",d.then(function(L){if(g.status==="pending"){var G=g;G.status="fulfilled",G.value=L}},function(L){if(g.status==="pending"){var G=g;G.status="rejected",G.reason=L}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw d=g.reason,Oj(d),d}throw Hx=g,Gx}}var Hx=null;function Rj(){if(Hx===null)throw Error(i(459));var d=Hx;return Hx=null,d}function Oj(d){if(d===Gx||d===TS)throw Error(i(483))}var kf=!1;function Q4(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function e5(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Nf(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function Ff(d,g,b){var L=d.updateQueue;if(L===null)return null;if(L=L.shared,(ia&2)!==0){var G=L.pending;return G===null?g.next=g:(g.next=G.next,G.next=g),L.pending=g,g=bo(d),up(d,null,b),g}return Yu(d,L,g,b),bo(d)}function qx(d,g,b){if(g=g.updateQueue,g!==null&&(g=g.shared,(b&4194048)!==0)){var L=g.lanes;L&=d.pendingLanes,b|=L,g.lanes=b,ze(d,b)}}function t5(d,g){var b=d.updateQueue,L=d.alternate;if(L!==null&&(L=L.updateQueue,b===L)){var G=null,W=null;if(b=b.firstBaseUpdate,b!==null){do{var ye={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};W===null?G=W=ye:W=W.next=ye,b=b.next}while(b!==null);W===null?G=W=g:W=W.next=g}else G=W=g;b={baseState:L.baseState,firstBaseUpdate:G,lastBaseUpdate:W,shared:L.shared,callbacks:L.callbacks},d.updateQueue=b;return}d=b.lastBaseUpdate,d===null?b.firstBaseUpdate=g:d.next=g,b.lastBaseUpdate=g}var r5=!1;function Wx(){if(r5){var d=jn;if(d!==null)throw d}}function Xx(d,g,b,L){r5=!1;var G=d.updateQueue;kf=!1;var W=G.firstBaseUpdate,ye=G.lastBaseUpdate,Pe=G.shared.pending;if(Pe!==null){G.shared.pending=null;var Ke=Pe,Ct=Ke.next;Ke.next=null,ye===null?W=Ct:ye.next=Ct,ye=Ke;var Xt=d.alternate;Xt!==null&&(Xt=Xt.updateQueue,Pe=Xt.lastBaseUpdate,Pe!==ye&&(Pe===null?Xt.firstBaseUpdate=Ct:Pe.next=Ct,Xt.lastBaseUpdate=Ke))}if(W!==null){var tr=G.baseState;ye=0,Xt=Ct=Ke=null,Pe=W;do{var Dt=Pe.lane&-536870913,Ot=Dt!==Pe.lane;if(Ot?(Cn&Dt)===Dt:(L&Dt)===Dt){Dt!==0&&Dt===Vi&&(r5=!0),Xt!==null&&(Xt=Xt.next={lane:0,tag:Pe.tag,payload:Pe.payload,callback:null,next:null});e:{var Ei=d,_i=Pe;Dt=g;var da=b;switch(_i.tag){case 1:if(Ei=_i.payload,typeof Ei=="function"){tr=Ei.call(da,tr,Dt);break e}tr=Ei;break e;case 3:Ei.flags=Ei.flags&-65537|128;case 0:if(Ei=_i.payload,Dt=typeof Ei=="function"?Ei.call(da,tr,Dt):Ei,Dt==null)break e;tr=p({},tr,Dt);break e;case 2:kf=!0}}Dt=Pe.callback,Dt!==null&&(d.flags|=64,Ot&&(d.flags|=8192),Ot=G.callbacks,Ot===null?G.callbacks=[Dt]:Ot.push(Dt))}else Ot={lane:Dt,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},Xt===null?(Ct=Xt=Ot,Ke=tr):Xt=Xt.next=Ot,ye|=Dt;if(Pe=Pe.next,Pe===null){if(Pe=G.shared.pending,Pe===null)break;Ot=Pe,Pe=Ot.next,Ot.next=null,G.lastBaseUpdate=Ot,G.shared.pending=null}}while(!0);Xt===null&&(Ke=tr),G.baseState=Ke,G.firstBaseUpdate=Ct,G.lastBaseUpdate=Xt,W===null&&(G.shared.lanes=0),Hf|=ye,d.lanes=ye,d.memoizedState=tr}}function kj(d,g){if(typeof d!="function")throw Error(i(191,d));d.call(g)}function Nj(d,g){var b=d.callbacks;if(b!==null)for(d.callbacks=null,d=0;d<b.length;d++)kj(b[d],g)}var Fv=ue(null),LS=ue(0);function Fj(d,g){d=bd,ce(LS,d),ce(Fv,g),bd=d|g.baseLanes}function i5(){ce(LS,bd),ce(Fv,Fv.current)}function n5(){bd=LS.current,K(Fv),K(LS)}var Bf=0,en=null,ha=null,rs=null,DS=!1,Bv=!1,Cg=!1,RS=0,Zx=0,zv=null,S6e=0;function zo(){throw Error(i(321))}function a5(d,g){if(g===null)return!1;for(var b=0;b<g.length&&b<d.length;b++)if(!Qo(d[b],g[b]))return!1;return!0}function o5(d,g,b,L,G,W){return Bf=W,en=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Y.H=d===null||d.memoizedState===null?x$:b$,Cg=!1,W=b(L,G),Cg=!1,Bv&&(W=zj(g,b,L,G)),Bj(d),W}function Bj(d){Y.H=zS;var g=ha!==null&&ha.next!==null;if(Bf=0,rs=ha=en=null,DS=!1,Zx=0,zv=null,g)throw Error(i(300));d===null||Rs||(d=d.dependencies,d!==null&&A(d)&&(Rs=!0))}function zj(d,g,b,L){en=d;var G=0;do{if(Bv&&(zv=null),Zx=0,Bv=!1,25<=G)throw Error(i(301));if(G+=1,rs=ha=null,d.updateQueue!=null){var W=d.updateQueue;W.lastEffect=null,W.events=null,W.stores=null,W.memoCache!=null&&(W.memoCache.index=0)}Y.H=L6e,W=g(b,L)}while(Bv);return W}function M6e(){var d=Y.H,g=d.useState()[0];return g=typeof g.then=="function"?Yx(g):g,d=d.useState()[0],(ha!==null?ha.memoizedState:null)!==d&&(en.flags|=1024),g}function s5(){var d=RS!==0;return RS=0,d}function l5(d,g,b){g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~b}function u5(d){if(DS){for(d=d.memoizedState;d!==null;){var g=d.queue;g!==null&&(g.pending=null),d=d.next}DS=!1}Bf=0,rs=ha=en=null,Bv=!1,Zx=RS=0,zv=null}function gu(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rs===null?en.memoizedState=rs=d:rs=rs.next=d,rs}function is(){if(ha===null){var d=en.alternate;d=d!==null?d.memoizedState:null}else d=ha.next;var g=rs===null?en.memoizedState:rs.next;if(g!==null)rs=g,ha=d;else{if(d===null)throw en.alternate===null?Error(i(467)):Error(i(310));ha=d,d={memoizedState:ha.memoizedState,baseState:ha.baseState,baseQueue:ha.baseQueue,queue:ha.queue,next:null},rs===null?en.memoizedState=rs=d:rs=rs.next=d}return rs}function c5(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yx(d){var g=Zx;return Zx+=1,zv===null&&(zv=[]),d=Dj(zv,d,g),g=en,(rs===null?g.memoizedState:rs.next)===null&&(g=g.alternate,Y.H=g===null||g.memoizedState===null?x$:b$),d}function OS(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Yx(d);if(d.$$typeof===C)return H(d)}throw Error(i(438,String(d)))}function h5(d){var g=null,b=en.updateQueue;if(b!==null&&(g=b.memoCache),g==null){var L=en.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(g={data:L.data.map(function(G){return G.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),b===null&&(b=c5(),en.updateQueue=b),b.memoCache=g,b=g.data[g.index],b===void 0)for(b=g.data[g.index]=Array(d),L=0;L<d;L++)b[L]=z;return g.index++,b}function md(d,g){return typeof g=="function"?g(d):g}function kS(d){var g=is();return p5(g,ha,d)}function p5(d,g,b){var L=d.queue;if(L===null)throw Error(i(311));L.lastRenderedReducer=b;var G=d.baseQueue,W=L.pending;if(W!==null){if(G!==null){var ye=G.next;G.next=W.next,W.next=ye}g.baseQueue=G=W,L.pending=null}if(W=d.baseState,G===null)d.memoizedState=W;else{g=G.next;var Pe=ye=null,Ke=null,Ct=g,Xt=!1;do{var tr=Ct.lane&-536870913;if(tr!==Ct.lane?(Cn&tr)===tr:(Bf&tr)===tr){var Dt=Ct.revertLane;if(Dt===0)Ke!==null&&(Ke=Ke.next={lane:0,revertLane:0,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null}),tr===Vi&&(Xt=!0);else if((Bf&Dt)===Dt){Ct=Ct.next,Dt===Vi&&(Xt=!0);continue}else tr={lane:0,revertLane:Ct.revertLane,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null},Ke===null?(Pe=Ke=tr,ye=W):Ke=Ke.next=tr,en.lanes|=Dt,Hf|=Dt;tr=Ct.action,Cg&&b(W,tr),W=Ct.hasEagerState?Ct.eagerState:b(W,tr)}else Dt={lane:tr,revertLane:Ct.revertLane,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null},Ke===null?(Pe=Ke=Dt,ye=W):Ke=Ke.next=Dt,en.lanes|=tr,Hf|=tr;Ct=Ct.next}while(Ct!==null&&Ct!==g);if(Ke===null?ye=W:Ke.next=Pe,!Qo(W,d.memoizedState)&&(Rs=!0,Xt&&(b=jn,b!==null)))throw b;d.memoizedState=W,d.baseState=ye,d.baseQueue=Ke,L.lastRenderedState=W}return G===null&&(L.lanes=0),[d.memoizedState,L.dispatch]}function d5(d){var g=is(),b=g.queue;if(b===null)throw Error(i(311));b.lastRenderedReducer=d;var L=b.dispatch,G=b.pending,W=g.memoizedState;if(G!==null){b.pending=null;var ye=G=G.next;do W=d(W,ye.action),ye=ye.next;while(ye!==G);Qo(W,g.memoizedState)||(Rs=!0),g.memoizedState=W,g.baseQueue===null&&(g.baseState=W),b.lastRenderedState=W}return[W,L]}function Uj(d,g,b){var L=en,G=is(),W=xn;if(W){if(b===void 0)throw Error(i(407));b=b()}else b=g();var ye=!Qo((ha||G).memoizedState,b);ye&&(G.memoizedState=b,Rs=!0),G=G.queue;var Pe=$j.bind(null,L,G,d);if(Kx(2048,8,Pe,[d]),G.getSnapshot!==g||ye||rs!==null&&rs.memoizedState.tag&1){if(L.flags|=2048,Uv(9,NS(),jj.bind(null,L,G,b,g),null),Ta===null)throw Error(i(349));W||(Bf&124)!==0||Vj(L,g,b)}return b}function Vj(d,g,b){d.flags|=16384,d={getSnapshot:g,value:b},g=en.updateQueue,g===null?(g=c5(),en.updateQueue=g,g.stores=[d]):(b=g.stores,b===null?g.stores=[d]:b.push(d))}function jj(d,g,b,L){g.value=b,g.getSnapshot=L,Gj(g)&&Hj(d)}function $j(d,g,b){return b(function(){Gj(g)&&Hj(d)})}function Gj(d){var g=d.getSnapshot;d=d.value;try{var b=g();return!Qo(d,b)}catch{return!0}}function Hj(d){var g=_s(d,2);g!==null&&ic(g,d,2)}function f5(d){var g=gu();if(typeof d=="function"){var b=d;if(d=b(),Cg){Yt(!0);try{b()}finally{Yt(!1)}}}return g.memoizedState=g.baseState=d,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:d},g}function qj(d,g,b,L){return d.baseState=b,p5(d,ha,typeof L=="function"?L:md)}function E6e(d,g,b,L,G){if(BS(d))throw Error(i(485));if(d=g.action,d!==null){var W={payload:G,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ye){W.listeners.push(ye)}};Y.T!==null?b(!0):W.isTransition=!1,L(W),b=g.pending,b===null?(W.next=g.pending=W,Wj(g,W)):(W.next=b.next,g.pending=b.next=W)}}function Wj(d,g){var b=g.action,L=g.payload,G=d.state;if(g.isTransition){var W=Y.T,ye={};Y.T=ye;try{var Pe=b(G,L),Ke=Y.S;Ke!==null&&Ke(ye,Pe),Xj(d,g,Pe)}catch(Ct){m5(d,g,Ct)}finally{Y.T=W}}else try{W=b(G,L),Xj(d,g,W)}catch(Ct){m5(d,g,Ct)}}function Xj(d,g,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(L){Zj(d,g,L)},function(L){return m5(d,g,L)}):Zj(d,g,b)}function Zj(d,g,b){g.status="fulfilled",g.value=b,Yj(g),d.state=b,g=d.pending,g!==null&&(b=g.next,b===g?d.pending=null:(b=b.next,g.next=b,Wj(d,b)))}function m5(d,g,b){var L=d.pending;if(d.pending=null,L!==null){L=L.next;do g.status="rejected",g.reason=b,Yj(g),g=g.next;while(g!==L)}d.action=null}function Yj(d){d=d.listeners;for(var g=0;g<d.length;g++)(0,d[g])()}function Kj(d,g){return g}function Jj(d,g){if(xn){var b=Ta.formState;if(b!==null){e:{var L=en;if(xn){if(ra){t:{for(var G=ra,W=xs;G.nodeType!==8;){if(!W){G=null;break t}if(G=gh(G.nextSibling),G===null){G=null;break t}}W=G.data,G=W==="F!"||W==="F"?G:null}if(G){ra=gh(G.nextSibling),L=G.data==="F!";break e}}fu(L)}L=!1}L&&(g=b[0])}}return b=gu(),b.memoizedState=b.baseState=g,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kj,lastRenderedState:g},b.queue=L,b=y$.bind(null,en,L),L.dispatch=b,L=f5(!1),W=x5.bind(null,en,!1,L.queue),L=gu(),G={state:g,dispatch:null,action:d,pending:null},L.queue=G,b=E6e.bind(null,en,G,W,b),G.dispatch=b,L.memoizedState=d,[g,b,!1]}function Qj(d){var g=is();return e$(g,ha,d)}function e$(d,g,b){if(g=p5(d,g,Kj)[0],d=kS(md)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var L=Yx(g)}catch(ye){throw ye===Gx?TS:ye}else L=g;g=is();var G=g.queue,W=G.dispatch;return b!==g.memoizedState&&(en.flags|=2048,Uv(9,NS(),C6e.bind(null,G,b),null)),[L,W,d]}function C6e(d,g){d.action=g}function t$(d){var g=is(),b=ha;if(b!==null)return e$(g,b,d);is(),g=g.memoizedState,b=is();var L=b.queue.dispatch;return b.memoizedState=d,[g,L,!1]}function Uv(d,g,b,L){return d={tag:d,create:b,deps:L,inst:g,next:null},g=en.updateQueue,g===null&&(g=c5(),en.updateQueue=g),b=g.lastEffect,b===null?g.lastEffect=d.next=d:(L=b.next,b.next=d,d.next=L,g.lastEffect=d),d}function NS(){return{destroy:void 0,resource:void 0}}function r$(){return is().memoizedState}function FS(d,g,b,L){var G=gu();L=L===void 0?null:L,en.flags|=d,G.memoizedState=Uv(1|g,NS(),b,L)}function Kx(d,g,b,L){var G=is();L=L===void 0?null:L;var W=G.memoizedState.inst;ha!==null&&L!==null&&a5(L,ha.memoizedState.deps)?G.memoizedState=Uv(g,W,b,L):(en.flags|=d,G.memoizedState=Uv(1|g,W,b,L))}function i$(d,g){FS(8390656,8,d,g)}function n$(d,g){Kx(2048,8,d,g)}function a$(d,g){return Kx(4,2,d,g)}function o$(d,g){return Kx(4,4,d,g)}function s$(d,g){if(typeof g=="function"){d=d();var b=g(d);return function(){typeof b=="function"?b():g(null)}}if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function l$(d,g,b){b=b!=null?b.concat([d]):null,Kx(4,4,s$.bind(null,g,d),b)}function g5(){}function u$(d,g){var b=is();g=g===void 0?null:g;var L=b.memoizedState;return g!==null&&a5(g,L[1])?L[0]:(b.memoizedState=[d,g],d)}function c$(d,g){var b=is();g=g===void 0?null:g;var L=b.memoizedState;if(g!==null&&a5(g,L[1]))return L[0];if(L=d(),Cg){Yt(!0);try{d()}finally{Yt(!1)}}return b.memoizedState=[L,g],L}function y5(d,g,b){return b===void 0||(Bf&1073741824)!==0?d.memoizedState=g:(d.memoizedState=b,d=dG(),en.lanes|=d,Hf|=d,b)}function h$(d,g,b,L){return Qo(b,g)?b:Fv.current!==null?(d=y5(d,b,L),Qo(d,g)||(Rs=!0),d):(Bf&42)===0?(Rs=!0,d.memoizedState=b):(d=dG(),en.lanes|=d,Hf|=d,g)}function p$(d,g,b,L,G){var W=he.p;he.p=W!==0&&8>W?W:8;var ye=Y.T,Pe={};Y.T=Pe,x5(d,!1,g,b);try{var Ke=G(),Ct=Y.S;if(Ct!==null&&Ct(Pe,Ke),Ke!==null&&typeof Ke=="object"&&typeof Ke.then=="function"){var Xt=fh(Ke,L);Jx(d,g,Xt,rc(d))}else Jx(d,g,L,rc(d))}catch(tr){Jx(d,g,{then:function(){},status:"rejected",reason:tr},rc())}finally{he.p=W,Y.T=ye}}function I6e(){}function v5(d,g,b,L){if(d.tag!==5)throw Error(i(476));var G=d$(d).queue;p$(d,G,g,J,b===null?I6e:function(){return f$(d),b(L)})}function d$(d){var g=d.memoizedState;if(g!==null)return g;g={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:J},next:null};var b={};return g.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:b},next:null},d.memoizedState=g,d=d.alternate,d!==null&&(d.memoizedState=g),g}function f$(d){var g=d$(d).next.queue;Jx(d,g,{},rc())}function _5(){return H(gb)}function m$(){return is().memoizedState}function g$(){return is().memoizedState}function T6e(d){for(var g=d.return;g!==null;){switch(g.tag){case 24:case 3:var b=rc();d=Nf(b);var L=Ff(g,d,b);L!==null&&(ic(L,g,b),qx(L,g,b)),g={cache:hr()},d.payload=g;return}g=g.return}}function P6e(d,g,b){var L=rc();b={lane:L,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null},BS(d)?v$(g,b):(b=ch(d,g,b,L),b!==null&&(ic(b,d,L),_$(b,g,L)))}function y$(d,g,b){var L=rc();Jx(d,g,b,L)}function Jx(d,g,b,L){var G={lane:L,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null};if(BS(d))v$(g,G);else{var W=d.alternate;if(d.lanes===0&&(W===null||W.lanes===0)&&(W=g.lastRenderedReducer,W!==null))try{var ye=g.lastRenderedState,Pe=W(ye,b);if(G.hasEagerState=!0,G.eagerState=Pe,Qo(Pe,ye))return Yu(d,g,G,0),Ta===null&&Ls(),!1}catch{}finally{}if(b=ch(d,g,G,L),b!==null)return ic(b,d,L),_$(b,g,L),!0}return!1}function x5(d,g,b,L){if(L={lane:2,revertLane:J5(),action:L,hasEagerState:!1,eagerState:null,next:null},BS(d)){if(g)throw Error(i(479))}else g=ch(d,b,L,2),g!==null&&ic(g,d,2)}function BS(d){var g=d.alternate;return d===en||g!==null&&g===en}function v$(d,g){Bv=DS=!0;var b=d.pending;b===null?g.next=g:(g.next=b.next,b.next=g),d.pending=g}function _$(d,g,b){if((b&4194048)!==0){var L=g.lanes;L&=d.pendingLanes,b|=L,g.lanes=b,ze(d,b)}}var zS={readContext:H,use:OS,useCallback:zo,useContext:zo,useEffect:zo,useImperativeHandle:zo,useLayoutEffect:zo,useInsertionEffect:zo,useMemo:zo,useReducer:zo,useRef:zo,useState:zo,useDebugValue:zo,useDeferredValue:zo,useTransition:zo,useSyncExternalStore:zo,useId:zo,useHostTransitionStatus:zo,useFormState:zo,useActionState:zo,useOptimistic:zo,useMemoCache:zo,useCacheRefresh:zo},x$={readContext:H,use:OS,useCallback:function(d,g){return gu().memoizedState=[d,g===void 0?null:g],d},useContext:H,useEffect:i$,useImperativeHandle:function(d,g,b){b=b!=null?b.concat([d]):null,FS(4194308,4,s$.bind(null,g,d),b)},useLayoutEffect:function(d,g){return FS(4194308,4,d,g)},useInsertionEffect:function(d,g){FS(4,2,d,g)},useMemo:function(d,g){var b=gu();g=g===void 0?null:g;var L=d();if(Cg){Yt(!0);try{d()}finally{Yt(!1)}}return b.memoizedState=[L,g],L},useReducer:function(d,g,b){var L=gu();if(b!==void 0){var G=b(g);if(Cg){Yt(!0);try{b(g)}finally{Yt(!1)}}}else G=g;return L.memoizedState=L.baseState=G,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:G},L.queue=d,d=d.dispatch=P6e.bind(null,en,d),[L.memoizedState,d]},useRef:function(d){var g=gu();return d={current:d},g.memoizedState=d},useState:function(d){d=f5(d);var g=d.queue,b=y$.bind(null,en,g);return g.dispatch=b,[d.memoizedState,b]},useDebugValue:g5,useDeferredValue:function(d,g){var b=gu();return y5(b,d,g)},useTransition:function(){var d=f5(!1);return d=p$.bind(null,en,d.queue,!0,!1),gu().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,g,b){var L=en,G=gu();if(xn){if(b===void 0)throw Error(i(407));b=b()}else{if(b=g(),Ta===null)throw Error(i(349));(Cn&124)!==0||Vj(L,g,b)}G.memoizedState=b;var W={value:b,getSnapshot:g};return G.queue=W,i$($j.bind(null,L,W,d),[d]),L.flags|=2048,Uv(9,NS(),jj.bind(null,L,W,b,g),null),b},useId:function(){var d=gu(),g=Ta.identifierPrefix;if(xn){var b=Fc,L=Fo;b=(L&~(1<<32-Kt(L)-1)).toString(32)+b,g=""+g+"R"+b,b=RS++,0<b&&(g+="H"+b.toString(32)),g+=""}else b=S6e++,g=""+g+"r"+b.toString(32)+"";return d.memoizedState=g},useHostTransitionStatus:_5,useFormState:Jj,useActionState:Jj,useOptimistic:function(d){var g=gu();g.memoizedState=g.baseState=d;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=b,g=x5.bind(null,en,!0,b),b.dispatch=g,[d,g]},useMemoCache:h5,useCacheRefresh:function(){return gu().memoizedState=T6e.bind(null,en)}},b$={readContext:H,use:OS,useCallback:u$,useContext:H,useEffect:n$,useImperativeHandle:l$,useInsertionEffect:a$,useLayoutEffect:o$,useMemo:c$,useReducer:kS,useRef:r$,useState:function(){return kS(md)},useDebugValue:g5,useDeferredValue:function(d,g){var b=is();return h$(b,ha.memoizedState,d,g)},useTransition:function(){var d=kS(md)[0],g=is().memoizedState;return[typeof d=="boolean"?d:Yx(d),g]},useSyncExternalStore:Uj,useId:m$,useHostTransitionStatus:_5,useFormState:Qj,useActionState:Qj,useOptimistic:function(d,g){var b=is();return qj(b,ha,d,g)},useMemoCache:h5,useCacheRefresh:g$},L6e={readContext:H,use:OS,useCallback:u$,useContext:H,useEffect:n$,useImperativeHandle:l$,useInsertionEffect:a$,useLayoutEffect:o$,useMemo:c$,useReducer:d5,useRef:r$,useState:function(){return d5(md)},useDebugValue:g5,useDeferredValue:function(d,g){var b=is();return ha===null?y5(b,d,g):h$(b,ha.memoizedState,d,g)},useTransition:function(){var d=d5(md)[0],g=is().memoizedState;return[typeof d=="boolean"?d:Yx(d),g]},useSyncExternalStore:Uj,useId:m$,useHostTransitionStatus:_5,useFormState:t$,useActionState:t$,useOptimistic:function(d,g){var b=is();return ha!==null?qj(b,ha,d,g):(b.baseState=d,[d,b.queue.dispatch])},useMemoCache:h5,useCacheRefresh:g$},Vv=null,Qx=0;function US(d){var g=Qx;return Qx+=1,Vv===null&&(Vv=[]),Dj(Vv,d,g)}function eb(d,g){g=g.props.ref,d.ref=g!==void 0?g:null}function VS(d,g){throw g.$$typeof===m?Error(i(525)):(d=Object.prototype.toString.call(g),Error(i(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d)))}function w$(d){var g=d._init;return g(d._payload)}function A$(d){function g(gt,ut){if(d){var St=gt.deletions;St===null?(gt.deletions=[ut],gt.flags|=16):St.push(ut)}}function b(gt,ut){if(!d)return null;for(;ut!==null;)g(gt,ut),ut=ut.sibling;return null}function L(gt){for(var ut=new Map;gt!==null;)gt.key!==null?ut.set(gt.key,gt):ut.set(gt.index,gt),gt=gt.sibling;return ut}function G(gt,ut){return gt=ca(gt,ut),gt.index=0,gt.sibling=null,gt}function W(gt,ut,St){return gt.index=St,d?(St=gt.alternate,St!==null?(St=St.index,St<ut?(gt.flags|=67108866,ut):St):(gt.flags|=67108866,ut)):(gt.flags|=1048576,ut)}function ye(gt){return d&&gt.alternate===null&&(gt.flags|=67108866),gt}function Pe(gt,ut,St,Qt){return ut===null||ut.tag!==6?(ut=Ku(St,gt.mode,Qt),ut.return=gt,ut):(ut=G(ut,St),ut.return=gt,ut)}function Ke(gt,ut,St,Qt){var Qr=St.type;return Qr===x?Xt(gt,ut,St.props.children,Qt,St.key):ut!==null&&(ut.elementType===Qr||typeof Qr=="object"&&Qr!==null&&Qr.$$typeof===B&&w$(Qr)===ut.type)?(ut=G(ut,St.props),eb(ut,St),ut.return=gt,ut):(ut=Rf(St.type,St.key,St.props,null,gt.mode,Qt),eb(ut,St),ut.return=gt,ut)}function Ct(gt,ut,St,Qt){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==St.containerInfo||ut.stateNode.implementation!==St.implementation?(ut=Na(St,gt.mode,Qt),ut.return=gt,ut):(ut=G(ut,St.children||[]),ut.return=gt,ut)}function Xt(gt,ut,St,Qt,Qr){return ut===null||ut.tag!==7?(ut=Ul(St,gt.mode,Qt,Qr),ut.return=gt,ut):(ut=G(ut,St),ut.return=gt,ut)}function tr(gt,ut,St){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return ut=Ku(""+ut,gt.mode,St),ut.return=gt,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case y:return St=Rf(ut.type,ut.key,ut.props,null,gt.mode,St),eb(St,ut),St.return=gt,St;case v:return ut=Na(ut,gt.mode,St),ut.return=gt,ut;case B:var Qt=ut._init;return ut=Qt(ut._payload),tr(gt,ut,St)}if(ae(ut)||Z(ut))return ut=Ul(ut,gt.mode,St,null),ut.return=gt,ut;if(typeof ut.then=="function")return tr(gt,US(ut),St);if(ut.$$typeof===C)return tr(gt,te(gt,ut),St);VS(gt,ut)}return null}function Dt(gt,ut,St,Qt){var Qr=ut!==null?ut.key:null;if(typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint")return Qr!==null?null:Pe(gt,ut,""+St,Qt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case y:return St.key===Qr?Ke(gt,ut,St,Qt):null;case v:return St.key===Qr?Ct(gt,ut,St,Qt):null;case B:return Qr=St._init,St=Qr(St._payload),Dt(gt,ut,St,Qt)}if(ae(St)||Z(St))return Qr!==null?null:Xt(gt,ut,St,Qt,null);if(typeof St.then=="function")return Dt(gt,ut,US(St),Qt);if(St.$$typeof===C)return Dt(gt,ut,te(gt,St),Qt);VS(gt,St)}return null}function Ot(gt,ut,St,Qt,Qr){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint")return gt=gt.get(St)||null,Pe(ut,gt,""+Qt,Qr);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case y:return gt=gt.get(Qt.key===null?St:Qt.key)||null,Ke(ut,gt,Qt,Qr);case v:return gt=gt.get(Qt.key===null?St:Qt.key)||null,Ct(ut,gt,Qt,Qr);case B:var cn=Qt._init;return Qt=cn(Qt._payload),Ot(gt,ut,St,Qt,Qr)}if(ae(Qt)||Z(Qt))return gt=gt.get(St)||null,Xt(ut,gt,Qt,Qr,null);if(typeof Qt.then=="function")return Ot(gt,ut,St,US(Qt),Qr);if(Qt.$$typeof===C)return Ot(gt,ut,St,te(ut,Qt),Qr);VS(ut,Qt)}return null}function Ei(gt,ut,St,Qt){for(var Qr=null,cn=null,hi=ut,wi=ut=0,ks=null;hi!==null&&wi<St.length;wi++){hi.index>wi?(ks=hi,hi=null):ks=hi.sibling;var Nn=Dt(gt,hi,St[wi],Qt);if(Nn===null){hi===null&&(hi=ks);break}d&&hi&&Nn.alternate===null&&g(gt,hi),ut=W(Nn,ut,wi),cn===null?Qr=Nn:cn.sibling=Nn,cn=Nn,hi=ks}if(wi===St.length)return b(gt,hi),xn&&Ju(gt,wi),Qr;if(hi===null){for(;wi<St.length;wi++)hi=tr(gt,St[wi],Qt),hi!==null&&(ut=W(hi,ut,wi),cn===null?Qr=hi:cn.sibling=hi,cn=hi);return xn&&Ju(gt,wi),Qr}for(hi=L(hi);wi<St.length;wi++)ks=Ot(hi,gt,wi,St[wi],Qt),ks!==null&&(d&&ks.alternate!==null&&hi.delete(ks.key===null?wi:ks.key),ut=W(ks,ut,wi),cn===null?Qr=ks:cn.sibling=ks,cn=ks);return d&&hi.forEach(function(em){return g(gt,em)}),xn&&Ju(gt,wi),Qr}function _i(gt,ut,St,Qt){if(St==null)throw Error(i(151));for(var Qr=null,cn=null,hi=ut,wi=ut=0,ks=null,Nn=St.next();hi!==null&&!Nn.done;wi++,Nn=St.next()){hi.index>wi?(ks=hi,hi=null):ks=hi.sibling;var em=Dt(gt,hi,Nn.value,Qt);if(em===null){hi===null&&(hi=ks);break}d&&hi&&em.alternate===null&&g(gt,hi),ut=W(em,ut,wi),cn===null?Qr=em:cn.sibling=em,cn=em,hi=ks}if(Nn.done)return b(gt,hi),xn&&Ju(gt,wi),Qr;if(hi===null){for(;!Nn.done;wi++,Nn=St.next())Nn=tr(gt,Nn.value,Qt),Nn!==null&&(ut=W(Nn,ut,wi),cn===null?Qr=Nn:cn.sibling=Nn,cn=Nn);return xn&&Ju(gt,wi),Qr}for(hi=L(hi);!Nn.done;wi++,Nn=St.next())Nn=Ot(hi,gt,wi,Nn.value,Qt),Nn!==null&&(d&&Nn.alternate!==null&&hi.delete(Nn.key===null?wi:Nn.key),ut=W(Nn,ut,wi),cn===null?Qr=Nn:cn.sibling=Nn,cn=Nn);return d&&hi.forEach(function(DRe){return g(gt,DRe)}),xn&&Ju(gt,wi),Qr}function da(gt,ut,St,Qt){if(typeof St=="object"&&St!==null&&St.type===x&&St.key===null&&(St=St.props.children),typeof St=="object"&&St!==null){switch(St.$$typeof){case y:e:{for(var Qr=St.key;ut!==null;){if(ut.key===Qr){if(Qr=St.type,Qr===x){if(ut.tag===7){b(gt,ut.sibling),Qt=G(ut,St.props.children),Qt.return=gt,gt=Qt;break e}}else if(ut.elementType===Qr||typeof Qr=="object"&&Qr!==null&&Qr.$$typeof===B&&w$(Qr)===ut.type){b(gt,ut.sibling),Qt=G(ut,St.props),eb(Qt,St),Qt.return=gt,gt=Qt;break e}b(gt,ut);break}else g(gt,ut);ut=ut.sibling}St.type===x?(Qt=Ul(St.props.children,gt.mode,Qt,St.key),Qt.return=gt,gt=Qt):(Qt=Rf(St.type,St.key,St.props,null,gt.mode,Qt),eb(Qt,St),Qt.return=gt,gt=Qt)}return ye(gt);case v:e:{for(Qr=St.key;ut!==null;){if(ut.key===Qr)if(ut.tag===4&&ut.stateNode.containerInfo===St.containerInfo&&ut.stateNode.implementation===St.implementation){b(gt,ut.sibling),Qt=G(ut,St.children||[]),Qt.return=gt,gt=Qt;break e}else{b(gt,ut);break}else g(gt,ut);ut=ut.sibling}Qt=Na(St,gt.mode,Qt),Qt.return=gt,gt=Qt}return ye(gt);case B:return Qr=St._init,St=Qr(St._payload),da(gt,ut,St,Qt)}if(ae(St))return Ei(gt,ut,St,Qt);if(Z(St)){if(Qr=Z(St),typeof Qr!="function")throw Error(i(150));return St=Qr.call(St),_i(gt,ut,St,Qt)}if(typeof St.then=="function")return da(gt,ut,US(St),Qt);if(St.$$typeof===C)return da(gt,ut,te(gt,St),Qt);VS(gt,St)}return typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint"?(St=""+St,ut!==null&&ut.tag===6?(b(gt,ut.sibling),Qt=G(ut,St),Qt.return=gt,gt=Qt):(b(gt,ut),Qt=Ku(St,gt.mode,Qt),Qt.return=gt,gt=Qt),ye(gt)):b(gt,ut)}return function(gt,ut,St,Qt){try{Qx=0;var Qr=da(gt,ut,St,Qt);return Vv=null,Qr}catch(hi){if(hi===Gx||hi===TS)throw hi;var cn=yl(29,hi,null,gt.mode);return cn.lanes=Qt,cn.return=gt,cn}finally{}}}var jv=A$(!0),S$=A$(!1),zc=ue(null),cp=null;function zf(d){var g=d.alternate;ce(bs,bs.current&1),ce(zc,d),cp===null&&(g===null||Fv.current!==null||g.memoizedState!==null)&&(cp=d)}function M$(d){if(d.tag===22){if(ce(bs,bs.current),ce(zc,d),cp===null){var g=d.alternate;g!==null&&g.memoizedState!==null&&(cp=d)}}else Uf()}function Uf(){ce(bs,bs.current),ce(zc,zc.current)}function gd(d){K(zc),cp===d&&(cp=null),K(bs)}var bs=ue(0);function jS(d){for(var g=d;g!==null;){if(g.tag===13){var b=g.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||cL(b)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function b5(d,g,b,L){g=d.memoizedState,b=b(L,g),b=b==null?g:p({},g,b),d.memoizedState=b,d.lanes===0&&(d.updateQueue.baseState=b)}var w5={enqueueSetState:function(d,g,b){d=d._reactInternals;var L=rc(),G=Nf(L);G.payload=g,b!=null&&(G.callback=b),g=Ff(d,G,L),g!==null&&(ic(g,d,L),qx(g,d,L))},enqueueReplaceState:function(d,g,b){d=d._reactInternals;var L=rc(),G=Nf(L);G.tag=1,G.payload=g,b!=null&&(G.callback=b),g=Ff(d,G,L),g!==null&&(ic(g,d,L),qx(g,d,L))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var b=rc(),L=Nf(b);L.tag=2,g!=null&&(L.callback=g),g=Ff(d,L,b),g!==null&&(ic(g,d,b),qx(g,d,b))}};function E$(d,g,b,L,G,W,ye){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(L,W,ye):g.prototype&&g.prototype.isPureReactComponent?!Df(b,L)||!Df(G,W):!0}function C$(d,g,b,L){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(b,L),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(b,L),g.state!==d&&w5.enqueueReplaceState(g,g.state,null)}function Ig(d,g){var b=g;if("ref"in g){b={};for(var L in g)L!=="ref"&&(b[L]=g[L])}if(d=d.defaultProps){b===g&&(b=p({},b));for(var G in d)b[G]===void 0&&(b[G]=d[G])}return b}var $S=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function I$(d){$S(d)}function T$(d){console.error(d)}function P$(d){$S(d)}function GS(d,g){try{var b=d.onUncaughtError;b(g.value,{componentStack:g.stack})}catch(L){setTimeout(function(){throw L})}}function L$(d,g,b){try{var L=d.onCaughtError;L(b.value,{componentStack:b.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(G){setTimeout(function(){throw G})}}function A5(d,g,b){return b=Nf(b),b.tag=3,b.payload={element:null},b.callback=function(){GS(d,g)},b}function D$(d){return d=Nf(d),d.tag=3,d}function R$(d,g,b,L){var G=b.type.getDerivedStateFromError;if(typeof G=="function"){var W=L.value;d.payload=function(){return G(W)},d.callback=function(){L$(g,b,L)}}var ye=b.stateNode;ye!==null&&typeof ye.componentDidCatch=="function"&&(d.callback=function(){L$(g,b,L),typeof G!="function"&&(qf===null?qf=new Set([this]):qf.add(this));var Pe=L.stack;this.componentDidCatch(L.value,{componentStack:Pe!==null?Pe:""})})}function D6e(d,g,b,L,G){if(b.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(g=b.alternate,g!==null&&_(g,b,G,!0),b=zc.current,b!==null){switch(b.tag){case 13:return cp===null?W5():b.alternate===null&&Ao===0&&(Ao=3),b.flags&=-257,b.flags|=65536,b.lanes=G,L===J4?b.flags|=16384:(g=b.updateQueue,g===null?b.updateQueue=new Set([L]):g.add(L),Z5(d,L,G)),!1;case 22:return b.flags|=65536,L===J4?b.flags|=16384:(g=b.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([L])},b.updateQueue=g):(b=g.retryQueue,b===null?g.retryQueue=new Set([L]):b.add(L)),Z5(d,L,G)),!1}throw Error(i(435,b.tag))}return Z5(d,L,G),W5(),!1}if(xn)return g=zc.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=G,L!==fd&&(d=Error(i(422),{cause:L}),Bo(Pn(d,b)))):(L!==fd&&(g=Error(i(423),{cause:L}),Bo(Pn(g,b))),d=d.current.alternate,d.flags|=65536,G&=-G,d.lanes|=G,L=Pn(L,b),G=A5(d.stateNode,L,G),t5(d,G),Ao!==4&&(Ao=2)),!1;var W=Error(i(520),{cause:L});if(W=Pn(W,b),sb===null?sb=[W]:sb.push(W),Ao!==4&&(Ao=2),g===null)return!0;L=Pn(L,b),b=g;do{switch(b.tag){case 3:return b.flags|=65536,d=G&-G,b.lanes|=d,d=A5(b.stateNode,L,d),t5(b,d),!1;case 1:if(g=b.type,W=b.stateNode,(b.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(qf===null||!qf.has(W))))return b.flags|=65536,G&=-G,b.lanes|=G,G=D$(G),R$(G,d,b,L),t5(b,G),!1}b=b.return}while(b!==null);return!1}var O$=Error(i(461)),Rs=!1;function Ks(d,g,b,L){g.child=d===null?S$(g,null,b,L):jv(g,d.child,b,L)}function k$(d,g,b,L,G){b=b.render;var W=g.ref;if("ref"in L){var ye={};for(var Pe in L)Pe!=="ref"&&(ye[Pe]=L[Pe])}else ye=L;return R(g),L=o5(d,g,b,ye,W,G),Pe=s5(),d!==null&&!Rs?(l5(d,g,G),yd(d,g,G)):(xn&&Pe&&$x(g),g.flags|=1,Ks(d,g,L,G),g.child)}function N$(d,g,b,L,G){if(d===null){var W=b.type;return typeof W=="function"&&!Ov(W)&&W.defaultProps===void 0&&b.compare===null?(g.tag=15,g.type=W,F$(d,g,W,L,G)):(d=Rf(b.type,null,L,g,g.mode,G),d.ref=g.ref,d.return=g,g.child=d)}if(W=d.child,!L5(d,G)){var ye=W.memoizedProps;if(b=b.compare,b=b!==null?b:Df,b(ye,L)&&d.ref===g.ref)return yd(d,g,G)}return g.flags|=1,d=ca(W,L),d.ref=g.ref,d.return=g,g.child=d}function F$(d,g,b,L,G){if(d!==null){var W=d.memoizedProps;if(Df(W,L)&&d.ref===g.ref)if(Rs=!1,g.pendingProps=L=W,L5(d,G))(d.flags&131072)!==0&&(Rs=!0);else return g.lanes=d.lanes,yd(d,g,G)}return S5(d,g,b,L,G)}function B$(d,g,b){var L=g.pendingProps,G=L.children,W=d!==null?d.memoizedState:null;if(L.mode==="hidden"){if((g.flags&128)!==0){if(L=W!==null?W.baseLanes|b:b,d!==null){for(G=g.child=d.child,W=0;G!==null;)W=W|G.lanes|G.childLanes,G=G.sibling;g.childLanes=W&~L}else g.childLanes=0,g.child=null;return z$(d,g,L,b)}if((b&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},d!==null&&IS(g,W!==null?W.cachePool:null),W!==null?Fj(g,W):i5(),M$(g);else return g.lanes=g.childLanes=536870912,z$(d,g,W!==null?W.baseLanes|b:b,b)}else W!==null?(IS(g,W.cachePool),Fj(g,W),Uf(),g.memoizedState=null):(d!==null&&IS(g,null),i5(),Uf());return Ks(d,g,G,b),g.child}function z$(d,g,b,L){var G=K4();return G=G===null?null:{parent:At._currentValue,pool:G},g.memoizedState={baseLanes:b,cachePool:G},d!==null&&IS(g,null),i5(),M$(g),d!==null&&_(d,g,L,!0),null}function HS(d,g){var b=g.ref;if(b===null)d!==null&&d.ref!==null&&(g.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(i(284));(d===null||d.ref!==b)&&(g.flags|=4194816)}}function S5(d,g,b,L,G){return R(g),b=o5(d,g,b,L,void 0,G),L=s5(),d!==null&&!Rs?(l5(d,g,G),yd(d,g,G)):(xn&&L&&$x(g),g.flags|=1,Ks(d,g,b,G),g.child)}function U$(d,g,b,L,G,W){return R(g),g.updateQueue=null,b=zj(g,L,b,G),Bj(d),L=s5(),d!==null&&!Rs?(l5(d,g,W),yd(d,g,W)):(xn&&L&&$x(g),g.flags|=1,Ks(d,g,b,W),g.child)}function V$(d,g,b,L,G){if(R(g),g.stateNode===null){var W=Ds,ye=b.contextType;typeof ye=="object"&&ye!==null&&(W=H(ye)),W=new b(L,W),g.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,W.updater=w5,g.stateNode=W,W._reactInternals=g,W=g.stateNode,W.props=L,W.state=g.memoizedState,W.refs={},Q4(g),ye=b.contextType,W.context=typeof ye=="object"&&ye!==null?H(ye):Ds,W.state=g.memoizedState,ye=b.getDerivedStateFromProps,typeof ye=="function"&&(b5(g,b,ye,L),W.state=g.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(ye=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),ye!==W.state&&w5.enqueueReplaceState(W,W.state,null),Xx(g,L,W,G),Wx(),W.state=g.memoizedState),typeof W.componentDidMount=="function"&&(g.flags|=4194308),L=!0}else if(d===null){W=g.stateNode;var Pe=g.memoizedProps,Ke=Ig(b,Pe);W.props=Ke;var Ct=W.context,Xt=b.contextType;ye=Ds,typeof Xt=="object"&&Xt!==null&&(ye=H(Xt));var tr=b.getDerivedStateFromProps;Xt=typeof tr=="function"||typeof W.getSnapshotBeforeUpdate=="function",Pe=g.pendingProps!==Pe,Xt||typeof W.UNSAFE_componentWillReceiveProps!="function"&&typeof W.componentWillReceiveProps!="function"||(Pe||Ct!==ye)&&C$(g,W,L,ye),kf=!1;var Dt=g.memoizedState;W.state=Dt,Xx(g,L,W,G),Wx(),Ct=g.memoizedState,Pe||Dt!==Ct||kf?(typeof tr=="function"&&(b5(g,b,tr,L),Ct=g.memoizedState),(Ke=kf||E$(g,b,Ke,L,Dt,Ct,ye))?(Xt||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount()),typeof W.componentDidMount=="function"&&(g.flags|=4194308)):(typeof W.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=L,g.memoizedState=Ct),W.props=L,W.state=Ct,W.context=ye,L=Ke):(typeof W.componentDidMount=="function"&&(g.flags|=4194308),L=!1)}else{W=g.stateNode,e5(d,g),ye=g.memoizedProps,Xt=Ig(b,ye),W.props=Xt,tr=g.pendingProps,Dt=W.context,Ct=b.contextType,Ke=Ds,typeof Ct=="object"&&Ct!==null&&(Ke=H(Ct)),Pe=b.getDerivedStateFromProps,(Ct=typeof Pe=="function"||typeof W.getSnapshotBeforeUpdate=="function")||typeof W.UNSAFE_componentWillReceiveProps!="function"&&typeof W.componentWillReceiveProps!="function"||(ye!==tr||Dt!==Ke)&&C$(g,W,L,Ke),kf=!1,Dt=g.memoizedState,W.state=Dt,Xx(g,L,W,G),Wx();var Ot=g.memoizedState;ye!==tr||Dt!==Ot||kf||d!==null&&d.dependencies!==null&&A(d.dependencies)?(typeof Pe=="function"&&(b5(g,b,Pe,L),Ot=g.memoizedState),(Xt=kf||E$(g,b,Xt,L,Dt,Ot,Ke)||d!==null&&d.dependencies!==null&&A(d.dependencies))?(Ct||typeof W.UNSAFE_componentWillUpdate!="function"&&typeof W.componentWillUpdate!="function"||(typeof W.componentWillUpdate=="function"&&W.componentWillUpdate(L,Ot,Ke),typeof W.UNSAFE_componentWillUpdate=="function"&&W.UNSAFE_componentWillUpdate(L,Ot,Ke)),typeof W.componentDidUpdate=="function"&&(g.flags|=4),typeof W.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof W.componentDidUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=4),typeof W.getSnapshotBeforeUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=1024),g.memoizedProps=L,g.memoizedState=Ot),W.props=L,W.state=Ot,W.context=Ke,L=Xt):(typeof W.componentDidUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=4),typeof W.getSnapshotBeforeUpdate!="function"||ye===d.memoizedProps&&Dt===d.memoizedState||(g.flags|=1024),L=!1)}return W=L,HS(d,g),L=(g.flags&128)!==0,W||L?(W=g.stateNode,b=L&&typeof b.getDerivedStateFromError!="function"?null:W.render(),g.flags|=1,d!==null&&L?(g.child=jv(g,d.child,null,G),g.child=jv(g,null,b,G)):Ks(d,g,b,G),g.memoizedState=W.state,d=g.child):d=yd(d,g,G),d}function j$(d,g,b,L){return Bc(),g.flags|=256,Ks(d,g,b,L),g.child}var M5={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function E5(d){return{baseLanes:d,cachePool:Tj()}}function C5(d,g,b){return d=d!==null?d.childLanes&~b:0,g&&(d|=Uc),d}function $$(d,g,b){var L=g.pendingProps,G=!1,W=(g.flags&128)!==0,ye;if((ye=W)||(ye=d!==null&&d.memoizedState===null?!1:(bs.current&2)!==0),ye&&(G=!0,g.flags&=-129),ye=(g.flags&32)!==0,g.flags&=-33,d===null){if(xn){if(G?zf(g):Uf(),xn){var Pe=ra,Ke;if(Ke=Pe){e:{for(Ke=Pe,Pe=xs;Ke.nodeType!==8;){if(!Pe){Pe=null;break e}if(Ke=gh(Ke.nextSibling),Ke===null){Pe=null;break e}}Pe=Ke}Pe!==null?(g.memoizedState={dehydrated:Pe,treeContext:dd!==null?{id:Fo,overflow:Fc}:null,retryLane:536870912,hydrationErrors:null},Ke=yl(18,null,null,0),Ke.stateNode=Pe,Ke.return=g,g.child=Ke,wo=g,ra=null,Ke=!0):Ke=!1}Ke||fu(g)}if(Pe=g.memoizedState,Pe!==null&&(Pe=Pe.dehydrated,Pe!==null))return cL(Pe)?g.lanes=32:g.lanes=536870912,null;gd(g)}return Pe=L.children,L=L.fallback,G?(Uf(),G=g.mode,Pe=qS({mode:"hidden",children:Pe},G),L=Ul(L,G,b,null),Pe.return=g,L.return=g,Pe.sibling=L,g.child=Pe,G=g.child,G.memoizedState=E5(b),G.childLanes=C5(d,ye,b),g.memoizedState=M5,L):(zf(g),I5(g,Pe))}if(Ke=d.memoizedState,Ke!==null&&(Pe=Ke.dehydrated,Pe!==null)){if(W)g.flags&256?(zf(g),g.flags&=-257,g=T5(d,g,b)):g.memoizedState!==null?(Uf(),g.child=d.child,g.flags|=128,g=null):(Uf(),G=L.fallback,Pe=g.mode,L=qS({mode:"visible",children:L.children},Pe),G=Ul(G,Pe,b,null),G.flags|=2,L.return=g,G.return=g,L.sibling=G,g.child=L,jv(g,d.child,null,b),L=g.child,L.memoizedState=E5(b),L.childLanes=C5(d,ye,b),g.memoizedState=M5,g=G);else if(zf(g),cL(Pe)){if(ye=Pe.nextSibling&&Pe.nextSibling.dataset,ye)var Ct=ye.dgst;ye=Ct,L=Error(i(419)),L.stack="",L.digest=ye,Bo({value:L,source:null,stack:null}),g=T5(d,g,b)}else if(Rs||_(d,g,b,!1),ye=(b&d.childLanes)!==0,Rs||ye){if(ye=Ta,ye!==null&&(L=b&-b,L=(L&42)!==0?1:De(L),L=(L&(ye.suspendedLanes|b))!==0?0:L,L!==0&&L!==Ke.retryLane))throw Ke.retryLane=L,_s(d,L),ic(ye,d,L),O$;Pe.data==="$?"||W5(),g=T5(d,g,b)}else Pe.data==="$?"?(g.flags|=192,g.child=d.child,g=null):(d=Ke.treeContext,ra=gh(Pe.nextSibling),wo=g,xn=!0,du=null,xs=!1,d!==null&&(Ys[Ln++]=Fo,Ys[Ln++]=Fc,Ys[Ln++]=dd,Fo=d.id,Fc=d.overflow,dd=g),g=I5(g,L.children),g.flags|=4096);return g}return G?(Uf(),G=L.fallback,Pe=g.mode,Ke=d.child,Ct=Ke.sibling,L=ca(Ke,{mode:"hidden",children:L.children}),L.subtreeFlags=Ke.subtreeFlags&65011712,Ct!==null?G=ca(Ct,G):(G=Ul(G,Pe,b,null),G.flags|=2),G.return=g,L.return=g,L.sibling=G,g.child=L,L=G,G=g.child,Pe=d.child.memoizedState,Pe===null?Pe=E5(b):(Ke=Pe.cachePool,Ke!==null?(Ct=At._currentValue,Ke=Ke.parent!==Ct?{parent:Ct,pool:Ct}:Ke):Ke=Tj(),Pe={baseLanes:Pe.baseLanes|b,cachePool:Ke}),G.memoizedState=Pe,G.childLanes=C5(d,ye,b),g.memoizedState=M5,L):(zf(g),b=d.child,d=b.sibling,b=ca(b,{mode:"visible",children:L.children}),b.return=g,b.sibling=null,d!==null&&(ye=g.deletions,ye===null?(g.deletions=[d],g.flags|=16):ye.push(d)),g.child=b,g.memoizedState=null,b)}function I5(d,g){return g=qS({mode:"visible",children:g},d.mode),g.return=d,d.child=g}function qS(d,g){return d=yl(22,d,null,g),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function T5(d,g,b){return jv(g,d.child,null,b),d=I5(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function G$(d,g,b){d.lanes|=g;var L=d.alternate;L!==null&&(L.lanes|=g),h(d.return,g,b)}function P5(d,g,b,L,G){var W=d.memoizedState;W===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:L,tail:b,tailMode:G}:(W.isBackwards=g,W.rendering=null,W.renderingStartTime=0,W.last=L,W.tail=b,W.tailMode=G)}function H$(d,g,b){var L=g.pendingProps,G=L.revealOrder,W=L.tail;if(Ks(d,g,L.children,b),L=bs.current,(L&2)!==0)L=L&1|2,g.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&G$(d,b,g);else if(d.tag===19)G$(d,b,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}L&=1}switch(ce(bs,L),G){case"forwards":for(b=g.child,G=null;b!==null;)d=b.alternate,d!==null&&jS(d)===null&&(G=b),b=b.sibling;b=G,b===null?(G=g.child,g.child=null):(G=b.sibling,b.sibling=null),P5(g,!1,G,b,W);break;case"backwards":for(b=null,G=g.child,g.child=null;G!==null;){if(d=G.alternate,d!==null&&jS(d)===null){g.child=G;break}d=G.sibling,G.sibling=b,b=G,G=d}P5(g,!0,b,null,W);break;case"together":P5(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function yd(d,g,b){if(d!==null&&(g.dependencies=d.dependencies),Hf|=g.lanes,(b&g.childLanes)===0)if(d!==null){if(_(d,g,b,!1),(b&g.childLanes)===0)return null}else return null;if(d!==null&&g.child!==d.child)throw Error(i(153));if(g.child!==null){for(d=g.child,b=ca(d,d.pendingProps),g.child=b,b.return=g;d.sibling!==null;)d=d.sibling,b=b.sibling=ca(d,d.pendingProps),b.return=g;b.sibling=null}return g.child}function L5(d,g){return(d.lanes&g)!==0?!0:(d=d.dependencies,!!(d!==null&&A(d)))}function R6e(d,g,b){switch(g.tag){case 3:Le(g,g.stateNode.containerInfo),dh(g,At,d.memoizedState.cache),Bc();break;case 27:case 5:Re(g);break;case 4:Le(g,g.stateNode.containerInfo);break;case 10:dh(g,g.type,g.memoizedProps.value);break;case 13:var L=g.memoizedState;if(L!==null)return L.dehydrated!==null?(zf(g),g.flags|=128,null):(b&g.child.childLanes)!==0?$$(d,g,b):(zf(g),d=yd(d,g,b),d!==null?d.sibling:null);zf(g);break;case 19:var G=(d.flags&128)!==0;if(L=(b&g.childLanes)!==0,L||(_(d,g,b,!1),L=(b&g.childLanes)!==0),G){if(L)return H$(d,g,b);g.flags|=128}if(G=g.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),ce(bs,bs.current),L)break;return null;case 22:case 23:return g.lanes=0,B$(d,g,b);case 24:dh(g,At,d.memoizedState.cache)}return yd(d,g,b)}function q$(d,g,b){if(d!==null)if(d.memoizedProps!==g.pendingProps)Rs=!0;else{if(!L5(d,b)&&(g.flags&128)===0)return Rs=!1,R6e(d,g,b);Rs=(d.flags&131072)!==0}else Rs=!1,xn&&(g.flags&1048576)!==0&&CS(g,Of,g.index);switch(g.lanes=0,g.tag){case 16:e:{d=g.pendingProps;var L=g.elementType,G=L._init;if(L=G(L._payload),g.type=L,typeof L=="function")Ov(L)?(d=Ig(L,d),g.tag=1,g=V$(null,g,L,d,b)):(g.tag=0,g=S5(null,g,L,d,b));else{if(L!=null){if(G=L.$$typeof,G===T){g.tag=11,g=k$(null,g,L,d,b);break e}else if(G===k){g.tag=14,g=N$(null,g,L,d,b);break e}}throw g=V(L)||L,Error(i(306,g,""))}}return g;case 0:return S5(d,g,g.type,g.pendingProps,b);case 1:return L=g.type,G=Ig(L,g.pendingProps),V$(d,g,L,G,b);case 3:e:{if(Le(g,g.stateNode.containerInfo),d===null)throw Error(i(387));L=g.pendingProps;var W=g.memoizedState;G=W.element,e5(d,g),Xx(g,L,null,b);var ye=g.memoizedState;if(L=ye.cache,dh(g,At,L),L!==W.cache&&f(g,[At],b,!0),Wx(),L=ye.element,W.isDehydrated)if(W={element:L,isDehydrated:!1,cache:ye.cache},g.updateQueue.baseState=W,g.memoizedState=W,g.flags&256){g=j$(d,g,L,b);break e}else if(L!==G){G=Pn(Error(i(424)),g),Bo(G),g=j$(d,g,L,b);break e}else{switch(d=g.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(ra=gh(d.firstChild),wo=g,xn=!0,du=null,xs=!0,b=S$(g,null,L,b),g.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling}else{if(Bc(),L===G){g=yd(d,g,b);break e}Ks(d,g,L,b)}g=g.child}return g;case 26:return HS(d,g),d===null?(b=YG(g.type,null,g.pendingProps,null))?g.memoizedState=b:xn||(b=g.type,d=g.pendingProps,L=oM(de.current).createElement(b),L[Gt]=g,L[ke]=d,Qs(L,b,d),$r(L),g.stateNode=L):g.memoizedState=YG(g.type,d.memoizedProps,g.pendingProps,d.memoizedState),null;case 27:return Re(g),d===null&&xn&&(L=g.stateNode=WG(g.type,g.pendingProps,de.current),wo=g,xs=!0,G=ra,Zf(g.type)?(hL=G,ra=gh(L.firstChild)):ra=G),Ks(d,g,g.pendingProps.children,b),HS(d,g),d===null&&(g.flags|=4194304),g.child;case 5:return d===null&&xn&&((G=L=ra)&&(L=sRe(L,g.type,g.pendingProps,xs),L!==null?(g.stateNode=L,wo=g,ra=gh(L.firstChild),xs=!1,G=!0):G=!1),G||fu(g)),Re(g),G=g.type,W=g.pendingProps,ye=d!==null?d.memoizedProps:null,L=W.children,sL(G,W)?L=null:ye!==null&&sL(G,ye)&&(g.flags|=32),g.memoizedState!==null&&(G=o5(d,g,M6e,null,null,b),gb._currentValue=G),HS(d,g),Ks(d,g,L,b),g.child;case 6:return d===null&&xn&&((d=b=ra)&&(b=lRe(b,g.pendingProps,xs),b!==null?(g.stateNode=b,wo=g,ra=null,d=!0):d=!1),d||fu(g)),null;case 13:return $$(d,g,b);case 4:return Le(g,g.stateNode.containerInfo),L=g.pendingProps,d===null?g.child=jv(g,null,L,b):Ks(d,g,L,b),g.child;case 11:return k$(d,g,g.type,g.pendingProps,b);case 7:return Ks(d,g,g.pendingProps,b),g.child;case 8:return Ks(d,g,g.pendingProps.children,b),g.child;case 12:return Ks(d,g,g.pendingProps.children,b),g.child;case 10:return L=g.pendingProps,dh(g,g.type,L.value),Ks(d,g,L.children,b),g.child;case 9:return G=g.type._context,L=g.pendingProps.children,R(g),G=H(G),L=L(G),g.flags|=1,Ks(d,g,L,b),g.child;case 14:return N$(d,g,g.type,g.pendingProps,b);case 15:return F$(d,g,g.type,g.pendingProps,b);case 19:return H$(d,g,b);case 31:return L=g.pendingProps,b=g.mode,L={mode:L.mode,children:L.children},d===null?(b=qS(L,b),b.ref=g.ref,g.child=b,b.return=g,g=b):(b=ca(d.child,L),b.ref=g.ref,g.child=b,b.return=g,g=b),g;case 22:return B$(d,g,b);case 24:return R(g),L=H(At),d===null?(G=K4(),G===null&&(G=Ta,W=hr(),G.pooledCache=W,W.refCount++,W!==null&&(G.pooledCacheLanes|=b),G=W),g.memoizedState={parent:L,cache:G},Q4(g),dh(g,At,G)):((d.lanes&b)!==0&&(e5(d,g),Xx(g,null,null,b),Wx()),G=d.memoizedState,W=g.memoizedState,G.parent!==L?(G={parent:L,cache:L},g.memoizedState=G,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=G),dh(g,At,L)):(L=W.cache,dh(g,At,L),L!==G.cache&&f(g,[At],b,!0))),Ks(d,g,g.pendingProps.children,b),g.child;case 29:throw g.pendingProps}throw Error(i(156,g.tag))}function vd(d){d.flags|=4}function W$(d,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!tH(g)){if(g=zc.current,g!==null&&((Cn&4194048)===Cn?cp!==null:(Cn&62914560)!==Cn&&(Cn&536870912)===0||g!==cp))throw Hx=J4,Pj;d.flags|=8192}}function WS(d,g){g!==null&&(d.flags|=4),d.flags&16384&&(g=d.tag!==22?er():536870912,d.lanes|=g,qv|=g)}function tb(d,g){if(!xn)switch(d.tailMode){case"hidden":g=d.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?d.tail=null:b.sibling=null;break;case"collapsed":b=d.tail;for(var L=null;b!==null;)b.alternate!==null&&(L=b),b=b.sibling;L===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:L.sibling=null}}function uo(d){var g=d.alternate!==null&&d.alternate.child===d.child,b=0,L=0;if(g)for(var G=d.child;G!==null;)b|=G.lanes|G.childLanes,L|=G.subtreeFlags&65011712,L|=G.flags&65011712,G.return=d,G=G.sibling;else for(G=d.child;G!==null;)b|=G.lanes|G.childLanes,L|=G.subtreeFlags,L|=G.flags,G.return=d,G=G.sibling;return d.subtreeFlags|=L,d.childLanes=b,g}function O6e(d,g,b){var L=g.pendingProps;switch(Vl(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return uo(g),null;case 1:return uo(g),null;case 3:return b=g.stateNode,L=null,d!==null&&(L=d.memoizedState.cache),g.memoizedState.cache!==L&&(g.flags|=2048),$l(At),fe(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(d===null||d.child===null)&&(jl(g)?vd(g):d===null||d.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,ph())),uo(g),null;case 26:return b=g.memoizedState,d===null?(vd(g),b!==null?(uo(g),W$(g,b)):(uo(g),g.flags&=-16777217)):b?b!==d.memoizedState?(vd(g),uo(g),W$(g,b)):(uo(g),g.flags&=-16777217):(d.memoizedProps!==L&&vd(g),uo(g),g.flags&=-16777217),null;case 27:me(g),b=de.current;var G=g.type;if(d!==null&&g.stateNode!=null)d.memoizedProps!==L&&vd(g);else{if(!L){if(g.stateNode===null)throw Error(i(166));return uo(g),null}d=re.current,jl(g)?hh(g):(d=WG(G,L,b),g.stateNode=d,vd(g))}return uo(g),null;case 5:if(me(g),b=g.type,d!==null&&g.stateNode!=null)d.memoizedProps!==L&&vd(g);else{if(!L){if(g.stateNode===null)throw Error(i(166));return uo(g),null}if(d=re.current,jl(g))hh(g);else{switch(G=oM(de.current),d){case 1:d=G.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:d=G.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":d=G.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":d=G.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":d=G.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof L.is=="string"?G.createElement("select",{is:L.is}):G.createElement("select"),L.multiple?d.multiple=!0:L.size&&(d.size=L.size);break;default:d=typeof L.is=="string"?G.createElement(b,{is:L.is}):G.createElement(b)}}d[Gt]=g,d[ke]=L;e:for(G=g.child;G!==null;){if(G.tag===5||G.tag===6)d.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===g)break e;for(;G.sibling===null;){if(G.return===null||G.return===g)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}g.stateNode=d;e:switch(Qs(d,b,L),b){case"button":case"input":case"select":case"textarea":d=!!L.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&vd(g)}}return uo(g),g.flags&=-16777217,null;case 6:if(d&&g.stateNode!=null)d.memoizedProps!==L&&vd(g);else{if(typeof L!="string"&&g.stateNode===null)throw Error(i(166));if(d=de.current,jl(g)){if(d=g.stateNode,b=g.memoizedProps,L=null,G=wo,G!==null)switch(G.tag){case 27:case 5:L=G.memoizedProps}d[Gt]=g,d=!!(d.nodeValue===b||L!==null&&L.suppressHydrationWarning===!0||UG(d.nodeValue,b)),d||fu(g)}else d=oM(d).createTextNode(L),d[Gt]=g,g.stateNode=d}return uo(g),null;case 13:if(L=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(G=jl(g),L!==null&&L.dehydrated!==null){if(d===null){if(!G)throw Error(i(318));if(G=g.memoizedState,G=G!==null?G.dehydrated:null,!G)throw Error(i(317));G[Gt]=g}else Bc(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;uo(g),G=!1}else G=ph(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=G),G=!0;if(!G)return g.flags&256?(gd(g),g):(gd(g),null)}if(gd(g),(g.flags&128)!==0)return g.lanes=b,g;if(b=L!==null,d=d!==null&&d.memoizedState!==null,b){L=g.child,G=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(G=L.alternate.memoizedState.cachePool.pool);var W=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(W=L.memoizedState.cachePool.pool),W!==G&&(L.flags|=2048)}return b!==d&&b&&(g.child.flags|=8192),WS(g,g.updateQueue),uo(g),null;case 4:return fe(),d===null&&rL(g.stateNode.containerInfo),uo(g),null;case 10:return $l(g.type),uo(g),null;case 19:if(K(bs),G=g.memoizedState,G===null)return uo(g),null;if(L=(g.flags&128)!==0,W=G.rendering,W===null)if(L)tb(G,!1);else{if(Ao!==0||d!==null&&(d.flags&128)!==0)for(d=g.child;d!==null;){if(W=jS(d),W!==null){for(g.flags|=128,tb(G,!1),d=W.updateQueue,g.updateQueue=d,WS(g,d),g.subtreeFlags=0,d=b,b=g.child;b!==null;)kc(b,d),b=b.sibling;return ce(bs,bs.current&1|2),g.child}d=d.sibling}G.tail!==null&&We()>YS&&(g.flags|=128,L=!0,tb(G,!1),g.lanes=4194304)}else{if(!L)if(d=jS(W),d!==null){if(g.flags|=128,L=!0,d=d.updateQueue,g.updateQueue=d,WS(g,d),tb(G,!0),G.tail===null&&G.tailMode==="hidden"&&!W.alternate&&!xn)return uo(g),null}else 2*We()-G.renderingStartTime>YS&&b!==536870912&&(g.flags|=128,L=!0,tb(G,!1),g.lanes=4194304);G.isBackwards?(W.sibling=g.child,g.child=W):(d=G.last,d!==null?d.sibling=W:g.child=W,G.last=W)}return G.tail!==null?(g=G.tail,G.rendering=g,G.tail=g.sibling,G.renderingStartTime=We(),g.sibling=null,d=bs.current,ce(bs,L?d&1|2:d&1),g):(uo(g),null);case 22:case 23:return gd(g),n5(),L=g.memoizedState!==null,d!==null?d.memoizedState!==null!==L&&(g.flags|=8192):L&&(g.flags|=8192),L?(b&536870912)!==0&&(g.flags&128)===0&&(uo(g),g.subtreeFlags&6&&(g.flags|=8192)):uo(g),b=g.updateQueue,b!==null&&WS(g,b.retryQueue),b=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),L=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(L=g.memoizedState.cachePool.pool),L!==b&&(g.flags|=2048),d!==null&&K(Eg),null;case 24:return b=null,d!==null&&(b=d.memoizedState.cache),g.memoizedState.cache!==b&&(g.flags|=2048),$l(At),uo(g),null;case 25:return null;case 30:return null}throw Error(i(156,g.tag))}function k6e(d,g){switch(Vl(g),g.tag){case 1:return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return $l(At),fe(),d=g.flags,(d&65536)!==0&&(d&128)===0?(g.flags=d&-65537|128,g):null;case 26:case 27:case 5:return me(g),null;case 13:if(gd(g),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(i(340));Bc()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return K(bs),null;case 4:return fe(),null;case 10:return $l(g.type),null;case 22:case 23:return gd(g),n5(),d!==null&&K(Eg),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 24:return $l(At),null;case 25:return null;default:return null}}function X$(d,g){switch(Vl(g),g.tag){case 3:$l(At),fe();break;case 26:case 27:case 5:me(g);break;case 4:fe();break;case 13:gd(g);break;case 19:K(bs);break;case 10:$l(g.type);break;case 22:case 23:gd(g),n5(),d!==null&&K(Eg);break;case 24:$l(At)}}function rb(d,g){try{var b=g.updateQueue,L=b!==null?b.lastEffect:null;if(L!==null){var G=L.next;b=G;do{if((b.tag&d)===d){L=void 0;var W=b.create,ye=b.inst;L=W(),ye.destroy=L}b=b.next}while(b!==G)}}catch(Pe){Sa(g,g.return,Pe)}}function Vf(d,g,b){try{var L=g.updateQueue,G=L!==null?L.lastEffect:null;if(G!==null){var W=G.next;L=W;do{if((L.tag&d)===d){var ye=L.inst,Pe=ye.destroy;if(Pe!==void 0){ye.destroy=void 0,G=g;var Ke=b,Ct=Pe;try{Ct()}catch(Xt){Sa(G,Ke,Xt)}}}L=L.next}while(L!==W)}}catch(Xt){Sa(g,g.return,Xt)}}function Z$(d){var g=d.updateQueue;if(g!==null){var b=d.stateNode;try{Nj(g,b)}catch(L){Sa(d,d.return,L)}}}function Y$(d,g,b){b.props=Ig(d.type,d.memoizedProps),b.state=d.memoizedState;try{b.componentWillUnmount()}catch(L){Sa(d,g,L)}}function ib(d,g){try{var b=d.ref;if(b!==null){switch(d.tag){case 26:case 27:case 5:var L=d.stateNode;break;case 30:L=d.stateNode;break;default:L=d.stateNode}typeof b=="function"?d.refCleanup=b(L):b.current=L}}catch(G){Sa(d,g,G)}}function hp(d,g){var b=d.ref,L=d.refCleanup;if(b!==null)if(typeof L=="function")try{L()}catch(G){Sa(d,g,G)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(G){Sa(d,g,G)}else b.current=null}function K$(d){var g=d.type,b=d.memoizedProps,L=d.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":b.autoFocus&&L.focus();break e;case"img":b.src?L.src=b.src:b.srcSet&&(L.srcset=b.srcSet)}}catch(G){Sa(d,d.return,G)}}function D5(d,g,b){try{var L=d.stateNode;rRe(L,d.type,b,g),L[ke]=g}catch(G){Sa(d,d.return,G)}}function J$(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Zf(d.type)||d.tag===4}function R5(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||J$(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Zf(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function O5(d,g,b){var L=d.tag;if(L===5||L===6)d=d.stateNode,g?(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b).insertBefore(d,g):(g=b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,g.appendChild(d),b=b._reactRootContainer,b!=null||g.onclick!==null||(g.onclick=aM));else if(L!==4&&(L===27&&Zf(d.type)&&(b=d.stateNode,g=null),d=d.child,d!==null))for(O5(d,g,b),d=d.sibling;d!==null;)O5(d,g,b),d=d.sibling}function XS(d,g,b){var L=d.tag;if(L===5||L===6)d=d.stateNode,g?b.insertBefore(d,g):b.appendChild(d);else if(L!==4&&(L===27&&Zf(d.type)&&(b=d.stateNode),d=d.child,d!==null))for(XS(d,g,b),d=d.sibling;d!==null;)XS(d,g,b),d=d.sibling}function Q$(d){var g=d.stateNode,b=d.memoizedProps;try{for(var L=d.type,G=g.attributes;G.length;)g.removeAttributeNode(G[0]);Qs(g,L,b),g[Gt]=d,g[ke]=b}catch(W){Sa(d,d.return,W)}}var _d=!1,Uo=!1,k5=!1,eG=typeof WeakSet=="function"?WeakSet:Set,Os=null;function N6e(d,g){if(d=d.containerInfo,aL=pM,d=oo(d),ap(d)){if("selectionStart"in d)var b={start:d.selectionStart,end:d.selectionEnd};else e:{b=(b=d.ownerDocument)&&b.defaultView||window;var L=b.getSelection&&b.getSelection();if(L&&L.rangeCount!==0){b=L.anchorNode;var G=L.anchorOffset,W=L.focusNode;L=L.focusOffset;try{b.nodeType,W.nodeType}catch{b=null;break e}var ye=0,Pe=-1,Ke=-1,Ct=0,Xt=0,tr=d,Dt=null;t:for(;;){for(var Ot;tr!==b||G!==0&&tr.nodeType!==3||(Pe=ye+G),tr!==W||L!==0&&tr.nodeType!==3||(Ke=ye+L),tr.nodeType===3&&(ye+=tr.nodeValue.length),(Ot=tr.firstChild)!==null;)Dt=tr,tr=Ot;for(;;){if(tr===d)break t;if(Dt===b&&++Ct===G&&(Pe=ye),Dt===W&&++Xt===L&&(Ke=ye),(Ot=tr.nextSibling)!==null)break;tr=Dt,Dt=tr.parentNode}tr=Ot}b=Pe===-1||Ke===-1?null:{start:Pe,end:Ke}}else b=null}b=b||{start:0,end:0}}else b=null;for(oL={focusedElem:d,selectionRange:b},pM=!1,Os=g;Os!==null;)if(g=Os,d=g.child,(g.subtreeFlags&1024)!==0&&d!==null)d.return=g,Os=d;else for(;Os!==null;){switch(g=Os,W=g.alternate,d=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&W!==null){d=void 0,b=g,G=W.memoizedProps,W=W.memoizedState,L=b.stateNode;try{var Ei=Ig(b.type,G,b.elementType===b.type);d=L.getSnapshotBeforeUpdate(Ei,W),L.__reactInternalSnapshotBeforeUpdate=d}catch(_i){Sa(b,b.return,_i)}}break;case 3:if((d&1024)!==0){if(d=g.stateNode.containerInfo,b=d.nodeType,b===9)uL(d);else if(b===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":uL(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(i(163))}if(d=g.sibling,d!==null){d.return=g.return,Os=d;break}Os=g.return}}function tG(d,g,b){var L=b.flags;switch(b.tag){case 0:case 11:case 15:jf(d,b),L&4&&rb(5,b);break;case 1:if(jf(d,b),L&4)if(d=b.stateNode,g===null)try{d.componentDidMount()}catch(ye){Sa(b,b.return,ye)}else{var G=Ig(b.type,g.memoizedProps);g=g.memoizedState;try{d.componentDidUpdate(G,g,d.__reactInternalSnapshotBeforeUpdate)}catch(ye){Sa(b,b.return,ye)}}L&64&&Z$(b),L&512&&ib(b,b.return);break;case 3:if(jf(d,b),L&64&&(d=b.updateQueue,d!==null)){if(g=null,b.child!==null)switch(b.child.tag){case 27:case 5:g=b.child.stateNode;break;case 1:g=b.child.stateNode}try{Nj(d,g)}catch(ye){Sa(b,b.return,ye)}}break;case 27:g===null&&L&4&&Q$(b);case 26:case 5:jf(d,b),g===null&&L&4&&K$(b),L&512&&ib(b,b.return);break;case 12:jf(d,b);break;case 13:jf(d,b),L&4&&nG(d,b),L&64&&(d=b.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(b=H6e.bind(null,b),uRe(d,b))));break;case 22:if(L=b.memoizedState!==null||_d,!L){g=g!==null&&g.memoizedState!==null||Uo,G=_d;var W=Uo;_d=L,(Uo=g)&&!W?$f(d,b,(b.subtreeFlags&8772)!==0):jf(d,b),_d=G,Uo=W}break;case 30:break;default:jf(d,b)}}function rG(d){var g=d.alternate;g!==null&&(d.alternate=null,rG(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&Zr(g)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Xa=null,yu=!1;function xd(d,g,b){for(b=b.child;b!==null;)iG(d,g,b),b=b.sibling}function iG(d,g,b){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(Et,b)}catch{}switch(b.tag){case 26:Uo||hp(b,g),xd(d,g,b),b.memoizedState?b.memoizedState.count--:b.stateNode&&(b=b.stateNode,b.parentNode.removeChild(b));break;case 27:Uo||hp(b,g);var L=Xa,G=yu;Zf(b.type)&&(Xa=b.stateNode,yu=!1),xd(d,g,b),pb(b.stateNode),Xa=L,yu=G;break;case 5:Uo||hp(b,g);case 6:if(L=Xa,G=yu,Xa=null,xd(d,g,b),Xa=L,yu=G,Xa!==null)if(yu)try{(Xa.nodeType===9?Xa.body:Xa.nodeName==="HTML"?Xa.ownerDocument.body:Xa).removeChild(b.stateNode)}catch(W){Sa(b,g,W)}else try{Xa.removeChild(b.stateNode)}catch(W){Sa(b,g,W)}break;case 18:Xa!==null&&(yu?(d=Xa,HG(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,b.stateNode),xb(d)):HG(Xa,b.stateNode));break;case 4:L=Xa,G=yu,Xa=b.stateNode.containerInfo,yu=!0,xd(d,g,b),Xa=L,yu=G;break;case 0:case 11:case 14:case 15:Uo||Vf(2,b,g),Uo||Vf(4,b,g),xd(d,g,b);break;case 1:Uo||(hp(b,g),L=b.stateNode,typeof L.componentWillUnmount=="function"&&Y$(b,g,L)),xd(d,g,b);break;case 21:xd(d,g,b);break;case 22:Uo=(L=Uo)||b.memoizedState!==null,xd(d,g,b),Uo=L;break;default:xd(d,g,b)}}function nG(d,g){if(g.memoizedState===null&&(d=g.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{xb(d)}catch(b){Sa(g,g.return,b)}}function F6e(d){switch(d.tag){case 13:case 19:var g=d.stateNode;return g===null&&(g=d.stateNode=new eG),g;case 22:return d=d.stateNode,g=d._retryCache,g===null&&(g=d._retryCache=new eG),g;default:throw Error(i(435,d.tag))}}function N5(d,g){var b=F6e(d);g.forEach(function(L){var G=q6e.bind(null,d,L);b.has(L)||(b.add(L),L.then(G,G))})}function Qu(d,g){var b=g.deletions;if(b!==null)for(var L=0;L<b.length;L++){var G=b[L],W=d,ye=g,Pe=ye;e:for(;Pe!==null;){switch(Pe.tag){case 27:if(Zf(Pe.type)){Xa=Pe.stateNode,yu=!1;break e}break;case 5:Xa=Pe.stateNode,yu=!1;break e;case 3:case 4:Xa=Pe.stateNode.containerInfo,yu=!0;break e}Pe=Pe.return}if(Xa===null)throw Error(i(160));iG(W,ye,G),Xa=null,yu=!1,W=G.alternate,W!==null&&(W.return=null),G.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)aG(g,d),g=g.sibling}var mh=null;function aG(d,g){var b=d.alternate,L=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Qu(g,d),ec(d),L&4&&(Vf(3,d,d.return),rb(3,d),Vf(5,d,d.return));break;case 1:Qu(g,d),ec(d),L&512&&(Uo||b===null||hp(b,b.return)),L&64&&_d&&(d=d.updateQueue,d!==null&&(L=d.callbacks,L!==null&&(b=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=b===null?L:b.concat(L))));break;case 26:var G=mh;if(Qu(g,d),ec(d),L&512&&(Uo||b===null||hp(b,b.return)),L&4){var W=b!==null?b.memoizedState:null;if(L=d.memoizedState,b===null)if(L===null)if(d.stateNode===null){e:{L=d.type,b=d.memoizedProps,G=G.ownerDocument||G;t:switch(L){case"title":W=G.getElementsByTagName("title")[0],(!W||W[nr]||W[Gt]||W.namespaceURI==="http://www.w3.org/2000/svg"||W.hasAttribute("itemprop"))&&(W=G.createElement(L),G.head.insertBefore(W,G.querySelector("head > title"))),Qs(W,L,b),W[Gt]=d,$r(W),L=W;break e;case"link":var ye=QG("link","href",G).get(L+(b.href||""));if(ye){for(var Pe=0;Pe<ye.length;Pe++)if(W=ye[Pe],W.getAttribute("href")===(b.href==null||b.href===""?null:b.href)&&W.getAttribute("rel")===(b.rel==null?null:b.rel)&&W.getAttribute("title")===(b.title==null?null:b.title)&&W.getAttribute("crossorigin")===(b.crossOrigin==null?null:b.crossOrigin)){ye.splice(Pe,1);break t}}W=G.createElement(L),Qs(W,L,b),G.head.appendChild(W);break;case"meta":if(ye=QG("meta","content",G).get(L+(b.content||""))){for(Pe=0;Pe<ye.length;Pe++)if(W=ye[Pe],W.getAttribute("content")===(b.content==null?null:""+b.content)&&W.getAttribute("name")===(b.name==null?null:b.name)&&W.getAttribute("property")===(b.property==null?null:b.property)&&W.getAttribute("http-equiv")===(b.httpEquiv==null?null:b.httpEquiv)&&W.getAttribute("charset")===(b.charSet==null?null:b.charSet)){ye.splice(Pe,1);break t}}W=G.createElement(L),Qs(W,L,b),G.head.appendChild(W);break;default:throw Error(i(468,L))}W[Gt]=d,$r(W),L=W}d.stateNode=L}else eH(G,d.type,d.stateNode);else d.stateNode=JG(G,L,d.memoizedProps);else W!==L?(W===null?b.stateNode!==null&&(b=b.stateNode,b.parentNode.removeChild(b)):W.count--,L===null?eH(G,d.type,d.stateNode):JG(G,L,d.memoizedProps)):L===null&&d.stateNode!==null&&D5(d,d.memoizedProps,b.memoizedProps)}break;case 27:Qu(g,d),ec(d),L&512&&(Uo||b===null||hp(b,b.return)),b!==null&&L&4&&D5(d,d.memoizedProps,b.memoizedProps);break;case 5:if(Qu(g,d),ec(d),L&512&&(Uo||b===null||hp(b,b.return)),d.flags&32){G=d.stateNode;try{be(G,"")}catch(Ot){Sa(d,d.return,Ot)}}L&4&&d.stateNode!=null&&(G=d.memoizedProps,D5(d,G,b!==null?b.memoizedProps:G)),L&1024&&(k5=!0);break;case 6:if(Qu(g,d),ec(d),L&4){if(d.stateNode===null)throw Error(i(162));L=d.memoizedProps,b=d.stateNode;try{b.nodeValue=L}catch(Ot){Sa(d,d.return,Ot)}}break;case 3:if(uM=null,G=mh,mh=sM(g.containerInfo),Qu(g,d),mh=G,ec(d),L&4&&b!==null&&b.memoizedState.isDehydrated)try{xb(g.containerInfo)}catch(Ot){Sa(d,d.return,Ot)}k5&&(k5=!1,oG(d));break;case 4:L=mh,mh=sM(d.stateNode.containerInfo),Qu(g,d),ec(d),mh=L;break;case 12:Qu(g,d),ec(d);break;case 13:Qu(g,d),ec(d),d.child.flags&8192&&d.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(j5=We()),L&4&&(L=d.updateQueue,L!==null&&(d.updateQueue=null,N5(d,L)));break;case 22:G=d.memoizedState!==null;var Ke=b!==null&&b.memoizedState!==null,Ct=_d,Xt=Uo;if(_d=Ct||G,Uo=Xt||Ke,Qu(g,d),Uo=Xt,_d=Ct,ec(d),L&8192)e:for(g=d.stateNode,g._visibility=G?g._visibility&-2:g._visibility|1,G&&(b===null||Ke||_d||Uo||Tg(d)),b=null,g=d;;){if(g.tag===5||g.tag===26){if(b===null){Ke=b=g;try{if(W=Ke.stateNode,G)ye=W.style,typeof ye.setProperty=="function"?ye.setProperty("display","none","important"):ye.display="none";else{Pe=Ke.stateNode;var tr=Ke.memoizedProps.style,Dt=tr!=null&&tr.hasOwnProperty("display")?tr.display:null;Pe.style.display=Dt==null||typeof Dt=="boolean"?"":(""+Dt).trim()}}catch(Ot){Sa(Ke,Ke.return,Ot)}}}else if(g.tag===6){if(b===null){Ke=g;try{Ke.stateNode.nodeValue=G?"":Ke.memoizedProps}catch(Ot){Sa(Ke,Ke.return,Ot)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===d)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break e;for(;g.sibling===null;){if(g.return===null||g.return===d)break e;b===g&&(b=null),g=g.return}b===g&&(b=null),g.sibling.return=g.return,g=g.sibling}L&4&&(L=d.updateQueue,L!==null&&(b=L.retryQueue,b!==null&&(L.retryQueue=null,N5(d,b))));break;case 19:Qu(g,d),ec(d),L&4&&(L=d.updateQueue,L!==null&&(d.updateQueue=null,N5(d,L)));break;case 30:break;case 21:break;default:Qu(g,d),ec(d)}}function ec(d){var g=d.flags;if(g&2){try{for(var b,L=d.return;L!==null;){if(J$(L)){b=L;break}L=L.return}if(b==null)throw Error(i(160));switch(b.tag){case 27:var G=b.stateNode,W=R5(d);XS(d,W,G);break;case 5:var ye=b.stateNode;b.flags&32&&(be(ye,""),b.flags&=-33);var Pe=R5(d);XS(d,Pe,ye);break;case 3:case 4:var Ke=b.stateNode.containerInfo,Ct=R5(d);O5(d,Ct,Ke);break;default:throw Error(i(161))}}catch(Xt){Sa(d,d.return,Xt)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function oG(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var g=d;oG(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),d=d.sibling}}function jf(d,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)tG(d,g.alternate,g),g=g.sibling}function Tg(d){for(d=d.child;d!==null;){var g=d;switch(g.tag){case 0:case 11:case 14:case 15:Vf(4,g,g.return),Tg(g);break;case 1:hp(g,g.return);var b=g.stateNode;typeof b.componentWillUnmount=="function"&&Y$(g,g.return,b),Tg(g);break;case 27:pb(g.stateNode);case 26:case 5:hp(g,g.return),Tg(g);break;case 22:g.memoizedState===null&&Tg(g);break;case 30:Tg(g);break;default:Tg(g)}d=d.sibling}}function $f(d,g,b){for(b=b&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var L=g.alternate,G=d,W=g,ye=W.flags;switch(W.tag){case 0:case 11:case 15:$f(G,W,b),rb(4,W);break;case 1:if($f(G,W,b),L=W,G=L.stateNode,typeof G.componentDidMount=="function")try{G.componentDidMount()}catch(Ct){Sa(L,L.return,Ct)}if(L=W,G=L.updateQueue,G!==null){var Pe=L.stateNode;try{var Ke=G.shared.hiddenCallbacks;if(Ke!==null)for(G.shared.hiddenCallbacks=null,G=0;G<Ke.length;G++)kj(Ke[G],Pe)}catch(Ct){Sa(L,L.return,Ct)}}b&&ye&64&&Z$(W),ib(W,W.return);break;case 27:Q$(W);case 26:case 5:$f(G,W,b),b&&L===null&&ye&4&&K$(W),ib(W,W.return);break;case 12:$f(G,W,b);break;case 13:$f(G,W,b),b&&ye&4&&nG(G,W);break;case 22:W.memoizedState===null&&$f(G,W,b),ib(W,W.return);break;case 30:break;default:$f(G,W,b)}g=g.sibling}}function F5(d,g){var b=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),d=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(d=g.memoizedState.cachePool.pool),d!==b&&(d!=null&&d.refCount++,b!=null&&gr(b))}function B5(d,g){d=null,g.alternate!==null&&(d=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==d&&(g.refCount++,d!=null&&gr(d))}function pp(d,g,b,L){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)sG(d,g,b,L),g=g.sibling}function sG(d,g,b,L){var G=g.flags;switch(g.tag){case 0:case 11:case 15:pp(d,g,b,L),G&2048&&rb(9,g);break;case 1:pp(d,g,b,L);break;case 3:pp(d,g,b,L),G&2048&&(d=null,g.alternate!==null&&(d=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==d&&(g.refCount++,d!=null&&gr(d)));break;case 12:if(G&2048){pp(d,g,b,L),d=g.stateNode;try{var W=g.memoizedProps,ye=W.id,Pe=W.onPostCommit;typeof Pe=="function"&&Pe(ye,g.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Ke){Sa(g,g.return,Ke)}}else pp(d,g,b,L);break;case 13:pp(d,g,b,L);break;case 23:break;case 22:W=g.stateNode,ye=g.alternate,g.memoizedState!==null?W._visibility&2?pp(d,g,b,L):nb(d,g):W._visibility&2?pp(d,g,b,L):(W._visibility|=2,$v(d,g,b,L,(g.subtreeFlags&10256)!==0)),G&2048&&F5(ye,g);break;case 24:pp(d,g,b,L),G&2048&&B5(g.alternate,g);break;default:pp(d,g,b,L)}}function $v(d,g,b,L,G){for(G=G&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var W=d,ye=g,Pe=b,Ke=L,Ct=ye.flags;switch(ye.tag){case 0:case 11:case 15:$v(W,ye,Pe,Ke,G),rb(8,ye);break;case 23:break;case 22:var Xt=ye.stateNode;ye.memoizedState!==null?Xt._visibility&2?$v(W,ye,Pe,Ke,G):nb(W,ye):(Xt._visibility|=2,$v(W,ye,Pe,Ke,G)),G&&Ct&2048&&F5(ye.alternate,ye);break;case 24:$v(W,ye,Pe,Ke,G),G&&Ct&2048&&B5(ye.alternate,ye);break;default:$v(W,ye,Pe,Ke,G)}g=g.sibling}}function nb(d,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var b=d,L=g,G=L.flags;switch(L.tag){case 22:nb(b,L),G&2048&&F5(L.alternate,L);break;case 24:nb(b,L),G&2048&&B5(L.alternate,L);break;default:nb(b,L)}g=g.sibling}}var ab=8192;function Gv(d){if(d.subtreeFlags&ab)for(d=d.child;d!==null;)lG(d),d=d.sibling}function lG(d){switch(d.tag){case 26:Gv(d),d.flags&ab&&d.memoizedState!==null&&wRe(mh,d.memoizedState,d.memoizedProps);break;case 5:Gv(d);break;case 3:case 4:var g=mh;mh=sM(d.stateNode.containerInfo),Gv(d),mh=g;break;case 22:d.memoizedState===null&&(g=d.alternate,g!==null&&g.memoizedState!==null?(g=ab,ab=16777216,Gv(d),ab=g):Gv(d));break;default:Gv(d)}}function uG(d){var g=d.alternate;if(g!==null&&(d=g.child,d!==null)){g.child=null;do g=d.sibling,d.sibling=null,d=g;while(d!==null)}}function ob(d){var g=d.deletions;if((d.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var L=g[b];Os=L,hG(L,d)}uG(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)cG(d),d=d.sibling}function cG(d){switch(d.tag){case 0:case 11:case 15:ob(d),d.flags&2048&&Vf(9,d,d.return);break;case 3:ob(d);break;case 12:ob(d);break;case 22:var g=d.stateNode;d.memoizedState!==null&&g._visibility&2&&(d.return===null||d.return.tag!==13)?(g._visibility&=-3,ZS(d)):ob(d);break;default:ob(d)}}function ZS(d){var g=d.deletions;if((d.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var L=g[b];Os=L,hG(L,d)}uG(d)}for(d=d.child;d!==null;){switch(g=d,g.tag){case 0:case 11:case 15:Vf(8,g,g.return),ZS(g);break;case 22:b=g.stateNode,b._visibility&2&&(b._visibility&=-3,ZS(g));break;default:ZS(g)}d=d.sibling}}function hG(d,g){for(;Os!==null;){var b=Os;switch(b.tag){case 0:case 11:case 15:Vf(8,b,g);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var L=b.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:gr(b.memoizedState.cache)}if(L=b.child,L!==null)L.return=b,Os=L;else e:for(b=d;Os!==null;){L=Os;var G=L.sibling,W=L.return;if(rG(L),L===b){Os=null;break e}if(G!==null){G.return=W,Os=G;break e}Os=W}}}var B6e={getCacheForType:function(d){var g=H(At),b=g.data.get(d);return b===void 0&&(b=d(),g.data.set(d,b)),b}},z6e=typeof WeakMap=="function"?WeakMap:Map,ia=0,Ta=null,dn=null,Cn=0,na=0,tc=null,Gf=!1,Hv=!1,z5=!1,bd=0,Ao=0,Hf=0,Pg=0,U5=0,Uc=0,qv=0,sb=null,vu=null,V5=!1,j5=0,YS=1/0,KS=null,qf=null,Js=0,Wf=null,Wv=null,Xv=0,$5=0,G5=null,pG=null,lb=0,H5=null;function rc(){if((ia&2)!==0&&Cn!==0)return Cn&-Cn;if(Y.T!==null){var d=Vi;return d!==0?d:J5()}return st()}function dG(){Uc===0&&(Uc=(Cn&536870912)===0||xn?Qe():536870912);var d=zc.current;return d!==null&&(d.flags|=32),Uc}function ic(d,g,b){(d===Ta&&(na===2||na===9)||d.cancelPendingCommit!==null)&&(Zv(d,0),Xf(d,Cn,Uc,!1)),oe(d,b),((ia&2)===0||d!==Ta)&&(d===Ta&&((ia&2)===0&&(Pg|=b),Ao===4&&Xf(d,Cn,Uc,!1)),dp(d))}function fG(d,g,b){if((ia&6)!==0)throw Error(i(327));var L=!b&&(g&124)===0&&(g&d.expiredLanes)===0||ar(d,g),G=L?j6e(d,g):X5(d,g,!0),W=L;do{if(G===0){Hv&&!L&&Xf(d,g,0,!1);break}else{if(b=d.current.alternate,W&&!U6e(b)){G=X5(d,g,!1),W=!1;continue}if(G===2){if(W=g,d.errorRecoveryDisabledLanes&W)var ye=0;else ye=d.pendingLanes&-536870913,ye=ye!==0?ye:ye&536870912?536870912:0;if(ye!==0){g=ye;e:{var Pe=d;G=sb;var Ke=Pe.current.memoizedState.isDehydrated;if(Ke&&(Zv(Pe,ye).flags|=256),ye=X5(Pe,ye,!1),ye!==2){if(z5&&!Ke){Pe.errorRecoveryDisabledLanes|=W,Pg|=W,G=4;break e}W=vu,vu=G,W!==null&&(vu===null?vu=W:vu.push.apply(vu,W))}G=ye}if(W=!1,G!==2)continue}}if(G===1){Zv(d,0),Xf(d,g,0,!0);break}e:{switch(L=d,W=G,W){case 0:case 1:throw Error(i(345));case 4:if((g&4194048)!==g)break;case 6:Xf(L,g,Uc,!Gf);break e;case 2:vu=null;break;case 3:case 5:break;default:throw Error(i(329))}if((g&62914560)===g&&(G=j5+300-We(),10<G)){if(Xf(L,g,Uc,!Gf),rr(L,0,!0)!==0)break e;L.timeoutHandle=$G(mG.bind(null,L,b,vu,KS,V5,g,Uc,Pg,qv,Gf,W,2,-0,0),G);break e}mG(L,b,vu,KS,V5,g,Uc,Pg,qv,Gf,W,0,-0,0)}}break}while(!0);dp(d)}function mG(d,g,b,L,G,W,ye,Pe,Ke,Ct,Xt,tr,Dt,Ot){if(d.timeoutHandle=-1,tr=g.subtreeFlags,(tr&8192||(tr&16785408)===16785408)&&(mb={stylesheets:null,count:0,unsuspend:bRe},lG(g),tr=ARe(),tr!==null)){d.cancelPendingCommit=tr(wG.bind(null,d,g,W,b,L,G,ye,Pe,Ke,Xt,1,Dt,Ot)),Xf(d,W,ye,!Ct);return}wG(d,g,W,b,L,G,ye,Pe,Ke)}function U6e(d){for(var g=d;;){var b=g.tag;if((b===0||b===11||b===15)&&g.flags&16384&&(b=g.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var L=0;L<b.length;L++){var G=b[L],W=G.getSnapshot;G=G.value;try{if(!Qo(W(),G))return!1}catch{return!1}}if(b=g.child,g.subtreeFlags&16384&&b!==null)b.return=g,g=b;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Xf(d,g,b,L){g&=~U5,g&=~Pg,d.suspendedLanes|=g,d.pingedLanes&=~g,L&&(d.warmLanes|=g),L=d.expirationTimes;for(var G=g;0<G;){var W=31-Kt(G),ye=1<<W;L[W]=-1,G&=~ye}b!==0&&Se(d,b,g)}function JS(){return(ia&6)===0?(ub(0),!1):!0}function q5(){if(dn!==null){if(na===0)var d=dn.return;else d=dn,En=lo=null,u5(d),Vv=null,Qx=0,d=dn;for(;d!==null;)X$(d.alternate,d),d=d.return;dn=null}}function Zv(d,g){var b=d.timeoutHandle;b!==-1&&(d.timeoutHandle=-1,nRe(b)),b=d.cancelPendingCommit,b!==null&&(d.cancelPendingCommit=null,b()),q5(),Ta=d,dn=b=ca(d.current,null),Cn=g,na=0,tc=null,Gf=!1,Hv=ar(d,g),z5=!1,qv=Uc=U5=Pg=Hf=Ao=0,vu=sb=null,V5=!1,(g&8)!==0&&(g|=g&32);var L=d.entangledLanes;if(L!==0)for(d=d.entanglements,L&=g;0<L;){var G=31-Kt(L),W=1<<G;g|=d[G],L&=~W}return bd=g,Ls(),b}function gG(d,g){en=null,Y.H=zS,g===Gx||g===TS?(g=Rj(),na=3):g===Pj?(g=Rj(),na=4):na=g===O$?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,tc=g,dn===null&&(Ao=1,GS(d,Pn(g,d.current)))}function yG(){var d=Y.H;return Y.H=zS,d===null?zS:d}function vG(){var d=Y.A;return Y.A=B6e,d}function W5(){Ao=4,Gf||(Cn&4194048)!==Cn&&zc.current!==null||(Hv=!0),(Hf&134217727)===0&&(Pg&134217727)===0||Ta===null||Xf(Ta,Cn,Uc,!1)}function X5(d,g,b){var L=ia;ia|=2;var G=yG(),W=vG();(Ta!==d||Cn!==g)&&(KS=null,Zv(d,g)),g=!1;var ye=Ao;e:do try{if(na!==0&&dn!==null){var Pe=dn,Ke=tc;switch(na){case 8:q5(),ye=6;break e;case 3:case 2:case 9:case 6:zc.current===null&&(g=!0);var Ct=na;if(na=0,tc=null,Yv(d,Pe,Ke,Ct),b&&Hv){ye=0;break e}break;default:Ct=na,na=0,tc=null,Yv(d,Pe,Ke,Ct)}}V6e(),ye=Ao;break}catch(Xt){gG(d,Xt)}while(!0);return g&&d.shellSuspendCounter++,En=lo=null,ia=L,Y.H=G,Y.A=W,dn===null&&(Ta=null,Cn=0,Ls()),ye}function V6e(){for(;dn!==null;)_G(dn)}function j6e(d,g){var b=ia;ia|=2;var L=yG(),G=vG();Ta!==d||Cn!==g?(KS=null,YS=We()+500,Zv(d,g)):Hv=ar(d,g);e:do try{if(na!==0&&dn!==null){g=dn;var W=tc;t:switch(na){case 1:na=0,tc=null,Yv(d,g,W,1);break;case 2:case 9:if(Lj(W)){na=0,tc=null,xG(g);break}g=function(){na!==2&&na!==9||Ta!==d||(na=7),dp(d)},W.then(g,g);break e;case 3:na=7;break e;case 4:na=5;break e;case 7:Lj(W)?(na=0,tc=null,xG(g)):(na=0,tc=null,Yv(d,g,W,7));break;case 5:var ye=null;switch(dn.tag){case 26:ye=dn.memoizedState;case 5:case 27:var Pe=dn;if(!ye||tH(ye)){na=0,tc=null;var Ke=Pe.sibling;if(Ke!==null)dn=Ke;else{var Ct=Pe.return;Ct!==null?(dn=Ct,QS(Ct)):dn=null}break t}}na=0,tc=null,Yv(d,g,W,5);break;case 6:na=0,tc=null,Yv(d,g,W,6);break;case 8:q5(),Ao=6;break e;default:throw Error(i(462))}}$6e();break}catch(Xt){gG(d,Xt)}while(!0);return En=lo=null,Y.H=L,Y.A=G,ia=b,dn!==null?0:(Ta=null,Cn=0,Ls(),Ao)}function $6e(){for(;dn!==null&&!lt();)_G(dn)}function _G(d){var g=q$(d.alternate,d,bd);d.memoizedProps=d.pendingProps,g===null?QS(d):dn=g}function xG(d){var g=d,b=g.alternate;switch(g.tag){case 15:case 0:g=U$(b,g,g.pendingProps,g.type,void 0,Cn);break;case 11:g=U$(b,g,g.pendingProps,g.type.render,g.ref,Cn);break;case 5:u5(g);default:X$(b,g),g=dn=kc(g,bd),g=q$(b,g,bd)}d.memoizedProps=d.pendingProps,g===null?QS(d):dn=g}function Yv(d,g,b,L){En=lo=null,u5(g),Vv=null,Qx=0;var G=g.return;try{if(D6e(d,G,g,b,Cn)){Ao=1,GS(d,Pn(b,d.current)),dn=null;return}}catch(W){if(G!==null)throw dn=G,W;Ao=1,GS(d,Pn(b,d.current)),dn=null;return}g.flags&32768?(xn||L===1?d=!0:Hv||(Cn&536870912)!==0?d=!1:(Gf=d=!0,(L===2||L===9||L===3||L===6)&&(L=zc.current,L!==null&&L.tag===13&&(L.flags|=16384))),bG(g,d)):QS(g)}function QS(d){var g=d;do{if((g.flags&32768)!==0){bG(g,Gf);return}d=g.return;var b=O6e(g.alternate,g,bd);if(b!==null){dn=b;return}if(g=g.sibling,g!==null){dn=g;return}dn=g=d}while(g!==null);Ao===0&&(Ao=5)}function bG(d,g){do{var b=k6e(d.alternate,d);if(b!==null){b.flags&=32767,dn=b;return}if(b=d.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!g&&(d=d.sibling,d!==null)){dn=d;return}dn=d=b}while(d!==null);Ao=6,dn=null}function wG(d,g,b,L,G,W,ye,Pe,Ke){d.cancelPendingCommit=null;do eM();while(Js!==0);if((ia&6)!==0)throw Error(i(327));if(g!==null){if(g===d.current)throw Error(i(177));if(W=g.lanes|g.childLanes,W|=ka,le(d,b,W,ye,Pe,Ke),d===Ta&&(dn=Ta=null,Cn=0),Wv=g,Wf=d,Xv=b,$5=W,G5=G,pG=L,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,W6e(Me,function(){return CG(),null})):(d.callbackNode=null,d.callbackPriority=0),L=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||L){L=Y.T,Y.T=null,G=he.p,he.p=2,ye=ia,ia|=4;try{N6e(d,g,b)}finally{ia=ye,he.p=G,Y.T=L}}Js=1,AG(),SG(),MG()}}function AG(){if(Js===1){Js=0;var d=Wf,g=Wv,b=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||b){b=Y.T,Y.T=null;var L=he.p;he.p=2;var G=ia;ia|=4;try{aG(g,d);var W=oL,ye=oo(d.containerInfo),Pe=W.focusedElem,Ke=W.selectionRange;if(ye!==Pe&&Pe&&Pe.ownerDocument&&hu(Pe.ownerDocument.documentElement,Pe)){if(Ke!==null&&ap(Pe)){var Ct=Ke.start,Xt=Ke.end;if(Xt===void 0&&(Xt=Ct),"selectionStart"in Pe)Pe.selectionStart=Ct,Pe.selectionEnd=Math.min(Xt,Pe.value.length);else{var tr=Pe.ownerDocument||document,Dt=tr&&tr.defaultView||window;if(Dt.getSelection){var Ot=Dt.getSelection(),Ei=Pe.textContent.length,_i=Math.min(Ke.start,Ei),da=Ke.end===void 0?_i:Math.min(Ke.end,Ei);!Ot.extend&&_i>da&&(ye=da,da=_i,_i=ye);var gt=np(Pe,_i),ut=np(Pe,da);if(gt&&ut&&(Ot.rangeCount!==1||Ot.anchorNode!==gt.node||Ot.anchorOffset!==gt.offset||Ot.focusNode!==ut.node||Ot.focusOffset!==ut.offset)){var St=tr.createRange();St.setStart(gt.node,gt.offset),Ot.removeAllRanges(),_i>da?(Ot.addRange(St),Ot.extend(ut.node,ut.offset)):(St.setEnd(ut.node,ut.offset),Ot.addRange(St))}}}}for(tr=[],Ot=Pe;Ot=Ot.parentNode;)Ot.nodeType===1&&tr.push({element:Ot,left:Ot.scrollLeft,top:Ot.scrollTop});for(typeof Pe.focus=="function"&&Pe.focus(),Pe=0;Pe<tr.length;Pe++){var Qt=tr[Pe];Qt.element.scrollLeft=Qt.left,Qt.element.scrollTop=Qt.top}}pM=!!aL,oL=aL=null}finally{ia=G,he.p=L,Y.T=b}}d.current=g,Js=2}}function SG(){if(Js===2){Js=0;var d=Wf,g=Wv,b=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||b){b=Y.T,Y.T=null;var L=he.p;he.p=2;var G=ia;ia|=4;try{tG(d,g.alternate,g)}finally{ia=G,he.p=L,Y.T=b}}Js=3}}function MG(){if(Js===4||Js===3){Js=0,tt();var d=Wf,g=Wv,b=Xv,L=pG;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?Js=5:(Js=0,Wv=Wf=null,EG(d,d.pendingLanes));var G=d.pendingLanes;if(G===0&&(qf=null),yt(b),g=g.stateNode,pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(Et,g,void 0,(g.current.flags&128)===128)}catch{}if(L!==null){g=Y.T,G=he.p,he.p=2,Y.T=null;try{for(var W=d.onRecoverableError,ye=0;ye<L.length;ye++){var Pe=L[ye];W(Pe.value,{componentStack:Pe.stack})}}finally{Y.T=g,he.p=G}}(Xv&3)!==0&&eM(),dp(d),G=d.pendingLanes,(b&4194090)!==0&&(G&42)!==0?d===H5?lb++:(lb=0,H5=d):lb=0,ub(0)}}function EG(d,g){(d.pooledCacheLanes&=g)===0&&(g=d.pooledCache,g!=null&&(d.pooledCache=null,gr(g)))}function eM(d){return AG(),SG(),MG(),CG()}function CG(){if(Js!==5)return!1;var d=Wf,g=$5;$5=0;var b=yt(Xv),L=Y.T,G=he.p;try{he.p=32>b?32:b,Y.T=null,b=G5,G5=null;var W=Wf,ye=Xv;if(Js=0,Wv=Wf=null,Xv=0,(ia&6)!==0)throw Error(i(331));var Pe=ia;if(ia|=4,cG(W.current),sG(W,W.current,ye,b),ia=Pe,ub(0,!1),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(Et,W)}catch{}return!0}finally{he.p=G,Y.T=L,EG(d,g)}}function IG(d,g,b){g=Pn(b,g),g=A5(d.stateNode,g,2),d=Ff(d,g,2),d!==null&&(oe(d,2),dp(d))}function Sa(d,g,b){if(d.tag===3)IG(d,d,b);else for(;g!==null;){if(g.tag===3){IG(g,d,b);break}else if(g.tag===1){var L=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(qf===null||!qf.has(L))){d=Pn(b,d),b=D$(2),L=Ff(g,b,2),L!==null&&(R$(b,L,g,d),oe(L,2),dp(L));break}}g=g.return}}function Z5(d,g,b){var L=d.pingCache;if(L===null){L=d.pingCache=new z6e;var G=new Set;L.set(g,G)}else G=L.get(g),G===void 0&&(G=new Set,L.set(g,G));G.has(b)||(z5=!0,G.add(b),d=G6e.bind(null,d,g,b),g.then(d,d))}function G6e(d,g,b){var L=d.pingCache;L!==null&&L.delete(g),d.pingedLanes|=d.suspendedLanes&b,d.warmLanes&=~b,Ta===d&&(Cn&b)===b&&(Ao===4||Ao===3&&(Cn&62914560)===Cn&&300>We()-j5?(ia&2)===0&&Zv(d,0):U5|=b,qv===Cn&&(qv=0)),dp(d)}function TG(d,g){g===0&&(g=er()),d=_s(d,g),d!==null&&(oe(d,g),dp(d))}function H6e(d){var g=d.memoizedState,b=0;g!==null&&(b=g.retryLane),TG(d,b)}function q6e(d,g){var b=0;switch(d.tag){case 13:var L=d.stateNode,G=d.memoizedState;G!==null&&(b=G.retryLane);break;case 19:L=d.stateNode;break;case 22:L=d.stateNode._retryCache;break;default:throw Error(i(314))}L!==null&&L.delete(g),TG(d,b)}function W6e(d,g){return Ue(d,g)}var tM=null,Kv=null,Y5=!1,rM=!1,K5=!1,Lg=0;function dp(d){d!==Kv&&d.next===null&&(Kv===null?tM=Kv=d:Kv=Kv.next=d),rM=!0,Y5||(Y5=!0,Z6e())}function ub(d,g){if(!K5&&rM){K5=!0;do for(var b=!1,L=tM;L!==null;){if(d!==0){var G=L.pendingLanes;if(G===0)var W=0;else{var ye=L.suspendedLanes,Pe=L.pingedLanes;W=(1<<31-Kt(42|d)+1)-1,W&=G&~(ye&~Pe),W=W&201326741?W&201326741|1:W?W|2:0}W!==0&&(b=!0,RG(L,W))}else W=Cn,W=rr(L,L===Ta?W:0,L.cancelPendingCommit!==null||L.timeoutHandle!==-1),(W&3)===0||ar(L,W)||(b=!0,RG(L,W));L=L.next}while(b);K5=!1}}function X6e(){PG()}function PG(){rM=Y5=!1;var d=0;Lg!==0&&(iRe()&&(d=Lg),Lg=0);for(var g=We(),b=null,L=tM;L!==null;){var G=L.next,W=LG(L,g);W===0?(L.next=null,b===null?tM=G:b.next=G,G===null&&(Kv=b)):(b=L,(d!==0||(W&3)!==0)&&(rM=!0)),L=G}ub(d)}function LG(d,g){for(var b=d.suspendedLanes,L=d.pingedLanes,G=d.expirationTimes,W=d.pendingLanes&-62914561;0<W;){var ye=31-Kt(W),Pe=1<<ye,Ke=G[ye];Ke===-1?((Pe&b)===0||(Pe&L)!==0)&&(G[ye]=zr(Pe,g)):Ke<=g&&(d.expiredLanes|=Pe),W&=~Pe}if(g=Ta,b=Cn,b=rr(d,d===g?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),L=d.callbackNode,b===0||d===g&&(na===2||na===9)||d.cancelPendingCommit!==null)return L!==null&&L!==null&&_e(L),d.callbackNode=null,d.callbackPriority=0;if((b&3)===0||ar(d,b)){if(g=b&-b,g===d.callbackPriority)return g;switch(L!==null&&_e(L),yt(b)){case 2:case 8:b=dt;break;case 32:b=Me;break;case 268435456:b=Ze;break;default:b=Me}return L=DG.bind(null,d),b=Ue(b,L),d.callbackPriority=g,d.callbackNode=b,g}return L!==null&&L!==null&&_e(L),d.callbackPriority=2,d.callbackNode=null,2}function DG(d,g){if(Js!==0&&Js!==5)return d.callbackNode=null,d.callbackPriority=0,null;var b=d.callbackNode;if(eM()&&d.callbackNode!==b)return null;var L=Cn;return L=rr(d,d===Ta?L:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),L===0?null:(fG(d,L,g),LG(d,We()),d.callbackNode!=null&&d.callbackNode===b?DG.bind(null,d):null)}function RG(d,g){if(eM())return null;fG(d,g,!0)}function Z6e(){aRe(function(){(ia&6)!==0?Ue(Lt,X6e):PG()})}function J5(){return Lg===0&&(Lg=Qe()),Lg}function OG(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:mr(""+d)}function kG(d,g){var b=g.ownerDocument.createElement("input");return b.name=g.name,b.value=g.value,d.id&&b.setAttribute("form",d.id),g.parentNode.insertBefore(b,g),d=new FormData(d),b.parentNode.removeChild(b),d}function Y6e(d,g,b,L,G){if(g==="submit"&&b&&b.stateNode===G){var W=OG((G[ke]||null).action),ye=L.submitter;ye&&(g=(g=ye[ke]||null)?OG(g.formAction):ye.getAttribute("formAction"),g!==null&&(W=g,ye=null));var Pe=new et("action","action",null,L,G);d.push({event:Pe,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(Lg!==0){var Ke=ye?kG(G,ye):new FormData(G);v5(b,{pending:!0,data:Ke,method:G.method,action:W},null,Ke)}}else typeof W=="function"&&(Pe.preventDefault(),Ke=ye?kG(G,ye):new FormData(G),v5(b,{pending:!0,data:Ke,method:G.method,action:W},W,Ke))},currentTarget:G}]})}}for(var Q5=0;Q5<Zu.length;Q5++){var eL=Zu[Q5],K6e=eL.toLowerCase(),J6e=eL[0].toUpperCase()+eL.slice(1);ua(K6e,"on"+J6e)}ua(Oc,"onAnimationEnd"),ua(sp,"onAnimationIteration"),ua(so,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(ko,"onTransitionRun"),ua(pu,"onTransitionStart"),ua(ml,"onTransitionCancel"),ua(Dv,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),Mn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q6e=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cb));function NG(d,g){g=(g&4)!==0;for(var b=0;b<d.length;b++){var L=d[b],G=L.event;L=L.listeners;e:{var W=void 0;if(g)for(var ye=L.length-1;0<=ye;ye--){var Pe=L[ye],Ke=Pe.instance,Ct=Pe.currentTarget;if(Pe=Pe.listener,Ke!==W&&G.isPropagationStopped())break e;W=Pe,G.currentTarget=Ct;try{W(G)}catch(Xt){$S(Xt)}G.currentTarget=null,W=Ke}else for(ye=0;ye<L.length;ye++){if(Pe=L[ye],Ke=Pe.instance,Ct=Pe.currentTarget,Pe=Pe.listener,Ke!==W&&G.isPropagationStopped())break e;W=Pe,G.currentTarget=Ct;try{W(G)}catch(Xt){$S(Xt)}G.currentTarget=null,W=Ke}}}}function fn(d,g){var b=g[ot];b===void 0&&(b=g[ot]=new Set);var L=d+"__bubble";b.has(L)||(FG(g,d,2,!1),b.add(L))}function tL(d,g,b){var L=0;g&&(L|=4),FG(b,d,L,g)}var iM="_reactListening"+Math.random().toString(36).slice(2);function rL(d){if(!d[iM]){d[iM]=!0,Qi.forEach(function(b){b!=="selectionchange"&&(Q6e.has(b)||tL(b,!1,d),tL(b,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[iM]||(g[iM]=!0,tL("selectionchange",!1,g))}}function FG(d,g,b,L){switch(sH(g)){case 2:var G=ERe;break;case 8:G=CRe;break;default:G=gL}b=G.bind(null,g,b,d),G=void 0,!vo||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(G=!0),L?G!==void 0?d.addEventListener(g,b,{capture:!0,passive:G}):d.addEventListener(g,b,!0):G!==void 0?d.addEventListener(g,b,{passive:G}):d.addEventListener(g,b,!1)}function iL(d,g,b,L,G){var W=L;if((g&1)===0&&(g&2)===0&&L!==null)e:for(;;){if(L===null)return;var ye=L.tag;if(ye===3||ye===4){var Pe=L.stateNode.containerInfo;if(Pe===G)break;if(ye===4)for(ye=L.return;ye!==null;){var Ke=ye.tag;if((Ke===3||Ke===4)&&ye.stateNode.containerInfo===G)return;ye=ye.return}for(;Pe!==null;){if(ye=ni(Pe),ye===null)return;if(Ke=ye.tag,Ke===5||Ke===6||Ke===26||Ke===27){L=W=ye;continue e}Pe=Pe.parentNode}}L=L.return}Bl(function(){var Ct=W,Xt=lr(b),tr=[];e:{var Dt=lp.get(d);if(Dt!==void 0){var Ot=et,Ei=d;switch(d){case"keypress":if(zl(b)===0)break e;case"keydown":case"keyup":Ot=Vx;break;case"focusin":Ei="focus",Ot=Un;break;case"focusout":Ei="blur",Ot=Un;break;case"beforeblur":case"afterblur":Ot=Un;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ot=ui;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ot=Ni;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ot=la;break;case Oc:case sp:case so:Ot=pl;break;case Dv:Ot=Ws;break;case"scroll":case"scrollend":Ot=Ge;break;case"wheel":Ot=Fi;break;case"copy":case"cut":case"paste":Ot=ip;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ot=Wi;break;case"toggle":case"beforetoggle":Ot=Vn}var _i=(g&4)!==0,da=!_i&&(d==="scroll"||d==="scrollend"),gt=_i?Dt!==null?Dt+"Capture":null:Dt;_i=[];for(var ut=Ct,St;ut!==null;){var Qt=ut;if(St=Qt.stateNode,Qt=Qt.tag,Qt!==5&&Qt!==26&&Qt!==27||St===null||gt===null||(Qt=sa(ut,gt),Qt!=null&&_i.push(hb(ut,Qt,St))),da)break;ut=ut.return}0<_i.length&&(Dt=new Ot(Dt,Ei,null,b,Xt),tr.push({event:Dt,listeners:_i}))}}if((g&7)===0){e:{if(Dt=d==="mouseover"||d==="pointerover",Ot=d==="mouseout"||d==="pointerout",Dt&&b!==xr&&(Ei=b.relatedTarget||b.fromElement)&&(ni(Ei)||Ei[$e]))break e;if((Ot||Dt)&&(Dt=Xt.window===Xt?Xt:(Dt=Xt.ownerDocument)?Dt.defaultView||Dt.parentWindow:window,Ot?(Ei=b.relatedTarget||b.toElement,Ot=Ct,Ei=Ei?ni(Ei):null,Ei!==null&&(da=a(Ei),_i=Ei.tag,Ei!==da||_i!==5&&_i!==27&&_i!==6)&&(Ei=null)):(Ot=null,Ei=Ct),Ot!==Ei)){if(_i=ui,Qt="onMouseLeave",gt="onMouseEnter",ut="mouse",(d==="pointerout"||d==="pointerover")&&(_i=Wi,Qt="onPointerLeave",gt="onPointerEnter",ut="pointer"),da=Ot==null?Dt:Cr(Ot),St=Ei==null?Dt:Cr(Ei),Dt=new _i(Qt,ut+"leave",Ot,b,Xt),Dt.target=da,Dt.relatedTarget=St,Qt=null,ni(Xt)===Ct&&(_i=new _i(gt,ut+"enter",Ei,b,Xt),_i.target=St,_i.relatedTarget=da,Qt=_i),da=Qt,Ot&&Ei)t:{for(_i=Ot,gt=Ei,ut=0,St=_i;St;St=Jv(St))ut++;for(St=0,Qt=gt;Qt;Qt=Jv(Qt))St++;for(;0<ut-St;)_i=Jv(_i),ut--;for(;0<St-ut;)gt=Jv(gt),St--;for(;ut--;){if(_i===gt||gt!==null&&_i===gt.alternate)break t;_i=Jv(_i),gt=Jv(gt)}_i=null}else _i=null;Ot!==null&&BG(tr,Dt,Ot,_i,!1),Ei!==null&&da!==null&&BG(tr,da,Ei,_i,!0)}}e:{if(Dt=Ct?Cr(Ct):window,Ot=Dt.nodeName&&Dt.nodeName.toLowerCase(),Ot==="select"||Ot==="input"&&Dt.type==="file")var Qr=lh;else if(Pc(Dt))if(Xu)Qr=ES;else{Qr=MS;var cn=cu}else Ot=Dt.nodeName,!Ot||Ot.toLowerCase()!=="input"||Dt.type!=="checkbox"&&Dt.type!=="radio"?Ct&&_t(Ct.elementType)&&(Qr=lh):Qr=ys;if(Qr&&(Qr=Qr(d,Ct))){dl(tr,Qr,b,Xt);break e}cn&&cn(d,Dt,Ct),d==="focusout"&&Ct&&Dt.type==="number"&&Ct.memoizedProps.value!=null&&O(Dt,"number",Dt.value)}switch(cn=Ct?Cr(Ct):window,d){case"focusin":(Pc(cn)||cn.contentEditable==="true")&&(Ts=cn,Dc=Ct,pd=null);break;case"focusout":pd=Dc=Ts=null;break;case"mousedown":uh=!0;break;case"contextmenu":case"mouseup":case"dragend":uh=!1,Rc(tr,b,Xt);break;case"selectionchange":if(es)break;case"keydown":case"keyup":Rc(tr,b,Xt)}var hi;if(Po)e:{switch(d){case"compositionstart":var wi="onCompositionStart";break e;case"compositionend":wi="onCompositionEnd";break e;case"compositionupdate":wi="onCompositionUpdate";break e}wi=void 0}else xo?hd(d,b)&&(wi="onCompositionEnd"):d==="keydown"&&b.keyCode===229&&(wi="onCompositionStart");wi&&(sh&&b.locale!=="ko"&&(xo||wi!=="onCompositionStart"?wi==="onCompositionEnd"&&xo&&(hi=Ia()):(_o=Xt,hl="value"in _o?_o.value:_o.textContent,xo=!0)),cn=nM(Ct,wi),0<cn.length&&(wi=new jr(wi,d,null,b,Xt),tr.push({event:wi,listeners:cn}),hi?wi.data=hi:(hi=su(b),hi!==null&&(wi.data=hi)))),(hi=AS?Lo(d,b):Y4(d,b))&&(wi=nM(Ct,"onBeforeInput"),0<wi.length&&(cn=new jr("onBeforeInput","beforeinput",null,b,Xt),tr.push({event:cn,listeners:wi}),cn.data=hi)),Y6e(tr,d,Ct,b,Xt)}NG(tr,g)})}function hb(d,g,b){return{instance:d,listener:g,currentTarget:b}}function nM(d,g){for(var b=g+"Capture",L=[];d!==null;){var G=d,W=G.stateNode;if(G=G.tag,G!==5&&G!==26&&G!==27||W===null||(G=sa(d,b),G!=null&&L.unshift(hb(d,G,W)),G=sa(d,g),G!=null&&L.push(hb(d,G,W))),d.tag===3)return L;d=d.return}return[]}function Jv(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function BG(d,g,b,L,G){for(var W=g._reactName,ye=[];b!==null&&b!==L;){var Pe=b,Ke=Pe.alternate,Ct=Pe.stateNode;if(Pe=Pe.tag,Ke!==null&&Ke===L)break;Pe!==5&&Pe!==26&&Pe!==27||Ct===null||(Ke=Ct,G?(Ct=sa(b,W),Ct!=null&&ye.unshift(hb(b,Ct,Ke))):G||(Ct=sa(b,W),Ct!=null&&ye.push(hb(b,Ct,Ke)))),b=b.return}ye.length!==0&&d.push({event:g,listeners:ye})}var eRe=/\r\n?/g,tRe=/\u0000|\uFFFD/g;function zG(d){return(typeof d=="string"?d:""+d).replace(eRe,`
`).replace(tRe,"")}function UG(d,g){return g=zG(g),zG(d)===g}function aM(){}function pa(d,g,b,L,G,W){switch(b){case"children":typeof L=="string"?g==="body"||g==="textarea"&&L===""||be(d,L):(typeof L=="number"||typeof L=="bigint")&&g!=="body"&&be(d,""+L);break;case"className":cr(d,"class",L);break;case"tabIndex":cr(d,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":cr(d,b,L);break;case"style":ct(d,L,W);break;case"data":if(g!=="object"){cr(d,"data",L);break}case"src":case"href":if(L===""&&(g!=="a"||b!=="href")){d.removeAttribute(b);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){d.removeAttribute(b);break}L=mr(""+L),d.setAttribute(b,L);break;case"action":case"formAction":if(typeof L=="function"){d.setAttribute(b,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof W=="function"&&(b==="formAction"?(g!=="input"&&pa(d,g,"name",G.name,G,null),pa(d,g,"formEncType",G.formEncType,G,null),pa(d,g,"formMethod",G.formMethod,G,null),pa(d,g,"formTarget",G.formTarget,G,null)):(pa(d,g,"encType",G.encType,G,null),pa(d,g,"method",G.method,G,null),pa(d,g,"target",G.target,G,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){d.removeAttribute(b);break}L=mr(""+L),d.setAttribute(b,L);break;case"onClick":L!=null&&(d.onclick=aM);break;case"onScroll":L!=null&&fn("scroll",d);break;case"onScrollEnd":L!=null&&fn("scrollend",d);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(i(61));if(b=L.__html,b!=null){if(G.children!=null)throw Error(i(60));d.innerHTML=b}}break;case"multiple":d.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":d.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){d.removeAttribute("xlink:href");break}b=mr(""+L),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?d.setAttribute(b,""+L):d.removeAttribute(b);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?d.setAttribute(b,""):d.removeAttribute(b);break;case"capture":case"download":L===!0?d.setAttribute(b,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?d.setAttribute(b,L):d.removeAttribute(b);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?d.setAttribute(b,L):d.removeAttribute(b);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?d.removeAttribute(b):d.setAttribute(b,L);break;case"popover":fn("beforetoggle",d),fn("toggle",d),zt(d,"popover",L);break;case"xlinkActuate":ur(d,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":ur(d,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":ur(d,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":ur(d,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":ur(d,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":ur(d,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":ur(d,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":ur(d,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":ur(d,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":zt(d,"is",L);break;case"innerText":case"textContent":break;default:(!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(b=qt.get(b)||b,zt(d,b,L))}}function nL(d,g,b,L,G,W){switch(b){case"style":ct(d,L,W);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(i(61));if(b=L.__html,b!=null){if(G.children!=null)throw Error(i(60));d.innerHTML=b}}break;case"children":typeof L=="string"?be(d,L):(typeof L=="number"||typeof L=="bigint")&&be(d,""+L);break;case"onScroll":L!=null&&fn("scroll",d);break;case"onScrollEnd":L!=null&&fn("scrollend",d);break;case"onClick":L!=null&&(d.onclick=aM);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gi.hasOwnProperty(b))e:{if(b[0]==="o"&&b[1]==="n"&&(G=b.endsWith("Capture"),g=b.slice(2,G?b.length-7:void 0),W=d[ke]||null,W=W!=null?W[b]:null,typeof W=="function"&&d.removeEventListener(g,W,G),typeof L=="function")){typeof W!="function"&&W!==null&&(b in d?d[b]=null:d.hasAttribute(b)&&d.removeAttribute(b)),d.addEventListener(g,L,G);break e}b in d?d[b]=L:L===!0?d.setAttribute(b,""):zt(d,b,L)}}}function Qs(d,g,b){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":fn("error",d),fn("load",d);var L=!1,G=!1,W;for(W in b)if(b.hasOwnProperty(W)){var ye=b[W];if(ye!=null)switch(W){case"src":L=!0;break;case"srcSet":G=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:pa(d,g,W,ye,b,null)}}G&&pa(d,g,"srcSet",b.srcSet,b,null),L&&pa(d,g,"src",b.src,b,null);return;case"input":fn("invalid",d);var Pe=W=ye=G=null,Ke=null,Ct=null;for(L in b)if(b.hasOwnProperty(L)){var Xt=b[L];if(Xt!=null)switch(L){case"name":G=Xt;break;case"type":ye=Xt;break;case"checked":Ke=Xt;break;case"defaultChecked":Ct=Xt;break;case"value":W=Xt;break;case"defaultValue":Pe=Xt;break;case"children":case"dangerouslySetInnerHTML":if(Xt!=null)throw Error(i(137,g));break;default:pa(d,g,L,Xt,b,null)}}S(d,W,Pe,Ke,Ct,ye,G,!1),Vr(d);return;case"select":fn("invalid",d),L=ye=W=null;for(G in b)if(b.hasOwnProperty(G)&&(Pe=b[G],Pe!=null))switch(G){case"value":W=Pe;break;case"defaultValue":ye=Pe;break;case"multiple":L=Pe;default:pa(d,g,G,Pe,b,null)}g=W,b=ye,d.multiple=!!L,g!=null?j(d,!!L,g,!1):b!=null&&j(d,!!L,b,!0);return;case"textarea":fn("invalid",d),W=G=L=null;for(ye in b)if(b.hasOwnProperty(ye)&&(Pe=b[ye],Pe!=null))switch(ye){case"value":L=Pe;break;case"defaultValue":G=Pe;break;case"children":W=Pe;break;case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(i(91));break;default:pa(d,g,ye,Pe,b,null)}ie(d,L,G,W),Vr(d);return;case"option":for(Ke in b)if(b.hasOwnProperty(Ke)&&(L=b[Ke],L!=null))switch(Ke){case"selected":d.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:pa(d,g,Ke,L,b,null)}return;case"dialog":fn("beforetoggle",d),fn("toggle",d),fn("cancel",d),fn("close",d);break;case"iframe":case"object":fn("load",d);break;case"video":case"audio":for(L=0;L<cb.length;L++)fn(cb[L],d);break;case"image":fn("error",d),fn("load",d);break;case"details":fn("toggle",d);break;case"embed":case"source":case"link":fn("error",d),fn("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ct in b)if(b.hasOwnProperty(Ct)&&(L=b[Ct],L!=null))switch(Ct){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:pa(d,g,Ct,L,b,null)}return;default:if(_t(g)){for(Xt in b)b.hasOwnProperty(Xt)&&(L=b[Xt],L!==void 0&&nL(d,g,Xt,L,b,void 0));return}}for(Pe in b)b.hasOwnProperty(Pe)&&(L=b[Pe],L!=null&&pa(d,g,Pe,L,b,null))}function rRe(d,g,b,L){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var G=null,W=null,ye=null,Pe=null,Ke=null,Ct=null,Xt=null;for(Ot in b){var tr=b[Ot];if(b.hasOwnProperty(Ot)&&tr!=null)switch(Ot){case"checked":break;case"value":break;case"defaultValue":Ke=tr;default:L.hasOwnProperty(Ot)||pa(d,g,Ot,null,L,tr)}}for(var Dt in L){var Ot=L[Dt];if(tr=b[Dt],L.hasOwnProperty(Dt)&&(Ot!=null||tr!=null))switch(Dt){case"type":W=Ot;break;case"name":G=Ot;break;case"checked":Ct=Ot;break;case"defaultChecked":Xt=Ot;break;case"value":ye=Ot;break;case"defaultValue":Pe=Ot;break;case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(i(137,g));break;default:Ot!==tr&&pa(d,g,Dt,Ot,L,tr)}}Gr(d,ye,Pe,Ke,Ct,Xt,W,G);return;case"select":Ot=ye=Pe=Dt=null;for(W in b)if(Ke=b[W],b.hasOwnProperty(W)&&Ke!=null)switch(W){case"value":break;case"multiple":Ot=Ke;default:L.hasOwnProperty(W)||pa(d,g,W,null,L,Ke)}for(G in L)if(W=L[G],Ke=b[G],L.hasOwnProperty(G)&&(W!=null||Ke!=null))switch(G){case"value":Dt=W;break;case"defaultValue":Pe=W;break;case"multiple":ye=W;default:W!==Ke&&pa(d,g,G,W,L,Ke)}g=Pe,b=ye,L=Ot,Dt!=null?j(d,!!b,Dt,!1):!!L!=!!b&&(g!=null?j(d,!!b,g,!0):j(d,!!b,b?[]:"",!1));return;case"textarea":Ot=Dt=null;for(Pe in b)if(G=b[Pe],b.hasOwnProperty(Pe)&&G!=null&&!L.hasOwnProperty(Pe))switch(Pe){case"value":break;case"children":break;default:pa(d,g,Pe,null,L,G)}for(ye in L)if(G=L[ye],W=b[ye],L.hasOwnProperty(ye)&&(G!=null||W!=null))switch(ye){case"value":Dt=G;break;case"defaultValue":Ot=G;break;case"children":break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(91));break;default:G!==W&&pa(d,g,ye,G,L,W)}X(d,Dt,Ot);return;case"option":for(var Ei in b)if(Dt=b[Ei],b.hasOwnProperty(Ei)&&Dt!=null&&!L.hasOwnProperty(Ei))switch(Ei){case"selected":d.selected=!1;break;default:pa(d,g,Ei,null,L,Dt)}for(Ke in L)if(Dt=L[Ke],Ot=b[Ke],L.hasOwnProperty(Ke)&&Dt!==Ot&&(Dt!=null||Ot!=null))switch(Ke){case"selected":d.selected=Dt&&typeof Dt!="function"&&typeof Dt!="symbol";break;default:pa(d,g,Ke,Dt,L,Ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _i in b)Dt=b[_i],b.hasOwnProperty(_i)&&Dt!=null&&!L.hasOwnProperty(_i)&&pa(d,g,_i,null,L,Dt);for(Ct in L)if(Dt=L[Ct],Ot=b[Ct],L.hasOwnProperty(Ct)&&Dt!==Ot&&(Dt!=null||Ot!=null))switch(Ct){case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(i(137,g));break;default:pa(d,g,Ct,Dt,L,Ot)}return;default:if(_t(g)){for(var da in b)Dt=b[da],b.hasOwnProperty(da)&&Dt!==void 0&&!L.hasOwnProperty(da)&&nL(d,g,da,void 0,L,Dt);for(Xt in L)Dt=L[Xt],Ot=b[Xt],!L.hasOwnProperty(Xt)||Dt===Ot||Dt===void 0&&Ot===void 0||nL(d,g,Xt,Dt,L,Ot);return}}for(var gt in b)Dt=b[gt],b.hasOwnProperty(gt)&&Dt!=null&&!L.hasOwnProperty(gt)&&pa(d,g,gt,null,L,Dt);for(tr in L)Dt=L[tr],Ot=b[tr],!L.hasOwnProperty(tr)||Dt===Ot||Dt==null&&Ot==null||pa(d,g,tr,Dt,L,Ot)}var aL=null,oL=null;function oM(d){return d.nodeType===9?d:d.ownerDocument}function VG(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jG(d,g){if(d===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&g==="foreignObject"?0:d}function sL(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var lL=null;function iRe(){var d=window.event;return d&&d.type==="popstate"?d===lL?!1:(lL=d,!0):(lL=null,!1)}var $G=typeof setTimeout=="function"?setTimeout:void 0,nRe=typeof clearTimeout=="function"?clearTimeout:void 0,GG=typeof Promise=="function"?Promise:void 0,aRe=typeof queueMicrotask=="function"?queueMicrotask:typeof GG<"u"?function(d){return GG.resolve(null).then(d).catch(oRe)}:$G;function oRe(d){setTimeout(function(){throw d})}function Zf(d){return d==="head"}function HG(d,g){var b=g,L=0,G=0;do{var W=b.nextSibling;if(d.removeChild(b),W&&W.nodeType===8)if(b=W.data,b==="/$"){if(0<L&&8>L){b=L;var ye=d.ownerDocument;if(b&1&&pb(ye.documentElement),b&2&&pb(ye.body),b&4)for(b=ye.head,pb(b),ye=b.firstChild;ye;){var Pe=ye.nextSibling,Ke=ye.nodeName;ye[nr]||Ke==="SCRIPT"||Ke==="STYLE"||Ke==="LINK"&&ye.rel.toLowerCase()==="stylesheet"||b.removeChild(ye),ye=Pe}}if(G===0){d.removeChild(W),xb(g);return}G--}else b==="$"||b==="$?"||b==="$!"?G++:L=b.charCodeAt(0)-48;else L=0;b=W}while(b);xb(g)}function uL(d){var g=d.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var b=g;switch(g=g.nextSibling,b.nodeName){case"HTML":case"HEAD":case"BODY":uL(b),Zr(b);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(b.rel.toLowerCase()==="stylesheet")continue}d.removeChild(b)}}function sRe(d,g,b,L){for(;d.nodeType===1;){var G=b;if(d.nodeName.toLowerCase()!==g.toLowerCase()){if(!L&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(L){if(!d[nr])switch(g){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(W=d.getAttribute("rel"),W==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(W!==G.rel||d.getAttribute("href")!==(G.href==null||G.href===""?null:G.href)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin)||d.getAttribute("title")!==(G.title==null?null:G.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(W=d.getAttribute("src"),(W!==(G.src==null?null:G.src)||d.getAttribute("type")!==(G.type==null?null:G.type)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin))&&W&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(g==="input"&&d.type==="hidden"){var W=G.name==null?null:""+G.name;if(G.type==="hidden"&&d.getAttribute("name")===W)return d}else return d;if(d=gh(d.nextSibling),d===null)break}return null}function lRe(d,g,b){if(g==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!b||(d=gh(d.nextSibling),d===null))return null;return d}function cL(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function uRe(d,g){var b=d.ownerDocument;if(d.data!=="$?"||b.readyState==="complete")g();else{var L=function(){g(),b.removeEventListener("DOMContentLoaded",L)};b.addEventListener("DOMContentLoaded",L),d._reactRetry=L}}function gh(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return d}var hL=null;function qG(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var b=d.data;if(b==="$"||b==="$!"||b==="$?"){if(g===0)return d;g--}else b==="/$"&&g++}d=d.previousSibling}return null}function WG(d,g,b){switch(g=oM(b),d){case"html":if(d=g.documentElement,!d)throw Error(i(452));return d;case"head":if(d=g.head,!d)throw Error(i(453));return d;case"body":if(d=g.body,!d)throw Error(i(454));return d;default:throw Error(i(451))}}function pb(d){for(var g=d.attributes;g.length;)d.removeAttributeNode(g[0]);Zr(d)}var Vc=new Map,XG=new Set;function sM(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var wd=he.d;he.d={f:cRe,r:hRe,D:pRe,C:dRe,L:fRe,m:mRe,X:yRe,S:gRe,M:vRe};function cRe(){var d=wd.f(),g=JS();return d||g}function hRe(d){var g=Yr(d);g!==null&&g.tag===5&&g.type==="form"?f$(g):wd.r(d)}var Qv=typeof document>"u"?null:document;function ZG(d,g,b){var L=Qv;if(L&&typeof g=="string"&&g){var G=Ui(g);G='link[rel="'+d+'"][href="'+G+'"]',typeof b=="string"&&(G+='[crossorigin="'+b+'"]'),XG.has(G)||(XG.add(G),d={rel:d,crossOrigin:b,href:g},L.querySelector(G)===null&&(g=L.createElement("link"),Qs(g,"link",d),$r(g),L.head.appendChild(g)))}}function pRe(d){wd.D(d),ZG("dns-prefetch",d,null)}function dRe(d,g){wd.C(d,g),ZG("preconnect",d,g)}function fRe(d,g,b){wd.L(d,g,b);var L=Qv;if(L&&d&&g){var G='link[rel="preload"][as="'+Ui(g)+'"]';g==="image"&&b&&b.imageSrcSet?(G+='[imagesrcset="'+Ui(b.imageSrcSet)+'"]',typeof b.imageSizes=="string"&&(G+='[imagesizes="'+Ui(b.imageSizes)+'"]')):G+='[href="'+Ui(d)+'"]';var W=G;switch(g){case"style":W=e0(d);break;case"script":W=t0(d)}Vc.has(W)||(d=p({rel:"preload",href:g==="image"&&b&&b.imageSrcSet?void 0:d,as:g},b),Vc.set(W,d),L.querySelector(G)!==null||g==="style"&&L.querySelector(db(W))||g==="script"&&L.querySelector(fb(W))||(g=L.createElement("link"),Qs(g,"link",d),$r(g),L.head.appendChild(g)))}}function mRe(d,g){wd.m(d,g);var b=Qv;if(b&&d){var L=g&&typeof g.as=="string"?g.as:"script",G='link[rel="modulepreload"][as="'+Ui(L)+'"][href="'+Ui(d)+'"]',W=G;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":W=t0(d)}if(!Vc.has(W)&&(d=p({rel:"modulepreload",href:d},g),Vc.set(W,d),b.querySelector(G)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(b.querySelector(fb(W)))return}L=b.createElement("link"),Qs(L,"link",d),$r(L),b.head.appendChild(L)}}}function gRe(d,g,b){wd.S(d,g,b);var L=Qv;if(L&&d){var G=Mi(L).hoistableStyles,W=e0(d);g=g||"default";var ye=G.get(W);if(!ye){var Pe={loading:0,preload:null};if(ye=L.querySelector(db(W)))Pe.loading=5;else{d=p({rel:"stylesheet",href:d,"data-precedence":g},b),(b=Vc.get(W))&&pL(d,b);var Ke=ye=L.createElement("link");$r(Ke),Qs(Ke,"link",d),Ke._p=new Promise(function(Ct,Xt){Ke.onload=Ct,Ke.onerror=Xt}),Ke.addEventListener("load",function(){Pe.loading|=1}),Ke.addEventListener("error",function(){Pe.loading|=2}),Pe.loading|=4,lM(ye,g,L)}ye={type:"stylesheet",instance:ye,count:1,state:Pe},G.set(W,ye)}}}function yRe(d,g){wd.X(d,g);var b=Qv;if(b&&d){var L=Mi(b).hoistableScripts,G=t0(d),W=L.get(G);W||(W=b.querySelector(fb(G)),W||(d=p({src:d,async:!0},g),(g=Vc.get(G))&&dL(d,g),W=b.createElement("script"),$r(W),Qs(W,"link",d),b.head.appendChild(W)),W={type:"script",instance:W,count:1,state:null},L.set(G,W))}}function vRe(d,g){wd.M(d,g);var b=Qv;if(b&&d){var L=Mi(b).hoistableScripts,G=t0(d),W=L.get(G);W||(W=b.querySelector(fb(G)),W||(d=p({src:d,async:!0,type:"module"},g),(g=Vc.get(G))&&dL(d,g),W=b.createElement("script"),$r(W),Qs(W,"link",d),b.head.appendChild(W)),W={type:"script",instance:W,count:1,state:null},L.set(G,W))}}function YG(d,g,b,L){var G=(G=de.current)?sM(G):null;if(!G)throw Error(i(446));switch(d){case"meta":case"title":return null;case"style":return typeof b.precedence=="string"&&typeof b.href=="string"?(g=e0(b.href),b=Mi(G).hoistableStyles,L=b.get(g),L||(L={type:"style",instance:null,count:0,state:null},b.set(g,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(b.rel==="stylesheet"&&typeof b.href=="string"&&typeof b.precedence=="string"){d=e0(b.href);var W=Mi(G).hoistableStyles,ye=W.get(d);if(ye||(G=G.ownerDocument||G,ye={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},W.set(d,ye),(W=G.querySelector(db(d)))&&!W._p&&(ye.instance=W,ye.state.loading=5),Vc.has(d)||(b={rel:"preload",as:"style",href:b.href,crossOrigin:b.crossOrigin,integrity:b.integrity,media:b.media,hrefLang:b.hrefLang,referrerPolicy:b.referrerPolicy},Vc.set(d,b),W||_Re(G,d,b,ye.state))),g&&L===null)throw Error(i(528,""));return ye}if(g&&L!==null)throw Error(i(529,""));return null;case"script":return g=b.async,b=b.src,typeof b=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=t0(b),b=Mi(G).hoistableScripts,L=b.get(g),L||(L={type:"script",instance:null,count:0,state:null},b.set(g,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,d))}}function e0(d){return'href="'+Ui(d)+'"'}function db(d){return'link[rel="stylesheet"]['+d+"]"}function KG(d){return p({},d,{"data-precedence":d.precedence,precedence:null})}function _Re(d,g,b,L){d.querySelector('link[rel="preload"][as="style"]['+g+"]")?L.loading=1:(g=d.createElement("link"),L.preload=g,g.addEventListener("load",function(){return L.loading|=1}),g.addEventListener("error",function(){return L.loading|=2}),Qs(g,"link",b),$r(g),d.head.appendChild(g))}function t0(d){return'[src="'+Ui(d)+'"]'}function fb(d){return"script[async]"+d}function JG(d,g,b){if(g.count++,g.instance===null)switch(g.type){case"style":var L=d.querySelector('style[data-href~="'+Ui(b.href)+'"]');if(L)return g.instance=L,$r(L),L;var G=p({},b,{"data-href":b.href,"data-precedence":b.precedence,href:null,precedence:null});return L=(d.ownerDocument||d).createElement("style"),$r(L),Qs(L,"style",G),lM(L,b.precedence,d),g.instance=L;case"stylesheet":G=e0(b.href);var W=d.querySelector(db(G));if(W)return g.state.loading|=4,g.instance=W,$r(W),W;L=KG(b),(G=Vc.get(G))&&pL(L,G),W=(d.ownerDocument||d).createElement("link"),$r(W);var ye=W;return ye._p=new Promise(function(Pe,Ke){ye.onload=Pe,ye.onerror=Ke}),Qs(W,"link",L),g.state.loading|=4,lM(W,b.precedence,d),g.instance=W;case"script":return W=t0(b.src),(G=d.querySelector(fb(W)))?(g.instance=G,$r(G),G):(L=b,(G=Vc.get(W))&&(L=p({},b),dL(L,G)),d=d.ownerDocument||d,G=d.createElement("script"),$r(G),Qs(G,"link",L),d.head.appendChild(G),g.instance=G);case"void":return null;default:throw Error(i(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(L=g.instance,g.state.loading|=4,lM(L,b.precedence,d));return g.instance}function lM(d,g,b){for(var L=b.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),G=L.length?L[L.length-1]:null,W=G,ye=0;ye<L.length;ye++){var Pe=L[ye];if(Pe.dataset.precedence===g)W=Pe;else if(W!==G)break}W?W.parentNode.insertBefore(d,W.nextSibling):(g=b.nodeType===9?b.head:b,g.insertBefore(d,g.firstChild))}function pL(d,g){d.crossOrigin==null&&(d.crossOrigin=g.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=g.referrerPolicy),d.title==null&&(d.title=g.title)}function dL(d,g){d.crossOrigin==null&&(d.crossOrigin=g.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=g.referrerPolicy),d.integrity==null&&(d.integrity=g.integrity)}var uM=null;function QG(d,g,b){if(uM===null){var L=new Map,G=uM=new Map;G.set(b,L)}else G=uM,L=G.get(b),L||(L=new Map,G.set(b,L));if(L.has(d))return L;for(L.set(d,null),b=b.getElementsByTagName(d),G=0;G<b.length;G++){var W=b[G];if(!(W[nr]||W[Gt]||d==="link"&&W.getAttribute("rel")==="stylesheet")&&W.namespaceURI!=="http://www.w3.org/2000/svg"){var ye=W.getAttribute(g)||"";ye=d+ye;var Pe=L.get(ye);Pe?Pe.push(W):L.set(ye,[W])}}return L}function eH(d,g,b){d=d.ownerDocument||d,d.head.insertBefore(b,g==="title"?d.querySelector("head > title"):null)}function xRe(d,g,b){if(b===1||g.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return d=g.disabled,typeof g.precedence=="string"&&d==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function tH(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var mb=null;function bRe(){}function wRe(d,g,b){if(mb===null)throw Error(i(475));var L=mb;if(g.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var G=e0(b.href),W=d.querySelector(db(G));if(W){d=W._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(L.count++,L=cM.bind(L),d.then(L,L)),g.state.loading|=4,g.instance=W,$r(W);return}W=d.ownerDocument||d,b=KG(b),(G=Vc.get(G))&&pL(b,G),W=W.createElement("link"),$r(W);var ye=W;ye._p=new Promise(function(Pe,Ke){ye.onload=Pe,ye.onerror=Ke}),Qs(W,"link",b),g.instance=W}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(g,d),(d=g.state.preload)&&(g.state.loading&3)===0&&(L.count++,g=cM.bind(L),d.addEventListener("load",g),d.addEventListener("error",g))}}function ARe(){if(mb===null)throw Error(i(475));var d=mb;return d.stylesheets&&d.count===0&&fL(d,d.stylesheets),0<d.count?function(g){var b=setTimeout(function(){if(d.stylesheets&&fL(d,d.stylesheets),d.unsuspend){var L=d.unsuspend;d.unsuspend=null,L()}},6e4);return d.unsuspend=g,function(){d.unsuspend=null,clearTimeout(b)}}:null}function cM(){if(this.count--,this.count===0){if(this.stylesheets)fL(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var hM=null;function fL(d,g){d.stylesheets=null,d.unsuspend!==null&&(d.count++,hM=new Map,g.forEach(SRe,d),hM=null,cM.call(d))}function SRe(d,g){if(!(g.state.loading&4)){var b=hM.get(d);if(b)var L=b.get(null);else{b=new Map,hM.set(d,b);for(var G=d.querySelectorAll("link[data-precedence],style[data-precedence]"),W=0;W<G.length;W++){var ye=G[W];(ye.nodeName==="LINK"||ye.getAttribute("media")!=="not all")&&(b.set(ye.dataset.precedence,ye),L=ye)}L&&b.set(null,L)}G=g.instance,ye=G.getAttribute("data-precedence"),W=b.get(ye)||L,W===L&&b.set(null,G),b.set(ye,G),this.count++,L=cM.bind(this),G.addEventListener("load",L),G.addEventListener("error",L),W?W.parentNode.insertBefore(G,W.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(G,d.firstChild)),g.state.loading|=4}}var gb={$$typeof:C,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function MRe(d,g,b,L,G,W,ye,Pe){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.hiddenUpdates=Oe(null),this.identifierPrefix=L,this.onUncaughtError=G,this.onCaughtError=W,this.onRecoverableError=ye,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pe,this.incompleteTransitions=new Map}function rH(d,g,b,L,G,W,ye,Pe,Ke,Ct,Xt,tr){return d=new MRe(d,g,b,ye,Pe,Ke,Ct,tr),g=1,W===!0&&(g|=24),W=yl(3,null,null,g),d.current=W,W.stateNode=d,g=hr(),g.refCount++,d.pooledCache=g,g.refCount++,W.memoizedState={element:L,isDehydrated:b,cache:g},Q4(W),d}function iH(d){return d?(d=Ds,d):Ds}function nH(d,g,b,L,G,W){G=iH(G),L.context===null?L.context=G:L.pendingContext=G,L=Nf(g),L.payload={element:b},W=W===void 0?null:W,W!==null&&(L.callback=W),b=Ff(d,L,g),b!==null&&(ic(b,d,g),qx(b,d,g))}function aH(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var b=d.retryLane;d.retryLane=b!==0&&b<g?b:g}}function mL(d,g){aH(d,g),(d=d.alternate)&&aH(d,g)}function oH(d){if(d.tag===13){var g=_s(d,67108864);g!==null&&ic(g,d,67108864),mL(d,67108864)}}var pM=!0;function ERe(d,g,b,L){var G=Y.T;Y.T=null;var W=he.p;try{he.p=2,gL(d,g,b,L)}finally{he.p=W,Y.T=G}}function CRe(d,g,b,L){var G=Y.T;Y.T=null;var W=he.p;try{he.p=8,gL(d,g,b,L)}finally{he.p=W,Y.T=G}}function gL(d,g,b,L){if(pM){var G=yL(L);if(G===null)iL(d,g,L,dM,b),lH(d,L);else if(TRe(G,d,g,b,L))L.stopPropagation();else if(lH(d,L),g&4&&-1<IRe.indexOf(d)){for(;G!==null;){var W=Yr(G);if(W!==null)switch(W.tag){case 3:if(W=W.stateNode,W.current.memoizedState.isDehydrated){var ye=ht(W.pendingLanes);if(ye!==0){var Pe=W;for(Pe.pendingLanes|=2,Pe.entangledLanes|=2;ye;){var Ke=1<<31-Kt(ye);Pe.entanglements[1]|=Ke,ye&=~Ke}dp(W),(ia&6)===0&&(YS=We()+500,ub(0))}}break;case 13:Pe=_s(W,2),Pe!==null&&ic(Pe,W,2),JS(),mL(W,2)}if(W=yL(L),W===null&&iL(d,g,L,dM,b),W===G)break;G=W}G!==null&&L.stopPropagation()}else iL(d,g,L,null,b)}}function yL(d){return d=lr(d),vL(d)}var dM=null;function vL(d){if(dM=null,d=ni(d),d!==null){var g=a(d);if(g===null)d=null;else{var b=g.tag;if(b===13){if(d=o(g),d!==null)return d;d=null}else if(b===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null)}}return dM=d,null}function sH(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(at()){case Lt:return 2;case dt:return 8;case Me:case ve:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var _L=!1,Yf=null,Kf=null,Jf=null,yb=new Map,vb=new Map,Qf=[],IRe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lH(d,g){switch(d){case"focusin":case"focusout":Yf=null;break;case"dragenter":case"dragleave":Kf=null;break;case"mouseover":case"mouseout":Jf=null;break;case"pointerover":case"pointerout":yb.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":vb.delete(g.pointerId)}}function _b(d,g,b,L,G,W){return d===null||d.nativeEvent!==W?(d={blockedOn:g,domEventName:b,eventSystemFlags:L,nativeEvent:W,targetContainers:[G]},g!==null&&(g=Yr(g),g!==null&&oH(g)),d):(d.eventSystemFlags|=L,g=d.targetContainers,G!==null&&g.indexOf(G)===-1&&g.push(G),d)}function TRe(d,g,b,L,G){switch(g){case"focusin":return Yf=_b(Yf,d,g,b,L,G),!0;case"dragenter":return Kf=_b(Kf,d,g,b,L,G),!0;case"mouseover":return Jf=_b(Jf,d,g,b,L,G),!0;case"pointerover":var W=G.pointerId;return yb.set(W,_b(yb.get(W)||null,d,g,b,L,G)),!0;case"gotpointercapture":return W=G.pointerId,vb.set(W,_b(vb.get(W)||null,d,g,b,L,G)),!0}return!1}function uH(d){var g=ni(d.target);if(g!==null){var b=a(g);if(b!==null){if(g=b.tag,g===13){if(g=o(b),g!==null){d.blockedOn=g,kt(d.priority,function(){if(b.tag===13){var L=rc();L=De(L);var G=_s(b,L);G!==null&&ic(G,b,L),mL(b,L)}});return}}else if(g===3&&b.stateNode.current.memoizedState.isDehydrated){d.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}d.blockedOn=null}function fM(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var b=yL(d.nativeEvent);if(b===null){b=d.nativeEvent;var L=new b.constructor(b.type,b);xr=L,b.target.dispatchEvent(L),xr=null}else return g=Yr(b),g!==null&&oH(g),d.blockedOn=b,!1;g.shift()}return!0}function cH(d,g,b){fM(d)&&b.delete(g)}function PRe(){_L=!1,Yf!==null&&fM(Yf)&&(Yf=null),Kf!==null&&fM(Kf)&&(Kf=null),Jf!==null&&fM(Jf)&&(Jf=null),yb.forEach(cH),vb.forEach(cH)}function mM(d,g){d.blockedOn===g&&(d.blockedOn=null,_L||(_L=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,PRe)))}var gM=null;function hH(d){gM!==d&&(gM=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){gM===d&&(gM=null);for(var g=0;g<d.length;g+=3){var b=d[g],L=d[g+1],G=d[g+2];if(typeof L!="function"){if(vL(L||b)===null)continue;break}var W=Yr(b);W!==null&&(d.splice(g,3),g-=3,v5(W,{pending:!0,data:G,method:b.method,action:L},L,G))}}))}function xb(d){function g(Ke){return mM(Ke,d)}Yf!==null&&mM(Yf,d),Kf!==null&&mM(Kf,d),Jf!==null&&mM(Jf,d),yb.forEach(g),vb.forEach(g);for(var b=0;b<Qf.length;b++){var L=Qf[b];L.blockedOn===d&&(L.blockedOn=null)}for(;0<Qf.length&&(b=Qf[0],b.blockedOn===null);)uH(b),b.blockedOn===null&&Qf.shift();if(b=(d.ownerDocument||d).$$reactFormReplay,b!=null)for(L=0;L<b.length;L+=3){var G=b[L],W=b[L+1],ye=G[ke]||null;if(typeof W=="function")ye||hH(b);else if(ye){var Pe=null;if(W&&W.hasAttribute("formAction")){if(G=W,ye=W[ke]||null)Pe=ye.formAction;else if(vL(G)!==null)continue}else Pe=ye.action;typeof Pe=="function"?b[L+1]=Pe:(b.splice(L,3),L-=3),hH(b)}}}function xL(d){this._internalRoot=d}yM.prototype.render=xL.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(i(409));var b=g.current,L=rc();nH(b,L,d,g,null,null)},yM.prototype.unmount=xL.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;nH(d.current,2,null,d,null,null),JS(),g[$e]=null}};function yM(d){this._internalRoot=d}yM.prototype.unstable_scheduleHydration=function(d){if(d){var g=st();d={blockedOn:null,target:d,priority:g};for(var b=0;b<Qf.length&&g!==0&&g<Qf[b].priority;b++);Qf.splice(b,0,d),b===0&&uH(d)}};var pH=e.version;if(pH!=="19.1.0")throw Error(i(527,pH,"19.1.0"));he.findDOMNode=function(d){var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(i(188)):(d=Object.keys(d).join(","),Error(i(268,d)));return d=u(g),d=d!==null?c(d):null,d=d===null?null:d.stateNode,d};var LRe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vM=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vM.isDisabled&&vM.supportsFiber)try{Et=vM.inject(LRe),pt=vM}catch{}}return wb.createRoot=function(d,g){if(!n(d))throw Error(i(299));var b=!1,L="",G=I$,W=T$,ye=P$,Pe=null;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(L=g.identifierPrefix),g.onUncaughtError!==void 0&&(G=g.onUncaughtError),g.onCaughtError!==void 0&&(W=g.onCaughtError),g.onRecoverableError!==void 0&&(ye=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Pe=g.unstable_transitionCallbacks)),g=rH(d,1,!1,null,null,b,L,G,W,ye,Pe,null),d[$e]=g.current,rL(d),new xL(g)},wb.hydrateRoot=function(d,g,b){if(!n(d))throw Error(i(299));var L=!1,G="",W=I$,ye=T$,Pe=P$,Ke=null,Ct=null;return b!=null&&(b.unstable_strictMode===!0&&(L=!0),b.identifierPrefix!==void 0&&(G=b.identifierPrefix),b.onUncaughtError!==void 0&&(W=b.onUncaughtError),b.onCaughtError!==void 0&&(ye=b.onCaughtError),b.onRecoverableError!==void 0&&(Pe=b.onRecoverableError),b.unstable_transitionCallbacks!==void 0&&(Ke=b.unstable_transitionCallbacks),b.formState!==void 0&&(Ct=b.formState)),g=rH(d,1,!0,g,b??null,L,G,W,ye,Pe,Ke,Ct),g.context=iH(null),b=g.current,L=rc(),L=De(L),G=Nf(L),G.callback=null,Ff(b,G,L),b=L,g.current.lanes=b,oe(g,b),dp(g),d[$e]=g.current,rL(d),new yM(g)},wb.version="19.1.0",wb}var wH;function VRe(){if(wH)return AL.exports;wH=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),AL.exports=URe(),AL.exports}var jRe=VRe();const $Re="modulepreload",GRe=function(t){return"/Mappedin-demo/"+t},AH={},ag=function(e,r,i){let n=Promise.resolve();if(r&&r.length>0){let o=function(c){return Promise.all(c.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=o(r.map(c=>{if(c=GRe(c),c in AH)return;AH[c]=!0;const p=c.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":$Re,p||(y.as="script"),y.crossOrigin="",y.href=c,u&&y.setAttribute("nonce",u),document.head.appendChild(y),p)return new Promise((v,x)=>{y.addEventListener("load",v),y.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};var HRe=Object.create,SH=Object.freeze,tx=Object.defineProperty,qRe=Object.defineProperties,WRe=Object.getOwnPropertyDescriptor,XRe=Object.getOwnPropertyDescriptors,ZRe=Object.getOwnPropertyNames,_T=Object.getOwnPropertySymbols,YRe=Object.getPrototypeOf,_9=Object.prototype.hasOwnProperty,XX=Object.prototype.propertyIsEnumerable,SE=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),x9=t=>{throw TypeError(t)},YD=(t,e,r)=>e in t?tx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ee=(t,e)=>{for(var r in e||(e={}))_9.call(e,r)&&YD(t,r,e[r]);if(_T)for(var r of _T(e))XX.call(e,r)&&YD(t,r,e[r]);return t},vt=(t,e)=>qRe(t,XRe(e)),s=(t,e)=>tx(t,"name",{value:e,configurable:!0}),ZX=t=>typeof t=="symbol"?t:t+"",Nh=(t,e)=>{var r={};for(var i in t)_9.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&_T)for(var i of _T(t))e.indexOf(i)<0&&XX.call(t,i)&&(r[i]=t[i]);return r},KRe=(t,e)=>()=>(t&&(e=t(t=0)),e),bt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),kl=(t,e)=>{for(var r in e)tx(t,r,{get:e[r],enumerable:!0})},JRe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ZRe(e))!_9.call(t,n)&&n!==r&&tx(t,n,{get:()=>e[n],enumerable:!(i=WRe(e,n))||i.enumerable});return t},Rr=(t,e,r)=>(r=t!=null?HRe(YRe(t)):{},JRe(e||!t||!t.__esModule?tx(r,"default",{value:t,enumerable:!0}):r,t)),$=(t,e,r)=>YD(t,typeof e!="symbol"?e+"":e,r),b9=(t,e,r)=>e.has(t)||x9("Cannot "+r),w=(t,e,r)=>(b9(t,e,"read from private field"),r?r.call(t):e.get(t)),Be=(t,e,r)=>e.has(t)?x9("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),He=(t,e,r,i)=>(b9(t,e,"write to private field"),e.set(t,r),r),dr=(t,e,r)=>(b9(t,e,"access private method"),r),je=(t,e)=>SH(tx(t,"raw",{value:SH(e||t.slice())})),YX=function(t,e){this[0]=t,this[1]=e},QRe=(t,e,r)=>{var i=(o,l,u,c)=>{try{var p=r[o](l),m=(l=p.value)instanceof YX,y=p.done;Promise.resolve(m?l[0]:l).then(v=>m?i(o==="return"?o:"next",l[1]?{done:v.done,value:v.value}:v,u,c):u({value:v,done:y})).catch(v=>i("throw",v,u,c))}catch(v){c(v)}},n=o=>a[o]=l=>new Promise((u,c)=>i(o,l,u,c)),a={};return r=r.apply(t,e),a[SE("asyncIterator")]=()=>a,n("next"),n("throw"),n("return"),a},vr=t=>{var e=t[SE("asyncIterator")],r=!1,i,n={};return e==null?(e=t[SE("iterator")](),i=a=>n[a]=o=>e[a](o)):(e=e.call(t),i=a=>n[a]=o=>{if(r){if(r=!1,a==="throw")throw o;return o}return r=!0,{done:!1,value:new YX(new Promise(l=>{var u=e[a](o);u instanceof Object||x9("Object expected"),l(u)}),1)}}),n[SE("iterator")]=()=>n,i("next"),"throw"in e?i("throw"):n.throw=a=>{throw a},"return"in e&&i("return"),n},ja,N=KRe(()=>{ja={env:{NODE_ENV:"production",npm_package_version:"6.0.1-beta.48"}}}),kn=bt((t,e)=>{N(),e.exports=r;function r(i,n){this.x=i,this.y=n}s(r,"Point"),r.prototype={clone:s(function(){return new r(this.x,this.y)},"clone"),add:s(function(i){return this.clone()._add(i)},"add"),sub:s(function(i){return this.clone()._sub(i)},"sub"),multByPoint:s(function(i){return this.clone()._multByPoint(i)},"multByPoint"),divByPoint:s(function(i){return this.clone()._divByPoint(i)},"divByPoint"),mult:s(function(i){return this.clone()._mult(i)},"mult"),div:s(function(i){return this.clone()._div(i)},"div"),rotate:s(function(i){return this.clone()._rotate(i)},"rotate"),rotateAround:s(function(i,n){return this.clone()._rotateAround(i,n)},"rotateAround"),matMult:s(function(i){return this.clone()._matMult(i)},"matMult"),unit:s(function(){return this.clone()._unit()},"unit"),perp:s(function(){return this.clone()._perp()},"perp"),round:s(function(){return this.clone()._round()},"round"),mag:s(function(){return Math.sqrt(this.x*this.x+this.y*this.y)},"mag"),equals:s(function(i){return this.x===i.x&&this.y===i.y},"equals"),dist:s(function(i){return Math.sqrt(this.distSqr(i))},"dist"),distSqr:s(function(i){var n=i.x-this.x,a=i.y-this.y;return n*n+a*a},"distSqr"),angle:s(function(){return Math.atan2(this.y,this.x)},"angle"),angleTo:s(function(i){return Math.atan2(this.y-i.y,this.x-i.x)},"angleTo"),angleWith:s(function(i){return this.angleWithSep(i.x,i.y)},"angleWith"),angleWithSep:s(function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},"angleWithSep"),_matMult:s(function(i){var n=i[0]*this.x+i[1]*this.y,a=i[2]*this.x+i[3]*this.y;return this.x=n,this.y=a,this},"_matMult"),_add:s(function(i){return this.x+=i.x,this.y+=i.y,this},"_add"),_sub:s(function(i){return this.x-=i.x,this.y-=i.y,this},"_sub"),_mult:s(function(i){return this.x*=i,this.y*=i,this},"_mult"),_div:s(function(i){return this.x/=i,this.y/=i,this},"_div"),_multByPoint:s(function(i){return this.x*=i.x,this.y*=i.y,this},"_multByPoint"),_divByPoint:s(function(i){return this.x/=i.x,this.y/=i.y,this},"_divByPoint"),_unit:s(function(){return this._div(this.mag()),this},"_unit"),_perp:s(function(){var i=this.y;return this.y=this.x,this.x=-i,this},"_perp"),_rotate:s(function(i){var n=Math.cos(i),a=Math.sin(i),o=n*this.x-a*this.y,l=a*this.x+n*this.y;return this.x=o,this.y=l,this},"_rotate"),_rotateAround:s(function(i,n){var a=Math.cos(i),o=Math.sin(i),l=n.x+a*(this.x-n.x)-o*(this.y-n.y),u=n.y+o*(this.x-n.x)+a*(this.y-n.y);return this.x=l,this.y=u,this},"_rotateAround"),_round:s(function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},"_round")},r.convert=function(i){return i instanceof r?i:Array.isArray(i)?new r(i[0],i[1]):i}}),eOe=bt((t,e)=>{N(),e.exports=r;function r(i,n,a,o){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(o-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=a,this.p2y=o}s(r,"UnitBezier"),r.prototype={sampleCurveX:s(function(i){return((this.ax*i+this.bx)*i+this.cx)*i},"sampleCurveX"),sampleCurveY:s(function(i){return((this.ay*i+this.by)*i+this.cy)*i},"sampleCurveY"),sampleCurveDerivativeX:s(function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},"sampleCurveDerivativeX"),solveCurveX:s(function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,o=0;o<8;o++){var l=this.sampleCurveX(a)-i;if(Math.abs(l)<n)return a;var u=this.sampleCurveDerivativeX(a);if(Math.abs(u)<1e-6)break;a=a-l/u}var c=0,p=1;for(a=i,o=0;o<20&&(l=this.sampleCurveX(a),!(Math.abs(l-i)<n));o++)i>l?c=a:p=a,a=(p-c)*.5+c;return a},"solveCurveX"),solve:s(function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))},"solve")}}),tOe=bt((t,e)=>{N();function r(i,n){var a,o,l,u,c,p,m,y;for(a=i.length&3,o=i.length-a,l=n,c=3432918353,p=461845907,y=0;y<o;)m=i.charCodeAt(y)&255|(i.charCodeAt(++y)&255)<<8|(i.charCodeAt(++y)&255)<<16|(i.charCodeAt(++y)&255)<<24,++y,m=(m&65535)*c+(((m>>>16)*c&65535)<<16)&4294967295,m=m<<15|m>>>17,m=(m&65535)*p+(((m>>>16)*p&65535)<<16)&4294967295,l^=m,l=l<<13|l>>>19,u=(l&65535)*5+(((l>>>16)*5&65535)<<16)&4294967295,l=(u&65535)+27492+(((u>>>16)+58964&65535)<<16);switch(m=0,a){case 3:m^=(i.charCodeAt(y+2)&255)<<16;case 2:m^=(i.charCodeAt(y+1)&255)<<8;case 1:m^=i.charCodeAt(y)&255,m=(m&65535)*c+(((m>>>16)*c&65535)<<16)&4294967295,m=m<<15|m>>>17,m=(m&65535)*p+(((m>>>16)*p&65535)<<16)&4294967295,l^=m}return l^=i.length,l^=l>>>16,l=(l&65535)*2246822507+(((l>>>16)*2246822507&65535)<<16)&4294967295,l^=l>>>13,l=(l&65535)*3266489909+(((l>>>16)*3266489909&65535)<<16)&4294967295,l^=l>>>16,l>>>0}s(r,"murmurhash3_32_gc"),typeof e<"u"&&(e.exports=r)}),rOe=bt((t,e)=>{N();function r(i,n){for(var a=i.length,o=n^a,l=0,u;a>=4;)u=i.charCodeAt(l)&255|(i.charCodeAt(++l)&255)<<8|(i.charCodeAt(++l)&255)<<16|(i.charCodeAt(++l)&255)<<24,u=(u&65535)*1540483477+(((u>>>16)*1540483477&65535)<<16),u^=u>>>24,u=(u&65535)*1540483477+(((u>>>16)*1540483477&65535)<<16),o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)^u,a-=4,++l;switch(a){case 3:o^=(i.charCodeAt(l+2)&255)<<16;case 2:o^=(i.charCodeAt(l+1)&255)<<8;case 1:o^=i.charCodeAt(l)&255,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)}return o^=o>>>13,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>15,o>>>0}s(r,"murmurhash2_32_gc"),typeof e!==void 0&&(e.exports=r)}),KX=bt((t,e)=>{N();var r=tOe(),i=rOe();e.exports=r,e.exports.murmur3=r,e.exports.murmur2=i}),w9=bt((t,e)=>{N(),e.exports=r,e.exports.default=r;function r(J,ne,ee){ee=ee||2;var ue=ne&&ne.length,K=ue?ne[0]*ee:J.length,ce=i(J,0,K,ee,!0),re=[];if(!ce||ce.next===ce.prev)return re;var se,de,we,Le,fe,Re,me;if(ue&&(ce=p(J,ne,ce,ee)),J.length>80*ee){se=we=J[0],de=Le=J[1];for(var Ae=ee;Ae<K;Ae+=ee)fe=J[Ae],Re=J[Ae+1],fe<se&&(se=fe),Re<de&&(de=Re),fe>we&&(we=fe),Re>Le&&(Le=Re);me=Math.max(we-se,Le-de),me=me!==0?32767/me:0}return a(ce,re,ee,se,de,me,0),re}s(r,"earcut");function i(J,ne,ee,ue,K){var ce,re;if(K===he(J,ne,ee,ue)>0)for(ce=ne;ce<ee;ce+=ue)re=V(ce,J[ce],J[ce+1],re);else for(ce=ee-ue;ce>=ne;ce-=ue)re=V(ce,J[ce],J[ce+1],re);return re&&F(re,re.next)&&(ae(re),re=re.next),re}s(i,"linkedList");function n(J,ne){if(!J)return J;ne||(ne=J);var ee=J,ue;do if(ue=!1,!ee.steiner&&(F(ee,ee.next)||D(ee.prev,ee,ee.next)===0)){if(ae(ee),ee=ne=ee.prev,ee===ee.next)break;ue=!0}else ee=ee.next;while(ue||ee!==ne);return ne}s(n,"filterPoints");function a(J,ne,ee,ue,K,ce,re){if(J){!re&&ce&&E(J,ue,K,ce);for(var se=J,de,we;J.prev!==J.next;){if(de=J.prev,we=J.next,ce?l(J,ue,K,ce):o(J)){ne.push(de.i/ee|0),ne.push(J.i/ee|0),ne.push(we.i/ee|0),ae(J),J=we.next,se=we.next;continue}if(J=we,J===se){re?re===1?(J=u(n(J),ne,ee),a(J,ne,ee,ue,K,ce,2)):re===2&&c(J,ne,ee,ue,K,ce):a(n(J),ne,ee,ue,K,ce,1);break}}}}s(a,"earcutLinked");function o(J){var ne=J.prev,ee=J,ue=J.next;if(D(ne,ee,ue)>=0)return!1;for(var K=ne.x,ce=ee.x,re=ue.x,se=ne.y,de=ee.y,we=ue.y,Le=K<ce?K<re?K:re:ce<re?ce:re,fe=se<de?se<we?se:we:de<we?de:we,Re=K>ce?K>re?K:re:ce>re?ce:re,me=se>de?se>we?se:we:de>we?de:we,Ae=ue.next;Ae!==ne;){if(Ae.x>=Le&&Ae.x<=Re&&Ae.y>=fe&&Ae.y<=me&&C(K,se,ce,de,re,we,Ae.x,Ae.y)&&D(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.next}return!0}s(o,"isEar");function l(J,ne,ee,ue){var K=J.prev,ce=J,re=J.next;if(D(K,ce,re)>=0)return!1;for(var se=K.x,de=ce.x,we=re.x,Le=K.y,fe=ce.y,Re=re.y,me=se<de?se<we?se:we:de<we?de:we,Ae=Le<fe?Le<Re?Le:Re:fe<Re?fe:Re,Ue=se>de?se>we?se:we:de>we?de:we,_e=Le>fe?Le>Re?Le:Re:fe>Re?fe:Re,lt=I(me,Ae,ne,ee,ue),tt=I(Ue,_e,ne,ee,ue),We=J.prevZ,at=J.nextZ;We&&We.z>=lt&&at&&at.z<=tt;){if(We.x>=me&&We.x<=Ue&&We.y>=Ae&&We.y<=_e&&We!==K&&We!==re&&C(se,Le,de,fe,we,Re,We.x,We.y)&&D(We.prev,We,We.next)>=0||(We=We.prevZ,at.x>=me&&at.x<=Ue&&at.y>=Ae&&at.y<=_e&&at!==K&&at!==re&&C(se,Le,de,fe,we,Re,at.x,at.y)&&D(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;We&&We.z>=lt;){if(We.x>=me&&We.x<=Ue&&We.y>=Ae&&We.y<=_e&&We!==K&&We!==re&&C(se,Le,de,fe,we,Re,We.x,We.y)&&D(We.prev,We,We.next)>=0)return!1;We=We.prevZ}for(;at&&at.z<=tt;){if(at.x>=me&&at.x<=Ue&&at.y>=Ae&&at.y<=_e&&at!==K&&at!==re&&C(se,Le,de,fe,we,Re,at.x,at.y)&&D(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}s(l,"isEarHashed");function u(J,ne,ee){var ue=J;do{var K=ue.prev,ce=ue.next.next;!F(K,ce)&&k(K,ue,ue.next,ce)&&q(K,ce)&&q(ce,K)&&(ne.push(K.i/ee|0),ne.push(ue.i/ee|0),ne.push(ce.i/ee|0),ae(ue),ae(ue.next),ue=J=ce),ue=ue.next}while(ue!==J);return n(ue)}s(u,"cureLocalIntersections");function c(J,ne,ee,ue,K,ce){var re=J;do{for(var se=re.next.next;se!==re.prev;){if(re.i!==se.i&&T(re,se)){var de=Q(re,se);re=n(re,re.next),de=n(de,de.next),a(re,ne,ee,ue,K,ce,0),a(de,ne,ee,ue,K,ce,0);return}se=se.next}re=re.next}while(re!==J)}s(c,"splitEarcut");function p(J,ne,ee,ue){var K=[],ce,re,se,de,we;for(ce=0,re=ne.length;ce<re;ce++)se=ne[ce]*ue,de=ce<re-1?ne[ce+1]*ue:J.length,we=i(J,se,de,ue,!1),we===we.next&&(we.steiner=!0),K.push(P(we));for(K.sort(m),ce=0;ce<K.length;ce++)ee=y(K[ce],ee);return ee}s(p,"eliminateHoles");function m(J,ne){return J.x-ne.x}s(m,"compareX");function y(J,ne){var ee=v(J,ne);if(!ee)return ne;var ue=Q(ee,J);return n(ue,ue.next),n(ee,ee.next)}s(y,"eliminateHole");function v(J,ne){var ee=ne,ue=J.x,K=J.y,ce=-1/0,re;do{if(K<=ee.y&&K>=ee.next.y&&ee.next.y!==ee.y){var se=ee.x+(K-ee.y)*(ee.next.x-ee.x)/(ee.next.y-ee.y);if(se<=ue&&se>ce&&(ce=se,re=ee.x<ee.next.x?ee:ee.next,se===ue))return re}ee=ee.next}while(ee!==ne);if(!re)return null;var de=re,we=re.x,Le=re.y,fe=1/0,Re;ee=re;do ue>=ee.x&&ee.x>=we&&ue!==ee.x&&C(K<Le?ue:ce,K,we,Le,K<Le?ce:ue,K,ee.x,ee.y)&&(Re=Math.abs(K-ee.y)/(ue-ee.x),q(ee,J)&&(Re<fe||Re===fe&&(ee.x>re.x||ee.x===re.x&&x(re,ee)))&&(re=ee,fe=Re)),ee=ee.next;while(ee!==de);return re}s(v,"findHoleBridge");function x(J,ne){return D(J.prev,J,ne.prev)<0&&D(ne.next,J,J.next)<0}s(x,"sectorContainsSector");function E(J,ne,ee,ue){var K=J;do K.z===0&&(K.z=I(K.x,K.y,ne,ee,ue)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==J);K.prevZ.nextZ=null,K.prevZ=null,M(K)}s(E,"indexCurve");function M(J){var ne,ee,ue,K,ce,re,se,de,we=1;do{for(ee=J,J=null,ce=null,re=0;ee;){for(re++,ue=ee,se=0,ne=0;ne<we&&(se++,ue=ue.nextZ,!!ue);ne++);for(de=we;se>0||de>0&&ue;)se!==0&&(de===0||!ue||ee.z<=ue.z)?(K=ee,ee=ee.nextZ,se--):(K=ue,ue=ue.nextZ,de--),ce?ce.nextZ=K:J=K,K.prevZ=ce,ce=K;ee=ue}ce.nextZ=null,we*=2}while(re>1);return J}s(M,"sortLinked");function I(J,ne,ee,ue,K){return J=(J-ee)*K|0,ne=(ne-ue)*K|0,J=(J|J<<8)&16711935,J=(J|J<<4)&252645135,J=(J|J<<2)&858993459,J=(J|J<<1)&1431655765,ne=(ne|ne<<8)&16711935,ne=(ne|ne<<4)&252645135,ne=(ne|ne<<2)&858993459,ne=(ne|ne<<1)&1431655765,J|ne<<1}s(I,"zOrder");function P(J){var ne=J,ee=J;do(ne.x<ee.x||ne.x===ee.x&&ne.y<ee.y)&&(ee=ne),ne=ne.next;while(ne!==J);return ee}s(P,"getLeftmost");function C(J,ne,ee,ue,K,ce,re,se){return(K-re)*(ne-se)>=(J-re)*(ce-se)&&(J-re)*(ue-se)>=(ee-re)*(ne-se)&&(ee-re)*(ce-se)>=(K-re)*(ue-se)}s(C,"pointInTriangle");function T(J,ne){return J.next.i!==ne.i&&J.prev.i!==ne.i&&!z(J,ne)&&(q(J,ne)&&q(ne,J)&&Z(J,ne)&&(D(J.prev,J,ne.prev)||D(J,ne.prev,ne))||F(J,ne)&&D(J.prev,J,J.next)>0&&D(ne.prev,ne,ne.next)>0)}s(T,"isValidDiagonal");function D(J,ne,ee){return(ne.y-J.y)*(ee.x-ne.x)-(ne.x-J.x)*(ee.y-ne.y)}s(D,"area");function F(J,ne){return J.x===ne.x&&J.y===ne.y}s(F,"equals");function k(J,ne,ee,ue){var K=U(D(J,ne,ee)),ce=U(D(J,ne,ue)),re=U(D(ee,ue,J)),se=U(D(ee,ue,ne));return!!(K!==ce&&re!==se||K===0&&B(J,ee,ne)||ce===0&&B(J,ue,ne)||re===0&&B(ee,J,ue)||se===0&&B(ee,ne,ue))}s(k,"intersects");function B(J,ne,ee){return ne.x<=Math.max(J.x,ee.x)&&ne.x>=Math.min(J.x,ee.x)&&ne.y<=Math.max(J.y,ee.y)&&ne.y>=Math.min(J.y,ee.y)}s(B,"onSegment");function U(J){return J>0?1:J<0?-1:0}s(U,"sign");function z(J,ne){var ee=J;do{if(ee.i!==J.i&&ee.next.i!==J.i&&ee.i!==ne.i&&ee.next.i!==ne.i&&k(ee,ee.next,J,ne))return!0;ee=ee.next}while(ee!==J);return!1}s(z,"intersectsPolygon");function q(J,ne){return D(J.prev,J,J.next)<0?D(J,ne,J.next)>=0&&D(J,J.prev,ne)>=0:D(J,ne,J.prev)<0||D(J,J.next,ne)<0}s(q,"locallyInside");function Z(J,ne){var ee=J,ue=!1,K=(J.x+ne.x)/2,ce=(J.y+ne.y)/2;do ee.y>ce!=ee.next.y>ce&&ee.next.y!==ee.y&&K<(ee.next.x-ee.x)*(ce-ee.y)/(ee.next.y-ee.y)+ee.x&&(ue=!ue),ee=ee.next;while(ee!==J);return ue}s(Z,"middleInside");function Q(J,ne){var ee=new Y(J.i,J.x,J.y),ue=new Y(ne.i,ne.x,ne.y),K=J.next,ce=ne.prev;return J.next=ne,ne.prev=J,ee.next=K,K.prev=ee,ue.next=ee,ee.prev=ue,ce.next=ue,ue.prev=ce,ue}s(Q,"splitPolygon");function V(J,ne,ee,ue){var K=new Y(J,ne,ee);return ue?(K.next=ue.next,K.prev=ue,ue.next.prev=K,ue.next=K):(K.prev=K,K.next=K),K}s(V,"insertNode");function ae(J){J.next.prev=J.prev,J.prev.next=J.next,J.prevZ&&(J.prevZ.nextZ=J.nextZ),J.nextZ&&(J.nextZ.prevZ=J.prevZ)}s(ae,"removeNode");function Y(J,ne,ee){this.i=J,this.x=ne,this.y=ee,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}s(Y,"Node"),r.deviation=function(J,ne,ee,ue){var K=ne&&ne.length,ce=K?ne[0]*ee:J.length,re=Math.abs(he(J,0,ce,ee));if(K)for(var se=0,de=ne.length;se<de;se++){var we=ne[se]*ee,Le=se<de-1?ne[se+1]*ee:J.length;re-=Math.abs(he(J,we,Le,ee))}var fe=0;for(se=0;se<ue.length;se+=3){var Re=ue[se]*ee,me=ue[se+1]*ee,Ae=ue[se+2]*ee;fe+=Math.abs((J[Re]-J[Ae])*(J[me+1]-J[Re+1])-(J[Re]-J[me])*(J[Ae+1]-J[Re+1]))}return re===0&&fe===0?0:Math.abs((fe-re)/re)};function he(J,ne,ee,ue){for(var K=0,ce=ne,re=ee-ue;ce<ee;ce+=ue)K+=(J[re]-J[ce])*(J[ce+1]+J[re+1]),re=ce;return K}s(he,"signedArea"),r.flatten=function(J){for(var ne=J[0][0].length,ee={vertices:[],holes:[],dimensions:ne},ue=0,K=0;K<J.length;K++){for(var ce=0;ce<J[K].length;ce++)for(var re=0;re<ne;re++)ee.vertices.push(J[K][ce][re]);K>0&&(ue+=J[K-1].length,ee.holes.push(ue))}return ee}}),JX=bt((t,e)=>{N();var r=kn();e.exports=i;function i(u,c,p,m,y){this.properties={},this.extent=p,this.type=0,this._pbf=u,this._geometry=-1,this._keys=m,this._values=y,u.readFields(n,this,c)}s(i,"VectorTileFeature");function n(u,c,p){u==1?c.id=p.readVarint():u==2?a(p,c):u==3?c.type=p.readVarint():u==4&&(c._geometry=p.pos)}s(n,"readFeature");function a(u,c){for(var p=u.readVarint()+u.pos;u.pos<p;){var m=c._keys[u.readVarint()],y=c._values[u.readVarint()];c.properties[m]=y}}s(a,"readTag"),i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,p=1,m=0,y=0,v=0,x=[],E;u.pos<c;){if(m<=0){var M=u.readVarint();p=M&7,m=M>>3}if(m--,p===1||p===2)y+=u.readSVarint(),v+=u.readSVarint(),p===1&&(E&&x.push(E),E=[]),E.push(new r(y,v));else if(p===7)E&&E.push(E[0].clone());else throw new Error("unknown command "+p)}return E&&x.push(E),x},i.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var c=u.readVarint()+u.pos,p=1,m=0,y=0,v=0,x=1/0,E=-1/0,M=1/0,I=-1/0;u.pos<c;){if(m<=0){var P=u.readVarint();p=P&7,m=P>>3}if(m--,p===1||p===2)y+=u.readSVarint(),v+=u.readSVarint(),y<x&&(x=y),y>E&&(E=y),v<M&&(M=v),v>I&&(I=v);else if(p!==7)throw new Error("unknown command "+p)}return[x,M,E,I]},i.prototype.toGeoJSON=function(u,c,p){var m=this.extent*Math.pow(2,p),y=this.extent*u,v=this.extent*c,x=this.loadGeometry(),E=i.types[this.type],M,I;function P(D){for(var F=0;F<D.length;F++){var k=D[F],B=180-(k.y+v)*360/m;D[F]=[(k.x+y)*360/m-180,360/Math.PI*Math.atan(Math.exp(B*Math.PI/180))-90]}}switch(s(P,"project"),this.type){case 1:var C=[];for(M=0;M<x.length;M++)C[M]=x[M][0];x=C,P(x);break;case 2:for(M=0;M<x.length;M++)P(x[M]);break;case 3:for(x=o(x),M=0;M<x.length;M++)for(I=0;I<x[M].length;I++)P(x[M][I]);break}x.length===1?x=x[0]:E="Multi"+E;var T={type:"Feature",geometry:{type:E,coordinates:x},properties:this.properties};return"id"in this&&(T.id=this.id),T};function o(u){var c=u.length;if(c<=1)return[u];for(var p=[],m,y,v=0;v<c;v++){var x=l(u[v]);x!==0&&(y===void 0&&(y=x<0),y===x<0?(m&&p.push(m),m=[u[v]]):m.push(u[v]))}return m&&p.push(m),p}s(o,"classifyRings");function l(u){for(var c=0,p=0,m=u.length,y=m-1,v,x;p<m;y=p++)v=u[p],x=u[y],c+=(x.x-v.x)*(v.y+x.y);return c}s(l,"signedArea")}),QX=bt((t,e)=>{N();var r=JX();e.exports=i;function i(o,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,l),this.length=this._features.length}s(i,"VectorTileLayer");function n(o,l,u){o===15?l.version=u.readVarint():o===1?l.name=u.readString():o===5?l.extent=u.readVarint():o===2?l._features.push(u.pos):o===3?l._keys.push(u.readString()):o===4&&l._values.push(a(u))}s(n,"readLayer");function a(o){for(var l=null,u=o.readVarint()+o.pos;o.pos<u;){var c=o.readVarint()>>3;l=c===1?o.readString():c===2?o.readFloat():c===3?o.readDouble():c===4?o.readVarint64():c===5?o.readVarint():c===6?o.readSVarint():c===7?o.readBoolean():null}return l}s(a,"readValueMessage"),i.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var l=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,l,this.extent,this._keys,this._values)}}),iOe=bt((t,e)=>{N();var r=QX();e.exports=i;function i(a,o){this.layers=a.readFields(n,{},o)}s(i,"VectorTile");function n(a,o,l){if(a===3){var u=new r(l,l.readVarint()+l.pos);u.length&&(o[u.name]=u)}}s(n,"readTile")}),q3=bt((t,e)=>{N(),e.exports.VectorTile=iOe(),e.exports.VectorTileFeature=JX(),e.exports.VectorTileLayer=QX()}),nOe=bt(t=>{N(),t.read=function(e,r,i,n,a){var o,l,u=a*8-n-1,c=(1<<u)-1,p=c>>1,m=-7,y=i?a-1:0,v=i?-1:1,x=e[r+y];for(y+=v,o=x&(1<<-m)-1,x>>=-m,m+=u;m>0;o=o*256+e[r+y],y+=v,m-=8);for(l=o&(1<<-m)-1,o>>=-m,m+=n;m>0;l=l*256+e[r+y],y+=v,m-=8);if(o===0)o=1-p;else{if(o===c)return l?NaN:(x?-1:1)*(1/0);l=l+Math.pow(2,n),o=o-p}return(x?-1:1)*l*Math.pow(2,o-n)},t.write=function(e,r,i,n,a,o){var l,u,c,p=o*8-a-1,m=(1<<p)-1,y=m>>1,v=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=n?0:o-1,E=n?1:-1,M=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(u=isNaN(r)?1:0,l=m):(l=Math.floor(Math.log(r)/Math.LN2),r*(c=Math.pow(2,-l))<1&&(l--,c*=2),l+y>=1?r+=v/c:r+=v*Math.pow(2,1-y),r*c>=2&&(l++,c/=2),l+y>=m?(u=0,l=m):l+y>=1?(u=(r*c-1)*Math.pow(2,a),l=l+y):(u=r*Math.pow(2,y-1)*Math.pow(2,a),l=0));a>=8;e[i+x]=u&255,x+=E,u/=256,a-=8);for(l=l<<a|u,p+=a;p>0;e[i+x]=l&255,x+=E,l/=256,p-=8);e[i+x-E]|=M*128}}),eZ=bt((t,e)=>{N(),e.exports=i;var r=nOe();function i(V){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(V)?V:new Uint8Array(V||0),this.pos=0,this.type=0,this.length=this.buf.length}s(i,"Pbf"),i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var n=65536*65536,a=1/n,o=12,l=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");i.prototype={destroy:s(function(){this.buf=null},"destroy"),readFields:s(function(V,ae,Y){for(Y=Y||this.length;this.pos<Y;){var he=this.readVarint(),J=he>>3,ne=this.pos;this.type=he&7,V(J,ae,this),this.pos===ne&&this.skip(he)}return ae},"readFields"),readMessage:s(function(V,ae){return this.readFields(V,ae,this.readVarint()+this.pos)},"readMessage"),readFixed32:s(function(){var V=B(this.buf,this.pos);return this.pos+=4,V},"readFixed32"),readSFixed32:s(function(){var V=z(this.buf,this.pos);return this.pos+=4,V},"readSFixed32"),readFixed64:s(function(){var V=B(this.buf,this.pos)+B(this.buf,this.pos+4)*n;return this.pos+=8,V},"readFixed64"),readSFixed64:s(function(){var V=B(this.buf,this.pos)+z(this.buf,this.pos+4)*n;return this.pos+=8,V},"readSFixed64"),readFloat:s(function(){var V=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,V},"readFloat"),readDouble:s(function(){var V=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,V},"readDouble"),readVarint:s(function(V){var ae=this.buf,Y,he;return he=ae[this.pos++],Y=he&127,he<128||(he=ae[this.pos++],Y|=(he&127)<<7,he<128)||(he=ae[this.pos++],Y|=(he&127)<<14,he<128)||(he=ae[this.pos++],Y|=(he&127)<<21,he<128)?Y:(he=ae[this.pos],Y|=(he&15)<<28,u(Y,V,this))},"readVarint"),readVarint64:s(function(){return this.readVarint(!0)},"readVarint64"),readSVarint:s(function(){var V=this.readVarint();return V%2===1?(V+1)/-2:V/2},"readSVarint"),readBoolean:s(function(){return!!this.readVarint()},"readBoolean"),readString:s(function(){var V=this.readVarint()+this.pos,ae=this.pos;return this.pos=V,V-ae>=o&&l?Z(this.buf,ae,V):q(this.buf,ae,V)},"readString"),readBytes:s(function(){var V=this.readVarint()+this.pos,ae=this.buf.subarray(this.pos,V);return this.pos=V,ae},"readBytes"),readPackedVarint:s(function(V,ae){if(this.type!==i.Bytes)return V.push(this.readVarint(ae));var Y=c(this);for(V=V||[];this.pos<Y;)V.push(this.readVarint(ae));return V},"readPackedVarint"),readPackedSVarint:s(function(V){if(this.type!==i.Bytes)return V.push(this.readSVarint());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readSVarint());return V},"readPackedSVarint"),readPackedBoolean:s(function(V){if(this.type!==i.Bytes)return V.push(this.readBoolean());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readBoolean());return V},"readPackedBoolean"),readPackedFloat:s(function(V){if(this.type!==i.Bytes)return V.push(this.readFloat());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readFloat());return V},"readPackedFloat"),readPackedDouble:s(function(V){if(this.type!==i.Bytes)return V.push(this.readDouble());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readDouble());return V},"readPackedDouble"),readPackedFixed32:s(function(V){if(this.type!==i.Bytes)return V.push(this.readFixed32());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readFixed32());return V},"readPackedFixed32"),readPackedSFixed32:s(function(V){if(this.type!==i.Bytes)return V.push(this.readSFixed32());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readSFixed32());return V},"readPackedSFixed32"),readPackedFixed64:s(function(V){if(this.type!==i.Bytes)return V.push(this.readFixed64());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readFixed64());return V},"readPackedFixed64"),readPackedSFixed64:s(function(V){if(this.type!==i.Bytes)return V.push(this.readSFixed64());var ae=c(this);for(V=V||[];this.pos<ae;)V.push(this.readSFixed64());return V},"readPackedSFixed64"),skip:s(function(V){var ae=V&7;if(ae===i.Varint)for(;this.buf[this.pos++]>127;);else if(ae===i.Bytes)this.pos=this.readVarint()+this.pos;else if(ae===i.Fixed32)this.pos+=4;else if(ae===i.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+ae)},"skip"),writeTag:s(function(V,ae){this.writeVarint(V<<3|ae)},"writeTag"),realloc:s(function(V){for(var ae=this.length||16;ae<this.pos+V;)ae*=2;if(ae!==this.length){var Y=new Uint8Array(ae);Y.set(this.buf),this.buf=Y,this.length=ae}},"realloc"),finish:s(function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},"finish"),writeFixed32:s(function(V){this.realloc(4),U(this.buf,V,this.pos),this.pos+=4},"writeFixed32"),writeSFixed32:s(function(V){this.realloc(4),U(this.buf,V,this.pos),this.pos+=4},"writeSFixed32"),writeFixed64:s(function(V){this.realloc(8),U(this.buf,V&-1,this.pos),U(this.buf,Math.floor(V*a),this.pos+4),this.pos+=8},"writeFixed64"),writeSFixed64:s(function(V){this.realloc(8),U(this.buf,V&-1,this.pos),U(this.buf,Math.floor(V*a),this.pos+4),this.pos+=8},"writeSFixed64"),writeVarint:s(function(V){if(V=+V||0,V>268435455||V<0){m(V,this);return}this.realloc(4),this.buf[this.pos++]=V&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=(V>>>=7)&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=(V>>>=7)&127|(V>127?128:0),!(V<=127)&&(this.buf[this.pos++]=V>>>7&127)))},"writeVarint"),writeSVarint:s(function(V){this.writeVarint(V<0?-V*2-1:V*2)},"writeSVarint"),writeBoolean:s(function(V){this.writeVarint(!!V)},"writeBoolean"),writeString:s(function(V){V=String(V),this.realloc(V.length*4),this.pos++;var ae=this.pos;this.pos=Q(this.buf,V,this.pos);var Y=this.pos-ae;Y>=128&&x(ae,Y,this),this.pos=ae-1,this.writeVarint(Y),this.pos+=Y},"writeString"),writeFloat:s(function(V){this.realloc(4),r.write(this.buf,V,this.pos,!0,23,4),this.pos+=4},"writeFloat"),writeDouble:s(function(V){this.realloc(8),r.write(this.buf,V,this.pos,!0,52,8),this.pos+=8},"writeDouble"),writeBytes:s(function(V){var ae=V.length;this.writeVarint(ae),this.realloc(ae);for(var Y=0;Y<ae;Y++)this.buf[this.pos++]=V[Y]},"writeBytes"),writeRawMessage:s(function(V,ae){this.pos++;var Y=this.pos;V(ae,this);var he=this.pos-Y;he>=128&&x(Y,he,this),this.pos=Y-1,this.writeVarint(he),this.pos+=he},"writeRawMessage"),writeMessage:s(function(V,ae,Y){this.writeTag(V,i.Bytes),this.writeRawMessage(ae,Y)},"writeMessage"),writePackedVarint:s(function(V,ae){ae.length&&this.writeMessage(V,E,ae)},"writePackedVarint"),writePackedSVarint:s(function(V,ae){ae.length&&this.writeMessage(V,M,ae)},"writePackedSVarint"),writePackedBoolean:s(function(V,ae){ae.length&&this.writeMessage(V,C,ae)},"writePackedBoolean"),writePackedFloat:s(function(V,ae){ae.length&&this.writeMessage(V,I,ae)},"writePackedFloat"),writePackedDouble:s(function(V,ae){ae.length&&this.writeMessage(V,P,ae)},"writePackedDouble"),writePackedFixed32:s(function(V,ae){ae.length&&this.writeMessage(V,T,ae)},"writePackedFixed32"),writePackedSFixed32:s(function(V,ae){ae.length&&this.writeMessage(V,D,ae)},"writePackedSFixed32"),writePackedFixed64:s(function(V,ae){ae.length&&this.writeMessage(V,F,ae)},"writePackedFixed64"),writePackedSFixed64:s(function(V,ae){ae.length&&this.writeMessage(V,k,ae)},"writePackedSFixed64"),writeBytesField:s(function(V,ae){this.writeTag(V,i.Bytes),this.writeBytes(ae)},"writeBytesField"),writeFixed32Field:s(function(V,ae){this.writeTag(V,i.Fixed32),this.writeFixed32(ae)},"writeFixed32Field"),writeSFixed32Field:s(function(V,ae){this.writeTag(V,i.Fixed32),this.writeSFixed32(ae)},"writeSFixed32Field"),writeFixed64Field:s(function(V,ae){this.writeTag(V,i.Fixed64),this.writeFixed64(ae)},"writeFixed64Field"),writeSFixed64Field:s(function(V,ae){this.writeTag(V,i.Fixed64),this.writeSFixed64(ae)},"writeSFixed64Field"),writeVarintField:s(function(V,ae){this.writeTag(V,i.Varint),this.writeVarint(ae)},"writeVarintField"),writeSVarintField:s(function(V,ae){this.writeTag(V,i.Varint),this.writeSVarint(ae)},"writeSVarintField"),writeStringField:s(function(V,ae){this.writeTag(V,i.Bytes),this.writeString(ae)},"writeStringField"),writeFloatField:s(function(V,ae){this.writeTag(V,i.Fixed32),this.writeFloat(ae)},"writeFloatField"),writeDoubleField:s(function(V,ae){this.writeTag(V,i.Fixed64),this.writeDouble(ae)},"writeDoubleField"),writeBooleanField:s(function(V,ae){this.writeVarintField(V,!!ae)},"writeBooleanField")};function u(V,ae,Y){var he=Y.buf,J,ne;if(ne=he[Y.pos++],J=(ne&112)>>4,ne<128||(ne=he[Y.pos++],J|=(ne&127)<<3,ne<128)||(ne=he[Y.pos++],J|=(ne&127)<<10,ne<128)||(ne=he[Y.pos++],J|=(ne&127)<<17,ne<128)||(ne=he[Y.pos++],J|=(ne&127)<<24,ne<128)||(ne=he[Y.pos++],J|=(ne&1)<<31,ne<128))return p(V,J,ae);throw new Error("Expected varint not more than 10 bytes")}s(u,"readVarintRemainder");function c(V){return V.type===i.Bytes?V.readVarint()+V.pos:V.pos+1}s(c,"readPackedEnd");function p(V,ae,Y){return Y?ae*4294967296+(V>>>0):(ae>>>0)*4294967296+(V>>>0)}s(p,"toNum");function m(V,ae){var Y,he;if(V>=0?(Y=V%4294967296|0,he=V/4294967296|0):(Y=~(-V%4294967296),he=~(-V/4294967296),Y^4294967295?Y=Y+1|0:(Y=0,he=he+1|0)),V>=18446744073709552e3||V<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ae.realloc(10),y(Y,he,ae),v(he,ae)}s(m,"writeBigVarint");function y(V,ae,Y){Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos++]=V&127|128,V>>>=7,Y.buf[Y.pos]=V&127}s(y,"writeBigVarintLow");function v(V,ae){var Y=(V&7)<<4;ae.buf[ae.pos++]|=Y|((V>>>=3)?128:0),V&&(ae.buf[ae.pos++]=V&127|((V>>>=7)?128:0),V&&(ae.buf[ae.pos++]=V&127|((V>>>=7)?128:0),V&&(ae.buf[ae.pos++]=V&127|((V>>>=7)?128:0),V&&(ae.buf[ae.pos++]=V&127|((V>>>=7)?128:0),V&&(ae.buf[ae.pos++]=V&127)))))}s(v,"writeBigVarintHigh");function x(V,ae,Y){var he=ae<=16383?1:ae<=2097151?2:ae<=268435455?3:Math.floor(Math.log(ae)/(Math.LN2*7));Y.realloc(he);for(var J=Y.pos-1;J>=V;J--)Y.buf[J+he]=Y.buf[J]}s(x,"makeRoomForExtraLength");function E(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeVarint(V[Y])}s(E,"writePackedVarint");function M(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeSVarint(V[Y])}s(M,"writePackedSVarint");function I(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeFloat(V[Y])}s(I,"writePackedFloat");function P(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeDouble(V[Y])}s(P,"writePackedDouble");function C(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeBoolean(V[Y])}s(C,"writePackedBoolean");function T(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeFixed32(V[Y])}s(T,"writePackedFixed32");function D(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeSFixed32(V[Y])}s(D,"writePackedSFixed32");function F(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeFixed64(V[Y])}s(F,"writePackedFixed64");function k(V,ae){for(var Y=0;Y<V.length;Y++)ae.writeSFixed64(V[Y])}s(k,"writePackedSFixed64");function B(V,ae){return(V[ae]|V[ae+1]<<8|V[ae+2]<<16)+V[ae+3]*16777216}s(B,"readUInt32");function U(V,ae,Y){V[Y]=ae,V[Y+1]=ae>>>8,V[Y+2]=ae>>>16,V[Y+3]=ae>>>24}s(U,"writeInt32");function z(V,ae){return(V[ae]|V[ae+1]<<8|V[ae+2]<<16)+(V[ae+3]<<24)}s(z,"readInt32");function q(V,ae,Y){for(var he="",J=ae;J<Y;){var ne=V[J],ee=null,ue=ne>239?4:ne>223?3:ne>191?2:1;if(J+ue>Y)break;var K,ce,re;ue===1?ne<128&&(ee=ne):ue===2?(K=V[J+1],(K&192)===128&&(ee=(ne&31)<<6|K&63,ee<=127&&(ee=null))):ue===3?(K=V[J+1],ce=V[J+2],(K&192)===128&&(ce&192)===128&&(ee=(ne&15)<<12|(K&63)<<6|ce&63,(ee<=2047||ee>=55296&&ee<=57343)&&(ee=null))):ue===4&&(K=V[J+1],ce=V[J+2],re=V[J+3],(K&192)===128&&(ce&192)===128&&(re&192)===128&&(ee=(ne&15)<<18|(K&63)<<12|(ce&63)<<6|re&63,(ee<=65535||ee>=1114112)&&(ee=null))),ee===null?(ee=65533,ue=1):ee>65535&&(ee-=65536,he+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|ee&1023),he+=String.fromCharCode(ee),J+=ue}return he}s(q,"readUtf8");function Z(V,ae,Y){return l.decode(V.subarray(ae,Y))}s(Z,"readUtf8TextDecoder");function Q(V,ae,Y){for(var he=0,J,ne;he<ae.length;he++){if(J=ae.charCodeAt(he),J>55295&&J<57344)if(ne)if(J<56320){V[Y++]=239,V[Y++]=191,V[Y++]=189,ne=J;continue}else J=ne-55296<<10|J-56320|65536,ne=null;else{J>56319||he+1===ae.length?(V[Y++]=239,V[Y++]=191,V[Y++]=189):ne=J;continue}else ne&&(V[Y++]=239,V[Y++]=191,V[Y++]=189,ne=null);J<128?V[Y++]=J:(J<2048?V[Y++]=J>>6|192:(J<65536?V[Y++]=J>>12|224:(V[Y++]=J>>18|240,V[Y++]=J>>12&63|128),V[Y++]=J>>6&63|128),V[Y++]=J&63|128)}return Y}s(Q,"writeUtf8")}),A9=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())}(t,function(){var r=s(function(n,a){if(n===void 0&&(n=[]),a===void 0&&(a=i),this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)},"TinyQueue");r.prototype.push=s(function(n){this.data.push(n),this.length++,this._up(this.length-1)},"push"),r.prototype.pop=s(function(){if(this.length!==0){var n=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),n}},"pop"),r.prototype.peek=s(function(){return this.data[0]},"peek"),r.prototype._up=s(function(n){for(var a=this,o=a.data,l=a.compare,u=o[n];n>0;){var c=n-1>>1,p=o[c];if(l(u,p)>=0)break;o[n]=p,n=c}o[n]=u},"_up"),r.prototype._down=s(function(n){for(var a=this,o=a.data,l=a.compare,u=this.length>>1,c=o[n];n<u;){var p=(n<<1)+1,m=o[p],y=p+1;if(y<this.length&&l(o[y],m)<0&&(p=y,m=o[y]),l(m,c)>=0)break;o[n]=m,n=p}o[n]=c},"_down");function i(n,a){return n<a?-1:n>a?1:0}return s(i,"defaultCompare"),r})});N();var tZ={version:"6.0.1-beta.48"};N();N();var aOe=Rr(kn(),1),oOe=Rr(eOe(),1);N();N();var CL;function S9(){return CL==null&&(CL=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),CL}s(S9,"offscreenCanvasSupported");var _M;function rZ(){if(_M==null&&(_M=!1,S9())){let t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let r=0;r<5*5;r++){let i=r*4;t.fillStyle="rgb(".concat(i,",").concat(i+1,",").concat(i+2,")"),t.fillRect(r%5,Math.floor(r/5),1,1)}let e=t.getImageData(0,0,5,5).data;for(let r=0;r<5*5*4;r++)if(r%4!==3&&e[r]!==r){_M=!0;break}}}return _M||!1}s(rZ,"isOffscreenCanvasDistorted");function iZ(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}s(iZ,"easeCubicInOut");function W3(t,e,r,i){let n=new oOe.default(t,e,r,i);return function(a){return n.solve(a)}}s(W3,"bezier");var KD=W3(.25,.1,.25,1);function hs(t,e,r){return Math.min(r,Math.max(e,t))}s(hs,"clamp");function Ay(t,e,r){let i=r-e,n=((t-e)%i+i)%i+e;return n===e?r:n}s(Ay,"wrap");function nZ(t,e){let r=[];for(let i in t)i in e||r.push(i);return r}s(nZ,"keysDifference");function Fr(t,...e){for(let r of e)for(let i in r)t[i]=r[i];return t}s(Fr,"extend");function dA(t,e){let r={};for(let i=0;i<e.length;i++){let n=e[i];n in t&&(r[n]=t[n])}return r}s(dA,"pick");var sOe=1;function M9(){return sOe++}s(M9,"uniqueId");function aZ(t){return Math.log(t)/Math.LN2%1===0}s(aZ,"isPowerOfTwo");function oZ(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}s(oZ,"nextPowerOfTwo");function X3(t,e,r){let i={};for(let n in t)i[n]=e.call(r||this,t[n],n,t);return i}s(X3,"mapObject");function E9(t,e,r){let i={};for(let n in t)e.call(r||this,t[n],n,t)&&(i[n]=t[n]);return i}s(E9,"filterObject");function zm(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!zm(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!zm(t[r],e[r]))return!1;return!0}return t===e}s(zm,"deepEqual");function mc(t){return Array.isArray(t)?t.map(mc):typeof t=="object"&&t?X3(t,mc):t}s(mc,"clone");function sZ(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}s(sZ,"arraysIntersect");var MH={};function Ol(t){MH[t]||(typeof console<"u"&&console.warn(t),MH[t]=!0)}s(Ol,"warnOnce");function of(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}s(of,"isCounterClockwise");function lZ(t,e,r,i){let n=e.y-t.y,a=e.x-t.x,o=i.y-r.y,l=i.x-r.x,u=o*a-l*n;if(u===0)return null;let c=t.y-r.y,p=t.x-r.x,m=(l*c-o*p)/u;return new aOe.default(t.x+m*a,t.y+m*n)}s(lZ,"findLineIntersection");function uZ(t){let e=0;for(let r=0,i=t.length,n=i-1,a,o;r<i;n=r++)a=t[r],o=t[n],e+=(o.x-a.x)*(a.y+o.y);return e}s(uZ,"calculateSignedArea");function cZ([t,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(r),y:t*Math.sin(e)*Math.sin(r),z:t*Math.cos(r)}}s(cZ,"sphericalToCartesian");function Vy(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}s(Vy,"isWorker");function hZ(t){let e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,r={};if(t.replace(e,(i,n,a,o)=>{let l=a||o;return r[n]=l?l.toLowerCase():!0,""}),r["max-age"]){let i=parseInt(r["max-age"],10);isNaN(i)?delete r["max-age"]:r["max-age"]=i}return r}s(hZ,"parseCacheControl");var IL=null;function pZ(t){if(IL==null){let e=t.navigator?t.navigator.userAgent:null;IL=!!t.safari||!!(e&&(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return IL}s(pZ,"isSafari");function Gp(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}s(Gp,"isImageBitmap");var lOe=s(async t=>{if(t.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(t)],{type:"image/png"});try{return createImageBitmap(e)}catch(r){throw new Error("Could not load image because of ".concat(r.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}},"arrayBufferToImageBitmap"),EH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",uOe=s(t=>new Promise((e,r)=>{let i=new Image;i.onload=()=>{e(i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame(()=>{i.src=EH})},i.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let n=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(n):EH}),"arrayBufferToImage");function dZ(t,e,r,i,n){let a=Math.max(-e,0)*4,o=(Math.max(0,r)-r)*i*4+a,l=i*4,u=Math.max(0,e),c=Math.max(0,r),p=Math.min(t.width,e+i),m=Math.min(t.height,r+n);return{rect:{x:u,y:c,width:p-u,height:m-c},layout:[{offset:o,stride:l}]}}s(dZ,"computeVideoFrameParameters");async function fZ(t,e,r,i,n){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let a=new VideoFrame(t,{timestamp:0});try{let o=a==null?void 0:a.format;if(!o||!(o.startsWith("BGR")||o.startsWith("RGB")))throw new Error("Unrecognized format ".concat(o));let l=o.startsWith("BGR"),u=new Uint8ClampedArray(i*n*4);if(await a.copyTo(u,dZ(t,e,r,i,n)),l)for(let c=0;c<u.length;c+=4){let p=u[c];u[c]=u[c+2],u[c+2]=p}return u}finally{a.close()}}s(fZ,"readImageUsingVideoFrame");function mZ(t,e,r,i){return t.addEventListener(e,r,i),{unsubscribe:s(()=>{t.removeEventListener(e,r,i)},"unsubscribe")}}s(mZ,"subscribe");function JD(t){return t*Math.PI/180}s(JD,"degreesToRadians");N();N();var cOe="AbortError";function fA(){return new Error(cOe)}s(fA,"createAbortError");var hOe=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),xM,TL,yn={now:hOe,frameAsync(t){return new Promise((e,r)=>{let i=requestAnimationFrame(e);t.signal.addEventListener("abort",()=>{cancelAnimationFrame(i),r(fA())})})},getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){let e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0,t.width,t.height),r},resolveURL(t){return xM||(xM=document.createElement("a")),xM.href=t,xM.href},hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return matchMedia?(TL==null&&(TL=matchMedia("(prefers-reduced-motion: reduce)")),TL.matches):!1}};N();var pOe=Rr(kn(),1),jg=class co{static testProp(e){if(!co.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in co.docStyle)return e[r];return e[0]}static create(e,r,i){let n=window.document.createElement(e);return r!==void 0&&(n.className=r),i&&i.appendChild(n),n}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){co.docStyle&&co.selectProp&&(co.userSelect=co.docStyle[co.selectProp],co.docStyle[co.selectProp]="none")}static enableDrag(){co.docStyle&&co.selectProp&&(co.docStyle[co.selectProp]=co.userSelect)}static setTransform(e,r){e.style[co.transformProp]=r}static addEventListener(e,r,i,n={}){"passive"in n?e.addEventListener(r,i,n):e.addEventListener(r,i,n.capture)}static removeEventListener(e,r,i,n={}){"passive"in n?e.removeEventListener(r,i,n):e.removeEventListener(r,i,n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",co.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",co.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",co.suppressClickInternal,!0)},0)}static getScale(e){let r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,i){let n=r.boundingClientRect;return new pOe.default((i.clientX-n.left)/r.x-e.clientLeft,(i.clientY-n.top)/r.y-e.clientTop)}static mousePos(e,r){let i=co.getScale(e);return co.getPoint(e,i,r)}static touchPos(e,r){let i=[],n=co.getScale(e);for(let a=0;a<r.length;a++)i.push(co.getPoint(e,n,r[a]));return i}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}};s(jg,"DOM"),jg.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,jg.selectProp=jg.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),jg.transformProp=jg.testProp(["transform","WebkitTransform"]);var or=jg;N();N();N();var wc={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function C9(t){return wc.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}s(C9,"getProtocol");function dOe(t,e){wc.REGISTERED_PROTOCOLS[t]=e}s(dOe,"addProtocol");function fOe(t){delete wc.REGISTERED_PROTOCOLS[t]}s(fOe,"removeProtocol");N();var QD="global-dispatcher",gZ=class extends Error{constructor(e,r,i,n){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(i)),this.status=e,this.statusText=r,this.url=i,this.body=n}};s(gZ,"AJAXError");var I9=gZ,T9=s(()=>Vy(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,"getReferrer"),mOe=s(t=>/^file:/.test(t)||/^file:/.test(T9())&&!/^\w+:/.test(t),"isFileURL");async function yZ(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:T9(),signal:e.signal});t.type==="json"&&r.headers.set("Accept","application/json");let i=await fetch(r);if(!i.ok){let o=await i.blob();throw new I9(i.status,i.statusText,t.url,o)}let n;t.type==="arrayBuffer"||t.type==="image"?n=i.arrayBuffer():t.type==="json"?n=i.json():n=i.text();let a=await n;if(e.signal.aborted)throw fA();return{data:a,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}}s(yZ,"makeFetchRequest");function vZ(t,e){return new Promise((r,i)=>{let n=new XMLHttpRequest;n.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(n.responseType="arraybuffer");for(let a in t.headers)n.setRequestHeader(a,t.headers[a]);t.type==="json"&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials=t.credentials==="include",n.onerror=()=>{i(new Error(n.statusText))},n.onload=()=>{if(!e.signal.aborted)if((n.status>=200&&n.status<300||n.status===0)&&n.response!==null){let a=n.response;if(t.type==="json")try{a=JSON.parse(n.response)}catch(o){i(o);return}r({data:a,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")})}else{let a=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});i(new I9(n.status,n.statusText,t.url,a))}},e.signal.addEventListener("abort",()=>{n.abort(),i(fA())}),n.send(t.body)})}s(vZ,"makeXMLHttpRequest");var Z3=s(function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=C9(t.url);if(r)return r(t,e);if(Vy(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:QD},e)}if(!mOe(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return yZ(t,e);if(Vy(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:QD},e)}return vZ(t,e)},"makeRequest"),Y3=s((t,e)=>Z3(Fr(t,{type:"json"}),e),"getJSON"),gOe=s((t,e)=>Z3(Fr(t,{type:"arrayBuffer"}),e),"getArrayBuffer");function P9(t){if(!t||t.indexOf("://")<=0||t.indexOf("data:image/")===0||t.indexOf("blob:")===0)return!0;let e=new URL(t),r=window.location;return e.protocol===r.protocol&&e.host===r.host}s(P9,"sameOrigin");var yOe=s(t=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(r=>{e.onloadstart=()=>{r(e)};for(let i of t){let n=window.document.createElement("source");P9(i)||(e.crossOrigin="Anonymous"),n.src=i,e.appendChild(n)}})},"getVideo");N();N();var L9={supported:!1,testSupport:xZ},qb,D9=!1,L1,_Z=!1;typeof document<"u"&&(L1=document.createElement("img"),L1.onload=function(){qb&&R9(qb),qb=null,_Z=!0},L1.onerror=function(){D9=!0,qb=null},L1.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function xZ(t){D9||!L1||(_Z?R9(t):qb=t)}s(xZ,"testSupport");function R9(t){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,L1),t.isContextLost())return;L9.supported=!0}catch{}t.deleteTexture(e),D9=!0}s(R9,"testWebpTextureUpload");var Hp;(t=>{let e,r,i,n;t.resetRequestQueue=s(()=>{e=[],r=0,i=0,n={}},"resetRequestQueue"),t.addThrottleControl=s(p=>{let m=i++;return n[m]=p,m},"addThrottleControl"),t.removeThrottleControl=s(p=>{delete n[p],u()},"removeThrottleControl");let a=s(()=>{for(let p of Object.keys(n))if(n[p]())return!0;return!1},"isThrottled");t.getImage=s((p,m,y=!0)=>new Promise((v,x)=>{L9.supported&&(p.headers||(p.headers={}),p.headers.accept="image/webp,*/*"),Fr(p,{type:"image"});let E={abortController:m,requestParameters:p,supportImageRefresh:y,state:"queued",onError:s(M=>{x(M)},"onError"),onSuccess:s(M=>{v(M)},"onSuccess")};e.push(E),u()}),"getImage");let o=s(p=>typeof createImageBitmap=="function"?lOe(p):uOe(p),"arrayBufferToCanvasImageSource"),l=s(async p=>{p.state="running";let{requestParameters:m,supportImageRefresh:y,onError:v,onSuccess:x,abortController:E}=p,M=y===!1&&!Vy(self)&&!C9(m.url)&&(!m.headers||Object.keys(m.headers).reduce((P,C)=>P&&C==="accept",!0));r++;let I=M?c(m,E):Z3(m,E);try{let P=await I;if(delete p.abortController,p.state="completed",P.data instanceof HTMLImageElement||Gp(P.data))x(P);else if(P.data){let C=await o(P.data);x({data:C,cacheControl:P.cacheControl,expires:P.expires})}}catch(P){delete p.abortController,v(P)}finally{r--,u()}},"doImageRequest"),u=s(()=>{let p=a()?wc.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:wc.MAX_PARALLEL_IMAGE_REQUESTS;for(let m=r;m<p&&e.length>0;m++){let y=e.shift();if(y.abortController.signal.aborted){m--;continue}l(y)}},"processQueue"),c=s((p,m)=>new Promise((y,v)=>{let x=new Image,E=p.url,M=p.credentials;M&&M==="include"?x.crossOrigin="use-credentials":(M&&M==="same-origin"||!P9(E))&&(x.crossOrigin="anonymous"),m.signal.addEventListener("abort",()=>{x.src="",v(fA())}),x.fetchPriority="high",x.onload=()=>{x.onerror=x.onload=null,y({data:x})},x.onerror=()=>{x.onerror=x.onload=null,!m.signal.aborted&&v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},x.src=E}),"getImageUsingHtmlImage")})(Hp||(Hp={}));Hp.resetRequestQueue();N();var bZ=class{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn?this._transformRequestFn(e,r)||{url:e}:{url:e}}normalizeSpriteURL(e,r,i){let n=wZ(e);return n.path+="".concat(r).concat(i),AZ(n)}setTransformRequest(e){this._transformRequestFn=e}};s(bZ,"RequestManager");var vOe=bZ,_Oe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wZ(t){let e=t.match(_Oe);if(!e)throw new Error('Unable to parse URL "'.concat(t,'"'));return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}s(wZ,"parseUrl");function AZ(t){let e=t.params.length?"?".concat(t.params.join("&")):"";return"".concat(t.protocol,"://").concat(t.authority).concat(t.path).concat(e)}s(AZ,"formatUrl");N();N();function e6(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}s(e6,"_addEventListener");function ME(t,e,r){if(r&&r[t]){let i=r[t].indexOf(e);i!==-1&&r[t].splice(i,1)}}s(ME,"_removeEventListener");var SZ=class{constructor(e,r={}){Fr(this,r),this.type=e}};s(SZ,"Event");var pr=SZ,MZ=class extends pr{constructor(e,r={}){super("error",Fr({error:e},r))}};s(MZ,"ErrorEvent");var di=MZ,EZ=class{on(e,r){return this._listeners=this._listeners||{},e6(e,r,this._listeners),this}off(e,r){return ME(e,r,this._listeners),ME(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},e6(e,r,this._oneTimeListeners),this):new Promise(i=>this.once(e,i))}fire(e,r){typeof e=="string"&&(e=new pr(e,r||{}));let i=e.type;if(this.listens(i)){e.target=this;let n=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(let l of n)l.call(this,e);let a=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(let l of a)ME(i,l,this._oneTimeListeners),l.call(this,e);let o=this._eventedParent;o&&(Fr(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof di&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};s(EZ,"Evented");var Nl=EZ;N();N();N();N();var xOe=8,bOe={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},wOe={"*":{type:"source"}},AOe=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],SOe={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},MOe={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},EOe={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},COe={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},IOe={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},TOe={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},POe={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},LOe=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],DOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ROe={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},OOe={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},kOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},NOe={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},FOe={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},BOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},zOe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},UOe={type:"array",value:"*"},VOe={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},jOe={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},$Oe={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},GOe={type:"array",value:"*",minimum:1},HOe={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},qOe={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},WOe={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},XOe={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},ZOe=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],YOe={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},KOe={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},JOe={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},QOe={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},eke={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},tke={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},rke={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ike={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},nke={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},ake={"*":{type:"string"}},Ut={$version:xOe,$root:bOe,sources:wOe,source:AOe,source_vector:SOe,source_raster:MOe,source_raster_dem:EOe,source_geojson:COe,source_video:IOe,source_image:TOe,layer:POe,layout:LOe,layout_background:DOe,layout_fill:ROe,layout_circle:OOe,layout_heatmap:kOe,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:NOe,layout_symbol:FOe,layout_raster:BOe,layout_hillshade:zOe,filter:UOe,filter_operator:VOe,geometry_type:jOe,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:$Oe,expression:GOe,light:HOe,sky:qOe,terrain:WOe,projection:XOe,paint:ZOe,paint_fill:YOe,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:KOe,paint_circle:JOe,paint_heatmap:QOe,paint_symbol:eke,paint_raster:tke,paint_hillshade:rke,paint_background:ike,transition:nke,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:ake},oke=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function CZ(t,e){let r={};for(let i in t)i!=="ref"&&(r[i]=t[i]);return oke.forEach(i=>{i in e&&(r[i]=e[i])}),r}s(CZ,"deref");function t6(t){t=t.slice();let e=Object.create(null);for(let r=0;r<t.length;r++)e[t[r].id]=t[r];for(let r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=CZ(t[r],e[t[r].ref]));return t}s(t6,"derefLayers");function Kn(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Kn(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!Kn(t[r],e[r]))return!1;return!0}return t===e}s(Kn,"deepEqual");function uc(t,e){t.push(e)}s(uc,"addCommand");function O9(t,e,r){uc(r,{command:"addSource",args:[t,e[t]]})}s(O9,"addSource");function k9(t,e,r){uc(e,{command:"removeSource",args:[t]}),r[t]=!0}s(k9,"removeSource");function IZ(t,e,r,i){k9(t,r,i),O9(t,e,r)}s(IZ,"updateSource");function TZ(t,e,r){let i;for(i in t[r])if(Object.prototype.hasOwnProperty.call(t[r],i)&&i!=="data"&&!Kn(t[r][i],e[r][i]))return!1;for(i in e[r])if(Object.prototype.hasOwnProperty.call(e[r],i)&&i!=="data"&&!Kn(t[r][i],e[r][i]))return!1;return!0}s(TZ,"canUpdateGeoJSON");function PZ(t,e,r,i){t=t||{},e=e||{};let n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)||k9(n,r,i));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(t,n)?Kn(t[n],e[n])||(t[n].type==="geojson"&&e[n].type==="geojson"&&TZ(t,e,n)?uc(r,{command:"setGeoJSONSourceData",args:[n,e[n].data]}):IZ(n,e,r,i)):O9(n,e,r))}s(PZ,"diffSources");function Wb(t,e,r,i,n,a){t=t||{},e=e||{};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Kn(t[o],e[o])||r.push({command:a,args:[i,o,e[o],n]}));for(let o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(t,o)||Kn(t[o],e[o])||r.push({command:a,args:[i,o,e[o],n]})}s(Wb,"diffLayerPropertyChanges");function r6(t){return t.id}s(r6,"pluckId");function i6(t,e){return t[e.id]=e,t}s(i6,"indexById");function LZ(t,e,r){t=t||[],e=e||[];let i=t.map(r6),n=e.map(r6),a=t.reduce(i6,{}),o=e.reduce(i6,{}),l=i.slice(),u=Object.create(null),c,p,m,y,v;for(let x=0,E=0;x<i.length;x++)c=i[x],Object.prototype.hasOwnProperty.call(o,c)?E++:(uc(r,{command:"removeLayer",args:[c]}),l.splice(l.indexOf(c,E),1));for(let x=0,E=0;x<n.length;x++)c=n[n.length-1-x],l[l.length-1-x]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(uc(r,{command:"removeLayer",args:[c]}),l.splice(l.lastIndexOf(c,l.length-E),1)):E++,y=l[l.length-x],uc(r,{command:"addLayer",args:[o[c],y]}),l.splice(l.length-x,0,c),u[c]=!0);for(let x=0;x<n.length;x++)if(c=n[x],p=a[c],m=o[c],!(u[c]||Kn(p,m))){if(!Kn(p.source,m.source)||!Kn(p["source-layer"],m["source-layer"])||!Kn(p.type,m.type)){uc(r,{command:"removeLayer",args:[c]}),y=l[l.lastIndexOf(c)+1],uc(r,{command:"addLayer",args:[m,y]});continue}Wb(p.layout,m.layout,r,c,null,"setLayoutProperty"),Wb(p.paint,m.paint,r,c,null,"setPaintProperty"),Kn(p.filter,m.filter)||uc(r,{command:"setFilter",args:[c,m.filter]}),(!Kn(p.minzoom,m.minzoom)||!Kn(p.maxzoom,m.maxzoom))&&uc(r,{command:"setLayerZoomRange",args:[c,m.minzoom,m.maxzoom]});for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&(v==="layout"||v==="paint"||v==="filter"||v==="metadata"||v==="minzoom"||v==="maxzoom"||(v.indexOf("paint.")===0?Wb(p[v],m[v],r,c,v.slice(6),"setPaintProperty"):Kn(p[v],m[v])||uc(r,{command:"setLayerProperty",args:[c,v,m[v]]})));for(v in m)!Object.prototype.hasOwnProperty.call(m,v)||Object.prototype.hasOwnProperty.call(p,v)||v==="layout"||v==="paint"||v==="filter"||v==="metadata"||v==="minzoom"||v==="maxzoom"||(v.indexOf("paint.")===0?Wb(p[v],m[v],r,c,v.slice(6),"setPaintProperty"):Kn(p[v],m[v])||uc(r,{command:"setLayerProperty",args:[c,v,m[v]]}))}}s(LZ,"diffLayers");function DZ(t,e){if(!t)return[{command:"setStyle",args:[e]}];let r=[];try{if(!Kn(t.version,e.version))return[{command:"setStyle",args:[e]}];Kn(t.center,e.center)||r.push({command:"setCenter",args:[e.center]}),Kn(t.zoom,e.zoom)||r.push({command:"setZoom",args:[e.zoom]}),Kn(t.bearing,e.bearing)||r.push({command:"setBearing",args:[e.bearing]}),Kn(t.pitch,e.pitch)||r.push({command:"setPitch",args:[e.pitch]}),Kn(t.roll,e.roll)||r.push({command:"setRoll",args:[e.roll]}),Kn(t.sprite,e.sprite)||r.push({command:"setSprite",args:[e.sprite]}),Kn(t.glyphs,e.glyphs)||r.push({command:"setGlyphs",args:[e.glyphs]}),Kn(t.transition,e.transition)||r.push({command:"setTransition",args:[e.transition]}),Kn(t.light,e.light)||r.push({command:"setLight",args:[e.light]}),Kn(t.terrain,e.terrain)||r.push({command:"setTerrain",args:[e.terrain]}),Kn(t.sky,e.sky)||r.push({command:"setSky",args:[e.sky]}),Kn(t.projection,e.projection)||r.push({command:"setProjection",args:[e.projection]});let i={},n=[];PZ(t.sources,e.sources,n,i);let a=[];t.layers&&t.layers.forEach(o=>{"source"in o&&i[o.source]?r.push({command:"removeLayer",args:[o.id]}):a.push(o)}),r=r.concat(n),LZ(a,e.layers,r)}catch(i){console.warn("Unable to compute style diff:",i),r=[{command:"setStyle",args:[e]}]}return r}s(DZ,"diffStyles");var RZ=class{constructor(e,r,i,n){this.message=(e?"".concat(e,": "):"")+i,n&&(this.identifier=n),r!=null&&r.__line__&&(this.line=r.__line__)}};s(RZ,"ValidationError");var _r=RZ;function jy(t,...e){for(let r of e)for(let i in r)t[i]=r[i];return t}s(jy,"extendBy");var OZ=class extends Error{constructor(e,r){super(r),this.message=r,this.key=e}};s(OZ,"ExpressionParsingError");var Fp=OZ,kZ=class NZ{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[i,n]of r)this.bindings[i]=n}concat(e){return new NZ(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}};s(kZ,"Scope");var ske=kZ,mA={kind:"null"},wr={kind:"number"},tn={kind:"string"},ji={kind:"boolean"},zh={kind:"color"},q1={kind:"object"},$i={kind:"value"},lke={kind:"error"},K3={kind:"collator"},gA={kind:"formatted"},J3={kind:"padding"},yA={kind:"resolvedImage"},Q3={kind:"variableAnchorOffsetCollection"};function Tu(t,e){return{kind:"array",itemType:t,N:e}}s(Tu,"array$1");function $a(t){if(t.kind==="array"){let e=$a(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}s($a,"toString$1");var uke=[mA,wr,tn,ji,zh,gA,q1,Tu($i),J3,yA,Q3];function f_(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!f_(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of uke)if(!f_(r,e))return null}}return"Expected ".concat($a(t)," but found ").concat($a(e)," instead.")}s(f_,"checkSubtype");function eP(t,e){return e.some(r=>r.kind===t.kind)}s(eP,"isValidType");function jm(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}s(jm,"isValidNativeType");function x0(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}s(x0,"verifyType");var FZ=.96422,BZ=1,zZ=.82521,UZ=4/29,W1=6/29,VZ=3*W1*W1,cke=W1*W1*W1,hke=Math.PI/180,pke=180/Math.PI;function N9(t){return t=t%360,t<0&&(t+=360),t}s(N9,"constrainAngle");function F9([t,e,r,i]){t=EE(t),e=EE(e),r=EE(r);let n,a,o=CE((.2225045*t+.7168786*e+.0606169*r)/BZ);t===e&&e===r?n=a=o:(n=CE((.4360747*t+.3850649*e+.1430804*r)/FZ),a=CE((.0139322*t+.0971045*e+.7141733*r)/zZ));let l=116*o-16;return[l<0?0:l,500*(n-o),200*(o-a),i]}s(F9,"rgbToLab");function EE(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}s(EE,"rgb2xyz");function CE(t){return t>cke?Math.pow(t,1/3):t/VZ+UZ}s(CE,"xyz2lab");function B9([t,e,r,i]){let n=(t+16)/116,a=isNaN(e)?n:n+e/500,o=isNaN(r)?n:n-r/200;return n=BZ*TE(n),a=FZ*TE(a),o=zZ*TE(o),[IE(3.1338561*a-1.6168667*n-.4906146*o),IE(-.9787684*a+1.9161415*n+.033454*o),IE(.0719453*a-.2289914*n+1.4052427*o),i]}s(B9,"labToRgb");function IE(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}s(IE,"xyz2rgb");function TE(t){return t>W1?t*t*t:VZ*(t-UZ)}s(TE,"lab2xyz");function jZ(t){let[e,r,i,n]=F9(t),a=Math.sqrt(r*r+i*i);return[Math.round(a*1e4)?N9(Math.atan2(i,r)*pke):NaN,a,e,n]}s(jZ,"rgbToHcl");function $Z([t,e,r,i]){return t=isNaN(t)?0:t*hke,B9([r,Math.cos(t)*e,Math.sin(t)*e,i])}s($Z,"hclToRgb");function GZ([t,e,r,i]){t=N9(t),e/=100,r/=100;function n(a){let o=(a+t/30)%12,l=e*Math.min(r,1-r);return r-l*Math.max(-1,Math.min(o-3,9-o,1))}return s(n,"f"),[n(0),n(8),n(4),i]}s(GZ,"hslToRgb");function HZ(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=dke[t];if(e){let[n,a,o]=e;return[n/255,a/255,o/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let n=t.length<6?1:2,a=1;return[Xb(t.slice(a,a+=n)),Xb(t.slice(a,a+=n)),Xb(t.slice(a,a+=n)),Xb(t.slice(a,a+n)||"ff")]}if(t.startsWith("rgb")){let n=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=t.match(n);if(a){let[o,l,u,c,p,m,y,v,x,E,M,I]=a,P=[c||" ",y||" ",E].join("");if(P==="  "||P==="  /"||P===",,"||P===",,,"){let C=[u,m,x].join(""),T=C==="%%%"?100:C===""?255:0;if(T){let D=[hy(+l/T,0,1),hy(+p/T,0,1),hy(+v/T,0,1),M?n6(+M,I):1];if(a6(D))return D}}return}}let r=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,i=t.match(r);if(i){let[n,a,o,l,u,c,p,m,y]=i,v=[o||" ",u||" ",p].join("");if(v==="  "||v==="  /"||v===",,"||v===",,,"){let x=[+a,hy(+l,0,100),hy(+c,0,100),m?n6(+m,y):1];if(a6(x))return GZ(x)}}}s(HZ,"parseCssColor");function Xb(t){return parseInt(t.padEnd(2,t),16)/255}s(Xb,"parseHex");function n6(t,e){return hy(e?t/100:t,0,1)}s(n6,"parseAlpha");function hy(t,e,r){return Math.min(Math.max(e,t),r)}s(hy,"clamp");function a6(t){return!t.some(Number.isNaN)}s(a6,"validateNumbers");var dke={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},qZ=class o6{constructor(e,r,i,n=1,a=!0){this.r=e,this.g=r,this.b=i,this.a=n,a||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,r,i,n]))}static parse(e){if(e instanceof o6)return e;if(typeof e!="string")return;let r=HZ(e);if(r)return new o6(...r,!1)}get rgb(){let{r:e,g:r,b:i,a:n}=this,a=n||1/0;return this.overwriteGetter("rgb",[e/a,r/a,i/a,n])}get hcl(){return this.overwriteGetter("hcl",jZ(this.rgb))}get lab(){return this.overwriteGetter("lab",F9(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,i,n]=this.rgb;return"rgba(".concat([e,r,i].map(a=>Math.round(a*255)).join(","),",").concat(n,")")}};s(qZ,"Color");var Pi=qZ;Pi.black=new Pi(0,0,0,1);Pi.white=new Pi(1,1,1,1);Pi.transparent=new Pi(0,0,0,0);Pi.red=new Pi(1,0,0,1);var WZ=class{constructor(e,r,i){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}};s(WZ,"Collator");var z9=WZ,XZ=class{constructor(e,r,i,n,a){this.text=e,this.image=r,this.scale=i,this.fontStack=n,this.textColor=a}};s(XZ,"FormattedSection");var s6=XZ,ZZ=class PE{constructor(e){this.sections=e}static fromString(e){return new PE([new s6(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof PE?e:PE.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}};s(ZZ,"Formatted");var df=ZZ,YZ=class LE{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof LE)return e;if(typeof e=="number")return new LE([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new LE(e)}}toString(){return JSON.stringify(this.values)}};s(YZ,"Padding");var Af=YZ,fke=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),KZ=class l6{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof l6)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let i=e[r],n=e[r+1];if(typeof i!="string"||!fke.has(i)||!Array.isArray(n)||n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")return}return new l6(e)}}toString(){return JSON.stringify(this.values)}};s(KZ,"VariableAnchorOffsetCollection");var ov=KZ,JZ=class QZ{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new QZ({name:e,available:!1}):null}};s(JZ,"ResolvedImage");var Kp=JZ;function U9(t,e,r,i){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let n=typeof i=="number"?[t,e,r,i]:[t,e,r];return"Invalid rgba value [".concat(n.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof i>"u"||typeof i=="number"&&i>=0&&i<=1?null:"Invalid rgba value [".concat([t,e,r,i].join(", "),"]: 'a' must be between 0 and 1.")}s(U9,"validateRGBA");function m_(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Pi||t instanceof z9||t instanceof df||t instanceof Af||t instanceof ov||t instanceof Kp)return!0;if(Array.isArray(t)){for(let e of t)if(!m_(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!m_(t[e]))return!1;return!0}else return!1}s(m_,"isValue");function Wo(t){if(t===null)return mA;if(typeof t=="string")return tn;if(typeof t=="boolean")return ji;if(typeof t=="number")return wr;if(t instanceof Pi)return zh;if(t instanceof z9)return K3;if(t instanceof df)return gA;if(t instanceof Af)return J3;if(t instanceof ov)return Q3;if(t instanceof Kp)return yA;if(Array.isArray(t)){let e=t.length,r;for(let i of t){let n=Wo(i);if(!r)r=n;else{if(r===n)continue;r=$i;break}}return Tu(r||$i,e)}else return q1}s(Wo,"typeOf");function X1(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Pi||t instanceof df||t instanceof Af||t instanceof ov||t instanceof Kp?t.toString():JSON.stringify(t)}s(X1,"toString");var eY=class tY{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!m_(e[1]))return r.error("invalid value");let i=e[1],n=Wo(i),a=r.expectedType;return n.kind==="array"&&n.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(n=a),new tY(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}};s(eY,"Literal");var mw=eY,rY=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};s(rY,"RuntimeError");var Xo=rY,bM={string:tn,number:wr,boolean:ji,object:q1},iY=class nY{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=1,n,a=e[0];if(a==="array"){let l;if(e.length>2){let c=e[1];if(typeof c!="string"||!(c in bM)||c==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);l=bM[c],i++}else l=$i;let u;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);u=e[2],i++}n=Tu(l,u)}else{if(!bM[a])throw new Error("Types doesn't contain name = ".concat(a));n=bM[a]}let o=[];for(;i<e.length;i++){let l=r.parse(e[i],i,$i);if(!l)return null;o.push(l)}return new nY(n,o)}evaluate(e){for(let r=0;r<this.args.length;r++){let i=this.args[r].evaluate(e);if(f_(this.type,Wo(i))){if(r===this.args.length-1)throw new Xo("Expected value to be of type ".concat($a(this.type),", but found ").concat($a(Wo(i))," instead."))}else return i}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};s(iY,"Assertion");var rf=iY,CH={"to-boolean":ji,"to-color":zh,"to-number":wr,"to-string":tn},aY=class oY{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=e[0];if(!CH[i])throw new Error("Can't parse ".concat(i," as it is not part of the known types"));if((i==="to-boolean"||i==="to-string")&&e.length!==2)return r.error("Expected one argument.");let n=CH[i],a=[];for(let o=1;o<e.length;o++){let l=r.parse(e[o],o,$i);if(!l)return null;a.push(l)}return new oY(n,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,i;for(let n of this.args){if(r=n.evaluate(e),i=null,r instanceof Pi)return r;if(typeof r=="string"){let a=e.parseColor(r);if(a)return a}else if(Array.isArray(r)&&(r.length<3||r.length>4?i="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):i=U9(r[0],r[1],r[2],r[3]),!i))return new Pi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Xo(i||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let i of this.args){r=i.evaluate(e);let n=Af.parse(r);if(n)return n}throw new Xo("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let i of this.args){r=i.evaluate(e);let n=ov.parse(r);if(n)return n}throw new Xo("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let i of this.args){if(r=i.evaluate(e),r===null)return 0;let n=Number(r);if(!isNaN(n))return n}throw new Xo("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return df.fromString(X1(this.args[0].evaluate(e)));case"resolvedImage":return Kp.fromString(X1(this.args[0].evaluate(e)));default:return X1(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};s(aY,"Coercion");var D1=aY,mke=["Unknown","Point","LineString","Polygon"],sY=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?mke[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=Pi.parse(e)),r}};s(sY,"EvaluationContext");var lY=sY,uY=class cY{constructor(e,r,i=[],n,a=new ske,o=[]){this.registry=e,this.path=i,this.key=i.map(l=>"[".concat(l,"]")).join(""),this.scope=a,this.errors=o,this.expectedType=n,this._isConstant=r}parse(e,r,i,n,a={}){return r?this.concat(r,i,n)._parse(e,a):this._parse(e,a)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function i(n,a,o){return o==="assert"?new rf(a,[n]):o==="coerce"?new D1(a,[n]):n}if(s(i,"annotate"),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let n=e[0];if(typeof n!="string")return this.error("Expression name must be a string, but found ".concat(typeof n,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let a=this.registry[n];if(a){let o=a.parse(e,this);if(!o)return null;if(this.expectedType){let l=this.expectedType,u=o.type;if((l.kind==="string"||l.kind==="number"||l.kind==="boolean"||l.kind==="object"||l.kind==="array")&&u.kind==="value")o=i(o,l,r.typeAnnotation||"assert");else if((l.kind==="color"||l.kind==="formatted"||l.kind==="resolvedImage")&&(u.kind==="value"||u.kind==="string"))o=i(o,l,r.typeAnnotation||"coerce");else if(l.kind==="padding"&&(u.kind==="value"||u.kind==="number"||u.kind==="array"))o=i(o,l,r.typeAnnotation||"coerce");else if(l.kind==="variableAnchorOffsetCollection"&&(u.kind==="value"||u.kind==="array"))o=i(o,l,r.typeAnnotation||"coerce");else if(this.checkSubtype(l,u))return null}if(!(o instanceof mw)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){let l=new lY;try{o=new mw(o.type,o.evaluate(l))}catch(u){return this.error(u.message),null}}return o}return this.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,i){let n=typeof e=="number"?this.path.concat(e):this.path,a=i?this.scope.concat(i):this.scope;return new cY(this.registry,this._isConstant,n,r||null,a,this.errors)}error(e,...r){let i="".concat(this.key).concat(r.map(n=>"[".concat(n,"]")).join(""));this.errors.push(new Fp(i,e))}checkSubtype(e,r){let i=f_(e,r);return i&&this.error(i),i}};s(uY,"ParsingContext");var hY=uY,pY=class dY{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let i=[];for(let a=1;a<e.length-1;a+=2){let o=e[a];if(typeof o!="string")return r.error("Expected string, but found ".concat(typeof o," instead."),a);if(/[^a-zA-Z0-9_]/.test(o))return r.error("Variable names must contain only alphanumeric characters or '_'.",a);let l=r.parse(e[a+1],a+1);if(!l)return null;i.push([o,l])}let n=r.parse(e[e.length-1],e.length-1,r.expectedType,i);return n?new dY(i,n):null}outputDefined(){return this.result.outputDefined()}};s(pY,"Let");var fY=pY,mY=class gY{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let i=e[1];return r.scope.has(i)?new gY(i,r.scope.get(i)):r.error('Unknown variable "'.concat(i,'". Make sure "').concat(i,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}};s(mY,"Var");var yY=mY,vY=class _Y{constructor(e,r,i){this.type=e,this.index=r,this.input=i}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,wr),n=r.parse(e[2],2,Tu(r.expectedType||$i));if(!i||!n)return null;let a=n.type;return new _Y(a.itemType,i,n)}evaluate(e){let r=this.index.evaluate(e),i=this.input.evaluate(e);if(r<0)throw new Xo("Array index out of bounds: ".concat(r," < 0."));if(r>=i.length)throw new Xo("Array index out of bounds: ".concat(r," > ").concat(i.length-1,"."));if(r!==Math.floor(r))throw new Xo("Array index must be an integer, but found ".concat(r," instead."));return i[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};s(vY,"At");var gke=vY,xY=class bY{constructor(e,r){this.type=ji,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,$i),n=r.parse(e[2],2,$i);return!i||!n?null:eP(i.type,[ji,tn,wr,mA,$i])?new bY(i,n):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat($a(i.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!jm(r,["boolean","string","number","null"]))throw new Xo("Expected first argument to be of type boolean, string, number or null, but found ".concat($a(Wo(r))," instead."));if(!jm(i,["string","array"]))throw new Xo("Expected second argument to be of type array or string, but found ".concat($a(Wo(i))," instead."));return i.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}};s(xY,"In");var yke=xY,wY=class u6{constructor(e,r,i){this.type=wr,this.needle=e,this.haystack=r,this.fromIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,$i),n=r.parse(e[2],2,$i);if(!i||!n)return null;if(!eP(i.type,[ji,tn,wr,mA,$i]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat($a(i.type)," instead"));if(e.length===4){let a=r.parse(e[3],3,wr);return a?new u6(i,n,a):null}else return new u6(i,n)}evaluate(e){let r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!jm(r,["boolean","string","number","null"]))throw new Xo("Expected first argument to be of type boolean, string, number or null, but found ".concat($a(Wo(r))," instead."));let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),jm(i,["string"])){let a=i.indexOf(r,n);return a===-1?-1:[...i.slice(0,a)].length}else{if(jm(i,["array"]))return i.indexOf(r,n);throw new Xo("Expected second argument to be of type array or string, but found ".concat($a(Wo(i))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}};s(wY,"IndexOf");var vke=wY,AY=class SY{constructor(e,r,i,n,a,o){this.inputType=e,this.type=r,this.input=i,this.cases=n,this.outputs=a,this.otherwise=o}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let i,n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let a={},o=[];for(let c=2;c<e.length-1;c+=2){let p=e[c],m=e[c+1];Array.isArray(p)||(p=[p]);let y=r.concat(c);if(p.length===0)return y.error("Expected at least one branch label.");for(let x of p){if(typeof x!="number"&&typeof x!="string")return y.error("Branch labels must be numbers or strings.");if(typeof x=="number"&&Math.abs(x)>Number.MAX_SAFE_INTEGER)return y.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof x=="number"&&Math.floor(x)!==x)return y.error("Numeric branch labels must be integer values.");if(!i)i=Wo(x);else if(y.checkSubtype(i,Wo(x)))return null;if(typeof a[String(x)]<"u")return y.error("Branch labels must be unique.");a[String(x)]=o.length}let v=r.parse(m,c,n);if(!v)return null;n=n||v.type,o.push(v)}let l=r.parse(e[1],1,$i);if(!l)return null;let u=r.parse(e[e.length-1],e.length-1,n);return!u||l.type.kind!=="value"&&r.concat(1).checkSubtype(i,l.type)?null:new SY(i,n,l,a,o,u)}evaluate(e){let r=this.input.evaluate(e);return(Wo(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}};s(AY,"Match");var _ke=AY,MY=class EY{constructor(e,r,i){this.type=e,this.branches=r,this.otherwise=i}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let n=[];for(let o=1;o<e.length-1;o+=2){let l=r.parse(e[o],o,ji);if(!l)return null;let u=r.parse(e[o+1],o+1,i);if(!u)return null;n.push([l,u]),i=i||u.type}let a=r.parse(e[e.length-1],e.length-1,i);if(!a)return null;if(!i)throw new Error("Can't infer output type");return new EY(i,n,a)}evaluate(e){for(let[r,i]of this.branches)if(r.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,i]of this.branches)e(r),e(i);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}};s(MY,"Case");var xke=MY,CY=class c6{constructor(e,r,i,n){this.type=e,this.input=r,this.beginIndex=i,this.endIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1,$i),n=r.parse(e[2],2,wr);if(!i||!n)return null;if(!eP(i.type,[Tu($i),tn,$i]))return r.error("Expected first argument to be of type array or string, but found ".concat($a(i.type)," instead"));if(e.length===4){let a=r.parse(e[3],3,wr);return a?new c6(i.type,i,n,a):null}else return new c6(i.type,i,n)}evaluate(e){let r=this.input.evaluate(e),i=this.beginIndex.evaluate(e),n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),jm(r,["string"]))return[...r].slice(i,n).join("");if(jm(r,["array"]))return r.slice(i,n);throw new Xo("Expected first argument to be of type array or string, but found ".concat($a(Wo(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};s(CY,"Slice");var bke=CY;function vA(t,e){let r=t.length-1,i=0,n=r,a=0,o,l;for(;i<=n;)if(a=Math.floor((i+n)/2),o=t[a],l=t[a+1],o<=e){if(a===r||e<l)return a;i=a+1}else if(o>e)n=a-1;else throw new Xo("Input is not a number.");return 0}s(vA,"findStopLessThanOrEqualTo");var IY=class TY{constructor(e,r,i){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[n,a]of i)this.labels.push(n),this.outputs.push(a)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let i=r.parse(e[1],1,wr);if(!i)return null;let n=[],a=null;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);for(let o=1;o<e.length;o+=2){let l=o===1?-1/0:e[o],u=e[o+1],c=o,p=o+1;if(typeof l!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(n.length&&n[n.length-1][0]>=l)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',c);let m=r.parse(u,p,a);if(!m)return null;a=a||m.type,n.push([l,m])}return new TY(a,i,n)}evaluate(e){let r=this.labels,i=this.outputs;if(r.length===1)return i[0].evaluate(e);let n=this.input.evaluate(e);if(n<=r[0])return i[0].evaluate(e);let a=r.length;if(n>=r[a-1])return i[a-1].evaluate(e);let o=vA(r,n);return i[o].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};s(IY,"Step");var V9=IY;function PY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}s(PY,"getDefaultExportFromCjs");var PL,IH;function LY(){if(IH)return PL;IH=1,PL=t;function t(e,r,i,n){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(n-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=i,this.p2y=n}return s(t,"UnitBezier"),t.prototype={sampleCurveX:s(function(e){return((this.ax*e+this.bx)*e+this.cx)*e},"sampleCurveX"),sampleCurveY:s(function(e){return((this.ay*e+this.by)*e+this.cy)*e},"sampleCurveY"),sampleCurveDerivativeX:s(function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},"sampleCurveDerivativeX"),solveCurveX:s(function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var i=e,n=0;n<8;n++){var a=this.sampleCurveX(i)-e;if(Math.abs(a)<r)return i;var o=this.sampleCurveDerivativeX(i);if(Math.abs(o)<1e-6)break;i=i-a/o}var l=0,u=1;for(i=e,n=0;n<20&&(a=this.sampleCurveX(i),!(Math.abs(a-e)<r));n++)e>a?l=i:u=i,i=(u-l)*.5+l;return i},"solveCurveX"),solve:s(function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))},"solve")},PL}s(LY,"requireUnitbezier");var wke=LY(),Ake=PY(wke);function DY(t){return t==="rgb"||t==="hcl"||t==="lab"}s(DY,"isSupportedInterpolationColorSpace");function $m(t,e,r){return t+r*(e-t)}s($m,"number");function RY(t,e,r,i="rgb"){switch(i){case"rgb":{let[n,a,o,l]=gw(t.rgb,e.rgb,r);return new Pi(n,a,o,l,!1)}case"hcl":{let[n,a,o,l]=t.hcl,[u,c,p,m]=e.hcl,y,v;if(!isNaN(n)&&!isNaN(u)){let P=u-n;u>n&&P>180?P-=360:u<n&&n-u>180&&(P+=360),y=n+r*P}else isNaN(n)?isNaN(u)?y=NaN:(y=u,(o===1||o===0)&&(v=c)):(y=n,(p===1||p===0)&&(v=a));let[x,E,M,I]=$Z([y,v??$m(a,c,r),$m(o,p,r),$m(l,m,r)]);return new Pi(x,E,M,I,!1)}case"lab":{let[n,a,o,l]=B9(gw(t.lab,e.lab,r));return new Pi(n,a,o,l,!1)}}}s(RY,"color");function gw(t,e,r){return t.map((i,n)=>$m(i,e[n],r))}s(gw,"array");function OY(t,e,r){return new Af(gw(t.values,e.values,r))}s(OY,"padding");function kY(t,e,r){let i=t.values,n=e.values;if(i.length!==n.length)throw new Xo("Cannot interpolate values of different length. from: ".concat(t.toString(),", to: ").concat(e.toString()));let a=[];for(let o=0;o<i.length;o+=2){if(i[o]!==n[o])throw new Xo("Cannot interpolate values containing mismatched anchors. from[".concat(o,"]: ").concat(i[o],", to[").concat(o,"]: ").concat(n[o]));a.push(i[o]);let[l,u]=i[o+1],[c,p]=n[o+1];a.push([$m(l,c,r),$m(u,p,r)])}return new ov(a)}s(kY,"variableAnchorOffsetCollection");var Ya={number:$m,color:RY,array:gw,padding:OY,variableAnchorOffsetCollection:kY},NY=class h6{constructor(e,r,i,n,a){this.type=e,this.operator=r,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(let[o,l]of a)this.labels.push(o),this.outputs.push(l)}static interpolationFactor(e,r,i,n){let a=0;if(e.name==="exponential")a=DE(r,e.base,i,n);else if(e.name==="linear")a=DE(r,1,i,n);else if(e.name==="cubic-bezier"){let o=e.controlPoints;a=new Ake(o[0],o[1],o[2],o[3]).solve(DE(r,1,i,n))}return a}static parse(e,r){let[i,n,a,...o]=e;if(!Array.isArray(n)||n.length===0)return r.error("Expected an interpolation type expression.",1);if(n[0]==="linear")n={name:"linear"};else if(n[0]==="exponential"){let c=n[1];if(typeof c!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:c}}else if(n[0]==="cubic-bezier"){let c=n.slice(1);if(c.length!==4||c.some(p=>typeof p!="number"||p<0||p>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:c}}else return r.error("Unknown interpolation type ".concat(String(n[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(a=r.parse(a,2,wr),!a)return null;let l=[],u=null;i==="interpolate-hcl"||i==="interpolate-lab"?u=zh:r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);for(let c=0;c<o.length;c+=2){let p=o[c],m=o[c+1],y=c+3,v=c+4;if(typeof p!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',y);if(l.length&&l[l.length-1][0]>=p)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',y);let x=r.parse(m,v,u);if(!x)return null;u=u||x.type,l.push([p,x])}return!x0(u,wr)&&!x0(u,zh)&&!x0(u,J3)&&!x0(u,Q3)&&!x0(u,Tu(wr))?r.error("Type ".concat($a(u)," is not interpolatable.")):new h6(u,i,n,a,l)}evaluate(e){let r=this.labels,i=this.outputs;if(r.length===1)return i[0].evaluate(e);let n=this.input.evaluate(e);if(n<=r[0])return i[0].evaluate(e);let a=r.length;if(n>=r[a-1])return i[a-1].evaluate(e);let o=vA(r,n),l=r[o],u=r[o+1],c=h6.interpolationFactor(this.interpolation,n,l,u),p=i[o].evaluate(e),m=i[o+1].evaluate(e);switch(this.operator){case"interpolate":return Ya[this.type.kind](p,m,c);case"interpolate-hcl":return Ya.color(p,m,c,"hcl");case"interpolate-lab":return Ya.color(p,m,c,"lab")}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};s(NY,"Interpolate");var qp=NY;function DE(t,e,r,i){let n=i-r,a=t-r;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}s(DE,"exponentialInterpolation");var FY=class p6{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=null,n=r.expectedType;n&&n.kind!=="value"&&(i=n);let a=[];for(let o of e.slice(1)){let l=r.parse(o,1+a.length,i,void 0,{typeAnnotation:"omit"});if(!l)return null;i=i||l.type,a.push(l)}if(!i)throw new Error("No output type");return n&&a.some(o=>f_(n,o.type))?new p6($i,a):new p6(i,a)}evaluate(e){let r=null,i=0,n;for(let a of this.args)if(i++,r=a.evaluate(e),r&&r instanceof Kp&&!r.available&&(n||(n=r.name),r=null,i===this.args.length&&(r=n)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};s(FY,"Coalesce");var BY=FY;function d6(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}s(d6,"isComparableType");function zY(t,e,r){return e===r}s(zY,"eq");function UY(t,e,r){return e!==r}s(UY,"neq");function VY(t,e,r){return e<r}s(VY,"lt");function jY(t,e,r){return e>r}s(jY,"gt");function $Y(t,e,r){return e<=r}s($Y,"lteq");function GY(t,e,r){return e>=r}s(GY,"gteq");function j9(t,e,r,i){return i.compare(e,r)===0}s(j9,"eqCollate");function HY(t,e,r,i){return!j9(t,e,r,i)}s(HY,"neqCollate");function qY(t,e,r,i){return i.compare(e,r)<0}s(qY,"ltCollate");function WY(t,e,r,i){return i.compare(e,r)>0}s(WY,"gtCollate");function XY(t,e,r,i){return i.compare(e,r)<=0}s(XY,"lteqCollate");function ZY(t,e,r,i){return i.compare(e,r)>=0}s(ZY,"gteqCollate");function sv(t,e,r){var i;let n=t!=="=="&&t!=="!=";return i=class{constructor(a,o,l){this.type=ji,this.lhs=a,this.rhs=o,this.collator=l,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}static parse(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");let l=a[0],u=o.parse(a[1],1,$i);if(!u)return null;if(!d6(l,u.type))return o.concat(1).error('"'.concat(l,`" comparisons are not supported for type '`).concat($a(u.type),"'."));let c=o.parse(a[2],2,$i);if(!c)return null;if(!d6(l,c.type))return o.concat(2).error('"'.concat(l,`" comparisons are not supported for type '`).concat($a(c.type),"'."));if(u.type.kind!==c.type.kind&&u.type.kind!=="value"&&c.type.kind!=="value")return o.error("Cannot compare types '".concat($a(u.type),"' and '").concat($a(c.type),"'."));n&&(u.type.kind==="value"&&c.type.kind!=="value"?u=new rf(c.type,[u]):u.type.kind!=="value"&&c.type.kind==="value"&&(c=new rf(u.type,[c])));let p=null;if(a.length===4){if(u.type.kind!=="string"&&c.type.kind!=="string"&&u.type.kind!=="value"&&c.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(p=o.parse(a[3],3,K3),!p)return null}return new i(u,c,p)}evaluate(a){let o=this.lhs.evaluate(a),l=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){let u=Wo(o),c=Wo(l);if(u.kind!==c.kind||!(u.kind==="string"||u.kind==="number"))throw new Xo('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(u.kind,", ").concat(c.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let u=Wo(o),c=Wo(l);if(u.kind!=="string"||c.kind!=="string")return e(a,o,l)}return this.collator?r(a,o,l,this.collator.evaluate(a)):e(a,o,l)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}},s(i,"Comparison"),i}s(sv,"makeComparison");var Ske=sv("==",zY,j9),Mke=sv("!=",UY,HY),Eke=sv("<",VY,qY),Cke=sv(">",jY,WY),Ike=sv("<=",$Y,XY),Tke=sv(">=",GY,ZY),YY=class KY{constructor(e,r,i){this.type=K3,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let i=e[1];if(typeof i!="object"||Array.isArray(i))return r.error("Collator options argument must be an object.");let n=r.parse(i["case-sensitive"]===void 0?!1:i["case-sensitive"],1,ji);if(!n)return null;let a=r.parse(i["diacritic-sensitive"]===void 0?!1:i["diacritic-sensitive"],1,ji);if(!a)return null;let o=null;return i.locale&&(o=r.parse(i.locale,1,tn),!o)?null:new KY(n,a,o)}evaluate(e){return new z9(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}};s(YY,"CollatorExpression");var JY=YY,QY=class eK{constructor(e,r,i,n,a){this.type=tn,this.number=e,this.locale=r,this.currency=i,this.minFractionDigits=n,this.maxFractionDigits=a}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let i=r.parse(e[1],1,wr);if(!i)return null;let n=e[2];if(typeof n!="object"||Array.isArray(n))return r.error("NumberFormat options argument must be an object.");let a=null;if(n.locale&&(a=r.parse(n.locale,1,tn),!a))return null;let o=null;if(n.currency&&(o=r.parse(n.currency,1,tn),!o))return null;let l=null;if(n["min-fraction-digits"]&&(l=r.parse(n["min-fraction-digits"],1,wr),!l))return null;let u=null;return n["max-fraction-digits"]&&(u=r.parse(n["max-fraction-digits"],1,wr),!u)?null:new eK(i,a,o,l,u)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}};s(QY,"NumberFormat");var Pke=QY,tK=class rK{constructor(e){this.type=gA,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i=e[1];if(!Array.isArray(i)&&typeof i=="object")return r.error("First argument must be an image or text section.");let n=[],a=!1;for(let o=1;o<=e.length-1;++o){let l=e[o];if(a&&typeof l=="object"&&!Array.isArray(l)){a=!1;let u=null;if(l["font-scale"]&&(u=r.parse(l["font-scale"],1,wr),!u))return null;let c=null;if(l["text-font"]&&(c=r.parse(l["text-font"],1,Tu(tn)),!c))return null;let p=null;if(l["text-color"]&&(p=r.parse(l["text-color"],1,zh),!p))return null;let m=n[n.length-1];m.scale=u,m.font=c,m.textColor=p}else{let u=r.parse(e[o],1,$i);if(!u)return null;let c=u.type.kind;if(c!=="string"&&c!=="value"&&c!=="null"&&c!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,n.push({content:u,scale:null,font:null,textColor:null})}}return new rK(n)}evaluate(e){let r=s(i=>{let n=i.content.evaluate(e);return Wo(n)===yA?new s6("",n,null,null,null):new s6(X1(n),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)},"evaluateSection");return new df(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}};s(tK,"FormatExpression");var iK=tK,nK=class aK{constructor(e){this.type=yA,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let i=r.parse(e[1],1,tn);return i?new aK(i):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),i=Kp.fromString(r);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(r)>-1),i}eachChild(e){e(this.input)}outputDefined(){return!1}};s(nK,"ImageExpression");var Lke=nK,oK=class sK{constructor(e){this.type=wr,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let i=r.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat($a(i.type)," instead.")):new sK(i):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Xo("Expected value to be of type string or array, but found ".concat($a(Wo(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}};s(oK,"Length");var Dke=oK,Wp=8192;function lK(t,e){let r=uK(t[0]),i=hK(t[1]),n=Math.pow(2,e.z);return[Math.round(r*n*Wp),Math.round(i*n*Wp)]}s(lK,"getTileCoordinates");function tP(t,e){let r=Math.pow(2,e.z),i=(t[0]/Wp+e.x)/r,n=(t[1]/Wp+e.y)/r;return[cK(i),pK(n)]}s(tP,"getLngLatFromTileCoord");function uK(t){return(180+t)/360}s(uK,"mercatorXfromLng");function cK(t){return t*360-180}s(cK,"lngFromMercatorXfromLng");function hK(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}s(hK,"mercatorYfromLat");function pK(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}s(pK,"latFromMercatorY");function rx(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}s(rx,"updateBBox");function g_(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}s(g_,"boxWithinBox");function dK(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}s(dK,"rayIntersect");function fK(t,e,r){let i=t[0]-e[0],n=t[1]-e[1],a=t[0]-r[0],o=t[1]-r[1];return i*o-a*n===0&&i*a<=0&&n*o<=0}s(fK,"pointOnBoundary");function _A(t,e,r,i){let n=[e[0]-t[0],e[1]-t[1]],a=[i[0]-r[0],i[1]-r[1]];return vK(a,n)===0?!1:!!(f6(t,e,r,i)&&f6(r,i,t,e))}s(_A,"segmentIntersectSegment");function mK(t,e,r){for(let i of r)for(let n=0;n<i.length-1;++n)if(_A(t,e,i[n],i[n+1]))return!0;return!1}s(mK,"lineIntersectPolygon");function lv(t,e,r=!1){let i=!1;for(let n of e)for(let a=0;a<n.length-1;a++){if(fK(t,n[a],n[a+1]))return r;dK(t,n[a],n[a+1])&&(i=!i)}return i}s(lv,"pointWithinPolygon");function gK(t,e){for(let r of e)if(lv(t,r))return!0;return!1}s(gK,"pointWithinPolygons");function $9(t,e){for(let r of t)if(!lv(r,e))return!1;for(let r=0;r<t.length-1;++r)if(mK(t[r],t[r+1],e))return!1;return!0}s($9,"lineStringWithinPolygon");function yK(t,e){for(let r of e)if($9(t,r))return!0;return!1}s(yK,"lineStringWithinPolygons");function vK(t,e){return t[0]*e[1]-t[1]*e[0]}s(vK,"perp");function f6(t,e,r,i){let n=t[0]-r[0],a=t[1]-r[1],o=e[0]-r[0],l=e[1]-r[1],u=i[0]-r[0],c=i[1]-r[1],p=n*c-u*a,m=o*c-u*l;return p>0&&m<0||p<0&&m>0}s(f6,"twoSided");function rP(t,e,r){let i=[];for(let n=0;n<t.length;n++){let a=[];for(let o=0;o<t[n].length;o++){let l=lK(t[n][o],r);rx(e,l),a.push(l)}i.push(a)}return i}s(rP,"getTilePolygon");function G9(t,e,r){let i=[];for(let n=0;n<t.length;n++){let a=rP(t[n],e,r);i.push(a)}return i}s(G9,"getTilePolygons");function H9(t,e,r,i){if(t[0]<r[0]||t[0]>r[2]){let n=i*.5,a=t[0]-r[0]>n?-i:r[0]-t[0]>n?i:0;a===0&&(a=t[0]-r[2]>n?-i:r[2]-t[0]>n?i:0),t[0]+=a}rx(e,t)}s(H9,"updatePoint");function _K(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}s(_K,"resetBBox");function m6(t,e,r,i){let n=Math.pow(2,i.z)*Wp,a=[i.x*Wp,i.y*Wp],o=[];for(let l of t)for(let u of l){let c=[u.x+a[0],u.y+a[1]];H9(c,e,r,n),o.push(c)}return o}s(m6,"getTilePoints");function g6(t,e,r,i){let n=Math.pow(2,i.z)*Wp,a=[i.x*Wp,i.y*Wp],o=[];for(let l of t){let u=[];for(let c of l){let p=[c.x+a[0],c.y+a[1]];rx(e,p),u.push(p)}o.push(u)}if(e[2]-e[0]<=n/2){_K(e);for(let l of o)for(let u of l)H9(u,e,r,n)}return o}s(g6,"getTileLines");function xK(t,e){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if(e.type==="Polygon"){let a=rP(e.coordinates,i,n),o=m6(t.geometry(),r,i,n);if(!g_(r,i))return!1;for(let l of o)if(!lv(l,a))return!1}if(e.type==="MultiPolygon"){let a=G9(e.coordinates,i,n),o=m6(t.geometry(),r,i,n);if(!g_(r,i))return!1;for(let l of o)if(!gK(l,a))return!1}return!0}s(xK,"pointsWithinPolygons");function bK(t,e){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if(e.type==="Polygon"){let a=rP(e.coordinates,i,n),o=g6(t.geometry(),r,i,n);if(!g_(r,i))return!1;for(let l of o)if(!$9(l,a))return!1}if(e.type==="MultiPolygon"){let a=G9(e.coordinates,i,n),o=g6(t.geometry(),r,i,n);if(!g_(r,i))return!1;for(let l of o)if(!yK(l,a))return!1}return!0}s(bK,"linesWithinPolygons");var wK=class RE{constructor(e,r){this.type=ji,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(m_(e[1])){let i=e[1];if(i.type==="FeatureCollection"){let n=[];for(let a of i.features){let{type:o,coordinates:l}=a.geometry;o==="Polygon"&&n.push(l),o==="MultiPolygon"&&n.push(...l)}if(n.length){let a={type:"MultiPolygon",coordinates:n};return new RE(i,a)}}else if(i.type==="Feature"){let n=i.geometry.type;if(n==="Polygon"||n==="MultiPolygon")return new RE(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new RE(i,i)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return xK(e,this.geometries);if(e.geometryType()==="LineString")return bK(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}};s(wK,"Within");var q9=wK,AK=class{constructor(e=[],r=(i,n)=>i<n?-1:i>n?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:i}=this,n=r[e];for(;e>0;){let a=e-1>>1,o=r[a];if(i(n,o)>=0)break;r[e]=o,e=a}r[e]=n}_down(e){let{data:r,compare:i}=this,n=this.length>>1,a=r[e];for(;e<n;){let o=(e<<1)+1,l=o+1;if(l<this.length&&i(r[l],r[o])<0&&(o=l),i(r[o],a)>=0)break;r[e]=r[o],e=o}r[e]=a}};s(AK,"TinyQueue");var SK=AK;function MK(t,e,r,i,n){W9(t,e,r,i||t.length-1,n||EK)}s(MK,"quickselect");function W9(t,e,r,i,n){for(;i>r;){if(i-r>600){var a=i-r+1,o=e-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(o-a/2<0?-1:1),p=Math.max(r,Math.floor(e-o*u/a+c)),m=Math.min(i,Math.floor(e+(a-o)*u/a+c));W9(t,e,p,m,n)}var y=t[e],v=r,x=i;for(b0(t,r,e),n(t[i],y)>0&&b0(t,r,i);v<x;){for(b0(t,v,x),v++,x--;n(t[v],y)<0;)v++;for(;n(t[x],y)>0;)x--}n(t[r],y)===0?b0(t,r,x):(x++,b0(t,x,i)),x<=e&&(r=x+1),e<=x&&(i=x-1)}}s(W9,"quickselectStep");function b0(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}s(b0,"swap");function EK(t,e){return t<e?-1:t>e?1:0}s(EK,"defaultCompare");function CK(t,e){if(t.length<=1)return[t];let r=[],i,n;for(let a of t){let o=TK(a);o!==0&&(a.area=Math.abs(o),n===void 0&&(n=o<0),n===o<0?(i&&r.push(i),i=[a]):i.push(a))}if(i&&r.push(i),e>1)for(let a=0;a<r.length;a++)r[a].length<=e||(MK(r[a],e,1,r[a].length-1,IK),r[a]=r[a].slice(0,e));return r}s(CK,"classifyRings");function IK(t,e){return e.area-t.area}s(IK,"compareAreas");function TK(t){let e=0;for(let r=0,i=t.length,n=i-1,a,o;r<i;n=r++)a=t[r],o=t[n],e+=(o.x-a.x)*(a.y+o.y);return e}s(TK,"calculateSignedArea");var Rke=6378.137,TH=1/298.257223563,PH=TH*(2-TH),LH=Math.PI/180,PK=class{constructor(e){let r=LH*Rke*1e3,i=Math.cos(e*LH),n=1/(1-PH*(1-i*i)),a=Math.sqrt(n);this.kx=r*a*i,this.ky=r*a*n*(1-PH)}distance(e,r){let i=this.wrap(e[0]-r[0])*this.kx,n=(e[1]-r[1])*this.ky;return Math.sqrt(i*i+n*n)}pointOnLine(e,r){let i=1/0,n,a,o,l;for(let u=0;u<e.length-1;u++){let c=e[u][0],p=e[u][1],m=this.wrap(e[u+1][0]-c)*this.kx,y=(e[u+1][1]-p)*this.ky,v=0;(m!==0||y!==0)&&(v=(this.wrap(r[0]-c)*this.kx*m+(r[1]-p)*this.ky*y)/(m*m+y*y),v>1?(c=e[u+1][0],p=e[u+1][1]):v>0&&(c+=m/this.kx*v,p+=y/this.ky*v)),m=this.wrap(r[0]-c)*this.kx,y=(r[1]-p)*this.ky;let x=m*m+y*y;x<i&&(i=x,n=c,a=p,o=u,l=v)}return{point:[n,a],index:o,t:Math.max(0,Math.min(1,l))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}};s(PK,"CheapRuler");var X9=PK,y6=100,v6=50;function Z9(t,e){return e[0]-t[0]}s(Z9,"compareDistPair");function yw(t){return t[1]-t[0]+1}s(yw,"getRangeSize");function Jp(t,e){return t[1]>=t[0]&&t[1]<e}s(Jp,"isRangeSafe");function xT(t,e){if(t[0]>t[1])return[null,null];let r=yw(t);if(e){if(r===2)return[t,null];let n=Math.floor(r/2);return[[t[0],t[0]+n],[t[0]+n,t[1]]]}if(r===1)return[t,null];let i=Math.floor(r/2)-1;return[[t[0],t[0]+i],[t[0]+i+1,t[1]]]}s(xT,"splitRange");function bT(t,e){if(!Jp(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let i=e[0];i<=e[1];++i)rx(r,t[i]);return r}s(bT,"getBBox");function wT(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let i of r)rx(e,i);return e}s(wT,"getPolygonBBox");function _6(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}s(_6,"isValidBBox");function iP(t,e,r){if(!_6(t)||!_6(e))return NaN;let i=0,n=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(n=t[1]-e[3]),t[3]<e[1]&&(n=e[1]-t[3]),r.distance([0,0],[i,n])}s(iP,"bboxToBBoxDistance");function Um(t,e,r){let i=r.pointOnLine(e,t);return r.distance(t,i.point)}s(Um,"pointToLineDistance");function nP(t,e,r,i,n){let a=Math.min(Um(t,[r,i],n),Um(e,[r,i],n)),o=Math.min(Um(r,[t,e],n),Um(i,[t,e],n));return Math.min(a,o)}s(nP,"segmentToSegmentDistance");function LK(t,e,r,i,n){if(!(Jp(e,t.length)&&Jp(i,r.length)))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){let l=t[o],u=t[o+1];for(let c=i[0];c<i[1];++c){let p=r[c],m=r[c+1];if(_A(l,u,p,m))return 0;a=Math.min(a,nP(l,u,p,m,n))}}return a}s(LK,"lineToLineDistance");function DK(t,e,r,i,n){if(!(Jp(e,t.length)&&Jp(i,r.length)))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let l=i[0];l<=i[1];++l)if(a=Math.min(a,n.distance(t[o],r[l])),a===0)return a;return a}s(DK,"pointsToPointsDistance");function RK(t,e,r){if(lv(t,e,!0))return 0;let i=1/0;for(let n of e){let a=n[0],o=n[n.length-1];if(a!==o&&(i=Math.min(i,Um(t,[o,a],r)),i===0))return i;let l=r.pointOnLine(n,t);if(i=Math.min(i,r.distance(t,l.point)),i===0)return i}return i}s(RK,"pointToPolygonDistance");function OK(t,e,r,i){if(!Jp(e,t.length))return NaN;for(let a=e[0];a<=e[1];++a)if(lv(t[a],r,!0))return 0;let n=1/0;for(let a=e[0];a<e[1];++a){let o=t[a],l=t[a+1];for(let u of r)for(let c=0,p=u.length,m=p-1;c<p;m=c++){let y=u[m],v=u[c];if(_A(o,l,y,v))return 0;n=Math.min(n,nP(o,l,y,v,i))}}return n}s(OK,"lineToPolygonDistance");function x6(t,e){for(let r of t)for(let i of r)if(lv(i,e,!0))return!0;return!1}s(x6,"polygonIntersect");function kK(t,e,r,i=1/0){let n=wT(t),a=wT(e);if(i!==1/0&&iP(n,a,r)>=i)return i;if(g_(n,a)){if(x6(t,e))return 0}else if(x6(e,t))return 0;let o=1/0;for(let l of t)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let m=l[p],y=l[u];for(let v of e)for(let x=0,E=v.length,M=E-1;x<E;M=x++){let I=v[M],P=v[x];if(_A(m,y,I,P))return 0;o=Math.min(o,nP(m,y,I,P,r))}}return o}s(kK,"polygonToPolygonDistance");function b6(t,e,r,i,n,a){if(!a)return;let o=iP(bT(i,a),n,r);o<e&&t.push([o,a,[0,0]])}s(b6,"updateQueue");function Zb(t,e,r,i,n,a,o){if(!a||!o)return;let l=iP(bT(i,a),bT(n,o),r);l<e&&t.push([l,a,o])}s(Zb,"updateQueueTwoSets");function vw(t,e,r,i,n=1/0){let a=Math.min(i.distance(t[0],r[0][0]),n);if(a===0)return a;let o=new SK([[0,[0,t.length-1],[0,0]]],Z9),l=wT(r);for(;o.length>0;){let u=o.pop();if(u[0]>=a)continue;let c=u[1],p=e?v6:y6;if(yw(c)<=p){if(!Jp(c,t.length))return NaN;if(e){let m=OK(t,c,r,i);if(isNaN(m)||m===0)return m;a=Math.min(a,m)}else for(let m=c[0];m<=c[1];++m){let y=RK(t[m],r,i);if(a=Math.min(a,y),a===0)return 0}}else{let m=xT(c,e);b6(o,a,i,t,l,m[0]),b6(o,a,i,t,l,m[1])}}return a}s(vw,"pointsToPolygonDistance");function _w(t,e,r,i,n,a=1/0){let o=Math.min(a,n.distance(t[0],r[0]));if(o===0)return o;let l=new SK([[0,[0,t.length-1],[0,r.length-1]]],Z9);for(;l.length>0;){let u=l.pop();if(u[0]>=o)continue;let c=u[1],p=u[2],m=e?v6:y6,y=i?v6:y6;if(yw(c)<=m&&yw(p)<=y){if(!Jp(c,t.length)&&Jp(p,r.length))return NaN;let v;if(e&&i)v=LK(t,c,r,p,n),o=Math.min(o,v);else if(e&&!i){let x=t.slice(c[0],c[1]+1);for(let E=p[0];E<=p[1];++E)if(v=Um(r[E],x,n),o=Math.min(o,v),o===0)return o}else if(!e&&i){let x=r.slice(p[0],p[1]+1);for(let E=c[0];E<=c[1];++E)if(v=Um(t[E],x,n),o=Math.min(o,v),o===0)return o}else v=DK(t,c,r,p,n),o=Math.min(o,v)}else{let v=xT(c,e),x=xT(p,i);Zb(l,o,n,t,r,v[0],x[0]),Zb(l,o,n,t,r,v[0],x[1]),Zb(l,o,n,t,r,v[1],x[0]),Zb(l,o,n,t,r,v[1],x[1])}}return o}s(_w,"pointSetToPointSetDistance");function NK(t,e){let r=t.geometry(),i=r.flat().map(o=>tP([o.x,o.y],t.canonical));if(r.length===0)return NaN;let n=new X9(i[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,_w(i,!1,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,_w(i,!1,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,vw(i,!1,o.coordinates,n,a));break}if(a===0)return a}return a}s(NK,"pointToGeometryDistance");function FK(t,e){let r=t.geometry(),i=r.flat().map(o=>tP([o.x,o.y],t.canonical));if(r.length===0)return NaN;let n=new X9(i[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,_w(i,!0,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,_w(i,!0,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,vw(i,!0,o.coordinates,n,a));break}if(a===0)return a}return a}s(FK,"lineStringToGeometryDistance");function BK(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let i=CK(r,0).map(o=>o.map(l=>l.map(u=>tP([u.x,u.y],t.canonical)))),n=new X9(i[0][0][0][1]),a=1/0;for(let o of e)for(let l of i){switch(o.type){case"Point":a=Math.min(a,vw([o.coordinates],!1,l,n,a));break;case"LineString":a=Math.min(a,vw(o.coordinates,!0,l,n,a));break;case"Polygon":a=Math.min(a,kK(l,o.coordinates,n,a));break}if(a===0)return a}return a}s(BK,"polygonToGeometryDistance");function OE(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}s(OE,"toSimpleGeometry");var zK=class kE{constructor(e,r){this.type=wr,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(m_(e[1])){let i=e[1];if(i.type==="FeatureCollection")return new kE(i,i.features.map(n=>OE(n.geometry)).flat());if(i.type==="Feature")return new kE(i,OE(i.geometry));if("type"in i&&"coordinates"in i)return new kE(i,OE(i))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return NK(e,this.geometries);if(e.geometryType()==="LineString")return FK(e,this.geometries);if(e.geometryType()==="Polygon")return BK(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}};s(zK,"Distance");var Y9=zK,Z1={"==":Ske,"!=":Mke,">":Cke,"<":Eke,">=":Tke,"<=":Ike,array:rf,at:gke,boolean:rf,case:xke,coalesce:BY,collator:JY,format:iK,image:Lke,in:yke,"index-of":vke,interpolate:qp,"interpolate-hcl":qp,"interpolate-lab":qp,length:Dke,let:fY,literal:mw,match:_ke,number:rf,"number-format":Pke,object:rf,slice:bke,step:V9,string:rf,"to-boolean":D1,"to-color":D1,"to-number":D1,"to-string":D1,var:yY,within:q9,distance:Y9},UK=class Yb{constructor(e,r,i,n){this.name=e,this.type=r,this._evaluate=i,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let i=e[0],n=Yb.definitions[i];if(!n)return r.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0);let a=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,l=o.filter(([c])=>!Array.isArray(c)||c.length===e.length-1),u=null;for(let[c,p]of l){u=new hY(r.registry,xw,r.path,null,r.scope);let m=[],y=!1;for(let v=1;v<e.length;v++){let x=e[v],E=Array.isArray(c)?c[v-1]:c.type,M=u.parse(x,1+m.length,E);if(!M){y=!0;break}m.push(M)}if(!y){if(Array.isArray(c)&&c.length!==m.length){u.error("Expected ".concat(c.length," arguments, but found ").concat(m.length," instead."));continue}for(let v=0;v<m.length;v++){let x=Array.isArray(c)?c[v]:c.type,E=m[v];u.concat(v+1).checkSubtype(x,E.type)}if(u.errors.length===0)return new Yb(i,a,p,m)}}if(l.length===1)r.errors.push(...u.errors);else{let c=(l.length?l:o).map(([m])=>jK(m)).join(" | "),p=[];for(let m=1;m<e.length;m++){let y=r.parse(e[m],1+p.length);if(!y)return null;p.push($a(y.type))}r.error("Expected arguments of type ".concat(c,", but found (").concat(p.join(", "),") instead."))}return null}static register(e,r){Yb.definitions=r;for(let i in r)e[i]=Yb}};s(UK,"CompoundExpression");var uv=UK;function w6(t,[e,r,i,n]){e=e.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);let a=n?n.evaluate(t):1,o=U9(e,r,i,a);if(o)throw new Xo(o);return new Pi(e/255,r/255,i/255,a,!1)}s(w6,"rgba");function A6(t,e){return t in e}s(A6,"has");function NE(t,e){let r=e[t];return typeof r>"u"?null:r}s(NE,"get");function VK(t,e,r,i){for(;r<=i;){let n=r+i>>1;if(e[n]===t)return!0;e[n]>t?i=n-1:r=n+1}return!1}s(VK,"binarySearch");function cm(t){return{type:t}}s(cm,"varargs");uv.register(Z1,{error:[lke,[tn],(t,[e])=>{throw new Xo(e.evaluate(t))}],typeof:[tn,[$i],(t,[e])=>$a(Wo(e.evaluate(t)))],"to-rgba":[Tu(wr,4),[zh],(t,[e])=>{let[r,i,n,a]=e.evaluate(t).rgb;return[r*255,i*255,n*255,a]}],rgb:[zh,[wr,wr,wr],w6],rgba:[zh,[wr,wr,wr,wr],w6],has:{type:ji,overloads:[[[tn],(t,[e])=>A6(e.evaluate(t),t.properties())],[[tn,q1],(t,[e,r])=>A6(e.evaluate(t),r.evaluate(t))]]},get:{type:$i,overloads:[[[tn],(t,[e])=>NE(e.evaluate(t),t.properties())],[[tn,q1],(t,[e,r])=>NE(e.evaluate(t),r.evaluate(t))]]},"feature-state":[$i,[tn],(t,[e])=>NE(e.evaluate(t),t.featureState||{})],properties:[q1,[],t=>t.properties()],"geometry-type":[tn,[],t=>t.geometryType()],id:[$i,[],t=>t.id()],zoom:[wr,[],t=>t.globals.zoom],"heatmap-density":[wr,[],t=>t.globals.heatmapDensity||0],"line-progress":[wr,[],t=>t.globals.lineProgress||0],accumulated:[$i,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[wr,cm(wr),(t,e)=>{let r=0;for(let i of e)r+=i.evaluate(t);return r}],"*":[wr,cm(wr),(t,e)=>{let r=1;for(let i of e)r*=i.evaluate(t);return r}],"-":{type:wr,overloads:[[[wr,wr],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[wr],(t,[e])=>-e.evaluate(t)]]},"/":[wr,[wr,wr],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[wr,[wr,wr],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[wr,[],()=>Math.LN2],pi:[wr,[],()=>Math.PI],e:[wr,[],()=>Math.E],"^":[wr,[wr,wr],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[wr,[wr],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[wr,[wr],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[wr,[wr],(t,[e])=>Math.log(e.evaluate(t))],log2:[wr,[wr],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[wr,[wr],(t,[e])=>Math.sin(e.evaluate(t))],cos:[wr,[wr],(t,[e])=>Math.cos(e.evaluate(t))],tan:[wr,[wr],(t,[e])=>Math.tan(e.evaluate(t))],asin:[wr,[wr],(t,[e])=>Math.asin(e.evaluate(t))],acos:[wr,[wr],(t,[e])=>Math.acos(e.evaluate(t))],atan:[wr,[wr],(t,[e])=>Math.atan(e.evaluate(t))],min:[wr,cm(wr),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[wr,cm(wr),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[wr,[wr],(t,[e])=>Math.abs(e.evaluate(t))],round:[wr,[wr],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[wr,[wr],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[wr,[wr],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[ji,[tn,$i],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[ji,[$i],(t,[e])=>t.id()===e.value],"filter-type-==":[ji,[tn],(t,[e])=>t.geometryType()===e.value],"filter-<":[ji,[tn,$i],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i<n}],"filter-id-<":[ji,[$i],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r<i}],"filter->":[ji,[tn,$i],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i>n}],"filter-id->":[ji,[$i],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r>i}],"filter-<=":[ji,[tn,$i],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i<=n}],"filter-id-<=":[ji,[$i],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r<=i}],"filter->=":[ji,[tn,$i],(t,[e,r])=>{let i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i>=n}],"filter-id->=":[ji,[$i],(t,[e])=>{let r=t.id(),i=e.value;return typeof r==typeof i&&r>=i}],"filter-has":[ji,[$i],(t,[e])=>e.value in t.properties()],"filter-has-id":[ji,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[ji,[Tu(tn)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[ji,[Tu($i)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[ji,[tn,Tu($i)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[ji,[tn,Tu($i)],(t,[e,r])=>VK(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:ji,overloads:[[[ji,ji],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[cm(ji),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:ji,overloads:[[[ji,ji],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[cm(ji),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[ji,[ji],(t,[e])=>!e.evaluate(t)],"is-supported-script":[ji,[tn],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[tn,[tn],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[tn,[tn],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[tn,cm($i),(t,e)=>e.map(r=>X1(r.evaluate(t))).join("")],"resolved-locale":[tn,[K3],(t,[e])=>e.evaluate(t).resolvedLocale()]});function jK(t){return Array.isArray(t)?"(".concat(t.map($a).join(", "),")"):"(".concat($a(t.type),"...)")}s(jK,"stringifySignature");function xw(t){if(t instanceof yY)return xw(t.boundExpression);if(t instanceof uv&&t.name==="error"||t instanceof JY||t instanceof q9||t instanceof Y9)return!1;let e=t instanceof D1||t instanceof rf,r=!0;return t.eachChild(i=>{e?r=r&&xw(i):r=r&&i instanceof mw}),r?xA(t)&&bA(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}s(xw,"isExpressionConstant");function xA(t){if(t instanceof uv&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof q9||t instanceof Y9)return!1;let e=!0;return t.eachChild(r=>{e&&!xA(r)&&(e=!1)}),e}s(xA,"isFeatureConstant");function y_(t){if(t instanceof uv&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!y_(r)&&(e=!1)}),e}s(y_,"isStateConstant");function bA(t,e){if(t instanceof uv&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(i=>{r&&!bA(i,e)&&(r=!1)}),r}s(bA,"isGlobalPropertyConstant");function AT(t){return{result:"success",value:t}}s(AT,"success");function py(t){return{result:"error",value:t}}s(py,"error");function $y(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}s($y,"supportsPropertyExpression");function K9(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}s(K9,"supportsZoomExpression");function aP(t){return!!t.expression&&t.expression.interpolated}s(aP,"supportsInterpolation");function wn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}s(wn,"getType");function wA(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}s(wA,"isFunction$1");function $K(t){return t}s($K,"identityFunction");function J9(t,e){let r=e.type==="color",i=t.stops&&typeof t.stops[0][0]=="object",n=i||t.property!==void 0,a=i||!n,o=t.type||(aP(e)?"exponential":"interval");if(r||e.type==="padding"){let p=r?Pi.parse:Af.parse;t=jy({},t),t.stops&&(t.stops=t.stops.map(m=>[m[0],p(m[1])])),t.default?t.default=p(t.default):t.default=p(e.default)}if(t.colorSpace&&!DY(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let l,u,c;if(o==="exponential")l=S6;else if(o==="interval")l=HK;else if(o==="categorical"){l=GK,u=Object.create(null);for(let p of t.stops)u[p[0]]=p[1];c=typeof t.stops[0][0]}else if(o==="identity")l=qK;else throw new Error('Unknown function type "'.concat(o,'"'));if(i){let p={},m=[];for(let x=0;x<t.stops.length;x++){let E=t.stops[x],M=E[0].zoom;p[M]===void 0&&(p[M]={zoom:M,type:t.type,property:t.property,default:t.default,stops:[]},m.push(M)),p[M].stops.push([E[0].value,E[1]])}let y=[];for(let x of m)y.push([p[x].zoom,J9(p[x],e)]);let v={name:"linear"};return{kind:"composite",interpolationType:v,interpolationFactor:qp.interpolationFactor.bind(void 0,v),zoomStops:y.map(x=>x[0]),evaluate({zoom:x},E){return S6({stops:y,base:t.base},e,x).evaluate(x,E)}}}else if(a){let p=o==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:p,interpolationFactor:qp.interpolationFactor.bind(void 0,p),zoomStops:t.stops.map(m=>m[0]),evaluate:s(({zoom:m})=>l(t,e,m,u,c),"evaluate")}}else return{kind:"source",evaluate(p,m){let y=m&&m.properties?m.properties[t.property]:void 0;return y===void 0?ix(t.default,e.default):l(t,e,y,u,c)}}}s(J9,"createFunction");function ix(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}s(ix,"coalesce$1");function GK(t,e,r,i,n){let a=typeof r===n?i[r]:void 0;return ix(a,t.default,e.default)}s(GK,"evaluateCategoricalFunction");function HK(t,e,r){if(wn(r)!=="number")return ix(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let n=vA(t.stops.map(a=>a[0]),r);return t.stops[n][1]}s(HK,"evaluateIntervalFunction");function S6(t,e,r){let i=t.base!==void 0?t.base:1;if(wn(r)!=="number")return ix(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let a=vA(t.stops.map(p=>p[0]),r),o=WK(r,i,t.stops[a][0],t.stops[a+1][0]),l=t.stops[a][1],u=t.stops[a+1][1],c=Ya[e.type]||$K;return typeof l.evaluate=="function"?{evaluate(...p){let m=l.evaluate.apply(void 0,p),y=u.evaluate.apply(void 0,p);if(!(m===void 0||y===void 0))return c(m,y,o,t.colorSpace)}}:c(l,u,o,t.colorSpace)}s(S6,"evaluateExponentialFunction");function qK(t,e,r){switch(e.type){case"color":r=Pi.parse(r);break;case"formatted":r=df.fromString(r.toString());break;case"resolvedImage":r=Kp.fromString(r.toString());break;case"padding":r=Af.parse(r);break;default:wn(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return ix(r,t.default,e.default)}s(qK,"evaluateIdentityFunction");function WK(t,e,r,i){let n=i-r,a=t-r;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}s(WK,"interpolationFactor");var XK=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new lY,this._defaultValue=r?rJ(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,i,n,a,o){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=i,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,r,i,n,a,o){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null;try{let l=this.expression.evaluate(this._evaluator);if(l==null||typeof l=="number"&&l!==l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new Xo("Expected value to be one of ".concat(Object.keys(this._enumValues).map(u=>JSON.stringify(u)).join(", "),", but found ").concat(JSON.stringify(l)," instead."));return l}catch(l){return this._warningHistory[l.message]||(this._warningHistory[l.message]=!0,typeof console<"u"&&console.warn(l.message)),this._defaultValue}}};s(XK,"StyleExpression");var Q9=XK;function nx(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Z1}s(nx,"isExpression");function oP(t,e){let r=new hY(Z1,xw,[],e?tJ(e):void 0),i=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return i?AT(new Q9(i,e)):py(r.errors)}s(oP,"createExpression");var ZK=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!y_(r.expression)}evaluateWithoutErrorHandling(e,r,i,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,r,i,n,a,o)}evaluate(e,r,i,n,a,o){return this._styleExpression.evaluate(e,r,i,n,a,o)}};s(ZK,"ZoomConstantExpression");var ST=ZK,YK=class{constructor(e,r,i,n){this.kind=e,this.zoomStops=i,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!y_(r.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,r,i,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,r,i,n,a,o)}evaluate(e,r,i,n,a,o){return this._styleExpression.evaluate(e,r,i,n,a,o)}interpolationFactor(e,r,i){return this.interpolationType?qp.interpolationFactor(this.interpolationType,e,r,i):0}};s(YK,"ZoomDependentExpression");var MT=YK;function e7(t,e){let r=oP(t,e);if(r.result==="error")return r;let i=r.value.expression,n=xA(i);if(!n&&!$y(e))return py([new Fp("","data expressions not supported")]);let a=bA(i,["zoom"]);if(!a&&!K9(e))return py([new Fp("","zoom expressions not supported")]);let o=aw(i);if(!o&&!a)return py([new Fp("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Fp)return py([o]);if(o instanceof qp&&!aP(e))return py([new Fp("",'"interpolate" expressions cannot be used with this property')]);if(!o)return AT(n?new ST("constant",r.value):new ST("source",r.value));let l=o instanceof qp?o.interpolation:void 0;return AT(n?new MT("camera",r.value,o.labels,l):new MT("composite",r.value,o.labels,l))}s(e7,"createPropertyExpression");var KK=class JK{constructor(e,r){this._parameters=e,this._specification=r,jy(this,J9(this._parameters,this._specification))}static deserialize(e){return new JK(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};s(KK,"StylePropertyFunction");var QK=KK;function eJ(t,e){if(wA(t))return new QK(t,e);if(nx(t)){let r=e7(t,e);if(r.result==="error")throw new Error(r.value.map(i=>"".concat(i.key,": ").concat(i.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=Pi.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Af.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)&&(r=ov.parse(t)),{kind:"constant",evaluate:s(()=>r,"evaluate")}}}s(eJ,"normalizePropertyExpression");function aw(t){let e=null;if(t instanceof fY)e=aw(t.result);else if(t instanceof BY){for(let r of t.args)if(e=aw(r),e)break}else(t instanceof V9||t instanceof qp)&&t.input instanceof uv&&t.input.name==="zoom"&&(e=t);return e instanceof Fp||t.eachChild(r=>{let i=aw(r);i instanceof Fp?e=i:!e&&i?e=new Fp("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new Fp("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}s(aw,"findZoomCurve");function tJ(t){let e={color:zh,string:tn,number:wr,enum:tn,boolean:ji,formatted:gA,padding:J3,resolvedImage:yA,variableAnchorOffsetCollection:Q3};return t.type==="array"?Tu(e[t.value]||$i,t.length):e[t.type]}s(tJ,"getExpectedType");function rJ(t){return t.type==="color"&&wA(t.default)?new Pi(0,0,0,0):t.type==="color"?Pi.parse(t.default)||null:t.type==="padding"?Af.parse(t.default)||null:t.type==="variableAnchorOffsetCollection"?ov.parse(t.default)||null:t.default===void 0?null:t.default}s(rJ,"getDefaultValue");function sP(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!sP(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}s(sP,"isExpressionFilter");var Oke={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ET(t){if(t==null)return{filter:s(()=>!0,"filter"),needGeometry:!1};sP(t)||(t=bw(t));let e=oP(t,Oke);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=t7(t);return{filter:s((i,n,a)=>e.value.evaluate(i,n,{},a),"filter"),needGeometry:r}}}s(ET,"createFilter");function iJ(t,e){return t<e?-1:t>e?1:0}s(iJ,"compare");function t7(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(t7(t[e]))return!0;return!1}s(t7,"geometryNeeded");function bw(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?FE(t[1],t[2],"=="):e==="!="?Kb(FE(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?FE(t[1],t[2],e):e==="any"?nJ(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(bw)):e==="none"?["all"].concat(t.slice(1).map(bw).map(Kb)):e==="in"?M6(t[1],t.slice(2)):e==="!in"?Kb(M6(t[1],t.slice(2))):e==="has"?E6(t[1]):e==="!has"?Kb(E6(t[1])):!0}s(bw,"convertFilter$1");function FE(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}s(FE,"convertComparisonOp$1");function nJ(t){return["any"].concat(t.map(bw))}s(nJ,"convertDisjunctionOp");function M6(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(iJ)]]:["filter-in-small",t,["literal",e]]}}s(M6,"convertInOp$1");function E6(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}s(E6,"convertHasOp$1");function Kb(t){return["!",t]}s(Kb,"convertNegation");function aJ(){let t={},e=Ut.$version;for(let r in Ut.$root){let i=Ut.$root[r];if(i.required){let n=null;r==="version"?n=e:i.type==="array"?n=[]:n={},n!=null&&(t[r]=n)}}return t}s(aJ,"emptyStyle");function r7(t){let e=t.key,r=t.value;return r?[new _r(e,r,"constants have been deprecated as of v8")]:[]}s(r7,"validateConstants");function fo(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}s(fo,"unbundle");function Zm(t){if(Array.isArray(t))return t.map(Zm);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Zm(t[r]);return e}return fo(t)}s(Zm,"deepUnbundle");function gc(t){let e=t.key,r=t.value,i=t.valueSpec||{},n=t.objectElementValidators||{},a=t.style,o=t.styleSpec,l=t.validateSpec,u=[],c=wn(r);if(c!=="object")return[new _r(e,r,"object expected, ".concat(c," found"))];for(let p in r){let m=p.split(".")[0],y=i[m]||i["*"],v;if(n[m])v=n[m];else if(i[m])v=l;else if(n["*"])v=n["*"];else if(i["*"])v=l;else{u.push(new _r(e,r[p],'unknown property "'.concat(p,'"')));continue}u=u.concat(v({key:(e&&"".concat(e,"."))+p,value:r[p],valueSpec:y,style:a,styleSpec:o,object:r,objectKey:p,validateSpec:l},r))}for(let p in i)n[p]||i[p].required&&i[p].default===void 0&&r[p]===void 0&&u.push(new _r(e,r,'missing required property "'.concat(p,'"')));return u}s(gc,"validateObject");function lP(t){let e=t.value,r=t.valueSpec,i=t.validateSpec,n=t.style,a=t.styleSpec,o=t.key,l=t.arrayElementValidator||i;if(wn(e)!=="array")return[new _r(o,e,"array expected, ".concat(wn(e)," found"))];if(r.length&&e.length!==r.length)return[new _r(o,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new _r(o,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let u={type:r.value,values:r.values};a.$version<7&&(u.function=r.function),wn(r.value)==="object"&&(u=r.value);let c=[];for(let p=0;p<e.length;p++)c=c.concat(l({array:e,arrayIndex:p,value:e[p],valueSpec:u,validateSpec:t.validateSpec,style:n,styleSpec:a,key:"".concat(o,"[").concat(p,"]")}));return c}s(lP,"validateArray");function uP(t){let e=t.key,r=t.value,i=t.valueSpec,n=wn(r);return n==="number"&&r!==r&&(n="NaN"),n!=="number"?[new _r(e,r,"number expected, ".concat(n," found"))]:"minimum"in i&&r<i.minimum?[new _r(e,r,"".concat(r," is less than the minimum value ").concat(i.minimum))]:"maximum"in i&&r>i.maximum?[new _r(e,r,"".concat(r," is greater than the maximum value ").concat(i.maximum))]:[]}s(uP,"validateNumber");function i7(t){let e=t.valueSpec,r=fo(t.value.type),i,n={},a,o,l=r!=="categorical"&&t.value.property===void 0,u=!l,c=wn(t.value.stops)==="array"&&wn(t.value.stops[0])==="array"&&wn(t.value.stops[0][0])==="object",p=gc({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:m,default:x}});return r==="identity"&&l&&p.push(new _r(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&p.push(new _r(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!aP(t.valueSpec)&&p.push(new _r(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!$y(t.valueSpec)?p.push(new _r(t.key,t.value,"property functions not supported")):l&&!K9(t.valueSpec)&&p.push(new _r(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||c)&&t.value.property===void 0&&p.push(new _r(t.key,t.value,'"property" property is required')),p;function m(E){if(r==="identity")return[new _r(E.key,E.value,'identity function may not have a "stops" property')];let M=[],I=E.value;return M=M.concat(lP({key:E.key,value:I,valueSpec:E.valueSpec,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec,arrayElementValidator:y})),wn(I)==="array"&&I.length===0&&M.push(new _r(E.key,I,"array must have at least one stop")),M}function y(E){let M=[],I=E.value,P=E.key;if(wn(I)!=="array")return[new _r(P,I,"array expected, ".concat(wn(I)," found"))];if(I.length!==2)return[new _r(P,I,"array length 2 expected, length ".concat(I.length," found"))];if(c){if(wn(I[0])!=="object")return[new _r(P,I,"object expected, ".concat(wn(I[0])," found"))];if(I[0].zoom===void 0)return[new _r(P,I,"object stop key must have zoom")];if(I[0].value===void 0)return[new _r(P,I,"object stop key must have value")];if(o&&o>fo(I[0].zoom))return[new _r(P,I[0].zoom,"stop zoom values must appear in ascending order")];fo(I[0].zoom)!==o&&(o=fo(I[0].zoom),a=void 0,n={}),M=M.concat(gc({key:"".concat(P,"[0]"),value:I[0],valueSpec:{zoom:{}},validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{zoom:uP,value:v}}))}else M=M.concat(v({key:"".concat(P,"[0]"),value:I[0],validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec},I));return nx(Zm(I[1]))?M.concat([new _r("".concat(P,"[1]"),I[1],"expressions are not allowed in function stops.")]):M.concat(E.validateSpec({key:"".concat(P,"[1]"),value:I[1],valueSpec:e,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec}))}function v(E,M){let I=wn(E.value),P=fo(E.value),C=E.value!==null?E.value:M;if(!i)i=I;else if(I!==i)return[new _r(E.key,C,"".concat(I," stop domain type must match previous stop domain type ").concat(i))];if(I!=="number"&&I!=="string"&&I!=="boolean")return[new _r(E.key,C,"stop domain value must be a number, string, or boolean")];if(I!=="number"&&r!=="categorical"){let T="number expected, ".concat(I," found");return $y(e)&&r===void 0&&(T+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _r(E.key,C,T)]}return r==="categorical"&&I==="number"&&(!isFinite(P)||Math.floor(P)!==P)?[new _r(E.key,C,"integer expected, found ".concat(P))]:r!=="categorical"&&I==="number"&&a!==void 0&&P<a?[new _r(E.key,C,"stop domain values must appear in ascending order")]:(a=P,r==="categorical"&&P in n?[new _r(E.key,C,"stop domain values must be unique")]:(n[P]=!0,[]))}function x(E){return E.validateSpec({key:E.key,value:E.value,valueSpec:e,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec})}}s(i7,"validateFunction");function Gy(t){let e=(t.expressionContext==="property"?e7:oP)(Zm(t.value),t.valueSpec);if(e.result==="error")return e.value.map(i=>new _r("".concat(t.key).concat(i.key),t.value,i.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new _r(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!y_(r))return[new _r(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!y_(r))return[new _r(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!bA(r,["zoom","feature-state"]))return[new _r(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!xA(r))return[new _r(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}s(Gy,"validateExpression");function oJ(t){let e=t.value,r=t.key,i=wn(e);return i!=="boolean"?[new _r(r,e,"boolean expected, ".concat(i," found"))]:[]}s(oJ,"validateBoolean");function sJ(t){let e=t.key,r=t.value,i=wn(r);return i!=="string"?[new _r(e,r,"color expected, ".concat(i," found"))]:Pi.parse(String(r))?[]:[new _r(e,r,'color expected, "'.concat(r,'" found'))]}s(sJ,"validateColor");function v_(t){let e=t.key,r=t.value,i=t.valueSpec,n=[];return Array.isArray(i.values)?i.values.indexOf(fo(r))===-1&&n.push(new _r(e,r,"expected one of [".concat(i.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(i.values).indexOf(fo(r))===-1&&n.push(new _r(e,r,"expected one of [".concat(Object.keys(i.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),n}s(v_,"validateEnum");function cP(t){return sP(Zm(t.value))?Gy(jy({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):n7(t)}s(cP,"validateFilter");function n7(t){let e=t.value,r=t.key;if(wn(e)!=="array")return[new _r(r,e,"array expected, ".concat(wn(e)," found"))];let i=t.styleSpec,n,a=[];if(e.length<1)return[new _r(r,e,"filter array must have at least 1 element")];switch(a=a.concat(v_({key:"".concat(r,"[0]"),value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),fo(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&fo(e[1])==="$type"&&a.push(new _r(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&a.push(new _r(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(n=wn(e[1]),n!=="string"&&a.push(new _r("".concat(r,"[1]"),e[1],"string expected, ".concat(n," found"))));for(let o=2;o<e.length;o++)n=wn(e[o]),fo(e[1])==="$type"?a=a.concat(v_({key:"".concat(r,"[").concat(o,"]"),value:e[o],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):n!=="string"&&n!=="number"&&n!=="boolean"&&a.push(new _r("".concat(r,"[").concat(o,"]"),e[o],"string, number, or boolean expected, ".concat(n," found")));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)a=a.concat(n7({key:"".concat(r,"[").concat(o,"]"),value:e[o],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":n=wn(e[1]),e.length!==2?a.push(new _r(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):n!=="string"&&a.push(new _r("".concat(r,"[1]"),e[1],"string expected, ".concat(n," found")));break}return a}s(n7,"validateNonExpressionFilter");function a7(t,e){let r=t.key,i=t.validateSpec,n=t.style,a=t.styleSpec,o=t.value,l=t.objectKey,u=a["".concat(e,"_").concat(t.layerType)];if(!u)return[];let c=l.match(/^(.*)-transition$/);if(e==="paint"&&c&&u[c[1]]&&u[c[1]].transition)return i({key:r,value:o,valueSpec:a.transition,style:n,styleSpec:a});let p=t.valueSpec||u[l];if(!p)return[new _r(r,o,'unknown property "'.concat(l,'"'))];let m;if(wn(o)==="string"&&$y(p)&&!p.tokens&&(m=/^{([^}]+)}$/.exec(o)))return[new _r(r,o,'"'.concat(l,`" does not support interpolation syntax
`)+'Use an identity property function instead: `{ "type": "identity", "property": '.concat(JSON.stringify(m[1])," }`."))];let y=[];return t.layerType==="symbol"&&(l==="text-field"&&n&&!n.glyphs&&y.push(new _r(r,o,'use of "text-field" requires a style "glyphs" property')),l==="text-font"&&wA(Zm(o))&&fo(o.type)==="identity"&&y.push(new _r(r,o,'"text-font" does not support identity functions'))),y.concat(i({key:t.key,value:o,valueSpec:p,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:l}))}s(a7,"validateProperty");function o7(t){return a7(t,"paint")}s(o7,"validatePaintProperty");function s7(t){return a7(t,"layout")}s(s7,"validateLayoutProperty");function l7(t){let e=[],r=t.value,i=t.key,n=t.style,a=t.styleSpec;!r.type&&!r.ref&&e.push(new _r(i,r,'either "type" or "ref" is required'));let o=fo(r.type),l=fo(r.ref);if(r.id){let u=fo(r.id);for(let c=0;c<t.arrayIndex;c++){let p=n.layers[c];fo(p.id)===u&&e.push(new _r(i,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(p.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(c=>{c in r&&e.push(new _r(i,r[c],'"'.concat(c,'" is prohibited for ref layers')))});let u;n.layers.forEach(c=>{fo(c.id)===l&&(u=c)}),u?u.ref?e.push(new _r(i,r.ref,"ref cannot reference another ref layer")):o=fo(u.type):e.push(new _r(i,r.ref,'ref layer "'.concat(l,'" not found')))}else if(o!=="background")if(!r.source)e.push(new _r(i,r,'missing required property "source"'));else{let u=n.sources&&n.sources[r.source],c=u&&fo(u.type);u?c==="vector"&&o==="raster"?e.push(new _r(i,r.source,'layer "'.concat(r.id,'" requires a raster source'))):c!=="raster-dem"&&o==="hillshade"?e.push(new _r(i,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):c==="raster"&&o!=="raster"?e.push(new _r(i,r.source,'layer "'.concat(r.id,'" requires a vector source'))):c==="vector"&&!r["source-layer"]?e.push(new _r(i,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):c==="raster-dem"&&o!=="hillshade"?e.push(new _r(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):o==="line"&&r.paint&&r.paint["line-gradient"]&&(c!=="geojson"||!u.lineMetrics)&&e.push(new _r(i,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new _r(i,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(gc({key:i,value:r,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(i,".type"),value:r.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:cP,layout(u){return gc({layer:r,key:u.key,value:u.value,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*"(c){return s7(jy({layerType:o},c))}}})},paint(u){return gc({layer:r,key:u.key,value:u.value,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*"(c){return o7(jy({layerType:o},c))}}})}}})),e}s(l7,"validateLayer");function Ym(t){let e=t.value,r=t.key,i=wn(e);return i!=="string"?[new _r(r,e,"string expected, ".concat(i," found"))]:[]}s(Ym,"validateString");function lJ(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",i=t.value,n=t.styleSpec,a=n.source_raster_dem,o=t.style,l=[],u=wn(i);if(i===void 0)return l;if(u!=="object")return l.push(new _r("source_raster_dem",i,"object expected, ".concat(u," found"))),l;let c=fo(i.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],m=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let y in i)!c&&p.includes(y)?l.push(new _r(y,i[y],'In "'.concat(r,'": "').concat(y,'" is only valid when "encoding" is set to "custom". ').concat(m," encoding found"))):a[y]?l=l.concat(t.validateSpec({key:y,value:i[y],valueSpec:a[y],validateSpec:t.validateSpec,style:o,styleSpec:n})):l.push(new _r(y,i[y],'unknown property "'.concat(y,'"')));return l}s(lJ,"validateRasterDEMSource");var DH={promoteId:uJ};function u7(t){let e=t.value,r=t.key,i=t.styleSpec,n=t.style,a=t.validateSpec;if(!e.type)return[new _r(r,e,'"type" is required')];let o=fo(e.type),l;switch(o){case"vector":case"raster":return l=gc({key:r,value:e,valueSpec:i["source_".concat(o.replace("-","_"))],style:t.style,styleSpec:i,objectElementValidators:DH,validateSpec:a}),l;case"raster-dem":return l=lJ({sourceName:r,value:e,style:t.style,styleSpec:i,validateSpec:a}),l;case"geojson":if(l=gc({key:r,value:e,valueSpec:i.source_geojson,style:n,styleSpec:i,validateSpec:a,objectElementValidators:DH}),e.cluster)for(let u in e.clusterProperties){let[c,p]=e.clusterProperties[u],m=typeof c=="string"?[c,["accumulated"],["get",u]]:c;l.push(...Gy({key:"".concat(r,".").concat(u,".map"),value:p,expressionContext:"cluster-map"})),l.push(...Gy({key:"".concat(r,".").concat(u,".reduce"),value:m,expressionContext:"cluster-reduce"}))}return l;case"video":return gc({key:r,value:e,valueSpec:i.source_video,style:n,validateSpec:a,styleSpec:i});case"image":return gc({key:r,value:e,valueSpec:i.source_image,style:n,validateSpec:a,styleSpec:i});case"canvas":return[new _r(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return v_({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}s(u7,"validateSource");function uJ({key:t,value:e}){if(wn(e)==="string")return Ym({key:t,value:e});{let r=[];for(let i in e)r.push(...Ym({key:"".concat(t,".").concat(i),value:e[i]}));return r}}s(uJ,"validatePromoteId");function c7(t){let e=t.value,r=t.styleSpec,i=r.light,n=t.style,a=[],o=wn(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new _r("light",e,"object expected, ".concat(o," found"))]),a;for(let l in e){let u=l.match(/^(.*)-transition$/);u&&i[u[1]]&&i[u[1]].transition?a=a.concat(t.validateSpec({key:l,value:e[l],valueSpec:r.transition,validateSpec:t.validateSpec,style:n,styleSpec:r})):i[l]?a=a.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],validateSpec:t.validateSpec,style:n,styleSpec:r})):a=a.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))])}return a}s(c7,"validateLight");function h7(t){let e=t.value,r=t.styleSpec,i=r.sky,n=t.style,a=wn(e);if(e===void 0)return[];if(a!=="object")return[new _r("sky",e,"object expected, ".concat(a," found"))];let o=[];for(let l in e)i[l]?o=o.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],style:n,styleSpec:r})):o=o.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))]);return o}s(h7,"validateSky");function p7(t){let e=t.value,r=t.styleSpec,i=r.terrain,n=t.style,a=[],o=wn(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new _r("terrain",e,"object expected, ".concat(o," found"))]),a;for(let l in e)i[l]?a=a.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],validateSpec:t.validateSpec,style:n,styleSpec:r})):a=a.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))]);return a}s(p7,"validateTerrain");function cJ(t){return Ym(t).length===0?[]:Gy(t)}s(cJ,"validateFormatted");function hJ(t){return Ym(t).length===0?[]:Gy(t)}s(hJ,"validateImage");function pJ(t){let e=t.key,r=t.value;if(wn(r)==="array"){if(r.length<1||r.length>4)return[new _r(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},n=[];for(let a=0;a<r.length;a++)n=n.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return n}else return uP({key:e,value:r,valueSpec:{}})}s(pJ,"validatePadding");function dJ(t){let e=t.key,r=t.value,i=wn(r),n=t.styleSpec;if(i!=="array"||r.length<1||r.length%2!==0)return[new _r(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<r.length;o+=2)a=a.concat(v_({key:"".concat(e,"[").concat(o,"]"),value:r[o],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(lP({key:"".concat(e,"[").concat(o+1,"]"),value:r[o+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:n}));return a}s(dJ,"validateVariableAnchorOffsetCollection");function d7(t){let e=[],r=t.value,i=t.key;if(Array.isArray(r)){let n=[],a=[];for(let o in r){r[o].id&&n.includes(r[o].id)&&e.push(new _r(i,r,"all the sprites' ids must be unique, but ".concat(r[o].id," is duplicated"))),n.push(r[o].id),r[o].url&&a.includes(r[o].url)&&e.push(new _r(i,r,"all the sprites' URLs must be unique, but ".concat(r[o].url," is duplicated"))),a.push(r[o].url);let l={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(gc({key:"".concat(i,"[").concat(o,"]"),value:r[o],valueSpec:l,validateSpec:t.validateSpec}))}return e}else return Ym({key:i,value:r})}s(d7,"validateSprite");function fJ(t){let e=t.value,r=t.styleSpec,i=r.projection,n=t.style,a=wn(e);if(e===void 0)return[];if(a!=="object")return[new _r("projection",e,"object expected, ".concat(a," found"))];let o=[];for(let l in e)i[l]?o=o.concat(t.validateSpec({key:l,value:e[l],valueSpec:i[l],style:n,styleSpec:r})):o=o.concat([new _r(l,e[l],'unknown property "'.concat(l,'"'))]);return o}s(fJ,"validateProjection");var RH={"*"(){return[]},array:lP,boolean:oJ,number:uP,color:sJ,constants:r7,enum:v_,filter:cP,function:i7,layer:l7,object:gc,source:u7,light:c7,sky:h7,terrain:p7,projection:fJ,string:Ym,formatted:cJ,resolvedImage:hJ,padding:pJ,variableAnchorOffsetCollection:dJ,sprite:d7};function ww(t){let e=t.value,r=t.valueSpec,i=t.styleSpec;return t.validateSpec=ww,r.expression&&wA(fo(e))?i7(t):r.expression&&nx(Zm(e))?Gy(t):r.type&&RH[r.type]?RH[r.type](t):gc(jy({},t,{valueSpec:r.type?i[r.type]:r}))}s(ww,"validate");function f7(t){let e=t.value,r=t.key,i=Ym(t);return i.length||(e.indexOf("{fontstack}")===-1&&i.push(new _r(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&i.push(new _r(r,e,'"glyphs" url must include a "{range}" token'))),i}s(f7,"validateGlyphsUrl");function ah(t,e=Ut){let r=[];return r=r.concat(ww({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:ww,objectElementValidators:{glyphs:f7,"*"(){return[]}}})),t.constants&&(r=r.concat(r7({key:"constants",value:t.constants}))),m7(r)}s(ah,"validateStyleMin");ah.source=Yh(Zh(u7));ah.sprite=Yh(Zh(d7));ah.glyphs=Yh(Zh(f7));ah.light=Yh(Zh(c7));ah.sky=Yh(Zh(h7));ah.terrain=Yh(Zh(p7));ah.layer=Yh(Zh(l7));ah.filter=Yh(Zh(cP));ah.paintProperty=Yh(Zh(o7));ah.layoutProperty=Yh(Zh(s7));function Zh(t){return function(e){return t(vt(Ee({},e),{validateSpec:ww}))}}s(Zh,"injectValidateSpec");function m7(t){return[].concat(t).sort((e,r)=>e.line-r.line)}s(m7,"sortErrors");function Yh(t){return function(...e){return m7(t.apply(this,e))}}s(Yh,"wrapCleanErrors");N();var Ss=ah;Ss.source;var kke=Ss.light;Ss.terrain;Ss.filter;var Nke=Ss.paintProperty,Fke=Ss.layoutProperty;function hP(t,e){let r=!1;if(e&&e.length)for(let i of e)t.fire(new di(new Error(i.message))),r=!0;return r}s(hP,"emitValidationErrors");N();N();N();var mJ=class gJ{constructor(e,r,i){let n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let o=new Int32Array(this.arrayBuffer);e=o[0],r=o[1],i=o[2],this.d=r+2*i;for(let c=0;c<this.d*this.d;c++){let p=o[3+c],m=o[3+c+1];n.push(p===m?null:o.subarray(p,m))}let l=o[3+n.length],u=o[3+n.length+1];this.keys=o.subarray(l,u),this.bboxes=o.subarray(u),this.insert=this._insertReadonly}else{this.d=r+2*i;for(let o=0;o<this.d*this.d;o++)n.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=i,this.scale=r/e,this.uid=0;let a=i/r*e;this.min=-a,this.max=e+a}insert(e,r,i,n,a){this._forEachCell(r,i,n,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(a)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,i,n,a,o){this.cells[a].push(o)}query(e,r,i,n,a){let o=this.min,l=this.max;if(e<=o&&r<=o&&l<=i&&l<=n&&!a)return Array.prototype.slice.call(this.keys);{let u=[],c={};return this._forEachCell(e,r,i,n,this._queryCell,u,c,a),u}}_queryCell(e,r,i,n,a,o,l,u){let c=this.cells[a];if(c!==null){let p=this.keys,m=this.bboxes;for(let y=0;y<c.length;y++){let v=c[y];if(l[v]===void 0){let x=v*4;(u?u(m[x+0],m[x+1],m[x+2],m[x+3]):e<=m[x+2]&&r<=m[x+3]&&i>=m[x+0]&&n>=m[x+1])?(l[v]=!0,o.push(p[v])):l[v]=!1}}}}_forEachCell(e,r,i,n,a,o,l,u){let c=this._convertToCellCoord(e),p=this._convertToCellCoord(r),m=this._convertToCellCoord(i),y=this._convertToCellCoord(n);for(let v=c;v<=m;v++)for(let x=p;x<=y;x++){let E=this.d*x+v;if(!(u&&!u(this._convertFromCellCoord(v),this._convertFromCellCoord(x),this._convertFromCellCoord(v+1),this._convertFromCellCoord(x+1)))&&a.call(this,e,r,i,n,E,o,l,u))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,i=0;for(let o=0;o<this.cells.length;o++)i+=this.cells[o].length;let n=new Int32Array(r+i+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let a=r;for(let o=0;o<e.length;o++){let l=e[o];n[3+o]=a,n.set(l,a),a+=l.length}return n[3+e.length]=a,n.set(this.keys,a),a+=this.keys.length,n[3+e.length+1]=a,n.set(this.bboxes,a),a+=this.bboxes.length,n.buffer}static serialize(e,r){let i=e.toArrayBuffer();return r&&r.push(i),{buffer:i}}static deserialize(e){return new gJ(e.buffer)}};s(mJ,"TransferableGridIndex");var C6=mJ,Gm={};function Lr(t,e,r={}){if(Gm[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Gm[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}s(Lr,"register");Lr("Object",Object);Lr("TransferableGridIndex",C6);Lr("Color",Pi);Lr("Error",Error);Lr("AJAXError",I9);Lr("ResolvedImage",Kp);Lr("StylePropertyFunction",QK);Lr("StyleExpression",Q9,{omit:["_evaluator"]});Lr("ZoomDependentExpression",MT);Lr("ZoomConstantExpression",ST);Lr("CompoundExpression",uv,{omit:["_evaluate"]});for(let t in Z1)Z1[t]._classRegistryKey||Lr("Expression_".concat(t),Z1[t]);function g7(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}s(g7,"isArrayBuffer");function Y1(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(g7(t)||Gp(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){let r=t;return e&&e.push(r.buffer),r}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){let r=[];for(let i of t)r.push(Y1(i,e));return r}if(typeof t=="object"){let r=t.constructor,i=r._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class ".concat(r.name));if(!Gm[i])throw new Error("".concat(i," is not registered."));let n=r.serialize?r.serialize(t,e):{};if(r.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let a in t){if(!t.hasOwnProperty(a)||Gm[i].omit.indexOf(a)>=0)continue;let o=t[a];n[a]=Gm[i].shallow.indexOf(a)>=0?o:Y1(o,e)}t instanceof Error&&(n.message=t.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(n.$name=i),n}throw new Error("can't serialize object of type ".concat(typeof t))}s(Y1,"serialize");function K1(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||g7(t)||Gp(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(K1);if(typeof t=="object"){let e=t.$name||"Object";if(!Gm[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=Gm[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let i=Object.create(r.prototype);for(let n of Object.keys(t)){if(n==="$name")continue;let a=t[n];i[n]=Gm[e].shallow.indexOf(n)>=0?a:K1(a)}return i}throw new Error("can't deserialize object of type ".concat(typeof t))}s(K1,"deserialize");N();N();var yJ=class{constructor(){this.first=!0}update(e,r){let i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=i,!0):!1)}};s(yJ,"ZoomHistory");var vJ=yJ;N();N();var mn={"Latin-1 Supplement":s(t=>t>=128&&t<=255,"Latin-1 Supplement"),Arabic:s(t=>t>=1536&&t<=1791,"Arabic"),"Arabic Supplement":s(t=>t>=1872&&t<=1919,"Arabic Supplement"),"Arabic Extended-A":s(t=>t>=2208&&t<=2303,"Arabic Extended-A"),"Hangul Jamo":s(t=>t>=4352&&t<=4607,"Hangul Jamo"),"Unified Canadian Aboriginal Syllabics":s(t=>t>=5120&&t<=5759,"Unified Canadian Aboriginal Syllabics"),Khmer:s(t=>t>=6016&&t<=6143,"Khmer"),"Unified Canadian Aboriginal Syllabics Extended":s(t=>t>=6320&&t<=6399,"Unified Canadian Aboriginal Syllabics Extended"),"General Punctuation":s(t=>t>=8192&&t<=8303,"General Punctuation"),"Letterlike Symbols":s(t=>t>=8448&&t<=8527,"Letterlike Symbols"),"Number Forms":s(t=>t>=8528&&t<=8591,"Number Forms"),"Miscellaneous Technical":s(t=>t>=8960&&t<=9215,"Miscellaneous Technical"),"Control Pictures":s(t=>t>=9216&&t<=9279,"Control Pictures"),"Optical Character Recognition":s(t=>t>=9280&&t<=9311,"Optical Character Recognition"),"Enclosed Alphanumerics":s(t=>t>=9312&&t<=9471,"Enclosed Alphanumerics"),"Geometric Shapes":s(t=>t>=9632&&t<=9727,"Geometric Shapes"),"Miscellaneous Symbols":s(t=>t>=9728&&t<=9983,"Miscellaneous Symbols"),"Miscellaneous Symbols and Arrows":s(t=>t>=11008&&t<=11263,"Miscellaneous Symbols and Arrows"),"CJK Radicals Supplement":s(t=>t>=11904&&t<=12031,"CJK Radicals Supplement"),"Kangxi Radicals":s(t=>t>=12032&&t<=12255,"Kangxi Radicals"),"Ideographic Description Characters":s(t=>t>=12272&&t<=12287,"Ideographic Description Characters"),"CJK Symbols and Punctuation":s(t=>t>=12288&&t<=12351,"CJK Symbols and Punctuation"),Hiragana:s(t=>t>=12352&&t<=12447,"Hiragana"),Katakana:s(t=>t>=12448&&t<=12543,"Katakana"),Bopomofo:s(t=>t>=12544&&t<=12591,"Bopomofo"),"Hangul Compatibility Jamo":s(t=>t>=12592&&t<=12687,"Hangul Compatibility Jamo"),Kanbun:s(t=>t>=12688&&t<=12703,"Kanbun"),"Bopomofo Extended":s(t=>t>=12704&&t<=12735,"Bopomofo Extended"),"CJK Strokes":s(t=>t>=12736&&t<=12783,"CJK Strokes"),"Katakana Phonetic Extensions":s(t=>t>=12784&&t<=12799,"Katakana Phonetic Extensions"),"Enclosed CJK Letters and Months":s(t=>t>=12800&&t<=13055,"Enclosed CJK Letters and Months"),"CJK Compatibility":s(t=>t>=13056&&t<=13311,"CJK Compatibility"),"CJK Unified Ideographs Extension A":s(t=>t>=13312&&t<=19903,"CJK Unified Ideographs Extension A"),"Yijing Hexagram Symbols":s(t=>t>=19904&&t<=19967,"Yijing Hexagram Symbols"),"CJK Unified Ideographs":s(t=>t>=19968&&t<=40959,"CJK Unified Ideographs"),"Yi Syllables":s(t=>t>=40960&&t<=42127,"Yi Syllables"),"Yi Radicals":s(t=>t>=42128&&t<=42191,"Yi Radicals"),"Hangul Jamo Extended-A":s(t=>t>=43360&&t<=43391,"Hangul Jamo Extended-A"),"Hangul Syllables":s(t=>t>=44032&&t<=55215,"Hangul Syllables"),"Hangul Jamo Extended-B":s(t=>t>=55216&&t<=55295,"Hangul Jamo Extended-B"),"Private Use Area":s(t=>t>=57344&&t<=63743,"Private Use Area"),"CJK Compatibility Ideographs":s(t=>t>=63744&&t<=64255,"CJK Compatibility Ideographs"),"Arabic Presentation Forms-A":s(t=>t>=64336&&t<=65023,"Arabic Presentation Forms-A"),"Vertical Forms":s(t=>t>=65040&&t<=65055,"Vertical Forms"),"CJK Compatibility Forms":s(t=>t>=65072&&t<=65103,"CJK Compatibility Forms"),"Small Form Variants":s(t=>t>=65104&&t<=65135,"Small Form Variants"),"Arabic Presentation Forms-B":s(t=>t>=65136&&t<=65279,"Arabic Presentation Forms-B"),"Halfwidth and Fullwidth Forms":s(t=>t>=65280&&t<=65519,"Halfwidth and Fullwidth Forms")};function _J(t){for(let e of t)if(xJ(e.charCodeAt(0)))return!0;return!1}s(_J,"allowsVerticalWritingMode");function xJ(t){return t===746||t===747?!0:t<4352?!1:!!(mn["Bopomofo Extended"](t)||mn.Bopomofo(t)||mn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||mn["CJK Compatibility Ideographs"](t)||mn["CJK Compatibility"](t)||mn["CJK Radicals Supplement"](t)||mn["CJK Strokes"](t)||mn["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||mn["CJK Unified Ideographs Extension A"](t)||mn["CJK Unified Ideographs"](t)||mn["Enclosed CJK Letters and Months"](t)||mn["Hangul Compatibility Jamo"](t)||mn["Hangul Jamo Extended-A"](t)||mn["Hangul Jamo Extended-B"](t)||mn["Hangul Jamo"](t)||mn["Hangul Syllables"](t)||mn.Hiragana(t)||mn["Ideographic Description Characters"](t)||mn.Kanbun(t)||mn["Kangxi Radicals"](t)||mn["Katakana Phonetic Extensions"](t)||mn.Katakana(t)&&t!==12540||mn["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||mn["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||mn["Unified Canadian Aboriginal Syllabics"](t)||mn["Unified Canadian Aboriginal Syllabics Extended"](t)||mn["Vertical Forms"](t)||mn["Yijing Hexagram Symbols"](t)||mn["Yi Syllables"](t)||mn["Yi Radicals"](t))}s(xJ,"charHasUprightVerticalOrientation");function y7(t){return t>=1424&&t<=2303||mn["Arabic Presentation Forms-A"](t)||mn["Arabic Presentation Forms-B"](t)}s(y7,"charInRTLScript");function bJ(t,e){return!(!e&&y7(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||mn.Khmer(t))}s(bJ,"charInSupportedScript");function wJ(t){for(let e of t)if(y7(e.charCodeAt(0)))return!0;return!1}s(wJ,"stringContainsRTLText");function AJ(t,e){for(let r of t)if(!bJ(r.charCodeAt(0),e))return!1;return!0}s(AJ,"isStringInSupportedScript");N();var SJ=class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};s(SJ,"RTLWorkerPlugin");var Bke=SJ,Aw=new Bke,MJ=class{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vJ,this.transition={})}isSupportedScript(e){return AJ(e,Aw.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*r}}};s(MJ,"EvaluationParameters");var ds=MJ,EJ=class{constructor(e,r){this.property=e,this.value=r,this.expression=eJ(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,i){return this.property.possiblyEvaluate(this,e,r,i)}};s(EJ,"PropertyValue");var pP=EJ,CJ=class{constructor(e){this.property=e,this.value=new pP(e,void 0)}transitioned(e,r){return new OH(this.property,this.value,r,Fr({},e.transition,this.transition),e.now)}untransitioned(){return new OH(this.property,this.value,null,{},0)}};s(CJ,"TransitionablePropertyValue");var I6=CJ,IJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return mc(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new I6(this._values[e].property)),this._values[e].value=new pP(this._values[e].property,r===null?void 0:mc(r))}getTransition(e){return mc(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new I6(this._values[e].property)),this._values[e].transition=mc(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let i=this.getValue(r);i!==void 0&&(e[r]=i);let n=this.getTransition(r);n!==void 0&&(e["".concat(r,"-transition")]=n)}return e}transitioned(e,r){let i=new kH(this._properties);for(let n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(e,r._values[n]);return i}untransitioned(){let e=new kH(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}};s(IJ,"Transitionable");var TJ=IJ,PJ=class{constructor(e,r,i,n,a){this.property=e,this.value=r,this.begin=a+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(e,r,i){let n=e.now||0,a=this.value.possiblyEvaluate(e,r,i),o=this.prior;if(o){if(n>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(n<this.begin)return o.possiblyEvaluate(e,r,i);{let l=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,r,i),a,iZ(l))}}else return a}};s(PJ,"TransitioningPropertyValue");var OH=PJ,LJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,i){let n=new dP(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,r,i);return n}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}};s(LJ,"Transitioning");var kH=LJ,DJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return mc(this._values[e].value)}setValue(e,r){this._values[e]=new pP(this._values[e].property,r===null?void 0:mc(r))}serialize(){let e={};for(let r of Object.keys(this._values)){let i=this.getValue(r);i!==void 0&&(e[r]=i)}return e}possiblyEvaluate(e,r,i){let n=new dP(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,r,i);return n}};s(DJ,"Layout");var zke=DJ,RJ=class{constructor(e,r,i){this.property=e,this.value=r,this.parameters=i}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,i,n){return this.property.evaluate(this.value,this.parameters,e,r,i,n)}};s(RJ,"PossiblyEvaluatedPropertyValue");var Fh=RJ,OJ=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}};s(OJ,"PossiblyEvaluated");var dP=OJ,kJ=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,i){let n=this.specification.type,a=Ya[n];return a?a(e,r,i):e}};s(kJ,"DataConstantProperty");var Hr=kJ,NJ=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,i,n){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Fh(this,{kind:"constant",value:e.expression.evaluate(r,null,{},i,n)},r):new Fh(this,e.expression,r)}interpolate(e,r,i){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Fh(this,{kind:"constant",value:void 0},e.parameters);let n=this.specification.type,a=Ya[n];if(a){let o=a(e.value.value,r.value.value,i);return new Fh(this,{kind:"constant",value:o},e.parameters)}else return e}evaluate(e,r,i,n,a,o){return e.kind==="constant"?e.value:e.evaluate(r,i,n,a,o)}};s(NJ,"DataDrivenProperty");var pi=NJ,FJ=class extends pi{possiblyEvaluate(e,r,i,n){if(e.value===void 0)return new Fh(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){let a=e.expression.evaluate(r,null,{},i,n),o=e.property.specification.type==="resolvedImage"&&typeof a!="string"?a.name:a,l=this._calculate(o,o,o,r);return new Fh(this,{kind:"constant",value:l},r)}else if(e.expression.kind==="camera"){let a=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new Fh(this,{kind:"constant",value:a},r)}else return new Fh(this,e.expression,r)}evaluate(e,r,i,n,a,o){if(e.kind==="source"){let l=e.evaluate(r,i,n,a,o);return this._calculate(l,l,l,r)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},i,n),e.evaluate({zoom:Math.floor(r.zoom)},i,n),e.evaluate({zoom:Math.floor(r.zoom)+1},i,n),r):e.value}_calculate(e,r,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:i,to:r}}interpolate(e){return e}};s(FJ,"CrossFadedDataDrivenProperty");var fP=FJ,BJ=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,i,n){if(e.value!==void 0)if(e.expression.kind==="constant"){let a=e.expression.evaluate(r,null,{},i,n);return this._calculate(a,a,a,r)}else return this._calculate(e.expression.evaluate(new ds(Math.floor(r.zoom-1),r)),e.expression.evaluate(new ds(Math.floor(r.zoom),r)),e.expression.evaluate(new ds(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:i,to:r}}interpolate(e){return e}};s(BJ,"CrossFadedProperty");var v7=BJ,zJ=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,i,n){return!!e.expression.evaluate(r,null,{},i,n)}interpolate(){return!1}};s(zJ,"ColorRampProperty");var _7=zJ,UJ=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let i=e[r];i.specification.overridable&&this.overridableProperties.push(r);let n=this.defaultPropertyValues[r]=new pP(i,void 0),a=this.defaultTransitionablePropertyValues[r]=new I6(i);this.defaultTransitioningPropertyValues[r]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=n.possiblyEvaluate({})}}};s(UJ,"Properties");var $u=UJ;Lr("DataDrivenProperty",pi);Lr("DataConstantProperty",Hr);Lr("CrossFadedDataDrivenProperty",fP);Lr("CrossFadedProperty",v7);Lr("ColorRampProperty",_7);var wM="-transition",VJ=class extends Nl{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:s(()=>!0,"filter"),needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new zke(r.layout)),r.paint)){this._transitionablePaint=new TJ(r.paint);for(let i in e.paint)this.setPaintProperty(i,e.paint[i],{validate:!1});for(let i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new dP(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,i={}){if(r!=null){let n="layers.".concat(this.id,".layout.").concat(e);if(this._validate(Fke,n,e,r,i))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(wM)?this._transitionablePaint.getTransition(e.slice(0,-wM.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,i={}){if(r!=null){let n="layers.".concat(this.id,".paint.").concat(e);if(this._validate(Nke,n,e,r,i))return!1}if(e.endsWith(wM))return this._transitionablePaint.setTransition(e.slice(0,-wM.length),r||void 0),!1;{let n=this._transitionablePaint._values[e],a=n.property.specification["property-type"]==="cross-faded-data-driven",o=n.value.isDataDriven(),l=n.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let u=this._transitionablePaint._values[e].value;return u.isDataDriven()||o||a||this._handleOverridablePaintPropertyUpdate(e,l,u)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,i){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),E9(e,(r,i)=>r!==void 0&&!(i==="layout"&&!Object.keys(r).length)&&!(i==="paint"&&!Object.keys(r).length))}_validate(e,r,i,n,a={}){return a&&a.validate===!1?!1:hP(this,e.call(Ss,{key:r,layerType:this.type,objectKey:i,value:n,styleSpec:Ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof Fh)||!$y(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};s(VJ,"StyleLayer");var id=VJ;N();N();N();var Uke={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},jJ=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}};s(jJ,"Struct");var AA=jJ,Vke=128,jke=5,$J=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*jke),Vke),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};s($J,"StructArray");var yo=$J;function no(t,e=1){let r=0,i=0,n=t.map(o=>{let l=GJ(o.type),u=r=T6(r,Math.max(e,l)),c=o.components||1;return i=Math.max(i,l),r+=l*c,{name:o.name,type:o.type,components:c,offset:u}}),a=T6(r,Math.max(i,e));return{members:n,size:a,alignment:e}}s(no,"createLayout");function GJ(t){return Uke[t].BYTES_PER_ELEMENT}s(GJ,"sizeOf");function T6(t,e){return Math.ceil(t/e)*e}s(T6,"align");var $ke=Rr(kn(),1),HJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){let n=e*2;return this.int16[n+0]=r,this.int16[n+1]=i,e}};s(HJ,"StructArrayLayout2i4");var SA=HJ;SA.prototype.bytesPerElement=4;Lr("StructArrayLayout2i4",SA);var qJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*3;return this.int16[a+0]=r,this.int16[a+1]=i,this.int16[a+2]=n,e}};s(qJ,"StructArrayLayout3i6");var mP=qJ;mP.prototype.bytesPerElement=6;Lr("StructArrayLayout3i6",mP);var WJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,i,n)}emplace(e,r,i,n,a){let o=e*4;return this.int16[o+0]=r,this.int16[o+1]=i,this.int16[o+2]=n,this.int16[o+3]=a,e}};s(WJ,"StructArrayLayout4i8");var x7=WJ;x7.prototype.bytesPerElement=8;Lr("StructArrayLayout4i8",x7);var XJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o){let l=this.length;return this.resize(l+1),this.emplace(l,e,r,i,n,a,o)}emplace(e,r,i,n,a,o,l){let u=e*6;return this.int16[u+0]=r,this.int16[u+1]=i,this.int16[u+2]=n,this.int16[u+3]=a,this.int16[u+4]=o,this.int16[u+5]=l,e}};s(XJ,"StructArrayLayout2i4i12");var b7=XJ;b7.prototype.bytesPerElement=12;Lr("StructArrayLayout2i4i12",b7);var ZJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o){let l=this.length;return this.resize(l+1),this.emplace(l,e,r,i,n,a,o)}emplace(e,r,i,n,a,o,l){let u=e*4,c=e*8;return this.int16[u+0]=r,this.int16[u+1]=i,this.uint8[c+4]=n,this.uint8[c+5]=a,this.uint8[c+6]=o,this.uint8[c+7]=l,e}};s(ZJ,"StructArrayLayout2i4ub8");var w7=ZJ;w7.prototype.bytesPerElement=8;Lr("StructArrayLayout2i4ub8",w7);var YJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){let n=e*2;return this.float32[n+0]=r,this.float32[n+1]=i,e}};s(YJ,"StructArrayLayout2f8");var Sw=YJ;Sw.prototype.bytesPerElement=8;Lr("StructArrayLayout2f8",Sw);var KJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p){let m=this.length;return this.resize(m+1),this.emplace(m,e,r,i,n,a,o,l,u,c,p)}emplace(e,r,i,n,a,o,l,u,c,p,m){let y=e*10;return this.uint16[y+0]=r,this.uint16[y+1]=i,this.uint16[y+2]=n,this.uint16[y+3]=a,this.uint16[y+4]=o,this.uint16[y+5]=l,this.uint16[y+6]=u,this.uint16[y+7]=c,this.uint16[y+8]=p,this.uint16[y+9]=m,e}};s(KJ,"StructArrayLayout10ui20");var A7=KJ;A7.prototype.bytesPerElement=20;Lr("StructArrayLayout10ui20",A7);var JJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p,m,y){let v=this.length;return this.resize(v+1),this.emplace(v,e,r,i,n,a,o,l,u,c,p,m,y)}emplace(e,r,i,n,a,o,l,u,c,p,m,y,v){let x=e*12;return this.int16[x+0]=r,this.int16[x+1]=i,this.int16[x+2]=n,this.int16[x+3]=a,this.uint16[x+4]=o,this.uint16[x+5]=l,this.uint16[x+6]=u,this.uint16[x+7]=c,this.int16[x+8]=p,this.int16[x+9]=m,this.int16[x+10]=y,this.int16[x+11]=v,e}};s(JJ,"StructArrayLayout4i4ui4i24");var S7=JJ;S7.prototype.bytesPerElement=24;Lr("StructArrayLayout4i4ui4i24",S7);var QJ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*3;return this.float32[a+0]=r,this.float32[a+1]=i,this.float32[a+2]=n,e}};s(QJ,"StructArrayLayout3f12");var M7=QJ;M7.prototype.bytesPerElement=12;Lr("StructArrayLayout3f12",M7);var eQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let i=e*1;return this.uint32[i+0]=r,e}};s(eQ,"StructArrayLayout1ul4");var E7=eQ;E7.prototype.bytesPerElement=4;Lr("StructArrayLayout1ul4",E7);var tQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,i,n,a,o,l,u,c)}emplace(e,r,i,n,a,o,l,u,c,p){let m=e*10,y=e*5;return this.int16[m+0]=r,this.int16[m+1]=i,this.int16[m+2]=n,this.int16[m+3]=a,this.int16[m+4]=o,this.int16[m+5]=l,this.uint32[y+3]=u,this.uint16[m+8]=c,this.uint16[m+9]=p,e}};s(tQ,"StructArrayLayout6i1ul2ui20");var C7=tQ;C7.prototype.bytesPerElement=20;Lr("StructArrayLayout6i1ul2ui20",C7);var rQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o){let l=this.length;return this.resize(l+1),this.emplace(l,e,r,i,n,a,o)}emplace(e,r,i,n,a,o,l){let u=e*6;return this.int16[u+0]=r,this.int16[u+1]=i,this.int16[u+2]=n,this.int16[u+3]=a,this.int16[u+4]=o,this.int16[u+5]=l,e}};s(rQ,"StructArrayLayout2i2i2i12");var I7=rQ;I7.prototype.bytesPerElement=12;Lr("StructArrayLayout2i2i2i12",I7);var iQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,i,n,a)}emplace(e,r,i,n,a,o){let l=e*4,u=e*8;return this.float32[l+0]=r,this.float32[l+1]=i,this.float32[l+2]=n,this.int16[u+6]=a,this.int16[u+7]=o,e}};s(iQ,"StructArrayLayout2f1f2i16");var T7=iQ;T7.prototype.bytesPerElement=16;Lr("StructArrayLayout2f1f2i16",T7);var nQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,i,n)}emplace(e,r,i,n,a){let o=e*12,l=e*3;return this.uint8[o+0]=r,this.uint8[o+1]=i,this.float32[l+1]=n,this.float32[l+2]=a,e}};s(nQ,"StructArrayLayout2ub2f12");var P7=nQ;P7.prototype.bytesPerElement=12;Lr("StructArrayLayout2ub2f12",P7);var aQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*3;return this.uint16[a+0]=r,this.uint16[a+1]=i,this.uint16[a+2]=n,e}};s(aQ,"StructArrayLayout3ui6");var gP=aQ;gP.prototype.bytesPerElement=6;Lr("StructArrayLayout3ui6",gP);var oQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I){let P=this.length;return this.resize(P+1),this.emplace(P,e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I)}emplace(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P){let C=e*24,T=e*12,D=e*48;return this.int16[C+0]=r,this.int16[C+1]=i,this.uint16[C+2]=n,this.uint16[C+3]=a,this.uint32[T+2]=o,this.uint32[T+3]=l,this.uint32[T+4]=u,this.uint16[C+10]=c,this.uint16[C+11]=p,this.uint16[C+12]=m,this.float32[T+7]=y,this.float32[T+8]=v,this.uint8[D+36]=x,this.uint8[D+37]=E,this.uint8[D+38]=M,this.uint32[T+10]=I,this.int16[C+22]=P,e}};s(oQ,"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48");var L7=oQ;L7.prototype.bytesPerElement=48;Lr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",L7);var sQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T,D,F,k,B,U,z,q,Z){let Q=this.length;return this.resize(Q+1),this.emplace(Q,e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T,D,F,k,B,U,z,q,Z)}emplace(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T,D,F,k,B,U,z,q,Z,Q){let V=e*32,ae=e*16;return this.int16[V+0]=r,this.int16[V+1]=i,this.int16[V+2]=n,this.int16[V+3]=a,this.int16[V+4]=o,this.int16[V+5]=l,this.int16[V+6]=u,this.int16[V+7]=c,this.uint16[V+8]=p,this.uint16[V+9]=m,this.uint16[V+10]=y,this.uint16[V+11]=v,this.uint16[V+12]=x,this.uint16[V+13]=E,this.uint16[V+14]=M,this.uint16[V+15]=I,this.uint16[V+16]=P,this.uint16[V+17]=C,this.uint16[V+18]=T,this.uint16[V+19]=D,this.uint16[V+20]=F,this.uint16[V+21]=k,this.uint16[V+22]=B,this.uint32[ae+12]=U,this.float32[ae+13]=z,this.float32[ae+14]=q,this.uint16[V+30]=Z,this.uint16[V+31]=Q,e}};s(sQ,"StructArrayLayout8i15ui1ul2f2ui64");var D7=sQ;D7.prototype.bytesPerElement=64;Lr("StructArrayLayout8i15ui1ul2f2ui64",D7);var lQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let i=e*1;return this.float32[i+0]=r,e}};s(lQ,"StructArrayLayout1f4");var yP=lQ;yP.prototype.bytesPerElement=4;Lr("StructArrayLayout1f4",yP);var uQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*6,o=e*3;return this.uint16[a+0]=r,this.float32[o+1]=i,this.float32[o+2]=n,e}};s(uQ,"StructArrayLayout1ui2f12");var R7=uQ;R7.prototype.bytesPerElement=12;Lr("StructArrayLayout1ui2f12",R7);var cQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,r,i)}emplace(e,r,i,n){let a=e*2,o=e*4;return this.uint32[a+0]=r,this.uint16[o+2]=i,this.uint16[o+3]=n,e}};s(cQ,"StructArrayLayout1ul2ui8");var O7=cQ;O7.prototype.bytesPerElement=8;Lr("StructArrayLayout1ul2ui8",O7);var hQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){let n=e*2;return this.uint16[n+0]=r,this.uint16[n+1]=i,e}};s(hQ,"StructArrayLayout2ui4");var k7=hQ;k7.prototype.bytesPerElement=4;Lr("StructArrayLayout2ui4",k7);var pQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let i=e*1;return this.uint16[i+0]=r,e}};s(pQ,"StructArrayLayout1ui2");var N7=pQ;N7.prototype.bytesPerElement=2;Lr("StructArrayLayout1ui2",N7);var dQ=class extends yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,i,n)}emplace(e,r,i,n,a){let o=e*4;return this.float32[o+0]=r,this.float32[o+1]=i,this.float32[o+2]=n,this.float32[o+3]=a,e}};s(dQ,"StructArrayLayout4f16");var F7=dQ;F7.prototype.bytesPerElement=16;Lr("StructArrayLayout4f16",F7);var fQ=class extends AA{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new $ke.default(this.anchorPointX,this.anchorPointY)}};s(fQ,"CollisionBoxStruct");var mQ=fQ;mQ.prototype.size=20;var gQ=class extends C7{get(e){return new mQ(this,e)}};s(gQ,"CollisionBoxArray");var yQ=gQ;Lr("CollisionBoxArray",yQ);var vQ=class extends AA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};s(vQ,"PlacedSymbolStruct");var _Q=vQ;_Q.prototype.size=48;var xQ=class extends L7{get(e){return new _Q(this,e)}};s(xQ,"PlacedSymbolArray");var bQ=xQ;Lr("PlacedSymbolArray",bQ);var wQ=class extends AA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};s(wQ,"SymbolInstanceStruct");var AQ=wQ;AQ.prototype.size=64;var SQ=class extends D7{get(e){return new AQ(this,e)}};s(SQ,"SymbolInstanceArray");var MQ=SQ;Lr("SymbolInstanceArray",MQ);var EQ=class extends yP{getoffsetX(e){return this.float32[e*1+0]}};s(EQ,"GlyphOffsetArray");var CQ=EQ;Lr("GlyphOffsetArray",CQ);var IQ=class extends mP{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};s(IQ,"SymbolLineVertexArray");var TQ=IQ;Lr("SymbolLineVertexArray",TQ);var PQ=class extends AA{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};s(PQ,"TextAnchorOffsetStruct");var LQ=PQ;LQ.prototype.size=12;var DQ=class extends R7{get(e){return new LQ(this,e)}};s(DQ,"TextAnchorOffsetArray");var RQ=DQ;Lr("TextAnchorOffsetArray",RQ);var OQ=class extends AA{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};s(OQ,"FeatureIndexStruct");var kQ=OQ;kQ.prototype.size=8;var NQ=class extends O7{get(e){return new kQ(this,e)}};s(NQ,"FeatureIndexArray");var FQ=NQ;Lr("FeatureIndexArray",FQ);var BQ=class extends SA{};s(BQ,"PosArray");var BE=BQ,zQ=class extends mP{};s(zQ,"Pos3dArray");var Gke=zQ,UQ=class extends x7{};s(UQ,"RasterBoundsArray");var VQ=UQ,jQ=class extends SA{};s(jQ,"CircleLayoutArray");var Hke=jQ,$Q=class extends SA{};s($Q,"FillLayoutArray");var qke=$Q,GQ=class extends b7{};s(GQ,"FillExtrusionLayoutArray");var Wke=GQ,HQ=class extends w7{};s(HQ,"LineLayoutArray");var Xke=HQ,qQ=class extends Sw{};s(qQ,"LineExtLayoutArray");var Zke=qQ,WQ=class extends A7{};s(WQ,"PatternLayoutArray");var r0=WQ,XQ=class extends S7{};s(XQ,"SymbolLayoutArray");var Yke=XQ,ZQ=class extends M7{};s(ZQ,"SymbolDynamicLayoutArray");var Kke=ZQ,YQ=class extends E7{};s(YQ,"SymbolOpacityArray");var Jke=YQ,KQ=class extends I7{};s(KQ,"CollisionBoxLayoutArray");var NH=KQ,JQ=class extends T7{};s(JQ,"CollisionCircleLayoutArray");var Qke=JQ,QQ=class extends P7{};s(QQ,"CollisionVertexArray");var e8e=QQ,eee=class extends gP{};s(eee,"QuadTriangleArray");var t8e=eee,tee=class extends gP{};s(tee,"TriangleIndexArray");var cv=tee,ree=class extends k7{};s(ree,"LineIndexArray");var P6=ree,iee=class extends N7{};s(iee,"LineStripIndexArray");var r8e=iee;N();var i8e=no([{name:"a_pos",components:2,type:"Int16"}],4),{members:n8e,size:nat,alignment:aat}=i8e;N();var nee=class Jb{constructor(e=[]){this.segments=e}prepareSegment(e,r,i,n){let a=this.segments[this.segments.length-1];return e>Jb.MAX_VERTEX_ARRAY_LENGTH&&Ol("Max vertices per segment is ".concat(Jb.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!a||a.vertexLength+e>Jb.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==n)&&(a={vertexOffset:r.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},n!==void 0&&(a.sortKey=n),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,i,n){return new Jb([{vertexOffset:e,primitiveOffset:r,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}};s(nee,"SegmentVector");var Io=nee;Io.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;Lr("SegmentVector",Io);N();N();function L6(t,e){return t=hs(Math.floor(t),0,255),e=hs(Math.floor(e),0,255),256*t+e}s(L6,"packUint8ToFloat");N();var CT=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);N();var a8e=Rr(KX(),1),aee=class oee{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,i,n){this.ids.push(D6(e)),this.positions.push(r,i,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=D6(e),i=0,n=this.ids.length-1;for(;i<n;){let o=i+n>>1;this.ids[o]>=r?n=o:i=o+1}let a=[];for(;this.ids[i]===r;){let o=this.positions[3*i],l=this.positions[3*i+1],u=this.positions[3*i+2];a.push({index:o,start:l,end:u}),i++}return a}static serialize(e,r){let i=new Float64Array(e.ids),n=new Uint32Array(e.positions);return IT(i,n,0,i.length-1),r&&r.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(e){let r=new oee;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};s(aee,"FeaturePositionMap");var see=aee;function D6(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,a8e.default)(String(t))}s(D6,"getNumericId");function IT(t,e,r,i){for(;r<i;){let n=t[r+i>>1],a=r-1,o=i+1;for(;;){do a++;while(t[a]<n);do o--;while(t[o]>n);if(a>=o)break;Qb(t,a,o),Qb(e,3*a,3*o),Qb(e,3*a+1,3*o+1),Qb(e,3*a+2,3*o+2)}o-r<i-o?(IT(t,e,r,o),r=o+1):(IT(t,e,o+1,i),i=o)}}s(IT,"sort");function Qb(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}s(Qb,"swap");Lr("FeaturePositionMap",see);N();var lee=class{constructor(e,r){this.gl=e.gl,this.location=r}};s(lee,"Uniform");var hv=lee,uee=class extends hv{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}};s(uee,"Uniform1i");var qi=uee,cee=class extends hv{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};s(cee,"Uniform1f");var Mr=cee,hee=class extends hv{constructor(e,r){super(e,r),this.current=[0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1])&&(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}};s(hee,"Uniform2f");var nn=hee,pee=class extends hv{constructor(e,r){super(e,r),this.current=[0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2])&&(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}};s(pee,"Uniform3f");var cf=pee,dee=class extends hv{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}};s(dee,"Uniform4f");var B7=dee,fee=class extends hv{constructor(e,r){super(e,r),this.current=Pi.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};s(fee,"UniformColor");var J1=fee,o8e=new Float32Array(16),mee=class extends hv{constructor(e,r){super(e,r),this.current=o8e}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);return}for(let r=1;r<16;r++)if(e[r]!==this.current[r]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}};s(mee,"UniformMatrix4f");var vn=mee;function TT(t){return[L6(255*t.r,255*t.g),L6(255*t.b,255*t.a)]}s(TT,"packColor");var gee=class{constructor(e,r,i){this.value=e,this.uniformNames=r.map(n=>"u_".concat(n)),this.type=i}setUniform(e,r,i){e.set(i.constantOr(this.value))}getBinding(e,r,i){return this.type==="color"?new J1(e,r):new Mr(e,r)}};s(gee,"ConstantBinder");var e2=gee,yee=class{constructor(e,r){this.uniformNames=r.map(i=>"u_".concat(i)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,i,n){let a=n==="u_pattern_to"?this.patternTo:n==="u_pattern_from"?this.patternFrom:n==="u_pixel_ratio_to"?this.pixelRatioTo:n==="u_pixel_ratio_from"?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,r,i){return i.substr(0,9)==="u_pattern"?new B7(e,r):new Mr(e,r)}};s(yee,"CrossFadedConstantBinder");var w0=yee,vee=class{constructor(e,r,i,n){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=r.map(a=>({name:"a_".concat(a),type:"Float32",components:i==="color"?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,r,i,n,a){let o=this.paintVertexArray.length,l=this.expression.evaluate(new ds(0),r,{},n,[],a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,l)}updatePaintArray(e,r,i,n){let a=this.expression.evaluate({zoom:0},i,n);this._setPaintValue(e,r,a)}_setPaintValue(e,r,i){if(this.type==="color"){let n=TT(i);for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,n[0],n[1])}else{for(let n=e;n<r;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}};s(vee,"SourceExpressionBinder");var Dd=vee,_ee=class{constructor(e,r,i,n,a,o){this.expression=e,this.uniformNames=r.map(l=>"u_".concat(l,"_t")),this.type=i,this.useIntegerZoom=n,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=r.map(l=>({name:"a_".concat(l),type:"Float32",components:i==="color"?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(e,r,i,n,a){let o=this.expression.evaluate(new ds(this.zoom),r,{},n,[],a),l=this.expression.evaluate(new ds(this.zoom+1),r,{},n,[],a),u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(u,e,o,l)}updatePaintArray(e,r,i,n){let a=this.expression.evaluate({zoom:this.zoom},i,n),o=this.expression.evaluate({zoom:this.zoom+1},i,n);this._setPaintValue(e,r,a,o)}_setPaintValue(e,r,i,n){if(this.type==="color"){let a=TT(i),o=TT(n);for(let l=e;l<r;l++)this.paintVertexArray.emplace(l,a[0],a[1],o[0],o[1])}else{for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){let i=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,n=hs(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,r,i){return new Mr(e,r)}};s(_ee,"CompositeExpressionBinder");var xh=_ee,xee=class{constructor(e,r,i,n,a,o){this.expression=e,this.type=r,this.useIntegerZoom=i,this.zoom=n,this.layerId=o,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,r,i){let n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,r.patterns&&r.patterns[this.layerId],i)}updatePaintArray(e,r,i,n,a){this._setPaintValues(e,r,i.patterns&&i.patterns[this.layerId],a)}_setPaintValues(e,r,i,n){if(!n||!i)return;let{min:a,mid:o,max:l}=i,u=n[a],c=n[o],p=n[l];if(!(!u||!c||!p))for(let m=e;m<r;m++)this.zoomInPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],c.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],c.pixelRatio,p.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,CT.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,CT.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}};s(xee,"CrossFadedCompositeBinder");var hm=xee,bee=class{constructor(e,r,i){this.binders={},this._buffers=[];let n=[];for(let a in e.paint._values){if(!i(a))continue;let o=e.paint.get(a);if(!(o instanceof Fh)||!$y(o.property.specification))continue;let l=See(a,e.type),u=o.value,c=o.property.specification.type,p=o.property.useIntegerZoom,m=o.property.specification["property-type"],y=m==="cross-faded"||m==="cross-faded-data-driven";if(u.kind==="constant")this.binders[a]=y?new w0(u.value,l):new e2(u.value,l,c),n.push("/u_".concat(a));else if(u.kind==="source"||y){let v=R6(a,c,"source");this.binders[a]=y?new hm(u,c,p,r,v,e.id):new Dd(u,l,c,v),n.push("/a_".concat(a))}else{let v=R6(a,c,"composite");this.binders[a]=new xh(u,l,c,p,r,v),n.push("/z_".concat(a))}}this.cacheKey=n.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof Dd||r instanceof xh?r.maxValue:0}populatePaintArrays(e,r,i,n,a){for(let o in this.binders){let l=this.binders[o];(l instanceof Dd||l instanceof xh||l instanceof hm)&&l.populatePaintArray(e,r,i,n,a)}}setConstantPatternPositions(e,r){for(let i in this.binders){let n=this.binders[i];n instanceof w0&&n.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,i,n,a){let o=!1;for(let l in e){let u=r.getPositions(l);for(let c of u){let p=i.feature(c.index);for(let m in this.binders){let y=this.binders[m];if((y instanceof Dd||y instanceof xh||y instanceof hm)&&y.expression.isStateDependent===!0){let v=n.paint.get(m);y.expression=v.value,y.updatePaintArray(c.start,c.end,p,e[l],a),o=!0}}}}return o}defines(){let e=[];for(let r in this.binders){let i=this.binders[r];(i instanceof e2||i instanceof w0)&&e.push(...i.uniformNames.map(n=>"#define HAS_UNIFORM_".concat(n)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let i=this.binders[r];if(i instanceof Dd||i instanceof xh)for(let n=0;n<i.paintVertexAttributes.length;n++)e.push(i.paintVertexAttributes[n].name);else if(i instanceof hm)for(let n=0;n<CT.members.length;n++)e.push(CT.members[n].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let i=this.binders[r];if(i instanceof e2||i instanceof w0||i instanceof xh)for(let n of i.uniformNames)e.push(n)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let i=[];for(let n in this.binders){let a=this.binders[n];if(a instanceof e2||a instanceof w0||a instanceof xh){for(let o of a.uniformNames)if(r[o]){let l=a.getBinding(e,r[o],o);i.push({name:o,property:n,binding:l})}}}return i}setUniforms(e,r,i,n){for(let{name:a,property:o,binding:l}of r)this.binders[o].setUniform(l,n,i.get(o),a)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let i=this.binders[r];if(e&&i instanceof hm){let n=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(i instanceof Dd||i instanceof xh)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(let r in this.binders){let i=this.binders[r];(i instanceof Dd||i instanceof xh||i instanceof hm)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof Dd||r instanceof xh||r instanceof hm)&&r.destroy()}}};s(bee,"ProgramConfiguration");var wee=bee,Aee=class{constructor(e,r,i=()=>!0){this.programConfigurations={};for(let n of e)this.programConfigurations[n.id]=new wee(n,r,i);this.needsUpload=!1,this._featureMap=new see,this._bufferOffset=0}populatePaintArrays(e,r,i,n,a,o){for(let l in this.programConfigurations)this.programConfigurations[l].populatePaintArrays(e,r,n,a,o);r.id!==void 0&&this._featureMap.add(r.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,i,n){for(let a of i)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,r,a,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};s(Aee,"ProgramConfigurationSet");var Hy=Aee;function See(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}s(See,"paintAttributeNames");function Mee(t){return{"line-pattern":{source:r0,composite:r0},"fill-pattern":{source:r0,composite:r0},"fill-extrusion-pattern":{source:r0,composite:r0}}[t]}s(Mee,"getLayoutException");function R6(t,e,r){let i={color:{source:Sw,composite:F7},number:{source:yP,composite:Sw}},n=Mee(t);return n&&n[r]||i[e][r]}s(R6,"layoutType");Lr("ConstantBinder",e2);Lr("CrossFadedConstantBinder",w0);Lr("SourceExpressionBinder",Dd);Lr("CrossFadedCompositeBinder",hm);Lr("CompositeExpressionBinder",xh);Lr("ProgramConfiguration",wee,{omit:["_buffers"]});Lr("ProgramConfigurationSet",Hy);N();N();N();var s8e=15,O6=Math.pow(2,s8e-1)-1,FH=-O6-1;function og(t){let e=8192/t.extent,r=t.loadGeometry();for(let i=0;i<r.length;i++){let n=r[i];for(let a=0;a<n.length;a++){let o=n[a],l=Math.round(o.x*e),u=Math.round(o.y*e);o.x=hs(l,FH,O6),o.y=hs(u,FH,O6),(l<o.x||l>o.x+1||u<o.y||u>o.y+1)&&Ol("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}s(og,"loadGeometry");N();function sg(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?og(t):[]}}s(sg,"toEvaluationFeature");function t2(t,e,r,i,n){t.emplaceBack(e*2+(i+1)/2,r*2+(n+1)/2)}s(t2,"addCircleVertex");var Eee=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Hke,this.indexArray=new cv,this.segments=new Io,this.programConfigurations=new Hy(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){let n=this.layers[0],a=[],o=null,l=!1;n.type==="circle"&&(o=n.layout.get("circle-sort-key"),l=!o.isConstant());for(let{feature:u,id:c,index:p,sourceLayerIndex:m}of e){let y=this.layers[0]._featureFilter.needGeometry,v=sg(u,y);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),v,i))continue;let x=l?o.evaluate(v,{},i):void 0,E={id:c,properties:u.properties,type:u.type,sourceLayerIndex:m,index:p,geometry:y?v.geometry:og(u),patterns:{},sortKey:x};a.push(E)}l&&a.sort((u,c)=>u.sortKey-c.sortKey);for(let u of a){let{geometry:c,index:p,sourceLayerIndex:m}=u,y=e[p].feature;this.addFeature(u,c,p,i),r.featureIndex.insert(y,c,p,m,this.index)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,n8e),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,i,n){for(let a of r)for(let o of a){let l=o.x,u=o.y;if(l<0||l>=8192||u<0||u>=8192)continue;let c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),p=c.vertexLength;t2(this.layoutVertexArray,l,u,-1,-1),t2(this.layoutVertexArray,l,u,1,-1),t2(this.layoutVertexArray,l,u,1,1),t2(this.layoutVertexArray,l,u,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),c.vertexLength+=4,c.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},n)}};s(Eee,"CircleBucket");var z7=Eee;Lr("CircleBucket",z7,{omit:["layers"]});N();var AM=Rr(kn(),1);function U7(t,e){for(let r=0;r<t.length;r++)if(qy(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(qy(t,e[r]))return!0;return!!vP(t,e)}s(U7,"polygonIntersectsPolygon");function Cee(t,e,r){return!!(qy(t,e)||PT(e,t,r))}s(Cee,"polygonIntersectsBufferedPoint");function V7(t,e){if(t.length===1)return k6(e,t[0]);for(let r=0;r<e.length;r++){let i=e[r];for(let n=0;n<i.length;n++)if(qy(t,i[n]))return!0}for(let r=0;r<t.length;r++)if(k6(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(vP(t,e[r]))return!0;return!1}s(V7,"polygonIntersectsMultiPolygon");function Iee(t,e,r){for(let i=0;i<e.length;i++){let n=e[i];if(t.length>=3){for(let a=0;a<n.length;a++)if(qy(t,n[a]))return!0}if(Tee(t,n,r))return!0}return!1}s(Iee,"polygonIntersectsBufferedMultiLine");function Tee(t,e,r){if(t.length>1){if(vP(t,e))return!0;for(let i=0;i<e.length;i++)if(PT(e[i],t,r))return!0}for(let i=0;i<t.length;i++)if(PT(t[i],e,r))return!0;return!1}s(Tee,"lineIntersectsBufferedLine");function vP(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let i=t[r],n=t[r+1];for(let a=0;a<e.length-1;a++){let o=e[a],l=e[a+1];if(Pee(i,n,o,l))return!0}}return!1}s(vP,"lineIntersectsLine");function Pee(t,e,r,i){return of(t,r,i)!==of(e,r,i)&&of(t,e,r)!==of(t,e,i)}s(Pee,"lineSegmentIntersectsLineSegment");function PT(t,e,r){let i=r*r;if(e.length===1)return t.distSqr(e[0])<i;for(let n=1;n<e.length;n++){let a=e[n-1],o=e[n];if(Lee(t,a,o)<i)return!0}return!1}s(PT,"pointIntersectsBufferedLine");function Lee(t,e,r){let i=e.distSqr(r);if(i===0)return t.distSqr(e);let n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return n<0?t.distSqr(e):n>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(n)._add(e))}s(Lee,"distToSegmentSquared");function k6(t,e){let r=!1,i,n,a;for(let o=0;o<t.length;o++){i=t[o];for(let l=0,u=i.length-1;l<i.length;u=l++)n=i[l],a=i[u],n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(r=!r)}return r}s(k6,"multiPolygonContainsPoint");function qy(t,e){let r=!1;for(let i=0,n=t.length-1;i<t.length;n=i++){let a=t[i],o=t[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}s(qy,"polygonContainsPoint");function Dee(t,e,r,i,n){for(let o of t)if(e<=o.x&&r<=o.y&&i>=o.x&&n>=o.y)return!0;let a=[new AM.default(e,r),new AM.default(e,n),new AM.default(i,n),new AM.default(i,r)];if(t.length>2){for(let o of a)if(qy(t,o))return!0}for(let o=0;o<t.length-1;o++){let l=t[o],u=t[o+1];if(Ree(l,u,a))return!0}return!1}s(Dee,"polygonIntersectsBox");function Ree(t,e,r){let i=r[0],n=r[2];if(t.x<i.x&&e.x<i.x||t.x>n.x&&e.x>n.x||t.y<i.y&&e.y<i.y||t.y>n.y&&e.y>n.y)return!1;let a=of(t,e,r[0]);return a!==of(t,e,r[1])||a!==of(t,e,r[2])||a!==of(t,e,r[3])}s(Ree,"edgeIntersectsBox");N();var N6=Rr(kn(),1);function Q1(t,e,r){let i=e.paint.get(t).value;return i.kind==="constant"?i.value:r.programConfigurations.get(e.id).getMaxValue(t)}s(Q1,"getMaximumPaintValue");function MA(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}s(MA,"translateDistance");function EA(t,e,r,i,n){if(!e[0]&&!e[1])return t;let a=N6.default.convert(e)._mult(n);r==="viewport"&&a._rotate(-i);let o=[];for(let l=0;l<t.length;l++){let u=t[l];o.push(u.sub(a))}return o}s(EA,"translate");function Oee(t,e){let r=[];for(let i=0;i<t.length;i++){let n=t[i],a=[];for(let o=0;o<n.length;o++){let l=n[o-1],u=n[o],c=n[o+1],p=o===0?new N6.default(0,0):u.sub(l)._unit()._perp(),m=o===n.length-1?new N6.default(0,0):c.sub(u)._unit()._perp(),y=p._add(m)._unit(),v=y.x*m.x+y.y*m.y;v!==0&&y._mult(1/v),a.push(y._mult(e)._add(u))}r.push(a)}return r}s(Oee,"offsetLine");N();var BH,l8e=s(()=>BH=BH||new $u({"circle-sort-key":new pi(Ut.layout_circle["circle-sort-key"])}),"getLayout"),zH,u8e=s(()=>zH=zH||new $u({"circle-radius":new pi(Ut.paint_circle["circle-radius"]),"circle-color":new pi(Ut.paint_circle["circle-color"]),"circle-blur":new pi(Ut.paint_circle["circle-blur"]),"circle-opacity":new pi(Ut.paint_circle["circle-opacity"]),"circle-translate":new Hr(Ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Hr(Ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Hr(Ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Hr(Ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pi(Ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pi(Ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pi(Ut.paint_circle["circle-stroke-opacity"])}),"getPaint"),c8e={get paint(){return u8e()},get layout(){return l8e()}};N();N();var Bi=1e-6,Ra=typeof Float32Array<"u"?Float32Array:Array,Sy=Math.random;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var F6={};kl(F6,{LDU:()=>Kee,add:()=>Jee,adjoint:()=>$ee,clone:()=>Nee,copy:()=>Fee,create:()=>kee,determinant:()=>Gee,equals:()=>ete,exactEquals:()=>Qee,frob:()=>Yee,fromRotation:()=>Wee,fromScaling:()=>Xee,fromValues:()=>zee,identity:()=>Bee,invert:()=>jee,mul:()=>h8e,multiply:()=>j7,multiplyScalar:()=>tte,multiplyScalarAndAdd:()=>rte,rotate:()=>Hee,scale:()=>qee,set:()=>Uee,str:()=>Zee,sub:()=>p8e,subtract:()=>$7,transpose:()=>Vee});N();function kee(){var t=new Ra(4);return Ra!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}s(kee,"create");function Nee(t){var e=new Ra(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}s(Nee,"clone");function Fee(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}s(Fee,"copy");function Bee(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}s(Bee,"identity");function zee(t,e,r,i){var n=new Ra(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}s(zee,"fromValues");function Uee(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}s(Uee,"set");function Vee(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}s(Vee,"transpose");function jee(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r*a-n*i;return o?(o=1/o,t[0]=a*o,t[1]=-i*o,t[2]=-n*o,t[3]=r*o,t):null}s(jee,"invert");function $ee(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}s($ee,"adjoint");function Gee(t){return t[0]*t[3]-t[2]*t[1]}s(Gee,"determinant");function j7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=r[0],u=r[1],c=r[2],p=r[3];return t[0]=i*l+a*u,t[1]=n*l+o*u,t[2]=i*c+a*p,t[3]=n*c+o*p,t}s(j7,"multiply");function Hee(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=Math.sin(r),u=Math.cos(r);return t[0]=i*u+a*l,t[1]=n*u+o*l,t[2]=i*-l+a*u,t[3]=n*-l+o*u,t}s(Hee,"rotate");function qee(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=r[0],u=r[1];return t[0]=i*l,t[1]=n*l,t[2]=a*u,t[3]=o*u,t}s(qee,"scale");function Wee(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t}s(Wee,"fromRotation");function Xee(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}s(Xee,"fromScaling");function Zee(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}s(Zee,"str");function Yee(t){return Math.hypot(t[0],t[1],t[2],t[3])}s(Yee,"frob");function Kee(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]}s(Kee,"LDU");function Jee(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}s(Jee,"add");function $7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}s($7,"subtract");function Qee(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}s(Qee,"exactEquals");function ete(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=Bi*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=Bi*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=Bi*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-c)<=Bi*Math.max(1,Math.abs(a),Math.abs(c))}s(ete,"equals");function tte(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}s(tte,"multiplyScalar");function rte(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}s(rte,"multiplyScalarAndAdd");var h8e=j7,p8e=$7,B6={};kl(B6,{add:()=>Ete,adjoint:()=>pte,clone:()=>ate,copy:()=>ote,create:()=>ite,determinant:()=>dte,equals:()=>Pte,exactEquals:()=>Tte,frob:()=>Mte,fromMat2d:()=>xte,fromMat4:()=>nte,fromQuat:()=>bte,fromRotation:()=>vte,fromScaling:()=>_te,fromTranslation:()=>yte,fromValues:()=>ste,identity:()=>ute,invert:()=>hte,mul:()=>d8e,multiply:()=>G7,multiplyScalar:()=>Cte,multiplyScalarAndAdd:()=>Ite,normalFromMat4:()=>wte,projection:()=>Ate,rotate:()=>mte,scale:()=>gte,set:()=>lte,str:()=>Ste,sub:()=>f8e,subtract:()=>H7,translate:()=>fte,transpose:()=>cte});N();function ite(){var t=new Ra(9);return Ra!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}s(ite,"create");function nte(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}s(nte,"fromMat4");function ate(t){var e=new Ra(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}s(ate,"clone");function ote(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}s(ote,"copy");function ste(t,e,r,i,n,a,o,l,u){var c=new Ra(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=i,c[4]=n,c[5]=a,c[6]=o,c[7]=l,c[8]=u,c}s(ste,"fromValues");function lte(t,e,r,i,n,a,o,l,u,c){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=o,t[6]=l,t[7]=u,t[8]=c,t}s(lte,"set");function ute(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}s(ute,"identity");function cte(t,e){if(t===e){var r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}s(cte,"transpose");function hte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=p*o-l*c,y=-p*a+l*u,v=c*a-o*u,x=r*m+i*y+n*v;return x?(x=1/x,t[0]=m*x,t[1]=(-p*i+n*c)*x,t[2]=(l*i-n*o)*x,t[3]=y*x,t[4]=(p*r-n*u)*x,t[5]=(-l*r+n*a)*x,t[6]=v*x,t[7]=(-c*r+i*u)*x,t[8]=(o*r-i*a)*x,t):null}s(hte,"invert");function pte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8];return t[0]=o*p-l*c,t[1]=n*c-i*p,t[2]=i*l-n*o,t[3]=l*u-a*p,t[4]=r*p-n*u,t[5]=n*a-r*l,t[6]=a*c-o*u,t[7]=i*u-r*c,t[8]=r*o-i*a,t}s(pte,"adjoint");function dte(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8];return e*(c*a-o*u)+r*(-c*n+o*l)+i*(u*n-a*l)}s(dte,"determinant");function G7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=r[0],v=r[1],x=r[2],E=r[3],M=r[4],I=r[5],P=r[6],C=r[7],T=r[8];return t[0]=y*i+v*o+x*c,t[1]=y*n+v*l+x*p,t[2]=y*a+v*u+x*m,t[3]=E*i+M*o+I*c,t[4]=E*n+M*l+I*p,t[5]=E*a+M*u+I*m,t[6]=P*i+C*o+T*c,t[7]=P*n+C*l+T*p,t[8]=P*a+C*u+T*m,t}s(G7,"multiply");function fte(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=r[0],v=r[1];return t[0]=i,t[1]=n,t[2]=a,t[3]=o,t[4]=l,t[5]=u,t[6]=y*i+v*o+c,t[7]=y*n+v*l+p,t[8]=y*a+v*u+m,t}s(fte,"translate");function mte(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=Math.sin(r),v=Math.cos(r);return t[0]=v*i+y*o,t[1]=v*n+y*l,t[2]=v*a+y*u,t[3]=v*o-y*i,t[4]=v*l-y*n,t[5]=v*u-y*a,t[6]=c,t[7]=p,t[8]=m,t}s(mte,"rotate");function gte(t,e,r){var i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}s(gte,"scale");function yte(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}s(yte,"fromTranslation");function vte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}s(vte,"fromRotation");function _te(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}s(_te,"fromScaling");function xte(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}s(xte,"fromMat2d");function bte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,l=i+i,u=n+n,c=r*o,p=i*o,m=i*l,y=n*o,v=n*l,x=n*u,E=a*o,M=a*l,I=a*u;return t[0]=1-m-x,t[3]=p-I,t[6]=y+M,t[1]=p+I,t[4]=1-c-x,t[7]=v-E,t[2]=y-M,t[5]=v+E,t[8]=1-c-m,t}s(bte,"fromQuat");function wte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],x=e[12],E=e[13],M=e[14],I=e[15],P=r*l-i*o,C=r*u-n*o,T=r*c-a*o,D=i*u-n*l,F=i*c-a*l,k=n*c-a*u,B=p*E-m*x,U=p*M-y*x,z=p*I-v*x,q=m*M-y*E,Z=m*I-v*E,Q=y*I-v*M,V=P*Q-C*Z+T*q+D*z-F*U+k*B;return V?(V=1/V,t[0]=(l*Q-u*Z+c*q)*V,t[1]=(u*z-o*Q-c*U)*V,t[2]=(o*Z-l*z+c*B)*V,t[3]=(n*Z-i*Q-a*q)*V,t[4]=(r*Q-n*z+a*U)*V,t[5]=(i*z-r*Z-a*B)*V,t[6]=(E*k-M*F+I*D)*V,t[7]=(M*T-x*k-I*C)*V,t[8]=(x*F-E*T+I*P)*V,t):null}s(wte,"normalFromMat4");function Ate(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}s(Ate,"projection");function Ste(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}s(Ste,"str");function Mte(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}s(Mte,"frob");function Ete(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}s(Ete,"add");function H7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}s(H7,"subtract");function Cte(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}s(Cte,"multiplyScalar");function Ite(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t}s(Ite,"multiplyScalarAndAdd");function Tte(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}s(Tte,"exactEquals");function Pte(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7],p=t[8],m=e[0],y=e[1],v=e[2],x=e[3],E=e[4],M=e[5],I=e[6],P=e[7],C=e[8];return Math.abs(r-m)<=Bi*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(i-y)<=Bi*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(n-v)<=Bi*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-x)<=Bi*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-E)<=Bi*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(l-M)<=Bi*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-I)<=Bi*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-P)<=Bi*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(p-C)<=Bi*Math.max(1,Math.abs(p),Math.abs(C))}s(Pte,"equals");var d8e=G7,f8e=H7,Or={};kl(Or,{add:()=>pre,adjoint:()=>Bte,clone:()=>Dte,copy:()=>Rte,create:()=>Lte,determinant:()=>zte,equals:()=>gre,exactEquals:()=>mre,frob:()=>hre,fromQuat:()=>ire,fromQuat2:()=>Jte,fromRotation:()=>Xte,fromRotationTranslation:()=>X7,fromRotationTranslationScale:()=>tre,fromRotationTranslationScaleOrigin:()=>rre,fromScaling:()=>Wte,fromTranslation:()=>qte,fromValues:()=>Ote,fromXRotation:()=>Zte,fromYRotation:()=>Yte,fromZRotation:()=>Kte,frustum:()=>nre,getRotation:()=>ere,getScaling:()=>Z7,getTranslation:()=>Qte,identity:()=>q7,invert:()=>Fte,lookAt:()=>lre,mul:()=>y8e,multiply:()=>W7,multiplyScalar:()=>dre,multiplyScalarAndAdd:()=>fre,ortho:()=>g8e,orthoNO:()=>K7,orthoZO:()=>sre,perspective:()=>m8e,perspectiveFromFieldOfView:()=>ore,perspectiveNO:()=>Y7,perspectiveZO:()=>are,rotate:()=>jte,rotateX:()=>$te,rotateY:()=>Gte,rotateZ:()=>Hte,scale:()=>Vte,set:()=>kte,str:()=>cre,sub:()=>v8e,subtract:()=>J7,targetTo:()=>ure,translate:()=>Ute,transpose:()=>Nte});N();function Lte(){var t=new Ra(16);return Ra!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}s(Lte,"create");function Dte(t){var e=new Ra(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}s(Dte,"clone");function Rte(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}s(Rte,"copy");function Ote(t,e,r,i,n,a,o,l,u,c,p,m,y,v,x,E){var M=new Ra(16);return M[0]=t,M[1]=e,M[2]=r,M[3]=i,M[4]=n,M[5]=a,M[6]=o,M[7]=l,M[8]=u,M[9]=c,M[10]=p,M[11]=m,M[12]=y,M[13]=v,M[14]=x,M[15]=E,M}s(Ote,"fromValues");function kte(t,e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=o,t[6]=l,t[7]=u,t[8]=c,t[9]=p,t[10]=m,t[11]=y,t[12]=v,t[13]=x,t[14]=E,t[15]=M,t}s(kte,"set");function q7(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(q7,"identity");function Nte(t,e){if(t===e){var r=e[1],i=e[2],n=e[3],a=e[6],o=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=n,t[13]=o,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}s(Nte,"transpose");function Fte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],x=e[12],E=e[13],M=e[14],I=e[15],P=r*l-i*o,C=r*u-n*o,T=r*c-a*o,D=i*u-n*l,F=i*c-a*l,k=n*c-a*u,B=p*E-m*x,U=p*M-y*x,z=p*I-v*x,q=m*M-y*E,Z=m*I-v*E,Q=y*I-v*M,V=P*Q-C*Z+T*q+D*z-F*U+k*B;return V?(V=1/V,t[0]=(l*Q-u*Z+c*q)*V,t[1]=(n*Z-i*Q-a*q)*V,t[2]=(E*k-M*F+I*D)*V,t[3]=(y*F-m*k-v*D)*V,t[4]=(u*z-o*Q-c*U)*V,t[5]=(r*Q-n*z+a*U)*V,t[6]=(M*T-x*k-I*C)*V,t[7]=(p*k-y*T+v*C)*V,t[8]=(o*Z-l*z+c*B)*V,t[9]=(i*z-r*Z-a*B)*V,t[10]=(x*F-E*T+I*P)*V,t[11]=(m*T-p*F-v*P)*V,t[12]=(l*U-o*q-u*B)*V,t[13]=(r*q-i*U+n*B)*V,t[14]=(E*C-x*D-M*P)*V,t[15]=(p*D-m*C+y*P)*V,t):null}s(Fte,"invert");function Bte(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],x=e[12],E=e[13],M=e[14],I=e[15];return t[0]=l*(y*I-v*M)-m*(u*I-c*M)+E*(u*v-c*y),t[1]=-(i*(y*I-v*M)-m*(n*I-a*M)+E*(n*v-a*y)),t[2]=i*(u*I-c*M)-l*(n*I-a*M)+E*(n*c-a*u),t[3]=-(i*(u*v-c*y)-l*(n*v-a*y)+m*(n*c-a*u)),t[4]=-(o*(y*I-v*M)-p*(u*I-c*M)+x*(u*v-c*y)),t[5]=r*(y*I-v*M)-p*(n*I-a*M)+x*(n*v-a*y),t[6]=-(r*(u*I-c*M)-o*(n*I-a*M)+x*(n*c-a*u)),t[7]=r*(u*v-c*y)-o*(n*v-a*y)+p*(n*c-a*u),t[8]=o*(m*I-v*E)-p*(l*I-c*E)+x*(l*v-c*m),t[9]=-(r*(m*I-v*E)-p*(i*I-a*E)+x*(i*v-a*m)),t[10]=r*(l*I-c*E)-o*(i*I-a*E)+x*(i*c-a*l),t[11]=-(r*(l*v-c*m)-o*(i*v-a*m)+p*(i*c-a*l)),t[12]=-(o*(m*M-y*E)-p*(l*M-u*E)+x*(l*y-u*m)),t[13]=r*(m*M-y*E)-p*(i*M-n*E)+x*(i*y-n*m),t[14]=-(r*(l*M-u*E)-o*(i*M-n*E)+x*(i*u-n*l)),t[15]=r*(l*y-u*m)-o*(i*y-n*m)+p*(i*u-n*l),t}s(Bte,"adjoint");function zte(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8],p=t[9],m=t[10],y=t[11],v=t[12],x=t[13],E=t[14],M=t[15],I=e*o-r*a,P=e*l-i*a,C=e*u-n*a,T=r*l-i*o,D=r*u-n*o,F=i*u-n*l,k=c*x-p*v,B=c*E-m*v,U=c*M-y*v,z=p*E-m*x,q=p*M-y*x,Z=m*M-y*E;return I*Z-P*q+C*z+T*U-D*B+F*k}s(zte,"determinant");function W7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=e[8],y=e[9],v=e[10],x=e[11],E=e[12],M=e[13],I=e[14],P=e[15],C=r[0],T=r[1],D=r[2],F=r[3];return t[0]=C*i+T*l+D*m+F*E,t[1]=C*n+T*u+D*y+F*M,t[2]=C*a+T*c+D*v+F*I,t[3]=C*o+T*p+D*x+F*P,C=r[4],T=r[5],D=r[6],F=r[7],t[4]=C*i+T*l+D*m+F*E,t[5]=C*n+T*u+D*y+F*M,t[6]=C*a+T*c+D*v+F*I,t[7]=C*o+T*p+D*x+F*P,C=r[8],T=r[9],D=r[10],F=r[11],t[8]=C*i+T*l+D*m+F*E,t[9]=C*n+T*u+D*y+F*M,t[10]=C*a+T*c+D*v+F*I,t[11]=C*o+T*p+D*x+F*P,C=r[12],T=r[13],D=r[14],F=r[15],t[12]=C*i+T*l+D*m+F*E,t[13]=C*n+T*u+D*y+F*M,t[14]=C*a+T*c+D*v+F*I,t[15]=C*o+T*p+D*x+F*P,t}s(W7,"multiply");function Ute(t,e,r){var i=r[0],n=r[1],a=r[2],o,l,u,c,p,m,y,v,x,E,M,I;return e===t?(t[12]=e[0]*i+e[4]*n+e[8]*a+e[12],t[13]=e[1]*i+e[5]*n+e[9]*a+e[13],t[14]=e[2]*i+e[6]*n+e[10]*a+e[14],t[15]=e[3]*i+e[7]*n+e[11]*a+e[15]):(o=e[0],l=e[1],u=e[2],c=e[3],p=e[4],m=e[5],y=e[6],v=e[7],x=e[8],E=e[9],M=e[10],I=e[11],t[0]=o,t[1]=l,t[2]=u,t[3]=c,t[4]=p,t[5]=m,t[6]=y,t[7]=v,t[8]=x,t[9]=E,t[10]=M,t[11]=I,t[12]=o*i+p*n+x*a+e[12],t[13]=l*i+m*n+E*a+e[13],t[14]=u*i+y*n+M*a+e[14],t[15]=c*i+v*n+I*a+e[15]),t}s(Ute,"translate");function Vte(t,e,r){var i=r[0],n=r[1],a=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}s(Vte,"scale");function jte(t,e,r,i){var n=i[0],a=i[1],o=i[2],l=Math.hypot(n,a,o),u,c,p,m,y,v,x,E,M,I,P,C,T,D,F,k,B,U,z,q,Z,Q,V,ae;return l<Bi?null:(l=1/l,n*=l,a*=l,o*=l,u=Math.sin(r),c=Math.cos(r),p=1-c,m=e[0],y=e[1],v=e[2],x=e[3],E=e[4],M=e[5],I=e[6],P=e[7],C=e[8],T=e[9],D=e[10],F=e[11],k=n*n*p+c,B=a*n*p+o*u,U=o*n*p-a*u,z=n*a*p-o*u,q=a*a*p+c,Z=o*a*p+n*u,Q=n*o*p+a*u,V=a*o*p-n*u,ae=o*o*p+c,t[0]=m*k+E*B+C*U,t[1]=y*k+M*B+T*U,t[2]=v*k+I*B+D*U,t[3]=x*k+P*B+F*U,t[4]=m*z+E*q+C*Z,t[5]=y*z+M*q+T*Z,t[6]=v*z+I*q+D*Z,t[7]=x*z+P*q+F*Z,t[8]=m*Q+E*V+C*ae,t[9]=y*Q+M*V+T*ae,t[10]=v*Q+I*V+D*ae,t[11]=x*Q+P*V+F*ae,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}s(jte,"rotate");function $te(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],p=e[9],m=e[10],y=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+c*i,t[5]=o*n+p*i,t[6]=l*n+m*i,t[7]=u*n+y*i,t[8]=c*n-a*i,t[9]=p*n-o*i,t[10]=m*n-l*i,t[11]=y*n-u*i,t}s($te,"rotateX");function Gte(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],o=e[1],l=e[2],u=e[3],c=e[8],p=e[9],m=e[10],y=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n-c*i,t[1]=o*n-p*i,t[2]=l*n-m*i,t[3]=u*n-y*i,t[8]=a*i+c*n,t[9]=o*i+p*n,t[10]=l*i+m*n,t[11]=u*i+y*n,t}s(Gte,"rotateY");function Hte(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],o=e[1],l=e[2],u=e[3],c=e[4],p=e[5],m=e[6],y=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+c*i,t[1]=o*n+p*i,t[2]=l*n+m*i,t[3]=u*n+y*i,t[4]=c*n-a*i,t[5]=p*n-o*i,t[6]=m*n-l*i,t[7]=y*n-u*i,t}s(Hte,"rotateZ");function qte(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}s(qte,"fromTranslation");function Wte(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Wte,"fromScaling");function Xte(t,e,r){var i=r[0],n=r[1],a=r[2],o=Math.hypot(i,n,a),l,u,c;return o<Bi?null:(o=1/o,i*=o,n*=o,a*=o,l=Math.sin(e),u=Math.cos(e),c=1-u,t[0]=i*i*c+u,t[1]=n*i*c+a*l,t[2]=a*i*c-n*l,t[3]=0,t[4]=i*n*c-a*l,t[5]=n*n*c+u,t[6]=a*n*c+i*l,t[7]=0,t[8]=i*a*c+n*l,t[9]=n*a*c-i*l,t[10]=a*a*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}s(Xte,"fromRotation");function Zte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Zte,"fromXRotation");function Yte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Yte,"fromYRotation");function Kte(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(Kte,"fromZRotation");function X7(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3],l=i+i,u=n+n,c=a+a,p=i*l,m=i*u,y=i*c,v=n*u,x=n*c,E=a*c,M=o*l,I=o*u,P=o*c;return t[0]=1-(v+E),t[1]=m+P,t[2]=y-I,t[3]=0,t[4]=m-P,t[5]=1-(p+E),t[6]=x+M,t[7]=0,t[8]=y+I,t[9]=x-M,t[10]=1-(p+v),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}s(X7,"fromRotationTranslation");function Jte(t,e){var r=new Ra(3),i=-e[0],n=-e[1],a=-e[2],o=e[3],l=e[4],u=e[5],c=e[6],p=e[7],m=i*i+n*n+a*a+o*o;return m>0?(r[0]=(l*o+p*i+u*a-c*n)*2/m,r[1]=(u*o+p*n+c*i-l*a)*2/m,r[2]=(c*o+p*a+l*n-u*i)*2/m):(r[0]=(l*o+p*i+u*a-c*n)*2,r[1]=(u*o+p*n+c*i-l*a)*2,r[2]=(c*o+p*a+l*n-u*i)*2),X7(t,e,r),t}s(Jte,"fromQuat2");function Qte(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}s(Qte,"getTranslation");function Z7(t,e){var r=e[0],i=e[1],n=e[2],a=e[4],o=e[5],l=e[6],u=e[8],c=e[9],p=e[10];return t[0]=Math.hypot(r,i,n),t[1]=Math.hypot(a,o,l),t[2]=Math.hypot(u,c,p),t}s(Z7,"getScaling");function ere(t,e){var r=new Ra(3);Z7(r,e);var i=1/r[0],n=1/r[1],a=1/r[2],o=e[0]*i,l=e[1]*n,u=e[2]*a,c=e[4]*i,p=e[5]*n,m=e[6]*a,y=e[8]*i,v=e[9]*n,x=e[10]*a,E=o+p+x,M=0;return E>0?(M=Math.sqrt(E+1)*2,t[3]=.25*M,t[0]=(m-v)/M,t[1]=(y-u)/M,t[2]=(l-c)/M):o>p&&o>x?(M=Math.sqrt(1+o-p-x)*2,t[3]=(m-v)/M,t[0]=.25*M,t[1]=(l+c)/M,t[2]=(y+u)/M):p>x?(M=Math.sqrt(1+p-o-x)*2,t[3]=(y-u)/M,t[0]=(l+c)/M,t[1]=.25*M,t[2]=(m+v)/M):(M=Math.sqrt(1+x-o-p)*2,t[3]=(l-c)/M,t[0]=(y+u)/M,t[1]=(m+v)/M,t[2]=.25*M),t}s(ere,"getRotation");function tre(t,e,r,i){var n=e[0],a=e[1],o=e[2],l=e[3],u=n+n,c=a+a,p=o+o,m=n*u,y=n*c,v=n*p,x=a*c,E=a*p,M=o*p,I=l*u,P=l*c,C=l*p,T=i[0],D=i[1],F=i[2];return t[0]=(1-(x+M))*T,t[1]=(y+C)*T,t[2]=(v-P)*T,t[3]=0,t[4]=(y-C)*D,t[5]=(1-(m+M))*D,t[6]=(E+I)*D,t[7]=0,t[8]=(v+P)*F,t[9]=(E-I)*F,t[10]=(1-(m+x))*F,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}s(tre,"fromRotationTranslationScale");function rre(t,e,r,i,n){var a=e[0],o=e[1],l=e[2],u=e[3],c=a+a,p=o+o,m=l+l,y=a*c,v=a*p,x=a*m,E=o*p,M=o*m,I=l*m,P=u*c,C=u*p,T=u*m,D=i[0],F=i[1],k=i[2],B=n[0],U=n[1],z=n[2],q=(1-(E+I))*D,Z=(v+T)*D,Q=(x-C)*D,V=(v-T)*F,ae=(1-(y+I))*F,Y=(M+P)*F,he=(x+C)*k,J=(M-P)*k,ne=(1-(y+E))*k;return t[0]=q,t[1]=Z,t[2]=Q,t[3]=0,t[4]=V,t[5]=ae,t[6]=Y,t[7]=0,t[8]=he,t[9]=J,t[10]=ne,t[11]=0,t[12]=r[0]+B-(q*B+V*U+he*z),t[13]=r[1]+U-(Z*B+ae*U+J*z),t[14]=r[2]+z-(Q*B+Y*U+ne*z),t[15]=1,t}s(rre,"fromRotationTranslationScaleOrigin");function ire(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,l=i+i,u=n+n,c=r*o,p=i*o,m=i*l,y=n*o,v=n*l,x=n*u,E=a*o,M=a*l,I=a*u;return t[0]=1-m-x,t[1]=p+I,t[2]=y-M,t[3]=0,t[4]=p-I,t[5]=1-c-x,t[6]=v+E,t[7]=0,t[8]=y+M,t[9]=v-E,t[10]=1-c-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}s(ire,"fromQuat");function nre(t,e,r,i,n,a,o){var l=1/(r-e),u=1/(n-i),c=1/(a-o);return t[0]=a*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*u,t[6]=0,t[7]=0,t[8]=(r+e)*l,t[9]=(n+i)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}s(nre,"frustum");function Y7(t,e,r,i,n){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(i-n),t[10]=(n+i)*o,t[14]=2*n*i*o):(t[10]=-1,t[14]=-2*i),t}s(Y7,"perspectiveNO");var m8e=Y7;function are(t,e,r,i,n){var a=1/Math.tan(e/2),o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(i-n),t[10]=n*o,t[14]=n*i*o):(t[10]=-1,t[14]=-i),t}s(are,"perspectiveZO");function ore(t,e,r,i){var n=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),l=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+l),c=2/(n+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((o-l)*u*.5),t[9]=(n-a)*c*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}s(ore,"perspectiveFromFieldOfView");function K7(t,e,r,i,n,a,o){var l=1/(e-r),u=1/(i-n),c=1/(a-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*l,t[13]=(n+i)*u,t[14]=(o+a)*c,t[15]=1,t}s(K7,"orthoNO");var g8e=K7;function sre(t,e,r,i,n,a,o){var l=1/(e-r),u=1/(i-n),c=1/(a-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*l,t[13]=(n+i)*u,t[14]=a*c,t[15]=1,t}s(sre,"orthoZO");function lre(t,e,r,i){var n,a,o,l,u,c,p,m,y,v,x=e[0],E=e[1],M=e[2],I=i[0],P=i[1],C=i[2],T=r[0],D=r[1],F=r[2];return Math.abs(x-T)<Bi&&Math.abs(E-D)<Bi&&Math.abs(M-F)<Bi?q7(t):(p=x-T,m=E-D,y=M-F,v=1/Math.hypot(p,m,y),p*=v,m*=v,y*=v,n=P*y-C*m,a=C*p-I*y,o=I*m-P*p,v=Math.hypot(n,a,o),v?(v=1/v,n*=v,a*=v,o*=v):(n=0,a=0,o=0),l=m*o-y*a,u=y*n-p*o,c=p*a-m*n,v=Math.hypot(l,u,c),v?(v=1/v,l*=v,u*=v,c*=v):(l=0,u=0,c=0),t[0]=n,t[1]=l,t[2]=p,t[3]=0,t[4]=a,t[5]=u,t[6]=m,t[7]=0,t[8]=o,t[9]=c,t[10]=y,t[11]=0,t[12]=-(n*x+a*E+o*M),t[13]=-(l*x+u*E+c*M),t[14]=-(p*x+m*E+y*M),t[15]=1,t)}s(lre,"lookAt");function ure(t,e,r,i){var n=e[0],a=e[1],o=e[2],l=i[0],u=i[1],c=i[2],p=n-r[0],m=a-r[1],y=o-r[2],v=p*p+m*m+y*y;v>0&&(v=1/Math.sqrt(v),p*=v,m*=v,y*=v);var x=u*y-c*m,E=c*p-l*y,M=l*m-u*p;return v=x*x+E*E+M*M,v>0&&(v=1/Math.sqrt(v),x*=v,E*=v,M*=v),t[0]=x,t[1]=E,t[2]=M,t[3]=0,t[4]=m*M-y*E,t[5]=y*x-p*M,t[6]=p*E-m*x,t[7]=0,t[8]=p,t[9]=m,t[10]=y,t[11]=0,t[12]=n,t[13]=a,t[14]=o,t[15]=1,t}s(ure,"targetTo");function cre(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}s(cre,"str");function hre(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}s(hre,"frob");function pre(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}s(pre,"add");function J7(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}s(J7,"subtract");function dre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}s(dre,"multiplyScalar");function fre(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}s(fre,"multiplyScalarAndAdd");function mre(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}s(mre,"exactEquals");function gre(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7],p=t[8],m=t[9],y=t[10],v=t[11],x=t[12],E=t[13],M=t[14],I=t[15],P=e[0],C=e[1],T=e[2],D=e[3],F=e[4],k=e[5],B=e[6],U=e[7],z=e[8],q=e[9],Z=e[10],Q=e[11],V=e[12],ae=e[13],Y=e[14],he=e[15];return Math.abs(r-P)<=Bi*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(i-C)<=Bi*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(n-T)<=Bi*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(a-D)<=Bi*Math.max(1,Math.abs(a),Math.abs(D))&&Math.abs(o-F)<=Bi*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(l-k)<=Bi*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-B)<=Bi*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(c-U)<=Bi*Math.max(1,Math.abs(c),Math.abs(U))&&Math.abs(p-z)<=Bi*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(m-q)<=Bi*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(y-Z)<=Bi*Math.max(1,Math.abs(y),Math.abs(Z))&&Math.abs(v-Q)<=Bi*Math.max(1,Math.abs(v),Math.abs(Q))&&Math.abs(x-V)<=Bi*Math.max(1,Math.abs(x),Math.abs(V))&&Math.abs(E-ae)<=Bi*Math.max(1,Math.abs(E),Math.abs(ae))&&Math.abs(M-Y)<=Bi*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(I-he)<=Bi*Math.max(1,Math.abs(I),Math.abs(he))}s(gre,"equals");var y8e=W7,v8e=J7,kh={};kl(kh,{add:()=>bre,angle:()=>$re,bezier:()=>kre,ceil:()=>wre,clone:()=>yre,copy:()=>_re,create:()=>Q7,cross:()=>Dre,dist:()=>w8e,distance:()=>nF,div:()=>b8e,divide:()=>iF,dot:()=>sF,equals:()=>Wre,exactEquals:()=>qre,floor:()=>Are,forEach:()=>E8e,fromValues:()=>vre,hermite:()=>Ore,inverse:()=>Pre,len:()=>S8e,length:()=>eF,lerp:()=>Rre,max:()=>Mre,min:()=>Sre,mul:()=>x8e,multiply:()=>rF,negate:()=>Tre,normalize:()=>Lre,random:()=>Nre,rotateX:()=>Ure,rotateY:()=>Vre,rotateZ:()=>jre,round:()=>Ere,scale:()=>Cre,scaleAndAdd:()=>Ire,set:()=>xre,sqrDist:()=>A8e,sqrLen:()=>M8e,squaredDistance:()=>aF,squaredLength:()=>oF,str:()=>Hre,sub:()=>_8e,subtract:()=>tF,transformMat3:()=>Bre,transformMat4:()=>Fre,transformQuat:()=>zre,zero:()=>Gre});N();function Q7(){var t=new Ra(3);return Ra!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}s(Q7,"create");function yre(t){var e=new Ra(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}s(yre,"clone");function eF(t){var e=t[0],r=t[1],i=t[2];return Math.hypot(e,r,i)}s(eF,"length");function vre(t,e,r){var i=new Ra(3);return i[0]=t,i[1]=e,i[2]=r,i}s(vre,"fromValues");function _re(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}s(_re,"copy");function xre(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}s(xre,"set");function bre(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}s(bre,"add");function tF(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}s(tF,"subtract");function rF(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}s(rF,"multiply");function iF(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}s(iF,"divide");function wre(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}s(wre,"ceil");function Are(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}s(Are,"floor");function Sre(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}s(Sre,"min");function Mre(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}s(Mre,"max");function Ere(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}s(Ere,"round");function Cre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}s(Cre,"scale");function Ire(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}s(Ire,"scaleAndAdd");function nF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.hypot(r,i,n)}s(nF,"distance");function aF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n}s(aF,"squaredDistance");function oF(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}s(oF,"squaredLength");function Tre(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}s(Tre,"negate");function Pre(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}s(Pre,"inverse");function Lre(t,e){var r=e[0],i=e[1],n=e[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}s(Lre,"normalize");function sF(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}s(sF,"dot");function Dre(t,e,r){var i=e[0],n=e[1],a=e[2],o=r[0],l=r[1],u=r[2];return t[0]=n*u-a*l,t[1]=a*o-i*u,t[2]=i*l-n*o,t}s(Dre,"cross");function Rre(t,e,r,i){var n=e[0],a=e[1],o=e[2];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=o+i*(r[2]-o),t}s(Rre,"lerp");function Ore(t,e,r,i,n,a){var o=a*a,l=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),p=o*(3-2*a);return t[0]=e[0]*l+r[0]*u+i[0]*c+n[0]*p,t[1]=e[1]*l+r[1]*u+i[1]*c+n[1]*p,t[2]=e[2]*l+r[2]*u+i[2]*c+n[2]*p,t}s(Ore,"hermite");function kre(t,e,r,i,n,a){var o=1-a,l=o*o,u=a*a,c=l*o,p=3*a*l,m=3*u*o,y=u*a;return t[0]=e[0]*c+r[0]*p+i[0]*m+n[0]*y,t[1]=e[1]*c+r[1]*p+i[1]*m+n[1]*y,t[2]=e[2]*c+r[2]*p+i[2]*m+n[2]*y,t}s(kre,"bezier");function Nre(t,e){e=e||1;var r=Sy()*2*Math.PI,i=Sy()*2-1,n=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t[2]=i*e,t}s(Nre,"random");function Fre(t,e,r){var i=e[0],n=e[1],a=e[2],o=r[3]*i+r[7]*n+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/o,t[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/o,t[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/o,t}s(Fre,"transformMat4");function Bre(t,e,r){var i=e[0],n=e[1],a=e[2];return t[0]=i*r[0]+n*r[3]+a*r[6],t[1]=i*r[1]+n*r[4]+a*r[7],t[2]=i*r[2]+n*r[5]+a*r[8],t}s(Bre,"transformMat3");function zre(t,e,r){var i=r[0],n=r[1],a=r[2],o=r[3],l=e[0],u=e[1],c=e[2],p=n*c-a*u,m=a*l-i*c,y=i*u-n*l,v=n*y-a*m,x=a*p-i*y,E=i*m-n*p,M=o*2;return p*=M,m*=M,y*=M,v*=2,x*=2,E*=2,t[0]=l+p+v,t[1]=u+m+x,t[2]=c+y+E,t}s(zre,"transformQuat");function Ure(t,e,r,i){var n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}s(Ure,"rotateX");function Vre(t,e,r,i){var n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}s(Vre,"rotateY");function jre(t,e,r,i){var n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}s(jre,"rotateZ");function $re(t,e){var r=t[0],i=t[1],n=t[2],a=e[0],o=e[1],l=e[2],u=Math.sqrt(r*r+i*i+n*n),c=Math.sqrt(a*a+o*o+l*l),p=u*c,m=p&&sF(t,e)/p;return Math.acos(Math.min(Math.max(m,-1),1))}s($re,"angle");function Gre(t){return t[0]=0,t[1]=0,t[2]=0,t}s(Gre,"zero");function Hre(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}s(Hre,"str");function qre(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}s(qre,"exactEquals");function Wre(t,e){var r=t[0],i=t[1],n=t[2],a=e[0],o=e[1],l=e[2];return Math.abs(r-a)<=Bi*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=Bi*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=Bi*Math.max(1,Math.abs(n),Math.abs(l))}s(Wre,"equals");var _8e=tF,x8e=rF,b8e=iF,w8e=nF,A8e=aF,S8e=eF,M8e=oF,E8e=function(){var t=Q7();return function(e,r,i,n,a,o){var l,u;for(r||(r=3),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,l=i;l<u;l+=r)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,o),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}}(),Kl={};kl(Kl,{add:()=>Jre,ceil:()=>Qre,clone:()=>Xre,copy:()=>Yre,create:()=>lF,cross:()=>cie,dist:()=>P8e,distance:()=>pF,div:()=>T8e,divide:()=>hF,dot:()=>uie,equals:()=>vie,exactEquals:()=>yie,floor:()=>eie,forEach:()=>O8e,fromValues:()=>Zre,inverse:()=>sie,len:()=>D8e,length:()=>fF,lerp:()=>hie,max:()=>rie,min:()=>tie,mul:()=>I8e,multiply:()=>cF,negate:()=>oie,normalize:()=>lie,random:()=>pie,round:()=>iie,scale:()=>nie,scaleAndAdd:()=>aie,set:()=>Kre,sqrDist:()=>L8e,sqrLen:()=>R8e,squaredDistance:()=>dF,squaredLength:()=>mF,str:()=>gie,sub:()=>C8e,subtract:()=>uF,transformMat4:()=>die,transformQuat:()=>fie,zero:()=>mie});N();function lF(){var t=new Ra(4);return Ra!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}s(lF,"create");function Xre(t){var e=new Ra(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}s(Xre,"clone");function Zre(t,e,r,i){var n=new Ra(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}s(Zre,"fromValues");function Yre(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}s(Yre,"copy");function Kre(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}s(Kre,"set");function Jre(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}s(Jre,"add");function uF(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}s(uF,"subtract");function cF(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}s(cF,"multiply");function hF(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}s(hF,"divide");function Qre(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}s(Qre,"ceil");function eie(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}s(eie,"floor");function tie(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}s(tie,"min");function rie(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}s(rie,"max");function iie(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}s(iie,"round");function nie(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}s(nie,"scale");function aie(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}s(aie,"scaleAndAdd");function pF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return Math.hypot(r,i,n,a)}s(pF,"distance");function dF(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return r*r+i*i+n*n+a*a}s(dF,"squaredDistance");function fF(t){var e=t[0],r=t[1],i=t[2],n=t[3];return Math.hypot(e,r,i,n)}s(fF,"length");function mF(t){var e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n}s(mF,"squaredLength");function oie(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}s(oie,"negate");function sie(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}s(sie,"inverse");function lie(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r*r+i*i+n*n+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=i*o,t[2]=n*o,t[3]=a*o,t}s(lie,"normalize");function uie(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}s(uie,"dot");function cie(t,e,r,i){var n=r[0]*i[1]-r[1]*i[0],a=r[0]*i[2]-r[2]*i[0],o=r[0]*i[3]-r[3]*i[0],l=r[1]*i[2]-r[2]*i[1],u=r[1]*i[3]-r[3]*i[1],c=r[2]*i[3]-r[3]*i[2],p=e[0],m=e[1],y=e[2],v=e[3];return t[0]=m*c-y*u+v*l,t[1]=-(p*c)+y*o-v*a,t[2]=p*u-m*o+v*n,t[3]=-(p*l)+m*a-y*n,t}s(cie,"cross");function hie(t,e,r,i){var n=e[0],a=e[1],o=e[2],l=e[3];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=o+i*(r[2]-o),t[3]=l+i*(r[3]-l),t}s(hie,"lerp");function pie(t,e){e=e||1;var r,i,n,a,o,l;do r=Sy()*2-1,i=Sy()*2-1,o=r*r+i*i;while(o>=1);do n=Sy()*2-1,a=Sy()*2-1,l=n*n+a*a;while(l>=1);var u=Math.sqrt((1-o)/l);return t[0]=e*r,t[1]=e*i,t[2]=e*n*u,t[3]=e*a*u,t}s(pie,"random");function die(t,e,r){var i=e[0],n=e[1],a=e[2],o=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*o,t[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*o,t[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*o,t[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*o,t}s(die,"transformMat4");function fie(t,e,r){var i=e[0],n=e[1],a=e[2],o=r[0],l=r[1],u=r[2],c=r[3],p=c*i+l*a-u*n,m=c*n+u*i-o*a,y=c*a+o*n-l*i,v=-o*i-l*n-u*a;return t[0]=p*c+v*-o+m*-u-y*-l,t[1]=m*c+v*-l+y*-o-p*-u,t[2]=y*c+v*-u+p*-l-m*-o,t[3]=e[3],t}s(fie,"transformQuat");function mie(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}s(mie,"zero");function gie(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}s(gie,"str");function yie(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}s(yie,"exactEquals");function vie(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=Bi*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=Bi*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=Bi*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-c)<=Bi*Math.max(1,Math.abs(a),Math.abs(c))}s(vie,"equals");var C8e=uF,I8e=cF,T8e=hF,P8e=pF,L8e=dF,D8e=fF,R8e=mF,O8e=function(){var t=lF();return function(e,r,i,n,a,o){var l,u;for(r||(r=4),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,l=i;l<u;l+=r)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,o),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}}(),gF={};kl(gF,{add:()=>Aie,angle:()=>$ie,ceil:()=>Sie,clone:()=>_ie,copy:()=>bie,create:()=>yF,cross:()=>kie,dist:()=>z8e,distance:()=>bF,div:()=>B8e,divide:()=>xF,dot:()=>Oie,equals:()=>Wie,exactEquals:()=>qie,floor:()=>Mie,forEach:()=>j8e,fromValues:()=>xie,inverse:()=>Die,len:()=>k8e,length:()=>AF,lerp:()=>Nie,max:()=>Cie,min:()=>Eie,mul:()=>F8e,multiply:()=>_F,negate:()=>Lie,normalize:()=>Rie,random:()=>Fie,rotate:()=>jie,round:()=>Iie,scale:()=>Tie,scaleAndAdd:()=>Pie,set:()=>wie,sqrDist:()=>U8e,sqrLen:()=>V8e,squaredDistance:()=>wF,squaredLength:()=>SF,str:()=>Hie,sub:()=>N8e,subtract:()=>vF,transformMat2:()=>Bie,transformMat2d:()=>zie,transformMat3:()=>Uie,transformMat4:()=>Vie,zero:()=>Gie});N();function yF(){var t=new Ra(2);return Ra!=Float32Array&&(t[0]=0,t[1]=0),t}s(yF,"create");function _ie(t){var e=new Ra(2);return e[0]=t[0],e[1]=t[1],e}s(_ie,"clone");function xie(t,e){var r=new Ra(2);return r[0]=t,r[1]=e,r}s(xie,"fromValues");function bie(t,e){return t[0]=e[0],t[1]=e[1],t}s(bie,"copy");function wie(t,e,r){return t[0]=e,t[1]=r,t}s(wie,"set");function Aie(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}s(Aie,"add");function vF(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}s(vF,"subtract");function _F(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}s(_F,"multiply");function xF(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}s(xF,"divide");function Sie(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}s(Sie,"ceil");function Mie(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}s(Mie,"floor");function Eie(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}s(Eie,"min");function Cie(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}s(Cie,"max");function Iie(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}s(Iie,"round");function Tie(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}s(Tie,"scale");function Pie(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}s(Pie,"scaleAndAdd");function bF(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.hypot(r,i)}s(bF,"distance");function wF(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}s(wF,"squaredDistance");function AF(t){var e=t[0],r=t[1];return Math.hypot(e,r)}s(AF,"length");function SF(t){var e=t[0],r=t[1];return e*e+r*r}s(SF,"squaredLength");function Lie(t,e){return t[0]=-e[0],t[1]=-e[1],t}s(Lie,"negate");function Die(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}s(Die,"inverse");function Rie(t,e){var r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t}s(Rie,"normalize");function Oie(t,e){return t[0]*e[0]+t[1]*e[1]}s(Oie,"dot");function kie(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}s(kie,"cross");function Nie(t,e,r,i){var n=e[0],a=e[1];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t}s(Nie,"lerp");function Fie(t,e){e=e||1;var r=Sy()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}s(Fie,"random");function Bie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t}s(Bie,"transformMat2");function zie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t}s(zie,"transformMat2d");function Uie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t}s(Uie,"transformMat3");function Vie(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t}s(Vie,"transformMat4");function jie(t,e,r,i){var n=e[0]-r[0],a=e[1]-r[1],o=Math.sin(i),l=Math.cos(i);return t[0]=n*l-a*o+r[0],t[1]=n*o+a*l+r[1],t}s(jie,"rotate");function $ie(t,e){var r=t[0],i=t[1],n=e[0],a=e[1],o=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+a*a),l=o&&(r*n+i*a)/o;return Math.acos(Math.min(Math.max(l,-1),1))}s($ie,"angle");function Gie(t){return t[0]=0,t[1]=0,t}s(Gie,"zero");function Hie(t){return"vec2("+t[0]+", "+t[1]+")"}s(Hie,"str");function qie(t,e){return t[0]===e[0]&&t[1]===e[1]}s(qie,"exactEquals");function Wie(t,e){var r=t[0],i=t[1],n=e[0],a=e[1];return Math.abs(r-n)<=Bi*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-a)<=Bi*Math.max(1,Math.abs(i),Math.abs(a))}s(Wie,"equals");var k8e=AF,N8e=vF,F8e=_F,B8e=xF,z8e=bF,U8e=wF,V8e=SF,j8e=function(){var t=yF();return function(e,r,i,n,a,o){var l,u;for(r||(r=2),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,l=i;l<u;l+=r)t[0]=e[l],t[1]=e[l+1],a(t,t,o),e[l]=t[0],e[l+1]=t[1];return e}}(),$8e=Rr(kn(),1),Xie=class extends id{constructor(e){super(e,c8e)}createBucket(e){return new z7(e)}queryRadius(e){let r=e;return Q1("circle-radius",this,r)+Q1("circle-stroke-width",this,r)+MA(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,i,n,a,o,l,u){let c=EA(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,l),p=this.paint.get("circle-radius").evaluate(r,i),m=this.paint.get("circle-stroke-width").evaluate(r,i),y=p+m,v=this.paint.get("circle-pitch-alignment")==="map",x=v?c:Zie(c,u),E=v?y*l:y;for(let M of n)for(let I of M){let P=v?I:MF(I,u),C=E,T=Kl.transformMat4([],[I.x,I.y,0,1],u);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?C*=T[3]/o.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(C*=o.cameraToCenterDistance/T[3]),Cee(x,P,C))return!0}return!1}};s(Xie,"CircleStyleLayer");var G8e=Xie;function MF(t,e){let r=Kl.transformMat4([],[t.x,t.y,0,1],e);return new $8e.default(r[0]/r[3],r[1]/r[3])}s(MF,"projectPoint");function Zie(t,e){return t.map(r=>MF(r,e))}s(Zie,"projectQueryGeometry");N();N();var Yie=class extends z7{};s(Yie,"HeatmapBucket");var Kie=Yie;Lr("HeatmapBucket",Kie,{omit:["layers"]});N();var UH,H8e=s(()=>UH=UH||new $u({"heatmap-radius":new pi(Ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pi(Ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Hr(Ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _7(Ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Hr(Ut.paint_heatmap["heatmap-opacity"])}),"getPaint"),q8e={get paint(){return H8e()}};N();N();function _P(t,{width:e,height:r},i,n){if(!n)n=new Uint8Array(e*r*i);else if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*r*i)throw new RangeError("mismatched image size. expected: ".concat(n.length," but got: ").concat(e*r*i));return t.width=e,t.height=r,t.data=n,t}s(_P,"createImage");function EF(t,{width:e,height:r},i){if(e===t.width&&r===t.height)return;let n=_P({},{width:e,height:r},i);xP(t,n,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},i),t.width=e,t.height=r,t.data=n.data}s(EF,"resizeImage");function xP(t,e,r,i,n,a){if(n.width===0||n.height===0)return e;if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||i.x>e.width-n.width||i.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");let o=t.data,l=e.data;if(o===l)throw new Error("srcData equals dstData, so image is already copied");for(let u=0;u<n.height;u++){let c=((r.y+u)*t.width+r.x)*a,p=((i.y+u)*e.width+i.x)*a;for(let m=0;m<n.width*a;m++)l[p+m]=o[c+m]}return e}s(xP,"copyImage");var Jie=class Qie{constructor(e,r){_P(this,e,1,r)}resize(e){EF(this,e,1)}clone(){return new Qie({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,i,n,a){xP(e,r,i,n,a,1)}};s(Jie,"AlphaImage");var CF=Jie,ene=class tne{constructor(e,r){_P(this,e,4,r)}resize(e){EF(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new tne({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,i,n,a){xP(e,r,i,n,a,4)}};s(ene,"RGBAImage");var mo=ene;Lr("AlphaImage",CF);Lr("RGBAImage",mo);function IF(t){let e={},r=t.resolution||256,i=t.clips?t.clips.length:1,n=t.image||new mo({width:r,height:i});if(!aZ(r))throw new Error("width is not a power of 2 - ".concat(r));let a=s((o,l,u)=>{e[t.evaluationKey]=u;let c=t.expression.evaluate(e);n.data[o+l+0]=Math.floor(c.r*255/c.a),n.data[o+l+1]=Math.floor(c.g*255/c.a),n.data[o+l+2]=Math.floor(c.b*255/c.a),n.data[o+l+3]=Math.floor(c.a*255)},"renderPixel");if(t.clips)for(let o=0,l=0;o<i;++o,l+=r*4)for(let u=0,c=0;u<r;u++,c+=4){let p=u/(r-1),{start:m,end:y}=t.clips[o],v=m*(1-p)+y*p;a(l,c,v)}else for(let o=0,l=0;o<r;o++,l+=4){let u=o/(r-1);a(0,l,u)}return n}s(IF,"renderColorRamp");var rne=class extends id{createBucket(e){return new Kie(e)}constructor(e){super(e,q8e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=IF({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};s(rne,"HeatmapStyleLayer");var W8e=rne;N();N();var VH,X8e=s(()=>VH=VH||new $u({"hillshade-illumination-direction":new Hr(Ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Hr(Ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Hr(Ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Hr(Ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Hr(Ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Hr(Ut.paint_hillshade["hillshade-accent-color"])}),"getPaint"),Z8e={get paint(){return X8e()}},ine=class extends id{constructor(e){super(e,Z8e)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};s(ine,"HillshadeStyleLayer");var Y8e=ine;N();N();N();var K8e=no([{name:"a_pos",components:2,type:"Int16"}],4),{members:J8e,size:Eat,alignment:Cat}=K8e,Q8e=Rr(w9(),1);N();N();function nne(t,e,r,i,n){TF(t,e,r||0,i||t.length-1,n||ane)}s(nne,"quickselect");function TF(t,e,r,i,n){for(;i>r;){if(i-r>600){var a=i-r+1,o=e-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(o-a/2<0?-1:1),p=Math.max(r,Math.floor(e-o*u/a+c)),m=Math.min(i,Math.floor(e+(a-o)*u/a+c));TF(t,e,p,m,n)}var y=t[e],v=r,x=i;for(A0(t,r,e),n(t[i],y)>0&&A0(t,r,i);v<x;){for(A0(t,v,x),v++,x--;n(t[v],y)<0;)v++;for(;n(t[x],y)>0;)x--}n(t[r],y)===0?A0(t,r,x):(x++,A0(t,x,i)),x<=e&&(r=x+1),e<=x&&(i=x-1)}}s(TF,"quickselectStep");function A0(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}s(A0,"swap");function ane(t,e){return t<e?-1:t>e?1:0}s(ane,"defaultCompare");function PF(t,e){let r=t.length;if(r<=1)return[t];let i=[],n,a;for(let o=0;o<r;o++){let l=uZ(t[o]);l!==0&&(t[o].area=Math.abs(l),a===void 0&&(a=l<0),a===l<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}if(n&&i.push(n),e>1)for(let o=0;o<i.length;o++)i[o].length<=e||(nne(i[o],e,1,i[o].length-1,one),i[o]=i[o].slice(0,e));return i}s(PF,"classifyRings");function one(t,e){return e.area-t.area}s(one,"compareAreas");N();function bP(t,e,r){let i=r.patternDependencies,n=!1;for(let a of e){let o=a.paint.get("".concat(t,"-pattern"));o.isConstant()||(n=!0);let l=o.constantOr(null);l&&(n=!0,i[l.to]=!0,i[l.from]=!0)}return n}s(bP,"hasPattern");function wP(t,e,r,i,n){let a=n.patternDependencies;for(let o of e){let l=o.paint.get("".concat(t,"-pattern")).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:i-1},r,{},n.availableImages),c=l.evaluate({zoom:i},r,{},n.availableImages),p=l.evaluate({zoom:i+1},r,{},n.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,a[u]=!0,a[c]=!0,a[p]=!0,r.patterns[o.id]={min:u,mid:c,max:p}}}return r}s(wP,"addPatternDependencies");var eNe=500,sne=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new qke,this.indexArray=new cv,this.indexArray2=new P6,this.programConfigurations=new Hy(e.layers,e.zoom),this.segments=new Io,this.segments2=new Io,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){this.hasPattern=bP("fill",this.layers,r);let n=this.layers[0].layout.get("fill-sort-key"),a=!n.isConstant(),o=[];for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let m=this.layers[0]._featureFilter.needGeometry,y=sg(l,m);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),y,i))continue;let v=a?n.evaluate(y,{},i,r.availableImages):void 0,x={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:m?y.geometry:og(l),patterns:{},sortKey:v};o.push(x)}a&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l;if(this.hasPattern){let y=wP("fill",this.layers,l,this.zoom,r);this.patternFeatures.push(y)}else this.addFeature(l,u,c,i,{});let m=e[c].feature;r.featureIndex.insert(m,u,c,p,this.index)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}addFeatures(e,r,i){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,r,i)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J8e),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,i,n,a){for(let o of PF(r,eNe)){let l=0;for(let v of o)l+=v.length;let u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),c=u.vertexLength,p=[],m=[];for(let v of o){if(v.length===0)continue;v!==o[0]&&m.push(p.length/2);let x=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),E=x.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(E+v.length-1,E),p.push(v[0].x),p.push(v[0].y);for(let M=1;M<v.length;M++)this.layoutVertexArray.emplaceBack(v[M].x,v[M].y),this.indexArray2.emplaceBack(E+M-1,E+M),p.push(v[M].x),p.push(v[M].y);x.vertexLength+=v.length,x.primitiveLength+=v.length}let y=(0,Q8e.default)(p,m);for(let v=0;v<y.length;v+=3)this.indexArray.emplaceBack(c+y[v],c+y[v+1],c+y[v+2]);u.vertexLength+=l,u.primitiveLength+=y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,a,n)}};s(sne,"FillBucket");var lne=sne;Lr("FillBucket",lne,{omit:["layers","patternFeatures"]});N();var jH,tNe=s(()=>jH=jH||new $u({"fill-sort-key":new pi(Ut.layout_fill["fill-sort-key"])}),"getLayout"),$H,rNe=s(()=>$H=$H||new $u({"fill-antialias":new Hr(Ut.paint_fill["fill-antialias"]),"fill-opacity":new pi(Ut.paint_fill["fill-opacity"]),"fill-color":new pi(Ut.paint_fill["fill-color"]),"fill-outline-color":new pi(Ut.paint_fill["fill-outline-color"]),"fill-translate":new Hr(Ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Hr(Ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new fP(Ut.paint_fill["fill-pattern"])}),"getPaint"),iNe={get paint(){return rNe()},get layout(){return tNe()}},une=class extends id{constructor(e){super(e,iNe)}recalculate(e,r){super.recalculate(e,r);let i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new lne(e)}queryRadius(){return MA(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,i,n,a,o,l){let u=EA(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,l);return V7(u,n)}isTileClipped(){return!0}};s(une,"FillStyleLayer");var nNe=une;N();N();N();var aNe=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),oNe=no([{name:"a_centroid",components:2,type:"Int16"}],4),{members:sNe,size:Pat,alignment:Lat}=aNe,lNe=Rr(w9(),1),uNe=Rr(q3(),1),cNe=uNe.default.VectorTileFeature.types,hNe=500,LL=Math.pow(2,13);function S0(t,e,r,i,n,a,o,l){t.emplaceBack(e,r,Math.floor(i*LL)*2+o,n*LL*2,a*LL*2,Math.round(l))}s(S0,"addVertex");var cne=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Wke,this.centroidVertexArray=new BE,this.indexArray=new cv,this.programConfigurations=new Hy(e.layers,e.zoom),this.segments=new Io,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){this.features=[],this.hasPattern=bP("fill-extrusion",this.layers,r);for(let{feature:n,id:a,index:o,sourceLayerIndex:l}of e){let u=this.layers[0]._featureFilter.needGeometry,c=sg(n,u);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),c,i))continue;let p={id:a,sourceLayerIndex:l,index:o,geometry:u?c.geometry:og(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(wP("fill-extrusion",this.layers,p,this.zoom,r)):this.addFeature(p,p.geometry,o,i,{}),r.featureIndex.insert(n,p.geometry,o,l,this.index,!0)}}addFeatures(e,r,i){for(let n of this.features){let{geometry:a}=n;this.addFeature(n,a,n.index,r,i)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sNe),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,oNe.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,i,n,a){let o={x:0,y:0,vertexCount:0};for(let l of PF(r,hNe)){let u=0;for(let x of l)u+=x.length;let c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let x of l){if(x.length===0||dne(x))continue;let E=0;for(let M=0;M<x.length;M++){let I=x[M];if(M>=1){let P=x[M-1];if(!pne(I,P)){c.vertexLength+4>Io.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let C=I.sub(P)._perp()._unit(),T=P.dist(I);E+T>32768&&(E=0),S0(this.layoutVertexArray,I.x,I.y,C.x,C.y,0,0,E),S0(this.layoutVertexArray,I.x,I.y,C.x,C.y,0,1,E),o.x+=2*I.x,o.y+=2*I.y,o.vertexCount+=2,E+=T,S0(this.layoutVertexArray,P.x,P.y,C.x,C.y,0,0,E),S0(this.layoutVertexArray,P.x,P.y,C.x,C.y,0,1,E),o.x+=2*P.x,o.y+=2*P.y,o.vertexCount+=2;let D=c.vertexLength;this.indexArray.emplaceBack(D,D+2,D+1),this.indexArray.emplaceBack(D+1,D+2,D+3),c.vertexLength+=4,c.primitiveLength+=2}}}}if(c.vertexLength+u>Io.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),cNe[e.type]!=="Polygon")continue;let p=[],m=[],y=c.vertexLength;for(let x of l)if(x.length!==0){x!==l[0]&&m.push(p.length/2);for(let E=0;E<x.length;E++){let M=x[E];S0(this.layoutVertexArray,M.x,M.y,0,0,1,1,0),o.x+=M.x,o.y+=M.y,o.vertexCount+=1,p.push(M.x),p.push(M.y)}}let v=(0,lNe.default)(p,m);for(let x=0;x<v.length;x+=3)this.indexArray.emplaceBack(y+v[x],y+v[x+2],y+v[x+1]);c.primitiveLength+=v.length/3,c.vertexLength+=u}for(let l=0;l<o.vertexCount;l++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,a,n)}};s(cne,"FillExtrusionBucket");var hne=cne;Lr("FillExtrusionBucket",hne,{omit:["layers","features"]});function pne(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}s(pne,"isBoundaryEdge");function dne(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}s(dne,"isEntirelyOutside");N();var GH,pNe=s(()=>GH=GH||new $u({"fill-extrusion-opacity":new Hr(Ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pi(Ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Hr(Ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Hr(Ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fP(Ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pi(Ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pi(Ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Hr(Ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),"getPaint"),dNe={get paint(){return pNe()}},z6=Rr(kn(),1),fne=class extends id{constructor(e){super(e,dNe)}createBucket(e){return new hne(e)}queryRadius(){return MA(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,i,n,a,o,l,u){let c=EA(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,l),p=this.paint.get("fill-extrusion-height").evaluate(r,i),m=this.paint.get("fill-extrusion-base").evaluate(r,i),y=yne(c,u,o,0),v=gne(n,m,p,u),x=v[0],E=v[1];return mne(x,E,y)}};s(fne,"FillExtrusionStyleLayer");var fNe=fne;function M0(t,e){return t.x*e.x+t.y*e.y}s(M0,"dot");function U6(t,e){if(t.length===1){let r=0,i=e[r++],n;for(;!n||i.equals(n);)if(n=e[r++],!n)return 1/0;for(;r<e.length;r++){let a=e[r],o=t[0],l=n.sub(i),u=a.sub(i),c=o.sub(i),p=M0(l,l),m=M0(l,u),y=M0(u,u),v=M0(c,l),x=M0(c,u),E=p*y-m*m,M=(y*v-m*x)/E,I=(p*x-m*v)/E,P=1-M-I,C=i.z*P+n.z*M+a.z*I;if(isFinite(C))return C}return 1/0}else{let r=1/0;for(let i of e)r=Math.min(r,i.z);return r}}s(U6,"getIntersectionDistance");function mne(t,e,r){let i=1/0;V7(r,e)&&(i=U6(r,e[0]));for(let n=0;n<e.length;n++){let a=e[n],o=t[n];for(let l=0;l<a.length-1;l++){let u=a[l],c=a[l+1],p=o[l],m=o[l+1],y=[u,c,m,p,u];U7(r,y)&&(i=Math.min(i,U6(r,y)))}}return i===1/0?!1:i}s(mne,"checkIntersection");function gne(t,e,r,i){let n=[],a=[],o=i[8]*e,l=i[9]*e,u=i[10]*e,c=i[11]*e,p=i[8]*r,m=i[9]*r,y=i[10]*r,v=i[11]*r;for(let x of t){let E=[],M=[];for(let I of x){let P=I.x,C=I.y,T=i[0]*P+i[4]*C+i[12],D=i[1]*P+i[5]*C+i[13],F=i[2]*P+i[6]*C+i[14],k=i[3]*P+i[7]*C+i[15],B=T+o,U=D+l,z=F+u,q=k+c,Z=T+p,Q=D+m,V=F+y,ae=k+v,Y=new z6.default(B/q,U/q);Y.z=z/q,E.push(Y);let he=new z6.default(Z/ae,Q/ae);he.z=V/ae,M.push(he)}n.push(E),a.push(M)}return[n,a]}s(gne,"projectExtrusion");function yne(t,e,r,i){let n=[];for(let a of t){let o=[a.x,a.y,i,1];Kl.transformMat4(o,o,e),n.push(new z6.default(o[0]/o[3],o[1]/o[3]))}return n}s(yne,"projectQueryGeometry");N();N();N();var mNe=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:gNe,size:Oat,alignment:kat}=mNe;N();var yNe=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:vNe,size:Nat,alignment:Fat}=yNe,_Ne=Rr(q3(),1),xNe=_Ne.default.VectorTileFeature.types,HH=63,bNe=Math.cos(75/2*(Math.PI/180)),wNe=15,ANe=20,SNe=15,vne=1/2,qH=Math.pow(2,SNe-1)/vne,_ne=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Xke,this.layoutVertexArray2=new Zke,this.indexArray=new cv,this.programConfigurations=new Hy(e.layers,e.zoom),this.segments=new Io,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i){this.hasPattern=bP("line",this.layers,r);let n=this.layers[0].layout.get("line-sort-key"),a=!n.isConstant(),o=[];for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let m=this.layers[0]._featureFilter.needGeometry,y=sg(l,m);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),y,i))continue;let v=a?n.evaluate(y,{},i):void 0,x={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:m?y.geometry:og(l),patterns:{},sortKey:v};o.push(x)}a&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l;if(this.hasPattern){let y=wP("line",this.layers,l,this.zoom,r);this.patternFeatures.push(y)}else this.addFeature(l,u,c,i,{});let m=e[c].feature;r.featureIndex.insert(m,u,c,p,this.index)}}update(e,r,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,i)}addFeatures(e,r,i){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,r,i)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,vNe)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gNe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,i=+e.properties.mapbox_clip_end;return{start:r,end:i}}}addFeature(e,r,i,n,a){let o=this.layers[0].layout,l=o.get("line-join").evaluate(e,{}),u=o.get("line-cap"),c=o.get("line-miter-limit"),p=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let m of r)this.addLine(m,e,l,u,c,p);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,a,n)}addLine(e,r,i,n,a,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let I=0;I<e.length-1;I++)this.totalDistance+=e[I].dist(e[I+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let l=xNe[r.type]==="Polygon",u=e.length;for(;u>=2&&e[u-1].equals(e[u-2]);)u--;let c=0;for(;c<u-1&&e[c].equals(e[c+1]);)c++;if(u<(l?3:2))return;i==="bevel"&&(a=1.05);let p=this.overscaling<=16?wNe*8192/(512*this.overscaling):0,m=this.segments.prepareSegment(u*10,this.layoutVertexArray,this.indexArray),y,v,x,E,M;this.e1=this.e2=-1,l&&(y=e[u-2],M=e[c].sub(y)._unit()._perp());for(let I=c;I<u;I++){if(x=I===u-1?l?e[c+1]:void 0:e[I+1],x&&e[I].equals(x))continue;M&&(E=M),y&&(v=y),y=e[I],M=x?x.sub(y)._unit()._perp():E,E=E||M;let P=E.add(M);(P.x!==0||P.y!==0)&&P._unit();let C=E.x*M.x+E.y*M.y,T=P.x*M.x+P.y*M.y,D=T!==0?1/T:1/0,F=2*Math.sqrt(2-2*T),k=T<bNe&&v&&x,B=E.x*M.y-E.y*M.x>0;if(k&&I>c){let q=y.dist(v);if(q>2*p){let Z=y.sub(y.sub(v)._mult(p/q)._round());this.updateDistance(v,Z),this.addCurrentVertex(Z,E,0,0,m),v=Z}}let U=v&&x,z=U?i:l?"butt":n;if(U&&z==="round"&&(D<o?z="miter":D<=2&&(z="fakeround")),z==="miter"&&D>a&&(z="bevel"),z==="bevel"&&(D>2&&(z="flipbevel"),D<a&&(z="miter")),v&&this.updateDistance(v,y),z==="miter")P._mult(D),this.addCurrentVertex(y,P,0,0,m);else if(z==="flipbevel"){if(D>100)P=M.mult(-1);else{let q=D*E.add(M).mag()/E.sub(M).mag();P._perp()._mult(q*(B?-1:1))}this.addCurrentVertex(y,P,0,0,m),this.addCurrentVertex(y,P.mult(-1),0,0,m)}else if(z==="bevel"||z==="fakeround"){let q=-Math.sqrt(D*D-1),Z=B?q:0,Q=B?0:q;if(v&&this.addCurrentVertex(y,E,Z,Q,m),z==="fakeround"){let V=Math.round(F*180/Math.PI/ANe);for(let ae=1;ae<V;ae++){let Y=ae/V;if(Y!==.5){let J=Y-.5,ne=1.0904+C*(-3.2452+C*(3.55645-C*1.43519)),ee=.848013+C*(-1.06021+C*.215638);Y=Y+Y*J*(Y-1)*(ne*J*J+ee)}let he=M.sub(E)._mult(Y)._add(E)._unit()._mult(B?-1:1);this.addHalfVertex(y,he.x,he.y,!1,B,0,m)}}x&&this.addCurrentVertex(y,M,-Z,-Q,m)}else if(z==="butt")this.addCurrentVertex(y,P,0,0,m);else if(z==="square"){let q=v?1:-1;this.addCurrentVertex(y,P,q,q,m)}else z==="round"&&(v&&(this.addCurrentVertex(y,E,0,0,m),this.addCurrentVertex(y,E,1,1,m,!0)),x&&(this.addCurrentVertex(y,M,-1,-1,m,!0),this.addCurrentVertex(y,M,0,0,m)));if(k&&I<u-1){let q=y.dist(x);if(q>2*p){let Z=y.add(x.sub(y)._mult(p/q)._round());this.updateDistance(y,Z),this.addCurrentVertex(Z,M,0,0,m),y=Z}}}}addCurrentVertex(e,r,i,n,a,o=!1){let l=r.x+r.y*i,u=r.y-r.x*i,c=-r.x+r.y*n,p=-r.y-r.x*n;this.addHalfVertex(e,l,u,o,!1,i,a),this.addHalfVertex(e,c,p,o,!0,-n,a),this.distance>qH/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,i,n,a,o))}addHalfVertex({x:e,y:r},i,n,a,o,l,u){let c=(this.lineClips?this.scaledDistance*(qH-1):this.scaledDistance)*vne;if(this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(r<<1)+(o?1:0),Math.round(HH*i)+128,Math.round(HH*n)+128,(l===0?0:l<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let m=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,v=m/y;this.layoutVertexArray2.emplaceBack(v,this.lineClipsArray.length)}let p=u.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),u.primitiveLength++),o?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};s(_ne,"LineBucket");var xne=_ne;Lr("LineBucket",xne,{omit:["layers","patternFeatures"]});N();var WH,MNe=s(()=>WH=WH||new $u({"line-cap":new Hr(Ut.layout_line["line-cap"]),"line-join":new pi(Ut.layout_line["line-join"]),"line-miter-limit":new Hr(Ut.layout_line["line-miter-limit"]),"line-round-limit":new Hr(Ut.layout_line["line-round-limit"]),"line-sort-key":new pi(Ut.layout_line["line-sort-key"])}),"getLayout"),XH,ENe=s(()=>XH=XH||new $u({"line-opacity":new pi(Ut.paint_line["line-opacity"]),"line-color":new pi(Ut.paint_line["line-color"]),"line-translate":new Hr(Ut.paint_line["line-translate"]),"line-translate-anchor":new Hr(Ut.paint_line["line-translate-anchor"]),"line-width":new pi(Ut.paint_line["line-width"]),"line-gap-width":new pi(Ut.paint_line["line-gap-width"]),"line-offset":new pi(Ut.paint_line["line-offset"]),"line-blur":new pi(Ut.paint_line["line-blur"]),"line-dasharray":new v7(Ut.paint_line["line-dasharray"]),"line-pattern":new fP(Ut.paint_line["line-pattern"]),"line-gradient":new _7(Ut.paint_line["line-gradient"])}),"getPaint"),ZH={get paint(){return ENe()},get layout(){return MNe()}},bne=class extends pi{possiblyEvaluate(e,r){return r=new ds(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,i,n){return r=Fr({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,i,n)}};s(bne,"LineFloorwidthProperty");var CNe=bne,SM,wne=class extends id{constructor(e){super(e,ZH),this.gradientVersion=0,SM||(SM=new CNe(ZH.paint.properties["line-width"].specification),SM.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();nx(r)?this.stepInterpolant=r._styleExpression.expression instanceof V9:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=SM.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new xne(e)}queryRadius(e){let r=e,i=V6(Q1("line-width",this,r),Q1("line-gap-width",this,r)),n=Q1("line-offset",this,r);return i/2+Math.abs(n)+MA(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,i,n,a,o,l){let u=EA(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,l),c=l/2*V6(this.paint.get("line-width").evaluate(r,i),this.paint.get("line-gap-width").evaluate(r,i)),p=this.paint.get("line-offset").evaluate(r,i);return p&&(n=Oee(n,p*l)),Iee(u,n,c)}isTileClipped(){return!0}};s(wne,"LineStyleLayer");var INe=wne;function V6(t,e){return e>0?e+2*t:t}s(V6,"getLineWidth");N();N();N();var TNe=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),PNe=no([{name:"a_projected_pos",components:3,type:"Float32"}],4);no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var LNe=no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var YH=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),DNe=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);no([{name:"triangle",components:3,type:"Uint16"}]);no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);no([{type:"Float32",name:"offsetX"}]);no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);no([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var MM=Rr(kn(),1);N();function Ane(t,e,r){let i=e.layout.get("text-transform").evaluate(r,{});return i==="uppercase"?t=t.toLocaleUpperCase():i==="lowercase"&&(t=t.toLocaleLowerCase()),Aw.applyArabicShaping&&(t=Aw.applyArabicShaping(t)),t}s(Ane,"transformTextInternal");function Sne(t,e,r){return t.sections.forEach(i=>{i.text=Ane(i.text,e,r)}),t}s(Sne,"transformText");N();function Mne(t){let e={},r={},i=[],n=0;function a(c){i.push(t[c]),n++}s(a,"add");function o(c,p,m){let y=r[c];return delete r[c],r[p]=y,i[y].geometry[0].pop(),i[y].geometry[0]=i[y].geometry[0].concat(m[0]),y}s(o,"mergeFromRight");function l(c,p,m){let y=e[p];return delete e[p],e[c]=y,i[y].geometry[0].shift(),i[y].geometry[0]=m[0].concat(i[y].geometry[0]),y}s(l,"mergeFromLeft");function u(c,p,m){let y=m?p[0][p[0].length-1]:p[0][0];return"".concat(c,":").concat(y.x,":").concat(y.y)}s(u,"getKey");for(let c=0;c<t.length;c++){let p=t[c],m=p.geometry,y=p.text?p.text.toString():null;if(!y){a(c);continue}let v=u(y,m),x=u(y,m,!0);if(v in r&&x in e&&r[v]!==e[x]){let E=l(v,x,m),M=o(v,x,i[E].geometry);delete e[v],delete r[x],r[u(y,i[M].geometry,!0)]=M,i[E].geometry=null}else v in r?o(v,x,m):x in e?l(v,x,m):(a(c),e[v]=n-1,r[x]=n-1)}return i.filter(c=>c.geometry)}s(Mne,"mergeLines");N();N();var RNe={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};N();var Ene=24;N();var ONe=Rr(eZ(),1),KH=3;function Cne(t,e,r){t===1&&r.readMessage(Ine,e)}s(Cne,"readFontstacks");function Ine(t,e,r){if(t===3){let{id:i,bitmap:n,width:a,height:o,left:l,top:u,advance:c}=r.readMessage(Tne,{});e.push({id:i,bitmap:new CF({width:a+2*KH,height:o+2*KH},n),metrics:{width:a,height:o,left:l,top:u,advance:c}})}}s(Ine,"readFontstack");function Tne(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}s(Tne,"readGlyph");function Pne(t){return new ONe.default(t).readFields(Cne,[])}s(Pne,"parseGlyphPbf");N();N();function LF(t){let e=0,r=0;for(let o of t)e+=o.w*o.h,r=Math.max(r,o.w);t.sort((o,l)=>l.h-o.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],n=0,a=0;for(let o of t)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(o.w>u.w||o.h>u.h)){if(o.x=u.x,o.y=u.y,a=Math.max(a,o.y+o.h),n=Math.max(n,o.x+o.w),o.w===u.w&&o.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else o.h===u.h?(u.x+=o.w,u.w-=o.w):o.w===u.w?(u.y+=o.h,u.h-=o.h):(i.push({x:u.x+o.w,y:u.y,w:u.w-o.w,h:o.h}),u.y+=o.h,u.h-=o.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}s(LF,"potpack");var Yc=1,Lne=class{constructor(e,{pixelRatio:r,version:i,stretchX:n,stretchY:a,content:o}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=n,this.stretchY=a,this.content=o,this.version=i}get tl(){return[this.paddedRect.x+Yc,this.paddedRect.y+Yc]}get br(){return[this.paddedRect.x+this.paddedRect.w-Yc,this.paddedRect.y+this.paddedRect.h-Yc]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-Yc*2)/this.pixelRatio,(this.paddedRect.h-Yc*2)/this.pixelRatio]}};s(Lne,"ImagePosition");var DF=Lne,Dne=class{constructor(e,r){let i={},n={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,i,a),this.addImages(r,n,a);let{w:o,h:l}=LF(a),u=new mo({width:o||1,height:l||1});for(let c in e){let p=e[c],m=i[c].paddedRect;mo.copy(p.data,u,{x:0,y:0},{x:m.x+Yc,y:m.y+Yc},p.data)}for(let c in r){let p=r[c],m=n[c].paddedRect,y=m.x+Yc,v=m.y+Yc,x=p.data.width,E=p.data.height;mo.copy(p.data,u,{x:0,y:0},{x:y,y:v},p.data),mo.copy(p.data,u,{x:0,y:E-1},{x:y,y:v-1},{width:x,height:1}),mo.copy(p.data,u,{x:0,y:0},{x:y,y:v+E},{width:x,height:1}),mo.copy(p.data,u,{x:x-1,y:0},{x:y-1,y:v},{width:1,height:E}),mo.copy(p.data,u,{x:0,y:0},{x:y+x,y:v},{width:1,height:E})}this.image=u,this.iconPositions=i,this.patternPositions=n}addImages(e,r,i){for(let n in e){let a=e[n],o={x:0,y:0,w:a.data.width+2*Yc,h:a.data.height+2*Yc};i.push(o),r[n]=new DF(o,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let i in e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),r),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),r)}patchUpdatedImage(e,r,i){if(!e||!r||e.version===r.version)return;e.version=r.version;let[n,a]=e.tl;i.update(r.data,void 0,{x:n,y:a})}};s(Dne,"ImageAtlas");var kNe=Dne;Lr("ImagePosition",DF);Lr("ImageAtlas",kNe);var Rne=(t=>(t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.horizontalOnly=3]="horizontalOnly",t))(Rne||{});function RF(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}s(RF,"getAnchorAlignment");var NNe=Rr(q3(),1);N();var FNe=255,zE=128,JH=FNe*zE;function j6(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new ds(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:i,interpolationType:n}=r,a=0;for(;a<i.length&&i[a]<=t;)a++;a=Math.max(0,a-1);let o=a;for(;o<i.length&&i[o]<t+1;)o++;o=Math.min(i.length-1,o);let l=i[a],u=i[o];if(r.kind==="composite")return{kind:"composite",minZoom:l,maxZoom:u,interpolationType:n};let c=r.evaluate(new ds(l)),p=r.evaluate(new ds(u));return{kind:"camera",minZoom:l,maxZoom:u,minSize:c,maxSize:p,interpolationType:n}}}s(j6,"getSizeData");function AP(t,{uSize:e,uSizeT:r},{lowerSize:i,upperSize:n}){return t.kind==="source"?i/zE:t.kind==="composite"?Ya.number(i/zE,n/zE,r):e}s(AP,"evaluateSizeForFeature");function CA(t,e){let r=0,i=0;if(t.kind==="constant")i=t.layoutSize;else if(t.kind!=="source"){let{interpolationType:n,minZoom:a,maxZoom:o}=t,l=n?hs(qp.interpolationFactor(n,e,a,o),0,1):0;t.kind==="camera"?i=Ya.number(t.minSize,t.maxSize,l):r=l}return{uSizeT:r,uSize:i}}s(CA,"evaluateSizeForZoom");N();function Mw(t,e,r){let i="never",n=t.get(e);return n?i=n:t.get(r)&&(i="always"),i}s(Mw,"getOverlapMode");var BNe=NNe.default.VectorTileFeature.types,zNe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function r2(t,e,r,i,n,a,o,l,u,c,p,m,y){let v=l?Math.min(JH,Math.round(l[0])):0,x=l?Math.min(JH,Math.round(l[1])):0;t.emplaceBack(e,r,Math.round(i*32),Math.round(n*32),a,o,(v<<1)+(u?1:0),x,c*16,p*16,m*256,y*256)}s(r2,"addVertex");function __(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}s(__,"addDynamicAttributes");function One(t){for(let e of t.sections)if(wJ(e.text))return!0;return!1}s(One,"containsRTLText");var kne=class{constructor(e){this.layoutVertexArray=new Yke,this.indexArray=new cv,this.programConfigurations=e,this.segments=new Io,this.dynamicLayoutVertexArray=new Kke,this.opacityVertexArray=new Jke,this.hasVisibleVertices=!1,this.placedSymbolArray=new bQ}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,TNe.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,PNe.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,zNe,!0),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};s(kne,"SymbolBuffers");var $6=kne;Lr("SymbolBuffers",$6);var Nne=class{constructor(e,r,i){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new i,this.segments=new Io,this.collisionVertexArray=new e8e}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,LNe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};s(Nne,"CollisionBuffers");var G6=Nne;Lr("CollisionBuffers",G6);var Fne=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Or.identity([]),this.placementViewportMatrix=Or.identity([]);let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=j6(this.zoom,r["text-size"]),this.iconSizeData=j6(this.zoom,r["icon-size"]);let i=this.layers[0].layout,n=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=Mw(i,"text-overlap","text-allow-overlap")!=="never"||Mw(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!n.isConstant();let o=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>Rne[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=e.sourceID}createArrays(){this.text=new $6(new Hy(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new $6(new Hy(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new CQ,this.lineVertexArray=new TQ,this.symbolInstances=new MQ,this.textAnchorOffsets=new RQ}calculateGlyphDependencies(e,r,i,n,a){for(let o=0;o<e.length;o++)if(r[e.charCodeAt(o)]=!0,(i||n)&&a){let l=RNe[e.charAt(o)];l&&(r[l.charCodeAt(0)]=!0)}}populate(e,r,i){let n=this.layers[0],a=n.layout,o=a.get("text-font"),l=a.get("text-field"),u=a.get("icon-image"),c=(l.value.kind!=="constant"||l.value.value instanceof df&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0),p=u.value.kind!=="constant"||!!u.value.value||Object.keys(u.parameters).length>0,m=a.get("symbol-sort-key");if(this.features=[],!c&&!p)return;let y=r.iconDependencies,v=r.glyphDependencies,x=r.availableImages,E=new ds(this.zoom);for(let{feature:M,id:I,index:P,sourceLayerIndex:C}of e){let T=n._featureFilter.needGeometry,D=sg(M,T);if(!n._featureFilter.filter(E,D,i))continue;T||(D.geometry=og(M));let F;if(c){let z=n.getValueAndResolveTokens("text-field",D,i,x),q=df.factory(z),Z=this.hasRTLText=this.hasRTLText||One(q);(!Z||Aw.getRTLTextPluginStatus()==="unavailable"||Z&&Aw.isParsed())&&(F=Sne(q,n,D))}let k;if(p){let z=n.getValueAndResolveTokens("icon-image",D,i,x);z instanceof Kp?k=z:k=Kp.fromString(z)}if(!F&&!k)continue;let B=this.sortFeaturesByKey?m.evaluate(D,{},i):void 0,U={id:I,text:F,icon:k,index:P,sourceLayerIndex:C,geometry:D.geometry,properties:M.properties,type:BNe[M.type],sortKey:B};if(this.features.push(U),k&&(y[k.name]=!0),F){let z=o.evaluate(D,{},i).join(","),q=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let Z of F.sections)if(Z.image)y[Z.image.name]=!0;else{let Q=_J(F.toString()),V=Z.fontStack||z,ae=v[V]=v[V]||{};this.calculateGlyphDependencies(Z.text,ae,q,this.allowVerticalPlacement,Q)}}}a.get("symbol-placement")==="line"&&(this.features=Mne(this.features)),this.sortFeaturesByKey&&this.features.sort((M,I)=>M.sortKey-I.sortKey)}update(e,r,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,i))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let i=this.lineVertexArray.length;if(e.segment!==void 0){let n=e.dist(r[e.segment+1]),a=e.dist(r[e.segment]),o={};for(let l=e.segment+1;l<r.length;l++)o[l]={x:r[l].x,y:r[l].y,tileUnitDistanceFromAnchor:n},l<r.length-1&&(n+=r[l+1].dist(r[l]));for(let l=e.segment||0;l>=0;l--)o[l]={x:r[l].x,y:r[l].y,tileUnitDistanceFromAnchor:a},l>0&&(a+=r[l-1].dist(r[l]));for(let l=0;l<r.length;l++){let u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,r,i,n,a,o,l,u,c,p,m,y){let v=e.indexArray,x=e.layoutVertexArray,E=e.segments.prepareSegment(4*r.length,x,v,this.canOverlap?o.sortKey:void 0),M=this.glyphOffsetArray.length,I=E.vertexLength,P=this.allowVerticalPlacement&&l===2?Math.PI/2:0,C=o.text&&o.text.sections;for(let T=0;T<r.length;T++){let{tl:D,tr:F,bl:k,br:B,tex:U,pixelOffsetTL:z,pixelOffsetBR:q,minFontScaleX:Z,minFontScaleY:Q,glyphOffset:V,isSDF:ae,sectionIndex:Y}=r[T],he=E.vertexLength,J=V[1];r2(x,u.x,u.y,D.x,J+D.y,U.x,U.y,i,ae,z.x,z.y,Z,Q),r2(x,u.x,u.y,F.x,J+F.y,U.x+U.w,U.y,i,ae,q.x,z.y,Z,Q),r2(x,u.x,u.y,k.x,J+k.y,U.x,U.y+U.h,i,ae,z.x,q.y,Z,Q),r2(x,u.x,u.y,B.x,J+B.y,U.x+U.w,U.y+U.h,i,ae,q.x,q.y,Z,Q),__(e.dynamicLayoutVertexArray,u,P),v.emplaceBack(he,he+1,he+2),v.emplaceBack(he+1,he+2,he+3),E.vertexLength+=4,E.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(V[0]),(T===r.length-1||Y!==r[T+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(x.length,o,o.index,{},y,C&&C[Y])}e.placedSymbolArray.emplaceBack(u.x,u.y,M,this.glyphOffsetArray.length-M,I,c,p,u.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],l,0,!1,0,m)}_addCollisionDebugVertex(e,r,i,n,a,o){return r.emplaceBack(0,0),e.emplaceBack(i.x,i.y,n,a,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,r,i,n,a,o,l){let u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),c=u.vertexLength,p=a.layoutVertexArray,m=a.collisionVertexArray,y=l.anchorX,v=l.anchorY;this._addCollisionDebugVertex(p,m,o,y,v,new MM.default(e,r)),this._addCollisionDebugVertex(p,m,o,y,v,new MM.default(i,r)),this._addCollisionDebugVertex(p,m,o,y,v,new MM.default(i,n)),this._addCollisionDebugVertex(p,m,o,y,v,new MM.default(e,n)),u.vertexLength+=4;let x=a.indexArray;x.emplaceBack(c,c+1),x.emplaceBack(c+1,c+2),x.emplaceBack(c+2,c+3),x.emplaceBack(c+3,c),u.primitiveLength+=4}addDebugCollisionBoxes(e,r,i,n){for(let a=e;a<r;a++){let o=this.collisionBoxArray.get(a),l=o.x1,u=o.y1,c=o.x2,p=o.y2;this.addCollisionDebugVertices(l,u,c,p,n?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new G6(NH,YH.members,P6),this.iconCollisionBox=new G6(NH,YH.members,P6);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,i,n,a,o,l,u,c){let p={};for(let m=r;m<i;m++){let y=e.get(m);p.textBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.textFeatureIndex=y.featureIndex;break}for(let m=n;m<a;m++){let y=e.get(m);p.verticalTextBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.verticalTextFeatureIndex=y.featureIndex;break}for(let m=o;m<l;m++){let y=e.get(m);p.iconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.iconFeatureIndex=y.featureIndex;break}for(let m=u;m<c;m++){let y=e.get(m);p.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},p.verticalIconFeatureIndex=y.featureIndex;break}return p}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let i=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let i=e.placedSymbolArray.get(r),n=i.vertexStartIndex+i.numGlyphs*4;for(let a=i.vertexStartIndex;a<n;a+=4)e.indexArray.emplaceBack(a,a+1,a+2),e.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),i=Math.cos(e),n=[],a=[],o=[];for(let l=0;l<this.symbolInstances.length;++l){o.push(l);let u=this.symbolInstances.get(l);n.push(Math.round(r*u.anchorX+i*u.anchorY)|0),a.push(u.featureIndex)}return o.sort((l,u)=>n[l]-n[u]||a[u]-a[l]),o}addToSortKeyRanges(e,r){let i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===r?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let i=this.symbolInstances.get(r);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((n,a,o)=>{n>=0&&o.indexOf(n)===a&&this.addIndicesForPlacedSymbol(this.text,n)}),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};s(Fne,"SymbolBucket");var x_=Fne;Lr("SymbolBucket",x_,{omit:["layers","collisionBoxArray","features","compareText"]});x_.MAX_GLYPHS=65535;x_.addDynamicAttributes=__;N();function Bne(t,e){return e.replace(/{([^{}]+)}/g,(r,i)=>t&&i in t?String(t[i]):"")}s(Bne,"resolveTokens");N();var QH,UNe=s(()=>QH=QH||new $u({"symbol-placement":new Hr(Ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Hr(Ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Hr(Ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pi(Ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Hr(Ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Hr(Ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Hr(Ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Hr(Ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Hr(Ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Hr(Ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new pi(Ut.layout_symbol["icon-size"]),"icon-text-fit":new Hr(Ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Hr(Ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new pi(Ut.layout_symbol["icon-image"]),"icon-rotate":new pi(Ut.layout_symbol["icon-rotate"]),"icon-padding":new pi(Ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Hr(Ut.layout_symbol["icon-keep-upright"]),"icon-offset":new pi(Ut.layout_symbol["icon-offset"]),"icon-anchor":new pi(Ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Hr(Ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Hr(Ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Hr(Ut.layout_symbol["text-rotation-alignment"]),"text-field":new pi(Ut.layout_symbol["text-field"]),"text-font":new pi(Ut.layout_symbol["text-font"]),"text-size":new pi(Ut.layout_symbol["text-size"]),"text-max-width":new pi(Ut.layout_symbol["text-max-width"]),"text-line-height":new Hr(Ut.layout_symbol["text-line-height"]),"text-letter-spacing":new pi(Ut.layout_symbol["text-letter-spacing"]),"text-justify":new pi(Ut.layout_symbol["text-justify"]),"text-radial-offset":new pi(Ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Hr(Ut.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new pi(Ut.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new pi(Ut.layout_symbol["text-anchor"]),"text-max-angle":new Hr(Ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Hr(Ut.layout_symbol["text-writing-mode"]),"text-rotate":new pi(Ut.layout_symbol["text-rotate"]),"text-padding":new Hr(Ut.layout_symbol["text-padding"]),"text-keep-upright":new Hr(Ut.layout_symbol["text-keep-upright"]),"text-transform":new pi(Ut.layout_symbol["text-transform"]),"text-offset":new pi(Ut.layout_symbol["text-offset"]),"text-allow-overlap":new Hr(Ut.layout_symbol["text-allow-overlap"]),"text-overlap":new Hr(Ut.layout_symbol["text-overlap"]),"text-ignore-placement":new Hr(Ut.layout_symbol["text-ignore-placement"]),"text-optional":new Hr(Ut.layout_symbol["text-optional"])}),"getLayout"),eq,VNe=s(()=>eq=eq||new $u({"icon-opacity":new pi(Ut.paint_symbol["icon-opacity"]),"icon-color":new pi(Ut.paint_symbol["icon-color"]),"icon-halo-color":new pi(Ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new pi(Ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pi(Ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Hr(Ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Hr(Ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new pi(Ut.paint_symbol["text-opacity"]),"text-color":new pi(Ut.paint_symbol["text-color"],{runtimeType:zh,getOverride:s(t=>t.textColor,"getOverride"),hasOverride:s(t=>!!t.textColor,"hasOverride")}),"text-halo-color":new pi(Ut.paint_symbol["text-halo-color"]),"text-halo-width":new pi(Ut.paint_symbol["text-halo-width"]),"text-halo-blur":new pi(Ut.paint_symbol["text-halo-blur"]),"text-translate":new Hr(Ut.paint_symbol["text-translate"]),"text-translate-anchor":new Hr(Ut.paint_symbol["text-translate-anchor"])}),"getPaint"),DL={get paint(){return VNe()},get layout(){return UNe()}};N();var zne=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:mA,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};s(zne,"FormatSectionOverride");var Une=zne;Lr("FormatSectionOverride",Une,{omit:["defaultValue"]});var Vne=class H6 extends id{constructor(e){super(e,DL)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let i=this.layout.get("text-writing-mode");if(i){let n=[];for(let a of i)n.indexOf(a)<0&&n.push(a);this.layout._values["text-writing-mode"]=n}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,i,n){let a=this.layout.get(e).evaluate(r,{},i,n),o=this._unevaluatedLayout._values[e];return!o.isDataDriven()&&!nx(o.value)&&a?Bne(r.properties,a):a}createBucket(e){return new x_(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of DL.paint.overridableProperties){if(!H6.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),i=new Une(r),n=new Q9(i,r.property.specification),a=null;r.value.kind==="constant"||r.value.kind==="source"?a=new ST("source",n):a=new MT("composite",n,r.value.zoomStops),this.paint._values[e]=new Fh(r.property,a,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,i){return!this.layout||r.isDataDriven()||i.isDataDriven()?!1:H6.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let i=e.get("text-field"),n=DL.paint.properties[r],a=!1,o=s(l=>{for(let u of l)if(n.overrides&&n.overrides.hasOverride(u)){a=!0;return}},"checkSections");if(i.value.kind==="constant"&&i.value.value instanceof df)o(i.value.value.sections);else if(i.value.kind==="source"){let l=s(c=>{if(!a)if(c instanceof mw&&Wo(c.value)===gA){let p=c.value;o(p.sections)}else c instanceof iK?o(c.sections):c.eachChild(l)},"checkExpression"),u=i.value;u._styleExpression&&l(u._styleExpression.expression)}return a}};s(Vne,"SymbolStyleLayer");var jNe=Vne;N();N();var tq,$Ne=s(()=>tq=tq||new $u({"background-color":new Hr(Ut.paint_background["background-color"]),"background-pattern":new v7(Ut.paint_background["background-pattern"]),"background-opacity":new Hr(Ut.paint_background["background-opacity"])}),"getPaint"),GNe={get paint(){return $Ne()}},jne=class extends id{constructor(e){super(e,GNe)}};s(jne,"BackgroundStyleLayer");var HNe=jne;N();N();var rq,qNe=s(()=>rq=rq||new $u({"raster-opacity":new Hr(Ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new Hr(Ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Hr(Ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Hr(Ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Hr(Ut.paint_raster["raster-saturation"]),"raster-contrast":new Hr(Ut.paint_raster["raster-contrast"]),"raster-resampling":new Hr(Ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Hr(Ut.paint_raster["raster-fade-duration"])}),"getPaint"),WNe={get paint(){return qNe()}},$ne=class extends id{constructor(e){super(e,WNe)}};s($ne,"RasterStyleLayer");var XNe=$ne;N();function Gne(t){let e=[],r=t.id;return r===void 0&&e.push({message:"layers.".concat(r,': missing required property "id"')}),t.render===void 0&&e.push({message:"layers.".concat(r,': missing required method "render"')}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers.".concat(r,': property "renderingMode" must be either "2d" or "3d"')}),e}s(Gne,"validateCustomStyleLayer");var Hne=class extends id{constructor(e){super(e,{}),this.onAdd=s(r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},"onAdd"),this.onRemove=s(r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},"onRemove"),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};s(Hne,"CustomStyleLayer");var ZNe=Hne;function UE(t){if(t.type==="custom")return new ZNe(t);switch(t.type){case"background":return new HNe(t);case"circle":return new G8e(t);case"fill":return new nNe(t);case"fill-extrusion":return new fNe(t);case"heatmap":return new W8e(t);case"hillshade":return new Y8e(t);case"line":return new INe(t);case"raster":return new XNe(t);case"symbol":return new jNe(t)}}s(UE,"createStyleLayer");N();N();function ow(t){let e=[];if(typeof t=="string")e.push({id:"default",url:t});else if(t&&t.length>0){let r=[];for(let{id:i,url:n}of t){let a="".concat(i).concat(n);r.indexOf(a)===-1&&(r.push(a),e.push({id:i,url:n}))}}return e}s(ow,"coerceSpriteToArray");async function qne(t,e,r,i){let n=ow(t),a=r>1?"@2x":"",o={},l={};for(let{id:u,url:c}of n){let p=e.transformRequest(e.normalizeSpriteURL(c,a,".json"),"SpriteJSON");o[u]=Y3(p,i);let m=e.transformRequest(e.normalizeSpriteURL(c,a,".png"),"SpriteImage");l[u]=Hp.getImage(m,i)}return await Promise.all([...Object.values(o),...Object.values(l)]),Wne(o,l)}s(qne,"loadSprite");async function Wne(t,e){let r={};for(let i in t){r[i]={};let n=yn.getImageCanvasContext((await e[i]).data),a=(await t[i]).data;for(let o in a){let{width:l,height:u,x:c,y:p,sdf:m,pixelRatio:y,stretchX:v,stretchY:x,content:E}=a[o],M={width:l,height:u,x:c,y:p,context:n};r[i][o]={data:null,pixelRatio:y,sdf:m,stretchX:v,stretchY:x,content:E,spriteData:M}}}return r}s(Wne,"doOnceCompleted");N();N();var Xne=class{constructor(e,r,i,n){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(r,n)}update(e,r,i){let{width:n,height:a}=e,o=(!this.size||this.size[0]!==n||this.size[1]!==a)&&!i,{context:l}=this,{gl:u}=l;if(this.useMipmap=!!(r&&r.useMipmap),u.bindTexture(u.TEXTURE_2D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(this.format===u.RGBA&&(!r||r.premultiply!==!1)),o)this.size=[n,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Gp(e)?u.texImage2D(u.TEXTURE_2D,0,this.format,this.format,u.UNSIGNED_BYTE,e):u.texImage2D(u.TEXTURE_2D,0,this.format,n,a,0,this.format,u.UNSIGNED_BYTE,e.data);else{let{x:c,y:p}=i||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Gp(e)?u.texSubImage2D(u.TEXTURE_2D,0,c,p,u.RGBA,u.UNSIGNED_BYTE,e):u.texSubImage2D(u.TEXTURE_2D,0,c,p,n,a,u.RGBA,u.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&u.generateMipmap(u.TEXTURE_2D)}bind(e,r,i){let{context:n}=this,{gl:a}=n;a.bindTexture(a.TEXTURE_2D,this.texture),i===a.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(i=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,i||e),this.filter=e),r!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};s(Xne,"Texture");var Ms=Xne;N();function Zne(t){let{userImage:e}=t;return e&&e.render&&e.render()?(t.data.replace(new Uint8Array(e.data.buffer)),!0):!1}s(Zne,"renderStyleImage");var EM=1,Yne=class extends Nl{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new mo({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:r,promiseResolve:i}of this.requestors)i(this._getImagesForIds(r));this.requestors=[]}}getImage(e){let r=this.images[e];if(r&&!r.data&&r.spriteData){let i=r.spriteData;r.data=new mo({width:i.width,height:i.height},i.context.getImageData(i.x,i.y,i.width,i.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error("Image id ".concat(e," already exist, use updateImage instead"));this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let i=!0,n=r.data||r.spriteData;return this._validateStretch(r.stretchX,n&&n.width)||(this.fire(new di(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),i=!1),this._validateStretch(r.stretchY,n&&n.height)||(this.fire(new di(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),i=!1),this._validateContent(r.content,r)||(this.fire(new di(new Error('Image "'.concat(e,'" has invalid "content" value')))),i=!1),i}_validateStretch(e,r){if(!e)return!0;let i=0;for(let n of e){if(n[0]<i||n[1]<n[0]||r<n[1])return!1;i=n[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;let i=r.spriteData,n=i&&i.width||r.data.width,a=i&&i.height||r.data.height;return!(e[0]<0||n<e[0]||e[1]<0||a<e[1]||e[2]<0||n<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,i=!0){let n=this.getImage(e);if(i&&(n.data.width!==r.data.width||n.data.height!==r.data.height))throw new Error("size mismatch between old image (".concat(n.data.width,"x").concat(n.data.height,") and new image (").concat(r.data.width,"x").concat(r.data.height,")."));r.version=n.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){let r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,i)=>{let n=!0;if(!this.isLoaded())for(let a of e)this.images[a]||(n=!1);this.isLoaded()||n?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){let r={};for(let i of e){let n=this.getImage(i);n||(this.fire(new pr("styleimagemissing",{id:i})),n=this.getImage(i)),n?r[i]={data:n.data.clone(),pixelRatio:n.pixelRatio,sdf:n.sdf,version:n.version,stretchX:n.stretchX,stretchY:n.stretchY,content:n.content,hasRenderCallback:!!(n.userImage&&n.userImage.render)}:Ol('Image "'.concat(i,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}return r}getPixelSize(){let{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){let r=this.patterns[e],i=this.getImage(e);if(!i)return null;if(r&&r.position.version===i.version)return r.position;if(r)r.position.version=i.version;else{let n=i.data.width+EM*2,a=i.data.height+EM*2,o={w:n,h:a,x:0,y:0},l=new DF(o,i);this.patterns[e]={bin:o,position:l}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ms(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let a in this.patterns)e.push(this.patterns[a].bin);let{w:r,h:i}=LF(e),n=this.atlasImage;n.resize({width:r||1,height:i||1});for(let a in this.patterns){let{bin:o}=this.patterns[a],l=o.x+EM,u=o.y+EM,c=this.getImage(a).data,p=c.width,m=c.height;mo.copy(c,n,{x:0,y:0},{x:l,y:u},{width:p,height:m}),mo.copy(c,n,{x:0,y:m-1},{x:l,y:u-1},{width:p,height:1}),mo.copy(c,n,{x:0,y:0},{x:l,y:u+m},{width:p,height:1}),mo.copy(c,n,{x:p-1,y:0},{x:l-1,y:u},{width:1,height:m}),mo.copy(c,n,{x:0,y:0},{x:l+p,y:u},{width:1,height:m})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;let i=this.getImage(r);i||Ol('Image with ID: "'.concat(r,'" was not found')),Zne(i)&&this.updateImage(r,i)}}};s(Yne,"ImageManager");var YNe=Yne;N();N();async function Kne(t,e,r,i){let n=e*256,a=n+255,o=i.transformRequest(r.replace("{fontstack}",t).replace("{range}","".concat(n,"-").concat(a)),"Glyphs"),l=await gOe(o,new AbortController);if(!l||!l.data)throw new Error("Could not load glyph range. range: ".concat(e,", ").concat(n,"-").concat(a));let u={};for(let c of Pne(l.data))u[c.id]=c;return u}s(Kne,"loadGlyphRange");N();var Jne=class{constructor({fontSize:e=24,buffer:r=3,radius:i=8,cutoff:n=.25,fontFamily:a="sans-serif",fontWeight:o="normal",fontStyle:l="normal"}={}){this.buffer=r,this.cutoff=n,this.radius=i;let u=this.size=e+r*4,c=this._createCanvas(u),p=this.ctx=c.getContext("2d",{willReadFrequently:!0});p.font="".concat(l," ").concat(o," ").concat(e,"px ").concat(a),p.textBaseline="alphabetic",p.textAlign="left",p.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(e){let r=document.createElement("canvas");return r.width=r.height=e,r}draw(e){let{width:r,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:a,actualBoundingBoxRight:o}=this.ctx.measureText(e),l=Math.ceil(i),u=0,c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),p=Math.min(this.size-this.buffer,l+Math.ceil(n)),m=c+2*this.buffer,y=p+2*this.buffer,v=Math.max(m*y,0),x=new Uint8ClampedArray(v),E={data:x,width:m,height:y,glyphWidth:c,glyphHeight:p,glyphTop:l,glyphLeft:u,glyphAdvance:r};if(c===0||p===0)return E;let{ctx:M,buffer:I,gridInner:P,gridOuter:C}=this;M.clearRect(I,I,c,p),M.fillText(e,I,I+l);let T=M.getImageData(I,I,c,p);C.fill(1e20,0,v),P.fill(0,0,v);for(let D=0;D<p;D++)for(let F=0;F<c;F++){let k=T.data[4*(D*c+F)+3]/255;if(k===0)continue;let B=(D+I)*m+F+I;if(k===1)C[B]=0,P[B]=1e20;else{let U=.5-k;C[B]=U>0?U*U:0,P[B]=U<0?U*U:0}}q6(C,0,0,m,y,m,this.f,this.v,this.z),q6(P,I,I,c,p,m,this.f,this.v,this.z);for(let D=0;D<v;D++){let F=Math.sqrt(C[D])-Math.sqrt(P[D]);x[D]=Math.round(255-255*(F/this.radius+this.cutoff))}return E}};s(Jne,"TinySDF");var KNe=Jne;function q6(t,e,r,i,n,a,o,l,u){for(let c=e;c<e+i;c++)W6(t,r*a+c,a,n,o,l,u);for(let c=r;c<r+n;c++)W6(t,c*a+e,1,i,o,l,u)}s(q6,"edt");function W6(t,e,r,i,n,a,o){a[0]=0,o[0]=-1e20,o[1]=1e20,n[0]=t[e];for(let l=1,u=0,c=0;l<i;l++){n[l]=t[e+l*r];let p=l*l;do{let m=a[u];c=(n[l]-n[m]+p-m*m)/(l-m)/2}while(c<=o[u]&&--u>-1);u++,a[u]=l,o[u]=c,o[u+1]=1e20}for(let l=0,u=0;l<i;l++){for(;o[u+1]<l;)u++;let c=a[u],p=l-c;t[e+l*r]=n[c]+p*p}}s(W6,"edt1d");var VE=class X6{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}async getGlyphs(e){let r=[];for(let a in e)for(let o of e[a])r.push(this._getAndCacheGlyphsPromise(a,o));let i=await Promise.all(r),n={};for(let{stack:a,id:o,glyph:l}of i)n[a]||(n[a]={}),n[a][o]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};return n}async _getAndCacheGlyphsPromise(e,r){let i=this.entries[e];i||(i=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=i.glyphs[r];if(n!==void 0)return{stack:e,id:r,glyph:n};if(n=this._tinySDF(i,e,r),n)return i.glyphs[r]=n,{stack:e,id:r,glyph:n};let a=Math.floor(r/256);if(a*256>65535)throw new Error("glyphs > 65535 not supported");if(i.ranges[a])return{stack:e,id:r,glyph:n};if(!this.url)throw new Error("glyphsUrl is not set");if(!i.requests[a]){let l=X6.loadGlyphRange(e,a,this.url,this.requestManager);i.requests[a]=l}let o=await i.requests[a];for(let l in o)this._doesCharSupportLocalGlyph(+l)||(i.glyphs[+l]=o[+l]);return i.ranges[a]=!0,{stack:e,id:r,glyph:o[r]||null}}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(mn["CJK Unified Ideographs"](e)||mn["Hangul Syllables"](e)||mn.Hiragana(e)||mn.Katakana(e))}_tinySDF(e,r,i){let n=this.localIdeographFontFamily;if(!n||!this._doesCharSupportLocalGlyph(i))return;let a=2,o=e.tinySDF;if(!o){let u="400";/bold/i.test(r)?u="900":/medium/i.test(r)?u="500":/light/i.test(r)&&(u="200"),o=e.tinySDF=new X6.TinySDF({fontSize:24*a,buffer:3*a,radius:8*a,cutoff:.25,fontFamily:n,fontWeight:u})}let l=o.draw(String.fromCharCode(i));return{id:i,bitmap:new CF({width:l.width||30*a,height:l.height||30*a},l.data),metrics:{width:l.glyphWidth/a||24,height:l.glyphHeight/a||24,left:l.glyphLeft/a+.5||0,top:l.glyphTop/a-27.5||-8,advance:l.glyphAdvance/a||24,isDoubleResolution:!0}}}};s(VE,"GlyphManager"),VE.loadGlyphRange=Kne,VE.TinySDF=KNe;var JNe=VE;N();var Qne=class{constructor(){this.specification=Ut.light.position}possiblyEvaluate(e,r){return cZ(e.expression.evaluate(r))}interpolate(e,r,i){return{x:Ya.number(e.x,r.x,i),y:Ya.number(e.y,r.y,i),z:Ya.number(e.z,r.z,i)}}};s(Qne,"LightPositionProperty");var QNe=Qne,iq="-transition",RL,eae=class extends Nl{constructor(e){super(),RL=RL||new $u({anchor:new Hr(Ut.light.anchor),position:new QNe,color:new Hr(Ut.light.color),intensity:new Hr(Ut.light.intensity)}),this._transitionable=new TJ(RL),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(kke,e,r))for(let i in e){let n=e[i];i.endsWith(iq)?this._transitionable.setTransition(i.slice(0,-iq.length),n):this._transitionable.setValue(i,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,i){return i&&i.validate===!1?!1:hP(this,e.call(Ss,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:Ut}))}};s(eae,"Light");var e9e=eae;N();var tae=class{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){let i=e.join(",")+String(r);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(e,r)),this.dashEntry[i]}getDashRanges(e,r,i){let n=e.length%2===1,a=[],o=n?-e[e.length-1]*i:0,l=e[0]*i,u=!0;a.push({left:o,right:l,isDash:u,zeroLength:e[0]===0});let c=e[0];for(let p=1;p<e.length;p++){u=!u;let m=e[p];o=c*i,c+=m,l=c*i,a.push({left:o,right:l,isDash:u,zeroLength:m===0})}return a}addRoundDash(e,r,i){let n=r/2;for(let a=-i;a<=i;a++){let o=this.nextRow+i+a,l=this.width*o,u=0,c=e[u];for(let p=0;p<this.width;p++){p/c.right>1&&(c=e[++u]);let m=Math.abs(p-c.left),y=Math.abs(p-c.right),v=Math.min(m,y),x,E=a/i*(n+1);if(c.isDash){let M=n-Math.abs(E);x=Math.sqrt(v*v+M*M)}else x=n-Math.sqrt(v*v+E*E);this.data[l+p]=Math.max(0,Math.min(255,x+128))}}}addRegularDash(e){for(let l=e.length-1;l>=0;--l){let u=e[l],c=e[l+1];u.zeroLength?e.splice(l,1):c&&c.isDash===u.isDash&&(c.left=u.left,e.splice(l,1))}let r=e[0],i=e[e.length-1];r.isDash===i.isDash&&(r.left=i.left-this.width,i.right=r.right+this.width);let n=this.width*this.nextRow,a=0,o=e[a];for(let l=0;l<this.width;l++){l/o.right>1&&(o=e[++a]);let u=Math.abs(l-o.left),c=Math.abs(l-o.right),p=Math.min(u,c),m=o.isDash?p:-p;this.data[n+l]=Math.max(0,Math.min(255,m+128))}}addDash(e,r){let i=r?7:0,n=2*i+1;if(this.nextRow+n>this.height)return Ol("LineAtlas out of space"),null;let a=0;for(let l=0;l<e.length;l++)a+=e[l];if(a!==0){let l=this.width/a,u=this.getDashRanges(e,this.width,l);r?this.addRoundDash(u,l,i):this.addRegularDash(u)}let o={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:a};return this.nextRow+=n,this.dirty=!0,o}bind(e){let r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}};s(tae,"LineAtlas");var t9e=tae;N();N();N();var rae=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};s(rae,"ThrottledInvoker");var r9e=rae,iae=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new r9e(()=>this.process()),this.subscription=mZ(this.target,"message",i=>this.receive(i),!1),this.globalScope=Vy(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((i,n)=>{let a=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[a]={resolve:i,reject:n},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[a];let u={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(u)},{once:!0});let o=[],l=vt(Ee({},e),{id:a,sourceMapId:this.mapId,origin:location.origin,data:Y1(e.data,o)});this.target.postMessage(l,{transfer:o})})}receive(e){let r=e.data,i=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[i];let n=this.abortControllers[i];delete this.abortControllers[i],n&&n.abort();return}if(Vy(self)||r.mustQueue){this.tasks[i]=r,this.taskQueue.push(i),this.invoker.trigger();return}this.processTask(i,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let a=this.resolveRejects[e];if(delete this.resolveRejects[e],!a)return;r.error?a.reject(K1(r.error)):a.resolve(K1(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let i=K1(r.data),n=new AbortController;this.abortControllers[e]=n;try{let a=await this.messageHandlers[r.type](r.sourceMapId,i,n);this.completeTask(e,null,a)}catch(a){this.completeTask(e,a)}}completeTask(e,r,i){let n=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Y1(r):null,data:Y1(i,n)};this.target.postMessage(a,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};s(iae,"Actor");var i9e=iae;N();N();N();N();var n9e=`(()=>{var _y=Object.create;var Ti=Object.defineProperty,Iy=Object.defineProperties,Ty=Object.getOwnPropertyDescriptor,Cy=Object.getOwnPropertyDescriptors,ky=Object.getOwnPropertyNames,Bl=Object.getOwnPropertySymbols,My=Object.getPrototypeOf,Rl=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable;var zl=(t,e,r)=>e in t?Ti(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dt=(t,e)=>{for(var r in e||(e={}))Rl.call(e,r)&&zl(t,r,e[r]);if(Bl)for(var r of Bl(e))Ey.call(e,r)&&zl(t,r,e[r]);return t},Ci=(t,e)=>Iy(t,Cy(e));var Ae=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ol=(t,e)=>{for(var r in e)Ti(t,r,{get:e[r],enumerable:!0})},Fy=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ky(e))!Rl.call(t,i)&&i!==r&&Ti(t,i,{get:()=>e[i],enumerable:!(n=Ty(e,i))||n.enumerable});return t};var Z=(t,e,r)=>(r=t!=null?_y(My(t)):{},Fy(e||!t||!t.__esModule?Ti(r,"default",{value:t,enumerable:!0}):r,t));var he=Ae((d0,Nl)=>{"use strict";Nl.exports=sr;function sr(t,e){this.x=t,this.y=e}sr.prototype={clone:function(){return new sr(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};sr.convert=function(t){return t instanceof sr?t:Array.isArray(t)?new sr(t[0],t[1]):t}});var Gl=Ae((g0,$l)=>{"use strict";$l.exports=Ul;function Ul(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=n}Ul.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,n=0;n<8;n++){var i=this.sampleCurveX(r)-t;if(Math.abs(i)<e)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=t,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-t)<e));n++)t>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}}});var Mc=Ae((Yv,Ts)=>{function hd(t,e){var r,n,i,o,a,s,l,u,c,p;for(r=t.length&3,n=t.length-r,i=e,a=3432918353,l=461845907,p=0;p<n;)c=t.charCodeAt(p)&255|(t.charCodeAt(++p)&255)<<8|(t.charCodeAt(++p)&255)<<16|(t.charCodeAt(++p)&255)<<24,++p,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,o=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(c=0,r){case 3:c^=(t.charCodeAt(p+2)&255)<<16;case 2:c^=(t.charCodeAt(p+1)&255)<<8;case 1:c^=t.charCodeAt(p)&255,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c}return i^=t.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}typeof Ts<"u"&&(Ts.exports=hd)});var Ec=Ae((Qv,Cs)=>{function dd(t,e){for(var r=t.length,n=e^r,i=0,o;r>=4;)o=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)^o,r-=4,++i;switch(r){case 3:n^=(t.charCodeAt(i+2)&255)<<16;case 2:n^=(t.charCodeAt(i+1)&255)<<8;case 1:n^=t.charCodeAt(i)&255,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)}return n^=n>>>13,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16),n^=n>>>15,n>>>0}typeof Cs!==void 0&&(Cs.exports=dd)});var ks=Ae((e1,Lo)=>{var Fc=Mc(),gd=Ec();Lo.exports=Fc;Lo.exports.murmur3=Fc;Lo.exports.murmur2=gd});var $s=Ae((JP,Us)=>{"use strict";Us.exports=Jo;Us.exports.default=Jo;function Jo(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,o=xp(t,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;var s,l,u,c,p,f,y;if(n&&(o=nx(t,e,o,r)),t.length>80*r){s=u=t[0],l=c=t[1];for(var m=r;m<i;m+=r)p=t[m],f=t[m+1],p<s&&(s=p),f<l&&(l=f),p>u&&(u=p),f>c&&(c=f);y=Math.max(u-s,c-l),y=y!==0?32767/y:0}return Wn(o,a,r,s,l,y,0),a}function xp(t,e,r,n,i){var o,a;if(i===Ns(t,e,r,n)>0)for(o=e;o<r;o+=n)a=gp(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=gp(o,t[o],t[o+1],a);return a&&Zo(a,a.next)&&(Xn(a),a=a.next),a}function tr(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Zo(r,r.next)||oe(r.prev,r,r.next)===0)){if(Xn(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function Wn(t,e,r,n,i,o,a){if(t){!a&&o&&lx(t,n,i,o);for(var s=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,o?ex(t,n,i,o):Qg(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),Xn(t),t=u.next,s=u.next;continue}if(t=u,t===s){a?a===1?(t=tx(tr(t),e,r),Wn(t,e,r,n,i,o,2)):a===2&&rx(t,e,r,n,i,o):Wn(tr(t),e,r,n,i,o,1);break}}}}function Qg(t){var e=t.prev,r=t,n=t.next;if(oe(e,r,n)>=0)return!1;for(var i=e.x,o=r.x,a=n.x,s=e.y,l=r.y,u=n.y,c=i<o?i<a?i:a:o<a?o:a,p=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,y=s>l?s>u?s:u:l>u?l:u,m=n.next;m!==e;){if(m.x>=c&&m.x<=f&&m.y>=p&&m.y<=y&&Ir(i,s,o,l,a,u,m.x,m.y)&&oe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function ex(t,e,r,n){var i=t.prev,o=t,a=t.next;if(oe(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,p=o.y,f=a.y,y=s<l?s<u?s:u:l<u?l:u,m=c<p?c<f?c:f:p<f?p:f,h=s>l?s>u?s:u:l>u?l:u,d=c>p?c>f?c:f:p>f?p:f,g=Rs(y,m,e,r,n),b=Rs(h,d,e,r,n),x=t.prevZ,v=t.nextZ;x&&x.z>=g&&v&&v.z<=b;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ir(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ir(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=g;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ir(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=b;){if(v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ir(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function tx(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!Zo(i,o)&&bp(i,n,n.next,o)&&Hn(i,o)&&Hn(o,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(o.i/r|0),Xn(n),Xn(n.next),n=t=o),n=n.next}while(n!==t);return tr(n)}function rx(t,e,r,n,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&px(a,s)){var l=vp(a,s);a=tr(a,a.next),l=tr(l,l.next),Wn(a,e,r,n,i,o,0),Wn(l,e,r,n,i,o,0);return}s=s.next}a=a.next}while(a!==t)}function nx(t,e,r,n){var i=[],o,a,s,l,u;for(o=0,a=e.length;o<a;o++)s=e[o]*n,l=o<a-1?e[o+1]*n:t.length,u=xp(t,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(cx(u));for(i.sort(ix),o=0;o<i.length;o++)r=ox(i[o],r);return r}function ix(t,e){return t.x-e.x}function ox(t,e){var r=ax(t,e);if(!r)return e;var n=vp(r,t);return tr(n,n.next),tr(r,r.next)}function ax(t,e){var r=e,n=t.x,i=t.y,o=-1/0,a;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o&&(o=s,a=r.x<r.next.x?r:r.next,s===n))return a}r=r.next}while(r!==e);if(!a)return null;var l=a,u=a.x,c=a.y,p=1/0,f;r=a;do n>=r.x&&r.x>=u&&n!==r.x&&Ir(i<c?n:o,i,u,c,i<c?o:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),Hn(r,t)&&(f<p||f===p&&(r.x>a.x||r.x===a.x&&sx(a,r)))&&(a=r,p=f)),r=r.next;while(r!==l);return a}function sx(t,e){return oe(t.prev,t,e.prev)<0&&oe(e.next,t,t.next)<0}function lx(t,e,r,n){var i=t;do i.z===0&&(i.z=Rs(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,ux(i)}function ux(t){var e,r,n,i,o,a,s,l,u=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,s=0,e=0;e<u&&(s++,n=n.nextZ,!!n);e++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1);return t}function Rs(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function cx(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Ir(t,e,r,n,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(n-s)>=(r-a)*(e-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function px(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!fx(t,e)&&(Hn(t,e)&&Hn(e,t)&&yx(t,e)&&(oe(t.prev,t,e.prev)||oe(t,e.prev,e))||Zo(t,e)&&oe(t.prev,t,t.next)>0&&oe(e.prev,e,e.next)>0)}function oe(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Zo(t,e){return t.x===e.x&&t.y===e.y}function bp(t,e,r,n){var i=jo(oe(t,e,r)),o=jo(oe(t,e,n)),a=jo(oe(r,n,t)),s=jo(oe(r,n,e));return!!(i!==o&&a!==s||i===0&&qo(t,r,e)||o===0&&qo(t,n,e)||a===0&&qo(r,t,n)||s===0&&qo(r,e,n))}function qo(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function jo(t){return t>0?1:t<0?-1:0}function fx(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&bp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Hn(t,e){return oe(t.prev,t,t.next)<0?oe(t,e,t.next)>=0&&oe(t,t.prev,e)>=0:oe(t,e,t.prev)<0||oe(t,t.next,e)<0}function yx(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function vp(t,e){var r=new Os(t.i,t.x,t.y),n=new Os(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function gp(t,e,r,n){var i=new Os(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Xn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Os(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jo.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(Ns(t,0,o,r));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;a-=Math.abs(Ns(t,u,c,r))}var p=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,y=n[s+1]*r,m=n[s+2]*r;p+=Math.abs((t[f]-t[m])*(t[y+1]-t[f+1])-(t[f]-t[y])*(t[m+1]-t[f+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function Ns(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}Jo.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}});var qs=Ae((kS,Cp)=>{"use strict";var vx=he();Cp.exports=Mr;function Mr(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(Px,this,e)}function Px(t,e,r){t==1?e.id=r.readVarint():t==2?Sx(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function Sx(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}Mr.types=["Unknown","Point","LineString","Polygon"];Mr.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=[],s;t.pos<e;){if(n<=0){var l=t.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),r===1&&(s&&a.push(s),s=[]),s.push(new vx(i,o));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&a.push(s),a};Mr.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(r!==7)throw new Error("unknown command "+r)}return[a,l,s,u]};Mr.prototype.toGeoJSON=function(t,e,r){var n=this.extent*Math.pow(2,r),i=this.extent*t,o=this.extent*e,a=this.loadGeometry(),s=Mr.types[this.type],l,u;function c(y){for(var m=0;m<y.length;m++){var h=y[m],d=180-(h.y+o)*360/n;y[m]=[(h.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(l=0;l<a.length;l++)p[l]=a[l][0];a=p,c(a);break;case 2:for(l=0;l<a.length;l++)c(a[l]);break;case 3:for(a=wx(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)c(a[l][u]);break}a.length===1?a=a[0]:s="Multi"+s;var f={type:"Feature",geometry:{type:s,coordinates:a},properties:this.properties};return"id"in this&&(f.id=this.id),f};function wx(t){var e=t.length;if(e<=1)return[t];for(var r=[],n,i,o=0;o<e;o++){var a=Ax(t[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}function Ax(t){for(var e=0,r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}});var js=Ae((MS,Mp)=>{"use strict";var _x=qs();Mp.exports=kp;function kp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ix,this,e),this.length=this._features.length}function Ix(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(Tx(r))}function Tx(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null}return e}kp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new _x(this._pbf,e,this.extent,this._keys,this._values)}});var Fp=Ae((ES,Ep)=>{"use strict";var Cx=js();Ep.exports=kx;function kx(t,e){this.layers=t.readFields(Mx,{},e)}function Mx(t,e,r){if(t===3){var n=new Cx(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}});var Tt=Ae((FS,Ho)=>{Ho.exports.VectorTile=Fp();Ho.exports.VectorTileFeature=qs();Ho.exports.VectorTileLayer=js()});var Qp=Ae(Xs=>{Xs.read=function(t,e,r,n,i){var o,a,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,f=r?-1:1,y=t[e+p];for(p+=f,o=y&(1<<-c)-1,y>>=-c,c+=s;c>0;o=o*256+t[e+p],p+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=a*256+t[e+p],p+=f,c-=8);if(o===0)o=1-u;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-u}return(y?-1:1)*a*Math.pow(2,o-n)};Xs.write=function(t,e,r,n,i,o){var a,s,l,u=o*8-i-1,c=(1<<u)-1,p=c>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,m=n?1:-1,h=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+p>=1?e+=f/l:e+=f*Math.pow(2,1-p),e*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(e*l-1)*Math.pow(2,i),a=a+p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[r+y]=s&255,y+=m,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+y]=a&255,y+=m,a/=256,u-=8);t[r+y-m]|=h*128}});var ei=Ae((m2,of)=>{"use strict";of.exports=J;var ea=Qp();function J(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}J.Varint=0;J.Fixed64=1;J.Bytes=2;J.Fixed32=5;var Ks=65536*65536,ef=1/Ks,Hx=12,nf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");J.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ta(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=rf(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ta(this.buf,this.pos)+ta(this.buf,this.pos+4)*Ks;return this.pos+=8,t},readSFixed64:function(){var t=ta(this.buf,this.pos)+rf(this.buf,this.pos+4)*Ks;return this.pos+=8,t},readFloat:function(){var t=ea.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ea.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r,n;return n=e[this.pos++],r=n&127,n<128||(n=e[this.pos++],r|=(n&127)<<7,n<128)||(n=e[this.pos++],r|=(n&127)<<14,n<128)||(n=e[this.pos++],r|=(n&127)<<21,n<128)?r:(n=e[this.pos],r|=(n&15)<<28,Xx(r,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=Hx&&nf?cb(this.buf,e,t):ub(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==J.Bytes)return t.push(this.readVarint(e));var r=ct(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==J.Bytes)return t.push(this.readSVarint());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==J.Bytes)return t.push(this.readBoolean());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==J.Bytes)return t.push(this.readFloat());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==J.Bytes)return t.push(this.readDouble());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed32());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed32());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readFixed64());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==J.Bytes)return t.push(this.readSFixed64());var e=ct(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===J.Varint)for(;this.buf[this.pos++]>127;);else if(e===J.Bytes)this.pos=this.readVarint()+this.pos;else if(e===J.Fixed32)this.pos+=4;else if(e===J.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Lr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Lr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Lr(this.buf,t&-1,this.pos),Lr(this.buf,Math.floor(t*ef),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Lr(this.buf,t&-1,this.pos),Lr(this.buf,Math.floor(t*ef),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){Kx(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=pb(this.buf,t,this.pos);var r=this.pos-e;r>=128&&tf(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),ea.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ea.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&tf(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,J.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,eb,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,tb,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ib,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,rb,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,nb,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,ob,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ab,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,sb,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,lb,e)},writeBytesField:function(t,e){this.writeTag(t,J.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,J.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,J.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,J.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,J.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,J.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,J.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function Xx(t,e,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return Fr(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function ct(t){return t.type===J.Bytes?t.readVarint()+t.pos:t.pos+1}function Fr(t,e,r){return r?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function Kx(t,e){var r,n;if(t>=0?(r=t%4294967296|0,n=t/4294967296|0):(r=~(-t%4294967296),n=~(-t/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),Yx(r,n,e),Qx(n,e)}function Yx(t,e,r){r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos++]=t&127|128,t>>>=7,r.buf[r.pos]=t&127}function Qx(t,e){var r=(t&7)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function tf(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function eb(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function tb(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function rb(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function nb(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function ib(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function ob(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function ab(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function sb(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function lb(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ta(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Lr(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function rf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ub(t,e,r){for(var n="",i=e;i<r;){var o=t[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var l,u,c;s===1?o<128&&(a=o):s===2?(l=t[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=t[i+1],u=t[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=t[i+1],u=t[i+2],c=t[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function cb(t,e,r){return nf.decode(t.subarray(e,r))}function pb(t,e,r){for(var n=0,i,o;n<e.length;n++){if(i=e.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):o=i;continue}else o&&(t[r++]=239,t[r++]=191,t[r++]=189,o=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=i&63|128)}return r}});var ey=Ae((pT,Qf)=>{Qf.exports=Aa;function Aa(t,e){var r=t&&t.type,n;if(r==="FeatureCollection")for(n=0;n<t.features.length;n++)Aa(t.features[n],e);else if(r==="GeometryCollection")for(n=0;n<t.geometries.length;n++)Aa(t.geometries[n],e);else if(r==="Feature")Aa(t.geometry,e);else if(r==="Polygon")Kf(t.coordinates,e);else if(r==="MultiPolygon")for(n=0;n<t.coordinates.length;n++)Kf(t.coordinates[n],e);return t}function Kf(t,e){if(t.length!==0){Yf(t[0],e);for(var r=1;r<t.length;r++)Yf(t[r],!e)}}function Yf(t,e){for(var r=0,n=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!e&&t.reverse()}});var iy=Ae((mT,ny)=>{"use strict";var Zb=he(),Wb=Tt().VectorTileFeature;ny.exports=ry;function ry(t,e){this.options=e||{},this.features=t,this.length=t.length}ry.prototype.feature=function(t){return new Ia(this.features[t],this.options.extent)};function Ia(t,e){this.id=typeof t.id=="number"?t.id:void 0,this.type=t.type,this.rawGeometry=t.type===1?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Ia.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],n=[],i=0;i<r.length;i++)n.push(new Zb(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry};Ia.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[e,n,r,i]};Ia.prototype.toGeoJSON=Wb.prototype.toGeoJSON});var sy=Ae((hT,gi)=>{var Hb=ei(),ay=iy();gi.exports=dl;gi.exports.fromVectorTileJs=dl;gi.exports.fromGeojsonVt=Xb;gi.exports.GeoJSONWrapper=ay;function dl(t){var e=new Hb;return Kb(t,e),e.finish()}function Xb(t,e){e=e||{};var r={};for(var n in t)r[n]=new ay(t[n].features,e),r[n].name=n,r[n].version=e.version,r[n].extent=e.extent;return dl({layers:r})}function Kb(t,e){for(var r in t.layers)e.writeMessage(3,Yb,t.layers[r])}function Yb(t,e){e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)n.feature=t.feature(r),e.writeMessage(2,Qb,n);var i=n.keys;for(r=0;r<i.length;r++)e.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)e.writeMessage(4,r0,o[r])}function Qb(t,e){var r=t.feature;r.id!==void 0&&e.writeVarintField(1,r.id),e.writeMessage(2,e0,t),e.writeVarintField(3,r.type),e.writeMessage(4,t0,r)}function e0(t,e){var r=t.feature,n=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=r.properties[s],u=o[s];if(l!==null){typeof u>"u"&&(n.push(s),u=n.length-1,o[s]=u),e.writeVarint(u);var c=typeof l;c!=="string"&&c!=="boolean"&&c!=="number"&&(l=JSON.stringify(l));var p=c+":"+l,f=a[p];typeof f>"u"&&(i.push(l),f=i.length-1,a[p]=f),e.writeVarint(f)}}}function hl(t,e){return(e<<3)+(t&7)}function oy(t){return t<<1^t>>31}function t0(t,e){for(var r=t.loadGeometry(),n=t.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;n===1&&(u=l.length),e.writeVarint(hl(1,u));for(var c=n===3?l.length-1:l.length,p=0;p<c;p++){p===1&&n!==1&&e.writeVarint(hl(2,c-1));var f=l[p].x-i,y=l[p].y-o;e.writeVarint(oy(f)),e.writeVarint(oy(y)),i+=f,o+=y}n===3&&e.writeVarint(hl(7,1))}}function r0(t,e){var r=typeof t;r==="string"?e.writeStringField(1,t):r==="boolean"?e.writeBooleanField(7,t):r==="number"&&(t%1!==0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}});var Ly=Z(he(),1),Zl=Z(Gl(),1);var Oa;function ql(){return Oa==null&&(Oa=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Oa}var ki;function jl(){if(ki==null&&(ki=!1,ql())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let i=0;i<5*5;i++){let o=i*4;r.fillStyle="rgb(".concat(o,",").concat(o+1,",").concat(o+2,")"),r.fillRect(i%5,Math.floor(i/5),1,1)}let n=r.getImageData(0,0,5,5).data;for(let i=0;i<5*5*4;i++)if(i%4!==3&&n[i]!==i){ki=!0;break}}}return ki||!1}function Wl(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function Dy(t,e,r,n){let i=new Zl.default(t,e,r,n);return function(o){return i.solve(o)}}var S0=Dy(.25,.1,.25,1);function it(t,e,r){return Math.min(r,Math.max(e,t))}function Hl(t,e,r){let n=r-e,i=((t-e)%n+n)%n+e;return i===e?r:i}function Pe(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}function Xl(t){return Math.log(t)/Math.LN2%1===0}function jr(t,e,r){let n={};for(let i in t)n[i]=e.call(r||this,t[i],i,t);return n}function Kl(t,e,r){let n={};for(let i in t)e.call(r||this,t[i],i,t)&&(n[i]=t[i]);return n}function nt(t){return Array.isArray(t)?t.map(nt):typeof t=="object"&&t?jr(t,nt):t}function Yl(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}var Jl={};function fe(t){Jl[t]||(typeof console<"u"&&console.warn(t),Jl[t]=!0)}function ot(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function Ql(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}function at(t){return typeof WorkerGlobalScope<"u"&&typeof t<"u"&&t instanceof WorkerGlobalScope}function Jr(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap}function Vy(t,e,r,n,i){let o=Math.max(-e,0)*4,l=(Math.max(0,r)-r)*n*4+o,u=n*4,c=Math.max(0,e),p=Math.max(0,r),f=Math.min(t.width,e+n),y=Math.min(t.height,r+i);return{rect:{x:c,y:p,width:f-c,height:y-p},layout:[{offset:l,stride:u}]}}async function By(t,e,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let o=new VideoFrame(t,{timestamp:0});try{let a=o==null?void 0:o.format;if(!a||!(a.startsWith("BGR")||a.startsWith("RGB")))throw new Error("Unrecognized format ".concat(a));let s=a.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await o.copyTo(l,Vy(t,e,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{o.close()}}var Gr,qr;function zy(t,e,r,n,i){let o=t.width,a=t.height;(!Gr||!qr)&&(Gr=new OffscreenCanvas(o,a),qr=Gr.getContext("2d",{willReadFrequently:!0})),Gr.width=o,Gr.height=a,qr.drawImage(t,0,0,o,a);let s=qr.getImageData(e,r,n,i);return qr.clearRect(0,0,o,a),s.data}async function eu(t,e,r,n,i){if(jl())try{return await By(t,e,r,n,i)}catch(o){}return zy(t,e,r,n,i)}function tu(t,e,r,n){return t.addEventListener(e,r,n),{unsubscribe:()=>{t.removeEventListener(e,r,n)}}}var Vt=class t{constructor(e,r,n){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let a=new Int32Array(this.arrayBuffer);e=a[0],r=a[1],n=a[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=a[3+u],p=a[3+u+1];i.push(c===p?null:a.subarray(c,p))}let s=a[3+i.length],l=a[3+i.length+1];this.keys=a.subarray(s,l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let a=0;a<this.d*this.d;a++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=n,this.scale=r/e,this.uid=0;let o=n/r*e;this.min=-o,this.max=e+o}insert(e,r,n,i,o){this._forEachCell(r,n,i,o,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,n,i,o,a){this.cells[o].push(a)}query(e,r,n,i,o){let a=this.min,s=this.max;if(e<=a&&r<=a&&s<=n&&s<=i&&!o)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,r,n,i,this._queryCell,l,u,o),l}}_queryCell(e,r,n,i,o,a,s,l){let u=this.cells[o];if(u!==null){let c=this.keys,p=this.bboxes;for(let f=0;f<u.length;f++){let y=u[f];if(s[y]===void 0){let m=y*4;(l?l(p[m+0],p[m+1],p[m+2],p[m+3]):e<=p[m+2]&&r<=p[m+3]&&n>=p[m+0]&&i>=p[m+1])?(s[y]=!0,a.push(c[y])):s[y]=!1}}}}_forEachCell(e,r,n,i,o,a,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),p=this._convertToCellCoord(n),f=this._convertToCellCoord(i);for(let y=u;y<=p;y++)for(let m=c;m<=f;m++){let h=this.d*m+y;if(!(l&&!l(this._convertFromCellCoord(y),this._convertFromCellCoord(m),this._convertFromCellCoord(y+1),this._convertFromCellCoord(m+1)))&&o.call(this,e,r,n,i,h,a,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,r=3+this.cells.length+1+1,n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let o=r;for(let a=0;a<e.length;a++){let s=e[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+e.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+e.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}static serialize(e,r){let n=e.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(e){return new t(e.buffer)}};var Ry=8,Oy={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Ny={"*":{type:"source"}},Uy=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],$y={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Gy={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},qy={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},jy={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Jy={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Zy={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Wy={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Hy=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Xy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ky={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yy={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Qy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},em={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},tm={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},rm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},nm={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},im={type:"array",value:"*"},om={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},am={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},sm={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},lm={type:"array",value:"*",minimum:1},um={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},cm={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},pm={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},fm={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},ym=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],mm={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},hm={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},dm={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},gm={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},xm={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},bm={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},vm={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Pm={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Sm={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},wm={"*":{type:"string"}},S={$version:Ry,$root:Oy,sources:Ny,source:Uy,source_vector:$y,source_raster:Gy,source_raster_dem:qy,source_geojson:jy,source_video:Jy,source_image:Zy,layer:Wy,layout:Hy,layout_background:Xy,layout_fill:Ky,layout_circle:Yy,layout_heatmap:Qy,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:em,layout_symbol:tm,layout_raster:rm,layout_hillshade:nm,filter:im,filter_operator:om,geometry_type:am,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:sm,expression:lm,light:um,sky:cm,terrain:pm,projection:fm,paint:ym,paint_fill:mm,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:hm,paint_circle:dm,paint_heatmap:gm,paint_symbol:xm,paint_raster:bm,paint_hillshade:vm,paint_background:Pm,transition:Sm,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:wm},Am=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var M=class{constructor(e,r,n,i){this.message=(e?"".concat(e,": "):"")+n,i&&(this.identifier=i),r!=null&&r.__line__&&(this.line=r.__line__)}};function fr(t,...e){for(let r of e)for(let n in r)t[n]=r[n];return t}var Be=class extends Error{constructor(e,r){super(r),this.message=r,this.key=e}},Ha=class t{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(e){return new t(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}},hr={kind:"null"},L={kind:"number"},G={kind:"string"},U={kind:"boolean"},Re={kind:"color"},cr={kind:"object"},$={kind:"value"},_m={kind:"error"},Wi={kind:"collator"},dr={kind:"formatted"},Hi={kind:"padding"},cn={kind:"resolvedImage"},Xi={kind:"variableAnchorOffsetCollection"};function Ee(t,e){return{kind:"array",itemType:t,N:e}}function te(t){if(t.kind==="array"){let e=te(t.itemType);return typeof t.N=="number"?"array<".concat(e,", ").concat(t.N,">"):t.itemType.kind==="value"?"array":"array<".concat(e,">")}else return t.kind}var Im=[hr,L,G,U,Re,dr,cr,Ee($),Hi,cn,Xi];function Kr(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Kr(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of Im)if(!Kr(r,e))return null}}return"Expected ".concat(te(t)," but found ").concat(te(e)," instead.")}function fs(t,e){return e.some(r=>r.kind===t.kind)}function Rt(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}function Zr(t,e){return t.kind==="array"&&e.kind==="array"?t.itemType.kind===e.itemType.kind&&typeof t.N=="number":t.kind===e.kind}var wu=.96422,Au=1,_u=.82521,Iu=4/29,pr=6/29,Tu=3*pr*pr,Tm=pr*pr*pr,Cm=Math.PI/180,km=180/Math.PI;function Cu(t){return t=t%360,t<0&&(t+=360),t}function ku([t,e,r,n]){t=Na(t),e=Na(e),r=Na(r);let i,o,a=Ua((.2225045*t+.7168786*e+.0606169*r)/Au);t===e&&e===r?i=o=a:(i=Ua((.4360747*t+.3850649*e+.1430804*r)/wu),o=Ua((.0139322*t+.0971045*e+.7141733*r)/_u));let s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function Na(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ua(t){return t>Tm?Math.pow(t,1/3):t/Tu+Iu}function Mu([t,e,r,n]){let i=(t+16)/116,o=isNaN(e)?i:i+e/500,a=isNaN(r)?i:i-r/200;return i=Au*Ga(i),o=wu*Ga(o),a=_u*Ga(a),[$a(3.1338561*o-1.6168667*i-.4906146*a),$a(-.9787684*o+1.9161415*i+.033454*a),$a(.0719453*o-.2289914*i+1.4052427*a),n]}function $a(t){return t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055,t<0?0:t>1?1:t}function Ga(t){return t>pr?t*t*t:Tu*(t-Iu)}function Mm(t){let[e,r,n,i]=ku(t),o=Math.sqrt(r*r+n*n);return[Math.round(o*1e4)?Cu(Math.atan2(n,r)*km):NaN,o,e,i]}function Em([t,e,r,n]){return t=isNaN(t)?0:t*Cm,Mu([r,Math.cos(t)*e,Math.sin(t)*e,n])}function Fm([t,e,r,n]){t=Cu(t),e/=100,r/=100;function i(o){let a=(o+t/30)%12,s=e*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return[i(0),i(8),i(4),n]}function Lm(t){if(t=t.toLowerCase().trim(),t==="transparent")return[0,0,0,0];let e=Dm[t];if(e){let[i,o,a]=e;return[i/255,o/255,a/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){let o=t.length<6?1:2,a=1;return[Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+=o)),Mi(t.slice(a,a+o)||"ff")]}if(t.startsWith("rgb")){let i=/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,o=t.match(i);if(o){let[a,s,l,u,c,p,f,y,m,h,d,g]=o,b=[u||" ",f||" ",h].join("");if(b==="  "||b==="  /"||b===",,"||b===",,,"){let x=[l,p,m].join(""),v=x==="%%%"?100:x===""?255:0;if(v){let P=[lr(+s/v,0,1),lr(+c/v,0,1),lr(+y/v,0,1),d?ru(+d,g):1];if(nu(P))return P}}return}}let r=/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,n=t.match(r);if(n){let[i,o,a,s,l,u,c,p,f]=n,y=[a||" ",l||" ",c].join("");if(y==="  "||y==="  /"||y===",,"||y===",,,"){let m=[+o,lr(+s,0,100),lr(+u,0,100),p?ru(+p,f):1];if(nu(m))return Fm(m)}}}function Mi(t){return parseInt(t.padEnd(2,t),16)/255}function ru(t,e){return lr(e?t/100:t,0,1)}function lr(t,e,r){return Math.min(Math.max(e,t),r)}function nu(t){return!t.some(Number.isNaN)}var Dm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},W=class t{constructor(e,r,n,i=1,o=!0){this.r=e,this.g=r,this.b=n,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,r,n,i]))}static parse(e){if(e instanceof t)return e;if(typeof e!="string")return;let r=Lm(e);if(r)return new t(...r,!1)}get rgb(){let{r:e,g:r,b:n,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[e/o,r/o,n/o,i])}get hcl(){return this.overwriteGetter("hcl",Mm(this.rgb))}get lab(){return this.overwriteGetter("lab",ku(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){let[e,r,n,i]=this.rgb;return"rgba(".concat([e,r,n].map(o=>Math.round(o*255)).join(","),",").concat(i,")")}};W.black=new W(0,0,0,1);W.white=new W(1,1,1,1);W.transparent=new W(0,0,0,0);W.red=new W(1,0,0,1);var Yr=class{constructor(e,r,n){e?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},Qr=class{constructor(e,r,n,i,o){this.text=e,this.image=r,this.scale=n,this.fontStack=i,this.textColor=o}},Fe=class t{constructor(e){this.sections=e}static fromString(e){return new t([new Qr(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof t?e:t.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}},Ze=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(typeof e=="number")return new t([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new t(e)}}toString(){return JSON.stringify(this.values)}},Vm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),Ne=class t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof t)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let r=0;r<e.length;r+=2){let n=e[r],i=e[r+1];if(typeof n!="string"||!Vm.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new t(e)}}toString(){return JSON.stringify(this.values)}},Te=class t{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new t({name:e,available:!1}):null}};function Eu(t,e,r,n){if(!(typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255)){let i=typeof n=="number"?[t,e,r,n]:[t,e,r];return"Invalid rgba value [".concat(i.join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value [".concat([t,e,r,n].join(", "),"]: 'a' must be between 0 and 1.")}function en(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof W||t instanceof Yr||t instanceof Fe||t instanceof Ze||t instanceof Ne||t instanceof Te)return!0;if(Array.isArray(t)){for(let e of t)if(!en(e))return!1;return!0}else if(typeof t=="object"){for(let e in t)if(!en(t[e]))return!1;return!0}else return!1}function ue(t){if(t===null)return hr;if(typeof t=="string")return G;if(typeof t=="boolean")return U;if(typeof t=="number")return L;if(t instanceof W)return Re;if(t instanceof Yr)return Wi;if(t instanceof Fe)return dr;if(t instanceof Ze)return Hi;if(t instanceof Ne)return Xi;if(t instanceof Te)return cn;if(Array.isArray(t)){let e=t.length,r;for(let n of t){let i=ue(n);if(!r)r=i;else{if(r===i)continue;r=$;break}}return Ee(r||$,e)}else return cr}function Hr(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof W||t instanceof Fe||t instanceof Ze||t instanceof Ne||t instanceof Te?t.toString():JSON.stringify(t)}var mt=class t{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!en(e[1]))return r.error("invalid value");let n=e[1],i=ue(n),o=r.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new t(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},ie=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}},Ei={string:G,number:L,boolean:U,object:cr},je=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=1,i,o=e[0];if(o==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in Ei)||u==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);s=Ei[u],n++}else s=$;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);l=e[2],n++}i=Ee(s,l)}else{if(!Ei[o])throw new Error("Types doesn't contain name = ".concat(o));i=Ei[o]}let a=[];for(;n<e.length;n++){let s=r.parse(e[n],n,$);if(!s)return null;a.push(s)}return new t(i,a)}evaluate(e){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(e);if(Kr(this.type,ue(n))){if(r===this.args.length-1)throw new ie("Expected value to be of type ".concat(te(this.type),", but found ").concat(te(ue(n))," instead."))}else return n}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},iu={"to-boolean":U,"to-color":Re,"to-number":L,"to-string":G},yt=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[0];if(!iu[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");let i=iu[n],o=[];for(let a=1;a<e.length;a++){let s=r.parse(e[a],a,$);if(!s)return null;o.push(s)}return new t(i,o)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(e),n=null,r instanceof W)return r;if(typeof r=="string"){let o=e.parseColor(r);if(o)return o}else if(Array.isArray(r)&&(r.length<3||r.length>4?n="Invalid rgba value ".concat(JSON.stringify(r),": expected an array containing either three or four numeric values."):n=Eu(r[0],r[1],r[2],r[3]),!n))return new W(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ie(n||"Could not parse color from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"padding":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ze.parse(r);if(i)return i}throw new ie("Could not parse padding from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(e);let i=Ne.parse(r);if(i)return i}throw new ie("Could not parse variableAnchorOffsetCollection from value '".concat(typeof r=="string"?r:JSON.stringify(r),"'"))}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(e),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new ie("Could not convert ".concat(JSON.stringify(r)," to number."))}case"formatted":return Fe.fromString(Hr(this.args[0].evaluate(e)));case"resolvedImage":return Te.fromString(Hr(this.args[0].evaluate(e)));default:return Hr(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},Bm=["Unknown","Point","LineString","Polygon"],Vi=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Bm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=W.parse(e)),r}},Bi=class t{constructor(e,r,n=[],i,o=new Ha,a=[]){this.registry=e,this.path=n,this.key=n.map(s=>"[".concat(s,"]")).join(""),this.scope=o,this.errors=a,this.expectedType=i,this._isConstant=r}parse(e,r,n,i,o={}){return r?this.concat(r,n,i)._parse(e,o):this._parse(e,o)}_parse(e,r){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(i,o,a){return a==="assert"?new je(o,[i]):a==="coerce"?new yt(o,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if(typeof i!="string")return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let o=this.registry[i];if(o){let a=o.parse(e,this);if(!a)return null;if(this.expectedType){let s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,r.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof mt)&&a.type.kind!=="resolvedImage"&&this._isConstant(a)){let s=new Vi;try{a=new mt(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(e,r,n){let i=typeof e=="number"?this.path.concat(e):this.path,o=n?this.scope.concat(n):this.scope;return new t(this.registry,this._isConstant,i,r||null,o,this.errors)}error(e,...r){let n="".concat(this.key).concat(r.map(i=>"[".concat(i,"]")).join(""));this.errors.push(new Be(n,e))}checkSubtype(e,r){let n=Kr(e,r);return n&&this.error(n),n}},zi=class t{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));let n=[];for(let o=1;o<e.length-1;o+=2){let a=e[o];if(typeof a!="string")return r.error("Expected string, but found ".concat(typeof a," instead."),o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or '_'.",o);let s=r.parse(e[o+1],o+1);if(!s)return null;n.push([a,s])}let i=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return i?new t(n,i):null}outputDefined(){return this.result.outputDefined()}},Ri=class t{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let n=e[1];return r.scope.has(n)?new t(n,r.scope.get(n)):r.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}},Xa=class t{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,L),i=r.parse(e[2],2,Ee(r.expectedType||$));if(!n||!i)return null;let o=i.type;return new t(o.itemType,n,i)}evaluate(e){let r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new ie("Array index out of bounds: ".concat(r," < 0."));if(r>=n.length)throw new ie("Array index out of bounds: ".concat(r," > ").concat(n.length-1,"."));if(r!==Math.floor(r))throw new ie("Array index must be an integer, but found ".concat(r," instead."));return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},Ka=class t{constructor(e,r){this.type=U,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,$);return!n||!i?null:fs(n.type,[U,G,L,hr,$])?new t(n,i):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(n.type)," instead"))}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Rt(r,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(ue(r))," instead."));if(!Rt(n,["string","array"]))throw new ie("Expected second argument to be of type array or string, but found ".concat(te(ue(n))," instead."));return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},Ya=class t{constructor(e,r,n){this.type=L,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,$);if(!n||!i)return null;if(!fs(n.type,[U,G,L,hr,$]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,L);return o?new t(n,i,o):null}else return new t(n,i)}evaluate(e){let r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Rt(r,["boolean","string","number","null"]))throw new ie("Expected first argument to be of type boolean, string, number or null, but found ".concat(te(ue(r))," instead."));let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(e)),Rt(n,["string"])){let o=n.indexOf(r,i);return o===-1?-1:[...n.slice(0,o)].length}else{if(Rt(n,["array"]))return n.indexOf(r,i);throw new ie("Expected second argument to be of type array or string, but found ".concat(te(ue(n))," instead."))}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},Qa=class t{constructor(e,r,n,i,o,a){this.inputType=e,this.type=r,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let o={},a=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],p=e[u+1];Array.isArray(c)||(c=[c]);let f=r.concat(u);if(c.length===0)return f.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return f.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if(typeof m=="number"&&Math.floor(m)!==m)return f.error("Numeric branch labels must be integer values.");if(!n)n=ue(m);else if(f.checkSubtype(n,ue(m)))return null;if(typeof o[String(m)]<"u")return f.error("Branch labels must be unique.");o[String(m)]=a.length}let y=r.parse(p,u,i);if(!y)return null;i=i||y.type,a.push(y)}let s=r.parse(e[1],1,$);if(!s)return null;let l=r.parse(e[e.length-1],e.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new t(n,i,s,o,a,l)}evaluate(e){let r=this.input.evaluate(e);return(ue(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}},es=class t{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let a=1;a<e.length-1;a+=2){let s=r.parse(e[a],a,U);if(!s)return null;let l=r.parse(e[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let o=r.parse(e[e.length-1],e.length-1,n);if(!o)return null;if(!n)throw new Error("Can't infer output type");return new t(n,i,o)}evaluate(e){for(let[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},ts=class t{constructor(e,r,n,i){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1,$),i=r.parse(e[2],2,L);if(!n||!i)return null;if(!fs(n.type,[Ee($),G,$]))return r.error("Expected first argument to be of type array or string, but found ".concat(te(n.type)," instead"));if(e.length===4){let o=r.parse(e[3],3,L);return o?new t(n.type,n,i,o):null}else return new t(n.type,n,i)}evaluate(e){let r=this.input.evaluate(e),n=this.beginIndex.evaluate(e),i;if(this.endIndex&&(i=this.endIndex.evaluate(e)),Rt(r,["string"]))return[...r].slice(n,i).join("");if(Rt(r,["array"]))return r.slice(n,i);throw new ie("Expected first argument to be of type array or string, but found ".concat(te(ue(r))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};function Ki(t,e){let r=t.length-1,n=0,i=r,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=t[o],s=t[o+1],a<=e){if(o===r||e<s)return o;n=o+1}else if(a>e)i=o-1;else throw new ie("Input is not a number.");return 0}var yr=class t{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(e[1],1,L);if(!n)return null;let i=[],o=null;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);for(let a=1;a<e.length;a+=2){let s=a===1?-1/0:e[a],l=e[a+1],u=a,c=a+1;if(typeof s!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let p=r.parse(l,c,o);if(!p)return null;o=o||p.type,i.push([s,p])}return new t(o,n,i)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=Ki(r,i);return n[a].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function zm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qa,ou;function Rm(){if(ou)return qa;ou=1,qa=t;function t(e,r,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(i-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=i}return t.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var o=this.sampleCurveX(n)-e;if(Math.abs(o)<r)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n=n-o/a}var s=0,l=1;for(n=e,i=0;i<20&&(o=this.sampleCurveX(n),!(Math.abs(o-e)<r));i++)e>o?s=n:l=n,n=(l-s)*.5+s;return n},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},qa}var Om=Rm(),Nm=zm(Om);function Um(t){return t==="rgb"||t==="hcl"||t==="lab"}function Ot(t,e,r){return t+r*(e-t)}function $m(t,e,r,n="rgb"){switch(n){case"rgb":{let[i,o,a,s]=Oi(t.rgb,e.rgb,r);return new W(i,o,a,s,!1)}case"hcl":{let[i,o,a,s]=t.hcl,[l,u,c,p]=e.hcl,f,y;if(!isNaN(i)&&!isNaN(l)){let b=l-i;l>i&&b>180?b-=360:l<i&&i-l>180&&(b+=360),f=i+r*b}else isNaN(i)?isNaN(l)?f=NaN:(f=l,(a===1||a===0)&&(y=u)):(f=i,(c===1||c===0)&&(y=o));let[m,h,d,g]=Em([f,y!=null?y:Ot(o,u,r),Ot(a,c,r),Ot(s,p,r)]);return new W(m,h,d,g,!1)}case"lab":{let[i,o,a,s]=Mu(Oi(t.lab,e.lab,r));return new W(i,o,a,s,!1)}}}function Oi(t,e,r){return t.map((n,i)=>Ot(n,e[i],r))}function Gm(t,e,r){return new Ze(Oi(t.values,e.values,r))}function qm(t,e,r){let n=t.values,i=e.values;if(n.length!==i.length)throw new ie("Cannot interpolate values of different length. from: ".concat(t.toString(),", to: ").concat(e.toString()));let o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==i[a])throw new ie("Cannot interpolate values containing mismatched anchors. from[".concat(a,"]: ").concat(n[a],", to[").concat(a,"]: ").concat(i[a]));o.push(n[a]);let[s,l]=n[a+1],[u,c]=i[a+1];o.push([Ot(s,u,r),Ot(l,c,r)])}return new Ne(o)}var Oe={number:Ot,color:$m,array:Oi,padding:Gm,variableAnchorOffsetCollection:qm},Je=class t{constructor(e,r,n,i,o){this.type=e,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(e,r,n,i){let o=0;if(e.name==="exponential")o=ja(r,e.base,n,i);else if(e.name==="linear")o=ja(r,1,n,i);else if(e.name==="cubic-bezier"){let a=e.controlPoints;o=new Nm(a[0],a[1],a[2],a[3]).solve(ja(r,1,n,i))}return o}static parse(e,r){let[n,i,o,...a]=e;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error("Unknown interpolation type ".concat(String(i[0])),1,0);if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(o=r.parse(o,2,L),!o)return null;let s=[],l=null;n==="interpolate-hcl"||n==="interpolate-lab"?l=Re:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<a.length;u+=2){let c=a[u],p=a[u+1],f=u+3,y=u+4;if(typeof c!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(s.length&&s[s.length-1][0]>=c)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);let m=r.parse(p,y,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!Zr(l,L)&&!Zr(l,Re)&&!Zr(l,Hi)&&!Zr(l,Xi)&&!Zr(l,Ee(L))?r.error("Type ".concat(te(l)," is not interpolatable.")):new t(l,n,i,o,s)}evaluate(e){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);let i=this.input.evaluate(e);if(i<=r[0])return n[0].evaluate(e);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(e);let a=Ki(r,i),s=r[a],l=r[a+1],u=t.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(e),p=n[a+1].evaluate(e);switch(this.operator){case"interpolate":return Oe[this.type.kind](c,p,u);case"interpolate-hcl":return Oe.color(c,p,u,"hcl");case"interpolate-lab":return Oe.color(c,p,u,"lab")}}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function ja(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Ni=class t{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let o=[];for(let s of e.slice(1)){let l=r.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}if(!n)throw new Error("No output type");return i&&o.some(s=>Kr(i,s.type))?new t($,o):new t(n,o)}evaluate(e){let r=null,n=0,i;for(let o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof Te&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};function au(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function jm(t,e,r){return e===r}function Jm(t,e,r){return e!==r}function Zm(t,e,r){return e<r}function Wm(t,e,r){return e>r}function Hm(t,e,r){return e<=r}function Xm(t,e,r){return e>=r}function Fu(t,e,r,n){return n.compare(e,r)===0}function Km(t,e,r,n){return!Fu(t,e,r,n)}function Ym(t,e,r,n){return n.compare(e,r)<0}function Qm(t,e,r,n){return n.compare(e,r)>0}function eh(t,e,r,n){return n.compare(e,r)<=0}function th(t,e,r,n){return n.compare(e,r)>=0}function gr(t,e,r){let n=t!=="=="&&t!=="!=";return class Lu{constructor(o,a,s){this.type=U,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");let s=o[0],l=a.parse(o[1],1,$);if(!l)return null;if(!au(s,l.type))return a.concat(1).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(te(l.type),"'."));let u=a.parse(o[2],2,$);if(!u)return null;if(!au(s,u.type))return a.concat(2).error('"'.concat(s,"\\" comparisons are not supported for type '").concat(te(u.type),"'."));if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot compare types '".concat(te(l.type),"' and '").concat(te(u.type),"'."));n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new je(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new je(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,Wi),!c)return null}return new Lu(l,u,c)}evaluate(o){let a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new ie('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(l.kind,", ").concat(u.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!=="string"||u.kind!=="string")return e(o,a,s)}return this.collator?r(o,a,s,this.collator.evaluate(o)):e(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var rh=gr("==",jm,Fu),nh=gr("!=",Jm,Km),ih=gr("<",Zm,Ym),oh=gr(">",Wm,Qm),ah=gr("<=",Hm,eh),sh=gr(">=",Xm,th),Ui=class t{constructor(e,r,n){this.type=Wi,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,U);if(!i)return null;let o=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,U);if(!o)return null;let a=null;return n.locale&&(a=r.parse(n.locale,1,G),!a)?null:new t(i,o,a)}evaluate(e){return new Yr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}},rs=class t{constructor(e,r,n,i,o){this.type=G,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let n=r.parse(e[1],1,L);if(!n)return null;let i=e[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=r.parse(i.locale,1,G),!o))return null;let a=null;if(i.currency&&(a=r.parse(i.currency,1,G),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,L),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,L),!l)?null:new t(n,o,a,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},tn=class t{constructor(e){this.type=dr,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],o=!1;for(let a=1;a<=e.length-1;++a){let s=e[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,L),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,Ee(G)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,Re),!c))return null;let p=i[i.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=r.parse(e[a],1,$);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null})}}return new t(i)}evaluate(e){let r=n=>{let i=n.content.evaluate(e);return ue(i)===cn?new Qr("",i,null,null,null):new Qr(Hr(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)};return new Fe(this.sections.map(r))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}},ns=class t{constructor(e){this.type=cn,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");let n=r.parse(e[1],1,G);return n?new t(n):r.error("No image name provided.")}evaluate(e){let r=this.input.evaluate(e),n=Te.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}},is=class t{constructor(e){this.type=L,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found ".concat(e.length-1," instead."));let n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error("Expected argument of type string or array, but found ".concat(te(n.type)," instead.")):new t(n):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new ie("Expected value to be of type string or array, but found ".concat(te(ue(r))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}},Xe=8192;function lh(t,e){let r=uh(t[0]),n=ph(t[1]),i=Math.pow(2,e.z);return[Math.round(r*i*Xe),Math.round(n*i*Xe)]}function ys(t,e){let r=Math.pow(2,e.z),n=(t[0]/Xe+e.x)/r,i=(t[1]/Xe+e.y)/r;return[ch(n),fh(i)]}function uh(t){return(180+t)/360}function ch(t){return t*360-180}function ph(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function fh(t){return 360/Math.PI*Math.atan(Math.exp((180-t*360)*Math.PI/180))-90}function pn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function rn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function yh(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function mh(t,e,r){let n=t[0]-e[0],i=t[1]-e[1],o=t[0]-r[0],a=t[1]-r[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function Yi(t,e,r,n){let i=[e[0]-t[0],e[1]-t[1]],o=[n[0]-r[0],n[1]-r[1]];return xh(o,i)===0?!1:!!(su(t,e,r,n)&&su(r,n,t,e))}function hh(t,e,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(Yi(t,e,n[i],n[i+1]))return!0;return!1}function xr(t,e,r=!1){let n=!1;for(let i of e)for(let o=0;o<i.length-1;o++){if(mh(t,i[o],i[o+1]))return r;yh(t,i[o],i[o+1])&&(n=!n)}return n}function dh(t,e){for(let r of e)if(xr(t,r))return!0;return!1}function Du(t,e){for(let r of t)if(!xr(r,e))return!1;for(let r=0;r<t.length-1;++r)if(hh(t[r],t[r+1],e))return!1;return!0}function gh(t,e){for(let r of e)if(Du(t,r))return!0;return!1}function xh(t,e){return t[0]*e[1]-t[1]*e[0]}function su(t,e,r,n){let i=t[0]-r[0],o=t[1]-r[1],a=e[0]-r[0],s=e[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function ms(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=[];for(let a=0;a<t[i].length;a++){let s=lh(t[i][a],r);pn(e,s),o.push(s)}n.push(o)}return n}function Vu(t,e,r){let n=[];for(let i=0;i<t.length;i++){let o=ms(t[i],e,r);n.push(o)}return n}function Bu(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){let i=n*.5,o=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;o===0&&(o=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=o}pn(e,t)}function bh(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}function lu(t,e,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of t)for(let l of s){let u=[l.x+o[0],l.y+o[1]];Bu(u,e,r,i),a.push(u)}return a}function uu(t,e,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of t){let l=[];for(let u of s){let c=[u.x+o[0],u.y+o[1]];pn(e,c),l.push(c)}a.push(l)}if(e[2]-e[0]<=i/2){bh(e);for(let s of a)for(let l of s)Bu(l,e,r,i)}return a}function vh(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=ms(e.coordinates,n,i),a=lu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!xr(s,o))return!1}if(e.type==="MultiPolygon"){let o=Vu(e.coordinates,n,i),a=lu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!dh(s,o))return!1}return!0}function Ph(t,e){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if(e.type==="Polygon"){let o=ms(e.coordinates,n,i),a=uu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!Du(s,o))return!1}if(e.type==="MultiPolygon"){let o=Vu(e.coordinates,n,i),a=uu(t.geometry(),r,n,i);if(!rn(r,n))return!1;for(let s of a)if(!gh(s,o))return!1}return!0}var nn=class t{constructor(e,r){this.type=U,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(en(e[1])){let n=e[1];if(n.type==="FeatureCollection"){let i=[];for(let o of n.features){let{type:a,coordinates:s}=o.geometry;a==="Polygon"&&i.push(s),a==="MultiPolygon"&&i.push(...s)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new t(n,o)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new t(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new t(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return vh(e,this.geometries);if(e.geometryType()==="LineString")return Ph(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},$i=class{constructor(e=[],r=(n,i)=>n<i?-1:n>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=a+1;if(s<this.length&&n(r[s],r[a])<0&&(a=s),n(r[a],o)>=0)break;r[e]=r[a],e=a}r[e]=o}};function Sh(t,e,r,n,i){zu(t,e,r,n||t.length-1,i||wh)}function zu(t,e,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(e-a*l/o+u)),p=Math.min(n,Math.floor(e+(o-a)*l/o+u));zu(t,e,c,p,i)}var f=t[e],y=r,m=n;for(Wr(t,r,e),i(t[n],f)>0&&Wr(t,r,n);y<m;){for(Wr(t,y,m),y++,m--;i(t[y],f)<0;)y++;for(;i(t[m],f)>0;)m--}i(t[r],f)===0?Wr(t,r,m):(m++,Wr(t,m,n)),m<=e&&(r=m+1),e<=m&&(n=m-1)}}function Wr(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function wh(t,e){return t<e?-1:t>e?1:0}function Ah(t,e){if(t.length<=1)return[t];let n=[],i,o;for(let a of t){let s=Ih(a);s!==0&&(a.area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(Sh(n[a],e,1,n[a].length-1,_h),n[a]=n[a].slice(0,e));return n}function _h(t,e){return e.area-t.area}function Ih(t){let e=0;for(let r=0,n=t.length,i=n-1,o,a;r<n;i=r++)o=t[r],a=t[i],e+=(a.x-o.x)*(o.y+a.y);return e}var Th=6378.137,cu=1/298.257223563,pu=cu*(2-cu),fu=Math.PI/180,on=class{constructor(e){let r=fu*Th*1e3,n=Math.cos(e*fu),i=1/(1-pu*(1-n*n)),o=Math.sqrt(i);this.kx=r*o*n,this.ky=r*o*i*(1-pu)}distance(e,r){let n=this.wrap(e[0]-r[0])*this.kx,i=(e[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(e,r){let n=1/0,i,o,a,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],p=this.wrap(e[l+1][0]-u)*this.kx,f=(e[l+1][1]-c)*this.ky,y=0;(p!==0||f!==0)&&(y=(this.wrap(r[0]-u)*this.kx*p+(r[1]-c)*this.ky*f)/(p*p+f*f),y>1?(u=e[l+1][0],c=e[l+1][1]):y>0&&(u+=p/this.kx*y,c+=f/this.ky*y)),p=this.wrap(r[0]-u)*this.kx,f=(r[1]-c)*this.ky;let m=p*p+f*f;m<n&&(n=m,i=u,o=c,a=l,s=y)}return{point:[i,o],index:a,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}},os=100,as=50;function Ru(t,e){return e[0]-t[0]}function Gi(t){return t[1]-t[0]+1}function st(t,e){return t[1]>=t[0]&&t[1]<e}function ss(t,e){if(t[0]>t[1])return[null,null];let r=Gi(t);if(e){if(r===2)return[t,null];let i=Math.floor(r/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}if(r===1)return[t,null];let n=Math.floor(r/2)-1;return[[t[0],t[0]+n],[t[0]+n+1,t[1]]]}function ls(t,e){if(!st(e,t.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=e[0];n<=e[1];++n)pn(r,t[n]);return r}function us(t){let e=[1/0,1/0,-1/0,-1/0];for(let r of t)for(let n of r)pn(e,n);return e}function yu(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function hs(t,e,r){if(!yu(t)||!yu(e))return NaN;let n=0,i=0;return t[2]<e[0]&&(n=e[0]-t[2]),t[0]>e[2]&&(n=t[0]-e[2]),t[1]>e[3]&&(i=t[1]-e[3]),t[3]<e[1]&&(i=e[1]-t[3]),r.distance([0,0],[n,i])}function zt(t,e,r){let n=r.pointOnLine(e,t);return r.distance(t,n.point)}function ds(t,e,r,n,i){let o=Math.min(zt(t,[r,n],i),zt(e,[r,n],i)),a=Math.min(zt(r,[t,e],i),zt(n,[t,e],i));return Math.min(o,a)}function Ch(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return 1/0;let a=1/0;for(let s=e[0];s<e[1];++s){let l=t[s],u=t[s+1];for(let c=n[0];c<n[1];++c){let p=r[c],f=r[c+1];if(Yi(l,u,p,f))return 0;a=Math.min(a,ds(l,u,p,f,i))}}return a}function kh(t,e,r,n,i){if(!(st(e,t.length)&&st(n,r.length)))return NaN;let a=1/0;for(let s=e[0];s<=e[1];++s)for(let l=n[0];l<=n[1];++l)if(a=Math.min(a,i.distance(t[s],r[l])),a===0)return a;return a}function Mh(t,e,r){if(xr(t,e,!0))return 0;let n=1/0;for(let i of e){let o=i[0],a=i[i.length-1];if(o!==a&&(n=Math.min(n,zt(t,[a,o],r)),n===0))return n;let s=r.pointOnLine(i,t);if(n=Math.min(n,r.distance(t,s.point)),n===0)return n}return n}function Eh(t,e,r,n){if(!st(e,t.length))return NaN;for(let o=e[0];o<=e[1];++o)if(xr(t[o],r,!0))return 0;let i=1/0;for(let o=e[0];o<e[1];++o){let a=t[o],s=t[o+1];for(let l of r)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let f=l[p],y=l[u];if(Yi(a,s,f,y))return 0;i=Math.min(i,ds(a,s,f,y,n))}}return i}function mu(t,e){for(let r of t)for(let n of r)if(xr(n,e,!0))return!0;return!1}function Fh(t,e,r,n=1/0){let i=us(t),o=us(e);if(n!==1/0&&hs(i,o,r)>=n)return n;if(rn(i,o)){if(mu(t,e))return 0}else if(mu(e,t))return 0;let a=1/0;for(let s of t)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],f=s[l];for(let y of e)for(let m=0,h=y.length,d=h-1;m<h;d=m++){let g=y[d],b=y[m];if(Yi(p,f,g,b))return 0;a=Math.min(a,ds(p,f,g,b,r))}}return a}function hu(t,e,r,n,i,o){if(!o)return;let a=hs(ls(n,o),i,r);a<e&&t.push([a,o,[0,0]])}function Fi(t,e,r,n,i,o,a){if(!o||!a)return;let s=hs(ls(n,o),ls(i,a),r);s<e&&t.push([s,o,a])}function qi(t,e,r,n,i=1/0){let o=Math.min(n.distance(t[0],r[0][0]),i);if(o===0)return o;let a=new $i([[0,[0,t.length-1],[0,0]]],Ru),s=us(r);for(;a.length>0;){let l=a.pop();if(l[0]>=o)continue;let u=l[1],c=e?as:os;if(Gi(u)<=c){if(!st(u,t.length))return NaN;if(e){let p=Eh(t,u,r,n);if(isNaN(p)||p===0)return p;o=Math.min(o,p)}else for(let p=u[0];p<=u[1];++p){let f=Mh(t[p],r,n);if(o=Math.min(o,f),o===0)return 0}}else{let p=ss(u,e);hu(a,o,n,t,s,p[0]),hu(a,o,n,t,s,p[1])}}return o}function ji(t,e,r,n,i,o=1/0){let a=Math.min(o,i.distance(t[0],r[0]));if(a===0)return a;let s=new $i([[0,[0,t.length-1],[0,r.length-1]]],Ru);for(;s.length>0;){let l=s.pop();if(l[0]>=a)continue;let u=l[1],c=l[2],p=e?as:os,f=n?as:os;if(Gi(u)<=p&&Gi(c)<=f){if(!st(u,t.length)&&st(c,r.length))return NaN;let y;if(e&&n)y=Ch(t,u,r,c,i),a=Math.min(a,y);else if(e&&!n){let m=t.slice(u[0],u[1]+1);for(let h=c[0];h<=c[1];++h)if(y=zt(r[h],m,i),a=Math.min(a,y),a===0)return a}else if(!e&&n){let m=r.slice(c[0],c[1]+1);for(let h=u[0];h<=u[1];++h)if(y=zt(t[h],m,i),a=Math.min(a,y),a===0)return a}else y=kh(t,u,r,c,i),a=Math.min(a,y)}else{let y=ss(u,e),m=ss(c,n);Fi(s,a,i,t,r,y[0],m[0]),Fi(s,a,i,t,r,y[0],m[1]),Fi(s,a,i,t,r,y[1],m[0]),Fi(s,a,i,t,r,y[1],m[1])}}return a}function Lh(t,e){let r=t.geometry(),n=r.flat().map(a=>ys([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new on(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,ji(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,ji(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,qi(n,!1,a.coordinates,i,o));break}if(o===0)return o}return o}function Dh(t,e){let r=t.geometry(),n=r.flat().map(a=>ys([a.x,a.y],t.canonical));if(r.length===0)return NaN;let i=new on(n[0][1]),o=1/0;for(let a of e){switch(a.type){case"Point":o=Math.min(o,ji(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,ji(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,qi(n,!0,a.coordinates,i,o));break}if(o===0)return o}return o}function Vh(t,e){let r=t.geometry();if(r.length===0||r[0].length===0)return NaN;let n=Ah(r,0).map(a=>a.map(s=>s.map(l=>ys([l.x,l.y],t.canonical)))),i=new on(n[0][0][0][1]),o=1/0;for(let a of e)for(let s of n){switch(a.type){case"Point":o=Math.min(o,qi([a.coordinates],!1,s,i,o));break;case"LineString":o=Math.min(o,qi(a.coordinates,!0,s,i,o));break;case"Polygon":o=Math.min(o,Fh(s,a.coordinates,i,o));break}if(o===0)return o}return o}function Ja(t){return t.type==="MultiPolygon"?t.coordinates.map(e=>({type:"Polygon",coordinates:e})):t.type==="MultiLineString"?t.coordinates.map(e=>({type:"LineString",coordinates:e})):t.type==="MultiPoint"?t.coordinates.map(e=>({type:"Point",coordinates:e})):[t]}var an=class t{constructor(e,r){this.type=L,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(en(e[1])){let n=e[1];if(n.type==="FeatureCollection")return new t(n,n.features.map(i=>Ja(i.geometry)).flat());if(n.type==="Feature")return new t(n,Ja(n.geometry));if("type"in n&&"coordinates"in n)return new t(n,Ja(n))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return Lh(e,this.geometries);if(e.geometryType()==="LineString")return Dh(e,this.geometries);if(e.geometryType()==="Polygon")return Vh(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},Gt={"==":rh,"!=":nh,">":oh,"<":ih,">=":sh,"<=":ah,array:je,at:Xa,boolean:je,case:es,coalesce:Ni,collator:Ui,format:tn,image:ns,in:Ka,"index-of":Ya,interpolate:Je,"interpolate-hcl":Je,"interpolate-lab":Je,length:is,let:zi,literal:mt,match:Qa,number:je,"number-format":rs,object:je,slice:ts,step:yr,string:je,"to-boolean":yt,"to-color":yt,"to-number":yt,"to-string":yt,var:Ri,within:nn,distance:an},Ke=class t{constructor(e,r,n,i){this.name=e,this.type=r,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){let n=e[0],i=t.definitions[n];if(!i)return r.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);let o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new Bi(r.registry,Ji,r.path,null,r.scope);let p=[],f=!1;for(let y=1;y<e.length;y++){let m=e[y],h=Array.isArray(u)?u[y-1]:u.type,d=l.parse(m,1+p.length,h);if(!d){f=!0;break}p.push(d)}if(!f){if(Array.isArray(u)&&u.length!==p.length){l.error("Expected ".concat(u.length," arguments, but found ").concat(p.length," instead."));continue}for(let y=0;y<p.length;y++){let m=Array.isArray(u)?u[y]:u.type,h=p[y];l.concat(y+1).checkSubtype(m,h.type)}if(l.errors.length===0)return new t(n,o,c,p)}}if(s.length===1)r.errors.push(...l.errors);else{let c=(s.length?s:a).map(([f])=>zh(f)).join(" | "),p=[];for(let f=1;f<e.length;f++){let y=r.parse(e[f],1+p.length);if(!y)return null;p.push(te(y.type))}r.error("Expected arguments of type ".concat(c,", but found (").concat(p.join(", "),") instead."))}return null}static register(e,r){t.definitions=r;for(let n in r)e[n]=t}};function du(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);let o=i?i.evaluate(t):1,a=Eu(e,r,n,o);if(a)throw new ie(a);return new W(e/255,r/255,n/255,o,!1)}function gu(t,e){return t in e}function Za(t,e){let r=e[t];return typeof r>"u"?null:r}function Bh(t,e,r,n){for(;r<=n;){let i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}function Bt(t){return{type:t}}Ke.register(Gt,{error:[_m,[G],(t,[e])=>{throw new ie(e.evaluate(t))}],typeof:[G,[$],(t,[e])=>te(ue(e.evaluate(t)))],"to-rgba":[Ee(L,4),[Re],(t,[e])=>{let[r,n,i,o]=e.evaluate(t).rgb;return[r*255,n*255,i*255,o]}],rgb:[Re,[L,L,L],du],rgba:[Re,[L,L,L,L],du],has:{type:U,overloads:[[[G],(t,[e])=>gu(e.evaluate(t),t.properties())],[[G,cr],(t,[e,r])=>gu(e.evaluate(t),r.evaluate(t))]]},get:{type:$,overloads:[[[G],(t,[e])=>Za(e.evaluate(t),t.properties())],[[G,cr],(t,[e,r])=>Za(e.evaluate(t),r.evaluate(t))]]},"feature-state":[$,[G],(t,[e])=>Za(e.evaluate(t),t.featureState||{})],properties:[cr,[],t=>t.properties()],"geometry-type":[G,[],t=>t.geometryType()],id:[$,[],t=>t.id()],zoom:[L,[],t=>t.globals.zoom],"heatmap-density":[L,[],t=>t.globals.heatmapDensity||0],"line-progress":[L,[],t=>t.globals.lineProgress||0],accumulated:[$,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[L,Bt(L),(t,e)=>{let r=0;for(let n of e)r+=n.evaluate(t);return r}],"*":[L,Bt(L),(t,e)=>{let r=1;for(let n of e)r*=n.evaluate(t);return r}],"-":{type:L,overloads:[[[L,L],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[L],(t,[e])=>-e.evaluate(t)]]},"/":[L,[L,L],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[L,[L,L],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[L,[],()=>Math.LN2],pi:[L,[],()=>Math.PI],e:[L,[],()=>Math.E],"^":[L,[L,L],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[L,[L],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[L,[L],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[L,[L],(t,[e])=>Math.log(e.evaluate(t))],log2:[L,[L],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[L,[L],(t,[e])=>Math.sin(e.evaluate(t))],cos:[L,[L],(t,[e])=>Math.cos(e.evaluate(t))],tan:[L,[L],(t,[e])=>Math.tan(e.evaluate(t))],asin:[L,[L],(t,[e])=>Math.asin(e.evaluate(t))],acos:[L,[L],(t,[e])=>Math.acos(e.evaluate(t))],atan:[L,[L],(t,[e])=>Math.atan(e.evaluate(t))],min:[L,Bt(L),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[L,Bt(L),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[L,[L],(t,[e])=>Math.abs(e.evaluate(t))],round:[L,[L],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[L,[L],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[L,[L],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[U,[G,$],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[U,[$],(t,[e])=>t.id()===e.value],"filter-type-==":[U,[G],(t,[e])=>t.geometryType()===e.value],"filter-<":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[U,[G,$],(t,[e,r])=>{let n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[U,[$],(t,[e])=>{let r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[U,[$],(t,[e])=>e.value in t.properties()],"filter-has-id":[U,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[U,[Ee(G)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[U,[Ee($)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[U,[G,Ee($)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[U,[G,Ee($)],(t,[e,r])=>Bh(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Bt(U),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:U,overloads:[[[U,U],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Bt(U),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[U,[U],(t,[e])=>!e.evaluate(t)],"is-supported-script":[U,[G],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return r?r(e.evaluate(t)):!0}],upcase:[G,[G],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[G,[G],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[G,Bt($),(t,e)=>e.map(r=>Hr(r.evaluate(t))).join("")],"resolved-locale":[G,[Wi],(t,[e])=>e.evaluate(t).resolvedLocale()]});function zh(t){return Array.isArray(t)?"(".concat(t.map(te).join(", "),")"):"(".concat(te(t.type),"...)")}function Ji(t){if(t instanceof Ri)return Ji(t.boundExpression);if(t instanceof Ke&&t.name==="error")return!1;if(t instanceof Ui)return!1;if(t instanceof nn)return!1;if(t instanceof an)return!1;let e=t instanceof yt||t instanceof je,r=!0;return t.eachChild(n=>{e?r=r&&Ji(n):r=r&&n instanceof mt}),r?Qi(t)&&eo(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Qi(t){if(t instanceof Ke){if(t.name==="get"&&t.args.length===1)return!1;if(t.name==="feature-state")return!1;if(t.name==="has"&&t.args.length===1)return!1;if(t.name==="properties"||t.name==="geometry-type"||t.name==="id")return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof nn||t instanceof an)return!1;let e=!0;return t.eachChild(r=>{e&&!Qi(r)&&(e=!1)}),e}function sn(t){if(t instanceof Ke&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!sn(r)&&(e=!1)}),e}function eo(t,e){if(t instanceof Ke&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(n=>{r&&!eo(n,e)&&(r=!1)}),r}function cs(t){return{result:"success",value:t}}function ur(t){return{result:"error",value:t}}function ht(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function Ou(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function gs(t){return!!t.expression&&t.expression.interpolated}function j(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function to(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Rh(t){return t}function Nu(t,e){let r=e.type==="color",n=t.stops&&typeof t.stops[0][0]=="object",i=n||t.property!==void 0,o=n||!i,a=t.type||(gs(e)?"exponential":"interval");if(r||e.type==="padding"){let c=r?W.parse:Ze.parse;t=fr({},t),t.stops&&(t.stops=t.stops.map(p=>[p[0],c(p[1])])),t.default?t.default=c(t.default):t.default=c(e.default)}if(t.colorSpace&&!Um(t.colorSpace))throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));let s,l,u;if(a==="exponential")s=xu;else if(a==="interval")s=Nh;else if(a==="categorical"){s=Oh,l=Object.create(null);for(let c of t.stops)l[c[0]]=c[1];u=typeof t.stops[0][0]}else if(a==="identity")s=Uh;else throw new Error('Unknown function type "'.concat(a,'"'));if(n){let c={},p=[];for(let m=0;m<t.stops.length;m++){let h=t.stops[m],d=h[0].zoom;c[d]===void 0&&(c[d]={zoom:d,type:t.type,property:t.property,default:t.default,stops:[]},p.push(d)),c[d].stops.push([h[0].value,h[1]])}let f=[];for(let m of p)f.push([c[m].zoom,Nu(c[m],e)]);let y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:Je.interpolationFactor.bind(void 0,y),zoomStops:f.map(m=>m[0]),evaluate({zoom:m},h){return xu({stops:f,base:t.base},e,m).evaluate(m,h)}}}else if(o){let c=a==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Je.interpolationFactor.bind(void 0,c),zoomStops:t.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(t,e,p,l,u)}}else return{kind:"source",evaluate(c,p){let f=p&&p.properties?p.properties[t.property]:void 0;return f===void 0?fn(t.default,e.default):s(t,e,f,l,u)}}}function fn(t,e,r){if(t!==void 0)return t;if(e!==void 0)return e;if(r!==void 0)return r}function Oh(t,e,r,n,i){let o=typeof r===i?n[r]:void 0;return fn(o,t.default,e.default)}function Nh(t,e,r){if(j(r)!=="number")return fn(t.default,e.default);let n=t.stops.length;if(n===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];let i=Ki(t.stops.map(o=>o[0]),r);return t.stops[i][1]}function xu(t,e,r){let n=t.base!==void 0?t.base:1;if(j(r)!=="number")return fn(t.default,e.default);let i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];let o=Ki(t.stops.map(c=>c[0]),r),a=$h(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Oe[e.type]||Rh;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),f=l.evaluate.apply(void 0,c);if(!(p===void 0||f===void 0))return u(p,f,a,t.colorSpace)}}:u(s,l,a,t.colorSpace)}function Uh(t,e,r){switch(e.type){case"color":r=W.parse(r);break;case"formatted":r=Fe.fromString(r.toString());break;case"resolvedImage":r=Te.fromString(r.toString());break;case"padding":r=Ze.parse(r);break;default:j(r)!==e.type&&(e.type!=="enum"||!e.values[r])&&(r=void 0)}return fn(r,t.default,e.default)}function $h(t,e,r,n){let i=n-r,o=t-r;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Nt=class{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new Vi,this._defaultValue=r?qh(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,i,o,a){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new ie("Expected value to be one of ".concat(Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", "),", but found ").concat(JSON.stringify(s)," instead."));return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function qt(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Gt}function jt(t,e){let r=new Bi(Gt,Ji,[],e?Gh(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?cs(new Nt(n,e)):ur(r.errors)}var dt=class{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!sn(r.expression)}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}},gt=class{constructor(e,r,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!sn(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,i,o,a)}evaluate(e,r,n,i,o,a){return this._styleExpression.evaluate(e,r,n,i,o,a)}interpolationFactor(e,r,n){return this.interpolationType?Je.interpolationFactor(this.interpolationType,e,r,n):0}};function Uu(t,e){let r=jt(t,e);if(r.result==="error")return r;let n=r.value.expression,i=Qi(n);if(!i&&!ht(e))return ur([new Be("","data expressions not supported")]);let o=eo(n,["zoom"]);if(!o&&!Ou(e))return ur([new Be("","zoom expressions not supported")]);let a=Di(n);if(!a&&!o)return ur([new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof Be)return ur([a]);if(a instanceof Je&&!gs(e))return ur([new Be("",'"interpolate" expressions cannot be used with this property')]);if(!a)return cs(i?new dt("constant",r.value):new dt("source",r.value));let s=a instanceof Je?a.interpolation:void 0;return cs(i?new gt("camera",r.value,a.labels,s):new gt("composite",r.value,a.labels,s))}var ln=class t{constructor(e,r){this._parameters=e,this._specification=r,fr(this,Nu(this._parameters,this._specification))}static deserialize(e){return new t(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};function $u(t,e){if(to(t))return new ln(t,e);if(qt(t)){let r=Uu(t,e);if(r.result==="error")throw new Error(r.value.map(n=>"".concat(n.key,": ").concat(n.message)).join(", "));return r.value}else{let r=t;return e.type==="color"&&typeof t=="string"?r=W.parse(t):e.type==="padding"&&(typeof t=="number"||Array.isArray(t))?r=Ze.parse(t):e.type==="variableAnchorOffsetCollection"&&Array.isArray(t)&&(r=Ne.parse(t)),{kind:"constant",evaluate:()=>r}}}function Di(t){let e=null;if(t instanceof zi)e=Di(t.result);else if(t instanceof Ni){for(let r of t.args)if(e=Di(r),e)break}else(t instanceof yr||t instanceof Je)&&t.input instanceof Ke&&t.input.name==="zoom"&&(e=t);return e instanceof Be||t.eachChild(r=>{let n=Di(r);n instanceof Be?e=n:!e&&n?e=new Be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Be("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Gh(t){let e={color:Re,string:G,number:L,enum:G,boolean:U,formatted:dr,padding:Hi,resolvedImage:cn,variableAnchorOffsetCollection:Xi};return t.type==="array"?Ee(e[t.value]||$,t.length):e[t.type]}function qh(t){return t.type==="color"&&to(t.default)?new W(0,0,0,0):t.type==="color"?W.parse(t.default)||null:t.type==="padding"?Ze.parse(t.default)||null:t.type==="variableAnchorOffsetCollection"?Ne.parse(t.default)||null:t.default===void 0?null:t.default}function xs(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!xs(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}var jh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yn(t){if(t==null)return{filter:()=>!0,needGeometry:!1};xs(t)||(t=Zi(t));let e=jt(t,jh);if(e.result==="error")throw new Error(e.value.map(r=>"".concat(r.key,": ").concat(r.message)).join(", "));{let r=Gu(t);return{filter:(n,i,o)=>e.value.evaluate(n,i,{},o),needGeometry:r}}}function Jh(t,e){return t<e?-1:t>e?1:0}function Gu(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Gu(t[e]))return!0;return!1}function Zi(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?Wa(t[1],t[2],"=="):e==="!="?Li(Wa(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Wa(t[1],t[2],e):e==="any"?Zh(t.slice(1)):e==="all"?["all"].concat(t.slice(1).map(Zi)):e==="none"?["all"].concat(t.slice(1).map(Zi).map(Li)):e==="in"?bu(t[1],t.slice(2)):e==="!in"?Li(bu(t[1],t.slice(2))):e==="has"?vu(t[1]):e==="!has"?Li(vu(t[1])):!0}function Wa(t,e,r){switch(t){case"$type":return["filter-type-".concat(r),e];case"$id":return["filter-id-".concat(r),e];default:return["filter-".concat(r),t,e]}}function Zh(t){return["any"].concat(t.map(Zi))}function bu(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Jh)]]:["filter-in-small",t,["literal",e]]}}function vu(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Li(t){return["!",t]}function ps(t){let e=typeof t;if(e==="number"||e==="boolean"||e==="string"||t===void 0||t===null)return JSON.stringify(t);if(Array.isArray(t)){let i="[";for(let o of t)i+="".concat(ps(o),",");return"".concat(i,"]")}let r=Object.keys(t).sort(),n="{";for(let i=0;i<r.length;i++)n+="".concat(JSON.stringify(r[i]),":").concat(ps(t[r[i]]),",");return"".concat(n,"}")}function Wh(t){let e="";for(let r of Am)e+="/".concat(ps(t[r]));return e}function qu(t,e){let r={};for(let i=0;i<t.length;i++){let o=e&&e[t[i].id]||Wh(t[i]);e&&(e[t[i].id]=o);let a=r[o];a||(a=r[o]=[]),a.push(t[i])}let n=[];for(let i in r)n.push(r[i]);return n}function ju(t){let e=t.key,r=t.value;return r?[new M(e,r,"constants have been deprecated as of v8")]:[]}function ae(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ut(t){if(Array.isArray(t))return t.map(Ut);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Ut(t[r]);return e}return ae(t)}function ze(t){let e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=t.validateSpec,l=[],u=j(r);if(u!=="object")return[new M(e,r,"object expected, ".concat(u," found"))];for(let c in r){let p=c.split(".")[0],f=n[p]||n["*"],y;if(i[p])y=i[p];else if(n[p])y=s;else if(i["*"])y=i["*"];else if(n["*"])y=s;else{l.push(new M(e,r[c],'unknown property "'.concat(c,'"')));continue}l=l.concat(y({key:(e&&"".concat(e,"."))+c,value:r[c],valueSpec:f,style:o,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new M(e,r,'missing required property "'.concat(c,'"')));return l}function bs(t){let e=t.value,r=t.valueSpec,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.key,s=t.arrayElementValidator||n;if(j(e)!=="array")return[new M(a,e,"array expected, ".concat(j(e)," found"))];if(r.length&&e.length!==r.length)return[new M(a,e,"array length ".concat(r.length," expected, length ").concat(e.length," found"))];if(r["min-length"]&&e.length<r["min-length"])return[new M(a,e,"array length at least ".concat(r["min-length"]," expected, length ").concat(e.length," found"))];let l={type:r.value,values:r.values};o.$version<7&&(l.function=r.function),j(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:t.validateSpec,style:i,styleSpec:o,key:"".concat(a,"[").concat(c,"]")}));return u}function vs(t){let e=t.key,r=t.value,n=t.valueSpec,i=j(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new M(e,r,"number expected, ".concat(i," found"))]:"minimum"in n&&r<n.minimum?[new M(e,r,"".concat(r," is less than the minimum value ").concat(n.minimum))]:"maximum"in n&&r>n.maximum?[new M(e,r,"".concat(r," is greater than the maximum value ").concat(n.maximum))]:[]}function Ju(t){let e=t.valueSpec,r=ae(t.value.type),n,i={},o,a,s=r!=="categorical"&&t.value.property===void 0,l=!s,u=j(t.value.stops)==="array"&&j(t.value.stops[0])==="array"&&j(t.value.stops[0][0])==="object",c=ze({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:p,default:m}});return r==="identity"&&s&&c.push(new M(t.key,t.value,'missing required property "property"')),r!=="identity"&&!t.value.stops&&c.push(new M(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!gs(t.valueSpec)&&c.push(new M(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!ht(t.valueSpec)?c.push(new M(t.key,t.value,"property functions not supported")):s&&!Ou(t.valueSpec)&&c.push(new M(t.key,t.value,"zoom functions not supported"))),(r==="categorical"||u)&&t.value.property===void 0&&c.push(new M(t.key,t.value,'"property" property is required')),c;function p(h){if(r==="identity")return[new M(h.key,h.value,'identity function may not have a "stops" property')];let d=[],g=h.value;return d=d.concat(bs({key:h.key,value:g,valueSpec:h.valueSpec,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,arrayElementValidator:f})),j(g)==="array"&&g.length===0&&d.push(new M(h.key,g,"array must have at least one stop")),d}function f(h){let d=[],g=h.value,b=h.key;if(j(g)!=="array")return[new M(b,g,"array expected, ".concat(j(g)," found"))];if(g.length!==2)return[new M(b,g,"array length 2 expected, length ".concat(g.length," found"))];if(u){if(j(g[0])!=="object")return[new M(b,g,"object expected, ".concat(j(g[0])," found"))];if(g[0].zoom===void 0)return[new M(b,g,"object stop key must have zoom")];if(g[0].value===void 0)return[new M(b,g,"object stop key must have value")];if(a&&a>ae(g[0].zoom))return[new M(b,g[0].zoom,"stop zoom values must appear in ascending order")];ae(g[0].zoom)!==a&&(a=ae(g[0].zoom),o=void 0,i={}),d=d.concat(ze({key:"".concat(b,"[0]"),value:g[0],valueSpec:{zoom:{}},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{zoom:vs,value:y}}))}else d=d.concat(y({key:"".concat(b,"[0]"),value:g[0],valueSpec:{},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec},g));return qt(Ut(g[1]))?d.concat([new M("".concat(b,"[1]"),g[1],"expressions are not allowed in function stops.")]):d.concat(h.validateSpec({key:"".concat(b,"[1]"),value:g[1],valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec}))}function y(h,d){let g=j(h.value),b=ae(h.value),x=h.value!==null?h.value:d;if(!n)n=g;else if(g!==n)return[new M(h.key,x,"".concat(g," stop domain type must match previous stop domain type ").concat(n))];if(g!=="number"&&g!=="string"&&g!=="boolean")return[new M(h.key,x,"stop domain value must be a number, string, or boolean")];if(g!=="number"&&r!=="categorical"){let v="number expected, ".concat(g," found");return ht(e)&&r===void 0&&(v+='\\nIf you intended to use a categorical function, specify \`"type": "categorical"\`.'),[new M(h.key,x,v)]}return r==="categorical"&&g==="number"&&(!isFinite(b)||Math.floor(b)!==b)?[new M(h.key,x,"integer expected, found ".concat(b))]:r!=="categorical"&&g==="number"&&o!==void 0&&b<o?[new M(h.key,x,"stop domain values must appear in ascending order")]:(o=b,r==="categorical"&&b in i?[new M(h.key,x,"stop domain values must be unique")]:(i[b]=!0,[]))}function m(h){return h.validateSpec({key:h.key,value:h.value,valueSpec:e,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec})}}function mr(t){let e=(t.expressionContext==="property"?Uu:jt)(Ut(t.value),t.valueSpec);if(e.result==="error")return e.value.map(n=>new M("".concat(t.key).concat(n.key),t.value,n.message));let r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new M(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!sn(r))return[new M(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!sn(r))return[new M(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!eo(r,["zoom","feature-state"]))return[new M(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Qi(r))return[new M(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hh(t){let e=t.value,r=t.key,n=j(e);return n!=="boolean"?[new M(r,e,"boolean expected, ".concat(n," found"))]:[]}function Xh(t){let e=t.key,r=t.value,n=j(r);return n!=="string"?[new M(e,r,"color expected, ".concat(n," found"))]:W.parse(String(r))?[]:[new M(e,r,'color expected, "'.concat(r,'" found'))]}function un(t){let e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(ae(r))===-1&&i.push(new M(e,r,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):Object.keys(n.values).indexOf(ae(r))===-1&&i.push(new M(e,r,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),i}function Ps(t){return xs(Ut(t.value))?mr(fr({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Zu(t)}function Zu(t){let e=t.value,r=t.key;if(j(e)!=="array")return[new M(r,e,"array expected, ".concat(j(e)," found"))];let n=t.styleSpec,i,o=[];if(e.length<1)return[new M(r,e,"filter array must have at least 1 element")];switch(o=o.concat(un({key:"".concat(r,"[0]"),value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),ae(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ae(e[1])==="$type"&&o.push(new M(r,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":e.length!==3&&o.push(new M(r,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(i=j(e[1]),i!=="string"&&o.push(new M("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found"))));for(let a=2;a<e.length;a++)i=j(e[a]),ae(e[1])==="$type"?o=o.concat(un({key:"".concat(r,"[").concat(a,"]"),value:e[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new M("".concat(r,"[").concat(a,"]"),e[a],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let a=1;a<e.length;a++)o=o.concat(Zu({key:"".concat(r,"[").concat(a,"]"),value:e[a],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=j(e[1]),e.length!==2?o.push(new M(r,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):i!=="string"&&o.push(new M("".concat(r,"[1]"),e[1],"string expected, ".concat(i," found")));break}return o}function Wu(t,e){let r=t.key,n=t.validateSpec,i=t.style,o=t.styleSpec,a=t.value,s=t.objectKey,l=o["".concat(e,"_").concat(t.layerType)];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});let c=t.valueSpec||l[s];if(!c)return[new M(r,a,'unknown property "'.concat(s,'"'))];let p;if(j(a)==="string"&&ht(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new M(r,a,'"'.concat(s,'" does not support interpolation syntax\\n')+'Use an identity property function instead: \`{ "type": "identity", "property": '.concat(JSON.stringify(p[1])," }\`."))];let f=[];return t.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&f.push(new M(r,a,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&to(Ut(a))&&ae(a.type)==="identity"&&f.push(new M(r,a,'"text-font" does not support identity functions'))),f.concat(n({key:t.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:e,propertyKey:s}))}function Hu(t){return Wu(t,"paint")}function Xu(t){return Wu(t,"layout")}function Ku(t){let e=[],r=t.value,n=t.key,i=t.style,o=t.styleSpec;!r.type&&!r.ref&&e.push(new M(n,r,'either "type" or "ref" is required'));let a=ae(r.type),s=ae(r.ref);if(r.id){let l=ae(r.id);for(let u=0;u<t.arrayIndex;u++){let c=i.layers[u];ae(c.id)===l&&e.push(new M(n,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(c.id.__line__)))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&e.push(new M(n,r[u],'"'.concat(u,'" is prohibited for ref layers')))});let l;i.layers.forEach(u=>{ae(u.id)===s&&(l=u)}),l?l.ref?e.push(new M(n,r.ref,"ref cannot reference another ref layer")):a=ae(l.type):e.push(new M(n,r.ref,'ref layer "'.concat(s,'" not found')))}else if(a!=="background")if(!r.source)e.push(new M(n,r,'missing required property "source"'));else{let l=i.sources&&i.sources[r.source],u=l&&ae(l.type);l?u==="vector"&&a==="raster"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a raster source'))):u!=="raster-dem"&&a==="hillshade"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a raster-dem source'))):u==="raster"&&a!=="raster"?e.push(new M(n,r.source,'layer "'.concat(r.id,'" requires a vector source'))):u==="vector"&&!r["source-layer"]?e.push(new M(n,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):u==="raster-dem"&&a!=="hillshade"?e.push(new M(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):a==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new M(n,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.'))):e.push(new M(n,r.source,'source "'.concat(r.source,'" not found')))}return e=e.concat(ze({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*"(){return[]},type(){return t.validateSpec({key:"".concat(n,".type"),value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:r,objectKey:"type"})},filter:Ps,layout(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Xu(fr({layerType:a},u))}}})},paint(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Hu(fr({layerType:a},u))}}})}}})),e}function $t(t){let e=t.value,r=t.key,n=j(e);return n!=="string"?[new M(r,e,"string expected, ".concat(n," found"))]:[]}function Kh(t){var e;let r=(e=t.sourceName)!==null&&e!==void 0?e:"",n=t.value,i=t.styleSpec,o=i.source_raster_dem,a=t.style,s=[],l=j(n);if(n===void 0)return s;if(l!=="object")return s.push(new M("source_raster_dem",n,"object expected, ".concat(l," found"))),s;let c=ae(n.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],f=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(let y in n)!c&&p.includes(y)?s.push(new M(y,n[y],'In "'.concat(r,'": "').concat(y,'" is only valid when "encoding" is set to "custom". ').concat(f," encoding found"))):o[y]?s=s.concat(t.validateSpec({key:y,value:n[y],valueSpec:o[y],validateSpec:t.validateSpec,style:a,styleSpec:i})):s.push(new M(y,n[y],'unknown property "'.concat(y,'"')));return s}var Pu={promoteId:Yh};function Yu(t){let e=t.value,r=t.key,n=t.styleSpec,i=t.style,o=t.validateSpec;if(!e.type)return[new M(r,e,'"type" is required')];let a=ae(e.type),s;switch(a){case"vector":case"raster":return s=ze({key:r,value:e,valueSpec:n["source_".concat(a.replace("-","_"))],style:t.style,styleSpec:n,objectElementValidators:Pu,validateSpec:o}),s;case"raster-dem":return s=Kh({sourceName:r,value:e,style:t.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=ze({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:Pu}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...mr({key:"".concat(r,".").concat(l,".map"),value:c,validateSpec:o,expressionContext:"cluster-map"})),s.push(...mr({key:"".concat(r,".").concat(l,".reduce"),value:p,validateSpec:o,expressionContext:"cluster-reduce"}))}return s;case"video":return ze({key:r,value:e,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return ze({key:r,value:e,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new M(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return un({key:"".concat(r,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:o,styleSpec:n})}}function Yh({key:t,value:e}){if(j(e)==="string")return $t({key:t,value:e});{let r=[];for(let n in e)r.push(...$t({key:"".concat(t,".").concat(n),value:e[n]}));return r}}function Qu(t){let e=t.value,r=t.styleSpec,n=r.light,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new M("light",e,"object expected, ".concat(a," found"))]),o;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:r.transition,validateSpec:t.validateSpec,style:i,styleSpec:r})):n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))])}return o}function ec(t){let e=t.value,r=t.styleSpec,n=r.sky,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new M("sky",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return a}function tc(t){let e=t.value,r=t.styleSpec,n=r.terrain,i=t.style,o=[],a=j(e);if(e===void 0)return o;if(a!=="object")return o=o.concat([new M("terrain",e,"object expected, ".concat(a," found"))]),o;for(let s in e)n[s]?o=o.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],validateSpec:t.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return o}function Qh(t){return $t(t).length===0?[]:mr(t)}function ed(t){return $t(t).length===0?[]:mr(t)}function td(t){let e=t.key,r=t.value;if(j(r)==="array"){if(r.length<1||r.length>4)return[new M(e,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},o=[];for(let a=0;a<r.length;a++)o=o.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:r[a],validateSpec:t.validateSpec,valueSpec:i}));return o}else return vs({key:e,value:r,valueSpec:{}})}function rd(t){let e=t.key,r=t.value,n=j(r),i=t.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new M(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(un({key:"".concat(e,"[").concat(a,"]"),value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(bs({key:"".concat(e,"[").concat(a+1,"]"),value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:i}));return o}function rc(t){let e=[],r=t.value,n=t.key;if(Array.isArray(r)){let i=[],o=[];for(let a in r){r[a].id&&i.includes(r[a].id)&&e.push(new M(n,r,"all the sprites' ids must be unique, but ".concat(r[a].id," is duplicated"))),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&e.push(new M(n,r,"all the sprites' URLs must be unique, but ".concat(r[a].url," is duplicated"))),o.push(r[a].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(ze({key:"".concat(n,"[").concat(a,"]"),value:r[a],valueSpec:s,validateSpec:t.validateSpec}))}return e}else return $t({key:n,value:r})}function nd(t){let e=t.value,r=t.styleSpec,n=r.projection,i=t.style,o=j(e);if(e===void 0)return[];if(o!=="object")return[new M("projection",e,"object expected, ".concat(o," found"))];let a=[];for(let s in e)n[s]?a=a.concat(t.validateSpec({key:s,value:e[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,e[s],'unknown property "'.concat(s,'"'))]);return a}var Su={"*"(){return[]},array:bs,boolean:Hh,number:vs,color:Xh,constants:ju,enum:un,filter:Ps,function:Ju,layer:Ku,object:ze,source:Yu,light:Qu,sky:ec,terrain:tc,projection:nd,string:$t,formatted:Qh,resolvedImage:ed,padding:td,variableAnchorOffsetCollection:rd,sprite:rc};function Xr(t){let e=t.value,r=t.valueSpec,n=t.styleSpec;return t.validateSpec=Xr,r.expression&&to(ae(e))?Ju(t):r.expression&&qt(Ut(e))?mr(t):r.type&&Su[r.type]?Su[r.type](t):ze(fr({},t,{valueSpec:r.type?n[r.type]:r}))}function nc(t){let e=t.value,r=t.key,n=$t(t);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new M(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new M(r,e,'"glyphs" url must include a "{range}" token'))),n}function Ue(t,e=S){let r=[];return r=r.concat(Xr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Xr,objectElementValidators:{glyphs:nc,"*"(){return[]}}})),t.constants&&(r=r.concat(ju({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:Xr}))),ic(r)}Ue.source=Qe(Ye(Yu));Ue.sprite=Qe(Ye(rc));Ue.glyphs=Qe(Ye(nc));Ue.light=Qe(Ye(Qu));Ue.sky=Qe(Ye(ec));Ue.terrain=Qe(Ye(tc));Ue.layer=Qe(Ye(Ku));Ue.filter=Qe(Ye(Ps));Ue.paintProperty=Qe(Ye(Hu));Ue.layoutProperty=Qe(Ye(Xu));function Ye(t){return function(e){return t(Ci(Dt({},e),{validateSpec:Xr}))}}function ic(t){return[].concat(t).sort((e,r)=>e.line-r.line)}function Qe(t){return function(...e){return ic(t.apply(this,e))}}var oc="AbortError";function ac(t){return t.message===oc}function Ss(){return new Error(oc)}var ro={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function sc(t){return ro.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}function lc(t,e){ro.REGISTERED_PROTOCOLS[t]=e}function uc(t){delete ro.REGISTERED_PROTOCOLS[t]}var cc="global-dispatcher",br=class extends Error{constructor(e,r,n,i){super("AJAXError: ".concat(r," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=r,this.url=n,this.body=i}},fc=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,id=t=>/^file:/.test(t)||/^file:/.test(fc())&&!/^\\w+:/.test(t);async function od(t,e){let r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:fc(),signal:e.signal});t.type==="json"&&r.headers.set("Accept","application/json");let n=await fetch(r);if(!n.ok){let a=await n.blob();throw new br(n.status,n.statusText,t.url,a)}let i;t.type==="arrayBuffer"||t.type==="image"?i=n.arrayBuffer():t.type==="json"?i=n.json():i=n.text();let o=await i;if(e.signal.aborted)throw Ss();return{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function ad(t,e){return new Promise((r,n)=>{let i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),(t.type==="arrayBuffer"||t.type==="image")&&(i.responseType="arraybuffer");for(let o in t.headers)i.setRequestHeader(o,t.headers[o]);t.type==="json"&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials=t.credentials==="include",i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if(!e.signal.aborted)if((i.status>=200&&i.status<300||i.status===0)&&i.response!==null){let o=i.response;if(t.type==="json")try{o=JSON.parse(i.response)}catch(a){n(a);return}r({data:o,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")})}else{let o=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});n(new br(i.status,i.statusText,t.url,o))}},e.signal.addEventListener("abort",()=>{i.abort(),n(Ss())}),i.send(t.body)})}var yc=function(t,e){if(/:\\/\\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){let r=sc(t.url);if(r)return r(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:cc},e)}if(!id(t.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return od(t,e);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:cc},e)}return ad(t,e)},mc=(t,e)=>yc(Pe(t,{type:"json"}),e),hc=(t,e)=>yc(Pe(t,{type:"arrayBuffer"}),e);var xt={};function C(t,e,r={}){if(xt[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),xt[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}C("Object",Object);C("TransferableGridIndex",Vt);C("Color",W);C("Error",Error);C("AJAXError",br);C("ResolvedImage",Te);C("StylePropertyFunction",ln);C("StyleExpression",Nt,{omit:["_evaluator"]});C("ZoomDependentExpression",gt);C("ZoomConstantExpression",dt);C("CompoundExpression",Ke,{omit:["_evaluate"]});for(let t in Gt)Gt[t]._classRegistryKey||C("Expression_".concat(t),Gt[t]);function dc(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function vr(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(dc(t)||Jr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){let r=t;return e&&e.push(r.buffer),r}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){let r=[];for(let n of t)r.push(vr(n,e));return r}if(typeof t=="object"){let r=t.constructor,n=r._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class ".concat(r.name));if(!xt[n])throw new Error("".concat(n," is not registered."));let i=r.serialize?r.serialize(t,e):{};if(r.serialize){if(e&&i===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let o in t){if(!t.hasOwnProperty(o)||xt[n].omit.indexOf(o)>=0)continue;let a=t[o];i[o]=xt[n].shallow.indexOf(o)>=0?a:vr(a,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(i.$name=n),i}throw new Error("can't serialize object of type ".concat(typeof t))}function Pr(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||dc(t)||Jr(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Pr);if(typeof t=="object"){let e=t.$name||"Object";if(!xt[e])throw new Error("can't deserialize unregistered class ".concat(e));let{klass:r}=xt[e];if(!r)throw new Error("can't deserialize unregistered class ".concat(e));if(r.deserialize)return r.deserialize(t);let n=Object.create(r.prototype);for(let i of Object.keys(t)){if(i==="$name")continue;let o=t[i];n[i]=xt[e].shallow.indexOf(i)>=0?o:Pr(o)}return n}throw new Error("can't deserialize object of type ".concat(typeof t))}var no=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};var io=class{constructor(e,r){this.target=e,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new no(()=>this.process()),this.subscription=tu(this.target,"message",n=>this.receive(n),!1),this.globalScope=at(self)?e:window}registerMessageHandler(e,r){this.messageHandlers[e]=r}sendAsync(e,r){return new Promise((n,i)=>{let o=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[o]={resolve:n,reject:i},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[o];let l={id:o,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let a=[],s=Ci(Dt({},e),{id:o,sourceMapId:this.mapId,origin:location.origin,data:vr(e.data,a)});this.target.postMessage(s,{transfer:a})})}receive(e){let r=e.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(at(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(e,r)}async processTask(e,r){if(r.type==="<response>"){let o=this.resolveRejects[e];if(delete this.resolveRejects[e],!o)return;r.error?o.reject(Pr(r.error)):o.resolve(Pr(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(e,new Error("Could not find a registered handler for ".concat(r.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));return}let n=Pr(r.data),i=new AbortController;this.abortControllers[e]=i;try{let o=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(e,null,o)}catch(o){this.completeTask(e,o)}}completeTask(e,r,n){let i=[];delete this.abortControllers[e];let o={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?vr(r):null,data:vr(n,i)};this.target.postMessage(o,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};function gc(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function ws(t,e,r){if(r&&r[t]){let n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}var oo=class{constructor(e,r={}){Pe(this,r),this.type=e}},mn=class extends oo{constructor(e,r={}){super("error",Pe({error:e},r))}},ao=class{on(e,r){return this._listeners=this._listeners||{},gc(e,r,this._listeners),this}off(e,r){return ws(e,r,this._listeners),ws(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},gc(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new oo(e,r||{}));let n=e.type;if(this.listens(n)){e.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,e);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of o)ws(n,s,this._oneTimeListeners),s.call(this,e);let a=this._eventedParent;a&&(Pe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(e))}else e instanceof mn&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}};var bt=Ue,tv=bt.source,rv=bt.light,nv=bt.terrain,iv=bt.filter,xc=bt.paintProperty,bc=bt.layoutProperty;function vc(t,e){let r=!1;if(e&&e.length)for(let n of e)t.fire(new mn(new Error(n.message))),r=!0;return r}var so=class{constructor(){this.first=!0}update(e,r){let n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=n,!0):!1)}};var D={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function hn(t){for(let e of t)if(lo(e.charCodeAt(0)))return!0;return!1}function Pc(t){for(let e of t)if(!sd(e.charCodeAt(0)))return!1;return!0}function sd(t){return!(D.Arabic(t)||D["Arabic Supplement"](t)||D["Arabic Extended-A"](t)||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t))}function Sc(t){return t<11904?!1:!!(D["Bopomofo Extended"](t)||D.Bopomofo(t)||D["CJK Compatibility Forms"](t)||D["CJK Compatibility Ideographs"](t)||D["CJK Compatibility"](t)||D["CJK Radicals Supplement"](t)||D["CJK Strokes"](t)||D["CJK Symbols and Punctuation"](t)||D["CJK Unified Ideographs Extension A"](t)||D["CJK Unified Ideographs"](t)||D["Enclosed CJK Letters and Months"](t)||D["Halfwidth and Fullwidth Forms"](t)||D.Hiragana(t)||D["Ideographic Description Characters"](t)||D["Kangxi Radicals"](t)||D["Katakana Phonetic Extensions"](t)||D.Katakana(t)||D["Vertical Forms"](t)||D["Yi Radicals"](t)||D["Yi Syllables"](t))}function lo(t){return t===746||t===747?!0:t<4352?!1:!!(D["Bopomofo Extended"](t)||D.Bopomofo(t)||D["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||D["CJK Compatibility Ideographs"](t)||D["CJK Compatibility"](t)||D["CJK Radicals Supplement"](t)||D["CJK Strokes"](t)||D["CJK Symbols and Punctuation"](t)&&!(t>=12296&&t<=12305)&&!(t>=12308&&t<=12319)&&t!==12336||D["CJK Unified Ideographs Extension A"](t)||D["CJK Unified Ideographs"](t)||D["Enclosed CJK Letters and Months"](t)||D["Hangul Compatibility Jamo"](t)||D["Hangul Jamo Extended-A"](t)||D["Hangul Jamo Extended-B"](t)||D["Hangul Jamo"](t)||D["Hangul Syllables"](t)||D.Hiragana(t)||D["Ideographic Description Characters"](t)||D.Kanbun(t)||D["Kangxi Radicals"](t)||D["Katakana Phonetic Extensions"](t)||D.Katakana(t)&&t!==12540||D["Halfwidth and Fullwidth Forms"](t)&&t!==65288&&t!==65289&&t!==65293&&!(t>=65306&&t<=65310)&&t!==65339&&t!==65341&&t!==65343&&!(t>=65371&&t<=65503)&&t!==65507&&!(t>=65512&&t<=65519)||D["Small Form Variants"](t)&&!(t>=65112&&t<=65118)&&!(t>=65123&&t<=65126)||D["Unified Canadian Aboriginal Syllabics"](t)||D["Unified Canadian Aboriginal Syllabics Extended"](t)||D["Vertical Forms"](t)||D["Yijing Hexagram Symbols"](t)||D["Yi Syllables"](t)||D["Yi Radicals"](t))}function ld(t){return!!(D["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||D["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||D["Letterlike Symbols"](t)||D["Number Forms"](t)||D["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||D["Control Pictures"](t)&&t!==9251||D["Optical Character Recognition"](t)||D["Enclosed Alphanumerics"](t)||D["Geometric Shapes"](t)||D["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||D["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||D["CJK Symbols and Punctuation"](t)||D.Katakana(t)||D["Private Use Area"](t)||D["CJK Compatibility Forms"](t)||D["Small Form Variants"](t)||D["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}function As(t){return!(lo(t)||ld(t))}function wc(t){return D.Arabic(t)||D["Arabic Supplement"](t)||D["Arabic Extended-A"](t)||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t)}function Ac(t){return t>=1424&&t<=2303||D["Arabic Presentation Forms-A"](t)||D["Arabic Presentation Forms-B"](t)}function ud(t,e){return!(!e&&Ac(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||D.Khmer(t))}function _c(t){for(let e of t)if(Ac(e.charCodeAt(0)))return!0;return!1}function Ic(t,e){for(let r of t)if(!ud(r.charCodeAt(0),e))return!1;return!0}var _s=class{constructor(){this.applyArabicShaping=null;this.processBidirectionalText=null;this.processStyledBidirectionalText=null;this.pluginStatus="unavailable";this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}},ye=new _s;var q=class{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new so,this.transition={})}isSupportedScript(e){return Ic(e,ye.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}};var Sr=class{constructor(e,r){this.property=e,this.value=r,this.expression=$u(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}},dn=class{constructor(e){this.property=e,this.value=new Sr(e,void 0)}transitioned(e,r){return new co(this.property,this.value,r,Pe({},e.transition,this.transition),e.now)}untransitioned(){return new co(this.property,this.value,null,{},0)}},uo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return nt(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].value=new Sr(this._values[e].property,r===null?void 0:nt(r))}getTransition(e){return nt(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].transition=nt(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n);let i=this.getTransition(r);i!==void 0&&(e["".concat(r,"-transition")]=i)}return e}transitioned(e,r){let n=new po(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,r._values[i]);return n}untransitioned(){let e=new po(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}},co=class{constructor(e,r,n,i,o){this.property=e,this.value=r,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(e,r,n){let i=e.now||0,o=this.value.possiblyEvaluate(e,r,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(e,r,n);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,r,n),o,Wl(s))}}else return o}},po=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}},fo=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return nt(this._values[e].value)}setValue(e,r){this._values[e]=new Sr(this._values[e].property,r===null?void 0:nt(r))}serialize(){let e={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(e[r]=n)}return e}possiblyEvaluate(e,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(e,r,n);return i}},Se=class{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,i){return this.property.evaluate(this.value,this.parameters,e,r,n,i)}},vt=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}},B=class{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,n){let i=this.specification.type,o=Oe[i];return o?o(e,r,n):e}},R=class{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,i){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Se(this,{kind:"constant",value:e.expression.evaluate(r,null,{},n,i)},r):new Se(this,e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Se(this,{kind:"constant",value:void 0},e.parameters);let i=this.specification.type,o=Oe[i];if(o){let a=o(e.value.value,r.value.value,n);return new Se(this,{kind:"constant",value:a},e.parameters)}else return e}evaluate(e,r,n,i,o,a){return e.kind==="constant"?e.value:e.evaluate(r,n,i,o,a)}},lt=class extends R{possiblyEvaluate(e,r,n,i){if(e.value===void 0)return new Se(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i),s=e.property.specification.type==="resolvedImage"&&typeof o!="string"?o.name:o,l=this._calculate(s,s,s,r);return new Se(this,{kind:"constant",value:l},r)}else if(e.expression.kind==="camera"){let o=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new Se(this,{kind:"constant",value:o},r)}else return new Se(this,e.expression,r)}evaluate(e,r,n,i,o,a){if(e.kind==="source"){let s=e.evaluate(r,n,i,o,a);return this._calculate(s,s,s,r)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},n,i),e.evaluate({zoom:Math.floor(r.zoom)},n,i),e.evaluate({zoom:Math.floor(r.zoom)+1},n,i),r):e.value}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},Jt=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){if(e.value!==void 0)if(e.expression.kind==="constant"){let o=e.expression.evaluate(r,null,{},n,i);return this._calculate(o,o,o,r)}else return this._calculate(e.expression.evaluate(new q(Math.floor(r.zoom-1),r)),e.expression.evaluate(new q(Math.floor(r.zoom),r)),e.expression.evaluate(new q(Math.floor(r.zoom+1),r)),r)}_calculate(e,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}},Zt=class{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,i){return!!e.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},re=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in e){let n=e[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new Sr(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new dn(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};C("DataDrivenProperty",R);C("DataConstantProperty",B);C("CrossFadedDataDrivenProperty",lt);C("CrossFadedProperty",Jt);C("ColorRampProperty",Zt);var yo="-transition",se=class extends ao{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new fo(r.layout)),r.paint)){this._transitionablePaint=new uo(r.paint);for(let n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(let n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vt(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".layout.").concat(e);if(this._validate(bc,i,e,r,n))return}if(e==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(e,r)}getPaintProperty(e){return e.endsWith(yo)?this._transitionablePaint.getTransition(e.slice(0,-yo.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null){let i="layers.".concat(this.id,".paint.").concat(e);if(this._validate(xc,i,e,r,n))return!1}if(e.endsWith(yo))return this._transitionablePaint.setTransition(e.slice(0,-yo.length),r||void 0),!1;{let i=this._transitionablePaint._values[e],o=i.property.specification["property-type"]==="cross-faded-data-driven",a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Kl(e,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,i,o={}){return o&&o.validate===!1?!1:vc(this,e.call(bt,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:S,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(!(!(r instanceof Se)||!ht(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};var cd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pt=class{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},pd=128,fd=5,ee=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*fd),pd),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Y(t,e=1){let r=0,n=0,i=t.map(a=>{let s=yd(a.type),l=r=Tc(r,Math.max(e,s)),u=a.components||1;return n=Math.max(n,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:l}}),o=Tc(r,Math.max(n,e));return{members:i,size:o,alignment:e}}function yd(t){return cd[t].BYTES_PER_ELEMENT}function Tc(t,e){return Math.ceil(t/e)*e}var Cc=Z(he(),1),Wt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.int16[i+0]=r,this.int16[i+1]=n,e}};Wt.prototype.bytesPerElement=4;C("StructArrayLayout2i4",Wt);var gn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,e}};gn.prototype.bytesPerElement=6;C("StructArrayLayout3i6",gn);var mo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=o,e}};mo.prototype.bytesPerElement=8;C("StructArrayLayout4i8",mo);var xn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};xn.prototype.bytesPerElement=12;C("StructArrayLayout2i4i12",xn);var bn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*4,u=e*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=o,this.uint8[u+6]=a,this.uint8[u+7]=s,e}};bn.prototype.bytesPerElement=8;C("StructArrayLayout2i4ub8",bn);var St=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.float32[i+0]=r,this.float32[i+1]=n,e}};St.prototype.bytesPerElement=8;C("StructArrayLayout2f8",St);var vn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,n,i,o,a,s,l,u,c)}emplace(e,r,n,i,o,a,s,l,u,c,p){let f=e*10;return this.uint16[f+0]=r,this.uint16[f+1]=n,this.uint16[f+2]=i,this.uint16[f+3]=o,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=l,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=p,e}};vn.prototype.bytesPerElement=20;C("StructArrayLayout10ui20",vn);var Pn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f){let y=this.length;return this.resize(y+1),this.emplace(y,e,r,n,i,o,a,s,l,u,c,p,f)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y){let m=e*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=o,this.uint16[m+4]=a,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=p,this.int16[m+10]=f,this.int16[m+11]=y,e}};Pn.prototype.bytesPerElement=24;C("StructArrayLayout4i4ui4i24",Pn);var Sn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}};Sn.prototype.bytesPerElement=12;C("StructArrayLayout3f12",Sn);var wn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint32[n+0]=r,e}};wn.prototype.bytesPerElement=4;C("StructArrayLayout1ul4",wn);var An=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,i,o,a,s,l,u)}emplace(e,r,n,i,o,a,s,l,u,c){let p=e*10,f=e*5;return this.int16[p+0]=r,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=o,this.int16[p+4]=a,this.int16[p+5]=s,this.uint32[f+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,e}};An.prototype.bytesPerElement=20;C("StructArrayLayout6i1ul2ui20",An);var _n=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,r,n,i,o,a)}emplace(e,r,n,i,o,a,s){let l=e*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,e}};_n.prototype.bytesPerElement=12;C("StructArrayLayout2i2i2i12",_n);var ho=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o){let a=this.length;return this.resize(a+1),this.emplace(a,e,r,n,i,o)}emplace(e,r,n,i,o,a){let s=e*4,l=e*8;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[l+6]=o,this.int16[l+7]=a,e}};ho.prototype.bytesPerElement=16;C("StructArrayLayout2f1f2i16",ho);var In=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*12,s=e*3;return this.uint8[a+0]=r,this.uint8[a+1]=n,this.float32[s+1]=i,this.float32[s+2]=o,e}};In.prototype.bytesPerElement=12;C("StructArrayLayout2ub2f12",In);var Tn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*3;return this.uint16[o+0]=r,this.uint16[o+1]=n,this.uint16[o+2]=i,e}};Tn.prototype.bytesPerElement=6;C("StructArrayLayout3ui6",Tn);var Cn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g){let b=this.length;return this.resize(b+1),this.emplace(b,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b){let x=e*24,v=e*12,P=e*48;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=i,this.uint16[x+3]=o,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=l,this.uint16[x+10]=u,this.uint16[x+11]=c,this.uint16[x+12]=p,this.float32[v+7]=f,this.float32[v+8]=y,this.uint8[P+36]=m,this.uint8[P+37]=h,this.uint8[P+38]=d,this.uint32[v+10]=g,this.int16[x+22]=b,e}};Cn.prototype.bytesPerElement=48;C("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Cn);var kn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k){let V=this.length;return this.resize(V+1),this.emplace(V,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k)}emplace(e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V){let A=e*32,z=e*16;return this.int16[A+0]=r,this.int16[A+1]=n,this.int16[A+2]=i,this.int16[A+3]=o,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=l,this.int16[A+7]=u,this.uint16[A+8]=c,this.uint16[A+9]=p,this.uint16[A+10]=f,this.uint16[A+11]=y,this.uint16[A+12]=m,this.uint16[A+13]=h,this.uint16[A+14]=d,this.uint16[A+15]=g,this.uint16[A+16]=b,this.uint16[A+17]=x,this.uint16[A+18]=v,this.uint16[A+19]=P,this.uint16[A+20]=w,this.uint16[A+21]=T,this.uint16[A+22]=F,this.uint32[z+12]=E,this.float32[z+13]=_,this.float32[z+14]=I,this.uint16[A+30]=k,this.uint16[A+31]=V,e}};kn.prototype.bytesPerElement=64;C("StructArrayLayout8i15ui1ul2f2ui64",kn);var Ht=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.float32[n+0]=r,e}};Ht.prototype.bytesPerElement=4;C("StructArrayLayout1f4",Ht);var Mn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*6,a=e*3;return this.uint16[o+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,e}};Mn.prototype.bytesPerElement=12;C("StructArrayLayout1ui2f12",Mn);var En=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,e,r,n)}emplace(e,r,n,i){let o=e*2,a=e*4;return this.uint32[o+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,e}};En.prototype.bytesPerElement=8;C("StructArrayLayout1ul2ui8",En);var Fn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){let i=e*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,e}};Fn.prototype.bytesPerElement=4;C("StructArrayLayout2ui4",Fn);var go=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){let n=e*1;return this.uint16[n+0]=r,e}};go.prototype.bytesPerElement=2;C("StructArrayLayout1ui2",go);var wr=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,e,r,n,i)}emplace(e,r,n,i,o){let a=e*4;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=o,e}};wr.prototype.bytesPerElement=16;C("StructArrayLayout4f16",wr);var xo=class extends Pt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Cc.default(this.anchorPointX,this.anchorPointY)}};xo.prototype.size=20;var Ln=class extends An{get(e){return new xo(this,e)}};C("CollisionBoxArray",Ln);var bo=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};bo.prototype.size=48;var Dn=class extends Cn{get(e){return new bo(this,e)}};C("PlacedSymbolArray",Dn);var vo=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};vo.prototype.size=64;var Vn=class extends kn{get(e){return new vo(this,e)}};C("SymbolInstanceArray",Vn);var Bn=class extends Ht{getoffsetX(e){return this.float32[e*1+0]}};C("GlyphOffsetArray",Bn);var zn=class extends gn{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};C("SymbolLineVertexArray",zn);var Po=class extends Pt{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};Po.prototype.size=12;var Rn=class extends Mn{get(e){return new Po(this,e)}};C("TextAnchorOffsetArray",Rn);var So=class extends Pt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};So.prototype.size=8;var On=class extends En{get(e){return new So(this,e)}};C("FeatureIndexArray",On);var wo=class extends Wt{};var Ao=class extends Wt{},_o=class extends Wt{},Io=class extends xn{};var To=class extends bn{},Co=class extends St{},ut=class extends vn{},ko=class extends Pn{},Mo=class extends Sn{},Eo=class extends wn{},Nn=class extends _n{};var Fo=class extends In{};var Le=class extends Tn{},wt=class extends Fn{};var md=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:kc,size:$v,alignment:Gv}=md;var me=class t{constructor(e=[]){this.segments=e}prepareSegment(e,r,n,i){let o=this.segments[this.segments.length-1];return e>t.MAX_VERTEX_ARRAY_LENGTH&&fe("Max vertices per segment is ".concat(t.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!o||o.vertexLength+e>t.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},i!==void 0&&(o.sortKey=i),this.segments.push(o)),o}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,i){return new t([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};me.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;C("SegmentVector",me);function Is(t,e){return t=it(Math.floor(t),0,255),e=it(Math.floor(e),0,255),256*t+e}var Un=Y([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Dc=Z(ks(),1);var $n=class t{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,i){this.ids.push(Lc(e)),this.positions.push(r,n,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=Lc(e),n=0,i=this.ids.length-1;for(;n<i;){let a=n+i>>1;this.ids[a]>=r?i=a:n=a+1}let o=[];for(;this.ids[n]===r;){let a=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];o.push({index:a,start:s,end:l}),n++}return o}static serialize(e,r){let n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return Ms(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){let r=new t;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}};function Lc(t){let e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,Dc.default)(String(t))}function Ms(t,e,r,n){for(;r<n;){let i=t[r+n>>1],o=r-1,a=n+1;for(;;){do o++;while(t[o]<i);do a--;while(t[a]>i);if(o>=a)break;Do(t,o,a),Do(e,3*o,3*a),Do(e,3*o+1,3*a+1),Do(e,3*o+2,3*a+2)}a-r<n-a?(Ms(t,e,r,a),r=a+1):(Ms(t,e,a+1,n),n=a)}}function Do(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}C("FeaturePositionMap",$n);var Gn=class{constructor(e,r){this.gl=e.gl,this.location=r}};var Ar=class extends Gn{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};var Vo=class extends Gn{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}},Bo=class extends Gn{constructor(e,r){super(e,r),this.current=W.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}},i1=new Float32Array(16);function Es(t){return[Is(255*t.r,255*t.g),Is(255*t.b,255*t.a)]}var Xt=class{constructor(e,r,n){this.value=e,this.uniformNames=r.map(i=>"u_".concat(i)),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new Bo(e,r):new Ar(e,r)}},At=class{constructor(e,r){this.uniformNames=r.map(n=>"u_".concat(n)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,n,i){let o=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;o&&e.set(o)}getBinding(e,r,n){return n.substr(0,9)==="u_pattern"?new Vo(e,r):new Ar(e,r)}},We=class{constructor(e,r,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(o=>({name:"a_".concat(o),type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(e,r,n,i,o){let a=this.paintVertexArray.length,s=this.expression.evaluate(new q(0),r,{},i,[],o);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(e,r,o)}_setPaintValue(e,r,n){if(this.type==="color"){let i=Es(n);for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,i[0],i[1])}else{for(let i=e;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},De=class{constructor(e,r,n,i,o,a){this.expression=e,this.uniformNames=r.map(s=>"u_".concat(s,"_t")),this.type=n,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:"a_".concat(s),type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,r,n,i,o){let a=this.expression.evaluate(new q(this.zoom),r,{},i,[],o),s=this.expression.evaluate(new q(this.zoom+1),r,{},i,[],o),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,a,s)}updatePaintArray(e,r,n,i){let o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(e,r,o,a)}_setPaintValue(e,r,n,i){if(this.type==="color"){let o=Es(n),a=Es(i);for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,o[0],o[1],a[0],a[1])}else{for(let o=e;o<r;o++)this.paintVertexArray.emplace(o,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,i=it(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,r,n){return new Ar(e,r)}},et=class{constructor(e,r,n,i,o,a){this.expression=e,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(e,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,i,o){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(e,r,n,i){if(!i||!n)return;let{min:o,mid:a,max:s}=n,l=i[o],u=i[a],c=i[s];if(!(!l||!u||!c))for(let p=e;p<r;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Un.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Un.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},zo=class{constructor(e,r,n){this.binders={},this._buffers=[];let i=[];for(let o in e.paint._values){if(!n(o))continue;let a=e.paint.get(o);if(!(a instanceof Se)||!ht(a.property.specification))continue;let s=xd(o,e.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,p=a.property.specification["property-type"],f=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[o]=f?new At(l.value,s):new Xt(l.value,s,u),i.push("/u_".concat(o));else if(l.kind==="source"||f){let y=Vc(o,u,"source");this.binders[o]=f?new et(l,u,c,r,y,e.id):new We(l,s,u,y),i.push("/a_".concat(o))}else{let y=Vc(o,u,"composite");this.binders[o]=new De(l,s,u,c,r,y),i.push("/z_".concat(o))}}this.cacheKey=i.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof We||r instanceof De?r.maxValue:0}populatePaintArrays(e,r,n,i,o){for(let a in this.binders){let s=this.binders[a];(s instanceof We||s instanceof De||s instanceof et)&&s.populatePaintArray(e,r,n,i,o)}}setConstantPatternPositions(e,r){for(let n in this.binders){let i=this.binders[n];i instanceof At&&i.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,i,o){let a=!1;for(let s in e){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let p in this.binders){let f=this.binders[p];if((f instanceof We||f instanceof De||f instanceof et)&&f.expression.isStateDependent===!0){let y=i.paint.get(p);f.expression=y.value,f.updatePaintArray(u.start,u.end,c,e[s],o),a=!0}}}}return a}defines(){let e=[];for(let r in this.binders){let n=this.binders[r];(n instanceof Xt||n instanceof At)&&e.push(...n.uniformNames.map(i=>"#define HAS_UNIFORM_".concat(i)))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof We||n instanceof De)for(let i=0;i<n.paintVertexAttributes.length;i++)e.push(n.paintVertexAttributes[i].name);else if(n instanceof et)for(let i=0;i<Un.members.length;i++)e.push(Un.members[i].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof Xt||n instanceof At||n instanceof De)for(let i of n.uniformNames)e.push(i)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){let n=[];for(let i in this.binders){let o=this.binders[i];if(o instanceof Xt||o instanceof At||o instanceof De){for(let a of o.uniformNames)if(r[a]){let s=o.getBinding(e,r[a],a);n.push({name:a,property:i,binding:s})}}}return n}setUniforms(e,r,n,i){for(let{name:o,property:a,binding:s}of r)this.binders[a].setUniform(s,i,n.get(a),o)}updatePaintBuffers(e){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(e&&n instanceof et){let i=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof We||n instanceof De)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let r in this.binders){let n=this.binders[r];(n instanceof We||n instanceof De||n instanceof et)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof We||r instanceof De||r instanceof et)&&r.destroy()}}},Ce=class{constructor(e,r,n=()=>!0){this.programConfigurations={};for(let i of e)this.programConfigurations[i.id]=new zo(i,r,n);this.needsUpload=!1,this._featureMap=new $n,this._bufferOffset=0}populatePaintArrays(e,r,n,i,o,a){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,r,i,o,a);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,i){for(let o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,r,o,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};function xd(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function bd(t){return{"line-pattern":{source:ut,composite:ut},"fill-pattern":{source:ut,composite:ut},"fill-extrusion-pattern":{source:ut,composite:ut}}[t]}function Vc(t,e,r){let n={color:{source:St,composite:wr},number:{source:Ht,composite:St}},i=bd(t);return i&&i[r]||n[e][r]}C("ConstantBinder",Xt);C("CrossFadedConstantBinder",At);C("SourceExpressionBinder",We);C("CrossFadedCompositeBinder",et);C("CompositeExpressionBinder",De);C("ProgramConfiguration",zo,{omit:["_buffers"]});C("ProgramConfigurationSet",Ce);var vd=15,Fs=Math.pow(2,vd-1)-1,Bc=-Fs-1;function ke(t){let e=8192/t.extent,r=t.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let a=i[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=it(s,Bc,Fs),a.y=it(l,Bc,Fs),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function $e(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ke(t):[]}}function Ro(t,e,r,n,i){t.emplaceBack(e*2+(n+1)/2,r*2+(i+1)/2)}var Kt=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ao,this.indexArray=new Le,this.segments=new me,this.programConfigurations=new Ce(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){let i=this.layers[0],o=[],a=null,s=!1;i.type==="circle"&&(a=i.layout.get("circle-sort-key"),s=!a.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let f=this.layers[0]._featureFilter.needGeometry,y=$e(l,f);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),y,n))continue;let m=s?a.evaluate(y,{},n):void 0,h={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:f?y.geometry:ke(l),patterns:{},sortKey:m};o.push(h)}s&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l,f=e[c].feature;this.addFeature(l,u,c,n),r.featureIndex.insert(f,u,c,p,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,i){for(let o of r)for(let a of o){let s=a.x,l=a.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),c=u.vertexLength;Ro(this.layoutVertexArray,s,l,-1,-1),Ro(this.layoutVertexArray,s,l,1,-1),Ro(this.layoutVertexArray,s,l,1,1),Ro(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i)}};C("CircleBucket",Kt,{omit:["layers"]});var qn=Z(he(),1);function Rc(t,e){for(let r=0;r<t.length;r++)if(_r(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(_r(t,e[r]))return!0;return!!Ds(t,e)}function Oc(t,e,r){return!!(_r(t,e)||Ls(e,t,r))}function Oo(t,e){if(t.length===1)return zc(e,t[0]);for(let r=0;r<e.length;r++){let n=e[r];for(let i=0;i<n.length;i++)if(_r(t,n[i]))return!0}for(let r=0;r<t.length;r++)if(zc(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Ds(t,e[r]))return!0;return!1}function Nc(t,e,r){for(let n=0;n<e.length;n++){let i=e[n];if(t.length>=3){for(let o=0;o<i.length;o++)if(_r(t,i[o]))return!0}if(Pd(t,i,r))return!0}return!1}function Pd(t,e,r){if(t.length>1){if(Ds(t,e))return!0;for(let n=0;n<e.length;n++)if(Ls(e[n],t,r))return!0}for(let n=0;n<t.length;n++)if(Ls(t[n],e,r))return!0;return!1}function Ds(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let n=t[r],i=t[r+1];for(let o=0;o<e.length-1;o++){let a=e[o],s=e[o+1];if(Sd(n,i,a,s))return!0}}return!1}function Sd(t,e,r,n){return ot(t,r,n)!==ot(e,r,n)&&ot(t,e,r)!==ot(t,e,n)}function Ls(t,e,r){let n=r*r;if(e.length===1)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++){let o=e[i-1],a=e[i];if(Vs(t,o,a)<n)return!0}return!1}function Vs(t,e,r){let n=e.distSqr(r);if(n===0)return t.distSqr(e);let i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;return i<0?t.distSqr(e):i>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(i)._add(e))}function zc(t,e){let r=!1,n,i,o;for(let a=0;a<t.length;a++){n=t[a];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],o=n[l],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function _r(t,e){let r=!1;for(let n=0,i=t.length-1;n<t.length;i=n++){let o=t[n],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Uc(t,e,r,n,i){for(let a of t)if(e<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;let o=[new qn.default(e,r),new qn.default(e,i),new qn.default(n,i),new qn.default(n,r)];if(t.length>2){for(let a of o)if(_r(t,a))return!0}for(let a=0;a<t.length-1;a++){let s=t[a],l=t[a+1];if(wd(s,l,o))return!0}return!1}function wd(t,e,r){let n=r[0],i=r[2];if(t.x<n.x&&e.x<n.x||t.x>i.x&&e.x>i.x||t.y<n.y&&e.y<n.y||t.y>i.y&&e.y>i.y)return!1;let o=ot(t,e,r[0]);return o!==ot(t,e,r[1])||o!==ot(t,e,r[2])||o!==ot(t,e,r[3])}var No=Z(he(),1);function Yt(t,e,r){let n=e.paint.get(t).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(t)}function _t(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function It(t,e,r,n,i){if(!e[0]&&!e[1])return t;let o=No.default.convert(e)._mult(i);r==="viewport"&&o._rotate(-n);let a=[];for(let s=0;s<t.length;s++){let l=t[s];a.push(l.sub(o))}return a}function $c(t,e){let r=[];for(let n=0;n<t.length;n++){let i=t[n],o=[];for(let a=0;a<i.length;a++){let s=i[a-1],l=i[a],u=i[a+1],c=a===0?new No.default(0,0):l.sub(s)._unit()._perp(),p=a===i.length-1?new No.default(0,0):u.sub(l)._unit()._perp(),f=c._add(p)._unit(),y=f.x*p.x+f.y*p.y;y!==0&&f._mult(1/y),o.push(f._mult(e)._add(l))}r.push(o)}return r}var Gc,Ad=()=>Gc=Gc||new re({"circle-sort-key":new R(S.layout_circle["circle-sort-key"])}),qc,_d=()=>qc=qc||new re({"circle-radius":new R(S.paint_circle["circle-radius"]),"circle-color":new R(S.paint_circle["circle-color"]),"circle-blur":new R(S.paint_circle["circle-blur"]),"circle-opacity":new R(S.paint_circle["circle-opacity"]),"circle-translate":new B(S.paint_circle["circle-translate"]),"circle-translate-anchor":new B(S.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new B(S.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new B(S.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new R(S.paint_circle["circle-stroke-width"]),"circle-stroke-color":new R(S.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new R(S.paint_circle["circle-stroke-opacity"])}),jc={get paint(){return _d()},get layout(){return Ad()}};var Q=1e-6,Ge=typeof Float32Array<"u"?Float32Array:Array,jn=Math.random;var X1=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Jn={};Ol(Jn,{add:()=>ug,adjoint:()=>Ld,clone:()=>Td,copy:()=>Cd,create:()=>Id,determinant:()=>Dd,equals:()=>yg,exactEquals:()=>fg,frob:()=>lg,fromQuat:()=>Yd,fromQuat2:()=>Zd,fromRotation:()=>Gd,fromRotationTranslation:()=>Hc,fromRotationTranslationScale:()=>Xd,fromRotationTranslationScaleOrigin:()=>Kd,fromScaling:()=>$d,fromTranslation:()=>Ud,fromValues:()=>kd,fromXRotation:()=>qd,fromYRotation:()=>jd,fromZRotation:()=>Jd,frustum:()=>Qd,getRotation:()=>Hd,getScaling:()=>Xc,getTranslation:()=>Wd,identity:()=>Zc,invert:()=>Fd,lookAt:()=>og,mul:()=>mg,multiply:()=>Wc,multiplyScalar:()=>cg,multiplyScalarAndAdd:()=>pg,ortho:()=>ng,orthoNO:()=>Yc,orthoZO:()=>ig,perspective:()=>eg,perspectiveFromFieldOfView:()=>rg,perspectiveNO:()=>Kc,perspectiveZO:()=>tg,rotate:()=>zd,rotateX:()=>Rd,rotateY:()=>Od,rotateZ:()=>Nd,scale:()=>Bd,set:()=>Md,str:()=>sg,sub:()=>hg,subtract:()=>Qc,targetTo:()=>ag,translate:()=>Vd,transpose:()=>Ed});function Id(){var t=new Ge(16);return Ge!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Td(t){var e=new Ge(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Cd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function kd(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h){var d=new Ge(16);return d[0]=t,d[1]=e,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=a,d[7]=s,d[8]=l,d[9]=u,d[10]=c,d[11]=p,d[12]=f,d[13]=y,d[14]=m,d[15]=h,d}function Md(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=p,t[11]=f,t[12]=y,t[13]=m,t[14]=h,t[15]=d,t}function Zc(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ed(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Fd(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15],b=r*s-n*a,x=r*l-i*a,v=r*u-o*a,P=n*l-i*s,w=n*u-o*s,T=i*u-o*l,F=c*h-p*m,E=c*d-f*m,_=c*g-y*m,I=p*d-f*h,k=p*g-y*h,V=f*g-y*d,A=b*V-x*k+v*I+P*_-w*E+T*F;return A?(A=1/A,t[0]=(s*V-l*k+u*I)*A,t[1]=(i*k-n*V-o*I)*A,t[2]=(h*T-d*w+g*P)*A,t[3]=(f*w-p*T-y*P)*A,t[4]=(l*_-a*V-u*E)*A,t[5]=(r*V-i*_+o*E)*A,t[6]=(d*v-m*T-g*x)*A,t[7]=(c*T-f*v+y*x)*A,t[8]=(a*k-s*_+u*F)*A,t[9]=(n*_-r*k-o*F)*A,t[10]=(m*w-h*v+g*b)*A,t[11]=(p*v-c*w-y*b)*A,t[12]=(s*E-a*I-l*F)*A,t[13]=(r*I-n*E+i*F)*A,t[14]=(h*x-m*P-d*b)*A,t[15]=(c*P-p*x+f*b)*A,t):null}function Ld(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15];return t[0]=s*(f*g-y*d)-p*(l*g-u*d)+h*(l*y-u*f),t[1]=-(n*(f*g-y*d)-p*(i*g-o*d)+h*(i*y-o*f)),t[2]=n*(l*g-u*d)-s*(i*g-o*d)+h*(i*u-o*l),t[3]=-(n*(l*y-u*f)-s*(i*y-o*f)+p*(i*u-o*l)),t[4]=-(a*(f*g-y*d)-c*(l*g-u*d)+m*(l*y-u*f)),t[5]=r*(f*g-y*d)-c*(i*g-o*d)+m*(i*y-o*f),t[6]=-(r*(l*g-u*d)-a*(i*g-o*d)+m*(i*u-o*l)),t[7]=r*(l*y-u*f)-a*(i*y-o*f)+c*(i*u-o*l),t[8]=a*(p*g-y*h)-c*(s*g-u*h)+m*(s*y-u*p),t[9]=-(r*(p*g-y*h)-c*(n*g-o*h)+m*(n*y-o*p)),t[10]=r*(s*g-u*h)-a*(n*g-o*h)+m*(n*u-o*s),t[11]=-(r*(s*y-u*p)-a*(n*y-o*p)+c*(n*u-o*s)),t[12]=-(a*(p*d-f*h)-c*(s*d-l*h)+m*(s*f-l*p)),t[13]=r*(p*d-f*h)-c*(n*d-i*h)+m*(n*f-i*p),t[14]=-(r*(s*d-l*h)-a*(n*d-i*h)+m*(n*l-i*s)),t[15]=r*(s*f-l*p)-a*(n*f-i*p)+c*(n*l-i*s),t}function Dd(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],p=t[10],f=t[11],y=t[12],m=t[13],h=t[14],d=t[15],g=e*a-r*o,b=e*s-n*o,x=e*l-i*o,v=r*s-n*a,P=r*l-i*a,w=n*l-i*s,T=u*m-c*y,F=u*h-p*y,E=u*d-f*y,_=c*h-p*m,I=c*d-f*m,k=p*d-f*h;return g*k-b*I+x*_+v*E-P*F+w*T}function Wc(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],f=e[9],y=e[10],m=e[11],h=e[12],d=e[13],g=e[14],b=e[15],x=r[0],v=r[1],P=r[2],w=r[3];return t[0]=x*n+v*s+P*p+w*h,t[1]=x*i+v*l+P*f+w*d,t[2]=x*o+v*u+P*y+w*g,t[3]=x*a+v*c+P*m+w*b,x=r[4],v=r[5],P=r[6],w=r[7],t[4]=x*n+v*s+P*p+w*h,t[5]=x*i+v*l+P*f+w*d,t[6]=x*o+v*u+P*y+w*g,t[7]=x*a+v*c+P*m+w*b,x=r[8],v=r[9],P=r[10],w=r[11],t[8]=x*n+v*s+P*p+w*h,t[9]=x*i+v*l+P*f+w*d,t[10]=x*o+v*u+P*y+w*g,t[11]=x*a+v*c+P*m+w*b,x=r[12],v=r[13],P=r[14],w=r[15],t[12]=x*n+v*s+P*p+w*h,t[13]=x*i+v*l+P*f+w*d,t[14]=x*o+v*u+P*y+w*g,t[15]=x*a+v*c+P*m+w*b,t}function Vd(t,e,r){var n=r[0],i=r[1],o=r[2],a,s,l,u,c,p,f,y,m,h,d,g;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*o+e[12],t[13]=e[1]*n+e[5]*i+e[9]*o+e[13],t[14]=e[2]*n+e[6]*i+e[10]*o+e[14],t[15]=e[3]*n+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],l=e[2],u=e[3],c=e[4],p=e[5],f=e[6],y=e[7],m=e[8],h=e[9],d=e[10],g=e[11],t[0]=a,t[1]=s,t[2]=l,t[3]=u,t[4]=c,t[5]=p,t[6]=f,t[7]=y,t[8]=m,t[9]=h,t[10]=d,t[11]=g,t[12]=a*n+c*i+m*o+e[12],t[13]=s*n+p*i+h*o+e[13],t[14]=l*n+f*i+d*o+e[14],t[15]=u*n+y*i+g*o+e[15]),t}function Bd(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zd(t,e,r,n){var i=n[0],o=n[1],a=n[2],s=Math.hypot(i,o,a),l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V,A,z;return s<Q?null:(s=1/s,i*=s,o*=s,a*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,p=e[0],f=e[1],y=e[2],m=e[3],h=e[4],d=e[5],g=e[6],b=e[7],x=e[8],v=e[9],P=e[10],w=e[11],T=i*i*c+u,F=o*i*c+a*l,E=a*i*c-o*l,_=i*o*c-a*l,I=o*o*c+u,k=a*o*c+i*l,V=i*a*c+o*l,A=o*a*c-i*l,z=a*a*c+u,t[0]=p*T+h*F+x*E,t[1]=f*T+d*F+v*E,t[2]=y*T+g*F+P*E,t[3]=m*T+b*F+w*E,t[4]=p*_+h*I+x*k,t[5]=f*_+d*I+v*k,t[6]=y*_+g*I+P*k,t[7]=m*_+b*I+w*k,t[8]=p*V+h*A+x*z,t[9]=f*V+d*A+v*z,t[10]=y*V+g*A+P*z,t[11]=m*V+b*A+w*z,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Rd(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*n,t[5]=a*i+c*n,t[6]=s*i+p*n,t[7]=l*i+f*n,t[8]=u*i-o*n,t[9]=c*i-a*n,t[10]=p*i-s*n,t[11]=f*i-l*n,t}function Od(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],p=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*n,t[1]=a*i-c*n,t[2]=s*i-p*n,t[3]=l*i-f*n,t[8]=o*n+u*i,t[9]=a*n+c*i,t[10]=s*n+p*i,t[11]=l*n+f*i,t}function Nd(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*n,t[1]=a*i+c*n,t[2]=s*i+p*n,t[3]=l*i+f*n,t[4]=u*i-o*n,t[5]=c*i-a*n,t[6]=p*i-s*n,t[7]=f*i-l*n,t}function Ud(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function $d(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gd(t,e,r){var n=r[0],i=r[1],o=r[2],a=Math.hypot(n,i,o),s,l,u;return a<Q?null:(a=1/a,n*=a,i*=a,o*=a,s=Math.sin(e),l=Math.cos(e),u=1-l,t[0]=n*n*u+l,t[1]=i*n*u+o*s,t[2]=o*n*u-i*s,t[3]=0,t[4]=n*i*u-o*s,t[5]=i*i*u+l,t[6]=o*i*u+n*s,t[7]=0,t[8]=n*o*u+i*s,t[9]=i*o*u-n*s,t[10]=o*o*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function qd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hc(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=n+n,l=i+i,u=o+o,c=n*s,p=n*l,f=n*u,y=i*l,m=i*u,h=o*u,d=a*s,g=a*l,b=a*u;return t[0]=1-(y+h),t[1]=p+b,t[2]=f-g,t[3]=0,t[4]=p-b,t[5]=1-(c+h),t[6]=m+d,t[7]=0,t[8]=f+g,t[9]=m-d,t[10]=1-(c+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Zd(t,e){var r=new Ge(3),n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=n*n+i*i+o*o+a*a;return p>0?(r[0]=(s*a+c*n+l*o-u*i)*2/p,r[1]=(l*a+c*i+u*n-s*o)*2/p,r[2]=(u*a+c*o+s*i-l*n)*2/p):(r[0]=(s*a+c*n+l*o-u*i)*2,r[1]=(l*a+c*i+u*n-s*o)*2,r[2]=(u*a+c*o+s*i-l*n)*2),Hc(t,e,r),t}function Wd(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Xc(t,e){var r=e[0],n=e[1],i=e[2],o=e[4],a=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(l,u,c),t}function Hd(t,e){var r=new Ge(3);Xc(r,e);var n=1/r[0],i=1/r[1],o=1/r[2],a=e[0]*n,s=e[1]*i,l=e[2]*o,u=e[4]*n,c=e[5]*i,p=e[6]*o,f=e[8]*n,y=e[9]*i,m=e[10]*o,h=a+c+m,d=0;return h>0?(d=Math.sqrt(h+1)*2,t[3]=.25*d,t[0]=(p-y)/d,t[1]=(f-l)/d,t[2]=(s-u)/d):a>c&&a>m?(d=Math.sqrt(1+a-c-m)*2,t[3]=(p-y)/d,t[0]=.25*d,t[1]=(s+u)/d,t[2]=(f+l)/d):c>m?(d=Math.sqrt(1+c-a-m)*2,t[3]=(f-l)/d,t[0]=(s+u)/d,t[1]=.25*d,t[2]=(p+y)/d):(d=Math.sqrt(1+m-a-c)*2,t[3]=(s-u)/d,t[0]=(f+l)/d,t[1]=(p+y)/d,t[2]=.25*d),t}function Xd(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3],l=i+i,u=o+o,c=a+a,p=i*l,f=i*u,y=i*c,m=o*u,h=o*c,d=a*c,g=s*l,b=s*u,x=s*c,v=n[0],P=n[1],w=n[2];return t[0]=(1-(m+d))*v,t[1]=(f+x)*v,t[2]=(y-b)*v,t[3]=0,t[4]=(f-x)*P,t[5]=(1-(p+d))*P,t[6]=(h+g)*P,t[7]=0,t[8]=(y+b)*w,t[9]=(h-g)*w,t[10]=(1-(p+m))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Kd(t,e,r,n,i){var o=e[0],a=e[1],s=e[2],l=e[3],u=o+o,c=a+a,p=s+s,f=o*u,y=o*c,m=o*p,h=a*c,d=a*p,g=s*p,b=l*u,x=l*c,v=l*p,P=n[0],w=n[1],T=n[2],F=i[0],E=i[1],_=i[2],I=(1-(h+g))*P,k=(y+v)*P,V=(m-x)*P,A=(y-v)*w,z=(1-(f+g))*w,O=(d+b)*w,N=(m+x)*T,K=(d-b)*T,xe=(1-(f+h))*T;return t[0]=I,t[1]=k,t[2]=V,t[3]=0,t[4]=A,t[5]=z,t[6]=O,t[7]=0,t[8]=N,t[9]=K,t[10]=xe,t[11]=0,t[12]=r[0]+F-(I*F+A*E+N*_),t[13]=r[1]+E-(k*F+z*E+K*_),t[14]=r[2]+_-(V*F+O*E+xe*_),t[15]=1,t}function Yd(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,l=i+i,u=r*a,c=n*a,p=n*s,f=i*a,y=i*s,m=i*l,h=o*a,d=o*s,g=o*l;return t[0]=1-p-m,t[1]=c+g,t[2]=f-d,t[3]=0,t[4]=c-g,t[5]=1-u-m,t[6]=y+h,t[7]=0,t[8]=f+d,t[9]=y-h,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qd(t,e,r,n,i,o,a){var s=1/(r-e),l=1/(i-n),u=1/(o-a);return t[0]=o*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(a+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*u,t[15]=0,t}function Kc(t,e,r,n,i){var o=1/Math.tan(e/2),a;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var eg=Kc;function tg(t,e,r,n,i){var o=1/Math.tan(e/2),a;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function rg(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((a-s)*l*.5),t[9]=(i-o)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Yc(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(a+o)*u,t[15]=1,t}var ng=Yc;function ig(t,e,r,n,i,o,a){var s=1/(e-r),l=1/(n-i),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=o*u,t[15]=1,t}function og(t,e,r,n){var i,o,a,s,l,u,c,p,f,y,m=e[0],h=e[1],d=e[2],g=n[0],b=n[1],x=n[2],v=r[0],P=r[1],w=r[2];return Math.abs(m-v)<Q&&Math.abs(h-P)<Q&&Math.abs(d-w)<Q?Zc(t):(c=m-v,p=h-P,f=d-w,y=1/Math.hypot(c,p,f),c*=y,p*=y,f*=y,i=b*f-x*p,o=x*c-g*f,a=g*p-b*c,y=Math.hypot(i,o,a),y?(y=1/y,i*=y,o*=y,a*=y):(i=0,o=0,a=0),s=p*a-f*o,l=f*i-c*a,u=c*o-p*i,y=Math.hypot(s,l,u),y?(y=1/y,s*=y,l*=y,u*=y):(s=0,l=0,u=0),t[0]=i,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=p,t[7]=0,t[8]=a,t[9]=u,t[10]=f,t[11]=0,t[12]=-(i*m+o*h+a*d),t[13]=-(s*m+l*h+u*d),t[14]=-(c*m+p*h+f*d),t[15]=1,t)}function ag(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=n[0],l=n[1],u=n[2],c=i-r[0],p=o-r[1],f=a-r[2],y=c*c+p*p+f*f;y>0&&(y=1/Math.sqrt(y),c*=y,p*=y,f*=y);var m=l*f-u*p,h=u*c-s*f,d=s*p-l*c;return y=m*m+h*h+d*d,y>0&&(y=1/Math.sqrt(y),m*=y,h*=y,d*=y),t[0]=m,t[1]=h,t[2]=d,t[3]=0,t[4]=p*d-f*h,t[5]=f*m-c*d,t[6]=c*h-p*m,t[7]=0,t[8]=c,t[9]=p,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function sg(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function lg(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ug(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Qc(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function cg(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function pg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function fg(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function yg(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15],b=e[0],x=e[1],v=e[2],P=e[3],w=e[4],T=e[5],F=e[6],E=e[7],_=e[8],I=e[9],k=e[10],V=e[11],A=e[12],z=e[13],O=e[14],N=e[15];return Math.abs(r-b)<=Q*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=Q*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-v)<=Q*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-P)<=Q*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-w)<=Q*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-T)<=Q*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-F)<=Q*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(u-E)<=Q*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-_)<=Q*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(p-I)<=Q*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-k)<=Q*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(y-V)<=Q*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(m-A)<=Q*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(h-z)<=Q*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(d-O)<=Q*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-N)<=Q*Math.max(1,Math.abs(g),Math.abs(N))}var mg=Wc,hg=Qc;var Qt={};Ol(Qt,{add:()=>vg,ceil:()=>Pg,clone:()=>dg,copy:()=>xg,create:()=>ep,cross:()=>Fg,dist:()=>qg,distance:()=>ip,div:()=>Gg,divide:()=>np,dot:()=>Eg,equals:()=>Ng,exactEquals:()=>Og,floor:()=>Sg,forEach:()=>Wg,fromValues:()=>gg,inverse:()=>kg,len:()=>Jg,length:()=>ap,lerp:()=>Lg,max:()=>Ag,min:()=>wg,mul:()=>$g,multiply:()=>rp,negate:()=>Cg,normalize:()=>Mg,random:()=>Dg,round:()=>_g,scale:()=>Ig,scaleAndAdd:()=>Tg,set:()=>bg,sqrDist:()=>jg,sqrLen:()=>Zg,squaredDistance:()=>op,squaredLength:()=>sp,str:()=>Rg,sub:()=>Ug,subtract:()=>tp,transformMat4:()=>Vg,transformQuat:()=>Bg,zero:()=>zg});function ep(){var t=new Ge(4);return Ge!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function dg(t){var e=new Ge(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function gg(t,e,r,n){var i=new Ge(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function xg(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function bg(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function vg(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function tp(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function rp(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function np(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Pg(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Sg(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function wg(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Ag(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function _g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Ig(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Tg(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function ip(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(r,n,i,o)}function op(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}function ap(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function sp(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function Cg(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function kg(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Mg(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a,t}function Eg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Fg(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=e[0],p=e[1],f=e[2],y=e[3];return t[0]=p*u-f*l+y*s,t[1]=-(c*u)+f*a-y*o,t[2]=c*l-p*a+y*i,t[3]=-(c*s)+p*o-f*i,t}function Lg(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=s+n*(r[3]-s),t}function Dg(t,e){e=e||1;var r,n,i,o,a,s;do r=jn()*2-1,n=jn()*2-1,a=r*r+n*n;while(a>=1);do i=jn()*2-1,o=jn()*2-1,s=i*i+o*o;while(s>=1);var l=Math.sqrt((1-a)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*l,t[3]=e*o*l,t}function Vg(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}function Bg(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,p=u*i+l*n-a*o,f=u*o+a*i-s*n,y=-a*n-s*i-l*o;return t[0]=c*u+y*-a+p*-l-f*-s,t[1]=p*u+y*-s+f*-a-c*-l,t[2]=f*u+y*-l+c*-s-p*-a,t[3]=e[3],t}function zg(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Rg(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Og(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Ng(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(r-a)<=Q*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Q*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Q*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=Q*Math.max(1,Math.abs(o),Math.abs(u))}var Ug=tp,$g=rp,Gg=np,qg=ip,jg=op,Jg=ap,Zg=sp,Wg=function(){var t=ep();return function(e,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,s=n;s<l;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();var lp=Z(he(),1),Uo=class extends se{constructor(e){super(e,jc)}createBucket(e){return new Kt(e)}queryRadius(e){let r=e;return Yt("circle-radius",this,r)+Yt("circle-stroke-width",this,r)+_t(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s,l){let u=It(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(r,n),p=this.paint.get("circle-stroke-width").evaluate(r,n),f=c+p,y=this.paint.get("circle-pitch-alignment")==="map",m=y?u:Hg(u,l),h=y?f*s:f;for(let d of i)for(let g of d){let b=y?g:up(g,l),x=h,v=Qt.transformMat4([],[g.x,g.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?x*=v[3]/a.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(x*=a.cameraToCenterDistance/v[3]),Oc(m,b,x))return!0}return!1}};function up(t,e){let r=Qt.transformMat4([],[t.x,t.y,0,1],e);return new lp.default(r[0]/r[3],r[1]/r[3])}function Hg(t,e){return t.map(r=>up(r,e))}var Zn=class extends Kt{};C("HeatmapBucket",Zn,{omit:["layers"]});var cp,Xg=()=>cp=cp||new re({"heatmap-radius":new R(S.paint_heatmap["heatmap-radius"]),"heatmap-weight":new R(S.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new B(S.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zt(S.paint_heatmap["heatmap-color"]),"heatmap-opacity":new B(S.paint_heatmap["heatmap-opacity"])}),pp={get paint(){return Xg()}};function Bs(t,{width:e,height:r},n,i){if(!i)i=new Uint8Array(e*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*r*n)throw new RangeError("mismatched image size. expected: ".concat(i.length," but got: ").concat(e*r*n));return t.width=e,t.height=r,t.data=i,t}function fp(t,{width:e,height:r},n){if(e===t.width&&r===t.height)return;let i=Bs({},{width:e,height:r},n);zs(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,r)},n),t.width=e,t.height=r,t.data=i.data}function zs(t,e,r,n,i,o){if(i.width===0||i.height===0)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let a=t.data,s=e.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*t.width+r.x)*o,c=((n.y+l)*e.width+n.x)*o;for(let p=0;p<i.width*o;p++)s[c+p]=a[u+p]}return e}var er=class t{constructor(e,r){Bs(this,e,1,r)}resize(e){fp(this,e,1)}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){zs(e,r,n,i,o,1)}},de=class t{constructor(e,r){Bs(this,e,4,r)}resize(e){fp(this,e,4)}replace(e,r){r?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,i,o){zs(e,r,n,i,o,4)}};C("AlphaImage",er);C("RGBAImage",de);function yp(t){let e={},r=t.resolution||256,n=t.clips?t.clips.length:1,i=t.image||new de({width:r,height:n});if(!Xl(r))throw new Error("width is not a power of 2 - ".concat(r));let o=(a,s,l)=>{e[t.evaluationKey]=l;let u=t.expression.evaluate(e);i.data[a+s+0]=Math.floor(u.r*255/u.a),i.data[a+s+1]=Math.floor(u.g*255/u.a),i.data[a+s+2]=Math.floor(u.b*255/u.a),i.data[a+s+3]=Math.floor(u.a*255)};if(t.clips)for(let a=0,s=0;a<n;++a,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:p,end:f}=t.clips[a],y=p*(1-c)+f*c;o(s,u,y)}else for(let a=0,s=0;a<r;a++,s+=4){let l=a/(r-1);o(0,s,l)}return i}var $o=class extends se{createBucket(e){return new Zn(e)}constructor(e){super(e,pp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=yp({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};var mp,Kg=()=>mp=mp||new re({"hillshade-illumination-direction":new B(S.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new B(S.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new B(S.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new B(S.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new B(S.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new B(S.paint_hillshade["hillshade-accent-color"])}),hp={get paint(){return Kg()}};var Go=class extends se{constructor(e){super(e,hp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};var Yg=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:dp,size:GP,alignment:qP}=Yg;var Sp=Z($s(),1);function Gs(t,e,r,n,i){Pp(t,e,r||0,n||t.length-1,i||mx)}function Pp(t,e,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(e-a*l/o+u)),p=Math.min(n,Math.floor(e+(o-a)*l/o+u));Pp(t,e,c,p,i)}var f=t[e],y=r,m=n;for(Kn(t,r,e),i(t[n],f)>0&&Kn(t,r,n);y<m;){for(Kn(t,y,m),y++,m--;i(t[y],f)<0;)y++;for(;i(t[m],f)>0;)m--}i(t[r],f)===0?Kn(t,r,m):(m++,Kn(t,m,n)),m<=e&&(r=m+1),e<=m&&(n=m-1)}}function Kn(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function mx(t,e){return t<e?-1:t>e?1:0}function Tr(t,e){let r=t.length;if(r<=1)return[t];let n=[],i,o;for(let a=0;a<r;a++){let s=Ql(t[a]);s!==0&&(t[a].area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[t[a]]):i.push(t[a]))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||(Gs(n[a],e,1,n[a].length-1,hx),n[a]=n[a].slice(0,e));return n}function hx(t,e){return e.area-t.area}function Cr(t,e,r){let n=r.patternDependencies,i=!1;for(let o of e){let a=o.paint.get("".concat(t,"-pattern"));a.isConstant()||(i=!0);let s=a.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function kr(t,e,r,n,i){let o=i.patternDependencies;for(let a of e){let l=a.paint.get("".concat(t,"-pattern")).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:n-1},r,{},i.availableImages),c=l.evaluate({zoom:n},r,{},i.availableImages),p=l.evaluate({zoom:n+1},r,{},i.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,o[u]=!0,o[c]=!0,o[p]=!0,r.patterns[a.id]={min:u,mid:c,max:p}}}return r}var dx=500,rr=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _o,this.indexArray=new Le,this.indexArray2=new wt,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.segments2=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Cr("fill",this.layers,r);let i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n,r.availableImages):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=kr("fill",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,dp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,n,i,o){for(let a of Tr(r,dx)){let s=0;for(let y of a)s+=y.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let y of a){if(y.length===0)continue;y!==a[0]&&p.push(c.length/2);let m=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),h=m.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(h+y.length-1,h),c.push(y[0].x),c.push(y[0].y);for(let d=1;d<y.length;d++)this.layoutVertexArray.emplaceBack(y[d].x,y[d].y),this.indexArray2.emplaceBack(h+d-1,h+d),c.push(y[d].x),c.push(y[d].y);m.vertexLength+=y.length,m.primitiveLength+=y.length}let f=(0,Sp.default)(c,p);for(let y=0;y<f.length;y+=3)this.indexArray.emplaceBack(u+f[y],u+f[y+1],u+f[y+2]);l.vertexLength+=s,l.primitiveLength+=f.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};C("FillBucket",rr,{omit:["layers","patternFeatures"]});var wp,gx=()=>wp=wp||new re({"fill-sort-key":new R(S.layout_fill["fill-sort-key"])}),Ap,xx=()=>Ap=Ap||new re({"fill-antialias":new B(S.paint_fill["fill-antialias"]),"fill-opacity":new R(S.paint_fill["fill-opacity"]),"fill-color":new R(S.paint_fill["fill-color"]),"fill-outline-color":new R(S.paint_fill["fill-outline-color"]),"fill-translate":new B(S.paint_fill["fill-translate"]),"fill-translate-anchor":new B(S.paint_fill["fill-translate-anchor"]),"fill-pattern":new lt(S.paint_fill["fill-pattern"])}),_p={get paint(){return xx()},get layout(){return gx()}};var Wo=class extends se{constructor(e){super(e,_p)}recalculate(e,r){super.recalculate(e,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new rr(e)}queryRadius(){return _t(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s){let l=It(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s);return Oo(l,i)}isTileClipped(){return!0}};var bx=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ip=Y([{name:"a_centroid",components:2,type:"Int16"}],4);var{members:Tp,size:IS,alignment:TS}=bx;var Lp=Z($s(),1),Dp=Z(Tt(),1);var Ex=Dp.default.VectorTileFeature.types,Fx=500,Js=Math.pow(2,13);function Yn(t,e,r,n,i,o,a,s){t.emplaceBack(e,r,Math.floor(n*Js)*2+a,i*Js*2,o*Js*2,Math.round(s))}var nr=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Io,this.centroidVertexArray=new wo,this.indexArray=new Le,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.features=[],this.hasPattern=Cr("fill-extrusion",this.layers,r);for(let{feature:i,id:o,index:a,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=$e(i,l);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),u,n))continue;let c={id:o,sourceLayerIndex:s,index:a,geometry:l?u.geometry:ke(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(kr("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,a,n,{}),r.featureIndex.insert(i,c.geometry,a,s,this.index,!0)}}addFeatures(e,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tp),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ip.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,n,i,o){let a={x:0,y:0,vertexCount:0};for(let s of Tr(r,Fx)){let l=0;for(let m of s)l+=m.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let m of s){if(m.length===0||Dx(m))continue;let h=0;for(let d=0;d<m.length;d++){let g=m[d];if(d>=1){let b=m[d-1];if(!Lx(g,b)){u.vertexLength+4>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let x=g.sub(b)._perp()._unit(),v=b.dist(g);h+v>32768&&(h=0),Yn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,h),Yn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,h),a.x+=2*g.x,a.y+=2*g.y,a.vertexCount+=2,h+=v,Yn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,0,h),Yn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,1,h),a.x+=2*b.x,a.y+=2*b.y,a.vertexCount+=2;let P=u.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),Ex[e.type]!=="Polygon")continue;let c=[],p=[],f=u.vertexLength;for(let m of s)if(m.length!==0){m!==s[0]&&p.push(c.length/2);for(let h=0;h<m.length;h++){let d=m[h];Yn(this.layoutVertexArray,d.x,d.y,0,0,1,1,0),a.x+=d.x,a.y+=d.y,a.vertexCount+=1,c.push(d.x),c.push(d.y)}}let y=(0,Lp.default)(c,p);for(let m=0;m<y.length;m+=3)this.indexArray.emplaceBack(f+y[m],f+y[m+2],f+y[m+1]);u.primitiveLength+=y.length/3,u.vertexLength+=l}for(let s=0;s<a.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}};C("FillExtrusionBucket",nr,{omit:["layers","features"]});function Lx(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}function Dx(t){return t.every(e=>e.x<0)||t.every(e=>e.x>8192)||t.every(e=>e.y<0)||t.every(e=>e.y>8192)}var Vp,Vx=()=>Vp=Vp||new re({"fill-extrusion-opacity":new B(S["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new R(S["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new B(S["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new B(S["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lt(S["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new R(S["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new R(S["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new B(S["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Bp={get paint(){return Vx()}};var Xo=Z(he(),1);var Ko=class extends se{constructor(e){super(e,Bp)}createBucket(e){return new nr(e)}queryRadius(){return _t(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,n,i,o,a,s,l){let u=It(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(r,n),p=this.paint.get("fill-extrusion-base").evaluate(r,n),f=Rx(u,l,a,0),y=zx(i,p,c,l),m=y[0],h=y[1];return Bx(m,h,f)}};function Qn(t,e){return t.x*e.x+t.y*e.y}function zp(t,e){if(t.length===1){let r=0,n=e[r++],i;for(;!i||n.equals(i);)if(i=e[r++],!i)return 1/0;for(;r<e.length;r++){let o=e[r],a=t[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=Qn(s,s),p=Qn(s,l),f=Qn(l,l),y=Qn(u,s),m=Qn(u,l),h=c*f-p*p,d=(f*y-p*m)/h,g=(c*m-p*y)/h,b=1-d-g,x=n.z*b+i.z*d+o.z*g;if(isFinite(x))return x}return 1/0}else{let r=1/0;for(let n of e)r=Math.min(r,n.z);return r}}function Bx(t,e,r){let n=1/0;Oo(r,e)&&(n=zp(r,e[0]));for(let i=0;i<e.length;i++){let o=e[i],a=t[i];for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=a[s],p=a[s+1],f=[l,u,p,c,l];Rc(r,f)&&(n=Math.min(n,zp(r,f)))}}return n===1/0?!1:n}function zx(t,e,r,n){let i=[],o=[],a=n[8]*e,s=n[9]*e,l=n[10]*e,u=n[11]*e,c=n[8]*r,p=n[9]*r,f=n[10]*r,y=n[11]*r;for(let m of t){let h=[],d=[];for(let g of m){let b=g.x,x=g.y,v=n[0]*b+n[4]*x+n[12],P=n[1]*b+n[5]*x+n[13],w=n[2]*b+n[6]*x+n[14],T=n[3]*b+n[7]*x+n[15],F=v+a,E=P+s,_=w+l,I=T+u,k=v+c,V=P+p,A=w+f,z=T+y,O=new Xo.default(F/I,E/I);O.z=_/I,h.push(O);let N=new Xo.default(k/z,V/z);N.z=A/z,d.push(N)}i.push(h),o.push(d)}return[i,o]}function Rx(t,e,r,n){let i=[];for(let o of t){let a=[o.x,o.y,n,1];Qt.transformMat4(a,a,e),i.push(new Xo.default(a[0]/a[3],a[1]/a[3]))}return i}var Ox=Y([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rp,size:uw,alignment:cw}=Ox;var Nx=Y([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Op,size:yw,alignment:mw}=Nx;var $p=Z(Tt(),1);var Ux=$p.default.VectorTileFeature.types,Np=63,$x=Math.cos(75/2*(Math.PI/180)),Gx=15,qx=20,jx=15,Gp=1/2,Up=Math.pow(2,jx-1)/Gp,ir=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new To,this.layoutVertexArray2=new Co,this.indexArray=new Le,this.programConfigurations=new Ce(e.layers,e.zoom),this.segments=new me,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n){this.hasPattern=Cr("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=kr("line",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=e[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(e,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n)}addFeatures(e,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Op)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let r=+e.properties.mapbox_clip_start,n=+e.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(e,r,n,i,o){let a=this.layers[0].layout,s=a.get("line-join").evaluate(e,{}),l=a.get("line-cap"),u=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let p of r)this.addLine(p,e,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,i)}addLine(e,r,n,i,o,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let g=0;g<e.length-1;g++)this.totalDistance+=e[g].dist(e[g+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Ux[r.type]==="Polygon",l=e.length;for(;l>=2&&e[l-1].equals(e[l-2]);)l--;let u=0;for(;u<l-1&&e[u].equals(e[u+1]);)u++;if(l<(s?3:2))return;n==="bevel"&&(o=1.05);let c=this.overscaling<=16?Gx*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),f,y,m,h,d;this.e1=this.e2=-1,s&&(f=e[l-2],d=e[u].sub(f)._unit()._perp());for(let g=u;g<l;g++){if(m=g===l-1?s?e[u+1]:void 0:e[g+1],m&&e[g].equals(m))continue;d&&(h=d),f&&(y=f),f=e[g],d=m?m.sub(f)._unit()._perp():h,h=h||d;let b=h.add(d);(b.x!==0||b.y!==0)&&b._unit();let x=h.x*d.x+h.y*d.y,v=b.x*d.x+b.y*d.y,P=v!==0?1/v:1/0,w=2*Math.sqrt(2-2*v),T=v<$x&&y&&m,F=h.x*d.y-h.y*d.x>0;if(T&&g>u){let I=f.dist(y);if(I>2*c){let k=f.sub(f.sub(y)._mult(c/I)._round());this.updateDistance(y,k),this.addCurrentVertex(k,h,0,0,p),y=k}}let E=y&&m,_=E?n:s?"butt":i;if(E&&_==="round"&&(P<a?_="miter":P<=2&&(_="fakeround")),_==="miter"&&P>o&&(_="bevel"),_==="bevel"&&(P>2&&(_="flipbevel"),P<o&&(_="miter")),y&&this.updateDistance(y,f),_==="miter")b._mult(P),this.addCurrentVertex(f,b,0,0,p);else if(_==="flipbevel"){if(P>100)b=d.mult(-1);else{let I=P*h.add(d).mag()/h.sub(d).mag();b._perp()._mult(I*(F?-1:1))}this.addCurrentVertex(f,b,0,0,p),this.addCurrentVertex(f,b.mult(-1),0,0,p)}else if(_==="bevel"||_==="fakeround"){let I=-Math.sqrt(P*P-1),k=F?I:0,V=F?0:I;if(y&&this.addCurrentVertex(f,h,k,V,p),_==="fakeround"){let A=Math.round(w*180/Math.PI/qx);for(let z=1;z<A;z++){let O=z/A;if(O!==.5){let K=O-.5,xe=1.0904+x*(-3.2452+x*(3.55645-x*1.43519)),X=.848013+x*(-1.06021+x*.215638);O=O+O*K*(O-1)*(xe*K*K+X)}let N=d.sub(h)._mult(O)._add(h)._unit()._mult(F?-1:1);this.addHalfVertex(f,N.x,N.y,!1,F,0,p)}}m&&this.addCurrentVertex(f,d,-k,-V,p)}else if(_==="butt")this.addCurrentVertex(f,b,0,0,p);else if(_==="square"){let I=y?1:-1;this.addCurrentVertex(f,b,I,I,p)}else _==="round"&&(y&&(this.addCurrentVertex(f,h,0,0,p),this.addCurrentVertex(f,h,1,1,p,!0)),m&&(this.addCurrentVertex(f,d,-1,-1,p,!0),this.addCurrentVertex(f,d,0,0,p)));if(T&&g<l-1){let I=f.dist(m);if(I>2*c){let k=f.add(m.sub(f)._mult(c/I)._round());this.updateDistance(f,k),this.addCurrentVertex(k,d,0,0,p),f=k}}}}addCurrentVertex(e,r,n,i,o,a=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(e,s,l,a,!1,n,o),this.addHalfVertex(e,u,c,a,!0,-i,o),this.distance>Up/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,n,i,o,a))}addHalfVertex({x:e,y:r},n,i,o,a,s,l){let c=(this.lineClips?this.scaledDistance*(Up-1):this.scaledDistance)*Gp;if(this.layoutVertexArray.emplaceBack((e<<1)+(o?1:0),(r<<1)+(a?1:0),Math.round(Np*n)+128,Math.round(Np*i)+128,(s===0?0:s<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,m=f/y;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let p=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),l.primitiveLength++),a?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}};C("LineBucket",ir,{omit:["layers","patternFeatures"]});var qp,Jx=()=>qp=qp||new re({"line-cap":new B(S.layout_line["line-cap"]),"line-join":new R(S.layout_line["line-join"]),"line-miter-limit":new B(S.layout_line["line-miter-limit"]),"line-round-limit":new B(S.layout_line["line-round-limit"]),"line-sort-key":new R(S.layout_line["line-sort-key"])}),jp,Zx=()=>jp=jp||new re({"line-opacity":new R(S.paint_line["line-opacity"]),"line-color":new R(S.paint_line["line-color"]),"line-translate":new B(S.paint_line["line-translate"]),"line-translate-anchor":new B(S.paint_line["line-translate-anchor"]),"line-width":new R(S.paint_line["line-width"]),"line-gap-width":new R(S.paint_line["line-gap-width"]),"line-offset":new R(S.paint_line["line-offset"]),"line-blur":new R(S.paint_line["line-blur"]),"line-dasharray":new Jt(S.paint_line["line-dasharray"]),"line-pattern":new lt(S.paint_line["line-pattern"]),"line-gradient":new Zt(S.paint_line["line-gradient"])}),Zs={get paint(){return Zx()},get layout(){return Jx()}};var Ws=class extends R{possiblyEvaluate(e,r){return r=new q(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,n,i){return r=Pe({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,n,i)}},Yo,Qo=class extends se{constructor(e){super(e,Zs),this.gradientVersion=0,Yo||(Yo=new Ws(Zs.paint.properties["line-width"].specification),Yo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let r=this.gradientExpression();qt(r)?this.stepInterpolant=r._styleExpression.expression instanceof yr:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=Yo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new ir(e)}queryRadius(e){let r=e,n=Jp(Yt("line-width",this,r),Yt("line-gap-width",this,r)),i=Yt("line-offset",this,r);return n/2+Math.abs(i)+_t(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,n,i,o,a,s){let l=It(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*Jp(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),c=this.paint.get("line-offset").evaluate(r,n);return c&&(i=$c(i,c*s)),Nc(l,i,u)}isTileClipped(){return!0}};function Jp(t,e){return e>0?e+2*t:t}var Zp=Y([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wp=Y([{name:"a_projected_pos",components:3,type:"Float32"}],4),Kw=Y([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Hp=Y([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Yw=Y([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Hs=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qw=Y([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),e2=Y([{name:"triangle",components:3,type:"Uint16"}]),t2=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),r2=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),n2=Y([{type:"Float32",name:"offsetX"}]),i2=Y([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),o2=Y([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var oi=Z(he(),1);function Wx(t,e,r){let n=e.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?t=t.toLocaleUpperCase():n==="lowercase"&&(t=t.toLocaleLowerCase()),ye.applyArabicShaping&&(t=ye.applyArabicShaping(t)),t}function Xp(t,e,r){return t.sections.forEach(n=>{n.text=Wx(n.text,e,r)}),t}function Kp(t){let e={},r={},n=[],i=0;function o(u){n.push(t[u]),i++}function a(u,c,p){let f=r[u];return delete r[u],r[c]=f,n[f].geometry[0].pop(),n[f].geometry[0]=n[f].geometry[0].concat(p[0]),f}function s(u,c,p){let f=e[c];return delete e[c],e[u]=f,n[f].geometry[0].shift(),n[f].geometry[0]=p[0].concat(n[f].geometry[0]),f}function l(u,c,p){let f=p?c[0][c[0].length-1]:c[0][0];return"".concat(u,":").concat(f.x,":").concat(f.y)}for(let u=0;u<t.length;u++){let c=t[u],p=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}let y=l(f,p),m=l(f,p,!0);if(y in r&&m in e&&r[y]!==e[m]){let h=s(y,m,p),d=a(y,m,n[h].geometry);delete e[y],delete r[m],r[l(f,n[d].geometry,!0)]=d,n[h].geometry=null}else y in r?a(y,m,p):m in e?s(y,m,p):(o(u),e[y]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}var Er={"!":"\\uFE15","#":"\\uFF03",$:"\\uFF04","%":"\\uFF05","&":"\\uFF06","(":"\\uFE35",")":"\\uFE36","*":"\\uFF0A","+":"\\uFF0B",",":"\\uFE10","-":"\\uFE32",".":"\\u30FB","/":"\\uFF0F",":":"\\uFE13",";":"\\uFE14","<":"\\uFE3F","=":"\\uFF1D",">":"\\uFE40","?":"\\uFE16","@":"\\uFF20","[":"\\uFE47","\\\\":"\\uFF3C","]":"\\uFE48","^":"\\uFF3E",_:"\\uFE33","\`":"\\uFF40","{":"\\uFE37","|":"\\u2015","}":"\\uFE38","~":"\\uFF5E","\\xA2":"\\uFFE0","\\xA3":"\\uFFE1","\\xA5":"\\uFFE5","\\xA6":"\\uFFE4","\\xAC":"\\uFFE2","\\xAF":"\\uFFE3","\\u2013":"\\uFE32","\\u2014":"\\uFE31","\\u2018":"\\uFE43","\\u2019":"\\uFE44","\\u201C":"\\uFE41","\\u201D":"\\uFE42","\\u2026":"\\uFE19","\\u2027":"\\u30FB","\\u20A9":"\\uFFE6","\\u3001":"\\uFE11","\\u3002":"\\uFE12","\\u3008":"\\uFE3F","\\u3009":"\\uFE40","\\u300A":"\\uFE3D","\\u300B":"\\uFE3E","\\u300C":"\\uFE41","\\u300D":"\\uFE42","\\u300E":"\\uFE43","\\u300F":"\\uFE44","\\u3010":"\\uFE3B","\\u3011":"\\uFE3C","\\u3014":"\\uFE39","\\u3015":"\\uFE3A","\\u3016":"\\uFE17","\\u3017":"\\uFE18","\\uFF01":"\\uFE15","\\uFF08":"\\uFE35","\\uFF09":"\\uFE36","\\uFF0C":"\\uFE10","\\uFF0D":"\\uFE32","\\uFF0E":"\\u30FB","\\uFF1A":"\\uFE13","\\uFF1B":"\\uFE14","\\uFF1C":"\\uFE3F","\\uFF1E":"\\uFE40","\\uFF1F":"\\uFE16","\\uFF3B":"\\uFE47","\\uFF3D":"\\uFE48","\\uFF3F":"\\uFE33","\\uFF5B":"\\uFE37","\\uFF5C":"\\u2015","\\uFF5D":"\\uFE38","\\uFF5F":"\\uFE35","\\uFF60":"\\uFE36","\\uFF61":"\\uFE12","\\uFF62":"\\uFE41","\\uFF63":"\\uFE42"};function Yp(t){let e="";for(let r=0;r<t.length;r++){let n=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;(!n||!As(n)||Er[t[r+1]])&&(!i||!As(i)||Er[t[r-1]])&&Er[t[r]]?e+=Er[t[r]]:e+=t[r]}return e}var ne=24;var fb=Z(ei(),1),yb=3;var ra=yb;function ti(t){let e=0,r=0;for(let s of t)e+=s.w*s.h,r=Math.max(r,s.w);t.sort((s,l)=>l.h-s.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],o=0,a=0;for(let s of t)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(s.w>u.w||s.h>u.h)){if(s.x=u.x,s.y=u.y,a=Math.max(a,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===u.w&&s.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else s.h===u.h?(u.x+=s.w,u.w-=s.w):s.w===u.w?(u.y+=s.h,u.h-=s.h):(i.push({x:u.x+s.w,y:u.y,w:u.w-s.w,h:s.h}),u.y+=s.h,u.h-=s.h);break}}return{w:o,h:a,fill:e/(o*a)||0}}var ge=1;var na=class{constructor(e,{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n}get tl(){return[this.paddedRect.x+ge,this.paddedRect.y+ge]}get br(){return[this.paddedRect.x+this.paddedRect.w-ge,this.paddedRect.y+this.paddedRect.h-ge]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-ge*2)/this.pixelRatio,(this.paddedRect.h-ge*2)/this.pixelRatio]}},ri=class{constructor(e,r){let n={},i={};this.haveRenderCallbacks=[];let o=[];this.addImages(e,n,o),this.addImages(r,i,o);let{w:a,h:s}=ti(o),l=new de({width:a||1,height:s||1});for(let u in e){let c=e[u],p=n[u].paddedRect;de.copy(c.data,l,{x:0,y:0},{x:p.x+ge,y:p.y+ge},c.data)}for(let u in r){let c=r[u],p=i[u].paddedRect,f=p.x+ge,y=p.y+ge,m=c.data.width,h=c.data.height;de.copy(c.data,l,{x:0,y:0},{x:f,y},c.data),de.copy(c.data,l,{x:0,y:h-1},{x:f,y:y-1},{width:m,height:1}),de.copy(c.data,l,{x:0,y:0},{x:f,y:y+h},{width:m,height:1}),de.copy(c.data,l,{x:m-1,y:0},{x:f-1,y},{width:1,height:h}),de.copy(c.data,l,{x:0,y:0},{x:f+m,y},{width:1,height:h})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(e,r,n){for(let i in e){let o=e[i],a={x:0,y:0,w:o.data.width+2*ge,h:o.data.height+2*ge};n.push(a),r[i]=new na(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;let[i,o]=e.tl;n.update(r.data,void 0,{x:i,y:o})}};C("ImagePosition",na);C("ImageAtlas",ri);var aa=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(aa||{}),Dr=-17;function mb(t){for(let e of t)if(e.positionedGlyphs.length!==0)return!1;return!0}var af=57344,sf=63743,ia=class t{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){let n=new t;return n.scale=e||1,n.fontStack=r,n}static forImage(e){let r=new t;return r.imageName=e,r}},ni=class t{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){let n=new t;for(let i=0;i<e.sections.length;i++){let o=e.sections[i];o.image?n.addImageSection(o):n.addTextSection(o,r)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=Yp(this.text)}trim(){let e=0;for(let n=0;n<this.text.length&&oa[this.text.charCodeAt(n)];n++)e++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&oa[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){let n=new t;return n.text=this.text.substring(e,r),n.sectionIndex=this.sectionIndex.slice(e,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(ia.forText(e.scale,e.fontStack||r));let n=this.sections.length-1;for(let i=0;i<e.text.length;++i)this.sectionIndex.push(n)}addImageSection(e){let r=e.image?e.image.name:"";if(r.length===0){fe("Can't add FormattedSection with an empty image.");return}let n=this.getNextImageSectionCharCode();if(!n){fe("Reached maximum number of images ".concat(sf-af+2));return}this.text+=String.fromCharCode(n),this.sections.push(ia.forImage(r)),this.sectionIndex.push(this.sections.length-1)}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=sf?null:++this.imageSectionID:(this.imageSectionID=af,this.imageSectionID)}};function hb(t,e){let r=[],n=t.text,i=0;for(let o of e)r.push(t.substring(i,o)),i=o;return i<n.length&&r.push(t.substring(i,n.length)),r}function ii(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h){let d=ni.fromFeature(t,i);p===2&&d.verticalizePunctuation();let g,{processBidirectionalText:b,processStyledBidirectionalText:x}=ye;if(b&&d.sections.length===1){g=[];let w=b(d.toString(),Ys(d,u,o,e,n,y,m));for(let T of w){let F=new ni;F.text=T,F.sections=d.sections;for(let E=0;E<T.length;E++)F.sectionIndex.push(0);g.push(F)}}else if(x){g=[];let w=x(d.text,d.sectionIndex,Ys(d,u,o,e,n,y,m));for(let T of w){let F=new ni;F.text=T[0],F.sectionIndex=T[1],F.sections=d.sections,g.push(F)}}else g=hb(d,Ys(d,u,o,e,n,y,m));let v=[],P={positionedLines:v,text:d.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return bb(P,e,r,n,g,a,s,l,p,u,f,h),mb(v)?!1:P}var oa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},db={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function cf(t,e,r,n,i,o){if(e.imageName){let a=n[e.imageName];return a?a.displaySize[0]*e.scale*ne/o+i:0}else{let a=r[e.fontStack],s=a&&a[t];return s?s.metrics.advance*e.scale+i:0}}function gb(t,e,r,n,i,o){let a=0;for(let l=0;l<t.length();l++){let u=t.getSection(l);a+=cf(t.getCharCode(l),u,n,i,e,o)}let s=Math.max(1,Math.ceil(a/r));return a/s}function lf(t,e,r,n){let i=Math.pow(t-e,2);return n?t<e?i/2:i*2:i+Math.abs(r)*r}function xb(t,e,r){let n=0;return t===10&&(n-=1e4),r&&(n+=150),(t===40||t===65288)&&(n+=50),(e===41||e===65289)&&(n+=50),n}function uf(t,e,r,n,i,o){let a=null,s=lf(e,r,i,o);for(let l of n){let u=e-l.x,c=lf(u,r,i,o)+l.badness;c<=s&&(a=l,s=c)}return{index:t,x:e,priorBreak:a,badness:s}}function pf(t){return t?pf(t.priorBreak).concat(t.index):[]}function Ys(t,e,r,n,i,o,a){if(o!=="point")return[];if(!t)return[];let s=[],l=gb(t,e,r,n,i,a),u=t.text.indexOf("\\u200B")>=0,c=0;for(let p=0;p<t.length();p++){let f=t.getSection(p),y=t.getCharCode(p);if(oa[y]||(c+=cf(y,f,n,i,e,a)),p<t.length()-1){let m=Sc(y);(db[y]||m||f.imageName)&&s.push(uf(p+1,c,l,s,xb(y,t.getCharCode(p+1),m&&u),!1))}}return pf(uf(t.length(),c,l,s,0,!0))}function ff(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:e,verticalAlign:r}}function bb(t,e,r,n,i,o,a,s,l,u,c,p){let f=0,y=Dr,m=0,h=0,d=s==="right"?1:s==="left"?0:.5,g=0;for(let P of i){P.trim();let w=P.getMaxScale(),T=(w-1)*ne,F={positionedGlyphs:[],lineOffset:0};t.positionedLines[g]=F;let E=F.positionedGlyphs,_=0;if(!P.length()){y+=o,++g;continue}for(let k=0;k<P.length();k++){let V=P.getSection(k),A=P.getSectionIndex(k),z=P.getCharCode(k),O=0,N=null,K=null,xe=null,X=ne,le=!(l===1||!c&&!lo(z)||c&&(oa[z]||wc(z)));if(V.imageName){let ce=n[V.imageName];if(!ce)continue;xe=V.imageName,t.iconsInText=t.iconsInText||!0,K=ce.paddedRect;let pe=ce.displaySize;V.scale=V.scale*ne/p,N={width:pe[0],height:pe[1],left:ge,top:-ra,advance:le?pe[1]:pe[0]};let _e=ne-pe[1]*V.scale;O=T+_e,X=N.advance;let be=le?pe[0]*V.scale-ne*w:pe[1]*V.scale-ne*w;be>0&&be>_&&(_=be)}else{let ce=r[V.fontStack],pe=ce&&ce[z];if(pe&&pe.rect)K=pe.rect,N=pe.metrics;else{let _e=e[V.fontStack],be=_e&&_e[z];if(!be)continue;N=be.metrics}O=(w-V.scale)*ne}le?(t.verticalizable=!0,E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=X*V.scale+u):(E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=N.advance*V.scale+u)}if(E.length!==0){let k=f-u;m=Math.max(k,m),vb(E,0,E.length-1,d,_)}f=0;let I=o*w+_;F.lineOffset=Math.max(_,T),y+=I,h=Math.max(I,h),++g}let b=y-Dr,{horizontalAlign:x,verticalAlign:v}=ff(a);Pb(t.positionedLines,d,x,v,m,h,o,b,i.length),t.top+=-v*b,t.bottom=t.top+b,t.left+=-x*m,t.right=t.left+m}function vb(t,e,r,n,i){if(!n&&!i)return;let o=t[r],a=o.metrics.advance*o.scale,s=(t[r].x+a)*n;for(let l=e;l<=r;l++)t[l].x-=s,t[l].y+=i}function Pb(t,e,r,n,i,o,a,s,l){let u=(e-r)*i,c=0;o!==a?c=-s*n-Dr:c=(-n*l+.5)*a;for(let p of t)for(let f of p.positionedGlyphs)f.x+=u,f.y+=c}function yf(t,e,r){let{horizontalAlign:n,verticalAlign:i}=ff(r),o=e[0],a=e[1],s=o-t.displaySize[0]*n,l=s+t.displaySize[0],u=a-t.displaySize[1]*i,c=u+t.displaySize[1];return{image:t,top:u,bottom:c,left:s,right:l}}function Qs(t,e,r,n,i,o){let a=t.image,s;if(a.content){let d=a.content,g=a.pixelRatio||1;s=[d[0]/g,d[1]/g,a.displaySize[0]-d[2]/g,a.displaySize[1]-d[3]/g]}let l=e.left*o,u=e.right*o,c,p,f,y;r==="width"||r==="both"?(y=i[0]+l-n[3],p=i[0]+u+n[1]):(y=i[0]+(l+u-a.displaySize[0])/2,p=y+a.displaySize[0]);let m=e.top*o,h=e.bottom*o;return r==="height"||r==="both"?(c=i[1]+m-n[0],f=i[1]+h+n[2]):(c=i[1]+(m+h-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:p,bottom:f,left:y,collisionPadding:s}}var mf=Z(Tt(),1);var Vr=255,Ct=128,tt=Vr*Ct;function el(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new q(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,o=0;for(;o<n.length&&n[o]<=t;)o++;o=Math.max(0,o-1);let a=o;for(;a<n.length&&n[a]<t+1;)a++;a=Math.min(n.length-1,a);let s=n[o],l=n[a];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new q(s)),c=r.evaluate(new q(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function tl(t,e,r){let n="never",i=t.get(e);return i?n=i:t.get(r)&&(n="always"),n}var Sb=mf.default.VectorTileFeature.types,wb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sa(t,e,r,n,i,o,a,s,l,u,c,p,f){let y=s?Math.min(tt,Math.round(s[0])):0,m=s?Math.min(tt,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(n*32),Math.round(i*32),o,a,(y<<1)+(l?1:0),m,u*16,c*16,p*256,f*256)}function hf(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Ab(t){for(let e of t.sections)if(_c(e.text))return!0;return!1}var ai=class{constructor(e){this.layoutVertexArray=new ko,this.indexArray=new Le,this.programConfigurations=e,this.segments=new me,this.dynamicLayoutVertexArray=new Mo,this.opacityVertexArray=new Eo,this.hasVisibleVertices=!1,this.placedSymbolArray=new Dn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,wb,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};C("SymbolBuffers",ai);var si=class{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new me,this.collisionVertexArray=new Fo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};C("CollisionBuffers",si);var He=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Jn.identity([]),this.placementViewportMatrix=Jn.identity([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=el(this.zoom,n["text-size"]),this.iconSizeData=el(this.zoom,n["icon-size"]);let i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=tl(i,"text-overlap","text-allow-overlap")!=="never"||tl(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!o.isConstant();let s=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>aa[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=e.sourceID}createArrays(){this.text=new ai(new Ce(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new ai(new Ce(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Bn,this.lineVertexArray=new zn,this.symbolInstances=new Vn,this.textAnchorOffsets=new Rn}calculateGlyphDependencies(e,r,n,i,o){for(let a=0;a<e.length;a++)if(r[e.charCodeAt(a)]=!0,(n||i)&&o){let s=Er[e.charAt(a)];s&&(r[s.charCodeAt(0)]=!0)}}populate(e,r,n){let i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(a.value.kind!=="constant"||a.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let f=r.iconDependencies,y=r.glyphDependencies,m=r.availableImages,h=new q(this.zoom);for(let{feature:d,id:g,index:b,sourceLayerIndex:x}of e){let v=i._featureFilter.needGeometry,P=$e(d,v);if(!i._featureFilter.filter(h,P,n))continue;v||(P.geometry=ke(d));let w;if(u){let _=i.getValueAndResolveTokens("text-field",P,n,m),I=Fe.factory(_),k=this.hasRTLText=this.hasRTLText||Ab(I);(!k||ye.getRTLTextPluginStatus()==="unavailable"||k&&ye.isParsed())&&(w=Xp(I,i,P))}let T;if(c){let _=i.getValueAndResolveTokens("icon-image",P,n,m);_ instanceof Te?T=_:T=Te.fromString(_)}if(!w&&!T)continue;let F=this.sortFeaturesByKey?p.evaluate(P,{},n):void 0,E={id:g,text:w,icon:T,index:b,sourceLayerIndex:x,geometry:P.geometry,properties:d.properties,type:Sb[d.type],sortKey:F};if(this.features.push(E),T&&(f[T.name]=!0),w){let _=a.evaluate(P,{},n).join(","),I=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let k of w.sections)if(k.image)f[k.image.name]=!0;else{let V=hn(w.toString()),A=k.fontStack||_,z=y[A]=y[A]||{};this.calculateGlyphDependencies(k.text,z,I,this.allowVerticalPlacement,V)}}}o.get("symbol-placement")==="line"&&(this.features=Kp(this.features)),this.sortFeaturesByKey&&this.features.sort((d,g)=>d.sortKey-g.sortKey)}update(e,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){let n=this.lineVertexArray.length;if(e.segment!==void 0){let i=e.dist(r[e.segment+1]),o=e.dist(r[e.segment]),a={};for(let s=e.segment+1;s<r.length;s++)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=e.segment||0;s>=0;s--)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=a[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,i,o,a,s,l,u,c,p,f){let y=e.indexArray,m=e.layoutVertexArray,h=e.segments.prepareSegment(4*r.length,m,y,this.canOverlap?a.sortKey:void 0),d=this.glyphOffsetArray.length,g=h.vertexLength,b=this.allowVerticalPlacement&&s===2?Math.PI/2:0,x=a.text&&a.text.sections;for(let v=0;v<r.length;v++){let{tl:P,tr:w,bl:T,br:F,tex:E,pixelOffsetTL:_,pixelOffsetBR:I,minFontScaleX:k,minFontScaleY:V,glyphOffset:A,isSDF:z,sectionIndex:O}=r[v],N=h.vertexLength,K=A[1];sa(m,l.x,l.y,P.x,K+P.y,E.x,E.y,n,z,_.x,_.y,k,V),sa(m,l.x,l.y,w.x,K+w.y,E.x+E.w,E.y,n,z,I.x,_.y,k,V),sa(m,l.x,l.y,T.x,K+T.y,E.x,E.y+E.h,n,z,_.x,I.y,k,V),sa(m,l.x,l.y,F.x,K+F.y,E.x+E.w,E.y+E.h,n,z,I.x,I.y,k,V),hf(e.dynamicLayoutVertexArray,l,b),y.emplaceBack(N,N+1,N+2),y.emplaceBack(N+1,N+2,N+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),(v===r.length-1||O!==r[v+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(m.length,a,a.index,{},f,x&&x[O])}e.placedSymbolArray.emplaceBack(l.x,l.y,d,this.glyphOffsetArray.length-d,g,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,p)}_addCollisionDebugVertex(e,r,n,i,o,a){return r.emplaceBack(0,0),e.emplaceBack(n.x,n.y,i,o,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,r,n,i,o,a,s){let l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,y=s.anchorY;this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(e,r)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(n,r)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(n,i)),this._addCollisionDebugVertex(c,p,a,f,y,new oi.default(e,i)),l.vertexLength+=4;let m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,r,n,i){for(let o=e;o<r;o++){let a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new si(Nn,Hs.members,wt),this.iconCollisionBox=new si(Nn,Hs.members,wt);for(let e=0;e<this.symbolInstances.length;e++){let r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,n,i,o,a,s,l,u){let c={};for(let p=r;p<n;p++){let f=e.get(p);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(let p=i;p<o;p++){let f=e.get(p);c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}for(let p=a;p<s;p++){let f=e.get(p);c.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.iconFeatureIndex=f.featureIndex;break}for(let p=l;p<u;p++){let f=e.get(p);c.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalIconFeatureIndex=f.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){let n=e.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let o=n.vertexStartIndex;o<i;o+=4)e.indexArray.emplaceBack(o,o+1,o+2),e.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),n=Math.cos(e),i=[],o=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),o.push(l.featureIndex)}return a.sort((s,l)=>i[s]-i[l]||o[l]-o[s]),a}addToSortKeyRanges(e,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,o,a)=>{i>=0&&a.indexOf(i)===o&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};C("SymbolBucket",He,{omit:["layers","collisionBoxArray","features","compareText"]});He.MAX_GLYPHS=65535;He.addDynamicAttributes=hf;function df(t,e){return e.replace(/{([^{}]+)}/g,(r,n)=>t&&n in t?String(t[n]):"")}var gf,_b=()=>gf=gf||new re({"symbol-placement":new B(S.layout_symbol["symbol-placement"]),"symbol-spacing":new B(S.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new B(S.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new R(S.layout_symbol["symbol-sort-key"]),"symbol-z-order":new B(S.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new B(S.layout_symbol["icon-allow-overlap"]),"icon-overlap":new B(S.layout_symbol["icon-overlap"]),"icon-ignore-placement":new B(S.layout_symbol["icon-ignore-placement"]),"icon-optional":new B(S.layout_symbol["icon-optional"]),"icon-rotation-alignment":new B(S.layout_symbol["icon-rotation-alignment"]),"icon-size":new R(S.layout_symbol["icon-size"]),"icon-text-fit":new B(S.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new B(S.layout_symbol["icon-text-fit-padding"]),"icon-image":new R(S.layout_symbol["icon-image"]),"icon-rotate":new R(S.layout_symbol["icon-rotate"]),"icon-padding":new R(S.layout_symbol["icon-padding"]),"icon-keep-upright":new B(S.layout_symbol["icon-keep-upright"]),"icon-offset":new R(S.layout_symbol["icon-offset"]),"icon-anchor":new R(S.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new B(S.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new B(S.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new B(S.layout_symbol["text-rotation-alignment"]),"text-field":new R(S.layout_symbol["text-field"]),"text-font":new R(S.layout_symbol["text-font"]),"text-size":new R(S.layout_symbol["text-size"]),"text-max-width":new R(S.layout_symbol["text-max-width"]),"text-line-height":new B(S.layout_symbol["text-line-height"]),"text-letter-spacing":new R(S.layout_symbol["text-letter-spacing"]),"text-justify":new R(S.layout_symbol["text-justify"]),"text-radial-offset":new R(S.layout_symbol["text-radial-offset"]),"text-variable-anchor":new B(S.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new R(S.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new R(S.layout_symbol["text-anchor"]),"text-max-angle":new B(S.layout_symbol["text-max-angle"]),"text-writing-mode":new B(S.layout_symbol["text-writing-mode"]),"text-rotate":new R(S.layout_symbol["text-rotate"]),"text-padding":new B(S.layout_symbol["text-padding"]),"text-keep-upright":new B(S.layout_symbol["text-keep-upright"]),"text-transform":new R(S.layout_symbol["text-transform"]),"text-offset":new R(S.layout_symbol["text-offset"]),"text-allow-overlap":new B(S.layout_symbol["text-allow-overlap"]),"text-overlap":new B(S.layout_symbol["text-overlap"]),"text-ignore-placement":new B(S.layout_symbol["text-ignore-placement"]),"text-optional":new B(S.layout_symbol["text-optional"])}),xf,Ib=()=>xf=xf||new re({"icon-opacity":new R(S.paint_symbol["icon-opacity"]),"icon-color":new R(S.paint_symbol["icon-color"]),"icon-halo-color":new R(S.paint_symbol["icon-halo-color"]),"icon-halo-width":new R(S.paint_symbol["icon-halo-width"]),"icon-halo-blur":new R(S.paint_symbol["icon-halo-blur"]),"icon-translate":new B(S.paint_symbol["icon-translate"]),"icon-translate-anchor":new B(S.paint_symbol["icon-translate-anchor"]),"text-opacity":new R(S.paint_symbol["text-opacity"]),"text-color":new R(S.paint_symbol["text-color"],{runtimeType:Re,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new R(S.paint_symbol["text-halo-color"]),"text-halo-width":new R(S.paint_symbol["text-halo-width"]),"text-halo-blur":new R(S.paint_symbol["text-halo-blur"]),"text-translate":new B(S.paint_symbol["text-translate"]),"text-translate-anchor":new B(S.paint_symbol["text-translate-anchor"])}),la={get paint(){return Ib()},get layout(){return _b()}};var li=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:hr,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;e(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};C("FormatSectionOverride",li,{omit:["defaultValue"]});var ua=class t extends se{constructor(e){super(e,la)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let o of n)i.indexOf(o)<0&&i.push(o);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,i){let o=this.layout.get(e).evaluate(r,{},n,i),a=this._unevaluatedLayout._values[e];return!a.isDataDriven()&&!qt(a.value)&&o?df(r.properties,o):o}createBucket(e){return new He(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of la.paint.overridableProperties){if(!t.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),n=new li(r),i=new Nt(n,r.property.specification),o=null;r.value.kind==="constant"||r.value.kind==="source"?o=new dt("source",i):o=new gt("composite",i,r.value.zoomStops),this.paint._values[e]=new Se(r.property,o,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:t.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let n=e.get("text-field"),i=la.paint.properties[r],o=!1,a=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){o=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Fe)a(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!o)if(u instanceof mt&&ue(u.value)===dr){let c=u.value;a(c.sections)}else u instanceof tn?a(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return o}};function bf(t,e,r,n=1){let i=t.get("icon-padding").evaluate(e,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}var vf,Tb=()=>vf=vf||new re({"background-color":new B(S.paint_background["background-color"]),"background-pattern":new Jt(S.paint_background["background-pattern"]),"background-opacity":new B(S.paint_background["background-opacity"])}),Pf={get paint(){return Tb()}};var ca=class extends se{constructor(e){super(e,Pf)}};var Sf,Cb=()=>Sf=Sf||new re({"raster-opacity":new B(S.paint_raster["raster-opacity"]),"raster-hue-rotate":new B(S.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new B(S.paint_raster["raster-brightness-min"]),"raster-brightness-max":new B(S.paint_raster["raster-brightness-max"]),"raster-saturation":new B(S.paint_raster["raster-saturation"]),"raster-contrast":new B(S.paint_raster["raster-contrast"]),"raster-resampling":new B(S.paint_raster["raster-resampling"]),"raster-fade-duration":new B(S.paint_raster["raster-fade-duration"])}),wf={get paint(){return Cb()}};var pa=class extends se{constructor(e){super(e,wf)}};var fa=class extends se{constructor(r){super(r,{});this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)};this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)};this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function Af(t){if(t.type==="custom")return new fa(t);switch(t.type){case"background":return new ca(t);case"circle":return new Uo(t);case"fill":return new Wo(t);case"fill-extrusion":return new Ko(t);case"heatmap":return new $o(t);case"hillshade":return new Go(t);case"line":return new Qo(t);case"raster":return new pa(t);case"symbol":return new ua(t)}}var ya=class{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(e,r){for(let i of e){this._layerConfigs[i.id]=i;let o=this._layers[i.id]=Af(i);o._featureFilter=yn(o.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(let i of r)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let n=qu(Object.values(this._layerConfigs),this.keyCache);for(let i of n){let o=i.map(p=>this._layers[p.id]),a=o[0];if(a.visibility==="none")continue;let s=a.source||"",l=this.familiesBySource[s];l||(l=this.familiesBySource[s]={});let u=a.sourceLayer||"_geojsonTileLayer",c=l[u];c||(c=l[u]=[]),c.push(o)}}};var Hf=Z(Tt(),1),Xf=Z(ei(),1);var Br=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};var Tf=Z(Tt(),1),Cf=Z(ei(),1);var ma=class{constructor(e,r,n,i,o){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=n,e._y=i,this.properties=e.properties,this.id=o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}};var ui=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Vt(8192,16,0),this.grid3D=new Vt(8192,16,0),this.featureIndexArray=new On,this.promoteId=r}insert(e,r,n,i,o,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);let l=a?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],p=[1/0,1/0,-1/0,-1/0];for(let f=0;f<c.length;f++){let y=c[f];p[0]=Math.min(p[0],y.x),p[1]=Math.min(p[1],y.y),p[2]=Math.max(p[2],y.x),p[3]=Math.max(p[3],y.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Tf.default.VectorTile(new Cf.default(this.rawTileData)).layers,this.sourceLayerCoder=new Br(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,n,i){this.loadVTLayers();let o=e.params||{},a=8192/e.tileSize/e.scale,s=yn(o.filter),l=e.queryGeometry,u=e.queryPadding*a,c=If(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),f=If(e.cameraQueryGeometry),y=this.grid3D.query(f.minX-u,f.minY-u,f.maxX+u,f.maxY+u,(d,g,b,x)=>Uc(e.cameraQueryGeometry,d-u,g-u,b+u,x+u));for(let d of y)p.push(d);p.sort(kb);let m={},h;for(let d=0;d<p.length;d++){let g=p[d];if(g===h)continue;h=g;let b=this.featureIndexArray.get(g),x=null;this.loadMatchingFeature(m,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,s,o.layers,o.availableImages,r,n,i,(v,P,w)=>(x||(x=ke(v)),P.queryIntersectsFeature(l,v,w,x,this.z,e.transform,a,e.pixelPosMatrix)))}return m}loadMatchingFeature(e,r,n,i,o,a,s,l,u,c,p){let f=this.bucketLayerIDs[r];if(a&&!Yl(a,f))return;let y=this.sourceLayerCoder.decode(n),h=this.vtLayers[y].feature(i);if(o.needGeometry){let g=$e(h,!0);if(!o.filter(new q(this.tileID.overscaledZ),g,this.tileID.canonical))return}else if(!o.filter(new q(this.tileID.overscaledZ),h))return;let d=this.getId(h,y);for(let g=0;g<f.length;g++){let b=f[g];if(a&&a.indexOf(b)<0)continue;let x=l[b];if(!x)continue;let v={};d&&c&&(v=c.getState(x.sourceLayer||"_geojsonTileLayer",d));let P=Pe({},u[b]);P.paint=_f(P.paint,x.paint,h,v,s),P.layout=_f(P.layout,x.layout,h,v,s);let w=!p||p(h,x,v);if(!w)continue;let T=new ma(h,this.z,this.x,this.y,d);T.layer=P;let F=e[b];F===void 0&&(F=e[b]=[]),F.push({featureIndex:i,feature:T,intersectionZ:w})}}lookupSymbolFeatures(e,r,n,i,o,a,s,l){let u={};this.loadVTLayers();let c=yn(o);for(let p of e)this.loadMatchingFeature(u,n,i,p,c,a,s,l,r);return u}hasLayer(e){for(let r of this.bucketLayerIDs)for(let n of r)if(e===n)return!0;return!1}getId(e,r){let n=e.id;if(this.promoteId){let i=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];n=e.properties[i],typeof n=="boolean"&&(n=Number(n))}return n}};C("FeatureIndex",ui,{omit:["rawTileData","sourceLayerCoder"]});function _f(t,e,r,n,i){return jr(t,(o,a)=>{let s=e instanceof vt?e.get(a):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function If(t){let e=1/0,r=1/0,n=-1/0,i=-1/0;for(let o of t)e=Math.min(e,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{minX:e,minY:r,maxX:n,maxY:i}}function kb(t,e){return e-t}var kf=Z(he(),1);var rt=class t extends kf.default{constructor(e,r,n,i){super(e,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new t(this.x,this.y,this.angle,this.segment)}};C("Anchor",rt);function rl(t,e,r,n,i){if(e.segment===void 0||r===0)return!0;let o=e,a=e.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;let l=[],u=0;for(;s<r/2;){let c=t[a-1],p=t[a],f=t[a+1];if(!f)return!1;let y=c.angleTo(p)-p.angleTo(f);for(y=Math.abs((y+3*Math.PI)%(Math.PI*2)-Math.PI),l.push({distance:s,angleDelta:y}),u+=y;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=p.dist(f)}return!0}function Mf(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Ef(t,e,r){return t?3/5*e*r:0}function Ff(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Lf(t,e,r,n,i,o){let a=Ef(r,i,o),s=Ff(r,n)*o,l=0,u=Mf(t)/2;for(let c=0;c<t.length-1;c++){let p=t[c],f=t[c+1],y=p.dist(f);if(l+y>u){let m=(u-l)/y,h=Oe.number(p.x,f.x,m),d=Oe.number(p.y,f.y,m),g=new rt(h,d,f.angleTo(p),c);return g._round(),!a||rl(t,g,s,a,e)?g:void 0}l+=y}}function Df(t,e,r,n,i,o,a,s,l){let u=Ef(n,o,a),c=Ff(n,i),p=c*a,f=t[0].x===0||t[0].x===l||t[0].y===0||t[0].y===l;e-p<e/4&&(e=p+e/4);let y=o*2,m=f?e/2*s%e:(c/2+y)*a*s%e;return Vf(t,m,e,u,r,p,f,!1,l)}function Vf(t,e,r,n,i,o,a,s,l){let u=o/2,c=Mf(t),p=0,f=e-r,y=[];for(let m=0;m<t.length-1;m++){let h=t[m],d=t[m+1],g=h.dist(d),b=d.angleTo(h);for(;f+r<p+g;){f+=r;let x=(f-p)/g,v=Oe.number(h.x,d.x,x),P=Oe.number(h.y,d.y,x);if(v>=0&&v<l&&P>=0&&P<l&&f-u>=0&&f+u<=c){let w=new rt(v,P,b,m);w._round(),(!n||rl(t,w,o,n,i))&&y.push(w)}}p+=g}return!s&&!y.length&&!a&&(y=Vf(t,p/2,r,n,i,o,a,!0,l)),y}var pt=Z(he(),1);function Bf(t,e,r,n,i){let o=[];for(let a=0;a<t.length;a++){let s=t[a],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new pt.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round():p.x<e&&(p=new pt.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round()),!(c.y<r&&p.y<r)&&(c.y<r?c=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round():p.y<r&&(p=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round()),!(c.x>=n&&p.x>=n)&&(c.x>=n?c=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round():p.x>=n&&(p=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round()),!(c.y>=i&&p.y>=i)&&(c.y>=i?c=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round():p.y>=i&&(p=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],o.push(l)),l.push(p)))))}}return o}var we=Z(he(),1);var zr=ge;function nl(t,e,r,n){let i=[],o=t.image,a=o.pixelRatio,s=o.paddedRect.w-2*zr,l=o.paddedRect.h-2*zr,u=t.right-t.left,c=t.bottom-t.top,p=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],y=(I,k)=>I+k[1]-k[0],m=p.reduce(y,0),h=f.reduce(y,0),d=s-m,g=l-h,b=0,x=m,v=0,P=h,w=0,T=d,F=0,E=g;if(o.content&&n){let I=o.content;b=ha(p,0,I[0]),v=ha(f,0,I[1]),x=ha(p,I[0],I[2]),P=ha(f,I[1],I[3]),w=I[0]-b,F=I[1]-v,T=I[2]-I[0]-x,E=I[3]-I[1]-P}let _=(I,k,V,A)=>{let z=da(I.stretch-b,x,u,t.left),O=ga(I.fixed-w,T,I.stretch,m),N=da(k.stretch-v,P,c,t.top),K=ga(k.fixed-F,E,k.stretch,h),xe=da(V.stretch-b,x,u,t.left),X=ga(V.fixed-w,T,V.stretch,m),le=da(A.stretch-v,P,c,t.top),ce=ga(A.fixed-F,E,A.stretch,h),pe=new we.default(z,N),_e=new we.default(xe,N),be=new we.default(xe,le),Ai=new we.default(z,le),Da=new we.default(O/a,K/a),Va=new we.default(X/a,ce/a),Ur=e*Math.PI/180;if(Ur){let Ie=Math.sin(Ur),ve=Math.cos(Ur),Ve=[ve,-Ie,Ie,ve];pe._matMult(Ve),_e._matMult(Ve),Ai._matMult(Ve),be._matMult(Ve)}let _i=I.stretch+I.fixed,Me=V.stretch+V.fixed,Ft=k.stretch+k.fixed,Ii=A.stretch+A.fixed,Ba={x:o.paddedRect.x+zr+_i,y:o.paddedRect.y+zr+Ft,w:Me-_i,h:Ii-Ft},za=T/a/u,Ra=E/a/c;return{tl:pe,tr:_e,bl:Ai,br:be,tex:Ba,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Da,pixelOffsetBR:Va,minFontScaleX:za,minFontScaleY:Ra,isSDF:r}};if(!n||!o.stretchX&&!o.stretchY)i.push(_({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));else{let I=zf(p,d,m),k=zf(f,g,h);for(let V=0;V<I.length-1;V++){let A=I[V],z=I[V+1];for(let O=0;O<k.length-1;O++){let N=k[O],K=k[O+1];i.push(_(A,N,z,K))}}}return i}function ha(t,e,r){let n=0;for(let i of t)n+=Math.max(e,Math.min(r,i[1]))-Math.max(e,Math.min(r,i[0]));return n}function zf(t,e,r){let n=[{fixed:-zr,stretch:0}];for(let[i,o]of t){let a=n[n.length-1];n.push({fixed:i-a.stretch,stretch:a.stretch}),n.push({fixed:i-a.stretch,stretch:a.stretch+(o-i)})}return n.push({fixed:e+zr,stretch:r}),n}function da(t,e,r,n){return t/e*r+n}function ga(t,e,r,n){return t-e*r/n}function Rf(t,e,r,n,i,o,a,s){let l=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(let c of e.positionedLines)for(let p of c.positionedGlyphs){if(!p.rect)continue;let f=p.rect||{},m=ra+1,h=!0,d=1,g=0,b=(i||s)&&p.vertical,x=p.metrics.advance*p.scale/2;if(s&&e.verticalizable){let X=(p.scale-1)*ne,le=(ne-p.metrics.width*p.scale)/2;g=c.lineOffset/2-(p.imageName?-le:X)}if(p.imageName){let X=a[p.imageName];h=X.sdf,d=X.pixelRatio,m=ge/d}let v=i?[p.x+x,p.y]:[0,0],P=i?[0,0]:[p.x+x+r[0],p.y+r[1]-g],w=[0,0];b&&(w=P,P=[0,0]);let T=p.metrics.isDoubleResolution?2:1,F=(p.metrics.left-m)*p.scale-x+P[0],E=(-p.metrics.top-m)*p.scale+P[1],_=F+f.w/T*p.scale/d,I=E+f.h/T*p.scale/d,k=new we.default(F,E),V=new we.default(_,E),A=new we.default(F,I),z=new we.default(_,I);if(b){let X=new we.default(-x,x-Dr),le=-Math.PI/2,ce=ne/2-x,pe=p.imageName?ce:0,_e=new we.default(5-Dr-ce,-pe),be=new we.default(...w);k._rotateAround(le,X)._add(_e)._add(be),V._rotateAround(le,X)._add(_e)._add(be),A._rotateAround(le,X)._add(_e)._add(be),z._rotateAround(le,X)._add(_e)._add(be)}if(l){let X=Math.sin(l),le=Math.cos(l),ce=[le,-X,X,le];k._matMult(ce),V._matMult(ce),A._matMult(ce),z._matMult(ce)}let O=new we.default(0,0),N=new we.default(0,0);u.push({tl:k,tr:V,bl:A,br:z,tex:f,writingMode:e.writingMode,glyphOffset:v,sectionIndex:p.sectionIndex,isSDF:h,pixelOffsetTL:O,pixelOffsetBR:N,minFontScaleX:0,minFontScaleY:0})}return u}var ci=Z(he(),1),or=class{constructor(e,r,n,i,o,a,s,l,u,c){if(this.boxStartIndex=e.length,u){let p=a.top,f=a.bottom,y=a.collisionPadding;y&&(p-=y[1],f+=y[3]);let m=f-p;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{let p=a.top*s-l[0],f=a.bottom*s+l[2],y=a.left*s-l[3],m=a.right*s+l[1],h=a.collisionPadding;if(h&&(y-=h[0]*s,p-=h[1]*s,m+=h[2]*s,f+=h[3]*s),c){let d=new ci.default(y,p),g=new ci.default(m,p),b=new ci.default(y,f),x=new ci.default(m,f),v=c*Math.PI/180;d._rotate(v),g._rotate(v),b._rotate(v),x._rotate(v),y=Math.min(d.x,g.x,b.x,x.x),m=Math.max(d.x,g.x,b.x,x.x),p=Math.min(d.y,g.y,b.y,x.y),f=Math.max(d.y,g.y,b.y,x.y)}e.emplaceBack(r.x,r.y,y,p,m,f,n,i,o)}this.boxEndIndex=e.length}};var pi=class{constructor(e=[],r=Mb){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:r,compare:n}=this,i=r[e];for(;e>0;){let o=e-1>>1,a=r[o];if(n(i,a)>=0)break;r[e]=a,e=o}r[e]=i}_down(e){let{data:r,compare:n}=this,i=this.length>>1,o=r[e];for(;e<i;){let a=(e<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[e]=s,e=a}r[e]=o}};function Mb(t,e){return t<e?-1:t>e?1:0}var il=Z(he(),1);function Of(t,e=1,r=!1){let n=1/0,i=1/0,o=-1/0,a=-1/0,s=t[0];for(let h=0;h<s.length;h++){let d=s[h];(!h||d.x<n)&&(n=d.x),(!h||d.y<i)&&(i=d.y),(!h||d.x>o)&&(o=d.x),(!h||d.y>a)&&(a=d.y)}let l=o-n,u=a-i,c=Math.min(l,u),p=c/2,f=new pi([],Eb);if(c===0)return new il.default(n,i);for(let h=n;h<o;h+=c)for(let d=i;d<a;d+=c)f.push(new Rr(h+p,d+p,p,t));let y=Lb(t),m=f.length;for(;f.length;){let h=f.pop();(h.d>y.d||!y.d)&&(y=h,r&&console.log("found best %d after %d probes",Math.round(1e4*h.d)/1e4,m)),!(h.max-y.d<=e)&&(p=h.h/2,f.push(new Rr(h.p.x-p,h.p.y-p,p,t)),f.push(new Rr(h.p.x+p,h.p.y-p,p,t)),f.push(new Rr(h.p.x-p,h.p.y+p,p,t)),f.push(new Rr(h.p.x+p,h.p.y+p,p,t)),m+=4)}return r&&(console.log("num probes: ".concat(m)),console.log("best distance: ".concat(y.d))),y.p}function Eb(t,e){return e.max-t.max}function Rr(t,e,r,n){this.p=new il.default(t,e),this.h=r,this.d=Fb(this.p,n),this.max=this.d+this.h*Math.SQRT2}function Fb(t,e){let r=!1,n=1/0;for(let i=0;i<e.length;i++){let o=e[i];for(let a=0,s=o.length,l=s-1;a<s;l=a++){let u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,Vs(t,u,c))}}return(r?1:-1)*Math.sqrt(n)}function Lb(t){let e=0,r=0,n=0,i=t[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){let l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,e+=c*3}return new Rr(r/e,n/e,0,t)}var ll=Z(ks(),1);var ol=(o=>(o[o.center=1]="center",o[o.left=2]="left",o[o.right=3]="right",o[o.top=4]="top",o[o.bottom=5]="bottom",o[o["top-left"]=6]="top-left",o[o["top-right"]=7]="top-right",o[o["bottom-left"]=8]="bottom-left",o[o["bottom-right"]=9]="bottom-right",o))(ol||{}),kt=7,xa=Number.POSITIVE_INFINITY;function al(t,e){function r(i,o){let a=0,s=0;o<0&&(o=0);let l=o/Math.SQRT2;switch(i){case"top-right":case"top-left":s=l-kt;break;case"bottom-right":case"bottom-left":s=-l+kt;break;case"bottom":s=-o+kt;break;case"top":s=o-kt;break}switch(i){case"top-right":case"bottom-right":a=-l;break;case"top-left":case"bottom-left":a=l;break;case"left":a=o;break;case"right":a=-o;break}return[a,s]}function n(i,o,a){let s=0,l=0;switch(o=Math.abs(o),a=Math.abs(a),i){case"top-right":case"top-left":case"top":l=a-kt;break;case"bottom-right":case"bottom-left":case"bottom":l=-a+kt;break}switch(i){case"top-right":case"bottom-right":case"right":s=-o;break;case"top-left":case"bottom-left":case"left":s=o;break}return[s,l]}return e[1]!==xa?n(t,e[0],e[1]):r(t,e[0])}function sl(t,e,r){var a;let n=t.layout,i=(a=n.get("text-variable-anchor-offset"))==null?void 0:a.evaluate(e,{},r);if(i){let s=i.values,l=[];for(let u=0;u<s.length;u+=2){let c=l[u]=s[u],p=s[u+1].map(f=>f*ne);c.startsWith("top")?p[1]-=kt:c.startsWith("bottom")&&(p[1]+=kt),l[u+1]=p}return new Ne(l)}let o=n.get("text-variable-anchor");if(o){let s;t._unevaluatedLayout.getValue("text-radial-offset")!==void 0?s=[n.get("text-radial-offset").evaluate(e,{},r)*ne,xa]:s=n.get("text-offset").evaluate(e,{},r).map(c=>c*ne);let u=[];for(let c of o)u.push(c,al(c,s));return new Ne(u)}return null}function $f(t){t.bucket.createArrays();let e=512*t.bucket.overscaling;t.bucket.tilePixelRatio=8192/e,t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;let r=t.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,o={layoutIconSize:i["icon-size"].possiblyEvaluate(new q(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new q(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new q(18))};if(t.bucket.textSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.textSizeData;o.compositeTextSizes=[i["text-size"].possiblyEvaluate(new q(c),t.canonical),i["text-size"].possiblyEvaluate(new q(p),t.canonical)]}if(t.bucket.iconSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=t.bucket.iconSizeData;o.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new q(c),t.canonical),i["icon-size"].possiblyEvaluate(new q(p),t.canonical)]}let a=n.get("text-line-height")*ne,s=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",l=n.get("text-keep-upright"),u=n.get("text-size");for(let c of t.bucket.features){let p=n.get("text-font").evaluate(c,{},t.canonical).join(","),f=u.evaluate(c,{},t.canonical),y=o.layoutTextSize.evaluate(c,{},t.canonical),m=o.layoutIconSize.evaluate(c,{},t.canonical),h={horizontal:{},vertical:void 0},d=c.text,g=[0,0];if(d){let P=d.toString(),w=n.get("text-letter-spacing").evaluate(c,{},t.canonical)*ne,T=Pc(P)?w:0,F=n.get("text-anchor").evaluate(c,{},t.canonical),E=sl(r,c,t.canonical);if(!E){let A=n.get("text-radial-offset").evaluate(c,{},t.canonical);A?g=al(F,[A*ne,xa]):g=n.get("text-offset").evaluate(c,{},t.canonical).map(z=>z*ne)}let _=s?"center":n.get("text-justify").evaluate(c,{},t.canonical),I=n.get("symbol-placement"),k=I==="point"?n.get("text-max-width").evaluate(c,{},t.canonical)*ne:0,V=()=>{t.bucket.allowVerticalPlacement&&hn(P)&&(h.vertical=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,"left",T,g,2,!0,I,y,f))};if(!s&&E){let A=new Set;if(_==="auto")for(let O=0;O<E.values.length;O+=2)A.add(Nf(E.values[O]));else A.add(_);let z=!1;for(let O of A)if(!h.horizontal[O])if(z)h.horizontal[O]=h.horizontal[0];else{let N=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,"center",O,T,g,1,!1,I,y,f);N&&(h.horizontal[O]=N,z=N.positionedLines.length===1)}V()}else{_==="auto"&&(_=Nf(F));let A=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,_,T,g,1,!1,I,y,f);A&&(h.horizontal[_]=A),V(),hn(P)&&s&&l&&(h.vertical=ii(d,t.glyphMap,t.glyphPositions,t.imagePositions,p,k,a,F,_,T,g,2,!1,I,y,f))}}let b,x=!1;if(c.icon&&c.icon.name){let P=t.imageMap[c.icon.name];P&&(b=yf(t.imagePositions[c.icon.name],n.get("icon-offset").evaluate(c,{},t.canonical),n.get("icon-anchor").evaluate(c,{},t.canonical)),x=!!P.sdf,t.bucket.sdfIcons===void 0?t.bucket.sdfIcons=x:t.bucket.sdfIcons!==x&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(P.pixelRatio!==t.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(t.bucket.iconsNeedLinear=!0))}let v=Gf(h.horizontal)||h.vertical;t.bucket.iconsInText=v?v.iconsInText:!1,(v||b)&&Db(t.bucket,c,h,b,t.imageMap,o,y,m,g,x,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()}function Nf(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Db(t,e,r,n,i,o,a,s,l,u,c){let p=o.textMaxSize.evaluate(e,{});p===void 0&&(p=a);let f=t.layers[0].layout,y=f.get("icon-offset").evaluate(e,{},c),m=Gf(r.horizontal),h=24,d=a/h,g=t.tilePixelRatio*d,b=t.tilePixelRatio*p/h,x=t.tilePixelRatio*s,v=t.tilePixelRatio*f.get("symbol-spacing"),P=f.get("text-padding")*t.tilePixelRatio,w=bf(f,e,c,t.tilePixelRatio),T=f.get("text-max-angle")/180*Math.PI,F=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",E=f.get("icon-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point",_=f.get("symbol-placement"),I=v/2,k=f.get("icon-text-fit"),V;n&&k!=="none"&&(t.allowVerticalPlacement&&r.vertical&&(V=Qs(n,r.vertical,k,f.get("icon-text-fit-padding"),y,d)),m&&(n=Qs(n,m,k,f.get("icon-text-fit-padding"),y,d)));let A=(z,O)=>{O.x<0||O.x>=8192||O.y<0||O.y>=8192||Bb(t,O,z,r,n,i,V,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,g,[P,P,P,P],F,l,x,w,E,y,e,o,u,c,a)};if(_==="line")for(let z of Bf(e.geometry,0,0,8192,8192)){let O=Df(z,v,T,r.vertical||m,n,h,b,t.overscaling,8192);for(let N of O){let K=m;(!K||!zb(t,K.text,I,N))&&A(z,N)}}else if(_==="line-center"){for(let z of e.geometry)if(z.length>1){let O=Lf(z,T,r.vertical||m,n,h,b);O&&A(z,O)}}else if(e.type==="Polygon")for(let z of Tr(e.geometry,0)){let O=Of(z,16);A(z[0],new rt(O.x,O.y,0))}else if(e.type==="LineString")for(let z of e.geometry)A(z,new rt(z[0].x,z[0].y,0));else if(e.type==="Point")for(let z of e.geometry)for(let O of z)A([O],new rt(O.x,O.y,0))}function Vb(t,e){let r=t.length,n=e==null?void 0:e.values;if((n==null?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){let o=ol[n[i]],a=n[i+1];t.emplaceBack(o,a[0],a[1])}return[r,t.length]}function Uf(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=Rf(e,r,s,i,o,a,n,t.allowVerticalPlacement),d=t.textSizeData,g=null;d.kind==="source"?(g=[Ct*i.layout.get("text-size").evaluate(a,{})],g[0]>tt&&fe("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Vr,'. Reduce your "text-size".'))):d.kind==="composite"&&(g=[Ct*y.compositeTextSizes[0].evaluate(a,{},m),Ct*y.compositeTextSizes[1].evaluate(a,{},m)],(g[0]>tt||g[1]>tt)&&fe("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(Vr,'. Reduce your "text-size".'))),t.addSymbols(t.text,h,g,s,o,a,u,e,l.lineStartIndex,l.lineLength,f,m);for(let b of c)p[b]=t.text.placedSymbolArray.length-1;return h.length*4}function Gf(t){for(let e in t)return t[e];return null}function Bb(t,e,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F){let E=t.addToLineVertexArray(e,r),_,I,k,V,A=0,z=0,O=0,N=0,K=-1,xe=-1,X={},le=(0,ll.default)("");if(t.allowVerticalPlacement&&n.vertical){let ve=s.layout.get("text-rotate").evaluate(v,{},T)+90,Ve=n.vertical;k=new or(l,e,u,c,p,Ve,f,y,m,ve),a&&(V=new or(l,e,u,c,p,a,d,g,m,ve))}if(i){let Ie=s.layout.get("icon-rotate").evaluate(v,{}),ve=s.layout.get("icon-text-fit")!=="none",Ve=nl(i,Ie,w,ve),$r=a?nl(a,Ie,w,ve):void 0;I=new or(l,e,u,c,p,i,d,g,!1,Ie),A=Ve.length*4;let Vl=t.iconSizeData,Lt=null;Vl.kind==="source"?(Lt=[Ct*s.layout.get("icon-size").evaluate(v,{})],Lt[0]>tt&&fe("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Vr,'. Reduce your "icon-size".'))):Vl.kind==="composite"&&(Lt=[Ct*P.compositeIconSizes[0].evaluate(v,{},T),Ct*P.compositeIconSizes[1].evaluate(v,{},T)],(Lt[0]>tt||Lt[1]>tt)&&fe("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(Vr,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,Ve,Lt,x,b,v,0,e,E.lineStartIndex,E.lineLength,-1,T),K=t.icon.placedSymbolArray.length-1,$r&&(z=$r.length*4,t.addSymbols(t.icon,$r,Lt,x,b,v,2,e,E.lineStartIndex,E.lineLength,-1,T),xe=t.icon.placedSymbolArray.length-1)}let ce=Object.keys(n.horizontal);for(let Ie of ce){let ve=n.horizontal[Ie];if(!_){le=(0,ll.default)(ve.text);let $r=s.layout.get("text-rotate").evaluate(v,{},T);_=new or(l,e,u,c,p,ve,f,y,m,$r)}let Ve=ve.positionedLines.length===1;if(O+=Uf(t,e,ve,o,s,m,v,h,E,n.vertical?1:3,Ve?ce:[Ie],X,K,P,T),Ve)break}n.vertical&&(N+=Uf(t,e,n.vertical,o,s,m,v,h,E,2,["vertical"],X,xe,P,T));let pe=_?_.boxStartIndex:t.collisionBoxArray.length,_e=_?_.boxEndIndex:t.collisionBoxArray.length,be=k?k.boxStartIndex:t.collisionBoxArray.length,Ai=k?k.boxEndIndex:t.collisionBoxArray.length,Da=I?I.boxStartIndex:t.collisionBoxArray.length,Va=I?I.boxEndIndex:t.collisionBoxArray.length,Ur=V?V.boxStartIndex:t.collisionBoxArray.length,_i=V?V.boxEndIndex:t.collisionBoxArray.length,Me=-1,Ft=(Ie,ve)=>Ie&&Ie.circleDiameter?Math.max(Ie.circleDiameter,ve):ve;Me=Ft(_,Me),Me=Ft(k,Me),Me=Ft(I,Me),Me=Ft(V,Me);let Ii=Me>-1?1:0;Ii&&(Me*=F/ne),t.glyphOffsetArray.length>=He.MAX_GLYPHS&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),v.sortKey!==void 0&&t.addToSortKeyRanges(t.symbolInstances.length,v.sortKey);let Ba=sl(s,v,T),[za,Ra]=Vb(t.textAnchorOffsets,Ba);t.symbolInstances.emplaceBack(e.x,e.y,X.right>=0?X.right:-1,X.center>=0?X.center:-1,X.left>=0?X.left:-1,X.vertical||-1,K,xe,le,pe,_e,be,Ai,Da,Va,Ur,_i,u,O,N,A,z,Ii,0,f,Me,za,Ra)}function zb(t,e,r,n){let i=t.compareText;if(!(e in i))i[e]=[];else{let o=i[e];for(let a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}return i[e].push(n),!1}var ba=1,fi=class{constructor(e){let r={},n=[];for(let s in e){let l=e[s],u=r[s]={};for(let c in l){let p=l[+c];if(!p||p.bitmap.width===0||p.bitmap.height===0)continue;let f={x:0,y:0,w:p.bitmap.width+2*ba,h:p.bitmap.height+2*ba};n.push(f),u[c]={rect:f,metrics:p.metrics}}}let{w:i,h:o}=ti(n),a=new er({width:i||1,height:o||1});for(let s in e){let l=e[s];for(let u in l){let c=l[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0)continue;let p=r[s][u].rect;er.copy(c.bitmap,a,{x:0,y:0},{x:p.x+ba,y:p.y+ba},c.bitmap)}}this.image=a,this.positions=r}};C("GlyphAtlas",fi);function jf(t,e,r){e=Math.pow(2,r)-e-1;var n=qf(t*256,e*256,r),i=qf((t+1)*256,(e+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function qf(t,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=t*n-2*Math.PI*6378137/2,o=e*n-2*Math.PI*6378137/2;return[i,o]}var Wf=Z(he(),1);var ul=63710088e-1,yi=class t{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new t(Hl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,n=this.lat*r,i=e.lat*r,o=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*r);return ul*Math.acos(Math.min(o,1))}static convert(e){if(e instanceof t)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new t(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("\`LngLatLike\` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var Jf=2*Math.PI*ul;function Zf(t){return Jf*Math.cos(t*Math.PI/180)}function Rb(t){return(180+t)/360}function Ob(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Nb(t,e){return t/Zf(e)}function Ub(t){return t*360-180}function cl(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function $b(t,e){return t*Zf(cl(e))}function Gb(t){return 1/Math.cos(t*Math.PI/180)}var va=class t{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){let n=yi.convert(e);return new t(Rb(n.lng),Ob(n.lat),Nb(r,n.lat))}toLngLat(){return new yi(Ub(this.x),cl(this.y))}toAltitude(){return $b(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Jf*Gb(cl(this.y))}};var Pa=class{constructor(e,r,n){if(e<0||e>25||n<0||n>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error("x=".concat(r,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=r,this.y=n,this.key=mi(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,n){let i=jf(this.x,this.y,this.z),o=qb(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,o).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new Wf.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}},pl=class{constructor(e,r){this.wrap=e,this.canonical=r,this.key=mi(e,r.z,r.z,r.x,r.y)}},hi=class t{constructor(e,r,n,i,o){if(e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=r,this.canonical=new Pa(n,+i,+o),this.key=mi(r,e,n,i,o)}clone(){return new t(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new t(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new t(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let n=this.canonical.z-e;return e>this.canonical.z?mi(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):mi(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new t(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new t(r,this.wrap,r,n,i),new t(r,this.wrap,r,n+1,i),new t(r,this.wrap,r,n,i+1),new t(r,this.wrap,r,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new t(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new t(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new pl(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new va(e.x-this.wrap,e.y))}};function mi(t,e,r,n,i){t*=2,t<0&&(t=t*-1-1);let o=1<<r;return(o*o*t+o*i+n).toString(36)+r.toString(36)+e.toString(36)}function qb(t,e,r){let n="",i;for(let o=t;o>0;o--)i=1<<o-1,n+=(e&i?1:0)+(r&i?2:0);return n}C("CanonicalTileID",Pa);C("OverscaledTileID",hi,{omit:["posMatrix"]});var Sa=class{constructor(e){this.tileID=new hi(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[]}async parse(e,r,n,i){this.status="parsing",this.data=e,this.collisionBoxArray=new Ln;let o=new Br(Object.keys(e.layers).sort()),a=new ui(this.tileID,this.promoteId);a.bucketLayerIDs=[];let s={},l={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},u=r.familiesBySource[this.source];for(let P in u){let w=e.layers[P];if(!w)continue;w.version===1&&fe('Vector tile source "'.concat(this.source,'" layer "').concat(P,'" ')+"does not use vector tile spec v2 and therefore may have some rendering errors.");let T=o.encode(P),F=[];for(let E=0;E<w.length;E++){let _=w.feature(E),I=a.getId(_,P);F.push({feature:_,id:I,index:E,sourceLayerIndex:T})}for(let E of u[P]){let _=E[0];if(_.source!==this.source&&fe("layer.source = ".concat(_.source," does not equal this.source = ").concat(this.source)),_.minzoom&&this.zoom<Math.floor(_.minzoom)||_.maxzoom&&this.zoom>=_.maxzoom||_.visibility==="none")continue;fl(E,this.zoom,n),(s[_.id]=_.createBucket({index:a.bucketLayerIDs.length,layers:E,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:T,sourceID:this.source})).populate(F,l,this.tileID.canonical),a.bucketLayerIDs.push(E.map(k=>k.id))}}let c=jr(l.glyphDependencies,P=>Object.keys(P).map(Number));this.inFlightDependencies.forEach(P=>P==null?void 0:P.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(c).length){let P=new AbortController;this.inFlightDependencies.push(P),p=i.sendAsync({type:"GG",data:{stacks:c,source:this.source,tileID:this.tileID,type:"glyphs"}},P)}let f=Object.keys(l.iconDependencies),y=Promise.resolve({});if(f.length){let P=new AbortController;this.inFlightDependencies.push(P),y=i.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},P)}let m=Object.keys(l.patternDependencies),h=Promise.resolve({});if(m.length){let P=new AbortController;this.inFlightDependencies.push(P),h=i.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"patterns"}},P)}let[d,g,b]=await Promise.all([p,y,h]),x=new fi(d),v=new ri(g,b);for(let P in s){let w=s[P];w instanceof He?(fl(w.layers,this.zoom,n),$f({bucket:w,glyphMap:d,glyphPositions:x.positions,imageMap:g,imagePositions:v.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):w.hasPattern&&(w instanceof ir||w instanceof rr||w instanceof nr)&&(fl(w.layers,this.zoom,n),w.addFeatures(l,this.tileID.canonical,v.patternPositions))}return this.status="done",{buckets:Object.values(s).filter(P=>!P.isEmpty()),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:v,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?g:null,glyphPositions:this.returnDependencies?x.positions:null}}};function fl(t,e,r){let n=new q(e);for(let i of t)i.recalculate(n,r)}var jb=60,HI=1e3/jb;var Or=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return e.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}};var Nr=class{constructor(e,r,n){this.actor=e,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}async loadVectorTile(e,r){let n=await hc(e.request,r);try{return{vectorTile:new Hf.default.VectorTile(new Xf.default(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){let o=new Uint8Array(n.data),a=o[0]===31&&o[1]===139,s="Unable to parse the tile at ".concat(e.request.url,", ");throw a?s+="please make sure the data is not gzipped and that you have configured the relevant header in the server":s+="got error: ".concat(i.messge),new Error(s)}}async loadTile(e){let r=e.uid,n=e&&e.request&&e.request.collectResourceTiming?new Or(e.request):!1,i=new Sa(e);this.loading[r]=i;let o=new AbortController;i.abort=o;try{let a=await this.loadVectorTile(e,o);if(delete this.loading[r],!a)return null;let s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);let u={};if(n){let p=n.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}i.vectorTile=a.vectorTile;let c=i.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[r]=i,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{let p=await c;return Pe({rawTileData:s.slice(0)},p,l,u)}finally{delete this.fetching[r]}}catch(a){throw delete this.loading[r],i.status="done",this.loaded[r]=i,a}}async reloadTile(e){let r=e.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let n=this.loaded[r];if(n.showCollisionBoxes=e.showCollisionBoxes,n.status==="parsing"){let i=await n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor),o;if(this.fetching[r]){let{rawTileData:a,cacheControl:s,resourceTiming:l}=this.fetching[r];delete this.fetching[r],o=Pe({rawTileData:a.slice(0)},i,s,l)}else o=i;return o}if(n.status==="done"&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor)}async abortTile(e){let r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort.abort(),delete r[n])}async removeTile(e){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]}};var di=class{constructor(e,r,n,i=1,o=1,a=1,s=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){fe('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=o,this.blueFactor=a,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(e,r){let n=new Uint8Array(this.data.buffer),i=this._idx(e,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,n){return e*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new de({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,o=r*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=o-1;break;case 1:o=i+1;break}switch(n){case-1:a=s-1;break;case 1:s=a+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=a;c<s;c++)for(let p=i;p<o;p++)this.data[this._idx(p,c)]=e.data[this._idx(p+l,c+u)]}};C("DEMData",di);var wa=class{constructor(){this.loaded={}}async loadTile(e){let{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=e,u=i.width+2,c=i.height+2,p=Jr(i)?new de({width:u,height:c},await eu(i,-1,-1,u,c)):i,f=new di(r,p,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=f,f}removeTile(e){let r=this.loaded,n=e.uid;r&&r[n]&&delete r[n]}};var wy=Z(ey(),1);var yl=Z(he(),1),ty=Z(Tt(),1);var Jb=ty.default.VectorTileFeature.prototype.toGeoJSON,ml=class{constructor(e){this._feature=e,this.extent=8192,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(this._feature.type===1){let e=[];for(let r of this._feature.geometry)e.push([new yl.default(r[0],r[1])]);return e}else{let e=[];for(let r of this._feature.geometry){let n=[];for(let i of r)n.push(new yl.default(i[0],i[1]));e.push(n)}return e}}toGeoJSON(e,r,n){return Jb.call(this,e,r,n)}},_a=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=e.length,this._features=e}feature(e){return new ml(this._features[e])}};var Ay=Z(sy(),1);var ly=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],gl=1,xi=8,vi=class t{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==gl)throw new Error("Got v".concat(i," data when expected v").concat(gl,"."));let o=ly[n&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new t(s,a,o,e)}constructor(e,r=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let o=ly.indexOf(this.ArrayType),a=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(n,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,xi,e),this.coords=new this.ArrayType(this.data,xi+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(xi+a+s+l),this.ids=new this.IndexArrayType(this.data,xi,e),this.coords=new this.ArrayType(this.data,xi+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(gl<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=r,n}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return bl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:a,nodeSize:s}=this,l=[0,o.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,f=l.pop()||0;if(p-f<=s){for(let d=f;d<=p;d++){let g=a[2*d],b=a[2*d+1];g>=e&&g<=n&&b>=r&&b<=i&&u.push(o[d])}continue}let y=f+p>>1,m=a[2*y],h=a[2*y+1];m>=e&&m<=n&&h>=r&&h<=i&&u.push(o[y]),(c===0?e<=m:r<=h)&&(l.push(f),l.push(y-1),l.push(1-c)),(c===0?n>=m:i>=h)&&(l.push(y+1),l.push(p),l.push(1-c))}return u}within(e,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,f=s.pop()||0;if(p-f<=a){for(let d=f;d<=p;d++)uy(o[2*d],o[2*d+1],e,r)<=u&&l.push(i[d]);continue}let y=f+p>>1,m=o[2*y],h=o[2*y+1];uy(m,h,e,r)<=u&&l.push(i[y]),(c===0?e-n<=m:r-n<=h)&&(s.push(f),s.push(y-1),s.push(1-c)),(c===0?e+n>=m:r+n>=h)&&(s.push(y+1),s.push(p),s.push(1-c))}return l}};function bl(t,e,r,n,i,o){if(i-n<=r)return;let a=n+i>>1;cy(t,e,a,n,i,o),bl(t,e,r,n,a-1,1-o),bl(t,e,r,a+1,i,1-o)}function cy(t,e,r,n,i,o){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),y=.5*Math.sqrt(p*f*(u-f)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*f/u+y)),h=Math.min(i,Math.floor(r+(u-c)*f/u+y));cy(t,e,r,m,h,o)}let a=e[2*r+o],s=n,l=i;for(bi(t,e,n,r),e[2*i+o]>a&&bi(t,e,n,i);s<l;){for(bi(t,e,s,l),s++,l--;e[2*s+o]<a;)s++;for(;e[2*l+o]>a;)l--}e[2*n+o]===a?bi(t,e,n,l):(l++,bi(t,e,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function bi(t,e,r,n){xl(t,r,n),xl(e,2*r,2*n),xl(e,2*r+1,2*n+1)}function xl(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function uy(t,e,r,n){let i=t-r,o=e-n;return i*i+o*o}var n0={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},py=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),ar=2,Et=3,vl=4,Mt=5,yy=6,Pi=class{constructor(e){this.options=Object.assign(Object.create(n0),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){let{log:r,minZoom:n,maxZoom:i}=this.options;r&&console.time("total time");let o="prepare ".concat(e.length," points");r&&console.time(o),this.points=e;let a=[];for(let l=0;l<e.length;l++){let u=e[l];if(!u.geometry)continue;let[c,p]=u.geometry.coordinates,f=py(Ta(c)),y=py(Ca(p));a.push(f,y,1/0,l,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);r&&console.timeEnd(o);for(let l=i;l>=n;l--){let u=+Date.now();s=this.trees[l]=this._createTree(this._cluster(s,l)),r&&console.log("z%d: %d clusters in %dms",l,s.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(e,r){let n=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),o=e[2]===180?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,o=180;else if(n>o){let p=this.getClusters([n,i,180,a],r),f=this.getClusters([-180,i,o,a],r);return p.concat(f)}let s=this.trees[this._limitZoom(r)],l=s.range(Ta(n),Ca(a),Ta(o),Ca(i)),u=s.data,c=[];for(let p of l){let f=this.stride*p;c.push(u[f+Mt]>1?fy(u,f,this.clusterProps):this.points[u[f+Et]])}return c}getChildren(e){let r=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);let a=o.data;if(r*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=a[r*this.stride],u=a[r*this.stride+1],c=o.within(l,u,s),p=[];for(let f of c){let y=f*this.stride;a[y+vl]===e&&p.push(a[y+Mt]>1?fy(a,y,this.clusterProps):this.points[a[y+Et]])}if(p.length===0)throw new Error(i);return p}getLeaves(e,r,n){r=r||10,n=n||0;let i=[];return this._appendLeaves(i,e,r,n,0),i}getTile(e,r,n){let i=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:a,radius:s}=this.options,l=s/a,u=(n-l)/o,c=(n+1+l)/o,p={features:[]};return this._addTileFeatures(i.range((r-l)/o,u,(r+1+l)/o,c),i.data,r,n,o,p),r===0&&this._addTileFeatures(i.range(1-l/o,u,1,c),i.data,o,n,o,p),r===o-1&&this._addTileFeatures(i.range(0,u,l/o,c),i.data,-1,n,o,p),p.features.length?p:null}getClusterExpansionZoom(e){let r=this._getOriginZoom(e)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(e);if(r++,n.length!==1)break;e=n[0].properties.cluster_id}return r}_appendLeaves(e,r,n,i,o){let a=this.getChildren(r);for(let s of a){let l=s.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(e,l.cluster_id,n,i,o):o<i?o++:e.push(s),e.length===n)break}return o}_createTree(e){let r=new vi(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)r.add(e[n],e[n+1]);return r.finish(),r.data=e,r}_addTileFeatures(e,r,n,i,o,a){for(let s of e){let l=s*this.stride,u=r[l+Mt]>1,c,p,f;if(u)c=my(r,l,this.clusterProps),p=r[l],f=r[l+1];else{let h=this.points[r[l+Et]];c=h.properties;let[d,g]=h.geometry.coordinates;p=Ta(d),f=Ca(g)}let y={type:1,geometry:[[Math.round(this.options.extent*(p*o-n)),Math.round(this.options.extent*(f*o-i))]],tags:c},m;u||this.options.generateId?m=r[l+Et]:m=this.points[r[l+Et]].id,m!==void 0&&(y.id=m),a.features.push(y)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){let{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,r)),l=e.data,u=[],c=this.stride;for(let p=0;p<l.length;p+=c){if(l[p+ar]<=r)continue;l[p+ar]=r;let f=l[p],y=l[p+1],m=e.within(l[p],l[p+1],s),h=l[p+Mt],d=h;for(let g of m){let b=g*c;l[b+ar]>r&&(d+=l[b+Mt])}if(d>h&&d>=a){let g=f*h,b=y*h,x,v=-1,P=((p/c|0)<<5)+(r+1)+this.points.length;for(let w of m){let T=w*c;if(l[T+ar]<=r)continue;l[T+ar]=r;let F=l[T+Mt];g+=l[T]*F,b+=l[T+1]*F,l[T+vl]=P,o&&(x||(x=this._map(l,p,!0),v=this.clusterProps.length,this.clusterProps.push(x)),o(x,this._map(l,T)))}l[p+vl]=P,u.push(g/d,b/d,1/0,P,-1,d),o&&u.push(v)}else{for(let g=0;g<c;g++)u.push(l[p+g]);if(d>1)for(let g of m){let b=g*c;if(!(l[b+ar]<=r)){l[b+ar]=r;for(let x=0;x<c;x++)u.push(l[b+x])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,r,n){if(e[r+Mt]>1){let a=this.clusterProps[e[r+yy]];return n?Object.assign({},a):a}let i=this.points[e[r+Et]].properties,o=this.options.map(i);return n&&o===i?Object.assign({},o):o}};function fy(t,e,r){return{type:"Feature",id:t[e+Et],properties:my(t,e,r),geometry:{type:"Point",coordinates:[i0(t[e]),o0(t[e+1])]}}}function my(t,e,r){let n=t[e+Mt],i=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?"".concat(Math.round(n/100)/10,"k"):n,o=t[e+yy],a=o===-1?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:t[e+Et],point_count:n,point_count_abbreviated:i})}function Ta(t){return t/360+.5}function Ca(t){let e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function i0(t){return(t-.5)*360}function o0(t){let e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function Si(t,e,r,n){for(var i=n,o=r-e>>1,a=r-e,s,l=t[e],u=t[e+1],c=t[r],p=t[r+1],f=e+3;f<r;f+=3){var y=a0(t[f],t[f+1],l,u,c,p);if(y>i)s=f,i=y;else if(y===i){var m=Math.abs(f-o);m<a&&(s=f,a=m)}}i>n&&(s-e>3&&Si(t,e,s,n),t[s+2]=i,r-s>3&&Si(t,s,r,n))}function a0(t,e,r,n,i,o){var a=i-r,s=o-n;if(a!==0||s!==0){var l=((t-r)*a+(e-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=t-r,s=e-n,a*a+s*s}function ft(t,e,r,n){var i={id:typeof t>"u"?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return s0(i),i}function s0(t){var e=t.geometry,r=t.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")Pl(t,e);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<e.length;n++)Pl(t,e[n]);else if(r==="MultiPolygon")for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)Pl(t,e[n][i])}function Pl(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Al(t,e){var r=[];if(t.type==="FeatureCollection")for(var n=0;n<t.features.length;n++)ka(r,t.features[n],e,n);else t.type==="Feature"?ka(r,t,e):ka(r,{geometry:t},e);return r}function ka(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=n||0),o==="Point")hy(i,s);else if(o==="MultiPoint")for(var u=0;u<i.length;u++)hy(i[u],s);else if(o==="LineString")wl(i,s,a,!1);else if(o==="MultiLineString")if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],wl(i[u],s,a,!1),t.push(ft(l,"LineString",s,e.properties));return}else Sl(i,s,a,!1);else if(o==="Polygon")Sl(i,s,a,!0);else if(o==="MultiPolygon")for(u=0;u<i.length;u++){var c=[];Sl(i[u],c,a,!0),s.push(c)}else if(o==="GeometryCollection"){for(u=0;u<e.geometry.geometries.length;u++)ka(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");t.push(ft(l,o,s,e.properties))}}function hy(t,e){e.push(dy(t[0])),e.push(gy(t[1])),e.push(0)}function wl(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var l=dy(t[s][0]),u=gy(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(n?a+=(i*u-l*o)/2:a+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,Si(e,0,c,r),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Sl(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];wl(t[i],o,r,n),e.push(o)}}function dy(t){return t/360+.5}function gy(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function qe(t,e,r,n,i,o,a,s){if(r/=e,n/=e,o>=r&&a<n)return t;if(a<r||o>=n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,f=c.type,y=i===0?c.minX:c.minY,m=i===0?c.maxX:c.maxY;if(y>=r&&m<n){l.push(c);continue}else if(m<r||y>=n)continue;var h=[];if(f==="Point"||f==="MultiPoint")l0(p,h,r,n,i);else if(f==="LineString")by(p,h,r,n,i,!1,s.lineMetrics);else if(f==="MultiLineString")_l(p,h,r,n,i,!1);else if(f==="Polygon")_l(p,h,r,n,i,!0);else if(f==="MultiPolygon")for(var d=0;d<p.length;d++){var g=[];_l(p[d],g,r,n,i,!0),g.length&&h.push(g)}if(h.length){if(s.lineMetrics&&f==="LineString"){for(d=0;d<h.length;d++)l.push(ft(c.id,f,h[d],c.tags));continue}(f==="LineString"||f==="MultiLineString")&&(h.length===1?(f="LineString",h=h[0]):f="MultiLineString"),(f==="Point"||f==="MultiPoint")&&(f=h.length===3?"Point":"MultiPoint"),l.push(ft(c.id,f,h,c.tags))}}return l.length?l:null}function l0(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=r&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function by(t,e,r,n,i,o,a){for(var s=xy(t),l=i===0?u0:c0,u=t.start,c,p,f=0;f<t.length-3;f+=3){var y=t[f],m=t[f+1],h=t[f+2],d=t[f+3],g=t[f+4],b=i===0?y:m,x=i===0?d:g,v=!1;a&&(c=Math.sqrt(Math.pow(y-d,2)+Math.pow(m-g,2))),b<r?x>r&&(p=l(s,y,m,d,g,r),a&&(s.start=u+c*p)):b>n?x<n&&(p=l(s,y,m,d,g,n),a&&(s.start=u+c*p)):Il(s,y,m,h),x<r&&b>=r&&(p=l(s,y,m,d,g,r),v=!0),x>n&&b<=n&&(p=l(s,y,m,d,g,n),v=!0),!o&&v&&(a&&(s.end=u+c*p),e.push(s),s=xy(t)),a&&(u+=c)}var P=t.length-3;y=t[P],m=t[P+1],h=t[P+2],b=i===0?y:m,b>=r&&b<=n&&Il(s,y,m,h),P=s.length-3,o&&P>=3&&(s[P]!==s[0]||s[P+1]!==s[1])&&Il(s,s[0],s[1],s[2]),s.length&&e.push(s)}function xy(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function _l(t,e,r,n,i,o){for(var a=0;a<t.length;a++)by(t[a],e,r,n,i,o,!1)}function Il(t,e,r,n){t.push(e),t.push(r),t.push(n)}function u0(t,e,r,n,i,o){var a=(o-e)/(n-e);return t.push(o),t.push(r+(i-r)*a),t.push(1),a}function c0(t,e,r,n,i,o){var a=(o-r)/(i-r);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function Cl(t,e){var r=e.buffer/e.extent,n=t,i=qe(t,1,-1-r,r,0,-1,2,e),o=qe(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=qe(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=vy(i,1).concat(n)),o&&(n=n.concat(vy(o,-1)))),n}function vy(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n],o=i.type,a;if(o==="Point"||o==="MultiPoint"||o==="LineString")a=Tl(i.geometry,e);else if(o==="MultiLineString"||o==="Polygon"){a=[];for(var s=0;s<i.geometry.length;s++)a.push(Tl(i.geometry[s],e))}else if(o==="MultiPolygon")for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(Tl(i.geometry[s][u],e));a.push(l)}r.push(ft(i.id,o,a,i.tags))}return r}function Tl(t,e){var r=[];r.size=t.size,t.start!==void 0&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function Ma(t,e){if(t.transformed)return t;var r=1<<t.z,n=t.x,i=t.y,o,a,s;for(o=0;o<t.features.length;o++){var l=t.features[o],u=l.geometry,c=l.type;if(l.geometry=[],c===1)for(a=0;a<u.length;a+=2)l.geometry.push(Py(u[a],u[a+1],e,r,n,i));else for(a=0;a<u.length;a++){var p=[];for(s=0;s<u[a].length;s+=2)p.push(Py(u[a][s],u[a][s+1],e,r,n,i));l.geometry.push(p)}}return t.transformed=!0,t}function Py(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function Ml(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,p0(a,t[s],o,i);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,p=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function p0(t,e,r,n){var i=e.geometry,o=e.type,a=[];if(o==="Point"||o==="MultiPoint")for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if(o==="LineString")kl(a,i,t,r,!1,!1);else if(o==="MultiLineString"||o==="Polygon")for(s=0;s<i.length;s++)kl(a,i[s],t,r,o==="Polygon",s===0);else if(o==="MultiPolygon")for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)kl(a,u[s],t,r,!0,s===0)}if(a.length){var c=e.tags||null;if(o==="LineString"&&n.lineMetrics){c={};for(var p in e.tags)c[p]=e.tags[p];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:o==="Polygon"||o==="MultiPolygon"?3:o==="LineString"||o==="MultiLineString"?2:1,tags:c};e.id!==null&&(f.id=e.id),t.features.push(f)}}function kl(t,e,r,n,i,o){var a=n*n;if(n>0&&e.size<(i?a:n)){r.numPoints+=e.length/3;return}for(var s=[],l=0;l<e.length;l+=3)(n===0||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;i&&f0(s,o),t.push(s)}function f0(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(r>0===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}function Fl(t,e){return new Ea(t,e)}function Ea(t,e){e=this.options=y0(Object.create(this.options),e);var r=e.debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Al(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=Cl(n,e),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ea.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Ea.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,p=El(e,r,n),f=this.tiles[p];if(!f&&(u>1&&console.time("creation"),f=this.tiles[p]=Ml(t,e,r,n,l),this.tileCoords.push({z:e,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var y="z"+e;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(f.source=t,i){if(e===l.maxZoom||e===i)continue;var m=1<<i-e;if(r!==Math.floor(o/m)||n!==Math.floor(a/m))continue}else if(e===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,t.length!==0){u>1&&console.time("clipping");var h=.5*l.buffer/l.extent,d=.5-h,g=.5+h,b=1+h,x,v,P,w,T,F;x=v=P=w=null,T=qe(t,c,r-h,r+g,0,f.minX,f.maxX,l),F=qe(t,c,r+d,r+b,0,f.minX,f.maxX,l),t=null,T&&(x=qe(T,c,n-h,n+g,1,f.minY,f.maxY,l),v=qe(T,c,n+d,n+b,1,f.minY,f.maxY,l),T=null),F&&(P=qe(F,c,n-h,n+g,1,f.minY,f.maxY,l),w=qe(F,c,n+d,n+b,1,f.minY,f.maxY,l),F=null),u>1&&console.timeEnd("clipping"),s.push(x||[],e+1,r*2,n*2),s.push(v||[],e+1,r*2,n*2+1),s.push(P||[],e+1,r*2+1,n*2),s.push(w||[],e+1,r*2+1,n*2+1)}}};Ea.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t;e=(e%a+a)%a;var s=El(t,e,r);if(this.tiles[s])return Ma(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l=t,u=e,c=r,p;!p&&l>0;)l--,u=Math.floor(u/2),c=Math.floor(c/2),p=this.tiles[El(l,u,c)];return!p||!p.source?null:(o>1&&console.log("found parent tile z%d-%d-%d",l,u,c),o>1&&console.time("drilling down"),this.splitTile(p.source,l,u,c,t,e,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Ma(this.tiles[s],i):null)};function El(t,e,r){return((1<<t)*r+e)*32+t}function y0(t,e){for(var r in e)t[r]=e[r];return t}function wi(t,e){return e?t.properties[e]:t.id}function Ll(t,e){if(t==null)return!0;if(t.type==="Feature")return wi(t,e)!=null;if(t.type==="FeatureCollection"){let r=new Set;for(let n of t.features){let i=wi(n,e);if(i==null||r.has(i))return!1;r.add(i)}return!0}return!1}function Dl(t,e){let r=new Map;if(t!=null)if(t.type==="Feature")r.set(wi(t,e),t);else for(let n of t.features)r.set(wi(n,e),n);return r}function Sy(t,e,r){var n,i,o,a;if(e.removeAll&&t.clear(),e.remove)for(let s of e.remove)t.delete(s);if(e.add)for(let s of e.add){let l=wi(s,r);l!=null&&t.set(l,s)}if(e.update)for(let s of e.update){let l=t.get(s.id);if(l==null)continue;let u=s.newGeometry||s.removeAllProperties,c=!s.removeAllProperties&&(((n=s.removeProperties)==null?void 0:n.length)>0||((i=s.addOrUpdateProperties)==null?void 0:i.length)>0);if((u||c)&&(l=Dt({},l),t.set(s.id,l),c&&(l.properties=Dt({},l.properties))),s.newGeometry&&(l.geometry=s.newGeometry),s.removeAllProperties)l.properties={};else if(((o=s.removeProperties)==null?void 0:o.length)>0)for(let p of s.removeProperties)Object.prototype.hasOwnProperty.call(l.properties,p)&&delete l.properties[p];if(((a=s.addOrUpdateProperties)==null?void 0:a.length)>0)for(let{key:p,value:f}of s.addOrUpdateProperties)l.properties[p]=f}}var Fa=class extends Nr{constructor(){super(...arguments);this._dataUpdateable=new Map}async loadVectorTile(r,n){let i=r.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return null;let a=new _a(o.features),s=(0,Ay.default)(a);return(s.byteOffset!==0||s.byteLength!==s.buffer.byteLength)&&(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}}async loadData(r){var i;(i=this._pendingRequest)==null||i.abort();let n=r&&r.request&&r.request.collectResourceTiming?new Or(r.request):!1;this._pendingRequest=new AbortController;try{let o=await this.loadGeoJSON(r,this._pendingRequest);if(delete this._pendingRequest,typeof o!="object")throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if((0,wy.default)(o,!0),r.filter){let s=jt(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(s.result==="error")throw new Error(s.value.map(u=>"".concat(u.key,": ").concat(u.message)).join(", "));o={type:"FeatureCollection",features:o.features.filter(u=>s.value.evaluate({zoom:0},u))}}this._geoJSONIndex=r.cluster?new Pi(m0(r)).load(o.features):Fl(o,r.geojsonVtOptions),this.loaded={};let a={};if(n){let s=n.finish();s&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(s)))}return a}catch(o){if(delete this._pendingRequest,ac(o))return{abandoned:!0};throw o}}reloadTile(r){let n=this.loaded,i=r.uid;return n&&n[i]?super.reloadTile(r):this.loadTile(r)}async loadGeoJSON(r,n){let{promoteId:i}=r;if(r.request){let o=await mc(r.request,n);return this._dataUpdateable=Ll(o.data,i)?Dl(o.data,i):void 0,o.data}if(typeof r.data=="string")try{let o=JSON.parse(r.data);return this._dataUpdateable=Ll(o,i)?Dl(o,i):void 0,o}catch(o){throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."))}if(!r.dataDiff)throw new Error("Input data given to '".concat(r.source,"' is not a valid GeoJSON object."));if(!this._dataUpdateable)throw new Error("Cannot update existing geojson data in ".concat(r.source));return Sy(this._dataUpdateable,r.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}async removeSource(r){this._pendingRequest&&this._pendingRequest.abort()}getClusterExpansionZoom(r){return this._geoJSONIndex.getClusterExpansionZoom(r.clusterId)}getClusterChildren(r){return this._geoJSONIndex.getChildren(r.clusterId)}getClusterLeaves(r){return this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset)}};function m0({superclusterOptions:t,clusterProperties:e}){if(!e||!t)return t;let r={},n={},i={accumulated:null,zoom:0},o={properties:null},a=Object.keys(e);for(let s of a){let[l,u]=e[s],c=jt(u),p=jt(typeof l=="string"?[l,["accumulated"],["get",s]]:l);r[s]=c.value,n[s]=p.value}return t.map=s=>{o.properties=s;let l={};for(let u of a)l[u]=r[u].evaluate(i,o);return l},t.reduce=(s,l)=>{o.properties=l;for(let u of a)i.accumulated=s[u],s[u]=n[u].evaluate(i,o)},t}var La=class{constructor(e){this.self=e,this.actor=new io(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(r,n)=>{if(this.externalWorkerSourceTypes[r])throw new Error('Worker source with name "'.concat(r,'" already registered.'));this.externalWorkerSourceTypes[r]=n},this.self.addProtocol=lc,this.self.removeProtocol=uc,this.self.registerRTLTextPlugin=r=>{if(ye.isParsed())throw new Error("RTL text plugin already registered.");ye.setMethods(r)},this.actor.registerMessageHandler("LDT",(r,n)=>this._getDEMWorkerSource(r,n.source).loadTile(n)),this.actor.registerMessageHandler("RDT",async(r,n)=>{this._getDEMWorkerSource(r,n.source).removeTile(n)}),this.actor.registerMessageHandler("GCEZ",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterExpansionZoom(n)),this.actor.registerMessageHandler("GCC",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterChildren(n)),this.actor.registerMessageHandler("GCL",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterLeaves(n)),this.actor.registerMessageHandler("LD",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadData(n)),this.actor.registerMessageHandler("LT",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadTile(n)),this.actor.registerMessageHandler("RT",(r,n)=>this._getWorkerSource(r,n.type,n.source).reloadTile(n)),this.actor.registerMessageHandler("AT",(r,n)=>this._getWorkerSource(r,n.type,n.source).abortTile(n)),this.actor.registerMessageHandler("RMT",(r,n)=>this._getWorkerSource(r,n.type,n.source).removeTile(n)),this.actor.registerMessageHandler("RS",async(r,n)=>{if(!this.workerSources[r]||!this.workerSources[r][n.type]||!this.workerSources[r][n.type][n.source])return;let i=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],i.removeSource!==void 0&&i.removeSource(n)}),this.actor.registerMessageHandler("RM",async r=>{delete this.layerIndexes[r],delete this.availableImages[r],delete this.workerSources[r],delete this.demWorkerSources[r]}),this.actor.registerMessageHandler("SR",async(r,n)=>{this.referrer=n}),this.actor.registerMessageHandler("SRPS",(r,n)=>this._syncRTLPluginState(r,n)),this.actor.registerMessageHandler("IS",async(r,n)=>{this.self.importScripts(n)}),this.actor.registerMessageHandler("SI",(r,n)=>this._setImages(r,n)),this.actor.registerMessageHandler("UL",async(r,n)=>{this._getLayerIndex(r).update(n.layers,n.removedIds)}),this.actor.registerMessageHandler("SL",async(r,n)=>{this._getLayerIndex(r).replace(n)})}async _setImages(e,r){this.availableImages[e]=r;for(let n in this.workerSources[e]){let i=this.workerSources[e][n];for(let o in i)i[o].availableImages=r}}async _syncRTLPluginState(e,r){if(ye.isParsed())return ye.getState();if(r.pluginStatus!=="loading")return ye.setState(r),r;let n=r.pluginURL;if(this.self.importScripts(n),ye.isParsed()){let o={pluginStatus:"loaded",pluginURL:n};return ye.setState(o),o}throw ye.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(n))}_getAvailableImages(e){let r=this.availableImages[e];return r||(r=[]),r}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new ya),r}_getWorkerSource(e,r,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][r]||(this.workerSources[e][r]={}),!this.workerSources[e][r][n]){let i={sendAsync:(o,a)=>(o.targetMapId=e,this.actor.sendAsync(o,a))};switch(r){case"vector":this.workerSources[e][r][n]=new Nr(i,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][r][n]=new Fa(i,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][r][n]=new this.externalWorkerSourceTypes[r](i,this._getLayerIndex(e),this._getAvailableImages(e));break}}return this.workerSources[e][r][n]}_getDEMWorkerSource(e,r){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][r]||(this.demWorkerSources[e][r]=new wa),this.demWorkerSources[e][r]}};at(self)&&(self.worker=new La(self));})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
`,a9e=s(()=>wc.WORKER_URL?wc.WORKER_URL:URL.createObjectURL(new Blob([n9e],{type:"text/javascript"})),"getWorkerURL");function nae(){return new Worker(a9e())}s(nae,"workerFactory");var OF="maplibre_preloaded_worker_pool",aae=class oae{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<oae.workerCount;)this.workers.push(nae());return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[OF]}numActive(){return Object.keys(this.active).length}};s(aae,"WorkerPool");var SP=aae,o9e=Math.floor(yn.hardwareConcurrency/2);SP.workerCount=pZ(globalThis)?Math.max(Math.min(o9e,3),1):1;var sw;function MP(){return sw||(sw=new SP),sw}s(MP,"getGlobalWorkerPool");function s9e(){MP().acquire(OF)}s(s9e,"prewarm");function l9e(){let t=sw;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(OF),sw=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}s(l9e,"clearPrewarmedResources");var sae=class{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;let i=this.workerPool.acquire(r);for(let n=0;n<i.length;n++){let a=i[n],o=new i9e(a,r);o.name="Worker ".concat(n),this.actors.push(o)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){let i=[];for(let n of this.actors)i.push(n.sendAsync({type:e,data:r}));return Promise.all(i)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(let i of this.actors)i.registerMessageHandler(e,r)}};s(sae,"Dispatcher");var lae=sae,CM;function kF(){return CM||(CM=new lae(MP(),QD),CM.registerMessageHandler("GR",(t,e,r)=>Z3(e,r))),CM}s(kF,"getGlobalDispatcher");N();function uae(t,e){let r=Or.create();return Or.translate(r,r,[1,1,0]),Or.scale(r,r,[t.width*.5,t.height*.5,1]),Or.multiply(r,r,t.calculatePosMatrix(e.toUnwrapped()))}s(uae,"getPixelPosMatrix");function cae(t,e,r){if(t)for(let i of t){let n=e[i];if(n&&n.source===r&&n.type==="fill-extrusion")return!0}else for(let i in e){let n=e[i];if(n.source===r&&n.type==="fill-extrusion")return!0}return!1}s(cae,"queryIncludes3DLayer");function hae(t,e,r,i,n,a){let o=cae(n&&n.layers,e,t.id),l=a.maxPitchScaleFactor(),u=t.tilesIn(i,l,o);u.sort(NF);let c=[];for(let m of u)c.push({wrappedTileID:m.tileID.wrapped().key,queryResults:m.tile.queryRenderedFeatures(e,r,t._state,m.queryGeometry,m.cameraQueryGeometry,m.scale,n,a,l,uae(t.transform,m.tileID))});let p=fae(c);for(let m in p)p[m].forEach(y=>{let v=y.feature,x=t.getFeatureState(v.layer["source-layer"],v.id);v.source=v.layer.source,v.layer["source-layer"]&&(v.sourceLayer=v.layer["source-layer"]),v.state=x});return p}s(hae,"queryRenderedFeatures");function pae(t,e,r,i,n,a,o){let l={},u=a.queryRenderedSymbols(i),c=[];for(let p of Object.keys(u).map(Number))c.push(o[p]);c.sort(NF);for(let p of c){let m=p.featureIndex.lookupSymbolFeatures(u[p.bucketInstanceId],e,p.bucketIndex,p.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(let y in m){let v=l[y]=l[y]||[],x=m[y];x.sort((E,M)=>{let I=p.featureSortOrder;if(I){let P=I.indexOf(E.featureIndex);return I.indexOf(M.featureIndex)-P}else return M.featureIndex-E.featureIndex});for(let E of x)v.push(E)}}for(let p in l)l[p].forEach(m=>{let y=m.feature,v=t[p],x=r[v.source].getFeatureState(y.layer["source-layer"],y.id);y.source=y.layer.source,y.layer["source-layer"]&&(y.sourceLayer=y.layer["source-layer"]),y.state=x});return l}s(pae,"queryRenderedSymbols");function dae(t,e){let r=t.getRenderableIds().map(a=>t.getTileByID(a)),i=[],n={};for(let a=0;a<r.length;a++){let o=r[a],l=o.tileID.canonical.key;n[l]||(n[l]=!0,o.querySourceFeatures(i,e))}return i}s(dae,"querySourceFeatures");function NF(t,e){let r=t.tileID,i=e.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}s(NF,"sortTilesIn");function fae(t){let e={},r={};for(let i of t){let n=i.queryResults,a=i.wrappedTileID,o=r[a]=r[a]||{};for(let l in n){let u=n[l],c=o[l]=o[l]||{},p=e[l]=e[l]||[];for(let m of u)c[m.featureIndex]||(c[m.featureIndex]=!0,p.push(m))}}return e}s(fae,"mergeRenderedFeatureLayers");N();N();N();N();async function FF(t,e,r){let i=t;if(t.url?i=(await Y3(e.transformRequest(t.url,"Source"),r)).data:await yn.frameAsync(r),!i)return null;let n=dA(Fr(i,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in i&&i.vector_layers&&(n.vectorLayerIds=i.vector_layers.map(a=>a.id)),n}s(FF,"loadTileJson");N();N();N();var BF=63710088e-1,mae=class i2{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(r,")"));if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new i2(Ay(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let r=Math.PI/180,i=this.lat*r,n=e.lat*r,a=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((e.lng-this.lng)*r);return BF*Math.acos(Math.min(a,1))}static convert(e){if(e instanceof i2)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new i2(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new i2(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};s(mae,"LngLat");var Yi=mae,gae=class E0{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof Yi?new Yi(e.lng,e.lat):Yi.convert(e),this}setSouthWest(e){return this._sw=e instanceof Yi?new Yi(e.lng,e.lat):Yi.convert(e),this}extend(e){let r=this._sw,i=this._ne,n,a;if(e instanceof Yi)n=e,a=e;else if(e instanceof E0){if(n=e._sw,a=e._ne,!n||!a)return this}else{if(Array.isArray(e))if(e.length===4||e.every(Array.isArray)){let o=e;return this.extend(E0.convert(o))}else{let o=e;return this.extend(Yi.convert(o))}else if(e&&("lng"in e||"lon"in e)&&"lat"in e)return this.extend(Yi.convert(e));return this}return!r&&!i?(this._sw=new Yi(n.lng,n.lat),this._ne=new Yi(a.lng,a.lat)):(r.lng=Math.min(n.lng,r.lng),r.lat=Math.min(n.lat,r.lat),i.lng=Math.max(a.lng,i.lng),i.lat=Math.max(a.lat,i.lat)),this}getCenter(){return new Yi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Yi(this.getWest(),this.getNorth())}getSouthEast(){return new Yi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:r,lat:i}=Yi.convert(e),n=this._sw.lat<=i&&i<=this._ne.lat,a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),n&&a}static convert(e){return e instanceof E0||!e?e:new E0(e)}static fromLngLat(e,r=0){let i=360*r/40075017,n=i/Math.cos(Math.PI/180*e.lat);return new E0(new Yi(e.lng-n,e.lat-i),new Yi(e.lng+n,e.lat+i))}};s(gae,"LngLatBounds");var Km=gae;N();var yae=2*Math.PI*BF;function zF(t){return yae*Math.cos(t*Math.PI/180)}s(zF,"circumferenceAtLatitude");function Ry(t){return(180+t)/360}s(Ry,"mercatorXfromLng");function Oy(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}s(Oy,"mercatorYfromLat");function LT(t,e){return t/zF(e)}s(LT,"mercatorZfromAltitude");function vae(t){return t*360-180}s(vae,"lngFromMercatorX");function DT(t){let e=180-t*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}s(DT,"latFromMercatorY");function _ae(t,e){return t*zF(DT(e))}s(_ae,"altitudeFromMercatorZ");function xae(t){return 1/Math.cos(t*Math.PI/180)}s(xae,"mercatorScale");var bae=class wae{constructor(e,r,i=0){this.x=+e,this.y=+r,this.z=+i}static fromLngLat(e,r=0){let i=Yi.convert(e);return new wae(Ry(i.lng),Oy(i.lat),LT(r,i.lat))}toLngLat(){return new Yi(vae(this.x),DT(this.y))}toAltitude(){return _ae(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yae*xae(DT(this.y))}};s(bae,"MercatorCoordinate");var nl=bae,Aae=class{constructor(e,r,i){this.bounds=Km.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=i||24}validateBounds(e){return!Array.isArray(e)||e.length!==4?[-180,-90,180,90]:[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]}contains(e){let r=Math.pow(2,e.z),i={minX:Math.floor(Ry(this.bounds.getWest())*r),minY:Math.floor(Oy(this.bounds.getNorth())*r),maxX:Math.ceil(Ry(this.bounds.getEast())*r),maxY:Math.ceil(Oy(this.bounds.getSouth())*r)};return e.x>=i.minX&&e.x<i.maxX&&e.y>=i.minY&&e.y<i.maxY}};s(Aae,"TileBounds");var Sae=Aae,Mae=class extends Nl{constructor(e,r,i,n){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Fr(this,dA(r,["url","scheme","tileSize","promoteId"])),this._options=Fr({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}async load(){this._loaded=!1,this.fire(new pr("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await FF(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(Fr(this,e),e.bounds&&(this.tileBounds=new Sae(e.bounds,this.minzoom,this.maxzoom)),this.fire(new pr("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new pr("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new di(e))}}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return Fr({},this._options)}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(!e.actor||e.state==="expired")e.actor=this.dispatcher.getActor(),n="LT";else if(e.state==="loading")return new Promise((a,o)=>{e.reloadPromise={resolve:a,reject:o}});e.abortController=new AbortController;try{let a=await e.actor.sendAsync({type:n,data:i},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,a)}catch(a){if(delete e.abortController,e.aborted)return;if(a&&a.status!==404)throw a;this._afterTileLoadWorkerResponse(e,null)}}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){let i=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(i.resolve).catch(i.reject)}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&await e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}})}async unloadTile(e){e.unloadVectorData(),e.actor&&await e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}hasTransition(){return!1}};s(Mae,"VectorTileSource");var u9e=Mae;N();var Eae=class extends Nl{constructor(e,r,i,n){super(),this.id=e,this.dispatcher=i,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Fr({type:"raster"},r),Fr(this,dA(r,["url","scheme","tileSize"]))}async load(){this._loaded=!1,this.fire(new pr("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await FF(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(Fr(this,e),e.bounds&&(this.tileBounds=new Sae(e.bounds,this.minzoom,this.maxzoom)),this.fire(new pr("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new pr("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new di(e))}}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return Fr({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let i=await Hp.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(i&&i.data){this.map._refreshExpiredTiles&&i.cacheControl&&i.expires&&e.setExpiryData({cacheControl:i.cacheControl,expires:i.expires});let n=this.map.painter.context,a=n.gl,o=i.data;e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new Ms(n,o,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(i){if(delete e.abortController,e.aborted)e.state="unloaded";else if(i)throw e.state="errored",i}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController)}async unloadTile(e){e.texture&&this.map.painter.saveTileTexture(e.texture)}hasTransition(){return!1}};s(Eae,"RasterTileSource");var Cae=Eae;N();N();N();function Iae(t,e,r){e=Math.pow(2,r)-e-1;var i=Z6(t*256,e*256,r),n=Z6((t+1)*256,(e+1)*256,r);return i[0]+","+i[1]+","+n[0]+","+n[1]}s(Iae,"getTileBBox");function Z6(t,e,r){var i=2*Math.PI*6378137/256/Math.pow(2,r),n=t*i-2*Math.PI*6378137/2,a=e*i-2*Math.PI*6378137/2;return[n,a]}s(Z6,"getMercCoords");var c9e=Rr(kn(),1),Tae=class{constructor(e,r,i){if(e<0||e>25||i<0||i>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error("x=".concat(r,", y=").concat(i,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=r,this.y=i,this.key=e_(0,e,e,r,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,i){let n=Iae(this.x,this.y,this.z),a=Dae(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){let r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){let r=Math.pow(2,this.z);return new c9e.default((e.x*r-this.x)*8192,(e.y*r-this.y)*8192)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}};s(Tae,"CanonicalTileID");var UF=Tae,Pae=class{constructor(e,r){this.wrap=e,this.canonical=r,this.key=e_(e,r.z,r.z,r.x,r.y)}};s(Pae,"UnwrappedTileID");var Y6=Pae,Lae=class bh{constructor(e,r,i,n,a){if(e<i)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(i));this.overscaledZ=e,this.wrap=r,this.canonical=new UF(i,+n,+a),this.key=e_(r,e,i,n,a)}clone(){return new bh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?new bh(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bh(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let i=this.canonical.z-e;return e>this.canonical.z?e_(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):e_(this.wrap*+r,e,e,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new bh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,i=this.canonical.x*2,n=this.canonical.y*2;return[new bh(r,this.wrap,r,i,n),new bh(r,this.wrap,r,i+1,n),new bh(r,this.wrap,r,i,n+1),new bh(r,this.wrap,r,i+1,n+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new bh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new bh(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Y6(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new nl(e.x-this.wrap,e.y))}};s(Lae,"OverscaledTileID");var hc=Lae;function e_(t,e,r,i,n){t*=2,t<0&&(t=t*-1-1);let a=1<<r;return(a*a*t+a*n+i).toString(36)+r.toString(36)+e.toString(36)}s(e_,"calculateKey");function Dae(t,e,r){let i="",n;for(let a=t;a>0;a--)n=1<<a-1,i+=(e&n?1:0)+(r&n?2:0);return i}s(Dae,"getQuadkey");Lr("CanonicalTileID",UF);Lr("OverscaledTileID",hc,{omit:["posMatrix"]});N();var Rae=class{constructor(e,r,i,n=1,a=1,o=1,l=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(i&&!["mapbox","terrarium","custom"].includes(i)){Ol('"'.concat(i,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));return}this.stride=r.height;let u=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),i){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=a,this.blueFactor=o,this.baseShift=l;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let c=0;c<u;c++)this.data[this._idx(-1,c)]=this.data[this._idx(0,c)],this.data[this._idx(u,c)]=this.data[this._idx(u-1,c)],this.data[this._idx(c,-1)]=this.data[this._idx(c,0)],this.data[this._idx(c,u)]=this.data[this._idx(c,u-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(u,-1)]=this.data[this._idx(u-1,0)],this.data[this._idx(-1,u)]=this.data[this._idx(0,u-1)],this.data[this._idx(u,u)]=this.data[this._idx(u-1,u-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let c=0;c<u;c++)for(let p=0;p<u;p++){let m=this.get(c,p);m>this.max&&(this.max=m),m<this.min&&(this.min=m)}}get(e,r){let i=new Uint8Array(this.data.buffer),n=this._idx(e,r)*4;return this.unpack(i[n],i[n+1],i[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,i){return e*this.redFactor+r*this.greenFactor+i*this.blueFactor-this.baseShift}getPixels(){return new mo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=r*this.dim,a=r*this.dim+this.dim,o=i*this.dim,l=i*this.dim+this.dim;switch(r){case-1:n=a-1;break;case 1:a=n+1;break}switch(i){case-1:o=l-1;break;case 1:l=o+1;break}let u=-r*this.dim,c=-i*this.dim;for(let p=o;p<l;p++)for(let m=n;m<a;m++)this.data[this._idx(m,p)]=e.data[this._idx(m+u,p+c)]}};s(Rae,"DEMData");var h9e=Rae;Lr("DEMData",h9e);var Oae=class extends Cae{constructor(e,r,i,n){super(e,r,i,n),this.type="raster-dem",this.maxzoom=22,this._options=Fr({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}async loadTile(e){let r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let n=await Hp.getImage(i,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(n&&n.data){let a=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});let o=Gp(a)&&S9()?a:await this.readImageNow(a),l={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let u=await e.actor.sendAsync({type:"LDT",data:l});e.dem=u,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}async readImageNow(e){if(typeof VideoFrame<"u"&&rZ()){let r=e.width+2,i=e.height+2;try{return new mo({width:r,height:i},await fZ(e,-1,-1,r,i))}catch{}}return yn.getImageData(e,1)}_getNeighboringTiles(e){let r=e.canonical,i=Math.pow(2,r.z),n=(r.x-1+i)%i,a=r.x===0?e.wrap-1:e.wrap,o=(r.x+1+i)%i,l=r.x+1===i?e.wrap+1:e.wrap,u={};return u[new hc(e.overscaledZ,a,r.z,n,r.y).key]={backfilled:!1},u[new hc(e.overscaledZ,l,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(u[new hc(e.overscaledZ,a,r.z,n,r.y-1).key]={backfilled:!1},u[new hc(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},u[new hc(e.overscaledZ,l,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<i&&(u[new hc(e.overscaledZ,a,r.z,n,r.y+1).key]={backfilled:!1},u[new hc(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},u[new hc(e.overscaledZ,l,r.z,o,r.y+1).key]={backfilled:!1}),u}async unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&await e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}})}};s(Oae,"RasterDEMTileSource");var p9e=Oae;N();var kae=class extends Nl{constructor(e,r,i,n){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(n),this._data=r.data,this._options=Fr({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;let a=8192/this.tileSize;this.workerOptions=Fr({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*a,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*a,extent:8192,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:8192,radius:(r.clusterRadius||50)*a,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}async load(){await this._updateWorkerData()}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,i){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:i}})}async _updateWorkerData(e){let r=Fr({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(yn.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new pr("dataloading",{dataType:"source"}));try{let i=await this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||i.abandoned){this.fire(new pr("dataabort",{dataType:"source"}));return}let n=null;i.resourceTiming&&i.resourceTiming[this.id]&&(n=i.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&Fr(a,{resourceTiming:n}),this.fire(new pr("data",vt(Ee({},a),{sourceDataType:"metadata"}))),this.fire(new pr("data",vt(Ee({},a),{sourceDataType:"content"})))}catch(i){if(this._pendingLoads--,this._removed){this.fire(new pr("dataabort",{dataType:"source"}));return}this.fire(new di(i))}}loaded(){return this._pendingLoads===0}async loadTile(e){let r=e.actor?"RT":"LT";e.actor=this.actor;let i={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let n=await this.actor.sendAsync({type:r,data:i},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,r==="RT")}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}async unloadTile(e){e.unloadVectorData(),await this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return Fr({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}};s(kae,"GeoJSONSource");var d9e=kae;N();N();N();var EP=no([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Nae=class extends Nl{constructor(e,r,i,n){super(),this.id=e,this.dispatcher=i,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=r}async load(e){this._loaded=!1,this.fire(new pr("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let r=await Hp.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new di(r))}}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new pr("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let r=e.map(nl.fromLngLat);this.tileID=Fae(r),this.minzoom=this.maxzoom=this.tileID.z;let i=r.map(n=>this.tileID.getTilePoint(n)._round());return this._boundsArray=new VQ,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,8192,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,8192),this._boundsArray.emplaceBack(i[2].x,i[2].y,8192,8192),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new pr("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,EP.members)),this.boundsSegments||(this.boundsSegments=Io.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ms(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,i=!0)}i&&this.fire(new pr("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}async loadTile(e){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}};s(Nae,"ImageSource");var Ew=Nae;function Fae(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let p of t)e=Math.min(e,p.x),r=Math.min(r,p.y),i=Math.max(i,p.x),n=Math.max(n,p.y);let a=i-e,o=n-r,l=Math.max(a,o),u=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),c=Math.pow(2,u);return new UF(u,Math.floor((e+i)/2*c),Math.floor((r+n)/2*c))}s(Fae,"getCoordinatesCenterTileID");var Bae=class extends Ew{constructor(e,r,i,n){super(e,r,i,n),this.roundZoom=!0,this.type="video",this.options=r}async load(){this._loaded=!1;let e=this.options;this.urls=[];for(let r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{let r=await yOe(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new di(r))}}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new di(new _r("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(r.start(0)," and ").concat(r.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,r=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,EP.members)),this.boundsSegments||(this.boundsSegments=Io.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new Ms(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let i=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,i=!0)}i&&this.fire(new pr("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}};s(Bae,"VideoSource");var f9e=Bae;N();var zae=class extends Ew{constructor(e,r,i,n){super(e,r,i,n),r.coordinates?(!Array.isArray(r.coordinates)||r.coordinates.length!==4||r.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(o=>typeof o!="number")))&&this.fire(new di(new _r("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new di(new _r("sources.".concat(e),null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new di(new _r("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas!="string"&&!(r.canvas instanceof HTMLCanvasElement)&&this.fire(new di(new _r("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new di(new _r("sources.".concat(e),null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate!==void 0?r.animate:!0}async load(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new di(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let r=this.map.painter.context,i=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,EP.members)),this.boundsSegments||(this.boundsSegments=Io.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ms(r,this.canvas,i.RGBA,{premultiply:!0});let n=!1;for(let a in this.tiles){let o=this.tiles[a];o.state!=="loaded"&&(o.state="loaded",o.texture=this.texture,n=!0)}n&&this.fire(new pr("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}};s(zae,"CanvasSource");var m9e=zae,Uae={},g9e=s((t,e,r,i)=>{let n=Vae(e.type),a=new n(t,e,r,i);if(a.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(a.id));return a},"create"),Vae=s(t=>{switch(t){case"geojson":return d9e;case"image":return Ew;case"raster":return Cae;case"raster-dem":return p9e;case"vector":return u9e;case"video":return f9e;case"canvas":return m9e}return Uae[t]},"getSourceType"),y9e=s((t,e)=>{Uae[t]=e},"setSourceType"),got=s(async(t,e)=>{if(Vae(t))throw new Error('A source type called "'.concat(t,'" already exists.'));y9e(t,e)},"addSourceType");N();N();function jae(t,e){let r={};if(!e)return r;for(let i of t){let n=i.layerIds.map(a=>e.getLayer(a)).filter(Boolean);if(n.length!==0){i.layers=n,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(a=>n.filter(o=>o.id===a)[0]));for(let a of n)r[a.id]=i}}return r}s(jae,"deserialize");N();N();var $ae=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let i=e[r];this._stringToNumber[i]=r,this._numberToString[r]=i}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};s($ae,"DictionaryCoder");var v9e=$ae,_9e=Rr(q3(),1),x9e=Rr(eZ(),1);N();var Gae=class{constructor(e,r,i,n,a){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=i,e._y=n,this.properties=e.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(e[r]=this[r]);return e}};s(Gae,"GeoJSONFeature");var Hae=Gae,qae=class{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new C6(8192,16,0),this.grid3D=new C6(8192,16,0),this.featureIndexArray=new FQ,this.promoteId=r}insert(e,r,i,n,a,o){let l=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,a);let u=o?this.grid3D:this.grid;for(let c=0;c<r.length;c++){let p=r[c],m=[1/0,1/0,-1/0,-1/0];for(let y=0;y<p.length;y++){let v=p[y];m[0]=Math.min(m[0],v.x),m[1]=Math.min(m[1],v.y),m[2]=Math.max(m[2],v.x),m[3]=Math.max(m[3],v.y)}m[0]<8192&&m[1]<8192&&m[2]>=0&&m[3]>=0&&u.insert(l,m[0],m[1],m[2],m[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new _9e.default.VectorTile(new x9e.default(this.rawTileData)).layers,this.sourceLayerCoder=new v9e(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,i,n){this.loadVTLayers();let a=e.params||{},o=8192/e.tileSize/e.scale,l=ET(a.filter),u=e.queryGeometry,c=e.queryPadding*o,p=J6(u),m=this.grid.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c),y=J6(e.cameraQueryGeometry),v=this.grid3D.query(y.minX-c,y.minY-c,y.maxX+c,y.maxY+c,(M,I,P,C)=>Dee(e.cameraQueryGeometry,M-c,I-c,P+c,C+c));for(let M of v)m.push(M);m.sort(Wae);let x={},E;for(let M=0;M<m.length;M++){let I=m[M];if(I===E)continue;E=I;let P=this.featureIndexArray.get(I),C=null;this.loadMatchingFeature(x,P.bucketIndex,P.sourceLayerIndex,P.featureIndex,l,a.layers,a.availableImages,r,i,n,(T,D,F)=>(C||(C=og(T)),D.queryIntersectsFeature(u,T,F,C,this.z,e.transform,o,e.pixelPosMatrix)))}return x}loadMatchingFeature(e,r,i,n,a,o,l,u,c,p,m){let y=this.bucketLayerIDs[r];if(o&&!sZ(o,y))return;let v=this.sourceLayerCoder.decode(i),x=this.vtLayers[v].feature(n);if(a.needGeometry){let M=sg(x,!0);if(!a.filter(new ds(this.tileID.overscaledZ),M,this.tileID.canonical))return}else if(!a.filter(new ds(this.tileID.overscaledZ),x))return;let E=this.getId(x,v);for(let M=0;M<y.length;M++){let I=y[M];if(o&&o.indexOf(I)<0)continue;let P=u[I];if(!P)continue;let C={};E&&p&&(C=p.getState(P.sourceLayer||"_geojsonTileLayer",E));let T=Fr({},c[I]);T.paint=K6(T.paint,P.paint,x,C,l),T.layout=K6(T.layout,P.layout,x,C,l);let D=!m||m(x,P,C);if(!D)continue;let F=new Hae(x,this.z,this.x,this.y,E);F.layer=T;let k=e[I];k===void 0&&(k=e[I]=[]),k.push({featureIndex:n,feature:F,intersectionZ:D})}}lookupSymbolFeatures(e,r,i,n,a,o,l,u){let c={};this.loadVTLayers();let p=ET(a);for(let m of e)this.loadMatchingFeature(c,i,n,m,p,o,l,u,r);return c}hasLayer(e){for(let r of this.bucketLayerIDs)for(let i of r)if(e===i)return!0;return!1}getId(e,r){let i=e.id;if(this.promoteId){let n=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];i=e.properties[n],typeof i=="boolean"&&(i=Number(i))}return i}};s(qae,"FeatureIndex");var b9e=qae;Lr("FeatureIndex",b9e,{omit:["rawTileData","sourceLayerCoder"]});function K6(t,e,r,i,n){return X3(t,(a,o)=>{let l=e instanceof dP?e.get(o):null;return l&&l.evaluate?l.evaluate(r,i,n):l})}s(K6,"evaluateProperties");function J6(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let a of t)e=Math.min(e,a.x),r=Math.min(r,a.y),i=Math.max(i,a.x),n=Math.max(n,a.y);return{minX:e,minY:r,maxX:i,maxY:n}}s(J6,"getBounds");function Wae(t,e){return e-t}s(Wae,"topDownFeatureComparator");N();N();var Q6="RTLPluginLoaded",Xae=class extends Nl{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=kF()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}async setRTLTextPlugin(e,r=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=yn.resolveURL(e),!this.url)throw new Error("requested url ".concat(e," is invalid"));if(this.status==="unavailable")if(r)this.status="deferred",this._syncState(this.status);else return this._requestImport();else if(this.status==="requested")return this._requestImport()}async _requestImport(){await this._syncState("loading"),this.status="loaded",this.fire(new pr(Q6))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}};s(Xae,"RTLMainThreadPlugin");var w9e=Xae,OL=null;function b_(){return OL||(OL=new w9e),OL}s(b_,"rtlMainThreadPluginFactory");var A9e=3e4,Zae=class{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=M9(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!e){this.collisionBoxArray=new yQ;return}e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=jae(e.buckets,r.style),this.hasSymbolBuckets=!1;for(let n in this.buckets){let a=this.buckets[n];if(a instanceof x_)if(this.hasSymbolBuckets=!0,i)a.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let n in this.buckets){let a=this.buckets[n];if(a instanceof x_&&a.hasRTLText){this.hasRTLText=!0,b_().lazyLoad();break}}this.queryPadding=0;for(let n in this.buckets){let a=this.buckets[n];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(n).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let i in this.buckets){let n=this.buckets[i];n.uploadPending()&&n.upload(e)}let r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ms(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ms(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,i,n,a,o,l,u,c,p){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:a,scale:o,tileSize:this.tileSize,pixelPosMatrix:p,transform:u,params:l,queryPadding:this.queryPadding*c},e,r,i)}querySourceFeatures(e,r){let i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;let n=i.loadVTLayers(),a=r&&r.sourceLayer?r.sourceLayer:"",o=n._geojsonTileLayer||n[a];if(!o)return;let l=ET(r&&r.filter),{z:u,x:c,y:p}=this.tileID.canonical,m={z:u,x:c,y:p};for(let y=0;y<o.length;y++){let v=o.feature(y);if(l.needGeometry){let M=sg(v,!0);if(!l.filter(new ds(this.tileID.overscaledZ),M,this.tileID.canonical))continue}else if(!l.filter(new ds(this.tileID.overscaledZ),v))continue;let x=i.getId(v,a),E=new Hae(v,u,c,p,x);E.tile=m,e.push(E)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let r=this.expirationTime;if(e.cacheControl){let i=hZ(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+i["max-age"]*1e3)}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let i=Date.now(),n=!1;if(this.expirationTime>i)n=!1;else if(!r)n=!0;else if(this.expirationTime<r)n=!0;else{let a=this.expirationTime-r;a?this.expirationTime=i+Math.max(a,A9e):n=!0}n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let i=this.latestFeatureIndex.loadVTLayers();for(let n in this.buckets){if(!r.style.hasLayer(n))continue;let a=this.buckets[n],o=a.layers[0].sourceLayer||"_geojsonTileLayer",l=i[o],u=e[o];if(!l||!u||Object.keys(u).length===0)continue;a.update(u,l,this.imageAtlas&&this.imageAtlas.patternPositions||{});let c=r&&r.style&&r.style.getLayer(n);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(a)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<yn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=yn.now()+e}setDependencies(e,r){let i={};for(let n of r)i[n]=!0;this.dependencies[e]=i}hasDependency(e,r){for(let i of e){let n=this.dependencies[i];if(n){for(let a of r)if(n[a])return!0}}return!1}};s(Zae,"Tile");var Yae=Zae;N();var Kae=class{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(let e in this.data)for(let r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,i){let n=e.wrapped().key;this.data[n]===void 0&&(this.data[n]=[]);let a={value:r,timeout:void 0};if(i!==void 0&&(a.timeout=setTimeout(()=>{this.remove(e,a)},i)),this.data[n].push(a),this.order.push(n),this.order.length>this.max){let o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){let r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;let i=e.wrapped().key,n=r===void 0?0:this.data[i].indexOf(r),a=this.data[i][n];return this.data[i].splice(n,1),a.timeout&&clearTimeout(a.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(a.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){let r=[];for(let i in this.data)for(let n of this.data[i])e(n.value)||r.push(n);for(let i of r)this.remove(i.value.tileID,i)}};s(Kae,"TileCache");var S9e=Kae,nq=Rr(kn(),1);N();var Jae=class{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,i){let n=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},Fr(this.stateChanges[e][n],i),this.deletedStates[e]===null){this.deletedStates[e]={};for(let a in this.state[e])a!==n&&(this.deletedStates[e][a]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][n]===null){this.deletedStates[e][n]={};for(let a in this.state[e][n])i[a]||(this.deletedStates[e][n][a]=null)}else for(let a in i)this.deletedStates[e]&&this.deletedStates[e][n]&&this.deletedStates[e][n][a]===null&&delete this.deletedStates[e][n][a]}removeFeatureState(e,r,i){if(this.deletedStates[e]===null)return;let n=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&r!==void 0)this.deletedStates[e][n]!==null&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][i]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][n]){this.deletedStates[e][n]={};for(i in this.stateChanges[e][n])this.deletedStates[e][n][i]=null}else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,r){let i=String(r),n=this.state[e]||{},a=this.stateChanges[e]||{},o=Fr({},n[i],a[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let l=this.deletedStates[e][r];if(l===null)return{};for(let u in l)delete o[u]}return o}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){let i={};for(let n in this.stateChanges){this.state[n]=this.state[n]||{};let a={};for(let o in this.stateChanges[n])this.state[n][o]||(this.state[n][o]={}),Fr(this.state[n][o],this.stateChanges[n][o]),a[o]=this.state[n][o];i[n]=a}for(let n in this.deletedStates){this.state[n]=this.state[n]||{};let a={};if(this.deletedStates[n]===null)for(let o in this.state[n])a[o]={},this.state[n][o]={};else for(let o in this.deletedStates[n]){if(this.deletedStates[n][o]===null)this.state[n][o]={};else for(let l of Object.keys(this.deletedStates[n][o]))delete this.state[n][o][l];a[o]=this.state[n][o]}i[n]=i[n]||{},Fr(i[n],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(let n in e)e[n].setFeatureState(i,r)}};s(Jae,"SourceFeatureState");var M9e=Jae,Qae=class n2 extends Nl{constructor(e,r,i){super(),this.id=e,this.dispatcher=i,this.on("data",n=>this._dataHandler(n)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=g9e(e,r,i,this),this._tiles={},this._cache=new S9e(0,n=>this._unloadTile(n)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new M9e,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if((this.used!==void 0||this.usedForTerrain!==void 0)&&!this.used&&!this.usedForTerrain)return!0;if(!this._updated)return!1;for(let e in this._tiles){let r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}async _loadTile(e,r,i){try{await this._source.loadTile(e),this._tileLoaded(e,r,i)}catch(n){e.state="errored",n.status!==404?this._source.fire(new di(n,{tile:e})):this.update(this.transform,this.terrain)}}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new pr("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let r in this._tiles){let i=this._tiles[r];i.upload(e),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(eR).map(e=>e.key)}getRenderableIds(e){let r=[];for(let i in this._tiles)this._isIdRenderable(i,e)&&r.push(this._tiles[i]);return e?r.sort((i,n)=>{let a=i.tileID,o=n.tileID,l=new nq.default(a.canonical.x,a.canonical.y)._rotate(this.transform.angle),u=new nq.default(o.canonical.x,o.canonical.y)._rotate(this.transform.angle);return a.overscaledZ-o.overscaledZ||u.y-l.y||u.x-l.x}).map(i=>i.tileID.key):r.map(i=>i.tileID).sort(eR).map(i=>i.key)}hasRenderableParent(e){let r=this.findLoadedParent(e,0);return r?this._isIdRenderable(r.tileID.key):!1}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}async _reloadTile(e,r){let i=this._tiles[e];i&&(i.state!=="loading"&&(i.state=r),await this._loadTile(i,e,r))}_tileLoaded(e,r,i){e.timeAdded=yn.now(),i==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new pr("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let r=this.getRenderableIds();for(let n=0;n<r.length;n++){let a=r[n];if(e.neighboringTiles&&e.neighboringTiles[a]){let o=this.getTileByID(a);i(e,o),i(o,e)}}function i(n,a){n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0;let o=a.tileID.canonical.x-n.tileID.canonical.x,l=a.tileID.canonical.y-n.tileID.canonical.y,u=Math.pow(2,n.tileID.canonical.z),c=a.tileID.key;o===0&&l===0||Math.abs(l)>1||(Math.abs(o)>1&&(Math.abs(o+u)===1?o+=u:Math.abs(o-u)===1&&(o-=u)),!(!a.dem||!n.dem)&&(n.dem.backfillBorder(a.dem,o,l),n.neighboringTiles&&n.neighboringTiles[c]&&(n.neighboringTiles[c].backfilled=!0)))}s(i,"fillBorder")}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,i,n){for(let a in this._tiles){let o=this._tiles[a];if(n[a]||!o.hasData()||o.tileID.overscaledZ<=r||o.tileID.overscaledZ>i)continue;let l=o.tileID;for(;o&&o.tileID.overscaledZ>r+1;){let c=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[c.key],o&&o.hasData()&&(l=c)}let u=l;for(;u.overscaledZ>r;)if(u=u.scaledTo(u.overscaledZ-1),e[u.key]){n[l.key]=l;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){let i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=r?i:null}for(let i=e.overscaledZ-1;i>=r;i--){let n=e.scaledTo(i),a=this._getLoadedTile(n);if(a)return a}}_getLoadedTile(e){let r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let r=Math.ceil(e.width/this._source.tileSize)+1,i=Math.ceil(e.height/this._source.tileSize)+1,n=r*i,a=this._maxTileCacheZoomLevels===null?wc.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels,o=Math.floor(n*a),l=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(l)}handleWrapJump(e){let r=this._prevLng===void 0?e:this._prevLng,i=(e-r)/360,n=Math.round(i);if(this._prevLng=e,n){let a={};for(let o in this._tiles){let l=this._tiles[o];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+n),a[l.tileID.key]=l}this._tiles=a;for(let o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(let o in this._tiles){let l=this._tiles[o];this._setTileReloadTimer(o,l)}}}update(e,r){if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};let i;!this.used&&!this.usedForTerrain?i=[]:this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(p=>new hc(p.canonical.z,p.wrap,p.canonical.z,p.canonical.x,p.canonical.y)):(i=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this.usedForTerrain?!1:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r}),this._source.hasTile&&(i=i.filter(p=>this._source.hasTile(p))));let n=e.coveringZoomLevel(this._source),a=Math.max(n-n2.maxOverzooming,this._source.minzoom),o=Math.max(n+n2.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let p={};for(let m of i)if(m.canonical.z>this._source.minzoom){let y=m.scaledTo(m.canonical.z-1);p[y.key]=y;let v=m.scaledTo(Math.max(this._source.minzoom,Math.min(m.canonical.z,5)));p[v.key]=v}i=i.concat(Object.values(p))}let l=i.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,l&&this.fire(new pr("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let u=this._updateRetainedTiles(i,n);if(tR(this._source.type)){let p={},m={},y=Object.keys(u),v=yn.now();for(let x of y){let E=u[x],M=this._tiles[x];if(!M||M.fadeEndTime!==0&&M.fadeEndTime<=v)continue;let I=this.findLoadedParent(E,a);I&&(this._addTile(I.tileID),p[I.tileID.key]=I.tileID),m[x]=E}this._retainLoadedChildren(m,n,o,u);for(let x in p)u[x]||(this._coveredTiles[x]=!0,u[x]=p[x]);if(r){let x={},E={};for(let M of i)this._tiles[M.key].hasData()?x[M.key]=M:E[M.key]=M;for(let M in E){let I=E[M].children(this._source.maxzoom);this._tiles[I[0].key]&&this._tiles[I[1].key]&&this._tiles[I[2].key]&&this._tiles[I[3].key]&&(x[I[0].key]=u[I[0].key]=I[0],x[I[1].key]=u[I[1].key]=I[1],x[I[2].key]=u[I[2].key]=I[2],x[I[3].key]=u[I[3].key]=I[3],delete E[M])}for(let M in E){let I=this.findLoadedParent(E[M],this._source.minzoom);if(I){x[I.tileID.key]=u[I.tileID.key]=I.tileID;for(let P in x)x[P].isChildOf(I.tileID)&&delete x[P]}}for(let M in this._tiles)x[M]||(this._coveredTiles[M]=!0)}}for(let p in u)this._tiles[p].clearFadeHold();let c=nZ(this._tiles,u);for(let p of c){let m=this._tiles[p];m.hasSymbolBuckets&&!m.holdingForFade()?m.setHoldDuration(this.map._fadeDuration):(!m.hasSymbolBuckets||m.symbolFadeFinished())&&this._removeTile(p)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){let i={},n={},a=Math.max(r-n2.maxOverzooming,this._source.minzoom),o=Math.max(r+n2.maxUnderzooming,this._source.minzoom),l={};for(let u of e){let c=this._addTile(u);i[u.key]=u,!c.hasData()&&r<this._source.maxzoom&&(l[u.key]=u)}this._retainLoadedChildren(l,r,o,i);for(let u of e){let c=this._tiles[u.key];if(c.hasData())continue;if(r+1>this._source.maxzoom){let m=u.children(this._source.maxzoom)[0],y=this.getTile(m);if(y&&y.hasData()){i[m.key]=m;continue}}else{let m=u.children(this._source.maxzoom);if(i[m[0].key]&&i[m[1].key]&&i[m[2].key]&&i[m[3].key])continue}let p=c.wasRequested();for(let m=u.overscaledZ-1;m>=a;--m){let y=u.scaledTo(m);if(n[y.key])break;if(n[y.key]=!0,c=this.getTile(y),!c&&p&&(c=this._addTile(y)),c){let v=c.hasData();if((p||v)&&(i[y.key]=y),p=c.wasRequested(),v)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let r=[],i,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}r.push(n.key);let a=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(a),i)break;n=a}for(let a of r)this._loadedParentTiles[a]=i}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));let i=r;return r||(r=new Yae(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,i||this._source.fire(new pr("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let i=r.getExpiryTimeout();i&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},i))}_removeTile(e){let r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(r.uses>0)&&(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){let r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,i){let n=[],a=this.transform;if(!a)return n;let o=i?a.getCameraQueryGeometry(e):e,l=e.map(x=>a.pointCoordinate(x,this.terrain)),u=o.map(x=>a.pointCoordinate(x,this.terrain)),c=this.getIds(),p=1/0,m=1/0,y=-1/0,v=-1/0;for(let x of u)p=Math.min(p,x.x),m=Math.min(m,x.y),y=Math.max(y,x.x),v=Math.max(v,x.y);for(let x=0;x<c.length;x++){let E=this._tiles[c[x]];if(E.holdingForFade())continue;let M=E.tileID,I=Math.pow(2,a.zoom-E.tileID.overscaledZ),P=r*E.queryPadding*8192/E.tileSize/I,C=[M.getTilePoint(new nl(p,m)),M.getTilePoint(new nl(y,v))];if(C[0].x-P<8192&&C[0].y-P<8192&&C[1].x+P>=0&&C[1].y+P>=0){let T=l.map(F=>M.getTilePoint(F)),D=u.map(F=>M.getTilePoint(F));n.push({tile:E,tileID:M,queryGeometry:T,cameraQueryGeometry:D,scale:I})}}return n}getVisibleCoordinates(e){let r=this.getRenderableIds(e).map(i=>this._tiles[i].tileID);for(let i of r)i.posMatrix=this.transform.calculatePosMatrix(i.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(tR(this._source.type)){let e=yn.now();for(let r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,i){e=e||"_geojsonTileLayer",this._state.updateState(e,r,i)}removeFeatureState(e,r,i){e=e||"_geojsonTileLayer",this._state.removeFeatureState(e,r,i)}getFeatureState(e,r){return e=e||"_geojsonTileLayer",this._state.getState(e,r)}setDependencies(e,r,i){let n=this._tiles[e];n&&n.setDependencies(r,i)}reloadTilesForDependencies(e,r){for(let i in this._tiles)this._tiles[i].hasDependency(e,r)&&this._reloadTile(i,"reloading");this._cache.filter(i=>!i.hasDependency(e,r))}};s(Qae,"SourceCache");var Cw=Qae;Cw.maxOverzooming=10;Cw.maxUnderzooming=3;function eR(t,e){let r=Math.abs(t.wrap*2)-+(t.wrap<0),i=Math.abs(e.wrap*2)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}s(eR,"compareTileId");function tR(t){return t==="raster"||t==="image"||t==="video"}s(tR,"isRasterType");N();N();N();var Ad=Rr(kn(),1);N();var tm=Rr(kn(),1);function eoe(t,e,r,i,n){let a=[];for(let o=0;o<t.length;o++){let l=t[o],u;for(let c=0;c<l.length-1;c++){let p=l[c],m=l[c+1];p.x<e&&m.x<e||(p.x<e?p=new tm.default(e,p.y+(m.y-p.y)*((e-p.x)/(m.x-p.x)))._round():m.x<e&&(m=new tm.default(e,p.y+(m.y-p.y)*((e-p.x)/(m.x-p.x)))._round()),!(p.y<r&&m.y<r)&&(p.y<r?p=new tm.default(p.x+(m.x-p.x)*((r-p.y)/(m.y-p.y)),r)._round():m.y<r&&(m=new tm.default(p.x+(m.x-p.x)*((r-p.y)/(m.y-p.y)),r)._round()),!(p.x>=i&&m.x>=i)&&(p.x>=i?p=new tm.default(i,p.y+(m.y-p.y)*((i-p.x)/(m.x-p.x)))._round():m.x>=i&&(m=new tm.default(i,p.y+(m.y-p.y)*((i-p.x)/(m.x-p.x)))._round()),!(p.y>=n&&m.y>=n)&&(p.y>=n?p=new tm.default(p.x+(m.x-p.x)*((n-p.y)/(m.y-p.y)),n)._round():m.y>=n&&(m=new tm.default(p.x+(m.x-p.x)*((n-p.y)/(m.y-p.y)),n)._round()),(!u||!p.equals(u[u.length-1]))&&(u=[p],a.push(u)),u.push(m)))))}}return a}s(eoe,"clipLine");N();var toe=class{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,this.length*.5),this.paddedLength=this.length-this.padding*2}lerp(e){if(this.points.length===1)return this.points[0];e=hs(e,0,1);let r=1,i=this._distances[r],n=e*this.paddedLength+this.padding;for(;i<n&&r<this._distances.length;)i=this._distances[++r];let a=r-1,o=this._distances[a],l=i-o,u=l>0?(n-o)/l:0;return this.points[a].mult(1-u).add(this.points[r].mult(u))}};s(toe,"PathInterpolator");var E9e=toe;N();function a2(t,e){let r=!0;return t==="always"||(t==="never"||e==="never")&&(r=!1),r}s(a2,"overlapAllowed");var roe=class{constructor(e,r,i){let n=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(r/i);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,i,n,a){this._forEachCell(r,i,n,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(a)}insertCircle(e,r,i,n){this._forEachCell(r-n,i-n,r+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(i),this.circles.push(n)}_insertBoxCell(e,r,i,n,a,o){this.boxCells[a].push(o)}_insertCircleCell(e,r,i,n,a,o){this.circleCells[a].push(o)}_query(e,r,i,n,a,o,l){if(i<0||e>this.width||n<0||r>this.height)return[];let u=[];if(e<=0&&r<=0&&this.width<=i&&this.height<=n){if(a)return[{key:null,x1:e,y1:r,x2:i,y2:n}];for(let c=0;c<this.boxKeys.length;c++)u.push({key:this.boxKeys[c],x1:this.bboxes[c*4],y1:this.bboxes[c*4+1],x2:this.bboxes[c*4+2],y2:this.bboxes[c*4+3]});for(let c=0;c<this.circleKeys.length;c++){let p=this.circles[c*3],m=this.circles[c*3+1],y=this.circles[c*3+2];u.push({key:this.circleKeys[c],x1:p-y,y1:m-y,x2:p+y,y2:m+y})}}else{let c={hitTest:a,overlapMode:o,seenUids:{box:{},circle:{}}};this._forEachCell(e,r,i,n,this._queryCell,u,c,l)}return u}query(e,r,i,n){return this._query(e,r,i,n,!1,null)}hitTest(e,r,i,n,a,o){return this._query(e,r,i,n,!0,a,o).length>0}hitTestCircle(e,r,i,n,a){let o=e-i,l=e+i,u=r-i,c=r+i;if(l<0||o>this.width||c<0||u>this.height)return!1;let p=[],m={hitTest:!0,overlapMode:n,circle:{x:e,y:r,radius:i},seenUids:{box:{},circle:{}}};return this._forEachCell(o,u,l,c,this._queryCellCircle,p,m,a),p.length>0}_queryCell(e,r,i,n,a,o,l,u){let{seenUids:c,hitTest:p,overlapMode:m}=l,y=this.boxCells[a];if(y!==null){let x=this.bboxes;for(let E of y)if(!c.box[E]){c.box[E]=!0;let M=E*4,I=this.boxKeys[E];if(e<=x[M+2]&&r<=x[M+3]&&i>=x[M+0]&&n>=x[M+1]&&(!u||u(I))&&(!p||!a2(m,I.overlapMode))&&(o.push({key:I,x1:x[M],y1:x[M+1],x2:x[M+2],y2:x[M+3]}),p))return!0}}let v=this.circleCells[a];if(v!==null){let x=this.circles;for(let E of v)if(!c.circle[E]){c.circle[E]=!0;let M=E*3,I=this.circleKeys[E];if(this._circleAndRectCollide(x[M],x[M+1],x[M+2],e,r,i,n)&&(!u||u(I))&&(!p||!a2(m,I.overlapMode))){let P=x[M],C=x[M+1],T=x[M+2];if(o.push({key:I,x1:P-T,y1:C-T,x2:P+T,y2:C+T}),p)return!0}}}return!1}_queryCellCircle(e,r,i,n,a,o,l,u){let{circle:c,seenUids:p,overlapMode:m}=l,y=this.boxCells[a];if(y!==null){let x=this.bboxes;for(let E of y)if(!p.box[E]){p.box[E]=!0;let M=E*4,I=this.boxKeys[E];if(this._circleAndRectCollide(c.x,c.y,c.radius,x[M+0],x[M+1],x[M+2],x[M+3])&&(!u||u(I))&&!a2(m,I.overlapMode))return o.push(!0),!0}}let v=this.circleCells[a];if(v!==null){let x=this.circles;for(let E of v)if(!p.circle[E]){p.circle[E]=!0;let M=E*3,I=this.circleKeys[E];if(this._circlesCollide(x[M],x[M+1],x[M+2],c.x,c.y,c.radius)&&(!u||u(I))&&!a2(m,I.overlapMode))return o.push(!0),!0}}}_forEachCell(e,r,i,n,a,o,l,u){let c=this._convertToXCellCoord(e),p=this._convertToYCellCoord(r),m=this._convertToXCellCoord(i),y=this._convertToYCellCoord(n);for(let v=c;v<=m;v++)for(let x=p;x<=y;x++){let E=this.xCellCount*x+v;if(a.call(this,e,r,i,n,E,o,l,u))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,i,n,a,o){let l=n-e,u=a-r,c=i+o;return c*c>l*l+u*u}_circleAndRectCollide(e,r,i,n,a,o,l){let u=(o-n)/2,c=Math.abs(e-(n+u));if(c>u+i)return!1;let p=(l-a)/2,m=Math.abs(r-(a+p));if(m>p+i)return!1;if(c<=u||m<=p)return!0;let y=c-u,v=m-p;return y*y+v*v<=i*i}};s(roe,"GridIndex");var aq=roe;N();var Iw=Rr(kn(),1);function CP(t,e,r,i,n){let a=Or.create();return e?(Or.scale(a,a,[1/n,1/n,1]),r||Or.rotateZ(a,a,i.angle)):Or.multiply(a,i.labelPlaneMatrix,t),a}s(CP,"getLabelPlaneMatrix");function VF(t,e,r,i,n){if(e){let a=Or.clone(t);return Or.scale(a,a,[n,n,1]),r||Or.rotateZ(a,a,-i.angle),a}else return i.glCoordMatrix}s(VF,"getGlCoordMatrix");function yc(t,e,r){let i;r?(i=[t.x,t.y,r(t.x,t.y),1],Kl.transformMat4(i,i,e)):(i=[t.x,t.y,0,1],TP(i,i,e));let n=i[3];return{point:new Iw.default(i[0]/n,i[1]/n),signedDistanceFromCamera:n}}s(yc,"project");function IP(t,e){return .5+.5*(t/e)}s(IP,"getPerspectiveRatio");function ioe(t,e){let r=t[0]/t[3],i=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&i>=-e[1]&&i<=e[1]}s(ioe,"isVisible");function noe(t,e,r,i,n,a,o,l,u,c){let p=i?t.textSizeData:t.iconSizeData,m=CA(p,r.transform.zoom),y=[256/r.width*2+1,256/r.height*2+1],v=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;v.clear();let x=t.lineVertexArray,E=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,M=r.transform.width/r.transform.height,I=!1;for(let P=0;P<E.length;P++){let C=E.get(P);if(C.hidden||C.writingMode===2&&!I){ky(C.numGlyphs,v);continue}I=!1;let T;if(c?(T=[C.anchorX,C.anchorY,c(C.anchorX,C.anchorY),1],Kl.transformMat4(T,T,e)):(T=[C.anchorX,C.anchorY,0,1],TP(T,T,e)),!ioe(T,y)){ky(C.numGlyphs,v);continue}let D=T[3],F=IP(r.transform.cameraToCenterDistance,D),k=AP(p,m,C),B=o?k/F:k*F,U=new Iw.default(C.anchorX,C.anchorY),z=yc(U,n,c).point,q={projections:{},offsets:{}},Z=iR(C,B,!1,l,e,n,a,t.glyphOffsetArray,x,v,z,U,q,M,u,c);I=Z.useVertical,(Z.notEnoughRoom||I||Z.needsFlipping&&iR(C,B,!0,l,e,n,a,t.glyphOffsetArray,x,v,z,U,q,M,u,c).notEnoughRoom)&&ky(C.numGlyphs,v)}i?t.text.dynamicLayoutVertexBuffer.updateData(v):t.icon.dynamicLayoutVertexBuffer.updateData(v)}s(noe,"updateLineLabels");function jF(t,e,r,i,n,a,o,l,u,c,p,m,y){let v=l.glyphStartIndex+l.numGlyphs,x=l.lineStartIndex,E=l.lineStartIndex+l.lineLength,M=e.getoffsetX(l.glyphStartIndex),I=e.getoffsetX(v-1),P=Tw(t*M,r,i,n,a,o,l.segment,x,E,u,c,p,m,y);if(!P)return null;let C=Tw(t*I,r,i,n,a,o,l.segment,x,E,u,c,p,m,y);return C?{first:P,last:C}:null}s(jF,"placeFirstAndLastGlyph");function rR(t,e,r,i){if(t===1){let n=Math.abs(r.y-e.y),a=Math.abs(r.x-e.x)*i;if(n>a)return{useVertical:!0}}return(t===2?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}s(rR,"requiresOrientationChange");function iR(t,e,r,i,n,a,o,l,u,c,p,m,y,v,x,E){let M=e/24,I=t.lineOffsetX*M,P=t.lineOffsetY*M,C;if(t.numGlyphs>1){let T=t.glyphStartIndex+t.numGlyphs,D=t.lineStartIndex,F=t.lineStartIndex+t.lineLength,k=jF(M,l,I,P,r,p,m,t,u,a,y,x,E);if(!k)return{notEnoughRoom:!0};let B=yc(k.first.point,o,E).point,U=yc(k.last.point,o,E).point;if(i&&!r){let z=rR(t.writingMode,B,U,v);if(z)return z}C=[k.first];for(let z=t.glyphStartIndex+1;z<T-1;z++){let q=Tw(M*l.getoffsetX(z),I,P,r,p,m,t.segment,D,F,u,a,y,x,E);if(q==null)return{notEnoughRoom:!0};C.push(q)}C.push(k.last)}else{if(i&&!r){let D=yc(m,n,E).point,F=t.lineStartIndex+t.segment+1,k=new Iw.default(u.getx(F),u.gety(F)),B=yc(k,n,E),U=B.signedDistanceFromCamera>0?B.point:$F(m,k,D,1,n,E),z=rR(t.writingMode,D,U,v);if(z)return z}let T=Tw(M*l.getoffsetX(t.glyphStartIndex),I,P,r,p,m,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,a,y,x,E);if(!T)return{notEnoughRoom:!0};C=[T]}for(let T of C)__(c,T.point,T.angle);return{}}s(iR,"placeGlyphsAlongLine");function $F(t,e,r,i,n,a){let o=yc(t.add(t.sub(e)._unit()),n,a).point,l=r.sub(o);return r.add(l._mult(i/l.mag()))}s($F,"projectTruncatedLineSegment");function RT(t,e){let{projectionCache:r,lineVertexArray:i,labelPlaneMatrix:n,tileAnchorPoint:a,distanceFromAnchor:o,getElevation:l,previousVertex:u,direction:c,absOffsetX:p}=e;if(r.projections[t])return r.projections[t];let m=new Iw.default(i.getx(t),i.gety(t)),y=yc(m,n,l);if(y.signedDistanceFromCamera>0)return r.projections[t]=y.point,y.point;let v=t-c,x=o===0?a:new Iw.default(i.getx(v),i.gety(v));return $F(x,m,u,p-o+1,n,l)}s(RT,"projectVertexToViewport");function OT(t,e,r){return t._unit()._perp()._mult(e*r)}s(OT,"transformToOffsetNormal");function aoe(t,e,r,i,n,a,o,l){let{projectionCache:u,direction:c}=l;if(u.offsets[t])return u.offsets[t];let p=r.add(e);if(t+c<i||t+c>=n)return u.offsets[t]=p,p;let m=RT(t+c,l),y=OT(m.sub(r),o,c),v=r.add(y),x=m.add(y);return u.offsets[t]=lZ(a,p,v,x)||p,u.offsets[t]}s(aoe,"findOffsetIntersectionPoint");function Tw(t,e,r,i,n,a,o,l,u,c,p,m,y,v){let x=i?t-e:t+e,E=x>0?1:-1,M=0;i&&(E*=-1,M=Math.PI),E<0&&(M+=Math.PI);let I=E>0?l+o:l+o+1,P=n,C=n,T,D,F=0,k=0,B=Math.abs(x),U=[],z;for(;F+k<=B;){if(I+=E,I<l||I>=u)return null;F+=k,C=P,D=T;let V={projectionCache:m,lineVertexArray:c,labelPlaneMatrix:p,tileAnchorPoint:a,distanceFromAnchor:F,getElevation:v,previousVertex:C,direction:E,absOffsetX:B};if(P=RT(I,V),r===0)U.push(C),z=P.sub(C);else{let ae,Y=P.sub(C);if(Y.mag()===0){let he=RT(I+E,V);ae=OT(he.sub(P),r,E)}else ae=OT(Y,r,E);D||(D=C.add(ae)),T=aoe(I,ae,P,l,u,D,r,V),U.push(D),z=T.sub(D)}k=z.mag()}let q=(B-F)/k,Z=z._mult(q)._add(D||C),Q=M+Math.atan2(P.y-C.y,P.x-C.x);return U.push(Z),{point:Z,angle:y?Q:0,path:U}}s(Tw,"placeGlyphAlongLine");var C9e=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ky(t,e){for(let r=0;r<t;r++){let i=e.length;e.resize(i+4),e.float32.set(C9e,i*3)}}s(ky,"hideGlyphs");function TP(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t[3]=r[3]*i+r[7]*n+r[15],t}s(TP,"xyTransformMat4");var ns=100,ooe=class{constructor(e,r=new aq(e.width+2*ns,e.height+2*ns,25),i=new aq(e.width+2*ns,e.height+2*ns,25)){this.transform=e,this.grid=r,this.ignoredGrid=i,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+ns,this.screenBottomBoundary=e.height+ns,this.gridRightBoundary=e.width+2*ns,this.gridBottomBoundary=e.height+2*ns,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,i,n,a,o){let l=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,o),u=i*l.perspectiveRatio,c=e.x1*u+l.point.x,p=e.y1*u+l.point.y,m=e.x2*u+l.point.x,y=e.y2*u+l.point.y;return!this.isInsideGrid(c,p,m,y)||r!=="always"&&this.grid.hitTest(c,p,m,y,r,a)||l.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[c,p,m,y],offscreen:this.isOffscreen(c,p,m,y)}}placeCollisionCircles(e,r,i,n,a,o,l,u,c,p,m,y,v,x){let E=[],M=new Ad.default(r.anchorX,r.anchorY),I=yc(M,o,x),P=IP(this.transform.cameraToCenterDistance,I.signedDistanceFromCamera),C=(p?a/P:a*P)/Ene,T=yc(M,l,x).point,D={projections:{},offsets:{}},F=r.lineOffsetX*C,k=r.lineOffsetY*C,B=jF(C,n,F,k,!1,T,M,r,i,l,D,!1,x),U=!1,z=!1,q=!0;if(B){let Z=y*.5*P+v,Q=new Ad.default(-ns,-ns),V=new Ad.default(this.screenRightBoundary,this.screenBottomBoundary),ae=new E9e,Y=B.first,he=B.last,J=[];for(let ue=Y.path.length-1;ue>=1;ue--)J.push(Y.path[ue]);for(let ue=1;ue<he.path.length;ue++)J.push(he.path[ue]);let ne=Z*2.5;if(u){let ue=J.map(K=>yc(K,u,x));ue.some(K=>K.signedDistanceFromCamera<=0)?J=[]:J=ue.map(K=>K.point)}let ee=[];if(J.length>0){let ue=J[0].clone(),K=J[0].clone();for(let ce=1;ce<J.length;ce++)ue.x=Math.min(ue.x,J[ce].x),ue.y=Math.min(ue.y,J[ce].y),K.x=Math.max(K.x,J[ce].x),K.y=Math.max(K.y,J[ce].y);ue.x>=Q.x&&K.x<=V.x&&ue.y>=Q.y&&K.y<=V.y?ee=[J]:K.x<Q.x||ue.x>V.x||K.y<Q.y||ue.y>V.y?ee=[]:ee=eoe([J],Q.x,Q.y,V.x,V.y)}for(let ue of ee){ae.reset(ue,Z*.25);let K=0;ae.length<=.5*Z?K=1:K=Math.ceil(ae.paddedLength/ne)+1;for(let ce=0;ce<K;ce++){let re=ce/Math.max(K-1,1),se=ae.lerp(re),de=se.x+ns,we=se.y+ns;E.push(de,we,Z,0);let Le=de-Z,fe=we-Z,Re=de+Z,me=we+Z;if(q=q&&this.isOffscreen(Le,fe,Re,me),z=z||this.isInsideGrid(Le,fe,Re,me),e!=="always"&&this.grid.hitTestCircle(de,we,Z,e,m)&&(U=!0,!c))return{circles:[],offscreen:!1,collisionDetected:U}}}}return{circles:!c&&U||!z||P<this.perspectiveRatioCutoff?[]:E,offscreen:q,collisionDetected:U}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let r=[],i=1/0,n=1/0,a=-1/0,o=-1/0;for(let p of e){let m=new Ad.default(p.x+ns,p.y+ns);i=Math.min(i,m.x),n=Math.min(n,m.y),a=Math.max(a,m.x),o=Math.max(o,m.y),r.push(m)}let l=this.grid.query(i,n,a,o).concat(this.ignoredGrid.query(i,n,a,o)),u={},c={};for(let p of l){let m=p.key;if(u[m.bucketInstanceId]===void 0&&(u[m.bucketInstanceId]={}),u[m.bucketInstanceId][m.featureIndex])continue;let y=[new Ad.default(p.x1,p.y1),new Ad.default(p.x2,p.y1),new Ad.default(p.x2,p.y2),new Ad.default(p.x1,p.y2)];U7(r,y)&&(u[m.bucketInstanceId][m.featureIndex]=!0,c[m.bucketInstanceId]===void 0&&(c[m.bucketInstanceId]=[]),c[m.bucketInstanceId].push(m.featureIndex))}return c}insertCollisionBox(e,r,i,n,a,o){let l=i?this.ignoredGrid:this.grid,u={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:r};l.insert(u,e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,i,n,a,o){let l=i?this.ignoredGrid:this.grid,u={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:r};for(let c=0;c<e.length;c+=4)l.insertCircle(u,e[c],e[c+1],e[c+2])}projectAndGetPerspectiveRatio(e,r,i,n){let a;return n?(a=[r,i,n(r,i),1],Kl.transformMat4(a,a,e)):(a=[r,i,0,1],TP(a,a,e)),{point:new Ad.default((a[0]/a[3]+1)/2*this.transform.width+ns,(-a[1]/a[3]+1)/2*this.transform.height+ns),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/a[3])}}isOffscreen(e,r,i,n){return i<ns||e>=this.screenRightBoundary||n<ns||r>this.screenBottomBoundary}isInsideGrid(e,r,i,n){return i>=0&&e<this.gridRightBoundary&&n>=0&&r<this.gridBottomBoundary}getViewportMatrix(){let e=Or.identity([]);return Or.translate(e,e,[-ns,-ns,0]),e}};s(ooe,"CollisionIndex");var I9e=ooe;N();N();var T9e=Rr(kn(),1),soe=class loe extends T9e.default{constructor(e,r,i,n){super(e,r),this.angle=i,n!==void 0&&(this.segment=n)}clone(){return new loe(this.x,this.y,this.angle,this.segment)}};s(soe,"Anchor");var P9e=soe;Lr("Anchor",P9e);N();N();N();Rr(kn(),1);N();Rr(kn(),1);N();Rr(A9(),1);Rr(kn(),1);Rr(KX(),1);N();var nR=(t=>(t[t.center=1]="center",t[t.left=2]="left",t[t.right=3]="right",t[t.top=4]="top",t[t.bottom=5]="bottom",t[t["top-left"]=6]="top-left",t[t["top-right"]=7]="top-right",t[t["bottom-left"]=8]="bottom-left",t[t["bottom-right"]=9]="bottom-right",t))(nR||{});function uoe(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}s(uoe,"getAnchorJustification");N();function ku(t,e,r){return e*(8192/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}s(ku,"pixelsToTileUnits");var GF=Rr(kn(),1),coe=class{constructor(e,r,i,n){e?this.opacity=Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):this.opacity=n&&i?1:0,this.placed=i}isHidden(){return this.opacity===0&&!this.placed}};s(coe,"OpacityState");var oq=coe,hoe=class{constructor(e,r,i,n,a){this.text=new oq(e?e.text:null,r,i,a),this.icon=new oq(e?e.icon:null,r,n,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}};s(hoe,"JointOpacityState");var Ab=hoe,poe=class{constructor(e,r,i){this.text=e,this.icon=r,this.skipFade=i}};s(poe,"JointPlacement");var sq=poe,doe=class{constructor(){this.invProjMatrix=Or.create(),this.viewportMatrix=Or.create(),this.circles=[]}};s(doe,"CollisionCircleArray");var L9e=doe,foe=class{constructor(e,r,i,n,a){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=a}};s(foe,"RetainedQueryData");var D9e=foe,moe=class{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:s(i=>i.collisionGroupID===r,"predicate")}}return this.collisionGroups[e]}};s(moe,"CollisionGroups");var R9e=moe;function aR(t,e,r,i,n){let{horizontalAlign:a,verticalAlign:o}=RF(t),l=-(a-.5)*e,u=-(o-.5)*r;return new GF.default(l+i[0]*n,u+i[1]*n)}s(aR,"calculateVariableLayoutShift");function jE(t,e,r,i,n,a){let{x1:o,x2:l,y1:u,y2:c,anchorPointX:p,anchorPointY:m}=t,y=new GF.default(e,r);return i&&y._rotate(n?a:-a),{x1:o+y.x,y1:u+y.y,x2:l+y.x,y2:c+y.y,anchorPointX:p,anchorPointY:m}}s(jE,"shiftVariableCollisionBox");var goe=class{constructor(e,r,i,n,a){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new I9e(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new R9e(n),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,r,i,n){let a=i.getBucket(r),o=i.latestFeatureIndex;if(!a||!o||r.id!==a.layerIds[0])return;let l=i.collisionBoxArray,u=a.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),p=i.tileSize/8192,m=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),y=u.get("text-pitch-alignment")==="map",v=u.get("text-rotation-alignment")==="map",x=ku(i,1,this.transform.zoom),E=CP(m,y,v,this.transform,x),M=null;if(y){let P=VF(m,y,v,this.transform,x);M=Or.multiply([],this.transform.labelPlaneMatrix,P)}this.retainedQueryData[a.bucketInstanceId]=new D9e(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,i.tileID);let I={bucket:a,layout:u,posMatrix:m,textLabelPlaneMatrix:E,labelToScreenMatrix:M,scale:c,textPixelRatio:p,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:CA(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(n)for(let P of a.sortKeyRanges){let{sortKey:C,symbolInstanceStart:T,symbolInstanceEnd:D}=P;e.push({sortKey:C,symbolInstanceStart:T,symbolInstanceEnd:D,parameters:I})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:I})}attemptAnchorPlacement(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M){let I=nR[e.textAnchor],P=[e.textOffset0,e.textOffset1],C=aR(I,i,n,P,a),T=this.collisionIndex.placeCollisionBox(jE(r,C.x,C.y,o,l,this.transform.angle),m,u,c,p.predicate,M);if(!(E&&this.collisionIndex.placeCollisionBox(jE(E,C.x,C.y,o,l,this.transform.angle),m,u,c,p.predicate,M).box.length===0)&&T.box.length>0){let D;if(this.prevPlacement&&this.prevPlacement.variableOffsets[y.crossTileID]&&this.prevPlacement.placements[y.crossTileID]&&this.prevPlacement.placements[y.crossTileID].text&&(D=this.prevPlacement.variableOffsets[y.crossTileID].anchor),y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[y.crossTileID]={textOffset:P,width:i,height:n,anchor:I,textBoxScale:a,prevAnchor:D},this.markUsedJustification(v,I,y,x),v.allowVerticalPlacement&&(this.markUsedOrientation(v,x,y),this.placedOrientations[y.crossTileID]=x),{shift:C,placedGlyphBoxes:T}}}placeLayerBucketPart(e,r,i){let{bucket:n,layout:a,posMatrix:o,textLabelPlaneMatrix:l,labelToScreenMatrix:u,textPixelRatio:c,holdingForFade:p,collisionBoxArray:m,partiallyEvaluatedTextSize:y,collisionGroup:v}=e.parameters,x=a.get("text-optional"),E=a.get("icon-optional"),M=Mw(a,"text-overlap","text-allow-overlap"),I=M==="always",P=Mw(a,"icon-overlap","icon-allow-overlap"),C=P==="always",T=a.get("text-rotation-alignment")==="map",D=a.get("text-pitch-alignment")==="map",F=a.get("icon-text-fit")!=="none",k=a.get("symbol-z-order")==="viewport-y",B=I&&(C||!n.hasIconData()||E),U=C&&(I||!n.hasTextData()||x);!n.collisionArrays&&m&&n.deserializeCollisionBoxes(m);let z=this.retainedQueryData[n.bucketInstanceId].tileID,q=this.terrain?(Q,V)=>this.terrain.getElevation(z,Q,V):null,Z=s((Q,V)=>{var ae,Y;if(r[Q.crossTileID])return;if(p){this.placements[Q.crossTileID]=new sq(!1,!1,!1);return}let he=!1,J=!1,ne=!0,ee=null,ue={box:null,offscreen:null},K={box:null},ce=null,re=null,se=null,de=0,we=0,Le=0;V.textFeatureIndex?de=V.textFeatureIndex:Q.useRuntimeCollisionCircles&&(de=Q.featureIndex),V.verticalTextFeatureIndex&&(we=V.verticalTextFeatureIndex);let fe=V.textBox;if(fe){let Ae=s(tt=>{let We=1;if(n.allowVerticalPlacement&&!tt&&this.prevPlacement){let at=this.prevPlacement.placedOrientations[Q.crossTileID];at&&(this.placedOrientations[Q.crossTileID]=at,We=at,this.markUsedOrientation(n,We,Q))}return We},"updatePreviousOrientationIfNotPlaced"),Ue=s((tt,We)=>{if(n.allowVerticalPlacement&&Q.numVerticalGlyphVertices>0&&V.verticalTextBox){for(let at of n.writingModes)if(at===2?(ue=We(),K=ue):ue=tt(),ue&&ue.box&&ue.box.length)break}else ue=tt()},"placeTextForPlacementModes"),_e=Q.textAnchorOffsetStartIndex,lt=Q.textAnchorOffsetEndIndex;if(lt===_e){let tt=s((We,at)=>{let Lt=this.collisionIndex.placeCollisionBox(We,M,c,o,v.predicate,q);return Lt&&Lt.box&&Lt.box.length&&(this.markUsedOrientation(n,at,Q),this.placedOrientations[Q.crossTileID]=at),Lt},"placeBox");Ue(s(()=>tt(fe,1),"placeHorizontal"),s(()=>{let We=V.verticalTextBox;return n.allowVerticalPlacement&&Q.numVerticalGlyphVertices>0&&We?tt(We,2):{box:null,offscreen:null}},"placeVertical")),Ae(ue&&ue.box&&ue.box.length)}else{let tt=nR[(Y=(ae=this.prevPlacement)==null?void 0:ae.variableOffsets[Q.crossTileID])==null?void 0:Y.anchor],We=s((Lt,dt,Me)=>{let ve=Lt.x2-Lt.x1,Ze=Lt.y2-Lt.y1,It=Q.textBoxScale,Rt=F&&P==="never"?dt:null,Et={box:[],offscreen:!1},pt=M==="never"?1:2,Yt="never";tt&&pt++;for(let Kt=0;Kt<pt;Kt++){for(let $t=_e;$t<lt;$t++){let jt=n.textAnchorOffsets.get($t);if(tt&&jt.textAnchor!==tt)continue;let Nt=this.attemptAnchorPlacement(jt,Lt,ve,Ze,It,T,D,c,o,v,Yt,Q,n,Me,Rt,q);if(Nt&&(Et=Nt.placedGlyphBoxes,Et&&Et.box&&Et.box.length))return he=!0,ee=Nt.shift,Et}tt?tt=null:Yt=M}return Et},"placeBoxForVariableAnchors");Ue(s(()=>We(fe,V.iconBox,1),"placeHorizontal"),s(()=>{let Lt=V.verticalTextBox,dt=ue&&ue.box&&ue.box.length;return n.allowVerticalPlacement&&!dt&&Q.numVerticalGlyphVertices>0&&Lt?We(Lt,V.verticalIconBox,2):{box:null,offscreen:null}},"placeVertical")),ue&&(he=ue.box,ne=ue.offscreen);let at=Ae(ue&&ue.box);if(!he&&this.prevPlacement){let Lt=this.prevPlacement.variableOffsets[Q.crossTileID];Lt&&(this.variableOffsets[Q.crossTileID]=Lt,this.markUsedJustification(n,Lt.anchor,Q,at))}}}if(ce=ue,he=ce&&ce.box&&ce.box.length>0,ne=ce&&ce.offscreen,Q.useRuntimeCollisionCircles){let Ae=n.text.placedSymbolArray.get(Q.centerJustifiedTextSymbolIndex),Ue=AP(n.textSizeData,y,Ae),_e=a.get("text-padding"),lt=Q.collisionCircleDiameter;re=this.collisionIndex.placeCollisionCircles(M,Ae,n.lineVertexArray,n.glyphOffsetArray,Ue,o,l,u,i,D,v.predicate,lt,_e,q),re.circles.length&&re.collisionDetected&&!i&&Ol("Collisions detected, but collision boxes are not shown"),he=I||re.circles.length>0&&!re.collisionDetected,ne=ne&&re.offscreen}if(V.iconFeatureIndex&&(Le=V.iconFeatureIndex),V.iconBox){let Ae=s(Ue=>{let _e=F&&ee?jE(Ue,ee.x,ee.y,T,D,this.transform.angle):Ue;return this.collisionIndex.placeCollisionBox(_e,P,c,o,v.predicate,q)},"placeIconFeature");K&&K.box&&K.box.length&&V.verticalIconBox?(se=Ae(V.verticalIconBox),J=se.box.length>0):(se=Ae(V.iconBox),J=se.box.length>0),ne=ne&&se.offscreen}let Re=x||Q.numHorizontalGlyphVertices===0&&Q.numVerticalGlyphVertices===0,me=E||Q.numIconVertices===0;if(!Re&&!me?J=he=J&&he:me?Re||(J=J&&he):he=J&&he,he&&ce&&ce.box&&(K&&K.box&&we?this.collisionIndex.insertCollisionBox(ce.box,M,a.get("text-ignore-placement"),n.bucketInstanceId,we,v.ID):this.collisionIndex.insertCollisionBox(ce.box,M,a.get("text-ignore-placement"),n.bucketInstanceId,de,v.ID)),J&&se&&this.collisionIndex.insertCollisionBox(se.box,P,a.get("icon-ignore-placement"),n.bucketInstanceId,Le,v.ID),re&&(he&&this.collisionIndex.insertCollisionCircles(re.circles,M,a.get("text-ignore-placement"),n.bucketInstanceId,de,v.ID),i)){let Ae=n.bucketInstanceId,Ue=this.collisionCircleArrays[Ae];Ue===void 0&&(Ue=this.collisionCircleArrays[Ae]=new L9e);for(let _e=0;_e<re.circles.length;_e+=4)Ue.circles.push(re.circles[_e+0]),Ue.circles.push(re.circles[_e+1]),Ue.circles.push(re.circles[_e+2]),Ue.circles.push(re.collisionDetected?1:0)}if(Q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(n.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Q.crossTileID]=new sq(he||B,J||U,ne||n.justReloaded),r[Q.crossTileID]=!0},"placeSymbol");if(k){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let Q=n.getSortedSymbolIndexes(this.transform.angle);for(let V=Q.length-1;V>=0;--V){let ae=Q[V];Z(n.symbolInstances.get(ae),n.collisionArrays[ae])}}else for(let Q=e.symbolInstanceStart;Q<e.symbolInstanceEnd;Q++)Z(n.symbolInstances.get(Q),n.collisionArrays[Q]);if(i&&n.bucketInstanceId in this.collisionCircleArrays){let Q=this.collisionCircleArrays[n.bucketInstanceId];Or.invert(Q.invProjMatrix,o),Q.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}markUsedJustification(e,r,i,n){let a={left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex},o;n===2?o=i.verticalPlacedTextSymbolIndex:o=a[uoe(r)];let l=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(let u of l)u>=0&&(o>=0&&u!==o?e.text.placedSymbolArray.get(u).crossTileID=0:e.text.placedSymbolArray.get(u).crossTileID=i.crossTileID)}markUsedOrientation(e,r,i){let n=r===1||r===3?r:0,a=r===2?r:0,o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(let l of o)e.text.placedSymbolArray.get(l).placedOrientation=n;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let r=this.prevPlacement,i=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;let n=r?r.symbolFadeChange(e):1,a=r?r.opacities:{},o=r?r.variableOffsets:{},l=r?r.placedOrientations:{};for(let u in this.placements){let c=this.placements[u],p=a[u];p?(this.opacities[u]=new Ab(p,n,c.text,c.icon),i=i||c.text!==p.text.placed||c.icon!==p.icon.placed):(this.opacities[u]=new Ab(null,n,c.text,c.icon,c.skipFade),i=i||c.text||c.icon)}for(let u in a){let c=a[u];if(!this.opacities[u]){let p=new Ab(c,n,!1,!1);p.isHidden()||(this.opacities[u]=p,i=i||c.text.placed||c.icon.placed)}}for(let u in o)!this.variableOffsets[u]&&this.opacities[u]&&!this.opacities[u].isHidden()&&(this.variableOffsets[u]=o[u]);for(let u in l)!this.placedOrientations[u]&&this.opacities[u]&&!this.opacities[u].isHidden()&&(this.placedOrientations[u]=l[u]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){let i={};for(let n of r){let a=n.getBucket(e);a&&n.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,i,n.collisionBoxArray)}}updateBucketOpacities(e,r,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let n=e.layers[0],a=n.layout,o=new Ab(null,0,!1,!1,!0),l=a.get("text-allow-overlap"),u=a.get("icon-allow-overlap"),c=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),p=a.get("text-rotation-alignment")==="map",m=a.get("text-pitch-alignment")==="map",y=a.get("icon-text-fit")!=="none",v=new Ab(null,0,l&&(u||!e.hasIconData()||a.get("icon-optional")),u&&(l||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);let x=s((E,M,I)=>{for(let P=0;P<M/4;P++)E.opacityVertexArray.emplaceBack(I);E.hasVisibleVertices=E.hasVisibleVertices||I!==Sb},"addOpacities");for(let E=0;E<e.symbolInstances.length;E++){let M=e.symbolInstances.get(E),{numHorizontalGlyphVertices:I,numVerticalGlyphVertices:P,crossTileID:C}=M,T=r[C],D=this.opacities[C];T?D=o:D||(D=v,this.opacities[C]=D),r[C]=!0;let F=I>0||P>0,k=M.numIconVertices>0,B=this.placedOrientations[M.crossTileID],U=B===2,z=B===1||B===3;if(F){let q=oR(D.text),Z=U?Sb:q;x(e.text,I,Z);let Q=z?Sb:q;x(e.text,P,Q);let V=D.text.isHidden();[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach(he=>{he>=0&&(e.text.placedSymbolArray.get(he).hidden=V||U?1:0)}),M.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(M.verticalPlacedTextSymbolIndex).hidden=V||z?1:0);let ae=this.variableOffsets[M.crossTileID];ae&&this.markUsedJustification(e,ae.anchor,M,B);let Y=this.placedOrientations[M.crossTileID];Y&&(this.markUsedJustification(e,"left",M,Y),this.markUsedOrientation(e,Y,M))}if(k){let q=oR(D.icon),Z=!(y&&M.verticalPlacedIconSymbolIndex&&U);if(M.placedIconSymbolIndex>=0){let Q=Z?q:Sb;x(e.icon,M.numIconVertices,Q),e.icon.placedSymbolArray.get(M.placedIconSymbolIndex).hidden=D.icon.isHidden()}if(M.verticalPlacedIconSymbolIndex>=0){let Q=Z?Sb:q;x(e.icon,M.numVerticalIconVertices,Q),e.icon.placedSymbolArray.get(M.verticalPlacedIconSymbolIndex).hidden=D.icon.isHidden()}}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let q=e.collisionArrays[E];if(q){let Z=new GF.default(0,0);if(q.textBox||q.verticalTextBox){let V=!0;if(c){let ae=this.variableOffsets[C];ae?(Z=aR(ae.anchor,ae.width,ae.height,ae.textOffset,ae.textBoxScale),p&&Z._rotate(m?this.transform.angle:-this.transform.angle)):V=!1}q.textBox&&o2(e.textCollisionBox.collisionVertexArray,D.text.placed,!V||U,Z.x,Z.y),q.verticalTextBox&&o2(e.textCollisionBox.collisionVertexArray,D.text.placed,!V||z,Z.x,Z.y)}let Q=!!(!z&&q.verticalIconBox);q.iconBox&&o2(e.iconCollisionBox.collisionVertexArray,D.icon.placed,Q,y?Z.x:0,y?Z.y:0),q.verticalIconBox&&o2(e.iconCollisionBox.collisionVertexArray,D.icon.placed,!Q,y?Z.x:0,y?Z.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(e.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(e.text.layoutVertexArray.length,") / 4"));if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(e.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(e.icon.layoutVertexArray.length,") / 4"));if(e.bucketInstanceId in this.collisionCircleArrays){let E=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=E.invProjMatrix,e.placementViewportMatrix=E.viewportMatrix,e.collisionCircleArray=E.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){let i=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}};s(goe,"Placement");var O9e=goe;function o2(t,e,r,i,n){t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0)}s(o2,"updateCollisionVertices");var k9e=Math.pow(2,25),N9e=Math.pow(2,24),F9e=Math.pow(2,17),B9e=Math.pow(2,16),z9e=Math.pow(2,9),U9e=Math.pow(2,8),V9e=Math.pow(2,1);function oR(t){if(t.opacity===0&&!t.placed)return 0;if(t.opacity===1&&t.placed)return 4294967295;let e=t.placed?1:0,r=Math.floor(t.opacity*127);return r*k9e+e*N9e+r*F9e+e*B9e+r*z9e+e*U9e+r*V9e+e}s(oR,"packOpacity");var Sb=0,yoe=class{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,i,n,a){let o=this._bucketParts;for(;this._currentTileIndex<e.length;){let l=e[this._currentTileIndex];if(r.getBucketParts(o,n,l,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((l,u)=>l.sortKey-u.sortKey));this._currentPartIndex<o.length;){let l=o[this._currentPartIndex];if(r.placeLayerBucketPart(l,this._seenCrossTileIDs,i),this._currentPartIndex++,a())return!0}return!1}};s(yoe,"LayerPlacement");var j9e=yoe,voe=class{constructor(e,r,i,n,a,o,l,u){this.placement=new O9e(e,r,o,l,u),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,r,i){let n=yn.now(),a=s(()=>this._forceFullPlacement?!1:yn.now()-n>2,"shouldPausePlacement");for(;this._currentPlacementIndex>=0;){let o=e[this._currentPlacementIndex],l=r[o],u=this.placement.collisionIndex.transform.zoom;if(l.type==="symbol"&&(!l.minzoom||l.minzoom<=u)&&(!l.maxzoom||l.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new j9e(l)),this._inProgressLayer.continuePlacement(i[l.source],this.placement,this._showCollisionBoxes,l,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}};s(voe,"PauseablePlacement");var $9e=voe;N();N();var lq=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],kL=1,Mb=8,_oe=class xoe{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let n=i>>4;if(n!==kL)throw new Error("Got v".concat(n," data when expected v").concat(kL,"."));let a=lq[i&15];if(!a)throw new Error("Unrecognized array type.");let[o]=new Uint16Array(e,2,1),[l]=new Uint32Array(e,4,1);return new xoe(l,o,a,e)}constructor(e,r=64,i=Float64Array,n){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=lq.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,l=e*this.IndexArrayType.BYTES_PER_ELEMENT,u=(8-l%8)%8;if(a<0)throw new Error("Unexpected typed array class: ".concat(i,"."));n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,Mb,e),this.coords=new this.ArrayType(this.data,Mb+l+u,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Mb+o+l+u),this.ids=new this.IndexArrayType(this.data,Mb,e),this.coords=new this.ArrayType(this.data,Mb+l+u,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(kL<<4)+a]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return kT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:a,coords:o,nodeSize:l}=this,u=[0,a.length-1,0],c=[];for(;u.length;){let p=u.pop()||0,m=u.pop()||0,y=u.pop()||0;if(m-y<=l){for(let M=y;M<=m;M++){let I=o[2*M],P=o[2*M+1];I>=e&&I<=i&&P>=r&&P<=n&&c.push(a[M])}continue}let v=y+m>>1,x=o[2*v],E=o[2*v+1];x>=e&&x<=i&&E>=r&&E<=n&&c.push(a[v]),(p===0?e<=x:r<=E)&&(u.push(y),u.push(v-1),u.push(1-p)),(p===0?i>=x:n>=E)&&(u.push(v+1),u.push(m),u.push(1-p))}return c}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:n,coords:a,nodeSize:o}=this,l=[0,n.length-1,0],u=[],c=i*i;for(;l.length;){let p=l.pop()||0,m=l.pop()||0,y=l.pop()||0;if(m-y<=o){for(let M=y;M<=m;M++)sR(a[2*M],a[2*M+1],e,r)<=c&&u.push(n[M]);continue}let v=y+m>>1,x=a[2*v],E=a[2*v+1];sR(x,E,e,r)<=c&&u.push(n[v]),(p===0?e-i<=x:r-i<=E)&&(l.push(y),l.push(v-1),l.push(1-p)),(p===0?e+i>=x:r+i>=E)&&(l.push(v+1),l.push(m),l.push(1-p))}return u}};s(_oe,"KDBush");var G9e=_oe;function kT(t,e,r,i,n,a){if(n-i<=r)return;let o=i+n>>1;HF(t,e,o,i,n,a),kT(t,e,r,i,o-1,1-a),kT(t,e,r,o+1,n,1-a)}s(kT,"sort");function HF(t,e,r,i,n,a){for(;n>i;){if(n-i>600){let c=n-i+1,p=r-i+1,m=Math.log(c),y=.5*Math.exp(2*m/3),v=.5*Math.sqrt(m*y*(c-y)/c)*(p-c/2<0?-1:1),x=Math.max(i,Math.floor(r-p*y/c+v)),E=Math.min(n,Math.floor(r+(c-p)*y/c+v));HF(t,e,r,x,E,a)}let o=e[2*r+a],l=i,u=n;for(C0(t,e,i,r),e[2*n+a]>o&&C0(t,e,i,n);l<u;){for(C0(t,e,l,u),l++,u--;e[2*l+a]<o;)l++;for(;e[2*u+a]>o;)u--}e[2*i+a]===o?C0(t,e,i,u):(u++,C0(t,e,u,n)),u<=r&&(i=u+1),r<=u&&(n=u-1)}}s(HF,"select");function C0(t,e,r,i){$E(t,r,i),$E(e,2*r,2*i),$E(e,2*r+1,2*i+1)}s(C0,"swapItem");function $E(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}s($E,"swap");function sR(t,e,r,i){let n=t-r,a=e-i;return n*n+a*a}s(sR,"sqDist");var Eb=512/8192/2,H9e=128,boe=class{constructor(e,r,i){this.tileID=e,this.bucketInstanceId=i,this._symbolsByKey={};let n=new Map;for(let a=0;a<r.length;a++){let o=r.get(a),l=o.key,u=n.get(l);u?u.push(o):n.set(l,[o])}for(let[a,o]of n){let l=o.map(p=>({x:Math.floor(p.anchorX*Eb),y:Math.floor(p.anchorY*Eb)})),u=o.map(p=>p.crossTileID),c={positions:l,crossTileIDs:u};if(c.positions.length>H9e){let p=new G9e(c.positions.length,16,Uint16Array);for(let{x:m,y}of c.positions)p.add(m,y);p.finish(),delete c.positions,c.index=p}this._symbolsByKey[a]=c}}getScaledCoordinates(e,r){let{x:i,y:n,z:a}=this.tileID.canonical,{x:o,y:l,z:u}=r.canonical,c=u-a,p=Eb/Math.pow(2,c),m=(o*8192+e.anchorX)*p,y=(l*8192+e.anchorY)*p,v=i*8192*Eb,x=n*8192*Eb;return{x:Math.floor(m-v),y:Math.floor(y-x)}}findMatches(e,r,i){let n=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let a=0;a<e.length;a++){let o=e.get(a);if(o.crossTileID)continue;let l=this._symbolsByKey[o.key];if(!l)continue;let u=this.getScaledCoordinates(o,r);if(l.index){let c=l.index.range(u.x-n,u.y-n,u.x+n,u.y+n).sort();for(let p of c){let m=l.crossTileIDs[p];if(!i[m]){i[m]=!0,o.crossTileID=m;break}}}else if(l.positions)for(let c=0;c<l.positions.length;c++){let p=l.positions[c],m=l.crossTileIDs[c];if(Math.abs(p.x-u.x)<=n&&Math.abs(p.y-u.y)<=n&&!i[m]){i[m]=!0,o.crossTileID=m;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}};s(boe,"TileLayerIndex");var q9e=boe,woe=class{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}};s(woe,"CrossTileIDs");var W9e=woe,Aoe=class{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let r=Math.round((e-this.lng)/360);if(r!==0)for(let i in this.indexes){let n=this.indexes[i],a={};for(let o in n){let l=n[o];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+r),a[l.tileID.key]=l}this.indexes[i]=a}this.lng=e}addBucket(e,r,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let a=0;a<r.symbolInstances.length;a++){let o=r.symbolInstances.get(a);o.crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let n=this.usedCrossTileIDs[e.overscaledZ];for(let a in this.indexes){let o=this.indexes[a];if(Number(a)>e.overscaledZ)for(let l in o){let u=o[l];u.tileID.isChildOf(e)&&u.findMatches(r.symbolInstances,e,n)}else{let l=e.scaledTo(Number(a)),u=o[l.key];u&&u.findMatches(r.symbolInstances,e,n)}}for(let a=0;a<r.symbolInstances.length;a++){let o=r.symbolInstances.get(a);o.crossTileID||(o.crossTileID=i.generate(),n[o.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new q9e(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(let i of r.getCrossTileIDsLists())for(let n of i)delete this.usedCrossTileIDs[e][n]}removeStaleBuckets(e){let r=!1;for(let i in this.indexes){let n=this.indexes[i];for(let a in n)e[n[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[a]),delete n[a],r=!0)}return r}};s(Aoe,"CrossTileSymbolLayerIndex");var X9e=Aoe,Soe=class{constructor(){this.layerIndexes={},this.crossTileIDs=new W9e,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,i){let n=this.layerIndexes[e.id];n===void 0&&(n=this.layerIndexes[e.id]=new X9e);let a=!1,o={};n.handleWrapJump(i);for(let l of r){let u=l.getBucket(e);!u||e.id!==u.layerIds[0]||(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(a=!0),o[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(a=!0),a}pruneUnusedLayers(e){let r={};e.forEach(i=>{r[i]=!0});for(let i in this.layerIndexes)r[i]||delete this.layerIndexes[i]}};s(Soe,"CrossTileSymbolIndex");var Moe=Soe,IM=s((t,e)=>hP(t,e&&e.filter(r=>r.identifier!=="source.canvas")),"emitValidationErrors"),Z9e=aJ(),Eoe=class extends Nl{constructor(e,r={}){super(),this._rtlPluginLoaded=s(()=>{for(let i in this.sourceCaches){let n=this.sourceCaches[i].getSource().type;(n==="vector"||n==="geojson")&&this.sourceCaches[i].reload()}},"_rtlPluginLoaded"),this.map=e,this.dispatcher=new lae(MP(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(i,n)=>this.getGlyphs(i,n)),this.dispatcher.registerMessageHandler("GI",(i,n)=>this.getImages(i,n)),this.imageManager=new YNe,this.imageManager.setEventedParent(this),this.glyphManager=new JNe(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new t9e(256,512),this.crossTileSymbolIndex=new Moe,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new vJ,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",T9()),b_().on(Q6,this._rtlPluginLoaded),this.on("data",i=>{if(i.dataType!=="source"||i.sourceDataType!=="metadata")return;let n=this.sourceCaches[i.sourceId];if(!n)return;let a=n.getSource();if(!(!a||!a.vectorLayerIds))for(let o in this._layers){let l=this._layers[o];l.source===a.id&&this._validateLayer(l)}})}loadURL(e,r={},i){this.fire(new pr("dataloading",{dataType:"style"})),r.validate=typeof r.validate=="boolean"?r.validate:!0;let n=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,Y3(n,this._loadStyleRequest).then(a=>{this._loadStyleRequest=null,this._load(a.data,r,i)}).catch(a=>{this._loadStyleRequest=null,a&&this.fire(new di(a))})}loadJSON(e,r={},i){this.fire(new pr("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,yn.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,i)}).catch(()=>{})}loadEmpty(){this.fire(new pr("dataloading",{dataType:"style"})),this._load(Z9e,{validate:!1})}_load(e,r,i){var n;let a=r.transformStyle?r.transformStyle(i,e):e;if(!(r.validate&&IM(this,Ss(a)))){this._loaded=!0,this.stylesheet=a;for(let o in a.sources)this.addSource(o,a.sources[o],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new e9e(this.stylesheet.light),this.map.setTerrain((n=this.stylesheet.terrain)!=null?n:null),this.fire(new pr("data",{dataType:"style"})),this.fire(new pr("style.load"))}}_createLayers(){let e=t6(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(let r of e){let i=UE(r);i.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=i}}_loadSprite(e,r=!1,i=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController;let n;qne(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(a=>{if(this._spriteRequest=null,a)for(let o in a){this._spritesImagesIds[o]=[];let l=this._spritesImagesIds[o]?this._spritesImagesIds[o].filter(u=>!(u in a)):[];for(let u of l)this.imageManager.removeImage(u),this._changedImages[u]=!0;for(let u in a[o]){let c=o==="default"?u:"".concat(o,":").concat(u);this._spritesImagesIds[o].push(c),c in this.imageManager.images?this.imageManager.updateImage(c,a[o][u],!1):this.imageManager.addImage(c,a[o][u]),r&&(this._changedImages[c]=!0)}}}).catch(a=>{this._spriteRequest=null,n=a,this.fire(new di(n))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"})),i&&i(n)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"}))}_validateLayer(e){let r=this.sourceCaches[e.source];if(!r)return;let i=e.sourceLayer;if(!i)return;let n=r.getSource();(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(i)===-1)&&this.fire(new di(new Error('Source layer "'.concat(i,'" ')+'does not exist on source "'.concat(n.id,'" ')+'as specified by style layer "'.concat(e.id,'".'))))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let r=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r);let i=[];for(let n of e)r[n]&&i.push(r[n]);return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let r=Object.keys(this._layers);for(let i of r){let n=this._layers[i];n.type!=="custom"&&(e[i]=n.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let r=this._changed;if(r){let n=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);(n.length||a.length)&&this._updateWorkerLayers(n,a);for(let o in this._updatedSources){let l=this._updatedSources[o];if(l==="reload")this._reloadSource(o);else if(l==="clear")this._clearSource(o);else throw new Error("Invalid action ".concat(l))}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}let i={};for(let n in this.sourceCaches){let a=this.sourceCaches[n];i[n]=a.used,a.used=!1}for(let n of this._order){let a=this._layers[n];a.recalculate(e,this._availableImages),!a.isHidden(e.zoom)&&a.source&&(this.sourceCaches[a.source].used=!0)}for(let n in i){let a=this.sourceCaches[n];!!i[n]!=!!a.used&&a.fire(new pr("data",{sourceDataType:"visibility",dataType:"source",sourceId:n}))}this.light.recalculate(e),this.z=e.zoom,r&&this.fire(new pr("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var i;this._checkLoaded();let n=this.serialize();if(e=r.transformStyle?r.transformStyle(n,e):e,((i=r.validate)!=null?i:!0)&&IM(this,Ss(e)))return!1;e=mc(e),e.layers=t6(e.layers);let a=DZ(n,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error("Unimplemented: ".concat(o.unimplemented.join(", "),"."));if(o.operations.length===0)return!1;for(let l of o.operations)l();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let r=[],i=[];for(let n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,n.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,n.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,n.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,n.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,n.args));break;case"addSource":r.push(()=>this.addSource.apply(this,n.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,n.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,n.args));break;case"setLight":r.push(()=>this.setLight.apply(this,n.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,n.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,n.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,n.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,n.args));break;case"setTransition":r.push(()=>{});break;default:i.push(n.command);break}return{operations:r,unimplemented:i}}addImage(e,r){if(this.getImage(e))return this.fire(new di(new Error('An image named "'.concat(e,'" already exists.'))));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new di(new Error('An image named "'.concat(e,'" does not exist.'))));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,i={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error('Source "'.concat(e,'" already exists.'));if(!r.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(r).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(Ss.source,"sources.".concat(e),r,null,i))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);let n=this.sourceCaches[e]=new Cw(e,r,this.dispatcher);n.style=this,n.setEventedParent(this,()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:e})),n.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let i in this._layers)if(this._layers[i].source===e)return this.fire(new di(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(i,'" is using it.'))));let r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new pr("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID=".concat(e));let i=this.sourceCaches[e].getSource();if(i.type!=="geojson")throw new Error("geojsonSource.type is ".concat(i.type,", which is !== 'geojson"));i.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,i={}){this._checkLoaded();let n=e.id;if(this.getLayer(n)){this.fire(new di(new Error('Layer "'.concat(n,'" already exists on this map.'))));return}let a;if(e.type==="custom"){if(IM(this,Gne(e)))return;a=UE(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(n,e.source),e=mc(e),e=Fr(e,{source:n})),this._validate(Ss.layer,"layers.".concat(n),e,{arrayIndex:-1},i))return;a=UE(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:n}})}let o=r?this._order.indexOf(r):this._order.length;if(r&&o===-1){this.fire(new di(new Error('Cannot add layer "'.concat(n,'" before non-existing layer "').concat(r,'".'))));return}if(this._order.splice(o,0,n),this._layerOrderChanged=!0,this._layers[n]=a,this._removedLayers[n]&&a.source&&a.type!=="custom"){let l=this._removedLayers[n];delete this._removedLayers[n],l.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e]){this.fire(new di(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));return}if(e===r)return;let i=this._order.indexOf(e);this._order.splice(i,1);let n=r?this._order.indexOf(r):this._order.length;if(r&&n===-1){this.fire(new di(new Error('Cannot move layer "'.concat(e,'" before non-existing layer "').concat(r,'".'))));return}this._order.splice(n,0,e),this._layerOrderChanged=!0}removeLayer(e){this._checkLoaded();let r=this._layers[e];if(!r){this.fire(new di(new Error('Cannot remove non-existing layer "'.concat(e,'".'))));return}r.setEventedParent(null);let i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,i){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new di(new Error('Cannot set the zoom range of non-existing layer "'.concat(e,'".'))));return}n.minzoom===r&&n.maxzoom===i||(r!=null&&(n.minzoom=r),i!=null&&(n.maxzoom=i),this._updateLayer(n))}setFilter(e,r,i={}){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new di(new Error('Cannot filter non-existing layer "'.concat(e,'".'))));return}if(!zm(n.filter,r)){if(r==null){n.filter=void 0,this._updateLayer(n);return}this._validate(Ss.filter,"layers.".concat(n.id,".filter"),r,null,i)||(n.filter=mc(r),this._updateLayer(n))}}getFilter(e){return mc(this.getLayer(e).filter)}setLayoutProperty(e,r,i,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new di(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}zm(a.getLayoutProperty(r),i)||(a.setLayoutProperty(r,i,n),this._updateLayer(a))}getLayoutProperty(e,r){let i=this.getLayer(e);if(!i){this.fire(new di(new Error('Cannot get style of non-existing layer "'.concat(e,'".'))));return}return i.getLayoutProperty(r)}setPaintProperty(e,r,i,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new di(new Error('Cannot style non-existing layer "'.concat(e,'".'))));return}zm(a.getPaintProperty(r),i)||(a.setPaintProperty(r,i,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null)}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();let i=e.source,n=e.sourceLayer,a=this.sourceCaches[i];if(a===void 0){this.fire(new di(new Error("The source '".concat(i,"' does not exist in the map's style."))));return}let o=a.getSource().type;if(o==="geojson"&&n){this.fire(new di(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(o==="vector"&&!n){this.fire(new di(new Error("The sourceLayer parameter must be provided for vector source types.")));return}e.id===void 0&&this.fire(new di(new Error("The feature id parameter must be provided."))),a.setFeatureState(n,e.id,r)}removeFeatureState(e,r){this._checkLoaded();let i=e.source,n=this.sourceCaches[i];if(n===void 0){this.fire(new di(new Error("The source '".concat(i,"' does not exist in the map's style."))));return}let a=n.getSource().type,o=a==="vector"?e.sourceLayer:void 0;if(a==="vector"&&!o){this.fire(new di(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(r&&typeof e.id!="string"&&typeof e.id!="number"){this.fire(new di(new Error("A feature id is required to remove its specific state property.")));return}n.removeFeatureState(o,e.id,r)}getFeatureState(e){this._checkLoaded();let r=e.source,i=e.sourceLayer,n=this.sourceCaches[r];if(n===void 0){this.fire(new di(new Error("The source '".concat(r,"' does not exist in the map's style."))));return}if(n.getSource().type==="vector"&&!i){this.fire(new di(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return e.id===void 0&&this.fire(new di(new Error("The feature id parameter must be provided."))),n.getFeatureState(i,e.id)}getTransition(){return Fr({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=X3(this.sourceCaches,a=>a.serialize()),r=this._serializeByIds(this._order),i=this.map.getTerrain()||void 0,n=this.stylesheet;return E9({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:e,layers:r,terrain:i},a=>a!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let r=s(o=>this._layers[o].type==="fill-extrusion","isLayer3D"),i={},n=[];for(let o=this._order.length-1;o>=0;o--){let l=this._order[o];if(r(l)){i[l]=o;for(let u of e){let c=u[l];if(c)for(let p of c)n.push(p)}}}n.sort((o,l)=>l.intersectionZ-o.intersectionZ);let a=[];for(let o=this._order.length-1;o>=0;o--){let l=this._order[o];if(r(l))for(let u=n.length-1;u>=0;u--){let c=n[u].feature;if(i[c.layer.id]<o)break;a.push(c),n.pop()}else for(let u of e){let c=u[l];if(c)for(let p of c)a.push(p.feature)}}return a}queryRenderedFeatures(e,r,i){r&&r.filter&&this._validate(Ss.filter,"queryRenderedFeatures.filter",r.filter,null,r);let n={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new di(new Error("parameters.layers must be an Array."))),[];for(let l of r.layers){let u=this._layers[l];if(!u)return this.fire(new di(new Error("The layer '".concat(l,"' does not exist in the map's style and cannot be queried for features.")))),[];n[u.source]=!0}}let a=[];r.availableImages=this._availableImages;let o=this._serializedAllLayers();for(let l in this.sourceCaches)r.layers&&!n[l]||a.push(hae(this.sourceCaches[l],this._layers,o,e,r,i));return this.placement&&a.push(pae(this._layers,o,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,r){r&&r.filter&&this._validate(Ss.filter,"querySourceFeatures.filter",r.filter,null,r);let i=this.sourceCaches[e];return i?dae(i,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();let i=this.light.getLight(),n=!1;for(let o in e)if(!zm(e[o],i[o])){n=!0;break}if(!n)return;let a={now:yn.now(),transition:Fr({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(a)}_validate(e,r,i,n,a={}){return a&&a.validate===!1?!1:IM(this,e.call(Ss,Fr({key:r,style:this.serialize(),value:i,styleSpec:Ut},n)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),b_().off(Q6,this._rtlPluginLoaded);for(let r in this._layers)this._layers[r].setEventedParent(null);for(let r in this.sourceCaches){let i=this.sourceCaches[r];i.setEventedParent(null),i.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,i,n,a=!1){let o=!1,l=!1,u={};for(let c of this._order){let p=this._layers[c];if(p.type!=="symbol")continue;if(!u[p.source]){let y=this.sourceCaches[p.source];u[p.source]=y.getRenderableIds(!0).map(v=>y.getTileByID(v)).sort((v,x)=>x.tileID.overscaledZ-v.tileID.overscaledZ||(v.tileID.isLessThan(x.tileID)?-1:1))}let m=this.crossTileSymbolIndex.addLayer(p,u[p.source],e.center.lng);o=o||m}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),a=a||this._layerOrderChanged||i===0,(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(yn.now(),e.zoom))&&(this.pauseablePlacement=new $9e(e,this.map.terrain,this._order,a,r,i,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(yn.now()),l=!0),o&&this.pauseablePlacement.placement.setStale()),l||o)for(let c of this._order){let p=this._layers[c];p.type==="symbol"&&this.placement.updateLayerOpacities(p,u[p.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(yn.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}async getImages(e,r){let i=await this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();let n=this.sourceCaches[r.source];return n&&n.setDependencies(r.tileID.key,r.type,r.icons),i}async getGlyphs(e,r){let i=await this.glyphManager.getGlyphs(r.stacks),n=this.sourceCaches[r.source];return n&&n.setDependencies(r.tileID.key,r.type,[""]),i}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),!(e&&this._validate(Ss.glyphs,"glyphs",e,null,r))&&(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,i={},n){this._checkLoaded();let a=[{id:e,url:r}],o=[...ow(this.stylesheet.sprite),...a];this._validate(Ss.sprite,"sprite",o,null,i)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,n))}removeSprite(e){this._checkLoaded();let r=ow(this.stylesheet.sprite);if(!r.find(i=>i.id===e)){this.fire(new di(new Error('Sprite "'.concat(e,`" doesn't exists on this map.`))));return}if(this._spritesImagesIds[e])for(let i of this._spritesImagesIds[e])this.imageManager.removeImage(i),this._changedImages[i]=!0;r.splice(r.findIndex(i=>i.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new pr("data",{dataType:"style"}))}getSprite(){return ow(this.stylesheet.sprite)}setSprite(e,r={},i){this._checkLoaded(),!(e&&this._validate(Ss.sprite,"sprite",e,null,r))&&(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,i):(this._unloadSprite(),i&&i(null)))}};s(Eoe,"Style");var uq=Eoe;N();N();var NL=no([{name:"a_pos",type:"Int16",components:2}]);N();N();var Y9e=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`;N();var K9e=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`;N();var J9e=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var Q9e="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";N();var e7e=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var t7e="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";N();var r7e=`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var i7e=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`;N();var n7e="void main() {gl_FragColor=vec4(1.0);}";N();var a7e="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";N();var o7e=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var s7e=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`;N();var l7e=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`;N();var u7e="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";N();var c7e="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}";N();var h7e="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}";N();var p7e="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}";N();var d7e="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";N();var f7e="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}";N();var m7e="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}";N();var g7e=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var y7e=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`;N();var v7e=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var _7e=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;N();var x7e=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var b7e=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;N();var w7e=`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var A7e=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`;N();var S7e=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var M7e=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`;N();var E7e=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var C7e=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`;N();var I7e=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var T7e="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";N();var P7e=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var L7e="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}";N();var D7e=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var R7e=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;N();var O7e=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var k7e=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;N();var N7e=`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var F7e=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`;N();var B7e=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var z7e=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`;N();var U7e=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var V7e="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}";N();var j7e=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var $7e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`;N();var G7e=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var H7e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`;N();var q7e=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;N();var W7e=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`;N();var X7e="varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}";N();var Z7e="precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}";N();var Y7e="uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}";N();var FL="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}",s2={prelude:Xn(Y9e,K9e),background:Xn(J9e,Q9e),backgroundPattern:Xn(e7e,t7e),circle:Xn(r7e,i7e),clippingMask:Xn(n7e,a7e),heatmap:Xn(o7e,s7e),heatmapTexture:Xn(l7e,u7e),collisionBox:Xn(c7e,h7e),collisionCircle:Xn(p7e,d7e),debug:Xn(f7e,m7e),fill:Xn(g7e,y7e),fillOutline:Xn(v7e,_7e),fillOutlinePattern:Xn(x7e,b7e),fillPattern:Xn(w7e,A7e),fillExtrusion:Xn(S7e,M7e),fillExtrusionPattern:Xn(E7e,C7e),hillshadePrepare:Xn(I7e,T7e),hillshade:Xn(P7e,L7e),line:Xn(D7e,R7e),lineGradient:Xn(O7e,k7e),linePattern:Xn(N7e,F7e),lineSDF:Xn(B7e,z7e),raster:Xn(U7e,V7e),symbolIcon:Xn(j7e,$7e),symbolSDF:Xn(G7e,H7e),symbolTextAndIcon:Xn(q7e,W7e),terrain:Xn(Y7e,FL),terrainDepth:Xn(X7e,FL),terrainCoords:Xn(Z7e,FL)};function Xn(t,e){let r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(n):n,l={};return t=t.replace(r,(u,c,p,m,y)=>(l[y]=!0,c==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
varying `).concat(p," ").concat(m," ").concat(y,`;
#else
uniform `).concat(p," ").concat(m," u_").concat(y,`;
#endif
`):`
#ifdef HAS_UNIFORM_u_`.concat(y,`
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`))),e=e.replace(r,(u,c,p,m,y)=>{let v=m==="float"?"vec2":"vec4",x=y.match(/color/)?"color":v;return l[y]?c==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
uniform lowp float u_`).concat(y,`_t;
attribute `).concat(p," ").concat(v," a_").concat(y,`;
varying `).concat(p," ").concat(m," ").concat(y,`;
#else
uniform `).concat(p," ").concat(m," u_").concat(y,`;
#endif
`):x==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(y," = a_").concat(y,`;
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(y," = unpack_mix_").concat(x,"(a_").concat(y,", u_").concat(y,`_t);
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`):c==="define"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
uniform lowp float u_`).concat(y,`_t;
attribute `).concat(p," ").concat(v," a_").concat(y,`;
#else
uniform `).concat(p," ").concat(m," u_").concat(y,`;
#endif
`):x==="vec4"?`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(p," ").concat(m," ").concat(y," = a_").concat(y,`;
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`):`
#ifndef HAS_UNIFORM_u_`.concat(y,`
    `).concat(p," ").concat(m," ").concat(y," = unpack_mix_").concat(x,"(a_").concat(y,", u_").concat(y,`_t);
#else
    `).concat(p," ").concat(m," ").concat(y," = u_").concat(y,`;
#endif
`)}),{fragmentSource:t,vertexSource:e,staticAttributes:i,staticUniforms:o}}s(Xn,"compile");N();N();var Coe=class{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,i,n,a,o,l,u,c){this.context=e;let p=this.boundPaintVertexBuffers.length!==n.length;for(let m=0;!p&&m<n.length;m++)this.boundPaintVertexBuffers[m]!==n[m]&&(p=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==i||p||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==l||this.boundDynamicVertexBuffer2!==u||this.boundDynamicVertexBuffer3!==c?this.freshBind(r,i,n,a,o,l,u,c):(e.bindVertexArray.set(this.vao),l&&l.bind(),a&&a.dynamicDraw&&a.bind(),u&&u.bind(),c&&c.bind())}freshBind(e,r,i,n,a,o,l,u){let c=e.numAttributes,p=this.context,m=p.gl;this.vao&&this.destroy(),this.vao=p.createVertexArray(),p.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=l,this.boundDynamicVertexBuffer3=u,r.enableAttributes(m,e);for(let y of i)y.enableAttributes(m,e);o&&o.enableAttributes(m,e),l&&l.enableAttributes(m,e),u&&u.enableAttributes(m,e),r.bind(),r.setVertexAttribPointers(m,e,a);for(let y of i)y.bind(),y.setVertexAttribPointers(m,e,a);o&&(o.bind(),o.setVertexAttribPointers(m,e,a)),n&&n.bind(),l&&(l.bind(),l.setVertexAttribPointers(m,e,a)),u&&(u.bind(),u.setVertexAttribPointers(m,e,a)),p.currentNumAttributes=c}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}};s(Coe,"VertexArrayObject");var K7e=Coe;N();var J7e=s((t,e)=>({u_depth:new qi(t,e.u_depth),u_terrain:new qi(t,e.u_terrain),u_terrain_dim:new Mr(t,e.u_terrain_dim),u_terrain_matrix:new vn(t,e.u_terrain_matrix),u_terrain_unpack:new B7(t,e.u_terrain_unpack),u_terrain_exaggeration:new Mr(t,e.u_terrain_exaggeration)}),"terrainPreludeUniforms"),Q7e=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_texture:new qi(t,e.u_texture),u_ele_delta:new Mr(t,e.u_ele_delta)}),"terrainUniforms"),eFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_ele_delta:new Mr(t,e.u_ele_delta)}),"terrainDepthUniforms"),tFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_texture:new qi(t,e.u_texture),u_terrain_coords_id:new Mr(t,e.u_terrain_coords_id),u_ele_delta:new Mr(t,e.u_ele_delta)}),"terrainCoordsUniforms"),rFe=s((t,e)=>({u_matrix:t,u_texture:0,u_ele_delta:e}),"terrainUniformValues"),iFe=s((t,e)=>({u_matrix:t,u_ele_delta:e}),"terrainDepthUniformValues"),nFe=s((t,e,r)=>({u_matrix:t,u_terrain_coords_id:e/255,u_texture:0,u_ele_delta:r}),"terrainCoordsUniformValues");function GE(t){let e=[];for(let r=0;r<t.length;r++){if(t[r]===null)continue;let i=t[r].split(" ");e.push(i.pop())}return e}s(GE,"getTokenizedAttributesAndUniforms");var Ioe=class{constructor(e,r,i,n,a,o){let l=e.gl;this.program=l.createProgram();let u=GE(r.staticAttributes),c=i?i.getBinderAttributes():[],p=u.concat(c),m=s2.prelude.staticUniforms?GE(s2.prelude.staticUniforms):[],y=r.staticUniforms?GE(r.staticUniforms):[],v=i?i.getBinderUniforms():[],x=m.concat(y).concat(v),E=[];for(let F of x)E.indexOf(F)<0&&E.push(F);let M=i?i.defines():[];a&&M.push("#define OVERDRAW_INSPECTOR;"),o&&M.push("#define TERRAIN3D;");let I=M.concat(s2.prelude.fragmentSource,r.fragmentSource).join(`
`),P=M.concat(s2.prelude.vertexSource,r.vertexSource).join(`
`),C=l.createShader(l.FRAGMENT_SHADER);if(l.isContextLost()){this.failedToCreate=!0;return}if(l.shaderSource(C,I),l.compileShader(C),!l.getShaderParameter(C,l.COMPILE_STATUS))throw new Error("Could not compile fragment shader: ".concat(l.getShaderInfoLog(C)));l.attachShader(this.program,C);let T=l.createShader(l.VERTEX_SHADER);if(l.isContextLost()){this.failedToCreate=!0;return}if(l.shaderSource(T,P),l.compileShader(T),!l.getShaderParameter(T,l.COMPILE_STATUS))throw new Error("Could not compile vertex shader: ".concat(l.getShaderInfoLog(T)));l.attachShader(this.program,T),this.attributes={};let D={};this.numAttributes=p.length;for(let F=0;F<this.numAttributes;F++)p[F]&&(l.bindAttribLocation(this.program,F,p[F]),this.attributes[p[F]]=F);if(l.linkProgram(this.program),!l.getProgramParameter(this.program,l.LINK_STATUS))throw new Error("Program failed to link: ".concat(l.getProgramInfoLog(this.program)));l.deleteShader(T),l.deleteShader(C);for(let F=0;F<E.length;F++){let k=E[F];if(k&&!D[k]){let B=l.getUniformLocation(this.program,k);B&&(D[k]=B)}}this.fixedUniforms=n(e,D),this.terrainUniforms=J7e(e,D),this.binderUniforms=i?i.getUniforms(e,D):[]}draw(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P){let C=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(i),e.setStencilMode(n),e.setColorMode(a),e.setCullFace(o),u){e.activeTexture.set(C.TEXTURE2),C.bindTexture(C.TEXTURE_2D,u.depthTexture),e.activeTexture.set(C.TEXTURE3),C.bindTexture(C.TEXTURE_2D,u.texture);for(let D in this.terrainUniforms)this.terrainUniforms[D].set(u[D])}for(let D in this.fixedUniforms)this.fixedUniforms[D].set(l[D]);E&&E.setUniforms(e,this.binderUniforms,v,{zoom:x});let T=0;switch(r){case C.LINES:T=2;break;case C.TRIANGLES:T=3;break;case C.LINE_STRIP:T=1;break}for(let D of y.get()){let F=D.vaos||(D.vaos={});(F[c]||(F[c]=new K7e)).bind(e,this,p,E?E.getPaintVertexBuffers():[],m,D.vertexOffset,M,I,P),C.drawElements(r,D.primitiveLength*T,C.UNSIGNED_SHORT,D.primitiveOffset*T*2)}}};s(Ioe,"Program");var aFe=Ioe;N();N();N();function qF(t,e,r){let i=1/ku(r,1,e.transform.tileZoom),n=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=a*(r.tileID.canonical.x+r.tileID.wrap*n),l=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,l>>16],u_pixel_coord_lower:[o&65535,l&65535]}}s(qF,"patternUniformValues");function Toe(t,e,r,i){let n=r.imageManager.getPattern(t.from.toString()),a=r.imageManager.getPattern(t.to.toString()),{width:o,height:l}=r.imageManager.getPixelSize(),u=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,r.transform.tileZoom)/u,p=c*(i.tileID.canonical.x+i.tileID.wrap*u),m=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,l],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/ku(i,1,r.transform.tileZoom),u_pixel_coord_upper:[p>>16,m>>16],u_pixel_coord_lower:[p&65535,m&65535]}}s(Toe,"bgPatternUniformValues");var oFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_lightpos:new cf(t,e.u_lightpos),u_lightintensity:new Mr(t,e.u_lightintensity),u_lightcolor:new cf(t,e.u_lightcolor),u_vertical_gradient:new Mr(t,e.u_vertical_gradient),u_opacity:new Mr(t,e.u_opacity)}),"fillExtrusionUniforms"),sFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_lightpos:new cf(t,e.u_lightpos),u_lightintensity:new Mr(t,e.u_lightintensity),u_lightcolor:new cf(t,e.u_lightcolor),u_vertical_gradient:new Mr(t,e.u_vertical_gradient),u_height_factor:new Mr(t,e.u_height_factor),u_image:new qi(t,e.u_image),u_texsize:new nn(t,e.u_texsize),u_pixel_coord_upper:new nn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new nn(t,e.u_pixel_coord_lower),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade),u_opacity:new Mr(t,e.u_opacity)}),"fillExtrusionPatternUniforms"),Poe=s((t,e,r,i)=>{let n=e.style.light,a=n.properties.get("position"),o=[a.x,a.y,a.z],l=B6.create();n.properties.get("anchor")==="viewport"&&B6.fromRotation(l,-e.transform.angle),kh.transformMat3(o,o,l);let u=n.properties.get("color");return{u_matrix:t,u_lightpos:o,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},"fillExtrusionUniformValues"),lFe=s((t,e,r,i,n,a,o)=>Fr(Poe(t,e,r,i),qF(a,e,o),{u_height_factor:-Math.pow(2,n.overscaledZ)/o.tileSize/8}),"fillExtrusionPatternUniformValues");N();var uFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix)}),"fillUniforms"),cFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_image:new qi(t,e.u_image),u_texsize:new nn(t,e.u_texsize),u_pixel_coord_upper:new nn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new nn(t,e.u_pixel_coord_lower),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade)}),"fillPatternUniforms"),hFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_world:new nn(t,e.u_world)}),"fillOutlineUniforms"),pFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_world:new nn(t,e.u_world),u_image:new qi(t,e.u_image),u_texsize:new nn(t,e.u_texsize),u_pixel_coord_upper:new nn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new nn(t,e.u_pixel_coord_lower),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade)}),"fillOutlinePatternUniforms"),Loe=s(t=>({u_matrix:t}),"fillUniformValues"),Doe=s((t,e,r,i)=>Fr(Loe(t),qF(r,e,i)),"fillPatternUniformValues"),dFe=s((t,e)=>({u_matrix:t,u_world:e}),"fillOutlineUniformValues"),fFe=s((t,e,r,i,n)=>Fr(Doe(t,e,r,i),{u_world:n}),"fillOutlinePatternUniformValues");N();var mFe=s((t,e)=>({u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_scale_with_map:new qi(t,e.u_scale_with_map),u_pitch_with_map:new qi(t,e.u_pitch_with_map),u_extrude_scale:new nn(t,e.u_extrude_scale),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_matrix:new vn(t,e.u_matrix)}),"circleUniforms"),gFe=s((t,e,r,i)=>{let n=t.transform,a,o;if(i.paint.get("circle-pitch-alignment")==="map"){let l=ku(r,1,n.zoom);a=!0,o=[l,l]}else a=!1,o=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+(i.paint.get("circle-pitch-scale")==="map"),u_matrix:t.translatePosMatrix(e.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},"circleUniformValues");N();var yFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new Mr(t,e.u_pixels_to_tile_units),u_extrude_scale:new nn(t,e.u_extrude_scale),u_overscale_factor:new Mr(t,e.u_overscale_factor)}),"collisionUniforms"),vFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_inv_matrix:new vn(t,e.u_inv_matrix),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_viewport_size:new nn(t,e.u_viewport_size)}),"collisionCircleUniforms"),_Fe=s((t,e,r)=>{let i=ku(r,1,e.zoom),n=Math.pow(2,e.zoom-r.tileID.overscaledZ),a=r.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[e.pixelsToGLUnits[0]/(i*n),e.pixelsToGLUnits[1]/(i*n)],u_overscale_factor:a}},"collisionUniformValues"),xFe=s((t,e,r)=>({u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}),"collisionCircleUniformValues");N();var bFe=s((t,e)=>({u_color:new J1(t,e.u_color),u_matrix:new vn(t,e.u_matrix),u_overlay:new qi(t,e.u_overlay),u_overlay_scale:new Mr(t,e.u_overlay_scale)}),"debugUniforms"),cq=s((t,e,r=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:r}),"debugUniformValues");N();var wFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix)}),"clippingMaskUniforms"),hq=s(t=>({u_matrix:t}),"clippingMaskUniformValues");N();var AFe=s((t,e)=>({u_extrude_scale:new Mr(t,e.u_extrude_scale),u_intensity:new Mr(t,e.u_intensity),u_matrix:new vn(t,e.u_matrix)}),"heatmapUniforms"),SFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_world:new nn(t,e.u_world),u_image:new qi(t,e.u_image),u_color_ramp:new qi(t,e.u_color_ramp),u_opacity:new Mr(t,e.u_opacity)}),"heatmapTextureUniforms"),MFe=s((t,e,r,i)=>({u_matrix:t,u_extrude_scale:ku(e,1,r),u_intensity:i}),"heatmapUniformValues"),EFe=s((t,e,r,i)=>{let n=Or.create();Or.ortho(n,0,t.width,t.height,0,0,1);let a=t.context.gl;return{u_matrix:n,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:e.paint.get("heatmap-opacity")}},"heatmapTextureUniformValues");N();var CFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_image:new qi(t,e.u_image),u_latrange:new nn(t,e.u_latrange),u_light:new nn(t,e.u_light),u_shadow:new J1(t,e.u_shadow),u_highlight:new J1(t,e.u_highlight),u_accent:new J1(t,e.u_accent)}),"hillshadeUniforms"),IFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_image:new qi(t,e.u_image),u_dimension:new nn(t,e.u_dimension),u_zoom:new Mr(t,e.u_zoom),u_unpack:new B7(t,e.u_unpack)}),"hillshadePrepareUniforms"),TFe=s((t,e,r,i)=>{let n=r.paint.get("hillshade-shadow-color"),a=r.paint.get("hillshade-highlight-color"),o=r.paint.get("hillshade-accent-color"),l=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);r.paint.get("hillshade-illumination-anchor")==="viewport"&&(l-=t.transform.angle);let u=!t.options.moving;return{u_matrix:i?i.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),u),u_image:0,u_latrange:Roe(t,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),l],u_shadow:n,u_highlight:a,u_accent:o}},"hillshadeUniformValues"),PFe=s((t,e)=>{let r=e.stride,i=Or.create();return Or.ortho(i,0,8192,-8192,0,0,1),Or.translate(i,i,[0,-8192,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:t.overscaledZ,u_unpack:e.getUnpackVector()}},"hillshadeUniformPrepareValues");function Roe(t,e){let r=Math.pow(2,e.canonical.z),i=e.canonical.y;return[new nl(0,i/r).toLngLat().lat,new nl(0,(i+1)/r).toLngLat().lat]}s(Roe,"getTileLatRange");N();var LFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_units_to_pixels:new nn(t,e.u_units_to_pixels)}),"lineUniforms"),DFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_units_to_pixels:new nn(t,e.u_units_to_pixels),u_image:new qi(t,e.u_image),u_image_height:new Mr(t,e.u_image_height)}),"lineGradientUniforms"),RFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_texsize:new nn(t,e.u_texsize),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_image:new qi(t,e.u_image),u_units_to_pixels:new nn(t,e.u_units_to_pixels),u_scale:new cf(t,e.u_scale),u_fade:new Mr(t,e.u_fade)}),"linePatternUniforms"),OFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_ratio:new Mr(t,e.u_ratio),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_units_to_pixels:new nn(t,e.u_units_to_pixels),u_patternscale_a:new nn(t,e.u_patternscale_a),u_patternscale_b:new nn(t,e.u_patternscale_b),u_sdfgamma:new Mr(t,e.u_sdfgamma),u_image:new qi(t,e.u_image),u_tex_y_a:new Mr(t,e.u_tex_y_a),u_tex_y_b:new Mr(t,e.u_tex_y_b),u_mix:new Mr(t,e.u_mix)}),"lineSDFUniforms"),WF=s((t,e,r,i)=>{let n=t.transform;return{u_matrix:ZF(t,e,r,i),u_ratio:1/ku(e,1,n.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},"lineUniformValues"),kFe=s((t,e,r,i,n)=>Fr(WF(t,e,r,n),{u_image:0,u_image_height:i}),"lineGradientUniformValues"),NFe=s((t,e,r,i,n)=>{let a=t.transform,o=XF(e,a);return{u_matrix:ZF(t,e,r,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/ku(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},"linePatternUniformValues"),FFe=s((t,e,r,i,n,a)=>{let o=t.transform,l=t.lineAtlas,u=XF(e,o),c=r.layout.get("line-cap")==="round",p=l.getDash(i.from,c),m=l.getDash(i.to,c),y=p.width*n.fromScale,v=m.width*n.toScale;return Fr(WF(t,e,r,a),{u_patternscale_a:[u/y,-p.height/2],u_patternscale_b:[u/v,-m.height/2],u_sdfgamma:l.width/(Math.min(y,v)*256*t.pixelRatio)/2,u_image:0,u_tex_y_a:p.y,u_tex_y_b:m.y,u_mix:n.t})},"lineSDFUniformValues");function XF(t,e){return 1/ku(t,1,e.tileZoom)}s(XF,"calculateTileRatio");function ZF(t,e,r,i){return t.translatePosMatrix(i?i.posMatrix:e.tileID.posMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}s(ZF,"calculateMatrix");N();var BFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_tl_parent:new nn(t,e.u_tl_parent),u_scale_parent:new Mr(t,e.u_scale_parent),u_buffer_scale:new Mr(t,e.u_buffer_scale),u_fade_t:new Mr(t,e.u_fade_t),u_opacity:new Mr(t,e.u_opacity),u_image0:new qi(t,e.u_image0),u_image1:new qi(t,e.u_image1),u_brightness_low:new Mr(t,e.u_brightness_low),u_brightness_high:new Mr(t,e.u_brightness_high),u_saturation_factor:new Mr(t,e.u_saturation_factor),u_contrast_factor:new Mr(t,e.u_contrast_factor),u_spin_weights:new cf(t,e.u_spin_weights)}),"rasterUniforms"),zFe=s((t,e,r,i,n)=>({u_matrix:t,u_tl_parent:e,u_scale_parent:r,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:Noe(n.paint.get("raster-saturation")),u_contrast_factor:koe(n.paint.get("raster-contrast")),u_spin_weights:Ooe(n.paint.get("raster-hue-rotate"))}),"rasterUniformValues");function Ooe(t){t*=Math.PI/180;let e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}s(Ooe,"spinWeights");function koe(t){return t>0?1/(1-t):1+t}s(koe,"contrastFactor");function Noe(t){return t>0?1-1/(1.001-t):-t}s(Noe,"saturationFactor");N();var UFe=s((t,e)=>({u_is_size_zoom_constant:new qi(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new qi(t,e.u_is_size_feature_constant),u_size_t:new Mr(t,e.u_size_t),u_size:new Mr(t,e.u_size),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pitch:new Mr(t,e.u_pitch),u_rotate_symbol:new qi(t,e.u_rotate_symbol),u_aspect_ratio:new Mr(t,e.u_aspect_ratio),u_fade_change:new Mr(t,e.u_fade_change),u_matrix:new vn(t,e.u_matrix),u_label_plane_matrix:new vn(t,e.u_label_plane_matrix),u_coord_matrix:new vn(t,e.u_coord_matrix),u_is_text:new qi(t,e.u_is_text),u_pitch_with_map:new qi(t,e.u_pitch_with_map),u_texsize:new nn(t,e.u_texsize),u_texture:new qi(t,e.u_texture)}),"symbolIconUniforms"),VFe=s((t,e)=>({u_is_size_zoom_constant:new qi(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new qi(t,e.u_is_size_feature_constant),u_size_t:new Mr(t,e.u_size_t),u_size:new Mr(t,e.u_size),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pitch:new Mr(t,e.u_pitch),u_rotate_symbol:new qi(t,e.u_rotate_symbol),u_aspect_ratio:new Mr(t,e.u_aspect_ratio),u_fade_change:new Mr(t,e.u_fade_change),u_matrix:new vn(t,e.u_matrix),u_label_plane_matrix:new vn(t,e.u_label_plane_matrix),u_coord_matrix:new vn(t,e.u_coord_matrix),u_is_text:new qi(t,e.u_is_text),u_pitch_with_map:new qi(t,e.u_pitch_with_map),u_texsize:new nn(t,e.u_texsize),u_texture:new qi(t,e.u_texture),u_gamma_scale:new Mr(t,e.u_gamma_scale),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_is_halo:new qi(t,e.u_is_halo)}),"symbolSDFUniforms"),jFe=s((t,e)=>({u_is_size_zoom_constant:new qi(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new qi(t,e.u_is_size_feature_constant),u_size_t:new Mr(t,e.u_size_t),u_size:new Mr(t,e.u_size),u_camera_to_center_distance:new Mr(t,e.u_camera_to_center_distance),u_pitch:new Mr(t,e.u_pitch),u_rotate_symbol:new qi(t,e.u_rotate_symbol),u_aspect_ratio:new Mr(t,e.u_aspect_ratio),u_fade_change:new Mr(t,e.u_fade_change),u_matrix:new vn(t,e.u_matrix),u_label_plane_matrix:new vn(t,e.u_label_plane_matrix),u_coord_matrix:new vn(t,e.u_coord_matrix),u_is_text:new qi(t,e.u_is_text),u_pitch_with_map:new qi(t,e.u_pitch_with_map),u_texsize:new nn(t,e.u_texsize),u_texsize_icon:new nn(t,e.u_texsize_icon),u_texture:new qi(t,e.u_texture),u_texture_icon:new qi(t,e.u_texture_icon),u_gamma_scale:new Mr(t,e.u_gamma_scale),u_device_pixel_ratio:new Mr(t,e.u_device_pixel_ratio),u_is_halo:new qi(t,e.u_is_halo)}),"symbolTextAndIconUniforms"),Foe=s((t,e,r,i,n,a,o,l,u,c)=>{let p=n.transform;return{u_is_size_zoom_constant:+(t==="constant"||t==="source"),u_is_size_feature_constant:+(t==="constant"||t==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:p.cameraToCenterDistance,u_pitch:p.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:p.width/p.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+i,u_texsize:c,u_texture:0}},"symbolIconUniformValues"),Boe=s((t,e,r,i,n,a,o,l,u,c,p)=>{let m=n.transform;return Fr(Foe(t,e,r,i,n,a,o,l,u,c),{u_gamma_scale:i?Math.cos(m._pitch)*m.cameraToCenterDistance:1,u_device_pixel_ratio:n.pixelRatio,u_is_halo:+p})},"symbolSDFUniformValues"),$Fe=s((t,e,r,i,n,a,o,l,u,c)=>Fr(Boe(t,e,r,i,n,a,o,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1}),"symbolTextAndIconUniformValues");N();var GFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_opacity:new Mr(t,e.u_opacity),u_color:new J1(t,e.u_color)}),"backgroundUniforms"),HFe=s((t,e)=>({u_matrix:new vn(t,e.u_matrix),u_opacity:new Mr(t,e.u_opacity),u_image:new qi(t,e.u_image),u_pattern_tl_a:new nn(t,e.u_pattern_tl_a),u_pattern_br_a:new nn(t,e.u_pattern_br_a),u_pattern_tl_b:new nn(t,e.u_pattern_tl_b),u_pattern_br_b:new nn(t,e.u_pattern_br_b),u_texsize:new nn(t,e.u_texsize),u_mix:new Mr(t,e.u_mix),u_pattern_size_a:new nn(t,e.u_pattern_size_a),u_pattern_size_b:new nn(t,e.u_pattern_size_b),u_scale_a:new Mr(t,e.u_scale_a),u_scale_b:new Mr(t,e.u_scale_b),u_pixel_coord_upper:new nn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new nn(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new Mr(t,e.u_tile_units_to_pixels)}),"backgroundPatternUniforms"),qFe=s((t,e,r)=>({u_matrix:t,u_opacity:e,u_color:r}),"backgroundUniformValues"),WFe=s((t,e,r,i,n,a)=>Fr(Toe(i,a,r,n),{u_matrix:t,u_opacity:e}),"backgroundPatternUniformValues"),XFe={fillExtrusion:oFe,fillExtrusionPattern:sFe,fill:uFe,fillPattern:cFe,fillOutline:hFe,fillOutlinePattern:pFe,circle:mFe,collisionBox:yFe,collisionCircle:vFe,debug:bFe,clippingMask:wFe,heatmap:AFe,heatmapTexture:SFe,hillshade:CFe,hillshadePrepare:IFe,line:LFe,lineGradient:DFe,linePattern:RFe,lineSDF:OFe,raster:BFe,symbolIcon:UFe,symbolSDF:VFe,symbolTextAndIcon:jFe,background:GFe,backgroundPattern:HFe,terrain:Q7e,terrainDepth:eFe,terrainCoords:tFe};N();N();var zoe=class{constructor(e,r,i){this.context=e;let n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=!!i,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};s(zoe,"IndexBuffer");var ZFe=zoe;N();var YFe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Uoe=class{constructor(e,r,i,n){this.length=r.length,this.attributes=i,this.itemSize=r.bytesPerElement,this.dynamicDraw=n,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error("Length of new data is ".concat(e.length,", which doesn't match current length of ").concat(this.length));let r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let i=0;i<this.attributes.length;i++){let n=this.attributes[i],a=r.attributes[n.name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,r,i){for(let n=0;n<this.attributes.length;n++){let a=this.attributes[n],o=r.attributes[a.name];o!==void 0&&e.vertexAttribPointer(o,a.components,e[YFe[a.type]],!1,this.itemSize,a.offset+this.itemSize*(i||0))}}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};s(Uoe,"VertexBuffer");var KFe=Uoe;N();N();N();var BL=new WeakMap;function lw(t){var e;if(BL.has(t))return BL.get(t);{let r=(e=t.getParameter(t.VERSION))==null?void 0:e.startsWith("WebGL 2.0");return BL.set(t,r),r}}s(lw,"isWebGL2");var Voe=class{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}};s(Voe,"BaseValue");var zn=Voe,joe=class extends zn{getDefault(){return Pi.transparent}set(e){let r=this.current;e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};s(joe,"ClearColor");var JFe=joe,$oe=class extends zn{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}};s($oe,"ClearDepth");var QFe=$oe,Goe=class extends zn{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}};s(Goe,"ClearStencil");var eBe=Goe,Hoe=class extends zn{getDefault(){return[!0,!0,!0,!0]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};s(Hoe,"ColorMask");var tBe=Hoe,qoe=class extends zn{getDefault(){return!0}set(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)}};s(qoe,"DepthMask");var rBe=qoe,Woe=class extends zn{getDefault(){return 255}set(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}};s(Woe,"StencilMask");var iBe=Woe,Xoe=class extends zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let r=this.current;e.func===r.func&&e.ref===r.ref&&e.mask===r.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}};s(Xoe,"StencilFunc");var nBe=Xoe,Zoe=class extends zn{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}};s(Zoe,"StencilOp");var aBe=Zoe,Yoe=class extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}};s(Yoe,"StencilTest");var oBe=Yoe,Koe=class extends zn{getDefault(){return[0,1]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}};s(Koe,"DepthRange");var sBe=Koe,Joe=class extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}};s(Joe,"DepthTest");var lBe=Joe,Qoe=class extends zn{getDefault(){return this.gl.LESS}set(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}};s(Qoe,"DepthFunc");var uBe=Qoe,ese=class extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}};s(ese,"Blend");var cBe=ese,tse=class extends zn{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}};s(tse,"BlendFunc");var hBe=tse,rse=class extends zn{getDefault(){return Pi.transparent}set(e){let r=this.current;e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};s(rse,"BlendColor");var pBe=rse,ise=class extends zn{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}};s(ise,"BlendEquation");var dBe=ise,nse=class extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}};s(nse,"CullFace");var fBe=nse,ase=class extends zn{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}};s(ase,"CullFaceSide");var mBe=ase,ose=class extends zn{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}};s(ose,"FrontFace");var gBe=ose,sse=class extends zn{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};s(sse,"ProgramValue");var yBe=sse,lse=class extends zn{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}};s(lse,"ActiveTextureUnit");var vBe=lse,use=class extends zn{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let r=this.current;e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};s(use,"Viewport");var _Be=use,cse=class extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}};s(cse,"BindFramebuffer");var xBe=cse,hse=class extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};s(hse,"BindRenderbuffer");var bBe=hse,pse=class extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}};s(pse,"BindTexture");var wBe=pse,dse=class extends zn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};s(dse,"BindVertexBuffer");var ABe=dse,fse=class extends zn{getDefault(){return null}set(e){let r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};s(fse,"BindElementBuffer");var SBe=fse,mse=class extends zn{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;let i=this.gl;lw(i)?i.bindVertexArray(e):(r=i.getExtension("OES_vertex_array_object"))==null||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}};s(mse,"BindVertexArray");var MBe=mse,gse=class extends zn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}};s(gse,"PixelStoreUnpack");var EBe=gse,yse=class extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}};s(yse,"PixelStoreUnpackPremultiplyAlpha");var CBe=yse,vse=class extends zn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}};s(vse,"PixelStoreUnpackFlipY");var IBe=vse,_se=class extends zn{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}};s(_se,"FramebufferAttachment");var YF=_se,xse=class extends YF{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}};s(xse,"ColorAttachment");var TBe=xse,bse=class extends YF{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};s(bse,"DepthAttachment");var PBe=bse,wse=class extends YF{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}};s(wse,"DepthStencilAttachment");var LBe=wse,Ase=class{constructor(e,r,i,n,a){this.context=e,this.width=r,this.height=i;let o=e.gl,l=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new TBe(e,l),n)this.depthAttachment=a?new LBe(e,l):new PBe(e,l);else if(a)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){let i=this.depthAttachment.get();i&&e.deleteRenderbuffer(i)}e.deleteFramebuffer(this.framebuffer)}};s(Ase,"Framebuffer");var DBe=Ase;N();var RBe=0,Sse=1,OBe=771,Mse=class{constructor(e,r,i){this.blendFunction=e,this.blendColor=r,this.mask=i}};s(Mse,"ColorMode");var Ho=Mse;Ho.Replace=[Sse,RBe];Ho.disabled=new Ho(Ho.Replace,Pi.transparent,[!1,!1,!1,!1]);Ho.unblended=new Ho(Ho.Replace,Pi.transparent,[!0,!0,!0,!0]);Ho.alphaBlended=new Ho([Sse,OBe],Pi.transparent,[!0,!0,!0,!0]);var Ese=class{constructor(e){var r,i;if(this.gl=e,this.clearColor=new JFe(this),this.clearDepth=new QFe(this),this.clearStencil=new eBe(this),this.colorMask=new tBe(this),this.depthMask=new rBe(this),this.stencilMask=new iBe(this),this.stencilFunc=new nBe(this),this.stencilOp=new aBe(this),this.stencilTest=new oBe(this),this.depthRange=new sBe(this),this.depthTest=new lBe(this),this.depthFunc=new uBe(this),this.blend=new cBe(this),this.blendFunc=new hBe(this),this.blendColor=new pBe(this),this.blendEquation=new dBe(this),this.cullFace=new fBe(this),this.cullFaceSide=new mBe(this),this.frontFace=new gBe(this),this.program=new yBe(this),this.activeTexture=new vBe(this),this.viewport=new _Be(this),this.bindFramebuffer=new xBe(this),this.bindRenderbuffer=new bBe(this),this.bindTexture=new wBe(this),this.bindVertexBuffer=new ABe(this),this.bindElementBuffer=new SBe(this),this.bindVertexArray=new MBe(this),this.pixelStoreUnpack=new EBe(this),this.pixelStoreUnpackPremultiplyAlpha=new CBe(this),this.pixelStoreUnpackFlipY=new IBe(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),lw(e)){this.HALF_FLOAT=e.HALF_FLOAT;let n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!=null?r:n==null?void 0:n.RGBA16F_EXT,this.RGB16F=(i=e.RGB16F)!=null?i:n==null?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let n=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=n==null?void 0:n.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new ZFe(this,e,r)}createVertexBuffer(e,r,i){return new KFe(this,e,r,i)}createRenderbuffer(e,r,i){let n=this.gl,a=n.createRenderbuffer();return this.bindRenderbuffer.set(a),n.renderbufferStorage(n.RENDERBUFFER,e,r,i),this.bindRenderbuffer.set(null),a}createFramebuffer(e,r,i,n){return new DBe(this,e,r,i,n)}clear({color:e,depth:r,stencil:i}){let n=this.gl,a=0;e&&(a|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),typeof r<"u"&&(a|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),typeof i<"u"&&(a|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),n.clear(a)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func===this.gl.ALWAYS&&!e.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range))}setStencilMode(e){e.test.func===this.gl.ALWAYS&&!e.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask}))}setColorMode(e){zm(e.blendFunction,Ho.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return lw(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return lw(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}};s(Ese,"Context");var kBe=Ese;N();var Cse=class{constructor(e,r,i){this.func=e,this.mask=r,this.range=i}};s(Cse,"DepthMode");var gn=Cse;gn.ReadOnly=!1;gn.ReadWrite=!0;gn.disabled=new gn(519,gn.ReadOnly,[0,1]);N();var Ise=class{constructor(e,r,i,n,a,o){this.test=e,this.ref=r,this.mask=i,this.fail=n,this.depthFail=a,this.pass=o}};s(Ise,"StencilMode");var Ka=Ise;Ka.disabled=new Ka({func:519,mask:0},0,0,7680,7680,7680);N();var Tse=class{constructor(e,r,i){this.enable=e,this.mode=r,this.frontFace=i}};s(Tse,"CullFaceMode");var Ga=Tse;Ga.disabled=new Ga(!1,1029,2305);Ga.backCCW=new Ga(!0,1029,2305);N();var Pse=Rr(kn(),1);N();var TM;function lR(t,e,r,i,n,a,o){let l=t.context,u=l.gl,c=t.useProgram("collisionBox"),p=[],m=0,y=0;for(let P=0;P<i.length;P++){let C=i[P],T=e.getTile(C),D=T.getBucket(r);if(!D)continue;let F=C.posMatrix;(n[0]!==0||n[1]!==0)&&(F=t.translatePosMatrix(C.posMatrix,T,n,a));let k=o?D.textCollisionBox:D.iconCollisionBox,B=D.collisionCircleArray;if(B.length>0){let U=Or.create(),z=F;Or.mul(U,D.placementInvProjMatrix,t.transform.glCoordMatrix),Or.mul(U,U,D.placementViewportMatrix),p.push({circleArray:B,circleOffset:y,transform:z,invTransform:U,coord:C}),m+=B.length/4,y=m}k&&c.draw(l,u.LINES,gn.disabled,Ka.disabled,t.colorModeForRenderPass(),Ga.disabled,_Fe(F,t.transform,T),t.style.map.terrain&&t.style.map.terrain.getTerrainData(C),r.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,null,t.transform.zoom,null,null,k.collisionVertexBuffer)}if(!o||!p.length)return;let v=t.useProgram("collisionCircle"),x=new Qke;x.resize(m*4),x._trim();let E=0;for(let P of p)for(let C=0;C<P.circleArray.length/4;C++){let T=C*4,D=P.circleArray[T+0],F=P.circleArray[T+1],k=P.circleArray[T+2],B=P.circleArray[T+3];x.emplace(E++,D,F,k,B,0),x.emplace(E++,D,F,k,B,1),x.emplace(E++,D,F,k,B,2),x.emplace(E++,D,F,k,B,3)}(!TM||TM.length<m*2)&&(TM=Lse(m));let M=l.createIndexBuffer(TM,!0),I=l.createVertexBuffer(x,DNe.members,!0);for(let P of p){let C=xFe(P.transform,P.invTransform,t.transform);v.draw(l,u.TRIANGLES,gn.disabled,Ka.disabled,t.colorModeForRenderPass(),Ga.disabled,C,t.style.map.terrain&&t.style.map.terrain.getTerrainData(P.coord),r.id,I,M,Io.simpleSegment(0,P.circleOffset*2,P.circleArray.length,P.circleArray.length/2),null,t.transform.zoom,null,null,null)}I.destroy(),M.destroy()}s(lR,"drawCollisionDebug");function Lse(t){let e=t*2,r=new t8e;r.resize(e),r._trim();for(let i=0;i<e;i++){let n=i*6;r.uint16[n+0]=i*4+0,r.uint16[n+1]=i*4+1,r.uint16[n+2]=i*4+2,r.uint16[n+3]=i*4+2,r.uint16[n+4]=i*4+3,r.uint16[n+5]=i*4+0}return r}s(Lse,"createQuadTriangles");var NBe=Or.identity(new Float32Array(16));function Dse(t,e,r,i,n){if(t.renderPass!=="translucent")return;let a=Ka.disabled,o=t.colorModeForRenderPass();(r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&Ose(i,t,r,e,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),n),r.paint.get("icon-opacity").constantOr(1)!==0&&uR(t,e,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,o),r.paint.get("text-opacity").constantOr(1)!==0&&uR(t,e,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,o),e.map.showCollisionBoxes&&(lR(t,e,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),lR(t,e,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}s(Dse,"drawSymbols");function Rse(t,e,r,i,n,a){let{horizontalAlign:o,verticalAlign:l}=RF(t),u=-(o-.5)*e,c=-(l-.5)*r;return new Pse.default((u/n+i[0])*a,(c/n+i[1])*a)}s(Rse,"calculateVariableRenderShift");function Ose(t,e,r,i,n,a,o){let l=e.transform,u=n==="map",c=a==="map";for(let p of t){let m=i.getTile(p),y=m.getBucket(r);if(!y||!y.text||!y.text.segments.get().length)continue;let v=y.textSizeData,x=CA(v,l.zoom),E=ku(m,1,e.transform.zoom),M=CP(p.posMatrix,c,u,e.transform,E),I=r.layout.get("icon-text-fit")!=="none"&&y.hasIconData();if(x){let P=Math.pow(2,l.zoom-m.tileID.overscaledZ),C=e.style.map.terrain?(T,D)=>e.style.map.terrain.getElevation(p,T,D):null;kse(y,u,c,o,l,M,p.posMatrix,P,x,I,C)}}}s(Ose,"updateVariableAnchors");function kse(t,e,r,i,n,a,o,l,u,c,p){let m=t.text.placedSymbolArray,y=t.text.dynamicLayoutVertexArray,v=t.icon.dynamicLayoutVertexArray,x={};y.clear();for(let E=0;E<m.length;E++){let M=m.get(E),I=t.allowVerticalPlacement&&!M.placedOrientation,P=!M.hidden&&M.crossTileID&&!I?i[M.crossTileID]:null;if(!P)ky(M.numGlyphs,y);else{let C=new Pse.default(M.anchorX,M.anchorY),T=yc(C,r?o:a,p),D=IP(n.cameraToCenterDistance,T.signedDistanceFromCamera),F=AP(t.textSizeData,u,M)*D/Ene;r&&(F*=t.tilePixelRatio/l);let{width:k,height:B,anchor:U,textOffset:z,textBoxScale:q}=P,Z=Rse(U,k,B,z,q,F),Q=r?yc(C.add(Z),a,p).point:T.point.add(e?Z.rotate(-n.angle):Z),V=t.allowVerticalPlacement&&M.placedOrientation===2?Math.PI/2:0;for(let ae=0;ae<M.numGlyphs;ae++)__(y,Q,V);c&&M.associatedIconIndex>=0&&(x[M.associatedIconIndex]={shiftedAnchor:Q,angle:V})}}if(c){v.clear();let E=t.icon.placedSymbolArray;for(let M=0;M<E.length;M++){let I=E.get(M);if(I.hidden)ky(I.numGlyphs,v);else{let P=x[M];if(!P)ky(I.numGlyphs,v);else for(let C=0;C<I.numGlyphs;C++)__(v,P.shiftedAnchor,P.angle)}}t.icon.dynamicLayoutVertexBuffer.updateData(v)}t.text.dynamicLayoutVertexBuffer.updateData(y)}s(kse,"updateVariableAnchorsForBucket");function Nse(t,e,r){return r.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}s(Nse,"getSymbolProgramName");function uR(t,e,r,i,n,a,o,l,u,c,p,m){let y=t.context,v=y.gl,x=t.transform,E=l==="map",M=u==="map",I=l!=="viewport"&&r.layout.get("symbol-placement")!=="point",P=E&&!M&&!I,C=!r.layout.get("symbol-sort-key").isConstant(),T=!1,D=t.depthModeForSublayer(0,gn.ReadOnly),F=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k=[];for(let B of i){let U=e.getTile(B),z=U.getBucket(r);if(!z)continue;let q=n?z.text:z.icon;if(!q||!q.segments.get().length||!q.hasVisibleVertices)continue;let Z=q.programConfigurations.get(r.id),Q=n||z.sdfIcons,V=n?z.textSizeData:z.iconSizeData,ae=M||x.pitch!==0,Y=t.useProgram(Nse(Q,n,z),Z),he=CA(V,x.zoom),J=t.style.map.terrain&&t.style.map.terrain.getTerrainData(B),ne,ee=[0,0],ue,K,ce=null,re;if(n){if(ue=U.glyphAtlasTexture,K=v.LINEAR,ne=U.glyphAtlasTexture.size,z.iconsInText){ee=U.imageAtlasTexture.size,ce=U.imageAtlasTexture;let tt=V.kind==="composite"||V.kind==="camera";re=ae||t.options.rotating||t.options.zooming||tt?v.LINEAR:v.NEAREST}}else{let tt=r.layout.get("icon-size").constantOr(0)!==1||z.iconsNeedLinear;ue=U.imageAtlasTexture,K=Q||t.options.rotating||t.options.zooming||tt||ae?v.LINEAR:v.NEAREST,ne=U.imageAtlasTexture.size}let se=ku(U,1,t.transform.zoom),de=CP(B.posMatrix,M,E,t.transform,se),we=VF(B.posMatrix,M,E,t.transform,se),Le=F&&z.hasTextData(),fe=r.layout.get("icon-text-fit")!=="none"&&Le&&z.hasIconData();if(I){let tt=t.style.map.terrain?(at,Lt)=>t.style.map.terrain.getElevation(B,at,Lt):null,We=r.layout.get("text-rotation-alignment")==="map";noe(z,B.posMatrix,t,n,de,we,M,c,We,tt)}let Re=t.translatePosMatrix(B.posMatrix,U,a,o),me=I||n&&F||fe?NBe:de,Ae=t.translatePosMatrix(we,U,a,o,!0),Ue=Q&&r.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1)!==0,_e;Q?z.iconsInText?_e=$Fe(V.kind,he,P,M,t,Re,me,Ae,ne,ee):_e=Boe(V.kind,he,P,M,t,Re,me,Ae,n,ne,!0):_e=Foe(V.kind,he,P,M,t,Re,me,Ae,n,ne);let lt={program:Y,buffers:q,uniformValues:_e,atlasTexture:ue,atlasTextureIcon:ce,atlasInterpolation:K,atlasInterpolationIcon:re,isSDF:Q,hasHalo:Ue};if(C&&z.canOverlap){T=!0;let tt=q.segments.get();for(let We of tt)k.push({segments:new Io([We]),sortKey:We.sortKey,state:lt,terrainData:J})}else k.push({segments:q.segments,sortKey:0,state:lt,terrainData:J})}T&&k.sort((B,U)=>B.sortKey-U.sortKey);for(let B of k){let U=B.state;if(y.activeTexture.set(v.TEXTURE0),U.atlasTexture.bind(U.atlasInterpolation,v.CLAMP_TO_EDGE),U.atlasTextureIcon&&(y.activeTexture.set(v.TEXTURE1),U.atlasTextureIcon&&U.atlasTextureIcon.bind(U.atlasInterpolationIcon,v.CLAMP_TO_EDGE)),U.isSDF){let z=U.uniformValues;U.hasHalo&&(z.u_is_halo=1,cR(U.buffers,B.segments,r,t,U.program,D,p,m,z,B.terrainData)),z.u_is_halo=0}cR(U.buffers,B.segments,r,t,U.program,D,p,m,U.uniformValues,B.terrainData)}}s(uR,"drawLayerSymbols");function cR(t,e,r,i,n,a,o,l,u,c){let p=i.context,m=p.gl;n.draw(p,m.TRIANGLES,a,o,l,Ga.disabled,u,c,r.id,t.layoutVertexBuffer,t.indexBuffer,e,r.paint,i.transform.zoom,t.programConfigurations.get(r.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}s(cR,"drawSymbolElements");N();function Fse(t,e,r,i){if(t.renderPass!=="translucent")return;let n=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),o=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(n.constantOr(1)===0&&(a.constantOr(1)===0||o.constantOr(1)===0))return;let u=t.context,c=u.gl,p=t.depthModeForSublayer(0,gn.ReadOnly),m=Ka.disabled,y=t.colorModeForRenderPass(),v=[];for(let x=0;x<i.length;x++){let E=i[x],M=e.getTile(E),I=M.getBucket(r);if(!I)continue;let P=I.programConfigurations.get(r.id),C=t.useProgram("circle",P),T=I.layoutVertexBuffer,D=I.indexBuffer,F=t.style.map.terrain&&t.style.map.terrain.getTerrainData(E),k=gFe(t,E,M,r),B={programConfiguration:P,program:C,layoutVertexBuffer:T,indexBuffer:D,uniformValues:k,terrainData:F};if(l){let U=I.segments.get();for(let z of U)v.push({segments:new Io([z]),sortKey:z.sortKey,state:B})}else v.push({segments:I.segments,sortKey:0,state:B})}l&&v.sort((x,E)=>x.sortKey-E.sortKey);for(let x of v){let{programConfiguration:E,program:M,layoutVertexBuffer:I,indexBuffer:P,uniformValues:C,terrainData:T}=x.state,D=x.segments;M.draw(u,c.TRIANGLES,p,m,y,Ga.disabled,C,T,r.id,I,P,D,r.paint,t.transform.zoom,E)}}s(Fse,"drawCircles");N();function Bse(t,e,r,i){if(r.paint.get("heatmap-opacity")!==0)if(t.renderPass==="offscreen"){let n=t.context,a=n.gl,o=Ka.disabled,l=new Ho([a.ONE,a.ONE],Pi.transparent,[!0,!0,!0,!0]);zse(n,t,r),n.clear({color:Pi.transparent});for(let u=0;u<i.length;u++){let c=i[u];if(e.hasRenderableParent(c))continue;let p=e.getTile(c),m=p.getBucket(r);if(!m)continue;let y=m.programConfigurations.get(r.id),v=t.useProgram("heatmap",y),{zoom:x}=t.transform;v.draw(n,a.TRIANGLES,gn.disabled,o,l,Ga.disabled,MFe(c.posMatrix,p,x,r.paint.get("heatmap-intensity")),null,r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,r.paint,t.transform.zoom,y)}n.viewport.set([0,0,t.width,t.height])}else t.renderPass==="translucent"&&(t.context.setColorMode(t.colorModeForRenderPass()),Vse(t,r))}s(Bse,"drawHeatmap");function zse(t,e,r){let i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let n=r.heatmapFbo;if(n)i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),t.bindFramebuffer.set(n.framebuffer);else{let a=i.createTexture();i.bindTexture(i.TEXTURE_2D,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),n=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),Use(t,e,a,n)}}s(zse,"bindFramebuffer");function Use(t,e,r,i){var n,a;let o=t.gl,l=(n=t.HALF_FLOAT)!=null?n:o.UNSIGNED_BYTE,u=(a=t.RGBA16F)!=null?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,u,e.width/4,e.height/4,0,o.RGBA,l,null),i.colorAttachment.set(r)}s(Use,"bindTextureToFramebuffer");function Vse(t,e){let r=t.context,i=r.gl,n=e.heatmapFbo;if(!n)return;r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);let a=e.colorRampTexture;a||(a=e.colorRampTexture=new Ms(r,e.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(r,i.TRIANGLES,gn.disabled,Ka.disabled,t.colorModeForRenderPass(),Ga.disabled,EFe(t,e,0,1),null,e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}s(Vse,"renderTextureToMap");N();function jse(t,e,r,i){if(t.renderPass!=="translucent")return;let n=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(n.constantOr(1)===0||a.constantOr(1)===0)return;let o=t.depthModeForSublayer(0,gn.ReadOnly),l=t.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),c=r.paint.get("line-pattern"),p=c.constantOr(1),m=r.paint.get("line-gradient"),y=r.getCrossfadeParameters(),v=p?"linePattern":u?"lineSDF":m?"lineGradient":"line",x=t.context,E=x.gl,M=!0;for(let I of i){let P=e.getTile(I);if(p&&!P.patternsLoaded())continue;let C=P.getBucket(r);if(!C)continue;let T=C.programConfigurations.get(r.id),D=t.context.program.get(),F=t.useProgram(v,T),k=M||F.program!==D,B=t.style.map.terrain&&t.style.map.terrain.getTerrainData(I),U=c.constantOr(null);if(U&&P.imageAtlas){let Z=P.imageAtlas,Q=Z.patternPositions[U.to.toString()],V=Z.patternPositions[U.from.toString()];Q&&V&&T.setConstantPatternPositions(Q,V)}let z=B?I:null,q=p?NFe(t,P,r,y,z):u?FFe(t,P,r,u,y,z):m?kFe(t,P,r,C.lineClipsArray.length,z):WF(t,P,r,z);if(p)x.activeTexture.set(E.TEXTURE0),P.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),T.updatePaintBuffers(y);else if(u&&(k||t.lineAtlas.dirty))x.activeTexture.set(E.TEXTURE0),t.lineAtlas.bind(x);else if(m){let Z=C.gradients[r.id],Q=Z.texture;if(r.gradientVersion!==Z.version){let V=256;if(r.stepInterpolant){let ae=e.getSource().maxzoom,Y=I.canonical.z===ae?Math.ceil(1<<t.transform.maxZoom-I.canonical.z):1,he=C.maxLineLength/8192*1024*Y;V=hs(oZ(he),256,x.maxTextureSize)}Z.gradient=IF({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:V,image:Z.gradient||void 0,clips:C.lineClipsArray}),Z.texture?Z.texture.update(Z.gradient):Z.texture=new Ms(x,Z.gradient,E.RGBA),Z.version=r.gradientVersion,Q=Z.texture}x.activeTexture.set(E.TEXTURE0),Q.bind(r.stepInterpolant?E.NEAREST:E.LINEAR,E.CLAMP_TO_EDGE)}F.draw(x,E.TRIANGLES,o,t.stencilModeForClipping(I),l,Ga.disabled,q,B,r.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,r.paint,t.transform.zoom,T,C.layoutVertexBuffer2),M=!1}}s(jse,"drawLine");N();N();function KF(t,e,r,i,n){if(!r||!i||!i.imageAtlas)return;let a=i.imageAtlas.patternPositions,o=a[r.to.toString()],l=a[r.from.toString()];if(!o&&l&&(o=l),!l&&o&&(l=o),!o||!l){let u=n.getPaintProperty(e);o=a[u],l=a[u]}o&&l&&t.setConstantPatternPositions(o,l)}s(KF,"updatePatternPositionsInProgram");function $se(t,e,r,i){let n=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(a.constantOr(1)===0)return;let o=t.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&n.constantOr(Pi.transparent).a===1&&a.constantOr(0)===1?"opaque":"translucent";if(t.renderPass===u){let c=t.depthModeForSublayer(1,t.renderPass==="opaque"?gn.ReadWrite:gn.ReadOnly);hR(t,e,r,i,c,o,!1)}if(t.renderPass==="translucent"&&r.paint.get("fill-antialias")){let c=t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,gn.ReadOnly);hR(t,e,r,i,c,o,!0)}}s($se,"drawFill");function hR(t,e,r,i,n,a,o){let l=t.context.gl,u="fill-pattern",c=r.paint.get(u),p=c&&c.constantOr(1),m=r.getCrossfadeParameters(),y,v,x,E,M;o?(v=p&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y=l.LINES):(v=p?"fillPattern":"fill",y=l.TRIANGLES);let I=c.constantOr(null);for(let P of i){let C=e.getTile(P);if(p&&!C.patternsLoaded())continue;let T=C.getBucket(r);if(!T)continue;let D=T.programConfigurations.get(r.id),F=t.useProgram(v,D),k=t.style.map.terrain&&t.style.map.terrain.getTerrainData(P);p&&(t.context.activeTexture.set(l.TEXTURE0),C.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),D.updatePaintBuffers(m)),KF(D,u,I,C,r);let B=k?P:null,U=B?B.posMatrix:P.posMatrix,z=t.translatePosMatrix(U,C,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(!o)E=T.indexBuffer,M=T.segments,x=p?Doe(z,t,m,C):Loe(z);else{E=T.indexBuffer2,M=T.segments2;let q=[l.drawingBufferWidth,l.drawingBufferHeight];x=v==="fillOutlinePattern"&&p?fFe(z,t,m,C,q):dFe(z,q)}F.draw(t.context,y,n,t.stencilModeForClipping(P),a,Ga.disabled,x,k,r.id,T.layoutVertexBuffer,E,M,r.paint,t.transform.zoom,D)}}s(hR,"drawFillTiles");N();function Gse(t,e,r,i){let n=r.paint.get("fill-extrusion-opacity");if(n!==0&&t.renderPass==="translucent"){let a=new gn(t.context.gl.LEQUAL,gn.ReadWrite,t.depthRangeFor3D);if(n===1&&!r.paint.get("fill-extrusion-pattern").constantOr(1)){let o=t.colorModeForRenderPass();HE(t,e,r,i,a,Ka.disabled,o)}else HE(t,e,r,i,a,Ka.disabled,Ho.disabled),HE(t,e,r,i,a,t.stencilModeFor3D(),t.colorModeForRenderPass())}}s(Gse,"drawFillExtrusion");function HE(t,e,r,i,n,a,o){let l=t.context,u=l.gl,c="fill-extrusion-pattern",p=r.paint.get(c),m=p.constantOr(1),y=r.getCrossfadeParameters(),v=r.paint.get("fill-extrusion-opacity"),x=p.constantOr(null);for(let E of i){let M=e.getTile(E),I=M.getBucket(r);if(!I)continue;let P=t.style.map.terrain&&t.style.map.terrain.getTerrainData(E),C=I.programConfigurations.get(r.id),T=t.useProgram(m?"fillExtrusionPattern":"fillExtrusion",C);m&&(t.context.activeTexture.set(u.TEXTURE0),M.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),C.updatePaintBuffers(y)),KF(C,c,x,M,r);let D=t.translatePosMatrix(E.posMatrix,M,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),F=r.paint.get("fill-extrusion-vertical-gradient"),k=m?lFe(D,t,F,v,E,y,M):Poe(D,t,F,v);T.draw(l,l.gl.TRIANGLES,n,a,o,Ga.backCCW,k,P,r.id,I.layoutVertexBuffer,I.indexBuffer,I.segments,r.paint,t.transform.zoom,C,t.style.map.terrain&&I.centroidVertexBuffer)}}s(HE,"drawExtrusionTiles");N();function Hse(t,e,r,i){if(t.renderPass!=="offscreen"&&t.renderPass!=="translucent")return;let n=t.context,a=t.depthModeForSublayer(0,gn.ReadOnly),o=t.colorModeForRenderPass(),[l,u]=t.renderPass==="translucent"?t.stencilConfigForOverlap(i):[{},i];for(let c of u){let p=e.getTile(c);typeof p.needsHillshadePrepare<"u"&&p.needsHillshadePrepare&&t.renderPass==="offscreen"?Wse(t,p,r,a,Ka.disabled,o):t.renderPass==="translucent"&&qse(t,c,p,r,a,l[c.overscaledZ],o)}n.viewport.set([0,0,t.width,t.height])}s(Hse,"drawHillshade");function qse(t,e,r,i,n,a,o){let l=t.context,u=l.gl,c=r.fbo;if(!c)return;let p=t.useProgram("hillshade"),m=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());let y=m?e:null;p.draw(l,u.TRIANGLES,n,a,o,Ga.disabled,TFe(t,r,i,y),m,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}s(qse,"renderHillshade");function Wse(t,e,r,i,n,a){let o=t.context,l=o.gl,u=e.dem;if(u&&u.data){let c=u.dim,p=u.stride,m=u.getPixels();if(o.activeTexture.set(l.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(p),e.demTexture){let v=e.demTexture;v.update(m,{premultiply:!1}),v.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else e.demTexture=new Ms(o,m,l.RGBA,{premultiply:!1}),e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);o.activeTexture.set(l.TEXTURE0);let y=e.fbo;if(!y){let v=new Ms(o,{width:c,height:c,data:null},l.RGBA);v.bind(l.LINEAR,l.CLAMP_TO_EDGE),y=e.fbo=o.createFramebuffer(c,c,!0,!1),y.colorAttachment.set(v.texture)}o.bindFramebuffer.set(y.framebuffer),o.viewport.set([0,0,c,c]),t.useProgram("hillshadePrepare").draw(o,l.TRIANGLES,i,n,a,Ga.disabled,PFe(e.tileID,u),null,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}s(Wse,"prepareHillshade");N();function Xse(t,e,r,i){if(t.renderPass!=="translucent"||r.paint.get("raster-opacity")===0||!i.length)return;let n=t.context,a=n.gl,o=e.getSource(),l=t.useProgram("raster"),u=t.colorModeForRenderPass(),[c,p]=o instanceof Ew?[{},i]:t.stencilConfigForOverlap(i),m=p[p.length-1].overscaledZ,y=!t.options.moving;for(let v of p){let x=t.depthModeForSublayer(v.overscaledZ-m,r.paint.get("raster-opacity")===1?gn.ReadWrite:gn.ReadOnly,a.LESS),E=e.getTile(v);E.registerFadeDuration(r.paint.get("raster-fade-duration"));let M=e.findLoadedParent(v,0),I=Zse(E,M,e,r,t.transform,t.style.map.terrain),P,C,T=r.paint.get("raster-resampling")==="nearest"?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),E.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),M?(M.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),P=Math.pow(2,M.tileID.overscaledZ-E.tileID.overscaledZ),C=[E.tileID.canonical.x*P%1,E.tileID.canonical.y*P%1]):E.texture.bind(T,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);let D=t.style.map.terrain&&t.style.map.terrain.getTerrainData(v),F=D?v:null,k=F?F.posMatrix:t.transform.calculatePosMatrix(v.toUnwrapped(),y),B=zFe(k,C||[0,0],P||1,I,r);o instanceof Ew?l.draw(n,a.TRIANGLES,x,Ka.disabled,u,Ga.disabled,B,D,r.id,o.boundsBuffer,t.quadTriangleIndexBuffer,o.boundsSegments):l.draw(n,a.TRIANGLES,x,c[v.overscaledZ],u,Ga.disabled,B,D,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}s(Xse,"drawRaster");function Zse(t,e,r,i,n,a){let o=i.paint.get("raster-fade-duration");if(!a&&o>0){let l=yn.now(),u=(l-t.timeAdded)/o,c=e?(l-e.timeAdded)/o:-1,p=r.getSource(),m=n.coveringZoomLevel({tileSize:p.tileSize,roundZoom:p.roundZoom}),y=!e||Math.abs(e.tileID.overscaledZ-m)>Math.abs(t.tileID.overscaledZ-m),v=y&&t.refreshedUponExpiration?1:hs(y?u:1-c,0,1);return t.refreshedUponExpiration&&u>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-v}:{opacity:v,mix:0}}else return{opacity:1,mix:0}}s(Zse,"getFadeValues");N();function Yse(t,e,r,i){let n=r.paint.get("background-color"),a=r.paint.get("background-opacity");if(a===0)return;let o=t.context,l=o.gl,u=t.transform,c=u.tileSize,p=r.paint.get("background-pattern");if(t.isPatternMissing(p))return;let m=!p&&n.a===1&&a===1&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==m)return;let y=Ka.disabled,v=t.depthModeForSublayer(0,m==="opaque"?gn.ReadWrite:gn.ReadOnly),x=t.colorModeForRenderPass(),E=t.useProgram(p?"backgroundPattern":"background"),M=i||u.coveringTiles({tileSize:c,terrain:t.style.map.terrain});p&&(o.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));let I=r.getCrossfadeParameters();for(let P of M){let C=i?P.posMatrix:t.transform.calculatePosMatrix(P.toUnwrapped()),T=p?WFe(C,a,t,p,{tileID:P,tileSize:c},I):qFe(C,a,n),D=t.style.map.terrain&&t.style.map.terrain.getTerrainData(P);E.draw(o,l.TRIANGLES,v,y,x,Ga.disabled,T,D,r.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}s(Yse,"drawBackground");N();var FBe=new Pi(1,0,0,1),BBe=new Pi(0,1,0,1),zBe=new Pi(0,0,1,1),UBe=new Pi(1,0,1,1),VBe=new Pi(0,1,1,1);function Kse(t){let e=t.transform.padding,r=3;pR(t,t.transform.height-(e.top||0),r,FBe),pR(t,e.bottom||0,r,BBe),dR(t,e.left||0,r,zBe),dR(t,t.transform.width-(e.right||0),r,UBe);let i=t.transform.centerPoint;Jse(t,i.x,t.transform.height-i.y,VBe)}s(Kse,"drawDebugPadding");function Jse(t,e,r,i){Pw(t,e-2/2,r-20/2,2,20,i),Pw(t,e-20/2,r-2/2,20,2,i)}s(Jse,"drawCrosshair");function pR(t,e,r,i){Pw(t,0,e+r/2,t.transform.width,r,i)}s(pR,"drawHorizontalLine");function dR(t,e,r,i){Pw(t,e-r/2,0,r,t.transform.height,i)}s(dR,"drawVerticalLine");function Pw(t,e,r,i,n,a){let o=t.context,l=o.gl;l.enable(l.SCISSOR_TEST),l.scissor(e*t.pixelRatio,r*t.pixelRatio,i*t.pixelRatio,n*t.pixelRatio),o.clear({color:a}),l.disable(l.SCISSOR_TEST)}s(Pw,"drawDebugSSRect");function Qse(t,e,r){for(let i=0;i<r.length;i++)ele(t,e,r[i])}s(Qse,"drawDebug");function ele(t,e,r){let i=t.context,n=i.gl,a=r.posMatrix,o=t.useProgram("debug"),l=gn.disabled,u=Ka.disabled,c=t.colorModeForRenderPass(),p="$debug",m=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r);i.activeTexture.set(n.TEXTURE0);let y=e.getTileByID(r.key).latestRawTileData,v=y&&y.byteLength||0,x=Math.floor(v/1024),E=e.getTile(r).tileSize,M=512/Math.min(E,512)*(r.overscaledZ/t.transform.zoom)*.5,I=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(I+=" => ".concat(r.overscaledZ));let P="".concat(I," ").concat(x,"kB");tle(t,P),o.draw(i,n.TRIANGLES,l,u,Ho.alphaBlended,Ga.disabled,cq(a,Pi.transparent,M),null,p,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),o.draw(i,n.LINE_STRIP,l,u,c,Ga.disabled,cq(a,Pi.red),m,p,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}s(ele,"drawDebugTile");function tle(t,e){t.initDebugOverlayCanvas();let r=t.debugOverlayCanvas,i=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,r.width,r.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(r),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}s(tle,"drawTextToOverlay");function rle(t,e){let r=null,i=Object.values(t._layers).flatMap(l=>l.source&&!l.isHidden(e)?[t.sourceCaches[l.source]]:[]),n=i.filter(l=>l.getSource().type==="vector"),a=i.filter(l=>l.getSource().type!=="vector"),o=s(l=>{(!r||r.getSource().maxzoom<l.getSource().maxzoom)&&(r=l)},"considerSource");return n.forEach(l=>o(l)),r||a.forEach(l=>o(l)),r}s(rle,"selectDebugSource");N();function ile(t,e,r){let i=t.context,n=r.implementation;if(t.renderPass==="offscreen"){let a=n.prerender;a&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),a.call(n,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if(t.renderPass==="translucent"){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(Ka.disabled);let a=n.renderingMode==="3d"?new gn(t.context.gl.LEQUAL,gn.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,gn.ReadOnly);i.setDepthMode(a),n.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}s(ile,"drawCustom");N();function nle(t,e){let r=t.context,i=r.gl,n=Ho.unblended,a=new gn(i.LEQUAL,gn.ReadWrite,[0,1]),o=e.getTerrainMesh(),l=e.sourceCache.getRenderableTiles(),u=t.useProgram("terrainDepth");r.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:Pi.transparent,depth:1});for(let c of l){let p=e.getTerrainData(c.tileID),m=t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),y=iFe(m,e.getMeshFrameDelta(t.transform.zoom));u.draw(r,i.TRIANGLES,a,Ka.disabled,n,Ga.backCCW,y,p,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}s(nle,"drawDepth");function ale(t,e){let r=t.context,i=r.gl,n=Ho.unblended,a=new gn(i.LEQUAL,gn.ReadWrite,[0,1]),o=e.getTerrainMesh(),l=e.getCoordsTexture(),u=e.sourceCache.getRenderableTiles(),c=t.useProgram("terrainCoords");r.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),r.clear({color:Pi.transparent,depth:1}),e.coordsIndex=[];for(let p of u){let m=e.getTerrainData(p.tileID);r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);let y=t.transform.calculatePosMatrix(p.tileID.toUnwrapped()),v=nFe(y,255-e.coordsIndex.length,e.getMeshFrameDelta(t.transform.zoom));c.draw(r,i.TRIANGLES,a,Ka.disabled,n,Ga.backCCW,v,m,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(p.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height])}s(ale,"drawCoords");function fR(t,e,r){let i=t.context,n=i.gl,a=t.colorModeForRenderPass(),o=new gn(n.LEQUAL,gn.ReadWrite,t.depthRangeFor3D),l=t.useProgram("terrain"),u=e.getTerrainMesh();i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height]);for(let c of r){let p=t.renderToTexture.getTexture(c),m=e.getTerrainData(c.tileID);i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,p.texture);let y=t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),v=rFe(y,e.getMeshFrameDelta(t.transform.zoom));l.draw(i,n.TRIANGLES,o,Ka.disabled,a,Ga.backCCW,v,m,"terrain",u.vertexBuffer,u.indexBuffer,u.segments)}}s(fR,"drawTerrain");var ole=class{constructor(e,r){this.context=new kBe(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Or.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Cw.maxUnderzooming+Cw.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Moe}resize(e,r,i){if(this.width=Math.floor(e*i),this.height=Math.floor(r*i),this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let n of this.style._order)this.style._layers[n].resize()}setup(){let e=this.context,r=new BE;r.emplaceBack(0,0),r.emplaceBack(8192,0),r.emplaceBack(0,8192),r.emplaceBack(8192,8192),this.tileExtentBuffer=e.createVertexBuffer(r,NL.members),this.tileExtentSegments=Io.simpleSegment(0,0,4,2);let i=new BE;i.emplaceBack(0,0),i.emplaceBack(8192,0),i.emplaceBack(0,8192),i.emplaceBack(8192,8192),this.debugBuffer=e.createVertexBuffer(i,NL.members),this.debugSegments=Io.simpleSegment(0,0,4,5);let n=new VQ;n.emplaceBack(0,0,0,0),n.emplaceBack(8192,0,8192,0),n.emplaceBack(0,8192,0,8192),n.emplaceBack(8192,8192,8192,8192),this.rasterBoundsBuffer=e.createVertexBuffer(n,EP.members),this.rasterBoundsSegments=Io.simpleSegment(0,0,4,2);let a=new BE;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,NL.members),this.viewportSegments=Io.simpleSegment(0,0,4,2);let o=new r8e;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);let l=new cv;l.emplaceBack(0,1,2),l.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l);let u=this.context.gl;this.stencilClearMode=new Ka({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)}clearStencil(){let e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let i=Or.create();Or.ortho(i,0,this.width,this.height,0,0,1),Or.scale(i,i,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,r.TRIANGLES,gn.disabled,this.stencilClearMode,Ho.disabled,Ga.disabled,hq(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source;let i=this.context,n=i.gl;this.nextStencilID+r.length>256&&this.clearStencil(),i.setColorMode(Ho.disabled),i.setDepthMode(gn.disabled);let a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let o of r){let l=this._tileClippingMaskIDs[o.key]=this.nextStencilID++,u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(o);a.draw(i,n.TRIANGLES,gn.disabled,new Ka({func:n.ALWAYS,mask:0},l,255,n.KEEP,n.KEEP,n.REPLACE),Ho.disabled,Ga.disabled,hq(o.posMatrix),u,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,r=this.context.gl;return new Ka({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){let r=this.context.gl;return new Ka({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(e){let r=this.context.gl,i=e.sort((o,l)=>l.overscaledZ-o.overscaledZ),n=i[i.length-1].overscaledZ,a=i[0].overscaledZ-n+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let o={};for(let l=0;l<a;l++)o[l+n]=new Ka({func:r.GEQUAL,mask:255},l+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=a,[o,i]}return[{[n]:Ka.disabled},i]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new Ho([e.CONSTANT_COLOR,e.ONE],new Pi(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ho.unblended:Ho.alphaBlended}depthModeForSublayer(e,r,i){if(!this.opaquePassEnabledForLayer())return gn.disabled;let n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new gn(i||this.context.gl.LEQUAL,r,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(yn.now()),this.imageManager.beginFrame();let i=this.style._order,n=this.style.sourceCaches,a={},o={},l={};for(let u in n){let c=n[u];c.used&&c.prepare(this.context),a[u]=c.getVisibleCoordinates(),o[u]=a[u].slice().reverse(),l[u]=c.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let u=0;u<i.length;u++){let c=i[u];if(this.style._layers[c].is3D()){this.opaquePassCutoff=u;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let u of i){let c=this.style._layers[u];if(!c.hasOffscreenPass()||c.isHidden(this.transform.zoom))continue;let p=o[c.source];c.type!=="custom"&&!p.length||this.renderLayer(this,n[c.source],c,p)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?Pi.black:Pi.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){let u=this.style._layers[i[this.currentLayer]],c=n[u.source],p=a[u.source];this._renderTileClippingMasks(u,p),this.renderLayer(this,c,u,p)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){let u=this.style._layers[i[this.currentLayer]],c=n[u.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(u))continue;let p=(u.type==="symbol"?l:o)[u.source];this._renderTileClippingMasks(u,a[u.source]),this.renderLayer(this,c,u,p)}if(this.options.showTileBoundaries){let u=rle(this.style,this.transform.zoom);u&&Qse(this,u,u.getVisibleCoordinates())}this.options.showPadding&&Kse(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let r=this.terrainFacilitator.matrix,i=this.transform.projMatrix,n=this.terrainFacilitator.dirty;n||(n=e?!Or.exactEquals(r,i):!Or.equals(r,i)),n||(n=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),n&&(Or.copy(r,i),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,nle(this,this.style.map.terrain),ale(this,this.style.map.terrain))}renderLayer(e,r,i,n){if(!i.isHidden(this.transform.zoom)&&!(i.type!=="background"&&i.type!=="custom"&&!(n||[]).length))switch(this.id=i.id,i.type){case"symbol":Dse(e,r,i,n,this.style.placement.variableOffsets);break;case"circle":Fse(e,r,i,n);break;case"heatmap":Bse(e,r,i,n);break;case"line":jse(e,r,i,n);break;case"fill":$se(e,r,i,n);break;case"fill-extrusion":Gse(e,r,i,n);break;case"hillshade":Hse(e,r,i,n);break;case"raster":Xse(e,r,i,n);break;case"background":Yse(e,r,i,n);break;case"custom":ile(e,r,i);break}}translatePosMatrix(e,r,i,n,a){if(!i[0]&&!i[1])return e;let o=a?n==="map"?this.transform.angle:0:n==="viewport"?-this.transform.angle:0;if(o){let c=Math.sin(o),p=Math.cos(o);i=[i[0]*p-i[1]*c,i[0]*c+i[1]*p]}let l=[a?i[0]:ku(r,i[0],this.transform.zoom),a?i[1]:ku(r,i[1],this.transform.zoom),0],u=new Float32Array(16);return Or.translate(u,e,l),u}saveTileTexture(e){let r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let r=this.imageManager.getPattern(e.from.toString()),i=this.imageManager.getPattern(e.to.toString());return!r||!i}useProgram(e,r){this.cache=this.cache||{};let i=e+(r?r.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new aFe(this.context,s2[e],r,XFe[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;let e=this.context.gl;this.debugOverlayTexture=new Ms(this.context,this.debugOverlayCanvas,e.RGBA)}}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}};s(ole,"Painter");var jBe=ole;N();var as=Rr(kn(),1);N();var sle=class lle{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,i){let n=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],a=Math.pow(2,i),o=n.map(u=>{u=Kl.transformMat4([],u,e);let c=1/u[3]/r*a;return Kl.mul(u,u,[c,c,1/u[3],c])}),l=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(u=>{let c=kh.sub([],o[u[0]],o[u[1]]),p=kh.sub([],o[u[2]],o[u[1]]),m=kh.normalize([],kh.cross([],c,p)),y=-kh.dot(m,o[u[1]]);return m.concat(y)});return new lle(o,l)}};s(sle,"Frustum");var $Be=sle,ule=class cle{constructor(e,r){this.min=e,this.max=r,this.center=kh.scale([],kh.add([],this.min,this.max),.5)}quadrant(e){let r=[e%2===0,e<2],i=kh.clone(this.min),n=kh.clone(this.max);for(let a=0;a<r.length;a++)i[a]=r[a]?this.min[a]:this.center[a],n[a]=r[a]?this.center[a]:this.max[a];return n[2]=this.max[2],new cle(i,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let r=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],i=!0;for(let n=0;n<e.planes.length;n++){let a=e.planes[n],o=0;for(let l=0;l<r.length;l++)Kl.dot(a,r[l])>=0&&o++;if(o===0)return 0;o!==r.length&&(i=!1)}if(i)return 2;for(let n=0;n<3;n++){let a=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let l=0;l<e.points.length;l++){let u=e.points[l][n]-this.min[n];a=Math.min(a,u),o=Math.max(o,u)}if(o<0||a>this.max[n]-this.min[n])return 0}return 1}};s(ule,"Aabb");var pq=ule;N();var GBe=Rr(kn(),1),hle=class ple{constructor(e=0,r=0,i=0,n=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(i)||i<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=i,this.right=n}interpolate(e,r,i){return r.top!=null&&e.top!=null&&(this.top=Ya.number(e.top,r.top,i)),r.bottom!=null&&e.bottom!=null&&(this.bottom=Ya.number(e.bottom,r.bottom,i)),r.left!=null&&e.left!=null&&(this.left=Ya.number(e.left,r.left,i)),r.right!=null&&e.right!=null&&(this.right=Ya.number(e.right,r.right,i)),this}getCenter(e,r){let i=hs((this.left+e-this.right)/2,0,e),n=hs((this.top+r-this.bottom)/2,0,r);return new GBe.default(i,n)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new ple(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}};s(hle,"EdgeInsets");var HBe=hle,PM=85.051129,dle=class fle{constructor(e,r,i,n,a){this.tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=i??0,this._maxPitch=n??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Yi(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new HBe,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new fle(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new as.default(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){let r=-Ay(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=F6.create(),F6.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let r=hs(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let r=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this.tileZoom=Math.max(0,Math.floor(r)),this.scale=this.zoomScale(r),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,i){this._unmodified=!1,this._edgeInsets.interpolate(e,r,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){let r=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(e){let r=[new Y6(0,e)];if(this._renderWorldCopies){let i=this.pointCoordinate(new as.default(0,0)),n=this.pointCoordinate(new as.default(this.width,0)),a=this.pointCoordinate(new as.default(this.width,this.height)),o=this.pointCoordinate(new as.default(0,this.height)),l=Math.floor(Math.min(i.x,n.x,a.x,o.x)),u=Math.floor(Math.max(i.x,n.x,a.x,o.x)),c=1;for(let p=l-c;p<=u+c;p++)p!==0&&r.push(new Y6(p,e))}return r}coveringTiles(e){var r,i;let n=this.coveringZoomLevel(e),a=n;if(e.minzoom!==void 0&&n<e.minzoom)return[];e.maxzoom!==void 0&&n>e.maxzoom&&(n=e.maxzoom);let o=this.pointCoordinate(this.getCameraPoint()),l=nl.fromLngLat(this.center),u=Math.pow(2,n),c=[u*o.x,u*o.y,0],p=[u*l.x,u*l.y,0],m=$Be.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),y=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(y=n);let v=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,x=s(C=>({aabb:new pq([C*u,0,0],[(C+1)*u,u,0]),zoom:0,x:0,y:0,wrap:C,fullyVisible:!1}),"newRootTile"),E=[],M=[],I=n,P=e.reparseOverscaled?a:n;if(this._renderWorldCopies)for(let C=1;C<=3;C++)E.push(x(-C)),E.push(x(C));for(E.push(x(0));E.length>0;){let C=E.pop(),T=C.x,D=C.y,F=C.fullyVisible;if(!F){let Z=C.aabb.intersects(m);if(Z===0)continue;F=Z===2}let k=e.terrain?c:p,B=C.aabb.distanceX(k),U=C.aabb.distanceY(k),z=Math.max(Math.abs(B),Math.abs(U)),q=v+(1<<I-C.zoom)-2;if(C.zoom===I||z>q&&C.zoom>=y){let Z=I-C.zoom,Q=c[0]-.5-(T<<Z),V=c[1]-.5-(D<<Z);M.push({tileID:new hc(C.zoom===I?P:C.zoom,C.wrap,C.zoom,T,D),distanceSq:gF.sqrLen([p[0]-.5-T,p[1]-.5-D]),tileDistanceToCamera:Math.sqrt(Q*Q+V*V)});continue}for(let Z=0;Z<4;Z++){let Q=(T<<1)+Z%2,V=(D<<1)+(Z>>1),ae=C.zoom+1,Y=C.aabb.quadrant(Z);if(e.terrain){let he=new hc(ae,C.wrap,ae,Q,V),J=e.terrain.getMinMaxElevation(he),ne=(r=J.minElevation)!=null?r:this.elevation,ee=(i=J.maxElevation)!=null?i:this.elevation;Y=new pq([Y.min[0],Y.min[1],ne],[Y.max[0],Y.max[1],ee])}E.push({aabb:Y,zoom:ae,x:Q,y:V,wrap:C.wrap,fullyVisible:F})}}return M.sort((C,T)=>C.distanceSq-T.distanceSq).map(C=>C.tileID)}resize(e,r){this.width=e,this.height=r,this.pixelsToGLUnits=[2/e,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let r=hs(e.lat,-PM,PM);return new as.default(Ry(e.lng)*this.worldSize,Oy(r)*this.worldSize)}unproject(e){return new nl(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){let e=this.pointLocation(this.getCameraPoint()),r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:e,altitude:r+this.elevation}}recalculateZoom(e){let r=this.elevation,i=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,n=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(n,this.tileZoom);if(!(this.elevation-a))return;let o=i+r-a,l=Math.cos(this._pitch)*this.cameraToCenterDistance/o/LT(1,n.lat)/this.tileSize,u=this.scaleZoom(l);this._elevation=a,this._center=n,this.zoom=u}setLocationAtPoint(e,r){let i=this.pointCoordinate(r),n=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new nl(a.x-(i.x-n.x),a.y-(i.y-n.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,r){return r?this.coordinatePoint(this.locationCoordinate(e),r.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,r){return this.coordinateLocation(this.pointCoordinate(e,r))}locationCoordinate(e){return nl.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,r){if(r){let E=r.pointCoordinate(e);if(E!=null)return E}let i=0,n=[e.x,e.y,0,1],a=[e.x,e.y,1,1];Kl.transformMat4(n,n,this.pixelMatrixInverse),Kl.transformMat4(a,a,this.pixelMatrixInverse);let o=n[3],l=a[3],u=n[0]/o,c=a[0]/l,p=n[1]/o,m=a[1]/l,y=n[2]/o,v=a[2]/l,x=y===v?0:(i-y)/(v-y);return new nl(Ya.number(u,c,x)/this.worldSize,Ya.number(p,m,x)/this.worldSize)}coordinatePoint(e,r=0,i=this.pixelMatrix){let n=[e.x*this.worldSize,e.y*this.worldSize,r,1];return Kl.transformMat4(n,n,i),new as.default(n[0]/n[3],n[1]/n[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new Km().extend(this.pointLocation(new as.default(0,e))).extend(this.pointLocation(new as.default(this.width,e))).extend(this.pointLocation(new as.default(this.width,this.height))).extend(this.pointLocation(new as.default(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new Km([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-PM,PM])}calculatePosMatrix(e,r=!1){let i=e.key,n=r?this._alignedPosMatrixCache:this._posMatrixCache;if(n[i])return n[i];let a=e.canonical,o=this.worldSize/this.zoomScale(a.z),l=a.x+Math.pow(2,a.z)*e.wrap,u=Or.identity(new Float64Array(16));return Or.translate(u,u,[l*o,a.y*o,0]),Or.scale(u,u,[o/8192,o/8192,1]),Or.multiply(u,r?this.alignedProjMatrix:this.projMatrix,u),n[i]=new Float32Array(u),n[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,r){r=hs(+r,this.minZoom,this.maxZoom);let i={center:new Yi(e.lng,e.lat),zoom:r},n=this.lngRange;if(!this._renderWorldCopies&&n===null){let C=179.9999999999;n=[-C,C]}let a=this.tileSize*this.zoomScale(i.zoom),o=0,l=a,u=0,c=a,p=0,m=0,{x:y,y:v}=this.size;if(this.latRange){let C=this.latRange;o=Oy(C[1])*a,l=Oy(C[0])*a,l-o<v&&(p=v/(l-o))}n&&(u=Ay(Ry(n[0])*a,0,a),c=Ay(Ry(n[1])*a,0,a),c<u&&(c+=a),c-u<y&&(m=y/(c-u)));let{x,y:E}=this.project.call({worldSize:a},e),M,I,P=Math.max(m||0,p||0);if(P){let C=new as.default(m?(c+u)/2:x,p?(l+o)/2:E);return i.center=this.unproject.call({worldSize:a},C).wrap(),i.zoom+=this.scaleZoom(P),i}if(this.latRange){let C=v/2;E-C<o&&(I=o+C),E+C>l&&(I=l-C)}if(n){let C=(u+c)/2,T=x;this._renderWorldCopies&&(T=Ay(x,C-a/2,C+a/2));let D=y/2;T-D<u&&(M=u+D),T+D>c&&(M=c-D)}if(M!==void 0||I!==void 0){let C=new as.default(M??x,I??E);i.center=this.unproject.call({worldSize:a},C).wrap()}return i}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:r,zoom:i}=this.getConstrained(this.center,this.zoom);this.center=r,this.zoom=i,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this._fov/2,r=this.centerOffset,i=this.point.x,n=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=LT(1,this.center.lat)*this.worldSize;let a=Or.identity(new Float64Array(16));Or.scale(a,a,[this.width/2,-this.height/2,1]),Or.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=Or.identity(new Float64Array(16)),Or.scale(a,a,[1,-1,1]),Or.translate(a,a,[-1,-1,0]),Or.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;let o=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),l=Math.min(this.elevation,this.minElevationForCurrentTile),u=o-l*this._pixelPerMeter/Math.cos(this._pitch),c=l<0?u:o,p=Math.PI/2+this._pitch,m=this._fov*(.5+r.y/this.height),y=Math.sin(m)*c/Math.sin(hs(Math.PI-p-m,.01,Math.PI-.01)),v=this.getHorizon(),x=2*Math.atan(v/this.cameraToCenterDistance)*(.5+r.y/(v*2)),E=Math.sin(x)*c/Math.sin(hs(Math.PI-p-x,.01,Math.PI-.01)),M=Math.min(y,E),I=(Math.cos(Math.PI/2-this._pitch)*M+c)*1.01,P=this.height/50;a=new Float64Array(16),Or.perspective(a,this._fov,this.width/this.height,P,I),a[8]=-r.x*2/this.width,a[9]=r.y*2/this.height,Or.scale(a,a,[1,-1,1]),Or.translate(a,a,[0,0,-this.cameraToCenterDistance]),Or.rotateX(a,a,this._pitch),Or.rotateZ(a,a,this.angle),Or.translate(a,a,[-i,-n,0]),this.mercatorMatrix=Or.scale([],a,[this.worldSize,this.worldSize,this.worldSize]),Or.scale(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=Or.multiply(new Float64Array(16),this.labelPlaneMatrix,a),Or.translate(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=Or.invert([],a),this.pixelMatrix3D=Or.multiply(new Float64Array(16),this.labelPlaneMatrix,a);let C=this.width%2/2,T=this.height%2/2,D=Math.cos(this.angle),F=Math.sin(this.angle),k=i-Math.round(i)+D*C+F*T,B=n-Math.round(n)+D*T+F*C,U=new Float64Array(a);if(Or.translate(U,U,[k>.5?k-1:k,B>.5?B-1:B,0]),this.alignedProjMatrix=U,a=Or.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new as.default(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return Kl.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=this._pitch,r=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new as.default(0,r))}getCameraQueryGeometry(e){let r=this.getCameraPoint();if(e.length===1)return[e[0],r];{let i=r.x,n=r.y,a=r.x,o=r.y;for(let l of e)i=Math.min(i,l.x),n=Math.min(n,l.y),a=Math.max(a,l.x),o=Math.max(o,l.y);return[new as.default(i,n),new as.default(a,n),new as.default(a,o),new as.default(i,o),new as.default(i,n)]}}lngLatToCameraDepth(e,r){let i=this.locationCoordinate(e),n=[i.x*this.worldSize,i.y*this.worldSize,r,1];return Kl.transformMat4(n,n,this.projMatrix),n[2]/n[3]}};s(dle,"Transform");var qBe=dle;N();N();function PP(t,e){let r=!1,i=null,n=null,a,o=s(()=>{i=null,r&&(t.apply(n,a),i=setTimeout(o,e),r=!1)},"later");return(...l)=>(r=!0,n=this,a=l,i||o(),i)}s(PP,"throttle");var mle=class{constructor(e){this._getCurrentHash=s(()=>{let r=window.location.hash.replace("#","");if(this._hashName){let i;return r.split("&").map(n=>n.split("=")).forEach(n=>{n[0]===this._hashName&&(i=n)}),(i&&i[1]||"").split("/")}return r.split("/")},"_getCurrentHash"),this._onHashChange=s(()=>{let r=this._getCurrentHash();if(r.length>=3&&!r.some(i=>isNaN(i))){let i=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:i,pitch:+(r[4]||0)}),!0}return!1},"_onHashChange"),this._updateHashUnthrottled=s(()=>{let r=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,r)}catch{}},"_updateHashUnthrottled"),this._updateHash=PP(this._updateHashUnthrottled,30*1e3/100),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){let r=this._map.getCenter(),i=Math.round(this._map.getZoom()*100)/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,n),o=Math.round(r.lng*a)/a,l=Math.round(r.lat*a)/a,u=this._map.getBearing(),c=this._map.getPitch(),p="";if(e?p+="/".concat(o,"/").concat(l,"/").concat(i):p+="".concat(i,"/").concat(l,"/").concat(o),(u||c)&&(p+="/".concat(Math.round(u*10)/10)),c&&(p+="/".concat(Math.round(c))),this._hashName){let m=this._hashName,y=!1,v=window.location.hash.slice(1).split("&").map(x=>{let E=x.split("=")[0];return E===m?(y=!0,"".concat(E,"=").concat(p)):x}).filter(x=>x);return y||v.push("".concat(m,"=").concat(p)),"#".concat(v.join("&"))}return"#".concat(p)}};s(mle,"Hash");var WBe=mle;N();N();var XBe=Rr(kn(),1),LP={linearity:.3,easing:W3(0,0,.3,1)},ZBe=Fr({deceleration:2500,maxSpeed:1400},LP),YBe=Fr({deceleration:20,maxSpeed:1400},LP),KBe=Fr({deceleration:1e3,maxSpeed:360},LP),JBe=Fr({deceleration:1e3,maxSpeed:90},LP),gle=class{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:yn.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,r=yn.now(),i=160;for(;e.length>0&&r-e[0].time>i;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let r={zoom:0,bearing:0,pitch:0,pan:new XBe.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:a}of this._inertiaBuffer)r.zoom+=a.zoomDelta||0,r.bearing+=a.bearingDelta||0,r.pitch+=a.pitchDelta||0,a.panDelta&&r.pan._add(a.panDelta),a.around&&(r.around=a.around),a.pinchAround&&(r.pinchAround=a.pinchAround);let i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(r.pan.mag()){let a=u2(r.pan.mag(),i,Fr({},ZBe,e||{}));n.offset=r.pan.mult(a.amount/r.pan.mag()),n.center=this._map.transform.center,l2(n,a)}if(r.zoom){let a=u2(r.zoom,i,YBe);n.zoom=this._map.transform.zoom+a.amount,l2(n,a)}if(r.bearing){let a=u2(r.bearing,i,KBe);n.bearing=this._map.transform.bearing+hs(a.amount,-179,179),l2(n,a)}if(r.pitch){let a=u2(r.pitch,i,JBe);n.pitch=this._map.transform.pitch+a.amount,l2(n,a)}if(n.zoom||n.bearing){let a=r.pinchAround===void 0?r.around:r.pinchAround;n.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),Fr(n,{noMoveStart:!0})}};s(gle,"HandlerInertia");var QBe=gle;function l2(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}s(l2,"extendDuration");function u2(t,e,r){let{maxSpeed:i,linearity:n,deceleration:a}=r,o=hs(t*n/(e/1e3),-i,i),l=Math.abs(o)/(a*n);return{easing:r.easing,duration:l*1e3,amount:o*(l/2)}}s(u2,"calculateEasing");N();N();var eze=Rr(kn(),1),yle=class extends pr{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i,n={}){let a=or.mousePos(r.getCanvas(),i),o=r.unproject(a);super(e,Fr({point:a,lngLat:o,originalEvent:i},n)),this._defaultPrevented=!1,this.target=r}};s(yle,"MapMouseEvent");var Kc=yle,vle=class extends pr{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){let n=e==="touchend"?i.changedTouches:i.touches,a=or.touchPos(r.getCanvasContainer(),n),o=a.map(c=>r.unproject(c)),l=a.reduce((c,p,m,y)=>c.add(p.div(y.length)),new eze.default(0,0)),u=r.unproject(l);super(e,{points:a,point:l,lngLats:o,lngLat:u,originalEvent:i}),this._defaultPrevented=!1}};s(vle,"MapTouchEvent");var LM=vle,_le=class extends pr{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}};s(_le,"MapWheelEvent");var tze=_le,xle=class{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new tze(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Kc(e.type,this._map,e))}mouseup(e){this._map.fire(new Kc(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Kc(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Kc(e.type,this._map,e))}mouseover(e){this._map.fire(new Kc(e.type,this._map,e))}mouseout(e){this._map.fire(new Kc(e.type,this._map,e))}touchstart(e){return this._firePreventable(new LM(e.type,this._map,e))}touchmove(e){this._map.fire(new LM(e.type,this._map,e))}touchend(e){this._map.fire(new LM(e.type,this._map,e))}touchcancel(e){this._map.fire(new LM(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};s(xle,"MapEventHandler");var rze=xle,ble=class{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Kc(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Kc("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Kc(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};s(ble,"BlockableMapEventHandler");var ize=ble;N();N();var nze=Rr(kn(),1),wle=class{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(nze.default.convert(e),this._map.terrain)}};s(wle,"TransformProvider");var IA=wle,Ale=class{constructor(e,r){this._map=e,this._tr=new IA(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){console.warn("boxZoom will not work. Use SDK interaction events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(or.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;let i=r;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=i,this._box||(this._box=or.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let a=Math.min(n.x,i.x),o=Math.max(n.x,i.x),l=Math.min(n.y,i.y),u=Math.max(n.y,i.y);or.setTransform(this._box,"translate(".concat(a,"px,").concat(l,"px)")),this._box.style.width="".concat(o-a,"px"),this._box.style.height="".concat(u-l,"px")}mouseupWindow(e,r){if(!this._active||e.button!==0)return;let i=this._startPos,n=r;if(this.reset(),or.suppressClick(),i.x===n.x&&i.y===n.y)this._fireEvent("boxzoomcancel",e);else return this._map.fire(new pr("boxzoomend",{originalEvent:e})),{cameraAnimation:s(a=>a.fitScreenCoordinates(i,n,this._tr.bearing,{linear:!0}),"cameraAnimation")}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(or.remove(this._box),this._box=null),or.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new pr(e,{originalEvent:r}))}};s(Ale,"BoxZoomHandler");var aze=Ale;N();N();var oze=Rr(kn(),1);N();function NT(t,e){if(t.length!==e.length)throw new Error("The number of touches and points are not equal - touches ".concat(t.length,", points ").concat(e.length));let r={};for(let i=0;i<t.length;i++)r[t[i].identifier]=e[i];return r}s(NT,"indexTouches");function Sle(t){let e=new oze.default(0,0);for(let r of t)e._add(r);return e.div(t.length)}s(Sle,"getCentroid");var Mle=500,sze=500,JF=30,Ele=class{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=Sle(r),this.touches=NT(i,r)))}touchmove(e,r,i){if(this.aborted||!this.centroid)return;let n=NT(i,r);for(let a in this.touches){let o=this.touches[a],l=n[a];(!l||l.dist(o)>JF)&&(this.aborted=!0)}}touchend(e,r,i){if((!this.centroid||e.timeStamp-this.startTime>sze)&&(this.aborted=!0),i.length===0){let n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}};s(Ele,"SingleTapRecognizer");var lze=Ele,Cle=class{constructor(e){this.singleTap=new lze(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,i){this.singleTap.touchstart(e,r,i)}touchmove(e,r,i){this.singleTap.touchmove(e,r,i)}touchend(e,r,i){let n=this.singleTap.touchend(e,r,i);if(n){let a=e.timeStamp-this.lastTime<Mle,o=!this.lastTap||this.lastTap.dist(n)<JF;if((!a||!o)&&this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}};s(Cle,"TapRecognizer");var mR=Cle,Ile=class{constructor(e){this._tr=new IA(e),this._zoomIn=new mR({numTouches:1,numTaps:2}),this._zoomOut=new mR({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,i){this._zoomIn.touchstart(e,r,i),this._zoomOut.touchstart(e,r,i)}touchmove(e,r,i){this._zoomIn.touchmove(e,r,i),this._zoomOut.touchmove(e,r,i)}touchend(e,r,i){let n=this._zoomIn.touchend(e,r,i),a=this._zoomOut.touchend(e,r,i),o=this._tr;if(n)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s(l=>l.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(n)},{originalEvent:e}),"cameraAnimation")};if(a)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s(l=>l.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:e}),"cameraAnimation")}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Ile,"TapZoomHandler");var uze=Ile;N();N();var Tle=class{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=r.length?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;let i=this._lastPoint;if(!i)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e)){this.reset(e);return}let n=r.length?r[0]:r;if(!(!this._moved&&n.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(i,n)}dragEnd(e){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(e)&&(this._moved&&or.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}};s(Tle,"DragHandler");var TA=Tle;N();var cze=0,hze=2,pze={[cze]:1,[hze]:2};function Ple(t,e){let r=pze[e];return t.buttons===void 0||(t.buttons&r)!==r}s(Ple,"buttonNoLongerPressed");var Lle=class{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let r=or.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!Ple(e,this._eventButton)}isValidEndEvent(e){return or.mouseButton(e)===this._eventButton}};s(Lle,"MouseMoveStateManager");var QF=Lle,Dle=class{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){let r=e.targetTouches[0].identifier;this._firstTouch=r}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}};s(Dle,"OneFingerTouchMoveStateManager");var Rle=Dle,eB=0,Ole=2,tB=s(t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=function(e){e.preventDefault()}},"assignEvents"),dze=s(({enable:t,clickTolerance:e})=>{let r=new QF({checkCorrectEvent:s(i=>or.mouseButton(i)===eB&&!i.ctrlKey,"checkCorrectEvent")});return new TA({clickTolerance:e,move:s((i,n)=>({around:n,panDelta:n.sub(i)}),"move"),activateOnStart:!0,moveStateManager:r,enable:t,assignEvents:tB})},"generateMousePanHandler"),kle=s(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:r=.8})=>{let i=new QF({checkCorrectEvent:s(n=>or.mouseButton(n)===eB&&n.ctrlKey||or.mouseButton(n)===Ole,"checkCorrectEvent")});return new TA({clickTolerance:e,move:s((n,a)=>({bearingDelta:(a.x-n.x)*r}),"move"),moveStateManager:i,enable:t,assignEvents:tB})},"generateMouseRotationHandler"),Nle=s(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:r=-.5})=>{let i=new QF({checkCorrectEvent:s(n=>or.mouseButton(n)===eB&&n.ctrlKey||or.mouseButton(n)===Ole,"checkCorrectEvent")});return new TA({clickTolerance:e,move:s((n,a)=>({pitchDelta:(a.y-n.y)*r}),"move"),moveStateManager:i,enable:t,assignEvents:tB})},"generateMousePitchHandler");N();var zL=Rr(kn(),1),Fle=class{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new zL.default(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,r,i){return this._calculateTransform(e,r,i)}touchmove(e,r,i){if(!(!this._active||i.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,r,i)}touchend(e,r,i){this._calculateTransform(e,r,i),this._active&&i.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,i){i.length>0&&(this._active=!0);let n=NT(i,r),a=new zL.default(0,0),o=new zL.default(0,0),l=0;for(let c in n){let p=n[c],m=this._touches[c];m&&(a._add(p),o._add(p.sub(m)),l++,n[c]=p)}if(this._touches=n,l<this.minTouchs()||!o.mag())return;let u=o.div(l);return this._sum._add(u),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(l),panDelta:u}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Fle,"TouchPanHandler");var fze=Fle;N();var Ble=class{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,i){if(!this._firstTwoTouches)return;e.preventDefault();let[n,a]=this._firstTwoTouches,o=c2(i,r,n),l=c2(i,r,a);if(!o||!l)return;let u=this._aroundCenter?null:o.add(l).div(2);return this._move([o,l],u,e)}touchend(e,r,i){if(!this._firstTwoTouches)return;let[n,a]=this._firstTwoTouches,o=c2(i,r,n),l=c2(i,r,a);o&&l||(this._active&&or.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}};s(Ble,"TwoFingersTouchHandler");var rB=Ble;function c2(t,e,r){for(let i=0;i<t.length;i++)if(t[i].identifier===r)return e[i]}s(c2,"getTouchById");var mze=.1;function gR(t,e){return Math.log(t/e)/Math.LN2}s(gR,"getZoomDelta");var zle=class extends rB{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){let i=this._distance;if(this._distance=e[0].dist(e[1]),!(!this._active&&Math.abs(gR(this._distance,this._startDistance))<mze))return this._active=!0,{zoomDelta:gR(this._distance,i),pinchAround:r}}};s(zle,"TwoFingersTouchZoomHandler");var gze=zle,yze=25;function yR(t,e){return t.angleWith(e)*180/Math.PI}s(yR,"getBearingDelta");var Ule=class extends rB{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,i){let n=this._vector;if(this._vector=e[0].sub(e[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:yR(this._vector,n),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let r=Math.PI*this._minDiameter,i=yze/r*360,n=yR(e,this._startVector);return Math.abs(n)<i}};s(Ule,"TwoFingersTouchRotateHandler");var vze=Ule;function qE(t){return Math.abs(t.y)>Math.abs(t.x)}s(qE,"isVertical");var _ze=100,Vle=class extends rB{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,i){super.touchstart(e,r,i),this._currentTouchCount=i.length}_start(e){this._lastPoints=e,qE(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,i){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let n=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,a,i.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+a.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,i){if(this._valid!==void 0)return this._valid;let n=2,a=e.mag()>=n,o=r.mag()>=n;if(!a&&!o)return;if(!a||!o)return this._firstMove===void 0&&(this._firstMove=i),i-this._firstMove<_ze?void 0:!1;let l=e.y>0==r.y>0;return qE(e)&&qE(r)&&l}};s(Vle,"TwoFingersTouchPitchHandler");var xze=Vle;N();var bze={panStep:100,bearingStep:15,pitchStep:10},jle=class{constructor(e){this._tr=new IA(e);let r=bze;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,i=0,n=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:s(l=>{let u=this._tr;l.easeTo({duration:300,easeId:"keyboardHandler",easing:$le,zoom:r?Math.round(u.zoom)+r*(e.shiftKey?2:1):u.zoom,bearing:u.bearing+i*this._bearingStep,pitch:u.pitch+n*this._pitchStep,offset:[-a*this._panStep,-o*this._panStep],center:u.center},{originalEvent:e})},"cameraAnimation")}}enable(){console.warn("maplibre keyboard events are not supported, use SDK keyboard events instead.")}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}};s(jle,"KeyboardHandler");var wze=jle;function $le(t){return t*(2-t)}s($le,"easeOut");N();var dq=4.000244140625,Aze=1/100,Sze=1/450,Mze=2,Gle=class{constructor(e,r){this._onTimeout=s(i=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)},"_onTimeout"),this._map=e,this._tr=new IA(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=Aze,this._wheelZoomRate=Sze}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){console.log("Enable maplibre scrollZoom events will not work. Use Mappedin SDK interactions events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?e.deltaY*40:e.deltaY,i=yn.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,r!==0&&r%dq===0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r=r/4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let r=or.mousePos(this._map.getCanvas(),e),i=this._tr;r.y>i.transform.height/2-i.transform.getHorizon()?this._around=Yi.convert(this._aroundCenter?i.center:i.unproject(r)):this._around=Yi.convert(i.center),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(this._delta!==0){let l=this._type==="wheel"&&Math.abs(this._delta)>dq?this._wheelZoomRate:this._defaultZoomRate,u=Mze/(1+Math.exp(-Math.abs(this._delta*l)));this._delta<0&&u!==0&&(u=1/u);let c=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(c*u))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let r=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,i=this._startZoom,n=this._easing,a=!1,o;if(this._type==="wheel"&&i&&n){let l=Math.min((yn.now()-this._lastWheelEventTime)/200,1),u=n(l);o=Ya.number(i,r,u),l<1?this._frameId||(this._frameId=!0):a=!0}else o=r,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=KD;if(this._prevEase){let i=this._prevEase,n=(yn.now()-i.start)/i.duration,a=i.easing(n+.01)-i.easing(n),o=.27/Math.sqrt(a*a+1e-4)*.01,l=Math.sqrt(.27*.27-o*o);r=W3(o,l,.25,1)}return this._prevEase={start:yn.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}};s(Gle,"ScrollZoomHandler");var Eze=Gle;N();var Hle=class{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}};s(Hle,"DoubleClickZoomHandler");var Cze=Hle;N();var qle=class{constructor(e){this._tr=new IA(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:s(i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})},"cameraAnimation")}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(qle,"ClickZoomHandler");var Ize=qle;N();var Wle=class{constructor(){this._tap=new mR({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,i){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(e,r,i);else{let n=r[0],a=e.timeStamp-this._tapTime<Mle,o=this._tapPoint.dist(n)<JF;!a||!o?this.reset():i.length>0&&(this._swipePoint=n,this._swipeTouch=i[0].identifier)}}touchmove(e,r,i){if(!this._tapTime)this._tap.touchmove(e,r,i);else if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;let n=r[0],a=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(e,r,i){if(this._tapTime)this._swipePoint&&i.length===0&&this.reset();else{let n=this._tap.touchend(e,r,i);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};s(Wle,"TapDragZoomHandler");var Tze=Wle;N();var Xle=class{constructor(e,r,i){this._el=e,this._mousePan=r,this._touchPan=i}enable(e){console.log("Maplibre interaction is not supported. Use Mappedin SDK interaction instead")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}};s(Xle,"DragPanHandler");var Pze=Xle;N();var Zle=class{constructor(e,r,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=r,this._mousePitch=i}enable(){console.warn("dragRotate does not work. Use SDK interaction events instead.")}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}};s(Zle,"DragRotateHandler");var Lze=Zle;N();var Yle=class{constructor(e,r,i,n){this._el=e,this._touchZoom=r,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}};s(Yle,"TwoFingersTouchZoomRotateHandler");var Dze=Yle;N();var Kle=class{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=or.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let i=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=r,this._container.appendChild(n);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=i,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(or.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(e.touches.length===1)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){!this._enabled||!e||(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}};s(Kle,"CooperativeGesturesHandler");var Rze=Kle,Oze=Rr(kn(),1),DM=s(t=>t.zoom||t.drag||t.pitch||t.rotate,"isMoving"),Jle=class extends pr{};s(Jle,"RenderFrameEvent");var kze=Jle;function WE(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}s(WE,"hasChange");var Qle=class{constructor(e,r){this.handleWindowEvent=s(n=>{this.handleEvent(n,"".concat(n.type,"Window"))},"handleWindowEvent"),this.handleEvent=s((n,a)=>{if(n.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;let o=n.type==="renderFrame"?void 0:n,l={needsRenderFrame:!1},u={},c={},p=n.touches,m=p?this._getMapTouches(p):void 0,y=m?or.touchPos(this._map.getCanvas(),m):or.mousePos(this._map.getCanvas(),n);for(let{handlerName:E,handler:M,allowed:I}of this._handlers){if(!M.isEnabled())continue;let P;this._blockedByActive(c,I,E)?M.reset():M[a||n.type]&&(P=M[a||n.type](n,y,m),this.mergeHandlerResult(l,u,P,E,o),P&&P.needsRenderFrame&&this._triggerRenderFrame()),(P||M.isActive())&&(c[E]=M)}let v={};for(let E in this._previousActiveHandlers)c[E]||(v[E]=o);this._previousActiveHandlers=c,(Object.keys(v).length||WE(l))&&(this._changes.push([l,u,v]),this._triggerRenderFrame()),(Object.keys(c).length||WE(l))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:x}=l;x&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],x(this._map))},"handleEvent"),this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new QBe(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);let i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(let[n,a,o]of this._listeners);}destroy(){for(let[e,r,i]of this._listeners)or.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(e){let r=this._map,i=r.getCanvasContainer();this._add("mapEvent",new rze(r,e));let n=r.boxZoom=new aze(r,e);this._add("boxZoom",n),e.interactive&&e.boxZoom&&n.enable();let a=r.cooperativeGestures=new Rze(r,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let o=new uze(r),l=new Ize(r);r.doubleClickZoom=new Cze(l,o),this._add("tapZoom",o),this._add("clickZoom",l),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();let u=new Tze;this._add("tapDragZoom",u);let c=r.touchPitch=new xze(r);this._add("touchPitch",c),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);let p=kle(e),m=Nle(e);r.dragRotate=new Lze(e,p,m),this._add("mouseRotate",p,["mousePitch"]),this._add("mousePitch",m,["mouseRotate"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();let y=dze(e),v=new fze(e,r);r.dragPan=new Pze(i,y,v),this._add("mousePan",y),this._add("touchPan",v,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);let x=new vze,E=new gze;r.touchZoomRotate=new Dze(i,E,x,u),this._add("touchRotate",x,["touchPan","touchZoom"]),this._add("touchZoom",E,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);let M=r.scrollZoom=new Eze(r,()=>this._triggerRenderFrame());this._add("scrollZoom",M,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);let I=r.keyboard=new wze(r);this._add("keyboard",I),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new ize(r))}_add(e,r,i){this._handlers.push({handlerName:e,handler:r,allowed:i}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(let{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!DM(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,i){for(let n in e)if(n!==i&&(!r||r.indexOf(n)<0))return!0;return!1}_getMapTouches(e){let r=[];for(let i of e){let n=i.target;this._el.contains(n)&&r.push(i)}return r}mergeHandlerResult(e,r,i,n,a){if(!i)return;Fr(e,i);let o={handlerName:n,originalEvent:i.originalEvent||a};i.zoomDelta!==void 0&&(r.zoom=o),i.panDelta!==void 0&&(r.drag=o),i.pitchDelta!==void 0&&(r.pitch=o),i.bearingDelta!==void 0&&(r.rotate=o)}_applyChanges(){let e={},r={},i={};for(let[n,a,o]of this._changes)n.panDelta&&(e.panDelta=(e.panDelta||new Oze.default(0,0))._add(n.panDelta)),n.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+n.pitchDelta),n.around!==void 0&&(e.around=n.around),n.pinchAround!==void 0&&(e.pinchAround=n.pinchAround),n.noInertia&&(e.noInertia=n.noInertia),Fr(r,a),Fr(i,o);this._updateMapTransform(e,r,i),this._changes=[]}_updateMapTransform(e,r,i){let n=this._map,a=n._getTransformForUpdate(),o=n.terrain;if(!WE(e)&&!(o&&this._terrainMovement))return this._fireEvents(r,i,!0);let{panDelta:l,zoomDelta:u,bearingDelta:c,pitchDelta:p,around:m,pinchAround:y}=e;y!==void 0&&(m=y),n._stop(!0),m=m||n.transform.centerPoint;let v=a.pointLocation(l?m.sub(l):m);c&&(a.bearing+=c),p&&(a.pitch+=p),u&&(a.zoom+=u),o?!this._terrainMovement&&(r.drag||r.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,a.setLocationAtPoint(v,m),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,a.recalculateZoom(n.terrain)})):r.drag&&this._terrainMovement?a.center=a.pointLocation(a.centerPoint.sub(l)):a.setLocationAtPoint(v,m):a.setLocationAtPoint(v,m),n._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,i,!0)}_fireEvents(e,r,i){let n=DM(this._eventsInProgress),a=DM(e),o={};for(let p in e){let{originalEvent:m}=e[p];this._eventsInProgress[p]||(o["".concat(p,"start")]=m),this._eventsInProgress[p]=e[p]}!n&&a&&this._fireEvent("movestart",a.originalEvent);for(let p in o)this._fireEvent(p,o[p]);a&&this._fireEvent("move",a.originalEvent);for(let p in e){let{originalEvent:m}=e[p];this._fireEvent(p,m)}let l={},u;for(let p in this._eventsInProgress){let{handlerName:m,originalEvent:y}=this._eventsInProgress[p];this._handlersById[m].isActive()||(delete this._eventsInProgress[p],u=r[m]||y,l["".concat(p,"end")]=u)}for(let p in l)this._fireEvent(p,l[p]);let c=DM(this._eventsInProgress);if(i&&(n||a)&&!c){this._updatingCamera=!0;let p=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),m=s(y=>y!==0&&-this._bearingSnap<y&&y<this._bearingSnap,"shouldSnapToNorth");p&&(p.essential||!yn.prefersReducedMotion)?(m(p.bearing||this._map.getBearing())&&(p.bearing=0),p.freezeElevation=!0,this._map.easeTo(p,{originalEvent:u})):(this._map.fire(new pr("moveend",{originalEvent:u})),m(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new pr(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new kze("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}};s(Qle,"HandlerManager");var Nze=Qle;N();var Sd=Rr(kn(),1),eue=class extends Nl{constructor(e,r){super(),this._renderFrameCallback=s(()=>{let i=Math.min((yn.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},"_renderFrameCallback"),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new Yi(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}panBy(e,r,i){return e=Sd.default.convert(e).mult(-1),this.panTo(this.transform.center,Fr({offset:e},r),i)}panTo(e,r,i){return this.easeTo(Fr({center:e},r),i)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,i){return this.easeTo(Fr({zoom:e},r),i)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,i){return this.easeTo(Fr({bearing:e},r),i)}resetNorth(e,r){return this.rotateTo(0,Fr({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(Fr({bearing:0,pitch:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}cameraForBounds(e,r){e=Km.convert(e);let i=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,r)}_cameraForBoxAndBearing(e,r,i,n){let a={top:0,bottom:0,right:0,left:0};if(n=Fr({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n),typeof n.padding=="number"){let Q=n.padding;n.padding={top:Q,bottom:Q,right:Q,left:Q}}n.padding=Fr(a,n.padding);let o=this.transform,l=o.padding,u=new Km(e,r),c=o.project(u.getNorthWest()),p=o.project(u.getNorthEast()),m=o.project(u.getSouthEast()),y=o.project(u.getSouthWest()),v=JD(-i),x=c.rotate(v),E=p.rotate(v),M=m.rotate(v),I=y.rotate(v),P=new Sd.default(Math.max(x.x,E.x,I.x,M.x),Math.max(x.y,E.y,I.y,M.y)),C=new Sd.default(Math.min(x.x,E.x,I.x,M.x),Math.min(x.y,E.y,I.y,M.y)),T=P.sub(C),D=(o.width-(l.left+l.right+n.padding.left+n.padding.right))/T.x,F=(o.height-(l.top+l.bottom+n.padding.top+n.padding.bottom))/T.y;if(F<0||D<0){Ol("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}let k=Math.min(o.scaleZoom(o.scale*Math.min(D,F)),n.maxZoom),B=Sd.default.convert(n.offset),U=(n.padding.left-n.padding.right)/2,z=(n.padding.top-n.padding.bottom)/2,q=new Sd.default(U,z).rotate(JD(i)),Z=B.add(q).mult(o.scale/o.zoomScale(k));return{center:o.unproject(c.add(m).div(2).sub(Z)),zoom:k,bearing:i}}fitBounds(e,r,i){return this._fitInternal(this.cameraForBounds(e,r),r,i)}fitScreenCoordinates(e,r,i,n,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(Sd.default.convert(e)),this.transform.pointLocation(Sd.default.convert(r)),i,n),n,a)}_fitInternal(e,r,i){return e?(r=Fr(e,r),delete r.padding,r.linear?this.easeTo(r,i):this.flyTo(r,i)):this}jumpTo(e,r){this.stop();let i=this._getTransformForUpdate(),n=!1,a=!1,o=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(n=!0,i.zoom=+e.zoom),e.center!==void 0&&(i.center=Yi.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(a=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(o=!0,i.pitch=+e.pitch),e.padding!=null&&!i.isPaddingEqual(e.padding)&&(i.padding=e.padding),this._applyUpdatedTransform(i),this.fire(new pr("movestart",r)).fire(new pr("move",r)),n&&this.fire(new pr("zoomstart",r)).fire(new pr("zoom",r)).fire(new pr("zoomend",r)),a&&this.fire(new pr("rotatestart",r)).fire(new pr("rotate",r)).fire(new pr("rotateend",r)),o&&this.fire(new pr("pitchstart",r)).fire(new pr("pitch",r)).fire(new pr("pitchend",r)),this.fire(new pr("moveend",r))}calculateCameraOptionsFromTo(e,r,i,n=0){let a=nl.fromLngLat(e,r),o=nl.fromLngLat(i,n),l=o.x-a.x,u=o.y-a.y,c=o.z-a.z,p=Math.hypot(l,u,c);if(p===0)throw new Error("Can't calculate camera options with same From and To");let m=Math.hypot(l,u),y=this.transform.scaleZoom(this.transform.cameraToCenterDistance/p/this.transform.tileSize),v=Math.atan2(l,-u)*180/Math.PI,x=Math.acos(m/p)*180/Math.PI;return x=c<0?90-x:90+x,{center:o.toLngLat(),zoom:y,pitch:x,bearing:v}}easeTo(e,r){var i;this._stop(!1,e.easeId),e=Fr({offset:[0,0],duration:500,easing:KD},e),(e.animate===!1||!e.essential&&yn.prefersReducedMotion)&&(e.duration=0);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="bearing"in e?this._normalizeBearing(e.bearing,o):o,p="pitch"in e?+e.pitch:l,m="padding"in e?e.padding:n.padding,y=Sd.default.convert(e.offset),v=n.centerPoint.add(y),x=n.pointLocation(v),{center:E,zoom:M}=n.getConstrained(Yi.convert(e.center||x),(i=e.zoom)!=null?i:a);this._normalizeCenter(E);let I=n.project(x),P=n.project(E).sub(I),C=n.zoomScale(M-a),T,D;e.around&&(T=Yi.convert(e.around),D=n.locationPoint(T));let F={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||M!==a,this._rotating=this._rotating||o!==c,this._pitching=this._pitching||p!==l,this._padding=!n.isPaddingEqual(m),this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,F),this.terrain&&this._prepareElevation(E),this._ease(k=>{if(this._zooming&&(n.zoom=Ya.number(a,M,k)),this._rotating&&(n.bearing=Ya.number(o,c,k)),this._pitching&&(n.pitch=Ya.number(l,p,k)),this._padding&&(n.interpolatePadding(u,m,k),v=n.centerPoint.add(y)),this.terrain&&!e.freezeElevation&&this._updateElevation(k),T)n.setLocationAtPoint(T,D);else{let B=n.zoomScale(n.zoom-a),U=M>a?Math.min(2,C):Math.max(.5,C),z=Math.pow(U,1-k),q=n.unproject(I.add(P.mult(k*z)).mult(B));n.setLocationAtPoint(n.renderWorldCopies?q.wrap():q,v)}this._applyUpdatedTransform(n),this._fireMoveEvents(r)},k=>{this.terrain&&this._finalizeElevation(),this._afterEase(r,k)},e),this}_prepareEase(e,r,i={}){this._moving=!0,!r&&!i.moving&&this.fire(new pr("movestart",e)),this._zooming&&!i.zooming&&this.fire(new pr("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new pr("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new pr("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){let i=this._elevationTarget-this._elevationStart,n=(r-(i*e+this._elevationStart))/(1-e);this._elevationStart+=e*(i-n),this._elevationTarget=r}this.transform.elevation=Ya.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let r=e.clone(),{center:i,zoom:n,pitch:a,bearing:o,elevation:l}=this.transformCameraUpdate(r);i&&(r.center=i),n!==void 0&&(r.zoom=n),a!==void 0&&(r.pitch=a),o!==void 0&&(r.bearing=o),l!==void 0&&(r.elevation=l),this.transform.apply(r)}_fireMoveEvents(e){this.fire(new pr("move",e)),this._zooming&&this.fire(new pr("zoom",e)),this._rotating&&this.fire(new pr("rotate",e)),this._pitching&&this.fire(new pr("pitch",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;let i=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new pr("zoomend",e)),n&&this.fire(new pr("rotateend",e)),a&&this.fire(new pr("pitchend",e)),this.fire(new pr("moveend",e))}flyTo(e,r){var i;if(!e.essential&&yn.prefersReducedMotion){let he=dA(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(he,r)}this.stop(),e=Fr({offset:[0,0],speed:1.2,curve:1.42,easing:KD},e);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="bearing"in e?this._normalizeBearing(e.bearing,o):o,p="pitch"in e?+e.pitch:l,m="padding"in e?e.padding:n.padding,y=Sd.default.convert(e.offset),v=n.centerPoint.add(y),x=n.pointLocation(v),{center:E,zoom:M}=n.getConstrained(Yi.convert(e.center||x),(i=e.zoom)!=null?i:a);this._normalizeCenter(E);let I=n.zoomScale(M-a),P=n.project(x),C=n.project(E).sub(P),T=e.curve,D=Math.max(n.width,n.height),F=D/I,k=C.mag();if("minZoom"in e){let he=hs(Math.min(e.minZoom,a,M),n.minZoom,n.maxZoom),J=D/n.zoomScale(he-a);T=Math.sqrt(J/k*2)}let B=T*T;function U(he){let J=(F*F-D*D+(he?-1:1)*B*B*k*k)/(2*(he?F:D)*B*k);return Math.log(Math.sqrt(J*J+1)-J)}s(U,"zoomOutFactor");function z(he){return(Math.exp(he)-Math.exp(-he))/2}s(z,"sinh");function q(he){return(Math.exp(he)+Math.exp(-he))/2}s(q,"cosh");function Z(he){return z(he)/q(he)}s(Z,"tanh");let Q=U(!1),V=s(function(he){return q(Q)/q(Q+T*he)},"w"),ae=s(function(he){return D*((q(Q)*Z(Q+T*he)-z(Q))/B)/k},"u"),Y=(U(!0)-Q)/T;if(Math.abs(k)<1e-6||!isFinite(Y)){if(Math.abs(D-F)<1e-6)return this.easeTo(e,r);let he=F<D?-1:1;Y=Math.abs(Math.log(F/D))/T,ae=s(function(){return 0},"u"),V=s(function(J){return Math.exp(he*T*J)},"w")}if("duration"in e)e.duration=+e.duration;else{let he="screenSpeed"in e?+e.screenSpeed/T:+e.speed;e.duration=1e3*Y/he}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==c,this._pitching=p!==l,this._padding=!n.isPaddingEqual(m),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(E),this._ease(he=>{let J=he*Y,ne=1/V(J);n.zoom=he===1?M:a+n.scaleZoom(ne),this._rotating&&(n.bearing=Ya.number(o,c,he)),this._pitching&&(n.pitch=Ya.number(l,p,he)),this._padding&&(n.interpolatePadding(u,m,he),v=n.centerPoint.add(y)),this.terrain&&!e.freezeElevation&&this._updateElevation(he);let ee=he===1?E:n.unproject(P.add(C.mult(ae(J))).mult(ne));n.setLocationAtPoint(n.renderWorldCopies?ee.wrap():ee,v),this._applyUpdatedTransform(n),this._fireMoveEvents(r)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,r)}if(!e){let i=this.handlers;i&&i.stop(!1)}return this}_ease(e,r,i){i.animate===!1||i.duration===0?(e(1),r()):(this._easeStart=yn.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=Ay(e,-180,180);let i=Math.abs(e-r);return Math.abs(e-360-r)<i&&(e-=360),Math.abs(e+360-r)<i&&(e+=360),e}_normalizeCenter(e){let r=this.transform;if(!r.renderWorldCopies||r.lngRange)return;let i=e.lng-r.center.lng;e.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(Yi.convert(e),this.transform.tileZoom)-this.transform.elevation:null}};s(eue,"Camera");var Fze=eue,rm=Rr(kn(),1);N();var tue={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'},rue=class{constructor(e=tue){this._toggleAttribution=s(()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},"_toggleAttribution"),this._updateData=s(r=>{r&&(r.sourceDataType==="metadata"||r.sourceDataType==="visibility"||r.dataType==="style"||r.type==="terrain")&&this._updateAttributions()},"_updateData"),this._updateCompact=s(()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):!this._container.classList.contains("maplibregl-compact")&&!this._container.classList.contains("maplibregl-attrib-empty")&&(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},"_updateCompact"),this._updateCompactMinimize=s(()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},"_updateCompactMinimize"),this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=or.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=or.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=or.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){or.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){let i=this._map._getUIString("AttributionControl.".concat(r));e.title=i,e.setAttribute("aria-label",i)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(n=>typeof n!="string"?"":n)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let n=this._map.style.stylesheet;this.styleOwner=n.owner,this.styleId=n.id}let r=this._map.style.sourceCaches;for(let n in r){let a=r[n];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e=e.filter(n=>String(n).trim()),e.sort((n,a)=>n.length-a.length),e=e.filter((n,a)=>{for(let o=a+1;o<e.length;o++)if(e[o].indexOf(n)>=0)return!1;return!0});let i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}};s(rue,"AttributionControl");var Bze=rue;N();var iue=class{constructor(e={}){this._updateCompact=s(()=>{let r=this._container.children;if(r.length){let i=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&i.classList.add("maplibregl-compact"):i.classList.remove("maplibregl-compact")}},"_updateCompact"),this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=or.create("div","maplibregl-ctrl");let r=or.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){or.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}};s(iue,"LogoControl");var zze=iue;N();var nue=class{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){let r=this._currentlyRunning,i=r?this._queue.concat(r):this._queue;for(let n of i)if(n.id===e){n.cancelled=!0;return}}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let r=this._currentlyRunning=this._queue;this._queue=[];for(let i of r)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}};s(nue,"TaskQueue");var Uze=nue;N();var vR=(t=>(t.create="create",t.load="load",t.fullLoad="fullLoad",t))(vR||{}),RM=null,Cb=[],Vze=60,UL=1e3/Vze,VL="loadTime",jL="fullLoadTime",Ib={mark(t){performance.mark(t)},frame(t){let e=t;if(RM!=null){let r=e-RM;Cb.push(r)}RM=e},clearMetrics(){RM=null,Cb=[],performance.clearMeasures(VL),performance.clearMeasures(jL);for(let t in vR)performance.clearMarks(vR[t])},getPerformanceMetrics(){performance.measure(VL,"create","load"),performance.measure(jL,"create","fullLoad");let t=performance.getEntriesByName(VL)[0].duration,e=performance.getEntriesByName(jL)[0].duration,r=Cb.length,i=1/(Cb.reduce((o,l)=>o+l,0)/r/1e3),n=Cb.filter(o=>o>UL).reduce((o,l)=>o+(l-UL)/UL,0),a=n/(r+n)*100;return{loadTime:t,fullLoadTime:e,fps:i,percentDroppedFrames:a,totalFrames:r}}};N();N();var jze=no([{name:"a_pos3d",type:"Int16",components:3}]);N();var aue=class extends Nl{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];let i={};for(let n of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r}))i[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),Or.ortho(n.posMatrix,0,8192,0,8192,0,1),this._tiles[n.key]=new Yae(n,this.tileSize));for(let n in this._tiles)i[n]||delete this._tiles[n]}freeRtt(e){for(let r in this._tiles){let i=this._tiles[r];(!e||i.tileID.equals(e)||i.tileID.isChildOf(e)||e.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let r={};for(let i of this._renderableTilesKeys){let n=this._tiles[i].tileID;if(n.canonical.equals(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16),Or.ortho(a.posMatrix,0,8192,0,8192,0,1),r[i]=a}else if(n.canonical.isChildOf(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=n.canonical.z-e.canonical.z,l=n.canonical.x-(n.canonical.x>>o<<o),u=n.canonical.y-(n.canonical.y>>o<<o),c=8192>>o;Or.ortho(a.posMatrix,0,c,0,c,0,1),Or.translate(a.posMatrix,a.posMatrix,[-l*c,-u*c,0]),r[i]=a}else if(e.canonical.isChildOf(n.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=e.canonical.z-n.canonical.z,l=e.canonical.x-(e.canonical.x>>o<<o),u=e.canonical.y-(e.canonical.y>>o<<o),c=8192>>o;Or.ortho(a.posMatrix,0,8192,0,8192,0,1),Or.translate(a.posMatrix,a.posMatrix,[l*c,u*c,0]),Or.scale(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),r[i]=a}}return r}getSourceTile(e,r){let i=this.sourceCache._source,n=e.overscaledZ-this.deltaZoom;if(n>i.maxzoom&&(n=i.maxzoom),n<i.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if(!(a&&a.dem)&&r)for(;n>=i.minzoom&&!(a&&a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(n--).key);return a}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(r=>r.timeAdded>=e)}};s(aue,"TerrainSourceCache");var $ze=aue,oue=class{constructor(e,r,i){this.painter=e,this.sourceCache=new $ze(r),this.options=i,this.exaggeration=typeof i.exaggeration=="number"?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,i,n=8192){var a;if(!(r>=0&&r<n&&i>=0&&i<n))return 0;let o=this.getTerrainData(e),l=(a=o.tile)==null?void 0:a.dem;if(!l)return 0;let u=gF.transformMat4([],[r/n*8192,i/n*8192],o.u_terrain_matrix),c=[u[0]*l.dim,u[1]*l.dim],p=Math.floor(c[0]),m=Math.floor(c[1]),y=c[0]-p,v=c[1]-m;return l.get(p,m)*(1-y)*(1-v)+l.get(p+1,m)*y*(1-v)+l.get(p,m+1)*(1-y)*v+l.get(p+1,m+1)*y*v}getElevationForLngLatZoom(e,r){let{tileID:i,mercatorX:n,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(i,n%8192,a%8192,8192)}getElevation(e,r,i,n=8192){return this.getDEMElevation(e,r,i,n)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let n=this.painter.context,a=new mo({width:1,height:1},new Uint8Array(1*4));this._emptyDepthTexture=new Ms(n,a,n.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ms(n,new mo({width:1,height:1}),n.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Or.identity([])}let r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){let n=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new Ms(n,r.dem.getPixels(),n.gl.RGBA,{premultiply:!1}),r.demTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}let i=r&&r+r.tileID.key+e.key;if(i&&!this._demMatrixCache[i]){let n=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?a=e.canonical.z-n:Ol("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let o=e.canonical.x-(e.canonical.x>>a<<a),l=e.canonical.y-(e.canonical.y>>a<<a),u=Or.fromScaling(new Float64Array(16),[1/(8192<<a),1/(8192<<a),0]);Or.translate(u,u,[o*8192,l*8192,0]),this._demMatrixCache[e.key]={matrix:u,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){let r=this.painter,i=r.width/devicePixelRatio,n=r.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==i||this._fbo.height!==n)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ms(r.context,{width:i,height:n,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ms(r.context,{width:i,height:n,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(i,n,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,i,n))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let a=0,o=0;a<this._coordsTextureSize;a++)for(let l=0;l<this._coordsTextureSize;l++,o+=4)r[o+0]=l&255,r[o+1]=a&255,r[o+2]=l>>8<<4|a>>8,r[o+3]=0;let i=new mo({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),n=new Ms(e,i,e.gl.RGBA,{premultiply:!1});return n.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let r=new Uint8Array(4),i=this.painter.context,n=i.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),l=Math.round(this.painter.height/devicePixelRatio);i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(a,l-o-1,1,1,n.RGBA,n.UNSIGNED_BYTE,r),i.bindFramebuffer.set(null);let u=r[0]+(r[2]>>4<<8),c=r[1]+((r[2]&15)<<8),p=this.coordsIndex[255-r[3]],m=p&&this.sourceCache.getTileByID(p);if(!m)return null;let y=this._coordsTextureSize,v=(1<<m.tileID.canonical.z)*y;return new nl((m.tileID.canonical.x*y+u)/v+m.tileID.wrap,(m.tileID.canonical.y*y+c)/v,this.getElevation(m.tileID,u,c,y))}depthAtPoint(e){let r=new Uint8Array(4),i=this.painter.context,n=i.gl;return i.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,r),i.bindFramebuffer.set(null),(r[0]/(256*256*256)+r[1]/(256*256)+r[2]/256+r[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,r=new Gke,i=new cv,n=this.meshSize,a=8192/n,o=n*n;for(let m=0;m<=n;m++)for(let y=0;y<=n;y++)r.emplaceBack(y*a,m*a,0);for(let m=0;m<o;m+=n+1)for(let y=0;y<n;y++)i.emplaceBack(y+m,n+y+m+1,n+y+m+2),i.emplaceBack(y+m,n+y+m+2,y+m+1);let l=r.length,u=l+(n+1)*2;for(let m of[0,1])for(let y=0;y<=n;y++)for(let v of[0,1])r.emplaceBack(y*a,m*8192,v);for(let m=0;m<n*2;m+=2)i.emplaceBack(u+m,u+m+1,u+m+3),i.emplaceBack(u+m,u+m+3,u+m+2),i.emplaceBack(l+m,l+m+3,l+m+1),i.emplaceBack(l+m,l+m+2,l+m+3);let c=r.length,p=c+(n+1)*2;for(let m of[0,1])for(let y=0;y<=n;y++)for(let v of[0,1])r.emplaceBack(m*8192,y*a,v);for(let m=0;m<n*2;m+=2)i.emplaceBack(c+m,c+m+1,c+m+3),i.emplaceBack(c+m,c+m+3,c+m+2),i.emplaceBack(p+m,p+m+3,p+m+1),i.emplaceBack(p+m,p+m+2,p+m+3);return this._mesh={indexBuffer:e.createIndexBuffer(i),vertexBuffer:e.createVertexBuffer(r,jze.members),segments:Io.simpleSegment(0,0,r.length,i.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*BF/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,r){var i;let{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(i=this.getMinMaxElevation(n).minElevation)!=null?i:0}getMinMaxElevation(e){let r=this.getTerrainData(e).tile,i={minElevation:null,maxElevation:null};return r&&r.dem&&(i.minElevation=r.dem.min*this.exaggeration,i.maxElevation=r.dem.max*this.exaggeration),i}_getOverscaledTileIDFromLngLatZoom(e,r){let i=nl.fromLngLat(e.wrap()),n=(1<<r)*8192,a=i.x*n,o=i.y*n,l=Math.floor(a/8192),u=Math.floor(o/8192);return{tileID:new hc(r,0,r,l,u),mercatorX:a,mercatorY:o}}};s(oue,"Terrain");var Gze=oue;N();N();var sue=class{constructor(e,r,i){this._context=e,this._size=r,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new Ms(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(i.texture),{id:e,fbo:r,texture:i,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return this._objects.length<this._size?!1:this._objects.some(e=>!e.inUse)===!1}};s(sue,"RenderPool");var Hze=sue,i0={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0},lue=class{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new Hze(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(i=>!e._layers[i].isHidden(r)),this._coordsDescendingInv={};for(let i in e.sourceCaches){this._coordsDescendingInv[i]={};let n=e.sourceCaches[i].getVisibleCoordinates();for(let a of n){let o=this.terrain.sourceCache.getTerrainCoords(a);for(let l in o)this._coordsDescendingInv[i][l]||(this._coordsDescendingInv[i][l]=[]),this._coordsDescendingInv[i][l].push(o[l])}}this._coordsDescendingInvStr={};for(let i of e._order){let n=e._layers[i],a=n.source;if(i0[n.type]&&!this._coordsDescendingInvStr[a]){this._coordsDescendingInvStr[a]={};for(let o in this._coordsDescendingInv[a])this._coordsDescendingInvStr[a][o]=this._coordsDescendingInv[a][o].map(l=>l.key).sort().join()}}for(let i of this._renderableTiles)for(let n in this._coordsDescendingInvStr){let a=this._coordsDescendingInvStr[n][i.tileID.key];a&&a!==i.rttCoords[n]&&(i.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let r=e.type,i=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(i0[r]&&((!this._prevType||!i0[this._prevType])&&this._stacks.push([]),this._prevType=r,this._stacks[this._stacks.length-1].push(e.id),!n))return!0;if(i0[this._prevType]||i0[r]&&n){this._prevType=r;let a=this._stacks.length-1,o=this._stacks[a]||[];for(let l of this._renderableTiles){if(this.pool.isFull()&&(fR(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(l),l.rtt[a]){let c=this.pool.getObjectForId(l.rtt[a].id);if(c.stamp===l.rtt[a].stamp){this.pool.useObject(c);continue}}let u=this.pool.getOrCreateFreeObject();this.pool.useObject(u),this.pool.stampObject(u),l.rtt[a]={id:u.id,stamp:u.stamp},i.context.bindFramebuffer.set(u.fbo.framebuffer),i.context.clear({color:Pi.transparent,stencil:0}),i.currentStencilSource=void 0;for(let c=0;c<o.length;c++){let p=i.style._layers[o[c]],m=p.source?this._coordsDescendingInv[p.source][l.tileID.key]:[l.tileID];i.context.viewport.set([0,0,u.fbo.width,u.fbo.height]),i._renderTileClippingMasks(p,m),i.renderLayer(i,i.style.sourceCaches[p.source],p,m),p.source&&(l.rttCoords[p.source]=this._coordsDescendingInvStr[p.source][l.tileID.key])}}return fR(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),i0[r]}return!1}};s(lue,"RenderToTexture");var qze=lue;N();var Wze={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Xze=tZ.version,XE=-2,uue=22,pm=0,cue=80,OM=85,Zze={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:XE,maxZoom:uue,minPitch:pm,maxPitch:cue,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:tue,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:wc.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},hue=class extends Fze{constructor(e){if(Ib.mark("create"),e=Fr({},Zze,e),e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<pm)throw new Error("minPitch must be greater than or equal to ".concat(pm));if(e.maxPitch!=null&&e.maxPitch>OM)throw new Error("maxPitch must be less than or equal to ".concat(OM));let r=new qBe(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(super(r,{bearingSnap:e.bearingSnap}),this._contextLost=s(n=>{n.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new pr("webglcontextlost",{originalEvent:n}))},"_contextLost"),this._contextRestored=s(n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new pr("webglcontextrestored",{originalEvent:n}))},"_contextRestored"),this._onMapScroll=s(n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},"_onMapScroll"),this._onWindowOnline=s(()=>{this._update()},"_onWindowOnline"),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new Uze,this._controls=[],this._mapId=M9(),this._locale=Fr({},Wze,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=Hp.addThrottleControl(()=>this.isMoving()),this._requestManager=new vOe(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error("Container '".concat(e.container,"' not found."))}else if(e.container instanceof HTMLElement)this._container=e.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1,a=PP(o=>{this._trackResize&&!this._removed&&this.resize(o)._update()},50);this._resizeObserver=new ResizeObserver(o=>{if(!n){n=!0;return}a(o)}),this._resizeObserver.observe(this._container)}this.handlers=new Nze(this,e);let i=typeof e.hash=="string"&&e.hash||void 0;this._hash=e.hash&&new WBe(i).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,Fr({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Bze(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new zze,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new pr("".concat(n.dataType,"data"),n))}),this.on("dataloading",n=>{this.fire(new pr("".concat(n.dataType,"dataloading"),n))}),this.on("dataabort",n=>{this.fire(new pr("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(e,r){if(r===void 0&&(e.getDefaultPosition?r=e.getDefaultPosition():r="top-right"),!e||!e.onAdd)return this.fire(new di(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let i=e.onAdd(this);this._controls.push(e);let n=this._controlPositions[r];return r.indexOf("bottom")!==-1?n.insertBefore(i,n.firstChild):n.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new di(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,r,i,n){return n==null&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,r,i,n)}resize(e){var r;let i=this._containerDimensions(),n=i[0],a=i[1],o=this._getClampedPixelRatio(n,a);if(this._resizeCanvas(n,a,o),this.painter.resize(n,a,o),this.painter.overLimit()){let u=this.painter.context.gl;this._maxCanvasSize=[u.drawingBufferWidth,u.drawingBufferHeight];let c=this._getClampedPixelRatio(n,a);this._resizeCanvas(n,a,c),this.painter.resize(n,a,c)}this.transform.resize(n,a),(r=this._requestedCameraState)==null||r.resize(n,a);let l=!this._moving;return l&&(this.stop(),this.fire(new pr("movestart",e)).fire(new pr("move",e))),this.fire(new pr("resize",e)),l&&this.fire(new pr("moveend",e)),this}_getClampedPixelRatio(e,r){let{0:i,1:n}=this._maxCanvasSize,a=this.getPixelRatio(),o=e*a,l=r*a,u=o>i?i/o:1,c=l>n?n/l:1;return Math.min(u,c)*a}getPixelRatio(){var e;return(e=this._overridePixelRatio)!=null?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Km.convert(e)),this._update()}setMinZoom(e){if(e=e??XE,e>=XE&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between ".concat(XE," and the current maxZoom, inclusive"))}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if(e=e??uue,e>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if(e=e??pm,e<pm)throw new Error("minPitch must be greater than or equal to ".concat(pm));if(e>=pm&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between ".concat(pm," and the current maxPitch, inclusive"))}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(e=e??cue,e>OM)throw new Error("maxPitch must be less than or equal to ".concat(OM));if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(Yi.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(rm.default.convert(e),this.terrain)}isMoving(){var e;return this._moving||((e=this.handlers)==null?void 0:e.isMoving())}isZooming(){var e;return this._zooming||((e=this.handlers)==null?void 0:e.isZooming())}isRotating(){var e;return this._rotating||((e=this.handlers)==null?void 0:e.isRotating())}_createDelegatedListener(e,r,i){if(e==="mouseenter"||e==="mouseover"){let n=!1;return{layer:r,listener:i,delegates:{mousemove:s(a=>{let o=this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[];o.length?n||(n=!0,i.call(this,new Kc(e,this,a.originalEvent,{features:o}))):n=!1},"mousemove"),mouseout:s(()=>{n=!1},"mouseout")}}}else if(e==="mouseleave"||e==="mouseout"){let n=!1;return{layer:r,listener:i,delegates:{mousemove:s(a=>{(this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[]).length?n=!0:n&&(n=!1,i.call(this,new Kc(e,this,a.originalEvent)))},"mousemove"),mouseout:s(a=>{n&&(n=!1,i.call(this,new Kc(e,this,a.originalEvent)))},"mouseout")}}}else{let n=s(a=>{let o=this.getLayer(r)?this.queryRenderedFeatures(a.point,{layers:[r]}):[];o.length&&(a.features=o,i.call(this,a),delete a.features)},"delegate");return{layer:r,listener:i,delegates:{[e]:n}}}}on(e,r,i){if(i===void 0)return super.on(e,r);let n=this._createDelegatedListener(e,r,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(let a in n.delegates)this.on(a,n.delegates[a]);return this}once(e,r,i){if(i===void 0)return super.once(e,r);let n=this._createDelegatedListener(e,r,i);for(let a in n.delegates)this.once(a,n.delegates[a]);return this}off(e,r,i){if(i===void 0)return super.off(e,r);let n=s(a=>{let o=a[e];for(let l=0;l<o.length;l++){let u=o[l];if(u.layer===r&&u.listener===i){for(let c in u.delegates)this.off(c,u.delegates[c]);return o.splice(l,1),this}}},"removeDelegatedListener");return this._delegatedListeners&&this._delegatedListeners[e]&&n(this._delegatedListeners),this}queryRenderedFeatures(e,r){if(!this.style)return[];let i,n=e instanceof rm.default||Array.isArray(e),a=n?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(n?{}:e)||{},a instanceof rm.default||typeof a[0]=="number")i=[rm.default.convert(a)];else{let o=rm.default.convert(a[0]),l=rm.default.convert(a[1]);i=[o,new rm.default(l.x,o.y),l,new rm.default(o.x,l.y),o]}return this.style.queryRenderedFeatures(i,r,this.transform)}querySourceFeatures(e,r){return this.style.querySourceFeatures(e,r)}setStyle(e,r){return r=Fr({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r),r.diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let r=this._locale[e];if(r==null)throw new Error("Missing UI string '".concat(e,"'"));return r}_updateStyle(e,r){if(r.transformStyle&&this.style&&!this.style._loaded){this.style.once("style.load",()=>this._updateStyle(e,r));return}let i=this.style&&r.transformStyle?this.style.serialize():void 0;if(this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e)this.style=new uq(this,r||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e,r,i):this.style.loadJSON(e,r,i),this}_lazyInitEmptyStyle(){this.style||(this.style=new uq(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if(typeof e=="string"){let i=e,n=this._requestManager.transformRequest(i,"Style");Y3(n,new AbortController).then(a=>{this._updateDiff(a.data,r)}).catch(a=>{a&&this.fire(new di(a))})}else typeof e=="object"&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(i){Ol("Unable to perform style diff: ".concat(i.message||i.error||i,".  Rebuilding the style from scratch.")),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():Ol("There is no style added to the map.")}addSource(e,r){return this._lazyInitEmptyStyle(),this.style.addSource(e,r),this._update(!0)}isSourceLoaded(e){let r=this.style&&this.style.sourceCaches[e];if(r===void 0){this.fire(new di(new Error("There is no source with ID '".concat(e,"'"))));return}return r.loaded()}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),!e)this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;else{let r=this.style.sourceCaches[e.source];if(!r)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(e.source));this.terrain===null&&r.reload();for(let i in this.style._layers){let n=this.style._layers[i];n.type==="hillshade"&&n.source===e.source&&Ol("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Gze(this.painter,r,e),this.painter.renderToTexture=new qze(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId===e.source&&!this._elevationFreeze&&(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}return this.fire(new pr("terrain",{terrain:e})),this}getTerrain(){var e,r;return(r=(e=this.terrain)==null?void 0:e.options)!=null?r:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let r in e){let i=e[r]._tiles;for(let n in i){let a=i[n];if(!(a.state==="loaded"||a.state==="errored"))return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,r,i={}){let{pixelRatio:n=1,sdf:a=!1,stretchX:o,stretchY:l,content:u}=i;this._lazyInitEmptyStyle();let c=0;if(r instanceof HTMLImageElement||Gp(r)){let{width:p,height:m,data:y}=yn.getImageData(r);this.style.addImage(e,{data:new mo({width:p,height:m},y),pixelRatio:n,stretchX:o,stretchY:l,content:u,sdf:a,version:c})}else{if(r.width===void 0||r.height===void 0)return this.fire(new di(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:p,height:m,data:y}=r,v=r;return this.style.addImage(e,{data:new mo({width:p,height:m},new Uint8Array(y)),pixelRatio:n,stretchX:o,stretchY:l,content:u,sdf:a,version:c,userImage:v}),v.onAdd&&v.onAdd(this,e),this}}}updateImage(e,r){let i=this.style.getImage(e);if(!i)return this.fire(new di(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let n=r instanceof HTMLImageElement||Gp(r)?yn.getImageData(r):r,{width:a,height:o,data:l}=n;if(a===void 0||o===void 0)return this.fire(new di(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==i.data.width||o!==i.data.height)return this.fire(new di(new Error("The width and height of the updated image must be that same as the previous version of the image")));let u=!(r instanceof HTMLImageElement||Gp(r));return i.data.replace(l,u),this.style.updateImage(e,i),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new di(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return Hp.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,r){return this._lazyInitEmptyStyle(),this.style.addLayer(e,r),this._update(!0)}moveLayer(e,r){return this.style.moveLayer(e,r),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,r,i){return this.style.setLayerZoomRange(e,r,i),this._update(!0)}setFilter(e,r,i={}){return this.style.setFilter(e,r,i),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,r,i,n={}){return this.style.setPaintProperty(e,r,i,n),this._update(!0)}getPaintProperty(e,r){return this.style.getPaintProperty(e,r)}setLayoutProperty(e,r,i,n={}){return this.style.setLayoutProperty(e,r,i,n),this._update(!0)}getLayoutProperty(e,r){return this.style.getLayoutProperty(e,r)}setGlyphs(e,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,r,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,r,i,n=>{n||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,r,i=>{i||this._update(!0)}),this}setLight(e,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,r){return this.style.setFeatureState(e,r),this._update()}removeFeatureState(e,r){return this.style.removeFeatureState(e,r),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,r=0;return this._container&&(e=this._container.clientWidth||400,r=this._container.clientHeight||300),[e,r]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let r=this._canvasContainer=or.create("div","maplibregl-canvas-container",e);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=or.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let i=this._containerDimensions(),n=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],n);let a=this._controlContainer=or.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(l=>{o[l]=or.create("div","maplibregl-ctrl-".concat(l," "),a)})}_resizeCanvas(e,r,i){this._canvas.width=Math.floor(i*e),this._canvas.height=Math.floor(i*r),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(r,"px")}_setupPainter(){let e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},r=null;this._canvas.addEventListener("webglcontextcreationerror",n=>{r={requestedAttributes:e},n&&(r.statusMessage=n.statusMessage,r.type=n.type)},{once:!0});let i=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!i){let n="Failed to initialize WebGL";throw r?(r.message=n,new Error(JSON.stringify(r))):new Error(n)}this.painter=new jBe(i,this.transform),L9.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return!this.style||!this.style._loaded?this:(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this)}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){let r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let a=this.transform.zoom,o=yn.now();this.style.zoomHistory.update(a,o);let l=new ds(a,{now:o,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=l.crossFadingFactor();(u!==1||u!==this._crossFadingFactor)&&(i=!0,this._crossFadingFactor=u),this.style.update(l)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new pr("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,Ib.mark("load"),this.fire(new pr("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new pr("idle")),this._loaded&&!this._fullyLoaded&&!n&&(this._fullyLoaded=!0,Ib.mark("fullLoad")),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(let i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Hp.removeThrottleControl(this._imageQueueHandle),(e=this._resizeObserver)==null||e.disconnect();let r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),or.remove(this._canvasContainer),or.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),Ib.clearMetrics(),this._removed=!0,this.fire(new pr("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,yn.frameAsync(this._frameRequest).then(e=>{Ib.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return Xze}getCameraTargetElevation(){return this.transform.elevation}};s(hue,"Map");var xlt=hue;N();N();var pue=s(t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},"assignEvents"),Yze=s(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:r=.8})=>{let i=new Rle;return new TA({clickTolerance:e,move:s((n,a)=>({bearingDelta:(a.x-n.x)*r}),"move"),moveStateManager:i,enable:t,assignEvents:pue})},"generateOneFingerTouchRotationHandler"),Kze=s(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:r=-.5})=>{let i=new Rle;return new TA({clickTolerance:e,move:s((n,a)=>({pitchDelta:(a.y-n.y)*r}),"move"),moveStateManager:i,enable:t,assignEvents:pue})},"generateOneFingerTouchPitchHandler"),Jze={showCompass:!0,showZoom:!0,visualizePitch:!1},due=class{constructor(e){this._updateZoomButtons=s(()=>{let r=this._map.getZoom(),i=r===this._map.getMaxZoom(),n=r===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},"_updateZoomButtons"),this._rotateCompassArrow=s(()=>{let r=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(this._map.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(this._map.transform.angle*(180/Math.PI),"deg)");this._compassIcon.style.transform=r},"_rotateCompassArrow"),this._setButtonTitle=s((r,i)=>{let n=this._map._getUIString("NavigationControl.".concat(i));r.title=n,r.setAttribute("aria-label",n)},"_setButtonTitle"),this.options=Fr({},Jze,e),this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),or.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),or.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=or.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Qze(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){or.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,r){let i=or.create("button",e,this._container);return i.type="button",i.addEventListener("click",r),i}};s(due,"NavigationControl");var wlt=due,fue=class{constructor(e,r,i=!1){this.mousedown=s(o=>{this.startMouse(Fr({},o,{ctrlKey:!0,preventDefault:s(()=>o.preventDefault(),"preventDefault")}),or.mousePos(this.element,o)),or.addEventListener(window,"mousemove",this.mousemove),or.addEventListener(window,"mouseup",this.mouseup)},"mousedown"),this.mousemove=s(o=>{this.moveMouse(o,or.mousePos(this.element,o))},"mousemove"),this.mouseup=s(o=>{this.mouseRotate.dragEnd(o),this.mousePitch&&this.mousePitch.dragEnd(o),this.offTemp()},"mouseup"),this.touchstart=s(o=>{o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=or.touchPos(this.element,o.targetTouches)[0],this.startTouch(o,this._startPos),or.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),or.addEventListener(window,"touchend",this.touchend))},"touchstart"),this.touchmove=s(o=>{o.targetTouches.length!==1?this.reset():(this._lastPos=or.touchPos(this.element,o.targetTouches)[0],this.moveTouch(o,this._lastPos))},"touchmove"),this.touchend=s(o=>{o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},"touchend"),this.reset=s(()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},"reset"),this._clickTolerance=10;let n=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=r,this.mouseRotate=kle({clickTolerance:n,enable:!0}),this.touchRotate=Yze({clickTolerance:n,enable:!0}),this.map=e,i&&(this.mousePitch=Nle({clickTolerance:a,enable:!0}),this.touchPitch=Kze({clickTolerance:a,enable:!0})),or.addEventListener(r,"mousedown",this.mousedown),or.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),or.addEventListener(r,"touchcancel",this.reset)}startMouse(e,r){this.mouseRotate.dragStart(e,r),this.mousePitch&&this.mousePitch.dragStart(e,r),or.disableDrag()}startTouch(e,r){this.touchRotate.dragStart(e,r),this.touchPitch&&this.touchPitch.dragStart(e,r),or.disableDrag()}moveMouse(e,r){let i=this.map,{bearingDelta:n}=this.mouseRotate.dragMove(e,r)||{};if(n&&i.setBearing(i.getBearing()+n),this.mousePitch){let{pitchDelta:a}=this.mousePitch.dragMove(e,r)||{};a&&i.setPitch(i.getPitch()+a)}}moveTouch(e,r){let i=this.map,{bearingDelta:n}=this.touchRotate.dragMove(e,r)||{};if(n&&i.setBearing(i.getBearing()+n),this.touchPitch){let{pitchDelta:a}=this.touchPitch.dragMove(e,r)||{};a&&i.setPitch(i.getPitch()+a)}}off(){let e=this.element;or.removeEventListener(e,"mousedown",this.mousedown),or.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),or.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),or.removeEventListener(window,"touchend",this.touchend),or.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){or.enableDrag(),or.removeEventListener(window,"mousemove",this.mousemove),or.removeEventListener(window,"mouseup",this.mouseup),or.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),or.removeEventListener(window,"touchend",this.touchend)}};s(fue,"MouseRotateWrapper");var Qze=fue;N();N();var Dg;async function mue(t=!1){if(Dg!==void 0&&!t)return Dg;if(window.navigator.permissions===void 0)return Dg=!!window.navigator.geolocation,Dg;try{Dg=(await window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Dg=!!window.navigator.geolocation}return Dg}s(mue,"checkGeolocationSupport");N();var kM=Rr(kn(),1);N();function iB(t,e,r){let i=new Yi(t.lng,t.lat);if(t=new Yi(t.lng,t.lat),e){let n=new Yi(t.lng-360,t.lat),a=new Yi(t.lng+360,t.lat),o=r.locationPoint(t).distSqr(e);r.locationPoint(n).distSqr(e)<o?t=n:r.locationPoint(a).distSqr(e)<o&&(t=a)}for(;Math.abs(t.lng-r.center.lng)>180;){let n=r.locationPoint(t);if(n.x>=0&&n.y>=0&&n.x<=r.width&&n.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t.lng!==i.lng&&r.locationPoint(t).y>r.height/2-r.getHorizon()?t:i}s(iB,"smartWrap");N();var nB={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function aB(t,e,r){let i=t.classList;for(let n in nB)i.remove("maplibregl-".concat(r,"-anchor-").concat(n));i.add("maplibregl-".concat(r,"-anchor-").concat(e))}s(aB,"applyAnchorClass");var gue=class extends Nl{constructor(e){if(super(),this._onKeyPress=s(r=>{let i=r.code,n=r.charCode||r.keyCode;(i==="Space"||i==="Enter"||n===32||n===13)&&this.togglePopup()},"_onKeyPress"),this._onMapClick=s(r=>{let i=r.originalEvent.target,n=this._element;this._popup&&(i===n||n.contains(i))&&this.togglePopup()},"_onMapClick"),this._update=s(r=>{var i;if(!this._map)return;let n=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!n)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies?this._lngLat=iB(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(i=this._lngLat)==null?void 0:i.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a="rotateZ(".concat(this._rotation,"deg)"):this._rotationAlignment==="map"&&(a="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));let o="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?o="rotateX(0deg)":this._pitchAlignment==="map"&&(o="rotateX(".concat(this._map.getPitch(),"deg)")),(!r||r.type==="moveend")&&(this._pos=this._pos.round()),or.setTransform(this._element,"".concat(nB[this._anchor]," translate(").concat(this._pos.x,"px, ").concat(this._pos.y,"px) ").concat(o," ").concat(a)),yn.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},"_update"),this._onMove=s(r=>{if(!this._isDragging){let i=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=i}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new pr("dragstart"))),this.fire(new pr("drag")))},"_onMove"),this._onUp=s(()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new pr("dragend")),this._state="inactive"},"_onUp"),this._addDragHandler=s(r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},"_addDragHandler"),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),!e||!e.element){this._defaultMarker=!0,this._element=or.create("div"),this._element.setAttribute("aria-label","Map marker");let r=or.createNS("http://www.w3.org/2000/svg","svg"),i=41,n=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","".concat(i,"px")),r.setAttributeNS(null,"width","".concat(n,"px")),r.setAttributeNS(null,"viewBox","0 0 ".concat(n," ").concat(i));let a=or.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");let o=or.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");let l=or.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");let u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let I of u){let P=or.createNS("http://www.w3.org/2000/svg","ellipse");P.setAttributeNS(null,"opacity","0.04"),P.setAttributeNS(null,"cx","10.5"),P.setAttributeNS(null,"cy","5.80029008"),P.setAttributeNS(null,"rx",I.rx),P.setAttributeNS(null,"ry",I.ry),l.appendChild(P)}let c=or.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);let p=or.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(p);let m=or.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"fill","#000000");let y=or.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),m.appendChild(y);let v=or.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");let x=or.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(8.0, 8.0)");let E=or.createNS("http://www.w3.org/2000/svg","circle");E.setAttributeNS(null,"fill","#000000"),E.setAttributeNS(null,"opacity","0.25"),E.setAttributeNS(null,"cx","5.5"),E.setAttributeNS(null,"cy","5.5"),E.setAttributeNS(null,"r","5.4999962");let M=or.createNS("http://www.w3.org/2000/svg","circle");M.setAttributeNS(null,"fill","#FFFFFF"),M.setAttributeNS(null,"cx","5.5"),M.setAttributeNS(null,"cy","5.5"),M.setAttributeNS(null,"r","5.4999962"),x.appendChild(E),x.appendChild(M),o.appendChild(l),o.appendChild(c),o.appendChild(m),o.appendChild(v),o.appendChild(x),r.appendChild(o),r.setAttributeNS(null,"height","".concat(i*this._scale,"px")),r.setAttributeNS(null,"width","".concat(n*this._scale,"px")),this._element.appendChild(r),this._offset=kM.default.convert(e&&e.offset||[0,-14])}else this._element=e.element,this._offset=kM.default.convert(e&&e.offset||[0,0]);if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),aB(this._element,this._anchor,"marker"),e&&e.className)for(let r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),or.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Yi.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let r=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[r,(38.1-13.5+r)*-1],"bottom-right":[-r,(38.1-13.5+r)*-1],left:[13.5,(38.1-13.5)*-1],right:[-13.5,(38.1-13.5)*-1]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let e=this._popup;if(this._element.style.opacity===this._opacityWhenCovered)return this;if(e)e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map));else return this;return this}_updateOpacity(e=!1){var r,i;if(!((r=this._map)!=null&&r.terrain)){this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity);return}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let n=this._map,a=n.terrain.depthAtPoint(this._pos),o=n.terrain.getElevationForLngLatZoom(this._lngLat,n.transform.tileZoom),l=n.transform.lngLatToCameraDepth(this._lngLat,o),u=.006;if(l-a<u){this._element.style.opacity=this._opacity;return}let c=-this._offset.y/n.transform._pixelPerMeter,p=Math.sin(n.getPitch()*Math.PI/180)*c,m=n.terrain.depthAtPoint(new kM.default(this._pos.x,this._pos.y-this._offset.y)),y=n.transform.lngLatToCameraDepth(this._lngLat,o+p)-m>u;(i=this._popup)!=null&&i.isOpen()&&y&&this._popup.remove(),this._element.style.opacity=y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=kM.default.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return e===void 0&&r===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}};s(gue,"Marker");var fq=gue,eUe={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},NM=0,Tb=!1,yue=class extends Nl{constructor(e){super(),this._onSuccess=s(r=>{if(this._map){if(this._isOutOfMapMaxBounds(r)){this._setErrorState(),this.fire(new pr("outofmaxbounds",r)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new pr("geolocate",r)),this._finish()}},"_onSuccess"),this._updateCamera=s(r=>{let i=new Yi(r.coords.longitude,r.coords.latitude),n=r.coords.accuracy,a=this._map.getBearing(),o=Fr({bearing:a},this.options.fitBoundsOptions),l=Km.fromLngLat(i,n);this._map.fitBounds(l,o,{geolocateSource:!0})},"_updateCamera"),this._updateMarker=s(r=>{if(r){let i=new Yi(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},"_updateMarker"),this._onZoom=s(()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},"_onZoom"),this._onError=s(r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Tb)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new pr("error",r)),this._finish()}},"_onError"),this._finish=s(()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},"_finish"),this._setupUI=s(r=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=or.create("button","maplibregl-ctrl-geolocate",this._container),or.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){Ol("Geolocation support is not available so the GeolocateControl will be disabled.");let i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{let i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=or.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new fq({element:this._dotElement}),this._circleElement=or.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fq({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{let n=i.originalEvent&&i.originalEvent.type==="resize";!i.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!n&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new pr("trackuserlocationend")))})}},"_setupUI"),this.options=Fr({},eUe,e)}onAdd(e){return this._map=e,this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),mue().then(r=>this._setupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),or.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,NM=0,Tb=!1}_isOutOfMapMaxBounds(e){let r=this._map.getMaxBounds(),i=e.coords;return r&&(i.longitude<r.getWest()||i.longitude>r.getEast()||i.latitude<r.getSouth()||i.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}}_updateCircleRadius(){let e=this._map.getBounds(),r=e.getSouthEast(),i=e.getNorthEast(),n=r.distanceTo(i),a=this._map._container.clientHeight,o=Math.ceil(2*(this._accuracy/(n/a)));this._circleElement.style.width="".concat(o,"px"),this._circleElement.style.height="".concat(o,"px")}trigger(){if(!this._setup)return Ol("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new pr("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":NM--,Tb=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new pr("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new pr("trackuserlocationstart"));break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),NM++;let e;NM>1?(e={maximumAge:6e5,timeout:0},Tb=!0):(e=this.options.positionOptions,Tb=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}};s(yue,"GeolocateControl");var Elt=yue;N();var tUe={maxWidth:100,unit:"metric"},vue=class{constructor(e){this._onMove=s(()=>{_R(this._map,this._container,this.options)},"_onMove"),this.setUnit=s(r=>{this.options.unit=r,_R(this._map,this._container,this.options)},"setUnit"),this.options=Ee(Ee({},tUe),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){or.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}};s(vue,"ScaleControl");var Ilt=vue;function _R(t,e,r){let i=r&&r.maxWidth||100,n=t._container.clientHeight/2,a=t.unproject([0,n]),o=t.unproject([i,n]),l=a.distanceTo(o);if(r&&r.unit==="imperial"){let u=3.2808*l;if(u>5280){let c=u/5280;I0(e,i,c,t._getUIString("ScaleControl.Miles"))}else I0(e,i,u,t._getUIString("ScaleControl.Feet"))}else if(r&&r.unit==="nautical"){let u=l/1852;I0(e,i,u,t._getUIString("ScaleControl.NauticalMiles"))}else l>=1e3?I0(e,i,l/1e3,t._getUIString("ScaleControl.Kilometers")):I0(e,i,l,t._getUIString("ScaleControl.Meters"))}s(_R,"updateScale");function I0(t,e,r,i){let n=xue(r),a=n/r;t.style.width="".concat(e*a,"px"),t.innerHTML="".concat(n,"&nbsp;").concat(i)}s(I0,"setScale");function _ue(t){let e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}s(_ue,"getDecimalRoundNum");function xue(t){let e=Math.pow(10,"".concat(Math.floor(t)).length-1),r=t/e;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:_ue(r),e*r}s(xue,"getRoundNum");N();var bue=class extends Nl{constructor(e={}){super(),this._onFullscreenChange=s(()=>{var r;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;(r=i==null?void 0:i.shadowRoot)!=null&&r.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},"_onFullscreenChange"),this._onClickFullscreen=s(()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},"_onClickFullscreen"),this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:Ol("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){or.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let e=this._fullscreenButton=or.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);or.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new pr("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new pr("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}};s(bue,"FullscreenControl");var Plt=bue;N();var wue=class{constructor(e){this._toggleTerrain=s(()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},"_toggleTerrain"),this._updateTerrainIcon=s(()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},"_updateTerrainIcon"),this.options=e}onAdd(e){return this._map=e,this._container=or.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=or.create("button","maplibregl-ctrl-terrain",this._container),or.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){or.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}};s(wue,"TerrainControl");var Dlt=wue;N();var Vo=Rr(kn(),1),rUe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},iUe=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Aue=class extends Nl{constructor(e){super(),this.remove=s(()=>(this._content&&or.remove(this._content),this._container&&(or.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new pr("close"))),this),"remove"),this._onMouseUp=s(r=>{this._update(r.point)},"_onMouseUp"),this._onMouseMove=s(r=>{this._update(r.point)},"_onMouseMove"),this._onDrag=s(r=>{this._update(r.point)},"_onDrag"),this._update=s(r=>{var i;let n=this._lngLat||this._trackPointer;if(!this._map||!n||!this._content)return;if(!this._container){if(this._container=or.create("div","maplibregl-popup",this._map.getContainer()),this._tip=or.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let c of this.options.className.split(" "))this._container.classList.add(c);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer?this._lngLat=iB(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(i=this._lngLat)==null?void 0:i.wrap(),this._trackPointer&&!r)return;let a=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let o=this.options.anchor,l=oB(this.options.offset);if(!o){let c=this._container.offsetWidth,p=this._container.offsetHeight,m;a.y+l.bottom.y<p?m=["top"]:a.y>this._map.transform.height-p?m=["bottom"]:m=[],a.x<c/2?m.push("left"):a.x>this._map.transform.width-c/2&&m.push("right"),m.length===0?o="bottom":o=m.join("-")}let u=a.add(l[o]);this.options.subpixelPositioning||(u=u.round()),or.setTransform(this._container,"".concat(nB[o]," translate(").concat(u.x,"px,").concat(u.y,"px)")),aB(this._container,o,"popup")},"_update"),this._onClose=s(()=>{this.remove()},"_onClose"),this.options=Fr(Object.create(rUe),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new pr("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Yi.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){let r=document.createDocumentFragment(),i=document.createElement("body"),n;for(i.innerHTML=e;n=i.firstChild,!!n;)r.appendChild(n);return this.setDOMContent(r)}getMaxWidth(){var e;return(e=this._container)==null?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=or.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=or.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let e=this._container.querySelector(iUe);e&&e.focus()}};s(Aue,"Popup");var Olt=Aue;function oB(t){if(t)if(typeof t=="number"){let e=Math.round(Math.abs(t)/Math.SQRT2);return{center:new Vo.default(0,0),top:new Vo.default(0,t),"top-left":new Vo.default(e,e),"top-right":new Vo.default(-e,e),bottom:new Vo.default(0,-t),"bottom-left":new Vo.default(e,-e),"bottom-right":new Vo.default(-e,-e),left:new Vo.default(t,0),right:new Vo.default(-t,0)}}else if(t instanceof Vo.default||Array.isArray(t)){let e=Vo.default.convert(t);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}else return{center:Vo.default.convert(t.center||[0,0]),top:Vo.default.convert(t.top||[0,0]),"top-left":Vo.default.convert(t["top-left"]||[0,0]),"top-right":Vo.default.convert(t["top-right"]||[0,0]),bottom:Vo.default.convert(t.bottom||[0,0]),"bottom-left":Vo.default.convert(t["bottom-left"]||[0,0]),"bottom-right":Vo.default.convert(t["bottom-right"]||[0,0]),left:Vo.default.convert(t.left||[0,0]),right:Vo.default.convert(t.right||[0,0])};else return oB(new Vo.default(0,0))}s(oB,"normalizeOffset");var klt=Rr(kn(),1),nUe=tZ.version;function aUe(t,e){return b_().setRTLTextPlugin(t,e)}s(aUe,"setRTLTextPlugin");function oUe(){return b_().getRTLTextPluginStatus()}s(oUe,"getRTLTextPluginStatus");function sUe(){return nUe}s(sUe,"getVersion");function lUe(){return SP.workerCount}s(lUe,"getWorkerCount");function uUe(t){SP.workerCount=t}s(uUe,"setWorkerCount");function cUe(){return wc.MAX_PARALLEL_IMAGE_REQUESTS}s(cUe,"getMaxParallelImageRequests");function hUe(t){wc.MAX_PARALLEL_IMAGE_REQUESTS=t}s(hUe,"setMaxParallelImageRequests");function pUe(){return wc.WORKER_URL}s(pUe,"getWorkerUrl");function Sue(t){wc.WORKER_URL=t}s(Sue,"setWorkerUrl");function dUe(t){return kF().broadcast("IS",t)}s(dUe,"importScriptInWorkers");N();var sB="173",$L={LEFT:0,MIDDLE:1,RIGHT:2},fUe=0,mq=1,mUe=2,Mue=1,gUe=2,Rd=3,Qp=0,eu=1,Pu=2,Hm=0,t_=1,gq=2,yq=3,vq=4,yUe=5,dy=100,vUe=101,_Ue=102,xUe=103,bUe=104,wUe=200,AUe=201,SUe=202,MUe=203,xR=204,bR=205,EUe=206,CUe=207,IUe=208,TUe=209,PUe=210,LUe=211,DUe=212,RUe=213,OUe=214,wR=0,AR=1,SR=2,w_=3,MR=4,ER=5,CR=6,IR=7,lB=0,kUe=1,NUe=2,qm=0,FUe=1,BUe=2,zUe=3,UUe=4,VUe=5,jUe=6,$Ue=7,_q="attached",GUe="detached",Eue=300,A_=301,S_=302,FT=303,TR=304,DP=306,Bh=1e3,My=1001,PR=1002,_c=1003,HUe=1004,FM=1005,Up=1006,GL=1007,Ey=1008,ed=1009,Cue=1010,Iue=1011,Lw=1012,uB=1013,Jm=1014,Lu=1015,PA=1016,cB=1017,hB=1018,M_=1020,Tue=35902,Pue=1021,Lue=1022,Ll=1023,Due=1024,Rue=1025,r_=1026,E_=1027,pB=1028,RP=1029,Oue=1030,dB=1031,fB=1033,ZE=33776,YE=33777,KE=33778,JE=33779,LR=35840,DR=35841,RR=35842,OR=35843,kR=36196,NR=37492,FR=37496,BR=37808,zR=37809,UR=37810,VR=37811,jR=37812,$R=37813,GR=37814,HR=37815,qR=37816,WR=37817,XR=37818,ZR=37819,YR=37820,KR=37821,QE=36492,JR=36494,QR=36495,kue=36283,eO=36284,tO=36285,rO=36286,BT=2300,iO=2301,HL=2302,xq=2400,bq=2401,wq=2402,qUe=2500,WUe=0,XUe=1,Aq=2,ZUe=3200,YUe=3201,mB=0,KUe=1,Nm="",il="srgb",Wy="srgb-linear",zT="linear",ma="srgb",Jd=7680,qL=7681,JUe=517,nO=519,QUe=512,eVe=513,tVe=514,Nue=515,rVe=516,iVe=517,nVe=518,aVe=519,aO=35044,Nlt=35048,oO="300 es",sf=2e3,UT=2001,Fue=class{addEventListener(e,r){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(r)===-1&&i[e].push(r)}hasEventListener(e,r){let i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(r)!==-1}removeEventListener(e,r){let i=this._listeners;if(i===void 0)return;let n=i[e];if(n!==void 0){let a=n.indexOf(r);a!==-1&&n.splice(a,1)}}dispatchEvent(e){let r=this._listeners;if(r===void 0)return;let i=r[e.type];if(i!==void 0){e.target=this;let n=i.slice(0);for(let a=0,o=n.length;a<o;a++)n[a].call(this,e);e.target=null}}};s(Fue,"EventDispatcher");var ax=Fue,_l=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Sq=1234567,i_=Math.PI/180,C_=180/Math.PI;function xc(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(_l[t&255]+_l[t>>8&255]+_l[t>>16&255]+_l[t>>24&255]+"-"+_l[e&255]+_l[e>>8&255]+"-"+_l[e>>16&15|64]+_l[e>>24&255]+"-"+_l[r&63|128]+_l[r>>8&255]+"-"+_l[r>>16&255]+_l[r>>24&255]+_l[i&255]+_l[i>>8&255]+_l[i>>16&255]+_l[i>>24&255]).toLowerCase()}s(xc,"generateUUID");function Ki(t,e,r){return Math.max(e,Math.min(r,t))}s(Ki,"clamp");function OP(t,e){return(t%e+e)%e}s(OP,"euclideanModulo");function Bue(t,e,r,i,n){return i+(t-e)*(n-i)/(r-e)}s(Bue,"mapLinear");function zue(t,e,r){return t!==e?(r-t)/(e-t):0}s(zue,"inverseLerp");function n_(t,e,r){return(1-r)*t+r*e}s(n_,"lerp");function Uue(t,e,r,i){return n_(t,e,1-Math.exp(-r*i))}s(Uue,"damp");function Vue(t,e=1){return e-Math.abs(OP(t,e*2)-e)}s(Vue,"pingpong");function jue(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*(3-2*t))}s(jue,"smoothstep");function $ue(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*t*(t*(t*6-15)+10))}s($ue,"smootherstep");function Gue(t,e){return t+Math.floor(Math.random()*(e-t+1))}s(Gue,"randInt");function Hue(t,e){return t+Math.random()*(e-t)}s(Hue,"randFloat");function que(t){return t*(.5-Math.random())}s(que,"randFloatSpread");function Wue(t){t!==void 0&&(Sq=t);let e=Sq+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}s(Wue,"seededRandom");function Xue(t){return t*i_}s(Xue,"degToRad");function Zue(t){return t*C_}s(Zue,"radToDeg");function Yue(t){return(t&t-1)===0&&t!==0}s(Yue,"isPowerOfTwo");function Kue(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}s(Kue,"ceilPowerOfTwo");function Jue(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}s(Jue,"floorPowerOfTwo");function Que(t,e,r,i,n){let a=Math.cos,o=Math.sin,l=a(r/2),u=o(r/2),c=a((e+i)/2),p=o((e+i)/2),m=a((e-i)/2),y=o((e-i)/2),v=a((i-e)/2),x=o((i-e)/2);switch(n){case"XYX":t.set(l*p,u*m,u*y,l*c);break;case"YZY":t.set(u*y,l*p,u*m,l*c);break;case"ZXZ":t.set(u*m,u*y,l*p,l*c);break;case"XZX":t.set(l*p,u*x,u*v,l*c);break;case"YXY":t.set(u*v,l*p,u*x,l*c);break;case"ZYZ":t.set(u*x,u*v,l*p,l*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}s(Que,"setQuaternionFromProperEuler");function Qc(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}s(Qc,"denormalize");function Zn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}s(Zn,"normalize");var $n={DEG2RAD:i_,RAD2DEG:C_,generateUUID:xc,clamp:Ki,euclideanModulo:OP,mapLinear:Bue,inverseLerp:zue,lerp:n_,damp:Uue,pingpong:Vue,smoothstep:jue,smootherstep:$ue,randInt:Gue,randFloat:Hue,randFloatSpread:que,seededRandom:Wue,degToRad:Xue,radToDeg:Zue,isPowerOfTwo:Yue,ceilPowerOfTwo:Kue,floorPowerOfTwo:Jue,setQuaternionFromProperEuler:Que,normalize:Zn,denormalize:Qc},ece=class tce{constructor(e=0,r=0){tce.prototype.isVector2=!0,this.x=e,this.y=r}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,r){return this.x=e,this.y=r,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let r=this.x,i=this.y,n=e.elements;return this.x=n[0]*r+n[3]*i+n[6],this.y=n[1]*r+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,r){return this.x=Ki(this.x,e.x,r.x),this.y=Ki(this.y,e.y,r.y),this}clampScalar(e,r){return this.x=Ki(this.x,e,r),this.y=Ki(this.y,e,r),this}clampLength(e,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ki(i,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;let i=this.dot(e)/r;return Math.acos(Ki(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let r=this.x-e.x,i=this.y-e.y;return r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this}lerpVectors(e,r,i){return this.x=e.x+(r.x-e.x)*i,this.y=e.y+(r.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this}rotateAround(e,r){let i=Math.cos(r),n=Math.sin(r),a=this.x-e.x,o=this.y-e.y;return this.x=a*i-o*n+e.x,this.y=a*n+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};s(ece,"Vector2");var Jt=ece,rce=class ice{constructor(e,r,i,n,a,o,l,u,c){ice.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,r,i,n,a,o,l,u,c)}set(e,r,i,n,a,o,l,u,c){let p=this.elements;return p[0]=e,p[1]=n,p[2]=l,p[3]=r,p[4]=a,p[5]=u,p[6]=i,p[7]=o,p[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let r=this.elements,i=e.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],this}extractBasis(e,r,i){return e.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let r=e.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){let i=e.elements,n=r.elements,a=this.elements,o=i[0],l=i[3],u=i[6],c=i[1],p=i[4],m=i[7],y=i[2],v=i[5],x=i[8],E=n[0],M=n[3],I=n[6],P=n[1],C=n[4],T=n[7],D=n[2],F=n[5],k=n[8];return a[0]=o*E+l*P+u*D,a[3]=o*M+l*C+u*F,a[6]=o*I+l*T+u*k,a[1]=c*E+p*P+m*D,a[4]=c*M+p*C+m*F,a[7]=c*I+p*T+m*k,a[2]=y*E+v*P+x*D,a[5]=y*M+v*C+x*F,a[8]=y*I+v*T+x*k,this}multiplyScalar(e){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=e,r[4]*=e,r[7]*=e,r[2]*=e,r[5]*=e,r[8]*=e,this}determinant(){let e=this.elements,r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8];return r*o*p-r*l*c-i*a*p+i*l*u+n*a*c-n*o*u}invert(){let e=this.elements,r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=p*o-l*c,y=l*u-p*a,v=c*a-o*u,x=r*m+i*y+n*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);let E=1/x;return e[0]=m*E,e[1]=(n*c-p*i)*E,e[2]=(l*i-n*o)*E,e[3]=y*E,e[4]=(p*r-n*u)*E,e[5]=(n*a-l*r)*E,e[6]=v*E,e[7]=(i*u-c*r)*E,e[8]=(o*r-i*a)*E,this}transpose(){let e,r=this.elements;return e=r[1],r[1]=r[3],r[3]=e,e=r[2],r[2]=r[6],r[6]=e,e=r[5],r[5]=r[7],r[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let r=this.elements;return e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8],this}setUvTransform(e,r,i,n,a,o,l){let u=Math.cos(a),c=Math.sin(a);return this.set(i*u,i*c,-i*(u*o+c*l)+o+e,-n*c,n*u,-n*(-c*o+u*l)+l+r,0,0,1),this}scale(e,r){return this.premultiply(WL.makeScale(e,r)),this}rotate(e){return this.premultiply(WL.makeRotation(-e)),this}translate(e,r){return this.premultiply(WL.makeTranslation(e,r)),this}makeTranslation(e,r){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,r,0,0,1),this}makeRotation(e){let r=Math.cos(e),i=Math.sin(e);return this.set(r,-i,0,i,r,0,0,0,1),this}makeScale(e,r){return this.set(e,0,0,0,r,0,0,0,1),this}equals(e){let r=this.elements,i=e.elements;for(let n=0;n<9;n++)if(r[n]!==i[n])return!1;return!0}fromArray(e,r=0){for(let i=0;i<9;i++)this.elements[i]=e[i+r];return this}toArray(e=[],r=0){let i=this.elements;return e[r]=i[0],e[r+1]=i[1],e[r+2]=i[2],e[r+3]=i[3],e[r+4]=i[4],e[r+5]=i[5],e[r+6]=i[6],e[r+7]=i[7],e[r+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};s(rce,"Matrix3");var rn=rce,WL=new rn;function gB(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}s(gB,"arrayNeedsUint32");function I_(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}s(I_,"createElementNS");function nce(){let t=I_("canvas");return t.style.display="block",t}s(nce,"createCanvasElement");var Mq={};function fy(t){t in Mq||(Mq[t]=!0,console.warn(t))}s(fy,"warnOnce");function ace(t,e,r){return new Promise(function(i,n){function a(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:n();break;case t.TIMEOUT_EXPIRED:setTimeout(a,r);break;default:i()}}s(a,"probe"),setTimeout(a,r)})}s(ace,"probeAsync");function oce(t){let e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}s(oce,"toNormalizedProjectionMatrix");function sce(t){let e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}s(sce,"toReversedProjectionMatrix");var Eq=new rn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Cq=new rn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function lce(){let t={enabled:!0,workingColorSpace:Wy,spaces:{},convert:s(function(n,a,o){return this.enabled===!1||a===o||!a||!o||(this.spaces[a].transfer===ma&&(n.r=Xp(n.r),n.g=Xp(n.g),n.b=Xp(n.b)),this.spaces[a].primaries!==this.spaces[o].primaries&&(n.applyMatrix3(this.spaces[a].toXYZ),n.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===ma&&(n.r=Ny(n.r),n.g=Ny(n.g),n.b=Ny(n.b))),n},"convert"),fromWorkingColorSpace:s(function(n,a){return this.convert(n,this.workingColorSpace,a)},"fromWorkingColorSpace"),toWorkingColorSpace:s(function(n,a){return this.convert(n,a,this.workingColorSpace)},"toWorkingColorSpace"),getPrimaries:s(function(n){return this.spaces[n].primaries},"getPrimaries"),getTransfer:s(function(n){return n===Nm?zT:this.spaces[n].transfer},"getTransfer"),getLuminanceCoefficients:s(function(n,a=this.workingColorSpace){return n.fromArray(this.spaces[a].luminanceCoefficients)},"getLuminanceCoefficients"),define:s(function(n){Object.assign(this.spaces,n)},"define"),_getMatrix:s(function(n,a,o){return n.copy(this.spaces[a].toXYZ).multiply(this.spaces[o].fromXYZ)},"_getMatrix"),_getDrawingBufferColorSpace:s(function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},"_getDrawingBufferColorSpace"),_getUnpackColorSpace:s(function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace},"_getUnpackColorSpace")},e=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[Wy]:{primaries:e,whitePoint:i,transfer:zT,toXYZ:Eq,fromXYZ:Cq,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:il},outputColorSpaceConfig:{drawingBufferColorSpace:il}},[il]:{primaries:e,whitePoint:i,transfer:ma,toXYZ:Eq,fromXYZ:Cq,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:il}}}),t}s(lce,"createColorManagement");var Dn=lce();function Xp(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}s(Xp,"SRGBToLinear");function Ny(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}s(Ny,"LinearToSRGB");var n0,uce=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{n0===void 0&&(n0=I_("canvas")),n0.width=e.width,n0.height=e.height;let i=n0.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=n0}return r.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let r=I_("canvas");r.width=e.width,r.height=e.height;let i=r.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let n=i.getImageData(0,0,e.width,e.height),a=n.data;for(let o=0;o<a.length;o++)a[o]=Xp(a[o]/255)*255;return i.putImageData(n,0,0),r}else if(e.data){let r=e.data.slice(0);for(let i=0;i<r.length;i++)r instanceof Uint8Array||r instanceof Uint8ClampedArray?r[i]=Math.floor(Xp(r[i]/255)*255):r[i]=Xp(r[i]);return{data:r,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}};s(uce,"ImageUtils");var oVe=uce,sVe=0,cce=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:sVe++}),this.uuid=xc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let r=e===void 0||typeof e=="string";if(!r&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let o=0,l=n.length;o<l;o++)n[o].isDataTexture?a.push(eC(n[o].image)):a.push(eC(n[o]))}else a=eC(n);i.url=a}return r||(e.images[this.uuid]=i),i}};s(cce,"Source");var hce=cce;function eC(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?oVe.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}s(eC,"serializeImage");var lVe=0,pce=class tC extends ax{constructor(e=tC.DEFAULT_IMAGE,r=tC.DEFAULT_MAPPING,i=My,n=My,a=Up,o=Ey,l=Ll,u=ed,c=tC.DEFAULT_ANISOTROPY,p=Nm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:lVe++}),this.uuid=xc(),this.name="",this.source=new hce(e),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=i,this.wrapT=n,this.magFilter=a,this.minFilter=o,this.anisotropy=c,this.format=l,this.internalFormat=null,this.type=u,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new rn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let r=e===void 0||typeof e=="string";if(!r&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),r||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Eue)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Bh:e.x=e.x-Math.floor(e.x);break;case My:e.x=e.x<0?0:1;break;case PR:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Bh:e.y=e.y-Math.floor(e.y);break;case My:e.y=e.y<0?0:1;break;case PR:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};s(pce,"Texture");var Gu=pce;Gu.DEFAULT_IMAGE=null;Gu.DEFAULT_MAPPING=Eue;Gu.DEFAULT_ANISOTROPY=1;var dce=class fce{constructor(e=0,r=0,i=0,n=1){fce.prototype.isVector4=!0,this.x=e,this.y=r,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,r,i,n){return this.x=e,this.y=r,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this.w=e.w+r.w,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this.w+=e.w*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this.w=e.w-r.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let r=this.x,i=this.y,n=this.z,a=this.w,o=e.elements;return this.x=o[0]*r+o[4]*i+o[8]*n+o[12]*a,this.y=o[1]*r+o[5]*i+o[9]*n+o[13]*a,this.z=o[2]*r+o[6]*i+o[10]*n+o[14]*a,this.w=o[3]*r+o[7]*i+o[11]*n+o[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let r=Math.sqrt(1-e.w*e.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/r,this.y=e.y/r,this.z=e.z/r),this}setAxisAngleFromRotationMatrix(e){let r,i,n,a,o=e.elements,l=o[0],u=o[4],c=o[8],p=o[1],m=o[5],y=o[9],v=o[2],x=o[6],E=o[10];if(Math.abs(u-p)<.01&&Math.abs(c-v)<.01&&Math.abs(y-x)<.01){if(Math.abs(u+p)<.1&&Math.abs(c+v)<.1&&Math.abs(y+x)<.1&&Math.abs(l+m+E-3)<.1)return this.set(1,0,0,0),this;r=Math.PI;let I=(l+1)/2,P=(m+1)/2,C=(E+1)/2,T=(u+p)/4,D=(c+v)/4,F=(y+x)/4;return I>P&&I>C?I<.01?(i=0,n=.707106781,a=.707106781):(i=Math.sqrt(I),n=T/i,a=D/i):P>C?P<.01?(i=.707106781,n=0,a=.707106781):(n=Math.sqrt(P),i=T/n,a=F/n):C<.01?(i=.707106781,n=.707106781,a=0):(a=Math.sqrt(C),i=D/a,n=F/a),this.set(i,n,a,r),this}let M=Math.sqrt((x-y)*(x-y)+(c-v)*(c-v)+(p-u)*(p-u));return Math.abs(M)<.001&&(M=1),this.x=(x-y)/M,this.y=(c-v)/M,this.z=(p-u)/M,this.w=Math.acos((l+m+E-1)/2),this}setFromMatrixPosition(e){let r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this.w=r[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,r){return this.x=Ki(this.x,e.x,r.x),this.y=Ki(this.y,e.y,r.y),this.z=Ki(this.z,e.z,r.z),this.w=Ki(this.w,e.w,r.w),this}clampScalar(e,r){return this.x=Ki(this.x,e,r),this.y=Ki(this.y,e,r),this.z=Ki(this.z,e,r),this.w=Ki(this.w,e,r),this}clampLength(e,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ki(i,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this.w+=(e.w-this.w)*r,this}lerpVectors(e,r,i){return this.x=e.x+(r.x-e.x)*i,this.y=e.y+(r.y-e.y)*i,this.z=e.z+(r.z-e.z)*i,this.w=e.w+(r.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this.w=e[r+3],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e[r+3]=this.w,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this.w=e.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};s(dce,"Vector4");var Jn=dce,mce=class extends ax{constructor(e=1,r=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=r,this.depth=1,this.scissor=new Jn(0,0,e,r),this.scissorTest=!1,this.viewport=new Jn(0,0,e,r);let n={width:e,height:r,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Up,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);let a=new Gu(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);a.flipY=!1,a.generateMipmaps=i.generateMipmaps,a.internalFormat=i.internalFormat,this.textures=[];let o=i.count;for(let l=0;l<o;l++)this.textures[l]=a.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,r,i=1){if(this.width!==e||this.height!==r||this.depth!==i){this.width=e,this.height=r,this.depth=i;for(let n=0,a=this.textures.length;n<a;n++)this.textures[n].image.width=e,this.textures[n].image.height=r,this.textures[n].image.depth=i;this.dispose()}this.viewport.set(0,0,e,r),this.scissor.set(0,0,e,r)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,n=e.textures.length;i<n;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0,this.textures[i].renderTarget=this;let r=Object.assign({},e.texture.image);return this.texture.source=new hce(r),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};s(mce,"RenderTarget");var uVe=mce,gce=class extends uVe{constructor(e=1,r=1,i={}){super(e,r,i),this.isWebGLRenderTarget=!0}};s(gce,"WebGLRenderTarget");var Qm=gce,yce=class extends Gu{constructor(e=null,r=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:r,height:i,depth:n},this.magFilter=_c,this.minFilter=_c,this.wrapR=My,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};s(yce,"DataArrayTexture");var vce=yce,_ce=class extends Gu{constructor(e=null,r=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:r,height:i,depth:n},this.magFilter=_c,this.minFilter=_c,this.wrapR=My,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};s(_ce,"Data3DTexture");var cVe=_ce,xce=class{constructor(e=0,r=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=r,this._z=i,this._w=n}static slerpFlat(e,r,i,n,a,o,l){let u=i[n+0],c=i[n+1],p=i[n+2],m=i[n+3],y=a[o+0],v=a[o+1],x=a[o+2],E=a[o+3];if(l===0){e[r+0]=u,e[r+1]=c,e[r+2]=p,e[r+3]=m;return}if(l===1){e[r+0]=y,e[r+1]=v,e[r+2]=x,e[r+3]=E;return}if(m!==E||u!==y||c!==v||p!==x){let M=1-l,I=u*y+c*v+p*x+m*E,P=I>=0?1:-1,C=1-I*I;if(C>Number.EPSILON){let D=Math.sqrt(C),F=Math.atan2(D,I*P);M=Math.sin(M*F)/D,l=Math.sin(l*F)/D}let T=l*P;if(u=u*M+y*T,c=c*M+v*T,p=p*M+x*T,m=m*M+E*T,M===1-l){let D=1/Math.sqrt(u*u+c*c+p*p+m*m);u*=D,c*=D,p*=D,m*=D}}e[r]=u,e[r+1]=c,e[r+2]=p,e[r+3]=m}static multiplyQuaternionsFlat(e,r,i,n,a,o){let l=i[n],u=i[n+1],c=i[n+2],p=i[n+3],m=a[o],y=a[o+1],v=a[o+2],x=a[o+3];return e[r]=l*x+p*m+u*v-c*y,e[r+1]=u*x+p*y+c*m-l*v,e[r+2]=c*x+p*v+l*y-u*m,e[r+3]=p*x-l*m-u*y-c*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,r,i,n){return this._x=e,this._y=r,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,r=!0){let i=e._x,n=e._y,a=e._z,o=e._order,l=Math.cos,u=Math.sin,c=l(i/2),p=l(n/2),m=l(a/2),y=u(i/2),v=u(n/2),x=u(a/2);switch(o){case"XYZ":this._x=y*p*m+c*v*x,this._y=c*v*m-y*p*x,this._z=c*p*x+y*v*m,this._w=c*p*m-y*v*x;break;case"YXZ":this._x=y*p*m+c*v*x,this._y=c*v*m-y*p*x,this._z=c*p*x-y*v*m,this._w=c*p*m+y*v*x;break;case"ZXY":this._x=y*p*m-c*v*x,this._y=c*v*m+y*p*x,this._z=c*p*x+y*v*m,this._w=c*p*m-y*v*x;break;case"ZYX":this._x=y*p*m-c*v*x,this._y=c*v*m+y*p*x,this._z=c*p*x-y*v*m,this._w=c*p*m+y*v*x;break;case"YZX":this._x=y*p*m+c*v*x,this._y=c*v*m+y*p*x,this._z=c*p*x-y*v*m,this._w=c*p*m-y*v*x;break;case"XZY":this._x=y*p*m-c*v*x,this._y=c*v*m-y*p*x,this._z=c*p*x+y*v*m,this._w=c*p*m+y*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return r===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,r){let i=r/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let r=e.elements,i=r[0],n=r[4],a=r[8],o=r[1],l=r[5],u=r[9],c=r[2],p=r[6],m=r[10],y=i+l+m;if(y>0){let v=.5/Math.sqrt(y+1);this._w=.25/v,this._x=(p-u)*v,this._y=(a-c)*v,this._z=(o-n)*v}else if(i>l&&i>m){let v=2*Math.sqrt(1+i-l-m);this._w=(p-u)/v,this._x=.25*v,this._y=(n+o)/v,this._z=(a+c)/v}else if(l>m){let v=2*Math.sqrt(1+l-i-m);this._w=(a-c)/v,this._x=(n+o)/v,this._y=.25*v,this._z=(u+p)/v}else{let v=2*Math.sqrt(1+m-i-l);this._w=(o-n)/v,this._x=(a+c)/v,this._y=(u+p)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,r){let i=e.dot(r)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*r.z-e.z*r.y,this._y=e.z*r.x-e.x*r.z,this._z=e.x*r.y-e.y*r.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ki(this.dot(e),-1,1)))}rotateTowards(e,r){let i=this.angleTo(e);if(i===0)return this;let n=Math.min(1,r/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,r){let i=e._x,n=e._y,a=e._z,o=e._w,l=r._x,u=r._y,c=r._z,p=r._w;return this._x=i*p+o*l+n*c-a*u,this._y=n*p+o*u+a*l-i*c,this._z=a*p+o*c+i*u-n*l,this._w=o*p-i*l-n*u-a*c,this._onChangeCallback(),this}slerp(e,r){if(r===0)return this;if(r===1)return this.copy(e);let i=this._x,n=this._y,a=this._z,o=this._w,l=o*e._w+i*e._x+n*e._y+a*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=i,this._y=n,this._z=a,this;let u=1-l*l;if(u<=Number.EPSILON){let v=1-r;return this._w=v*o+r*this._w,this._x=v*i+r*this._x,this._y=v*n+r*this._y,this._z=v*a+r*this._z,this.normalize(),this}let c=Math.sqrt(u),p=Math.atan2(c,l),m=Math.sin((1-r)*p)/c,y=Math.sin(r*p)/c;return this._w=o*m+this._w*y,this._x=i*m+this._x*y,this._y=n*m+this._y*y,this._z=a*m+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,r,i){return this.copy(e).slerp(r,i)}random(){let e=2*Math.PI*Math.random(),r=2*Math.PI*Math.random(),i=Math.random(),n=Math.sqrt(1-i),a=Math.sqrt(i);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(r),a*Math.cos(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,r=0){return this._x=e[r],this._y=e[r+1],this._z=e[r+2],this._w=e[r+3],this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._w,e}fromBufferAttribute(e,r){return this._x=e.getX(r),this._y=e.getY(r),this._z=e.getZ(r),this._w=e.getW(r),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};s(xce,"Quaternion");var ff=xce,bce=class wce{constructor(e=0,r=0,i=0){wce.prototype.isVector3=!0,this.x=e,this.y=r,this.z=i}set(e,r,i){return i===void 0&&(i=this.z),this.x=e,this.y=r,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,r){return this.x=e.x*r.x,this.y=e.y*r.y,this.z=e.z*r.z,this}applyEuler(e){return this.applyQuaternion(Iq.setFromEuler(e))}applyAxisAngle(e,r){return this.applyQuaternion(Iq.setFromAxisAngle(e,r))}applyMatrix3(e){let r=this.x,i=this.y,n=this.z,a=e.elements;return this.x=a[0]*r+a[3]*i+a[6]*n,this.y=a[1]*r+a[4]*i+a[7]*n,this.z=a[2]*r+a[5]*i+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let r=this.x,i=this.y,n=this.z,a=e.elements,o=1/(a[3]*r+a[7]*i+a[11]*n+a[15]);return this.x=(a[0]*r+a[4]*i+a[8]*n+a[12])*o,this.y=(a[1]*r+a[5]*i+a[9]*n+a[13])*o,this.z=(a[2]*r+a[6]*i+a[10]*n+a[14])*o,this}applyQuaternion(e){let r=this.x,i=this.y,n=this.z,a=e.x,o=e.y,l=e.z,u=e.w,c=2*(o*n-l*i),p=2*(l*r-a*n),m=2*(a*i-o*r);return this.x=r+u*c+o*m-l*p,this.y=i+u*p+l*c-a*m,this.z=n+u*m+a*p-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let r=this.x,i=this.y,n=this.z,a=e.elements;return this.x=a[0]*r+a[4]*i+a[8]*n,this.y=a[1]*r+a[5]*i+a[9]*n,this.z=a[2]*r+a[6]*i+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,r){return this.x=Ki(this.x,e.x,r.x),this.y=Ki(this.y,e.y,r.y),this.z=Ki(this.z,e.z,r.z),this}clampScalar(e,r){return this.x=Ki(this.x,e,r),this.y=Ki(this.y,e,r),this.z=Ki(this.z,e,r),this}clampLength(e,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ki(i,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this}lerpVectors(e,r,i){return this.x=e.x+(r.x-e.x)*i,this.y=e.y+(r.y-e.y)*i,this.z=e.z+(r.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,r){let i=e.x,n=e.y,a=e.z,o=r.x,l=r.y,u=r.z;return this.x=n*u-a*l,this.y=a*o-i*u,this.z=i*l-n*o,this}projectOnVector(e){let r=e.lengthSq();if(r===0)return this.set(0,0,0);let i=e.dot(this)/r;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return XL.copy(this).projectOnVector(e),this.sub(XL)}reflect(e){return this.sub(XL.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;let i=this.dot(e)/r;return Math.acos(Ki(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let r=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return r*r+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,r,i){let n=Math.sin(r)*e;return this.x=n*Math.sin(i),this.y=Math.cos(r)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,r,i){return this.x=e*Math.sin(r),this.y=i,this.z=e*Math.cos(r),this}setFromMatrixPosition(e){let r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(e){let r=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=r,this.y=i,this.z=n,this}setFromMatrixColumn(e,r){return this.fromArray(e.elements,r*4)}setFromMatrix3Column(e,r){return this.fromArray(e.elements,r*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,r=Math.random()*2-1,i=Math.sqrt(1-r*r);return this.x=i*Math.cos(e),this.y=r,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};s(bce,"Vector3");var qe=bce,XL=new qe,Iq=new ff,Ace=class{constructor(e=new qe(1/0,1/0,1/0),r=new qe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromArray(e){this.makeEmpty();for(let r=0,i=e.length;r<i;r+=3)this.expandByPoint(yh.fromArray(e,r));return this}setFromBufferAttribute(e){this.makeEmpty();for(let r=0,i=e.count;r<i;r++)this.expandByPoint(yh.fromBufferAttribute(e,r));return this}setFromPoints(e){this.makeEmpty();for(let r=0,i=e.length;r<i;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){let i=yh.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,r=!1){return this.makeEmpty(),this.expandByObject(e,r)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,r=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let a=i.getAttribute("position");if(r===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=a.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,yh):yh.fromBufferAttribute(a,o),yh.applyMatrix4(e.matrixWorld),this.expandByPoint(yh);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),BM.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),BM.copy(i.boundingBox)),BM.applyMatrix4(e.matrixWorld),this.union(BM)}let n=e.children;for(let a=0,o=n.length;a<o;a++)this.expandByObject(n[a],r);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,yh),yh.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let r,i;return e.normal.x>0?(r=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(r=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(r+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(r+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(r+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(r+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),r<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Pb),zM.subVectors(this.max,Pb),a0.subVectors(e.a,Pb),o0.subVectors(e.b,Pb),s0.subVectors(e.c,Pb),im.subVectors(o0,a0),nm.subVectors(s0,o0),Rg.subVectors(a0,s0);let r=[0,-im.z,im.y,0,-nm.z,nm.y,0,-Rg.z,Rg.y,im.z,0,-im.x,nm.z,0,-nm.x,Rg.z,0,-Rg.x,-im.y,im.x,0,-nm.y,nm.x,0,-Rg.y,Rg.x,0];return!rC(r,a0,o0,s0,zM)||(r=[1,0,0,0,1,0,0,0,1],!rC(r,a0,o0,s0,zM))?!1:(UM.crossVectors(im,nm),r=[UM.x,UM.y,UM.z],rC(r,a0,o0,s0,zM))}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,yh).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(yh).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Md[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Md[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Md[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Md[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Md[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Md[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Md[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Md[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Md),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};s(Ace,"Box3");var to=Ace,Md=[new qe,new qe,new qe,new qe,new qe,new qe,new qe,new qe],yh=new qe,BM=new to,a0=new qe,o0=new qe,s0=new qe,im=new qe,nm=new qe,Rg=new qe,Pb=new qe,zM=new qe,UM=new qe,Og=new qe;function rC(t,e,r,i,n){for(let a=0,o=t.length-3;a<=o;a+=3){Og.fromArray(t,a);let l=n.x*Math.abs(Og.x)+n.y*Math.abs(Og.y)+n.z*Math.abs(Og.z),u=e.dot(Og),c=r.dot(Og),p=i.dot(Og);if(Math.max(-Math.max(u,c,p),Math.min(u,c,p))>l)return!1}return!0}s(rC,"satForAxes");var hVe=new to,Lb=new qe,ZL=new qe,Sce=class{constructor(e=new qe,r=-1){this.isSphere=!0,this.center=e,this.radius=r}set(e,r){return this.center.copy(e),this.radius=r,this}setFromPoints(e,r){let i=this.center;r!==void 0?i.copy(r):hVe.setFromPoints(e).getCenter(i);let n=0;for(let a=0,o=e.length;a<o;a++)n=Math.max(n,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let r=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=r*r}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,r){let i=this.center.distanceToSquared(e);return r.copy(e),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Lb.subVectors(e,this.center);let r=Lb.lengthSq();if(r>this.radius*this.radius){let i=Math.sqrt(r),n=(i-this.radius)*.5;this.center.addScaledVector(Lb,n/i),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ZL.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Lb.copy(e.center).add(ZL)),this.expandByPoint(Lb.copy(e.center).sub(ZL))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};s(Sce,"Sphere");var Ru=Sce,Ed=new qe,YL=new qe,VM=new qe,am=new qe,KL=new qe,jM=new qe,JL=new qe,Mce=class{constructor(e=new qe,r=new qe(0,0,-1)){this.origin=e,this.direction=r}set(e,r){return this.origin.copy(e),this.direction.copy(r),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,r){return r.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ed)),this}closestPointToPoint(e,r){r.subVectors(e,this.origin);let i=r.dot(this.direction);return i<0?r.copy(this.origin):r.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let r=Ed.subVectors(e,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(e):(Ed.copy(this.origin).addScaledVector(this.direction,r),Ed.distanceToSquared(e))}distanceSqToSegment(e,r,i,n){YL.copy(e).add(r).multiplyScalar(.5),VM.copy(r).sub(e).normalize(),am.copy(this.origin).sub(YL);let a=e.distanceTo(r)*.5,o=-this.direction.dot(VM),l=am.dot(this.direction),u=-am.dot(VM),c=am.lengthSq(),p=Math.abs(1-o*o),m,y,v,x;if(p>0)if(m=o*u-l,y=o*l-u,x=a*p,m>=0)if(y>=-x)if(y<=x){let E=1/p;m*=E,y*=E,v=m*(m+o*y+2*l)+y*(o*m+y+2*u)+c}else y=a,m=Math.max(0,-(o*y+l)),v=-m*m+y*(y+2*u)+c;else y=-a,m=Math.max(0,-(o*y+l)),v=-m*m+y*(y+2*u)+c;else y<=-x?(m=Math.max(0,-(-o*a+l)),y=m>0?-a:Math.min(Math.max(-a,-u),a),v=-m*m+y*(y+2*u)+c):y<=x?(m=0,y=Math.min(Math.max(-a,-u),a),v=y*(y+2*u)+c):(m=Math.max(0,-(o*a+l)),y=m>0?a:Math.min(Math.max(-a,-u),a),v=-m*m+y*(y+2*u)+c);else y=o>0?-a:a,m=Math.max(0,-(o*y+l)),v=-m*m+y*(y+2*u)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,m),n&&n.copy(YL).addScaledVector(VM,y),v}intersectSphere(e,r){Ed.subVectors(e.center,this.origin);let i=Ed.dot(this.direction),n=Ed.dot(Ed)-i*i,a=e.radius*e.radius;if(n>a)return null;let o=Math.sqrt(a-n),l=i-o,u=i+o;return u<0?null:l<0?this.at(u,r):this.at(l,r)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let r=e.normal.dot(this.direction);if(r===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/r;return i>=0?i:null}intersectPlane(e,r){let i=this.distanceToPlane(e);return i===null?null:this.at(i,r)}intersectsPlane(e){let r=e.distanceToPoint(this.origin);return r===0||e.normal.dot(this.direction)*r<0}intersectBox(e,r){let i,n,a,o,l,u,c=1/this.direction.x,p=1/this.direction.y,m=1/this.direction.z,y=this.origin;return c>=0?(i=(e.min.x-y.x)*c,n=(e.max.x-y.x)*c):(i=(e.max.x-y.x)*c,n=(e.min.x-y.x)*c),p>=0?(a=(e.min.y-y.y)*p,o=(e.max.y-y.y)*p):(a=(e.max.y-y.y)*p,o=(e.min.y-y.y)*p),i>o||a>n||((a>i||isNaN(i))&&(i=a),(o<n||isNaN(n))&&(n=o),m>=0?(l=(e.min.z-y.z)*m,u=(e.max.z-y.z)*m):(l=(e.max.z-y.z)*m,u=(e.min.z-y.z)*m),i>u||l>n)||((l>i||i!==i)&&(i=l),(u<n||n!==n)&&(n=u),n<0)?null:this.at(i>=0?i:n,r)}intersectsBox(e){return this.intersectBox(e,Ed)!==null}intersectTriangle(e,r,i,n,a){KL.subVectors(r,e),jM.subVectors(i,e),JL.crossVectors(KL,jM);let o=this.direction.dot(JL),l;if(o>0){if(n)return null;l=1}else if(o<0)l=-1,o=-o;else return null;am.subVectors(this.origin,e);let u=l*this.direction.dot(jM.crossVectors(am,jM));if(u<0)return null;let c=l*this.direction.dot(KL.cross(am));if(c<0||u+c>o)return null;let p=-l*am.dot(JL);return p<0?null:this.at(p/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};s(Mce,"Ray");var LA=Mce,Ece=class sO{constructor(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M){sO.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M)}set(e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M){let I=this.elements;return I[0]=e,I[4]=r,I[8]=i,I[12]=n,I[1]=a,I[5]=o,I[9]=l,I[13]=u,I[2]=c,I[6]=p,I[10]=m,I[14]=y,I[3]=v,I[7]=x,I[11]=E,I[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new sO().fromArray(this.elements)}copy(e){let r=this.elements,i=e.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this}copyPosition(e){let r=this.elements,i=e.elements;return r[12]=i[12],r[13]=i[13],r[14]=i[14],this}setFromMatrix3(e){let r=e.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(e,r,i){return e.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,r,i){return this.set(e.x,r.x,i.x,0,e.y,r.y,i.y,0,e.z,r.z,i.z,0,0,0,0,1),this}extractRotation(e){let r=this.elements,i=e.elements,n=1/l0.setFromMatrixColumn(e,0).length(),a=1/l0.setFromMatrixColumn(e,1).length(),o=1/l0.setFromMatrixColumn(e,2).length();return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=0,r[4]=i[4]*a,r[5]=i[5]*a,r[6]=i[6]*a,r[7]=0,r[8]=i[8]*o,r[9]=i[9]*o,r[10]=i[10]*o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(e){let r=this.elements,i=e.x,n=e.y,a=e.z,o=Math.cos(i),l=Math.sin(i),u=Math.cos(n),c=Math.sin(n),p=Math.cos(a),m=Math.sin(a);if(e.order==="XYZ"){let y=o*p,v=o*m,x=l*p,E=l*m;r[0]=u*p,r[4]=-u*m,r[8]=c,r[1]=v+x*c,r[5]=y-E*c,r[9]=-l*u,r[2]=E-y*c,r[6]=x+v*c,r[10]=o*u}else if(e.order==="YXZ"){let y=u*p,v=u*m,x=c*p,E=c*m;r[0]=y+E*l,r[4]=x*l-v,r[8]=o*c,r[1]=o*m,r[5]=o*p,r[9]=-l,r[2]=v*l-x,r[6]=E+y*l,r[10]=o*u}else if(e.order==="ZXY"){let y=u*p,v=u*m,x=c*p,E=c*m;r[0]=y-E*l,r[4]=-o*m,r[8]=x+v*l,r[1]=v+x*l,r[5]=o*p,r[9]=E-y*l,r[2]=-o*c,r[6]=l,r[10]=o*u}else if(e.order==="ZYX"){let y=o*p,v=o*m,x=l*p,E=l*m;r[0]=u*p,r[4]=x*c-v,r[8]=y*c+E,r[1]=u*m,r[5]=E*c+y,r[9]=v*c-x,r[2]=-c,r[6]=l*u,r[10]=o*u}else if(e.order==="YZX"){let y=o*u,v=o*c,x=l*u,E=l*c;r[0]=u*p,r[4]=E-y*m,r[8]=x*m+v,r[1]=m,r[5]=o*p,r[9]=-l*p,r[2]=-c*p,r[6]=v*m+x,r[10]=y-E*m}else if(e.order==="XZY"){let y=o*u,v=o*c,x=l*u,E=l*c;r[0]=u*p,r[4]=-m,r[8]=c*p,r[1]=y*m+E,r[5]=o*p,r[9]=v*m-x,r[2]=x*m-v,r[6]=l*p,r[10]=E*m+y}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pVe,e,dVe)}lookAt(e,r,i){let n=this.elements;return nc.subVectors(e,r),nc.lengthSq()===0&&(nc.z=1),nc.normalize(),om.crossVectors(i,nc),om.lengthSq()===0&&(Math.abs(i.z)===1?nc.x+=1e-4:nc.z+=1e-4,nc.normalize(),om.crossVectors(i,nc)),om.normalize(),$M.crossVectors(nc,om),n[0]=om.x,n[4]=$M.x,n[8]=nc.x,n[1]=om.y,n[5]=$M.y,n[9]=nc.y,n[2]=om.z,n[6]=$M.z,n[10]=nc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){let i=e.elements,n=r.elements,a=this.elements,o=i[0],l=i[4],u=i[8],c=i[12],p=i[1],m=i[5],y=i[9],v=i[13],x=i[2],E=i[6],M=i[10],I=i[14],P=i[3],C=i[7],T=i[11],D=i[15],F=n[0],k=n[4],B=n[8],U=n[12],z=n[1],q=n[5],Z=n[9],Q=n[13],V=n[2],ae=n[6],Y=n[10],he=n[14],J=n[3],ne=n[7],ee=n[11],ue=n[15];return a[0]=o*F+l*z+u*V+c*J,a[4]=o*k+l*q+u*ae+c*ne,a[8]=o*B+l*Z+u*Y+c*ee,a[12]=o*U+l*Q+u*he+c*ue,a[1]=p*F+m*z+y*V+v*J,a[5]=p*k+m*q+y*ae+v*ne,a[9]=p*B+m*Z+y*Y+v*ee,a[13]=p*U+m*Q+y*he+v*ue,a[2]=x*F+E*z+M*V+I*J,a[6]=x*k+E*q+M*ae+I*ne,a[10]=x*B+E*Z+M*Y+I*ee,a[14]=x*U+E*Q+M*he+I*ue,a[3]=P*F+C*z+T*V+D*J,a[7]=P*k+C*q+T*ae+D*ne,a[11]=P*B+C*Z+T*Y+D*ee,a[15]=P*U+C*Q+T*he+D*ue,this}multiplyScalar(e){let r=this.elements;return r[0]*=e,r[4]*=e,r[8]*=e,r[12]*=e,r[1]*=e,r[5]*=e,r[9]*=e,r[13]*=e,r[2]*=e,r[6]*=e,r[10]*=e,r[14]*=e,r[3]*=e,r[7]*=e,r[11]*=e,r[15]*=e,this}determinant(){let e=this.elements,r=e[0],i=e[4],n=e[8],a=e[12],o=e[1],l=e[5],u=e[9],c=e[13],p=e[2],m=e[6],y=e[10],v=e[14],x=e[3],E=e[7],M=e[11],I=e[15];return x*(+a*u*m-n*c*m-a*l*y+i*c*y+n*l*v-i*u*v)+E*(+r*u*v-r*c*y+a*o*y-n*o*v+n*c*p-a*u*p)+M*(+r*c*m-r*l*v-a*o*m+i*o*v+a*l*p-i*c*p)+I*(-n*l*p-r*u*m+r*l*y+n*o*m-i*o*y+i*u*p)}transpose(){let e=this.elements,r;return r=e[1],e[1]=e[4],e[4]=r,r=e[2],e[2]=e[8],e[8]=r,r=e[6],e[6]=e[9],e[9]=r,r=e[3],e[3]=e[12],e[12]=r,r=e[7],e[7]=e[13],e[13]=r,r=e[11],e[11]=e[14],e[14]=r,this}setPosition(e,r,i){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=r,n[14]=i),this}invert(){let e=this.elements,r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],p=e[8],m=e[9],y=e[10],v=e[11],x=e[12],E=e[13],M=e[14],I=e[15],P=m*M*c-E*y*c+E*u*v-l*M*v-m*u*I+l*y*I,C=x*y*c-p*M*c-x*u*v+o*M*v+p*u*I-o*y*I,T=p*E*c-x*m*c+x*l*v-o*E*v-p*l*I+o*m*I,D=x*m*u-p*E*u-x*l*y+o*E*y+p*l*M-o*m*M,F=r*P+i*C+n*T+a*D;if(F===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let k=1/F;return e[0]=P*k,e[1]=(E*y*a-m*M*a-E*n*v+i*M*v+m*n*I-i*y*I)*k,e[2]=(l*M*a-E*u*a+E*n*c-i*M*c-l*n*I+i*u*I)*k,e[3]=(m*u*a-l*y*a-m*n*c+i*y*c+l*n*v-i*u*v)*k,e[4]=C*k,e[5]=(p*M*a-x*y*a+x*n*v-r*M*v-p*n*I+r*y*I)*k,e[6]=(x*u*a-o*M*a-x*n*c+r*M*c+o*n*I-r*u*I)*k,e[7]=(o*y*a-p*u*a+p*n*c-r*y*c-o*n*v+r*u*v)*k,e[8]=T*k,e[9]=(x*m*a-p*E*a-x*i*v+r*E*v+p*i*I-r*m*I)*k,e[10]=(o*E*a-x*l*a+x*i*c-r*E*c-o*i*I+r*l*I)*k,e[11]=(p*l*a-o*m*a-p*i*c+r*m*c+o*i*v-r*l*v)*k,e[12]=D*k,e[13]=(p*E*n-x*m*n+x*i*y-r*E*y-p*i*M+r*m*M)*k,e[14]=(x*l*n-o*E*n-x*i*u+r*E*u+o*i*M-r*l*M)*k,e[15]=(o*m*n-p*l*n+p*i*u-r*m*u-o*i*y+r*l*y)*k,this}scale(e){let r=this.elements,i=e.x,n=e.y,a=e.z;return r[0]*=i,r[4]*=n,r[8]*=a,r[1]*=i,r[5]*=n,r[9]*=a,r[2]*=i,r[6]*=n,r[10]*=a,r[3]*=i,r[7]*=n,r[11]*=a,this}getMaxScaleOnAxis(){let e=this.elements,r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(r,i,n))}makeTranslation(e,r,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,r,0,0,1,i,0,0,0,1),this}makeRotationX(e){let r=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1),this}makeRotationY(e){let r=Math.cos(e),i=Math.sin(e);return this.set(r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1),this}makeRotationZ(e){let r=Math.cos(e),i=Math.sin(e);return this.set(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,r){let i=Math.cos(r),n=Math.sin(r),a=1-i,o=e.x,l=e.y,u=e.z,c=a*o,p=a*l;return this.set(c*o+i,c*l-n*u,c*u+n*l,0,c*l+n*u,p*l+i,p*u-n*o,0,c*u-n*l,p*u+n*o,a*u*u+i,0,0,0,0,1),this}makeScale(e,r,i){return this.set(e,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,r,i,n,a,o){return this.set(1,i,a,0,e,1,o,0,r,n,1,0,0,0,0,1),this}compose(e,r,i){let n=this.elements,a=r._x,o=r._y,l=r._z,u=r._w,c=a+a,p=o+o,m=l+l,y=a*c,v=a*p,x=a*m,E=o*p,M=o*m,I=l*m,P=u*c,C=u*p,T=u*m,D=i.x,F=i.y,k=i.z;return n[0]=(1-(E+I))*D,n[1]=(v+T)*D,n[2]=(x-C)*D,n[3]=0,n[4]=(v-T)*F,n[5]=(1-(y+I))*F,n[6]=(M+P)*F,n[7]=0,n[8]=(x+C)*k,n[9]=(M-P)*k,n[10]=(1-(y+E))*k,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,r,i){let n=this.elements,a=l0.set(n[0],n[1],n[2]).length(),o=l0.set(n[4],n[5],n[6]).length(),l=l0.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],vh.copy(this);let u=1/a,c=1/o,p=1/l;return vh.elements[0]*=u,vh.elements[1]*=u,vh.elements[2]*=u,vh.elements[4]*=c,vh.elements[5]*=c,vh.elements[6]*=c,vh.elements[8]*=p,vh.elements[9]*=p,vh.elements[10]*=p,r.setFromRotationMatrix(vh),i.x=a,i.y=o,i.z=l,this}makePerspective(e,r,i,n,a,o,l=sf){let u=this.elements,c=2*a/(r-e),p=2*a/(i-n),m=(r+e)/(r-e),y=(i+n)/(i-n),v,x;if(l===sf)v=-(o+a)/(o-a),x=-2*o*a/(o-a);else if(l===UT)v=-o/(o-a),x=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=c,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=p,u[9]=y,u[13]=0,u[2]=0,u[6]=0,u[10]=v,u[14]=x,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,r,i,n,a,o,l=sf){let u=this.elements,c=1/(r-e),p=1/(i-n),m=1/(o-a),y=(r+e)*c,v=(i+n)*p,x,E;if(l===sf)x=(o+a)*m,E=-2*m;else if(l===UT)x=a*m,E=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=2*c,u[4]=0,u[8]=0,u[12]=-y,u[1]=0,u[5]=2*p,u[9]=0,u[13]=-v,u[2]=0,u[6]=0,u[10]=E,u[14]=-x,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){let r=this.elements,i=e.elements;for(let n=0;n<16;n++)if(r[n]!==i[n])return!1;return!0}fromArray(e,r=0){for(let i=0;i<16;i++)this.elements[i]=e[i+r];return this}toArray(e=[],r=0){let i=this.elements;return e[r]=i[0],e[r+1]=i[1],e[r+2]=i[2],e[r+3]=i[3],e[r+4]=i[4],e[r+5]=i[5],e[r+6]=i[6],e[r+7]=i[7],e[r+8]=i[8],e[r+9]=i[9],e[r+10]=i[10],e[r+11]=i[11],e[r+12]=i[12],e[r+13]=i[13],e[r+14]=i[14],e[r+15]=i[15],e}};s(Ece,"Matrix4");var Ri=Ece,l0=new qe,vh=new Ri,pVe=new qe(0,0,0),dVe=new qe(1,1,1),om=new qe,$M=new qe,nc=new qe,Tq=new Ri,Pq=new ff,Cce=class Ice{constructor(e=0,r=0,i=0,n=Ice.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=r,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,r,i,n=this._order){return this._x=e,this._y=r,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,r=this._order,i=!0){let n=e.elements,a=n[0],o=n[4],l=n[8],u=n[1],c=n[5],p=n[9],m=n[2],y=n[6],v=n[10];switch(r){case"XYZ":this._y=Math.asin(Ki(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-p,v),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(y,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Ki(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(l,v),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-m,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ki(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-m,v),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-Ki(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(y,v),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Ki(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,c),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(l,v));break;case"XZY":this._z=Math.asin(-Ki(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(y,c),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-p,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,r,i){return Tq.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Tq,r,i)}setFromVector3(e,r=this._order){return this.set(e.x,e.y,e.z,r)}reorder(e){return Pq.setFromEuler(this),this.setFromQuaternion(Pq,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};s(Cce,"Euler");var Nu=Cce;Nu.DEFAULT_ORDER="XYZ";var Tce=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}};s(Tce,"Layers");var yB=Tce,fVe=0,Lq=new qe,u0=new ff,Cd=new Ri,GM=new qe,Db=new qe,mVe=new qe,gVe=new ff,Dq=new qe(1,0,0),Rq=new qe(0,1,0),Oq=new qe(0,0,1),kq={type:"added"},yVe={type:"removed"},c0={type:"childadded",child:null},QL={type:"childremoved",child:null},Pce=class iC extends ax{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:fVe++}),this.uuid=xc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=iC.DEFAULT_UP.clone();let e=new qe,r=new Nu,i=new ff,n=new qe(1,1,1);function a(){i.setFromEuler(r,!1)}s(a,"onRotationChange");function o(){r.setFromQuaternion(i,void 0,!1)}s(o,"onQuaternionChange"),r._onChange(a),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Ri},normalMatrix:{value:new rn}}),this.matrix=new Ri,this.matrixWorld=new Ri,this.matrixAutoUpdate=iC.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=iC.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new yB,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,r){this.quaternion.setFromAxisAngle(e,r)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,r){return u0.setFromAxisAngle(e,r),this.quaternion.multiply(u0),this}rotateOnWorldAxis(e,r){return u0.setFromAxisAngle(e,r),this.quaternion.premultiply(u0),this}rotateX(e){return this.rotateOnAxis(Dq,e)}rotateY(e){return this.rotateOnAxis(Rq,e)}rotateZ(e){return this.rotateOnAxis(Oq,e)}translateOnAxis(e,r){return Lq.copy(e).applyQuaternion(this.quaternion),this.position.add(Lq.multiplyScalar(r)),this}translateX(e){return this.translateOnAxis(Dq,e)}translateY(e){return this.translateOnAxis(Rq,e)}translateZ(e){return this.translateOnAxis(Oq,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Cd.copy(this.matrixWorld).invert())}lookAt(e,r,i){e.isVector3?GM.copy(e):GM.set(e,r,i);let n=this.parent;this.updateWorldMatrix(!0,!1),Db.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Cd.lookAt(Db,GM,this.up):Cd.lookAt(GM,Db,this.up),this.quaternion.setFromRotationMatrix(Cd),n&&(Cd.extractRotation(n.matrixWorld),u0.setFromRotationMatrix(Cd),this.quaternion.premultiply(u0.invert()))}add(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(kq),c0.child=e,this.dispatchEvent(c0),c0.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let r=this.children.indexOf(e);return r!==-1&&(e.parent=null,this.children.splice(r,1),e.dispatchEvent(yVe),QL.child=e,this.dispatchEvent(QL),QL.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Cd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Cd.multiply(e.parent.matrixWorld)),e.applyMatrix4(Cd),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(kq),c0.child=e,this.dispatchEvent(c0),c0.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,r){if(this[e]===r)return this;for(let i=0,n=this.children.length;i<n;i++){let a=this.children[i].getObjectByProperty(e,r);if(a!==void 0)return a}}getObjectsByProperty(e,r,i=[]){this[e]===r&&i.push(this);let n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].getObjectsByProperty(e,r,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Db,e,mVe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Db,gVe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let r=this.matrixWorld.elements;return e.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(e){e(this);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].traverseVisible(e)}traverseAncestors(e){let r=this.parent;r!==null&&(e(r),r.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].updateMatrixWorld(e)}updateWorldMatrix(e,r){let i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),r===!0){let n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].updateWorldMatrix(!1,!0)}}toJSON(e){let r=e===void 0||typeof e=="string",i={};r&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(n.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(e)),u.uuid}if(s(a,"serialize"),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);let l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){let u=l.shapes;if(Array.isArray(u))for(let c=0,p=u.length;c<p;c++){let m=u[c];a(e.shapes,m)}else a(e.shapes,u)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let l=[];for(let u=0,c=this.material.length;u<c;u++)l.push(a(e.materials,this.material[u]));n.material=l}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let l=0;l<this.children.length;l++)n.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let l=0;l<this.animations.length;l++){let u=this.animations[l];n.animations.push(a(e.animations,u))}}if(r){let l=o(e.geometries),u=o(e.materials),c=o(e.textures),p=o(e.images),m=o(e.shapes),y=o(e.skeletons),v=o(e.animations),x=o(e.nodes);l.length>0&&(i.geometries=l),u.length>0&&(i.materials=u),c.length>0&&(i.textures=c),p.length>0&&(i.images=p),m.length>0&&(i.shapes=m),y.length>0&&(i.skeletons=y),v.length>0&&(i.animations=v),x.length>0&&(i.nodes=x)}return i.object=n,i;function o(l){let u=[];for(let c in l){let p=l[c];delete p.metadata,u.push(p)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,r=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),r===!0)for(let i=0;i<e.children.length;i++){let n=e.children[i];this.add(n.clone())}return this}};s(Pce,"Object3D");var Ha=Pce;Ha.DEFAULT_UP=new qe(0,1,0);Ha.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ha.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var _h=new qe,Id=new qe,eD=new qe,Td=new qe,h0=new qe,p0=new qe,Nq=new qe,tD=new qe,rD=new qe,iD=new qe,nD=new Jn,aD=new Jn,oD=new Jn,Lce=class T0{constructor(e=new qe,r=new qe,i=new qe){this.a=e,this.b=r,this.c=i}static getNormal(e,r,i,n){n.subVectors(i,r),_h.subVectors(e,r),n.cross(_h);let a=n.lengthSq();return a>0?n.multiplyScalar(1/Math.sqrt(a)):n.set(0,0,0)}static getBarycoord(e,r,i,n,a){_h.subVectors(n,r),Id.subVectors(i,r),eD.subVectors(e,r);let o=_h.dot(_h),l=_h.dot(Id),u=_h.dot(eD),c=Id.dot(Id),p=Id.dot(eD),m=o*c-l*l;if(m===0)return a.set(0,0,0),null;let y=1/m,v=(c*u-l*p)*y,x=(o*p-l*u)*y;return a.set(1-v-x,x,v)}static containsPoint(e,r,i,n){return this.getBarycoord(e,r,i,n,Td)===null?!1:Td.x>=0&&Td.y>=0&&Td.x+Td.y<=1}static getInterpolation(e,r,i,n,a,o,l,u){return this.getBarycoord(e,r,i,n,Td)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(a,Td.x),u.addScaledVector(o,Td.y),u.addScaledVector(l,Td.z),u)}static getInterpolatedAttribute(e,r,i,n,a,o){return nD.setScalar(0),aD.setScalar(0),oD.setScalar(0),nD.fromBufferAttribute(e,r),aD.fromBufferAttribute(e,i),oD.fromBufferAttribute(e,n),o.setScalar(0),o.addScaledVector(nD,a.x),o.addScaledVector(aD,a.y),o.addScaledVector(oD,a.z),o}static isFrontFacing(e,r,i,n){return _h.subVectors(i,r),Id.subVectors(e,r),_h.cross(Id).dot(n)<0}set(e,r,i){return this.a.copy(e),this.b.copy(r),this.c.copy(i),this}setFromPointsAndIndices(e,r,i,n){return this.a.copy(e[r]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,r,i,n){return this.a.fromBufferAttribute(e,r),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _h.subVectors(this.c,this.b),Id.subVectors(this.a,this.b),_h.cross(Id).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return T0.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,r){return T0.getBarycoord(e,this.a,this.b,this.c,r)}getInterpolation(e,r,i,n,a){return T0.getInterpolation(e,this.a,this.b,this.c,r,i,n,a)}containsPoint(e){return T0.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return T0.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,r){let i=this.a,n=this.b,a=this.c,o,l;h0.subVectors(n,i),p0.subVectors(a,i),tD.subVectors(e,i);let u=h0.dot(tD),c=p0.dot(tD);if(u<=0&&c<=0)return r.copy(i);rD.subVectors(e,n);let p=h0.dot(rD),m=p0.dot(rD);if(p>=0&&m<=p)return r.copy(n);let y=u*m-p*c;if(y<=0&&u>=0&&p<=0)return o=u/(u-p),r.copy(i).addScaledVector(h0,o);iD.subVectors(e,a);let v=h0.dot(iD),x=p0.dot(iD);if(x>=0&&v<=x)return r.copy(a);let E=v*c-u*x;if(E<=0&&c>=0&&x<=0)return l=c/(c-x),r.copy(i).addScaledVector(p0,l);let M=p*x-v*m;if(M<=0&&m-p>=0&&v-x>=0)return Nq.subVectors(a,n),l=(m-p)/(m-p+(v-x)),r.copy(n).addScaledVector(Nq,l);let I=1/(M+E+y);return o=E*I,l=y*I,r.copy(i).addScaledVector(h0,o).addScaledVector(p0,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};s(Lce,"Triangle");var P0=Lce,Dce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},sm={h:0,s:0,l:0},HM={h:0,s:0,l:0};function nC(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*6*(2/3-r):t}s(nC,"hue2rgb");var Rce=class{constructor(e,r,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,r,i)}set(e,r,i){if(r===void 0&&i===void 0){let n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,r,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,r=il){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Dn.toWorkingColorSpace(this,r),this}setRGB(e,r,i,n=Dn.workingColorSpace){return this.r=e,this.g=r,this.b=i,Dn.toWorkingColorSpace(this,n),this}setHSL(e,r,i,n=Dn.workingColorSpace){if(e=OP(e,1),r=Ki(r,0,1),i=Ki(i,0,1),r===0)this.r=this.g=this.b=i;else{let a=i<=.5?i*(1+r):i+r-i*r,o=2*i-a;this.r=nC(o,a,e+1/3),this.g=nC(o,a,e),this.b=nC(o,a,e-1/3)}return Dn.toWorkingColorSpace(this,n),this}setStyle(e,r=il){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}s(i,"handleAlpha");let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a,o=n[1],l=n[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,r);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,r);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let a=n[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,r);if(o===6)return this.setHex(parseInt(a,16),r);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,r);return this}setColorName(e,r=il){let i=Dce[e.toLowerCase()];return i!==void 0?this.setHex(i,r):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Xp(e.r),this.g=Xp(e.g),this.b=Xp(e.b),this}copyLinearToSRGB(e){return this.r=Ny(e.r),this.g=Ny(e.g),this.b=Ny(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=il){return Dn.fromWorkingColorSpace(xl.copy(this),e),Math.round(Ki(xl.r*255,0,255))*65536+Math.round(Ki(xl.g*255,0,255))*256+Math.round(Ki(xl.b*255,0,255))}getHexString(e=il){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,r=Dn.workingColorSpace){Dn.fromWorkingColorSpace(xl.copy(this),r);let i=xl.r,n=xl.g,a=xl.b,o=Math.max(i,n,a),l=Math.min(i,n,a),u,c,p=(l+o)/2;if(l===o)u=0,c=0;else{let m=o-l;switch(c=p<=.5?m/(o+l):m/(2-o-l),o){case i:u=(n-a)/m+(n<a?6:0);break;case n:u=(a-i)/m+2;break;case a:u=(i-n)/m+4;break}u/=6}return e.h=u,e.s=c,e.l=p,e}getRGB(e,r=Dn.workingColorSpace){return Dn.fromWorkingColorSpace(xl.copy(this),r),e.r=xl.r,e.g=xl.g,e.b=xl.b,e}getStyle(e=il){Dn.fromWorkingColorSpace(xl.copy(this),e);let r=xl.r,i=xl.g,n=xl.b;return e!==il?"color(".concat(e," ").concat(r.toFixed(3)," ").concat(i.toFixed(3)," ").concat(n.toFixed(3),")"):"rgb(".concat(Math.round(r*255),",").concat(Math.round(i*255),",").concat(Math.round(n*255),")")}offsetHSL(e,r,i){return this.getHSL(sm),this.setHSL(sm.h+e,sm.s+r,sm.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,r){return this.r=e.r+r.r,this.g=e.g+r.g,this.b=e.b+r.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,r){return this.r+=(e.r-this.r)*r,this.g+=(e.g-this.g)*r,this.b+=(e.b-this.b)*r,this}lerpColors(e,r,i){return this.r=e.r+(r.r-e.r)*i,this.g=e.g+(r.g-e.g)*i,this.b=e.b+(r.b-e.b)*i,this}lerpHSL(e,r){this.getHSL(sm),e.getHSL(HM);let i=n_(sm.h,HM.h,r),n=n_(sm.s,HM.s,r),a=n_(sm.l,HM.l,r);return this.setHSL(i,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let r=this.r,i=this.g,n=this.b,a=e.elements;return this.r=a[0]*r+a[3]*i+a[6]*n,this.g=a[1]*r+a[4]*i+a[7]*n,this.b=a[2]*r+a[5]*i+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,r=0){return this.r=e[r],this.g=e[r+1],this.b=e[r+2],this}toArray(e=[],r=0){return e[r]=this.r,e[r+1]=this.g,e[r+2]=this.b,e}fromBufferAttribute(e,r){return this.r=e.getX(r),this.g=e.getY(r),this.b=e.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};s(Rce,"Color");var oi=Rce,xl=new oi;oi.NAMES=Dce;var vVe=0,Oce=class extends ax{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:vVe++}),this.uuid=xc(),this.name="",this.type="Material",this.blending=t_,this.side=Qp,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xR,this.blendDst=bR,this.blendEquation=dy,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new oi(0,0,0),this.blendAlpha=0,this.depthFunc=w_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nO,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Jd,this.stencilZFail=Jd,this.stencilZPass=Jd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let r in e){let i=e[r];if(i===void 0){console.warn("THREE.Material: parameter '".concat(r,"' has value of undefined."));continue}let n=this[r];if(n===void 0){console.warn("THREE.Material: '".concat(r,"' is not a property of THREE.").concat(this.type,"."));continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[r]=i}}toJSON(e){let r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==t_&&(i.blending=this.blending),this.side!==Qp&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==xR&&(i.blendSrc=this.blendSrc),this.blendDst!==bR&&(i.blendDst=this.blendDst),this.blendEquation!==dy&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==w_&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==nO&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Jd&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Jd&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Jd&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(a){let o=[];for(let l in a){let u=a[l];delete u.metadata,o.push(u)}return o}if(s(n,"extractFromCache"),r){let a=n(e.textures),o=n(e.images);a.length>0&&(i.textures=a),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let r=e.clippingPlanes,i=null;if(r!==null){let n=r.length;i=new Array(n);for(let a=0;a!==n;++a)i[a]=r[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}};s(Oce,"Material");var lg=Oce,kce=class extends lg{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new oi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nu,this.combine=lB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};s(kce,"MeshBasicMaterial");var ug=kce,os=new qe,qM=new Jt,_Ve=0,Nce=class{constructor(e,r,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:_Ve++}),this.name="",this.array=e,this.itemSize=r,this.count=e!==void 0?e.length/r:0,this.normalized=i,this.usage=aO,this.updateRanges=[],this.gpuType=Lu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,r){this.updateRanges.push({start:e,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,r,i){e*=this.itemSize,i*=r.itemSize;for(let n=0,a=this.itemSize;n<a;n++)this.array[e+n]=r.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let r=0,i=this.count;r<i;r++)qM.fromBufferAttribute(this,r),qM.applyMatrix3(e),this.setXY(r,qM.x,qM.y);else if(this.itemSize===3)for(let r=0,i=this.count;r<i;r++)os.fromBufferAttribute(this,r),os.applyMatrix3(e),this.setXYZ(r,os.x,os.y,os.z);return this}applyMatrix4(e){for(let r=0,i=this.count;r<i;r++)os.fromBufferAttribute(this,r),os.applyMatrix4(e),this.setXYZ(r,os.x,os.y,os.z);return this}applyNormalMatrix(e){for(let r=0,i=this.count;r<i;r++)os.fromBufferAttribute(this,r),os.applyNormalMatrix(e),this.setXYZ(r,os.x,os.y,os.z);return this}transformDirection(e){for(let r=0,i=this.count;r<i;r++)os.fromBufferAttribute(this,r),os.transformDirection(e),this.setXYZ(r,os.x,os.y,os.z);return this}set(e,r=0){return this.array.set(e,r),this}getComponent(e,r){let i=this.array[e*this.itemSize+r];return this.normalized&&(i=Qc(i,this.array)),i}setComponent(e,r,i){return this.normalized&&(i=Zn(i,this.array)),this.array[e*this.itemSize+r]=i,this}getX(e){let r=this.array[e*this.itemSize];return this.normalized&&(r=Qc(r,this.array)),r}setX(e,r){return this.normalized&&(r=Zn(r,this.array)),this.array[e*this.itemSize]=r,this}getY(e){let r=this.array[e*this.itemSize+1];return this.normalized&&(r=Qc(r,this.array)),r}setY(e,r){return this.normalized&&(r=Zn(r,this.array)),this.array[e*this.itemSize+1]=r,this}getZ(e){let r=this.array[e*this.itemSize+2];return this.normalized&&(r=Qc(r,this.array)),r}setZ(e,r){return this.normalized&&(r=Zn(r,this.array)),this.array[e*this.itemSize+2]=r,this}getW(e){let r=this.array[e*this.itemSize+3];return this.normalized&&(r=Qc(r,this.array)),r}setW(e,r){return this.normalized&&(r=Zn(r,this.array)),this.array[e*this.itemSize+3]=r,this}setXY(e,r,i){return e*=this.itemSize,this.normalized&&(r=Zn(r,this.array),i=Zn(i,this.array)),this.array[e+0]=r,this.array[e+1]=i,this}setXYZ(e,r,i,n){return e*=this.itemSize,this.normalized&&(r=Zn(r,this.array),i=Zn(i,this.array),n=Zn(n,this.array)),this.array[e+0]=r,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,r,i,n,a){return e*=this.itemSize,this.normalized&&(r=Zn(r,this.array),i=Zn(i,this.array),n=Zn(n,this.array),a=Zn(a,this.array)),this.array[e+0]=r,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==aO&&(e.usage=this.usage),e}};s(Nce,"BufferAttribute");var Zo=Nce,Fce=class extends Zo{constructor(e,r,i){super(new Uint16Array(e),r,i)}};s(Fce,"Uint16BufferAttribute");var Bce=Fce,zce=class extends Zo{constructor(e,r,i){super(new Uint32Array(e),r,i)}};s(zce,"Uint32BufferAttribute");var Uce=zce,Vce=class extends Zo{constructor(e,r,i){super(new Float32Array(e),r,i)}};s(Vce,"Float32BufferAttribute");var go=Vce,xVe=0,jc=new Ri,sD=new Ha,d0=new qe,ac=new to,Rb=new to,Ns=new qe,jce=class $ce extends ax{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xVe++}),this.uuid=xc(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(gB(e)?Uce:Bce)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,r){return this.attributes[e]=r,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,r,i=0){this.groups.push({start:e,count:r,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,r){this.drawRange.start=e,this.drawRange.count=r}applyMatrix4(e){let r=this.attributes.position;r!==void 0&&(r.applyMatrix4(e),r.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let a=new rn().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return jc.makeRotationFromQuaternion(e),this.applyMatrix4(jc),this}rotateX(e){return jc.makeRotationX(e),this.applyMatrix4(jc),this}rotateY(e){return jc.makeRotationY(e),this.applyMatrix4(jc),this}rotateZ(e){return jc.makeRotationZ(e),this.applyMatrix4(jc),this}translate(e,r,i){return jc.makeTranslation(e,r,i),this.applyMatrix4(jc),this}scale(e,r,i){return jc.makeScale(e,r,i),this.applyMatrix4(jc),this}lookAt(e){return sD.lookAt(e),sD.updateMatrix(),this.applyMatrix4(sD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(d0).negate(),this.translate(d0.x,d0.y,d0.z),this}setFromPoints(e){let r=this.getAttribute("position");if(r===void 0){let i=[];for(let n=0,a=e.length;n<a;n++){let o=e[n];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new go(i,3))}else{let i=Math.min(e.length,r.count);for(let n=0;n<i;n++){let a=e[n];r.setXYZ(n,a.x,a.y,a.z||0)}e.length>r.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),r.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new to);let e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new qe(-1/0,-1/0,-1/0),new qe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),r)for(let i=0,n=r.length;i<n;i++){let a=r[i];ac.setFromBufferAttribute(a),this.morphTargetsRelative?(Ns.addVectors(this.boundingBox.min,ac.min),this.boundingBox.expandByPoint(Ns),Ns.addVectors(this.boundingBox.max,ac.max),this.boundingBox.expandByPoint(Ns)):(this.boundingBox.expandByPoint(ac.min),this.boundingBox.expandByPoint(ac.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ru);let e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new qe,1/0);return}if(e){let i=this.boundingSphere.center;if(ac.setFromBufferAttribute(e),r)for(let a=0,o=r.length;a<o;a++){let l=r[a];Rb.setFromBufferAttribute(l),this.morphTargetsRelative?(Ns.addVectors(ac.min,Rb.min),ac.expandByPoint(Ns),Ns.addVectors(ac.max,Rb.max),ac.expandByPoint(Ns)):(ac.expandByPoint(Rb.min),ac.expandByPoint(Rb.max))}ac.getCenter(i);let n=0;for(let a=0,o=e.count;a<o;a++)Ns.fromBufferAttribute(e,a),n=Math.max(n,i.distanceToSquared(Ns));if(r)for(let a=0,o=r.length;a<o;a++){let l=r[a],u=this.morphTargetsRelative;for(let c=0,p=l.count;c<p;c++)Ns.fromBufferAttribute(l,c),u&&(d0.fromBufferAttribute(e,c),Ns.add(d0)),n=Math.max(n,i.distanceToSquared(Ns))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,r=this.attributes;if(e===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=r.position,n=r.normal,a=r.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Zo(new Float32Array(4*i.count),4));let o=this.getAttribute("tangent"),l=[],u=[];for(let B=0;B<i.count;B++)l[B]=new qe,u[B]=new qe;let c=new qe,p=new qe,m=new qe,y=new Jt,v=new Jt,x=new Jt,E=new qe,M=new qe;function I(B,U,z){c.fromBufferAttribute(i,B),p.fromBufferAttribute(i,U),m.fromBufferAttribute(i,z),y.fromBufferAttribute(a,B),v.fromBufferAttribute(a,U),x.fromBufferAttribute(a,z),p.sub(c),m.sub(c),v.sub(y),x.sub(y);let q=1/(v.x*x.y-x.x*v.y);isFinite(q)&&(E.copy(p).multiplyScalar(x.y).addScaledVector(m,-v.y).multiplyScalar(q),M.copy(m).multiplyScalar(v.x).addScaledVector(p,-x.x).multiplyScalar(q),l[B].add(E),l[U].add(E),l[z].add(E),u[B].add(M),u[U].add(M),u[z].add(M))}s(I,"handleTriangle");let P=this.groups;P.length===0&&(P=[{start:0,count:e.count}]);for(let B=0,U=P.length;B<U;++B){let z=P[B],q=z.start,Z=z.count;for(let Q=q,V=q+Z;Q<V;Q+=3)I(e.getX(Q+0),e.getX(Q+1),e.getX(Q+2))}let C=new qe,T=new qe,D=new qe,F=new qe;function k(B){D.fromBufferAttribute(n,B),F.copy(D);let U=l[B];C.copy(U),C.sub(D.multiplyScalar(D.dot(U))).normalize(),T.crossVectors(F,U);let z=T.dot(u[B])<0?-1:1;o.setXYZW(B,C.x,C.y,C.z,z)}s(k,"handleVertex");for(let B=0,U=P.length;B<U;++B){let z=P[B],q=z.start,Z=z.count;for(let Q=q,V=q+Z;Q<V;Q+=3)k(e.getX(Q+0)),k(e.getX(Q+1)),k(e.getX(Q+2))}}computeVertexNormals(){let e=this.index,r=this.getAttribute("position");if(r!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Zo(new Float32Array(r.count*3),3),this.setAttribute("normal",i);else for(let y=0,v=i.count;y<v;y++)i.setXYZ(y,0,0,0);let n=new qe,a=new qe,o=new qe,l=new qe,u=new qe,c=new qe,p=new qe,m=new qe;if(e)for(let y=0,v=e.count;y<v;y+=3){let x=e.getX(y+0),E=e.getX(y+1),M=e.getX(y+2);n.fromBufferAttribute(r,x),a.fromBufferAttribute(r,E),o.fromBufferAttribute(r,M),p.subVectors(o,a),m.subVectors(n,a),p.cross(m),l.fromBufferAttribute(i,x),u.fromBufferAttribute(i,E),c.fromBufferAttribute(i,M),l.add(p),u.add(p),c.add(p),i.setXYZ(x,l.x,l.y,l.z),i.setXYZ(E,u.x,u.y,u.z),i.setXYZ(M,c.x,c.y,c.z)}else for(let y=0,v=r.count;y<v;y+=3)n.fromBufferAttribute(r,y+0),a.fromBufferAttribute(r,y+1),o.fromBufferAttribute(r,y+2),p.subVectors(o,a),m.subVectors(n,a),p.cross(m),i.setXYZ(y+0,p.x,p.y,p.z),i.setXYZ(y+1,p.x,p.y,p.z),i.setXYZ(y+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let r=0,i=e.count;r<i;r++)Ns.fromBufferAttribute(e,r),Ns.normalize(),e.setXYZ(r,Ns.x,Ns.y,Ns.z)}toNonIndexed(){function e(l,u){let c=l.array,p=l.itemSize,m=l.normalized,y=new c.constructor(u.length*p),v=0,x=0;for(let E=0,M=u.length;E<M;E++){l.isInterleavedBufferAttribute?v=u[E]*l.data.stride+l.offset:v=u[E]*p;for(let I=0;I<p;I++)y[x++]=c[v++]}return new Zo(y,p,m)}if(s(e,"convertBufferAttribute"),this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let r=new $ce,i=this.index.array,n=this.attributes;for(let l in n){let u=n[l],c=e(u,i);r.setAttribute(l,c)}let a=this.morphAttributes;for(let l in a){let u=[],c=a[l];for(let p=0,m=c.length;p<m;p++){let y=c[p],v=e(y,i);u.push(v)}r.morphAttributes[l]=u}r.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let l=0,u=o.length;l<u;l++){let c=o[l];r.addGroup(c.start,c.count,c.materialIndex)}return r}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let u=this.parameters;for(let c in u)u[c]!==void 0&&(e[c]=u[c]);return e}e.data={attributes:{}};let r=this.index;r!==null&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});let i=this.attributes;for(let u in i){let c=i[u];e.data.attributes[u]=c.toJSON(e.data)}let n={},a=!1;for(let u in this.morphAttributes){let c=this.morphAttributes[u],p=[];for(let m=0,y=c.length;m<y;m++){let v=c[m];p.push(v.toJSON(e.data))}p.length>0&&(n[u]=p,a=!0)}a&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let r={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(r));let n=e.attributes;for(let c in n){let p=n[c];this.setAttribute(c,p.clone(r))}let a=e.morphAttributes;for(let c in a){let p=[],m=a[c];for(let y=0,v=m.length;y<v;y++)p.push(m[y].clone(r));this.morphAttributes[c]=p}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,p=o.length;c<p;c++){let m=o[c];this.addGroup(m.start,m.count,m.materialIndex)}let l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};s(jce,"BufferGeometry");var Vs=jce,Fq=new Ri,kg=new LA,WM=new Ru,Bq=new qe,XM=new qe,ZM=new qe,YM=new qe,lD=new qe,KM=new qe,zq=new qe,JM=new qe,Gce=class extends Ha{constructor(e=new Vs,r=new ug){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=i.length;n<a;n++){let o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}getVertexPosition(e,r){let i=this.geometry,n=i.attributes.position,a=i.morphAttributes.position,o=i.morphTargetsRelative;r.fromBufferAttribute(n,e);let l=this.morphTargetInfluences;if(a&&l){KM.set(0,0,0);for(let u=0,c=a.length;u<c;u++){let p=l[u],m=a[u];p!==0&&(lD.fromBufferAttribute(m,e),o?KM.addScaledVector(lD,p):KM.addScaledVector(lD.sub(r),p))}r.add(KM)}return r}raycast(e,r){let i=this.geometry,n=this.material,a=this.matrixWorld;n!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),WM.copy(i.boundingSphere),WM.applyMatrix4(a),kg.copy(e.ray).recast(e.near),!(WM.containsPoint(kg.origin)===!1&&(kg.intersectSphere(WM,Bq)===null||kg.origin.distanceToSquared(Bq)>(e.far-e.near)**2))&&(Fq.copy(a).invert(),kg.copy(e.ray).applyMatrix4(Fq),!(i.boundingBox!==null&&kg.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,r,kg)))}_computeIntersections(e,r,i){let n,a=this.geometry,o=this.material,l=a.index,u=a.attributes.position,c=a.attributes.uv,p=a.attributes.uv1,m=a.attributes.normal,y=a.groups,v=a.drawRange;if(l!==null)if(Array.isArray(o))for(let x=0,E=y.length;x<E;x++){let M=y[x],I=o[M.materialIndex],P=Math.max(M.start,v.start),C=Math.min(l.count,Math.min(M.start+M.count,v.start+v.count));for(let T=P,D=C;T<D;T+=3){let F=l.getX(T),k=l.getX(T+1),B=l.getX(T+2);n=h2(this,I,e,i,c,p,m,F,k,B),n&&(n.faceIndex=Math.floor(T/3),n.face.materialIndex=M.materialIndex,r.push(n))}}else{let x=Math.max(0,v.start),E=Math.min(l.count,v.start+v.count);for(let M=x,I=E;M<I;M+=3){let P=l.getX(M),C=l.getX(M+1),T=l.getX(M+2);n=h2(this,o,e,i,c,p,m,P,C,T),n&&(n.faceIndex=Math.floor(M/3),r.push(n))}}else if(u!==void 0)if(Array.isArray(o))for(let x=0,E=y.length;x<E;x++){let M=y[x],I=o[M.materialIndex],P=Math.max(M.start,v.start),C=Math.min(u.count,Math.min(M.start+M.count,v.start+v.count));for(let T=P,D=C;T<D;T+=3){let F=T,k=T+1,B=T+2;n=h2(this,I,e,i,c,p,m,F,k,B),n&&(n.faceIndex=Math.floor(T/3),n.face.materialIndex=M.materialIndex,r.push(n))}}else{let x=Math.max(0,v.start),E=Math.min(u.count,v.start+v.count);for(let M=x,I=E;M<I;M+=3){let P=M,C=M+1,T=M+2;n=h2(this,o,e,i,c,p,m,P,C,T),n&&(n.faceIndex=Math.floor(M/3),r.push(n))}}}};s(Gce,"Mesh");var Tn=Gce;function Hce(t,e,r,i,n,a,o,l){let u;if(e.side===eu?u=i.intersectTriangle(o,a,n,!0,l):u=i.intersectTriangle(n,a,o,e.side===Qp,l),u===null)return null;JM.copy(l),JM.applyMatrix4(t.matrixWorld);let c=r.ray.origin.distanceTo(JM);return c<r.near||c>r.far?null:{distance:c,point:JM.clone(),object:t}}s(Hce,"checkIntersection$1");function h2(t,e,r,i,n,a,o,l,u,c){t.getVertexPosition(l,XM),t.getVertexPosition(u,ZM),t.getVertexPosition(c,YM);let p=Hce(t,e,r,i,XM,ZM,YM,zq);if(p){let m=new qe;P0.getBarycoord(zq,XM,ZM,YM,m),n&&(p.uv=P0.getInterpolatedAttribute(n,l,u,c,m,new Jt)),a&&(p.uv1=P0.getInterpolatedAttribute(a,l,u,c,m,new Jt)),o&&(p.normal=P0.getInterpolatedAttribute(o,l,u,c,m,new qe),p.normal.dot(i.direction)>0&&p.normal.multiplyScalar(-1));let y={a:l,b:u,c,normal:new qe,materialIndex:0};P0.getNormal(XM,ZM,YM,y.normal),p.face=y,p.barycoord=m}return p}s(h2,"checkGeometryIntersection");var qce=class Wce extends Vs{constructor(e=1,r=1,i=1,n=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:r,depth:i,widthSegments:n,heightSegments:a,depthSegments:o};let l=this;n=Math.floor(n),a=Math.floor(a),o=Math.floor(o);let u=[],c=[],p=[],m=[],y=0,v=0;x("z","y","x",-1,-1,i,r,e,o,a,0),x("z","y","x",1,-1,i,r,-e,o,a,1),x("x","z","y",1,1,e,i,r,n,o,2),x("x","z","y",1,-1,e,i,-r,n,o,3),x("x","y","z",1,-1,e,r,i,n,a,4),x("x","y","z",-1,-1,e,r,-i,n,a,5),this.setIndex(u),this.setAttribute("position",new go(c,3)),this.setAttribute("normal",new go(p,3)),this.setAttribute("uv",new go(m,2));function x(E,M,I,P,C,T,D,F,k,B,U){let z=T/k,q=D/B,Z=T/2,Q=D/2,V=F/2,ae=k+1,Y=B+1,he=0,J=0,ne=new qe;for(let ee=0;ee<Y;ee++){let ue=ee*q-Q;for(let K=0;K<ae;K++){let ce=K*z-Z;ne[E]=ce*P,ne[M]=ue*C,ne[I]=V,c.push(ne.x,ne.y,ne.z),ne[E]=0,ne[M]=0,ne[I]=F>0?1:-1,p.push(ne.x,ne.y,ne.z),m.push(K/k),m.push(1-ee/B),he+=1}}for(let ee=0;ee<B;ee++)for(let ue=0;ue<k;ue++){let K=y+ue+ae*ee,ce=y+ue+ae*(ee+1),re=y+(ue+1)+ae*(ee+1),se=y+(ue+1)+ae*ee;u.push(K,ce,se),u.push(ce,re,se),J+=6}l.addGroup(v,J,U),v+=J,y+=he}s(x,"buildPlane")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wce(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};s(qce,"BoxGeometry");var DA=qce;function Xy(t){let e={};for(let r in t){e[r]={};for(let i in t[r]){let n=t[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[r][i]=null):e[r][i]=n.clone():Array.isArray(n)?e[r][i]=n.slice():e[r][i]=n}}return e}s(Xy,"cloneUniforms");function Al(t){let e={};for(let r=0;r<t.length;r++){let i=Xy(t[r]);for(let n in i)e[n]=i[n]}return e}s(Al,"mergeUniforms");function Xce(t){let e=[];for(let r=0;r<t.length;r++)e.push(t[r].clone());return e}s(Xce,"cloneUniformsGroups");function vB(t){let e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Dn.workingColorSpace}s(vB,"getUnlitUniformColorSpace");var bVe={clone:Xy,merge:Al},wVe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,AVe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Zce=class extends lg{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=wVe,this.fragmentShader=AVe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xy(e.uniforms),this.uniformsGroups=Xce(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let r=super.toJSON(e);r.glslVersion=this.glslVersion,r.uniforms={};for(let n in this.uniforms){let a=this.uniforms[n].value;a&&a.isTexture?r.uniforms[n]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?r.uniforms[n]={type:"c",value:a.getHex()}:a&&a.isVector2?r.uniforms[n]={type:"v2",value:a.toArray()}:a&&a.isVector3?r.uniforms[n]={type:"v3",value:a.toArray()}:a&&a.isVector4?r.uniforms[n]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?r.uniforms[n]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?r.uniforms[n]={type:"m4",value:a.toArray()}:r.uniforms[n]={value:a}}Object.keys(this.defines).length>0&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,r.lights=this.lights,r.clipping=this.clipping;let i={};for(let n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(r.extensions=i),r}};s(Zce,"ShaderMaterial");var bc=Zce,Yce=class extends Ha{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ri,this.projectionMatrix=new Ri,this.projectionMatrixInverse=new Ri,this.coordinateSystem=sf}copy(e,r){return super.copy(e,r),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,r){super.updateWorldMatrix(e,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};s(Yce,"Camera");var _B=Yce,lm=new qe,Uq=new Jt,Vq=new Jt,Kce=class extends _B{constructor(e=50,r=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let r=.5*this.getFilmHeight()/e;this.fov=C_*2*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(i_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return C_*2*Math.atan(Math.tan(i_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,r,i){lm.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(lm.x,lm.y).multiplyScalar(-e/lm.z),lm.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(lm.x,lm.y).multiplyScalar(-e/lm.z)}getViewSize(e,r){return this.getViewBounds(e,Uq,Vq),r.subVectors(Vq,Uq)}setViewOffset(e,r,i,n,a,o){this.aspect=e/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,r=e*Math.tan(i_*.5*this.fov)/this.zoom,i=2*r,n=this.aspect*i,a=-.5*n,o=this.view;if(this.view!==null&&this.view.enabled){let u=o.fullWidth,c=o.fullHeight;a+=o.offsetX*n/u,r-=o.offsetY*i/c,n*=o.width/u,i*=o.height/c}let l=this.filmOffset;l!==0&&(a+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+n,r,r-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let r=super.toJSON(e);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,this.view!==null&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}};s(Kce,"PerspectiveCamera");var Yl=Kce,f0=-90,m0=1,Jce=class extends Ha{constructor(e,r,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let n=new Yl(f0,m0,e,r);n.layers=this.layers,this.add(n);let a=new Yl(f0,m0,e,r);a.layers=this.layers,this.add(a);let o=new Yl(f0,m0,e,r);o.layers=this.layers,this.add(o);let l=new Yl(f0,m0,e,r);l.layers=this.layers,this.add(l);let u=new Yl(f0,m0,e,r);u.layers=this.layers,this.add(u);let c=new Yl(f0,m0,e,r);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){let e=this.coordinateSystem,r=this.children.concat(),[i,n,a,o,l,u]=r;for(let c of r)this.remove(c);if(e===sf)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===UT)i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let c of r)this.add(c),c.updateMatrixWorld()}update(e,r){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[a,o,l,u,c,p]=this.children,m=e.getRenderTarget(),y=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;let E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,n),e.render(r,a),e.setRenderTarget(i,1,n),e.render(r,o),e.setRenderTarget(i,2,n),e.render(r,l),e.setRenderTarget(i,3,n),e.render(r,u),e.setRenderTarget(i,4,n),e.render(r,c),i.texture.generateMipmaps=E,e.setRenderTarget(i,5,n),e.render(r,p),e.setRenderTarget(m,y,v),e.xr.enabled=x,i.texture.needsPMREMUpdate=!0}};s(Jce,"CubeCamera");var SVe=Jce,Qce=class extends Gu{constructor(e,r,i,n,a,o,l,u,c,p){e=e!==void 0?e:[],r=r!==void 0?r:A_,super(e,r,i,n,a,o,l,u,c,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};s(Qce,"CubeTexture");var ehe=Qce,the=class extends Qm{constructor(e=1,r={}){super(e,e,r),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new ehe(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Up}fromEquirectangularTexture(e,r){this.texture.type=r.type,this.texture.colorSpace=r.colorSpace,this.texture.generateMipmaps=r.generateMipmaps,this.texture.minFilter=r.minFilter,this.texture.magFilter=r.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new DA(5,5,5),a=new bc({name:"CubemapFromEquirect",uniforms:Xy(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:eu,blending:Hm});a.uniforms.tEquirect.value=r;let o=new Tn(n,a),l=r.minFilter;return r.minFilter===Ey&&(r.minFilter=Up),new SVe(1,10,this).update(e,o),r.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,r,i,n){let a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(r,i,n);e.setRenderTarget(a)}};s(the,"WebGLCubeRenderTarget");var MVe=the,rhe=class extends Ha{constructor(){super(),this.isGroup=!0,this.type="Group"}};s(rhe,"Group");var QM=rhe,EVe={type:"move"},ihe=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new QM,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new QM,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new qe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new qe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new QM,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new qe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new qe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let r=this._hand;if(r)for(let i of e.hand.values())this._getHandJoint(r,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,r,i){let n=null,a=null,o=null,l=this._targetRay,u=this._grip,c=this._hand;if(e&&r.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(let E of e.hand.values()){let M=r.getJointPose(E,i),I=this._getHandJoint(c,E);M!==null&&(I.matrix.fromArray(M.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=M.radius),I.visible=M!==null}let p=c.joints["index-finger-tip"],m=c.joints["thumb-tip"],y=p.position.distanceTo(m.position),v=.02,x=.005;c.inputState.pinching&&y>v+x?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&y<=v-x&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(a=r.getPose(e.gripSpace,i),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,a.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(a.linearVelocity)):u.hasLinearVelocity=!1,a.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(a.angularVelocity)):u.hasAngularVelocity=!1));l!==null&&(n=r.getPose(e.targetRaySpace,i),n===null&&a!==null&&(n=a),n!==null&&(l.matrix.fromArray(n.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,n.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(n.linearVelocity)):l.hasLinearVelocity=!1,n.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(n.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(EVe)))}return l!==null&&(l.visible=n!==null),u!==null&&(u.visible=a!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,r){if(e.joints[r.jointName]===void 0){let i=new QM;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[r.jointName]=i,e.add(i)}return e.joints[r.jointName]}};s(ihe,"WebXRController");var uD=ihe,nhe=class extends Ha{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Nu,this.environmentIntensity=1,this.environmentRotation=new Nu,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,r){return super.copy(e,r),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let r=super.toJSON(e);return this.fog!==null&&(r.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(r.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(r.object.backgroundIntensity=this.backgroundIntensity),r.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(r.object.environmentIntensity=this.environmentIntensity),r.object.environmentRotation=this.environmentRotation.toArray(),r}};s(nhe,"Scene");var xB=nhe,ahe=class{constructor(e,r){this.isInterleavedBuffer=!0,this.array=e,this.stride=r,this.count=e!==void 0?e.length/r:0,this.usage=aO,this.updateRanges=[],this.version=0,this.uuid=xc()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,r){this.updateRanges.push({start:e,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,r,i){e*=this.stride,i*=r.stride;for(let n=0,a=this.stride;n<a;n++)this.array[e+n]=r.array[i+n];return this}set(e,r=0){return this.array.set(e,r),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let r=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(r,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};s(ahe,"InterleavedBuffer");var dut=ahe,Gl=new qe,ohe=class she{constructor(e,r,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=r,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let r=0,i=this.data.count;r<i;r++)Gl.fromBufferAttribute(this,r),Gl.applyMatrix4(e),this.setXYZ(r,Gl.x,Gl.y,Gl.z);return this}applyNormalMatrix(e){for(let r=0,i=this.count;r<i;r++)Gl.fromBufferAttribute(this,r),Gl.applyNormalMatrix(e),this.setXYZ(r,Gl.x,Gl.y,Gl.z);return this}transformDirection(e){for(let r=0,i=this.count;r<i;r++)Gl.fromBufferAttribute(this,r),Gl.transformDirection(e),this.setXYZ(r,Gl.x,Gl.y,Gl.z);return this}getComponent(e,r){let i=this.array[e*this.data.stride+this.offset+r];return this.normalized&&(i=Qc(i,this.array)),i}setComponent(e,r,i){return this.normalized&&(i=Zn(i,this.array)),this.data.array[e*this.data.stride+this.offset+r]=i,this}setX(e,r){return this.normalized&&(r=Zn(r,this.array)),this.data.array[e*this.data.stride+this.offset]=r,this}setY(e,r){return this.normalized&&(r=Zn(r,this.array)),this.data.array[e*this.data.stride+this.offset+1]=r,this}setZ(e,r){return this.normalized&&(r=Zn(r,this.array)),this.data.array[e*this.data.stride+this.offset+2]=r,this}setW(e,r){return this.normalized&&(r=Zn(r,this.array)),this.data.array[e*this.data.stride+this.offset+3]=r,this}getX(e){let r=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(r=Qc(r,this.array)),r}getY(e){let r=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(r=Qc(r,this.array)),r}getZ(e){let r=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(r=Qc(r,this.array)),r}getW(e){let r=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(r=Qc(r,this.array)),r}setXY(e,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(r=Zn(r,this.array),i=Zn(i,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=i,this}setXYZ(e,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(r=Zn(r,this.array),i=Zn(i,this.array),n=Zn(n,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,r,i,n,a){return e=e*this.data.stride+this.offset,this.normalized&&(r=Zn(r,this.array),i=Zn(i,this.array),n=Zn(n,this.array),a=Zn(a,this.array)),this.data.array[e+0]=r,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let r=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)r.push(this.data.array[n+a])}return new Zo(new this.array.constructor(r),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new she(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let r=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)r.push(this.data.array[n+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:r,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};s(ohe,"InterleavedBufferAttribute");var fut=ohe,jq=new qe,$q=new Jn,Gq=new Jn,CVe=new qe,Hq=new Ri,eE=new qe,cD=new Ru,qq=new Ri,hD=new LA,lhe=class extends Tn{constructor(e,r){super(e,r),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=_q,this.bindMatrix=new Ri,this.bindMatrixInverse=new Ri,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new to),this.boundingBox.makeEmpty();let r=e.getAttribute("position");for(let i=0;i<r.count;i++)this.getVertexPosition(i,eE),this.boundingBox.expandByPoint(eE)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ru),this.boundingSphere.makeEmpty();let r=e.getAttribute("position");for(let i=0;i<r.count;i++)this.getVertexPosition(i,eE),this.boundingSphere.expandByPoint(eE)}copy(e,r){return super.copy(e,r),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,r){let i=this.material,n=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),cD.copy(this.boundingSphere),cD.applyMatrix4(n),e.ray.intersectsSphere(cD)!==!1&&(qq.copy(n).invert(),hD.copy(e.ray).applyMatrix4(qq),!(this.boundingBox!==null&&hD.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,r,hD)))}getVertexPosition(e,r){return super.getVertexPosition(e,r),this.applyBoneTransform(e,r),r}bind(e,r){this.skeleton=e,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Jn,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){e.fromBufferAttribute(r,i);let a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),r.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===_q?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===GUe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,r){let i=this.skeleton,n=this.geometry;$q.fromBufferAttribute(n.attributes.skinIndex,e),Gq.fromBufferAttribute(n.attributes.skinWeight,e),jq.copy(r).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let a=0;a<4;a++){let o=Gq.getComponent(a);if(o!==0){let l=$q.getComponent(a);Hq.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),r.addScaledVector(CVe.copy(jq).applyMatrix4(Hq),o)}}return r.applyMatrix4(this.bindMatrixInverse)}};s(lhe,"SkinnedMesh");var gut=lhe,uhe=class extends Ha{constructor(){super(),this.isBone=!0,this.type="Bone"}};s(uhe,"Bone");var IVe=uhe,che=class extends Gu{constructor(e=null,r=1,i=1,n,a,o,l,u,c=_c,p=_c,m,y){super(null,o,l,u,c,p,n,a,m,y),this.isDataTexture=!0,this.image={data:e,width:r,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};s(che,"DataTexture");var a_=che,Wq=new Ri,TVe=new Ri,hhe=class phe{constructor(e=[],r=[]){this.uuid=xc(),this.bones=e.slice(0),this.boneInverses=r,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,r=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),r.length===0)this.calculateInverses();else if(e.length!==r.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Ri)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,r=this.bones.length;e<r;e++){let i=new Ri;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,r=this.bones.length;e<r;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,r=this.bones.length;e<r;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,r=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let a=0,o=e.length;a<o;a++){let l=e[a]?e[a].matrixWorld:TVe;Wq.multiplyMatrices(l,r[a]),Wq.toArray(i,a*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new phe(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let r=new Float32Array(e*e*4);r.set(this.boneMatrices);let i=new a_(r,e,e,Ll,Lu);return i.needsUpdate=!0,this.boneMatrices=r,this.boneTexture=i,this}getBoneByName(e){for(let r=0,i=this.bones.length;r<i;r++){let n=this.bones[r];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,r){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){let a=e.bones[i],o=r[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new IVe),this.bones.push(o),this.boneInverses.push(new Ri().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let r=this.bones,i=this.boneInverses;for(let n=0,a=r.length;n<a;n++){let o=r[n];e.bones.push(o.uuid);let l=i[n];e.boneInverses.push(l.toArray())}return e}};s(hhe,"Skeleton");var _ut=hhe,dhe=class extends Zo{constructor(e,r,i,n=1){super(e,r,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};s(dhe,"InstancedBufferAttribute");var Xq=dhe,g0=new Ri,Zq=new Ri,tE=[],Yq=new to,PVe=new Ri,Ob=new Tn,kb=new Ru,fhe=class extends Tn{constructor(e,r,i){super(e,r),this.isInstancedMesh=!0,this.instanceMatrix=new Xq(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let n=0;n<i;n++)this.setMatrixAt(n,PVe)}computeBoundingBox(){let e=this.geometry,r=this.count;this.boundingBox===null&&(this.boundingBox=new to),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<r;i++)this.getMatrixAt(i,g0),Yq.copy(e.boundingBox).applyMatrix4(g0),this.boundingBox.union(Yq)}computeBoundingSphere(){let e=this.geometry,r=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ru),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<r;i++)this.getMatrixAt(i,g0),kb.copy(e.boundingSphere).applyMatrix4(g0),this.boundingSphere.union(kb)}copy(e,r){return super.copy(e,r),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,r){r.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,r){r.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,r){let i=r.morphTargetInfluences,n=this.morphTexture.source.data.data,a=i.length+1,o=e*a+1;for(let l=0;l<i.length;l++)i[l]=n[o+l]}raycast(e,r){let i=this.matrixWorld,n=this.count;if(Ob.geometry=this.geometry,Ob.material=this.material,Ob.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),kb.copy(this.boundingSphere),kb.applyMatrix4(i),e.ray.intersectsSphere(kb)!==!1))for(let a=0;a<n;a++){this.getMatrixAt(a,g0),Zq.multiplyMatrices(i,g0),Ob.matrixWorld=Zq,Ob.raycast(e,tE);for(let o=0,l=tE.length;o<l;o++){let u=tE[o];u.instanceId=a,u.object=this,r.push(u)}tE.length=0}}setColorAt(e,r){this.instanceColor===null&&(this.instanceColor=new Xq(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),r.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,r){r.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,r){let i=r.morphTargetInfluences,n=i.length+1;this.morphTexture===null&&(this.morphTexture=new a_(new Float32Array(n*this.count),n,this.count,pB,Lu));let a=this.morphTexture.source.data.data,o=0;for(let c=0;c<i.length;c++)o+=i[c];let l=this.geometry.morphTargetsRelative?1:1-o,u=n*e;a[u]=l,a.set(i,u+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};s(fhe,"InstancedMesh");var VT=fhe,pD=new qe,LVe=new qe,DVe=new rn,mhe=class{constructor(e=new qe(1,0,0),r=0){this.isPlane=!0,this.normal=e,this.constant=r}set(e,r){return this.normal.copy(e),this.constant=r,this}setComponents(e,r,i,n){return this.normal.set(e,r,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,r){return this.normal.copy(e),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(e,r,i){let n=pD.subVectors(i,r).cross(LVe.subVectors(e,r)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,r){return r.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,r){let i=e.delta(pD),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(e.start)===0?r.copy(e.start):null;let a=-(e.start.dot(this.normal)+this.constant)/n;return a<0||a>1?null:r.copy(e.start).addScaledVector(i,a)}intersectsLine(e){let r=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return r<0&&i>0||i<0&&r>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,r){let i=r||DVe.getNormalMatrix(e),n=this.coplanarPoint(pD).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};s(mhe,"Plane");var $g=mhe,Ng=new Ru,rE=new qe,ghe=class{constructor(e=new $g,r=new $g,i=new $g,n=new $g,a=new $g,o=new $g){this.planes=[e,r,i,n,a,o]}set(e,r,i,n,a,o){let l=this.planes;return l[0].copy(e),l[1].copy(r),l[2].copy(i),l[3].copy(n),l[4].copy(a),l[5].copy(o),this}copy(e){let r=this.planes;for(let i=0;i<6;i++)r[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,r=sf){let i=this.planes,n=e.elements,a=n[0],o=n[1],l=n[2],u=n[3],c=n[4],p=n[5],m=n[6],y=n[7],v=n[8],x=n[9],E=n[10],M=n[11],I=n[12],P=n[13],C=n[14],T=n[15];if(i[0].setComponents(u-a,y-c,M-v,T-I).normalize(),i[1].setComponents(u+a,y+c,M+v,T+I).normalize(),i[2].setComponents(u+o,y+p,M+x,T+P).normalize(),i[3].setComponents(u-o,y-p,M-x,T-P).normalize(),i[4].setComponents(u-l,y-m,M-E,T-C).normalize(),r===sf)i[5].setComponents(u+l,y+m,M+E,T+C).normalize();else if(r===UT)i[5].setComponents(l,m,E,C).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+r);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ng.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let r=e.geometry;r.boundingSphere===null&&r.computeBoundingSphere(),Ng.copy(r.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ng)}intersectsSprite(e){return Ng.center.set(0,0,0),Ng.radius=.7071067811865476,Ng.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ng)}intersectsSphere(e){let r=this.planes,i=e.center,n=-e.radius;for(let a=0;a<6;a++)if(r[a].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){let r=this.planes;for(let i=0;i<6;i++){let n=r[i];if(rE.x=n.normal.x>0?e.max.x:e.min.x,rE.y=n.normal.y>0?e.max.y:e.min.y,rE.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(rE)<0)return!1}return!0}containsPoint(e){let r=this.planes;for(let i=0;i<6;i++)if(r[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};s(ghe,"Frustum");var RA=ghe;function aC(t,e){return t-e}s(aC,"ascIdSort");function yhe(t,e){return t.z-e.z}s(yhe,"sortOpaque");function vhe(t,e){return e.z-t.z}s(vhe,"sortTransparent");var _he=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,r,i,n){let a=this.pool,o=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});let l=a[this.index];o.push(l),this.index++,l.start=e,l.count=r,l.z=i,l.index=n}reset(){this.list.length=0,this.index=0}};s(_he,"MultiDrawRenderList");var RVe=_he,_u=new Ri,OVe=new oi(1,1,1),dD=new RA,iE=new to,Fg=new Ru,Nb=new qe,Kq=new qe,kVe=new qe,fD=new RVe,bl=new Tn,nE=[];function xhe(t,e,r=0){let i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){let n=t.count;for(let a=0;a<n;a++)for(let o=0;o<i;o++)e.setComponent(a+r,o,t.getComponent(a,o))}else e.array.set(t.array,r*i);e.needsUpdate=!0}s(xhe,"copyAttributeData");function dm(t,e){if(t.constructor!==e.constructor){let r=Math.min(t.length,e.length);for(let i=0;i<r;i++)e[i]=t[i]}else{let r=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,r))}}s(dm,"copyArrayContents");var bhe=class extends Tn{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,r,i=r*2,n){super(new Vs,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=r,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let r=new Float32Array(e*e*4),i=new a_(r,e,e,Ll,Lu);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let r=new Uint32Array(e*e),i=new a_(r,e,e,RP,Jm);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let r=new Float32Array(e*e*4).fill(1),i=new a_(r,e,e,Ll,Lu);i.colorSpace=Dn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){let r=this.geometry,i=this._maxVertexCount,n=this._maxIndexCount;if(this._geometryInitialized===!1){for(let a in e.attributes){let o=e.getAttribute(a),{array:l,itemSize:u,normalized:c}=o,p=new l.constructor(i*u),m=new Zo(p,u,c);r.setAttribute(a,m)}if(e.getIndex()!==null){let a=i>65535?new Uint32Array(n):new Uint16Array(n);r.setIndex(new Zo(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){let r=this.geometry;if(!!e.getIndex()!=!!r.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let i in r.attributes){if(!e.hasAttribute(i))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(i,'". All geometries must have consistent attributes.'));let n=e.getAttribute(i),a=r.getAttribute(i);if(n.itemSize!==a.itemSize||n.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let r=this._instanceInfo;if(e<0||e>=r.length||r[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){let r=this._geometryInfo;if(e<0||e>=r.length||r[e].active===!1)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new to);let e=this.boundingBox,r=this._instanceInfo;e.makeEmpty();for(let i=0,n=r.length;i<n;i++){if(r[i].active===!1)continue;let a=r[i].geometryIndex;this.getMatrixAt(i,_u),this.getBoundingBoxAt(a,iE).applyMatrix4(_u),e.union(iE)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ru);let e=this.boundingSphere,r=this._instanceInfo;e.makeEmpty();for(let i=0,n=r.length;i<n;i++){if(r[i].active===!1)continue;let a=r[i].geometryIndex;this.getMatrixAt(i,_u),this.getBoundingSphereAt(a,Fg).applyMatrix4(_u),e.union(Fg)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");let r={visible:!0,active:!0,geometryIndex:e},i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(aC),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=r):(i=this._instanceInfo.length,this._instanceInfo.push(r));let n=this._matricesTexture;_u.identity().toArray(n.image.data,i*16),n.needsUpdate=!0;let a=this._colorsTexture;return a&&(OVe.toArray(a.image.data,i*4),a.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,r=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);let n={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;n.vertexStart=this._nextVertexStart,n.reservedVertexCount=r===-1?e.getAttribute("position").count:r;let o=e.getIndex();if(o!==null&&(n.indexStart=this._nextIndexStart,n.reservedIndexCount=i===-1?o.count:i),n.indexStart!==-1&&n.indexStart+n.reservedIndexCount>this._maxIndexCount||n.vertexStart+n.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(aC),l=this._availableGeometryIds.shift(),a[l]=n):(l=this._geometryCount,this._geometryCount++,a.push(n)),this.setGeometryAt(l,e),this._nextIndexStart=n.indexStart+n.reservedIndexCount,this._nextVertexStart=n.vertexStart+n.reservedVertexCount,l}setGeometryAt(e,r){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(r);let i=this.geometry,n=i.getIndex()!==null,a=i.getIndex(),o=r.getIndex(),l=this._geometryInfo[e];if(n&&o.count>l.reservedIndexCount||r.attributes.position.count>l.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let u=l.vertexStart,c=l.reservedVertexCount;l.vertexCount=r.getAttribute("position").count;for(let p in i.attributes){let m=r.getAttribute(p),y=i.getAttribute(p);xhe(m,y,u);let v=m.itemSize;for(let x=m.count,E=c;x<E;x++){let M=u+x;for(let I=0;I<v;I++)y.setComponent(M,I,0)}y.needsUpdate=!0,y.addUpdateRange(u*v,c*v)}if(n){let p=l.indexStart,m=l.reservedIndexCount;l.indexCount=r.getIndex().count;for(let y=0;y<o.count;y++)a.setX(p+y,u+o.getX(y));for(let y=o.count,v=m;y<v;y++)a.setX(p+y,u);a.needsUpdate=!0,a.addUpdateRange(p,l.reservedIndexCount)}return l.start=n?l.indexStart:l.vertexStart,l.count=n?l.indexCount:l.vertexCount,l.boundingBox=null,r.boundingBox!==null&&(l.boundingBox=r.boundingBox.clone()),l.boundingSphere=null,r.boundingSphere!==null&&(l.boundingSphere=r.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let r=this._geometryInfo;if(e>=r.length||r[e].active===!1)return this;let i=this._instanceInfo;for(let n=0,a=i.length;n<a;n++)i[n].active&&i[n].geometryIndex===e&&this.deleteInstance(n);return r[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,r=0,i=this._geometryInfo,n=i.map((o,l)=>l).sort((o,l)=>i[o].vertexStart-i[l].vertexStart),a=this.geometry;for(let o=0,l=i.length;o<l;o++){let u=n[o],c=i[u];if(c.active!==!1){if(a.index!==null){if(c.indexStart!==r){let{indexStart:p,vertexStart:m,reservedIndexCount:y}=c,v=a.index,x=v.array,E=e-m;for(let M=p;M<p+y;M++)x[M]=x[M]+E;v.array.copyWithin(r,p,p+y),v.addUpdateRange(r,y),c.indexStart=r}r+=c.reservedIndexCount}if(c.vertexStart!==e){let{vertexStart:p,reservedVertexCount:m}=c,y=a.attributes;for(let v in y){let x=y[v],{array:E,itemSize:M}=x;E.copyWithin(e*M,p*M,(p+m)*M),x.addUpdateRange(e*M,m*M)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=a.index?c.indexStart:c.vertexStart,this._nextIndexStart=a.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,r){if(e>=this._geometryCount)return null;let i=this.geometry,n=this._geometryInfo[e];if(n.boundingBox===null){let a=new to,o=i.index,l=i.attributes.position;for(let u=n.start,c=n.start+n.count;u<c;u++){let p=u;o&&(p=o.getX(p)),a.expandByPoint(Nb.fromBufferAttribute(l,p))}n.boundingBox=a}return r.copy(n.boundingBox),r}getBoundingSphereAt(e,r){if(e>=this._geometryCount)return null;let i=this.geometry,n=this._geometryInfo[e];if(n.boundingSphere===null){let a=new Ru;this.getBoundingBoxAt(e,iE),iE.getCenter(a.center);let o=i.index,l=i.attributes.position,u=0;for(let c=n.start,p=n.start+n.count;c<p;c++){let m=c;o&&(m=o.getX(m)),Nb.fromBufferAttribute(l,m),u=Math.max(u,a.center.distanceToSquared(Nb))}a.radius=Math.sqrt(u),n.boundingSphere=a}return r.copy(n.boundingSphere),r}setMatrixAt(e,r){this.validateInstanceId(e);let i=this._matricesTexture,n=this._matricesTexture.image.data;return r.toArray(n,e*16),i.needsUpdate=!0,this}getMatrixAt(e,r){return this.validateInstanceId(e),r.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,r){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),r.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,r){return this.validateInstanceId(e),r.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,r){return this.validateInstanceId(e),this._instanceInfo[e].visible===r?this:(this._instanceInfo[e].visible=r,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,r){return this.validateInstanceId(e),this.validateGeometryId(r),this._instanceInfo[e].geometryIndex=r,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,r={}){this.validateGeometryId(e);let i=this._geometryInfo[e];return r.vertexStart=i.vertexStart,r.vertexCount=i.vertexCount,r.reservedVertexCount=i.reservedVertexCount,r.indexStart=i.indexStart,r.indexCount=i.indexCount,r.reservedIndexCount=i.reservedIndexCount,r.start=i.start,r.count=i.count,r}setInstanceCount(e){let r=this._availableInstanceIds,i=this._instanceInfo;for(r.sort(aC);r[r.length-1]===i.length;)i.pop(),r.pop();if(e<i.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));let n=new Int32Array(e),a=new Int32Array(e);dm(this._multiDrawCounts,n),dm(this._multiDrawStarts,a),this._multiDrawCounts=n,this._multiDrawStarts=a,this._maxInstanceCount=e;let o=this._indirectTexture,l=this._matricesTexture,u=this._colorsTexture;o.dispose(),this._initIndirectTexture(),dm(o.image.data,this._indirectTexture.image.data),l.dispose(),this._initMatricesTexture(),dm(l.image.data,this._matricesTexture.image.data),u&&(u.dispose(),this._initColorsTexture(),dm(u.image.data,this._colorsTexture.image.data))}setGeometrySize(e,r){let i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(r,". Cannot shrink further."));if(this.geometry.index&&Math.max(...i.map(o=>o.indexStart+o.reservedIndexCount))>r)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(r,". Cannot shrink further."));let n=this.geometry;n.dispose(),this._maxVertexCount=e,this._maxIndexCount=r,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Vs,this._initializeGeometry(n));let a=this.geometry;n.index&&dm(n.index.array,a.index.array);for(let o in n.attributes)dm(n.attributes[o].array,a.attributes[o].array)}raycast(e,r){let i=this._instanceInfo,n=this._geometryInfo,a=this.matrixWorld,o=this.geometry;bl.material=this.material,bl.geometry.index=o.index,bl.geometry.attributes=o.attributes,bl.geometry.boundingBox===null&&(bl.geometry.boundingBox=new to),bl.geometry.boundingSphere===null&&(bl.geometry.boundingSphere=new Ru);for(let l=0,u=i.length;l<u;l++){if(!i[l].visible||!i[l].active)continue;let c=i[l].geometryIndex,p=n[c];bl.geometry.setDrawRange(p.start,p.count),this.getMatrixAt(l,bl.matrixWorld).premultiply(a),this.getBoundingBoxAt(c,bl.geometry.boundingBox),this.getBoundingSphereAt(c,bl.geometry.boundingSphere),bl.raycast(e,nE);for(let m=0,y=nE.length;m<y;m++){let v=nE[m];v.object=this,v.batchId=l,r.push(v)}nE.length=0}bl.material=null,bl.geometry.index=null,bl.geometry.attributes={},bl.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(r=>vt(Ee({},r),{boundingBox:r.boundingBox!==null?r.boundingBox.clone():null,boundingSphere:r.boundingSphere!==null?r.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(r=>Ee({},r)),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,r,i,n,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=n.getIndex(),l=o===null?1:o.array.BYTES_PER_ELEMENT,u=this._instanceInfo,c=this._multiDrawStarts,p=this._multiDrawCounts,m=this._geometryInfo,y=this.perObjectFrustumCulled,v=this._indirectTexture,x=v.image.data;y&&(_u.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),dD.setFromProjectionMatrix(_u,e.coordinateSystem));let E=0;if(this.sortObjects){_u.copy(this.matrixWorld).invert(),Nb.setFromMatrixPosition(i.matrixWorld).applyMatrix4(_u),Kq.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(_u);for(let P=0,C=u.length;P<C;P++)if(u[P].visible&&u[P].active){let T=u[P].geometryIndex;this.getMatrixAt(P,_u),this.getBoundingSphereAt(T,Fg).applyMatrix4(_u);let D=!1;if(y&&(D=!dD.intersectsSphere(Fg)),!D){let F=m[T],k=kVe.subVectors(Fg.center,Nb).dot(Kq);fD.push(F.start,F.count,k,P)}}let M=fD.list,I=this.customSort;I===null?M.sort(a.transparent?vhe:yhe):I.call(this,M,i);for(let P=0,C=M.length;P<C;P++){let T=M[P];c[E]=T.start*l,p[E]=T.count,x[E]=T.index,E++}fD.reset()}else for(let M=0,I=u.length;M<I;M++)if(u[M].visible&&u[M].active){let P=u[M].geometryIndex,C=!1;if(y&&(this.getMatrixAt(M,_u),this.getBoundingSphereAt(P,Fg).applyMatrix4(_u),C=!dD.intersectsSphere(Fg)),!C){let T=m[P];c[E]=T.start*l,p[E]=T.count,x[E]=M,E++}}v.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,r,i,n,a,o){this.onBeforeRender(e,null,n,a,o)}};s(bhe,"BatchedMesh");var bB=bhe,whe=class extends lg{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new oi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};s(whe,"LineBasicMaterial");var wB=whe,jT=new qe,$T=new qe,Jq=new Ri,Fb=new LA,aE=new Ru,mD=new qe,Qq=new qe,Ahe=class extends Ha{constructor(e=new Vs,r=new wB){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let r=e.attributes.position,i=[0];for(let n=1,a=r.count;n<a;n++)jT.fromBufferAttribute(r,n-1),$T.fromBufferAttribute(r,n),i[n]=i[n-1],i[n]+=jT.distanceTo($T);e.setAttribute("lineDistance",new go(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,r){let i=this.geometry,n=this.matrixWorld,a=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),aE.copy(i.boundingSphere),aE.applyMatrix4(n),aE.radius+=a,e.ray.intersectsSphere(aE)===!1)return;Jq.copy(n).invert(),Fb.copy(e.ray).applyMatrix4(Jq);let l=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=this.isLineSegments?2:1,p=i.index,m=i.attributes.position;if(p!==null){let y=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let x=y,E=v-1;x<E;x+=c){let M=p.getX(x),I=p.getX(x+1),P=p2(this,e,Fb,u,M,I,x);P&&r.push(P)}if(this.isLineLoop){let x=p.getX(v-1),E=p.getX(y),M=p2(this,e,Fb,u,x,E,v-1);M&&r.push(M)}}else{let y=Math.max(0,o.start),v=Math.min(m.count,o.start+o.count);for(let x=y,E=v-1;x<E;x+=c){let M=p2(this,e,Fb,u,x,x+1,x);M&&r.push(M)}if(this.isLineLoop){let x=p2(this,e,Fb,u,v-1,y,v-1);x&&r.push(x)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=i.length;n<a;n++){let o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};s(Ahe,"Line");var She=Ahe;function p2(t,e,r,i,n,a,o){let l=t.geometry.attributes.position;if(jT.fromBufferAttribute(l,n),$T.fromBufferAttribute(l,a),r.distanceSqToSegment(jT,$T,mD,Qq)>i)return;mD.applyMatrix4(t.matrixWorld);let u=e.ray.origin.distanceTo(mD);if(!(u<e.near||u>e.far))return{distance:u,point:Qq.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}s(p2,"checkIntersection");var eW=new qe,tW=new qe,Mhe=class extends She{constructor(e,r){super(e,r),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let r=e.attributes.position,i=[];for(let n=0,a=r.count;n<a;n+=2)eW.fromBufferAttribute(r,n),tW.fromBufferAttribute(r,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+eW.distanceTo(tW);e.setAttribute("lineDistance",new go(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};s(Mhe,"LineSegments");var kP=Mhe,Ehe=class extends She{constructor(e,r){super(e,r),this.isLineLoop=!0,this.type="LineLoop"}};s(Ehe,"LineLoop");var Put=Ehe,Che=class extends lg{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new oi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};s(Che,"PointsMaterial");var NVe=Che,rW=new Ri,lO=new LA,oE=new Ru,sE=new qe,Ihe=class extends Ha{constructor(e=new Vs,r=new NVe){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e,r){return super.copy(e,r),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,r){let i=this.geometry,n=this.matrixWorld,a=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),oE.copy(i.boundingSphere),oE.applyMatrix4(n),oE.radius+=a,e.ray.intersectsSphere(oE)===!1)return;rW.copy(n).invert(),lO.copy(e.ray).applyMatrix4(rW);let l=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=i.index,p=i.attributes.position;if(c!==null){let m=Math.max(0,o.start),y=Math.min(c.count,o.start+o.count);for(let v=m,x=y;v<x;v++){let E=c.getX(v);sE.fromBufferAttribute(p,E),uO(sE,E,u,n,e,r,this)}}else{let m=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let v=m,x=y;v<x;v++)sE.fromBufferAttribute(p,v),uO(sE,v,u,n,e,r,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){let i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=i.length;n<a;n++){let o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};s(Ihe,"Points");var Rut=Ihe;function uO(t,e,r,i,n,a,o){let l=lO.distanceSqToPoint(t);if(l<r){let u=new qe;lO.closestPointToPoint(t,u),u.applyMatrix4(i);let c=n.ray.origin.distanceTo(u);if(c<n.near||c>n.far)return;a.push({distance:c,distanceToRay:Math.sqrt(l),point:u,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}s(uO,"testPoint");var The=class extends Gu{constructor(e,r,i,n,a,o,l,u,c,p,m,y){super(null,o,l,u,c,p,n,a,m,y),this.isCompressedTexture=!0,this.image={width:r,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}};s(The,"CompressedTexture");var kut=The,Phe=class extends Gu{constructor(e,r,i,n,a,o,l,u,c,p=r_){if(p!==r_&&p!==E_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===r_&&(i=Jm),i===void 0&&p===E_&&(i=M_),super(null,n,a,o,l,u,p,i,c),this.isDepthTexture=!0,this.image={width:e,height:r},this.magFilter=l!==void 0?l:_c,this.minFilter=u!==void 0?u:_c,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let r=super.toJSON(e);return this.compareFunction!==null&&(r.compareFunction=this.compareFunction),r}};s(Phe,"DepthTexture");var Lhe=Phe,Dhe=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,r){let i=this.getUtoTmapping(e);return this.getPoint(i,r)}getPoints(e=5){let r=[];for(let i=0;i<=e;i++)r.push(this.getPoint(i/e));return r}getSpacedPoints(e=5){let r=[];for(let i=0;i<=e;i++)r.push(this.getPointAt(i/e));return r}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let r=[],i,n=this.getPoint(0),a=0;r.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),a+=i.distanceTo(n),r.push(a),n=i;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,r){let i=this.getLengths(),n=0,a=i.length,o;r?o=r:o=e*i[a-1];let l=0,u=a-1,c;for(;l<=u;)if(n=Math.floor(l+(u-l)/2),c=i[n]-o,c<0)l=n+1;else if(c>0)u=n-1;else{u=n;break}if(n=u,i[n]===o)return n/(a-1);let p=i[n],m=i[n+1]-p,y=(o-p)/m;return(n+y)/(a-1)}getTangent(e,r){let i=e-1e-4,n=e+1e-4;i<0&&(i=0),n>1&&(n=1);let a=this.getPoint(i),o=this.getPoint(n),l=r||(a.isVector2?new Jt:new qe);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,r){let i=this.getUtoTmapping(e);return this.getTangent(i,r)}computeFrenetFrames(e,r){let i=new qe,n=[],a=[],o=[],l=new qe,u=new Ri;for(let v=0;v<=e;v++){let x=v/e;n[v]=this.getTangentAt(x,new qe)}a[0]=new qe,o[0]=new qe;let c=Number.MAX_VALUE,p=Math.abs(n[0].x),m=Math.abs(n[0].y),y=Math.abs(n[0].z);p<=c&&(c=p,i.set(1,0,0)),m<=c&&(c=m,i.set(0,1,0)),y<=c&&i.set(0,0,1),l.crossVectors(n[0],i).normalize(),a[0].crossVectors(n[0],l),o[0].crossVectors(n[0],a[0]);for(let v=1;v<=e;v++){if(a[v]=a[v-1].clone(),o[v]=o[v-1].clone(),l.crossVectors(n[v-1],n[v]),l.length()>Number.EPSILON){l.normalize();let x=Math.acos(Ki(n[v-1].dot(n[v]),-1,1));a[v].applyMatrix4(u.makeRotationAxis(l,x))}o[v].crossVectors(n[v],a[v])}if(r===!0){let v=Math.acos(Ki(a[0].dot(a[e]),-1,1));v/=e,n[0].dot(l.crossVectors(a[0],a[e]))>0&&(v=-v);for(let x=1;x<=e;x++)a[x].applyMatrix4(u.makeRotationAxis(n[x],v*x)),o[x].crossVectors(n[x],a[x])}return{tangents:n,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};s(Dhe,"Curve");var nd=Dhe,Rhe=class extends nd{constructor(e=0,r=0,i=1,n=1,a=0,o=Math.PI*2,l=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=r,this.xRadius=i,this.yRadius=n,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=l,this.aRotation=u}getPoint(e,r=new Jt){let i=r,n=Math.PI*2,a=this.aEndAngle-this.aStartAngle,o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=n;for(;a>n;)a-=n;a<Number.EPSILON&&(o?a=0:a=n),this.aClockwise===!0&&!o&&(a===n?a=-n:a=a-n);let l=this.aStartAngle+e*a,u=this.aX+this.xRadius*Math.cos(l),c=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){let p=Math.cos(this.aRotation),m=Math.sin(this.aRotation),y=u-this.aX,v=c-this.aY;u=y*p-v*m+this.aX,c=y*m+v*p+this.aY}return i.set(u,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};s(Rhe,"EllipseCurve");var AB=Rhe,Ohe=class extends AB{constructor(e,r,i,n,a,o){super(e,r,i,i,n,a,o),this.isArcCurve=!0,this.type="ArcCurve"}};s(Ohe,"ArcCurve");var FVe=Ohe;function NP(){let t=0,e=0,r=0,i=0;function n(a,o,l,u){t=a,e=l,r=-3*a+3*o-2*l-u,i=2*a-2*o+l+u}return s(n,"init"),{initCatmullRom:s(function(a,o,l,u,c){n(o,l,c*(l-a),c*(u-o))},"initCatmullRom"),initNonuniformCatmullRom:s(function(a,o,l,u,c,p,m){let y=(o-a)/c-(l-a)/(c+p)+(l-o)/p,v=(l-o)/p-(u-o)/(p+m)+(u-l)/m;y*=p,v*=p,n(o,l,y,v)},"initNonuniformCatmullRom"),calc:s(function(a){let o=a*a,l=o*a;return t+e*a+r*o+i*l},"calc")}}s(NP,"CubicPoly");var lE=new qe,gD=new NP,yD=new NP,vD=new NP,khe=class extends nd{constructor(e=[],r=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=r,this.curveType=i,this.tension=n}getPoint(e,r=new qe){let i=r,n=this.points,a=n.length,o=(a-(this.closed?0:1))*e,l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/a)+1)*a:u===0&&l===a-1&&(l=a-2,u=1);let c,p;this.closed||l>0?c=n[(l-1)%a]:(lE.subVectors(n[0],n[1]).add(n[0]),c=lE);let m=n[l%a],y=n[(l+1)%a];if(this.closed||l+2<a?p=n[(l+2)%a]:(lE.subVectors(n[a-1],n[a-2]).add(n[a-1]),p=lE),this.curveType==="centripetal"||this.curveType==="chordal"){let v=this.curveType==="chordal"?.5:.25,x=Math.pow(c.distanceToSquared(m),v),E=Math.pow(m.distanceToSquared(y),v),M=Math.pow(y.distanceToSquared(p),v);E<1e-4&&(E=1),x<1e-4&&(x=E),M<1e-4&&(M=E),gD.initNonuniformCatmullRom(c.x,m.x,y.x,p.x,x,E,M),yD.initNonuniformCatmullRom(c.y,m.y,y.y,p.y,x,E,M),vD.initNonuniformCatmullRom(c.z,m.z,y.z,p.z,x,E,M)}else this.curveType==="catmullrom"&&(gD.initCatmullRom(c.x,m.x,y.x,p.x,this.tension),yD.initCatmullRom(c.y,m.y,y.y,p.y,this.tension),vD.initCatmullRom(c.z,m.z,y.z,p.z,this.tension));return i.set(gD.calc(u),yD.calc(u),vD.calc(u)),i}copy(e){super.copy(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(new qe().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};s(khe,"CatmullRomCurve3");var Nhe=khe;function cO(t,e,r,i,n){let a=(i-e)*.5,o=(n-r)*.5,l=t*t,u=t*l;return(2*r-2*i+a+o)*u+(-3*r+3*i-2*a-o)*l+a*t+r}s(cO,"CatmullRom");function Fhe(t,e){let r=1-t;return r*r*e}s(Fhe,"QuadraticBezierP0");function Bhe(t,e){return 2*(1-t)*t*e}s(Bhe,"QuadraticBezierP1");function zhe(t,e){return t*t*e}s(zhe,"QuadraticBezierP2");function o_(t,e,r,i){return Fhe(t,e)+Bhe(t,r)+zhe(t,i)}s(o_,"QuadraticBezier");function Uhe(t,e){let r=1-t;return r*r*r*e}s(Uhe,"CubicBezierP0");function Vhe(t,e){let r=1-t;return 3*r*r*t*e}s(Vhe,"CubicBezierP1");function jhe(t,e){return 3*(1-t)*t*t*e}s(jhe,"CubicBezierP2");function $he(t,e){return t*t*t*e}s($he,"CubicBezierP3");function s_(t,e,r,i,n){return Uhe(t,e)+Vhe(t,r)+jhe(t,i)+$he(t,n)}s(s_,"CubicBezier");var Ghe=class extends nd{constructor(e=new Jt,r=new Jt,i=new Jt,n=new Jt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=r,this.v2=i,this.v3=n}getPoint(e,r=new Jt){let i=r,n=this.v0,a=this.v1,o=this.v2,l=this.v3;return i.set(s_(e,n.x,a.x,o.x,l.x),s_(e,n.y,a.y,o.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};s(Ghe,"CubicBezierCurve");var Hhe=Ghe,qhe=class extends nd{constructor(e=new qe,r=new qe,i=new qe,n=new qe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=r,this.v2=i,this.v3=n}getPoint(e,r=new qe){let i=r,n=this.v0,a=this.v1,o=this.v2,l=this.v3;return i.set(s_(e,n.x,a.x,o.x,l.x),s_(e,n.y,a.y,o.y,l.y),s_(e,n.z,a.z,o.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};s(qhe,"CubicBezierCurve3");var BVe=qhe,Whe=class extends nd{constructor(e=new Jt,r=new Jt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=r}getPoint(e,r=new Jt){let i=r;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r=new Jt){return r.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,r){return this.getTangent(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Whe,"LineCurve");var Xhe=Whe,Zhe=class extends nd{constructor(e=new qe,r=new qe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=r}getPoint(e,r=new qe){let i=r;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r=new qe){return r.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,r){return this.getTangent(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Zhe,"LineCurve3");var zVe=Zhe,Yhe=class extends nd{constructor(e=new Jt,r=new Jt,i=new Jt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=r,this.v2=i}getPoint(e,r=new Jt){let i=r,n=this.v0,a=this.v1,o=this.v2;return i.set(o_(e,n.x,a.x,o.x),o_(e,n.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Yhe,"QuadraticBezierCurve");var Khe=Yhe,Jhe=class extends nd{constructor(e=new qe,r=new qe,i=new qe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=r,this.v2=i}getPoint(e,r=new qe){let i=r,n=this.v0,a=this.v1,o=this.v2;return i.set(o_(e,n.x,a.x,o.x),o_(e,n.y,a.y,o.y),o_(e,n.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};s(Jhe,"QuadraticBezierCurve3");var Qhe=Jhe,epe=class extends nd{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,r=new Jt){let i=r,n=this.points,a=(n.length-1)*e,o=Math.floor(a),l=a-o,u=n[o===0?o:o-1],c=n[o],p=n[o>n.length-2?n.length-1:o+1],m=n[o>n.length-3?n.length-1:o+2];return i.set(cO(l,u.x,c.x,p.x,m.x),cO(l,u.y,c.y,p.y,m.y)),i}copy(e){super.copy(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,i=e.points.length;r<i;r++){let n=e.points[r];this.points.push(new Jt().fromArray(n))}return this}};s(epe,"SplineCurve");var tpe=epe,GT=Object.freeze({__proto__:null,ArcCurve:FVe,CatmullRomCurve3:Nhe,CubicBezierCurve:Hhe,CubicBezierCurve3:BVe,EllipseCurve:AB,LineCurve:Xhe,LineCurve3:zVe,QuadraticBezierCurve:Khe,QuadraticBezierCurve3:Qhe,SplineCurve:tpe}),rpe=class extends nd{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(r)){let i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new GT[i](r,e))}return this}getPoint(e,r){let i=e*this.getLength(),n=this.getCurveLengths(),a=0;for(;a<n.length;){if(n[a]>=i){let o=n[a]-i,l=this.curves[a],u=l.getLength(),c=u===0?0:1-o/u;return l.getPointAt(c,r)}a++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],r=0;for(let i=0,n=this.curves.length;i<n;i++)r+=this.curves[i].getLength(),e.push(r);return this.cacheLengths=e,e}getSpacedPoints(e=40){let r=[];for(let i=0;i<=e;i++)r.push(this.getPoint(i/e));return this.autoClose&&r.push(r[0]),r}getPoints(e=12){let r=[],i;for(let n=0,a=this.curves;n<a.length;n++){let o=a[n],l=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,u=o.getPoints(l);for(let c=0;c<u.length;c++){let p=u[c];i&&i.equals(p)||(r.push(p),i=p)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let r=0,i=e.curves.length;r<i;r++){let n=e.curves[r];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let r=0,i=this.curves.length;r<i;r++){let n=this.curves[r];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let r=0,i=e.curves.length;r<i;r++){let n=e.curves[r];this.curves.push(new GT[n.type]().fromJSON(n))}return this}};s(rpe,"CurvePath");var UVe=rpe,ipe=class extends UVe{constructor(e){super(),this.type="Path",this.currentPoint=new Jt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let r=1,i=e.length;r<i;r++)this.lineTo(e[r].x,e[r].y);return this}moveTo(e,r){return this.currentPoint.set(e,r),this}lineTo(e,r){let i=new Xhe(this.currentPoint.clone(),new Jt(e,r));return this.curves.push(i),this.currentPoint.set(e,r),this}quadraticCurveTo(e,r,i,n){let a=new Khe(this.currentPoint.clone(),new Jt(e,r),new Jt(i,n));return this.curves.push(a),this.currentPoint.set(i,n),this}bezierCurveTo(e,r,i,n,a,o){let l=new Hhe(this.currentPoint.clone(),new Jt(e,r),new Jt(i,n),new Jt(a,o));return this.curves.push(l),this.currentPoint.set(a,o),this}splineThru(e){let r=[this.currentPoint.clone()].concat(e),i=new tpe(r);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,r,i,n,a,o){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+l,r+u,i,n,a,o),this}absarc(e,r,i,n,a,o){return this.absellipse(e,r,i,i,n,a,o),this}ellipse(e,r,i,n,a,o,l,u){let c=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(e+c,r+p,i,n,a,o,l,u),this}absellipse(e,r,i,n,a,o,l,u){let c=new AB(e,r,i,n,a,o,l,u);if(this.curves.length>0){let m=c.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(c);let p=c.getPoint(1);return this.currentPoint.copy(p),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};s(ipe,"Path");var T_=ipe,npe=class ape extends Vs{constructor(e=1,r=1,i=1,n=32,a=1,o=!1,l=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:r,height:i,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:u};let c=this;n=Math.floor(n),a=Math.floor(a);let p=[],m=[],y=[],v=[],x=0,E=[],M=i/2,I=0;P(),o===!1&&(e>0&&C(!0),r>0&&C(!1)),this.setIndex(p),this.setAttribute("position",new go(m,3)),this.setAttribute("normal",new go(y,3)),this.setAttribute("uv",new go(v,2));function P(){let T=new qe,D=new qe,F=0,k=(r-e)/i;for(let B=0;B<=a;B++){let U=[],z=B/a,q=z*(r-e)+e;for(let Z=0;Z<=n;Z++){let Q=Z/n,V=Q*u+l,ae=Math.sin(V),Y=Math.cos(V);D.x=q*ae,D.y=-z*i+M,D.z=q*Y,m.push(D.x,D.y,D.z),T.set(ae,k,Y).normalize(),y.push(T.x,T.y,T.z),v.push(Q,1-z),U.push(x++)}E.push(U)}for(let B=0;B<n;B++)for(let U=0;U<a;U++){let z=E[U][B],q=E[U+1][B],Z=E[U+1][B+1],Q=E[U][B+1];(e>0||U!==0)&&(p.push(z,q,Q),F+=3),(r>0||U!==a-1)&&(p.push(q,Z,Q),F+=3)}c.addGroup(I,F,0),I+=F}s(P,"generateTorso");function C(T){let D=x,F=new Jt,k=new qe,B=0,U=T===!0?e:r,z=T===!0?1:-1;for(let Z=1;Z<=n;Z++)m.push(0,M*z,0),y.push(0,z,0),v.push(.5,.5),x++;let q=x;for(let Z=0;Z<=n;Z++){let Q=Z/n*u+l,V=Math.cos(Q),ae=Math.sin(Q);k.x=U*ae,k.y=M*z,k.z=U*V,m.push(k.x,k.y,k.z),y.push(0,z,0),F.x=V*.5+.5,F.y=ae*.5*z+.5,v.push(F.x,F.y),x++}for(let Z=0;Z<n;Z++){let Q=D+Z,V=q+Z;T===!0?p.push(V,V+1,Q):p.push(V+1,V,Q),B+=3}c.addGroup(I,B,T===!0?1:2),I+=B}s(C,"generateCap")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ape(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};s(npe,"CylinderGeometry");var hO=npe,uE=new qe,cE=new qe,_D=new qe,hE=new P0,ope=class extends Vs{constructor(e=null,r=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:r},e!==null){let i=Math.pow(10,4),n=Math.cos(i_*r),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,u=[0,0,0],c=["a","b","c"],p=new Array(3),m={},y=[];for(let v=0;v<l;v+=3){a?(u[0]=a.getX(v),u[1]=a.getX(v+1),u[2]=a.getX(v+2)):(u[0]=v,u[1]=v+1,u[2]=v+2);let{a:x,b:E,c:M}=hE;if(x.fromBufferAttribute(o,u[0]),E.fromBufferAttribute(o,u[1]),M.fromBufferAttribute(o,u[2]),hE.getNormal(_D),p[0]="".concat(Math.round(x.x*i),",").concat(Math.round(x.y*i),",").concat(Math.round(x.z*i)),p[1]="".concat(Math.round(E.x*i),",").concat(Math.round(E.y*i),",").concat(Math.round(E.z*i)),p[2]="".concat(Math.round(M.x*i),",").concat(Math.round(M.y*i),",").concat(Math.round(M.z*i)),!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let I=0;I<3;I++){let P=(I+1)%3,C=p[I],T=p[P],D=hE[c[I]],F=hE[c[P]],k="".concat(C,"_").concat(T),B="".concat(T,"_").concat(C);B in m&&m[B]?(_D.dot(m[B].normal)<=n&&(y.push(D.x,D.y,D.z),y.push(F.x,F.y,F.z)),m[B]=null):k in m||(m[k]={index0:u[I],index1:u[P],normal:_D.clone()})}}for(let v in m)if(m[v]){let{index0:x,index1:E}=m[v];uE.fromBufferAttribute(o,x),cE.fromBufferAttribute(o,E),y.push(uE.x,uE.y,uE.z),y.push(cE.x,cE.y,cE.z)}this.setAttribute("position",new go(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};s(ope,"EdgesGeometry");var VVe=ope,spe=class extends T_{constructor(e){super(e),this.uuid=xc(),this.type="Shape",this.holes=[]}getPointsHoles(e){let r=[];for(let i=0,n=this.holes.length;i<n;i++)r[i]=this.holes[i].getPoints(e);return r}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let r=0,i=e.holes.length;r<i;r++){let n=e.holes[r];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let r=0,i=this.holes.length;r<i;r++){let n=this.holes[r];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let r=0,i=e.holes.length;r<i;r++){let n=e.holes[r];this.holes.push(new T_().fromJSON(n))}return this}};s(spe,"Shape");var ox=spe,jVe={triangulate:s(function(t,e,r=2){let i=e&&e.length,n=i?e[0]*r:t.length,a=SB(t,0,n,r,!0),o=[];if(!a||a.next===a.prev)return o;let l,u,c,p,m,y,v;if(i&&(a=ppe(t,e,a,r)),t.length>80*r){l=c=t[0],u=p=t[1];for(let x=r;x<n;x+=r)m=t[x],y=t[x+1],m<l&&(l=m),y<u&&(u=y),m>c&&(c=m),y>p&&(p=y);v=Math.max(c-l,p-u),v=v!==0?32767/v:0}return P_(a,o,r,l,u,v,0),o},"triangulate")};function SB(t,e,r,i,n){let a,o;if(n===Ape(t,e,r,i)>0)for(a=e;a<r;a+=i)o=pO(a,t[a],t[a+1],o);else for(a=r-i;a>=e;a-=i)o=pO(a,t[a],t[a+1],o);return o&&OA(o,o.next)&&(D_(o),o=o.next),o}s(SB,"linkedList");function eg(t,e){if(!t)return t;e||(e=t);let r=t,i;do if(i=!1,!r.steiner&&(OA(r,r.next)||Ja(r.prev,r,r.next)===0)){if(D_(r),r=e=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==e);return e}s(eg,"filterPoints");function P_(t,e,r,i,n,a,o){if(!t)return;!o&&a&&ype(t,i,n,a);let l=t,u,c;for(;t.prev!==t.next;){if(u=t.prev,c=t.next,a?upe(t,i,n,a):lpe(t)){e.push(u.i/r|0),e.push(t.i/r|0),e.push(c.i/r|0),D_(t),t=c.next,l=c.next;continue}if(t=c,t===l){o?o===1?(t=cpe(eg(t),e,r),P_(t,e,r,i,n,a,2)):o===2&&hpe(t,e,r,i,n,a):P_(eg(t),e,r,i,n,a,1);break}}}s(P_,"earcutLinked");function lpe(t){let e=t.prev,r=t,i=t.next;if(Ja(e,r,i)>=0)return!1;let n=e.x,a=r.x,o=i.x,l=e.y,u=r.y,c=i.y,p=n<a?n<o?n:o:a<o?a:o,m=l<u?l<c?l:c:u<c?u:c,y=n>a?n>o?n:o:a>o?a:o,v=l>u?l>c?l:c:u>c?u:c,x=i.next;for(;x!==e;){if(x.x>=p&&x.x<=y&&x.y>=m&&x.y<=v&&Cy(n,l,a,u,o,c,x.x,x.y)&&Ja(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}s(lpe,"isEar");function upe(t,e,r,i){let n=t.prev,a=t,o=t.next;if(Ja(n,a,o)>=0)return!1;let l=n.x,u=a.x,c=o.x,p=n.y,m=a.y,y=o.y,v=l<u?l<c?l:c:u<c?u:c,x=p<m?p<y?p:y:m<y?m:y,E=l>u?l>c?l:c:u>c?u:c,M=p>m?p>y?p:y:m>y?m:y,I=HT(v,x,e,r,i),P=HT(E,M,e,r,i),C=t.prevZ,T=t.nextZ;for(;C&&C.z>=I&&T&&T.z<=P;){if(C.x>=v&&C.x<=E&&C.y>=x&&C.y<=M&&C!==n&&C!==o&&Cy(l,p,u,m,c,y,C.x,C.y)&&Ja(C.prev,C,C.next)>=0||(C=C.prevZ,T.x>=v&&T.x<=E&&T.y>=x&&T.y<=M&&T!==n&&T!==o&&Cy(l,p,u,m,c,y,T.x,T.y)&&Ja(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;C&&C.z>=I;){if(C.x>=v&&C.x<=E&&C.y>=x&&C.y<=M&&C!==n&&C!==o&&Cy(l,p,u,m,c,y,C.x,C.y)&&Ja(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;T&&T.z<=P;){if(T.x>=v&&T.x<=E&&T.y>=x&&T.y<=M&&T!==n&&T!==o&&Cy(l,p,u,m,c,y,T.x,T.y)&&Ja(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}s(upe,"isEarHashed");function cpe(t,e,r){let i=t;do{let n=i.prev,a=i.next.next;!OA(n,a)&&MB(n,i,i.next,a)&&L_(n,a)&&L_(a,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(a.i/r|0),D_(i),D_(i.next),i=t=a),i=i.next}while(i!==t);return eg(i)}s(cpe,"cureLocalIntersections");function hpe(t,e,r,i,n,a){let o=t;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&xpe(o,l)){let u=EB(o,l);o=eg(o,o.next),u=eg(u,u.next),P_(o,e,r,i,n,a,0),P_(u,e,r,i,n,a,0);return}l=l.next}o=o.next}while(o!==t)}s(hpe,"splitEarcut");function ppe(t,e,r,i){let n=[],a,o,l,u,c;for(a=0,o=e.length;a<o;a++)l=e[a]*i,u=a<o-1?e[a+1]*i:t.length,c=SB(t,l,u,i,!1),c===c.next&&(c.steiner=!0),n.push(_pe(c));for(n.sort(dpe),a=0;a<n.length;a++)r=fpe(n[a],r);return r}s(ppe,"eliminateHoles");function dpe(t,e){return t.x-e.x}s(dpe,"compareX");function fpe(t,e){let r=mpe(t,e);if(!r)return e;let i=EB(r,t);return eg(i,i.next),eg(r,r.next)}s(fpe,"eliminateHole");function mpe(t,e){let r=e,i=-1/0,n,a=t.x,o=t.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let y=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(y<=a&&y>i&&(i=y,n=r.x<r.next.x?r:r.next,y===a))return n}r=r.next}while(r!==e);if(!n)return null;let l=n,u=n.x,c=n.y,p=1/0,m;r=n;do a>=r.x&&r.x>=u&&a!==r.x&&Cy(o<c?a:i,o,u,c,o<c?i:a,o,r.x,r.y)&&(m=Math.abs(o-r.y)/(a-r.x),L_(r,t)&&(m<p||m===p&&(r.x>n.x||r.x===n.x&&gpe(n,r)))&&(n=r,p=m)),r=r.next;while(r!==l);return n}s(mpe,"findHoleBridge");function gpe(t,e){return Ja(t.prev,t,e.prev)<0&&Ja(e.next,t,t.next)<0}s(gpe,"sectorContainsSector");function ype(t,e,r,i){let n=t;do n.z===0&&(n.z=HT(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,vpe(n)}s(ype,"indexCurve");function vpe(t){let e,r,i,n,a,o,l,u,c=1;do{for(r=t,t=null,a=null,o=0;r;){for(o++,i=r,l=0,e=0;e<c&&(l++,i=i.nextZ,!!i);e++);for(u=c;l>0||u>0&&i;)l!==0&&(u===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,l--):(n=i,i=i.nextZ,u--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;r=i}a.nextZ=null,c*=2}while(o>1);return t}s(vpe,"sortLinked");function HT(t,e,r,i,n){return t=(t-r)*n|0,e=(e-i)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}s(HT,"zOrder");function _pe(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}s(_pe,"getLeftmost");function Cy(t,e,r,i,n,a,o,l){return(n-o)*(e-l)>=(t-o)*(a-l)&&(t-o)*(i-l)>=(r-o)*(e-l)&&(r-o)*(a-l)>=(n-o)*(i-l)}s(Cy,"pointInTriangle");function xpe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!bpe(t,e)&&(L_(t,e)&&L_(e,t)&&wpe(t,e)&&(Ja(t.prev,t,e.prev)||Ja(t,e.prev,e))||OA(t,e)&&Ja(t.prev,t,t.next)>0&&Ja(e.prev,e,e.next)>0)}s(xpe,"isValidDiagonal");function Ja(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}s(Ja,"area");function OA(t,e){return t.x===e.x&&t.y===e.y}s(OA,"equals");function MB(t,e,r,i){let n=f2(Ja(t,e,r)),a=f2(Ja(t,e,i)),o=f2(Ja(r,i,t)),l=f2(Ja(r,i,e));return!!(n!==a&&o!==l||n===0&&d2(t,r,e)||a===0&&d2(t,i,e)||o===0&&d2(r,t,i)||l===0&&d2(r,e,i))}s(MB,"intersects");function d2(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}s(d2,"onSegment");function f2(t){return t>0?1:t<0?-1:0}s(f2,"sign");function bpe(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&MB(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}s(bpe,"intersectsPolygon");function L_(t,e){return Ja(t.prev,t,t.next)<0?Ja(t,e,t.next)>=0&&Ja(t,t.prev,e)>=0:Ja(t,e,t.prev)<0||Ja(t,t.next,e)<0}s(L_,"locallyInside");function wpe(t,e){let r=t,i=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i}s(wpe,"middleInside");function EB(t,e){let r=new qT(t.i,t.x,t.y),i=new qT(e.i,e.x,e.y),n=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}s(EB,"splitPolygon");function pO(t,e,r,i){let n=new qT(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}s(pO,"insertNode");function D_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}s(D_,"removeNode");function qT(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}s(qT,"Node");function Ape(t,e,r,i){let n=0;for(let a=e,o=r-i;a<r;a+=i)n+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return n}s(Ape,"signedArea");var Spe=class Mpe{static area(e){let r=e.length,i=0;for(let n=r-1,a=0;a<r;n=a++)i+=e[n].x*e[a].y-e[a].x*e[n].y;return i*.5}static isClockWise(e){return Mpe.area(e)<0}static triangulateShape(e,r){let i=[],n=[],a=[];dO(e),fO(i,e);let o=e.length;r.forEach(dO);for(let u=0;u<r.length;u++)n.push(o),o+=r[u].length,fO(i,r[u]);let l=jVe.triangulate(i,n);for(let u=0;u<l.length;u+=3)a.push(l.slice(u,u+3));return a}};s(Spe,"ShapeUtils");var xD=Spe;function dO(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}s(dO,"removeDupEndPts");function fO(t,e){for(let r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}s(fO,"addContour");var Epe=class Cpe extends Vs{constructor(e=new ox([new Jt(.5,.5),new Jt(-.5,.5),new Jt(-.5,-.5),new Jt(.5,-.5)]),r={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];let i=this,n=[],a=[];for(let l=0,u=e.length;l<u;l++){let c=e[l];o(c)}this.setAttribute("position",new go(n,3)),this.setAttribute("uv",new go(a,2)),this.computeVertexNormals();function o(l){let u=[],c=r.curveSegments!==void 0?r.curveSegments:12,p=r.steps!==void 0?r.steps:1,m=r.depth!==void 0?r.depth:1,y=r.bevelEnabled!==void 0?r.bevelEnabled:!0,v=r.bevelThickness!==void 0?r.bevelThickness:.2,x=r.bevelSize!==void 0?r.bevelSize:v-.1,E=r.bevelOffset!==void 0?r.bevelOffset:0,M=r.bevelSegments!==void 0?r.bevelSegments:3,I=r.extrudePath,P=r.UVGenerator!==void 0?r.UVGenerator:$Ve,C,T=!1,D,F,k,B;I&&(C=I.getSpacedPoints(p),T=!0,y=!1,D=I.computeFrenetFrames(p,!1),F=new qe,k=new qe,B=new qe),y||(M=0,v=0,x=0,E=0);let U=l.extractPoints(c),z=U.shape,q=U.holes;if(!xD.isClockWise(z)){z=z.reverse();for(let me=0,Ae=q.length;me<Ae;me++){let Ue=q[me];xD.isClockWise(Ue)&&(q[me]=Ue.reverse())}}let Z=xD.triangulateShape(z,q),Q=z;for(let me=0,Ae=q.length;me<Ae;me++){let Ue=q[me];z=z.concat(Ue)}function V(me,Ae,Ue){return Ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),me.clone().addScaledVector(Ae,Ue)}s(V,"scalePt2");let ae=z.length,Y=Z.length;function he(me,Ae,Ue){let _e,lt,tt,We=me.x-Ae.x,at=me.y-Ae.y,Lt=Ue.x-me.x,dt=Ue.y-me.y,Me=We*We+at*at,ve=We*dt-at*Lt;if(Math.abs(ve)>Number.EPSILON){let Ze=Math.sqrt(Me),It=Math.sqrt(Lt*Lt+dt*dt),Rt=Ae.x-at/Ze,Et=Ae.y+We/Ze,pt=Ue.x-dt/It,Yt=Ue.y+Lt/It,Kt=((pt-Rt)*dt-(Yt-Et)*Lt)/(We*dt-at*Lt);_e=Rt+We*Kt-me.x,lt=Et+at*Kt-me.y;let $t=_e*_e+lt*lt;if($t<=2)return new Jt(_e,lt);tt=Math.sqrt($t/2)}else{let Ze=!1;We>Number.EPSILON?Lt>Number.EPSILON&&(Ze=!0):We<-Number.EPSILON?Lt<-Number.EPSILON&&(Ze=!0):Math.sign(at)===Math.sign(dt)&&(Ze=!0),Ze?(_e=-at,lt=We,tt=Math.sqrt(Me)):(_e=We,lt=at,tt=Math.sqrt(Me/2))}return new Jt(_e/tt,lt/tt)}s(he,"getBevelVec");let J=[];for(let me=0,Ae=Q.length,Ue=Ae-1,_e=me+1;me<Ae;me++,Ue++,_e++)Ue===Ae&&(Ue=0),_e===Ae&&(_e=0),J[me]=he(Q[me],Q[Ue],Q[_e]);let ne=[],ee,ue=J.concat();for(let me=0,Ae=q.length;me<Ae;me++){let Ue=q[me];ee=[];for(let _e=0,lt=Ue.length,tt=lt-1,We=_e+1;_e<lt;_e++,tt++,We++)tt===lt&&(tt=0),We===lt&&(We=0),ee[_e]=he(Ue[_e],Ue[tt],Ue[We]);ne.push(ee),ue=ue.concat(ee)}for(let me=0;me<M;me++){let Ae=me/M,Ue=v*Math.cos(Ae*Math.PI/2),_e=x*Math.sin(Ae*Math.PI/2)+E;for(let lt=0,tt=Q.length;lt<tt;lt++){let We=V(Q[lt],J[lt],_e);de(We.x,We.y,-Ue)}for(let lt=0,tt=q.length;lt<tt;lt++){let We=q[lt];ee=ne[lt];for(let at=0,Lt=We.length;at<Lt;at++){let dt=V(We[at],ee[at],_e);de(dt.x,dt.y,-Ue)}}}let K=x+E;for(let me=0;me<ae;me++){let Ae=y?V(z[me],ue[me],K):z[me];T?(k.copy(D.normals[0]).multiplyScalar(Ae.x),F.copy(D.binormals[0]).multiplyScalar(Ae.y),B.copy(C[0]).add(k).add(F),de(B.x,B.y,B.z)):de(Ae.x,Ae.y,0)}for(let me=1;me<=p;me++)for(let Ae=0;Ae<ae;Ae++){let Ue=y?V(z[Ae],ue[Ae],K):z[Ae];T?(k.copy(D.normals[me]).multiplyScalar(Ue.x),F.copy(D.binormals[me]).multiplyScalar(Ue.y),B.copy(C[me]).add(k).add(F),de(B.x,B.y,B.z)):de(Ue.x,Ue.y,m/p*me)}for(let me=M-1;me>=0;me--){let Ae=me/M,Ue=v*Math.cos(Ae*Math.PI/2),_e=x*Math.sin(Ae*Math.PI/2)+E;for(let lt=0,tt=Q.length;lt<tt;lt++){let We=V(Q[lt],J[lt],_e);de(We.x,We.y,m+Ue)}for(let lt=0,tt=q.length;lt<tt;lt++){let We=q[lt];ee=ne[lt];for(let at=0,Lt=We.length;at<Lt;at++){let dt=V(We[at],ee[at],_e);T?de(dt.x,dt.y+C[p-1].y,C[p-1].x+Ue):de(dt.x,dt.y,m+Ue)}}}ce(),re();function ce(){let me=n.length/3;if(y){let Ae=0,Ue=ae*Ae;for(let _e=0;_e<Y;_e++){let lt=Z[_e];we(lt[2]+Ue,lt[1]+Ue,lt[0]+Ue)}Ae=p+M*2,Ue=ae*Ae;for(let _e=0;_e<Y;_e++){let lt=Z[_e];we(lt[0]+Ue,lt[1]+Ue,lt[2]+Ue)}}else{for(let Ae=0;Ae<Y;Ae++){let Ue=Z[Ae];we(Ue[2],Ue[1],Ue[0])}for(let Ae=0;Ae<Y;Ae++){let Ue=Z[Ae];we(Ue[0]+ae*p,Ue[1]+ae*p,Ue[2]+ae*p)}}i.addGroup(me,n.length/3-me,0)}s(ce,"buildLidFaces");function re(){let me=n.length/3,Ae=0;se(Q,Ae),Ae+=Q.length;for(let Ue=0,_e=q.length;Ue<_e;Ue++){let lt=q[Ue];se(lt,Ae),Ae+=lt.length}i.addGroup(me,n.length/3-me,1)}s(re,"buildSideFaces");function se(me,Ae){let Ue=me.length;for(;--Ue>=0;){let _e=Ue,lt=Ue-1;lt<0&&(lt=me.length-1);for(let tt=0,We=p+M*2;tt<We;tt++){let at=ae*tt,Lt=ae*(tt+1),dt=Ae+_e+at,Me=Ae+lt+at,ve=Ae+lt+Lt,Ze=Ae+_e+Lt;Le(dt,Me,ve,Ze)}}}s(se,"sidewalls");function de(me,Ae,Ue){u.push(me),u.push(Ae),u.push(Ue)}s(de,"v");function we(me,Ae,Ue){fe(me),fe(Ae),fe(Ue);let _e=n.length/3,lt=P.generateTopUV(i,n,_e-3,_e-2,_e-1);Re(lt[0]),Re(lt[1]),Re(lt[2])}s(we,"f3");function Le(me,Ae,Ue,_e){fe(me),fe(Ae),fe(_e),fe(Ae),fe(Ue),fe(_e);let lt=n.length/3,tt=P.generateSideWallUV(i,n,lt-6,lt-3,lt-2,lt-1);Re(tt[0]),Re(tt[1]),Re(tt[3]),Re(tt[1]),Re(tt[2]),Re(tt[3])}s(Le,"f4");function fe(me){n.push(u[me*3+0]),n.push(u[me*3+1]),n.push(u[me*3+2])}s(fe,"addVertex");function Re(me){a.push(me.x),a.push(me.y)}s(Re,"addUV")}s(o,"addShape")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),r=this.parameters.shapes,i=this.parameters.options;return Ipe(r,i,e)}static fromJSON(e,r){let i=[];for(let a=0,o=e.shapes.length;a<o;a++){let l=r[e.shapes[a]];i.push(l)}let n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new GT[n.type]().fromJSON(n)),new Cpe(i,e.options)}};s(Epe,"ExtrudeGeometry");var kA=Epe,$Ve={generateTopUV:s(function(t,e,r,i,n){let a=e[r*3],o=e[r*3+1],l=e[i*3],u=e[i*3+1],c=e[n*3],p=e[n*3+1];return[new Jt(a,o),new Jt(l,u),new Jt(c,p)]},"generateTopUV"),generateSideWallUV:s(function(t,e,r,i,n,a){let o=e[r*3],l=e[r*3+1],u=e[r*3+2],c=e[i*3],p=e[i*3+1],m=e[i*3+2],y=e[n*3],v=e[n*3+1],x=e[n*3+2],E=e[a*3],M=e[a*3+1],I=e[a*3+2];return Math.abs(l-p)<Math.abs(o-c)?[new Jt(o,1-u),new Jt(c,1-m),new Jt(y,1-x),new Jt(E,1-I)]:[new Jt(l,1-u),new Jt(p,1-m),new Jt(v,1-x),new Jt(M,1-I)]},"generateSideWallUV")};function Ipe(t,e,r){if(r.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){let a=t[i];r.shapes.push(a.uuid)}else r.shapes.push(t.uuid);return r.options=Object.assign({},e),e.extrudePath!==void 0&&(r.options.extrudePath=e.extrudePath.toJSON()),r}s(Ipe,"toJSON$1");var Tpe=class Ppe extends Vs{constructor(e=1,r=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:r,widthSegments:i,heightSegments:n};let a=e/2,o=r/2,l=Math.floor(i),u=Math.floor(n),c=l+1,p=u+1,m=e/l,y=r/u,v=[],x=[],E=[],M=[];for(let I=0;I<p;I++){let P=I*y-o;for(let C=0;C<c;C++){let T=C*m-a;x.push(T,-P,0),E.push(0,0,1),M.push(C/l),M.push(1-I/u)}}for(let I=0;I<u;I++)for(let P=0;P<l;P++){let C=P+c*I,T=P+c*(I+1),D=P+1+c*(I+1),F=P+1+c*I;v.push(C,T,F),v.push(T,D,F)}this.setIndex(v),this.setAttribute("position",new go(x,3)),this.setAttribute("normal",new go(E,3)),this.setAttribute("uv",new go(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ppe(e.width,e.height,e.widthSegments,e.heightSegments)}};s(Tpe,"PlaneGeometry");var pv=Tpe,GVe=class Lpe extends Vs{constructor(e=1,r=32,i=16,n=0,a=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:r,heightSegments:i,phiStart:n,phiLength:a,thetaStart:o,thetaLength:l},r=Math.max(3,Math.floor(r)),i=Math.max(2,Math.floor(i));let u=Math.min(o+l,Math.PI),c=0,p=[],m=new qe,y=new qe,v=[],x=[],E=[],M=[];for(let I=0;I<=i;I++){let P=[],C=I/i,T=0;I===0&&o===0?T=.5/r:I===i&&u===Math.PI&&(T=-.5/r);for(let D=0;D<=r;D++){let F=D/r;m.x=-e*Math.cos(n+F*a)*Math.sin(o+C*l),m.y=e*Math.cos(o+C*l),m.z=e*Math.sin(n+F*a)*Math.sin(o+C*l),x.push(m.x,m.y,m.z),y.copy(m).normalize(),E.push(y.x,y.y,y.z),M.push(F+T,1-C),P.push(c++)}p.push(P)}for(let I=0;I<i;I++)for(let P=0;P<r;P++){let C=p[I][P+1],T=p[I][P],D=p[I+1][P],F=p[I+1][P+1];(I!==0||o>0)&&v.push(C,T,F),(I!==i-1||u<Math.PI)&&v.push(T,D,F)}this.setIndex(v),this.setAttribute("position",new go(x,3)),this.setAttribute("normal",new go(E,3)),this.setAttribute("uv",new go(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lpe(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};s(GVe,"SphereGeometry");var Dpe=class Rpe extends Vs{constructor(e=new Qhe(new qe(-1,-1,0),new qe(-1,1,0),new qe(1,1,0)),r=64,i=1,n=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:r,radius:i,radialSegments:n,closed:a};let o=e.computeFrenetFrames(r,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let l=new qe,u=new qe,c=new Jt,p=new qe,m=[],y=[],v=[],x=[];E(),this.setIndex(x),this.setAttribute("position",new go(m,3)),this.setAttribute("normal",new go(y,3)),this.setAttribute("uv",new go(v,2));function E(){for(let C=0;C<r;C++)M(C);M(a===!1?r:0),P(),I()}s(E,"generateBufferData");function M(C){p=e.getPointAt(C/r,p);let T=o.normals[C],D=o.binormals[C];for(let F=0;F<=n;F++){let k=F/n*Math.PI*2,B=Math.sin(k),U=-Math.cos(k);u.x=U*T.x+B*D.x,u.y=U*T.y+B*D.y,u.z=U*T.z+B*D.z,u.normalize(),y.push(u.x,u.y,u.z),l.x=p.x+i*u.x,l.y=p.y+i*u.y,l.z=p.z+i*u.z,m.push(l.x,l.y,l.z)}}s(M,"generateSegment");function I(){for(let C=1;C<=r;C++)for(let T=1;T<=n;T++){let D=(n+1)*(C-1)+(T-1),F=(n+1)*C+(T-1),k=(n+1)*C+T,B=(n+1)*(C-1)+T;x.push(D,F,B),x.push(F,k,B)}}s(I,"generateIndices");function P(){for(let C=0;C<=r;C++)for(let T=0;T<=n;T++)c.x=C/r,c.y=T/n,v.push(c.x,c.y)}s(P,"generateUVs")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Rpe(new GT[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};s(Dpe,"TubeGeometry");var HVe=Dpe,Ope=class extends lg{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new oi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mB,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nu,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};s(Ope,"MeshStandardMaterial");var kpe=Ope,Npe=class extends kpe{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Jt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:s(function(){return Ki(2.5*(this.ior-1)/(this.ior+1),0,1)},"get"),set:s(function(r){this.ior=(1+.4*r)/(1-.4*r)},"set")}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new oi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new oi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new oi(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};s(Npe,"MeshPhysicalMaterial");var ect=Npe,Fpe=class extends lg{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new oi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mB,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nu,this.combine=lB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};s(Fpe,"MeshLambertMaterial");var R_=Fpe,Bpe=class extends lg{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ZUe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};s(Bpe,"MeshDepthMaterial");var qVe=Bpe,zpe=class extends lg{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};s(zpe,"MeshDistanceMaterial");var WVe=zpe;function m2(t,e,r){return!t||!r&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}s(m2,"convertArray");function Upe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}s(Upe,"isTypedArray");function Vpe(t){function e(n,a){return t[n]-t[a]}s(e,"compareTime");let r=t.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(e),i}s(Vpe,"getKeyframeOrder");function mO(t,e,r){let i=t.length,n=new t.constructor(i);for(let a=0,o=0;o!==i;++a){let l=r[a]*e;for(let u=0;u!==e;++u)n[o++]=t[l+u]}return n}s(mO,"sortedArray");function CB(t,e,r,i){let n=1,a=t[0];for(;a!==void 0&&a[i]===void 0;)a=t[n++];if(a===void 0)return;let o=a[i];if(o!==void 0)if(Array.isArray(o))do o=a[i],o!==void 0&&(e.push(a.time),r.push.apply(r,o)),a=t[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[i],o!==void 0&&(e.push(a.time),o.toArray(r,r.length)),a=t[n++];while(a!==void 0);else do o=a[i],o!==void 0&&(e.push(a.time),r.push(o)),a=t[n++];while(a!==void 0)}s(CB,"flattenJSON");var jpe=class{constructor(e,r,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new r.constructor(i),this.sampleValues=r,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let r=this.parameterPositions,i=this._cachedIndex,n=r[i],a=r[i-1];e:{t:{let o;r:{i:if(!(e<n)){for(let l=i+2;;){if(n===void 0){if(e<a)break i;return i=r.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(a=n,n=r[++i],e<n)break t}o=r.length;break r}if(!(e>=a)){let l=r[1];e<l&&(i=2,a=l);for(let u=i-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===u)break;if(n=a,a=r[--i-1],e>=a)break t}o=i,i=0;break r}break e}for(;i<o;){let l=i+o>>>1;e<r[l]?o=l:i=l+1}if(n=r[i],a=r[i-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=r.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,a,n)}return this.interpolate_(i,a,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let r=this.resultBuffer,i=this.sampleValues,n=this.valueSize,a=e*n;for(let o=0;o!==n;++o)r[o]=i[a+o];return r}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};s(jpe,"Interpolant");var FP=jpe,$pe=class extends FP{constructor(e,r,i,n){super(e,r,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:xq,endingEnd:xq}}intervalChanged_(e,r,i){let n=this.parameterPositions,a=e-2,o=e+1,l=n[a],u=n[o];if(l===void 0)switch(this.getSettings_().endingStart){case bq:a=e,l=2*r-i;break;case wq:a=n.length-2,l=r+n[a]-n[a+1];break;default:a=e,l=i}if(u===void 0)switch(this.getSettings_().endingEnd){case bq:o=e,u=2*i-r;break;case wq:o=1,u=i+n[1]-n[0];break;default:o=e-1,u=r}let c=(i-r)*.5,p=this.valueSize;this._weightPrev=c/(r-l),this._weightNext=c/(u-i),this._offsetPrev=a*p,this._offsetNext=o*p}interpolate_(e,r,i,n){let a=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,c=u-l,p=this._offsetPrev,m=this._offsetNext,y=this._weightPrev,v=this._weightNext,x=(i-r)/(n-r),E=x*x,M=E*x,I=-y*M+2*y*E-y*x,P=(1+y)*M+(-1.5-2*y)*E+(-.5+y)*x+1,C=(-1-v)*M+(1.5+v)*E+.5*x,T=v*M-v*E;for(let D=0;D!==l;++D)a[D]=I*o[p+D]+P*o[c+D]+C*o[u+D]+T*o[m+D];return a}};s($pe,"CubicInterpolant");var XVe=$pe,Gpe=class extends FP{constructor(e,r,i,n){super(e,r,i,n)}interpolate_(e,r,i,n){let a=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,c=u-l,p=(i-r)/(n-r),m=1-p;for(let y=0;y!==l;++y)a[y]=o[c+y]*m+o[u+y]*p;return a}};s(Gpe,"LinearInterpolant");var ZVe=Gpe,Hpe=class extends FP{constructor(e,r,i,n){super(e,r,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}};s(Hpe,"DiscreteInterpolant");var YVe=Hpe,qpe=class{constructor(e,r,i,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=m2(r,this.TimeBufferType),this.values=m2(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let r=e.constructor,i;if(r.toJSON!==this.toJSON)i=r.toJSON(e);else{i={name:e.name,times:m2(e.times,Array),values:m2(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(i.interpolation=n)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new YVe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ZVe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new XVe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let r;switch(e){case BT:r=this.InterpolantFactoryMethodDiscrete;break;case iO:r=this.InterpolantFactoryMethodLinear;break;case HL:r=this.InterpolantFactoryMethodSmooth;break}if(r===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=r,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return BT;case this.InterpolantFactoryMethodLinear:return iO;case this.InterpolantFactoryMethodSmooth:return HL}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let r=this.times;for(let i=0,n=r.length;i!==n;++i)r[i]+=e}return this}scale(e){if(e!==1){let r=this.times;for(let i=0,n=r.length;i!==n;++i)r[i]*=e}return this}trim(e,r){let i=this.times,n=i.length,a=0,o=n-1;for(;a!==n&&i[a]<e;)++a;for(;o!==-1&&i[o]>r;)--o;if(++o,a!==0||o!==n){a>=o&&(o=Math.max(o,1),a=o-1);let l=this.getValueSize();this.times=i.slice(a,o),this.values=this.values.slice(a*l,o*l)}return this}validate(){let e=!0,r=this.getValueSize();r-Math.floor(r)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,n=this.values,a=i.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==a;l++){let u=i[l];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(o!==null&&o>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,o),e=!1;break}o=u}if(n!==void 0&&Upe(n))for(let l=0,u=n.length;l!==u;++l){let c=n[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}optimize(){let e=this.times.slice(),r=this.values.slice(),i=this.getValueSize(),n=this.getInterpolation()===HL,a=e.length-1,o=1;for(let l=1;l<a;++l){let u=!1,c=e[l],p=e[l+1];if(c!==p&&(l!==1||c!==e[0]))if(n)u=!0;else{let m=l*i,y=m-i,v=m+i;for(let x=0;x!==i;++x){let E=r[m+x];if(E!==r[y+x]||E!==r[v+x]){u=!0;break}}}if(u){if(l!==o){e[o]=e[l];let m=l*i,y=o*i;for(let v=0;v!==i;++v)r[y+v]=r[m+v]}++o}}if(a>0){e[o]=e[a];for(let l=a*i,u=o*i,c=0;c!==i;++c)r[u+c]=r[l+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=r.slice(0,o*i)):(this.times=e,this.values=r),this}clone(){let e=this.times.slice(),r=this.values.slice(),i=this.constructor,n=new i(this.name,e,r);return n.createInterpolant=this.createInterpolant,n}};s(qpe,"KeyframeTrack");var ad=qpe;ad.prototype.TimeBufferType=Float32Array;ad.prototype.ValueBufferType=Float32Array;ad.prototype.DefaultInterpolation=iO;var Wpe=class extends ad{constructor(e,r,i){super(e,r,i)}};s(Wpe,"BooleanKeyframeTrack");var sx=Wpe;sx.prototype.ValueTypeName="bool";sx.prototype.ValueBufferType=Array;sx.prototype.DefaultInterpolation=BT;sx.prototype.InterpolantFactoryMethodLinear=void 0;sx.prototype.InterpolantFactoryMethodSmooth=void 0;var Xpe=class extends ad{};s(Xpe,"ColorKeyframeTrack");var Zpe=Xpe;Zpe.prototype.ValueTypeName="color";var Ype=class extends ad{};s(Ype,"NumberKeyframeTrack");var WT=Ype;WT.prototype.ValueTypeName="number";var Kpe=class extends FP{constructor(e,r,i,n){super(e,r,i,n)}interpolate_(e,r,i,n){let a=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=(i-r)/(n-r),c=e*l;for(let p=c+l;c!==p;c+=4)ff.slerpFlat(a,0,o,c-l,o,c,u);return a}};s(Kpe,"QuaternionLinearInterpolant");var KVe=Kpe,Jpe=class extends ad{InterpolantFactoryMethodLinear(e){return new KVe(this.times,this.values,this.getValueSize(),e)}};s(Jpe,"QuaternionKeyframeTrack");var BP=Jpe;BP.prototype.ValueTypeName="quaternion";BP.prototype.InterpolantFactoryMethodSmooth=void 0;var Qpe=class extends ad{constructor(e,r,i){super(e,r,i)}};s(Qpe,"StringKeyframeTrack");var lx=Qpe;lx.prototype.ValueTypeName="string";lx.prototype.ValueBufferType=Array;lx.prototype.DefaultInterpolation=BT;lx.prototype.InterpolantFactoryMethodLinear=void 0;lx.prototype.InterpolantFactoryMethodSmooth=void 0;var ede=class extends ad{};s(ede,"VectorKeyframeTrack");var XT=ede;XT.prototype.ValueTypeName="vector";var tde=class{constructor(e="",r=-1,i=[],n=qUe){this.name=e,this.tracks=i,this.duration=r,this.blendMode=n,this.uuid=xc(),this.duration<0&&this.resetDuration()}static parse(e){let r=[],i=e.tracks,n=1/(e.fps||1);for(let o=0,l=i.length;o!==l;++o)r.push(ide(i[o]).scale(n));let a=new this(e.name,e.duration,r,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){let r=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:r,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,o=i.length;a!==o;++a)r.push(ad.toJSON(i[a]));return n}static CreateFromMorphTargetSequence(e,r,i,n){let a=r.length,o=[];for(let l=0;l<a;l++){let u=[],c=[];u.push((l+a-1)%a,l,(l+1)%a),c.push(0,1,0);let p=Vpe(u);u=mO(u,1,p),c=mO(c,1,p),!n&&u[0]===0&&(u.push(a),c.push(c[0])),o.push(new WT(".morphTargetInfluences["+r[l].name+"]",u,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,r){let i=e;if(!Array.isArray(e)){let n=e;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===r)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,r,i){let n={},a=/^([\w-]*?)([\d]+)$/;for(let l=0,u=e.length;l<u;l++){let c=e[l],p=c.name.match(a);if(p&&p.length>1){let m=p[1],y=n[m];y||(n[m]=y=[]),y.push(c)}}let o=[];for(let l in n)o.push(this.CreateFromMorphTargetSequence(l,n[l],r,i));return o}static parseAnimation(e,r){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=s(function(p,m,y,v,x){if(y.length!==0){let E=[],M=[];CB(y,E,M,v),E.length!==0&&x.push(new p(m,E,M))}},"addNonemptyTrack"),n=[],a=e.name||"default",o=e.fps||30,l=e.blendMode,u=e.length||-1,c=e.hierarchy||[];for(let p=0;p<c.length;p++){let m=c[p].keys;if(!(!m||m.length===0))if(m[0].morphTargets){let y={},v;for(v=0;v<m.length;v++)if(m[v].morphTargets)for(let x=0;x<m[v].morphTargets.length;x++)y[m[v].morphTargets[x]]=-1;for(let x in y){let E=[],M=[];for(let I=0;I!==m[v].morphTargets.length;++I){let P=m[v];E.push(P.time),M.push(P.morphTarget===x?1:0)}n.push(new WT(".morphTargetInfluence["+x+"]",E,M))}u=y.length*o}else{let y=".bones["+r[p].name+"]";i(XT,y+".position",m,"pos",n),i(BP,y+".quaternion",m,"rot",n),i(XT,y+".scale",m,"scl",n)}}return n.length===0?null:new this(a,u,n,l)}resetDuration(){let e=this.tracks,r=0;for(let i=0,n=e.length;i!==n;++i){let a=this.tracks[i];r=Math.max(r,a.times[a.times.length-1])}return this.duration=r,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let r=0;r<this.tracks.length;r++)e=e&&this.tracks[r].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let r=0;r<this.tracks.length;r++)e.push(this.tracks[r].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};s(tde,"AnimationClip");var yct=tde;function rde(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return WT;case"vector":case"vector2":case"vector3":case"vector4":return XT;case"color":return Zpe;case"quaternion":return BP;case"bool":case"boolean":return sx;case"string":return lx}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}s(rde,"getTrackTypeForValueTypeName");function ide(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=rde(t.type);if(t.times===void 0){let r=[],i=[];CB(t.keys,r,i,"value"),t.times=r,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}s(ide,"parseKeyframeTrack");var Vm={enabled:!1,files:{},add:s(function(t,e){this.enabled!==!1&&(this.files[t]=e)},"add"),get:s(function(t){if(this.enabled!==!1)return this.files[t]},"get"),remove:s(function(t){delete this.files[t]},"remove"),clear:s(function(){this.files={}},"clear")},nde=class{constructor(e,r,i){let n=this,a=!1,o=0,l=0,u,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=r,this.onError=i,this.itemStart=function(p){l++,a===!1&&n.onStart!==void 0&&n.onStart(p,o,l),a=!0},this.itemEnd=function(p){o++,n.onProgress!==void 0&&n.onProgress(p,o,l),o===l&&(a=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(p){n.onError!==void 0&&n.onError(p)},this.resolveURL=function(p){return u?u(p):p},this.setURLModifier=function(p){return u=p,this},this.addHandler=function(p,m){return c.push(p,m),this},this.removeHandler=function(p){let m=c.indexOf(p);return m!==-1&&c.splice(m,2),this},this.getHandler=function(p){for(let m=0,y=c.length;m<y;m+=2){let v=c[m],x=c[m+1];if(v.global&&(v.lastIndex=0),v.test(p))return x}return null}}};s(nde,"LoadingManager");var JVe=nde,QVe=new JVe,ade=class{constructor(e){this.manager=e!==void 0?e:QVe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,r){let i=this;return new Promise(function(n,a){i.load(e,n,r,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};s(ade,"Loader");var NA=ade;NA.DEFAULT_MATERIAL_NAME="__DEFAULT";var Pd={},ode=class extends Error{constructor(e,r){super(e),this.response=r}};s(ode,"HttpError");var eje=ode,sde=class extends NA{constructor(e){super(e)}load(e,r,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=Vm.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{r&&r(a),this.manager.itemEnd(e)},0),a;if(Pd[e]!==void 0){Pd[e].push({onLoad:r,onProgress:i,onError:n});return}Pd[e]=[],Pd[e].push({onLoad:r,onProgress:i,onError:n});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,u=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;let p=Pd[e],m=c.body.getReader(),y=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),v=y?parseInt(y):0,x=v!==0,E=0,M=new ReadableStream({start(I){P();function P(){m.read().then(({done:C,value:T})=>{if(C)I.close();else{E+=T.byteLength;let D=new ProgressEvent("progress",{lengthComputable:x,loaded:E,total:v});for(let F=0,k=p.length;F<k;F++){let B=p[F];B.onProgress&&B.onProgress(D)}I.enqueue(T),P()}},C=>{I.error(C)})}s(P,"readData")}});return new Response(M)}else throw new eje('fetch for "'.concat(c.url,'" responded with ').concat(c.status,": ").concat(c.statusText),c)}).then(c=>{switch(u){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(p=>new DOMParser().parseFromString(p,l));case"json":return c.json();default:if(l===void 0)return c.text();{let p=/charset="?([^;"\s]*)"?/i.exec(l),m=p&&p[1]?p[1].toLowerCase():void 0,y=new TextDecoder(m);return c.arrayBuffer().then(v=>y.decode(v))}}}).then(c=>{Vm.add(e,c);let p=Pd[e];delete Pd[e];for(let m=0,y=p.length;m<y;m++){let v=p[m];v.onLoad&&v.onLoad(c)}}).catch(c=>{let p=Pd[e];if(p===void 0)throw this.manager.itemError(e),c;delete Pd[e];for(let m=0,y=p.length;m<y;m++){let v=p[m];v.onError&&v.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};s(sde,"FileLoader");var wct=sde,lde=class extends NA{constructor(e){super(e)}load(e,r,i,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Vm.get(e);if(o!==void 0)return a.manager.itemStart(e),setTimeout(function(){r&&r(o),a.manager.itemEnd(e)},0),o;let l=I_("img");function u(){p(),Vm.add(e,this),r&&r(this),a.manager.itemEnd(e)}s(u,"onImageLoad");function c(m){p(),n&&n(m),a.manager.itemError(e),a.manager.itemEnd(e)}s(c,"onImageError");function p(){l.removeEventListener("load",u,!1),l.removeEventListener("error",c,!1)}return s(p,"removeEventListeners"),l.addEventListener("load",u,!1),l.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),a.manager.itemStart(e),l.src=e,l}};s(lde,"ImageLoader");var tje=lde,ude=class extends NA{constructor(e){super(e)}load(e,r,i,n){let a=new Gu,o=new tje(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){a.image=l,a.needsUpdate=!0,r!==void 0&&r(a)},i,n),a}};s(ude,"TextureLoader");var IB=ude,cde=class extends Ha{constructor(e,r=1){super(),this.isLight=!0,this.type="Light",this.color=new oi(e),this.intensity=r}dispose(){}copy(e,r){return super.copy(e,r),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let r=super.toJSON(e);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,this.groundColor!==void 0&&(r.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(r.object.distance=this.distance),this.angle!==void 0&&(r.object.angle=this.angle),this.decay!==void 0&&(r.object.decay=this.decay),this.penumbra!==void 0&&(r.object.penumbra=this.penumbra),this.shadow!==void 0&&(r.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(r.object.target=this.target.uuid),r}};s(cde,"Light");var zP=cde,bD=new Ri,iW=new qe,nW=new qe,hde=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jt(512,512),this.map=null,this.mapPass=null,this.matrix=new Ri,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new RA,this._frameExtents=new Jt(1,1),this._viewportCount=1,this._viewports=[new Jn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let r=this.camera,i=this.matrix;iW.setFromMatrixPosition(e.matrixWorld),r.position.copy(iW),nW.setFromMatrixPosition(e.target.matrixWorld),r.lookAt(nW),r.updateMatrixWorld(),bD.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bD),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(bD)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};s(hde,"LightShadow");var TB=hde,pde=class extends TB{constructor(){super(new Yl(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let r=this.camera,i=C_*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,a=e.distance||r.far;(i!==r.fov||n!==r.aspect||a!==r.far)&&(r.fov=i,r.aspect=n,r.far=a,r.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};s(pde,"SpotLightShadow");var rje=pde,dde=class extends zP{constructor(e,r,i=0,n=Math.PI/3,a=0,o=2){super(e,r),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ha.DEFAULT_UP),this.updateMatrix(),this.target=new Ha,this.distance=i,this.angle=n,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new rje}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,r){return super.copy(e,r),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};s(dde,"SpotLight");var Tct=dde,aW=new Ri,Bb=new qe,wD=new qe,fde=class extends TB{constructor(){super(new Yl(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Jt(4,2),this._viewportCount=6,this._viewports=[new Jn(2,1,1,1),new Jn(0,1,1,1),new Jn(3,1,1,1),new Jn(1,1,1,1),new Jn(3,0,1,1),new Jn(1,0,1,1)],this._cubeDirections=[new qe(1,0,0),new qe(-1,0,0),new qe(0,0,1),new qe(0,0,-1),new qe(0,1,0),new qe(0,-1,0)],this._cubeUps=[new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,0,1),new qe(0,0,-1)]}updateMatrices(e,r=0){let i=this.camera,n=this.matrix,a=e.distance||i.far;a!==i.far&&(i.far=a,i.updateProjectionMatrix()),Bb.setFromMatrixPosition(e.matrixWorld),i.position.copy(Bb),wD.copy(i.position),wD.add(this._cubeDirections[r]),i.up.copy(this._cubeUps[r]),i.lookAt(wD),i.updateMatrixWorld(),n.makeTranslation(-Bb.x,-Bb.y,-Bb.z),aW.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aW)}};s(fde,"PointLightShadow");var ije=fde,mde=class extends zP{constructor(e,r,i=0,n=2){super(e,r),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new ije}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,r){return super.copy(e,r),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};s(mde,"PointLight");var Dct=mde,gde=class extends _B{constructor(e=-1,r=1,i=1,n=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=r,this.top=i,this.bottom=n,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,r,i,n,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,a=i-e,o=i+e,l=n+r,u=n-r;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=c*this.view.offsetX,o=a+c*this.view.width,l-=p*this.view.offsetY,u=l-p*this.view.height}this.projectionMatrix.makeOrthographic(a,o,l,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let r=super.toJSON(e);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,this.view!==null&&(r.object.view=Object.assign({},this.view)),r}};s(gde,"OrthographicCamera");var yde=gde,vde=class extends TB{constructor(){super(new yde(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}};s(vde,"DirectionalLightShadow");var nje=vde,_de=class extends zP{constructor(e,r){super(e,r),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ha.DEFAULT_UP),this.updateMatrix(),this.target=new Ha,this.shadow=new nje}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};s(_de,"DirectionalLight");var xde=_de,bde=class extends zP{constructor(e,r){super(e,r),this.isAmbientLight=!0,this.type="AmbientLight"}};s(bde,"AmbientLight");var aje=bde,wde=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let r="";for(let i=0,n=e.length;i<n;i++)r+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(r))}catch{return r}}static extractUrlBase(e){let r=e.lastIndexOf("/");return r===-1?"./":e.slice(0,r+1)}static resolveURL(e,r){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(r)&&/^\//.test(e)&&(r=r.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:r+e)}};s(wde,"LoaderUtils");var Bct=wde,Ade=class extends Vs{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};s(Ade,"InstancedBufferGeometry");var Uct=Ade,Sde=class extends NA{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,r,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Vm.get(e);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(c=>{r&&r(c),a.manager.itemEnd(e)}).catch(c=>{n&&n(c)});return}return setTimeout(function(){r&&r(o),a.manager.itemEnd(e)},0),o}let l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;let u=fetch(e,l).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(c){return Vm.add(e,c),r&&r(c),a.manager.itemEnd(e),c}).catch(function(c){n&&n(c),Vm.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});Vm.add(e,u),a.manager.itemStart(e)}};s(Sde,"ImageBitmapLoader");var jct=Sde,Mde=class extends Yl{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}};s(Mde,"ArrayCamera");var oje=Mde,Ede=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=gO(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let r=gO();e=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=e}return e}};s(Ede,"Clock");var sje=Ede;function gO(){return performance.now()}s(gO,"now");var PB="\\[\\]\\.:\\/",lje=new RegExp("["+PB+"]","g"),LB="[^"+PB+"]",uje="[^"+PB.replace("\\.","")+"]",cje=/((?:WC+[\/:])*)/.source.replace("WC",LB),hje=/(WCOD+)?/.source.replace("WCOD",uje),pje=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",LB),dje=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",LB),fje=new RegExp("^"+cje+hje+pje+dje+"$"),mje=["material","materials","bones","map"],Cde=class{constructor(e,r,i){let n=i||Eo.parseTrackName(r);this._targetGroup=e,this._bindings=e.subscribe_(r,n)}getValue(e,r){this.bind();let i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(e,r)}setValue(e,r){let i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,a=i.length;n!==a;++n)i[n].setValue(e,r)}bind(){let e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=e.length;r!==i;++r)e[r].bind()}unbind(){let e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=e.length;r!==i;++r)e[r].unbind()}};s(Cde,"Composite");var gje=Cde,Ide=class L0{constructor(e,r,i){this.path=r,this.parsedPath=i||L0.parseTrackName(r),this.node=L0.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,r,i){return e&&e.isAnimationObjectGroup?new L0.Composite(e,r,i):new L0(e,r,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(lje,"")}static parseTrackName(e){let r=fje.exec(e);if(r===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let a=i.nodeName.substring(n+1);mje.indexOf(a)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=a)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,r){if(r===void 0||r===""||r==="."||r===-1||r===e.name||r===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(r);if(i!==void 0)return i}if(e.children){let i=s(function(a){for(let o=0;o<a.length;o++){let l=a[o];if(l.name===r||l.uuid===r)return l;let u=i(l.children);if(u)return u}return null},"searchNodeSubtree"),n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,r){e[r]=this.targetObject[this.propertyName]}_getValue_array(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)e[r++]=i[n]}_getValue_arrayElement(e,r){e[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,r){this.resolvedProperty.toArray(e,r)}_setValue_direct(e,r){this.targetObject[this.propertyName]=e[r]}_setValue_direct_setNeedsUpdate(e,r){this.targetObject[this.propertyName]=e[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,r){this.targetObject[this.propertyName]=e[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)i[n]=e[r++]}_setValue_array_setNeedsUpdate(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)i[n]=e[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,r){let i=this.resolvedProperty;for(let n=0,a=i.length;n!==a;++n)i[n]=e[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,r){this.resolvedProperty[this.propertyIndex]=e[r]}_setValue_arrayElement_setNeedsUpdate(e,r){this.resolvedProperty[this.propertyIndex]=e[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,r){this.resolvedProperty[this.propertyIndex]=e[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,r){this.resolvedProperty.fromArray(e,r)}_setValue_fromArray_setNeedsUpdate(e,r){this.resolvedProperty.fromArray(e,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,r){this.resolvedProperty.fromArray(e,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,r){this.bind(),this.getValue(e,r)}_setValue_unbound(e,r){this.bind(),this.setValue(e,r)}bind(){let e=this.node,r=this.parsedPath,i=r.objectName,n=r.propertyName,a=r.propertyIndex;if(e||(e=L0.findNode(this.rootNode,r.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=r.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===c){c=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}let o=e[n];if(o===void 0){let c=r.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+n+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?l=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(a!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};s(Ide,"PropertyBinding");var Eo=Ide;Eo.Composite=gje;Eo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Eo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Eo.prototype.GetterByBindingType=[Eo.prototype._getValue_direct,Eo.prototype._getValue_array,Eo.prototype._getValue_arrayElement,Eo.prototype._getValue_toArray];Eo.prototype.SetterByBindingTypeAndVersioning=[[Eo.prototype._setValue_direct,Eo.prototype._setValue_direct_setNeedsUpdate,Eo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Eo.prototype._setValue_array,Eo.prototype._setValue_array_setNeedsUpdate,Eo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Eo.prototype._setValue_arrayElement,Eo.prototype._setValue_arrayElement_setNeedsUpdate,Eo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Eo.prototype._setValue_fromArray,Eo.prototype._setValue_fromArray_setNeedsUpdate,Eo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var oW=new Ri,Tde=class{constructor(e,r,i=0,n=1/0){this.ray=new LA(e,r),this.near=i,this.far=n,this.camera=null,this.layers=new yB,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,r){this.ray.set(e,r)}setFromCamera(e,r){r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type: "+r.type)}setFromXRController(e){return oW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(oW),this}intersectObject(e,r=!0,i=[]){return ZT(e,this,i,r),i.sort(yO),i}intersectObjects(e,r=!0,i=[]){for(let n=0,a=e.length;n<a;n++)ZT(e[n],this,i,r);return i.sort(yO),i}};s(Tde,"Raycaster");var FA=Tde;function yO(t,e){return t.distance-e.distance}s(yO,"ascSort");function ZT(t,e,r,i){let n=!0;if(t.layers.test(e.layers)&&t.raycast(e,r)===!1&&(n=!1),n===!0&&i===!0){let a=t.children;for(let o=0,l=a.length;o<l;o++)ZT(a[o],e,r,!0)}}s(ZT,"intersect");var sW=new Jt,Pde=class{constructor(e=new Jt(1/0,1/0),r=new Jt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromPoints(e){this.makeEmpty();for(let r=0,i=e.length;r<i;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){let i=sW.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,sW).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};s(Pde,"Box2");var Lde=Pde,yje=class extends kP{constructor(e=1){let r=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Vs;n.setAttribute("position",new go(r,3)),n.setAttribute("color",new go(i,3));let a=new wB({vertexColors:!0,toneMapped:!1});super(n,a),this.type="AxesHelper"}setColors(e,r,i){let n=new oi,a=this.geometry.attributes.color.array;return n.set(e),n.toArray(a,0),n.toArray(a,3),n.set(r),n.toArray(a,6),n.toArray(a,9),n.set(i),n.toArray(a,12),n.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};s(yje,"AxesHelper");function vO(t,e,r,i){let n=Dde(i);switch(r){case Pue:return t*e;case Due:return t*e;case Rue:return t*e*2;case pB:return t*e/n.components*n.byteLength;case RP:return t*e/n.components*n.byteLength;case Oue:return t*e*2/n.components*n.byteLength;case dB:return t*e*2/n.components*n.byteLength;case Lue:return t*e*3/n.components*n.byteLength;case Ll:return t*e*4/n.components*n.byteLength;case fB:return t*e*4/n.components*n.byteLength;case ZE:case YE:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case KE:case JE:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case DR:case OR:return Math.max(t,16)*Math.max(e,8)/4;case LR:case RR:return Math.max(t,8)*Math.max(e,8)/2;case kR:case NR:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case FR:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case BR:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case zR:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case UR:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case VR:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case jR:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case $R:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case GR:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case HR:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case qR:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case WR:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case XR:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case ZR:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case YR:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case KR:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case QE:case JR:case QR:return Math.ceil(t/4)*Math.ceil(e/4)*16;case kue:case eO:return Math.ceil(t/4)*Math.ceil(e/4)*8;case tO:case rO:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error("Unable to determine texture byte length for ".concat(r," format."))}s(vO,"getByteLength");function Dde(t){switch(t){case ed:case Cue:return{byteLength:1,components:1};case Lw:case Iue:case PA:return{byteLength:2,components:1};case cB:case hB:return{byteLength:2,components:4};case Jm:case uB:case Lu:return{byteLength:4,components:1};case Tue:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(t,"."))}s(Dde,"getTextureTypeByteLength");typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:sB}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=sB);N();function DB(){let t=null,e=!1,r=null,i=null;function n(a,o){r(a,o),i=t.requestAnimationFrame(n)}return s(n,"onAnimationFrame"),{start:s(function(){e!==!0&&r!==null&&(i=t.requestAnimationFrame(n),e=!0)},"start"),stop:s(function(){t.cancelAnimationFrame(i),e=!1},"stop"),setAnimationLoop:s(function(a){r=a},"setAnimationLoop"),setContext:s(function(a){t=a},"setContext")}}s(DB,"WebGLAnimation");function Rde(t){let e=new WeakMap;function r(l,u){let c=l.array,p=l.usage,m=c.byteLength,y=t.createBuffer();t.bindBuffer(u,y),t.bufferData(u,c,p),l.onUploadCallback();let v;if(c instanceof Float32Array)v=t.FLOAT;else if(c instanceof Uint16Array)l.isFloat16BufferAttribute?v=t.HALF_FLOAT:v=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)v=t.SHORT;else if(c instanceof Uint32Array)v=t.UNSIGNED_INT;else if(c instanceof Int32Array)v=t.INT;else if(c instanceof Int8Array)v=t.BYTE;else if(c instanceof Uint8Array)v=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)v=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:y,type:v,bytesPerElement:c.BYTES_PER_ELEMENT,version:l.version,size:m}}s(r,"createBuffer");function i(l,u,c){let p=u.array,m=u.updateRanges;if(t.bindBuffer(c,l),m.length===0)t.bufferSubData(c,0,p);else{m.sort((v,x)=>v.start-x.start);let y=0;for(let v=1;v<m.length;v++){let x=m[y],E=m[v];E.start<=x.start+x.count+1?x.count=Math.max(x.count,E.start+E.count-x.start):(++y,m[y]=E)}m.length=y+1;for(let v=0,x=m.length;v<x;v++){let E=m[v];t.bufferSubData(c,E.start*p.BYTES_PER_ELEMENT,p,E.start,E.count)}u.clearUpdateRanges()}u.onUploadCallback()}s(i,"updateBuffer");function n(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}s(n,"get");function a(l){l.isInterleavedBufferAttribute&&(l=l.data);let u=e.get(l);u&&(t.deleteBuffer(u.buffer),e.delete(l))}s(a,"remove");function o(l,u){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){let p=e.get(l);(!p||p.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}let c=e.get(l);if(c===void 0)e.set(l,r(l,u));else if(c.version<l.version){if(c.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,l,u),c.version=l.version}}return s(o,"update"),{get:n,remove:a,update:o}}s(Rde,"WebGLAttributes");var vje=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,_je=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,xje=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,bje=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wje=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Aje=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Sje=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Mje=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Eje=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Cje=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Ije=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Tje=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Pje=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Lje=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Dje=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Rje=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Oje=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,kje=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Nje=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Fje=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Bje=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,zje=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Uje=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Vje=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,jje=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,$je=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Gje=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Hje=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,qje=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Wje=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Xje="gl_FragColor = linearToOutputTexel( gl_FragColor );",Zje=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Yje=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Kje=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Jje=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Qje=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,e$e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,t$e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,r$e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,i$e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,n$e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,a$e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,o$e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,s$e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,l$e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,u$e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,c$e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,h$e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,p$e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,d$e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,f$e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,m$e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,g$e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,y$e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,v$e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,_$e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,x$e=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,b$e=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,w$e=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,A$e=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,S$e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,M$e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,E$e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,C$e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,I$e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,T$e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,P$e=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,L$e=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,D$e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,R$e=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,O$e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,k$e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,N$e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,F$e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,B$e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,z$e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,U$e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,V$e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,j$e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,$$e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,G$e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,H$e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,q$e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,W$e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,X$e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Z$e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Y$e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,K$e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,J$e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Q$e=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,eGe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,tGe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,rGe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,iGe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,nGe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,aGe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,oGe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,sGe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,lGe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,uGe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,cGe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,hGe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,pGe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,dGe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,fGe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mGe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,gGe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,yGe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,vGe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,_Ge=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xGe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bGe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,wGe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,AGe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,SGe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,MGe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,EGe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,CGe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,IGe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TGe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,PGe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,LGe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,DGe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RGe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,OGe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kGe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,NGe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FGe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,BGe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,zGe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,UGe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VGe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,jGe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$Ge=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,GGe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HGe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,qGe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,WGe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,XGe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ZGe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,YGe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Zi={alphahash_fragment:vje,alphahash_pars_fragment:_je,alphamap_fragment:xje,alphamap_pars_fragment:bje,alphatest_fragment:wje,alphatest_pars_fragment:Aje,aomap_fragment:Sje,aomap_pars_fragment:Mje,batching_pars_vertex:Eje,batching_vertex:Cje,begin_vertex:Ije,beginnormal_vertex:Tje,bsdfs:Pje,iridescence_fragment:Lje,bumpmap_pars_fragment:Dje,clipping_planes_fragment:Rje,clipping_planes_pars_fragment:Oje,clipping_planes_pars_vertex:kje,clipping_planes_vertex:Nje,color_fragment:Fje,color_pars_fragment:Bje,color_pars_vertex:zje,color_vertex:Uje,common:Vje,cube_uv_reflection_fragment:jje,defaultnormal_vertex:$je,displacementmap_pars_vertex:Gje,displacementmap_vertex:Hje,emissivemap_fragment:qje,emissivemap_pars_fragment:Wje,colorspace_fragment:Xje,colorspace_pars_fragment:Zje,envmap_fragment:Yje,envmap_common_pars_fragment:Kje,envmap_pars_fragment:Jje,envmap_pars_vertex:Qje,envmap_physical_pars_fragment:c$e,envmap_vertex:e$e,fog_vertex:t$e,fog_pars_vertex:r$e,fog_fragment:i$e,fog_pars_fragment:n$e,gradientmap_pars_fragment:a$e,lightmap_pars_fragment:o$e,lights_lambert_fragment:s$e,lights_lambert_pars_fragment:l$e,lights_pars_begin:u$e,lights_toon_fragment:h$e,lights_toon_pars_fragment:p$e,lights_phong_fragment:d$e,lights_phong_pars_fragment:f$e,lights_physical_fragment:m$e,lights_physical_pars_fragment:g$e,lights_fragment_begin:y$e,lights_fragment_maps:v$e,lights_fragment_end:_$e,logdepthbuf_fragment:x$e,logdepthbuf_pars_fragment:b$e,logdepthbuf_pars_vertex:w$e,logdepthbuf_vertex:A$e,map_fragment:S$e,map_pars_fragment:M$e,map_particle_fragment:E$e,map_particle_pars_fragment:C$e,metalnessmap_fragment:I$e,metalnessmap_pars_fragment:T$e,morphinstance_vertex:P$e,morphcolor_vertex:L$e,morphnormal_vertex:D$e,morphtarget_pars_vertex:R$e,morphtarget_vertex:O$e,normal_fragment_begin:k$e,normal_fragment_maps:N$e,normal_pars_fragment:F$e,normal_pars_vertex:B$e,normal_vertex:z$e,normalmap_pars_fragment:U$e,clearcoat_normal_fragment_begin:V$e,clearcoat_normal_fragment_maps:j$e,clearcoat_pars_fragment:$$e,iridescence_pars_fragment:G$e,opaque_fragment:H$e,packing:q$e,premultiplied_alpha_fragment:W$e,project_vertex:X$e,dithering_fragment:Z$e,dithering_pars_fragment:Y$e,roughnessmap_fragment:K$e,roughnessmap_pars_fragment:J$e,shadowmap_pars_fragment:Q$e,shadowmap_pars_vertex:eGe,shadowmap_vertex:tGe,shadowmask_pars_fragment:rGe,skinbase_vertex:iGe,skinning_pars_vertex:nGe,skinning_vertex:aGe,skinnormal_vertex:oGe,specularmap_fragment:sGe,specularmap_pars_fragment:lGe,tonemapping_fragment:uGe,tonemapping_pars_fragment:cGe,transmission_fragment:hGe,transmission_pars_fragment:pGe,uv_pars_fragment:dGe,uv_pars_vertex:fGe,uv_vertex:mGe,worldpos_vertex:gGe,background_vert:yGe,background_frag:vGe,backgroundCube_vert:_Ge,backgroundCube_frag:xGe,cube_vert:bGe,cube_frag:wGe,depth_vert:AGe,depth_frag:SGe,distanceRGBA_vert:MGe,distanceRGBA_frag:EGe,equirect_vert:CGe,equirect_frag:IGe,linedashed_vert:TGe,linedashed_frag:PGe,meshbasic_vert:LGe,meshbasic_frag:DGe,meshlambert_vert:RGe,meshlambert_frag:OGe,meshmatcap_vert:kGe,meshmatcap_frag:NGe,meshnormal_vert:FGe,meshnormal_frag:BGe,meshphong_vert:zGe,meshphong_frag:UGe,meshphysical_vert:VGe,meshphysical_frag:jGe,meshtoon_vert:$Ge,meshtoon_frag:GGe,points_vert:HGe,points_frag:qGe,shadow_vert:WGe,shadow_frag:XGe,sprite_vert:ZGe,sprite_frag:YGe},Pr={common:{diffuse:{value:new oi(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new rn},alphaMap:{value:null},alphaMapTransform:{value:new rn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new rn}},envmap:{envMap:{value:null},envMapRotation:{value:new rn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new rn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new rn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new rn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new rn},normalScale:{value:new Jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new rn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new rn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new rn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new rn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new oi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new oi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new rn},alphaTest:{value:0},uvTransform:{value:new rn}},sprite:{diffuse:{value:new oi(16777215)},opacity:{value:1},center:{value:new Jt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new rn},alphaMap:{value:null},alphaMapTransform:{value:new rn},alphaTest:{value:0}}},Pp={basic:{uniforms:Al([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.fog]),vertexShader:Zi.meshbasic_vert,fragmentShader:Zi.meshbasic_frag},lambert:{uniforms:Al([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,Pr.lights,{emissive:{value:new oi(0)}}]),vertexShader:Zi.meshlambert_vert,fragmentShader:Zi.meshlambert_frag},phong:{uniforms:Al([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,Pr.lights,{emissive:{value:new oi(0)},specular:{value:new oi(1118481)},shininess:{value:30}}]),vertexShader:Zi.meshphong_vert,fragmentShader:Zi.meshphong_frag},standard:{uniforms:Al([Pr.common,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.roughnessmap,Pr.metalnessmap,Pr.fog,Pr.lights,{emissive:{value:new oi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zi.meshphysical_vert,fragmentShader:Zi.meshphysical_frag},toon:{uniforms:Al([Pr.common,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.gradientmap,Pr.fog,Pr.lights,{emissive:{value:new oi(0)}}]),vertexShader:Zi.meshtoon_vert,fragmentShader:Zi.meshtoon_frag},matcap:{uniforms:Al([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,{matcap:{value:null}}]),vertexShader:Zi.meshmatcap_vert,fragmentShader:Zi.meshmatcap_frag},points:{uniforms:Al([Pr.points,Pr.fog]),vertexShader:Zi.points_vert,fragmentShader:Zi.points_frag},dashed:{uniforms:Al([Pr.common,Pr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zi.linedashed_vert,fragmentShader:Zi.linedashed_frag},depth:{uniforms:Al([Pr.common,Pr.displacementmap]),vertexShader:Zi.depth_vert,fragmentShader:Zi.depth_frag},normal:{uniforms:Al([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,{opacity:{value:1}}]),vertexShader:Zi.meshnormal_vert,fragmentShader:Zi.meshnormal_frag},sprite:{uniforms:Al([Pr.sprite,Pr.fog]),vertexShader:Zi.sprite_vert,fragmentShader:Zi.sprite_frag},background:{uniforms:{uvTransform:{value:new rn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Zi.background_vert,fragmentShader:Zi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new rn}},vertexShader:Zi.backgroundCube_vert,fragmentShader:Zi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Zi.cube_vert,fragmentShader:Zi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zi.equirect_vert,fragmentShader:Zi.equirect_frag},distanceRGBA:{uniforms:Al([Pr.common,Pr.displacementmap,{referencePosition:{value:new qe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zi.distanceRGBA_vert,fragmentShader:Zi.distanceRGBA_frag},shadow:{uniforms:Al([Pr.lights,Pr.fog,{color:{value:new oi(0)},opacity:{value:1}}]),vertexShader:Zi.shadow_vert,fragmentShader:Zi.shadow_frag}};Pp.physical={uniforms:Al([Pp.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new rn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new rn},clearcoatNormalScale:{value:new Jt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new rn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new rn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new rn},sheen:{value:0},sheenColor:{value:new oi(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new rn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new rn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new rn},transmissionSamplerSize:{value:new Jt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new rn},attenuationDistance:{value:0},attenuationColor:{value:new oi(0)},specularColor:{value:new oi(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new rn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new rn},anisotropyVector:{value:new Jt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new rn}}]),vertexShader:Zi.meshphysical_vert,fragmentShader:Zi.meshphysical_frag};var pE={r:0,b:0,g:0},Bg=new Nu,KGe=new Ri;function Ode(t,e,r,i,n,a,o){let l=new oi(0),u=a===!0?0:1,c,p,m=null,y=0,v=null;function x(C){let T=C.isScene===!0?C.background:null;return T&&T.isTexture&&(T=(C.backgroundBlurriness>0?r:e).get(T)),T}s(x,"getBackground");function E(C){let T=!1,D=x(C);D===null?I(l,u):D&&D.isColor&&(I(D,1),T=!0);let F=t.xr.getEnvironmentBlendMode();F==="additive"?i.buffers.color.setClear(0,0,0,1,o):F==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(t.autoClear||T)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}s(E,"render");function M(C,T){let D=x(T);D&&(D.isCubeTexture||D.mapping===DP)?(p===void 0&&(p=new Tn(new DA(1,1,1),new bc({name:"BackgroundCubeMaterial",uniforms:Xy(Pp.backgroundCube.uniforms),vertexShader:Pp.backgroundCube.vertexShader,fragmentShader:Pp.backgroundCube.fragmentShader,side:eu,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(F,k,B){this.matrixWorld.copyPosition(B.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:s(function(){return this.uniforms.envMap.value},"get")}),n.update(p)),Bg.copy(T.backgroundRotation),Bg.x*=-1,Bg.y*=-1,Bg.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(Bg.y*=-1,Bg.z*=-1),p.material.uniforms.envMap.value=D,p.material.uniforms.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=T.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(KGe.makeRotationFromEuler(Bg)),p.material.toneMapped=Dn.getTransfer(D.colorSpace)!==ma,(m!==D||y!==D.version||v!==t.toneMapping)&&(p.material.needsUpdate=!0,m=D,y=D.version,v=t.toneMapping),p.layers.enableAll(),C.unshift(p,p.geometry,p.material,0,0,null)):D&&D.isTexture&&(c===void 0&&(c=new Tn(new pv(2,2),new bc({name:"BackgroundMaterial",uniforms:Xy(Pp.background.uniforms),vertexShader:Pp.background.vertexShader,fragmentShader:Pp.background.fragmentShader,side:Qp,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:s(function(){return this.uniforms.t2D.value},"get")}),n.update(c)),c.material.uniforms.t2D.value=D,c.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,c.material.toneMapped=Dn.getTransfer(D.colorSpace)!==ma,D.matrixAutoUpdate===!0&&D.updateMatrix(),c.material.uniforms.uvTransform.value.copy(D.matrix),(m!==D||y!==D.version||v!==t.toneMapping)&&(c.material.needsUpdate=!0,m=D,y=D.version,v=t.toneMapping),c.layers.enableAll(),C.unshift(c,c.geometry,c.material,0,0,null))}s(M,"addToRenderList");function I(C,T){C.getRGB(pE,vB(t)),i.buffers.color.setClear(pE.r,pE.g,pE.b,T,o)}s(I,"setClear");function P(){p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return s(P,"dispose"),{getClearColor:s(function(){return l},"getClearColor"),setClearColor:s(function(C,T=1){l.set(C),u=T,I(l,u)},"setClearColor"),getClearAlpha:s(function(){return u},"getClearAlpha"),setClearAlpha:s(function(C){u=C,I(l,u)},"setClearAlpha"),render:E,addToRenderList:M,dispose:P}}s(Ode,"WebGLBackground");function kde(t,e){let r=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},n=y(null),a=n,o=!1;function l(z,q,Z,Q,V){let ae=!1,Y=m(Q,Z,q);a!==Y&&(a=Y,c(a.object)),ae=v(z,Q,Z,V),ae&&x(z,Q,Z,V),V!==null&&e.update(V,t.ELEMENT_ARRAY_BUFFER),(ae||o)&&(o=!1,T(z,q,Z,Q),V!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(V).buffer))}s(l,"setup");function u(){return t.createVertexArray()}s(u,"createVertexArrayObject");function c(z){return t.bindVertexArray(z)}s(c,"bindVertexArrayObject");function p(z){return t.deleteVertexArray(z)}s(p,"deleteVertexArrayObject");function m(z,q,Z){let Q=Z.wireframe===!0,V=i[z.id];V===void 0&&(V={},i[z.id]=V);let ae=V[q.id];ae===void 0&&(ae={},V[q.id]=ae);let Y=ae[Q];return Y===void 0&&(Y=y(u()),ae[Q]=Y),Y}s(m,"getBindingState");function y(z){let q=[],Z=[],Q=[];for(let V=0;V<r;V++)q[V]=0,Z[V]=0,Q[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:Z,attributeDivisors:Q,object:z,attributes:{},index:null}}s(y,"createBindingState");function v(z,q,Z,Q){let V=a.attributes,ae=q.attributes,Y=0,he=Z.getAttributes();for(let J in he)if(he[J].location>=0){let ne=V[J],ee=ae[J];if(ee===void 0&&(J==="instanceMatrix"&&z.instanceMatrix&&(ee=z.instanceMatrix),J==="instanceColor"&&z.instanceColor&&(ee=z.instanceColor)),ne===void 0||ne.attribute!==ee||ee&&ne.data!==ee.data)return!0;Y++}return a.attributesNum!==Y||a.index!==Q}s(v,"needsUpdate");function x(z,q,Z,Q){let V={},ae=q.attributes,Y=0,he=Z.getAttributes();for(let J in he)if(he[J].location>=0){let ne=ae[J];ne===void 0&&(J==="instanceMatrix"&&z.instanceMatrix&&(ne=z.instanceMatrix),J==="instanceColor"&&z.instanceColor&&(ne=z.instanceColor));let ee={};ee.attribute=ne,ne&&ne.data&&(ee.data=ne.data),V[J]=ee,Y++}a.attributes=V,a.attributesNum=Y,a.index=Q}s(x,"saveCache");function E(){let z=a.newAttributes;for(let q=0,Z=z.length;q<Z;q++)z[q]=0}s(E,"initAttributes");function M(z){I(z,0)}s(M,"enableAttribute");function I(z,q){let Z=a.newAttributes,Q=a.enabledAttributes,V=a.attributeDivisors;Z[z]=1,Q[z]===0&&(t.enableVertexAttribArray(z),Q[z]=1),V[z]!==q&&(t.vertexAttribDivisor(z,q),V[z]=q)}s(I,"enableAttributeAndDivisor");function P(){let z=a.newAttributes,q=a.enabledAttributes;for(let Z=0,Q=q.length;Z<Q;Z++)q[Z]!==z[Z]&&(t.disableVertexAttribArray(Z),q[Z]=0)}s(P,"disableUnusedAttributes");function C(z,q,Z,Q,V,ae,Y){Y===!0?t.vertexAttribIPointer(z,q,Z,V,ae):t.vertexAttribPointer(z,q,Z,Q,V,ae)}s(C,"vertexAttribPointer");function T(z,q,Z,Q){E();let V=Q.attributes,ae=Z.getAttributes(),Y=q.defaultAttributeValues;for(let he in ae){let J=ae[he];if(J.location>=0){let ne=V[he];if(ne===void 0&&(he==="instanceMatrix"&&z.instanceMatrix&&(ne=z.instanceMatrix),he==="instanceColor"&&z.instanceColor&&(ne=z.instanceColor)),ne!==void 0){let ee=ne.normalized,ue=ne.itemSize,K=e.get(ne);if(K===void 0)continue;let ce=K.buffer,re=K.type,se=K.bytesPerElement,de=re===t.INT||re===t.UNSIGNED_INT||ne.gpuType===uB;if(ne.isInterleavedBufferAttribute){let we=ne.data,Le=we.stride,fe=ne.offset;if(we.isInstancedInterleavedBuffer){for(let Re=0;Re<J.locationSize;Re++)I(J.location+Re,we.meshPerAttribute);z.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let Re=0;Re<J.locationSize;Re++)M(J.location+Re);t.bindBuffer(t.ARRAY_BUFFER,ce);for(let Re=0;Re<J.locationSize;Re++)C(J.location+Re,ue/J.locationSize,re,ee,Le*se,(fe+ue/J.locationSize*Re)*se,de)}else{if(ne.isInstancedBufferAttribute){for(let we=0;we<J.locationSize;we++)I(J.location+we,ne.meshPerAttribute);z.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let we=0;we<J.locationSize;we++)M(J.location+we);t.bindBuffer(t.ARRAY_BUFFER,ce);for(let we=0;we<J.locationSize;we++)C(J.location+we,ue/J.locationSize,re,ee,ue*se,ue/J.locationSize*we*se,de)}}else if(Y!==void 0){let ee=Y[he];if(ee!==void 0)switch(ee.length){case 2:t.vertexAttrib2fv(J.location,ee);break;case 3:t.vertexAttrib3fv(J.location,ee);break;case 4:t.vertexAttrib4fv(J.location,ee);break;default:t.vertexAttrib1fv(J.location,ee)}}}}P()}s(T,"setupVertexAttributes");function D(){B();for(let z in i){let q=i[z];for(let Z in q){let Q=q[Z];for(let V in Q)p(Q[V].object),delete Q[V];delete q[Z]}delete i[z]}}s(D,"dispose");function F(z){if(i[z.id]===void 0)return;let q=i[z.id];for(let Z in q){let Q=q[Z];for(let V in Q)p(Q[V].object),delete Q[V];delete q[Z]}delete i[z.id]}s(F,"releaseStatesOfGeometry");function k(z){for(let q in i){let Z=i[q];if(Z[z.id]===void 0)continue;let Q=Z[z.id];for(let V in Q)p(Q[V].object),delete Q[V];delete Z[z.id]}}s(k,"releaseStatesOfProgram");function B(){U(),o=!0,a!==n&&(a=n,c(a.object))}s(B,"reset");function U(){n.geometry=null,n.program=null,n.wireframe=!1}return s(U,"resetDefaultState"),{setup:l,reset:B,resetDefaultState:U,dispose:D,releaseStatesOfGeometry:F,releaseStatesOfProgram:k,initAttributes:E,enableAttribute:M,disableUnusedAttributes:P}}s(kde,"WebGLBindingStates");function Nde(t,e,r){let i;function n(c){i=c}s(n,"setMode");function a(c,p){t.drawArrays(i,c,p),r.update(p,i,1)}s(a,"render");function o(c,p,m){m!==0&&(t.drawArraysInstanced(i,c,p,m),r.update(p,i,m))}s(o,"renderInstances");function l(c,p,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,p,0,m);let y=0;for(let v=0;v<m;v++)y+=p[v];r.update(y,i,1)}s(l,"renderMultiDraw");function u(c,p,m,y){if(m===0)return;let v=e.get("WEBGL_multi_draw");if(v===null)for(let x=0;x<c.length;x++)o(c[x],p[x],y[x]);else{v.multiDrawArraysInstancedWEBGL(i,c,0,p,0,y,0,m);let x=0;for(let E=0;E<m;E++)x+=p[E]*y[E];r.update(x,i,1)}}s(u,"renderMultiDrawInstances"),this.setMode=n,this.render=a,this.renderInstances=o,this.renderMultiDraw=l,this.renderMultiDrawInstances=u}s(Nde,"WebGLBufferRenderer");function Fde(t,e,r,i){let n;function a(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){let k=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}s(a,"getMaxAnisotropy");function o(k){return!(k!==Ll&&i.convert(k)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}s(o,"textureFormatReadable");function l(k){let B=k===PA&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(k!==ed&&i.convert(k)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&k!==Lu&&!B)}s(l,"textureTypeReadable");function u(k){if(k==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}s(u,"getMaxPrecision");let c=r.precision!==void 0?r.precision:"highp",p=u(c);p!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",p,"instead."),c=p);let m=r.logarithmicDepthBuffer===!0,y=r.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),v=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),x=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),E=t.getParameter(t.MAX_TEXTURE_SIZE),M=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),I=t.getParameter(t.MAX_VERTEX_ATTRIBS),P=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),C=t.getParameter(t.MAX_VARYING_VECTORS),T=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),D=x>0,F=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:u,textureFormatReadable:o,textureTypeReadable:l,precision:c,logarithmicDepthBuffer:m,reverseDepthBuffer:y,maxTextures:v,maxVertexTextures:x,maxTextureSize:E,maxCubemapSize:M,maxAttributes:I,maxVertexUniforms:P,maxVaryings:C,maxFragmentUniforms:T,vertexTextures:D,maxSamples:F}}s(Fde,"WebGLCapabilities");function Bde(t){let e=this,r=null,i=0,n=!1,a=!1,o=new $g,l=new rn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(m,y){let v=m.length!==0||y||i!==0||n;return n=y,i=m.length,v},this.beginShadows=function(){a=!0,p(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(m,y){r=p(m,y,0)},this.setState=function(m,y,v){let x=m.clippingPlanes,E=m.clipIntersection,M=m.clipShadows,I=t.get(m);if(!n||x===null||x.length===0||a&&!M)a?p(null):c();else{let P=a?0:i,C=P*4,T=I.clippingState||null;u.value=T,T=p(x,y,C,v);for(let D=0;D!==C;++D)T[D]=r[D];I.clippingState=T,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=P}};function c(){u.value!==r&&(u.value=r,u.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}s(c,"resetGlobalState");function p(m,y,v,x){let E=m!==null?m.length:0,M=null;if(E!==0){if(M=u.value,x!==!0||M===null){let I=v+E*4,P=y.matrixWorldInverse;l.getNormalMatrix(P),(M===null||M.length<I)&&(M=new Float32Array(I));for(let C=0,T=v;C!==E;++C,T+=4)o.copy(m[C]).applyMatrix4(P,l),o.normal.toArray(M,T),M[T+3]=o.constant}u.value=M,u.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,M}s(p,"projectPlanes")}s(Bde,"WebGLClipping");function zde(t){let e=new WeakMap;function r(o,l){return l===FT?o.mapping=A_:l===TR&&(o.mapping=S_),o}s(r,"mapTextureMapping");function i(o){if(o&&o.isTexture){let l=o.mapping;if(l===FT||l===TR)if(e.has(o)){let u=e.get(o).texture;return r(u,o.mapping)}else{let u=o.image;if(u&&u.height>0){let c=new MVe(u.height);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",n),r(c.texture,o.mapping)}else return null}}return o}s(i,"get");function n(o){let l=o.target;l.removeEventListener("dispose",n);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}s(n,"onTextureDispose");function a(){e=new WeakMap}return s(a,"dispose"),{get:i,dispose:a}}s(zde,"WebGLCubeMaps");var R1=4,lW=[.125,.215,.35,.446,.526,.582],my=20,AD=new yde,uW=new oi,SD=null,MD=0,ED=0,CD=!1,Gg=(1+Math.sqrt(5))/2,y0=1/Gg,cW=[new qe(-Gg,y0,0),new qe(Gg,y0,0),new qe(-y0,0,Gg),new qe(y0,0,Gg),new qe(0,Gg,-y0),new qe(0,Gg,y0),new qe(-1,1,-1),new qe(1,1,-1),new qe(-1,1,1),new qe(1,1,1)],Ude=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,r=0,i=.1,n=100){SD=this._renderer.getRenderTarget(),MD=this._renderer.getActiveCubeFace(),ED=this._renderer.getActiveMipmapLevel(),CD=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,i,n,a),r>0&&this._blur(a,0,0,r),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,r=null){return this._fromTexture(e,r)}fromCubemap(e,r=null){return this._fromTexture(e,r)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=bO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=xO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(SD,MD,ED),this._renderer.xr.enabled=CD,e.scissorTest=!1,g2(e,0,0,e.width,e.height)}_fromTexture(e,r){e.mapping===A_||e.mapping===S_?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),SD=this._renderer.getRenderTarget(),MD=this._renderer.getActiveCubeFace(),ED=this._renderer.getActiveMipmapLevel(),CD=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let i=r||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),r=4*this._cubeSize,i={magFilter:Up,minFilter:Up,generateMipmaps:!1,type:PA,format:Ll,colorSpace:Wy,depthBuffer:!1},n=_O(e,r,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==r){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_O(e,r,i);let{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Vde(a)),this._blurMaterial=jde(a,e,r)}return n}_compileMaterial(e){let r=new Tn(this._lodPlanes[0],e);this._renderer.compile(r,AD)}_sceneToCubeUV(e,r,i,n){let a=new Yl(90,1,r,i),o=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,c=u.autoClear,p=u.toneMapping;u.getClearColor(uW),u.toneMapping=qm,u.autoClear=!1;let m=new ug({name:"PMREM.Background",side:eu,depthWrite:!1,depthTest:!1}),y=new Tn(new DA,m),v=!1,x=e.background;x?x.isColor&&(m.color.copy(x),e.background=null,v=!0):(m.color.copy(uW),v=!0);for(let E=0;E<6;E++){let M=E%3;M===0?(a.up.set(0,o[E],0),a.lookAt(l[E],0,0)):M===1?(a.up.set(0,0,o[E]),a.lookAt(0,l[E],0)):(a.up.set(0,o[E],0),a.lookAt(0,0,l[E]));let I=this._cubeSize;g2(n,M*I,E>2?I:0,I,I),u.setRenderTarget(n),v&&u.render(y,a),u.render(e,a)}y.geometry.dispose(),y.material.dispose(),u.toneMapping=p,u.autoClear=c,e.background=x}_textureToCubeUV(e,r){let i=this._renderer,n=e.mapping===A_||e.mapping===S_;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=bO()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=xO());let a=n?this._cubemapMaterial:this._equirectMaterial,o=new Tn(this._lodPlanes[0],a),l=a.uniforms;l.envMap.value=e;let u=this._cubeSize;g2(r,0,0,3*u,2*u),i.setRenderTarget(r),i.render(o,AD)}_applyPMREM(e){let r=this._renderer,i=r.autoClear;r.autoClear=!1;let n=this._lodPlanes.length;for(let a=1;a<n;a++){let o=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),l=cW[(n-a-1)%cW.length];this._blur(e,a-1,a,o,l)}r.autoClear=i}_blur(e,r,i,n,a){let o=this._pingPongRenderTarget;this._halfBlur(e,o,r,i,n,"latitudinal",a),this._halfBlur(o,e,i,i,n,"longitudinal",a)}_halfBlur(e,r,i,n,a,o,l){let u=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let p=3,m=new Tn(this._lodPlanes[n],c),y=c.uniforms,v=this._sizeLods[i]-1,x=isFinite(a)?Math.PI/(2*v):2*Math.PI/(2*my-1),E=a/x,M=isFinite(a)?1+Math.floor(p*E):my;M>my&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(M," samples when the maximum is set to ").concat(my));let I=[],P=0;for(let k=0;k<my;++k){let B=k/E,U=Math.exp(-B*B/2);I.push(U),k===0?P+=U:k<M&&(P+=2*U)}for(let k=0;k<I.length;k++)I[k]=I[k]/P;y.envMap.value=e.texture,y.samples.value=M,y.weights.value=I,y.latitudinal.value=o==="latitudinal",l&&(y.poleAxis.value=l);let{_lodMax:C}=this;y.dTheta.value=x,y.mipInt.value=C-i;let T=this._sizeLods[n],D=3*T*(n>C-R1?n-C+R1:0),F=4*(this._cubeSize-T);g2(r,D,F,3*T,2*T),u.setRenderTarget(r),u.render(m,AD)}};s(Ude,"PMREMGenerator");var hW=Ude;function Vde(t){let e=[],r=[],i=[],n=t,a=t-R1+1+lW.length;for(let o=0;o<a;o++){let l=Math.pow(2,n);r.push(l);let u=1/l;o>t-R1?u=lW[o-t+R1-1]:o===0&&(u=0),i.push(u);let c=1/(l-2),p=-c,m=1+c,y=[p,p,m,p,m,m,p,p,m,m,p,m],v=6,x=6,E=3,M=2,I=1,P=new Float32Array(E*x*v),C=new Float32Array(M*x*v),T=new Float32Array(I*x*v);for(let F=0;F<v;F++){let k=F%3*2/3-1,B=F>2?0:-1,U=[k,B,0,k+2/3,B,0,k+2/3,B+1,0,k,B,0,k+2/3,B+1,0,k,B+1,0];P.set(U,E*x*F),C.set(y,M*x*F);let z=[F,F,F,F,F,F];T.set(z,I*x*F)}let D=new Vs;D.setAttribute("position",new Zo(P,E)),D.setAttribute("uv",new Zo(C,M)),D.setAttribute("faceIndex",new Zo(T,I)),e.push(D),n>R1&&n--}return{lodPlanes:e,sizeLods:r,sigmas:i}}s(Vde,"_createPlanes");function _O(t,e,r){let i=new Qm(t,e,r);return i.texture.mapping=DP,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}s(_O,"_createRenderTarget");function g2(t,e,r,i,n){t.viewport.set(e,r,i,n),t.scissor.set(e,r,i,n)}s(g2,"_setViewport");function jde(t,e,r){let i=new Float32Array(my),n=new qe(0,1,0);return new bc({name:"SphericalGaussianBlur",defines:{n:my,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:"".concat(t,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:UP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Hm,depthTest:!1,depthWrite:!1})}s(jde,"_getBlurShader");function xO(){return new bc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:UP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Hm,depthTest:!1,depthWrite:!1})}s(xO,"_getEquirectMaterial");function bO(){return new bc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:UP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Hm,depthTest:!1,depthWrite:!1})}s(bO,"_getCubemapMaterial");function UP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}s(UP,"_getCommonVertexShader");function $de(t){let e=new WeakMap,r=null;function i(l){if(l&&l.isTexture){let u=l.mapping,c=u===FT||u===TR,p=u===A_||u===S_;if(c||p){let m=e.get(l),y=m!==void 0?m.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==y)return r===null&&(r=new hW(t)),m=c?r.fromEquirectangular(l,m):r.fromCubemap(l,m),m.texture.pmremVersion=l.pmremVersion,e.set(l,m),m.texture;if(m!==void 0)return m.texture;{let v=l.image;return c&&v&&v.height>0||p&&v&&n(v)?(r===null&&(r=new hW(t)),m=c?r.fromEquirectangular(l):r.fromCubemap(l),m.texture.pmremVersion=l.pmremVersion,e.set(l,m),l.addEventListener("dispose",a),m.texture):null}}}return l}s(i,"get");function n(l){let u=0,c=6;for(let p=0;p<c;p++)l[p]!==void 0&&u++;return u===c}s(n,"isCubeTextureComplete");function a(l){let u=l.target;u.removeEventListener("dispose",a);let c=e.get(u);c!==void 0&&(e.delete(u),c.dispose())}s(a,"onTextureDispose");function o(){e=new WeakMap,r!==null&&(r.dispose(),r=null)}return s(o,"dispose"),{get:i,dispose:o}}s($de,"WebGLCubeUVMaps");function Gde(t){let e={};function r(i){if(e[i]!==void 0)return e[i];let n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return e[i]=n,n}return s(r,"getExtension"),{has:s(function(i){return r(i)!==null},"has"),init:s(function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},"init"),get:s(function(i){let n=r(i);return n===null&&fy("THREE.WebGLRenderer: "+i+" extension not supported."),n},"get")}}s(Gde,"WebGLExtensions");function Hde(t,e,r,i){let n={},a=new WeakMap;function o(m){let y=m.target;y.index!==null&&e.remove(y.index);for(let x in y.attributes)e.remove(y.attributes[x]);y.removeEventListener("dispose",o),delete n[y.id];let v=a.get(y);v&&(e.remove(v),a.delete(y)),i.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,r.memory.geometries--}s(o,"onGeometryDispose");function l(m,y){return n[y.id]===!0||(y.addEventListener("dispose",o),n[y.id]=!0,r.memory.geometries++),y}s(l,"get");function u(m){let y=m.attributes;for(let v in y)e.update(y[v],t.ARRAY_BUFFER)}s(u,"update");function c(m){let y=[],v=m.index,x=m.attributes.position,E=0;if(v!==null){let P=v.array;E=v.version;for(let C=0,T=P.length;C<T;C+=3){let D=P[C+0],F=P[C+1],k=P[C+2];y.push(D,F,F,k,k,D)}}else if(x!==void 0){let P=x.array;E=x.version;for(let C=0,T=P.length/3-1;C<T;C+=3){let D=C+0,F=C+1,k=C+2;y.push(D,F,F,k,k,D)}}else return;let M=new(gB(y)?Uce:Bce)(y,1);M.version=E;let I=a.get(m);I&&e.remove(I),a.set(m,M)}s(c,"updateWireframeAttribute");function p(m){let y=a.get(m);if(y){let v=m.index;v!==null&&y.version<v.version&&c(m)}else c(m);return a.get(m)}return s(p,"getWireframeAttribute"),{get:l,update:u,getWireframeAttribute:p}}s(Hde,"WebGLGeometries");function qde(t,e,r){let i;function n(y){i=y}s(n,"setMode");let a,o;function l(y){a=y.type,o=y.bytesPerElement}s(l,"setIndex");function u(y,v){t.drawElements(i,v,a,y*o),r.update(v,i,1)}s(u,"render");function c(y,v,x){x!==0&&(t.drawElementsInstanced(i,v,a,y*o,x),r.update(v,i,x))}s(c,"renderInstances");function p(y,v,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,a,y,0,x);let E=0;for(let M=0;M<x;M++)E+=v[M];r.update(E,i,1)}s(p,"renderMultiDraw");function m(y,v,x,E){if(x===0)return;let M=e.get("WEBGL_multi_draw");if(M===null)for(let I=0;I<y.length;I++)c(y[I]/o,v[I],E[I]);else{M.multiDrawElementsInstancedWEBGL(i,v,0,a,y,0,E,0,x);let I=0;for(let P=0;P<x;P++)I+=v[P]*E[P];r.update(I,i,1)}}s(m,"renderMultiDrawInstances"),this.setMode=n,this.setIndex=l,this.render=u,this.renderInstances=c,this.renderMultiDraw=p,this.renderMultiDrawInstances=m}s(qde,"WebGLIndexedBufferRenderer");function Wde(t){let e={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,o,l){switch(r.calls++,o){case t.TRIANGLES:r.triangles+=l*(a/3);break;case t.LINES:r.lines+=l*(a/2);break;case t.LINE_STRIP:r.lines+=l*(a-1);break;case t.LINE_LOOP:r.lines+=l*a;break;case t.POINTS:r.points+=l*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}s(i,"update");function n(){r.calls=0,r.triangles=0,r.points=0,r.lines=0}return s(n,"reset"),{memory:e,render:r,programs:null,autoReset:!0,reset:n,update:i}}s(Wde,"WebGLInfo");function Xde(t,e,r){let i=new WeakMap,n=new Jn;function a(o,l,u){let c=o.morphTargetInfluences,p=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,m=p!==void 0?p.length:0,y=i.get(l);if(y===void 0||y.count!==m){let v=function(){B.dispose(),i.delete(l),l.removeEventListener("dispose",v)};s(v,"disposeTexture"),y!==void 0&&y.texture.dispose();let x=l.morphAttributes.position!==void 0,E=l.morphAttributes.normal!==void 0,M=l.morphAttributes.color!==void 0,I=l.morphAttributes.position||[],P=l.morphAttributes.normal||[],C=l.morphAttributes.color||[],T=0;x===!0&&(T=1),E===!0&&(T=2),M===!0&&(T=3);let D=l.attributes.position.count*T,F=1;D>e.maxTextureSize&&(F=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);let k=new Float32Array(D*F*4*m),B=new vce(k,D,F,m);B.type=Lu,B.needsUpdate=!0;let U=T*4;for(let z=0;z<m;z++){let q=I[z],Z=P[z],Q=C[z],V=D*F*4*z;for(let ae=0;ae<q.count;ae++){let Y=ae*U;x===!0&&(n.fromBufferAttribute(q,ae),k[V+Y+0]=n.x,k[V+Y+1]=n.y,k[V+Y+2]=n.z,k[V+Y+3]=0),E===!0&&(n.fromBufferAttribute(Z,ae),k[V+Y+4]=n.x,k[V+Y+5]=n.y,k[V+Y+6]=n.z,k[V+Y+7]=0),M===!0&&(n.fromBufferAttribute(Q,ae),k[V+Y+8]=n.x,k[V+Y+9]=n.y,k[V+Y+10]=n.z,k[V+Y+11]=Q.itemSize===4?n.w:1)}}y={count:m,texture:B,size:new Jt(D,F)},i.set(l,y),l.addEventListener("dispose",v)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)u.getUniforms().setValue(t,"morphTexture",o.morphTexture,r);else{let v=0;for(let E=0;E<c.length;E++)v+=c[E];let x=l.morphTargetsRelative?1:1-v;u.getUniforms().setValue(t,"morphTargetBaseInfluence",x),u.getUniforms().setValue(t,"morphTargetInfluences",c)}u.getUniforms().setValue(t,"morphTargetsTexture",y.texture,r),u.getUniforms().setValue(t,"morphTargetsTextureSize",y.size)}return s(a,"update"),{update:a}}s(Xde,"WebGLMorphtargets");function Zde(t,e,r,i){let n=new WeakMap;function a(u){let c=i.render.frame,p=u.geometry,m=e.get(u,p);if(n.get(m)!==c&&(e.update(m),n.set(m,c)),u.isInstancedMesh&&(u.hasEventListener("dispose",l)===!1&&u.addEventListener("dispose",l),n.get(u)!==c&&(r.update(u.instanceMatrix,t.ARRAY_BUFFER),u.instanceColor!==null&&r.update(u.instanceColor,t.ARRAY_BUFFER),n.set(u,c))),u.isSkinnedMesh){let y=u.skeleton;n.get(y)!==c&&(y.update(),n.set(y,c))}return m}s(a,"update");function o(){n=new WeakMap}s(o,"dispose");function l(u){let c=u.target;c.removeEventListener("dispose",l),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return s(l,"onInstancedMeshDispose"),{update:a,dispose:o}}s(Zde,"WebGLObjects");var Yde=new Gu,pW=new Lhe(1,1),Kde=new vce,Jde=new cVe,Qde=new ehe,dW=[],fW=[],mW=new Float32Array(16),gW=new Float32Array(9),yW=new Float32Array(4);function dv(t,e,r){let i=t[0];if(i<=0||i>0)return t;let n=e*r,a=dW[n];if(a===void 0&&(a=new Float32Array(n),dW[n]=a),e!==0){i.toArray(a,0);for(let o=1,l=0;o!==e;++o)l+=r,t[o].toArray(a,l)}return a}s(dv,"flatten");function fs(t,e){if(t.length!==e.length)return!1;for(let r=0,i=t.length;r<i;r++)if(t[r]!==e[r])return!1;return!0}s(fs,"arraysEqual");function ms(t,e){for(let r=0,i=e.length;r<i;r++)t[r]=e[r]}s(ms,"copyArray");function BA(t,e){let r=fW[e];r===void 0&&(r=new Int32Array(e),fW[e]=r);for(let i=0;i!==e;++i)r[i]=t.allocateTextureUnit();return r}s(BA,"allocTexUnits");function efe(t,e){let r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}s(efe,"setValueV1f");function tfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(fs(r,e))return;t.uniform2fv(this.addr,e),ms(r,e)}}s(tfe,"setValueV2f");function rfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(e.r!==void 0)(r[0]!==e.r||r[1]!==e.g||r[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(fs(r,e))return;t.uniform3fv(this.addr,e),ms(r,e)}}s(rfe,"setValueV3f");function ife(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(fs(r,e))return;t.uniform4fv(this.addr,e),ms(r,e)}}s(ife,"setValueV4f");function nfe(t,e){let r=this.cache,i=e.elements;if(i===void 0){if(fs(r,e))return;t.uniformMatrix2fv(this.addr,!1,e),ms(r,e)}else{if(fs(r,i))return;yW.set(i),t.uniformMatrix2fv(this.addr,!1,yW),ms(r,i)}}s(nfe,"setValueM2");function afe(t,e){let r=this.cache,i=e.elements;if(i===void 0){if(fs(r,e))return;t.uniformMatrix3fv(this.addr,!1,e),ms(r,e)}else{if(fs(r,i))return;gW.set(i),t.uniformMatrix3fv(this.addr,!1,gW),ms(r,i)}}s(afe,"setValueM3");function ofe(t,e){let r=this.cache,i=e.elements;if(i===void 0){if(fs(r,e))return;t.uniformMatrix4fv(this.addr,!1,e),ms(r,e)}else{if(fs(r,i))return;mW.set(i),t.uniformMatrix4fv(this.addr,!1,mW),ms(r,i)}}s(ofe,"setValueM4");function sfe(t,e){let r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}s(sfe,"setValueV1i");function lfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(fs(r,e))return;t.uniform2iv(this.addr,e),ms(r,e)}}s(lfe,"setValueV2i");function ufe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(fs(r,e))return;t.uniform3iv(this.addr,e),ms(r,e)}}s(ufe,"setValueV3i");function cfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(fs(r,e))return;t.uniform4iv(this.addr,e),ms(r,e)}}s(cfe,"setValueV4i");function hfe(t,e){let r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}s(hfe,"setValueV1ui");function pfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(fs(r,e))return;t.uniform2uiv(this.addr,e),ms(r,e)}}s(pfe,"setValueV2ui");function dfe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(fs(r,e))return;t.uniform3uiv(this.addr,e),ms(r,e)}}s(dfe,"setValueV3ui");function ffe(t,e){let r=this.cache;if(e.x!==void 0)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(fs(r,e))return;t.uniform4uiv(this.addr,e),ms(r,e)}}s(ffe,"setValueV4ui");function mfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n);let a;this.type===t.SAMPLER_2D_SHADOW?(pW.compareFunction=Nue,a=pW):a=Yde,r.setTexture2D(e||a,n)}s(mfe,"setValueT1");function gfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(e||Jde,n)}s(gfe,"setValueT3D1");function yfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(e||Qde,n)}s(yfe,"setValueT6");function vfe(t,e,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(e||Kde,n)}s(vfe,"setValueT2DArray1");function _fe(t){switch(t){case 5126:return efe;case 35664:return tfe;case 35665:return rfe;case 35666:return ife;case 35674:return nfe;case 35675:return afe;case 35676:return ofe;case 5124:case 35670:return sfe;case 35667:case 35671:return lfe;case 35668:case 35672:return ufe;case 35669:case 35673:return cfe;case 5125:return hfe;case 36294:return pfe;case 36295:return dfe;case 36296:return ffe;case 35678:case 36198:case 36298:case 36306:case 35682:return mfe;case 35679:case 36299:case 36307:return gfe;case 35680:case 36300:case 36308:case 36293:return yfe;case 36289:case 36303:case 36311:case 36292:return vfe}}s(_fe,"getSingularSetter");function xfe(t,e){t.uniform1fv(this.addr,e)}s(xfe,"setValueV1fArray");function bfe(t,e){let r=dv(e,this.size,2);t.uniform2fv(this.addr,r)}s(bfe,"setValueV2fArray");function wfe(t,e){let r=dv(e,this.size,3);t.uniform3fv(this.addr,r)}s(wfe,"setValueV3fArray");function Afe(t,e){let r=dv(e,this.size,4);t.uniform4fv(this.addr,r)}s(Afe,"setValueV4fArray");function Sfe(t,e){let r=dv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,r)}s(Sfe,"setValueM2Array");function Mfe(t,e){let r=dv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,r)}s(Mfe,"setValueM3Array");function Efe(t,e){let r=dv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,r)}s(Efe,"setValueM4Array");function Cfe(t,e){t.uniform1iv(this.addr,e)}s(Cfe,"setValueV1iArray");function Ife(t,e){t.uniform2iv(this.addr,e)}s(Ife,"setValueV2iArray");function Tfe(t,e){t.uniform3iv(this.addr,e)}s(Tfe,"setValueV3iArray");function Pfe(t,e){t.uniform4iv(this.addr,e)}s(Pfe,"setValueV4iArray");function Lfe(t,e){t.uniform1uiv(this.addr,e)}s(Lfe,"setValueV1uiArray");function Dfe(t,e){t.uniform2uiv(this.addr,e)}s(Dfe,"setValueV2uiArray");function Rfe(t,e){t.uniform3uiv(this.addr,e)}s(Rfe,"setValueV3uiArray");function Ofe(t,e){t.uniform4uiv(this.addr,e)}s(Ofe,"setValueV4uiArray");function kfe(t,e,r){let i=this.cache,n=e.length,a=BA(r,n);fs(i,a)||(t.uniform1iv(this.addr,a),ms(i,a));for(let o=0;o!==n;++o)r.setTexture2D(e[o]||Yde,a[o])}s(kfe,"setValueT1Array");function Nfe(t,e,r){let i=this.cache,n=e.length,a=BA(r,n);fs(i,a)||(t.uniform1iv(this.addr,a),ms(i,a));for(let o=0;o!==n;++o)r.setTexture3D(e[o]||Jde,a[o])}s(Nfe,"setValueT3DArray");function Ffe(t,e,r){let i=this.cache,n=e.length,a=BA(r,n);fs(i,a)||(t.uniform1iv(this.addr,a),ms(i,a));for(let o=0;o!==n;++o)r.setTextureCube(e[o]||Qde,a[o])}s(Ffe,"setValueT6Array");function Bfe(t,e,r){let i=this.cache,n=e.length,a=BA(r,n);fs(i,a)||(t.uniform1iv(this.addr,a),ms(i,a));for(let o=0;o!==n;++o)r.setTexture2DArray(e[o]||Kde,a[o])}s(Bfe,"setValueT2DArrayArray");function zfe(t){switch(t){case 5126:return xfe;case 35664:return bfe;case 35665:return wfe;case 35666:return Afe;case 35674:return Sfe;case 35675:return Mfe;case 35676:return Efe;case 5124:case 35670:return Cfe;case 35667:case 35671:return Ife;case 35668:case 35672:return Tfe;case 35669:case 35673:return Pfe;case 5125:return Lfe;case 36294:return Dfe;case 36295:return Rfe;case 36296:return Ofe;case 35678:case 36198:case 36298:case 36306:case 35682:return kfe;case 35679:case 36299:case 36307:return Nfe;case 35680:case 36300:case 36308:case 36293:return Ffe;case 36289:case 36303:case 36311:case 36292:return Bfe}}s(zfe,"getPureArraySetter");var Ufe=class{constructor(e,r,i){this.id=e,this.addr=i,this.cache=[],this.type=r.type,this.setValue=_fe(r.type)}};s(Ufe,"SingleUniform");var JGe=Ufe,Vfe=class{constructor(e,r,i){this.id=e,this.addr=i,this.cache=[],this.type=r.type,this.size=r.size,this.setValue=zfe(r.type)}};s(Vfe,"PureArrayUniform");var QGe=Vfe,jfe=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,r,i){let n=this.seq;for(let a=0,o=n.length;a!==o;++a){let l=n[a];l.setValue(e,r[l.id],i)}}};s(jfe,"StructuredUniform");var eHe=jfe,ID=/(\w+)(\])?(\[|\.)?/g;function wO(t,e){t.seq.push(e),t.map[e.id]=e}s(wO,"addUniform");function $fe(t,e,r){let i=t.name,n=i.length;for(ID.lastIndex=0;;){let a=ID.exec(i),o=ID.lastIndex,l=a[1],u=a[2]==="]",c=a[3];if(u&&(l=l|0),c===void 0||c==="["&&o+2===n){wO(r,c===void 0?new JGe(l,t,e):new QGe(l,t,e));break}else{let p=r.map[l];p===void 0&&(p=new eHe(l),wO(r,p)),r=p}}}s($fe,"parseUniform");var Gfe=class{constructor(e,r){this.seq=[],this.map={};let i=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){let a=e.getActiveUniform(r,n),o=e.getUniformLocation(r,a.name);$fe(a,o,this)}}setValue(e,r,i,n){let a=this.map[r];a!==void 0&&a.setValue(e,i,n)}setOptional(e,r,i){let n=r[i];n!==void 0&&this.setValue(e,i,n)}static upload(e,r,i,n){for(let a=0,o=r.length;a!==o;++a){let l=r[a],u=i[l.id];u.needsUpdate!==!1&&l.setValue(e,u.value,n)}}static seqWithValue(e,r){let i=[];for(let n=0,a=e.length;n!==a;++n){let o=e[n];o.id in r&&i.push(o)}return i}};s(Gfe,"WebGLUniforms");var oC=Gfe;function AO(t,e,r){let i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}s(AO,"WebGLShader");var tHe=37297,rHe=0;function Hfe(t,e){let r=t.split(`
`),i=[],n=Math.max(e-6,0),a=Math.min(e+6,r.length);for(let o=n;o<a;o++){let l=o+1;i.push("".concat(l===e?">":" "," ").concat(l,": ").concat(r[o]))}return i.join(`
`)}s(Hfe,"handleSource");var vW=new rn;function qfe(t){Dn._getMatrix(vW,Dn.workingColorSpace,t);let e="mat3( ".concat(vW.elements.map(r=>r.toFixed(4))," )");switch(Dn.getTransfer(t)){case zT:return[e,"LinearTransferOETF"];case ma:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}s(qfe,"getEncodingComponents");function SO(t,e,r){let i=t.getShaderParameter(e,t.COMPILE_STATUS),n=t.getShaderInfoLog(e).trim();if(i&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let o=parseInt(a[1]);return r.toUpperCase()+`

`+n+`

`+Hfe(t.getShaderSource(e),o)}else return n}s(SO,"getShaderErrors");function Wfe(t,e){let r=qfe(e);return["vec4 ".concat(t,"( vec4 value ) {"),"	return ".concat(r[1],"( vec4( value.rgb * ").concat(r[0],", value.a ) );"),"}"].join(`
`)}s(Wfe,"getTexelEncodingFunction");function Xfe(t,e){let r;switch(e){case FUe:r="Linear";break;case BUe:r="Reinhard";break;case zUe:r="Cineon";break;case UUe:r="ACESFilmic";break;case jUe:r="AgX";break;case $Ue:r="Neutral";break;case VUe:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}s(Xfe,"getToneMappingFunction");var dE=new qe;function Zfe(){Dn.getLuminanceCoefficients(dE);let t=dE.x.toFixed(4),e=dE.y.toFixed(4),r=dE.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","	const vec3 weights = vec3( ".concat(t,", ").concat(e,", ").concat(r," );"),"	return dot( weights, rgb );","}"].join(`
`)}s(Zfe,"getLuminanceFunction");function Yfe(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(O1).join(`
`)}s(Yfe,"generateVertexExtensions");function Kfe(t){let e=[];for(let r in t){let i=t[r];i!==!1&&e.push("#define "+r+" "+i)}return e.join(`
`)}s(Kfe,"generateDefines");function Jfe(t,e){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let a=t.getActiveAttrib(e,n),o=a.name,l=1;a.type===t.FLOAT_MAT2&&(l=2),a.type===t.FLOAT_MAT3&&(l=3),a.type===t.FLOAT_MAT4&&(l=4),r[o]={type:a.type,location:t.getAttribLocation(e,o),locationSize:l}}return r}s(Jfe,"fetchAttributeLocations");function O1(t){return t!==""}s(O1,"filterEmptyLine");function MO(t,e){let r=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}s(MO,"replaceLightNums");function EO(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}s(EO,"replaceClippingPlaneNums");var iHe=/^[ \t]*#include +<([\w\d./]+)>/gm;function YT(t){return t.replace(iHe,Qfe)}s(YT,"resolveIncludes");var nHe=new Map;function Qfe(t,e){let r=Zi[e];if(r===void 0){let i=nHe.get(e);if(i!==void 0)r=Zi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return YT(r)}s(Qfe,"includeReplacer");var aHe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function CO(t){return t.replace(aHe,eme)}s(CO,"unrollLoops");function eme(t,e,r,i){let n="";for(let a=parseInt(e);a<parseInt(r);a++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}s(eme,"loopReplacer");function IO(t){let e="precision ".concat(t.precision,` float;
	precision `).concat(t.precision,` int;
	precision `).concat(t.precision,` sampler2D;
	precision `).concat(t.precision,` samplerCube;
	precision `).concat(t.precision,` sampler3D;
	precision `).concat(t.precision,` sampler2DArray;
	precision `).concat(t.precision,` sampler2DShadow;
	precision `).concat(t.precision,` samplerCubeShadow;
	precision `).concat(t.precision,` sampler2DArrayShadow;
	precision `).concat(t.precision,` isampler2D;
	precision `).concat(t.precision,` isampler3D;
	precision `).concat(t.precision,` isamplerCube;
	precision `).concat(t.precision,` isampler2DArray;
	precision `).concat(t.precision,` usampler2D;
	precision `).concat(t.precision,` usampler3D;
	precision `).concat(t.precision,` usamplerCube;
	precision `).concat(t.precision,` usampler2DArray;
	`);return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}s(IO,"generatePrecision");function tme(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Mue?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===gUe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Rd&&(e="SHADOWMAP_TYPE_VSM"),e}s(tme,"generateShadowMapTypeDefine");function rme(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case A_:case S_:e="ENVMAP_TYPE_CUBE";break;case DP:e="ENVMAP_TYPE_CUBE_UV";break}return e}s(rme,"generateEnvMapTypeDefine");function ime(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case S_:e="ENVMAP_MODE_REFRACTION";break}return e}s(ime,"generateEnvMapModeDefine");function nme(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case lB:e="ENVMAP_BLENDING_MULTIPLY";break;case kUe:e="ENVMAP_BLENDING_MIX";break;case NUe:e="ENVMAP_BLENDING_ADD";break}return e}s(nme,"generateEnvMapBlendingDefine");function ame(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let r=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}s(ame,"generateCubeUVSize");function ome(t,e,r,i){let n=t.getContext(),a=r.defines,o=r.vertexShader,l=r.fragmentShader,u=tme(r),c=rme(r),p=ime(r),m=nme(r),y=ame(r),v=Yfe(r),x=Kfe(a),E=n.createProgram(),M,I,P=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(M=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x].filter(O1).join(`
`),M.length>0&&(M+=`
`),I=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x].filter(O1).join(`
`),I.length>0&&(I+=`
`)):(M=[IO(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(O1).join(`
`),I=[IO(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,x,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+p:"",r.envMap?"#define "+m:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==qm?"#define TONE_MAPPING":"",r.toneMapping!==qm?Zi.tonemapping_pars_fragment:"",r.toneMapping!==qm?Xfe("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Zi.colorspace_pars_fragment,Wfe("linearToOutputTexel",r.outputColorSpace),Zfe(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(O1).join(`
`)),o=YT(o),o=MO(o,r),o=EO(o,r),l=YT(l),l=MO(l,r),l=EO(l,r),o=CO(o),l=CO(l),r.isRawShaderMaterial!==!0&&(P=`#version 300 es
`,M=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,I=["#define varying in",r.glslVersion===oO?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===oO?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+I);let C=P+M+o,T=P+I+l,D=AO(n,n.VERTEX_SHADER,C),F=AO(n,n.FRAGMENT_SHADER,T);n.attachShader(E,D),n.attachShader(E,F),r.index0AttributeName!==void 0?n.bindAttribLocation(E,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(E,0,"position"),n.linkProgram(E);function k(q){if(t.debug.checkShaderErrors){let Z=n.getProgramInfoLog(E).trim(),Q=n.getShaderInfoLog(D).trim(),V=n.getShaderInfoLog(F).trim(),ae=!0,Y=!0;if(n.getProgramParameter(E,n.LINK_STATUS)===!1)if(ae=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(n,E,D,F);else{let he=SO(n,D,"vertex"),J=SO(n,F,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(E,n.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+Z+`
`+he+`
`+J)}else Z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Z):(Q===""||V==="")&&(Y=!1);Y&&(q.diagnostics={runnable:ae,programLog:Z,vertexShader:{log:Q,prefix:M},fragmentShader:{log:V,prefix:I}})}n.deleteShader(D),n.deleteShader(F),B=new oC(n,E),U=Jfe(n,E)}s(k,"onFirstUse");let B;this.getUniforms=function(){return B===void 0&&k(this),B};let U;this.getAttributes=function(){return U===void 0&&k(this),U};let z=r.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return z===!1&&(z=n.getProgramParameter(E,tHe)),z},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(E),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=rHe++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=D,this.fragmentShader=F,this}s(ome,"WebGLProgram");var oHe=0,sme=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let r=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(r),a=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){let r=this.materialCache.get(e);for(let i of r)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let r=this.materialCache,i=r.get(e);return i===void 0&&(i=new Set,r.set(e,i)),i}_getShaderStage(e){let r=this.shaderCache,i=r.get(e);return i===void 0&&(i=new lHe(e),r.set(e,i)),i}};s(sme,"WebGLShaderCache");var sHe=sme,lme=class{constructor(e){this.id=oHe++,this.code=e,this.usedTimes=0}};s(lme,"WebGLShaderStage");var lHe=lme;function ume(t,e,r,i,n,a,o){let l=new yB,u=new sHe,c=new Set,p=[],m=n.logarithmicDepthBuffer,y=n.vertexTextures,v=n.precision,x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(U){return c.add(U),U===0?"uv":"uv".concat(U)}s(E,"getChannel");function M(U,z,q,Z,Q){let V=Z.fog,ae=Q.geometry,Y=U.isMeshStandardMaterial?Z.environment:null,he=(U.isMeshStandardMaterial?r:e).get(U.envMap||Y),J=he&&he.mapping===DP?he.image.height:null,ne=x[U.type];U.precision!==null&&(v=n.getMaxPrecision(U.precision),v!==U.precision&&console.warn("THREE.WebGLProgram.getParameters:",U.precision,"not supported, using",v,"instead."));let ee=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,ue=ee!==void 0?ee.length:0,K=0;ae.morphAttributes.position!==void 0&&(K=1),ae.morphAttributes.normal!==void 0&&(K=2),ae.morphAttributes.color!==void 0&&(K=3);let ce,re,se,de;if(ne){let st=Pp[ne];ce=st.vertexShader,re=st.fragmentShader}else ce=U.vertexShader,re=U.fragmentShader,u.update(U),se=u.getVertexShaderID(U),de=u.getFragmentShaderID(U);let we=t.getRenderTarget(),Le=t.state.buffers.depth.getReversed(),fe=Q.isInstancedMesh===!0,Re=Q.isBatchedMesh===!0,me=!!U.map,Ae=!!U.matcap,Ue=!!he,_e=!!U.aoMap,lt=!!U.lightMap,tt=!!U.bumpMap,We=!!U.normalMap,at=!!U.displacementMap,Lt=!!U.emissiveMap,dt=!!U.metalnessMap,Me=!!U.roughnessMap,ve=U.anisotropy>0,Ze=U.clearcoat>0,It=U.dispersion>0,Rt=U.iridescence>0,Et=U.sheen>0,pt=U.transmission>0,Yt=ve&&!!U.anisotropyMap,Kt=Ze&&!!U.clearcoatMap,$t=Ze&&!!U.clearcoatNormalMap,jt=Ze&&!!U.clearcoatRoughnessMap,Nt=Rt&&!!U.iridescenceMap,Fe=Rt&&!!U.iridescenceThicknessMap,Xe=Et&&!!U.sheenColorMap,ht=Et&&!!U.sheenRoughnessMap,rr=!!U.specularMap,ar=!!U.specularColorMap,zr=!!U.specularIntensityMap,Qe=pt&&!!U.transmissionMap,er=pt&&!!U.thicknessMap,Oe=!!U.gradientMap,oe=!!U.alphaMap,le=U.alphaTest>0,Se=!!U.alphaHash,ze=!!U.extensions,De=qm;U.toneMapped&&(we===null||we.isXRRenderTarget===!0)&&(De=t.toneMapping);let yt={shaderID:ne,shaderType:U.type,shaderName:U.name,vertexShader:ce,fragmentShader:re,defines:U.defines,customVertexShaderID:se,customFragmentShaderID:de,isRawShaderMaterial:U.isRawShaderMaterial===!0,glslVersion:U.glslVersion,precision:v,batching:Re,batchingColor:Re&&Q._colorsTexture!==null,instancing:fe,instancingColor:fe&&Q.instanceColor!==null,instancingMorph:fe&&Q.morphTexture!==null,supportsVertexTextures:y,outputColorSpace:we===null?t.outputColorSpace:we.isXRRenderTarget===!0?we.texture.colorSpace:Wy,alphaToCoverage:!!U.alphaToCoverage,map:me,matcap:Ae,envMap:Ue,envMapMode:Ue&&he.mapping,envMapCubeUVHeight:J,aoMap:_e,lightMap:lt,bumpMap:tt,normalMap:We,displacementMap:y&&at,emissiveMap:Lt,normalMapObjectSpace:We&&U.normalMapType===KUe,normalMapTangentSpace:We&&U.normalMapType===mB,metalnessMap:dt,roughnessMap:Me,anisotropy:ve,anisotropyMap:Yt,clearcoat:Ze,clearcoatMap:Kt,clearcoatNormalMap:$t,clearcoatRoughnessMap:jt,dispersion:It,iridescence:Rt,iridescenceMap:Nt,iridescenceThicknessMap:Fe,sheen:Et,sheenColorMap:Xe,sheenRoughnessMap:ht,specularMap:rr,specularColorMap:ar,specularIntensityMap:zr,transmission:pt,transmissionMap:Qe,thicknessMap:er,gradientMap:Oe,opaque:U.transparent===!1&&U.blending===t_&&U.alphaToCoverage===!1,alphaMap:oe,alphaTest:le,alphaHash:Se,combine:U.combine,mapUv:me&&E(U.map.channel),aoMapUv:_e&&E(U.aoMap.channel),lightMapUv:lt&&E(U.lightMap.channel),bumpMapUv:tt&&E(U.bumpMap.channel),normalMapUv:We&&E(U.normalMap.channel),displacementMapUv:at&&E(U.displacementMap.channel),emissiveMapUv:Lt&&E(U.emissiveMap.channel),metalnessMapUv:dt&&E(U.metalnessMap.channel),roughnessMapUv:Me&&E(U.roughnessMap.channel),anisotropyMapUv:Yt&&E(U.anisotropyMap.channel),clearcoatMapUv:Kt&&E(U.clearcoatMap.channel),clearcoatNormalMapUv:$t&&E(U.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:jt&&E(U.clearcoatRoughnessMap.channel),iridescenceMapUv:Nt&&E(U.iridescenceMap.channel),iridescenceThicknessMapUv:Fe&&E(U.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&E(U.sheenColorMap.channel),sheenRoughnessMapUv:ht&&E(U.sheenRoughnessMap.channel),specularMapUv:rr&&E(U.specularMap.channel),specularColorMapUv:ar&&E(U.specularColorMap.channel),specularIntensityMapUv:zr&&E(U.specularIntensityMap.channel),transmissionMapUv:Qe&&E(U.transmissionMap.channel),thicknessMapUv:er&&E(U.thicknessMap.channel),alphaMapUv:oe&&E(U.alphaMap.channel),vertexTangents:!!ae.attributes.tangent&&(We||ve),vertexColors:U.vertexColors,vertexAlphas:U.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,pointsUvs:Q.isPoints===!0&&!!ae.attributes.uv&&(me||oe),fog:!!V,useFog:U.fog===!0,fogExp2:!!V&&V.isFogExp2,flatShading:U.flatShading===!0,sizeAttenuation:U.sizeAttenuation===!0,logarithmicDepthBuffer:m,reverseDepthBuffer:Le,skinning:Q.isSkinnedMesh===!0,morphTargets:ae.morphAttributes.position!==void 0,morphNormals:ae.morphAttributes.normal!==void 0,morphColors:ae.morphAttributes.color!==void 0,morphTargetsCount:ue,morphTextureStride:K,numDirLights:z.directional.length,numPointLights:z.point.length,numSpotLights:z.spot.length,numSpotLightMaps:z.spotLightMap.length,numRectAreaLights:z.rectArea.length,numHemiLights:z.hemi.length,numDirLightShadows:z.directionalShadowMap.length,numPointLightShadows:z.pointShadowMap.length,numSpotLightShadows:z.spotShadowMap.length,numSpotLightShadowsWithMaps:z.numSpotLightShadowsWithMaps,numLightProbes:z.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:U.dithering,shadowMapEnabled:t.shadowMap.enabled&&q.length>0,shadowMapType:t.shadowMap.type,toneMapping:De,decodeVideoTexture:me&&U.map.isVideoTexture===!0&&Dn.getTransfer(U.map.colorSpace)===ma,decodeVideoTextureEmissive:Lt&&U.emissiveMap.isVideoTexture===!0&&Dn.getTransfer(U.emissiveMap.colorSpace)===ma,premultipliedAlpha:U.premultipliedAlpha,doubleSided:U.side===Pu,flipSided:U.side===eu,useDepthPacking:U.depthPacking>=0,depthPacking:U.depthPacking||0,index0AttributeName:U.index0AttributeName,extensionClipCullDistance:ze&&U.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ze&&U.extensions.multiDraw===!0||Re)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:U.customProgramCacheKey()};return yt.vertexUv1s=c.has(1),yt.vertexUv2s=c.has(2),yt.vertexUv3s=c.has(3),c.clear(),yt}s(M,"getParameters");function I(U){let z=[];if(U.shaderID?z.push(U.shaderID):(z.push(U.customVertexShaderID),z.push(U.customFragmentShaderID)),U.defines!==void 0)for(let q in U.defines)z.push(q),z.push(U.defines[q]);return U.isRawShaderMaterial===!1&&(P(z,U),C(z,U),z.push(t.outputColorSpace)),z.push(U.customProgramCacheKey),z.join()}s(I,"getProgramCacheKey");function P(U,z){U.push(z.precision),U.push(z.outputColorSpace),U.push(z.envMapMode),U.push(z.envMapCubeUVHeight),U.push(z.mapUv),U.push(z.alphaMapUv),U.push(z.lightMapUv),U.push(z.aoMapUv),U.push(z.bumpMapUv),U.push(z.normalMapUv),U.push(z.displacementMapUv),U.push(z.emissiveMapUv),U.push(z.metalnessMapUv),U.push(z.roughnessMapUv),U.push(z.anisotropyMapUv),U.push(z.clearcoatMapUv),U.push(z.clearcoatNormalMapUv),U.push(z.clearcoatRoughnessMapUv),U.push(z.iridescenceMapUv),U.push(z.iridescenceThicknessMapUv),U.push(z.sheenColorMapUv),U.push(z.sheenRoughnessMapUv),U.push(z.specularMapUv),U.push(z.specularColorMapUv),U.push(z.specularIntensityMapUv),U.push(z.transmissionMapUv),U.push(z.thicknessMapUv),U.push(z.combine),U.push(z.fogExp2),U.push(z.sizeAttenuation),U.push(z.morphTargetsCount),U.push(z.morphAttributeCount),U.push(z.numDirLights),U.push(z.numPointLights),U.push(z.numSpotLights),U.push(z.numSpotLightMaps),U.push(z.numHemiLights),U.push(z.numRectAreaLights),U.push(z.numDirLightShadows),U.push(z.numPointLightShadows),U.push(z.numSpotLightShadows),U.push(z.numSpotLightShadowsWithMaps),U.push(z.numLightProbes),U.push(z.shadowMapType),U.push(z.toneMapping),U.push(z.numClippingPlanes),U.push(z.numClipIntersection),U.push(z.depthPacking)}s(P,"getProgramCacheKeyParameters");function C(U,z){l.disableAll(),z.supportsVertexTextures&&l.enable(0),z.instancing&&l.enable(1),z.instancingColor&&l.enable(2),z.instancingMorph&&l.enable(3),z.matcap&&l.enable(4),z.envMap&&l.enable(5),z.normalMapObjectSpace&&l.enable(6),z.normalMapTangentSpace&&l.enable(7),z.clearcoat&&l.enable(8),z.iridescence&&l.enable(9),z.alphaTest&&l.enable(10),z.vertexColors&&l.enable(11),z.vertexAlphas&&l.enable(12),z.vertexUv1s&&l.enable(13),z.vertexUv2s&&l.enable(14),z.vertexUv3s&&l.enable(15),z.vertexTangents&&l.enable(16),z.anisotropy&&l.enable(17),z.alphaHash&&l.enable(18),z.batching&&l.enable(19),z.dispersion&&l.enable(20),z.batchingColor&&l.enable(21),U.push(l.mask),l.disableAll(),z.fog&&l.enable(0),z.useFog&&l.enable(1),z.flatShading&&l.enable(2),z.logarithmicDepthBuffer&&l.enable(3),z.reverseDepthBuffer&&l.enable(4),z.skinning&&l.enable(5),z.morphTargets&&l.enable(6),z.morphNormals&&l.enable(7),z.morphColors&&l.enable(8),z.premultipliedAlpha&&l.enable(9),z.shadowMapEnabled&&l.enable(10),z.doubleSided&&l.enable(11),z.flipSided&&l.enable(12),z.useDepthPacking&&l.enable(13),z.dithering&&l.enable(14),z.transmission&&l.enable(15),z.sheen&&l.enable(16),z.opaque&&l.enable(17),z.pointsUvs&&l.enable(18),z.decodeVideoTexture&&l.enable(19),z.decodeVideoTextureEmissive&&l.enable(20),z.alphaToCoverage&&l.enable(21),U.push(l.mask)}s(C,"getProgramCacheKeyBooleans");function T(U){let z=x[U.type],q;if(z){let Z=Pp[z];q=bVe.clone(Z.uniforms)}else q=U.uniforms;return q}s(T,"getUniforms");function D(U,z){let q;for(let Z=0,Q=p.length;Z<Q;Z++){let V=p[Z];if(V.cacheKey===z){q=V,++q.usedTimes;break}}return q===void 0&&(q=new ome(t,z,U,a),p.push(q)),q}s(D,"acquireProgram");function F(U){if(--U.usedTimes===0){let z=p.indexOf(U);p[z]=p[p.length-1],p.pop(),U.destroy()}}s(F,"releaseProgram");function k(U){u.remove(U)}s(k,"releaseShaderCache");function B(){u.dispose()}return s(B,"dispose"),{getParameters:M,getProgramCacheKey:I,getUniforms:T,acquireProgram:D,releaseProgram:F,releaseShaderCache:k,programs:p,dispose:B}}s(ume,"WebGLPrograms");function cme(){let t=new WeakMap;function e(o){return t.has(o)}s(e,"has");function r(o){let l=t.get(o);return l===void 0&&(l={},t.set(o,l)),l}s(r,"get");function i(o){t.delete(o)}s(i,"remove");function n(o,l,u){t.get(o)[l]=u}s(n,"update");function a(){t=new WeakMap}return s(a,"dispose"),{has:e,get:r,remove:i,update:n,dispose:a}}s(cme,"WebGLProperties");function hme(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}s(hme,"painterSortStable");function TO(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}s(TO,"reversePainterSortStable");function PO(){let t=[],e=0,r=[],i=[],n=[];function a(){e=0,r.length=0,i.length=0,n.length=0}s(a,"init");function o(m,y,v,x,E,M){let I=t[e];return I===void 0?(I={id:m.id,object:m,geometry:y,material:v,groupOrder:x,renderOrder:m.renderOrder,z:E,group:M},t[e]=I):(I.id=m.id,I.object=m,I.geometry=y,I.material=v,I.groupOrder=x,I.renderOrder=m.renderOrder,I.z=E,I.group=M),e++,I}s(o,"getNextRenderItem");function l(m,y,v,x,E,M){let I=o(m,y,v,x,E,M);v.transmission>0?i.push(I):v.transparent===!0?n.push(I):r.push(I)}s(l,"push");function u(m,y,v,x,E,M){let I=o(m,y,v,x,E,M);v.transmission>0?i.unshift(I):v.transparent===!0?n.unshift(I):r.unshift(I)}s(u,"unshift");function c(m,y){r.length>1&&r.sort(m||hme),i.length>1&&i.sort(y||TO),n.length>1&&n.sort(y||TO)}s(c,"sort");function p(){for(let m=e,y=t.length;m<y;m++){let v=t[m];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return s(p,"finish"),{opaque:r,transmissive:i,transparent:n,init:a,push:l,unshift:u,finish:p,sort:c}}s(PO,"WebGLRenderList");function pme(){let t=new WeakMap;function e(i,n){let a=t.get(i),o;return a===void 0?(o=new PO,t.set(i,[o])):n>=a.length?(o=new PO,a.push(o)):o=a[n],o}s(e,"get");function r(){t=new WeakMap}return s(r,"dispose"),{get:e,dispose:r}}s(pme,"WebGLRenderLists");function dme(){let t={};return{get:s(function(e){if(t[e.id]!==void 0)return t[e.id];let r;switch(e.type){case"DirectionalLight":r={direction:new qe,color:new oi};break;case"SpotLight":r={position:new qe,direction:new qe,color:new oi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new qe,color:new oi,distance:0,decay:0};break;case"HemisphereLight":r={direction:new qe,skyColor:new oi,groundColor:new oi};break;case"RectAreaLight":r={color:new oi,position:new qe,halfWidth:new qe,halfHeight:new qe};break}return t[e.id]=r,r},"get")}}s(dme,"UniformsCache");function fme(){let t={};return{get:s(function(e){if(t[e.id]!==void 0)return t[e.id];let r;switch(e.type){case"DirectionalLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=r,r},"get")}}s(fme,"ShadowUniformsCache");var uHe=0;function mme(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}s(mme,"shadowCastingAndTexturingLightsFirst");function gme(t){let e=new dme,r=fme(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new qe);let n=new qe,a=new Ri,o=new Ri;function l(c){let p=0,m=0,y=0;for(let U=0;U<9;U++)i.probe[U].set(0,0,0);let v=0,x=0,E=0,M=0,I=0,P=0,C=0,T=0,D=0,F=0,k=0;c.sort(mme);for(let U=0,z=c.length;U<z;U++){let q=c[U],Z=q.color,Q=q.intensity,V=q.distance,ae=q.shadow&&q.shadow.map?q.shadow.map.texture:null;if(q.isAmbientLight)p+=Z.r*Q,m+=Z.g*Q,y+=Z.b*Q;else if(q.isLightProbe){for(let Y=0;Y<9;Y++)i.probe[Y].addScaledVector(q.sh.coefficients[Y],Q);k++}else if(q.isDirectionalLight){let Y=e.get(q);if(Y.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){let he=q.shadow,J=r.get(q);J.shadowIntensity=he.intensity,J.shadowBias=he.bias,J.shadowNormalBias=he.normalBias,J.shadowRadius=he.radius,J.shadowMapSize=he.mapSize,i.directionalShadow[v]=J,i.directionalShadowMap[v]=ae,i.directionalShadowMatrix[v]=q.shadow.matrix,P++}i.directional[v]=Y,v++}else if(q.isSpotLight){let Y=e.get(q);Y.position.setFromMatrixPosition(q.matrixWorld),Y.color.copy(Z).multiplyScalar(Q),Y.distance=V,Y.coneCos=Math.cos(q.angle),Y.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),Y.decay=q.decay,i.spot[E]=Y;let he=q.shadow;if(q.map&&(i.spotLightMap[D]=q.map,D++,he.updateMatrices(q),q.castShadow&&F++),i.spotLightMatrix[E]=he.matrix,q.castShadow){let J=r.get(q);J.shadowIntensity=he.intensity,J.shadowBias=he.bias,J.shadowNormalBias=he.normalBias,J.shadowRadius=he.radius,J.shadowMapSize=he.mapSize,i.spotShadow[E]=J,i.spotShadowMap[E]=ae,T++}E++}else if(q.isRectAreaLight){let Y=e.get(q);Y.color.copy(Z).multiplyScalar(Q),Y.halfWidth.set(q.width*.5,0,0),Y.halfHeight.set(0,q.height*.5,0),i.rectArea[M]=Y,M++}else if(q.isPointLight){let Y=e.get(q);if(Y.color.copy(q.color).multiplyScalar(q.intensity),Y.distance=q.distance,Y.decay=q.decay,q.castShadow){let he=q.shadow,J=r.get(q);J.shadowIntensity=he.intensity,J.shadowBias=he.bias,J.shadowNormalBias=he.normalBias,J.shadowRadius=he.radius,J.shadowMapSize=he.mapSize,J.shadowCameraNear=he.camera.near,J.shadowCameraFar=he.camera.far,i.pointShadow[x]=J,i.pointShadowMap[x]=ae,i.pointShadowMatrix[x]=q.shadow.matrix,C++}i.point[x]=Y,x++}else if(q.isHemisphereLight){let Y=e.get(q);Y.skyColor.copy(q.color).multiplyScalar(Q),Y.groundColor.copy(q.groundColor).multiplyScalar(Q),i.hemi[I]=Y,I++}}M>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Pr.LTC_FLOAT_1,i.rectAreaLTC2=Pr.LTC_FLOAT_2):(i.rectAreaLTC1=Pr.LTC_HALF_1,i.rectAreaLTC2=Pr.LTC_HALF_2)),i.ambient[0]=p,i.ambient[1]=m,i.ambient[2]=y;let B=i.hash;(B.directionalLength!==v||B.pointLength!==x||B.spotLength!==E||B.rectAreaLength!==M||B.hemiLength!==I||B.numDirectionalShadows!==P||B.numPointShadows!==C||B.numSpotShadows!==T||B.numSpotMaps!==D||B.numLightProbes!==k)&&(i.directional.length=v,i.spot.length=E,i.rectArea.length=M,i.point.length=x,i.hemi.length=I,i.directionalShadow.length=P,i.directionalShadowMap.length=P,i.pointShadow.length=C,i.pointShadowMap.length=C,i.spotShadow.length=T,i.spotShadowMap.length=T,i.directionalShadowMatrix.length=P,i.pointShadowMatrix.length=C,i.spotLightMatrix.length=T+D-F,i.spotLightMap.length=D,i.numSpotLightShadowsWithMaps=F,i.numLightProbes=k,B.directionalLength=v,B.pointLength=x,B.spotLength=E,B.rectAreaLength=M,B.hemiLength=I,B.numDirectionalShadows=P,B.numPointShadows=C,B.numSpotShadows=T,B.numSpotMaps=D,B.numLightProbes=k,i.version=uHe++)}s(l,"setup");function u(c,p){let m=0,y=0,v=0,x=0,E=0,M=p.matrixWorldInverse;for(let I=0,P=c.length;I<P;I++){let C=c[I];if(C.isDirectionalLight){let T=i.directional[m];T.direction.setFromMatrixPosition(C.matrixWorld),n.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(M),m++}else if(C.isSpotLight){let T=i.spot[v];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(M),T.direction.setFromMatrixPosition(C.matrixWorld),n.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(M),v++}else if(C.isRectAreaLight){let T=i.rectArea[x];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(M),o.identity(),a.copy(C.matrixWorld),a.premultiply(M),o.extractRotation(a),T.halfWidth.set(C.width*.5,0,0),T.halfHeight.set(0,C.height*.5,0),T.halfWidth.applyMatrix4(o),T.halfHeight.applyMatrix4(o),x++}else if(C.isPointLight){let T=i.point[y];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(M),y++}else if(C.isHemisphereLight){let T=i.hemi[E];T.direction.setFromMatrixPosition(C.matrixWorld),T.direction.transformDirection(M),E++}}}return s(u,"setupView"),{setup:l,setupView:u,state:i}}s(gme,"WebGLLights");function LO(t){let e=new gme(t),r=[],i=[];function n(p){c.camera=p,r.length=0,i.length=0}s(n,"init");function a(p){r.push(p)}s(a,"pushLight");function o(p){i.push(p)}s(o,"pushShadow");function l(){e.setup(r)}s(l,"setupLights");function u(p){e.setupView(r,p)}s(u,"setupLightsView");let c={lightsArray:r,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:n,state:c,setupLights:l,setupLightsView:u,pushLight:a,pushShadow:o}}s(LO,"WebGLRenderState");function yme(t){let e=new WeakMap;function r(n,a=0){let o=e.get(n),l;return o===void 0?(l=new LO(t),e.set(n,[l])):a>=o.length?(l=new LO(t),o.push(l)):l=o[a],l}s(r,"get");function i(){e=new WeakMap}return s(i,"dispose"),{get:r,dispose:i}}s(yme,"WebGLRenderStates");var cHe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,hHe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function vme(t,e,r){let i=new RA,n=new Jt,a=new Jt,o=new Jn,l=new qVe({depthPacking:YUe}),u=new WVe,c={},p=r.maxTextureSize,m={[Qp]:eu,[eu]:Qp,[Pu]:Pu},y=new bc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Jt},radius:{value:4}},vertexShader:cHe,fragmentShader:hHe}),v=y.clone();v.defines.HORIZONTAL_PASS=1;let x=new Vs;x.setAttribute("position",new Zo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let E=new Tn(x,y),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Mue;let I=this.type;this.render=function(F,k,B){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||F.length===0)return;let U=t.getRenderTarget(),z=t.getActiveCubeFace(),q=t.getActiveMipmapLevel(),Z=t.state;Z.setBlending(Hm),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);let Q=I!==Rd&&this.type===Rd,V=I===Rd&&this.type!==Rd;for(let ae=0,Y=F.length;ae<Y;ae++){let he=F[ae],J=he.shadow;if(J===void 0){console.warn("THREE.WebGLShadowMap:",he,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;n.copy(J.mapSize);let ne=J.getFrameExtents();if(n.multiply(ne),a.copy(J.mapSize),(n.x>p||n.y>p)&&(n.x>p&&(a.x=Math.floor(p/ne.x),n.x=a.x*ne.x,J.mapSize.x=a.x),n.y>p&&(a.y=Math.floor(p/ne.y),n.y=a.y*ne.y,J.mapSize.y=a.y)),J.map===null||Q===!0||V===!0){let ue=this.type!==Rd?{minFilter:_c,magFilter:_c}:{};J.map!==null&&J.map.dispose(),J.map=new Qm(n.x,n.y,ue),J.map.texture.name=he.name+".shadowMap",J.camera.updateProjectionMatrix()}t.setRenderTarget(J.map),t.clear();let ee=J.getViewportCount();for(let ue=0;ue<ee;ue++){let K=J.getViewport(ue);o.set(a.x*K.x,a.y*K.y,a.x*K.z,a.y*K.w),Z.viewport(o),J.updateMatrices(he,ue),i=J.getFrustum(),T(k,B,J.camera,he,this.type)}J.isPointLightShadow!==!0&&this.type===Rd&&P(J,B),J.needsUpdate=!1}I=this.type,M.needsUpdate=!1,t.setRenderTarget(U,z,q)};function P(F,k){let B=e.update(E);y.defines.VSM_SAMPLES!==F.blurSamples&&(y.defines.VSM_SAMPLES=F.blurSamples,v.defines.VSM_SAMPLES=F.blurSamples,y.needsUpdate=!0,v.needsUpdate=!0),F.mapPass===null&&(F.mapPass=new Qm(n.x,n.y)),y.uniforms.shadow_pass.value=F.map.texture,y.uniforms.resolution.value=F.mapSize,y.uniforms.radius.value=F.radius,t.setRenderTarget(F.mapPass),t.clear(),t.renderBufferDirect(k,null,B,y,E,null),v.uniforms.shadow_pass.value=F.mapPass.texture,v.uniforms.resolution.value=F.mapSize,v.uniforms.radius.value=F.radius,t.setRenderTarget(F.map),t.clear(),t.renderBufferDirect(k,null,B,v,E,null)}s(P,"VSMPass");function C(F,k,B,U){let z=null,q=B.isPointLight===!0?F.customDistanceMaterial:F.customDepthMaterial;if(q!==void 0)z=q;else if(z=B.isPointLight===!0?u:l,t.localClippingEnabled&&k.clipShadows===!0&&Array.isArray(k.clippingPlanes)&&k.clippingPlanes.length!==0||k.displacementMap&&k.displacementScale!==0||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0){let Z=z.uuid,Q=k.uuid,V=c[Z];V===void 0&&(V={},c[Z]=V);let ae=V[Q];ae===void 0&&(ae=z.clone(),V[Q]=ae,k.addEventListener("dispose",D)),z=ae}if(z.visible=k.visible,z.wireframe=k.wireframe,U===Rd?z.side=k.shadowSide!==null?k.shadowSide:k.side:z.side=k.shadowSide!==null?k.shadowSide:m[k.side],z.alphaMap=k.alphaMap,z.alphaTest=k.alphaTest,z.map=k.map,z.clipShadows=k.clipShadows,z.clippingPlanes=k.clippingPlanes,z.clipIntersection=k.clipIntersection,z.displacementMap=k.displacementMap,z.displacementScale=k.displacementScale,z.displacementBias=k.displacementBias,z.wireframeLinewidth=k.wireframeLinewidth,z.linewidth=k.linewidth,B.isPointLight===!0&&z.isMeshDistanceMaterial===!0){let Z=t.properties.get(z);Z.light=B}return z}s(C,"getDepthMaterial");function T(F,k,B,U,z){if(F.visible===!1)return;if(F.layers.test(k.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&z===Rd)&&(!F.frustumCulled||i.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,F.matrixWorld);let Z=e.update(F),Q=F.material;if(Array.isArray(Q)){let V=Z.groups;for(let ae=0,Y=V.length;ae<Y;ae++){let he=V[ae],J=Q[he.materialIndex];if(J&&J.visible){let ne=C(F,J,U,z);F.onBeforeShadow(t,F,k,B,Z,ne,he),t.renderBufferDirect(B,null,Z,ne,F,he),F.onAfterShadow(t,F,k,B,Z,ne,he)}}}else if(Q.visible){let V=C(F,Q,U,z);F.onBeforeShadow(t,F,k,B,Z,V,null),t.renderBufferDirect(B,null,Z,V,F,null),F.onAfterShadow(t,F,k,B,Z,V,null)}}let q=F.children;for(let Z=0,Q=q.length;Z<Q;Z++)T(q[Z],k,B,U,z)}s(T,"renderObject");function D(F){F.target.removeEventListener("dispose",D);for(let k in c){let B=c[k],U=F.target.uuid;U in B&&(B[U].dispose(),delete B[U])}}s(D,"onMaterialDispose")}s(vme,"WebGLShadowMap");var pHe={[wR]:AR,[SR]:CR,[MR]:IR,[w_]:ER,[AR]:wR,[CR]:SR,[IR]:MR,[ER]:w_};function _me(t,e){function r(){let Qe=!1,er=new Jn,Oe=null,oe=new Jn(0,0,0,0);return{setMask:s(function(le){Oe!==le&&!Qe&&(t.colorMask(le,le,le,le),Oe=le)},"setMask"),setLocked:s(function(le){Qe=le},"setLocked"),setClear:s(function(le,Se,ze,De,yt){yt===!0&&(le*=De,Se*=De,ze*=De),er.set(le,Se,ze,De),oe.equals(er)===!1&&(t.clearColor(le,Se,ze,De),oe.copy(er))},"setClear"),reset:s(function(){Qe=!1,Oe=null,oe.set(-1,0,0,0)},"reset")}}s(r,"ColorBuffer");function i(){let Qe=!1,er=!1,Oe=null,oe=null,le=null;return{setReversed:s(function(Se){if(er!==Se){let ze=e.get("EXT_clip_control");er?ze.clipControlEXT(ze.LOWER_LEFT_EXT,ze.ZERO_TO_ONE_EXT):ze.clipControlEXT(ze.LOWER_LEFT_EXT,ze.NEGATIVE_ONE_TO_ONE_EXT);let De=le;le=null,this.setClear(De)}er=Se},"setReversed"),getReversed:s(function(){return er},"getReversed"),setTest:s(function(Se){Se?we(t.DEPTH_TEST):Le(t.DEPTH_TEST)},"setTest"),setMask:s(function(Se){Oe!==Se&&!Qe&&(t.depthMask(Se),Oe=Se)},"setMask"),setFunc:s(function(Se){if(er&&(Se=pHe[Se]),oe!==Se){switch(Se){case wR:t.depthFunc(t.NEVER);break;case AR:t.depthFunc(t.ALWAYS);break;case SR:t.depthFunc(t.LESS);break;case w_:t.depthFunc(t.LEQUAL);break;case MR:t.depthFunc(t.EQUAL);break;case ER:t.depthFunc(t.GEQUAL);break;case CR:t.depthFunc(t.GREATER);break;case IR:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}oe=Se}},"setFunc"),setLocked:s(function(Se){Qe=Se},"setLocked"),setClear:s(function(Se){le!==Se&&(er&&(Se=1-Se),t.clearDepth(Se),le=Se)},"setClear"),reset:s(function(){Qe=!1,Oe=null,oe=null,le=null,er=!1},"reset")}}s(i,"DepthBuffer");function n(){let Qe=!1,er=null,Oe=null,oe=null,le=null,Se=null,ze=null,De=null,yt=null;return{setTest:s(function(st){Qe||(st?we(t.STENCIL_TEST):Le(t.STENCIL_TEST))},"setTest"),setMask:s(function(st){er!==st&&!Qe&&(t.stencilMask(st),er=st)},"setMask"),setFunc:s(function(st,kt,mt){(Oe!==st||oe!==kt||le!==mt)&&(t.stencilFunc(st,kt,mt),Oe=st,oe=kt,le=mt)},"setFunc"),setOp:s(function(st,kt,mt){(Se!==st||ze!==kt||De!==mt)&&(t.stencilOp(st,kt,mt),Se=st,ze=kt,De=mt)},"setOp"),setLocked:s(function(st){Qe=st},"setLocked"),setClear:s(function(st){yt!==st&&(t.clearStencil(st),yt=st)},"setClear"),reset:s(function(){Qe=!1,er=null,Oe=null,oe=null,le=null,Se=null,ze=null,De=null,yt=null},"reset")}}s(n,"StencilBuffer");let a=new r,o=new i,l=new n,u=new WeakMap,c=new WeakMap,p={},m={},y=new WeakMap,v=[],x=null,E=!1,M=null,I=null,P=null,C=null,T=null,D=null,F=null,k=new oi(0,0,0),B=0,U=!1,z=null,q=null,Z=null,Q=null,V=null,ae=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Y=!1,he=0,J=t.getParameter(t.VERSION);J.indexOf("WebGL")!==-1?(he=parseFloat(/^WebGL (\d)/.exec(J)[1]),Y=he>=1):J.indexOf("OpenGL ES")!==-1&&(he=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),Y=he>=2);let ne=null,ee={},ue=t.getParameter(t.SCISSOR_BOX),K=t.getParameter(t.VIEWPORT),ce=new Jn().fromArray(ue),re=new Jn().fromArray(K);function se(Qe,er,Oe,oe){let le=new Uint8Array(4),Se=t.createTexture();t.bindTexture(Qe,Se),t.texParameteri(Qe,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(Qe,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let ze=0;ze<Oe;ze++)Qe===t.TEXTURE_3D||Qe===t.TEXTURE_2D_ARRAY?t.texImage3D(er,0,t.RGBA,1,1,oe,0,t.RGBA,t.UNSIGNED_BYTE,le):t.texImage2D(er+ze,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,le);return Se}s(se,"createTexture");let de={};de[t.TEXTURE_2D]=se(t.TEXTURE_2D,t.TEXTURE_2D,1),de[t.TEXTURE_CUBE_MAP]=se(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),de[t.TEXTURE_2D_ARRAY]=se(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),de[t.TEXTURE_3D]=se(t.TEXTURE_3D,t.TEXTURE_3D,1,1),a.setClear(0,0,0,1),o.setClear(1),l.setClear(0),we(t.DEPTH_TEST),o.setFunc(w_),tt(!1),We(mq),we(t.CULL_FACE),_e(Hm);function we(Qe){p[Qe]!==!0&&(t.enable(Qe),p[Qe]=!0)}s(we,"enable");function Le(Qe){p[Qe]!==!1&&(t.disable(Qe),p[Qe]=!1)}s(Le,"disable");function fe(Qe,er){return m[Qe]!==er?(t.bindFramebuffer(Qe,er),m[Qe]=er,Qe===t.DRAW_FRAMEBUFFER&&(m[t.FRAMEBUFFER]=er),Qe===t.FRAMEBUFFER&&(m[t.DRAW_FRAMEBUFFER]=er),!0):!1}s(fe,"bindFramebuffer");function Re(Qe,er){let Oe=v,oe=!1;if(Qe){Oe=y.get(er),Oe===void 0&&(Oe=[],y.set(er,Oe));let le=Qe.textures;if(Oe.length!==le.length||Oe[0]!==t.COLOR_ATTACHMENT0){for(let Se=0,ze=le.length;Se<ze;Se++)Oe[Se]=t.COLOR_ATTACHMENT0+Se;Oe.length=le.length,oe=!0}}else Oe[0]!==t.BACK&&(Oe[0]=t.BACK,oe=!0);oe&&t.drawBuffers(Oe)}s(Re,"drawBuffers");function me(Qe){return x!==Qe?(t.useProgram(Qe),x=Qe,!0):!1}s(me,"useProgram");let Ae={[dy]:t.FUNC_ADD,[vUe]:t.FUNC_SUBTRACT,[_Ue]:t.FUNC_REVERSE_SUBTRACT};Ae[xUe]=t.MIN,Ae[bUe]=t.MAX;let Ue={[wUe]:t.ZERO,[AUe]:t.ONE,[SUe]:t.SRC_COLOR,[xR]:t.SRC_ALPHA,[PUe]:t.SRC_ALPHA_SATURATE,[IUe]:t.DST_COLOR,[EUe]:t.DST_ALPHA,[MUe]:t.ONE_MINUS_SRC_COLOR,[bR]:t.ONE_MINUS_SRC_ALPHA,[TUe]:t.ONE_MINUS_DST_COLOR,[CUe]:t.ONE_MINUS_DST_ALPHA,[LUe]:t.CONSTANT_COLOR,[DUe]:t.ONE_MINUS_CONSTANT_COLOR,[RUe]:t.CONSTANT_ALPHA,[OUe]:t.ONE_MINUS_CONSTANT_ALPHA};function _e(Qe,er,Oe,oe,le,Se,ze,De,yt,st){if(Qe===Hm){E===!0&&(Le(t.BLEND),E=!1);return}if(E===!1&&(we(t.BLEND),E=!0),Qe!==yUe){if(Qe!==M||st!==U){if((I!==dy||T!==dy)&&(t.blendEquation(t.FUNC_ADD),I=dy,T=dy),st)switch(Qe){case t_:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case gq:t.blendFunc(t.ONE,t.ONE);break;case yq:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case vq:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Qe);break}else switch(Qe){case t_:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case gq:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case yq:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case vq:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Qe);break}P=null,C=null,D=null,F=null,k.set(0,0,0),B=0,M=Qe,U=st}return}le=le||er,Se=Se||Oe,ze=ze||oe,(er!==I||le!==T)&&(t.blendEquationSeparate(Ae[er],Ae[le]),I=er,T=le),(Oe!==P||oe!==C||Se!==D||ze!==F)&&(t.blendFuncSeparate(Ue[Oe],Ue[oe],Ue[Se],Ue[ze]),P=Oe,C=oe,D=Se,F=ze),(De.equals(k)===!1||yt!==B)&&(t.blendColor(De.r,De.g,De.b,yt),k.copy(De),B=yt),M=Qe,U=!1}s(_e,"setBlending");function lt(Qe,er){Qe.side===Pu?Le(t.CULL_FACE):we(t.CULL_FACE);let Oe=Qe.side===eu;er&&(Oe=!Oe),tt(Oe),Qe.blending===t_&&Qe.transparent===!1?_e(Hm):_e(Qe.blending,Qe.blendEquation,Qe.blendSrc,Qe.blendDst,Qe.blendEquationAlpha,Qe.blendSrcAlpha,Qe.blendDstAlpha,Qe.blendColor,Qe.blendAlpha,Qe.premultipliedAlpha),o.setFunc(Qe.depthFunc),o.setTest(Qe.depthTest),o.setMask(Qe.depthWrite),a.setMask(Qe.colorWrite);let oe=Qe.stencilWrite;l.setTest(oe),oe&&(l.setMask(Qe.stencilWriteMask),l.setFunc(Qe.stencilFunc,Qe.stencilRef,Qe.stencilFuncMask),l.setOp(Qe.stencilFail,Qe.stencilZFail,Qe.stencilZPass)),Lt(Qe.polygonOffset,Qe.polygonOffsetFactor,Qe.polygonOffsetUnits),Qe.alphaToCoverage===!0?we(t.SAMPLE_ALPHA_TO_COVERAGE):Le(t.SAMPLE_ALPHA_TO_COVERAGE)}s(lt,"setMaterial");function tt(Qe){z!==Qe&&(Qe?t.frontFace(t.CW):t.frontFace(t.CCW),z=Qe)}s(tt,"setFlipSided");function We(Qe){Qe!==fUe?(we(t.CULL_FACE),Qe!==q&&(Qe===mq?t.cullFace(t.BACK):Qe===mUe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Le(t.CULL_FACE),q=Qe}s(We,"setCullFace");function at(Qe){Qe!==Z&&(Y&&t.lineWidth(Qe),Z=Qe)}s(at,"setLineWidth");function Lt(Qe,er,Oe){Qe?(we(t.POLYGON_OFFSET_FILL),(Q!==er||V!==Oe)&&(t.polygonOffset(er,Oe),Q=er,V=Oe)):Le(t.POLYGON_OFFSET_FILL)}s(Lt,"setPolygonOffset");function dt(Qe){Qe?we(t.SCISSOR_TEST):Le(t.SCISSOR_TEST)}s(dt,"setScissorTest");function Me(Qe){Qe===void 0&&(Qe=t.TEXTURE0+ae-1),ne!==Qe&&(t.activeTexture(Qe),ne=Qe)}s(Me,"activeTexture");function ve(Qe,er,Oe){Oe===void 0&&(ne===null?Oe=t.TEXTURE0+ae-1:Oe=ne);let oe=ee[Oe];oe===void 0&&(oe={type:void 0,texture:void 0},ee[Oe]=oe),(oe.type!==Qe||oe.texture!==er)&&(ne!==Oe&&(t.activeTexture(Oe),ne=Oe),t.bindTexture(Qe,er||de[Qe]),oe.type=Qe,oe.texture=er)}s(ve,"bindTexture");function Ze(){let Qe=ee[ne];Qe!==void 0&&Qe.type!==void 0&&(t.bindTexture(Qe.type,null),Qe.type=void 0,Qe.texture=void 0)}s(Ze,"unbindTexture");function It(){try{t.compressedTexImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(It,"compressedTexImage2D");function Rt(){try{t.compressedTexImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Rt,"compressedTexImage3D");function Et(){try{t.texSubImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Et,"texSubImage2D");function pt(){try{t.texSubImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(pt,"texSubImage3D");function Yt(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Yt,"compressedTexSubImage2D");function Kt(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Kt,"compressedTexSubImage3D");function $t(){try{t.texStorage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s($t,"texStorage2D");function jt(){try{t.texStorage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(jt,"texStorage3D");function Nt(){try{t.texImage2D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Nt,"texImage2D");function Fe(){try{t.texImage3D.apply(t,arguments)}catch(Qe){console.error("THREE.WebGLState:",Qe)}}s(Fe,"texImage3D");function Xe(Qe){ce.equals(Qe)===!1&&(t.scissor(Qe.x,Qe.y,Qe.z,Qe.w),ce.copy(Qe))}s(Xe,"scissor");function ht(Qe){re.equals(Qe)===!1&&(t.viewport(Qe.x,Qe.y,Qe.z,Qe.w),re.copy(Qe))}s(ht,"viewport");function rr(Qe,er){let Oe=c.get(er);Oe===void 0&&(Oe=new WeakMap,c.set(er,Oe));let oe=Oe.get(Qe);oe===void 0&&(oe=t.getUniformBlockIndex(er,Qe.name),Oe.set(Qe,oe))}s(rr,"updateUBOMapping");function ar(Qe,er){let Oe=c.get(er).get(Qe);u.get(er)!==Oe&&(t.uniformBlockBinding(er,Oe,Qe.__bindingPointIndex),u.set(er,Oe))}s(ar,"uniformBlockBinding");function zr(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),p={},ne=null,ee={},m={},y=new WeakMap,v=[],x=null,E=!1,M=null,I=null,P=null,C=null,T=null,D=null,F=null,k=new oi(0,0,0),B=0,U=!1,z=null,q=null,Z=null,Q=null,V=null,ce.set(0,0,t.canvas.width,t.canvas.height),re.set(0,0,t.canvas.width,t.canvas.height),a.reset(),o.reset(),l.reset()}return s(zr,"reset"),{buffers:{color:a,depth:o,stencil:l},enable:we,disable:Le,bindFramebuffer:fe,drawBuffers:Re,useProgram:me,setBlending:_e,setMaterial:lt,setFlipSided:tt,setCullFace:We,setLineWidth:at,setPolygonOffset:Lt,setScissorTest:dt,activeTexture:Me,bindTexture:ve,unbindTexture:Ze,compressedTexImage2D:It,compressedTexImage3D:Rt,texImage2D:Nt,texImage3D:Fe,updateUBOMapping:rr,uniformBlockBinding:ar,texStorage2D:$t,texStorage3D:jt,texSubImage2D:Et,texSubImage3D:pt,compressedTexSubImage2D:Yt,compressedTexSubImage3D:Kt,scissor:Xe,viewport:ht,reset:zr}}s(_me,"WebGLState");function xme(t,e,r,i,n,a,o){let l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Jt,p=new WeakMap,m,y=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(Me,ve){return v?new OffscreenCanvas(Me,ve):I_("canvas")}s(x,"createCanvas");function E(Me,ve,Ze){let It=1,Rt=dt(Me);if((Rt.width>Ze||Rt.height>Ze)&&(It=Ze/Math.max(Rt.width,Rt.height)),It<1)if(typeof HTMLImageElement<"u"&&Me instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Me instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Me instanceof ImageBitmap||typeof VideoFrame<"u"&&Me instanceof VideoFrame){let Et=Math.floor(It*Rt.width),pt=Math.floor(It*Rt.height);m===void 0&&(m=x(Et,pt));let Yt=ve?x(Et,pt):m;return Yt.width=Et,Yt.height=pt,Yt.getContext("2d").drawImage(Me,0,0,Et,pt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Rt.width+"x"+Rt.height+") to ("+Et+"x"+pt+")."),Yt}else return"data"in Me&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Rt.width+"x"+Rt.height+")."),Me;return Me}s(E,"resizeImage");function M(Me){return Me.generateMipmaps}s(M,"textureNeedsGenerateMipmaps");function I(Me){t.generateMipmap(Me)}s(I,"generateMipmap");function P(Me){return Me.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Me.isWebGL3DRenderTarget?t.TEXTURE_3D:Me.isWebGLArrayRenderTarget||Me.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}s(P,"getTargetType");function C(Me,ve,Ze,It,Rt=!1){if(Me!==null){if(t[Me]!==void 0)return t[Me];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Me+"'")}let Et=ve;if(ve===t.RED&&(Ze===t.FLOAT&&(Et=t.R32F),Ze===t.HALF_FLOAT&&(Et=t.R16F),Ze===t.UNSIGNED_BYTE&&(Et=t.R8)),ve===t.RED_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.R8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.R16UI),Ze===t.UNSIGNED_INT&&(Et=t.R32UI),Ze===t.BYTE&&(Et=t.R8I),Ze===t.SHORT&&(Et=t.R16I),Ze===t.INT&&(Et=t.R32I)),ve===t.RG&&(Ze===t.FLOAT&&(Et=t.RG32F),Ze===t.HALF_FLOAT&&(Et=t.RG16F),Ze===t.UNSIGNED_BYTE&&(Et=t.RG8)),ve===t.RG_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.RG8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.RG16UI),Ze===t.UNSIGNED_INT&&(Et=t.RG32UI),Ze===t.BYTE&&(Et=t.RG8I),Ze===t.SHORT&&(Et=t.RG16I),Ze===t.INT&&(Et=t.RG32I)),ve===t.RGB_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.RGB8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.RGB16UI),Ze===t.UNSIGNED_INT&&(Et=t.RGB32UI),Ze===t.BYTE&&(Et=t.RGB8I),Ze===t.SHORT&&(Et=t.RGB16I),Ze===t.INT&&(Et=t.RGB32I)),ve===t.RGBA_INTEGER&&(Ze===t.UNSIGNED_BYTE&&(Et=t.RGBA8UI),Ze===t.UNSIGNED_SHORT&&(Et=t.RGBA16UI),Ze===t.UNSIGNED_INT&&(Et=t.RGBA32UI),Ze===t.BYTE&&(Et=t.RGBA8I),Ze===t.SHORT&&(Et=t.RGBA16I),Ze===t.INT&&(Et=t.RGBA32I)),ve===t.RGB&&Ze===t.UNSIGNED_INT_5_9_9_9_REV&&(Et=t.RGB9_E5),ve===t.RGBA){let pt=Rt?zT:Dn.getTransfer(It);Ze===t.FLOAT&&(Et=t.RGBA32F),Ze===t.HALF_FLOAT&&(Et=t.RGBA16F),Ze===t.UNSIGNED_BYTE&&(Et=pt===ma?t.SRGB8_ALPHA8:t.RGBA8),Ze===t.UNSIGNED_SHORT_4_4_4_4&&(Et=t.RGBA4),Ze===t.UNSIGNED_SHORT_5_5_5_1&&(Et=t.RGB5_A1)}return(Et===t.R16F||Et===t.R32F||Et===t.RG16F||Et===t.RG32F||Et===t.RGBA16F||Et===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Et}s(C,"getInternalFormat");function T(Me,ve){let Ze;return Me?ve===null||ve===Jm||ve===M_?Ze=t.DEPTH24_STENCIL8:ve===Lu?Ze=t.DEPTH32F_STENCIL8:ve===Lw&&(Ze=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ve===null||ve===Jm||ve===M_?Ze=t.DEPTH_COMPONENT24:ve===Lu?Ze=t.DEPTH_COMPONENT32F:ve===Lw&&(Ze=t.DEPTH_COMPONENT16),Ze}s(T,"getInternalDepthFormat");function D(Me,ve){return M(Me)===!0||Me.isFramebufferTexture&&Me.minFilter!==_c&&Me.minFilter!==Up?Math.log2(Math.max(ve.width,ve.height))+1:Me.mipmaps!==void 0&&Me.mipmaps.length>0?Me.mipmaps.length:Me.isCompressedTexture&&Array.isArray(Me.image)?ve.mipmaps.length:1}s(D,"getMipLevels");function F(Me){let ve=Me.target;ve.removeEventListener("dispose",F),B(ve),ve.isVideoTexture&&p.delete(ve)}s(F,"onTextureDispose");function k(Me){let ve=Me.target;ve.removeEventListener("dispose",k),z(ve)}s(k,"onRenderTargetDispose");function B(Me){let ve=i.get(Me);if(ve.__webglInit===void 0)return;let Ze=Me.source,It=y.get(Ze);if(It){let Rt=It[ve.__cacheKey];Rt.usedTimes--,Rt.usedTimes===0&&U(Me),Object.keys(It).length===0&&y.delete(Ze)}i.remove(Me)}s(B,"deallocateTexture");function U(Me){let ve=i.get(Me);t.deleteTexture(ve.__webglTexture);let Ze=Me.source,It=y.get(Ze);delete It[ve.__cacheKey],o.memory.textures--}s(U,"deleteTexture");function z(Me){let ve=i.get(Me);if(Me.depthTexture&&(Me.depthTexture.dispose(),i.remove(Me.depthTexture)),Me.isWebGLCubeRenderTarget)for(let It=0;It<6;It++){if(Array.isArray(ve.__webglFramebuffer[It]))for(let Rt=0;Rt<ve.__webglFramebuffer[It].length;Rt++)t.deleteFramebuffer(ve.__webglFramebuffer[It][Rt]);else t.deleteFramebuffer(ve.__webglFramebuffer[It]);ve.__webglDepthbuffer&&t.deleteRenderbuffer(ve.__webglDepthbuffer[It])}else{if(Array.isArray(ve.__webglFramebuffer))for(let It=0;It<ve.__webglFramebuffer.length;It++)t.deleteFramebuffer(ve.__webglFramebuffer[It]);else t.deleteFramebuffer(ve.__webglFramebuffer);if(ve.__webglDepthbuffer&&t.deleteRenderbuffer(ve.__webglDepthbuffer),ve.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ve.__webglMultisampledFramebuffer),ve.__webglColorRenderbuffer)for(let It=0;It<ve.__webglColorRenderbuffer.length;It++)ve.__webglColorRenderbuffer[It]&&t.deleteRenderbuffer(ve.__webglColorRenderbuffer[It]);ve.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ve.__webglDepthRenderbuffer)}let Ze=Me.textures;for(let It=0,Rt=Ze.length;It<Rt;It++){let Et=i.get(Ze[It]);Et.__webglTexture&&(t.deleteTexture(Et.__webglTexture),o.memory.textures--),i.remove(Ze[It])}i.remove(Me)}s(z,"deallocateRenderTarget");let q=0;function Z(){q=0}s(Z,"resetTextureUnits");function Q(){let Me=q;return Me>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Me+" texture units while this GPU supports only "+n.maxTextures),q+=1,Me}s(Q,"allocateTextureUnit");function V(Me){let ve=[];return ve.push(Me.wrapS),ve.push(Me.wrapT),ve.push(Me.wrapR||0),ve.push(Me.magFilter),ve.push(Me.minFilter),ve.push(Me.anisotropy),ve.push(Me.internalFormat),ve.push(Me.format),ve.push(Me.type),ve.push(Me.generateMipmaps),ve.push(Me.premultiplyAlpha),ve.push(Me.flipY),ve.push(Me.unpackAlignment),ve.push(Me.colorSpace),ve.join()}s(V,"getTextureCacheKey");function ae(Me,ve){let Ze=i.get(Me);if(Me.isVideoTexture&&at(Me),Me.isRenderTargetTexture===!1&&Me.version>0&&Ze.__version!==Me.version){let It=Me.image;if(It===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(It.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{re(Ze,Me,ve);return}}r.bindTexture(t.TEXTURE_2D,Ze.__webglTexture,t.TEXTURE0+ve)}s(ae,"setTexture2D");function Y(Me,ve){let Ze=i.get(Me);if(Me.version>0&&Ze.__version!==Me.version){re(Ze,Me,ve);return}r.bindTexture(t.TEXTURE_2D_ARRAY,Ze.__webglTexture,t.TEXTURE0+ve)}s(Y,"setTexture2DArray");function he(Me,ve){let Ze=i.get(Me);if(Me.version>0&&Ze.__version!==Me.version){re(Ze,Me,ve);return}r.bindTexture(t.TEXTURE_3D,Ze.__webglTexture,t.TEXTURE0+ve)}s(he,"setTexture3D");function J(Me,ve){let Ze=i.get(Me);if(Me.version>0&&Ze.__version!==Me.version){se(Ze,Me,ve);return}r.bindTexture(t.TEXTURE_CUBE_MAP,Ze.__webglTexture,t.TEXTURE0+ve)}s(J,"setTextureCube");let ne={[Bh]:t.REPEAT,[My]:t.CLAMP_TO_EDGE,[PR]:t.MIRRORED_REPEAT},ee={[_c]:t.NEAREST,[HUe]:t.NEAREST_MIPMAP_NEAREST,[FM]:t.NEAREST_MIPMAP_LINEAR,[Up]:t.LINEAR,[GL]:t.LINEAR_MIPMAP_NEAREST,[Ey]:t.LINEAR_MIPMAP_LINEAR},ue={[QUe]:t.NEVER,[aVe]:t.ALWAYS,[eVe]:t.LESS,[Nue]:t.LEQUAL,[tVe]:t.EQUAL,[nVe]:t.GEQUAL,[rVe]:t.GREATER,[iVe]:t.NOTEQUAL};function K(Me,ve){if(ve.type===Lu&&e.has("OES_texture_float_linear")===!1&&(ve.magFilter===Up||ve.magFilter===GL||ve.magFilter===FM||ve.magFilter===Ey||ve.minFilter===Up||ve.minFilter===GL||ve.minFilter===FM||ve.minFilter===Ey)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Me,t.TEXTURE_WRAP_S,ne[ve.wrapS]),t.texParameteri(Me,t.TEXTURE_WRAP_T,ne[ve.wrapT]),(Me===t.TEXTURE_3D||Me===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Me,t.TEXTURE_WRAP_R,ne[ve.wrapR]),t.texParameteri(Me,t.TEXTURE_MAG_FILTER,ee[ve.magFilter]),t.texParameteri(Me,t.TEXTURE_MIN_FILTER,ee[ve.minFilter]),ve.compareFunction&&(t.texParameteri(Me,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Me,t.TEXTURE_COMPARE_FUNC,ue[ve.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ve.magFilter===_c||ve.minFilter!==FM&&ve.minFilter!==Ey||ve.type===Lu&&e.has("OES_texture_float_linear")===!1)return;if(ve.anisotropy>1||i.get(ve).__currentAnisotropy){let Ze=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Me,Ze.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ve.anisotropy,n.getMaxAnisotropy())),i.get(ve).__currentAnisotropy=ve.anisotropy}}}s(K,"setTextureParameters");function ce(Me,ve){let Ze=!1;Me.__webglInit===void 0&&(Me.__webglInit=!0,ve.addEventListener("dispose",F));let It=ve.source,Rt=y.get(It);Rt===void 0&&(Rt={},y.set(It,Rt));let Et=V(ve);if(Et!==Me.__cacheKey){Rt[Et]===void 0&&(Rt[Et]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,Ze=!0),Rt[Et].usedTimes++;let pt=Rt[Me.__cacheKey];pt!==void 0&&(Rt[Me.__cacheKey].usedTimes--,pt.usedTimes===0&&U(ve)),Me.__cacheKey=Et,Me.__webglTexture=Rt[Et].texture}return Ze}s(ce,"initTexture");function re(Me,ve,Ze){let It=t.TEXTURE_2D;(ve.isDataArrayTexture||ve.isCompressedArrayTexture)&&(It=t.TEXTURE_2D_ARRAY),ve.isData3DTexture&&(It=t.TEXTURE_3D);let Rt=ce(Me,ve),Et=ve.source;r.bindTexture(It,Me.__webglTexture,t.TEXTURE0+Ze);let pt=i.get(Et);if(Et.version!==pt.__version||Rt===!0){r.activeTexture(t.TEXTURE0+Ze);let Yt=Dn.getPrimaries(Dn.workingColorSpace),Kt=ve.colorSpace===Nm?null:Dn.getPrimaries(ve.colorSpace),$t=ve.colorSpace===Nm||Yt===Kt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ve.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ve.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ve.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);let jt=E(ve.image,!1,n.maxTextureSize);jt=Lt(ve,jt);let Nt=a.convert(ve.format,ve.colorSpace),Fe=a.convert(ve.type),Xe=C(ve.internalFormat,Nt,Fe,ve.colorSpace,ve.isVideoTexture);K(It,ve);let ht,rr=ve.mipmaps,ar=ve.isVideoTexture!==!0,zr=pt.__version===void 0||Rt===!0,Qe=Et.dataReady,er=D(ve,jt);if(ve.isDepthTexture)Xe=T(ve.format===E_,ve.type),zr&&(ar?r.texStorage2D(t.TEXTURE_2D,1,Xe,jt.width,jt.height):r.texImage2D(t.TEXTURE_2D,0,Xe,jt.width,jt.height,0,Nt,Fe,null));else if(ve.isDataTexture)if(rr.length>0){ar&&zr&&r.texStorage2D(t.TEXTURE_2D,er,Xe,rr[0].width,rr[0].height);for(let Oe=0,oe=rr.length;Oe<oe;Oe++)ht=rr[Oe],ar?Qe&&r.texSubImage2D(t.TEXTURE_2D,Oe,0,0,ht.width,ht.height,Nt,Fe,ht.data):r.texImage2D(t.TEXTURE_2D,Oe,Xe,ht.width,ht.height,0,Nt,Fe,ht.data);ve.generateMipmaps=!1}else ar?(zr&&r.texStorage2D(t.TEXTURE_2D,er,Xe,jt.width,jt.height),Qe&&r.texSubImage2D(t.TEXTURE_2D,0,0,0,jt.width,jt.height,Nt,Fe,jt.data)):r.texImage2D(t.TEXTURE_2D,0,Xe,jt.width,jt.height,0,Nt,Fe,jt.data);else if(ve.isCompressedTexture)if(ve.isCompressedArrayTexture){ar&&zr&&r.texStorage3D(t.TEXTURE_2D_ARRAY,er,Xe,rr[0].width,rr[0].height,jt.depth);for(let Oe=0,oe=rr.length;Oe<oe;Oe++)if(ht=rr[Oe],ve.format!==Ll)if(Nt!==null)if(ar){if(Qe)if(ve.layerUpdates.size>0){let le=vO(ht.width,ht.height,ve.format,ve.type);for(let Se of ve.layerUpdates){let ze=ht.data.subarray(Se*le/ht.data.BYTES_PER_ELEMENT,(Se+1)*le/ht.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Oe,0,0,Se,ht.width,ht.height,1,Nt,ze)}ve.clearLayerUpdates()}else r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Oe,0,0,0,ht.width,ht.height,jt.depth,Nt,ht.data)}else r.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Oe,Xe,ht.width,ht.height,jt.depth,0,ht.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ar?Qe&&r.texSubImage3D(t.TEXTURE_2D_ARRAY,Oe,0,0,0,ht.width,ht.height,jt.depth,Nt,Fe,ht.data):r.texImage3D(t.TEXTURE_2D_ARRAY,Oe,Xe,ht.width,ht.height,jt.depth,0,Nt,Fe,ht.data)}else{ar&&zr&&r.texStorage2D(t.TEXTURE_2D,er,Xe,rr[0].width,rr[0].height);for(let Oe=0,oe=rr.length;Oe<oe;Oe++)ht=rr[Oe],ve.format!==Ll?Nt!==null?ar?Qe&&r.compressedTexSubImage2D(t.TEXTURE_2D,Oe,0,0,ht.width,ht.height,Nt,ht.data):r.compressedTexImage2D(t.TEXTURE_2D,Oe,Xe,ht.width,ht.height,0,ht.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ar?Qe&&r.texSubImage2D(t.TEXTURE_2D,Oe,0,0,ht.width,ht.height,Nt,Fe,ht.data):r.texImage2D(t.TEXTURE_2D,Oe,Xe,ht.width,ht.height,0,Nt,Fe,ht.data)}else if(ve.isDataArrayTexture)if(ar){if(zr&&r.texStorage3D(t.TEXTURE_2D_ARRAY,er,Xe,jt.width,jt.height,jt.depth),Qe)if(ve.layerUpdates.size>0){let Oe=vO(jt.width,jt.height,ve.format,ve.type);for(let oe of ve.layerUpdates){let le=jt.data.subarray(oe*Oe/jt.data.BYTES_PER_ELEMENT,(oe+1)*Oe/jt.data.BYTES_PER_ELEMENT);r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,oe,jt.width,jt.height,1,Nt,Fe,le)}ve.clearLayerUpdates()}else r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,jt.width,jt.height,jt.depth,Nt,Fe,jt.data)}else r.texImage3D(t.TEXTURE_2D_ARRAY,0,Xe,jt.width,jt.height,jt.depth,0,Nt,Fe,jt.data);else if(ve.isData3DTexture)ar?(zr&&r.texStorage3D(t.TEXTURE_3D,er,Xe,jt.width,jt.height,jt.depth),Qe&&r.texSubImage3D(t.TEXTURE_3D,0,0,0,0,jt.width,jt.height,jt.depth,Nt,Fe,jt.data)):r.texImage3D(t.TEXTURE_3D,0,Xe,jt.width,jt.height,jt.depth,0,Nt,Fe,jt.data);else if(ve.isFramebufferTexture){if(zr)if(ar)r.texStorage2D(t.TEXTURE_2D,er,Xe,jt.width,jt.height);else{let Oe=jt.width,oe=jt.height;for(let le=0;le<er;le++)r.texImage2D(t.TEXTURE_2D,le,Xe,Oe,oe,0,Nt,Fe,null),Oe>>=1,oe>>=1}}else if(rr.length>0){if(ar&&zr){let Oe=dt(rr[0]);r.texStorage2D(t.TEXTURE_2D,er,Xe,Oe.width,Oe.height)}for(let Oe=0,oe=rr.length;Oe<oe;Oe++)ht=rr[Oe],ar?Qe&&r.texSubImage2D(t.TEXTURE_2D,Oe,0,0,Nt,Fe,ht):r.texImage2D(t.TEXTURE_2D,Oe,Xe,Nt,Fe,ht);ve.generateMipmaps=!1}else if(ar){if(zr){let Oe=dt(jt);r.texStorage2D(t.TEXTURE_2D,er,Xe,Oe.width,Oe.height)}Qe&&r.texSubImage2D(t.TEXTURE_2D,0,0,0,Nt,Fe,jt)}else r.texImage2D(t.TEXTURE_2D,0,Xe,Nt,Fe,jt);M(ve)&&I(It),pt.__version=Et.version,ve.onUpdate&&ve.onUpdate(ve)}Me.__version=ve.version}s(re,"uploadTexture");function se(Me,ve,Ze){if(ve.image.length!==6)return;let It=ce(Me,ve),Rt=ve.source;r.bindTexture(t.TEXTURE_CUBE_MAP,Me.__webglTexture,t.TEXTURE0+Ze);let Et=i.get(Rt);if(Rt.version!==Et.__version||It===!0){r.activeTexture(t.TEXTURE0+Ze);let pt=Dn.getPrimaries(Dn.workingColorSpace),Yt=ve.colorSpace===Nm?null:Dn.getPrimaries(ve.colorSpace),Kt=ve.colorSpace===Nm||pt===Yt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ve.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ve.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ve.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Kt);let $t=ve.isCompressedTexture||ve.image[0].isCompressedTexture,jt=ve.image[0]&&ve.image[0].isDataTexture,Nt=[];for(let oe=0;oe<6;oe++)!$t&&!jt?Nt[oe]=E(ve.image[oe],!0,n.maxCubemapSize):Nt[oe]=jt?ve.image[oe].image:ve.image[oe],Nt[oe]=Lt(ve,Nt[oe]);let Fe=Nt[0],Xe=a.convert(ve.format,ve.colorSpace),ht=a.convert(ve.type),rr=C(ve.internalFormat,Xe,ht,ve.colorSpace),ar=ve.isVideoTexture!==!0,zr=Et.__version===void 0||It===!0,Qe=Rt.dataReady,er=D(ve,Fe);K(t.TEXTURE_CUBE_MAP,ve);let Oe;if($t){ar&&zr&&r.texStorage2D(t.TEXTURE_CUBE_MAP,er,rr,Fe.width,Fe.height);for(let oe=0;oe<6;oe++){Oe=Nt[oe].mipmaps;for(let le=0;le<Oe.length;le++){let Se=Oe[le];ve.format!==Ll?Xe!==null?ar?Qe&&r.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le,0,0,Se.width,Se.height,Xe,Se.data):r.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le,rr,Se.width,Se.height,0,Se.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le,0,0,Se.width,Se.height,Xe,ht,Se.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le,rr,Se.width,Se.height,0,Xe,ht,Se.data)}}}else{if(Oe=ve.mipmaps,ar&&zr){Oe.length>0&&er++;let oe=dt(Nt[0]);r.texStorage2D(t.TEXTURE_CUBE_MAP,er,rr,oe.width,oe.height)}for(let oe=0;oe<6;oe++)if(jt){ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,0,0,Nt[oe].width,Nt[oe].height,Xe,ht,Nt[oe].data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,rr,Nt[oe].width,Nt[oe].height,0,Xe,ht,Nt[oe].data);for(let le=0;le<Oe.length;le++){let Se=Oe[le].image[oe].image;ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le+1,0,0,Se.width,Se.height,Xe,ht,Se.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le+1,rr,Se.width,Se.height,0,Xe,ht,Se.data)}}else{ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,0,0,Xe,ht,Nt[oe]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,rr,Xe,ht,Nt[oe]);for(let le=0;le<Oe.length;le++){let Se=Oe[le];ar?Qe&&r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le+1,0,0,Xe,ht,Se.image[oe]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+oe,le+1,rr,Xe,ht,Se.image[oe])}}}M(ve)&&I(t.TEXTURE_CUBE_MAP),Et.__version=Rt.version,ve.onUpdate&&ve.onUpdate(ve)}Me.__version=ve.version}s(se,"uploadCubeTexture");function de(Me,ve,Ze,It,Rt,Et){let pt=a.convert(Ze.format,Ze.colorSpace),Yt=a.convert(Ze.type),Kt=C(Ze.internalFormat,pt,Yt,Ze.colorSpace),$t=i.get(ve),jt=i.get(Ze);if(jt.__renderTarget=ve,!$t.__hasExternalTextures){let Nt=Math.max(1,ve.width>>Et),Fe=Math.max(1,ve.height>>Et);Rt===t.TEXTURE_3D||Rt===t.TEXTURE_2D_ARRAY?r.texImage3D(Rt,Et,Kt,Nt,Fe,ve.depth,0,pt,Yt,null):r.texImage2D(Rt,Et,Kt,Nt,Fe,0,pt,Yt,null)}r.bindFramebuffer(t.FRAMEBUFFER,Me),We(ve)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,It,Rt,jt.__webglTexture,0,tt(ve)):(Rt===t.TEXTURE_2D||Rt>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Rt<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,It,Rt,jt.__webglTexture,Et),r.bindFramebuffer(t.FRAMEBUFFER,null)}s(de,"setupFrameBufferTexture");function we(Me,ve,Ze){if(t.bindRenderbuffer(t.RENDERBUFFER,Me),ve.depthBuffer){let It=ve.depthTexture,Rt=It&&It.isDepthTexture?It.type:null,Et=T(ve.stencilBuffer,Rt),pt=ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Yt=tt(ve);We(ve)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Yt,Et,ve.width,ve.height):Ze?t.renderbufferStorageMultisample(t.RENDERBUFFER,Yt,Et,ve.width,ve.height):t.renderbufferStorage(t.RENDERBUFFER,Et,ve.width,ve.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,pt,t.RENDERBUFFER,Me)}else{let It=ve.textures;for(let Rt=0;Rt<It.length;Rt++){let Et=It[Rt],pt=a.convert(Et.format,Et.colorSpace),Yt=a.convert(Et.type),Kt=C(Et.internalFormat,pt,Yt,Et.colorSpace),$t=tt(ve);Ze&&We(ve)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,$t,Kt,ve.width,ve.height):We(ve)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,$t,Kt,ve.width,ve.height):t.renderbufferStorage(t.RENDERBUFFER,Kt,ve.width,ve.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}s(we,"setupRenderBufferStorage");function Le(Me,ve){if(ve&&ve.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(t.FRAMEBUFFER,Me),!(ve.depthTexture&&ve.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let Ze=i.get(ve.depthTexture);Ze.__renderTarget=ve,(!Ze.__webglTexture||ve.depthTexture.image.width!==ve.width||ve.depthTexture.image.height!==ve.height)&&(ve.depthTexture.image.width=ve.width,ve.depthTexture.image.height=ve.height,ve.depthTexture.needsUpdate=!0),ae(ve.depthTexture,0);let It=Ze.__webglTexture,Rt=tt(ve);if(ve.depthTexture.format===r_)We(ve)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,It,0,Rt):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,It,0);else if(ve.depthTexture.format===E_)We(ve)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,It,0,Rt):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,It,0);else throw new Error("Unknown depthTexture format")}s(Le,"setupDepthTexture");function fe(Me){let ve=i.get(Me),Ze=Me.isWebGLCubeRenderTarget===!0;if(ve.__boundDepthTexture!==Me.depthTexture){let It=Me.depthTexture;if(ve.__depthDisposeCallback&&ve.__depthDisposeCallback(),It){let Rt=s(()=>{delete ve.__boundDepthTexture,delete ve.__depthDisposeCallback,It.removeEventListener("dispose",Rt)},"disposeEvent");It.addEventListener("dispose",Rt),ve.__depthDisposeCallback=Rt}ve.__boundDepthTexture=It}if(Me.depthTexture&&!ve.__autoAllocateDepthBuffer){if(Ze)throw new Error("target.depthTexture not supported in Cube render targets");Le(ve.__webglFramebuffer,Me)}else if(Ze){ve.__webglDepthbuffer=[];for(let It=0;It<6;It++)if(r.bindFramebuffer(t.FRAMEBUFFER,ve.__webglFramebuffer[It]),ve.__webglDepthbuffer[It]===void 0)ve.__webglDepthbuffer[It]=t.createRenderbuffer(),we(ve.__webglDepthbuffer[It],Me,!1);else{let Rt=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Et=ve.__webglDepthbuffer[It];t.bindRenderbuffer(t.RENDERBUFFER,Et),t.framebufferRenderbuffer(t.FRAMEBUFFER,Rt,t.RENDERBUFFER,Et)}}else if(r.bindFramebuffer(t.FRAMEBUFFER,ve.__webglFramebuffer),ve.__webglDepthbuffer===void 0)ve.__webglDepthbuffer=t.createRenderbuffer(),we(ve.__webglDepthbuffer,Me,!1);else{let It=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Rt=ve.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Rt),t.framebufferRenderbuffer(t.FRAMEBUFFER,It,t.RENDERBUFFER,Rt)}r.bindFramebuffer(t.FRAMEBUFFER,null)}s(fe,"setupDepthRenderbuffer");function Re(Me,ve,Ze){let It=i.get(Me);ve!==void 0&&de(It.__webglFramebuffer,Me,Me.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Ze!==void 0&&fe(Me)}s(Re,"rebindTextures");function me(Me){let ve=Me.texture,Ze=i.get(Me),It=i.get(ve);Me.addEventListener("dispose",k);let Rt=Me.textures,Et=Me.isWebGLCubeRenderTarget===!0,pt=Rt.length>1;if(pt||(It.__webglTexture===void 0&&(It.__webglTexture=t.createTexture()),It.__version=ve.version,o.memory.textures++),Et){Ze.__webglFramebuffer=[];for(let Yt=0;Yt<6;Yt++)if(ve.mipmaps&&ve.mipmaps.length>0){Ze.__webglFramebuffer[Yt]=[];for(let Kt=0;Kt<ve.mipmaps.length;Kt++)Ze.__webglFramebuffer[Yt][Kt]=t.createFramebuffer()}else Ze.__webglFramebuffer[Yt]=t.createFramebuffer()}else{if(ve.mipmaps&&ve.mipmaps.length>0){Ze.__webglFramebuffer=[];for(let Yt=0;Yt<ve.mipmaps.length;Yt++)Ze.__webglFramebuffer[Yt]=t.createFramebuffer()}else Ze.__webglFramebuffer=t.createFramebuffer();if(pt)for(let Yt=0,Kt=Rt.length;Yt<Kt;Yt++){let $t=i.get(Rt[Yt]);$t.__webglTexture===void 0&&($t.__webglTexture=t.createTexture(),o.memory.textures++)}if(Me.samples>0&&We(Me)===!1){Ze.__webglMultisampledFramebuffer=t.createFramebuffer(),Ze.__webglColorRenderbuffer=[],r.bindFramebuffer(t.FRAMEBUFFER,Ze.__webglMultisampledFramebuffer);for(let Yt=0;Yt<Rt.length;Yt++){let Kt=Rt[Yt];Ze.__webglColorRenderbuffer[Yt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Ze.__webglColorRenderbuffer[Yt]);let $t=a.convert(Kt.format,Kt.colorSpace),jt=a.convert(Kt.type),Nt=C(Kt.internalFormat,$t,jt,Kt.colorSpace,Me.isXRRenderTarget===!0),Fe=tt(Me);t.renderbufferStorageMultisample(t.RENDERBUFFER,Fe,Nt,Me.width,Me.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Yt,t.RENDERBUFFER,Ze.__webglColorRenderbuffer[Yt])}t.bindRenderbuffer(t.RENDERBUFFER,null),Me.depthBuffer&&(Ze.__webglDepthRenderbuffer=t.createRenderbuffer(),we(Ze.__webglDepthRenderbuffer,Me,!0)),r.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Et){r.bindTexture(t.TEXTURE_CUBE_MAP,It.__webglTexture),K(t.TEXTURE_CUBE_MAP,ve);for(let Yt=0;Yt<6;Yt++)if(ve.mipmaps&&ve.mipmaps.length>0)for(let Kt=0;Kt<ve.mipmaps.length;Kt++)de(Ze.__webglFramebuffer[Yt][Kt],Me,ve,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Yt,Kt);else de(Ze.__webglFramebuffer[Yt],Me,ve,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Yt,0);M(ve)&&I(t.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(pt){for(let Yt=0,Kt=Rt.length;Yt<Kt;Yt++){let $t=Rt[Yt],jt=i.get($t);r.bindTexture(t.TEXTURE_2D,jt.__webglTexture),K(t.TEXTURE_2D,$t),de(Ze.__webglFramebuffer,Me,$t,t.COLOR_ATTACHMENT0+Yt,t.TEXTURE_2D,0),M($t)&&I(t.TEXTURE_2D)}r.unbindTexture()}else{let Yt=t.TEXTURE_2D;if((Me.isWebGL3DRenderTarget||Me.isWebGLArrayRenderTarget)&&(Yt=Me.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),r.bindTexture(Yt,It.__webglTexture),K(Yt,ve),ve.mipmaps&&ve.mipmaps.length>0)for(let Kt=0;Kt<ve.mipmaps.length;Kt++)de(Ze.__webglFramebuffer[Kt],Me,ve,t.COLOR_ATTACHMENT0,Yt,Kt);else de(Ze.__webglFramebuffer,Me,ve,t.COLOR_ATTACHMENT0,Yt,0);M(ve)&&I(Yt),r.unbindTexture()}Me.depthBuffer&&fe(Me)}s(me,"setupRenderTarget");function Ae(Me){let ve=Me.textures;for(let Ze=0,It=ve.length;Ze<It;Ze++){let Rt=ve[Ze];if(M(Rt)){let Et=P(Me),pt=i.get(Rt).__webglTexture;r.bindTexture(Et,pt),I(Et),r.unbindTexture()}}}s(Ae,"updateRenderTargetMipmap");let Ue=[],_e=[];function lt(Me){if(Me.samples>0){if(We(Me)===!1){let ve=Me.textures,Ze=Me.width,It=Me.height,Rt=t.COLOR_BUFFER_BIT,Et=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,pt=i.get(Me),Yt=ve.length>1;if(Yt)for(let Kt=0;Kt<ve.length;Kt++)r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.RENDERBUFFER,null),r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.TEXTURE_2D,null,0);r.bindFramebuffer(t.READ_FRAMEBUFFER,pt.__webglMultisampledFramebuffer),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,pt.__webglFramebuffer);for(let Kt=0;Kt<ve.length;Kt++){if(Me.resolveDepthBuffer&&(Me.depthBuffer&&(Rt|=t.DEPTH_BUFFER_BIT),Me.stencilBuffer&&Me.resolveStencilBuffer&&(Rt|=t.STENCIL_BUFFER_BIT)),Yt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,pt.__webglColorRenderbuffer[Kt]);let $t=i.get(ve[Kt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,$t,0)}t.blitFramebuffer(0,0,Ze,It,0,0,Ze,It,Rt,t.NEAREST),u===!0&&(Ue.length=0,_e.length=0,Ue.push(t.COLOR_ATTACHMENT0+Kt),Me.depthBuffer&&Me.resolveDepthBuffer===!1&&(Ue.push(Et),_e.push(Et),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,_e)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ue))}if(r.bindFramebuffer(t.READ_FRAMEBUFFER,null),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Yt)for(let Kt=0;Kt<ve.length;Kt++){r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.RENDERBUFFER,pt.__webglColorRenderbuffer[Kt]);let $t=i.get(ve[Kt]).__webglTexture;r.bindFramebuffer(t.FRAMEBUFFER,pt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Kt,t.TEXTURE_2D,$t,0)}r.bindFramebuffer(t.DRAW_FRAMEBUFFER,pt.__webglMultisampledFramebuffer)}else if(Me.depthBuffer&&Me.resolveDepthBuffer===!1&&u){let ve=Me.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[ve])}}}s(lt,"updateMultisampleRenderTarget");function tt(Me){return Math.min(n.maxSamples,Me.samples)}s(tt,"getRenderTargetSamples");function We(Me){let ve=i.get(Me);return Me.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ve.__useRenderToTexture!==!1}s(We,"useMultisampledRTT");function at(Me){let ve=o.render.frame;p.get(Me)!==ve&&(p.set(Me,ve),Me.update())}s(at,"updateVideoTexture");function Lt(Me,ve){let Ze=Me.colorSpace,It=Me.format,Rt=Me.type;return Me.isCompressedTexture===!0||Me.isVideoTexture===!0||Ze!==Wy&&Ze!==Nm&&(Dn.getTransfer(Ze)===ma?(It!==Ll||Rt!==ed)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ze)),ve}s(Lt,"verifyColorSpace");function dt(Me){return typeof HTMLImageElement<"u"&&Me instanceof HTMLImageElement?(c.width=Me.naturalWidth||Me.width,c.height=Me.naturalHeight||Me.height):typeof VideoFrame<"u"&&Me instanceof VideoFrame?(c.width=Me.displayWidth,c.height=Me.displayHeight):(c.width=Me.width,c.height=Me.height),c}s(dt,"getDimensions"),this.allocateTextureUnit=Q,this.resetTextureUnits=Z,this.setTexture2D=ae,this.setTexture2DArray=Y,this.setTexture3D=he,this.setTextureCube=J,this.rebindTextures=Re,this.setupRenderTarget=me,this.updateRenderTargetMipmap=Ae,this.updateMultisampleRenderTarget=lt,this.setupDepthRenderbuffer=fe,this.setupFrameBufferTexture=de,this.useMultisampledRTT=We}s(xme,"WebGLTextures");function bme(t,e){function r(i,n=Nm){let a,o=Dn.getTransfer(n);if(i===ed)return t.UNSIGNED_BYTE;if(i===cB)return t.UNSIGNED_SHORT_4_4_4_4;if(i===hB)return t.UNSIGNED_SHORT_5_5_5_1;if(i===Tue)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===Cue)return t.BYTE;if(i===Iue)return t.SHORT;if(i===Lw)return t.UNSIGNED_SHORT;if(i===uB)return t.INT;if(i===Jm)return t.UNSIGNED_INT;if(i===Lu)return t.FLOAT;if(i===PA)return t.HALF_FLOAT;if(i===Pue)return t.ALPHA;if(i===Lue)return t.RGB;if(i===Ll)return t.RGBA;if(i===Due)return t.LUMINANCE;if(i===Rue)return t.LUMINANCE_ALPHA;if(i===r_)return t.DEPTH_COMPONENT;if(i===E_)return t.DEPTH_STENCIL;if(i===pB)return t.RED;if(i===RP)return t.RED_INTEGER;if(i===Oue)return t.RG;if(i===dB)return t.RG_INTEGER;if(i===fB)return t.RGBA_INTEGER;if(i===ZE||i===YE||i===KE||i===JE)if(o===ma)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(i===ZE)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===YE)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===KE)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===JE)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(i===ZE)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===YE)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===KE)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===JE)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===LR||i===DR||i===RR||i===OR)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(i===LR)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===DR)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===RR)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===OR)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===kR||i===NR||i===FR)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(i===kR||i===NR)return o===ma?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===FR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===BR||i===zR||i===UR||i===VR||i===jR||i===$R||i===GR||i===HR||i===qR||i===WR||i===XR||i===ZR||i===YR||i===KR)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(i===BR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===zR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===UR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===VR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===jR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===$R)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===GR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===HR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===qR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===WR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===XR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===ZR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===YR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===KR)return o===ma?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===QE||i===JR||i===QR)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(i===QE)return o===ma?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===JR)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===QR)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===kue||i===eO||i===tO||i===rO)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(i===QE)return a.COMPRESSED_RED_RGTC1_EXT;if(i===eO)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===tO)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===rO)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===M_?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return s(r,"convert"),{convert:r}}s(bme,"WebGLUtils");var dHe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,fHe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,wme=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,r,i){if(this.texture===null){let n=new Gu,a=e.properties.get(n);a.__webglTexture=r.texture,(r.depthNear!==i.depthNear||r.depthFar!==i.depthFar)&&(this.depthNear=r.depthNear,this.depthFar=r.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){let r=e.cameras[0].viewport,i=new bc({vertexShader:dHe,fragmentShader:fHe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new Tn(new pv(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}};s(wme,"WebXRDepthSensing");var mHe=wme,Ame=class extends ax{constructor(e,r){super();let i=this,n=null,a=1,o=null,l="local-floor",u=1,c=null,p=null,m=null,y=null,v=null,x=null,E=new mHe,M=r.getContextAttributes(),I=null,P=null,C=[],T=[],D=new Jt,F=null,k=new Yl;k.viewport=new Jn;let B=new Yl;B.viewport=new Jn;let U=[k,B],z=new oje,q=null,Z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(re){let se=C[re];return se===void 0&&(se=new uD,C[re]=se),se.getTargetRaySpace()},this.getControllerGrip=function(re){let se=C[re];return se===void 0&&(se=new uD,C[re]=se),se.getGripSpace()},this.getHand=function(re){let se=C[re];return se===void 0&&(se=new uD,C[re]=se),se.getHandSpace()};function Q(re){let se=T.indexOf(re.inputSource);if(se===-1)return;let de=C[se];de!==void 0&&(de.update(re.inputSource,re.frame,c||o),de.dispatchEvent({type:re.type,data:re.inputSource}))}s(Q,"onSessionEvent");function V(){n.removeEventListener("select",Q),n.removeEventListener("selectstart",Q),n.removeEventListener("selectend",Q),n.removeEventListener("squeeze",Q),n.removeEventListener("squeezestart",Q),n.removeEventListener("squeezeend",Q),n.removeEventListener("end",V),n.removeEventListener("inputsourceschange",ae);for(let re=0;re<C.length;re++){let se=T[re];se!==null&&(T[re]=null,C[re].disconnect(se))}q=null,Z=null,E.reset(),e.setRenderTarget(I),v=null,y=null,m=null,n=null,P=null,ce.stop(),i.isPresenting=!1,e.setPixelRatio(F),e.setSize(D.width,D.height,!1),i.dispatchEvent({type:"sessionend"})}s(V,"onSessionEnd"),this.setFramebufferScaleFactor=function(re){a=re,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(re){l=re,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(re){c=re},this.getBaseLayer=function(){return y!==null?y:v},this.getBinding=function(){return m},this.getFrame=function(){return x},this.getSession=function(){return n},this.setSession=async function(re){if(n=re,n!==null){if(I=e.getRenderTarget(),n.addEventListener("select",Q),n.addEventListener("selectstart",Q),n.addEventListener("selectend",Q),n.addEventListener("squeeze",Q),n.addEventListener("squeezestart",Q),n.addEventListener("squeezeend",Q),n.addEventListener("end",V),n.addEventListener("inputsourceschange",ae),M.xrCompatible!==!0&&await r.makeXRCompatible(),F=e.getPixelRatio(),e.getSize(D),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let se=null,de=null,we=null;M.depth&&(we=M.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,se=M.stencil?E_:r_,de=M.stencil?M_:Jm);let Le={colorFormat:r.RGBA8,depthFormat:we,scaleFactor:a};m=new XRWebGLBinding(n,r),y=m.createProjectionLayer(Le),n.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),P=new Qm(y.textureWidth,y.textureHeight,{format:Ll,type:ed,depthTexture:new Lhe(y.textureWidth,y.textureHeight,de,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:M.stencil,colorSpace:e.outputColorSpace,samples:M.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1})}else{let se={antialias:M.antialias,alpha:!0,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:a};v=new XRWebGLLayer(n,r,se),n.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),P=new Qm(v.framebufferWidth,v.framebufferHeight,{format:Ll,type:ed,colorSpace:e.outputColorSpace,stencilBuffer:M.stencil})}P.isXRRenderTarget=!0,this.setFoveation(u),c=null,o=await n.requestReferenceSpace(l),ce.setContext(n),ce.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(n!==null)return n.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function ae(re){for(let se=0;se<re.removed.length;se++){let de=re.removed[se],we=T.indexOf(de);we>=0&&(T[we]=null,C[we].disconnect(de))}for(let se=0;se<re.added.length;se++){let de=re.added[se],we=T.indexOf(de);if(we===-1){for(let fe=0;fe<C.length;fe++)if(fe>=T.length){T.push(de),we=fe;break}else if(T[fe]===null){T[fe]=de,we=fe;break}if(we===-1)break}let Le=C[we];Le&&Le.connect(de)}}s(ae,"onInputSourcesChange");let Y=new qe,he=new qe;function J(re,se,de){Y.setFromMatrixPosition(se.matrixWorld),he.setFromMatrixPosition(de.matrixWorld);let we=Y.distanceTo(he),Le=se.projectionMatrix.elements,fe=de.projectionMatrix.elements,Re=Le[14]/(Le[10]-1),me=Le[14]/(Le[10]+1),Ae=(Le[9]+1)/Le[5],Ue=(Le[9]-1)/Le[5],_e=(Le[8]-1)/Le[0],lt=(fe[8]+1)/fe[0],tt=Re*_e,We=Re*lt,at=we/(-_e+lt),Lt=at*-_e;if(se.matrixWorld.decompose(re.position,re.quaternion,re.scale),re.translateX(Lt),re.translateZ(at),re.matrixWorld.compose(re.position,re.quaternion,re.scale),re.matrixWorldInverse.copy(re.matrixWorld).invert(),Le[10]===-1)re.projectionMatrix.copy(se.projectionMatrix),re.projectionMatrixInverse.copy(se.projectionMatrixInverse);else{let dt=Re+at,Me=me+at,ve=tt-Lt,Ze=We+(we-Lt),It=Ae*me/Me*dt,Rt=Ue*me/Me*dt;re.projectionMatrix.makePerspective(ve,Ze,It,Rt,dt,Me),re.projectionMatrixInverse.copy(re.projectionMatrix).invert()}}s(J,"setProjectionFromUnion");function ne(re,se){se===null?re.matrixWorld.copy(re.matrix):re.matrixWorld.multiplyMatrices(se.matrixWorld,re.matrix),re.matrixWorldInverse.copy(re.matrixWorld).invert()}s(ne,"updateCamera"),this.updateCamera=function(re){if(n===null)return;let se=re.near,de=re.far;E.texture!==null&&(E.depthNear>0&&(se=E.depthNear),E.depthFar>0&&(de=E.depthFar)),z.near=B.near=k.near=se,z.far=B.far=k.far=de,(q!==z.near||Z!==z.far)&&(n.updateRenderState({depthNear:z.near,depthFar:z.far}),q=z.near,Z=z.far),k.layers.mask=re.layers.mask|2,B.layers.mask=re.layers.mask|4,z.layers.mask=k.layers.mask|B.layers.mask;let we=re.parent,Le=z.cameras;ne(z,we);for(let fe=0;fe<Le.length;fe++)ne(Le[fe],we);Le.length===2?J(z,k,B):z.projectionMatrix.copy(k.projectionMatrix),ee(re,z,we)};function ee(re,se,de){de===null?re.matrix.copy(se.matrixWorld):(re.matrix.copy(de.matrixWorld),re.matrix.invert(),re.matrix.multiply(se.matrixWorld)),re.matrix.decompose(re.position,re.quaternion,re.scale),re.updateMatrixWorld(!0),re.projectionMatrix.copy(se.projectionMatrix),re.projectionMatrixInverse.copy(se.projectionMatrixInverse),re.isPerspectiveCamera&&(re.fov=C_*2*Math.atan(1/re.projectionMatrix.elements[5]),re.zoom=1)}s(ee,"updateUserCamera"),this.getCamera=function(){return z},this.getFoveation=function(){if(!(y===null&&v===null))return u},this.setFoveation=function(re){u=re,y!==null&&(y.fixedFoveation=re),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=re)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(z)};let ue=null;function K(re,se){if(p=se.getViewerPose(c||o),x=se,p!==null){let de=p.views;v!==null&&(e.setRenderTargetFramebuffer(P,v.framebuffer),e.setRenderTarget(P));let we=!1;de.length!==z.cameras.length&&(z.cameras.length=0,we=!0);for(let fe=0;fe<de.length;fe++){let Re=de[fe],me=null;if(v!==null)me=v.getViewport(Re);else{let Ue=m.getViewSubImage(y,Re);me=Ue.viewport,fe===0&&(e.setRenderTargetTextures(P,Ue.colorTexture,y.ignoreDepthValues?void 0:Ue.depthStencilTexture),e.setRenderTarget(P))}let Ae=U[fe];Ae===void 0&&(Ae=new Yl,Ae.layers.enable(fe),Ae.viewport=new Jn,U[fe]=Ae),Ae.matrix.fromArray(Re.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.quaternion,Ae.scale),Ae.projectionMatrix.fromArray(Re.projectionMatrix),Ae.projectionMatrixInverse.copy(Ae.projectionMatrix).invert(),Ae.viewport.set(me.x,me.y,me.width,me.height),fe===0&&(z.matrix.copy(Ae.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale)),we===!0&&z.cameras.push(Ae)}let Le=n.enabledFeatures;if(Le&&Le.includes("depth-sensing")&&n.depthUsage=="gpu-optimized"&&m){let fe=m.getDepthInformation(de[0]);fe&&fe.isValid&&fe.texture&&E.init(e,fe,n.renderState)}}for(let de=0;de<C.length;de++){let we=T[de],Le=C[de];we!==null&&Le!==void 0&&Le.update(we,se,c||o)}ue&&ue(re,se),se.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:se}),x=null}s(K,"onAnimationFrame");let ce=new DB;ce.setAnimationLoop(K),this.setAnimationLoop=function(re){ue=re},this.dispose=function(){}}};s(Ame,"WebXRManager");var gHe=Ame,zg=new Nu,yHe=new Ri;function Sme(t,e){function r(M,I){M.matrixAutoUpdate===!0&&M.updateMatrix(),I.value.copy(M.matrix)}s(r,"refreshTransformUniform");function i(M,I){I.color.getRGB(M.fogColor.value,vB(t)),I.isFog?(M.fogNear.value=I.near,M.fogFar.value=I.far):I.isFogExp2&&(M.fogDensity.value=I.density)}s(i,"refreshFogUniforms");function n(M,I,P,C,T){I.isMeshBasicMaterial||I.isMeshLambertMaterial?a(M,I):I.isMeshToonMaterial?(a(M,I),m(M,I)):I.isMeshPhongMaterial?(a(M,I),p(M,I)):I.isMeshStandardMaterial?(a(M,I),y(M,I),I.isMeshPhysicalMaterial&&v(M,I,T)):I.isMeshMatcapMaterial?(a(M,I),x(M,I)):I.isMeshDepthMaterial?a(M,I):I.isMeshDistanceMaterial?(a(M,I),E(M,I)):I.isMeshNormalMaterial?a(M,I):I.isLineBasicMaterial?(o(M,I),I.isLineDashedMaterial&&l(M,I)):I.isPointsMaterial?u(M,I,P,C):I.isSpriteMaterial?c(M,I):I.isShadowMaterial?(M.color.value.copy(I.color),M.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}s(n,"refreshMaterialUniforms");function a(M,I){M.opacity.value=I.opacity,I.color&&M.diffuse.value.copy(I.color),I.emissive&&M.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(M.map.value=I.map,r(I.map,M.mapTransform)),I.alphaMap&&(M.alphaMap.value=I.alphaMap,r(I.alphaMap,M.alphaMapTransform)),I.bumpMap&&(M.bumpMap.value=I.bumpMap,r(I.bumpMap,M.bumpMapTransform),M.bumpScale.value=I.bumpScale,I.side===eu&&(M.bumpScale.value*=-1)),I.normalMap&&(M.normalMap.value=I.normalMap,r(I.normalMap,M.normalMapTransform),M.normalScale.value.copy(I.normalScale),I.side===eu&&M.normalScale.value.negate()),I.displacementMap&&(M.displacementMap.value=I.displacementMap,r(I.displacementMap,M.displacementMapTransform),M.displacementScale.value=I.displacementScale,M.displacementBias.value=I.displacementBias),I.emissiveMap&&(M.emissiveMap.value=I.emissiveMap,r(I.emissiveMap,M.emissiveMapTransform)),I.specularMap&&(M.specularMap.value=I.specularMap,r(I.specularMap,M.specularMapTransform)),I.alphaTest>0&&(M.alphaTest.value=I.alphaTest);let P=e.get(I),C=P.envMap,T=P.envMapRotation;C&&(M.envMap.value=C,zg.copy(T),zg.x*=-1,zg.y*=-1,zg.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(zg.y*=-1,zg.z*=-1),M.envMapRotation.value.setFromMatrix4(yHe.makeRotationFromEuler(zg)),M.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=I.reflectivity,M.ior.value=I.ior,M.refractionRatio.value=I.refractionRatio),I.lightMap&&(M.lightMap.value=I.lightMap,M.lightMapIntensity.value=I.lightMapIntensity,r(I.lightMap,M.lightMapTransform)),I.aoMap&&(M.aoMap.value=I.aoMap,M.aoMapIntensity.value=I.aoMapIntensity,r(I.aoMap,M.aoMapTransform))}s(a,"refreshUniformsCommon");function o(M,I){M.diffuse.value.copy(I.color),M.opacity.value=I.opacity,I.map&&(M.map.value=I.map,r(I.map,M.mapTransform))}s(o,"refreshUniformsLine");function l(M,I){M.dashSize.value=I.dashSize,M.totalSize.value=I.dashSize+I.gapSize,M.scale.value=I.scale}s(l,"refreshUniformsDash");function u(M,I,P,C){M.diffuse.value.copy(I.color),M.opacity.value=I.opacity,M.size.value=I.size*P,M.scale.value=C*.5,I.map&&(M.map.value=I.map,r(I.map,M.uvTransform)),I.alphaMap&&(M.alphaMap.value=I.alphaMap,r(I.alphaMap,M.alphaMapTransform)),I.alphaTest>0&&(M.alphaTest.value=I.alphaTest)}s(u,"refreshUniformsPoints");function c(M,I){M.diffuse.value.copy(I.color),M.opacity.value=I.opacity,M.rotation.value=I.rotation,I.map&&(M.map.value=I.map,r(I.map,M.mapTransform)),I.alphaMap&&(M.alphaMap.value=I.alphaMap,r(I.alphaMap,M.alphaMapTransform)),I.alphaTest>0&&(M.alphaTest.value=I.alphaTest)}s(c,"refreshUniformsSprites");function p(M,I){M.specular.value.copy(I.specular),M.shininess.value=Math.max(I.shininess,1e-4)}s(p,"refreshUniformsPhong");function m(M,I){I.gradientMap&&(M.gradientMap.value=I.gradientMap)}s(m,"refreshUniformsToon");function y(M,I){M.metalness.value=I.metalness,I.metalnessMap&&(M.metalnessMap.value=I.metalnessMap,r(I.metalnessMap,M.metalnessMapTransform)),M.roughness.value=I.roughness,I.roughnessMap&&(M.roughnessMap.value=I.roughnessMap,r(I.roughnessMap,M.roughnessMapTransform)),I.envMap&&(M.envMapIntensity.value=I.envMapIntensity)}s(y,"refreshUniformsStandard");function v(M,I,P){M.ior.value=I.ior,I.sheen>0&&(M.sheenColor.value.copy(I.sheenColor).multiplyScalar(I.sheen),M.sheenRoughness.value=I.sheenRoughness,I.sheenColorMap&&(M.sheenColorMap.value=I.sheenColorMap,r(I.sheenColorMap,M.sheenColorMapTransform)),I.sheenRoughnessMap&&(M.sheenRoughnessMap.value=I.sheenRoughnessMap,r(I.sheenRoughnessMap,M.sheenRoughnessMapTransform))),I.clearcoat>0&&(M.clearcoat.value=I.clearcoat,M.clearcoatRoughness.value=I.clearcoatRoughness,I.clearcoatMap&&(M.clearcoatMap.value=I.clearcoatMap,r(I.clearcoatMap,M.clearcoatMapTransform)),I.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap,r(I.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),I.clearcoatNormalMap&&(M.clearcoatNormalMap.value=I.clearcoatNormalMap,r(I.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),I.side===eu&&M.clearcoatNormalScale.value.negate())),I.dispersion>0&&(M.dispersion.value=I.dispersion),I.iridescence>0&&(M.iridescence.value=I.iridescence,M.iridescenceIOR.value=I.iridescenceIOR,M.iridescenceThicknessMinimum.value=I.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=I.iridescenceThicknessRange[1],I.iridescenceMap&&(M.iridescenceMap.value=I.iridescenceMap,r(I.iridescenceMap,M.iridescenceMapTransform)),I.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=I.iridescenceThicknessMap,r(I.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),I.transmission>0&&(M.transmission.value=I.transmission,M.transmissionSamplerMap.value=P.texture,M.transmissionSamplerSize.value.set(P.width,P.height),I.transmissionMap&&(M.transmissionMap.value=I.transmissionMap,r(I.transmissionMap,M.transmissionMapTransform)),M.thickness.value=I.thickness,I.thicknessMap&&(M.thicknessMap.value=I.thicknessMap,r(I.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=I.attenuationDistance,M.attenuationColor.value.copy(I.attenuationColor)),I.anisotropy>0&&(M.anisotropyVector.value.set(I.anisotropy*Math.cos(I.anisotropyRotation),I.anisotropy*Math.sin(I.anisotropyRotation)),I.anisotropyMap&&(M.anisotropyMap.value=I.anisotropyMap,r(I.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=I.specularIntensity,M.specularColor.value.copy(I.specularColor),I.specularColorMap&&(M.specularColorMap.value=I.specularColorMap,r(I.specularColorMap,M.specularColorMapTransform)),I.specularIntensityMap&&(M.specularIntensityMap.value=I.specularIntensityMap,r(I.specularIntensityMap,M.specularIntensityMapTransform))}s(v,"refreshUniformsPhysical");function x(M,I){I.matcap&&(M.matcap.value=I.matcap)}s(x,"refreshUniformsMatcap");function E(M,I){let P=e.get(I).light;M.referencePosition.value.setFromMatrixPosition(P.matrixWorld),M.nearDistance.value=P.shadow.camera.near,M.farDistance.value=P.shadow.camera.far}return s(E,"refreshUniformsDistance"),{refreshFogUniforms:i,refreshMaterialUniforms:n}}s(Sme,"WebGLMaterials");function Mme(t,e,r,i){let n={},a={},o=[],l=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function u(P,C){let T=C.program;i.uniformBlockBinding(P,T)}s(u,"bind");function c(P,C){let T=n[P.id];T===void 0&&(x(P),T=p(P),n[P.id]=T,P.addEventListener("dispose",M));let D=C.program;i.updateUBOMapping(P,D);let F=e.render.frame;a[P.id]!==F&&(y(P),a[P.id]=F)}s(c,"update");function p(P){let C=m();P.__bindingPointIndex=C;let T=t.createBuffer(),D=P.__size,F=P.usage;return t.bindBuffer(t.UNIFORM_BUFFER,T),t.bufferData(t.UNIFORM_BUFFER,D,F),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,C,T),T}s(p,"createBuffer");function m(){for(let P=0;P<l;P++)if(o.indexOf(P)===-1)return o.push(P),P;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}s(m,"allocateBindingPointIndex");function y(P){let C=n[P.id],T=P.uniforms,D=P.__cache;t.bindBuffer(t.UNIFORM_BUFFER,C);for(let F=0,k=T.length;F<k;F++){let B=Array.isArray(T[F])?T[F]:[T[F]];for(let U=0,z=B.length;U<z;U++){let q=B[U];if(v(q,F,U,D)===!0){let Z=q.__offset,Q=Array.isArray(q.value)?q.value:[q.value],V=0;for(let ae=0;ae<Q.length;ae++){let Y=Q[ae],he=E(Y);typeof Y=="number"||typeof Y=="boolean"?(q.__data[0]=Y,t.bufferSubData(t.UNIFORM_BUFFER,Z+V,q.__data)):Y.isMatrix3?(q.__data[0]=Y.elements[0],q.__data[1]=Y.elements[1],q.__data[2]=Y.elements[2],q.__data[3]=0,q.__data[4]=Y.elements[3],q.__data[5]=Y.elements[4],q.__data[6]=Y.elements[5],q.__data[7]=0,q.__data[8]=Y.elements[6],q.__data[9]=Y.elements[7],q.__data[10]=Y.elements[8],q.__data[11]=0):(Y.toArray(q.__data,V),V+=he.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,Z,q.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}s(y,"updateBufferData");function v(P,C,T,D){let F=P.value,k=C+"_"+T;if(D[k]===void 0)return typeof F=="number"||typeof F=="boolean"?D[k]=F:D[k]=F.clone(),!0;{let B=D[k];if(typeof F=="number"||typeof F=="boolean"){if(B!==F)return D[k]=F,!0}else if(B.equals(F)===!1)return B.copy(F),!0}return!1}s(v,"hasUniformChanged");function x(P){let C=P.uniforms,T=0,D=16;for(let k=0,B=C.length;k<B;k++){let U=Array.isArray(C[k])?C[k]:[C[k]];for(let z=0,q=U.length;z<q;z++){let Z=U[z],Q=Array.isArray(Z.value)?Z.value:[Z.value];for(let V=0,ae=Q.length;V<ae;V++){let Y=Q[V],he=E(Y),J=T%D,ne=J%he.boundary,ee=J+ne;T+=ne,ee!==0&&D-ee<he.storage&&(T+=D-ee),Z.__data=new Float32Array(he.storage/Float32Array.BYTES_PER_ELEMENT),Z.__offset=T,T+=he.storage}}}let F=T%D;return F>0&&(T+=D-F),P.__size=T,P.__cache={},this}s(x,"prepareUniformsGroup");function E(P){let C={boundary:0,storage:0};return typeof P=="number"||typeof P=="boolean"?(C.boundary=4,C.storage=4):P.isVector2?(C.boundary=8,C.storage=8):P.isVector3||P.isColor?(C.boundary=16,C.storage=12):P.isVector4?(C.boundary=16,C.storage=16):P.isMatrix3?(C.boundary=48,C.storage=48):P.isMatrix4?(C.boundary=64,C.storage=64):P.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",P),C}s(E,"getUniformSize");function M(P){let C=P.target;C.removeEventListener("dispose",M);let T=o.indexOf(C.__bindingPointIndex);o.splice(T,1),t.deleteBuffer(n[C.id]),delete n[C.id],delete a[C.id]}s(M,"onUniformsGroupsDispose");function I(){for(let P in n)t.deleteBuffer(n[P]);o=[],n={},a={}}return s(I,"dispose"),{bind:u,update:c,dispose:I}}s(Mme,"WebGLUniformsGroups");var Eme=class{constructor(e={}){let{canvas:r=nce(),context:i=null,depth:n=!0,stencil:a=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:c=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:m=!1,reverseDepthBuffer:y=!1}=e;this.isWebGLRenderer=!0;let v;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=i.getContextAttributes().alpha}else v=o;let x=new Uint32Array(4),E=new Int32Array(4),M=null,I=null,P=[],C=[];this.domElement=r,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=il,this.toneMapping=qm,this.toneMappingExposure=1;let T=this,D=!1,F=0,k=0,B=null,U=-1,z=null,q=new Jn,Z=new Jn,Q=null,V=new oi(0),ae=0,Y=r.width,he=r.height,J=1,ne=null,ee=null,ue=new Jn(0,0,Y,he),K=new Jn(0,0,Y,he),ce=!1,re=new RA,se=!1,de=!1;this.transmissionResolutionScale=1;let we=new Ri,Le=new Ri,fe=new qe,Re=new Jn,me={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},Ae=!1;function Ue(){return B===null?J:1}s(Ue,"getTargetPixelRatio");let _e=i;function lt(Ie,Je){return r.getContext(Ie,Je)}s(lt,"getContext");try{let Ie={alpha:!0,depth:n,stencil:a,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:p,failIfMajorPerformanceCaveat:m};if("setAttribute"in r&&r.setAttribute("data-engine","three.js r".concat(sB)),r.addEventListener("webglcontextlost",oe,!1),r.addEventListener("webglcontextrestored",le,!1),r.addEventListener("webglcontextcreationerror",Se,!1),_e===null){let Je="webgl2";if(_e=lt(Je,Ie),_e===null)throw lt(Je)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ie){throw console.error("THREE.WebGLRenderer: "+Ie.message),Ie}let tt,We,at,Lt,dt,Me,ve,Ze,It,Rt,Et,pt,Yt,Kt,$t,jt,Nt,Fe,Xe,ht,rr,ar,zr,Qe;function er(){tt=new Gde(_e),tt.init(),ar=new bme(_e,tt),We=new Fde(_e,tt,e,ar),at=new _me(_e,tt),We.reverseDepthBuffer&&y&&at.buffers.depth.setReversed(!0),Lt=new Wde(_e),dt=new cme,Me=new xme(_e,tt,at,dt,We,ar,Lt),ve=new zde(T),Ze=new $de(T),It=new Rde(_e),zr=new kde(_e,It),Rt=new Hde(_e,It,Lt,zr),Et=new Zde(_e,Rt,It,Lt),Xe=new Xde(_e,We,Me),jt=new Bde(dt),pt=new ume(T,ve,Ze,tt,We,zr,jt),Yt=new Sme(T,dt),Kt=new pme,$t=new yme(tt),Fe=new Ode(T,ve,Ze,at,Et,v,u),Nt=new vme(T,Et,We),Qe=new Mme(_e,Lt,We,at),ht=new Nde(_e,tt,Lt),rr=new qde(_e,tt,Lt),Lt.programs=pt.programs,T.capabilities=We,T.extensions=tt,T.properties=dt,T.renderLists=Kt,T.shadowMap=Nt,T.state=at,T.info=Lt}s(er,"initGLContext"),er();let Oe=new gHe(T,_e);this.xr=Oe,this.getContext=function(){return _e},this.getContextAttributes=function(){return _e.getContextAttributes()},this.forceContextLoss=function(){let Ie=tt.get("WEBGL_lose_context");Ie&&Ie.loseContext()},this.forceContextRestore=function(){let Ie=tt.get("WEBGL_lose_context");Ie&&Ie.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(Ie){Ie!==void 0&&(J=Ie,this.setSize(Y,he,!1))},this.getSize=function(Ie){return Ie.set(Y,he)},this.setSize=function(Ie,Je,wt=!0){if(Oe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=Ie,he=Je,r.width=Math.floor(Ie*J),r.height=Math.floor(Je*J),wt===!0&&(r.style.width=Ie+"px",r.style.height=Je+"px"),this.setViewport(0,0,Ie,Je)},this.getDrawingBufferSize=function(Ie){return Ie.set(Y*J,he*J).floor()},this.setDrawingBufferSize=function(Ie,Je,wt){Y=Ie,he=Je,J=wt,r.width=Math.floor(Ie*wt),r.height=Math.floor(Je*wt),this.setViewport(0,0,Ie,Je)},this.getCurrentViewport=function(Ie){return Ie.copy(q)},this.getViewport=function(Ie){return Ie.copy(ue)},this.setViewport=function(Ie,Je,wt,ft){Ie.isVector4?ue.set(Ie.x,Ie.y,Ie.z,Ie.w):ue.set(Ie,Je,wt,ft),at.viewport(q.copy(ue).multiplyScalar(J).round())},this.getScissor=function(Ie){return Ie.copy(K)},this.setScissor=function(Ie,Je,wt,ft){Ie.isVector4?K.set(Ie.x,Ie.y,Ie.z,Ie.w):K.set(Ie,Je,wt,ft),at.scissor(Z.copy(K).multiplyScalar(J).round())},this.getScissorTest=function(){return ce},this.setScissorTest=function(Ie){at.setScissorTest(ce=Ie)},this.setOpaqueSort=function(Ie){ne=Ie},this.setTransparentSort=function(Ie){ee=Ie},this.getClearColor=function(Ie){return Ie.copy(Fe.getClearColor())},this.setClearColor=function(){Fe.setClearColor.apply(Fe,arguments)},this.getClearAlpha=function(){return Fe.getClearAlpha()},this.setClearAlpha=function(){Fe.setClearAlpha.apply(Fe,arguments)},this.clear=function(Ie=!0,Je=!0,wt=!0){let ft=0;if(Ie){let rt=!1;if(B!==null){let zt=B.texture.format;rt=zt===fB||zt===dB||zt===RP}if(rt){let zt=B.texture.type,cr=zt===ed||zt===Jm||zt===Lw||zt===M_||zt===cB||zt===hB,ur=Fe.getClearColor(),Ar=Fe.getClearAlpha(),kr=ur.r,qr=ur.g,Wr=ur.b;cr?(x[0]=kr,x[1]=qr,x[2]=Wr,x[3]=Ar,_e.clearBufferuiv(_e.COLOR,0,x)):(E[0]=kr,E[1]=qr,E[2]=Wr,E[3]=Ar,_e.clearBufferiv(_e.COLOR,0,E))}else ft|=_e.COLOR_BUFFER_BIT}Je&&(ft|=_e.DEPTH_BUFFER_BIT),wt&&(ft|=_e.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),_e.clear(ft)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",oe,!1),r.removeEventListener("webglcontextrestored",le,!1),r.removeEventListener("webglcontextcreationerror",Se,!1),Fe.dispose(),Kt.dispose(),$t.dispose(),dt.dispose(),ve.dispose(),Ze.dispose(),Et.dispose(),zr.dispose(),Qe.dispose(),pt.dispose(),Oe.dispose(),Oe.removeEventListener("sessionstart",Gt),Oe.removeEventListener("sessionend",ke),$e.stop()};function oe(Ie){Ie.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}s(oe,"onContextLost");function le(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;let Ie=Lt.autoReset,Je=Nt.enabled,wt=Nt.autoUpdate,ft=Nt.needsUpdate,rt=Nt.type;er(),Lt.autoReset=Ie,Nt.enabled=Je,Nt.autoUpdate=wt,Nt.needsUpdate=ft,Nt.type=rt}s(le,"onContextRestore");function Se(Ie){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ie.statusMessage)}s(Se,"onContextCreationError");function ze(Ie){let Je=Ie.target;Je.removeEventListener("dispose",ze),De(Je)}s(ze,"onMaterialDispose");function De(Ie){yt(Ie),dt.remove(Ie)}s(De,"deallocateMaterial");function yt(Ie){let Je=dt.get(Ie).programs;Je!==void 0&&(Je.forEach(function(wt){pt.releaseProgram(wt)}),Ie.isShaderMaterial&&pt.releaseShaderCache(Ie))}s(yt,"releaseMaterialProgramReferences"),this.renderBufferDirect=function(Ie,Je,wt,ft,rt,zt){Je===null&&(Je=me);let cr=rt.isMesh&&rt.matrixWorld.determinant()<0,ur=Cr(Ie,Je,wt,ft,rt);at.setMaterial(ft,cr);let Ar=wt.index,kr=1;if(ft.wireframe===!0){if(Ar=Rt.getWireframeAttribute(wt),Ar===void 0)return;kr=2}let qr=wt.drawRange,Wr=wt.attributes.position,vi=qr.start*kr,Li=(qr.start+qr.count)*kr;zt!==null&&(vi=Math.max(vi,zt.start*kr),Li=Math.min(Li,(zt.start+zt.count)*kr)),Ar!==null?(vi=Math.max(vi,0),Li=Math.min(Li,Ar.count)):Wr!=null&&(vi=Math.max(vi,0),Li=Math.min(Li,Wr.count));let Ur=Li-vi;if(Ur<0||Ur===1/0)return;zr.setup(rt,ft,ur,wt,Ar);let yi,bi=ht;if(Ar!==null&&(yi=It.get(Ar),bi=rr,bi.setIndex(yi)),rt.isMesh)ft.wireframe===!0?(at.setLineWidth(ft.wireframeLinewidth*Ue()),bi.setMode(_e.LINES)):bi.setMode(_e.TRIANGLES);else if(rt.isLine){let Xr=ft.linewidth;Xr===void 0&&(Xr=1),at.setLineWidth(Xr*Ue()),rt.isLineSegments?bi.setMode(_e.LINES):rt.isLineLoop?bi.setMode(_e.LINE_LOOP):bi.setMode(_e.LINE_STRIP)}else rt.isPoints?bi.setMode(_e.POINTS):rt.isSprite&&bi.setMode(_e.TRIANGLES);if(rt.isBatchedMesh)if(rt._multiDrawInstances!==null)bi.renderMultiDrawInstances(rt._multiDrawStarts,rt._multiDrawCounts,rt._multiDrawCount,rt._multiDrawInstances);else if(tt.get("WEBGL_multi_draw"))bi.renderMultiDraw(rt._multiDrawStarts,rt._multiDrawCounts,rt._multiDrawCount);else{let Xr=rt._multiDrawStarts,Vr=rt._multiDrawCounts,si=rt._multiDrawCount,oa=Ar?It.get(Ar).bytesPerElement:1,ea=dt.get(ft).currentProgram.getUniforms();for(let Ui=0;Ui<si;Ui++)ea.setValue(_e,"_gl_DrawID",Ui),bi.render(Xr[Ui]/oa,Vr[Ui])}else if(rt.isInstancedMesh)bi.renderInstances(vi,Ur,rt.count);else if(wt.isInstancedBufferGeometry){let Xr=wt._maxInstanceCount!==void 0?wt._maxInstanceCount:1/0,Vr=Math.min(wt.instanceCount,Xr);bi.renderInstances(vi,Ur,Vr)}else bi.render(vi,Ur)};function st(Ie,Je,wt){Ie.transparent===!0&&Ie.side===Pu&&Ie.forceSinglePass===!1?(Ie.side=eu,Ie.needsUpdate=!0,Zr(Ie,Je,wt),Ie.side=Qp,Ie.needsUpdate=!0,Zr(Ie,Je,wt),Ie.side=Pu):Zr(Ie,Je,wt)}s(st,"prepareMaterial"),this.compile=function(Ie,Je,wt=null){wt===null&&(wt=Ie),I=$t.get(wt),I.init(Je),C.push(I),wt.traverseVisible(function(rt){rt.isLight&&rt.layers.test(Je.layers)&&(I.pushLight(rt),rt.castShadow&&I.pushShadow(rt))}),Ie!==wt&&Ie.traverseVisible(function(rt){rt.isLight&&rt.layers.test(Je.layers)&&(I.pushLight(rt),rt.castShadow&&I.pushShadow(rt))}),I.setupLights();let ft=new Set;return Ie.traverse(function(rt){if(!(rt.isMesh||rt.isPoints||rt.isLine||rt.isSprite))return;let zt=rt.material;if(zt)if(Array.isArray(zt))for(let cr=0;cr<zt.length;cr++){let ur=zt[cr];st(ur,wt,rt),ft.add(ur)}else st(zt,wt,rt),ft.add(zt)}),C.pop(),I=null,ft},this.compileAsync=function(Ie,Je,wt=null){let ft=this.compile(Ie,Je,wt);return new Promise(rt=>{function zt(){if(ft.forEach(function(cr){dt.get(cr).currentProgram.isReady()&&ft.delete(cr)}),ft.size===0){rt(Ie);return}setTimeout(zt,10)}s(zt,"checkMaterialsReady"),tt.get("KHR_parallel_shader_compile")!==null?zt():setTimeout(zt,10)})};let kt=null;function mt(Ie){kt&&kt(Ie)}s(mt,"onAnimationFrame");function Gt(){$e.stop()}s(Gt,"onXRSessionStart");function ke(){$e.start()}s(ke,"onXRSessionEnd");let $e=new DB;$e.setAnimationLoop(mt),typeof self<"u"&&$e.setContext(self),this.setAnimationLoop=function(Ie){kt=Ie,Oe.setAnimationLoop(Ie),Ie===null?$e.stop():$e.start()},Oe.addEventListener("sessionstart",Gt),Oe.addEventListener("sessionend",ke),this.render=function(Ie,Je){if(Je!==void 0&&Je.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;if(Ie.matrixWorldAutoUpdate===!0&&Ie.updateMatrixWorld(),Je.parent===null&&Je.matrixWorldAutoUpdate===!0&&Je.updateMatrixWorld(),Oe.enabled===!0&&Oe.isPresenting===!0&&(Oe.cameraAutoUpdate===!0&&Oe.updateCamera(Je),Je=Oe.getCamera()),Ie.isScene===!0&&Ie.onBeforeRender(T,Ie,Je,B),I=$t.get(Ie,C.length),I.init(Je),C.push(I),Le.multiplyMatrices(Je.projectionMatrix,Je.matrixWorldInverse),re.setFromProjectionMatrix(Le),de=this.localClippingEnabled,se=jt.init(this.clippingPlanes,de),M=Kt.get(Ie,P.length),M.init(),P.push(M),Oe.enabled===!0&&Oe.isPresenting===!0){let zt=T.xr.getDepthSensingMesh();zt!==null&&ot(zt,Je,-1/0,T.sortObjects)}ot(Ie,Je,0,T.sortObjects),M.finish(),T.sortObjects===!0&&M.sort(ne,ee),Ae=Oe.enabled===!1||Oe.isPresenting===!1||Oe.hasDepthSensing()===!1,Ae&&Fe.addToRenderList(M,Ie),this.info.render.frame++,se===!0&&jt.beginShadows();let wt=I.state.shadowsArray;Nt.render(wt,Ie,Je),se===!0&&jt.endShadows(),this.info.autoReset===!0&&this.info.reset();let ft=M.opaque,rt=M.transmissive;if(I.setupLights(),Je.isArrayCamera){let zt=Je.cameras;if(rt.length>0)for(let cr=0,ur=zt.length;cr<ur;cr++){let Ar=zt[cr];Ht(ft,rt,Ie,Ar)}Ae&&Fe.render(Ie);for(let cr=0,ur=zt.length;cr<ur;cr++){let Ar=zt[cr];Ft(M,Ie,Ar,Ar.viewport)}}else rt.length>0&&Ht(ft,rt,Ie,Je),Ae&&Fe.render(Ie),Ft(M,Ie,Je);B!==null&&k===0&&(Me.updateMultisampleRenderTarget(B),Me.updateRenderTargetMipmap(B)),Ie.isScene===!0&&Ie.onAfterRender(T,Ie,Je),zr.resetDefaultState(),U=-1,z=null,C.pop(),C.length>0?(I=C[C.length-1],se===!0&&jt.setGlobalState(T.clippingPlanes,I.state.camera)):I=null,P.pop(),P.length>0?M=P[P.length-1]:M=null};function ot(Ie,Je,wt,ft){if(Ie.visible===!1)return;if(Ie.layers.test(Je.layers)){if(Ie.isGroup)wt=Ie.renderOrder;else if(Ie.isLOD)Ie.autoUpdate===!0&&Ie.update(Je);else if(Ie.isLight)I.pushLight(Ie),Ie.castShadow&&I.pushShadow(Ie);else if(Ie.isSprite){if(!Ie.frustumCulled||re.intersectsSprite(Ie)){ft&&Re.setFromMatrixPosition(Ie.matrixWorld).applyMatrix4(Le);let zt=Et.update(Ie),cr=Ie.material;cr.visible&&M.push(Ie,zt,cr,wt,Re.z,null)}}else if((Ie.isMesh||Ie.isLine||Ie.isPoints)&&(!Ie.frustumCulled||re.intersectsObject(Ie))){let zt=Et.update(Ie),cr=Ie.material;if(ft&&(Ie.boundingSphere!==void 0?(Ie.boundingSphere===null&&Ie.computeBoundingSphere(),Re.copy(Ie.boundingSphere.center)):(zt.boundingSphere===null&&zt.computeBoundingSphere(),Re.copy(zt.boundingSphere.center)),Re.applyMatrix4(Ie.matrixWorld).applyMatrix4(Le)),Array.isArray(cr)){let ur=zt.groups;for(let Ar=0,kr=ur.length;Ar<kr;Ar++){let qr=ur[Ar],Wr=cr[qr.materialIndex];Wr&&Wr.visible&&M.push(Ie,zt,Wr,wt,Re.z,qr)}}else cr.visible&&M.push(Ie,zt,cr,wt,Re.z,null)}}let rt=Ie.children;for(let zt=0,cr=rt.length;zt<cr;zt++)ot(rt[zt],Je,wt,ft)}s(ot,"projectObject");function Ft(Ie,Je,wt,ft){let rt=Ie.opaque,zt=Ie.transmissive,cr=Ie.transparent;I.setupLightsView(wt),se===!0&&jt.setGlobalState(T.clippingPlanes,wt),ft&&at.viewport(q.copy(ft)),rt.length>0&&fr(rt,Je,wt),zt.length>0&&fr(zt,Je,wt),cr.length>0&&fr(cr,Je,wt),at.buffers.depth.setTest(!0),at.buffers.depth.setMask(!0),at.buffers.color.setMask(!0),at.setPolygonOffset(!1)}s(Ft,"renderScene");function Ht(Ie,Je,wt,ft){if((wt.isScene===!0?wt.overrideMaterial:null)!==null)return;I.state.transmissionRenderTarget[ft.id]===void 0&&(I.state.transmissionRenderTarget[ft.id]=new Qm(1,1,{generateMipmaps:!0,type:tt.has("EXT_color_buffer_half_float")||tt.has("EXT_color_buffer_float")?PA:ed,minFilter:Ey,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Dn.workingColorSpace}));let rt=I.state.transmissionRenderTarget[ft.id],zt=ft.viewport||q;rt.setSize(zt.z*T.transmissionResolutionScale,zt.w*T.transmissionResolutionScale);let cr=T.getRenderTarget();T.setRenderTarget(rt),T.getClearColor(V),ae=T.getClearAlpha(),ae<1&&T.setClearColor(16777215,.5),T.clear(),Ae&&Fe.render(wt);let ur=T.toneMapping;T.toneMapping=qm;let Ar=ft.viewport;if(ft.viewport!==void 0&&(ft.viewport=void 0),I.setupLightsView(ft),se===!0&&jt.setGlobalState(T.clippingPlanes,ft),fr(Ie,wt,ft),Me.updateMultisampleRenderTarget(rt),Me.updateRenderTargetMipmap(rt),tt.has("WEBGL_multisampled_render_to_texture")===!1){let kr=!1;for(let qr=0,Wr=Je.length;qr<Wr;qr++){let vi=Je[qr],Li=vi.object,Ur=vi.geometry,yi=vi.material,bi=vi.group;if(yi.side===Pu&&Li.layers.test(ft.layers)){let Xr=yi.side;yi.side=eu,yi.needsUpdate=!0,nr(Li,wt,ft,Ur,yi,bi),yi.side=Xr,yi.needsUpdate=!0,kr=!0}}kr===!0&&(Me.updateMultisampleRenderTarget(rt),Me.updateRenderTargetMipmap(rt))}T.setRenderTarget(cr),T.setClearColor(V,ae),Ar!==void 0&&(ft.viewport=Ar),T.toneMapping=ur}s(Ht,"renderTransmissionPass");function fr(Ie,Je,wt){let ft=Je.isScene===!0?Je.overrideMaterial:null;for(let rt=0,zt=Ie.length;rt<zt;rt++){let cr=Ie[rt],ur=cr.object,Ar=cr.geometry,kr=ft===null?cr.material:ft,qr=cr.group;ur.layers.test(wt.layers)&&nr(ur,Je,wt,Ar,kr,qr)}}s(fr,"renderObjects");function nr(Ie,Je,wt,ft,rt,zt){Ie.onBeforeRender(T,Je,wt,ft,rt,zt),Ie.modelViewMatrix.multiplyMatrices(wt.matrixWorldInverse,Ie.matrixWorld),Ie.normalMatrix.getNormalMatrix(Ie.modelViewMatrix),rt.onBeforeRender(T,Je,wt,ft,Ie,zt),rt.transparent===!0&&rt.side===Pu&&rt.forceSinglePass===!1?(rt.side=eu,rt.needsUpdate=!0,T.renderBufferDirect(wt,Je,ft,rt,Ie,zt),rt.side=Qp,rt.needsUpdate=!0,T.renderBufferDirect(wt,Je,ft,rt,Ie,zt),rt.side=Pu):T.renderBufferDirect(wt,Je,ft,rt,Ie,zt),Ie.onAfterRender(T,Je,wt,ft,rt,zt)}s(nr,"renderObject");function Zr(Ie,Je,wt){Je.isScene!==!0&&(Je=me);let ft=dt.get(Ie),rt=I.state.lights,zt=I.state.shadowsArray,cr=rt.state.version,ur=pt.getParameters(Ie,rt.state,zt,Je,wt),Ar=pt.getProgramCacheKey(ur),kr=ft.programs;ft.environment=Ie.isMeshStandardMaterial?Je.environment:null,ft.fog=Je.fog,ft.envMap=(Ie.isMeshStandardMaterial?Ze:ve).get(Ie.envMap||ft.environment),ft.envMapRotation=ft.environment!==null&&Ie.envMap===null?Je.environmentRotation:Ie.envMapRotation,kr===void 0&&(Ie.addEventListener("dispose",ze),kr=new Map,ft.programs=kr);let qr=kr.get(Ar);if(qr!==void 0){if(ft.currentProgram===qr&&ft.lightsStateVersion===cr)return Yr(Ie,ur),qr}else ur.uniforms=pt.getUniforms(Ie),Ie.onBeforeCompile(ur,T),qr=pt.acquireProgram(ur,Ar),kr.set(Ar,qr),ft.uniforms=ur.uniforms;let Wr=ft.uniforms;return(!Ie.isShaderMaterial&&!Ie.isRawShaderMaterial||Ie.clipping===!0)&&(Wr.clippingPlanes=jt.uniform),Yr(Ie,ur),ft.needsLights=$r(Ie),ft.lightsStateVersion=cr,ft.needsLights&&(Wr.ambientLightColor.value=rt.state.ambient,Wr.lightProbe.value=rt.state.probe,Wr.directionalLights.value=rt.state.directional,Wr.directionalLightShadows.value=rt.state.directionalShadow,Wr.spotLights.value=rt.state.spot,Wr.spotLightShadows.value=rt.state.spotShadow,Wr.rectAreaLights.value=rt.state.rectArea,Wr.ltc_1.value=rt.state.rectAreaLTC1,Wr.ltc_2.value=rt.state.rectAreaLTC2,Wr.pointLights.value=rt.state.point,Wr.pointLightShadows.value=rt.state.pointShadow,Wr.hemisphereLights.value=rt.state.hemi,Wr.directionalShadowMap.value=rt.state.directionalShadowMap,Wr.directionalShadowMatrix.value=rt.state.directionalShadowMatrix,Wr.spotShadowMap.value=rt.state.spotShadowMap,Wr.spotLightMatrix.value=rt.state.spotLightMatrix,Wr.spotLightMap.value=rt.state.spotLightMap,Wr.pointShadowMap.value=rt.state.pointShadowMap,Wr.pointShadowMatrix.value=rt.state.pointShadowMatrix),ft.currentProgram=qr,ft.uniformsList=null,qr}s(Zr,"getProgram");function ni(Ie){if(Ie.uniformsList===null){let Je=Ie.currentProgram.getUniforms();Ie.uniformsList=oC.seqWithValue(Je.seq,Ie.uniforms)}return Ie.uniformsList}s(ni,"getUniformList");function Yr(Ie,Je){let wt=dt.get(Ie);wt.outputColorSpace=Je.outputColorSpace,wt.batching=Je.batching,wt.batchingColor=Je.batchingColor,wt.instancing=Je.instancing,wt.instancingColor=Je.instancingColor,wt.instancingMorph=Je.instancingMorph,wt.skinning=Je.skinning,wt.morphTargets=Je.morphTargets,wt.morphNormals=Je.morphNormals,wt.morphColors=Je.morphColors,wt.morphTargetsCount=Je.morphTargetsCount,wt.numClippingPlanes=Je.numClippingPlanes,wt.numIntersection=Je.numClipIntersection,wt.vertexAlphas=Je.vertexAlphas,wt.vertexTangents=Je.vertexTangents,wt.toneMapping=Je.toneMapping}s(Yr,"updateCommonMaterialProperties");function Cr(Ie,Je,wt,ft,rt){Je.isScene!==!0&&(Je=me),Me.resetTextureUnits();let zt=Je.fog,cr=ft.isMeshStandardMaterial?Je.environment:null,ur=B===null?T.outputColorSpace:B.isXRRenderTarget===!0?B.texture.colorSpace:Wy,Ar=(ft.isMeshStandardMaterial?Ze:ve).get(ft.envMap||cr),kr=ft.vertexColors===!0&&!!wt.attributes.color&&wt.attributes.color.itemSize===4,qr=!!wt.attributes.tangent&&(!!ft.normalMap||ft.anisotropy>0),Wr=!!wt.morphAttributes.position,vi=!!wt.morphAttributes.normal,Li=!!wt.morphAttributes.color,Ur=qm;ft.toneMapped&&(B===null||B.isXRRenderTarget===!0)&&(Ur=T.toneMapping);let yi=wt.morphAttributes.position||wt.morphAttributes.normal||wt.morphAttributes.color,bi=yi!==void 0?yi.length:0,Xr=dt.get(ft),Vr=I.state.lights;if(se===!0&&(de===!0||Ie!==z)){let X=Ie===z&&ft.id===U;jt.setState(ft,Ie,X)}let si=!1;ft.version===Xr.__version?(Xr.needsLights&&Xr.lightsStateVersion!==Vr.state.version||Xr.outputColorSpace!==ur||rt.isBatchedMesh&&Xr.batching===!1||!rt.isBatchedMesh&&Xr.batching===!0||rt.isBatchedMesh&&Xr.batchingColor===!0&&rt.colorTexture===null||rt.isBatchedMesh&&Xr.batchingColor===!1&&rt.colorTexture!==null||rt.isInstancedMesh&&Xr.instancing===!1||!rt.isInstancedMesh&&Xr.instancing===!0||rt.isSkinnedMesh&&Xr.skinning===!1||!rt.isSkinnedMesh&&Xr.skinning===!0||rt.isInstancedMesh&&Xr.instancingColor===!0&&rt.instanceColor===null||rt.isInstancedMesh&&Xr.instancingColor===!1&&rt.instanceColor!==null||rt.isInstancedMesh&&Xr.instancingMorph===!0&&rt.morphTexture===null||rt.isInstancedMesh&&Xr.instancingMorph===!1&&rt.morphTexture!==null||Xr.envMap!==Ar||ft.fog===!0&&Xr.fog!==zt||Xr.numClippingPlanes!==void 0&&(Xr.numClippingPlanes!==jt.numPlanes||Xr.numIntersection!==jt.numIntersection)||Xr.vertexAlphas!==kr||Xr.vertexTangents!==qr||Xr.morphTargets!==Wr||Xr.morphNormals!==vi||Xr.morphColors!==Li||Xr.toneMapping!==Ur||Xr.morphTargetsCount!==bi)&&(si=!0):(si=!0,Xr.__version=ft.version);let oa=Xr.currentProgram;si===!0&&(oa=Zr(ft,Je,rt));let ea=!1,Ui=!1,Gr=!1,S=oa.getUniforms(),O=Xr.uniforms;if(at.useProgram(oa.program)&&(ea=!0,Ui=!0,Gr=!0),ft.id!==U&&(U=ft.id,Ui=!0),ea||z!==Ie){at.buffers.depth.getReversed()?(we.copy(Ie.projectionMatrix),oce(we),sce(we),S.setValue(_e,"projectionMatrix",we)):S.setValue(_e,"projectionMatrix",Ie.projectionMatrix),S.setValue(_e,"viewMatrix",Ie.matrixWorldInverse);let X=S.map.cameraPosition;X!==void 0&&X.setValue(_e,fe.setFromMatrixPosition(Ie.matrixWorld)),We.logarithmicDepthBuffer&&S.setValue(_e,"logDepthBufFC",2/(Math.log(Ie.far+1)/Math.LN2)),(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial)&&S.setValue(_e,"isOrthographic",Ie.isOrthographicCamera===!0),z!==Ie&&(z=Ie,Ui=!0,Gr=!0)}if(rt.isSkinnedMesh){S.setOptional(_e,rt,"bindMatrix"),S.setOptional(_e,rt,"bindMatrixInverse");let X=rt.skeleton;X&&(X.boneTexture===null&&X.computeBoneTexture(),S.setValue(_e,"boneTexture",X.boneTexture,Me))}rt.isBatchedMesh&&(S.setOptional(_e,rt,"batchingTexture"),S.setValue(_e,"batchingTexture",rt._matricesTexture,Me),S.setOptional(_e,rt,"batchingIdTexture"),S.setValue(_e,"batchingIdTexture",rt._indirectTexture,Me),S.setOptional(_e,rt,"batchingColorTexture"),rt._colorsTexture!==null&&S.setValue(_e,"batchingColorTexture",rt._colorsTexture,Me));let j=wt.morphAttributes;if((j.position!==void 0||j.normal!==void 0||j.color!==void 0)&&Xe.update(rt,wt,oa),(Ui||Xr.receiveShadow!==rt.receiveShadow)&&(Xr.receiveShadow=rt.receiveShadow,S.setValue(_e,"receiveShadow",rt.receiveShadow)),ft.isMeshGouraudMaterial&&ft.envMap!==null&&(O.envMap.value=Ar,O.flipEnvMap.value=Ar.isCubeTexture&&Ar.isRenderTargetTexture===!1?-1:1),ft.isMeshStandardMaterial&&ft.envMap===null&&Je.environment!==null&&(O.envMapIntensity.value=Je.environmentIntensity),Ui&&(S.setValue(_e,"toneMappingExposure",T.toneMappingExposure),Xr.needsLights&&Mi(O,Gr),zt&&ft.fog===!0&&Yt.refreshFogUniforms(O,zt),Yt.refreshMaterialUniforms(O,ft,J,he,I.state.transmissionRenderTarget[Ie.id]),oC.upload(_e,ni(Xr),O,Me)),ft.isShaderMaterial&&ft.uniformsNeedUpdate===!0&&(oC.upload(_e,ni(Xr),O,Me),ft.uniformsNeedUpdate=!1),ft.isSpriteMaterial&&S.setValue(_e,"center",rt.center),S.setValue(_e,"modelViewMatrix",rt.modelViewMatrix),S.setValue(_e,"normalMatrix",rt.normalMatrix),S.setValue(_e,"modelMatrix",rt.matrixWorld),ft.isShaderMaterial||ft.isRawShaderMaterial){let X=ft.uniformsGroups;for(let ie=0,be=X.length;ie<be;ie++){let Ce=X[ie];Qe.update(Ce,oa),Qe.bind(Ce,oa)}}return oa}s(Cr,"setProgram");function Mi(Ie,Je){Ie.ambientLightColor.needsUpdate=Je,Ie.lightProbe.needsUpdate=Je,Ie.directionalLights.needsUpdate=Je,Ie.directionalLightShadows.needsUpdate=Je,Ie.pointLights.needsUpdate=Je,Ie.pointLightShadows.needsUpdate=Je,Ie.spotLights.needsUpdate=Je,Ie.spotLightShadows.needsUpdate=Je,Ie.rectAreaLights.needsUpdate=Je,Ie.hemisphereLights.needsUpdate=Je}s(Mi,"markUniformsLightsNeedsUpdate");function $r(Ie){return Ie.isMeshLambertMaterial||Ie.isMeshToonMaterial||Ie.isMeshPhongMaterial||Ie.isMeshStandardMaterial||Ie.isShadowMaterial||Ie.isShaderMaterial&&Ie.lights===!0}s($r,"materialNeedsLights"),this.getActiveCubeFace=function(){return F},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(Ie,Je,wt){dt.get(Ie.texture).__webglTexture=Je,dt.get(Ie.depthTexture).__webglTexture=wt;let ft=dt.get(Ie);ft.__hasExternalTextures=!0,ft.__autoAllocateDepthBuffer=wt===void 0,ft.__autoAllocateDepthBuffer||tt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ft.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Ie,Je){let wt=dt.get(Ie);wt.__webglFramebuffer=Je,wt.__useDefaultFramebuffer=Je===void 0};let Qi=_e.createFramebuffer();this.setRenderTarget=function(Ie,Je=0,wt=0){B=Ie,F=Je,k=wt;let ft=!0,rt=null,zt=!1,cr=!1;if(Ie){let ur=dt.get(Ie);if(ur.__useDefaultFramebuffer!==void 0)at.bindFramebuffer(_e.FRAMEBUFFER,null),ft=!1;else if(ur.__webglFramebuffer===void 0)Me.setupRenderTarget(Ie);else if(ur.__hasExternalTextures)Me.rebindTextures(Ie,dt.get(Ie.texture).__webglTexture,dt.get(Ie.depthTexture).__webglTexture);else if(Ie.depthBuffer){let qr=Ie.depthTexture;if(ur.__boundDepthTexture!==qr){if(qr!==null&&dt.has(qr)&&(Ie.width!==qr.image.width||Ie.height!==qr.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Me.setupDepthRenderbuffer(Ie)}}let Ar=Ie.texture;(Ar.isData3DTexture||Ar.isDataArrayTexture||Ar.isCompressedArrayTexture)&&(cr=!0);let kr=dt.get(Ie).__webglFramebuffer;Ie.isWebGLCubeRenderTarget?(Array.isArray(kr[Je])?rt=kr[Je][wt]:rt=kr[Je],zt=!0):Ie.samples>0&&Me.useMultisampledRTT(Ie)===!1?rt=dt.get(Ie).__webglMultisampledFramebuffer:Array.isArray(kr)?rt=kr[wt]:rt=kr,q.copy(Ie.viewport),Z.copy(Ie.scissor),Q=Ie.scissorTest}else q.copy(ue).multiplyScalar(J).floor(),Z.copy(K).multiplyScalar(J).floor(),Q=ce;if(wt!==0&&(rt=Qi),at.bindFramebuffer(_e.FRAMEBUFFER,rt)&&ft&&at.drawBuffers(Ie,rt),at.viewport(q),at.scissor(Z),at.setScissorTest(Q),zt){let ur=dt.get(Ie.texture);_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_CUBE_MAP_POSITIVE_X+Je,ur.__webglTexture,wt)}else if(cr){let ur=dt.get(Ie.texture),Ar=Je;_e.framebufferTextureLayer(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,ur.__webglTexture,wt,Ar)}else if(Ie!==null&&wt!==0){let ur=dt.get(Ie.texture);_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,ur.__webglTexture,wt)}U=-1},this.readRenderTargetPixels=function(Ie,Je,wt,ft,rt,zt,cr){if(!(Ie&&Ie.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ur=dt.get(Ie).__webglFramebuffer;if(Ie.isWebGLCubeRenderTarget&&cr!==void 0&&(ur=ur[cr]),ur){at.bindFramebuffer(_e.FRAMEBUFFER,ur);try{let Ar=Ie.texture,kr=Ar.format,qr=Ar.type;if(!We.textureFormatReadable(kr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!We.textureTypeReadable(qr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Je>=0&&Je<=Ie.width-ft&&wt>=0&&wt<=Ie.height-rt&&_e.readPixels(Je,wt,ft,rt,ar.convert(kr),ar.convert(qr),zt)}finally{let Ar=B!==null?dt.get(B).__webglFramebuffer:null;at.bindFramebuffer(_e.FRAMEBUFFER,Ar)}}},this.readRenderTargetPixelsAsync=async function(Ie,Je,wt,ft,rt,zt,cr){if(!(Ie&&Ie.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ur=dt.get(Ie).__webglFramebuffer;if(Ie.isWebGLCubeRenderTarget&&cr!==void 0&&(ur=ur[cr]),ur){let Ar=Ie.texture,kr=Ar.format,qr=Ar.type;if(!We.textureFormatReadable(kr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!We.textureTypeReadable(qr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Je>=0&&Je<=Ie.width-ft&&wt>=0&&wt<=Ie.height-rt){at.bindFramebuffer(_e.FRAMEBUFFER,ur);let Wr=_e.createBuffer();_e.bindBuffer(_e.PIXEL_PACK_BUFFER,Wr),_e.bufferData(_e.PIXEL_PACK_BUFFER,zt.byteLength,_e.STREAM_READ),_e.readPixels(Je,wt,ft,rt,ar.convert(kr),ar.convert(qr),0);let vi=B!==null?dt.get(B).__webglFramebuffer:null;at.bindFramebuffer(_e.FRAMEBUFFER,vi);let Li=_e.fenceSync(_e.SYNC_GPU_COMMANDS_COMPLETE,0);return _e.flush(),await ace(_e,Li,4),_e.bindBuffer(_e.PIXEL_PACK_BUFFER,Wr),_e.getBufferSubData(_e.PIXEL_PACK_BUFFER,0,zt),_e.deleteBuffer(Wr),_e.deleteSync(Li),zt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(Ie,Je=null,wt=0){Ie.isTexture!==!0&&(fy("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Je=arguments[0]||null,Ie=arguments[1]);let ft=Math.pow(2,-wt),rt=Math.floor(Ie.image.width*ft),zt=Math.floor(Ie.image.height*ft),cr=Je!==null?Je.x:0,ur=Je!==null?Je.y:0;Me.setTexture2D(Ie,0),_e.copyTexSubImage2D(_e.TEXTURE_2D,wt,0,0,cr,ur,rt,zt),at.unbindTexture()};let Gi=_e.createFramebuffer(),Mn=_e.createFramebuffer();this.copyTextureToTexture=function(Ie,Je,wt=null,ft=null,rt=0,zt=null){Ie.isTexture!==!0&&(fy("WebGLRenderer: copyTextureToTexture function signature has changed."),ft=arguments[0]||null,Ie=arguments[1],Je=arguments[2],zt=arguments[3]||0,wt=null),zt===null&&(rt!==0?(fy("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),zt=rt,rt=0):zt=0);let cr,ur,Ar,kr,qr,Wr,vi,Li,Ur,yi=Ie.isCompressedTexture?Ie.mipmaps[zt]:Ie.image;if(wt!==null)cr=wt.max.x-wt.min.x,ur=wt.max.y-wt.min.y,Ar=wt.isBox3?wt.max.z-wt.min.z:1,kr=wt.min.x,qr=wt.min.y,Wr=wt.isBox3?wt.min.z:0;else{let j=Math.pow(2,-rt);cr=Math.floor(yi.width*j),ur=Math.floor(yi.height*j),Ie.isDataArrayTexture?Ar=yi.depth:Ie.isData3DTexture?Ar=Math.floor(yi.depth*j):Ar=1,kr=0,qr=0,Wr=0}ft!==null?(vi=ft.x,Li=ft.y,Ur=ft.z):(vi=0,Li=0,Ur=0);let bi=ar.convert(Je.format),Xr=ar.convert(Je.type),Vr;Je.isData3DTexture?(Me.setTexture3D(Je,0),Vr=_e.TEXTURE_3D):Je.isDataArrayTexture||Je.isCompressedArrayTexture?(Me.setTexture2DArray(Je,0),Vr=_e.TEXTURE_2D_ARRAY):(Me.setTexture2D(Je,0),Vr=_e.TEXTURE_2D),_e.pixelStorei(_e.UNPACK_FLIP_Y_WEBGL,Je.flipY),_e.pixelStorei(_e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Je.premultiplyAlpha),_e.pixelStorei(_e.UNPACK_ALIGNMENT,Je.unpackAlignment);let si=_e.getParameter(_e.UNPACK_ROW_LENGTH),oa=_e.getParameter(_e.UNPACK_IMAGE_HEIGHT),ea=_e.getParameter(_e.UNPACK_SKIP_PIXELS),Ui=_e.getParameter(_e.UNPACK_SKIP_ROWS),Gr=_e.getParameter(_e.UNPACK_SKIP_IMAGES);_e.pixelStorei(_e.UNPACK_ROW_LENGTH,yi.width),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,yi.height),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,kr),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,qr),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,Wr);let S=Ie.isDataArrayTexture||Ie.isData3DTexture,O=Je.isDataArrayTexture||Je.isData3DTexture;if(Ie.isDepthTexture){let j=dt.get(Ie),X=dt.get(Je),ie=dt.get(j.__renderTarget),be=dt.get(X.__renderTarget);at.bindFramebuffer(_e.READ_FRAMEBUFFER,ie.__webglFramebuffer),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,be.__webglFramebuffer);for(let Ce=0;Ce<Ar;Ce++)S&&(_e.framebufferTextureLayer(_e.READ_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,dt.get(Ie).__webglTexture,rt,Wr+Ce),_e.framebufferTextureLayer(_e.DRAW_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,dt.get(Je).__webglTexture,zt,Ur+Ce)),_e.blitFramebuffer(kr,qr,cr,ur,vi,Li,cr,ur,_e.DEPTH_BUFFER_BIT,_e.NEAREST);at.bindFramebuffer(_e.READ_FRAMEBUFFER,null),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,null)}else if(rt!==0||Ie.isRenderTargetTexture||dt.has(Ie)){let j=dt.get(Ie),X=dt.get(Je);at.bindFramebuffer(_e.READ_FRAMEBUFFER,Gi),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,Mn);for(let ie=0;ie<Ar;ie++)S?_e.framebufferTextureLayer(_e.READ_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,j.__webglTexture,rt,Wr+ie):_e.framebufferTexture2D(_e.READ_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,j.__webglTexture,rt),O?_e.framebufferTextureLayer(_e.DRAW_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,X.__webglTexture,zt,Ur+ie):_e.framebufferTexture2D(_e.DRAW_FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,X.__webglTexture,zt),rt!==0?_e.blitFramebuffer(kr,qr,cr,ur,vi,Li,cr,ur,_e.COLOR_BUFFER_BIT,_e.NEAREST):O?_e.copyTexSubImage3D(Vr,zt,vi,Li,Ur+ie,kr,qr,cr,ur):_e.copyTexSubImage2D(Vr,zt,vi,Li,kr,qr,cr,ur);at.bindFramebuffer(_e.READ_FRAMEBUFFER,null),at.bindFramebuffer(_e.DRAW_FRAMEBUFFER,null)}else O?Ie.isDataTexture||Ie.isData3DTexture?_e.texSubImage3D(Vr,zt,vi,Li,Ur,cr,ur,Ar,bi,Xr,yi.data):Je.isCompressedArrayTexture?_e.compressedTexSubImage3D(Vr,zt,vi,Li,Ur,cr,ur,Ar,bi,yi.data):_e.texSubImage3D(Vr,zt,vi,Li,Ur,cr,ur,Ar,bi,Xr,yi):Ie.isDataTexture?_e.texSubImage2D(_e.TEXTURE_2D,zt,vi,Li,cr,ur,bi,Xr,yi.data):Ie.isCompressedTexture?_e.compressedTexSubImage2D(_e.TEXTURE_2D,zt,vi,Li,yi.width,yi.height,bi,yi.data):_e.texSubImage2D(_e.TEXTURE_2D,zt,vi,Li,cr,ur,bi,Xr,yi);_e.pixelStorei(_e.UNPACK_ROW_LENGTH,si),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,oa),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,ea),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,Ui),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,Gr),zt===0&&Je.generateMipmaps&&_e.generateMipmap(Vr),at.unbindTexture()},this.copyTextureToTexture3D=function(Ie,Je,wt=null,ft=null,rt=0){return Ie.isTexture!==!0&&(fy("WebGLRenderer: copyTextureToTexture3D function signature has changed."),wt=arguments[0]||null,ft=arguments[1]||null,Ie=arguments[2],Je=arguments[3],rt=arguments[4]||0),fy('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Ie,Je,wt,ft,rt)},this.initRenderTarget=function(Ie){dt.get(Ie).__webglFramebuffer===void 0&&Me.setupRenderTarget(Ie)},this.initTexture=function(Ie){Ie.isCubeTexture?Me.setTextureCube(Ie,0):Ie.isData3DTexture?Me.setTexture3D(Ie,0):Ie.isDataArrayTexture||Ie.isCompressedArrayTexture?Me.setTexture2DArray(Ie,0):Me.setTexture2D(Ie,0),at.unbindTexture()},this.resetState=function(){F=0,k=0,B=null,at.reset(),zr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return sf}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let r=this.getContext();r.drawingBufferColorspace=Dn._getDrawingBufferColorSpace(e),r.unpackColorSpace=Dn._getUnpackColorSpace()}};s(Eme,"WebGLRenderer");var vHe=Eme;N();function Cme(t,e,r=!1){let i=null,n=0;return function(...a){n++,n===1&&r===!0&&t(...a);let o=s(()=>{(!r||n>1)&&t(...a),i=null,n=0},"later");clearTimeout(i),i=setTimeout(o,e)}}s(Cme,"debounce");N();N();var Ime="[MappedinJS]",Tme=(t=>(t[t.LOG=0]="LOG",t[t.WARN=1]="WARN",t[t.ERROR=2]="ERROR",t[t.SILENT=3]="SILENT",t))(Tme||{});function Pme(t=""){let e="".concat(Ime).concat(t?"-".concat(t):"");return{logState:ja.env.NODE_ENV==="test"?3:0,log(...r){this.logState<=0&&console.log(e,...r)},warn(...r){this.logState<=1&&console.warn(e,...r)},error(...r){this.logState<=2&&console.error(e,...r)},assert(...r){console.assert(...r)},time(r){console.time(r)},timeEnd(r){console.timeEnd(r)},setLevel(r){0<=r&&r<=3&&(this.logState=r)}}}s(Pme,"createLogger");var Lme=Pme();function Dme(t){0<=t&&t<=3&&(Lme.logState=t)}s(Dme,"setLoggerLevel");var Vt=Lme;N();N();var Rme=class extends Error{};s(Rme,"InvalidTokenError");var y2=Rme;y2.prototype.name="InvalidTokenError";function Ome(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let i=r.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}s(Ome,"b64DecodeUnicode");function kme(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Ome(e)}catch{return atob(e)}}s(kme,"base64UrlDecode");function Nme(t,e){if(typeof t!="string")throw new y2("Invalid token specified: must be a string");e||(e={});let r=e.header===!0?0:1,i=t.split(".")[r];if(typeof i!="string")throw new y2("Invalid token specified: missing part #".concat(r+1));let n;try{n=kme(i)}catch(a){throw new y2("Invalid token specified: invalid base64 for part #".concat(r+1," (").concat(a.message,")"))}try{return JSON.parse(n)}catch(a){throw new y2("Invalid token specified: invalid json for part #".concat(r+1," (").concat(a.message,")"))}}s(Nme,"jwtDecode");N();var Zy=63710088e-1;function RB(t){var e,r;let i=Nme(t);if(i.sub==null)throw new Error("Access token is missing sub claim.");return{sub:i.sub,aud:typeof i.aud=="string"?[i.aud]:(e=i.aud)!=null?e:[],capabilities:(r=i.capabilities)!=null?r:{}}}s(RB,"decodeAccessToken");function Vp(t){return t*(Math.PI/180)}s(Vp,"toRadians");function Fme(t){return t*(180/Math.PI)}s(Fme,"toDegrees");function zA(t,e){let r=Math.pow(10,e);return Math.sign(t)*Math.round(Math.abs(t)*r)/r}s(zA,"round");function DO(t,e){return(t%e+e)%e}s(DO,"euclideanModulo");function OB([t,e],[r,i]){let n=Vp(i-e),a=Vp(r-t),o=Vp(e),l=Vp(i),u=Math.sin(n/2)*Math.sin(n/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(o)*Math.cos(l),c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return Zy*c}s(OB,"haversineDistance");function Bme([t,e],[r,i]){let n=Vp(e),a=Vp(t),o=Vp(i),l=Vp(r)-a,u=Math.sin(l)*Math.cos(o),c=Math.cos(n)*Math.sin(o)-Math.sin(n)*Math.cos(o)*Math.cos(l);return Fme((Math.atan2(u,c)+Math.PI*2)%(Math.PI*2))}s(Bme,"getForwardBearing");function kB(t,e){let r=DO(t,Math.PI*2),i=DO(e,Math.PI*2),n=i-r,a=i+(n>Math.PI?-Math.PI*2:n<-Math.PI?Math.PI*2:0);return{start:r,end:a}}s(kB,"shortestTweenRotation");function KT(t){return t instanceof Lde?Number.isFinite(t.min.x)&&Number.isFinite(t.min.y)&&Number.isFinite(t.max.x)&&Number.isFinite(t.max.y):Number.isFinite(t.min.x)&&Number.isFinite(t.min.y)&&Number.isFinite(t.max.x)&&Number.isFinite(t.max.y)&&Number.isFinite(t.min.z)&&Number.isFinite(t.max.z)}s(KT,"isFiniteBox");function Lp(t,e,r,i){return(t<e||t>r)&&Vt.warn(i),Math.min(r,Math.max(e,t))}s(Lp,"clampWithWarning");function zme(t,e){if(t==null||e==null)return t===e;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}s(zme,"arraysEqual");N();var Ume=class Vme extends Error{constructor(e){super(e),$(this,"name","AssertionError"),Error.captureStackTrace&&Error.captureStackTrace(this,Vme)}};s(Ume,"AssertionError");var _He=Ume;function NB(t,e){if(t==null){let r;if(e!=null&&e.customMessage)r=e.customMessage;else{let a=e!=null&&e.valueName?"'".concat(e.valueName,"'"):"value";r="Expected ".concat(a," to be defined, but received ").concat(t)}let i=(e==null?void 0:e.errorClass)||_He,n=new i(r);throw(e==null?void 0:e.captureStackTrace)!==!1&&Error.captureStackTrace&&Error.captureStackTrace(n,NB),n}}s(NB,"assertExists");function RO(t,e,r){if(NB(t),(t==null?void 0:t.type)!==e){let i="Expected type ".concat(e," but got ").concat(t==null?void 0:t.type);throw new Error(r??i)}}s(RO,"assertType");N();var TD=[0,4,6,8,10],ga=s(()=>{let t=new Array(16).fill(0),e=Math.random()*4294967296;for(let i=0;i<t.length;i++)i>0&&(i&3)===0&&(e=Math.random()*4294967296),t[i]=e>>>((i&3)<<3)&255;let r=t.map(i=>i.toString(16).padStart(2,"0"));return r[6]="4"+r[6][1],r[8]=["8","9","a","b"].includes(r[7][0])?r[7]:"a"+r[7][1],TD.map((i,n)=>r.slice(i,n===TD.length-1?void 0:TD[n+1]).join("")).join("-")},"randomId");N();var jme=class{constructor(){$(this,"_subscribers",{})}publish(e,r){!this._subscribers||!this._subscribers[e]||this._subscribers[e].forEach(function(i){typeof i=="function"&&i(r)})}on(e,r){this._subscribers||(this._subscribers={}),this._subscribers[e]=this._subscribers[e]||[],this._subscribers[e].push(r)}off(e,r){if(!this._subscribers||this._subscribers[e]==null)return;let i=this._subscribers[e].indexOf(r);i!==-1&&this._subscribers[e].splice(i,1)}destroy(){this._subscribers={}}};s(jme,"PubSub");var qa=jme;N();var _W="mi-session-data",xW="mi-local-data",fE="id",mE="deviceId",k1,fp,mp,OO=class $me{constructor(){Be(this,fp),Be(this,mp);try{let e=sessionStorage.getItem(_W);e?He(this,fp,JSON.parse(e)):He(this,fp,{[fE]:ga()})}catch{He(this,fp,{[fE]:ga()})}try{let e=localStorage.getItem(xW);e?He(this,mp,JSON.parse(e)):He(this,mp,{[mE]:ga()})}catch{He(this,mp,{[mE]:ga()})}w(this,fp)[fE]||(w(this,fp)[fE]=ga()),w(this,mp)[mE]||(w(this,mp)[mE]=ga())}static getInstance(){return w(this,k1)||He(this,k1,new $me),w(this,k1)}static ___clearInstance(){He(this,k1,void 0)}saveSessionData(e,r){w(this,fp)[e]=r;try{return sessionStorage.setItem(_W,JSON.stringify(w(this,fp))),!0}catch{return!1}}loadSessionData(e){let r=w(this,fp)[e];if(r!=null)return r}saveLocalData(e,r){w(this,mp)[e]=r;try{return localStorage.setItem(xW,JSON.stringify(w(this,mp))),!0}catch{return!1}}loadLocalData(e){let r=w(this,mp)[e];if(r!=null)return r}};k1=new WeakMap,fp=new WeakMap,mp=new WeakMap,s(OO,"SafeStorage"),Be(OO,k1);var O_=OO;N();function kO(t){return(t%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}s(kO,"normalizeAngle");N();N();N();N();N();N();N();N();var xu=63710088e-1,Gme={centimeters:xu*100,centimetres:xu*100,degrees:xu/111325,feet:xu*3.28084,inches:xu*39.37,kilometers:xu/1e3,kilometres:xu/1e3,meters:xu,metres:xu,miles:xu/1609.344,millimeters:xu*1e3,millimetres:xu*1e3,nauticalmiles:xu/1852,radians:1,yards:xu*1.0936};function Vh(t,e,r){r===void 0&&(r={});var i={type:"Feature"};return(r.id===0||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=e||{},i.geometry=t,i}s(Vh,"feature");function hf(t,e,r){if(r===void 0&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!NO(t[0])||!NO(t[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:t};return Vh(i,e,r)}s(hf,"point");function l_(t,e,r){r===void 0&&(r={});for(var i=0,n=t;i<n.length;i++){var a=n[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:t};return Vh(l,e,r)}s(l_,"polygon");function tg(t,e,r){if(r===void 0&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:t};return Vh(i,e,r)}s(tg,"lineString");function Dw(t,e){e===void 0&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}s(Dw,"featureCollection");function Hme(t,e,r){r===void 0&&(r={});var i={type:"MultiLineString",coordinates:t};return Vh(i,e,r)}s(Hme,"multiLineString");function qme(t,e,r){r===void 0&&(r={});var i={type:"MultiPoint",coordinates:t};return Vh(i,e,r)}s(qme,"multiPoint");function Wme(t,e,r){r===void 0&&(r={});var i={type:"MultiPolygon",coordinates:t};return Vh(i,e,r)}s(Wme,"multiPolygon");function Xme(t,e){e===void 0&&(e="kilometers");var r=Gme[e];if(!r)throw new Error(e+" units is invalid");return t*r}s(Xme,"radiansToLength");function Zme(t,e){e===void 0&&(e="kilometers");var r=Gme[e];if(!r)throw new Error(e+" units is invalid");return t/r}s(Zme,"lengthToRadians");function JT(t){var e=t%(2*Math.PI);return e*180/Math.PI}s(JT,"radiansToDegrees");function eh(t){var e=t%360;return e*Math.PI/180}s(eh,"degreesToRadians");function NO(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}s(NO,"isNumber");function ux(t,e,r){if(t!==null)for(var i,n,a,o,l,u,c,p=0,m=0,y,v=t.type,x=v==="FeatureCollection",E=v==="Feature",M=x?t.features.length:1,I=0;I<M;I++){c=x?t.features[I].geometry:E?t.geometry:t,y=c?c.type==="GeometryCollection":!1,l=y?c.geometries.length:1;for(var P=0;P<l;P++){var C=0,T=0;if(o=y?c.geometries[P]:c,o!==null){u=o.coordinates;var D=o.type;switch(p=r&&(D==="Polygon"||D==="MultiPolygon")?1:0,D){case null:break;case"Point":if(e(u,m,I,C,T)===!1)return!1;m++,C++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(e(u[i],m,I,C,T)===!1)return!1;m++,D==="MultiPoint"&&C++}D==="LineString"&&C++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(n=0;n<u[i].length-p;n++){if(e(u[i][n],m,I,C,T)===!1)return!1;m++}D==="MultiLineString"&&C++,D==="Polygon"&&T++}D==="Polygon"&&C++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(T=0,n=0;n<u[i].length;n++){for(a=0;a<u[i][n].length-p;a++){if(e(u[i][n][a],m,I,C,T)===!1)return!1;m++}T++}C++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(ux(o.geometries[i],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}s(ux,"coordEach");function Yme(t,e,r,i){var n=r;return ux(t,function(a,o,l,u,c){o===0&&r===void 0?n=a:n=e(n,a,o,l,u,c)},i),n}s(Yme,"coordReduce");function FO(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}s(FO,"featureEach");function Kme(t,e){var r,i,n,a,o,l,u,c,p,m,y=0,v=t.type==="FeatureCollection",x=t.type==="Feature",E=v?t.features.length:1;for(r=0;r<E;r++){for(l=v?t.features[r].geometry:x?t.geometry:t,c=v?t.features[r].properties:x?t.properties:{},p=v?t.features[r].bbox:x?t.bbox:void 0,m=v?t.features[r].id:x?t.id:void 0,u=l?l.type==="GeometryCollection":!1,o=u?l.geometries.length:1,n=0;n<o;n++){if(a=u?l.geometries[n]:l,a===null){if(e(null,y,c,p,m)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,y,c,p,m)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(e(a.geometries[i],y,c,p,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}y++}}s(Kme,"geomEach");function mf(t,e){Kme(t,function(r,i,n,a,o){var l=r===null?null:r.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(Vh(r,n,{bbox:a,id:o}),i,0)===!1?!1:void 0}var u;switch(l){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var c=0;c<r.coordinates.length;c++){var p=r.coordinates[c],m={type:u,coordinates:p};if(e(Vh(m,n),i,c)===!1)return!1}})}s(mf,"flattenEach");function Jme(t,e){mf(t,function(r,i,n){var a=0;if(r.geometry){var o=r.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var l,u=0,c=0,p=0;if(ux(r,function(m,y,v,x,E){if(l===void 0||i>u||x>c||E>p){l=m,u=i,c=x,p=E,a=0;return}var M=tg([l,m],r.properties);if(e(M,i,n,E,a)===!1)return!1;a++,l=m})===!1)return!1}}})}s(Jme,"segmentEach");function Qme(t,e,r){var i=r,n=!1;return Jme(t,function(a,o,l,u,c){n===!1&&r===void 0?i=a:i=e(i,a,o,l,u,c),n=!0}),i}s(Qme,"segmentReduce");function QT(t){var e=[1/0,1/0,-1/0,-1/0];return ux(t,function(r){e[0]>r[0]&&(e[0]=r[0]),e[1]>r[1]&&(e[1]=r[1]),e[2]<r[0]&&(e[2]=r[0]),e[3]<r[1]&&(e[3]=r[1])}),e}s(QT,"bbox");QT.default=QT;var UA=QT;function ege(t){return UA(t)}s(ege,"getBoundingBoxFromFeature");N();var BO="#ffffff",tge=class{constructor(e={}){$(this,"initialColor",BO),$(this,"color",BO),$(this,"initialTopColor"),$(this,"topColor"),$(this,"topTexture"),$(this,"texture"),$(this,"hoverColor"),$(this,"dirty",!0),$(this,"visible",!0),$(this,"opacity",1),$(this,"width",.1),$(this,"height",.1),$(this,"initialHeight",.1),$(this,"altitude",0),$(this,"join","round"),$(this,"cap","round"),$(this,"showImage",!0),$(this,"flipImageToFaceCamera",!0),$(this,"url"),$(this,"side","double"),$(this,"renderOrder",0),this.color=(e==null?void 0:e.color)!==void 0?e.color:this.color,this.initialColor=this.color,this.width=(e==null?void 0:e.width)!==void 0?e.width:this.width,this.opacity=(e==null?void 0:e.opacity)!==void 0?e.opacity:this.opacity,this.visible=(e==null?void 0:e.visible)!==void 0?e.visible:this.visible,this.height=(e==null?void 0:e.height)!==void 0?e.height:this.height,this.initialHeight=this.height,this.altitude=(e==null?void 0:e.altitude)!==void 0?e.altitude:this.altitude,this.join=(e==null?void 0:e.join)!==void 0?e.join:this.join,this.cap=(e==null?void 0:e.cap)!==void 0?e.cap:this.cap,this.topColor=e==null?void 0:e.topColor,this.initialTopColor=this.topColor,this.texture=e==null?void 0:e.texture,this.topTexture=e==null?void 0:e.topTexture,this.showImage=(e==null?void 0:e.showImage)!==void 0?e.showImage:this.showImage,this.flipImageToFaceCamera=(e==null?void 0:e.flipImageToFaceCamera)!==void 0?e.flipImageToFaceCamera:this.flipImageToFaceCamera,this.url=e==null?void 0:e.url,this.side=(e==null?void 0:e.side)!==void 0?e.side:this.side,this.renderOrder=(e==null?void 0:e.renderOrder)!==void 0?e.renderOrder:this.renderOrder}};s(tge,"StyleComponent");var u_=tge,rge=class extends bB{constructor(){super(...arguments),$(this,"type","entityBatchedMesh"),$(this,"userData",{entities:{}})}};s(rge,"EntityBatchedMesh");var FB=rge,sC,lC,D0,ige=class{constructor(e){$(this,"mesh"),$(this,"focusMesh"),$(this,"imageMesh"),$(this,"textMesh"),$(this,"textEntityId"),$(this,"type","geometry"),$(this,"dirty",!0),$(this,"detached",!1),$(this,"instanceIndex",-1),$(this,"geometry"),$(this,"material"),$(this,"feature"),$(this,"currentHeight",.1),$(this,"focusable",!1),$(this,"color",new oi),$(this,"topColor",new oi),$(this,"position",new qe),Be(this,sC,0),Be(this,lC,1),Be(this,D0),$(this,"texturesVisible",!1),this.feature=e}get visible(){return this.mesh&&this.instanceIndex!==-1?this.mesh.getVisibleAt(this.instanceIndex):!1}set visible(e){this.mesh&&this.instanceIndex!==-1&&this.mesh.setVisibleAt(this.instanceIndex,e)}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}setColor(e,r){this.color.set(e),this.topColor.set(r),this.material&&this.material.setColor(this.instanceIndex,this.color,this.topColor)}getColor(){var e;return(e=this.material)==null?void 0:e.getColor(this.instanceIndex)}get altitude(){return w(this,sC)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,sC,e))}get opacity(){return w(this,lC)}set opacity(e){if(this.material&&(this.material.opacity=e,this.material.transparent=e<1,this.material.needsUpdate=!0),this.imageMesh){let r=Array.isArray(this.imageMesh.material)?this.imageMesh.material:[this.imageMesh.material];for(let i of r)i.opacity=e,i.needsUpdate=!0}He(this,lC,e)}get texture(){var e,r;return(r=(e=this.material)==null?void 0:e.texture)==null?void 0:r.image.src}set texture(e){this.material&&(this.material.texture=e)}get textureInstance(){var e;return(e=this.material)==null?void 0:e.texture}set topTexture(e){this.material&&(this.material.topTexture=e)}get topTexture(){var e,r;return(r=(e=this.material)==null?void 0:e.topTexture)==null?void 0:r.image.src}get topTextureInstance(){var e;return(e=this.material)==null?void 0:e.topTexture}set blendTexture(e){this.material&&(this.material.blendTexture=e)}get featureBbox(){return w(this,D0)?w(this,D0):(He(this,D0,ege(this.feature)),w(this,D0))}showTextures(){this.material&&(this.material.showTextures(this.instanceIndex),this.texturesVisible=!0)}hideTextures(){this.material&&(this.material.hideTextures(this.instanceIndex),this.texturesVisible=!1)}removeSideTexture(){this.material&&this.material.removeSideTexture(this.instanceIndex)}removeTopTexture(){this.material&&this.material.removeTopTexture(this.instanceIndex)}};sC=new WeakMap,lC=new WeakMap,D0=new WeakMap,s(ige,"MeshComponent");var tu=ige;N();var bW="#ffffff",Hg,nge=class{constructor(e={}){$(this,"color",bW),$(this,"initialColor",bW),$(this,"topColor"),$(this,"initialTopColor"),$(this,"opacity",1),$(this,"height"),Be(this,Hg),$(this,"outline",!0),$(this,"texture"),$(this,"topTexture"),$(this,"dirty",!0);var r,i;this.color=(r=e==null?void 0:e.color)!=null?r:this.color,this.initialColor=this.color,this.topColor=e==null?void 0:e.topColor,this.initialTopColor=this.topColor,this.opacity=(i=e==null?void 0:e.opacity)!=null?i:this.opacity,this.height=e==null?void 0:e.height,this.shading=e==null?void 0:e.shading,this.outline=(e==null?void 0:e.outline)!==void 0?!!e.outline:this.outline}get shading(){return w(this,Hg)}set shading(e){var r;if(!e){He(this,Hg,void 0);return}He(this,Hg,(r=w(this,Hg))!=null?r:{start:0,end:0,intensity:0}),Object.assign(w(this,Hg),e)}};Hg=new WeakMap,s(nge,"GeometryGroupStyleComponent");var zO=nge,age=class extends Ha{constructor(e,r=new zO){super(),$(this,"visible",!0),$(this,"type","geometry-group"),$(this,"components"),$(this,"userData",{entityId:"",entities3D:new Set,opacity:1,dirty:!0,shadingDirty:!0}),this.components=[r],this.userData.entityId=e}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}getOpacity(){return this.userData.opacity}setOpacity(e){this.userData.opacity=e}removeEntity(){this.dispatchEvent({type:"childremoved",child:this})}getfirstChildEntityId(){let e;for(let r of this.children)if(!r.userData.detached){e=r;break}return e instanceof FB?Object.values(e.userData.entities)[0]:void 0}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}))}get altitude(){return this.position.z}};s(age,"GeometryGroupObject3D");var Fu=age;N();var oge=class extends Ha{};s(oge,"Geometry2DObject3D");var Rw=oge,sge=class{constructor(e,r,i=0){$(this,"id"),$(this,"verticalOffset"),$(this,"occluderId"),$(this,"object3d",new Rw),$(this,"components"),$(this,"disposed",!1),$(this,"worldPosition",new qe),this.id=e.id||ga(),this.components=[e],this.verticalOffset=i,this.object3d=new Rw,this.object3d.position.set(r.x,r.y,r.z+i),this.object3d.userData.entityId=this.id,this.object3d.userData.type=this.type,this.positionDirty=!0}get type(){return this.components[0].type}get parentObject3D(){return this.object3d.parent}get attachedTo(){return this.object3d.userData.attachedEntityId}get position(){return this.positionDirty&&(this.object3d.matrixAutoUpdate=!0,this.object3d.getWorldPosition(this.worldPosition),this.positionDirty=!1,this.object3d.matrixAutoUpdate=!1),this.worldPosition}get positionDirty(){return this.object3d.userData.worldPositionDirty}set positionDirty(e){this.object3d.userData.worldPositionDirty=e}updatePosition(e){this.object3d.position.copy(e),this.positionDirty=!0}setAltitude(e){this.object3d.position.z=e,this.positionDirty=!0}};s(sge,"Geometry2D");var k_=sge;N();var lge=class extends Ha{constructor(){super(...arguments),$(this,"type","geometry"),$(this,"userData",{entityId:"",type:"geometry"})}raycast(e,r){this.userData.type==="model"&&this.children[0]&&e.intersectObject(this.children[0],!0).forEach(i=>{r.push(i)})}};s(lge,"Geometry3DObject3D");var cx=lge,uge=class{constructor(e,r){$(this,"id",ga()),$(this,"components"),$(this,"entities2D",new Map),this.components=[e,r]}get object3d(){return this.components[0].mesh}get parentObject3D(){var e;return(e=this.components[0].mesh)==null?void 0:e.parent}get type(){return this.components[0].type}attach(e){this.parentObject3D instanceof Fu?e.object3d.userData.attachedEntityId=this.id:this.entities2D.set(e.id,e)}detach(e){this.parentObject3D instanceof Fu&&(e.object3d.userData.parentEntityId=void 0),this.entities2D.delete(e.id)}removeAllEntities(){for(let e of this.entities2D.values())this.detach(e)}};s(uge,"Geometry3D");var za=uge,cge=class uC extends Ha{constructor(e){super(),$(this,"childrenIds",new Set),$(this,"children",[]),$(this,"type","group-container"),$(this,"userData",{entityId:"",entities2D:new Set,dirty:!0,occluderDirty:!1,opacity:1,computedOpacity:1,preloadGeometry:!1}),$(this,"components",[]),this.userData.entityId=e}addOccluderFeature(e,r){this.userData.occluderFeature=e,this.userData.occluderId=r,this.userData.occluderDirty=!0}addEntity(e){e instanceof uC?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof k_?(this.childrenIds.add(e.id),this.add(e.object3d),this.userData.entities2D.add(e.id),e.positionDirty=!0):e instanceof Fu?(this.childrenIds.add(e.userData.entityId),this.add(e)):e instanceof za&&e.object3d&&(this.childrenIds.add(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childadded",child:this})}removeEntity(e){e instanceof uC?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof k_?(this.childrenIds.delete(e.id),this.userData.entities2D.delete(e.id),this.remove(e.object3d)):e instanceof Fu?(this.childrenIds.delete(e.userData.entityId),this.remove(e)):e instanceof za&&e.object3d&&(this.childrenIds.delete(e.id),this.add(e.object3d)),this.dispatchEvent({type:"childremoved",child:this})}setVisible(e){this.visible!==e&&(this.visible=e,this.dispatchEvent({type:"childremoved",child:this}))}setAltitude(e){this.position.z!==e&&(this.position.z=e,this.dispatchEvent({type:"childremoved",child:this}),this.set2DGeometryChildrenPositionDirty())}set2DGeometryChildrenPositionDirty(){this.children.forEach(e=>{e instanceof Rw?e.userData.worldPositionDirty=!0:e instanceof uC&&e.set2DGeometryChildrenPositionDirty()})}get altitude(){return this.position.z}setOpacity(e){this.userData.opacity=e}get opacity(){return this.userData.opacity}};s(cge,"GroupContainerObject3D");var Yn=cge;N();var BB={top:0,bottom:0,left:0,right:0,type:"pixel"},hge="mappedin",pge={ALWAYS_ON_TOP:10},wW=250;N();function dge(t){let e=t.min,r=t.max,i=new qe(e.x,e.y,e.z),n=new qe(r.x,e.y,e.z),a=new qe(e.x,r.y,e.z),o=new qe(r.x,r.y,e.z);return[i,n,a,o]}s(dge,"getCornersOfBoundingBox");N();function N1(t,e){let r;return typeof e=="string"||typeof e=="number"?(r=t.geometry2DMap.get(e),r==null&&(r=t.geometry3DMap.get(e))):typeof(e==null?void 0:e.id)=="string"||typeof(e==null?void 0:e.id)=="number"?(r=t.geometry2DMap.get(e.id),r==null&&(r=t.geometry3DMap.get(e.id))):r=e,r}s(N1,"getGeometryByGeometryId");function fge(t,e,r=[],i=new to,n){(t.getSystems().renderSystem.threeDdirty||t.getSystems().renderSystem.twoDdirty)&&t.renderSync();let a=N1(t.getInternalState(),e);return zB(a,r,i,n),r}s(fge,"getVerticesOfEntity");var gE=new qe;function zB(t,e=[],r=new to,i){if(t.visible){if(t.isMesh||t.isLine||t.isPoints){let n=t.geometry;if(n.isBufferGeometry){let a=n.attributes.position;for(let o=0;o<a.count;o++)gE.fromBufferAttribute(a,o),i!==void 0&&(gE.z=i),e.push(gE.clone()),r.expandByPoint(gE)}}for(let n of t.children)zB(n,e,r,i)}}s(zB,"traverse");N();function uw(){return typeof window>"u"?1:Math.min(window.devicePixelRatio,2)}s(uw,"getPixelRatio");N();function e3(t,e,r=!1){let i=null,n=0;return function(...a){n++,n===1&&r===!0&&t(...a);let o=s(()=>{(!r||n>1)&&t(...a),i=null,n=0},"later");clearTimeout(i),i=setTimeout(o,e)}}s(e3,"debounce");N();var xHe=(()=>{let t;return{getDeviceType(){if(t)return t;let{userAgent:e,platform:r,maxTouchPoints:i}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),a=r==="iPad"||r.indexOf("Mac")===0&&i>0&&!window.MSStream,o=/android/i.test(e);return t={isIpad:a,isMobile:o||n||a,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e),isWindows:/windows/i.test(e)},t},_reset(){t=void 0}}})(),AW=xHe.getDeviceType,mge=(()=>{let t,e,r;function i(){if(e!==void 0)return e;t||(t=document.createElement("canvas"));let a=t.getContext("webgl")||t.getContext("experimental-webgl");if(!a)return e;try{let o=AW().isFirefox?null:a.getExtension("WEBGL_debug_renderer_info");return e=o?a.getParameter(o.UNMASKED_RENDERER_WEBGL):a.getParameter(a.RENDERER),e}catch{let l=new Error("Failed getting device info");throw l.name="FailedGettingDeviceInfo",l}}s(i,"getInfo");function n(){var a,o;if(!AW().isWindows)return!1;if(r!==void 0)return r;let l=(o=(a=bHe())==null?void 0:a.toLowerCase())!=null?o:"";return r=l.includes("intel")&&(l.includes("uhd")||l.includes("iris")),r}return s(n,"shouldDisableOffscreenCanvas"),{getInfo:i,shouldDisableOffscreenCanvas:n,_setCanvas(a){t=a,e=void 0,r=void 0}}})(),bHe=mge.getInfo,wHe=mge.shouldDisableOffscreenCanvas;N();function Zc(t,e){let r={};for(let i=0;i<e.length;i++){let n=e[i];n in t&&(r[n]=t[n])}return r}s(Zc,"pick");function gge(t){return Object.keys(t).length===0}s(gge,"isEmpty");N();var AHe=s(t=>e=>{if(!e.includes("mappedin")){let r={};for(let i in t){let n=t[i];e.includes("mappedin")||(t[i]=n)}return{url:e,headers:r}}return{url:e,headers:t}},"transformRequest");function UB(t,e,r,i){let n=t*(Math.PI/180),a=i/Zy,o=t+a*180/Math.PI,l=r/Zy/Math.cos(n),u=e+l*180/Math.PI;return{lat:o,lon:u}}s(UB,"cartesianToGeographic");function VB(t,e,r,i){let n=r*(Math.PI/180),a=i*(Math.PI/180),o=t*(Math.PI/180),l=e*(Math.PI/180),u=n-o,c=a-l,p=Zy*c*Math.cos(o),m=Zy*u;return{x:p,y:m}}s(VB,"geographicToCartesian");var yge=s((t,e)=>{var r;if(t.children&&t.visible)for(let i of t.children){if(i.visible&&i.type)if("entities3D"in i.userData&&(r=i.userData)!=null&&r.entities3D&&i.type==="geometry-group"){e.add(i.userData.entityId);for(let n of i.userData.entities3D.values())e.add(n)}else(i.type==="group-container"||i.type==="custom-geometry"||i instanceof cx)&&e.add(i.userData.entityId);yge(i,e)}return e},"populateGeometry3DIdsInScene"),vge=s((t,e)=>{var r;if(t.children&&t.visible&&!((r=t.userData)!=null&&r.hidden))for(let i of t.children)i.visible&&i instanceof Rw&&e.add(i.userData.entityId),vge(i,e);return e},"populateGeometry2DIdsInScene");function jB(t,e){for(let r in e){if(e[r]==null){t[r]=void 0;continue}typeof e[r]=="object"?jB(t[r],e[r]):t[r]=e[r]}return t}s(jB,"mergeObjects");function $B(t,e,r,i){let n={translateX:t.x,translateY:t.y,translateZ:t.z,scale:t.meterInMercatorCoordinateUnits()},a=new Ri,o=new qe(n.scale,-n.scale,n.scale),l=new Ri().makeTranslation(n.translateX,n.translateY,n.translateZ).scale(o),u=r.elevation;return{id:hge,type:"custom",renderingMode:"3d",render:s((c,p)=>{if(a.fromArray(p),u!==r.elevation){let m=nl.fromLngLat(t.toLngLat(),r.elevation);l.makeTranslation(n.translateX,n.translateY,-m.z).scale(o)}e.projectionMatrix=a.multiply(l),u=r.elevation,i()},"render")}}s($B,"createCustomLayer");function _ge(t){return fetch(t,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials"})})}s(_ge,"fetchToken");async function xge(t){let e=await _ge(t),{access_token:r}=await e.json();return{"x-mappedin-tiles-key":r}}s(xge,"getRequestHeaders");function bge(t,e=0){let r=3735928559^e,i=1103547991^e;for(let n=0,a;n<t.length;n++)a=t.charCodeAt(n),r=Math.imul(r^a,2654435761),i=Math.imul(i^a,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&i)+(r>>>0)}s(bge,"cyrb53");var wge=s(t=>t,"linearEase"),SHe=s(t=>1-Math.cos(t*Math.PI/2),"easeIn");function Yy(t,e,r,i,n,a=wge){t=Math.max(e,Math.min(t,r));let o=(t-Math.min(e,r))/Math.abs(r-e),l=a(o);return i+l*(n-i)}s(Yy,"interpolate");function UO(t,e,r){let i=t*(Math.PI/180)/2,n=e/2;return r*Math.tan(i)/n}s(UO,"getProjectionScaleFactor");function Age(t){return new Km(new Yi(t[0][0],t[0][1]),new Yi(t[1][0],t[1][1])).getCenter().toArray()}s(Age,"getBoundingBoxCenter");function Sge(t,e){return t<e||e<=12}s(Sge,"shouldExpandZoomLevel");function Ow(t){let e=1;return t.type==="geometry-group"&&t.parent!=null&&t.parent instanceof Yn?e=t.parent.userData.computedOpacity:(t.type==="geometry"||t.type==="custom-geometry"||t.type==="model")&&t.parentObject3D!=null&&t.parentObject3D instanceof Fu&&t.parentObject3D.parent!=null&&t.parentObject3D.parent instanceof Yn&&(e=t.parentObject3D.parent.userData.computedOpacity),e}s(Ow,"getGroupContainerOpacity");N();var Mge=class{constructor(e){$(this,"visible"),$(this,"altitude"),$(this,"color"),$(this,"dirty",!0),$(this,"maxWidth"),$(this,"maxHeight"),$(this,"hoverByPolygon"),$(this,"flipToFaceCamera",cw.flipToFaceCamera),$(this,"font"),$(this,"fillOpacity"),$(this,"fontSize"),$(this,"margin"),$(this,"outlineWidth"),$(this,"outlineBlur"),$(this,"outlineOffsetX"),$(this,"strokeColor"),$(this,"strokeOpacity"),$(this,"strokeWidth"),$(this,"hoverColor"),$(this,"outlineOffsetY"),$(this,"outlineColor"),$(this,"outlineOpacity"),e&&Object.assign(this,e)}getState(e=!1){let r={};for(let i in this)!e&&i==="dirty"||this[i]!==void 0&&(r[i]=this[i]);return r}};s(Mge,"Text3DStyleComponent");var VO=Mge,cw=Object.freeze({visible:!0,color:"black",flipToFaceCamera:!0,fillOpacity:1,font:void 0,fontSize:2,margin:[.2,1,.2,1.5],outlineColor:"black",outlineOpacity:1,outlineWidth:0,outlineOffsetX:0,outlineOffsetY:0,outlineBlur:0,strokeOpacity:1,strokeWidth:0,maxWidth:void 0,maxHeight:void 0,strokeColor:"black",hoverColor:void 0});N();N();var Ege=class{constructor(e){$(this,"dirty",!0),$(this,"visible",!0),$(this,"opacity",1),$(this,"verticalOffset",0),$(this,"interactive",!1),$(this,"color"),$(this,"material"),$(this,"rotation"),$(this,"scale"),e&&Object.assign(this,e)}};s(Ege,"ModelStyleComponnet");var Cge=Ege;N();var cC=[1,1,1],hC=[0,0,0];N();function fv(t,e=!1){let r=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),n=new Set(Object.keys(t[0].morphAttributes)),a={},o={},l=t[0].morphTargetsRelative,u=new Vs,c=0;for(let p=0;p<t.length;++p){let m=t[p],y=0;if(r!==(m.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let v in m.attributes){if(!i.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;a[v]===void 0&&(a[v]=[]),a[v].push(m.attributes[v]),y++}if(y!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". Make sure all geometries have the same number of attributes."),null;if(l!==m.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let v in m.morphAttributes){if(!n.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+".  .morphAttributes must be consistent throughout all geometries."),null;o[v]===void 0&&(o[v]=[]),o[v].push(m.morphAttributes[v])}if(e){let v;if(r)v=m.index.count;else if(m.attributes.position!==void 0)v=m.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+p+". The geometry must have either an index or a position attribute"),null;u.addGroup(c,v,p),c+=v}}if(r){let p=0,m=[];for(let y=0;y<t.length;++y){let v=t[y].index;for(let x=0;x<v.count;++x)m.push(v.getX(x)+p);p+=t[y].attributes.position.count}u.setIndex(m)}for(let p in a){let m=jO(a[p]);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+p+" attribute."),null;u.setAttribute(p,m)}for(let p in o){let m=o[p][0].length;if(m===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[p]=[];for(let y=0;y<m;++y){let v=[];for(let E=0;E<o[p].length;++E)v.push(o[p][E][y]);let x=jO(v);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+p+" morphAttribute."),null;u.morphAttributes[p].push(x)}}return u}s(fv,"mergeGeometries");function jO(t){let e,r,i,n=-1,a=0;for(let c=0;c<t.length;++c){let p=t[c];if(e===void 0&&(e=p.array.constructor),e!==p.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=p.itemSize),r!==p.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=p.normalized),i!==p.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(n===-1&&(n=p.gpuType),n!==p.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=p.count*r}let o=new e(a),l=new Zo(o,r,i),u=0;for(let c=0;c<t.length;++c){let p=t[c];if(p.isInterleavedBufferAttribute){let m=u/r;for(let y=0,v=p.count;y<v;y++)for(let x=0;x<r;x++){let E=p.getComponent(y,x);l.setComponent(y+m,x,E)}}else o.set(p.array,u);u+=p.count*r}return n!==void 0&&(l.gpuType=n),l}s(jO,"mergeAttributes");function MHe(t,e){if(e===WUe)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===Aq||e===XUe){let r=t.getIndex();if(r===null){let o=[],l=t.getAttribute("position");if(l!==void 0){for(let u=0;u<l.count;u++)o.push(u);t.setIndex(o),r=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}let i=r.count-2,n=[];if(e===Aq)for(let o=1;o<=i;o++)n.push(r.getX(0)),n.push(r.getX(o)),n.push(r.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(n.push(r.getX(o)),n.push(r.getX(o+1)),n.push(r.getX(o+2))):(n.push(r.getX(o+2)),n.push(r.getX(o+1)),n.push(r.getX(o)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=t.clone();return a.setIndex(n),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}s(MHe,"toTrianglesDrawMode");var GB=bt((t,e)=>{N();var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function a(l){if(l==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(l)}s(a,"toObject");function o(){try{if(!Object.assign)return!1;var l=new String("abc");if(l[5]="de",Object.getOwnPropertyNames(l)[0]==="5")return!1;for(var u={},c=0;c<10;c++)u["_"+String.fromCharCode(c)]=c;var p=Object.getOwnPropertyNames(u).map(function(y){return u[y]});if(p.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(y){m[y]=y}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}s(o,"shouldUseNative"),e.exports=o()?Object.assign:function(l,u){for(var c,p=a(l),m,y=1;y<arguments.length;y++){c=Object(arguments[y]);for(var v in c)i.call(c,v)&&(p[v]=c[v]);if(r){m=r(c);for(var x=0;x<m.length;x++)n.call(c,m[x])&&(p[m[x]]=c[m[x]])}}return p}}),Ige=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self).RBush=i()}(t,function(){function r(P,C,T,D,F){s(function k(B,U,z,q,Z){for(;q>z;){if(q-z>600){var Q=q-z+1,V=U-z+1,ae=Math.log(Q),Y=.5*Math.exp(2*ae/3),he=.5*Math.sqrt(ae*Y*(Q-Y)/Q)*(V-Q/2<0?-1:1),J=Math.max(z,Math.floor(U-V*Y/Q+he)),ne=Math.min(q,Math.floor(U+(Q-V)*Y/Q+he));k(B,U,J,ne,Z)}var ee=B[U],ue=z,K=q;for(i(B,z,U),Z(B[q],ee)>0&&i(B,z,q);ue<K;){for(i(B,ue,K),ue++,K--;Z(B[ue],ee)<0;)ue++;for(;Z(B[K],ee)>0;)K--}Z(B[z],ee)===0?i(B,z,K):i(B,++K,q),K<=U&&(z=K+1),U<=K&&(q=K-1)}},"t")(P,C,T||0,D||P.length-1,F||n)}s(r,"t");function i(P,C,T){var D=P[C];P[C]=P[T],P[T]=D}s(i,"i");function n(P,C){return P<C?-1:P>C?1:0}s(n,"n");var a=s(function(P){P===void 0&&(P=9),this._maxEntries=Math.max(4,P),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()},"r");function o(P,C,T){if(!T)return C.indexOf(P);for(var D=0;D<C.length;D++)if(T(P,C[D]))return D;return-1}s(o,"e");function l(P,C){u(P,0,P.children.length,C,P)}s(l,"a");function u(P,C,T,D,F){F||(F=M(null)),F.minX=1/0,F.minY=1/0,F.maxX=-1/0,F.maxY=-1/0;for(var k=C;k<T;k++){var B=P.children[k];c(F,P.leaf?D(B):B)}return F}s(u,"h");function c(P,C){return P.minX=Math.min(P.minX,C.minX),P.minY=Math.min(P.minY,C.minY),P.maxX=Math.max(P.maxX,C.maxX),P.maxY=Math.max(P.maxY,C.maxY),P}s(c,"o");function p(P,C){return P.minX-C.minX}s(p,"s");function m(P,C){return P.minY-C.minY}s(m,"l");function y(P){return(P.maxX-P.minX)*(P.maxY-P.minY)}s(y,"f");function v(P){return P.maxX-P.minX+(P.maxY-P.minY)}s(v,"u");function x(P,C){return P.minX<=C.minX&&P.minY<=C.minY&&C.maxX<=P.maxX&&C.maxY<=P.maxY}s(x,"m");function E(P,C){return C.minX<=P.maxX&&C.minY<=P.maxY&&C.maxX>=P.minX&&C.maxY>=P.minY}s(E,"c");function M(P){return{children:P,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}s(M,"p");function I(P,C,T,D,F){for(var k=[C,T];k.length;)if(!((T=k.pop())-(C=k.pop())<=D)){var B=C+Math.ceil((T-C)/D/2)*D;r(P,B,C,T,F),k.push(C,B,B,T)}}return s(I,"d"),a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(P){var C=this.data,T=[];if(!E(P,C))return T;for(var D=this.toBBox,F=[];C;){for(var k=0;k<C.children.length;k++){var B=C.children[k],U=C.leaf?D(B):B;E(P,U)&&(C.leaf?T.push(B):x(P,U)?this._all(B,T):F.push(B))}C=F.pop()}return T},a.prototype.collides=function(P){var C=this.data;if(!E(P,C))return!1;for(var T=[];C;){for(var D=0;D<C.children.length;D++){var F=C.children[D],k=C.leaf?this.toBBox(F):F;if(E(P,k)){if(C.leaf||x(P,k))return!0;T.push(F)}}C=T.pop()}return!1},a.prototype.load=function(P){if(!P||!P.length)return this;if(P.length<this._minEntries){for(var C=0;C<P.length;C++)this.insert(P[C]);return this}var T=this._build(P.slice(),0,P.length-1,0);if(this.data.children.length)if(this.data.height===T.height)this._splitRoot(this.data,T);else{if(this.data.height<T.height){var D=this.data;this.data=T,T=D}this._insert(T,this.data.height-T.height-1,!0)}else this.data=T;return this},a.prototype.insert=function(P){return P&&this._insert(P,this.data.height-1),this},a.prototype.clear=function(){return this.data=M([]),this},a.prototype.remove=function(P,C){if(!P)return this;for(var T,D,F,k=this.data,B=this.toBBox(P),U=[],z=[];k||U.length;){if(k||(k=U.pop(),D=U[U.length-1],T=z.pop(),F=!0),k.leaf){var q=o(P,k.children,C);if(q!==-1)return k.children.splice(q,1),U.push(k),this._condense(U),this}F||k.leaf||!x(k,B)?D?(T++,k=D.children[T],F=!1):k=null:(U.push(k),z.push(T),T=0,D=k,k=k.children[0])}return this},a.prototype.toBBox=function(P){return P},a.prototype.compareMinX=function(P,C){return P.minX-C.minX},a.prototype.compareMinY=function(P,C){return P.minY-C.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(P){return this.data=P,this},a.prototype._all=function(P,C){for(var T=[];P;)P.leaf?C.push.apply(C,P.children):T.push.apply(T,P.children),P=T.pop();return C},a.prototype._build=function(P,C,T,D){var F,k=T-C+1,B=this._maxEntries;if(k<=B)return l(F=M(P.slice(C,T+1)),this.toBBox),F;D||(D=Math.ceil(Math.log(k)/Math.log(B)),B=Math.ceil(k/Math.pow(B,D-1))),(F=M([])).leaf=!1,F.height=D;var U=Math.ceil(k/B),z=U*Math.ceil(Math.sqrt(B));I(P,C,T,z,this.compareMinX);for(var q=C;q<=T;q+=z){var Z=Math.min(q+z-1,T);I(P,q,Z,U,this.compareMinY);for(var Q=q;Q<=Z;Q+=U){var V=Math.min(Q+U-1,Z);F.children.push(this._build(P,Q,V,D-1))}}return l(F,this.toBBox),F},a.prototype._chooseSubtree=function(P,C,T,D){for(;D.push(C),!C.leaf&&D.length-1!==T;){for(var F=1/0,k=1/0,B=void 0,U=0;U<C.children.length;U++){var z=C.children[U],q=y(z),Z=(Q=P,V=z,(Math.max(V.maxX,Q.maxX)-Math.min(V.minX,Q.minX))*(Math.max(V.maxY,Q.maxY)-Math.min(V.minY,Q.minY))-q);Z<k?(k=Z,F=q<F?q:F,B=z):Z===k&&q<F&&(F=q,B=z)}C=B||C.children[0]}var Q,V;return C},a.prototype._insert=function(P,C,T){var D=T?P:this.toBBox(P),F=[],k=this._chooseSubtree(D,this.data,C,F);for(k.children.push(P),c(k,D);C>=0&&F[C].children.length>this._maxEntries;)this._split(F,C),C--;this._adjustParentBBoxes(D,F,C)},a.prototype._split=function(P,C){var T=P[C],D=T.children.length,F=this._minEntries;this._chooseSplitAxis(T,F,D);var k=this._chooseSplitIndex(T,F,D),B=M(T.children.splice(k,T.children.length-k));B.height=T.height,B.leaf=T.leaf,l(T,this.toBBox),l(B,this.toBBox),C?P[C-1].children.push(B):this._splitRoot(T,B)},a.prototype._splitRoot=function(P,C){this.data=M([P,C]),this.data.height=P.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(P,C,T){for(var D,F,k,B,U,z,q,Z=1/0,Q=1/0,V=C;V<=T-C;V++){var ae=u(P,0,V,this.toBBox),Y=u(P,V,T,this.toBBox),he=(F=ae,k=Y,B=void 0,U=void 0,z=void 0,q=void 0,B=Math.max(F.minX,k.minX),U=Math.max(F.minY,k.minY),z=Math.min(F.maxX,k.maxX),q=Math.min(F.maxY,k.maxY),Math.max(0,z-B)*Math.max(0,q-U)),J=y(ae)+y(Y);he<Z?(Z=he,D=V,Q=J<Q?J:Q):he===Z&&J<Q&&(Q=J,D=V)}return D||T-C},a.prototype._chooseSplitAxis=function(P,C,T){var D=P.leaf?this.compareMinX:p,F=P.leaf?this.compareMinY:m;this._allDistMargin(P,C,T,D)<this._allDistMargin(P,C,T,F)&&P.children.sort(D)},a.prototype._allDistMargin=function(P,C,T,D){P.children.sort(D);for(var F=this.toBBox,k=u(P,0,C,F),B=u(P,T-C,T,F),U=v(k)+v(B),z=C;z<T-C;z++){var q=P.children[z];c(k,P.leaf?F(q):q),U+=v(k)}for(var Z=T-C-1;Z>=C;Z--){var Q=P.children[Z];c(B,P.leaf?F(Q):Q),U+=v(B)}return U},a.prototype._adjustParentBBoxes=function(P,C,T){for(var D=T;D>=0;D--)c(C[D],P)},a.prototype._condense=function(P){for(var C=P.length-1,T=void 0;C>=0;C--)P[C].children.length===0?C>0?(T=P[C-1].children).splice(T.indexOf(P[C]),1):this.clear():l(P[C],this.toBBox)},a})}),EHe=bt((t,e)=>{N(),e.exports=s(function(r,i,n,a){var o=r[0],l=r[1],u=!1;n===void 0&&(n=0),a===void 0&&(a=i.length);for(var c=(a-n)/2,p=0,m=c-1;p<c;m=p++){var y=i[n+p*2+0],v=i[n+p*2+1],x=i[n+m*2+0],E=i[n+m*2+1],M=v>l!=E>l&&o<(x-y)*(l-v)/(E-v)+y;M&&(u=!u)}return u},"pointInPolygonFlat")}),CHe=bt((t,e)=>{N(),e.exports=s(function(r,i,n,a){var o=r[0],l=r[1],u=!1;n===void 0&&(n=0),a===void 0&&(a=i.length);for(var c=a-n,p=0,m=c-1;p<c;m=p++){var y=i[p+n][0],v=i[p+n][1],x=i[m+n][0],E=i[m+n][1],M=v>l!=E>l&&o<(x-y)*(l-v)/(E-v)+y;M&&(u=!u)}return u},"pointInPolygonNested")}),IHe=bt((t,e)=>{N();var r=EHe(),i=CHe();e.exports=s(function(n,a,o,l){return a.length>0&&Array.isArray(a[0])?i(n,a,o,l):r(n,a,o,l)},"pointInPolygon"),e.exports.nested=i,e.exports.flat=r}),THe=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i((r=r||self).predicates={})}(t,function(r){let i=33306690738754706e-32;function n(x,E,M,I,P){let C,T,D,F,k=E[0],B=I[0],U=0,z=0;B>k==B>-k?(C=k,k=E[++U]):(C=B,B=I[++z]);let q=0;if(U<x&&z<M)for(B>k==B>-k?(D=C-((T=k+C)-k),k=E[++U]):(D=C-((T=B+C)-B),B=I[++z]),C=T,D!==0&&(P[q++]=D);U<x&&z<M;)B>k==B>-k?(D=C-((T=C+k)-(F=T-C))+(k-F),k=E[++U]):(D=C-((T=C+B)-(F=T-C))+(B-F),B=I[++z]),C=T,D!==0&&(P[q++]=D);for(;U<x;)D=C-((T=C+k)-(F=T-C))+(k-F),k=E[++U],C=T,D!==0&&(P[q++]=D);for(;z<M;)D=C-((T=C+B)-(F=T-C))+(B-F),B=I[++z],C=T,D!==0&&(P[q++]=D);return C===0&&q!==0||(P[q++]=C),q}s(n,"r");function a(x){return new Float64Array(x)}s(a,"o");let o=33306690738754716e-32,l=22204460492503146e-32,u=11093356479670487e-47,c=a(4),p=a(8),m=a(12),y=a(16),v=a(4);r.orient2d=function(x,E,M,I,P,C){let T=(E-C)*(M-P),D=(x-P)*(I-C),F=T-D;if(T===0||D===0||T>0!=D>0)return F;let k=Math.abs(T+D);return Math.abs(F)>=o*k?F:-function(B,U,z,q,Z,Q,V){let ae,Y,he,J,ne,ee,ue,K,ce,re,se,de,we,Le,fe,Re,me,Ae,Ue=B-Z,_e=z-Z,lt=U-Q,tt=q-Q;ne=(fe=(K=Ue-(ue=(ee=134217729*Ue)-(ee-Ue)))*(re=tt-(ce=(ee=134217729*tt)-(ee-tt)))-((Le=Ue*tt)-ue*ce-K*ce-ue*re))-(se=fe-(me=(K=lt-(ue=(ee=134217729*lt)-(ee-lt)))*(re=_e-(ce=(ee=134217729*_e)-(ee-_e)))-((Re=lt*_e)-ue*ce-K*ce-ue*re))),c[0]=fe-(se+ne)+(ne-me),ne=(we=Le-((de=Le+se)-(ne=de-Le))+(se-ne))-(se=we-Re),c[1]=we-(se+ne)+(ne-Re),ne=(Ae=de+se)-de,c[2]=de-(Ae-ne)+(se-ne),c[3]=Ae;let We=function(ve,Ze){let It=Ze[0];for(let Rt=1;Rt<ve;Rt++)It+=Ze[Rt];return It}(4,c),at=l*V;if(We>=at||-We>=at||(ae=B-(Ue+(ne=B-Ue))+(ne-Z),he=z-(_e+(ne=z-_e))+(ne-Z),Y=U-(lt+(ne=U-lt))+(ne-Q),J=q-(tt+(ne=q-tt))+(ne-Q),ae===0&&Y===0&&he===0&&J===0)||(at=u*V+i*Math.abs(We),(We+=Ue*J+tt*ae-(lt*he+_e*Y))>=at||-We>=at))return We;ne=(fe=(K=ae-(ue=(ee=134217729*ae)-(ee-ae)))*(re=tt-(ce=(ee=134217729*tt)-(ee-tt)))-((Le=ae*tt)-ue*ce-K*ce-ue*re))-(se=fe-(me=(K=Y-(ue=(ee=134217729*Y)-(ee-Y)))*(re=_e-(ce=(ee=134217729*_e)-(ee-_e)))-((Re=Y*_e)-ue*ce-K*ce-ue*re))),v[0]=fe-(se+ne)+(ne-me),ne=(we=Le-((de=Le+se)-(ne=de-Le))+(se-ne))-(se=we-Re),v[1]=we-(se+ne)+(ne-Re),ne=(Ae=de+se)-de,v[2]=de-(Ae-ne)+(se-ne),v[3]=Ae;let Lt=n(4,c,4,v,p);ne=(fe=(K=Ue-(ue=(ee=134217729*Ue)-(ee-Ue)))*(re=J-(ce=(ee=134217729*J)-(ee-J)))-((Le=Ue*J)-ue*ce-K*ce-ue*re))-(se=fe-(me=(K=lt-(ue=(ee=134217729*lt)-(ee-lt)))*(re=he-(ce=(ee=134217729*he)-(ee-he)))-((Re=lt*he)-ue*ce-K*ce-ue*re))),v[0]=fe-(se+ne)+(ne-me),ne=(we=Le-((de=Le+se)-(ne=de-Le))+(se-ne))-(se=we-Re),v[1]=we-(se+ne)+(ne-Re),ne=(Ae=de+se)-de,v[2]=de-(Ae-ne)+(se-ne),v[3]=Ae;let dt=n(Lt,p,4,v,m);ne=(fe=(K=ae-(ue=(ee=134217729*ae)-(ee-ae)))*(re=J-(ce=(ee=134217729*J)-(ee-J)))-((Le=ae*J)-ue*ce-K*ce-ue*re))-(se=fe-(me=(K=Y-(ue=(ee=134217729*Y)-(ee-Y)))*(re=he-(ce=(ee=134217729*he)-(ee-he)))-((Re=Y*he)-ue*ce-K*ce-ue*re))),v[0]=fe-(se+ne)+(ne-me),ne=(we=Le-((de=Le+se)-(ne=de-Le))+(se-ne))-(se=we-Re),v[1]=we-(se+ne)+(ne-Re),ne=(Ae=de+se)-de,v[2]=de-(Ae-ne)+(se-ne),v[3]=Ae;let Me=n(dt,m,4,v,y);return y[Me-1]}(x,E,M,I,P,C,k)},r.orient2dfast=function(x,E,M,I,P,C){return(E-C)*(M-P)-(x-P)*(I-C)},Object.defineProperty(r,"__esModule",{value:!0})})}),PHe=bt((t,e)=>{N();var r=Ige(),i=A9(),n=IHe(),a=THe().orient2d;i.default&&(i=i.default),e.exports=o,e.exports.default=o;function o(F,k,B){k=Math.max(0,k===void 0?2:k),B=B||0;var U=E(F),z=new r(16);z.toBBox=function(re){return{minX:re[0],minY:re[1],maxX:re[0],maxY:re[1]}},z.compareMinX=function(re,se){return re[0]-se[0]},z.compareMinY=function(re,se){return re[1]-se[1]},z.load(F);for(var q=[],Z=0,Q;Z<U.length;Z++){var V=U[Z];z.remove(V),Q=M(V,Q),q.push(Q)}var ae=new r(16);for(Z=0;Z<q.length;Z++)ae.insert(x(q[Z]));for(var Y=k*k,he=B*B;q.length;){var J=q.shift(),ne=J.p,ee=J.next.p,ue=I(ne,ee);if(!(ue<he)){var K=ue/Y;V=l(z,J.prev.p,ne,ee,J.next.next.p,K,ae),V&&Math.min(I(V,ne),I(V,ee))<=K&&(q.push(J),q.push(M(V,J)),z.remove(V),ae.remove(J),ae.insert(x(J)),ae.insert(x(J.next)))}}J=Q;var ce=[];do ce.push(J.p),J=J.next;while(J!==Q);return ce.push(J.p),ce}s(o,"concaveman");function l(F,k,B,U,z,q,Z){for(var Q=new i([],u),V=F.data;V;){for(var ae=0;ae<V.children.length;ae++){var Y=V.children[ae],he=V.leaf?P(Y,B,U):c(B,U,Y);he>q||Q.push({node:Y,dist:he})}for(;Q.length&&!Q.peek().node.children;){var J=Q.pop(),ne=J.node,ee=P(ne,k,B),ue=P(ne,U,z);if(J.dist<ee&&J.dist<ue&&m(B,ne,Z)&&m(U,ne,Z))return ne}V=Q.pop(),V&&(V=V.node)}return null}s(l,"findCandidate");function u(F,k){return F.dist-k.dist}s(u,"compareDist");function c(F,k,B){if(p(F,B)||p(k,B))return 0;var U=C(F[0],F[1],k[0],k[1],B.minX,B.minY,B.maxX,B.minY);if(U===0)return 0;var z=C(F[0],F[1],k[0],k[1],B.minX,B.minY,B.minX,B.maxY);if(z===0)return 0;var q=C(F[0],F[1],k[0],k[1],B.maxX,B.minY,B.maxX,B.maxY);if(q===0)return 0;var Z=C(F[0],F[1],k[0],k[1],B.minX,B.maxY,B.maxX,B.maxY);return Z===0?0:Math.min(U,z,q,Z)}s(c,"sqSegBoxDist");function p(F,k){return F[0]>=k.minX&&F[0]<=k.maxX&&F[1]>=k.minY&&F[1]<=k.maxY}s(p,"inside");function m(F,k,B){for(var U=Math.min(F[0],k[0]),z=Math.min(F[1],k[1]),q=Math.max(F[0],k[0]),Z=Math.max(F[1],k[1]),Q=B.search({minX:U,minY:z,maxX:q,maxY:Z}),V=0;V<Q.length;V++)if(v(Q[V].p,Q[V].next.p,F,k))return!1;return!0}s(m,"noIntersections");function y(F,k,B){return a(F[0],F[1],k[0],k[1],B[0],B[1])}s(y,"cross");function v(F,k,B,U){return F!==U&&k!==B&&y(F,k,B)>0!=y(F,k,U)>0&&y(B,U,F)>0!=y(B,U,k)>0}s(v,"intersects");function x(F){var k=F.p,B=F.next.p;return F.minX=Math.min(k[0],B[0]),F.minY=Math.min(k[1],B[1]),F.maxX=Math.max(k[0],B[0]),F.maxY=Math.max(k[1],B[1]),F}s(x,"updateBBox");function E(F){for(var k=F[0],B=F[0],U=F[0],z=F[0],q=0;q<F.length;q++){var Z=F[q];Z[0]<k[0]&&(k=Z),Z[0]>U[0]&&(U=Z),Z[1]<B[1]&&(B=Z),Z[1]>z[1]&&(z=Z)}var Q=[k,B,U,z],V=Q.slice();for(q=0;q<F.length;q++)n(F[q],Q)||V.push(F[q]);return D(V)}s(E,"fastConvexHull");function M(F,k){var B={p:F,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return k?(B.next=k.next,B.prev=k,k.next.prev=B,k.next=B):(B.prev=B,B.next=B),B}s(M,"insertNode");function I(F,k){var B=F[0]-k[0],U=F[1]-k[1];return B*B+U*U}s(I,"getSqDist");function P(F,k,B){var U=k[0],z=k[1],q=B[0]-U,Z=B[1]-z;if(q!==0||Z!==0){var Q=((F[0]-U)*q+(F[1]-z)*Z)/(q*q+Z*Z);Q>1?(U=B[0],z=B[1]):Q>0&&(U+=q*Q,z+=Z*Q)}return q=F[0]-U,Z=F[1]-z,q*q+Z*Z}s(P,"sqSegDist");function C(F,k,B,U,z,q,Z,Q){var V=B-F,ae=U-k,Y=Z-z,he=Q-q,J=F-z,ne=k-q,ee=V*V+ae*ae,ue=V*Y+ae*he,K=Y*Y+he*he,ce=V*J+ae*ne,re=Y*J+he*ne,se=ee*K-ue*ue,de,we,Le,fe,Re=se,me=se;se===0?(we=0,Re=1,fe=re,me=K):(we=ue*re-K*ce,fe=ee*re-ue*ce,we<0?(we=0,fe=re,me=K):we>Re&&(we=Re,fe=re+ue,me=K)),fe<0?(fe=0,-ce<0?we=0:-ce>ee?we=Re:(we=-ce,Re=ee)):fe>me&&(fe=me,-ce+ue<0?we=0:-ce+ue>ee?we=Re:(we=-ce+ue,Re=ee)),de=we===0?0:we/Re,Le=fe===0?0:fe/me;var Ae=(1-de)*F+de*B,Ue=(1-de)*k+de*U,_e=(1-Le)*z+Le*Z,lt=(1-Le)*q+Le*Q,tt=_e-Ae,We=lt-Ue;return tt*tt+We*We}s(C,"sqSegSegDist");function T(F,k){return F[0]===k[0]?F[1]-k[1]:F[0]-k[0]}s(T,"compareByX");function D(F){F.sort(T);for(var k=[],B=0;B<F.length;B++){for(;k.length>=2&&y(k[k.length-2],k[k.length-1],F[B])<=0;)k.pop();k.push(F[B])}for(var U=[],z=F.length-1;z>=0;z--){for(;U.length>=2&&y(U[U.length-2],U[U.length-1],F[z])<=0;)U.pop();U.push(F[z])}return U.pop(),k.pop(),k.concat(U)}s(D,"convexHull")}),LHe=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):r.quickselect=i()}(t,function(){function r(o,l,u,c,p){i(o,l,u||0,c||o.length-1,p||a)}s(r,"quickselect");function i(o,l,u,c,p){for(;c>u;){if(c-u>600){var m=c-u+1,y=l-u+1,v=Math.log(m),x=.5*Math.exp(2*v/3),E=.5*Math.sqrt(v*x*(m-x)/m)*(y-m/2<0?-1:1),M=Math.max(u,Math.floor(l-y*x/m+E)),I=Math.min(c,Math.floor(l+(m-y)*x/m+E));i(o,l,M,I,p)}var P=o[l],C=u,T=c;for(n(o,u,l),p(o[c],P)>0&&n(o,u,c);C<T;){for(n(o,C,T),C++,T--;p(o[C],P)<0;)C++;for(;p(o[T],P)>0;)T--}p(o[u],P)===0?n(o,u,T):(T++,n(o,T,c)),T<=l&&(u=T+1),l<=T&&(c=T-1)}}s(i,"quickselectStep");function n(o,l,u){var c=o[l];o[l]=o[u],o[u]=c}s(n,"swap");function a(o,l){return o<l?-1:o>l?1:0}return s(a,"defaultCompare"),r})}),Tge=bt((t,e)=>{N(),e.exports=i,e.exports.default=i;var r=LHe();function i(P,C){if(!(this instanceof i))return new i(P,C);this._maxEntries=Math.max(4,P||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),C&&this._initFormat(C),this.clear()}s(i,"rbush"),i.prototype={all:s(function(){return this._all(this.data,[])},"all"),search:s(function(P){var C=this.data,T=[],D=this.toBBox;if(!E(P,C))return T;for(var F=[],k,B,U,z;C;){for(k=0,B=C.children.length;k<B;k++)U=C.children[k],z=C.leaf?D(U):U,E(P,z)&&(C.leaf?T.push(U):x(P,z)?this._all(U,T):F.push(U));C=F.pop()}return T},"search"),collides:s(function(P){var C=this.data,T=this.toBBox;if(!E(P,C))return!1;for(var D=[],F,k,B,U;C;){for(F=0,k=C.children.length;F<k;F++)if(B=C.children[F],U=C.leaf?T(B):B,E(P,U)){if(C.leaf||x(P,U))return!0;D.push(B)}C=D.pop()}return!1},"collides"),load:s(function(P){if(!(P&&P.length))return this;if(P.length<this._minEntries){for(var C=0,T=P.length;C<T;C++)this.insert(P[C]);return this}var D=this._build(P.slice(),0,P.length-1,0);if(!this.data.children.length)this.data=D;else if(this.data.height===D.height)this._splitRoot(this.data,D);else{if(this.data.height<D.height){var F=this.data;this.data=D,D=F}this._insert(D,this.data.height-D.height-1,!0)}return this},"load"),insert:s(function(P){return P&&this._insert(P,this.data.height-1),this},"insert"),clear:s(function(){return this.data=M([]),this},"clear"),remove:s(function(P,C){if(!P)return this;for(var T=this.data,D=this.toBBox(P),F=[],k=[],B,U,z,q;T||F.length;){if(T||(T=F.pop(),U=F[F.length-1],B=k.pop(),q=!0),T.leaf&&(z=n(P,T.children,C),z!==-1))return T.children.splice(z,1),F.push(T),this._condense(F),this;!q&&!T.leaf&&x(T,D)?(F.push(T),k.push(B),B=0,U=T,T=T.children[0]):U?(B++,T=U.children[B],q=!1):T=null}return this},"remove"),toBBox:s(function(P){return P},"toBBox"),compareMinX:u,compareMinY:c,toJSON:s(function(){return this.data},"toJSON"),fromJSON:s(function(P){return this.data=P,this},"fromJSON"),_all:s(function(P,C){for(var T=[];P;)P.leaf?C.push.apply(C,P.children):T.push.apply(T,P.children),P=T.pop();return C},"_all"),_build:s(function(P,C,T,D){var F=T-C+1,k=this._maxEntries,B;if(F<=k)return B=M(P.slice(C,T+1)),a(B,this.toBBox),B;D||(D=Math.ceil(Math.log(F)/Math.log(k)),k=Math.ceil(F/Math.pow(k,D-1))),B=M([]),B.leaf=!1,B.height=D;var U=Math.ceil(F/k),z=U*Math.ceil(Math.sqrt(k)),q,Z,Q,V;for(I(P,C,T,z,this.compareMinX),q=C;q<=T;q+=z)for(Q=Math.min(q+z-1,T),I(P,q,Q,U,this.compareMinY),Z=q;Z<=Q;Z+=U)V=Math.min(Z+U-1,Q),B.children.push(this._build(P,Z,V,D-1));return a(B,this.toBBox),B},"_build"),_chooseSubtree:s(function(P,C,T,D){for(var F,k,B,U,z,q,Z,Q;D.push(C),!(C.leaf||D.length-1===T);){for(Z=Q=1/0,F=0,k=C.children.length;F<k;F++)B=C.children[F],z=p(B),q=y(P,B)-z,q<Q?(Q=q,Z=z<Z?z:Z,U=B):q===Q&&z<Z&&(Z=z,U=B);C=U||C.children[0]}return C},"_chooseSubtree"),_insert:s(function(P,C,T){var D=this.toBBox,F=T?P:D(P),k=[],B=this._chooseSubtree(F,this.data,C,k);for(B.children.push(P),l(B,F);C>=0&&k[C].children.length>this._maxEntries;)this._split(k,C),C--;this._adjustParentBBoxes(F,k,C)},"_insert"),_split:s(function(P,C){var T=P[C],D=T.children.length,F=this._minEntries;this._chooseSplitAxis(T,F,D);var k=this._chooseSplitIndex(T,F,D),B=M(T.children.splice(k,T.children.length-k));B.height=T.height,B.leaf=T.leaf,a(T,this.toBBox),a(B,this.toBBox),C?P[C-1].children.push(B):this._splitRoot(T,B)},"_split"),_splitRoot:s(function(P,C){this.data=M([P,C]),this.data.height=P.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},"_splitRoot"),_chooseSplitIndex:s(function(P,C,T){var D,F,k,B,U,z,q,Z;for(z=q=1/0,D=C;D<=T-C;D++)F=o(P,0,D,this.toBBox),k=o(P,D,T,this.toBBox),B=v(F,k),U=p(F)+p(k),B<z?(z=B,Z=D,q=U<q?U:q):B===z&&U<q&&(q=U,Z=D);return Z},"_chooseSplitIndex"),_chooseSplitAxis:s(function(P,C,T){var D=P.leaf?this.compareMinX:u,F=P.leaf?this.compareMinY:c,k=this._allDistMargin(P,C,T,D),B=this._allDistMargin(P,C,T,F);k<B&&P.children.sort(D)},"_chooseSplitAxis"),_allDistMargin:s(function(P,C,T,D){P.children.sort(D);var F=this.toBBox,k=o(P,0,C,F),B=o(P,T-C,T,F),U=m(k)+m(B),z,q;for(z=C;z<T-C;z++)q=P.children[z],l(k,P.leaf?F(q):q),U+=m(k);for(z=T-C-1;z>=C;z--)q=P.children[z],l(B,P.leaf?F(q):q),U+=m(B);return U},"_allDistMargin"),_adjustParentBBoxes:s(function(P,C,T){for(var D=T;D>=0;D--)l(C[D],P)},"_adjustParentBBoxes"),_condense:s(function(P){for(var C=P.length-1,T;C>=0;C--)P[C].children.length===0?C>0?(T=P[C-1].children,T.splice(T.indexOf(P[C]),1)):this.clear():a(P[C],this.toBBox)},"_condense"),_initFormat:s(function(P){var C=["return a"," - b",";"];this.compareMinX=new Function("a","b",C.join(P[0])),this.compareMinY=new Function("a","b",C.join(P[1])),this.toBBox=new Function("a","return {minX: a"+P[0]+", minY: a"+P[1]+", maxX: a"+P[2]+", maxY: a"+P[3]+"};")},"_initFormat")};function n(P,C,T){if(!T)return C.indexOf(P);for(var D=0;D<C.length;D++)if(T(P,C[D]))return D;return-1}s(n,"findItem");function a(P,C){o(P,0,P.children.length,C,P)}s(a,"calcBBox");function o(P,C,T,D,F){F||(F=M(null)),F.minX=1/0,F.minY=1/0,F.maxX=-1/0,F.maxY=-1/0;for(var k=C,B;k<T;k++)B=P.children[k],l(F,P.leaf?D(B):B);return F}s(o,"distBBox");function l(P,C){return P.minX=Math.min(P.minX,C.minX),P.minY=Math.min(P.minY,C.minY),P.maxX=Math.max(P.maxX,C.maxX),P.maxY=Math.max(P.maxY,C.maxY),P}s(l,"extend");function u(P,C){return P.minX-C.minX}s(u,"compareNodeMinX");function c(P,C){return P.minY-C.minY}s(c,"compareNodeMinY");function p(P){return(P.maxX-P.minX)*(P.maxY-P.minY)}s(p,"bboxArea");function m(P){return P.maxX-P.minX+(P.maxY-P.minY)}s(m,"bboxMargin");function y(P,C){return(Math.max(C.maxX,P.maxX)-Math.min(C.minX,P.minX))*(Math.max(C.maxY,P.maxY)-Math.min(C.minY,P.minY))}s(y,"enlargedArea");function v(P,C){var T=Math.max(P.minX,C.minX),D=Math.max(P.minY,C.minY),F=Math.min(P.maxX,C.maxX),k=Math.min(P.maxY,C.maxY);return Math.max(0,F-T)*Math.max(0,k-D)}s(v,"intersectionArea");function x(P,C){return P.minX<=C.minX&&P.minY<=C.minY&&C.maxX<=P.maxX&&C.maxY<=P.maxY}s(x,"contains");function E(P,C){return C.minX<=P.maxX&&C.minY<=P.maxY&&C.maxX>=P.minX&&C.maxY>=P.minY}s(E,"intersects");function M(P){return{children:P,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}s(M,"createNode");function I(P,C,T,D,F){for(var k=[C,T],B;k.length;)T=k.pop(),C=k.pop(),!(T-C<=D)&&(B=C+Math.ceil((T-C)/D/2)*D,r(P,B,C,T,F),k.push(C,B,B,T))}s(I,"multiSelect")}),Pge=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=63710088e-1,t.factors={centimeters:t.earthRadius*100,centimetres:t.earthRadius*100,degrees:t.earthRadius/111325,feet:t.earthRadius*3.28084,inches:t.earthRadius*39.37,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:t.earthRadius*1e3,millimetres:t.earthRadius*1e3,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius*1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(q,Z,Q){Q===void 0&&(Q={});var V={type:"Feature"};return(Q.id===0||Q.id)&&(V.id=Q.id),Q.bbox&&(V.bbox=Q.bbox),V.properties=Z||{},V.geometry=q,V}s(e,"feature"),t.feature=e;function r(q,Z,Q){switch(q){case"Point":return i(Z).geometry;case"LineString":return l(Z).geometry;case"Polygon":return a(Z).geometry;case"MultiPoint":return m(Z).geometry;case"MultiLineString":return p(Z).geometry;case"MultiPolygon":return y(Z).geometry;default:throw new Error(q+" is invalid")}}s(r,"geometry"),t.geometry=r;function i(q,Z,Q){if(Q===void 0&&(Q={}),!q)throw new Error("coordinates is required");if(!Array.isArray(q))throw new Error("coordinates must be an Array");if(q.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!k(q[0])||!k(q[1]))throw new Error("coordinates must contain numbers");var V={type:"Point",coordinates:q};return e(V,Z,Q)}s(i,"point"),t.point=i;function n(q,Z,Q){return Q===void 0&&(Q={}),c(q.map(function(V){return i(V,Z)}),Q)}s(n,"points"),t.points=n;function a(q,Z,Q){Q===void 0&&(Q={});for(var V=0,ae=q;V<ae.length;V++){var Y=ae[V];if(Y.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var he=0;he<Y[Y.length-1].length;he++)if(Y[Y.length-1][he]!==Y[0][he])throw new Error("First and last Position are not equivalent.")}var J={type:"Polygon",coordinates:q};return e(J,Z,Q)}s(a,"polygon"),t.polygon=a;function o(q,Z,Q){return Q===void 0&&(Q={}),c(q.map(function(V){return a(V,Z)}),Q)}s(o,"polygons"),t.polygons=o;function l(q,Z,Q){if(Q===void 0&&(Q={}),q.length<2)throw new Error("coordinates must be an array of two or more positions");var V={type:"LineString",coordinates:q};return e(V,Z,Q)}s(l,"lineString"),t.lineString=l;function u(q,Z,Q){return Q===void 0&&(Q={}),c(q.map(function(V){return l(V,Z)}),Q)}s(u,"lineStrings"),t.lineStrings=u;function c(q,Z){Z===void 0&&(Z={});var Q={type:"FeatureCollection"};return Z.id&&(Q.id=Z.id),Z.bbox&&(Q.bbox=Z.bbox),Q.features=q,Q}s(c,"featureCollection"),t.featureCollection=c;function p(q,Z,Q){Q===void 0&&(Q={});var V={type:"MultiLineString",coordinates:q};return e(V,Z,Q)}s(p,"multiLineString"),t.multiLineString=p;function m(q,Z,Q){Q===void 0&&(Q={});var V={type:"MultiPoint",coordinates:q};return e(V,Z,Q)}s(m,"multiPoint"),t.multiPoint=m;function y(q,Z,Q){Q===void 0&&(Q={});var V={type:"MultiPolygon",coordinates:q};return e(V,Z,Q)}s(y,"multiPolygon"),t.multiPolygon=y;function v(q,Z,Q){Q===void 0&&(Q={});var V={type:"GeometryCollection",geometries:q};return e(V,Z,Q)}s(v,"geometryCollection"),t.geometryCollection=v;function x(q,Z){if(Z===void 0&&(Z=0),Z&&!(Z>=0))throw new Error("precision must be a positive number");var Q=Math.pow(10,Z||0);return Math.round(q*Q)/Q}s(x,"round"),t.round=x;function E(q,Z){Z===void 0&&(Z="kilometers");var Q=t.factors[Z];if(!Q)throw new Error(Z+" units is invalid");return q*Q}s(E,"radiansToLength"),t.radiansToLength=E;function M(q,Z){Z===void 0&&(Z="kilometers");var Q=t.factors[Z];if(!Q)throw new Error(Z+" units is invalid");return q/Q}s(M,"lengthToRadians"),t.lengthToRadians=M;function I(q,Z){return C(M(q,Z))}s(I,"lengthToDegrees"),t.lengthToDegrees=I;function P(q){var Z=q%360;return Z<0&&(Z+=360),Z}s(P,"bearingToAzimuth"),t.bearingToAzimuth=P;function C(q){var Z=q%(2*Math.PI);return Z*180/Math.PI}s(C,"radiansToDegrees"),t.radiansToDegrees=C;function T(q){var Z=q%360;return Z*Math.PI/180}s(T,"degreesToRadians"),t.degreesToRadians=T;function D(q,Z,Q){if(Z===void 0&&(Z="kilometers"),Q===void 0&&(Q="kilometers"),!(q>=0))throw new Error("length must be a positive number");return E(M(q,Z),Q)}s(D,"convertLength"),t.convertLength=D;function F(q,Z,Q){if(Z===void 0&&(Z="meters"),Q===void 0&&(Q="kilometers"),!(q>=0))throw new Error("area must be a positive number");var V=t.areaFactors[Z];if(!V)throw new Error("invalid original units");var ae=t.areaFactors[Q];if(!ae)throw new Error("invalid final units");return q/V*ae}s(F,"convertArea"),t.convertArea=F;function k(q){return!isNaN(q)&&q!==null&&!Array.isArray(q)}s(k,"isNumber"),t.isNumber=k;function B(q){return!!q&&q.constructor===Object}s(B,"isObject"),t.isObject=B;function U(q){if(!q)throw new Error("bbox is required");if(!Array.isArray(q))throw new Error("bbox must be an Array");if(q.length!==4&&q.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");q.forEach(function(Z){if(!k(Z))throw new Error("bbox must only contain numbers")})}s(U,"validateBBox"),t.validateBBox=U;function z(q){if(!q)throw new Error("id is required");if(["string","number"].indexOf(typeof q)===-1)throw new Error("id must be a number or a string")}s(z,"validateId"),t.validateId=z}),Lge=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Pge();function r(C,T,D){if(C!==null)for(var F,k,B,U,z,q,Z,Q=0,V=0,ae,Y=C.type,he=Y==="FeatureCollection",J=Y==="Feature",ne=he?C.features.length:1,ee=0;ee<ne;ee++){Z=he?C.features[ee].geometry:J?C.geometry:C,ae=Z?Z.type==="GeometryCollection":!1,z=ae?Z.geometries.length:1;for(var ue=0;ue<z;ue++){var K=0,ce=0;if(U=ae?Z.geometries[ue]:Z,U!==null){q=U.coordinates;var re=U.type;switch(Q=D&&(re==="Polygon"||re==="MultiPolygon")?1:0,re){case null:break;case"Point":if(T(q,V,ee,K,ce)===!1)return!1;V++,K++;break;case"LineString":case"MultiPoint":for(F=0;F<q.length;F++){if(T(q[F],V,ee,K,ce)===!1)return!1;V++,re==="MultiPoint"&&K++}re==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(F=0;F<q.length;F++){for(k=0;k<q[F].length-Q;k++){if(T(q[F][k],V,ee,K,ce)===!1)return!1;V++}re==="MultiLineString"&&K++,re==="Polygon"&&ce++}re==="Polygon"&&K++;break;case"MultiPolygon":for(F=0;F<q.length;F++){for(ce=0,k=0;k<q[F].length;k++){for(B=0;B<q[F][k].length-Q;B++){if(T(q[F][k][B],V,ee,K,ce)===!1)return!1;V++}ce++}K++}break;case"GeometryCollection":for(F=0;F<U.geometries.length;F++)if(r(U.geometries[F],T,D)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}s(r,"coordEach");function i(C,T,D,F){var k=D;return r(C,function(B,U,z,q,Z){U===0&&D===void 0?k=B:k=T(k,B,U,z,q,Z)},F),k}s(i,"coordReduce");function n(C,T){var D;switch(C.type){case"FeatureCollection":for(D=0;D<C.features.length&&T(C.features[D].properties,D)!==!1;D++);break;case"Feature":T(C.properties,0);break}}s(n,"propEach");function a(C,T,D){var F=D;return n(C,function(k,B){B===0&&D===void 0?F=k:F=T(F,k,B)}),F}s(a,"propReduce");function o(C,T){if(C.type==="Feature")T(C,0);else if(C.type==="FeatureCollection")for(var D=0;D<C.features.length&&T(C.features[D],D)!==!1;D++);}s(o,"featureEach");function l(C,T,D){var F=D;return o(C,function(k,B){B===0&&D===void 0?F=k:F=T(F,k,B)}),F}s(l,"featureReduce");function u(C){var T=[];return r(C,function(D){T.push(D)}),T}s(u,"coordAll");function c(C,T){var D,F,k,B,U,z,q,Z,Q,V,ae=0,Y=C.type==="FeatureCollection",he=C.type==="Feature",J=Y?C.features.length:1;for(D=0;D<J;D++){for(z=Y?C.features[D].geometry:he?C.geometry:C,Z=Y?C.features[D].properties:he?C.properties:{},Q=Y?C.features[D].bbox:he?C.bbox:void 0,V=Y?C.features[D].id:he?C.id:void 0,q=z?z.type==="GeometryCollection":!1,U=q?z.geometries.length:1,k=0;k<U;k++){if(B=q?z.geometries[k]:z,B===null){if(T(null,ae,Z,Q,V)===!1)return!1;continue}switch(B.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(T(B,ae,Z,Q,V)===!1)return!1;break}case"GeometryCollection":{for(F=0;F<B.geometries.length;F++)if(T(B.geometries[F],ae,Z,Q,V)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ae++}}s(c,"geomEach");function p(C,T,D){var F=D;return c(C,function(k,B,U,z,q){B===0&&D===void 0?F=k:F=T(F,k,B,U,z,q)}),F}s(p,"geomReduce");function m(C,T){c(C,function(D,F,k,B,U){var z=D===null?null:D.type;switch(z){case null:case"Point":case"LineString":case"Polygon":return T(e.feature(D,k,{bbox:B,id:U}),F,0)===!1?!1:void 0}var q;switch(z){case"MultiPoint":q="Point";break;case"MultiLineString":q="LineString";break;case"MultiPolygon":q="Polygon";break}for(var Z=0;Z<D.coordinates.length;Z++){var Q=D.coordinates[Z],V={type:q,coordinates:Q};if(T(e.feature(V,k),F,Z)===!1)return!1}})}s(m,"flattenEach");function y(C,T,D){var F=D;return m(C,function(k,B,U){B===0&&U===0&&D===void 0?F=k:F=T(F,k,B,U)}),F}s(y,"flattenReduce");function v(C,T){m(C,function(D,F,k){var B=0;if(D.geometry){var U=D.geometry.type;if(!(U==="Point"||U==="MultiPoint")){var z,q=0,Z=0,Q=0;if(r(D,function(V,ae,Y,he,J){if(z===void 0||F>q||he>Z||J>Q){z=V,q=F,Z=he,Q=J,B=0;return}var ne=e.lineString([z,V],D.properties);if(T(ne,F,k,J,B)===!1)return!1;B++,z=V})===!1)return!1}}})}s(v,"segmentEach");function x(C,T,D){var F=D,k=!1;return v(C,function(B,U,z,q,Z){k===!1&&D===void 0?F=B:F=T(F,B,U,z,q,Z),k=!0}),F}s(x,"segmentReduce");function E(C,T){if(!C)throw new Error("geojson is required");m(C,function(D,F,k){if(D.geometry!==null){var B=D.geometry.type,U=D.geometry.coordinates;switch(B){case"LineString":if(T(D,F,k,0,0)===!1)return!1;break;case"Polygon":for(var z=0;z<U.length;z++)if(T(e.lineString(U[z],D.properties),F,k,z)===!1)return!1;break}}})}s(E,"lineEach");function M(C,T,D){var F=D;return E(C,function(k,B,U,z){B===0&&D===void 0?F=k:F=T(F,k,B,U,z)}),F}s(M,"lineReduce");function I(C,T){if(T=T||{},!e.isObject(T))throw new Error("options is invalid");var D=T.featureIndex||0,F=T.multiFeatureIndex||0,k=T.geometryIndex||0,B=T.segmentIndex||0,U=T.properties,z;switch(C.type){case"FeatureCollection":D<0&&(D=C.features.length+D),U=U||C.features[D].properties,z=C.features[D].geometry;break;case"Feature":U=U||C.properties,z=C.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":z=C;break;default:throw new Error("geojson is invalid")}if(z===null)return null;var q=z.coordinates;switch(z.type){case"Point":case"MultiPoint":return null;case"LineString":return B<0&&(B=q.length+B-1),e.lineString([q[B],q[B+1]],U,T);case"Polygon":return k<0&&(k=q.length+k),B<0&&(B=q[k].length+B-1),e.lineString([q[k][B],q[k][B+1]],U,T);case"MultiLineString":return F<0&&(F=q.length+F),B<0&&(B=q[F].length+B-1),e.lineString([q[F][B],q[F][B+1]],U,T);case"MultiPolygon":return F<0&&(F=q.length+F),k<0&&(k=q[F].length+k),B<0&&(B=q[F][k].length-B-1),e.lineString([q[F][k][B],q[F][k][B+1]],U,T)}throw new Error("geojson is invalid")}s(I,"findSegment");function P(C,T){if(T=T||{},!e.isObject(T))throw new Error("options is invalid");var D=T.featureIndex||0,F=T.multiFeatureIndex||0,k=T.geometryIndex||0,B=T.coordIndex||0,U=T.properties,z;switch(C.type){case"FeatureCollection":D<0&&(D=C.features.length+D),U=U||C.features[D].properties,z=C.features[D].geometry;break;case"Feature":U=U||C.properties,z=C.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":z=C;break;default:throw new Error("geojson is invalid")}if(z===null)return null;var q=z.coordinates;switch(z.type){case"Point":return e.point(q,U,T);case"MultiPoint":return F<0&&(F=q.length+F),e.point(q[F],U,T);case"LineString":return B<0&&(B=q.length+B),e.point(q[B],U,T);case"Polygon":return k<0&&(k=q.length+k),B<0&&(B=q[k].length+B),e.point(q[k][B],U,T);case"MultiLineString":return F<0&&(F=q.length+F),B<0&&(B=q[F].length+B),e.point(q[F][B],U,T);case"MultiPolygon":return F<0&&(F=q.length+F),k<0&&(k=q[F].length+k),B<0&&(B=q[F][k].length-B),e.point(q[F][k][B],U,T)}throw new Error("geojson is invalid")}s(P,"findPoint"),t.coordAll=u,t.coordEach=r,t.coordReduce=i,t.featureEach=o,t.featureReduce=l,t.findPoint=P,t.findSegment=I,t.flattenEach=m,t.flattenReduce=y,t.geomEach=c,t.geomReduce=p,t.lineEach=E,t.lineReduce=M,t.propEach=n,t.propReduce=a,t.segmentEach=v,t.segmentReduce=x}),DHe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Lge();function r(i){var n=[1/0,1/0,-1/0,-1/0];return e.coordEach(i,function(a){n[0]>a[0]&&(n[0]=a[0]),n[1]>a[1]&&(n[1]=a[1]),n[2]<a[0]&&(n[2]=a[0]),n[3]<a[1]&&(n[3]=a[1])}),n}s(r,"bbox"),r.default=r,t.default=r}),HB=bt((t,e)=>{N();var r=Ige(),i=Pge(),n=Lge(),a=DHe().default,o=n.featureEach;n.coordEach,i.polygon;var l=i.featureCollection;function u(c){var p=new r(c);return p.insert=function(m){if(m.type!=="Feature")throw new Error("invalid feature");return m.bbox=m.bbox?m.bbox:a(m),r.prototype.insert.call(this,m)},p.load=function(m){var y=[];return Array.isArray(m)?m.forEach(function(v){if(v.type!=="Feature")throw new Error("invalid features");v.bbox=v.bbox?v.bbox:a(v),y.push(v)}):o(m,function(v){if(v.type!=="Feature")throw new Error("invalid features");v.bbox=v.bbox?v.bbox:a(v),y.push(v)}),r.prototype.load.call(this,y)},p.remove=function(m,y){if(m.type!=="Feature")throw new Error("invalid feature");return m.bbox=m.bbox?m.bbox:a(m),r.prototype.remove.call(this,m,y)},p.clear=function(){return r.prototype.clear.call(this)},p.search=function(m){var y=r.prototype.search.call(this,this.toBBox(m));return l(y)},p.collides=function(m){return r.prototype.collides.call(this,this.toBBox(m))},p.all=function(){var m=r.prototype.all.call(this);return l(m)},p.toJSON=function(){return r.prototype.toJSON.call(this)},p.fromJSON=function(m){return r.prototype.fromJSON.call(this,m)},p.toBBox=function(m){var y;if(m.bbox)y=m.bbox;else if(Array.isArray(m)&&m.length===4)y=m;else if(Array.isArray(m)&&m.length===6)y=[m[0],m[1],m[3],m[4]];else if(m.type==="Feature")y=a(m);else if(m.type==="FeatureCollection")y=a(m);else throw new Error("invalid geojson");return{minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]}},p}s(u,"geojsonRbush"),e.exports=u,e.exports.default=u}),Dge=bt((t,e)=>{N();var r=Object.prototype.toString;e.exports=s(function(i){var n=r.call(i),a=n==="[object Arguments]";return a||(a=n!=="[object Array]"&&i!==null&&typeof i=="object"&&typeof i.length=="number"&&i.length>=0&&r.call(i.callee)==="[object Function]"),a},"isArguments")}),RHe=bt((t,e)=>{N();var r;Object.keys||(i=Object.prototype.hasOwnProperty,n=Object.prototype.toString,a=Dge(),o=Object.prototype.propertyIsEnumerable,l=!o.call({toString:null},"toString"),u=o.call(function(){},"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=s(function(x){var E=x.constructor;return E&&E.prototype===x},"equalsConstructorPrototype"),m={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},y=function(){if(typeof window>"u")return!1;for(var x in window)try{if(!m["$"+x]&&i.call(window,x)&&window[x]!==null&&typeof window[x]=="object")try{p(window[x])}catch{return!0}}catch{return!0}return!1}(),v=s(function(x){if(typeof window>"u"||!y)return p(x);try{return p(x)}catch{return!1}},"equalsConstructorPrototypeIfNotBuggy"),r=s(function(x){var E=x!==null&&typeof x=="object",M=n.call(x)==="[object Function]",I=a(x),P=E&&n.call(x)==="[object String]",C=[];if(!E&&!M&&!I)throw new TypeError("Object.keys called on a non-object");var T=u&&M;if(P&&x.length>0&&!i.call(x,0))for(var D=0;D<x.length;++D)C.push(String(D));if(I&&x.length>0)for(var F=0;F<x.length;++F)C.push(String(F));else for(var k in x)!(T&&k==="prototype")&&i.call(x,k)&&C.push(String(k));if(l)for(var B=v(x),U=0;U<c.length;++U)!(B&&c[U]==="constructor")&&i.call(x,c[U])&&C.push(c[U]);return C},"keys"));var i,n,a,o,l,u,c,p,m,y,v;e.exports=r}),Rge=bt((t,e)=>{N();var r=Array.prototype.slice,i=Dge(),n=Object.keys,a=n?s(function(l){return n(l)},"keys"):RHe(),o=Object.keys;a.shim=s(function(){if(Object.keys){var l=function(){var u=Object.keys(arguments);return u&&u.length===arguments.length}(1,2);l||(Object.keys=s(function(u){return i(u)?o(r.call(u)):o(u)},"keys"))}else Object.keys=a;return Object.keys||a},"shimObjectKeys"),e.exports=a}),Oge=bt((t,e)=>{N(),e.exports=s(function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var r={},i=Symbol("test"),n=Object(i);if(typeof i=="string"||Object.prototype.toString.call(i)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;r[i]=a;for(var o in r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var l=Object.getOwnPropertySymbols(r);if(l.length!==1||l[0]!==i||!Object.prototype.propertyIsEnumerable.call(r,i))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(r,i);if(u.value!==a||u.enumerable!==!0)return!1}return!0},"hasSymbols")}),qB=bt((t,e)=>{N();var r=Oge();e.exports=s(function(){return r()&&!!Symbol.toStringTag},"hasToStringTagShams")}),kge=bt((t,e)=>{N(),e.exports=Object}),Nge=bt((t,e)=>{N(),e.exports=Error}),OHe=bt((t,e)=>{N(),e.exports=EvalError}),kHe=bt((t,e)=>{N(),e.exports=RangeError}),NHe=bt((t,e)=>{N(),e.exports=ReferenceError}),Fge=bt((t,e)=>{N(),e.exports=SyntaxError}),hx=bt((t,e)=>{N(),e.exports=TypeError}),FHe=bt((t,e)=>{N(),e.exports=URIError}),BHe=bt((t,e)=>{N(),e.exports=Math.abs}),zHe=bt((t,e)=>{N(),e.exports=Math.floor}),UHe=bt((t,e)=>{N(),e.exports=Math.max}),VHe=bt((t,e)=>{N(),e.exports=Math.min}),jHe=bt((t,e)=>{N(),e.exports=Math.pow}),$He=bt((t,e)=>{N(),e.exports=Math.round}),GHe=bt((t,e)=>{N(),e.exports=Number.isNaN||s(function(r){return r!==r},"isNaN")}),HHe=bt((t,e)=>{N();var r=GHe();e.exports=s(function(i){return r(i)||i===0?i:i<0?-1:1},"sign")}),qHe=bt((t,e)=>{N(),e.exports=Object.getOwnPropertyDescriptor}),px=bt((t,e)=>{N();var r=qHe();if(r)try{r([],"length")}catch{r=null}e.exports=r}),VP=bt((t,e)=>{N();var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}e.exports=r}),WHe=bt((t,e)=>{N();var r=typeof Symbol<"u"&&Symbol,i=Oge();e.exports=s(function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:i()},"hasNativeSymbols")}),Bge=bt((t,e)=>{N(),e.exports=typeof Reflect<"u"&&Reflect.getPrototypeOf||null}),zge=bt((t,e)=>{N();var r=kge();e.exports=r.getPrototypeOf||null}),XHe=bt((t,e)=>{N();var r="Function.prototype.bind called on incompatible ",i=Object.prototype.toString,n=Math.max,a="[object Function]",o=s(function(c,p){for(var m=[],y=0;y<c.length;y+=1)m[y]=c[y];for(var v=0;v<p.length;v+=1)m[v+c.length]=p[v];return m},"concatty"),l=s(function(c,p){for(var m=[],y=p||0,v=0;y<c.length;y+=1,v+=1)m[v]=c[y];return m},"slicy"),u=s(function(c,p){for(var m="",y=0;y<c.length;y+=1)m+=c[y],y+1<c.length&&(m+=p);return m},"joiny");e.exports=s(function(c){var p=this;if(typeof p!="function"||i.apply(p)!==a)throw new TypeError(r+p);for(var m=l(arguments,1),y,v=s(function(){if(this instanceof y){var P=p.apply(this,o(m,arguments));return Object(P)===P?P:this}return p.apply(c,o(m,arguments))},"binder"),x=n(0,p.length-m.length),E=[],M=0;M<x;M++)E[M]="$"+M;if(y=Function("binder","return function ("+u(E,",")+"){ return binder.apply(this,arguments); }")(v),p.prototype){var I=s(function(){},"Empty");I.prototype=p.prototype,y.prototype=new I,I.prototype=null}return y},"bind")}),VA=bt((t,e)=>{N();var r=XHe();e.exports=Function.prototype.bind||r}),WB=bt((t,e)=>{N(),e.exports=Function.prototype.call}),XB=bt((t,e)=>{N(),e.exports=Function.prototype.apply}),ZHe=bt((t,e)=>{N(),e.exports=typeof Reflect<"u"&&Reflect&&Reflect.apply}),Uge=bt((t,e)=>{N();var r=VA(),i=XB(),n=WB(),a=ZHe();e.exports=a||r.call(n,i)}),ZB=bt((t,e)=>{N();var r=VA(),i=hx(),n=WB(),a=Uge();e.exports=s(function(o){if(o.length<1||typeof o[0]!="function")throw new i("a function is required");return a(r,n,o)},"callBindBasic")}),YHe=bt((t,e)=>{N();var r=ZB(),i=px(),n;try{n=[].__proto__===Array.prototype}catch(u){if(!u||typeof u!="object"||!("code"in u)||u.code!=="ERR_PROTO_ACCESS")throw u}var a=!!n&&i&&i(Object.prototype,"__proto__"),o=Object,l=o.getPrototypeOf;e.exports=a&&typeof a.get=="function"?r([a.get]):typeof l=="function"?s(function(u){return l(u==null?u:o(u))},"getDunder"):!1}),Vge=bt((t,e)=>{N();var r=Bge(),i=zge(),n=YHe();e.exports=r?s(function(a){return r(a)},"getProto"):i?s(function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return i(a)},"getProto"):n?s(function(a){return n(a)},"getProto"):null}),jge=bt((t,e)=>{N();var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,n=VA();e.exports=n.call(r,i)}),$ge=bt((t,e)=>{N();var r,i=kge(),n=Nge(),a=OHe(),o=kHe(),l=NHe(),u=Fge(),c=hx(),p=FHe(),m=BHe(),y=zHe(),v=UHe(),x=VHe(),E=jHe(),M=$He(),I=HHe(),P=Function,C=s(function(me){try{return P('"use strict"; return ('+me+").constructor;")()}catch{}},"getEvalledConstructor"),T=px(),D=VP(),F=s(function(){throw new c},"throwTypeError"),k=T?function(){try{return arguments.callee,F}catch{try{return T(arguments,"callee").get}catch{return F}}}():F,B=WHe()(),U=Vge(),z=zge(),q=Bge(),Z=XB(),Q=WB(),V={},ae=typeof Uint8Array>"u"||!U?r:U(Uint8Array),Y={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":B&&U?U([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":V,"%AsyncGenerator%":V,"%AsyncGeneratorFunction%":V,"%AsyncIteratorPrototype%":V,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":a,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":P,"%GeneratorFunction%":V,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":B&&U?U(U([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!B||!U?r:U(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":T,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":o,"%ReferenceError%":l,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!B||!U?r:U(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":B&&U?U(""[Symbol.iterator]()):r,"%Symbol%":B?Symbol:r,"%SyntaxError%":u,"%ThrowTypeError%":k,"%TypedArray%":ae,"%TypeError%":c,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":p,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":Q,"%Function.prototype.apply%":Z,"%Object.defineProperty%":D,"%Object.getPrototypeOf%":z,"%Math.abs%":m,"%Math.floor%":y,"%Math.max%":v,"%Math.min%":x,"%Math.pow%":E,"%Math.round%":M,"%Math.sign%":I,"%Reflect.getPrototypeOf%":q};if(U)try{null.error}catch(me){he=U(U(me)),Y["%Error.prototype%"]=he}var he,J=s(function me(Ae){var Ue;if(Ae==="%AsyncFunction%")Ue=C("async function () {}");else if(Ae==="%GeneratorFunction%")Ue=C("function* () {}");else if(Ae==="%AsyncGeneratorFunction%")Ue=C("async function* () {}");else if(Ae==="%AsyncGenerator%"){var _e=me("%AsyncGeneratorFunction%");_e&&(Ue=_e.prototype)}else if(Ae==="%AsyncIteratorPrototype%"){var lt=me("%AsyncGenerator%");lt&&U&&(Ue=U(lt.prototype))}return Y[Ae]=Ue,Ue},"doEval"),ne={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ee=VA(),ue=jge(),K=ee.call(Q,Array.prototype.concat),ce=ee.call(Z,Array.prototype.splice),re=ee.call(Q,String.prototype.replace),se=ee.call(Q,String.prototype.slice),de=ee.call(Q,RegExp.prototype.exec),we=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Le=/\\(\\)?/g,fe=s(function(me){var Ae=se(me,0,1),Ue=se(me,-1);if(Ae==="%"&&Ue!=="%")throw new u("invalid intrinsic syntax, expected closing `%`");if(Ue==="%"&&Ae!=="%")throw new u("invalid intrinsic syntax, expected opening `%`");var _e=[];return re(me,we,function(lt,tt,We,at){_e[_e.length]=We?re(at,Le,"$1"):tt||lt}),_e},"stringToPath"),Re=s(function(me,Ae){var Ue=me,_e;if(ue(ne,Ue)&&(_e=ne[Ue],Ue="%"+_e[0]+"%"),ue(Y,Ue)){var lt=Y[Ue];if(lt===V&&(lt=J(Ue)),typeof lt>"u"&&!Ae)throw new c("intrinsic "+me+" exists, but is not available. Please file an issue!");return{alias:_e,name:Ue,value:lt}}throw new u("intrinsic "+me+" does not exist!")},"getBaseIntrinsic");e.exports=s(function(me,Ae){if(typeof me!="string"||me.length===0)throw new c("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Ae!="boolean")throw new c('"allowMissing" argument must be a boolean');if(de(/^%?[^%]*%?$/,me)===null)throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ue=fe(me),_e=Ue.length>0?Ue[0]:"",lt=Re("%"+_e+"%",Ae),tt=lt.name,We=lt.value,at=!1,Lt=lt.alias;Lt&&(_e=Lt[0],ce(Ue,K([0,1],Lt)));for(var dt=1,Me=!0;dt<Ue.length;dt+=1){var ve=Ue[dt],Ze=se(ve,0,1),It=se(ve,-1);if((Ze==='"'||Ze==="'"||Ze==="`"||It==='"'||It==="'"||It==="`")&&Ze!==It)throw new u("property names with quotes must have matching quotes");if((ve==="constructor"||!Me)&&(at=!0),_e+="."+ve,tt="%"+_e+"%",ue(Y,tt))We=Y[tt];else if(We!=null){if(!(ve in We)){if(!Ae)throw new c("base intrinsic for "+me+" exists, but the property is not available.");return}if(T&&dt+1>=Ue.length){var Rt=T(We,ve);Me=!!Rt,Me&&"get"in Rt&&!("originalValue"in Rt.get)?We=Rt.get:We=We[ve]}else Me=ue(We,ve),We=We[ve];Me&&!at&&(Y[tt]=We)}}return We},"GetIntrinsic")}),YB=bt((t,e)=>{N();var r=$ge(),i=ZB(),n=i([r("%String.prototype.indexOf%")]);e.exports=s(function(a,o){var l=r(a,!!o);return typeof l=="function"&&n(a,".prototype.")>-1?i([l]):l},"callBoundIntrinsic")}),KHe=bt((t,e)=>{N();var r=qB()(),i=YB(),n=i("Object.prototype.toString"),a=s(function(u){return r&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:n(u)==="[object Arguments]"},"isArguments"),o=s(function(u){return a(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&n(u)!=="[object Array]"&&"callee"in u&&n(u.callee)==="[object Function]"},"isArguments"),l=function(){return a(arguments)}();a.isLegacyArguments=o,e.exports=l?a:o}),KB=bt((t,e)=>{N();var r=VP(),i=Fge(),n=hx(),a=px();e.exports=s(function(o,l,u){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,p=arguments.length>4?arguments[4]:null,m=arguments.length>5?arguments[5]:null,y=arguments.length>6?arguments[6]:!1,v=!!a&&a(o,l);if(r)r(o,l,{configurable:m===null&&v?v.configurable:!m,enumerable:c===null&&v?v.enumerable:!c,value:u,writable:p===null&&v?v.writable:!p});else if(y||!c&&!p&&!m)o[l]=u;else throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},"defineDataProperty")}),JB=bt((t,e)=>{N();var r=VP(),i=s(function(){return!!r},"hasPropertyDescriptors");i.hasArrayLengthDefineBug=s(function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},"hasArrayLengthDefineBug"),e.exports=i}),jA=bt((t,e)=>{N();var r=Rge(),i=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,a=Array.prototype.concat,o=KB(),l=s(function(m){return typeof m=="function"&&n.call(m)==="[object Function]"},"isFunction"),u=JB()(),c=s(function(m,y,v,x){if(y in m){if(x===!0){if(m[y]===v)return}else if(!l(x)||!x())return}u?o(m,y,v,!0):o(m,y,v)},"defineProperty"),p=s(function(m,y){var v=arguments.length>2?arguments[2]:{},x=r(y);i&&(x=a.call(x,Object.getOwnPropertySymbols(y)));for(var E=0;E<x.length;E+=1)c(m,x[E],y[x[E]],v[x[E]])},"defineProperties");p.supportsDescriptors=!!u,e.exports=p}),JHe=bt((t,e)=>{N();var r=$ge(),i=KB(),n=JB()(),a=px(),o=hx(),l=r("%Math.floor%");e.exports=s(function(u,c){if(typeof u!="function")throw new o("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||l(c)!==c)throw new o("`length` must be a positive 32-bit integer");var p=arguments.length>2&&!!arguments[2],m=!0,y=!0;if("length"in u&&a){var v=a(u,"length");v&&!v.configurable&&(m=!1),v&&!v.writable&&(y=!1)}return(m||y||!p)&&(n?i(u,"length",c,!0,!0):i(u,"length",c)),u},"setFunctionLength")}),QHe=bt((t,e)=>{N();var r=VA(),i=XB(),n=Uge();e.exports=s(function(){return n(r,i,arguments)},"applyBind")}),Gge=bt((t,e)=>{N();var r=JHe(),i=VP(),n=ZB(),a=QHe();e.exports=s(function(o){var l=n(arguments),u=o.length-(arguments.length-1);return r(l,1+(u>0?u:0),!0)},"callBind"),i?i(e.exports,"apply",{value:a}):e.exports.apply=a}),Hge=bt((t,e)=>{N();var r=s(function(i){return i!==i},"numberIsNaN");e.exports=s(function(i,n){return i===0&&n===0?1/i===1/n:!!(i===n||r(i)&&r(n))},"is")}),qge=bt((t,e)=>{N();var r=Hge();e.exports=s(function(){return typeof Object.is=="function"?Object.is:r},"getPolyfill")}),eqe=bt((t,e)=>{N();var r=qge(),i=jA();e.exports=s(function(){var n=r();return i(Object,{is:n},{is:s(function(){return Object.is!==n},"testObjectIs")}),n},"shimObjectIs")}),tqe=bt((t,e)=>{N();var r=jA(),i=Gge(),n=Hge(),a=qge(),o=eqe(),l=i(a(),Object);r(l,{getPolyfill:a,implementation:n,shim:o}),e.exports=l}),rqe=bt((t,e)=>{N();var r=YB(),i=qB()(),n=jge(),a=px(),o;i?(l=r("RegExp.prototype.exec"),u={},c=s(function(){throw u},"throwRegexMarker"),p={toString:c,valueOf:c},typeof Symbol.toPrimitive=="symbol"&&(p[Symbol.toPrimitive]=c),o=s(function(v){if(!v||typeof v!="object")return!1;var x=a(v,"lastIndex"),E=x&&n(x,"value");if(!E)return!1;try{l(v,p)}catch(M){return M===u}},"isRegex")):(m=r("Object.prototype.toString"),y="[object RegExp]",o=s(function(v){return!v||typeof v!="object"&&typeof v!="function"?!1:m(v)===y},"isRegex"));var l,u,c,p,m,y;e.exports=o}),iqe=bt((t,e)=>{N();var r=s(function(){return typeof s(function(){},"f").name=="string"},"functionsHaveNames"),i=Object.getOwnPropertyDescriptor;if(i)try{i([],"length")}catch{i=null}r.functionsHaveConfigurableNames=s(function(){if(!r()||!i)return!1;var a=i(function(){},"name");return!!a&&!!a.configurable},"functionsHaveConfigurableNames");var n=Function.prototype.bind;r.boundFunctionsHaveNames=s(function(){return r()&&typeof n=="function"&&s(function(){},"f").bind().name!==""},"boundFunctionsHaveNames"),e.exports=r}),nqe=bt((t,e)=>{N();var r=KB(),i=JB()(),n=iqe().functionsHaveConfigurableNames(),a=hx();e.exports=s(function(o,l){if(typeof o!="function")throw new a("`fn` is not a function");var u=arguments.length>2&&!!arguments[2];return(!u||n)&&(i?r(o,"name",l,!0,!0):r(o,"name",l)),o},"setFunctionName")}),Wge=bt((t,e)=>{N();var r=nqe(),i=hx(),n=Object;e.exports=r(s(function(){if(this==null||this!==n(this))throw new i("RegExp.prototype.flags getter called on non-object");var a="";return this.hasIndices&&(a+="d"),this.global&&(a+="g"),this.ignoreCase&&(a+="i"),this.multiline&&(a+="m"),this.dotAll&&(a+="s"),this.unicode&&(a+="u"),this.unicodeSets&&(a+="v"),this.sticky&&(a+="y"),a},"flags"),"get flags",!0)}),Xge=bt((t,e)=>{N();var r=Wge(),i=jA().supportsDescriptors,n=Object.getOwnPropertyDescriptor;e.exports=s(function(){if(i&&/a/mig.flags==="gim"){var a=n(RegExp.prototype,"flags");if(a&&typeof a.get=="function"&&"dotAll"in RegExp.prototype&&"hasIndices"in RegExp.prototype){var o="",l={};if(Object.defineProperty(l,"hasIndices",{get:s(function(){o+="d"},"get")}),Object.defineProperty(l,"sticky",{get:s(function(){o+="y"},"get")}),a.get.call(l),o==="dy")return a.get}}return r},"getPolyfill")}),aqe=bt((t,e)=>{N();var r=jA().supportsDescriptors,i=Xge(),n=px(),a=Object.defineProperty,o=Nge(),l=Vge(),u=/a/;e.exports=s(function(){if(!r||!l)throw new o("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var c=i(),p=l(u),m=n(p,"flags");return(!m||m.get!==c)&&a(p,"flags",{configurable:!0,enumerable:!1,get:c}),c},"shimFlags")}),oqe=bt((t,e)=>{N();var r=jA(),i=Gge(),n=Wge(),a=Xge(),o=aqe(),l=i(a());r(l,{getPolyfill:a,implementation:n,shim:o}),e.exports=l}),sqe=bt((t,e)=>{N();var r=YB(),i=r("Date.prototype.getDay"),n=s(function(u){try{return i(u),!0}catch{return!1}},"tryDateGetDayCall"),a=r("Object.prototype.toString"),o="[object Date]",l=qB()();e.exports=s(function(u){return typeof u!="object"||u===null?!1:l?n(u):a(u)===o},"isDateObject")}),Zge=bt((t,e)=>{N();var r=Rge(),i=KHe(),n=tqe(),a=rqe(),o=oqe(),l=sqe(),u=Date.prototype.getTime;function c(v,x,E){var M=E||{};return(M.strict?n(v,x):v===x)?!0:!v||!x||typeof v!="object"&&typeof x!="object"?M.strict?n(v,x):v==x:y(v,x,M)}s(c,"deepEqual");function p(v){return v==null}s(p,"isUndefinedOrNull");function m(v){return!(!v||typeof v!="object"||typeof v.length!="number"||typeof v.copy!="function"||typeof v.slice!="function"||v.length>0&&typeof v[0]!="number")}s(m,"isBuffer");function y(v,x,E){var M,I;if(typeof v!=typeof x||p(v)||p(x)||v.prototype!==x.prototype||i(v)!==i(x))return!1;var P=a(v),C=a(x);if(P!==C)return!1;if(P||C)return v.source===x.source&&o(v)===o(x);if(l(v)&&l(x))return u.call(v)===u.call(x);var T=m(v),D=m(x);if(T!==D)return!1;if(T||D){if(v.length!==x.length)return!1;for(M=0;M<v.length;M++)if(v[M]!==x[M])return!1;return!0}if(typeof v!=typeof x)return!1;try{var F=r(v),k=r(x)}catch{return!1}if(F.length!==k.length)return!1;for(F.sort(),k.sort(),M=F.length-1;M>=0;M--)if(F[M]!=k[M])return!1;for(M=F.length-1;M>=0;M--)if(I=F[M],!c(v[I],x[I],E))return!1;return!0}s(y,"objEquiv"),e.exports=c}),Yge=bt((t,e)=>{N();var r=Zge(),i=s(function(l){this.precision=l&&l.precision?l.precision:17,this.direction=l&&l.direction?l.direction:!1,this.pseudoNode=l&&l.pseudoNode?l.pseudoNode:!1,this.objectComparator=l&&l.objectComparator?l.objectComparator:o},"Equality");i.prototype.compare=function(l,u){if(l.type!==u.type||!a(l,u))return!1;switch(l.type){case"Point":return this.compareCoord(l.coordinates,u.coordinates);case"LineString":return this.compareLine(l.coordinates,u.coordinates,0,!1);case"Polygon":return this.comparePolygon(l,u);case"Feature":return this.compareFeature(l,u);default:if(l.type.indexOf("Multi")===0){var c=this,p=n(l),m=n(u);return p.every(function(y){return this.some(function(v){return c.compare(y,v)})},m)}}return!1};function n(l){return l.coordinates.map(function(u){return{type:l.type.replace("Multi",""),coordinates:u}})}s(n,"explode");function a(l,u){return l.hasOwnProperty("coordinates")?l.coordinates.length===u.coordinates.length:l.length===u.length}s(a,"sameLength"),i.prototype.compareCoord=function(l,u){if(l.length!==u.length)return!1;for(var c=0;c<l.length;c++)if(l[c].toFixed(this.precision)!==u[c].toFixed(this.precision))return!1;return!0},i.prototype.compareLine=function(l,u,c,p){if(!a(l,u))return!1;var m=this.pseudoNode?l:this.removePseudo(l),y=this.pseudoNode?u:this.removePseudo(u);if(!(p&&!this.compareCoord(m[0],y[0])&&(y=this.fixStartIndex(y,m),!y))){var v=this.compareCoord(m[c],y[c]);return this.direction||v?this.comparePath(m,y):this.compareCoord(m[c],y[y.length-(1+c)])?this.comparePath(m.slice().reverse(),y):!1}},i.prototype.fixStartIndex=function(l,u){for(var c,p=-1,m=0;m<l.length;m++)if(this.compareCoord(l[m],u[0])){p=m;break}return p>=0&&(c=[].concat(l.slice(p,l.length),l.slice(1,p+1))),c},i.prototype.comparePath=function(l,u){var c=this;return l.every(function(p,m){return c.compareCoord(p,this[m])},u)},i.prototype.comparePolygon=function(l,u){if(this.compareLine(l.coordinates[0],u.coordinates[0],1,!0)){var c=l.coordinates.slice(1,l.coordinates.length),p=u.coordinates.slice(1,u.coordinates.length),m=this;return c.every(function(y){return this.some(function(v){return m.compareLine(y,v,1,!0)})},p)}else return!1},i.prototype.compareFeature=function(l,u){return l.id!==u.id||!this.objectComparator(l.properties,u.properties)||!this.compareBBox(l,u)?!1:this.compare(l.geometry,u.geometry)},i.prototype.compareBBox=function(l,u){return!!(!l.bbox&&!u.bbox||l.bbox&&u.bbox&&this.compareCoord(l.bbox,u.bbox))},i.prototype.removePseudo=function(l){return l};function o(l,u){return r(l,u,{strict:!0})}s(o,"objectComparator"),e.exports=i}),lqe=bt((t,e)=>{N();function r(i,n,a,o){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(i,n,a,o)}s(r,"DBSCAN"),r.prototype.run=function(i,n,a,o){this._init(i,n,a,o);for(var l=0;l<this._datasetLength;l++)if(this._visited[l]!==1){this._visited[l]=1;var u=this._regionQuery(l);if(u.length<this.minPts)this.noise.push(l);else{var c=this.clusters.length;this.clusters.push([]),this._addToCluster(l,c),this._expandCluster(c,u)}}return this.clusters},r.prototype._init=function(i,n,a,o){if(i){if(!(i instanceof Array))throw Error("Dataset must be of type array, "+typeof i+" given");this.dataset=i,this.clusters=[],this.noise=[],this._datasetLength=i.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}n&&(this.epsilon=n),a&&(this.minPts=a),o&&(this.distance=o)},r.prototype._expandCluster=function(i,n){for(var a=0;a<n.length;a++){var o=n[a];if(this._visited[o]!==1){this._visited[o]=1;var l=this._regionQuery(o);l.length>=this.minPts&&(n=this._mergeArrays(n,l))}this._assigned[o]!==1&&this._addToCluster(o,i)}},r.prototype._addToCluster=function(i,n){this.clusters[n].push(i),this._assigned[i]=1},r.prototype._regionQuery=function(i){for(var n=[],a=0;a<this._datasetLength;a++){var o=this.distance(this.dataset[i],this.dataset[a]);o<this.epsilon&&n.push(a)}return n},r.prototype._mergeArrays=function(i,n){for(var a=n.length,o=0;o<a;o++){var l=n[o];i.indexOf(l)<0&&i.push(l)}return i},r.prototype._euclideanDistance=function(i,n){for(var a=0,o=Math.min(i.length,n.length);o--;)a+=(i[o]-n[o])*(i[o]-n[o]);return Math.sqrt(a)},typeof e<"u"&&e.exports&&(e.exports=r)}),uqe=bt((t,e)=>{N();function r(i,n,a){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(i,n,a)}s(r,"KMEANS"),r.prototype.init=function(i,n,a){this.assignments=[],this.centroids=[],typeof i<"u"&&(this.dataset=i),typeof n<"u"&&(this.k=n),typeof a<"u"&&(this.distance=a)},r.prototype.run=function(i,n){this.init(i,n);for(var a=this.dataset.length,o=0;o<this.k;o++)this.centroids[o]=this.randomCentroid();for(var l=!0;l;){l=this.assign();for(var u=0;u<this.k;u++){for(var c=new Array(v),p=0,m=0;m<v;m++)c[m]=0;for(var y=0;y<a;y++){var v=this.dataset[y].length;if(u===this.assignments[y]){for(var m=0;m<v;m++)c[m]+=this.dataset[y][m];p++}}if(p>0){for(var m=0;m<v;m++)c[m]/=p;this.centroids[u]=c}else this.centroids[u]=this.randomCentroid(),l=!0}}return this.getClusters()},r.prototype.randomCentroid=function(){var i=this.dataset.length-1,n,a;do a=Math.round(Math.random()*i),n=this.dataset[a];while(this.centroids.indexOf(n)>=0);return n},r.prototype.assign=function(){for(var i=!1,n=this.dataset.length,a,o=0;o<n;o++)a=this.argmin(this.dataset[o],this.centroids,this.distance),a!=this.assignments[o]&&(this.assignments[o]=a,i=!0);return i},r.prototype.getClusters=function(){for(var i=new Array(this.k),n,a=0;a<this.assignments.length;a++)n=this.assignments[a],typeof i[n]>"u"&&(i[n]=[]),i[n].push(a);return i},r.prototype.argmin=function(i,n,a){for(var o=Number.MAX_VALUE,l=0,u=n.length,c,p=0;p<u;p++)c=a(i,n[p]),c<o&&(o=c,l=p);return l},r.prototype.distance=function(i,n){for(var a=0,o=Math.min(i.length,n.length);o--;){var l=i[o]-n[o];a+=l*l}return Math.sqrt(a)},typeof e<"u"&&e.exports&&(e.exports=r)}),Kge=bt((t,e)=>{N();function r(i,n,a){this._queue=[],this._priorities=[],this._sorting="desc",this._init(i,n,a)}s(r,"PriorityQueue"),r.prototype.insert=function(i,n){for(var a=this._queue.length,o=a;o--;){var l=this._priorities[o];this._sorting==="desc"?n>l&&(a=o):n<l&&(a=o)}this._insertAt(i,n,a)},r.prototype.remove=function(i){for(var n=this._queue.length;n--;){var a=this._queue[n];if(i===a){this._queue.splice(n,1),this._priorities.splice(n,1);break}}},r.prototype.forEach=function(i){this._queue.forEach(i)},r.prototype.getElements=function(){return this._queue},r.prototype.getElementPriority=function(i){return this._priorities[i]},r.prototype.getPriorities=function(){return this._priorities},r.prototype.getElementsWithPriorities=function(){for(var i=[],n=0,a=this._queue.length;n<a;n++)i.push([this._queue[n],this._priorities[n]]);return i},r.prototype._init=function(i,n,a){if(i&&n){if(this._queue=[],this._priorities=[],i.length!==n.length)throw new Error("Arrays must have the same length");for(var o=0;o<i.length;o++)this.insert(i[o],n[o])}a&&(this._sorting=a)},r.prototype._insertAt=function(i,n,a){this._queue.length===a?(this._queue.push(i),this._priorities.push(n)):(this._queue.splice(a,0,i),this._priorities.splice(a,0,n))},typeof e<"u"&&e.exports&&(e.exports=r)}),cqe=bt((t,e)=>{N(),typeof e<"u"&&e.exports&&(r=Kge());var r;function i(n,a,o,l){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(n,a,o,l)}s(i,"OPTICS"),i.prototype.run=function(n,a,o,l){this._init(n,a,o,l);for(var u=0,c=this.dataset.length;u<c;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var p=this.clusters.length-1;this._orderedList.push(u);var m=new r(null,null,"asc"),y=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,y,m),this._expandCluster(p,m))}return this.clusters},i.prototype.getReachabilityPlot=function(){for(var n=[],a=0,o=this._orderedList.length;a<o;a++){var l=this._orderedList[a],u=this._reachability[l];n.push([l,u])}return n},i.prototype._init=function(n,a,o,l){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}a&&(this.epsilon=a),o&&(this.minPts=o),l&&(this.distance=l)},i.prototype._updateQueue=function(n,a,o){var l=this;this._coreDistance=this._distanceToCore(n),a.forEach(function(u){if(l._processed[u]===void 0){var c=l.distance(l.dataset[n],l.dataset[u]),p=Math.max(l._coreDistance,c);l._reachability[u]===void 0?(l._reachability[u]=p,o.insert(u,p)):p<l._reachability[u]&&(l._reachability[u]=p,o.remove(u),o.insert(u,p))}})},i.prototype._expandCluster=function(n,a){for(var o=a.getElements(),l=0,u=o.length;l<u;l++){var c=o[l];if(this._processed[c]===void 0){var p=this._regionQuery(c);this._processed[c]=1,this.clusters[n].push(c),this._orderedList.push(c),this._distanceToCore(c)!==void 0&&(this._updateQueue(c,p,a),this._expandCluster(n,a))}}},i.prototype._distanceToCore=function(n){for(var a=this.epsilon,o=0;o<a;o++){var l=this._regionQuery(n,o);if(l.length>=this.minPts)return o}},i.prototype._regionQuery=function(n,a){a=a||this.epsilon;for(var o=[],l=0,u=this.dataset.length;l<u;l++)this.distance(this.dataset[n],this.dataset[l])<a&&o.push(l);return o},i.prototype._euclideanDistance=function(n,a){for(var o=0,l=Math.min(n.length,a.length);l--;)o+=(n[l]-a[l])*(n[l]-a[l]);return Math.sqrt(o)},typeof e<"u"&&e.exports&&(e.exports=i)}),hqe=bt((t,e)=>{N(),typeof e<"u"&&e.exports&&(e.exports={DBSCAN:lqe(),KMEANS:uqe(),OPTICS:cqe(),PriorityQueue:Kge()})}),Jge=bt((t,e)=>{N(),e.exports={eudist:s(function(r,i,n){for(var a=r.length,o=0,l=0;l<a;l++){var u=(r[l]||0)-(i[l]||0);o+=u*u}return n?Math.sqrt(o):o},"eudist"),mandist:s(function(r,i,n){for(var a=r.length,o=0,l=0;l<a;l++)o+=Math.abs((r[l]||0)-(i[l]||0));return n?Math.sqrt(o):o},"mandist"),dist:s(function(r,i,n){var a=Math.abs(r-i);return n?a:a*a},"dist")}}),pqe=bt((t,e)=>{N();var r=Jge(),i=r.eudist,n=r.dist;e.exports={kmrand:s(function(a,o){for(var l={},u=[],c=o<<2,p=a.length,m=a[0].length>0;u.length<o&&c-- >0;){var y=a[Math.floor(Math.random()*p)],v=m?y.join("_"):""+y;l[v]||(l[v]=!0,u.push(y))}if(u.length<o)throw new Error("Error initializating clusters");return u},"kmrand"),kmpp:s(function(a,o){var l=a[0].length?i:n,u=[],c=a.length,p=a[0].length>0,m=a[Math.floor(Math.random()*c)];for(p?m.join("_"):""+m,u.push(m),!0;u.length<o;){for(var y=[],v=u.length,x=0,E=[],M=0;M<c;M++){for(var I=1/0,P=0;P<v;P++){var C=l(a[M],u[P]);C<=I&&(I=C)}y[M]=I}for(var T=0;T<c;T++)x+=y[T];for(var D=0;D<c;D++)E[D]={i:D,v:a[D],pr:y[D]/x,cs:0};E.sort(function(U,z){return U.pr-z.pr}),E[0].cs=E[0].pr;for(var F=1;F<c;F++)E[F].cs=E[F-1].cs+E[F].pr;for(var k=Math.random(),B=0;B<c-1&&E[B++].cs<k;);u.push(E[B-1].v)}return u},"kmpp")}}),dqe=bt((t,e)=>{N();var r=Jge(),i=pqe(),n=r.eudist;r.mandist,r.dist;var a=i.kmrand,o=i.kmpp,l=1e4;function u(p,m,y){y=y||[];for(var v=0;v<p;v++)y[v]=m;return y}s(u,"init");function c(p,m,y,v){var x=[],E=[],M=[],I=[],P=!1,C=v||l,T=p.length,D=p[0].length,F=D>0,k=[];if(y)y=="kmrand"?x=a(p,m):y=="kmpp"?x=o(p,m):x=y;else for(var B={};x.length<m;){var U=Math.floor(Math.random()*T);B[U]||(B[U]=!0,x.push(p[U]))}do{u(m,0,k);for(var z=0;z<T;z++){for(var q=1/0,Z=0,Q=0;Q<m;Q++){var I=F?n(p[z],x[Q]):Math.abs(p[z]-x[Q]);I<=q&&(q=I,Z=Q)}M[z]=Z,k[Z]++}for(var V=[],E=[],ae=0,Y=0;Y<m;Y++)V[Y]=F?u(D,0,V[Y]):0,E[Y]=x[Y];if(F){for(var he=0;he<m;he++)x[he]=[];for(var J=0;J<T;J++)for(var ne=M[J],ee=V[ne],ue=p[J],K=0;K<D;K++)ee[K]+=ue[K];P=!0;for(var ce=0;ce<m;ce++){for(var re=x[ce],se=V[ce],de=E[ce],we=k[ce],Le=0;Le<D;Le++)re[Le]=se[Le]/we||0;if(P){for(var fe=0;fe<D;fe++)if(de[fe]!=re[fe]){P=!1;break}}}}else{for(var Re=0;Re<T;Re++){var me=M[Re];V[me]+=p[Re]}for(var Ae=0;Ae<m;Ae++)x[Ae]=V[Ae]/k[Ae]||0;P=!0;for(var Ue=0;Ue<m;Ue++)if(E[Ue]!=x[Ue]){P=!1;break}}P=P||--C<=0}while(!P);return{it:l-C,k:m,idxs:M,centroids:x}}s(c,"skmeans"),e.exports=c}),$A=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?e.exports=i():typeof define=="function"&&define.amd?define(i):(r=typeof globalThis<"u"?globalThis:r||self,r.polygonClipping=i())}(t,function(){function r(Oe,oe){var le={label:0,sent:s(function(){if(De[0]&1)throw De[1];return De[1]},"sent"),trys:[],ops:[]},Se,ze,De,yt;return yt={next:st(0),throw:st(1),return:st(2)},typeof Symbol=="function"&&(yt[Symbol.iterator]=function(){return this}),yt;function st(mt){return function(Gt){return kt([mt,Gt])}}function kt(mt){if(Se)throw new TypeError("Generator is already executing.");for(;le;)try{if(Se=1,ze&&(De=mt[0]&2?ze.return:mt[0]?ze.throw||((De=ze.return)&&De.call(ze),0):ze.next)&&!(De=De.call(ze,mt[1])).done)return De;switch(ze=0,De&&(mt=[mt[0]&2,De.value]),mt[0]){case 0:case 1:De=mt;break;case 4:return le.label++,{value:mt[1],done:!1};case 5:le.label++,ze=mt[1],mt=[0];continue;case 7:mt=le.ops.pop(),le.trys.pop();continue;default:if(De=le.trys,!(De=De.length>0&&De[De.length-1])&&(mt[0]===6||mt[0]===2)){le=0;continue}if(mt[0]===3&&(!De||mt[1]>De[0]&&mt[1]<De[3])){le.label=mt[1];break}if(mt[0]===6&&le.label<De[1]){le.label=De[1],De=mt;break}if(De&&le.label<De[2]){le.label=De[2],le.ops.push(mt);break}De[2]&&le.ops.pop(),le.trys.pop();continue}mt=oe.call(Oe,le)}catch(Gt){mt=[6,Gt],ze=0}finally{Se=De=0}if(mt[0]&5)throw mt[1];return{value:mt[0]?mt[1]:void 0,done:!0}}}s(r,"__generator");var i=function(){function Oe(oe,le){this.next=null,this.key=oe,this.data=le,this.left=null,this.right=null}return s(Oe,"Node"),Oe}();function n(Oe,oe){return Oe>oe?1:Oe<oe?-1:0}s(n,"DEFAULT_COMPARE");function a(Oe,oe,le){for(var Se=new i(null,null),ze=Se,De=Se;;){var yt=le(Oe,oe.key);if(yt<0){if(oe.left===null)break;if(le(Oe,oe.left.key)<0){var st=oe.left;if(oe.left=st.right,st.right=oe,oe=st,oe.left===null)break}De.left=oe,De=oe,oe=oe.left}else if(yt>0){if(oe.right===null)break;if(le(Oe,oe.right.key)>0){var st=oe.right;if(oe.right=st.left,st.left=oe,oe=st,oe.right===null)break}ze.right=oe,ze=oe,oe=oe.right}else break}return ze.right=oe.left,De.left=oe.right,oe.left=Se.right,oe.right=Se.left,oe}s(a,"splay");function o(Oe,oe,le,Se){var ze=new i(Oe,oe);if(le===null)return ze.left=ze.right=null,ze;le=a(Oe,le,Se);var De=Se(Oe,le.key);return De<0?(ze.left=le.left,ze.right=le,le.left=null):De>=0&&(ze.right=le.right,ze.left=le,le.right=null),ze}s(o,"insert");function l(Oe,oe,le){var Se=null,ze=null;if(oe){oe=a(Oe,oe,le);var De=le(oe.key,Oe);De===0?(Se=oe.left,ze=oe.right):De<0?(ze=oe.right,oe.right=null,Se=oe):(Se=oe.left,oe.left=null,ze=oe)}return{left:Se,right:ze}}s(l,"split");function u(Oe,oe,le){return oe===null?Oe:(Oe===null||(oe=a(Oe.key,oe,le),oe.left=Oe),oe)}s(u,"merge");function c(Oe,oe,le,Se,ze){if(Oe){Se(""+oe+(le?" ":" ")+ze(Oe)+`
`);var De=oe+(le?"    ":"   ");Oe.left&&c(Oe.left,De,!1,Se,ze),Oe.right&&c(Oe.right,De,!0,Se,ze)}}s(c,"printRow");var p=function(){function Oe(oe){oe===void 0&&(oe=n),this._root=null,this._size=0,this._comparator=oe}return s(Oe,"Tree"),Oe.prototype.insert=function(oe,le){return this._size++,this._root=o(oe,le,this._root,this._comparator)},Oe.prototype.add=function(oe,le){var Se=new i(oe,le);this._root===null&&(Se.left=Se.right=null,this._size++,this._root=Se);var ze=this._comparator,De=a(oe,this._root,ze),yt=ze(oe,De.key);return yt===0?this._root=De:(yt<0?(Se.left=De.left,Se.right=De,De.left=null):yt>0&&(Se.right=De.right,Se.left=De,De.right=null),this._size++,this._root=Se),this._root},Oe.prototype.remove=function(oe){this._root=this._remove(oe,this._root,this._comparator)},Oe.prototype._remove=function(oe,le,Se){var ze;if(le===null)return null;le=a(oe,le,Se);var De=Se(oe,le.key);return De===0?(le.left===null?ze=le.right:(ze=a(oe,le.left,Se),ze.right=le.right),this._size--,ze):le},Oe.prototype.pop=function(){var oe=this._root;if(oe){for(;oe.left;)oe=oe.left;return this._root=a(oe.key,this._root,this._comparator),this._root=this._remove(oe.key,this._root,this._comparator),{key:oe.key,data:oe.data}}return null},Oe.prototype.findStatic=function(oe){for(var le=this._root,Se=this._comparator;le;){var ze=Se(oe,le.key);if(ze===0)return le;ze<0?le=le.left:le=le.right}return null},Oe.prototype.find=function(oe){return this._root&&(this._root=a(oe,this._root,this._comparator),this._comparator(oe,this._root.key)!==0)?null:this._root},Oe.prototype.contains=function(oe){for(var le=this._root,Se=this._comparator;le;){var ze=Se(oe,le.key);if(ze===0)return!0;ze<0?le=le.left:le=le.right}return!1},Oe.prototype.forEach=function(oe,le){for(var Se=this._root,ze=[],De=!1;!De;)Se!==null?(ze.push(Se),Se=Se.left):ze.length!==0?(Se=ze.pop(),oe.call(le,Se),Se=Se.right):De=!0;return this},Oe.prototype.range=function(oe,le,Se,ze){for(var De=[],yt=this._comparator,st=this._root,kt;De.length!==0||st;)if(st)De.push(st),st=st.left;else{if(st=De.pop(),kt=yt(st.key,le),kt>0)break;if(yt(st.key,oe)>=0&&Se.call(ze,st))return this;st=st.right}return this},Oe.prototype.keys=function(){var oe=[];return this.forEach(function(le){var Se=le.key;return oe.push(Se)}),oe},Oe.prototype.values=function(){var oe=[];return this.forEach(function(le){var Se=le.data;return oe.push(Se)}),oe},Oe.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Oe.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Oe.prototype.minNode=function(oe){if(oe===void 0&&(oe=this._root),oe)for(;oe.left;)oe=oe.left;return oe},Oe.prototype.maxNode=function(oe){if(oe===void 0&&(oe=this._root),oe)for(;oe.right;)oe=oe.right;return oe},Oe.prototype.at=function(oe){for(var le=this._root,Se=!1,ze=0,De=[];!Se;)if(le)De.push(le),le=le.left;else if(De.length>0){if(le=De.pop(),ze===oe)return le;ze++,le=le.right}else Se=!0;return null},Oe.prototype.next=function(oe){var le=this._root,Se=null;if(oe.right){for(Se=oe.right;Se.left;)Se=Se.left;return Se}for(var ze=this._comparator;le;){var De=ze(oe.key,le.key);if(De===0)break;De<0?(Se=le,le=le.left):le=le.right}return Se},Oe.prototype.prev=function(oe){var le=this._root,Se=null;if(oe.left!==null){for(Se=oe.left;Se.right;)Se=Se.right;return Se}for(var ze=this._comparator;le;){var De=ze(oe.key,le.key);if(De===0)break;De<0?le=le.left:(Se=le,le=le.right)}return Se},Oe.prototype.clear=function(){return this._root=null,this._size=0,this},Oe.prototype.toList=function(){return v(this._root)},Oe.prototype.load=function(oe,le,Se){le===void 0&&(le=[]),Se===void 0&&(Se=!1);var ze=oe.length,De=this._comparator;if(Se&&M(oe,le,0,ze-1,De),this._root===null)this._root=m(oe,le,0,ze),this._size=ze;else{var yt=E(this.toList(),y(oe,le),De);ze=this._size+ze,this._root=x({head:yt},0,ze)}return this},Oe.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Oe.prototype,"size",{get:s(function(){return this._size},"get"),enumerable:!0,configurable:!0}),Object.defineProperty(Oe.prototype,"root",{get:s(function(){return this._root},"get"),enumerable:!0,configurable:!0}),Oe.prototype.toString=function(oe){oe===void 0&&(oe=s(function(Se){return String(Se.key)},"printNode"));var le=[];return c(this._root,"",!0,function(Se){return le.push(Se)},oe),le.join("")},Oe.prototype.update=function(oe,le,Se){var ze=this._comparator,De=l(oe,this._root,ze),yt=De.left,st=De.right;ze(oe,le)<0?st=o(le,Se,st,ze):yt=o(le,Se,yt,ze),this._root=u(yt,st,ze)},Oe.prototype.split=function(oe){return l(oe,this._root,this._comparator)},Oe.prototype[Symbol.iterator]=function(){var oe,le,Se;return r(this,function(ze){switch(ze.label){case 0:oe=this._root,le=[],Se=!1,ze.label=1;case 1:return Se?[3,6]:oe===null?[3,2]:(le.push(oe),oe=oe.left,[3,5]);case 2:return le.length===0?[3,4]:(oe=le.pop(),[4,oe]);case 3:return ze.sent(),oe=oe.right,[3,5];case 4:Se=!0,ze.label=5;case 5:return[3,1];case 6:return[2]}})},Oe}();function m(Oe,oe,le,Se){var ze=Se-le;if(ze>0){var De=le+Math.floor(ze/2),yt=Oe[De],st=oe[De],kt=new i(yt,st);return kt.left=m(Oe,oe,le,De),kt.right=m(Oe,oe,De+1,Se),kt}return null}s(m,"loadRecursive");function y(Oe,oe){for(var le=new i(null,null),Se=le,ze=0;ze<Oe.length;ze++)Se=Se.next=new i(Oe[ze],oe[ze]);return Se.next=null,le.next}s(y,"createList");function v(Oe){for(var oe=Oe,le=[],Se=!1,ze=new i(null,null),De=ze;!Se;)oe?(le.push(oe),oe=oe.left):le.length>0?(oe=De=De.next=le.pop(),oe=oe.right):Se=!0;return De.next=null,ze.next}s(v,"toList");function x(Oe,oe,le){var Se=le-oe;if(Se>0){var ze=oe+Math.floor(Se/2),De=x(Oe,oe,ze),yt=Oe.head;return yt.left=De,Oe.head=Oe.head.next,yt.right=x(Oe,ze+1,le),yt}return null}s(x,"sortedListToBST");function E(Oe,oe,le){for(var Se=new i(null,null),ze=Se,De=Oe,yt=oe;De!==null&&yt!==null;)le(De.key,yt.key)<0?(ze.next=De,De=De.next):(ze.next=yt,yt=yt.next),ze=ze.next;return De!==null?ze.next=De:yt!==null&&(ze.next=yt),Se.next}s(E,"mergeLists");function M(Oe,oe,le,Se,ze){if(!(le>=Se)){for(var De=Oe[le+Se>>1],yt=le-1,st=Se+1;;){do yt++;while(ze(Oe[yt],De)<0);do st--;while(ze(Oe[st],De)>0);if(yt>=st)break;var kt=Oe[yt];Oe[yt]=Oe[st],Oe[st]=kt,kt=oe[yt],oe[yt]=oe[st],oe[st]=kt}M(Oe,oe,le,st,ze),M(Oe,oe,st+1,Se,ze)}}s(M,"sort");let I=s((Oe,oe)=>Oe.ll.x<=oe.x&&oe.x<=Oe.ur.x&&Oe.ll.y<=oe.y&&oe.y<=Oe.ur.y,"isInBbox"),P=s((Oe,oe)=>{if(oe.ur.x<Oe.ll.x||Oe.ur.x<oe.ll.x||oe.ur.y<Oe.ll.y||Oe.ur.y<oe.ll.y)return null;let le=Oe.ll.x<oe.ll.x?oe.ll.x:Oe.ll.x,Se=Oe.ur.x<oe.ur.x?Oe.ur.x:oe.ur.x,ze=Oe.ll.y<oe.ll.y?oe.ll.y:Oe.ll.y,De=Oe.ur.y<oe.ur.y?Oe.ur.y:oe.ur.y;return{ll:{x:le,y:ze},ur:{x:Se,y:De}}},"getBboxOverlap"),C=Number.EPSILON;C===void 0&&(C=Math.pow(2,-52));let T=C*C,D=s((Oe,oe)=>{if(-C<Oe&&Oe<C&&-C<oe&&oe<C)return 0;let le=Oe-oe;return le*le<T*Oe*oe?0:Oe<oe?-1:1},"cmp"),F=class{constructor(){this.reset()}reset(){this.xRounder=new U,this.yRounder=new U}round(oe,le){return{x:this.xRounder.round(oe),y:this.yRounder.round(le)}}};s(F,"PtRounder");let k=F,B=class{constructor(){this.tree=new p,this.round(0)}round(oe){let le=this.tree.add(oe),Se=this.tree.prev(le);if(Se!==null&&D(le.key,Se.key)===0)return this.tree.remove(oe),Se.key;let ze=this.tree.next(le);return ze!==null&&D(le.key,ze.key)===0?(this.tree.remove(oe),ze.key):oe}};s(B,"CoordRounder");let U=B,z=new k,q=11102230246251565e-32,Z=134217729,Q=(3+8*q)*q;function V(Oe,oe,le,Se,ze){let De,yt,st,kt,mt=oe[0],Gt=Se[0],ke=0,$e=0;Gt>mt==Gt>-mt?(De=mt,mt=oe[++ke]):(De=Gt,Gt=Se[++$e]);let ot=0;if(ke<Oe&&$e<le)for(Gt>mt==Gt>-mt?(yt=mt+De,st=De-(yt-mt),mt=oe[++ke]):(yt=Gt+De,st=De-(yt-Gt),Gt=Se[++$e]),De=yt,st!==0&&(ze[ot++]=st);ke<Oe&&$e<le;)Gt>mt==Gt>-mt?(yt=De+mt,kt=yt-De,st=De-(yt-kt)+(mt-kt),mt=oe[++ke]):(yt=De+Gt,kt=yt-De,st=De-(yt-kt)+(Gt-kt),Gt=Se[++$e]),De=yt,st!==0&&(ze[ot++]=st);for(;ke<Oe;)yt=De+mt,kt=yt-De,st=De-(yt-kt)+(mt-kt),mt=oe[++ke],De=yt,st!==0&&(ze[ot++]=st);for(;$e<le;)yt=De+Gt,kt=yt-De,st=De-(yt-kt)+(Gt-kt),Gt=Se[++$e],De=yt,st!==0&&(ze[ot++]=st);return(De!==0||ot===0)&&(ze[ot++]=De),ot}s(V,"sum");function ae(Oe,oe){let le=oe[0];for(let Se=1;Se<Oe;Se++)le+=oe[Se];return le}s(ae,"estimate");function Y(Oe){return new Float64Array(Oe)}s(Y,"vec");let he=(3+16*q)*q,J=(2+12*q)*q,ne=(9+64*q)*q*q,ee=Y(4),ue=Y(8),K=Y(12),ce=Y(16),re=Y(4);function se(Oe,oe,le,Se,ze,De,yt){let st,kt,mt,Gt,ke,$e,ot,Ft,Ht,fr,nr,Zr,ni,Yr,Cr,Mi,$r,Qi,Gi=Oe-ze,Mn=le-ze,Ie=oe-De,Je=Se-De;Yr=Gi*Je,$e=Z*Gi,ot=$e-($e-Gi),Ft=Gi-ot,$e=Z*Je,Ht=$e-($e-Je),fr=Je-Ht,Cr=Ft*fr-(Yr-ot*Ht-Ft*Ht-ot*fr),Mi=Ie*Mn,$e=Z*Ie,ot=$e-($e-Ie),Ft=Ie-ot,$e=Z*Mn,Ht=$e-($e-Mn),fr=Mn-Ht,$r=Ft*fr-(Mi-ot*Ht-Ft*Ht-ot*fr),nr=Cr-$r,ke=Cr-nr,ee[0]=Cr-(nr+ke)+(ke-$r),Zr=Yr+nr,ke=Zr-Yr,ni=Yr-(Zr-ke)+(nr-ke),nr=ni-Mi,ke=ni-nr,ee[1]=ni-(nr+ke)+(ke-Mi),Qi=Zr+nr,ke=Qi-Zr,ee[2]=Zr-(Qi-ke)+(nr-ke),ee[3]=Qi;let wt=ae(4,ee),ft=J*yt;if(wt>=ft||-wt>=ft||(ke=Oe-Gi,st=Oe-(Gi+ke)+(ke-ze),ke=le-Mn,mt=le-(Mn+ke)+(ke-ze),ke=oe-Ie,kt=oe-(Ie+ke)+(ke-De),ke=Se-Je,Gt=Se-(Je+ke)+(ke-De),st===0&&kt===0&&mt===0&&Gt===0)||(ft=ne*yt+Q*Math.abs(wt),wt+=Gi*Gt+Je*st-(Ie*mt+Mn*kt),wt>=ft||-wt>=ft))return wt;Yr=st*Je,$e=Z*st,ot=$e-($e-st),Ft=st-ot,$e=Z*Je,Ht=$e-($e-Je),fr=Je-Ht,Cr=Ft*fr-(Yr-ot*Ht-Ft*Ht-ot*fr),Mi=kt*Mn,$e=Z*kt,ot=$e-($e-kt),Ft=kt-ot,$e=Z*Mn,Ht=$e-($e-Mn),fr=Mn-Ht,$r=Ft*fr-(Mi-ot*Ht-Ft*Ht-ot*fr),nr=Cr-$r,ke=Cr-nr,re[0]=Cr-(nr+ke)+(ke-$r),Zr=Yr+nr,ke=Zr-Yr,ni=Yr-(Zr-ke)+(nr-ke),nr=ni-Mi,ke=ni-nr,re[1]=ni-(nr+ke)+(ke-Mi),Qi=Zr+nr,ke=Qi-Zr,re[2]=Zr-(Qi-ke)+(nr-ke),re[3]=Qi;let rt=V(4,ee,4,re,ue);Yr=Gi*Gt,$e=Z*Gi,ot=$e-($e-Gi),Ft=Gi-ot,$e=Z*Gt,Ht=$e-($e-Gt),fr=Gt-Ht,Cr=Ft*fr-(Yr-ot*Ht-Ft*Ht-ot*fr),Mi=Ie*mt,$e=Z*Ie,ot=$e-($e-Ie),Ft=Ie-ot,$e=Z*mt,Ht=$e-($e-mt),fr=mt-Ht,$r=Ft*fr-(Mi-ot*Ht-Ft*Ht-ot*fr),nr=Cr-$r,ke=Cr-nr,re[0]=Cr-(nr+ke)+(ke-$r),Zr=Yr+nr,ke=Zr-Yr,ni=Yr-(Zr-ke)+(nr-ke),nr=ni-Mi,ke=ni-nr,re[1]=ni-(nr+ke)+(ke-Mi),Qi=Zr+nr,ke=Qi-Zr,re[2]=Zr-(Qi-ke)+(nr-ke),re[3]=Qi;let zt=V(rt,ue,4,re,K);Yr=st*Gt,$e=Z*st,ot=$e-($e-st),Ft=st-ot,$e=Z*Gt,Ht=$e-($e-Gt),fr=Gt-Ht,Cr=Ft*fr-(Yr-ot*Ht-Ft*Ht-ot*fr),Mi=kt*mt,$e=Z*kt,ot=$e-($e-kt),Ft=kt-ot,$e=Z*mt,Ht=$e-($e-mt),fr=mt-Ht,$r=Ft*fr-(Mi-ot*Ht-Ft*Ht-ot*fr),nr=Cr-$r,ke=Cr-nr,re[0]=Cr-(nr+ke)+(ke-$r),Zr=Yr+nr,ke=Zr-Yr,ni=Yr-(Zr-ke)+(nr-ke),nr=ni-Mi,ke=ni-nr,re[1]=ni-(nr+ke)+(ke-Mi),Qi=Zr+nr,ke=Qi-Zr,re[2]=Zr-(Qi-ke)+(nr-ke),re[3]=Qi;let cr=V(zt,K,4,re,ce);return ce[cr-1]}s(se,"orient2dadapt");function de(Oe,oe,le,Se,ze,De){let yt=(oe-De)*(le-ze),st=(Oe-ze)*(Se-De),kt=yt-st,mt=Math.abs(yt+st);return Math.abs(kt)>=he*mt?kt:-se(Oe,oe,le,Se,ze,De,mt)}s(de,"orient2d");let we=s((Oe,oe)=>Oe.x*oe.y-Oe.y*oe.x,"crossProduct"),Le=s((Oe,oe)=>Oe.x*oe.x+Oe.y*oe.y,"dotProduct"),fe=s((Oe,oe,le)=>{let Se=de(Oe.x,Oe.y,oe.x,oe.y,le.x,le.y);return Se>0?-1:Se<0?1:0},"compareVectorAngles"),Re=s(Oe=>Math.sqrt(Le(Oe,Oe)),"length"),me=s((Oe,oe,le)=>{let Se={x:oe.x-Oe.x,y:oe.y-Oe.y},ze={x:le.x-Oe.x,y:le.y-Oe.y};return we(ze,Se)/Re(ze)/Re(Se)},"sineOfAngle"),Ae=s((Oe,oe,le)=>{let Se={x:oe.x-Oe.x,y:oe.y-Oe.y},ze={x:le.x-Oe.x,y:le.y-Oe.y};return Le(ze,Se)/Re(ze)/Re(Se)},"cosineOfAngle"),Ue=s((Oe,oe,le)=>oe.y===0?null:{x:Oe.x+oe.x/oe.y*(le-Oe.y),y:le},"horizontalIntersection"),_e=s((Oe,oe,le)=>oe.x===0?null:{x:le,y:Oe.y+oe.y/oe.x*(le-Oe.x)},"verticalIntersection"),lt=s((Oe,oe,le,Se)=>{if(oe.x===0)return _e(le,Se,Oe.x);if(Se.x===0)return _e(Oe,oe,le.x);if(oe.y===0)return Ue(le,Se,Oe.y);if(Se.y===0)return Ue(Oe,oe,le.y);let ze=we(oe,Se);if(ze==0)return null;let De={x:le.x-Oe.x,y:le.y-Oe.y},yt=we(De,oe)/ze,st=we(De,Se)/ze,kt=Oe.x+st*oe.x,mt=le.x+yt*Se.x,Gt=Oe.y+st*oe.y,ke=le.y+yt*Se.y,$e=(kt+mt)/2,ot=(Gt+ke)/2;return{x:$e,y:ot}},"intersection$1"),tt=class Qge{static compare(oe,le){let Se=Qge.comparePoints(oe.point,le.point);return Se!==0?Se:(oe.point!==le.point&&oe.link(le),oe.isLeft!==le.isLeft?oe.isLeft?1:-1:dt.compare(oe.segment,le.segment))}static comparePoints(oe,le){return oe.x<le.x?-1:oe.x>le.x?1:oe.y<le.y?-1:oe.y>le.y?1:0}constructor(oe,le){oe.events===void 0?oe.events=[this]:oe.events.push(this),this.point=oe,this.isLeft=le}link(oe){if(oe.point===this.point)throw new Error("Tried to link already linked events");let le=oe.point.events;for(let Se=0,ze=le.length;Se<ze;Se++){let De=le[Se];this.point.events.push(De),De.point=this.point}this.checkForConsuming()}checkForConsuming(){let oe=this.point.events.length;for(let le=0;le<oe;le++){let Se=this.point.events[le];if(Se.segment.consumedBy===void 0)for(let ze=le+1;ze<oe;ze++){let De=this.point.events[ze];De.consumedBy===void 0&&Se.otherSE.point.events===De.otherSE.point.events&&Se.segment.consume(De.segment)}}}getAvailableLinkedEvents(){let oe=[];for(let le=0,Se=this.point.events.length;le<Se;le++){let ze=this.point.events[le];ze!==this&&!ze.segment.ringOut&&ze.segment.isInResult()&&oe.push(ze)}return oe}getLeftmostComparator(oe){let le=new Map,Se=s(ze=>{let De=ze.otherSE;le.set(ze,{sine:me(this.point,oe.point,De.point),cosine:Ae(this.point,oe.point,De.point)})},"fillCache");return(ze,De)=>{le.has(ze)||Se(ze),le.has(De)||Se(De);let{sine:yt,cosine:st}=le.get(ze),{sine:kt,cosine:mt}=le.get(De);return yt>=0&&kt>=0?st<mt?1:st>mt?-1:0:yt<0&&kt<0?st<mt?-1:st>mt?1:0:kt<yt?-1:kt>yt?1:0}}};s(tt,"SweepEvent");let We=tt,at=0,Lt=class pC{static compare(oe,le){let Se=oe.leftSE.point.x,ze=le.leftSE.point.x,De=oe.rightSE.point.x,yt=le.rightSE.point.x;if(yt<Se)return 1;if(De<ze)return-1;let st=oe.leftSE.point.y,kt=le.leftSE.point.y,mt=oe.rightSE.point.y,Gt=le.rightSE.point.y;if(Se<ze){if(kt<st&&kt<mt)return 1;if(kt>st&&kt>mt)return-1;let ke=oe.comparePoint(le.leftSE.point);if(ke<0)return 1;if(ke>0)return-1;let $e=le.comparePoint(oe.rightSE.point);return $e!==0?$e:-1}if(Se>ze){if(st<kt&&st<Gt)return-1;if(st>kt&&st>Gt)return 1;let ke=le.comparePoint(oe.leftSE.point);if(ke!==0)return ke;let $e=oe.comparePoint(le.rightSE.point);return $e<0?1:$e>0?-1:1}if(st<kt)return-1;if(st>kt)return 1;if(De<yt){let ke=le.comparePoint(oe.rightSE.point);if(ke!==0)return ke}if(De>yt){let ke=oe.comparePoint(le.rightSE.point);if(ke<0)return 1;if(ke>0)return-1}if(De!==yt){let ke=mt-st,$e=De-Se,ot=Gt-kt,Ft=yt-ze;if(ke>$e&&ot<Ft)return 1;if(ke<$e&&ot>Ft)return-1}return De>yt?1:De<yt||mt<Gt?-1:mt>Gt?1:oe.id<le.id?-1:oe.id>le.id?1:0}constructor(oe,le,Se,ze){this.id=++at,this.leftSE=oe,oe.segment=this,oe.otherSE=le,this.rightSE=le,le.segment=this,le.otherSE=oe,this.rings=Se,this.windings=ze}static fromRing(oe,le,Se){let ze,De,yt,st=We.comparePoints(oe,le);if(st<0)ze=oe,De=le,yt=1;else if(st>0)ze=le,De=oe,yt=-1;else throw new Error("Tried to create degenerate segment at [".concat(oe.x,", ").concat(oe.y,"]"));let kt=new We(ze,!0),mt=new We(De,!1);return new pC(kt,mt,[Se],[yt])}replaceRightSE(oe){this.rightSE=oe,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let oe=this.leftSE.point.y,le=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:oe<le?oe:le},ur:{x:this.rightSE.point.x,y:oe>le?oe:le}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(oe){return oe.x===this.leftSE.point.x&&oe.y===this.leftSE.point.y||oe.x===this.rightSE.point.x&&oe.y===this.rightSE.point.y}comparePoint(oe){if(this.isAnEndpoint(oe))return 0;let le=this.leftSE.point,Se=this.rightSE.point,ze=this.vector();if(le.x===Se.x)return oe.x===le.x?0:oe.x<le.x?1:-1;let De=(oe.y-le.y)/ze.y,yt=le.x+De*ze.x;if(oe.x===yt)return 0;let st=(oe.x-le.x)/ze.x,kt=le.y+st*ze.y;return oe.y===kt?0:oe.y<kt?-1:1}getIntersection(oe){let le=this.bbox(),Se=oe.bbox(),ze=P(le,Se);if(ze===null)return null;let De=this.leftSE.point,yt=this.rightSE.point,st=oe.leftSE.point,kt=oe.rightSE.point,mt=I(le,st)&&this.comparePoint(st)===0,Gt=I(Se,De)&&oe.comparePoint(De)===0,ke=I(le,kt)&&this.comparePoint(kt)===0,$e=I(Se,yt)&&oe.comparePoint(yt)===0;if(Gt&&mt)return $e&&!ke?yt:!$e&&ke?kt:null;if(Gt)return ke&&De.x===kt.x&&De.y===kt.y?null:De;if(mt)return $e&&yt.x===st.x&&yt.y===st.y?null:st;if($e&&ke)return null;if($e)return yt;if(ke)return kt;let ot=lt(De,this.vector(),st,oe.vector());return ot===null||!I(ze,ot)?null:z.round(ot.x,ot.y)}split(oe){let le=[],Se=oe.events!==void 0,ze=new We(oe,!0),De=new We(oe,!1),yt=this.rightSE;this.replaceRightSE(De),le.push(De),le.push(ze);let st=new pC(ze,yt,this.rings.slice(),this.windings.slice());return We.comparePoints(st.leftSE.point,st.rightSE.point)>0&&st.swapEvents(),We.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Se&&(ze.checkForConsuming(),De.checkForConsuming()),le}swapEvents(){let oe=this.rightSE;this.rightSE=this.leftSE,this.leftSE=oe,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let le=0,Se=this.windings.length;le<Se;le++)this.windings[le]*=-1}consume(oe){let le=this,Se=oe;for(;le.consumedBy;)le=le.consumedBy;for(;Se.consumedBy;)Se=Se.consumedBy;let ze=pC.compare(le,Se);if(ze!==0){if(ze>0){let De=le;le=Se,Se=De}if(le.prev===Se){let De=le;le=Se,Se=De}for(let De=0,yt=Se.rings.length;De<yt;De++){let st=Se.rings[De],kt=Se.windings[De],mt=le.rings.indexOf(st);mt===-1?(le.rings.push(st),le.windings.push(kt)):le.windings[mt]+=kt}Se.rings=null,Se.windings=null,Se.consumedBy=le,Se.leftSE.consumedBy=le.leftSE,Se.rightSE.consumedBy=le.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let oe=this.prev.consumedBy||this.prev;this._beforeState=oe.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let oe=this.beforeState();this._afterState={rings:oe.rings.slice(0),windings:oe.windings.slice(0),multiPolys:[]};let le=this._afterState.rings,Se=this._afterState.windings,ze=this._afterState.multiPolys;for(let st=0,kt=this.rings.length;st<kt;st++){let mt=this.rings[st],Gt=this.windings[st],ke=le.indexOf(mt);ke===-1?(le.push(mt),Se.push(Gt)):Se[ke]+=Gt}let De=[],yt=[];for(let st=0,kt=le.length;st<kt;st++){if(Se[st]===0)continue;let mt=le[st],Gt=mt.poly;if(yt.indexOf(Gt)===-1)if(mt.isExterior)De.push(Gt);else{yt.indexOf(Gt)===-1&&yt.push(Gt);let ke=De.indexOf(mt.poly);ke!==-1&&De.splice(ke,1)}}for(let st=0,kt=De.length;st<kt;st++){let mt=De[st].multiPoly;ze.indexOf(mt)===-1&&ze.push(mt)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let oe=this.beforeState().multiPolys,le=this.afterState().multiPolys;switch(Qe.type){case"union":{let Se=oe.length===0,ze=le.length===0;this._isInResult=Se!==ze;break}case"intersection":{let Se,ze;oe.length<le.length?(Se=oe.length,ze=le.length):(Se=le.length,ze=oe.length),this._isInResult=ze===Qe.numMultiPolys&&Se<ze;break}case"xor":{let Se=Math.abs(oe.length-le.length);this._isInResult=Se%2===1;break}case"difference":{let Se=s(ze=>ze.length===1&&ze[0].isSubject,"isJustSubject");this._isInResult=Se(oe)!==Se(le);break}default:throw new Error("Unrecognized operation type found ".concat(Qe.type))}return this._isInResult}};s(Lt,"Segment");let dt=Lt,Me=class{constructor(oe,le,Se){if(!Array.isArray(oe)||oe.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=le,this.isExterior=Se,this.segments=[],typeof oe[0][0]!="number"||typeof oe[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let ze=z.round(oe[0][0],oe[0][1]);this.bbox={ll:{x:ze.x,y:ze.y},ur:{x:ze.x,y:ze.y}};let De=ze;for(let yt=1,st=oe.length;yt<st;yt++){if(typeof oe[yt][0]!="number"||typeof oe[yt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let kt=z.round(oe[yt][0],oe[yt][1]);kt.x===De.x&&kt.y===De.y||(this.segments.push(dt.fromRing(De,kt,this)),kt.x<this.bbox.ll.x&&(this.bbox.ll.x=kt.x),kt.y<this.bbox.ll.y&&(this.bbox.ll.y=kt.y),kt.x>this.bbox.ur.x&&(this.bbox.ur.x=kt.x),kt.y>this.bbox.ur.y&&(this.bbox.ur.y=kt.y),De=kt)}(ze.x!==De.x||ze.y!==De.y)&&this.segments.push(dt.fromRing(De,ze,this))}getSweepEvents(){let oe=[];for(let le=0,Se=this.segments.length;le<Se;le++){let ze=this.segments[le];oe.push(ze.leftSE),oe.push(ze.rightSE)}return oe}};s(Me,"RingIn");let ve=Me,Ze=class{constructor(oe,le){if(!Array.isArray(oe))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ve(oe[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let Se=1,ze=oe.length;Se<ze;Se++){let De=new ve(oe[Se],this,!1);De.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=De.bbox.ll.x),De.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=De.bbox.ll.y),De.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=De.bbox.ur.x),De.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=De.bbox.ur.y),this.interiorRings.push(De)}this.multiPoly=le}getSweepEvents(){let oe=this.exteriorRing.getSweepEvents();for(let le=0,Se=this.interiorRings.length;le<Se;le++){let ze=this.interiorRings[le].getSweepEvents();for(let De=0,yt=ze.length;De<yt;De++)oe.push(ze[De])}return oe}};s(Ze,"PolyIn");let It=Ze,Rt=class{constructor(oe,le){if(!Array.isArray(oe))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof oe[0][0][0]=="number"&&(oe=[oe])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let Se=0,ze=oe.length;Se<ze;Se++){let De=new It(oe[Se],this);De.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=De.bbox.ll.x),De.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=De.bbox.ll.y),De.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=De.bbox.ur.x),De.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=De.bbox.ur.y),this.polys.push(De)}this.isSubject=le}getSweepEvents(){let oe=[];for(let le=0,Se=this.polys.length;le<Se;le++){let ze=this.polys[le].getSweepEvents();for(let De=0,yt=ze.length;De<yt;De++)oe.push(ze[De])}return oe}};s(Rt,"MultiPolyIn");let Et=Rt,pt=class $O{static factory(oe){let le=[];for(let Se=0,ze=oe.length;Se<ze;Se++){let De=oe[Se];if(!De.isInResult()||De.ringOut)continue;let yt=null,st=De.leftSE,kt=De.rightSE,mt=[st],Gt=st.point,ke=[];for(;yt=st,st=kt,mt.push(st),st.point!==Gt;)for(;;){let $e=st.getAvailableLinkedEvents();if($e.length===0){let Ht=mt[0].point,fr=mt[mt.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Ht.x,",")+" ".concat(Ht.y,"]. Last matching segment found ends at")+" [".concat(fr.x,", ").concat(fr.y,"]."))}if($e.length===1){kt=$e[0].otherSE;break}let ot=null;for(let Ht=0,fr=ke.length;Ht<fr;Ht++)if(ke[Ht].point===st.point){ot=Ht;break}if(ot!==null){let Ht=ke.splice(ot)[0],fr=mt.splice(Ht.index);fr.unshift(fr[0].otherSE),le.push(new $O(fr.reverse()));continue}ke.push({index:mt.length,point:st.point});let Ft=st.getLeftmostComparator(yt);kt=$e.sort(Ft)[0].otherSE;break}le.push(new $O(mt))}return le}constructor(oe){this.events=oe;for(let le=0,Se=oe.length;le<Se;le++)oe[le].segment.ringOut=this;this.poly=null}getGeom(){let oe=this.events[0].point,le=[oe];for(let mt=1,Gt=this.events.length-1;mt<Gt;mt++){let ke=this.events[mt].point,$e=this.events[mt+1].point;fe(ke,oe,$e)!==0&&(le.push(ke),oe=ke)}if(le.length===1)return null;let Se=le[0],ze=le[1];fe(Se,oe,ze)===0&&le.shift(),le.push(le[0]);let De=this.isExteriorRing()?1:-1,yt=this.isExteriorRing()?0:le.length-1,st=this.isExteriorRing()?le.length:-1,kt=[];for(let mt=yt;mt!=st;mt+=De)kt.push([le[mt].x,le[mt].y]);return kt}isExteriorRing(){if(this._isExteriorRing===void 0){let oe=this.enclosingRing();this._isExteriorRing=oe?!oe.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let oe=this.events[0];for(let ze=1,De=this.events.length;ze<De;ze++){let yt=this.events[ze];We.compare(oe,yt)>0&&(oe=yt)}let le=oe.segment.prevInResult(),Se=le?le.prevInResult():null;for(;;){if(!le)return null;if(!Se)return le.ringOut;if(Se.ringOut!==le.ringOut)return Se.ringOut.enclosingRing()!==le.ringOut?le.ringOut:le.ringOut.enclosingRing();le=Se.prevInResult(),Se=le?le.prevInResult():null}}};s(pt,"RingOut");let Yt=pt,Kt=class{constructor(oe){this.exteriorRing=oe,oe.poly=this,this.interiorRings=[]}addInterior(oe){this.interiorRings.push(oe),oe.poly=this}getGeom(){let oe=[this.exteriorRing.getGeom()];if(oe[0]===null)return null;for(let le=0,Se=this.interiorRings.length;le<Se;le++){let ze=this.interiorRings[le].getGeom();ze!==null&&oe.push(ze)}return oe}};s(Kt,"PolyOut");let $t=Kt,jt=class{constructor(oe){this.rings=oe,this.polys=this._composePolys(oe)}getGeom(){let oe=[];for(let le=0,Se=this.polys.length;le<Se;le++){let ze=this.polys[le].getGeom();ze!==null&&oe.push(ze)}return oe}_composePolys(oe){let le=[];for(let Se=0,ze=oe.length;Se<ze;Se++){let De=oe[Se];if(!De.poly)if(De.isExteriorRing())le.push(new $t(De));else{let yt=De.enclosingRing();yt.poly||le.push(new $t(yt)),yt.poly.addInterior(De)}}return le}};s(jt,"MultiPolyOut");let Nt=jt,Fe=class{constructor(oe){let le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dt.compare;this.queue=oe,this.tree=new p(le),this.segments=[]}process(oe){let le=oe.segment,Se=[];if(oe.consumedBy)return oe.isLeft?this.queue.remove(oe.otherSE):this.tree.remove(le),Se;let ze=oe.isLeft?this.tree.add(le):this.tree.find(le);if(!ze)throw new Error("Unable to find segment #".concat(le.id," ")+"[".concat(le.leftSE.point.x,", ").concat(le.leftSE.point.y,"] -> ")+"[".concat(le.rightSE.point.x,", ").concat(le.rightSE.point.y,"] ")+"in SweepLine tree.");let De=ze,yt=ze,st,kt;for(;st===void 0;)De=this.tree.prev(De),De===null?st=null:De.key.consumedBy===void 0&&(st=De.key);for(;kt===void 0;)yt=this.tree.next(yt),yt===null?kt=null:yt.key.consumedBy===void 0&&(kt=yt.key);if(oe.isLeft){let mt=null;if(st){let ke=st.getIntersection(le);if(ke!==null&&(le.isAnEndpoint(ke)||(mt=ke),!st.isAnEndpoint(ke))){let $e=this._splitSafely(st,ke);for(let ot=0,Ft=$e.length;ot<Ft;ot++)Se.push($e[ot])}}let Gt=null;if(kt){let ke=kt.getIntersection(le);if(ke!==null&&(le.isAnEndpoint(ke)||(Gt=ke),!kt.isAnEndpoint(ke))){let $e=this._splitSafely(kt,ke);for(let ot=0,Ft=$e.length;ot<Ft;ot++)Se.push($e[ot])}}if(mt!==null||Gt!==null){let ke=null;mt===null?ke=Gt:Gt===null?ke=mt:ke=We.comparePoints(mt,Gt)<=0?mt:Gt,this.queue.remove(le.rightSE),Se.push(le.rightSE);let $e=le.split(ke);for(let ot=0,Ft=$e.length;ot<Ft;ot++)Se.push($e[ot])}Se.length>0?(this.tree.remove(le),Se.push(oe)):(this.segments.push(le),le.prev=st)}else{if(st&&kt){let mt=st.getIntersection(kt);if(mt!==null){if(!st.isAnEndpoint(mt)){let Gt=this._splitSafely(st,mt);for(let ke=0,$e=Gt.length;ke<$e;ke++)Se.push(Gt[ke])}if(!kt.isAnEndpoint(mt)){let Gt=this._splitSafely(kt,mt);for(let ke=0,$e=Gt.length;ke<$e;ke++)Se.push(Gt[ke])}}}this.tree.remove(le)}return Se}_splitSafely(oe,le){this.tree.remove(oe);let Se=oe.rightSE;this.queue.remove(Se);let ze=oe.split(le);return ze.push(Se),oe.consumedBy===void 0&&this.tree.add(oe),ze}};s(Fe,"SweepLine");let Xe=Fe,ht=typeof ja<"u"&&ja.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,rr=typeof ja<"u"&&ja.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ar=class{run(oe,le,Se){Qe.type=oe,z.reset();let ze=[new Et(le,!0)];for(let Gt=0,ke=Se.length;Gt<ke;Gt++)ze.push(new Et(Se[Gt],!1));if(Qe.numMultiPolys=ze.length,Qe.type==="difference"){let Gt=ze[0],ke=1;for(;ke<ze.length;)P(ze[ke].bbox,Gt.bbox)!==null?ke++:ze.splice(ke,1)}if(Qe.type==="intersection")for(let Gt=0,ke=ze.length;Gt<ke;Gt++){let $e=ze[Gt];for(let ot=Gt+1,Ft=ze.length;ot<Ft;ot++)if(P($e.bbox,ze[ot].bbox)===null)return[]}let De=new p(We.compare);for(let Gt=0,ke=ze.length;Gt<ke;Gt++){let $e=ze[Gt].getSweepEvents();for(let ot=0,Ft=$e.length;ot<Ft;ot++)if(De.insert($e[ot]),De.size>ht)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}let yt=new Xe(De),st=De.size,kt=De.pop();for(;kt;){let Gt=kt.key;if(De.size===st){let $e=Gt.segment;throw new Error("Unable to pop() ".concat(Gt.isLeft?"left":"right"," SweepEvent ")+"[".concat(Gt.point.x,", ").concat(Gt.point.y,"] from segment #").concat($e.id," ")+"[".concat($e.leftSE.point.x,", ").concat($e.leftSE.point.y,"] -> ")+"[".concat($e.rightSE.point.x,", ").concat($e.rightSE.point.y,"] from queue."))}if(De.size>ht)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(yt.segments.length>rr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");let ke=yt.process(Gt);for(let $e=0,ot=ke.length;$e<ot;$e++){let Ft=ke[$e];Ft.consumedBy===void 0&&De.insert(Ft)}st=De.size,kt=De.pop()}z.reset();let mt=Yt.factory(yt.segments);return new Nt(mt).getGeom()}};s(ar,"Operation");let zr=ar,Qe=new zr;var er={union:s(function(Oe){for(var oe=arguments.length,le=new Array(oe>1?oe-1:0),Se=1;Se<oe;Se++)le[Se-1]=arguments[Se];return Qe.run("union",Oe,le)},"union"),intersection:s(function(Oe){for(var oe=arguments.length,le=new Array(oe>1?oe-1:0),Se=1;Se<oe;Se++)le[Se-1]=arguments[Se];return Qe.run("intersection",Oe,le)},"intersection"),xor:s(function(Oe){for(var oe=arguments.length,le=new Array(oe>1?oe-1:0),Se=1;Se<oe;Se++)le[Se-1]=arguments[Se];return Qe.run("xor",Oe,le)},"xor"),difference:s(function(Oe){for(var oe=arguments.length,le=new Array(oe>1?oe-1:0),Se=1;Se<oe;Se++)le[Se-1]=arguments[Se];return Qe.run("difference",Oe,le)},"difference")};return er})}),fqe=bt((t,e)=>{N(),function(r,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i(r.jsts={})}(t,function(r){function i(){}s(i,"e");function n(h){this.message=h||""}s(n,"n");function a(h){this.message=h||""}s(a,"i");function o(h){this.message=h||""}s(o,"r");function l(){}s(l,"o");function u(h){return h===null?ot:h.color}s(u,"s");function c(h){return h===null?null:h.parent}s(c,"a");function p(h,f){h!==null&&(h.color=f)}s(p,"u");function m(h){return h===null?null:h.left}s(m,"l");function y(h){return h===null?null:h.right}s(y,"c");function v(){this.root_=null,this.size_=0}s(v,"p");function x(){}s(x,"h");function E(){this.array_=[],arguments[0]instanceof er&&this.addAll(arguments[0])}s(E,"f");function M(){}s(M,"g");function I(h){this.message=h||""}s(I,"d");function P(){this.array_=[]}s(P,"y"),"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:s(function(h){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var f=Object(this),_=Math.max(Math.min(f.length,9007199254740991),0)||0,A=1 in arguments&&parseInt(Number(arguments[1]),10)||0;A=A<0?Math.max(_+A,0):Math.min(A,_);var R=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:_;for(R=R<0?Math.max(_+arguments[2],0):Math.min(R,_);A<R;)f[A]=h,++A;return f},"value"),writable:!0}),Number.isFinite=Number.isFinite||function(h){return typeof h=="number"&&isFinite(h)},Number.isInteger=Number.isInteger||function(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(h){return h!=h},Math.trunc=Math.trunc||function(h){return h<0?Math.ceil(h):Math.floor(h)};var C=s(function(){},"_");C.prototype.interfaces_=function(){return[]},C.prototype.getClass=function(){return C},C.prototype.equalsWithTolerance=function(h,f,_){return Math.abs(h-f)<=_};var T=function(h){function f(_){h.call(this,_),this.name="IllegalArgumentException",this.message=_,this.stack=new h().stack}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f}(Error),D=s(function(){},"v"),F={MAX_VALUE:{configurable:!0}};D.isNaN=function(h){return Number.isNaN(h)},D.doubleToLongBits=function(h){return h},D.longBitsToDouble=function(h){return h},D.isInfinite=function(h){return!Number.isFinite(h)},F.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(D,F);var k=s(function(){},"E"),B=s(function(){},"x"),U=s(function(){},"N"),z=s(function h(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=h.NULL_ORDINATE;else if(arguments.length===1){var f=arguments[0];this.x=f.x,this.y=f.y,this.z=f.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=h.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},"t"),q={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};z.prototype.setOrdinate=function(h,f){switch(h){case z.X:this.x=f;break;case z.Y:this.y=f;break;case z.Z:this.z=f;break;default:throw new T("Invalid ordinate index: "+h)}},z.prototype.equals2D=function(){if(arguments.length===1){var h=arguments[0];return this.x===h.x&&this.y===h.y}if(arguments.length===2){var f=arguments[0],_=arguments[1];return!!C.equalsWithTolerance(this.x,f.x,_)&&!!C.equalsWithTolerance(this.y,f.y,_)}},z.prototype.getOrdinate=function(h){switch(h){case z.X:return this.x;case z.Y:return this.y;case z.Z:return this.z}throw new T("Invalid ordinate index: "+h)},z.prototype.equals3D=function(h){return this.x===h.x&&this.y===h.y&&(this.z===h.z||D.isNaN(this.z))&&D.isNaN(h.z)},z.prototype.equals=function(h){return h instanceof z&&this.equals2D(h)},z.prototype.equalInZ=function(h,f){return C.equalsWithTolerance(this.z,h.z,f)},z.prototype.compareTo=function(h){var f=h;return this.x<f.x?-1:this.x>f.x?1:this.y<f.y?-1:this.y>f.y?1:0},z.prototype.clone=function(){},z.prototype.copy=function(){return new z(this)},z.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},z.prototype.distance3D=function(h){var f=this.x-h.x,_=this.y-h.y,A=this.z-h.z;return Math.sqrt(f*f+_*_+A*A)},z.prototype.distance=function(h){var f=this.x-h.x,_=this.y-h.y;return Math.sqrt(f*f+_*_)},z.prototype.hashCode=function(){var h=17;return h=37*h+z.hashCode(this.x),h=37*h+z.hashCode(this.y)},z.prototype.setCoordinate=function(h){this.x=h.x,this.y=h.y,this.z=h.z},z.prototype.interfaces_=function(){return[k,B,i]},z.prototype.getClass=function(){return z},z.hashCode=function(){if(arguments.length===1){var h=arguments[0],f=D.doubleToLongBits(h);return Math.trunc((f^f)>>>32)}},q.DimensionalComparator.get=function(){return Z},q.serialVersionUID.get=function(){return 6683108902428367e3},q.NULL_ORDINATE.get=function(){return D.NaN},q.X.get=function(){return 0},q.Y.get=function(){return 1},q.Z.get=function(){return 2},Object.defineProperties(z,q);var Z=s(function(h){if(this._dimensionsToTest=2,arguments.length!==0&&arguments.length===1){var f=arguments[0];if(f!==2&&f!==3)throw new T("only 2 or 3 dimensions may be specified");this._dimensionsToTest=f}},"L");Z.prototype.compare=function(h,f){var _=h,A=f,R=Z.compare(_.x,A.x);if(R!==0)return R;var H=Z.compare(_.y,A.y);return H!==0?H:this._dimensionsToTest<=2?0:Z.compare(_.z,A.z)},Z.prototype.interfaces_=function(){return[U]},Z.prototype.getClass=function(){return Z},Z.compare=function(h,f){return h<f?-1:h>f?1:D.isNaN(h)?D.isNaN(f)?0:-1:D.isNaN(f)?1:0};var Q=s(function(){},"b");Q.prototype.create=function(){},Q.prototype.interfaces_=function(){return[]},Q.prototype.getClass=function(){return Q};var V=s(function(){},"w"),ae={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};V.prototype.interfaces_=function(){return[]},V.prototype.getClass=function(){return V},V.toLocationSymbol=function(h){switch(h){case V.EXTERIOR:return"e";case V.BOUNDARY:return"b";case V.INTERIOR:return"i";case V.NONE:return"-"}throw new T("Unknown location value: "+h)},ae.INTERIOR.get=function(){return 0},ae.BOUNDARY.get=function(){return 1},ae.EXTERIOR.get=function(){return 2},ae.NONE.get=function(){return-1},Object.defineProperties(V,ae);var Y=s(function(h,f){return h.interfaces_&&h.interfaces_().indexOf(f)>-1},"T"),he=s(function(){},"R"),J={LOG_10:{configurable:!0}};he.prototype.interfaces_=function(){return[]},he.prototype.getClass=function(){return he},he.log10=function(h){var f=Math.log(h);return D.isInfinite(f)||D.isNaN(f)?f:f/he.LOG_10},he.min=function(h,f,_,A){var R=h;return f<R&&(R=f),_<R&&(R=_),A<R&&(R=A),R},he.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var h=arguments[0],f=arguments[1],_=arguments[2];return h<f?f:h>_?_:h}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var A=arguments[0],R=arguments[1],H=arguments[2];return A<R?R:A>H?H:A}},he.wrap=function(h,f){return h<0?f- -h%f:h%f},he.max=function(){if(arguments.length===3){var h=arguments[0],f=arguments[1],_=arguments[2],A=h;return f>A&&(A=f),_>A&&(A=_),A}if(arguments.length===4){var R=arguments[0],H=arguments[1],te=arguments[2],ge=arguments[3],Ne=R;return H>Ne&&(Ne=H),te>Ne&&(Ne=te),ge>Ne&&(Ne=ge),Ne}},he.average=function(h,f){return(h+f)/2},J.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(he,J);var ne=s(function(h){this.str=h},"D");ne.prototype.append=function(h){this.str+=h},ne.prototype.setCharAt=function(h,f){this.str=this.str.substr(0,h)+f+this.str.substr(h+1)},ne.prototype.toString=function(h){return this.str};var ee=s(function(h){this.value=h},"M");ee.prototype.intValue=function(){return this.value},ee.prototype.compareTo=function(h){return this.value<h?-1:this.value>h?1:0},ee.isNaN=function(h){return Number.isNaN(h)};var ue=s(function(){},"A");ue.isWhitespace=function(h){return h<=32&&h>=0||h===127},ue.toUpperCase=function(h){return h.toUpperCase()};var K=s(function h(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var f=arguments[0];this.init(f)}else if(arguments[0]instanceof h){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var A=arguments[0];h.call(this,h.parse(A))}}else if(arguments.length===2){var R=arguments[0],H=arguments[1];this.init(R,H)}},"t"),ce={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};K.prototype.le=function(h){return(this._hi<h._hi||this._hi===h._hi)&&this._lo<=h._lo},K.prototype.extractSignificantDigits=function(h,f){var _=this.abs(),A=K.magnitude(_._hi),R=K.TEN.pow(A);(_=_.divide(R)).gt(K.TEN)?(_=_.divide(K.TEN),A+=1):_.lt(K.ONE)&&(_=_.multiply(K.TEN),A-=1);for(var H=A+1,te=new ne,ge=K.MAX_PRINT_DIGITS-1,Ne=0;Ne<=ge;Ne++){h&&Ne===H&&te.append(".");var Ye=Math.trunc(_._hi);if(Ye<0)break;var Mt=!1,At=0;Ye>9?(Mt=!0,At="9"):At="0"+Ye,te.append(At),_=_.subtract(K.valueOf(Ye)).multiply(K.TEN),Mt&&_.selfAdd(K.TEN);var hr=!0,gr=K.magnitude(_._hi);if(gr<0&&Math.abs(gr)>=ge-Ne&&(hr=!1),!hr)break}return f[0]=A,te.toString()},K.prototype.sqr=function(){return this.multiply(this)},K.prototype.doubleValue=function(){return this._hi+this._lo},K.prototype.subtract=function(){if(arguments[0]instanceof K){var h=arguments[0];return this.add(h.negate())}if(typeof arguments[0]=="number"){var f=arguments[0];return this.add(-f)}},K.prototype.equals=function(){if(arguments.length===1){var h=arguments[0];return this._hi===h._hi&&this._lo===h._lo}},K.prototype.isZero=function(){return this._hi===0&&this._lo===0},K.prototype.selfSubtract=function(){if(arguments[0]instanceof K){var h=arguments[0];return this.isNaN()?this:this.selfAdd(-h._hi,-h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0];return this.isNaN()?this:this.selfAdd(-f,0)}},K.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},K.prototype.min=function(h){return this.le(h)?this:h},K.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof K){var h=arguments[0];return this.selfDivide(h._hi,h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0];return this.selfDivide(f,0)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1],R=null,H=null,te=null,ge=null,Ne=null,Ye=null,Mt=null,At=null;return Ne=this._hi/_,Ye=K.SPLIT*Ne,R=Ye-Ne,At=K.SPLIT*_,R=Ye-R,H=Ne-R,te=At-_,Mt=Ne*_,te=At-te,ge=_-te,At=R*te-Mt+R*ge+H*te+H*ge,Ye=(this._hi-Mt-At+this._lo-Ne*A)/_,At=Ne+Ye,this._hi=At,this._lo=Ne-At+Ye,this}},K.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},K.prototype.divide=function(){if(arguments[0]instanceof K){var h=arguments[0],f=null,_=null,A=null,R=null,H=null,te=null,ge=null,Ne=null;return _=(H=this._hi/h._hi)-(f=(te=K.SPLIT*H)-(f=te-H)),Ne=f*(A=(Ne=K.SPLIT*h._hi)-(A=Ne-h._hi))-(ge=H*h._hi)+f*(R=h._hi-A)+_*A+_*R,te=(this._hi-ge-Ne+this._lo-H*h._lo)/h._hi,new K(Ne=H+te,H-Ne+te)}if(typeof arguments[0]=="number"){var Ye=arguments[0];return D.isNaN(Ye)?K.createNaN():K.copy(this).selfDivide(Ye,0)}},K.prototype.ge=function(h){return(this._hi>h._hi||this._hi===h._hi)&&this._lo>=h._lo},K.prototype.pow=function(h){if(h===0)return K.valueOf(1);var f=new K(this),_=K.valueOf(1),A=Math.abs(h);if(A>1)for(;A>0;)A%2==1&&_.selfMultiply(f),(A/=2)>0&&(f=f.sqr());else _=f;return h<0?_.reciprocal():_},K.prototype.ceil=function(){if(this.isNaN())return K.NaN;var h=Math.ceil(this._hi),f=0;return h===this._hi&&(f=Math.ceil(this._lo)),new K(h,f)},K.prototype.compareTo=function(h){var f=h;return this._hi<f._hi?-1:this._hi>f._hi?1:this._lo<f._lo?-1:this._lo>f._lo?1:0},K.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},K.prototype.setValue=function(){if(arguments[0]instanceof K){var h=arguments[0];return this.init(h),this}if(typeof arguments[0]=="number"){var f=arguments[0];return this.init(f),this}},K.prototype.max=function(h){return this.ge(h)?this:h},K.prototype.sqrt=function(){if(this.isZero())return K.valueOf(0);if(this.isNegative())return K.NaN;var h=1/Math.sqrt(this._hi),f=this._hi*h,_=K.valueOf(f),A=this.subtract(_.sqr())._hi*(.5*h);return _.add(A)},K.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof K){var h=arguments[0];return this.selfAdd(h._hi,h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0],_=null,A=null,R=null,H=null,te=null,ge=null;return R=this._hi+f,te=R-this._hi,H=R-te,H=f-te+(this._hi-H),ge=H+this._lo,_=R+ge,A=ge+(R-_),this._hi=_+A,this._lo=A+(_-this._hi),this}}else if(arguments.length===2){var Ne=arguments[0],Ye=arguments[1],Mt=null,At=null,hr=null,gr=null,Sr=null,Kr=null,Vi=null;gr=this._hi+Ne,At=this._lo+Ye,Sr=gr-(Kr=gr-this._hi),hr=At-(Vi=At-this._lo);var jn=(Mt=gr+(Kr=(Sr=Ne-Kr+(this._hi-Sr))+At))+(Kr=(hr=Ye-Vi+(this._lo-hr))+(Kr+(gr-Mt))),ts=Kr+(Mt-jn);return this._hi=jn,this._lo=ts,this}},K.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof K){var h=arguments[0];return this.selfMultiply(h._hi,h._lo)}if(typeof arguments[0]=="number"){var f=arguments[0];return this.selfMultiply(f,0)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1],R=null,H=null,te=null,ge=null,Ne=null,Ye=null;R=(Ne=K.SPLIT*this._hi)-this._hi,Ye=K.SPLIT*_,R=Ne-R,H=this._hi-R,te=Ye-_;var Mt=(Ne=this._hi*_)+(Ye=R*(te=Ye-te)-Ne+R*(ge=_-te)+H*te+H*ge+(this._hi*A+this._lo*_)),At=Ye+(R=Ne-Mt);return this._hi=Mt,this._lo=At,this}},K.prototype.selfSqr=function(){return this.selfMultiply(this)},K.prototype.floor=function(){if(this.isNaN())return K.NaN;var h=Math.floor(this._hi),f=0;return h===this._hi&&(f=Math.floor(this._lo)),new K(h,f)},K.prototype.negate=function(){return this.isNaN()?this:new K(-this._hi,-this._lo)},K.prototype.clone=function(){},K.prototype.multiply=function(){if(arguments[0]instanceof K){var h=arguments[0];return h.isNaN()?K.createNaN():K.copy(this).selfMultiply(h)}if(typeof arguments[0]=="number"){var f=arguments[0];return D.isNaN(f)?K.createNaN():K.copy(this).selfMultiply(f,0)}},K.prototype.isNaN=function(){return D.isNaN(this._hi)},K.prototype.intValue=function(){return Math.trunc(this._hi)},K.prototype.toString=function(){var h=K.magnitude(this._hi);return h>=-3&&h<=20?this.toStandardNotation():this.toSciNotation()},K.prototype.toStandardNotation=function(){var h=this.getSpecialNumberString();if(h!==null)return h;var f=new Array(1).fill(null),_=this.extractSignificantDigits(!0,f),A=f[0]+1,R=_;if(_.charAt(0)===".")R="0"+_;else if(A<0)R="0."+K.stringOfChar("0",-A)+_;else if(_.indexOf(".")===-1){var H=A-_.length;R=_+K.stringOfChar("0",H)+".0"}return this.isNegative()?"-"+R:R},K.prototype.reciprocal=function(){var h=null,f=null,_=null,A=null,R=null,H=null,te=null,ge=null;f=(R=1/this._hi)-(h=(H=K.SPLIT*R)-(h=H-R)),_=(ge=K.SPLIT*this._hi)-this._hi;var Ne=R+(H=(1-(te=R*this._hi)-(ge=h*(_=ge-_)-te+h*(A=this._hi-_)+f*_+f*A)-R*this._lo)/this._hi);return new K(Ne,R-Ne+H)},K.prototype.toSciNotation=function(){if(this.isZero())return K.SCI_NOT_ZERO;var h=this.getSpecialNumberString();if(h!==null)return h;var f=new Array(1).fill(null),_=this.extractSignificantDigits(!1,f),A=K.SCI_NOT_EXPONENT_CHAR+f[0];if(_.charAt(0)==="0")throw new Error("Found leading zero: "+_);var R="";_.length>1&&(R=_.substring(1));var H=_.charAt(0)+"."+R;return this.isNegative()?"-"+H+A:H+A},K.prototype.abs=function(){return this.isNaN()?K.NaN:this.isNegative()?this.negate():new K(this)},K.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0},K.prototype.lt=function(h){return(this._hi<h._hi||this._hi===h._hi)&&this._lo<h._lo},K.prototype.add=function(){if(arguments[0]instanceof K){var h=arguments[0];return K.copy(this).selfAdd(h)}if(typeof arguments[0]=="number"){var f=arguments[0];return K.copy(this).selfAdd(f)}},K.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var h=arguments[0];this._hi=h,this._lo=0}else if(arguments[0]instanceof K){var f=arguments[0];this._hi=f._hi,this._lo=f._lo}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this._hi=_,this._lo=A}},K.prototype.gt=function(h){return(this._hi>h._hi||this._hi===h._hi)&&this._lo>h._lo},K.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0},K.prototype.trunc=function(){return this.isNaN()?K.NaN:this.isPositive()?this.floor():this.ceil()},K.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},K.prototype.interfaces_=function(){return[i,k,B]},K.prototype.getClass=function(){return K},K.sqr=function(h){return K.valueOf(h).selfMultiply(h)},K.valueOf=function(){if(typeof arguments[0]=="string"){var h=arguments[0];return K.parse(h)}if(typeof arguments[0]=="number"){var f=arguments[0];return new K(f)}},K.sqrt=function(h){return K.valueOf(h).sqrt()},K.parse=function(h){for(var f=0,_=h.length;ue.isWhitespace(h.charAt(f));)f++;var A=!1;if(f<_){var R=h.charAt(f);R!=="-"&&R!=="+"||(f++,R==="-"&&(A=!0))}for(var H=new K,te=0,ge=0,Ne=0;!(f>=_);){var Ye=h.charAt(f);if(f++,ue.isDigit(Ye)){var Mt=Ye-"0";H.selfMultiply(K.TEN),H.selfAdd(Mt),te++}else{if(Ye!=="."){if(Ye==="e"||Ye==="E"){var At=h.substring(f);try{Ne=ee.parseInt(At)}catch(Vi){throw Vi instanceof Error?new Error("Invalid exponent "+At+" in string "+h):Vi}break}throw new Error("Unexpected character '"+Ye+"' at position "+f+" in string "+h)}ge=te}}var hr=H,gr=te-ge-Ne;if(gr===0)hr=H;else if(gr>0){var Sr=K.TEN.pow(gr);hr=H.divide(Sr)}else if(gr<0){var Kr=K.TEN.pow(-gr);hr=H.multiply(Kr)}return A?hr.negate():hr},K.createNaN=function(){return new K(D.NaN,D.NaN)},K.copy=function(h){return new K(h)},K.magnitude=function(h){var f=Math.abs(h),_=Math.log(f)/Math.log(10),A=Math.trunc(Math.floor(_));return 10*Math.pow(10,A)<=f&&(A+=1),A},K.stringOfChar=function(h,f){for(var _=new ne,A=0;A<f;A++)_.append(h);return _.toString()},ce.PI.get=function(){return new K(3.141592653589793,12246467991473532e-32)},ce.TWO_PI.get=function(){return new K(6.283185307179586,24492935982947064e-32)},ce.PI_2.get=function(){return new K(1.5707963267948966,6123233995736766e-32)},ce.E.get=function(){return new K(2.718281828459045,14456468917292502e-32)},ce.NaN.get=function(){return new K(D.NaN,D.NaN)},ce.EPS.get=function(){return 123259516440783e-46},ce.SPLIT.get=function(){return 134217729},ce.MAX_PRINT_DIGITS.get=function(){return 32},ce.TEN.get=function(){return K.valueOf(10)},ce.ONE.get=function(){return K.valueOf(1)},ce.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},ce.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(K,ce);var re=s(function(){},"q"),se={DP_SAFE_EPSILON:{configurable:!0}};re.prototype.interfaces_=function(){return[]},re.prototype.getClass=function(){return re},re.orientationIndex=function(h,f,_){var A=re.orientationIndexFilter(h,f,_);if(A<=1)return A;var R=K.valueOf(f.x).selfAdd(-h.x),H=K.valueOf(f.y).selfAdd(-h.y),te=K.valueOf(_.x).selfAdd(-f.x),ge=K.valueOf(_.y).selfAdd(-f.y);return R.selfMultiply(ge).selfSubtract(H.selfMultiply(te)).signum()},re.signOfDet2x2=function(h,f,_,A){return h.multiply(A).selfSubtract(f.multiply(_)).signum()},re.intersection=function(h,f,_,A){var R=K.valueOf(A.y).selfSubtract(_.y).selfMultiply(K.valueOf(f.x).selfSubtract(h.x)),H=K.valueOf(A.x).selfSubtract(_.x).selfMultiply(K.valueOf(f.y).selfSubtract(h.y)),te=R.subtract(H),ge=K.valueOf(A.x).selfSubtract(_.x).selfMultiply(K.valueOf(h.y).selfSubtract(_.y)),Ne=K.valueOf(A.y).selfSubtract(_.y).selfMultiply(K.valueOf(h.x).selfSubtract(_.x)),Ye=ge.subtract(Ne).selfDivide(te).doubleValue(),Mt=K.valueOf(h.x).selfAdd(K.valueOf(f.x).selfSubtract(h.x).selfMultiply(Ye)).doubleValue(),At=K.valueOf(f.x).selfSubtract(h.x).selfMultiply(K.valueOf(h.y).selfSubtract(_.y)),hr=K.valueOf(f.y).selfSubtract(h.y).selfMultiply(K.valueOf(h.x).selfSubtract(_.x)),gr=At.subtract(hr).selfDivide(te).doubleValue(),Sr=K.valueOf(_.y).selfAdd(K.valueOf(A.y).selfSubtract(_.y).selfMultiply(gr)).doubleValue();return new z(Mt,Sr)},re.orientationIndexFilter=function(h,f,_){var A=null,R=(h.x-_.x)*(f.y-_.y),H=(h.y-_.y)*(f.x-_.x),te=R-H;if(R>0){if(H<=0)return re.signum(te);A=R+H}else{if(!(R<0)||H>=0)return re.signum(te);A=-R-H}var ge=re.DP_SAFE_EPSILON*A;return te>=ge||-te>=ge?re.signum(te):2},re.signum=function(h){return h>0?1:h<0?-1:0},se.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(re,se);var de=s(function(){},"V"),we={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};we.X.get=function(){return 0},we.Y.get=function(){return 1},we.Z.get=function(){return 2},we.M.get=function(){return 3},de.prototype.setOrdinate=function(h,f,_){},de.prototype.size=function(){},de.prototype.getOrdinate=function(h,f){},de.prototype.getCoordinate=function(){},de.prototype.getCoordinateCopy=function(h){},de.prototype.getDimension=function(){},de.prototype.getX=function(h){},de.prototype.clone=function(){},de.prototype.expandEnvelope=function(h){},de.prototype.copy=function(){},de.prototype.getY=function(h){},de.prototype.toCoordinateArray=function(){},de.prototype.interfaces_=function(){return[B]},de.prototype.getClass=function(){return de},Object.defineProperties(de,we);var Le=s(function(){},"z"),fe=function(h){function f(){h.call(this,"Projective point not representable on the Cartesian plane.")}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Le),Re=s(function(){},"Y");Re.arraycopy=function(h,f,_,A,R){for(var H=0,te=f;te<f+R;te++)_[A+H]=h[te],H++},Re.getProperty=function(h){return{"line.separator":`
`}[h]};var me=s(function h(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var f=arguments[0];this.x=f.x,this.y=f.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],A=arguments[1];this.x=_,this.y=A,this.w=1}else if(arguments[0]instanceof h&&arguments[1]instanceof h){var R=arguments[0],H=arguments[1];this.x=R.y*H.w-H.y*R.w,this.y=H.x*R.w-R.x*H.w,this.w=R.x*H.y-H.x*R.y}else if(arguments[0]instanceof z&&arguments[1]instanceof z){var te=arguments[0],ge=arguments[1];this.x=te.y-ge.y,this.y=ge.x-te.x,this.w=te.x*ge.y-ge.x*te.y}}else if(arguments.length===3){var Ne=arguments[0],Ye=arguments[1],Mt=arguments[2];this.x=Ne,this.y=Ye,this.w=Mt}else if(arguments.length===4){var At=arguments[0],hr=arguments[1],gr=arguments[2],Sr=arguments[3],Kr=At.y-hr.y,Vi=hr.x-At.x,jn=At.x*hr.y-hr.x*At.y,ts=gr.y-Sr.y,mu=Sr.x-gr.x,fh=gr.x*Sr.y-Sr.x*gr.y;this.x=Vi*fh-mu*jn,this.y=ts*jn-Kr*fh,this.w=Kr*mu-ts*Vi}},"t");me.prototype.getY=function(){var h=this.y/this.w;if(D.isNaN(h)||D.isInfinite(h))throw new fe;return h},me.prototype.getX=function(){var h=this.x/this.w;if(D.isNaN(h)||D.isInfinite(h))throw new fe;return h},me.prototype.getCoordinate=function(){var h=new z;return h.x=this.getX(),h.y=this.getY(),h},me.prototype.interfaces_=function(){return[]},me.prototype.getClass=function(){return me},me.intersection=function(h,f,_,A){var R=h.y-f.y,H=f.x-h.x,te=h.x*f.y-f.x*h.y,ge=_.y-A.y,Ne=A.x-_.x,Ye=_.x*A.y-A.x*_.y,Mt=R*Ne-ge*H,At=(H*Ye-Ne*te)/Mt,hr=(ge*te-R*Ye)/Mt;if(D.isNaN(At)||D.isInfinite(At)||D.isNaN(hr)||D.isInfinite(hr))throw new fe;return new z(At,hr)};var Ae=s(function h(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof z){var f=arguments[0];this.init(f.x,f.x,f.y,f.y)}else if(arguments[0]instanceof h){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var A=arguments[0],R=arguments[1];this.init(A.x,R.x,A.y,R.y)}else if(arguments.length===4){var H=arguments[0],te=arguments[1],ge=arguments[2],Ne=arguments[3];this.init(H,te,ge,Ne)}},"t"),Ue={serialVersionUID:{configurable:!0}};Ae.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Ae.prototype.equals=function(h){if(!(h instanceof Ae))return!1;var f=h;return this.isNull()?f.isNull():this._maxx===f.getMaxX()&&this._maxy===f.getMaxY()&&this._minx===f.getMinX()&&this._miny===f.getMinY()},Ae.prototype.intersection=function(h){if(this.isNull()||h.isNull()||!this.intersects(h))return new Ae;var f=this._minx>h._minx?this._minx:h._minx,_=this._miny>h._miny?this._miny:h._miny,A=this._maxx<h._maxx?this._maxx:h._maxx,R=this._maxy<h._maxy?this._maxy:h._maxy;return new Ae(f,A,_,R)},Ae.prototype.isNull=function(){return this._maxx<this._minx},Ae.prototype.getMaxX=function(){return this._maxx},Ae.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];return this.covers(h.x,h.y)}if(arguments[0]instanceof Ae){var f=arguments[0];return!this.isNull()&&!f.isNull()&&f.getMinX()>=this._minx&&f.getMaxX()<=this._maxx&&f.getMinY()>=this._miny&&f.getMaxY()<=this._maxy}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return!this.isNull()&&_>=this._minx&&_<=this._maxx&&A>=this._miny&&A<=this._maxy}},Ae.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof Ae){var h=arguments[0];return!this.isNull()&&!h.isNull()&&!(h._minx>this._maxx||h._maxx<this._minx||h._miny>this._maxy||h._maxy<this._miny)}if(arguments[0]instanceof z){var f=arguments[0];return this.intersects(f.x,f.y)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return!this.isNull()&&!(_>this._maxx||_<this._minx||A>this._maxy||A<this._miny)}},Ae.prototype.getMinY=function(){return this._miny},Ae.prototype.getMinX=function(){return this._minx},Ae.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];this.expandToInclude(h.x,h.y)}else if(arguments[0]instanceof Ae){var f=arguments[0];if(f.isNull())return null;this.isNull()?(this._minx=f.getMinX(),this._maxx=f.getMaxX(),this._miny=f.getMinY(),this._maxy=f.getMaxY()):(f._minx<this._minx&&(this._minx=f._minx),f._maxx>this._maxx&&(this._maxx=f._maxx),f._miny<this._miny&&(this._miny=f._miny),f._maxy>this._maxy&&(this._maxy=f._maxy))}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this.isNull()?(this._minx=_,this._maxx=_,this._miny=A,this._maxy=A):(_<this._minx&&(this._minx=_),_>this._maxx&&(this._maxx=_),A<this._miny&&(this._miny=A),A>this._maxy&&(this._maxy=A))}},Ae.prototype.minExtent=function(){if(this.isNull())return 0;var h=this.getWidth(),f=this.getHeight();return h<f?h:f},Ae.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Ae.prototype.compareTo=function(h){var f=h;return this.isNull()?f.isNull()?0:-1:f.isNull()?1:this._minx<f._minx?-1:this._minx>f._minx?1:this._miny<f._miny?-1:this._miny>f._miny?1:this._maxx<f._maxx?-1:this._maxx>f._maxx?1:this._maxy<f._maxy?-1:this._maxy>f._maxy?1:0},Ae.prototype.translate=function(h,f){if(this.isNull())return null;this.init(this.getMinX()+h,this.getMaxX()+h,this.getMinY()+f,this.getMaxY()+f)},Ae.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Ae.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Ae.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Ae.prototype.maxExtent=function(){if(this.isNull())return 0;var h=this.getWidth(),f=this.getHeight();return h>f?h:f},Ae.prototype.expandBy=function(){if(arguments.length===1){var h=arguments[0];this.expandBy(h,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this.isNull())return null;this._minx-=f,this._maxx+=f,this._miny-=_,this._maxy+=_,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Ae.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof Ae){var h=arguments[0];return this.covers(h)}if(arguments[0]instanceof z){var f=arguments[0];return this.covers(f)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return this.covers(_,A)}},Ae.prototype.centre=function(){return this.isNull()?null:new z((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Ae.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];this.init(h.x,h.x,h.y,h.y)}else if(arguments[0]instanceof Ae){var f=arguments[0];this._minx=f._minx,this._maxx=f._maxx,this._miny=f._miny,this._maxy=f._maxy}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this.init(_.x,A.x,_.y,A.y)}else if(arguments.length===4){var R=arguments[0],H=arguments[1],te=arguments[2],ge=arguments[3];R<H?(this._minx=R,this._maxx=H):(this._minx=H,this._maxx=R),te<ge?(this._miny=te,this._maxy=ge):(this._miny=ge,this._maxy=te)}},Ae.prototype.getMaxY=function(){return this._maxy},Ae.prototype.distance=function(h){if(this.intersects(h))return 0;var f=0;this._maxx<h._minx?f=h._minx-this._maxx:this._minx>h._maxx&&(f=this._minx-h._maxx);var _=0;return this._maxy<h._miny?_=h._miny-this._maxy:this._miny>h._maxy&&(_=this._miny-h._maxy),f===0?_:_===0?f:Math.sqrt(f*f+_*_)},Ae.prototype.hashCode=function(){var h=17;return h=37*h+z.hashCode(this._minx),h=37*h+z.hashCode(this._maxx),h=37*h+z.hashCode(this._miny),h=37*h+z.hashCode(this._maxy)},Ae.prototype.interfaces_=function(){return[k,i]},Ae.prototype.getClass=function(){return Ae},Ae.intersects=function(){if(arguments.length===3){var h=arguments[0],f=arguments[1],_=arguments[2];return _.x>=(h.x<f.x?h.x:f.x)&&_.x<=(h.x>f.x?h.x:f.x)&&_.y>=(h.y<f.y?h.y:f.y)&&_.y<=(h.y>f.y?h.y:f.y)}if(arguments.length===4){var A=arguments[0],R=arguments[1],H=arguments[2],te=arguments[3],ge=Math.min(H.x,te.x),Ne=Math.max(H.x,te.x),Ye=Math.min(A.x,R.x),Mt=Math.max(A.x,R.x);return!(Ye>Ne)&&!(Mt<ge)&&(ge=Math.min(H.y,te.y),Ne=Math.max(H.y,te.y),Ye=Math.min(A.y,R.y),Mt=Math.max(A.y,R.y),!(Ye>Ne)&&!(Mt<ge))}},Ue.serialVersionUID.get=function(){return 5873921885273102e3},Object.defineProperties(Ae,Ue);var _e={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},lt=s(function(h){this.geometryFactory=h||new Gr},"K");lt.prototype.read=function(h){var f,_,A;h=h.replace(/[\n\r]/g," ");var R=_e.typeStr.exec(h);if(h.search("EMPTY")!==-1&&((R=_e.emptyTypeStr.exec(h))[2]=void 0),R&&(_=R[1].toLowerCase(),A=R[2],We[_]&&(f=We[_].apply(this,[A]))),f===void 0)throw new Error("Could not parse WKT "+h);return f},lt.prototype.write=function(h){return this.extractGeometry(h)},lt.prototype.extractGeometry=function(h){var f=h.getGeometryType().toLowerCase();if(!tt[f])return null;var _=f.toUpperCase();return h.isEmpty()?_+" EMPTY":_+"("+tt[f].apply(this,[h])+")"};var tt={coordinate:s(function(h){return h.x+" "+h.y},"coordinate"),point:s(function(h){return tt.coordinate.call(this,h._coordinates._coordinates[0])},"point"),multipoint:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push("("+tt.point.apply(this,[h._geometries[_]])+")");return f.join(",")},"multipoint"),linestring:s(function(h){for(var f=[],_=0,A=h._points._coordinates.length;_<A;++_)f.push(tt.coordinate.apply(this,[h._points._coordinates[_]]));return f.join(",")},"linestring"),linearring:s(function(h){for(var f=[],_=0,A=h._points._coordinates.length;_<A;++_)f.push(tt.coordinate.apply(this,[h._points._coordinates[_]]));return f.join(",")},"linearring"),multilinestring:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push("("+tt.linestring.apply(this,[h._geometries[_]])+")");return f.join(",")},"multilinestring"),polygon:s(function(h){var f=[];f.push("("+tt.linestring.apply(this,[h._shell])+")");for(var _=0,A=h._holes.length;_<A;++_)f.push("("+tt.linestring.apply(this,[h._holes[_]])+")");return f.join(",")},"polygon"),multipolygon:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push("("+tt.polygon.apply(this,[h._geometries[_]])+")");return f.join(",")},"multipolygon"),geometrycollection:s(function(h){for(var f=[],_=0,A=h._geometries.length;_<A;++_)f.push(this.extractGeometry(h._geometries[_]));return f.join(",")},"geometrycollection")},We={point:s(function(h){if(h===void 0)return this.geometryFactory.createPoint();var f=h.trim().split(_e.spaces);return this.geometryFactory.createPoint(new z(Number.parseFloat(f[0]),Number.parseFloat(f[1])))},"point"),multipoint:s(function(h){if(h===void 0)return this.geometryFactory.createMultiPoint();for(var f,_=h.trim().split(","),A=[],R=0,H=_.length;R<H;++R)f=_[R].replace(_e.trimParens,"$1"),A.push(We.point.apply(this,[f]));return this.geometryFactory.createMultiPoint(A)},"multipoint"),linestring:s(function(h){if(h===void 0)return this.geometryFactory.createLineString();for(var f,_=h.trim().split(","),A=[],R=0,H=_.length;R<H;++R)f=_[R].trim().split(_e.spaces),A.push(new z(Number.parseFloat(f[0]),Number.parseFloat(f[1])));return this.geometryFactory.createLineString(A)},"linestring"),linearring:s(function(h){if(h===void 0)return this.geometryFactory.createLinearRing();for(var f,_=h.trim().split(","),A=[],R=0,H=_.length;R<H;++R)f=_[R].trim().split(_e.spaces),A.push(new z(Number.parseFloat(f[0]),Number.parseFloat(f[1])));return this.geometryFactory.createLinearRing(A)},"linearring"),multilinestring:s(function(h){if(h===void 0)return this.geometryFactory.createMultiLineString();for(var f,_=h.trim().split(_e.parenComma),A=[],R=0,H=_.length;R<H;++R)f=_[R].replace(_e.trimParens,"$1"),A.push(We.linestring.apply(this,[f]));return this.geometryFactory.createMultiLineString(A)},"multilinestring"),polygon:s(function(h){if(h===void 0)return this.geometryFactory.createPolygon();for(var f,_,A,R,H=h.trim().split(_e.parenComma),te=[],ge=0,Ne=H.length;ge<Ne;++ge)f=H[ge].replace(_e.trimParens,"$1"),_=We.linestring.apply(this,[f]),A=this.geometryFactory.createLinearRing(_._points),ge===0?R=A:te.push(A);return this.geometryFactory.createPolygon(R,te)},"polygon"),multipolygon:s(function(h){if(h===void 0)return this.geometryFactory.createMultiPolygon();for(var f,_=h.trim().split(_e.doubleParenComma),A=[],R=0,H=_.length;R<H;++R)f=_[R].replace(_e.trimParens,"$1"),A.push(We.polygon.apply(this,[f]));return this.geometryFactory.createMultiPolygon(A)},"multipolygon"),geometrycollection:s(function(h){if(h===void 0)return this.geometryFactory.createGeometryCollection();for(var f=(h=h.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),_=[],A=0,R=f.length;A<R;++A)_.push(this.read(f[A]));return this.geometryFactory.createGeometryCollection(_)},"geometrycollection")},at=s(function(h){this.parser=new lt(h)},"Z");at.prototype.write=function(h){return this.parser.write(h)},at.toLineString=function(h,f){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+h.x+" "+h.y+", "+f.x+" "+f.y+" )"};var Lt=function(h){function f(_){h.call(this,_),this.name="RuntimeException",this.message=_,this.stack=new h().stack}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f}(Error),dt=function(h){function f(){if(h.call(this),arguments.length===0)h.call(this);else if(arguments.length===1){var _=arguments[0];h.call(this,_)}}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Lt),Me=s(function(){},"et");Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me},Me.shouldNeverReachHere=function(){if(arguments.length===0)Me.shouldNeverReachHere(null);else if(arguments.length===1){var h=arguments[0];throw new dt("Should never reach here"+(h!==null?": "+h:""))}},Me.isTrue=function(){var h,f;if(arguments.length===1)h=arguments[0],Me.isTrue(h,null);else if(arguments.length===2&&(h=arguments[0],f=arguments[1],!h))throw f===null?new dt:new dt(f)},Me.equals=function(){var h,f,_;if(arguments.length===2)h=arguments[0],f=arguments[1],Me.equals(h,f,null);else if(arguments.length===3&&(h=arguments[0],f=arguments[1],_=arguments[2],!f.equals(h)))throw new dt("Expected "+h+" but encountered "+f+(_!==null?": "+_:""))};var ve=s(function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new z,this._intPt[1]=new z,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},"nt"),Ze={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};ve.prototype.getIndexAlongSegment=function(h,f){return this.computeIntLineIndex(),this._intLineIndex[h][f]},ve.prototype.getTopologySummary=function(){var h=new ne;return this.isEndPoint()&&h.append(" endpoint"),this._isProper&&h.append(" proper"),this.isCollinear()&&h.append(" collinear"),h.toString()},ve.prototype.computeIntersection=function(h,f,_,A){this._inputLines[0][0]=h,this._inputLines[0][1]=f,this._inputLines[1][0]=_,this._inputLines[1][1]=A,this._result=this.computeIntersect(h,f,_,A)},ve.prototype.getIntersectionNum=function(){return this._result},ve.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var h=arguments[0];this.getEdgeDistance(h,0)>this.getEdgeDistance(h,1)?(this._intLineIndex[h][0]=0,this._intLineIndex[h][1]=1):(this._intLineIndex[h][0]=1,this._intLineIndex[h][1]=0)}},ve.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},ve.prototype.setPrecisionModel=function(h){this._precisionModel=h},ve.prototype.isInteriorIntersection=function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var h=arguments[0],f=0;f<this._result;f++)if(!this._intPt[f].equals2D(this._inputLines[h][0])&&!this._intPt[f].equals2D(this._inputLines[h][1]))return!0;return!1}},ve.prototype.getIntersection=function(h){return this._intPt[h]},ve.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},ve.prototype.hasIntersection=function(){return this._result!==ve.NO_INTERSECTION},ve.prototype.getEdgeDistance=function(h,f){return ve.computeEdgeDistance(this._intPt[f],this._inputLines[h][0],this._inputLines[h][1])},ve.prototype.isCollinear=function(){return this._result===ve.COLLINEAR_INTERSECTION},ve.prototype.toString=function(){return at.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+at.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},ve.prototype.getEndpoint=function(h,f){return this._inputLines[h][f]},ve.prototype.isIntersection=function(h){for(var f=0;f<this._result;f++)if(this._intPt[f].equals2D(h))return!0;return!1},ve.prototype.getIntersectionAlongSegment=function(h,f){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[h][f]]},ve.prototype.interfaces_=function(){return[]},ve.prototype.getClass=function(){return ve},ve.computeEdgeDistance=function(h,f,_){var A=Math.abs(_.x-f.x),R=Math.abs(_.y-f.y),H=-1;if(h.equals(f))H=0;else if(h.equals(_))H=A>R?A:R;else{var te=Math.abs(h.x-f.x),ge=Math.abs(h.y-f.y);(H=A>R?te:ge)!==0||h.equals(f)||(H=Math.max(te,ge))}return Me.isTrue(!(H===0&&!h.equals(f)),"Bad distance calculation"),H},ve.nonRobustComputeEdgeDistance=function(h,f,_){var A=h.x-f.x,R=h.y-f.y,H=Math.sqrt(A*A+R*R);return Me.isTrue(!(H===0&&!h.equals(f)),"Invalid distance calculation"),H},Ze.DONT_INTERSECT.get=function(){return 0},Ze.DO_INTERSECT.get=function(){return 1},Ze.COLLINEAR.get=function(){return 2},Ze.NO_INTERSECTION.get=function(){return 0},Ze.POINT_INTERSECTION.get=function(){return 1},Ze.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(ve,Ze);var It=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.isInSegmentEnvelopes=function(_){var A=new Ae(this._inputLines[0][0],this._inputLines[0][1]),R=new Ae(this._inputLines[1][0],this._inputLines[1][1]);return A.contains(_)&&R.contains(_)},f.prototype.computeIntersection=function(){if(arguments.length!==3)return h.prototype.computeIntersection.apply(this,arguments);var _=arguments[0],A=arguments[1],R=arguments[2];if(this._isProper=!1,Ae.intersects(A,R,_)&&pt.orientationIndex(A,R,_)===0&&pt.orientationIndex(R,A,_)===0)return this._isProper=!0,(_.equals(A)||_.equals(R))&&(this._isProper=!1),this._result=h.POINT_INTERSECTION,null;this._result=h.NO_INTERSECTION},f.prototype.normalizeToMinimum=function(_,A,R,H,te){te.x=this.smallestInAbsValue(_.x,A.x,R.x,H.x),te.y=this.smallestInAbsValue(_.y,A.y,R.y,H.y),_.x-=te.x,_.y-=te.y,A.x-=te.x,A.y-=te.y,R.x-=te.x,R.y-=te.y,H.x-=te.x,H.y-=te.y},f.prototype.safeHCoordinateIntersection=function(_,A,R,H){var te=null;try{te=me.intersection(_,A,R,H)}catch(ge){if(!(ge instanceof fe))throw ge;te=f.nearestEndpoint(_,A,R,H)}return te},f.prototype.intersection=function(_,A,R,H){var te=this.intersectionWithNormalization(_,A,R,H);return this.isInSegmentEnvelopes(te)||(te=new z(f.nearestEndpoint(_,A,R,H))),this._precisionModel!==null&&this._precisionModel.makePrecise(te),te},f.prototype.smallestInAbsValue=function(_,A,R,H){var te=_,ge=Math.abs(te);return Math.abs(A)<ge&&(te=A,ge=Math.abs(A)),Math.abs(R)<ge&&(te=R,ge=Math.abs(R)),Math.abs(H)<ge&&(te=H),te},f.prototype.checkDD=function(_,A,R,H,te){var ge=re.intersection(_,A,R,H),Ne=this.isInSegmentEnvelopes(ge);Re.out.println("DD in env = "+Ne+"  --------------------- "+ge),te.distance(ge)>1e-4&&Re.out.println("Distance = "+te.distance(ge))},f.prototype.intersectionWithNormalization=function(_,A,R,H){var te=new z(_),ge=new z(A),Ne=new z(R),Ye=new z(H),Mt=new z;this.normalizeToEnvCentre(te,ge,Ne,Ye,Mt);var At=this.safeHCoordinateIntersection(te,ge,Ne,Ye);return At.x+=Mt.x,At.y+=Mt.y,At},f.prototype.computeCollinearIntersection=function(_,A,R,H){var te=Ae.intersects(_,A,R),ge=Ae.intersects(_,A,H),Ne=Ae.intersects(R,H,_),Ye=Ae.intersects(R,H,A);return te&&ge?(this._intPt[0]=R,this._intPt[1]=H,h.COLLINEAR_INTERSECTION):Ne&&Ye?(this._intPt[0]=_,this._intPt[1]=A,h.COLLINEAR_INTERSECTION):te&&Ne?(this._intPt[0]=R,this._intPt[1]=_,!R.equals(_)||ge||Ye?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):te&&Ye?(this._intPt[0]=R,this._intPt[1]=A,!R.equals(A)||ge||Ne?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):ge&&Ne?(this._intPt[0]=H,this._intPt[1]=_,!H.equals(_)||te||Ye?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):ge&&Ye?(this._intPt[0]=H,this._intPt[1]=A,!H.equals(A)||te||Ne?h.COLLINEAR_INTERSECTION:h.POINT_INTERSECTION):h.NO_INTERSECTION},f.prototype.normalizeToEnvCentre=function(_,A,R,H,te){var ge=_.x<A.x?_.x:A.x,Ne=_.y<A.y?_.y:A.y,Ye=_.x>A.x?_.x:A.x,Mt=_.y>A.y?_.y:A.y,At=R.x<H.x?R.x:H.x,hr=R.y<H.y?R.y:H.y,gr=R.x>H.x?R.x:H.x,Sr=R.y>H.y?R.y:H.y,Kr=((ge>At?ge:At)+(Ye<gr?Ye:gr))/2,Vi=((Ne>hr?Ne:hr)+(Mt<Sr?Mt:Sr))/2;te.x=Kr,te.y=Vi,_.x-=te.x,_.y-=te.y,A.x-=te.x,A.y-=te.y,R.x-=te.x,R.y-=te.y,H.x-=te.x,H.y-=te.y},f.prototype.computeIntersect=function(_,A,R,H){if(this._isProper=!1,!Ae.intersects(_,A,R,H))return h.NO_INTERSECTION;var te=pt.orientationIndex(_,A,R),ge=pt.orientationIndex(_,A,H);if(te>0&&ge>0||te<0&&ge<0)return h.NO_INTERSECTION;var Ne=pt.orientationIndex(R,H,_),Ye=pt.orientationIndex(R,H,A);return Ne>0&&Ye>0||Ne<0&&Ye<0?h.NO_INTERSECTION:te===0&&ge===0&&Ne===0&&Ye===0?this.computeCollinearIntersection(_,A,R,H):(te===0||ge===0||Ne===0||Ye===0?(this._isProper=!1,_.equals2D(R)||_.equals2D(H)?this._intPt[0]=_:A.equals2D(R)||A.equals2D(H)?this._intPt[0]=A:te===0?this._intPt[0]=new z(R):ge===0?this._intPt[0]=new z(H):Ne===0?this._intPt[0]=new z(_):Ye===0&&(this._intPt[0]=new z(A))):(this._isProper=!0,this._intPt[0]=this.intersection(_,A,R,H)),h.POINT_INTERSECTION)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.nearestEndpoint=function(_,A,R,H){var te=_,ge=pt.distancePointLine(_,R,H),Ne=pt.distancePointLine(A,R,H);return Ne<ge&&(ge=Ne,te=A),(Ne=pt.distancePointLine(R,_,A))<ge&&(ge=Ne,te=R),(Ne=pt.distancePointLine(H,_,A))<ge&&(ge=Ne,te=H),te},f}(ve),Rt=s(function(){},"ot");Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},Rt.orientationIndex=function(h,f,_){var A=f.x-h.x,R=f.y-h.y,H=_.x-f.x,te=_.y-f.y;return Rt.signOfDet2x2(A,R,H,te)},Rt.signOfDet2x2=function(h,f,_,A){var R=null,H=null,te=null;if(R=1,h===0||A===0)return f===0||_===0?0:f>0?_>0?-R:R:_>0?R:-R;if(f===0||_===0)return A>0?h>0?R:-R:h>0?-R:R;if(f>0?A>0?f<=A||(R=-R,H=h,h=_,_=H,H=f,f=A,A=H):f<=-A?(R=-R,_=-_,A=-A):(H=h,h=-_,_=H,H=f,f=-A,A=H):A>0?-f<=A?(R=-R,h=-h,f=-f):(H=-h,h=_,_=H,H=-f,f=A,A=H):f>=A?(h=-h,f=-f,_=-_,A=-A):(R=-R,H=-h,h=-_,_=H,H=-f,f=-A,A=H),h>0){if(!(_>0)||!(h<=_))return R}else{if(_>0||!(h>=_))return-R;R=-R,h=-h,_=-_}for(;;){if(te=Math.floor(_/h),_-=te*h,(A-=te*f)<0)return-R;if(A>f)return R;if(h>_+_){if(f<A+A)return R}else{if(f>A+A)return-R;_=h-_,A=f-A,R=-R}if(A===0)return _===0?0:-R;if(_===0||(te=Math.floor(h/_),h-=te*_,(f-=te*A)<0))return R;if(f>A)return-R;if(_>h+h){if(A<f+f)return-R}else{if(A>f+f)return R;h=_-h,f=A-f,R=-R}if(f===0)return h===0?0:R;if(h===0)return-R}};var Et=s(function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var h=arguments[0];this._p=h},"st");Et.prototype.countSegment=function(h,f){if(h.x<this._p.x&&f.x<this._p.x)return null;if(this._p.x===f.x&&this._p.y===f.y)return this._isPointOnSegment=!0,null;if(h.y===this._p.y&&f.y===this._p.y){var _=h.x,A=f.x;return _>A&&(_=f.x,A=h.x),this._p.x>=_&&this._p.x<=A&&(this._isPointOnSegment=!0),null}if(h.y>this._p.y&&f.y<=this._p.y||f.y>this._p.y&&h.y<=this._p.y){var R=h.x-this._p.x,H=h.y-this._p.y,te=f.x-this._p.x,ge=f.y-this._p.y,Ne=Rt.signOfDet2x2(R,H,te,ge);if(Ne===0)return this._isPointOnSegment=!0,null;ge<H&&(Ne=-Ne),Ne>0&&this._crossingCount++}},Et.prototype.isPointInPolygon=function(){return this.getLocation()!==V.EXTERIOR},Et.prototype.getLocation=function(){return this._isPointOnSegment?V.BOUNDARY:this._crossingCount%2==1?V.INTERIOR:V.EXTERIOR},Et.prototype.isOnSegment=function(){return this._isPointOnSegment},Et.prototype.interfaces_=function(){return[]},Et.prototype.getClass=function(){return Et},Et.locatePointInRing=function(){if(arguments[0]instanceof z&&Y(arguments[1],de)){for(var h=arguments[0],f=arguments[1],_=new Et(h),A=new z,R=new z,H=1;H<f.size();H++)if(f.getCoordinate(H,A),f.getCoordinate(H-1,R),_.countSegment(A,R),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof z&&arguments[1]instanceof Array){for(var te=arguments[0],ge=arguments[1],Ne=new Et(te),Ye=1;Ye<ge.length;Ye++){var Mt=ge[Ye],At=ge[Ye-1];if(Ne.countSegment(Mt,At),Ne.isOnSegment())return Ne.getLocation()}return Ne.getLocation()}};var pt=s(function(){},"at"),Yt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt},pt.orientationIndex=function(h,f,_){return re.orientationIndex(h,f,_)},pt.signedArea=function(){if(arguments[0]instanceof Array){var h=arguments[0];if(h.length<3)return 0;for(var f=0,_=h[0].x,A=1;A<h.length-1;A++){var R=h[A].x-_,H=h[A+1].y;f+=R*(h[A-1].y-H)}return f/2}if(Y(arguments[0],de)){var te=arguments[0],ge=te.size();if(ge<3)return 0;var Ne=new z,Ye=new z,Mt=new z;te.getCoordinate(0,Ye),te.getCoordinate(1,Mt);var At=Ye.x;Mt.x-=At;for(var hr=0,gr=1;gr<ge-1;gr++)Ne.y=Ye.y,Ye.x=Mt.x,Ye.y=Mt.y,te.getCoordinate(gr+1,Mt),Mt.x-=At,hr+=Ye.x*(Ne.y-Mt.y);return hr/2}},pt.distanceLineLine=function(h,f,_,A){if(h.equals(f))return pt.distancePointLine(h,_,A);if(_.equals(A))return pt.distancePointLine(A,h,f);var R=!1;if(Ae.intersects(h,f,_,A)){var H=(f.x-h.x)*(A.y-_.y)-(f.y-h.y)*(A.x-_.x);if(H===0)R=!0;else{var te=(h.y-_.y)*(A.x-_.x)-(h.x-_.x)*(A.y-_.y),ge=((h.y-_.y)*(f.x-h.x)-(h.x-_.x)*(f.y-h.y))/H,Ne=te/H;(Ne<0||Ne>1||ge<0||ge>1)&&(R=!0)}}else R=!0;return R?he.min(pt.distancePointLine(h,_,A),pt.distancePointLine(f,_,A),pt.distancePointLine(_,h,f),pt.distancePointLine(A,h,f)):0},pt.isPointInRing=function(h,f){return pt.locatePointInRing(h,f)!==V.EXTERIOR},pt.computeLength=function(h){var f=h.size();if(f<=1)return 0;var _=0,A=new z;h.getCoordinate(0,A);for(var R=A.x,H=A.y,te=1;te<f;te++){h.getCoordinate(te,A);var ge=A.x,Ne=A.y,Ye=ge-R,Mt=Ne-H;_+=Math.sqrt(Ye*Ye+Mt*Mt),R=ge,H=Ne}return _},pt.isCCW=function(h){var f=h.length-1;if(f<3)throw new T("Ring has fewer than 4 points, so orientation cannot be determined");for(var _=h[0],A=0,R=1;R<=f;R++){var H=h[R];H.y>_.y&&(_=H,A=R)}var te=A;do(te-=1)<0&&(te=f);while(h[te].equals2D(_)&&te!==A);var ge=A;do ge=(ge+1)%f;while(h[ge].equals2D(_)&&ge!==A);var Ne=h[te],Ye=h[ge];if(Ne.equals2D(_)||Ye.equals2D(_)||Ne.equals2D(Ye))return!1;var Mt=pt.computeOrientation(Ne,_,Ye),At=!1;return At=Mt===0?Ne.x>Ye.x:Mt>0,At},pt.locatePointInRing=function(h,f){return Et.locatePointInRing(h,f)},pt.distancePointLinePerpendicular=function(h,f,_){var A=(_.x-f.x)*(_.x-f.x)+(_.y-f.y)*(_.y-f.y),R=((f.y-h.y)*(_.x-f.x)-(f.x-h.x)*(_.y-f.y))/A;return Math.abs(R)*Math.sqrt(A)},pt.computeOrientation=function(h,f,_){return pt.orientationIndex(h,f,_)},pt.distancePointLine=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];if(f.length===0)throw new T("Line array must contain at least one vertex");for(var _=h.distance(f[0]),A=0;A<f.length-1;A++){var R=pt.distancePointLine(h,f[A],f[A+1]);R<_&&(_=R)}return _}if(arguments.length===3){var H=arguments[0],te=arguments[1],ge=arguments[2];if(te.x===ge.x&&te.y===ge.y)return H.distance(te);var Ne=(ge.x-te.x)*(ge.x-te.x)+(ge.y-te.y)*(ge.y-te.y),Ye=((H.x-te.x)*(ge.x-te.x)+(H.y-te.y)*(ge.y-te.y))/Ne;if(Ye<=0)return H.distance(te);if(Ye>=1)return H.distance(ge);var Mt=((te.y-H.y)*(ge.x-te.x)-(te.x-H.x)*(ge.y-te.y))/Ne;return Math.abs(Mt)*Math.sqrt(Ne)}},pt.isOnLine=function(h,f){for(var _=new It,A=1;A<f.length;A++){var R=f[A-1],H=f[A];if(_.computeIntersection(h,R,H),_.hasIntersection())return!0}return!1},Yt.CLOCKWISE.get=function(){return-1},Yt.RIGHT.get=function(){return pt.CLOCKWISE},Yt.COUNTERCLOCKWISE.get=function(){return 1},Yt.LEFT.get=function(){return pt.COUNTERCLOCKWISE},Yt.COLLINEAR.get=function(){return 0},Yt.STRAIGHT.get=function(){return pt.COLLINEAR},Object.defineProperties(pt,Yt);var Kt=s(function(){},"lt");Kt.prototype.filter=function(h){},Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var $t=s(function(){var h=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=h,this._SRID=h.getSRID()},"ct"),jt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};$t.prototype.isGeometryCollection=function(){return this.getSortIndex()===$t.SORTINDEX_GEOMETRYCOLLECTION},$t.prototype.getFactory=function(){return this._factory},$t.prototype.getGeometryN=function(h){return this},$t.prototype.getArea=function(){return 0},$t.prototype.isRectangle=function(){return!1},$t.prototype.equals=function(){if(arguments[0]instanceof $t){var h=arguments[0];return h!==null&&this.equalsTopo(h)}if(arguments[0]instanceof Object){var f=arguments[0];if(!(f instanceof $t))return!1;var _=f;return this.equalsExact(_)}},$t.prototype.equalsExact=function(h){return this===h||this.equalsExact(h,0)},$t.prototype.geometryChanged=function(){this.apply($t.geometryChangedFilter)},$t.prototype.geometryChangedAction=function(){this._envelope=null},$t.prototype.equalsNorm=function(h){return h!==null&&this.norm().equalsExact(h.norm())},$t.prototype.getLength=function(){return 0},$t.prototype.getNumGeometries=function(){return 1},$t.prototype.compareTo=function(){if(arguments.length===1){var h=arguments[0],f=h;return this.getSortIndex()!==f.getSortIndex()?this.getSortIndex()-f.getSortIndex():this.isEmpty()&&f.isEmpty()?0:this.isEmpty()?-1:f.isEmpty()?1:this.compareToSameClass(h)}if(arguments.length===2){var _=arguments[0],A=arguments[1];return this.getSortIndex()!==_.getSortIndex()?this.getSortIndex()-_.getSortIndex():this.isEmpty()&&_.isEmpty()?0:this.isEmpty()?-1:_.isEmpty()?1:this.compareToSameClass(_,A)}},$t.prototype.getUserData=function(){return this._userData},$t.prototype.getSRID=function(){return this._SRID},$t.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},$t.prototype.checkNotGeometryCollection=function(h){if(h.getSortIndex()===$t.SORTINDEX_GEOMETRYCOLLECTION)throw new T("This method does not support GeometryCollection arguments")},$t.prototype.equal=function(h,f,_){return _===0?h.equals(f):h.distance(f)<=_},$t.prototype.norm=function(){var h=this.copy();return h.normalize(),h},$t.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},$t.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ae(this._envelope)},$t.prototype.setSRID=function(h){this._SRID=h},$t.prototype.setUserData=function(h){this._userData=h},$t.prototype.compare=function(h,f){for(var _=h.iterator(),A=f.iterator();_.hasNext()&&A.hasNext();){var R=_.next(),H=A.next(),te=R.compareTo(H);if(te!==0)return te}return _.hasNext()?1:A.hasNext()?-1:0},$t.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},$t.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===$t.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===$t.SORTINDEX_MULTIPOINT||this.getSortIndex()===$t.SORTINDEX_MULTILINESTRING||this.getSortIndex()===$t.SORTINDEX_MULTIPOLYGON},$t.prototype.interfaces_=function(){return[B,k,i]},$t.prototype.getClass=function(){return $t},$t.hasNonEmptyElements=function(h){for(var f=0;f<h.length;f++)if(!h[f].isEmpty())return!0;return!1},$t.hasNullElements=function(h){for(var f=0;f<h.length;f++)if(h[f]===null)return!0;return!1},jt.serialVersionUID.get=function(){return 8763622679187377e3},jt.SORTINDEX_POINT.get=function(){return 0},jt.SORTINDEX_MULTIPOINT.get=function(){return 1},jt.SORTINDEX_LINESTRING.get=function(){return 2},jt.SORTINDEX_LINEARRING.get=function(){return 3},jt.SORTINDEX_MULTILINESTRING.get=function(){return 4},jt.SORTINDEX_POLYGON.get=function(){return 5},jt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},jt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},jt.geometryChangedFilter.get=function(){return Nt},Object.defineProperties($t,jt);var Nt=s(function(){},"ht");Nt.interfaces_=function(){return[Kt]},Nt.filter=function(h){h.geometryChangedAction()};var Fe=s(function(){},"ft");Fe.prototype.filter=function(h){},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var Xe=s(function(){},"gt"),ht={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Xe.prototype.isInBoundary=function(h){},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe},ht.Mod2BoundaryNodeRule.get=function(){return rr},ht.EndPointBoundaryNodeRule.get=function(){return ar},ht.MultiValentEndPointBoundaryNodeRule.get=function(){return zr},ht.MonoValentEndPointBoundaryNodeRule.get=function(){return Qe},ht.MOD2_BOUNDARY_RULE.get=function(){return new rr},ht.ENDPOINT_BOUNDARY_RULE.get=function(){return new ar},ht.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new zr},ht.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Qe},ht.OGC_SFS_BOUNDARY_RULE.get=function(){return Xe.MOD2_BOUNDARY_RULE},Object.defineProperties(Xe,ht);var rr=s(function(){},"yt");rr.prototype.isInBoundary=function(h){return h%2==1},rr.prototype.interfaces_=function(){return[Xe]},rr.prototype.getClass=function(){return rr};var ar=s(function(){},"_t");ar.prototype.isInBoundary=function(h){return h>0},ar.prototype.interfaces_=function(){return[Xe]},ar.prototype.getClass=function(){return ar};var zr=s(function(){},"mt");zr.prototype.isInBoundary=function(h){return h>1},zr.prototype.interfaces_=function(){return[Xe]},zr.prototype.getClass=function(){return zr};var Qe=s(function(){},"vt");Qe.prototype.isInBoundary=function(h){return h===1},Qe.prototype.interfaces_=function(){return[Xe]},Qe.prototype.getClass=function(){return Qe};var er=s(function(){},"It");er.prototype.add=function(){},er.prototype.addAll=function(){},er.prototype.isEmpty=function(){},er.prototype.iterator=function(){},er.prototype.size=function(){},er.prototype.toArray=function(){},er.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var Oe=s(function(){},"Et");Oe.prototype.hasNext=function(){},Oe.prototype.next=function(){},Oe.prototype.remove=function(){};var oe=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.get=function(){},f.prototype.set=function(){},f.prototype.isEmpty=function(){},f}(er);(a.prototype=new Error).name="NoSuchElementException";var le=function(h){function f(){h.call(this),this.array_=[],arguments[0]instanceof er&&this.addAll(arguments[0])}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.ensureCapacity=function(){},f.prototype.interfaces_=function(){return[h,er]},f.prototype.add=function(_){return arguments.length===1?this.array_.push(_):this.array_.splice(arguments[0],arguments[1]),!0},f.prototype.clear=function(){this.array_=[]},f.prototype.addAll=function(_){for(var A=_.iterator();A.hasNext();)this.add(A.next());return!0},f.prototype.set=function(_,A){var R=this.array_[_];return this.array_[_]=A,R},f.prototype.iterator=function(){return new Se(this)},f.prototype.get=function(_){if(_<0||_>=this.size())throw new n;return this.array_[_]},f.prototype.isEmpty=function(){return this.array_.length===0},f.prototype.size=function(){return this.array_.length},f.prototype.toArray=function(){for(var _=[],A=0,R=this.array_.length;A<R;A++)_.push(this.array_[A]);return _},f.prototype.remove=function(_){for(var A=!1,R=0,H=this.array_.length;R<H;R++)if(this.array_[R]===_){this.array_.splice(R,1),A=!0;break}return A},f}(oe),Se=function(h){function f(_){h.call(this),this.arrayList_=_,this.position_=0}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new a;return this.arrayList_.get(this.position_++)},f.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},f.prototype.set=function(_){return this.arrayList_.set(this.position_-1,_)},f.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},f}(Oe),ze=function(h){function f(){if(h.call(this),arguments.length!==0){if(arguments.length===1){var A=arguments[0];this.ensureCapacity(A.length),this.add(A,!0)}else if(arguments.length===2){var R=arguments[0],H=arguments[1];this.ensureCapacity(R.length),this.add(R,H)}}}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={coordArrayType:{configurable:!0}};return _.coordArrayType.get=function(){return new Array(0).fill(null)},f.prototype.getCoordinate=function(A){return this.get(A)},f.prototype.addAll=function(){if(arguments.length===2){for(var A=arguments[0],R=arguments[1],H=!1,te=A.iterator();te.hasNext();)this.add(te.next(),R),H=!0;return H}return h.prototype.addAll.apply(this,arguments)},f.prototype.clone=function(){for(var A=h.prototype.clone.call(this),R=0;R<this.size();R++)A.add(R,this.get(R).copy());return A},f.prototype.toCoordinateArray=function(){return this.toArray(f.coordArrayType)},f.prototype.add=function(){if(arguments.length===1){var A=arguments[0];h.prototype.add.call(this,A)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var R=arguments[0],H=arguments[1];return this.add(R,H,!0),!0}if(arguments[0]instanceof z&&typeof arguments[1]=="boolean"){var te=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(te))return null;h.prototype.add.call(this,te)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ge=arguments[0],Ne=arguments[1];return this.add(ge,Ne),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Ye=arguments[0],Mt=arguments[1];if(arguments[2])for(var At=0;At<Ye.length;At++)this.add(Ye[At],Mt);else for(var hr=Ye.length-1;hr>=0;hr--)this.add(Ye[hr],Mt);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof z){var gr=arguments[0],Sr=arguments[1];if(!arguments[2]){var Kr=this.size();if(Kr>0&&(gr>0&&this.get(gr-1).equals2D(Sr)||gr<Kr&&this.get(gr).equals2D(Sr)))return null}h.prototype.add.call(this,gr,Sr)}}else if(arguments.length===4){var Vi=arguments[0],jn=arguments[1],ts=arguments[2],mu=arguments[3],fh=1;ts>mu&&(fh=-1);for(var Nv=ts;Nv!==mu;Nv+=fh)this.add(Vi[Nv],jn);return!0}},f.prototype.closeRing=function(){this.size()>0&&this.add(new z(this.get(0)),!1)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},Object.defineProperties(f,_),f}(le),De=s(function(){},"Lt"),yt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};yt.ForwardComparator.get=function(){return st},yt.BidirectionalComparator.get=function(){return kt},yt.coordArrayType.get=function(){return new Array(0).fill(null)},De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De},De.isRing=function(h){return!(h.length<4)&&!!h[0].equals2D(h[h.length-1])},De.ptNotInList=function(h,f){for(var _=0;_<h.length;_++){var A=h[_];if(De.indexOf(A,f)<0)return A}return null},De.scroll=function(h,f){var _=De.indexOf(f,h);if(_<0)return null;var A=new Array(h.length).fill(null);Re.arraycopy(h,_,A,0,h.length-_),Re.arraycopy(h,0,A,h.length-_,_),Re.arraycopy(A,0,h,0,h.length)},De.equals=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];if(h===f)return!0;if(h===null||f===null||h.length!==f.length)return!1;for(var _=0;_<h.length;_++)if(!h[_].equals(f[_]))return!1;return!0}if(arguments.length===3){var A=arguments[0],R=arguments[1],H=arguments[2];if(A===R)return!0;if(A===null||R===null||A.length!==R.length)return!1;for(var te=0;te<A.length;te++)if(H.compare(A[te],R[te])!==0)return!1;return!0}},De.intersection=function(h,f){for(var _=new ze,A=0;A<h.length;A++)f.intersects(h[A])&&_.add(h[A],!0);return _.toCoordinateArray()},De.hasRepeatedPoints=function(h){for(var f=1;f<h.length;f++)if(h[f-1].equals(h[f]))return!0;return!1},De.removeRepeatedPoints=function(h){return De.hasRepeatedPoints(h)?new ze(h,!1).toCoordinateArray():h},De.reverse=function(h){for(var f=h.length-1,_=Math.trunc(f/2),A=0;A<=_;A++){var R=h[A];h[A]=h[f-A],h[f-A]=R}},De.removeNull=function(h){for(var f=0,_=0;_<h.length;_++)h[_]!==null&&f++;var A=new Array(f).fill(null);if(f===0)return A;for(var R=0,H=0;H<h.length;H++)h[H]!==null&&(A[R++]=h[H]);return A},De.copyDeep=function(){if(arguments.length===1){for(var h=arguments[0],f=new Array(h.length).fill(null),_=0;_<h.length;_++)f[_]=new z(h[_]);return f}if(arguments.length===5)for(var A=arguments[0],R=arguments[1],H=arguments[2],te=arguments[3],ge=arguments[4],Ne=0;Ne<ge;Ne++)H[te+Ne]=new z(A[R+Ne])},De.isEqualReversed=function(h,f){for(var _=0;_<h.length;_++){var A=h[_],R=f[h.length-_-1];if(A.compareTo(R)!==0)return!1}return!0},De.envelope=function(h){for(var f=new Ae,_=0;_<h.length;_++)f.expandToInclude(h[_]);return f},De.toCoordinateArray=function(h){return h.toArray(De.coordArrayType)},De.atLeastNCoordinatesOrNothing=function(h,f){return f.length>=h?f:[]},De.indexOf=function(h,f){for(var _=0;_<f.length;_++)if(h.equals(f[_]))return _;return-1},De.increasingDirection=function(h){for(var f=0;f<Math.trunc(h.length/2);f++){var _=h.length-1-f,A=h[f].compareTo(h[_]);if(A!==0)return A}return 1},De.compare=function(h,f){for(var _=0;_<h.length&&_<f.length;){var A=h[_].compareTo(f[_]);if(A!==0)return A;_++}return _<f.length?-1:_<h.length?1:0},De.minCoordinate=function(h){for(var f=null,_=0;_<h.length;_++)(f===null||f.compareTo(h[_])>0)&&(f=h[_]);return f},De.extract=function(h,f,_){f=he.clamp(f,0,h.length);var A=(_=he.clamp(_,-1,h.length))-f+1;_<0&&(A=0),f>=h.length&&(A=0),_<f&&(A=0);var R=new Array(A).fill(null);if(A===0)return R;for(var H=0,te=f;te<=_;te++)R[H++]=h[te];return R},Object.defineProperties(De,yt);var st=s(function(){},"wt");st.prototype.compare=function(h,f){return De.compare(h,f)},st.prototype.interfaces_=function(){return[U]},st.prototype.getClass=function(){return st};var kt=s(function(){},"Ot");kt.prototype.compare=function(h,f){var _=h,A=f;if(_.length<A.length)return-1;if(_.length>A.length)return 1;if(_.length===0)return 0;var R=De.compare(_,A);return De.isEqualReversed(_,A)?0:R},kt.prototype.OLDcompare=function(h,f){var _=h,A=f;if(_.length<A.length)return-1;if(_.length>A.length)return 1;if(_.length===0)return 0;for(var R=De.increasingDirection(_),H=De.increasingDirection(A),te=R>0?0:_.length-1,ge=H>0?0:_.length-1,Ne=0;Ne<_.length;Ne++){var Ye=_[te].compareTo(A[ge]);if(Ye!==0)return Ye;te+=R,ge+=H}return 0},kt.prototype.interfaces_=function(){return[U]},kt.prototype.getClass=function(){return kt};var mt=s(function(){},"Tt");mt.prototype.get=function(){},mt.prototype.put=function(){},mt.prototype.size=function(){},mt.prototype.values=function(){},mt.prototype.entrySet=function(){};var Gt=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f}(mt);(o.prototype=new Error).name="OperationNotSupported",(l.prototype=new er).contains=function(){};var ke=function(h){function f(){h.call(this),this.array_=[],arguments[0]instanceof er&&this.addAll(arguments[0])}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.contains=function(_){for(var A=0,R=this.array_.length;A<R;A++)if(this.array_[A]===_)return!0;return!1},f.prototype.add=function(_){return!this.contains(_)&&(this.array_.push(_),!0)},f.prototype.addAll=function(_){for(var A=_.iterator();A.hasNext();)this.add(A.next());return!0},f.prototype.remove=function(_){throw new Error},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return this.array_.length===0},f.prototype.toArray=function(){for(var _=[],A=0,R=this.array_.length;A<R;A++)_.push(this.array_[A]);return _},f.prototype.iterator=function(){return new $e(this)},f}(l),$e=function(h){function f(_){h.call(this),this.hashSet_=_,this.position_=0}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new a;return this.hashSet_.array_[this.position_++]},f.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},f.prototype.remove=function(){throw new o},f}(Oe),ot=0;(v.prototype=new Gt).get=function(h){for(var f=this.root_;f!==null;){var _=h.compareTo(f.key);if(_<0)f=f.left;else{if(!(_>0))return f.value;f=f.right}}return null},v.prototype.put=function(h,f){if(this.root_===null)return this.root_={key:h,value:f,left:null,right:null,parent:null,color:ot,getValue:s(function(){return this.value},"getValue"),getKey:s(function(){return this.key},"getKey")},this.size_=1,null;var _,A,R=this.root_;do if(_=R,(A=h.compareTo(R.key))<0)R=R.left;else{if(!(A>0)){var H=R.value;return R.value=f,H}R=R.right}while(R!==null);var te={key:h,left:null,right:null,value:f,parent:_,color:ot,getValue:s(function(){return this.value},"getValue"),getKey:s(function(){return this.key},"getKey")};return A<0?_.left=te:_.right=te,this.fixAfterInsertion(te),this.size_++,null},v.prototype.fixAfterInsertion=function(h){for(h.color=1;h!=null&&h!==this.root_&&h.parent.color===1;)if(c(h)===m(c(c(h)))){var f=y(c(c(h)));u(f)===1?(p(c(h),ot),p(f,ot),p(c(c(h)),1),h=c(c(h))):(h===y(c(h))&&(h=c(h),this.rotateLeft(h)),p(c(h),ot),p(c(c(h)),1),this.rotateRight(c(c(h))))}else{var _=m(c(c(h)));u(_)===1?(p(c(h),ot),p(_,ot),p(c(c(h)),1),h=c(c(h))):(h===m(c(h))&&(h=c(h),this.rotateRight(h)),p(c(h),ot),p(c(c(h)),1),this.rotateLeft(c(c(h))))}this.root_.color=ot},v.prototype.values=function(){var h=new le,f=this.getFirstEntry();if(f!==null)for(h.add(f.value);(f=v.successor(f))!==null;)h.add(f.value);return h},v.prototype.entrySet=function(){var h=new ke,f=this.getFirstEntry();if(f!==null)for(h.add(f);(f=v.successor(f))!==null;)h.add(f);return h},v.prototype.rotateLeft=function(h){if(h!=null){var f=h.right;h.right=f.left,f.left!=null&&(f.left.parent=h),f.parent=h.parent,h.parent===null?this.root_=f:h.parent.left===h?h.parent.left=f:h.parent.right=f,f.left=h,h.parent=f}},v.prototype.rotateRight=function(h){if(h!=null){var f=h.left;h.left=f.right,f.right!=null&&(f.right.parent=h),f.parent=h.parent,h.parent===null?this.root_=f:h.parent.right===h?h.parent.right=f:h.parent.left=f,f.right=h,h.parent=f}},v.prototype.getFirstEntry=function(){var h=this.root_;if(h!=null)for(;h.left!=null;)h=h.left;return h},v.successor=function(h){if(h===null)return null;if(h.right!==null){for(var f=h.right;f.left!==null;)f=f.left;return f}for(var _=h.parent,A=h;_!==null&&A===_.right;)A=_,_=_.parent;return _},v.prototype.size=function(){return this.size_};var Ft=s(function(){},"At");Ft.prototype.interfaces_=function(){return[]},Ft.prototype.getClass=function(){return Ft},x.prototype=new l,(E.prototype=new x).contains=function(h){for(var f=0,_=this.array_.length;f<_;f++)if(this.array_[f].compareTo(h)===0)return!0;return!1},E.prototype.add=function(h){if(this.contains(h))return!1;for(var f=0,_=this.array_.length;f<_;f++)if(this.array_[f].compareTo(h)===1)return this.array_.splice(f,0,h),!0;return this.array_.push(h),!0},E.prototype.addAll=function(h){for(var f=h.iterator();f.hasNext();)this.add(f.next());return!0},E.prototype.remove=function(h){throw new o},E.prototype.size=function(){return this.array_.length},E.prototype.isEmpty=function(){return this.array_.length===0},E.prototype.toArray=function(){for(var h=[],f=0,_=this.array_.length;f<_;f++)h.push(this.array_[f]);return h},E.prototype.iterator=function(){return new Ht(this)};var Ht=s(function(h){this.treeSet_=h,this.position_=0},"Ft");Ht.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new a;return this.treeSet_.array_[this.position_++]},Ht.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ht.prototype.remove=function(){throw new o};var fr=s(function(){},"Gt");fr.sort=function(){var h,f,_,A,R=arguments[0];if(arguments.length===1)A=s(function(te,ge){return te.compareTo(ge)},"i"),R.sort(A);else if(arguments.length===2)_=arguments[1],A=s(function(te,ge){return _.compare(te,ge)},"i"),R.sort(A);else if(arguments.length===3){(f=R.slice(arguments[1],arguments[2])).sort();var H=R.slice(0,arguments[1]).concat(f,R.slice(arguments[2],R.length));for(R.splice(0,R.length),h=0;h<H.length;h++)R.push(H[h])}else if(arguments.length===4)for(f=R.slice(arguments[1],arguments[2]),_=arguments[3],A=s(function(te,ge){return _.compare(te,ge)},"i"),f.sort(A),H=R.slice(0,arguments[1]).concat(f,R.slice(arguments[2],R.length)),R.splice(0,R.length),h=0;h<H.length;h++)R.push(H[h])},fr.asList=function(h){for(var f=new le,_=0,A=h.length;_<A;_++)f.add(h[_]);return f};var nr=s(function(){},"qt"),Zr={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Zr.P.get=function(){return 0},Zr.L.get=function(){return 1},Zr.A.get=function(){return 2},Zr.FALSE.get=function(){return-1},Zr.TRUE.get=function(){return-2},Zr.DONTCARE.get=function(){return-3},Zr.SYM_FALSE.get=function(){return"F"},Zr.SYM_TRUE.get=function(){return"T"},Zr.SYM_DONTCARE.get=function(){return"*"},Zr.SYM_P.get=function(){return"0"},Zr.SYM_L.get=function(){return"1"},Zr.SYM_A.get=function(){return"2"},nr.prototype.interfaces_=function(){return[]},nr.prototype.getClass=function(){return nr},nr.toDimensionSymbol=function(h){switch(h){case nr.FALSE:return nr.SYM_FALSE;case nr.TRUE:return nr.SYM_TRUE;case nr.DONTCARE:return nr.SYM_DONTCARE;case nr.P:return nr.SYM_P;case nr.L:return nr.SYM_L;case nr.A:return nr.SYM_A}throw new T("Unknown dimension value: "+h)},nr.toDimensionValue=function(h){switch(ue.toUpperCase(h)){case nr.SYM_FALSE:return nr.FALSE;case nr.SYM_TRUE:return nr.TRUE;case nr.SYM_DONTCARE:return nr.DONTCARE;case nr.SYM_P:return nr.P;case nr.SYM_L:return nr.L;case nr.SYM_A:return nr.A}throw new T("Unknown dimension symbol: "+h)},Object.defineProperties(nr,Zr);var ni=s(function(){},"Vt");ni.prototype.filter=function(h){},ni.prototype.interfaces_=function(){return[]},ni.prototype.getClass=function(){return ni};var Yr=s(function(){},"Ut");Yr.prototype.filter=function(h,f){},Yr.prototype.isDone=function(){},Yr.prototype.isGeometryChanged=function(){},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr};var Cr=function(h){function f(A,R){if(h.call(this,R),this._geometries=A||[],h.hasNullElements(this._geometries))throw new T("geometries must not contain null elements")}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){for(var A=new Ae,R=0;R<this._geometries.length;R++)A.expandToInclude(this._geometries[R].getEnvelopeInternal());return A},f.prototype.getGeometryN=function(A){return this._geometries[A]},f.prototype.getSortIndex=function(){return h.SORTINDEX_GEOMETRYCOLLECTION},f.prototype.getCoordinates=function(){for(var A=new Array(this.getNumPoints()).fill(null),R=-1,H=0;H<this._geometries.length;H++)for(var te=this._geometries[H].getCoordinates(),ge=0;ge<te.length;ge++)A[++R]=te[ge];return A},f.prototype.getArea=function(){for(var A=0,R=0;R<this._geometries.length;R++)A+=this._geometries[R].getArea();return A},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];if(!this.isEquivalentClass(A))return!1;var H=A;if(this._geometries.length!==H._geometries.length)return!1;for(var te=0;te<this._geometries.length;te++)if(!this._geometries[te].equalsExact(H._geometries[te],R))return!1;return!0}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){for(var A=0;A<this._geometries.length;A++)this._geometries[A].normalize();fr.sort(this._geometries)},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},f.prototype.getBoundaryDimension=function(){for(var A=nr.FALSE,R=0;R<this._geometries.length;R++)A=Math.max(A,this._geometries[R].getBoundaryDimension());return A},f.prototype.getDimension=function(){for(var A=nr.FALSE,R=0;R<this._geometries.length;R++)A=Math.max(A,this._geometries[R].getDimension());return A},f.prototype.getLength=function(){for(var A=0,R=0;R<this._geometries.length;R++)A+=this._geometries[R].getLength();return A},f.prototype.getNumPoints=function(){for(var A=0,R=0;R<this._geometries.length;R++)A+=this._geometries[R].getNumPoints();return A},f.prototype.getNumGeometries=function(){return this._geometries.length},f.prototype.reverse=function(){for(var A=this._geometries.length,R=new Array(A).fill(null),H=0;H<this._geometries.length;H++)R[H]=this._geometries[H].reverse();return this.getFactory().createGeometryCollection(R)},f.prototype.compareToSameClass=function(){if(arguments.length===1){var A=arguments[0],R=new E(fr.asList(this._geometries)),H=new E(fr.asList(A._geometries));return this.compare(R,H)}if(arguments.length===2){for(var te=arguments[0],ge=arguments[1],Ne=te,Ye=this.getNumGeometries(),Mt=Ne.getNumGeometries(),At=0;At<Ye&&At<Mt;){var hr=this.getGeometryN(At),gr=Ne.getGeometryN(At),Sr=hr.compareToSameClass(gr,ge);if(Sr!==0)return Sr;At++}return At<Ye?1:At<Mt?-1:0}},f.prototype.apply=function(){if(Y(arguments[0],Fe))for(var A=arguments[0],R=0;R<this._geometries.length;R++)this._geometries[R].apply(A);else if(Y(arguments[0],Yr)){var H=arguments[0];if(this._geometries.length===0)return null;for(var te=0;te<this._geometries.length&&(this._geometries[te].apply(H),!H.isDone());te++);H.isGeometryChanged()&&this.geometryChanged()}else if(Y(arguments[0],ni)){var ge=arguments[0];ge.filter(this);for(var Ne=0;Ne<this._geometries.length;Ne++)this._geometries[Ne].apply(ge)}else if(Y(arguments[0],Kt)){var Ye=arguments[0];Ye.filter(this);for(var Mt=0;Mt<this._geometries.length;Mt++)this._geometries[Mt].apply(Ye)}},f.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Me.shouldNeverReachHere(),null},f.prototype.clone=function(){var A=h.prototype.clone.call(this);A._geometries=new Array(this._geometries.length).fill(null);for(var R=0;R<this._geometries.length;R++)A._geometries[R]=this._geometries[R].clone();return A},f.prototype.getGeometryType=function(){return"GeometryCollection"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),R=0;R<A.length;R++)A[R]=this._geometries[R].copy();return new f(A,this._factory)},f.prototype.isEmpty=function(){for(var A=0;A<this._geometries.length;A++)if(!this._geometries[A].isEmpty())return!1;return!0},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(f,_),f}($t),Mi=function(h){function f(){h.apply(this,arguments)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_MULTILINESTRING},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];return!!this.isEquivalentClass(A)&&h.prototype.equalsExact.call(this,A,R)}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return this.isClosed()?nr.FALSE:0},f.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var A=0;A<this._geometries.length;A++)if(!this._geometries[A].isClosed())return!1;return!0},f.prototype.getDimension=function(){return 1},f.prototype.reverse=function(){for(var A=this._geometries.length,R=new Array(A).fill(null),H=0;H<this._geometries.length;H++)R[A-1-H]=this._geometries[H].reverse();return this.getFactory().createMultiLineString(R)},f.prototype.getBoundary=function(){return new $r(this).getBoundary()},f.prototype.getGeometryType=function(){return"MultiLineString"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),R=0;R<A.length;R++)A[R]=this._geometries[R].copy();return new f(A,this._factory)},f.prototype.interfaces_=function(){return[Ft]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(f,_),f}(Cr),$r=s(function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var h=arguments[0],f=Xe.MOD2_BOUNDARY_RULE;this._geom=h,this._geomFact=h.getFactory(),this._bnRule=f}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this._geom=_,this._geomFact=_.getFactory(),this._bnRule=A}},"Yt");$r.prototype.boundaryMultiLineString=function(h){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var f=this.computeBoundaryCoordinates(h);return f.length===1?this._geomFact.createPoint(f[0]):this._geomFact.createMultiPointFromCoords(f)},$r.prototype.getBoundary=function(){return this._geom instanceof Je?this.boundaryLineString(this._geom):this._geom instanceof Mi?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},$r.prototype.boundaryLineString=function(h){return this._geom.isEmpty()?this.getEmptyMultiPoint():h.isClosed()?this._bnRule.isInBoundary(2)?h.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([h.getStartPoint(),h.getEndPoint()])},$r.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},$r.prototype.computeBoundaryCoordinates=function(h){var f=new le;this._endpointMap=new v;for(var _=0;_<h.getNumGeometries();_++){var A=h.getGeometryN(_);A.getNumPoints()!==0&&(this.addEndpoint(A.getCoordinateN(0)),this.addEndpoint(A.getCoordinateN(A.getNumPoints()-1)))}for(var R=this._endpointMap.entrySet().iterator();R.hasNext();){var H=R.next(),te=H.getValue().count;this._bnRule.isInBoundary(te)&&f.add(H.getKey())}return De.toCoordinateArray(f)},$r.prototype.addEndpoint=function(h){var f=this._endpointMap.get(h);f===null&&(f=new Qi,this._endpointMap.put(h,f)),f.count++},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.getBoundary=function(){if(arguments.length===1){var h=arguments[0];return new $r(h).getBoundary()}if(arguments.length===2){var f=arguments[0],_=arguments[1];return new $r(f,_).getBoundary()}};var Qi=s(function(){this.count=null},"kt");Qi.prototype.interfaces_=function(){return[]},Qi.prototype.getClass=function(){return Qi};var Gi=s(function(){},"jt"),Mn={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi},Gi.chars=function(h,f){for(var _=new Array(f).fill(null),A=0;A<f;A++)_[A]=h;return String(_)},Gi.getStackTrace=function(){if(arguments.length===1){var h=arguments[0],f=new function(){},_=new function(){};return h.printStackTrace(_),f.toString()}if(arguments.length===2){for(var A=arguments[0],R=arguments[1],H="",te=new function(){}(new function(){}(Gi.getStackTrace(A))),ge=0;ge<R;ge++)try{H+=te.readLine()+Gi.NEWLINE}catch(Ne){if(!(Ne instanceof M))throw Ne;Me.shouldNeverReachHere()}return H}},Gi.split=function(h,f){for(var _=f.length,A=new le,R=""+h,H=R.indexOf(f);H>=0;){var te=R.substring(0,H);A.add(te),H=(R=R.substring(H+_)).indexOf(f)}R.length>0&&A.add(R);for(var ge=new Array(A.size()).fill(null),Ne=0;Ne<ge.length;Ne++)ge[Ne]=A.get(Ne);return ge},Gi.toString=function(){if(arguments.length===1){var h=arguments[0];return Gi.SIMPLE_ORDINATE_FORMAT.format(h)}},Gi.spaces=function(h){return Gi.chars(" ",h)},Mn.NEWLINE.get=function(){return Re.getProperty("line.separator")},Mn.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}},Object.defineProperties(Gi,Mn);var Ie=s(function(){},"Wt");Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie},Ie.copyCoord=function(h,f,_,A){for(var R=Math.min(h.getDimension(),_.getDimension()),H=0;H<R;H++)_.setOrdinate(A,H,h.getOrdinate(f,H))},Ie.isRing=function(h){var f=h.size();return f===0||!(f<=3)&&h.getOrdinate(0,de.X)===h.getOrdinate(f-1,de.X)&&h.getOrdinate(0,de.Y)===h.getOrdinate(f-1,de.Y)},Ie.isEqual=function(h,f){var _=h.size();if(_!==f.size())return!1;for(var A=Math.min(h.getDimension(),f.getDimension()),R=0;R<_;R++)for(var H=0;H<A;H++){var te=h.getOrdinate(R,H),ge=f.getOrdinate(R,H);if(h.getOrdinate(R,H)!==f.getOrdinate(R,H)&&(!D.isNaN(te)||!D.isNaN(ge)))return!1}return!0},Ie.extend=function(h,f,_){var A=h.create(_,f.getDimension()),R=f.size();if(Ie.copy(f,0,A,0,R),R>0)for(var H=R;H<_;H++)Ie.copy(f,R-1,A,H,1);return A},Ie.reverse=function(h){for(var f=h.size()-1,_=Math.trunc(f/2),A=0;A<=_;A++)Ie.swap(h,A,f-A)},Ie.swap=function(h,f,_){if(f===_)return null;for(var A=0;A<h.getDimension();A++){var R=h.getOrdinate(f,A);h.setOrdinate(f,A,h.getOrdinate(_,A)),h.setOrdinate(_,A,R)}},Ie.copy=function(h,f,_,A,R){for(var H=0;H<R;H++)Ie.copyCoord(h,f+H,_,A+H)},Ie.toString=function(){if(arguments.length===1){var h=arguments[0],f=h.size();if(f===0)return"()";var _=h.getDimension(),A=new ne;A.append("(");for(var R=0;R<f;R++){R>0&&A.append(" ");for(var H=0;H<_;H++)H>0&&A.append(","),A.append(Gi.toString(h.getOrdinate(R,H)))}return A.append(")"),A.toString()}},Ie.ensureValidRing=function(h,f){var _=f.size();return _===0?f:_<=3?Ie.createClosedRing(h,f,4):f.getOrdinate(0,de.X)===f.getOrdinate(_-1,de.X)&&f.getOrdinate(0,de.Y)===f.getOrdinate(_-1,de.Y)?f:Ie.createClosedRing(h,f,_+1)},Ie.createClosedRing=function(h,f,_){var A=h.create(_,f.getDimension()),R=f.size();Ie.copy(f,0,A,0,R);for(var H=R;H<_;H++)Ie.copy(f,0,A,H,1);return A};var Je=function(h){function f(A,R){h.call(this,R),this._points=null,this.init(A)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Ae:this._points.expandEnvelope(new Ae)},f.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},f.prototype.getSortIndex=function(){return h.SORTINDEX_LINESTRING},f.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];if(!this.isEquivalentClass(A))return!1;var H=A;if(this._points.size()!==H._points.size())return!1;for(var te=0;te<this._points.size();te++)if(!this.equal(this._points.getCoordinate(te),H._points.getCoordinate(te),R))return!1;return!0}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){for(var A=0;A<Math.trunc(this._points.size()/2);A++){var R=this._points.size()-1-A;if(!this._points.getCoordinate(A).equals(this._points.getCoordinate(R)))return this._points.getCoordinate(A).compareTo(this._points.getCoordinate(R))>0&&Ie.reverse(this._points),null}},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},f.prototype.getBoundaryDimension=function(){return this.isClosed()?nr.FALSE:0},f.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},f.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},f.prototype.getDimension=function(){return 1},f.prototype.getLength=function(){return pt.computeLength(this._points)},f.prototype.getNumPoints=function(){return this._points.size()},f.prototype.reverse=function(){var A=this._points.copy();return Ie.reverse(A),this.getFactory().createLineString(A)},f.prototype.compareToSameClass=function(){if(arguments.length===1){for(var A=arguments[0],R=0,H=0;R<this._points.size()&&H<A._points.size();){var te=this._points.getCoordinate(R).compareTo(A._points.getCoordinate(H));if(te!==0)return te;R++,H++}return R<this._points.size()?1:H<A._points.size()?-1:0}if(arguments.length===2){var ge=arguments[0];return arguments[1].compare(this._points,ge._points)}},f.prototype.apply=function(){if(Y(arguments[0],Fe))for(var A=arguments[0],R=0;R<this._points.size();R++)A.filter(this._points.getCoordinate(R));else if(Y(arguments[0],Yr)){var H=arguments[0];if(this._points.size()===0)return null;for(var te=0;te<this._points.size()&&(H.filter(this._points,te),!H.isDone());te++);H.isGeometryChanged()&&this.geometryChanged()}else Y(arguments[0],ni)?arguments[0].filter(this):Y(arguments[0],Kt)&&arguments[0].filter(this)},f.prototype.getBoundary=function(){return new $r(this).getBoundary()},f.prototype.isEquivalentClass=function(A){return A instanceof f},f.prototype.clone=function(){var A=h.prototype.clone.call(this);return A._points=this._points.clone(),A},f.prototype.getCoordinateN=function(A){return this._points.getCoordinate(A)},f.prototype.getGeometryType=function(){return"LineString"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._points},f.prototype.isEmpty=function(){return this._points.size()===0},f.prototype.init=function(A){if(A===null&&(A=this.getFactory().getCoordinateSequenceFactory().create([])),A.size()===1)throw new T("Invalid number of points in LineString (found "+A.size()+" - must be 0 or >= 2)");this._points=A},f.prototype.isCoordinate=function(A){for(var R=0;R<this._points.size();R++)if(this._points.getCoordinate(R).equals(A))return!0;return!1},f.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},f.prototype.getPointN=function(A){return this.getFactory().createPoint(this._points.getCoordinate(A))},f.prototype.interfaces_=function(){return[Ft]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(f,_),f}($t),wt=s(function(){},"Jt");wt.prototype.interfaces_=function(){return[]},wt.prototype.getClass=function(){return wt};var ft=function(h){function f(A,R){h.call(this,R),this._coordinates=A||null,this.init(this._coordinates)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ae;var A=new Ae;return A.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),A},f.prototype.getSortIndex=function(){return h.SORTINDEX_POINT},f.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];return!!this.isEquivalentClass(A)&&(!(!this.isEmpty()||!A.isEmpty())||this.isEmpty()===A.isEmpty()&&this.equal(A.getCoordinate(),this.getCoordinate(),R))}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){},f.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},f.prototype.getBoundaryDimension=function(){return nr.FALSE},f.prototype.getDimension=function(){return 0},f.prototype.getNumPoints=function(){return this.isEmpty()?0:1},f.prototype.reverse=function(){return this.copy()},f.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},f.prototype.compareToSameClass=function(){if(arguments.length===1){var A=arguments[0];return this.getCoordinate().compareTo(A.getCoordinate())}if(arguments.length===2){var R=arguments[0];return arguments[1].compare(this._coordinates,R._coordinates)}},f.prototype.apply=function(){if(Y(arguments[0],Fe)){var A=arguments[0];if(this.isEmpty())return null;A.filter(this.getCoordinate())}else if(Y(arguments[0],Yr)){var R=arguments[0];if(this.isEmpty())return null;R.filter(this._coordinates,0),R.isGeometryChanged()&&this.geometryChanged()}else Y(arguments[0],ni)?arguments[0].filter(this):Y(arguments[0],Kt)&&arguments[0].filter(this)},f.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},f.prototype.clone=function(){var A=h.prototype.clone.call(this);return A._coordinates=this._coordinates.clone(),A},f.prototype.getGeometryType=function(){return"Point"},f.prototype.copy=function(){return new f(this._coordinates.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._coordinates},f.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},f.prototype.isEmpty=function(){return this._coordinates.size()===0},f.prototype.init=function(A){A===null&&(A=this.getFactory().getCoordinateSequenceFactory().create([])),Me.isTrue(A.size()<=1),this._coordinates=A},f.prototype.isSimple=function(){return!0},f.prototype.interfaces_=function(){return[wt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(f,_),f}($t),rt=s(function(){},"Zt");rt.prototype.interfaces_=function(){return[]},rt.prototype.getClass=function(){return rt};var zt=function(h){function f(A,R,H){if(h.call(this,H),this._shell=null,this._holes=null,A===null&&(A=this.getFactory().createLinearRing()),R===null&&(R=[]),h.hasNullElements(R))throw new T("holes must not contain null elements");if(A.isEmpty()&&h.hasNonEmptyElements(R))throw new T("shell is empty but holes are not");this._shell=A,this._holes=R}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},f.prototype.getSortIndex=function(){return h.SORTINDEX_POLYGON},f.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var A=new Array(this.getNumPoints()).fill(null),R=-1,H=this._shell.getCoordinates(),te=0;te<H.length;te++)A[++R]=H[te];for(var ge=0;ge<this._holes.length;ge++)for(var Ne=this._holes[ge].getCoordinates(),Ye=0;Ye<Ne.length;Ye++)A[++R]=Ne[Ye];return A},f.prototype.getArea=function(){var A=0;A+=Math.abs(pt.signedArea(this._shell.getCoordinateSequence()));for(var R=0;R<this._holes.length;R++)A-=Math.abs(pt.signedArea(this._holes[R].getCoordinateSequence()));return A},f.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var A=this._shell.getCoordinateSequence(),R=this.getEnvelopeInternal(),H=0;H<5;H++){var te=A.getX(H);if(te!==R.getMinX()&&te!==R.getMaxX())return!1;var ge=A.getY(H);if(ge!==R.getMinY()&&ge!==R.getMaxY())return!1}for(var Ne=A.getX(0),Ye=A.getY(0),Mt=1;Mt<=4;Mt++){var At=A.getX(Mt),hr=A.getY(Mt);if(At!==Ne==(hr!==Ye))return!1;Ne=At,Ye=hr}return!0},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];if(!this.isEquivalentClass(A))return!1;var H=A,te=this._shell,ge=H._shell;if(!te.equalsExact(ge,R)||this._holes.length!==H._holes.length)return!1;for(var Ne=0;Ne<this._holes.length;Ne++)if(!this._holes[Ne].equalsExact(H._holes[Ne],R))return!1;return!0}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){if(arguments.length===0){this.normalize(this._shell,!0);for(var A=0;A<this._holes.length;A++)this.normalize(this._holes[A],!1);fr.sort(this._holes)}else if(arguments.length===2){var R=arguments[0],H=arguments[1];if(R.isEmpty())return null;var te=new Array(R.getCoordinates().length-1).fill(null);Re.arraycopy(R.getCoordinates(),0,te,0,te.length);var ge=De.minCoordinate(R.getCoordinates());De.scroll(te,ge),Re.arraycopy(te,0,R.getCoordinates(),0,te.length),R.getCoordinates()[te.length]=te[0],pt.isCCW(R.getCoordinates())===H&&De.reverse(R.getCoordinates())}},f.prototype.getCoordinate=function(){return this._shell.getCoordinate()},f.prototype.getNumInteriorRing=function(){return this._holes.length},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.getLength=function(){var A=0;A+=this._shell.getLength();for(var R=0;R<this._holes.length;R++)A+=this._holes[R].getLength();return A},f.prototype.getNumPoints=function(){for(var A=this._shell.getNumPoints(),R=0;R<this._holes.length;R++)A+=this._holes[R].getNumPoints();return A},f.prototype.reverse=function(){var A=this.copy();A._shell=this._shell.copy().reverse(),A._holes=new Array(this._holes.length).fill(null);for(var R=0;R<this._holes.length;R++)A._holes[R]=this._holes[R].copy().reverse();return A},f.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},f.prototype.compareToSameClass=function(){if(arguments.length===1){var A=arguments[0],R=this._shell,H=A._shell;return R.compareToSameClass(H)}if(arguments.length===2){var te=arguments[0],ge=arguments[1],Ne=te,Ye=this._shell,Mt=Ne._shell,At=Ye.compareToSameClass(Mt,ge);if(At!==0)return At;for(var hr=this.getNumInteriorRing(),gr=Ne.getNumInteriorRing(),Sr=0;Sr<hr&&Sr<gr;){var Kr=this.getInteriorRingN(Sr),Vi=Ne.getInteriorRingN(Sr),jn=Kr.compareToSameClass(Vi,ge);if(jn!==0)return jn;Sr++}return Sr<hr?1:Sr<gr?-1:0}},f.prototype.apply=function(A){if(Y(A,Fe)){this._shell.apply(A);for(var R=0;R<this._holes.length;R++)this._holes[R].apply(A)}else if(Y(A,Yr)){if(this._shell.apply(A),!A.isDone())for(var H=0;H<this._holes.length&&(this._holes[H].apply(A),!A.isDone());H++);A.isGeometryChanged()&&this.geometryChanged()}else if(Y(A,ni))A.filter(this);else if(Y(A,Kt)){A.filter(this),this._shell.apply(A);for(var te=0;te<this._holes.length;te++)this._holes[te].apply(A)}},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var A=new Array(this._holes.length+1).fill(null);A[0]=this._shell;for(var R=0;R<this._holes.length;R++)A[R+1]=this._holes[R];return A.length<=1?this.getFactory().createLinearRing(A[0].getCoordinateSequence()):this.getFactory().createMultiLineString(A)},f.prototype.clone=function(){var A=h.prototype.clone.call(this);A._shell=this._shell.clone(),A._holes=new Array(this._holes.length).fill(null);for(var R=0;R<this._holes.length;R++)A._holes[R]=this._holes[R].clone();return A},f.prototype.getGeometryType=function(){return"Polygon"},f.prototype.copy=function(){for(var A=this._shell.copy(),R=new Array(this._holes.length).fill(null),H=0;H<R.length;H++)R[H]=this._holes[H].copy();return new f(A,R,this._factory)},f.prototype.getExteriorRing=function(){return this._shell},f.prototype.isEmpty=function(){return this._shell.isEmpty()},f.prototype.getInteriorRingN=function(A){return this._holes[A]},f.prototype.interfaces_=function(){return[rt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(f,_),f}($t),cr=function(h){function f(){h.apply(this,arguments)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_MULTIPOINT},f.prototype.isValid=function(){return!0},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];return!!this.isEquivalentClass(A)&&h.prototype.equalsExact.call(this,A,R)}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.getCoordinate=function(){if(arguments.length===1){var A=arguments[0];return this._geometries[A].getCoordinate()}return h.prototype.getCoordinate.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return nr.FALSE},f.prototype.getDimension=function(){return 0},f.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},f.prototype.getGeometryType=function(){return"MultiPoint"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),R=0;R<A.length;R++)A[R]=this._geometries[R].copy();return new f(A,this._factory)},f.prototype.interfaces_=function(){return[wt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(f,_),f}(Cr),ur=function(h){function f(A,R){A instanceof z&&R instanceof Gr&&(A=R.getCoordinateSequenceFactory().create(A)),h.call(this,A,R),this.validateConstruction()}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_LINEARRING},f.prototype.getBoundaryDimension=function(){return nr.FALSE},f.prototype.isClosed=function(){return!!this.isEmpty()||h.prototype.isClosed.call(this)},f.prototype.reverse=function(){var A=this._points.copy();return Ie.reverse(A),this.getFactory().createLinearRing(A)},f.prototype.validateConstruction=function(){if(!this.isEmpty()&&!h.prototype.isClosed.call(this))throw new T("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<f.MINIMUM_VALID_SIZE)throw new T("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},f.prototype.getGeometryType=function(){return"LinearRing"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},_.MINIMUM_VALID_SIZE.get=function(){return 4},_.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(f,_),f}(Je),Ar=function(h){function f(){h.apply(this,arguments)}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return $t.SORTINDEX_MULTIPOLYGON},f.prototype.equalsExact=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];return!!this.isEquivalentClass(A)&&h.prototype.equalsExact.call(this,A,R)}return h.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.reverse=function(){for(var A=this._geometries.length,R=new Array(A).fill(null),H=0;H<this._geometries.length;H++)R[H]=this._geometries[H].reverse();return this.getFactory().createMultiPolygon(R)},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var A=new le,R=0;R<this._geometries.length;R++)for(var H=this._geometries[R].getBoundary(),te=0;te<H.getNumGeometries();te++)A.add(H.getGeometryN(te));var ge=new Array(A.size()).fill(null);return this.getFactory().createMultiLineString(A.toArray(ge))},f.prototype.getGeometryType=function(){return"MultiPolygon"},f.prototype.copy=function(){for(var A=new Array(this._geometries.length).fill(null),R=0;R<A.length;R++)A[R]=this._geometries[R].copy();return new f(A,this._factory)},f.prototype.interfaces_=function(){return[rt]},f.prototype.getClass=function(){return f},_.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(f,_),f}(Cr),kr=s(function(h){this._factory=h||null,this._isUserDataCopied=!1},"ie"),qr={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};kr.prototype.setCopyUserData=function(h){this._isUserDataCopied=h},kr.prototype.edit=function(h,f){if(h===null)return null;var _=this.editInternal(h,f);return this._isUserDataCopied&&_.setUserData(h.getUserData()),_},kr.prototype.editInternal=function(h,f){return this._factory===null&&(this._factory=h.getFactory()),h instanceof Cr?this.editGeometryCollection(h,f):h instanceof zt?this.editPolygon(h,f):h instanceof ft?f.edit(h,this._factory):h instanceof Je?f.edit(h,this._factory):(Me.shouldNeverReachHere("Unsupported Geometry class: "+h.getClass().getName()),null)},kr.prototype.editGeometryCollection=function(h,f){for(var _=f.edit(h,this._factory),A=new le,R=0;R<_.getNumGeometries();R++){var H=this.edit(_.getGeometryN(R),f);H===null||H.isEmpty()||A.add(H)}return _.getClass()===cr?this._factory.createMultiPoint(A.toArray([])):_.getClass()===Mi?this._factory.createMultiLineString(A.toArray([])):_.getClass()===Ar?this._factory.createMultiPolygon(A.toArray([])):this._factory.createGeometryCollection(A.toArray([]))},kr.prototype.editPolygon=function(h,f){var _=f.edit(h,this._factory);if(_===null&&(_=this._factory.createPolygon(null)),_.isEmpty())return _;var A=this.edit(_.getExteriorRing(),f);if(A===null||A.isEmpty())return this._factory.createPolygon();for(var R=new le,H=0;H<_.getNumInteriorRing();H++){var te=this.edit(_.getInteriorRingN(H),f);te===null||te.isEmpty()||R.add(te)}return this._factory.createPolygon(A,R.toArray([]))},kr.prototype.interfaces_=function(){return[]},kr.prototype.getClass=function(){return kr},kr.GeometryEditorOperation=function(){},qr.NoOpGeometryOperation.get=function(){return Wr},qr.CoordinateOperation.get=function(){return vi},qr.CoordinateSequenceOperation.get=function(){return Li},Object.defineProperties(kr,qr);var Wr=s(function(){},"oe");Wr.prototype.edit=function(h,f){return h},Wr.prototype.interfaces_=function(){return[kr.GeometryEditorOperation]},Wr.prototype.getClass=function(){return Wr};var vi=s(function(){},"se");vi.prototype.edit=function(h,f){var _=this.editCoordinates(h.getCoordinates(),h);return _===null?h:h instanceof ur?f.createLinearRing(_):h instanceof Je?f.createLineString(_):h instanceof ft?_.length>0?f.createPoint(_[0]):f.createPoint():h},vi.prototype.interfaces_=function(){return[kr.GeometryEditorOperation]},vi.prototype.getClass=function(){return vi};var Li=s(function(){},"ae");Li.prototype.edit=function(h,f){return h instanceof ur?f.createLinearRing(this.edit(h.getCoordinateSequence(),h)):h instanceof Je?f.createLineString(this.edit(h.getCoordinateSequence(),h)):h instanceof ft?f.createPoint(this.edit(h.getCoordinateSequence(),h)):h},Li.prototype.interfaces_=function(){return[kr.GeometryEditorOperation]},Li.prototype.getClass=function(){return Li};var Ur=s(function(){if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var h=arguments[0];this._coordinates=new Array(h).fill(null);for(var f=0;f<h;f++)this._coordinates[f]=new z}else if(Y(arguments[0],de)){var _=arguments[0];if(_===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=_.getDimension(),this._coordinates=new Array(_.size()).fill(null);for(var A=0;A<this._coordinates.length;A++)this._coordinates[A]=_.getCoordinateCopy(A)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var R=arguments[0],H=arguments[1];this._coordinates=R,this._dimension=H,R===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var te=arguments[0],ge=arguments[1];this._coordinates=new Array(te).fill(null),this._dimension=ge;for(var Ne=0;Ne<te;Ne++)this._coordinates[Ne]=new z}}},"ue"),yi={serialVersionUID:{configurable:!0}};Ur.prototype.setOrdinate=function(h,f,_){switch(f){case de.X:this._coordinates[h].x=_;break;case de.Y:this._coordinates[h].y=_;break;case de.Z:this._coordinates[h].z=_;break;default:throw new T("invalid ordinateIndex")}},Ur.prototype.size=function(){return this._coordinates.length},Ur.prototype.getOrdinate=function(h,f){switch(f){case de.X:return this._coordinates[h].x;case de.Y:return this._coordinates[h].y;case de.Z:return this._coordinates[h].z}return D.NaN},Ur.prototype.getCoordinate=function(){if(arguments.length===1){var h=arguments[0];return this._coordinates[h]}if(arguments.length===2){var f=arguments[0],_=arguments[1];_.x=this._coordinates[f].x,_.y=this._coordinates[f].y,_.z=this._coordinates[f].z}},Ur.prototype.getCoordinateCopy=function(h){return new z(this._coordinates[h])},Ur.prototype.getDimension=function(){return this._dimension},Ur.prototype.getX=function(h){return this._coordinates[h].x},Ur.prototype.clone=function(){for(var h=new Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)h[f]=this._coordinates[f].clone();return new Ur(h,this._dimension)},Ur.prototype.expandEnvelope=function(h){for(var f=0;f<this._coordinates.length;f++)h.expandToInclude(this._coordinates[f]);return h},Ur.prototype.copy=function(){for(var h=new Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)h[f]=this._coordinates[f].copy();return new Ur(h,this._dimension)},Ur.prototype.toString=function(){if(this._coordinates.length>0){var h=new ne(17*this._coordinates.length);h.append("("),h.append(this._coordinates[0]);for(var f=1;f<this._coordinates.length;f++)h.append(", "),h.append(this._coordinates[f]);return h.append(")"),h.toString()}return"()"},Ur.prototype.getY=function(h){return this._coordinates[h].y},Ur.prototype.toCoordinateArray=function(){return this._coordinates},Ur.prototype.interfaces_=function(){return[de,i]},Ur.prototype.getClass=function(){return Ur},yi.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ur,yi);var bi=s(function(){},"ce"),Xr={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};bi.prototype.readResolve=function(){return bi.instance()},bi.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var h=arguments[0];return new Ur(h)}if(Y(arguments[0],de)){var f=arguments[0];return new Ur(f)}}else if(arguments.length===2){var _=arguments[0],A=arguments[1];return A>3&&(A=3),A<2?new Ur(_):new Ur(_,A)}},bi.prototype.interfaces_=function(){return[Q,i]},bi.prototype.getClass=function(){return bi},bi.instance=function(){return bi.instanceObject},Xr.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Xr.instanceObject.get=function(){return new bi},Object.defineProperties(bi,Xr);var Vr=function(h){function f(){h.call(this),this.map_=new Map}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.get=function(_){return this.map_.get(_)||null},f.prototype.put=function(_,A){return this.map_.set(_,A),A},f.prototype.values=function(){for(var _=new le,A=this.map_.values(),R=A.next();!R.done;)_.add(R.value),R=A.next();return _},f.prototype.entrySet=function(){var _=new ke;return this.map_.entries().forEach(function(A){return _.add(A)}),_},f.prototype.size=function(){return this.map_.size()},f}(mt),si=s(function h(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=h.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof ea){var f=arguments[0];this._modelType=f,f===h.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=h.FIXED,this.setScale(_)}else if(arguments[0]instanceof h){var A=arguments[0];this._modelType=A._modelType,this._scale=A._scale}}},"t"),oa={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};si.prototype.equals=function(h){if(!(h instanceof si))return!1;var f=h;return this._modelType===f._modelType&&this._scale===f._scale},si.prototype.compareTo=function(h){var f=h,_=this.getMaximumSignificantDigits(),A=f.getMaximumSignificantDigits();return new ee(_).compareTo(new ee(A))},si.prototype.getScale=function(){return this._scale},si.prototype.isFloating=function(){return this._modelType===si.FLOATING||this._modelType===si.FLOATING_SINGLE},si.prototype.getType=function(){return this._modelType},si.prototype.toString=function(){var h="UNKNOWN";return this._modelType===si.FLOATING?h="Floating":this._modelType===si.FLOATING_SINGLE?h="Floating-Single":this._modelType===si.FIXED&&(h="Fixed (Scale="+this.getScale()+")"),h},si.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var h=arguments[0];return D.isNaN(h)||this._modelType===si.FLOATING_SINGLE?h:this._modelType===si.FIXED?Math.round(h*this._scale)/this._scale:h}if(arguments[0]instanceof z){var f=arguments[0];if(this._modelType===si.FLOATING)return null;f.x=this.makePrecise(f.x),f.y=this.makePrecise(f.y)}},si.prototype.getMaximumSignificantDigits=function(){var h=16;return this._modelType===si.FLOATING?h=16:this._modelType===si.FLOATING_SINGLE?h=6:this._modelType===si.FIXED&&(h=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),h},si.prototype.setScale=function(h){this._scale=Math.abs(h)},si.prototype.interfaces_=function(){return[i,k]},si.prototype.getClass=function(){return si},si.mostPrecise=function(h,f){return h.compareTo(f)>=0?h:f},oa.serialVersionUID.get=function(){return 7777263578777804e3},oa.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(si,oa);var ea=s(function h(f){this._name=f||null,h.nameToTypeMap.put(f,this)},"t"),Ui={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ea.prototype.readResolve=function(){return ea.nameToTypeMap.get(this._name)},ea.prototype.toString=function(){return this._name},ea.prototype.interfaces_=function(){return[i]},ea.prototype.getClass=function(){return ea},Ui.serialVersionUID.get=function(){return-552860263173159e4},Ui.nameToTypeMap.get=function(){return new Vr},Object.defineProperties(ea,Ui),si.Type=ea,si.FIXED=new ea("FIXED"),si.FLOATING=new ea("FLOATING"),si.FLOATING_SINGLE=new ea("FLOATING SINGLE");var Gr=s(function h(){this._precisionModel=new si,this._SRID=0,this._coordinateSequenceFactory=h.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Y(arguments[0],Q)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof si&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},"t"),S={serialVersionUID:{configurable:!0}};Gr.prototype.toGeometry=function(h){return h.isNull()?this.createPoint(null):h.getMinX()===h.getMaxX()&&h.getMinY()===h.getMaxY()?this.createPoint(new z(h.getMinX(),h.getMinY())):h.getMinX()===h.getMaxX()||h.getMinY()===h.getMaxY()?this.createLineString([new z(h.getMinX(),h.getMinY()),new z(h.getMaxX(),h.getMaxY())]):this.createPolygon(this.createLinearRing([new z(h.getMinX(),h.getMinY()),new z(h.getMinX(),h.getMaxY()),new z(h.getMaxX(),h.getMaxY()),new z(h.getMaxX(),h.getMinY()),new z(h.getMinX(),h.getMinY())]),null)},Gr.prototype.createLineString=function(h){return h?h instanceof Array?new Je(this.getCoordinateSequenceFactory().create(h),this):Y(h,de)?new Je(h,this):void 0:new Je(this.getCoordinateSequenceFactory().create([]),this)},Gr.prototype.createMultiLineString=function(){if(arguments.length===0)return new Mi(null,this);if(arguments.length===1){var h=arguments[0];return new Mi(h,this)}},Gr.prototype.buildGeometry=function(h){for(var f=null,_=!1,A=!1,R=h.iterator();R.hasNext();){var H=R.next(),te=H.getClass();f===null&&(f=te),te!==f&&(_=!0),H.isGeometryCollectionOrDerived()&&(A=!0)}if(f===null)return this.createGeometryCollection();if(_||A)return this.createGeometryCollection(Gr.toGeometryArray(h));var ge=h.iterator().next();if(h.size()>1){if(ge instanceof zt)return this.createMultiPolygon(Gr.toPolygonArray(h));if(ge instanceof Je)return this.createMultiLineString(Gr.toLineStringArray(h));if(ge instanceof ft)return this.createMultiPoint(Gr.toPointArray(h));Me.shouldNeverReachHere("Unhandled class: "+ge.getClass().getName())}return ge},Gr.prototype.createMultiPointFromCoords=function(h){return this.createMultiPoint(h!==null?this.getCoordinateSequenceFactory().create(h):null)},Gr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof z){var h=arguments[0];return this.createPoint(h!==null?this.getCoordinateSequenceFactory().create([h]):null)}if(Y(arguments[0],de)){var f=arguments[0];return new ft(f,this)}}},Gr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Gr.prototype.createPolygon=function(){if(arguments.length===0)return new zt(null,null,this);if(arguments.length===1){if(Y(arguments[0],de)){var h=arguments[0];return this.createPolygon(this.createLinearRing(h))}if(arguments[0]instanceof Array){var f=arguments[0];return this.createPolygon(this.createLinearRing(f))}if(arguments[0]instanceof ur){var _=arguments[0];return this.createPolygon(_,null)}}else if(arguments.length===2){var A=arguments[0],R=arguments[1];return new zt(A,R,this)}},Gr.prototype.getSRID=function(){return this._SRID},Gr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Cr(null,this);if(arguments.length===1){var h=arguments[0];return new Cr(h,this)}},Gr.prototype.createGeometry=function(h){return new kr(this).edit(h,{edit:s(function(){if(arguments.length===2){var f=arguments[0];return this._coordinateSequenceFactory.create(f)}},"edit")})},Gr.prototype.getPrecisionModel=function(){return this._precisionModel},Gr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var h=arguments[0];return this.createLinearRing(h!==null?this.getCoordinateSequenceFactory().create(h):null)}if(Y(arguments[0],de)){var f=arguments[0];return new ur(f,this)}}},Gr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new Ar(null,this);if(arguments.length===1){var h=arguments[0];return new Ar(h,this)}},Gr.prototype.createMultiPoint=function(){if(arguments.length===0)return new cr(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var h=arguments[0];return new cr(h,this)}if(arguments[0]instanceof Array){var f=arguments[0];return this.createMultiPoint(f!==null?this.getCoordinateSequenceFactory().create(f):null)}if(Y(arguments[0],de)){var _=arguments[0];if(_===null)return this.createMultiPoint(new Array(0).fill(null));for(var A=new Array(_.size()).fill(null),R=0;R<_.size();R++){var H=this.getCoordinateSequenceFactory().create(1,_.getDimension());Ie.copy(_,R,H,0,1),A[R]=this.createPoint(H)}return this.createMultiPoint(A)}}},Gr.prototype.interfaces_=function(){return[i]},Gr.prototype.getClass=function(){return Gr},Gr.toMultiPolygonArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.toGeometryArray=function(h){if(h===null)return null;var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.getDefaultCoordinateSequenceFactory=function(){return bi.instance()},Gr.toMultiLineStringArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.toLineStringArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.toMultiPointArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.toLinearRingArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.toPointArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.toPolygonArray=function(h){var f=new Array(h.size()).fill(null);return h.toArray(f)},Gr.createPointFromInternalCoord=function(h,f){return f.getPrecisionModel().makePrecise(h),f.getFactory().createPoint(h)},S.serialVersionUID.get=function(){return-6820524753094096e3},Object.defineProperties(Gr,S);var O=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],j=s(function(h){this.geometryFactory=h||new Gr},"Ie");j.prototype.read=function(h){var f,_=(f=typeof h=="string"?JSON.parse(h):h).type;if(!X[_])throw new Error("Unknown GeoJSON type: "+f.type);return O.indexOf(_)!==-1?X[_].apply(this,[f.coordinates]):_==="GeometryCollection"?X[_].apply(this,[f.geometries]):X[_].apply(this,[f])},j.prototype.write=function(h){var f=h.getGeometryType();if(!ie[f])throw new Error("Geometry is not supported");return ie[f].apply(this,[h])};var X={Feature:s(function(h){var f={};for(var _ in h)f[_]=h[_];if(h.geometry){var A=h.geometry.type;if(!X[A])throw new Error("Unknown GeoJSON type: "+h.type);f.geometry=this.read(h.geometry)}return h.bbox&&(f.bbox=X.bbox.apply(this,[h.bbox])),f},"Feature"),FeatureCollection:s(function(h){var f={};if(h.features){f.features=[];for(var _=0;_<h.features.length;++_)f.features.push(this.read(h.features[_]))}return h.bbox&&(f.bbox=this.parse.bbox.apply(this,[h.bbox])),f},"FeatureCollection"),coordinates:s(function(h){for(var f=[],_=0;_<h.length;++_){var A=h[_];f.push(new z(A[0],A[1]))}return f},"coordinates"),bbox:s(function(h){return this.geometryFactory.createLinearRing([new z(h[0],h[1]),new z(h[2],h[1]),new z(h[2],h[3]),new z(h[0],h[3]),new z(h[0],h[1])])},"bbox"),Point:s(function(h){var f=new z(h[0],h[1]);return this.geometryFactory.createPoint(f)},"Point"),MultiPoint:s(function(h){for(var f=[],_=0;_<h.length;++_)f.push(X.Point.apply(this,[h[_]]));return this.geometryFactory.createMultiPoint(f)},"MultiPoint"),LineString:s(function(h){var f=X.coordinates.apply(this,[h]);return this.geometryFactory.createLineString(f)},"LineString"),MultiLineString:s(function(h){for(var f=[],_=0;_<h.length;++_)f.push(X.LineString.apply(this,[h[_]]));return this.geometryFactory.createMultiLineString(f)},"MultiLineString"),Polygon:s(function(h){for(var f=X.coordinates.apply(this,[h[0]]),_=this.geometryFactory.createLinearRing(f),A=[],R=1;R<h.length;++R){var H=h[R],te=X.coordinates.apply(this,[H]),ge=this.geometryFactory.createLinearRing(te);A.push(ge)}return this.geometryFactory.createPolygon(_,A)},"Polygon"),MultiPolygon:s(function(h){for(var f=[],_=0;_<h.length;++_){var A=h[_];f.push(X.Polygon.apply(this,[A]))}return this.geometryFactory.createMultiPolygon(f)},"MultiPolygon"),GeometryCollection:s(function(h){for(var f=[],_=0;_<h.length;++_){var A=h[_];f.push(this.read(A))}return this.geometryFactory.createGeometryCollection(f)},"GeometryCollection")},ie={coordinate:s(function(h){return[h.x,h.y]},"coordinate"),Point:s(function(h){return{type:"Point",coordinates:ie.coordinate.apply(this,[h.getCoordinate()])}},"Point"),MultiPoint:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],R=ie.Point.apply(this,[A]);f.push(R.coordinates)}return{type:"MultiPoint",coordinates:f}},"MultiPoint"),LineString:s(function(h){for(var f=[],_=h.getCoordinates(),A=0;A<_.length;++A){var R=_[A];f.push(ie.coordinate.apply(this,[R]))}return{type:"LineString",coordinates:f}},"LineString"),MultiLineString:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],R=ie.LineString.apply(this,[A]);f.push(R.coordinates)}return{type:"MultiLineString",coordinates:f}},"MultiLineString"),Polygon:s(function(h){var f=[],_=ie.LineString.apply(this,[h._shell]);f.push(_.coordinates);for(var A=0;A<h._holes.length;++A){var R=h._holes[A],H=ie.LineString.apply(this,[R]);f.push(H.coordinates)}return{type:"Polygon",coordinates:f}},"Polygon"),MultiPolygon:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],R=ie.Polygon.apply(this,[A]);f.push(R.coordinates)}return{type:"MultiPolygon",coordinates:f}},"MultiPolygon"),GeometryCollection:s(function(h){for(var f=[],_=0;_<h._geometries.length;++_){var A=h._geometries[_],R=A.getGeometryType();f.push(ie[R].apply(this,[A]))}return{type:"GeometryCollection",geometries:f}},"GeometryCollection")},be=s(function(h){this.geometryFactory=h||new Gr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new j(this.geometryFactory)},"Ne");be.prototype.read=function(h){var f=this.parser.read(h);return this.precisionModel.getType()===si.FIXED&&this.reducePrecision(f),f},be.prototype.reducePrecision=function(h){var f,_;if(h.coordinate)this.precisionModel.makePrecise(h.coordinate);else if(h.points)for(f=0,_=h.points.length;f<_;f++)this.precisionModel.makePrecise(h.points[f]);else if(h.geometries)for(f=0,_=h.geometries.length;f<_;f++)this.reducePrecision(h.geometries[f])};var Ce=s(function(){this.parser=new j(this.geometryFactory)},"Ce");Ce.prototype.write=function(h){return this.parser.write(h)};var Te=s(function(){},"Se"),ct={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Te.prototype.interfaces_=function(){return[]},Te.prototype.getClass=function(){return Te},Te.opposite=function(h){return h===Te.LEFT?Te.RIGHT:h===Te.RIGHT?Te.LEFT:h},ct.ON.get=function(){return 0},ct.LEFT.get=function(){return 1},ct.RIGHT.get=function(){return 2},Object.defineProperties(Te,ct),(I.prototype=new Error).name="EmptyStackException",(P.prototype=new oe).add=function(h){return this.array_.push(h),!0},P.prototype.get=function(h){if(h<0||h>=this.size())throw new Error;return this.array_[h]},P.prototype.push=function(h){return this.array_.push(h),h},P.prototype.pop=function(h){if(this.array_.length===0)throw new I;return this.array_.pop()},P.prototype.peek=function(){if(this.array_.length===0)throw new I;return this.array_[this.array_.length-1]},P.prototype.empty=function(){return this.array_.length===0},P.prototype.isEmpty=function(){return this.empty()},P.prototype.search=function(h){return this.array_.indexOf(h)},P.prototype.size=function(){return this.array_.length},P.prototype.toArray=function(){for(var h=[],f=0,_=this.array_.length;f<_;f++)h.push(this.array_[f]);return h};var _t=s(function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null},"be");_t.prototype.getCoordinate=function(){return this._minCoord},_t.prototype.getRightmostSide=function(h,f){var _=this.getRightmostSideOfSegment(h,f);return _<0&&(_=this.getRightmostSideOfSegment(h,f-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(h)),_},_t.prototype.findRightmostEdgeAtVertex=function(){var h=this._minDe.getEdge().getCoordinates();Me.isTrue(this._minIndex>0&&this._minIndex<h.length,"rightmost point expected to be interior vertex of edge");var f=h[this._minIndex-1],_=h[this._minIndex+1],A=pt.computeOrientation(this._minCoord,_,f),R=!1;(f.y<this._minCoord.y&&_.y<this._minCoord.y&&A===pt.COUNTERCLOCKWISE||f.y>this._minCoord.y&&_.y>this._minCoord.y&&A===pt.CLOCKWISE)&&(R=!0),R&&(this._minIndex=this._minIndex-1)},_t.prototype.getRightmostSideOfSegment=function(h,f){var _=h.getEdge().getCoordinates();if(f<0||f+1>=_.length||_[f].y===_[f+1].y)return-1;var A=Te.LEFT;return _[f].y<_[f+1].y&&(A=Te.RIGHT),A},_t.prototype.getEdge=function(){return this._orientedDe},_t.prototype.checkForRightmostCoordinate=function(h){for(var f=h.getEdge().getCoordinates(),_=0;_<f.length-1;_++)(this._minCoord===null||f[_].x>this._minCoord.x)&&(this._minDe=h,this._minIndex=_,this._minCoord=f[_])},_t.prototype.findRightmostEdgeAtNode=function(){var h=this._minDe.getNode().getEdges();this._minDe=h.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},_t.prototype.findEdge=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next();_.isForward()&&this.checkForRightmostCoordinate(_)}Me.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Te.LEFT&&(this._orientedDe=this._minDe.getSym())},_t.prototype.interfaces_=function(){return[]},_t.prototype.getClass=function(){return _t};var qt=function(h){function f(_,A){h.call(this,f.msgWithCoord(_,A)),this.pt=A?new z(A):null,this.name="TopologyException"}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.getCoordinate=function(){return this.pt},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.msgWithCoord=function(_,A){return A?_:_+" [ "+A+" ]"},f}(Lt),sr=s(function(){this.array_=[]},"Oe");sr.prototype.addLast=function(h){this.array_.push(h)},sr.prototype.removeFirst=function(){return this.array_.shift()},sr.prototype.isEmpty=function(){return this.array_.length===0};var mr=s(function(){this._finder=null,this._dirEdgeList=new le,this._nodes=new le,this._rightMostCoord=null,this._env=null,this._finder=new _t},"Te");mr.prototype.clearVisitedEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();)h.next().setVisited(!1)},mr.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},mr.prototype.computeNodeDepth=function(h){for(var f=null,_=h.getEdges().iterator();_.hasNext();){var A=_.next();if(A.isVisited()||A.getSym().isVisited()){f=A;break}}if(f===null)throw new qt("unable to find edge to compute depths at "+h.getCoordinate());h.getEdges().computeDepths(f);for(var R=h.getEdges().iterator();R.hasNext();){var H=R.next();H.setVisited(!0),this.copySymDepths(H)}},mr.prototype.computeDepth=function(h){this.clearVisitedEdges();var f=this._finder.getEdge();f.setEdgeDepths(Te.RIGHT,h),this.copySymDepths(f),this.computeDepths(f)},mr.prototype.create=function(h){this.addReachable(h),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},mr.prototype.findResultEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();){var f=h.next();f.getDepth(Te.RIGHT)>=1&&f.getDepth(Te.LEFT)<=0&&!f.isInteriorAreaEdge()&&f.setInResult(!0)}},mr.prototype.computeDepths=function(h){var f=new ke,_=new sr,A=h.getNode();for(_.addLast(A),f.add(A),h.setVisited(!0);!_.isEmpty();){var R=_.removeFirst();f.add(R),this.computeNodeDepth(R);for(var H=R.getEdges().iterator();H.hasNext();){var te=H.next().getSym();if(!te.isVisited()){var ge=te.getNode();f.contains(ge)||(_.addLast(ge),f.add(ge))}}}},mr.prototype.compareTo=function(h){var f=h;return this._rightMostCoord.x<f._rightMostCoord.x?-1:this._rightMostCoord.x>f._rightMostCoord.x?1:0},mr.prototype.getEnvelope=function(){if(this._env===null){for(var h=new Ae,f=this._dirEdgeList.iterator();f.hasNext();)for(var _=f.next().getEdge().getCoordinates(),A=0;A<_.length-1;A++)h.expandToInclude(_[A]);this._env=h}return this._env},mr.prototype.addReachable=function(h){var f=new P;for(f.add(h);!f.empty();){var _=f.pop();this.add(_,f)}},mr.prototype.copySymDepths=function(h){var f=h.getSym();f.setDepth(Te.LEFT,h.getDepth(Te.RIGHT)),f.setDepth(Te.RIGHT,h.getDepth(Te.LEFT))},mr.prototype.add=function(h,f){h.setVisited(!0),this._nodes.add(h);for(var _=h.getEdges().iterator();_.hasNext();){var A=_.next();this._dirEdgeList.add(A);var R=A.getSym().getNode();R.isVisited()||f.push(R)}},mr.prototype.getNodes=function(){return this._nodes},mr.prototype.getDirectedEdges=function(){return this._dirEdgeList},mr.prototype.interfaces_=function(){return[k]},mr.prototype.getClass=function(){return mr};var xr=s(function h(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var f=arguments[0];this.init(f.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[Te.ON]=_}else if(arguments[0]instanceof h){var A=arguments[0];if(this.init(A.location.length),A!==null)for(var R=0;R<this.location.length;R++)this.location[R]=A.location[R]}}else if(arguments.length===3){var H=arguments[0],te=arguments[1],ge=arguments[2];this.init(3),this.location[Te.ON]=H,this.location[Te.LEFT]=te,this.location[Te.RIGHT]=ge}},"t");xr.prototype.setAllLocations=function(h){for(var f=0;f<this.location.length;f++)this.location[f]=h},xr.prototype.isNull=function(){for(var h=0;h<this.location.length;h++)if(this.location[h]!==V.NONE)return!1;return!0},xr.prototype.setAllLocationsIfNull=function(h){for(var f=0;f<this.location.length;f++)this.location[f]===V.NONE&&(this.location[f]=h)},xr.prototype.isLine=function(){return this.location.length===1},xr.prototype.merge=function(h){if(h.location.length>this.location.length){var f=new Array(3).fill(null);f[Te.ON]=this.location[Te.ON],f[Te.LEFT]=V.NONE,f[Te.RIGHT]=V.NONE,this.location=f}for(var _=0;_<this.location.length;_++)this.location[_]===V.NONE&&_<h.location.length&&(this.location[_]=h.location[_])},xr.prototype.getLocations=function(){return this.location},xr.prototype.flip=function(){if(this.location.length<=1)return null;var h=this.location[Te.LEFT];this.location[Te.LEFT]=this.location[Te.RIGHT],this.location[Te.RIGHT]=h},xr.prototype.toString=function(){var h=new ne;return this.location.length>1&&h.append(V.toLocationSymbol(this.location[Te.LEFT])),h.append(V.toLocationSymbol(this.location[Te.ON])),this.location.length>1&&h.append(V.toLocationSymbol(this.location[Te.RIGHT])),h.toString()},xr.prototype.setLocations=function(h,f,_){this.location[Te.ON]=h,this.location[Te.LEFT]=f,this.location[Te.RIGHT]=_},xr.prototype.get=function(h){return h<this.location.length?this.location[h]:V.NONE},xr.prototype.isArea=function(){return this.location.length>1},xr.prototype.isAnyNull=function(){for(var h=0;h<this.location.length;h++)if(this.location[h]===V.NONE)return!0;return!1},xr.prototype.setLocation=function(){if(arguments.length===1){var h=arguments[0];this.setLocation(Te.ON,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this.location[f]=_}},xr.prototype.init=function(h){this.location=new Array(h).fill(null),this.setAllLocations(V.NONE)},xr.prototype.isEqualOnSide=function(h,f){return this.location[f]===h.location[f]},xr.prototype.allPositionsEqual=function(h){for(var f=0;f<this.location.length;f++)if(this.location[f]!==h)return!1;return!0},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var lr=s(function h(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var f=arguments[0];this.elt[0]=new xr(f),this.elt[1]=new xr(f)}else if(arguments[0]instanceof h){var _=arguments[0];this.elt[0]=new xr(_.elt[0]),this.elt[1]=new xr(_.elt[1])}}else if(arguments.length===2){var A=arguments[0],R=arguments[1];this.elt[0]=new xr(V.NONE),this.elt[1]=new xr(V.NONE),this.elt[A].setLocation(R)}else if(arguments.length===3){var H=arguments[0],te=arguments[1],ge=arguments[2];this.elt[0]=new xr(H,te,ge),this.elt[1]=new xr(H,te,ge)}else if(arguments.length===4){var Ne=arguments[0],Ye=arguments[1],Mt=arguments[2],At=arguments[3];this.elt[0]=new xr(V.NONE,V.NONE,V.NONE),this.elt[1]=new xr(V.NONE,V.NONE,V.NONE),this.elt[Ne].setLocations(Ye,Mt,At)}},"t");lr.prototype.getGeometryCount=function(){var h=0;return this.elt[0].isNull()||h++,this.elt[1].isNull()||h++,h},lr.prototype.setAllLocations=function(h,f){this.elt[h].setAllLocations(f)},lr.prototype.isNull=function(h){return this.elt[h].isNull()},lr.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var h=arguments[0];this.setAllLocationsIfNull(0,h),this.setAllLocationsIfNull(1,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this.elt[f].setAllLocationsIfNull(_)}},lr.prototype.isLine=function(h){return this.elt[h].isLine()},lr.prototype.merge=function(h){for(var f=0;f<2;f++)this.elt[f]===null&&h.elt[f]!==null?this.elt[f]=new xr(h.elt[f]):this.elt[f].merge(h.elt[f])},lr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},lr.prototype.getLocation=function(){if(arguments.length===1){var h=arguments[0];return this.elt[h].get(Te.ON)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return this.elt[f].get(_)}},lr.prototype.toString=function(){var h=new ne;return this.elt[0]!==null&&(h.append("A:"),h.append(this.elt[0].toString())),this.elt[1]!==null&&(h.append(" B:"),h.append(this.elt[1].toString())),h.toString()},lr.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var h=arguments[0];return this.elt[h].isArea()}},lr.prototype.isAnyNull=function(h){return this.elt[h].isAnyNull()},lr.prototype.setLocation=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];this.elt[h].setLocation(Te.ON,f)}else if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2];this.elt[_].setLocation(A,R)}},lr.prototype.isEqualOnSide=function(h,f){return this.elt[0].isEqualOnSide(h.elt[0],f)&&this.elt[1].isEqualOnSide(h.elt[1],f)},lr.prototype.allPositionsEqual=function(h,f){return this.elt[h].allPositionsEqual(f)},lr.prototype.toLine=function(h){this.elt[h].isArea()&&(this.elt[h]=new xr(this.elt[h].location[0]))},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},lr.toLineLabel=function(h){for(var f=new lr(V.NONE),_=0;_<2;_++)f.setLocation(_,h.getLocation(_));return f};var Er=s(function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new le,this._pts=new le,this._label=new lr(V.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new le,this._geometryFactory=null;var h=arguments[0],f=arguments[1];this._geometryFactory=f,this.computePoints(h),this.computeRing()},"De");Er.prototype.computeRing=function(){if(this._ring!==null)return null;for(var h=new Array(this._pts.size()).fill(null),f=0;f<this._pts.size();f++)h[f]=this._pts.get(f);this._ring=this._geometryFactory.createLinearRing(h),this._isHole=pt.isCCW(this._ring.getCoordinates())},Er.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},Er.prototype.computePoints=function(h){this._startDe=h;var f=h,_=!0;do{if(f===null)throw new qt("Found null DirectedEdge");if(f.getEdgeRing()===this)throw new qt("Directed Edge visited twice during ring-building at "+f.getCoordinate());this._edges.add(f);var A=f.getLabel();Me.isTrue(A.isArea()),this.mergeLabel(A),this.addPoints(f.getEdge(),f.isForward(),_),_=!1,this.setEdgeRing(f,this),f=this.getNext(f)}while(f!==this._startDe)},Er.prototype.getLinearRing=function(){return this._ring},Er.prototype.getCoordinate=function(h){return this._pts.get(h)},Er.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var h=this._startDe;do{var f=h.getNode().getEdges().getOutgoingDegree(this);f>this._maxNodeDegree&&(this._maxNodeDegree=f),h=this.getNext(h)}while(h!==this._startDe);this._maxNodeDegree*=2},Er.prototype.addPoints=function(h,f,_){var A=h.getCoordinates();if(f){var R=1;_&&(R=0);for(var H=R;H<A.length;H++)this._pts.add(A[H])}else{var te=A.length-2;_&&(te=A.length-1);for(var ge=te;ge>=0;ge--)this._pts.add(A[ge])}},Er.prototype.isHole=function(){return this._isHole},Er.prototype.setInResult=function(){var h=this._startDe;do h.getEdge().setInResult(!0),h=h.getNext();while(h!==this._startDe)},Er.prototype.containsPoint=function(h){var f=this.getLinearRing();if(!f.getEnvelopeInternal().contains(h)||!pt.isPointInRing(h,f.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(h))return!1;return!0},Er.prototype.addHole=function(h){this._holes.add(h)},Er.prototype.isShell=function(){return this._shell===null},Er.prototype.getLabel=function(){return this._label},Er.prototype.getEdges=function(){return this._edges},Er.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Er.prototype.getShell=function(){return this._shell},Er.prototype.mergeLabel=function(){if(arguments.length===1){var h=arguments[0];this.mergeLabel(h,0),this.mergeLabel(h,1)}else if(arguments.length===2){var f=arguments[0],_=arguments[1],A=f.getLocation(_,Te.RIGHT);if(A===V.NONE)return null;if(this._label.getLocation(_)===V.NONE)return this._label.setLocation(_,A),null}},Er.prototype.setShell=function(h){this._shell=h,h!==null&&h.addHole(this)},Er.prototype.toPolygon=function(h){for(var f=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)f[_]=this._holes.get(_).getLinearRing();return h.createPolygon(this.getLinearRing(),f)},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er};var on=function(h){function f(){var _=arguments[0],A=arguments[1];h.call(this,_,A)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.setEdgeRing=function(_,A){_.setMinEdgeRing(A)},f.prototype.getNext=function(_){return _.getNextMin()},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Er),ta=function(h){function f(){var _=arguments[0],A=arguments[1];h.call(this,_,A)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.buildMinimalRings=function(){var _=new le,A=this._startDe;do{if(A.getMinEdgeRing()===null){var R=new on(A,this._geometryFactory);_.add(R)}A=A.getNext()}while(A!==this._startDe);return _},f.prototype.setEdgeRing=function(_,A){_.setEdgeRing(A)},f.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)},f.prototype.getNext=function(_){return _.getNext()},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Er),sn=s(function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0&&arguments.length===1){var h=arguments[0];this._label=h}},"Fe");sn.prototype.setVisited=function(h){this._isVisited=h},sn.prototype.setInResult=function(h){this._isInResult=h},sn.prototype.isCovered=function(){return this._isCovered},sn.prototype.isCoveredSet=function(){return this._isCoveredSet},sn.prototype.setLabel=function(h){this._label=h},sn.prototype.getLabel=function(){return this._label},sn.prototype.setCovered=function(h){this._isCovered=h,this._isCoveredSet=!0},sn.prototype.updateIM=function(h){Me.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(h)},sn.prototype.isInResult=function(){return this._isInResult},sn.prototype.isVisited=function(){return this._isVisited},sn.prototype.interfaces_=function(){return[]},sn.prototype.getClass=function(){return sn};var Bl=function(h){function f(){h.call(this),this._coord=null,this._edges=null;var _=arguments[0],A=arguments[1];this._coord=_,this._edges=A,this._label=new lr(0,V.NONE)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.isIncidentEdgeInResult=function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1},f.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},f.prototype.getCoordinate=function(){return this._coord},f.prototype.print=function(_){_.println("node "+this._coord+" lbl: "+this._label)},f.prototype.computeIM=function(_){},f.prototype.computeMergedLocation=function(_,A){var R=V.NONE;if(R=this._label.getLocation(A),!_.isNull(A)){var H=_.getLocation(A);R!==V.BOUNDARY&&(R=H)}return R},f.prototype.setLabel=function(){if(arguments.length!==2)return h.prototype.setLabel.apply(this,arguments);var _=arguments[0],A=arguments[1];this._label===null?this._label=new lr(_,A):this._label.setLocation(_,A)},f.prototype.getEdges=function(){return this._edges},f.prototype.mergeLabel=function(){if(arguments[0]instanceof f){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof lr)for(var A=arguments[0],R=0;R<2;R++){var H=this.computeMergedLocation(A,R);this._label.getLocation(R)===V.NONE&&this._label.setLocation(R,H)}},f.prototype.add=function(_){this._edges.insert(_),_.setNode(this)},f.prototype.setLabelBoundary=function(_){if(this._label===null)return null;var A=V.NONE;this._label!==null&&(A=this._label.getLocation(_));var R=null;switch(A){case V.BOUNDARY:R=V.INTERIOR;break;case V.INTERIOR:default:R=V.BOUNDARY}this._label.setLocation(_,R)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(sn),sa=s(function(){this.nodeMap=new v,this.nodeFact=null;var h=arguments[0];this.nodeFact=h},"qe");sa.prototype.find=function(h){return this.nodeMap.get(h)},sa.prototype.addNode=function(){if(arguments[0]instanceof z){var h=arguments[0],f=this.nodeMap.get(h);return f===null&&(f=this.nodeFact.createNode(h),this.nodeMap.put(h,f)),f}if(arguments[0]instanceof Bl){var _=arguments[0],A=this.nodeMap.get(_.getCoordinate());return A===null?(this.nodeMap.put(_.getCoordinate(),_),_):(A.mergeLabel(_),A)}},sa.prototype.print=function(h){for(var f=this.iterator();f.hasNext();)f.next().print(h)},sa.prototype.iterator=function(){return this.nodeMap.values().iterator()},sa.prototype.values=function(){return this.nodeMap.values()},sa.prototype.getBoundaryNodes=function(h){for(var f=new le,_=this.iterator();_.hasNext();){var A=_.next();A.getLabel().getLocation(h)===V.BOUNDARY&&f.add(A)}return f},sa.prototype.add=function(h){var f=h.getCoordinate();this.addNode(f).add(h)},sa.prototype.interfaces_=function(){return[]},sa.prototype.getClass=function(){return sa};var li=s(function(){},"Be"),vo={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li},li.isNorthern=function(h){return h===li.NE||h===li.NW},li.isOpposite=function(h,f){return h===f?!1:(h-f+4)%4===2},li.commonHalfPlane=function(h,f){if(h===f)return h;if((h-f+4)%4===2)return-1;var _=h<f?h:f;return _===0&&(h>f?h:f)===3?3:_},li.isInHalfPlane=function(h,f){return f===li.SE?h===li.SE||h===li.SW:h===f||h===f+1},li.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var h=arguments[0],f=arguments[1];if(h===0&&f===0)throw new T("Cannot compute the quadrant for point ( "+h+", "+f+" )");return h>=0?f>=0?li.NE:li.SE:f>=0?li.NW:li.SW}if(arguments[0]instanceof z&&arguments[1]instanceof z){var _=arguments[0],A=arguments[1];if(A.x===_.x&&A.y===_.y)throw new T("Cannot compute the quadrant for two identical points "+_);return A.x>=_.x?A.y>=_.y?li.NE:li.SE:A.y>=_.y?li.NW:li.SW}},vo.NE.get=function(){return 0},vo.NW.get=function(){return 1},vo.SW.get=function(){return 2},vo.SE.get=function(){return 3},Object.defineProperties(li,vo);var ki=s(function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var h=arguments[0];this._edge=h}else if(arguments.length===3){var f=arguments[0],_=arguments[1],A=arguments[2];this._edge=f,this.init(_,A),this._label=null}else if(arguments.length===4){var R=arguments[0],H=arguments[1],te=arguments[2],ge=arguments[3];this._edge=R,this.init(H,te),this._label=ge}},"Ue");ki.prototype.compareDirection=function(h){return this._dx===h._dx&&this._dy===h._dy?0:this._quadrant>h._quadrant?1:this._quadrant<h._quadrant?-1:pt.computeOrientation(h._p0,h._p1,this._p1)},ki.prototype.getDy=function(){return this._dy},ki.prototype.getCoordinate=function(){return this._p0},ki.prototype.setNode=function(h){this._node=h},ki.prototype.print=function(h){var f=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),A=_.lastIndexOf("."),R=_.substring(A+1);h.print("  "+R+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+f+"   "+this._label)},ki.prototype.compareTo=function(h){var f=h;return this.compareDirection(f)},ki.prototype.getDirectedCoordinate=function(){return this._p1},ki.prototype.getDx=function(){return this._dx},ki.prototype.getLabel=function(){return this._label},ki.prototype.getEdge=function(){return this._edge},ki.prototype.getQuadrant=function(){return this._quadrant},ki.prototype.getNode=function(){return this._node},ki.prototype.toString=function(){var h=Math.atan2(this._dy,this._dx),f=this.getClass().getName(),_=f.lastIndexOf(".");return"  "+f.substring(_+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+h+"   "+this._label},ki.prototype.computeLabel=function(h){},ki.prototype.init=function(h,f){this._p0=h,this._p1=f,this._dx=f.x-h.x,this._dy=f.y-h.y,this._quadrant=li.quadrant(this._dx,this._dy),Me.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")},ki.prototype.interfaces_=function(){return[k]},ki.prototype.getClass=function(){return ki};var _o=function(h){function f(){var _=arguments[0],A=arguments[1];if(h.call(this,_),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=A,A)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var R=_.getNumPoints()-1;this.init(_.getCoordinate(R),_.getCoordinate(R-1))}this.computeDirectedLabel()}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.getNextMin=function(){return this._nextMin},f.prototype.getDepth=function(_){return this._depth[_]},f.prototype.setVisited=function(_){this._isVisited=_},f.prototype.computeDirectedLabel=function(){this._label=new lr(this._edge.getLabel()),this._isForward||this._label.flip()},f.prototype.getNext=function(){return this._next},f.prototype.setDepth=function(_,A){if(this._depth[_]!==-999&&this._depth[_]!==A)throw new qt("assigned depths do not match",this.getCoordinate());this._depth[_]=A},f.prototype.isInteriorAreaEdge=function(){for(var _=!0,A=0;A<2;A++)this._label.isArea(A)&&this._label.getLocation(A,Te.LEFT)===V.INTERIOR&&this._label.getLocation(A,Te.RIGHT)===V.INTERIOR||(_=!1);return _},f.prototype.setNextMin=function(_){this._nextMin=_},f.prototype.print=function(_){h.prototype.print.call(this,_),_.print(" "+this._depth[Te.LEFT]+"/"+this._depth[Te.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")},f.prototype.setMinEdgeRing=function(_){this._minEdgeRing=_},f.prototype.isLineEdge=function(){var _=this._label.isLine(0)||this._label.isLine(1),A=!this._label.isArea(0)||this._label.allPositionsEqual(0,V.EXTERIOR),R=!this._label.isArea(1)||this._label.allPositionsEqual(1,V.EXTERIOR);return _&&A&&R},f.prototype.setEdgeRing=function(_){this._edgeRing=_},f.prototype.getMinEdgeRing=function(){return this._minEdgeRing},f.prototype.getDepthDelta=function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_},f.prototype.setInResult=function(_){this._isInResult=_},f.prototype.getSym=function(){return this._sym},f.prototype.isForward=function(){return this._isForward},f.prototype.getEdge=function(){return this._edge},f.prototype.printEdge=function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)},f.prototype.setSym=function(_){this._sym=_},f.prototype.setVisitedEdge=function(_){this.setVisited(_),this._sym.setVisited(_)},f.prototype.setEdgeDepths=function(_,A){var R=this.getEdge().getDepthDelta();this._isForward||(R=-R);var H=1;_===Te.LEFT&&(H=-1);var te=Te.opposite(_),ge=A+R*H;this.setDepth(_,A),this.setDepth(te,ge)},f.prototype.getEdgeRing=function(){return this._edgeRing},f.prototype.isInResult=function(){return this._isInResult},f.prototype.setNext=function(_){this._next=_},f.prototype.isVisited=function(){return this._isVisited},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.depthFactor=function(_,A){return _===V.EXTERIOR&&A===V.INTERIOR?1:_===V.INTERIOR&&A===V.EXTERIOR?-1:0},f}(ki),hl=s(function(){},"Xe");hl.prototype.createNode=function(h){return new Bl(h,null)},hl.prototype.interfaces_=function(){return[]},hl.prototype.getClass=function(){return hl};var ln=s(function(){if(this._edges=new le,this._nodes=null,this._edgeEndList=new le,arguments.length===0)this._nodes=new sa(new hl);else if(arguments.length===1){var h=arguments[0];this._nodes=new sa(h)}},"Ye");ln.prototype.printEdges=function(h){h.println("Edges:");for(var f=0;f<this._edges.size();f++){h.println("edge "+f+":");var _=this._edges.get(f);_.print(h),_.eiList.print(h)}},ln.prototype.find=function(h){return this._nodes.find(h)},ln.prototype.addNode=function(){if(arguments[0]instanceof Bl){var h=arguments[0];return this._nodes.addNode(h)}if(arguments[0]instanceof z){var f=arguments[0];return this._nodes.addNode(f)}},ln.prototype.getNodeIterator=function(){return this._nodes.iterator()},ln.prototype.linkResultDirectedEdges=function(){for(var h=this._nodes.iterator();h.hasNext();)h.next().getEdges().linkResultDirectedEdges()},ln.prototype.debugPrintln=function(h){Re.out.println(h)},ln.prototype.isBoundaryNode=function(h,f){var _=this._nodes.find(f);if(_===null)return!1;var A=_.getLabel();return A!==null&&A.getLocation(h)===V.BOUNDARY},ln.prototype.linkAllDirectedEdges=function(){for(var h=this._nodes.iterator();h.hasNext();)h.next().getEdges().linkAllDirectedEdges()},ln.prototype.matchInSameDirection=function(h,f,_,A){return!!h.equals(_)&&pt.computeOrientation(h,f,A)===pt.COLLINEAR&&li.quadrant(h,f)===li.quadrant(_,A)},ln.prototype.getEdgeEnds=function(){return this._edgeEndList},ln.prototype.debugPrint=function(h){Re.out.print(h)},ln.prototype.getEdgeIterator=function(){return this._edges.iterator()},ln.prototype.findEdgeInSameDirection=function(h,f){for(var _=0;_<this._edges.size();_++){var A=this._edges.get(_),R=A.getCoordinates();if(this.matchInSameDirection(h,f,R[0],R[1])||this.matchInSameDirection(h,f,R[R.length-1],R[R.length-2]))return A}return null},ln.prototype.insertEdge=function(h){this._edges.add(h)},ln.prototype.findEdgeEnd=function(h){for(var f=this.getEdgeEnds().iterator();f.hasNext();){var _=f.next();if(_.getEdge()===h)return _}return null},ln.prototype.addEdges=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next();this._edges.add(_);var A=new _o(_,!0),R=new _o(_,!1);A.setSym(R),R.setSym(A),this.add(A),this.add(R)}},ln.prototype.add=function(h){this._nodes.add(h),this._edgeEndList.add(h)},ln.prototype.getNodes=function(){return this._nodes.values()},ln.prototype.findEdge=function(h,f){for(var _=0;_<this._edges.size();_++){var A=this._edges.get(_),R=A.getCoordinates();if(h.equals(R[0])&&f.equals(R[1]))return A}return null},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.linkResultDirectedEdges=function(h){for(var f=h.iterator();f.hasNext();)f.next().getEdges().linkResultDirectedEdges()};var Ia=s(function(){this._geometryFactory=null,this._shellList=new le;var h=arguments[0];this._geometryFactory=h},"ke");Ia.prototype.sortShellsAndHoles=function(h,f,_){for(var A=h.iterator();A.hasNext();){var R=A.next();R.isHole()?_.add(R):f.add(R)}},Ia.prototype.computePolygons=function(h){for(var f=new le,_=h.iterator();_.hasNext();){var A=_.next().toPolygon(this._geometryFactory);f.add(A)}return f},Ia.prototype.placeFreeHoles=function(h,f){for(var _=f.iterator();_.hasNext();){var A=_.next();if(A.getShell()===null){var R=this.findEdgeRingContaining(A,h);if(R===null)throw new qt("unable to assign hole to a shell",A.getCoordinate(0));A.setShell(R)}}},Ia.prototype.buildMinimalEdgeRings=function(h,f,_){for(var A=new le,R=h.iterator();R.hasNext();){var H=R.next();if(H.getMaxNodeDegree()>2){H.linkDirectedEdgesForMinimalEdgeRings();var te=H.buildMinimalRings(),ge=this.findShell(te);ge!==null?(this.placePolygonHoles(ge,te),f.add(ge)):_.addAll(te)}else A.add(H)}return A},Ia.prototype.containsPoint=function(h){for(var f=this._shellList.iterator();f.hasNext();)if(f.next().containsPoint(h))return!0;return!1},Ia.prototype.buildMaximalEdgeRings=function(h){for(var f=new le,_=h.iterator();_.hasNext();){var A=_.next();if(A.isInResult()&&A.getLabel().isArea()&&A.getEdgeRing()===null){var R=new ta(A,this._geometryFactory);f.add(R),R.setInResult()}}return f},Ia.prototype.placePolygonHoles=function(h,f){for(var _=f.iterator();_.hasNext();){var A=_.next();A.isHole()&&A.setShell(h)}},Ia.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ia.prototype.findEdgeRingContaining=function(h,f){for(var _=h.getLinearRing(),A=_.getEnvelopeInternal(),R=_.getCoordinateN(0),H=null,te=null,ge=f.iterator();ge.hasNext();){var Ne=ge.next(),Ye=Ne.getLinearRing(),Mt=Ye.getEnvelopeInternal();H!==null&&(te=H.getLinearRing().getEnvelopeInternal());var At=!1;Mt.contains(A)&&pt.isPointInRing(R,Ye.getCoordinates())&&(At=!0),At&&(H===null||te.contains(Mt))&&(H=Ne)}return H},Ia.prototype.findShell=function(h){for(var f=0,_=null,A=h.iterator();A.hasNext();){var R=A.next();R.isHole()||(_=R,f++)}return Me.isTrue(f<=1,"found two shells in MinimalEdgeRing list"),_},Ia.prototype.add=function(){if(arguments.length===1){var h=arguments[0];this.add(h.getEdgeEnds(),h.getNodes())}else if(arguments.length===2){var f=arguments[0],_=arguments[1];ln.linkResultDirectedEdges(_);var A=this.buildMaximalEdgeRings(f),R=new le,H=this.buildMinimalEdgeRings(A,this._shellList,R);this.sortShellsAndHoles(H,this._shellList,R),this.placeFreeHoles(this._shellList,R)}},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia};var zl=s(function(){},"je");zl.prototype.getBounds=function(){},zl.prototype.interfaces_=function(){return[]},zl.prototype.getClass=function(){return zl};var Oa=s(function(){this._bounds=null,this._item=null;var h=arguments[0],f=arguments[1];this._bounds=h,this._item=f},"He");Oa.prototype.getItem=function(){return this._item},Oa.prototype.getBounds=function(){return this._bounds},Oa.prototype.interfaces_=function(){return[zl,i]},Oa.prototype.getClass=function(){return Oa};var gs=s(function(){this._size=null,this._items=null,this._size=0,this._items=new le,this._items.add(null)},"We");gs.prototype.poll=function(){if(this.isEmpty())return null;var h=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),h},gs.prototype.size=function(){return this._size},gs.prototype.reorder=function(h){for(var f=null,_=this._items.get(h);2*h<=this._size&&((f=2*h)!==this._size&&this._items.get(f+1).compareTo(this._items.get(f))<0&&f++,this._items.get(f).compareTo(_)<0);h=f)this._items.set(h,this._items.get(f));this._items.set(h,_)},gs.prototype.clear=function(){this._size=0,this._items.clear()},gs.prototype.isEmpty=function(){return this._size===0},gs.prototype.add=function(h){this._items.add(null),this._size+=1;var f=this._size;for(this._items.set(0,h);h.compareTo(this._items.get(Math.trunc(f/2)))<0;f/=2)this._items.set(f,this._items.get(Math.trunc(f/2)));this._items.set(f,h)},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs};var qn=s(function(){},"Ke");qn.prototype.visitItem=function(h){},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var Ve=s(function(){},"Je");Ve.prototype.insert=function(h,f){},Ve.prototype.remove=function(h,f){},Ve.prototype.query=function(){},Ve.prototype.interfaces_=function(){return[]},Ve.prototype.getClass=function(){return Ve};var et=s(function(){if(this._childBoundables=new le,this._bounds=null,this._level=null,arguments.length!==0&&arguments.length===1){var h=arguments[0];this._level=h}},"Qe"),xe={serialVersionUID:{configurable:!0}};et.prototype.getLevel=function(){return this._level},et.prototype.size=function(){return this._childBoundables.size()},et.prototype.getChildBoundables=function(){return this._childBoundables},et.prototype.addChildBoundable=function(h){Me.isTrue(this._bounds===null),this._childBoundables.add(h)},et.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},et.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds},et.prototype.interfaces_=function(){return[zl,i]},et.prototype.getClass=function(){return et},xe.serialVersionUID.get=function(){return 6493722185909574e3},Object.defineProperties(et,xe);var Ge=s(function(){},"$e");Ge.reverseOrder=function(){return{compare:s(function(h,f){return f.compareTo(h)},"compare")}},Ge.min=function(h){return Ge.sort(h),h.get(0)},Ge.sort=function(h,f){var _=h.toArray();f?fr.sort(_,f):fr.sort(_);for(var A=h.iterator(),R=0,H=_.length;R<H;R++)A.next(),A.set(_[R])},Ge.singletonList=function(h){var f=new le;return f.add(h),f};var nt=s(function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var h=arguments[0],f=arguments[1],_=arguments[2];this._boundable1=h,this._boundable2=f,this._itemDistance=_,this._distance=this.distance()},"tn");nt.prototype.expandToQueue=function(h,f){var _=nt.isComposite(this._boundable1),A=nt.isComposite(this._boundable2);if(_&&A)return nt.area(this._boundable1)>nt.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,h,f),null):(this.expand(this._boundable2,this._boundable1,h,f),null);if(_)return this.expand(this._boundable1,this._boundable2,h,f),null;if(A)return this.expand(this._boundable2,this._boundable1,h,f),null;throw new T("neither boundable is composite")},nt.prototype.isLeaves=function(){return!(nt.isComposite(this._boundable1)||nt.isComposite(this._boundable2))},nt.prototype.compareTo=function(h){var f=h;return this._distance<f._distance?-1:this._distance>f._distance?1:0},nt.prototype.expand=function(h,f,_,A){for(var R=h.getChildBoundables().iterator();R.hasNext();){var H=R.next(),te=new nt(H,f,this._itemDistance);te.getDistance()<A&&_.add(te)}},nt.prototype.getBoundable=function(h){return h===0?this._boundable1:this._boundable2},nt.prototype.getDistance=function(){return this._distance},nt.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},nt.prototype.interfaces_=function(){return[k]},nt.prototype.getClass=function(){return nt},nt.area=function(h){return h.getBounds().getArea()},nt.isComposite=function(h){return h instanceof et};var Wt=s(function h(){if(this._root=null,this._built=!1,this._itemBoundables=new le,this._nodeCapacity=null,arguments.length===0){var f=h.DEFAULT_NODE_CAPACITY;this._nodeCapacity=f}else if(arguments.length===1){var _=arguments[0];Me.isTrue(_>1,"Node capacity must be greater than 1"),this._nodeCapacity=_}},"t"),Nr={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Wt.prototype.getNodeCapacity=function(){return this._nodeCapacity},Wt.prototype.lastNode=function(h){return h.get(h.size()-1)},Wt.prototype.size=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var h=0,f=arguments[0].getChildBoundables().iterator();f.hasNext();){var _=f.next();_ instanceof et?h+=this.size(_):_ instanceof Oa&&(h+=1)}return h}},Wt.prototype.removeItem=function(h,f){for(var _=null,A=h.getChildBoundables().iterator();A.hasNext();){var R=A.next();R instanceof Oa&&R.getItem()===f&&(_=R)}return _!==null&&(h.getChildBoundables().remove(_),!0)},Wt.prototype.itemsTree=function(){if(arguments.length===0){this.build();var h=this.itemsTree(this._root);return h===null?new le:h}if(arguments.length===1){for(var f=arguments[0],_=new le,A=f.getChildBoundables().iterator();A.hasNext();){var R=A.next();if(R instanceof et){var H=this.itemsTree(R);H!==null&&_.add(H)}else R instanceof Oa?_.add(R.getItem()):Me.shouldNeverReachHere()}return _.size()<=0?null:_}},Wt.prototype.insert=function(h,f){Me.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Oa(h,f))},Wt.prototype.boundablesAtLevel=function(){if(arguments.length===1){var h=arguments[0],f=new le;return this.boundablesAtLevel(h,this._root,f),f}if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2];if(Me.isTrue(_>-2),A.getLevel()===_)return R.add(A),null;for(var H=A.getChildBoundables().iterator();H.hasNext();){var te=H.next();te instanceof et?this.boundablesAtLevel(_,te,R):(Me.isTrue(te instanceof Oa),_===-1&&R.add(te))}return null}},Wt.prototype.query=function(){if(arguments.length===1){var h=arguments[0];this.build();var f=new le;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.query(h,this._root,f),f}if(arguments.length===2){var _=arguments[0],A=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),_)&&this.query(_,this._root,A)}else if(arguments.length===3){if(Y(arguments[2],qn)&&arguments[0]instanceof Object&&arguments[1]instanceof et)for(var R=arguments[0],H=arguments[1],te=arguments[2],ge=H.getChildBoundables(),Ne=0;Ne<ge.size();Ne++){var Ye=ge.get(Ne);this.getIntersectsOp().intersects(Ye.getBounds(),R)&&(Ye instanceof et?this.query(R,Ye,te):Ye instanceof Oa?te.visitItem(Ye.getItem()):Me.shouldNeverReachHere())}else if(Y(arguments[2],oe)&&arguments[0]instanceof Object&&arguments[1]instanceof et)for(var Mt=arguments[0],At=arguments[1],hr=arguments[2],gr=At.getChildBoundables(),Sr=0;Sr<gr.size();Sr++){var Kr=gr.get(Sr);this.getIntersectsOp().intersects(Kr.getBounds(),Mt)&&(Kr instanceof et?this.query(Mt,Kr,hr):Kr instanceof Oa?hr.add(Kr.getItem()):Me.shouldNeverReachHere())}}},Wt.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Wt.prototype.getRoot=function(){return this.build(),this._root},Wt.prototype.remove=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.remove(h,this._root,f)}if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2],H=this.removeItem(A,R);if(H)return!0;for(var te=null,ge=A.getChildBoundables().iterator();ge.hasNext();){var Ne=ge.next();if(this.getIntersectsOp().intersects(Ne.getBounds(),_)&&Ne instanceof et&&(H=this.remove(_,Ne,R))){te=Ne;break}}return te!==null&&te.getChildBoundables().isEmpty()&&A.getChildBoundables().remove(te),H}},Wt.prototype.createHigherLevels=function(h,f){Me.isTrue(!h.isEmpty());var _=this.createParentBoundables(h,f+1);return _.size()===1?_.get(0):this.createHigherLevels(_,f+1)},Wt.prototype.depth=function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var h=0,f=arguments[0].getChildBoundables().iterator();f.hasNext();){var _=f.next();if(_ instanceof et){var A=this.depth(_);A>h&&(h=A)}}return h+1}},Wt.prototype.createParentBoundables=function(h,f){Me.isTrue(!h.isEmpty());var _=new le;_.add(this.createNode(f));var A=new le(h);Ge.sort(A,this.getComparator());for(var R=A.iterator();R.hasNext();){var H=R.next();this.lastNode(_).getChildBoundables().size()===this.getNodeCapacity()&&_.add(this.createNode(f)),this.lastNode(_).addChildBoundable(H)}return _},Wt.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Wt.prototype.interfaces_=function(){return[i]},Wt.prototype.getClass=function(){return Wt},Wt.compareDoubles=function(h,f){return h>f?1:h<f?-1:0},Nr.IntersectsOp.get=function(){return Dr},Nr.serialVersionUID.get=function(){return-3886435814360241e3},Nr.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Wt,Nr);var Dr=s(function(){},"rn"),ui=s(function(){},"on");ui.prototype.distance=function(h,f){},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var mi=function(h){function f(A){A=A||f.DEFAULT_NODE_CAPACITY,h.call(this,A)}s(f,"n"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return f.prototype.createParentBoundablesFromVerticalSlices=function(A,R){Me.isTrue(A.length>0);for(var H=new le,te=0;te<A.length;te++)H.addAll(this.createParentBoundablesFromVerticalSlice(A[te],R));return H},f.prototype.createNode=function(A){return new Ni(A)},f.prototype.size=function(){return arguments.length===0?h.prototype.size.call(this):h.prototype.size.apply(this,arguments)},f.prototype.insert=function(){if(arguments.length!==2)return h.prototype.insert.apply(this,arguments);var A=arguments[0],R=arguments[1];if(A.isNull())return null;h.prototype.insert.call(this,A,R)},f.prototype.getIntersectsOp=function(){return f.intersectsOp},f.prototype.verticalSlices=function(A,R){for(var H=Math.trunc(Math.ceil(A.size()/R)),te=new Array(R).fill(null),ge=A.iterator(),Ne=0;Ne<R;Ne++){te[Ne]=new le;for(var Ye=0;ge.hasNext()&&Ye<H;){var Mt=ge.next();te[Ne].add(Mt),Ye++}}return te},f.prototype.query=function(){if(arguments.length===1){var A=arguments[0];return h.prototype.query.call(this,A)}if(arguments.length===2){var R=arguments[0],H=arguments[1];h.prototype.query.call(this,R,H)}else if(arguments.length===3){if(Y(arguments[2],qn)&&arguments[0]instanceof Object&&arguments[1]instanceof et){var te=arguments[0],ge=arguments[1],Ne=arguments[2];h.prototype.query.call(this,te,ge,Ne)}else if(Y(arguments[2],oe)&&arguments[0]instanceof Object&&arguments[1]instanceof et){var Ye=arguments[0],Mt=arguments[1],At=arguments[2];h.prototype.query.call(this,Ye,Mt,At)}}},f.prototype.getComparator=function(){return f.yComparator},f.prototype.createParentBoundablesFromVerticalSlice=function(A,R){return h.prototype.createParentBoundables.call(this,A,R)},f.prototype.remove=function(){if(arguments.length===2){var A=arguments[0],R=arguments[1];return h.prototype.remove.call(this,A,R)}return h.prototype.remove.apply(this,arguments)},f.prototype.depth=function(){return arguments.length===0?h.prototype.depth.call(this):h.prototype.depth.apply(this,arguments)},f.prototype.createParentBoundables=function(A,R){Me.isTrue(!A.isEmpty());var H=Math.trunc(Math.ceil(A.size()/this.getNodeCapacity())),te=new le(A);Ge.sort(te,f.xComparator);var ge=this.verticalSlices(te,Math.trunc(Math.ceil(Math.sqrt(H))));return this.createParentBoundablesFromVerticalSlices(ge,R)},f.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Y(arguments[0],ui)){var A=arguments[0],R=new nt(this.getRoot(),this.getRoot(),A);return this.nearestNeighbour(R)}if(arguments[0]instanceof nt){var H=arguments[0];return this.nearestNeighbour(H,D.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof f&&Y(arguments[1],ui)){var te=arguments[0],ge=arguments[1],Ne=new nt(this.getRoot(),te.getRoot(),ge);return this.nearestNeighbour(Ne)}if(arguments[0]instanceof nt&&typeof arguments[1]=="number"){var Ye=arguments[0],Mt=arguments[1],At=null,hr=new gs;for(hr.add(Ye);!hr.isEmpty()&&Mt>0;){var gr=hr.poll(),Sr=gr.getDistance();if(Sr>=Mt)break;gr.isLeaves()?(Mt=Sr,At=gr):gr.expandToQueue(hr,Mt)}return[At.getBoundable(0).getItem(),At.getBoundable(1).getItem()]}}else if(arguments.length===3){var Kr=arguments[0],Vi=arguments[1],jn=arguments[2],ts=new Oa(Kr,Vi),mu=new nt(this.getRoot(),ts,jn);return this.nearestNeighbour(mu)[0]}},f.prototype.interfaces_=function(){return[Ve,i]},f.prototype.getClass=function(){return f},f.centreX=function(A){return f.avg(A.getMinX(),A.getMaxX())},f.avg=function(A,R){return(A+R)/2},f.centreY=function(A){return f.avg(A.getMinY(),A.getMaxY())},_.STRtreeNode.get=function(){return Ni},_.serialVersionUID.get=function(){return 0x39920f7d5f261e0},_.xComparator.get=function(){return{interfaces_:s(function(){return[U]},"interfaces_"),compare:s(function(A,R){return h.compareDoubles(f.centreX(A.getBounds()),f.centreX(R.getBounds()))},"compare")}},_.yComparator.get=function(){return{interfaces_:s(function(){return[U]},"interfaces_"),compare:s(function(A,R){return h.compareDoubles(f.centreY(A.getBounds()),f.centreY(R.getBounds()))},"compare")}},_.intersectsOp.get=function(){return{interfaces_:s(function(){return[h.IntersectsOp]},"interfaces_"),intersects:s(function(A,R){return A.intersects(R)},"intersects")}},_.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(f,_),f}(Wt),Ni=function(h){function f(){var _=arguments[0];h.call(this,_)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.computeBounds=function(){for(var _=null,A=this.getChildBoundables().iterator();A.hasNext();){var R=A.next();_===null?_=new Ae(R.getBounds()):_.expandToInclude(R.getBounds())}return _},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(et),un=s(function(){},"un");un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},un.relativeSign=function(h,f){return h<f?-1:h>f?1:0},un.compare=function(h,f,_){if(f.equals2D(_))return 0;var A=un.relativeSign(f.x,_.x),R=un.relativeSign(f.y,_.y);switch(h){case 0:return un.compareValue(A,R);case 1:return un.compareValue(R,A);case 2:return un.compareValue(R,-A);case 3:return un.compareValue(-A,R);case 4:return un.compareValue(-A,-R);case 5:return un.compareValue(-R,-A);case 6:return un.compareValue(-R,A);case 7:return un.compareValue(A,-R)}return Me.shouldNeverReachHere("invalid octant value"),0},un.compareValue=function(h,f){return h<0?-1:h>0?1:f<0?-1:f>0?1:0};var Un=s(function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];this._segString=h,this.coord=new z(f),this.segmentIndex=_,this._segmentOctant=A,this._isInterior=!f.equals2D(h.getCoordinate(_))},"ln");Un.prototype.getCoordinate=function(){return this.coord},Un.prototype.print=function(h){h.print(this.coord),h.print(" seg # = "+this.segmentIndex)},Un.prototype.compareTo=function(h){var f=h;return this.segmentIndex<f.segmentIndex?-1:this.segmentIndex>f.segmentIndex?1:this.coord.equals2D(f.coord)?0:un.compare(this._segmentOctant,this.coord,f.coord)},Un.prototype.isEndPoint=function(h){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===h},Un.prototype.isInterior=function(){return this._isInterior},Un.prototype.interfaces_=function(){return[k]},Un.prototype.getClass=function(){return Un};var Wn=s(function(){this._nodeMap=new v,this._edge=null;var h=arguments[0];this._edge=h},"cn");Wn.prototype.getSplitCoordinates=function(){var h=new ze;this.addEndpoints();for(var f=this.iterator(),_=f.next();f.hasNext();){var A=f.next();this.addEdgeCoordinates(_,A,h),_=A}return h.toCoordinateArray()},Wn.prototype.addCollapsedNodes=function(){var h=new le;this.findCollapsesFromInsertedNodes(h),this.findCollapsesFromExistingVertices(h);for(var f=h.iterator();f.hasNext();){var _=f.next().intValue();this.add(this._edge.getCoordinate(_),_)}},Wn.prototype.print=function(h){h.println("Intersections:");for(var f=this.iterator();f.hasNext();)f.next().print(h)},Wn.prototype.findCollapsesFromExistingVertices=function(h){for(var f=0;f<this._edge.size()-2;f++){var _=this._edge.getCoordinate(f),A=this._edge.getCoordinate(f+2);_.equals2D(A)&&h.add(new ee(f+1))}},Wn.prototype.addEdgeCoordinates=function(h,f,_){var A=this._edge.getCoordinate(f.segmentIndex),R=f.isInterior()||!f.coord.equals2D(A);_.add(new z(h.coord),!1);for(var H=h.segmentIndex+1;H<=f.segmentIndex;H++)_.add(this._edge.getCoordinate(H));R&&_.add(new z(f.coord))},Wn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Wn.prototype.addSplitEdges=function(h){this.addEndpoints(),this.addCollapsedNodes();for(var f=this.iterator(),_=f.next();f.hasNext();){var A=f.next(),R=this.createSplitEdge(_,A);h.add(R),_=A}},Wn.prototype.findCollapseIndex=function(h,f,_){if(!h.coord.equals2D(f.coord))return!1;var A=f.segmentIndex-h.segmentIndex;return f.isInterior()||A--,A===1&&(_[0]=h.segmentIndex+1,!0)},Wn.prototype.findCollapsesFromInsertedNodes=function(h){for(var f=new Array(1).fill(null),_=this.iterator(),A=_.next();_.hasNext();){var R=_.next();this.findCollapseIndex(A,R,f)&&h.add(new ee(f[0])),A=R}},Wn.prototype.getEdge=function(){return this._edge},Wn.prototype.addEndpoints=function(){var h=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(h),h)},Wn.prototype.createSplitEdge=function(h,f){var _=f.segmentIndex-h.segmentIndex+2,A=this._edge.getCoordinate(f.segmentIndex),R=f.isInterior()||!f.coord.equals2D(A);R||_--;var H=new Array(_).fill(null),te=0;H[te++]=new z(h.coord);for(var ge=h.segmentIndex+1;ge<=f.segmentIndex;ge++)H[te++]=this._edge.getCoordinate(ge);return R&&(H[te]=new z(f.coord)),new ba(H,this._edge.getData())},Wn.prototype.add=function(h,f){var _=new Un(this._edge,h,f,this._edge.getSegmentOctant(f)),A=this._nodeMap.get(_);return A!==null?(Me.isTrue(A.coord.equals2D(h),"Found equal nodes with different coordinates"),A):(this._nodeMap.put(_,_),_)},Wn.prototype.checkSplitEdgesCorrectness=function(h){var f=this._edge.getCoordinates(),_=h.get(0).getCoordinate(0);if(!_.equals2D(f[0]))throw new Lt("bad split edge start point at "+_);var A=h.get(h.size()-1).getCoordinates(),R=A[A.length-1];if(!R.equals2D(f[f.length-1]))throw new Lt("bad split edge end point at "+R)},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var pl=s(function(){},"pn");pl.prototype.interfaces_=function(){return[]},pl.prototype.getClass=function(){return pl},pl.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var h=arguments[0],f=arguments[1];if(h===0&&f===0)throw new T("Cannot compute the octant for point ( "+h+", "+f+" )");var _=Math.abs(h),A=Math.abs(f);return h>=0?f>=0?_>=A?0:1:_>=A?7:6:f>=0?_>=A?3:2:_>=A?4:5}if(arguments[0]instanceof z&&arguments[1]instanceof z){var R=arguments[0],H=arguments[1],te=H.x-R.x,ge=H.y-R.y;if(te===0&&ge===0)throw new T("Cannot compute the octant for two identical points "+R);return pl.octant(te,ge)}};var qs=s(function(){},"hn");qs.prototype.getCoordinates=function(){},qs.prototype.size=function(){},qs.prototype.getCoordinate=function(h){},qs.prototype.isClosed=function(){},qs.prototype.setData=function(h){},qs.prototype.getData=function(){},qs.prototype.interfaces_=function(){return[]},qs.prototype.getClass=function(){return qs};var ip=s(function(){},"fn");ip.prototype.addIntersection=function(h,f){},ip.prototype.interfaces_=function(){return[qs]},ip.prototype.getClass=function(){return ip};var ba=s(function(){this._nodeList=new Wn(this),this._pts=null,this._data=null;var h=arguments[0],f=arguments[1];this._pts=h,this._data=f},"gn");ba.prototype.getCoordinates=function(){return this._pts},ba.prototype.size=function(){return this._pts.length},ba.prototype.getCoordinate=function(h){return this._pts[h]},ba.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ba.prototype.getSegmentOctant=function(h){return h===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(h),this.getCoordinate(h+1))},ba.prototype.setData=function(h){this._data=h},ba.prototype.safeOctant=function(h,f){return h.equals2D(f)?0:pl.octant(h,f)},ba.prototype.getData=function(){return this._data},ba.prototype.addIntersection=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];this.addIntersectionNode(h,f)}else if(arguments.length===4){var _=arguments[0],A=arguments[1],R=arguments[3],H=new z(_.getIntersection(R));this.addIntersection(H,A)}},ba.prototype.toString=function(){return at.toLineString(new Ur(this._pts))},ba.prototype.getNodeList=function(){return this._nodeList},ba.prototype.addIntersectionNode=function(h,f){var _=f,A=_+1;if(A<this._pts.length){var R=this._pts[A];h.equals2D(R)&&(_=A)}return this._nodeList.add(h,_)},ba.prototype.addIntersections=function(h,f,_){for(var A=0;A<h.getIntersectionNum();A++)this.addIntersection(h,f,_,A)},ba.prototype.interfaces_=function(){return[ip]},ba.prototype.getClass=function(){return ba},ba.getNodedSubstrings=function(){if(arguments.length===1){var h=arguments[0],f=new le;return ba.getNodedSubstrings(h,f),f}if(arguments.length===2)for(var _=arguments[0],A=arguments[1],R=_.iterator();R.hasNext();)R.next().getNodeList().addSplitEdges(A)};var jr=s(function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new z,this.p1=new z;else if(arguments.length===1){var h=arguments[0];this.p0=new z(h.p0),this.p1=new z(h.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var f=arguments[0],_=arguments[1],A=arguments[2],R=arguments[3];this.p0=new z(f,_),this.p1=new z(A,R)}},"dn"),xS={serialVersionUID:{configurable:!0}};jr.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},jr.prototype.orientationIndex=function(){if(arguments[0]instanceof jr){var h=arguments[0],f=pt.orientationIndex(this.p0,this.p1,h.p0),_=pt.orientationIndex(this.p0,this.p1,h.p1);return f>=0&&_>=0||f<=0&&_<=0?Math.max(f,_):0}if(arguments[0]instanceof z){var A=arguments[0];return pt.orientationIndex(this.p0,this.p1,A)}},jr.prototype.toGeometry=function(h){return h.createLineString([this.p0,this.p1])},jr.prototype.isVertical=function(){return this.p0.x===this.p1.x},jr.prototype.equals=function(h){if(!(h instanceof jr))return!1;var f=h;return this.p0.equals(f.p0)&&this.p1.equals(f.p1)},jr.prototype.intersection=function(h){var f=new It;return f.computeIntersection(this.p0,this.p1,h.p0,h.p1),f.hasIntersection()?f.getIntersection(0):null},jr.prototype.project=function(){if(arguments[0]instanceof z){var h=arguments[0];if(h.equals(this.p0)||h.equals(this.p1))return new z(h);var f=this.projectionFactor(h),_=new z;return _.x=this.p0.x+f*(this.p1.x-this.p0.x),_.y=this.p0.y+f*(this.p1.y-this.p0.y),_}if(arguments[0]instanceof jr){var A=arguments[0],R=this.projectionFactor(A.p0),H=this.projectionFactor(A.p1);if(R>=1&&H>=1||R<=0&&H<=0)return null;var te=this.project(A.p0);R<0&&(te=this.p0),R>1&&(te=this.p1);var ge=this.project(A.p1);return H<0&&(ge=this.p0),H>1&&(ge=this.p1),new jr(te,ge)}},jr.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},jr.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},jr.prototype.getCoordinate=function(h){return h===0?this.p0:this.p1},jr.prototype.distancePerpendicular=function(h){return pt.distancePointLinePerpendicular(h,this.p0,this.p1)},jr.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},jr.prototype.midPoint=function(){return jr.midPoint(this.p0,this.p1)},jr.prototype.projectionFactor=function(h){if(h.equals(this.p0))return 0;if(h.equals(this.p1))return 1;var f=this.p1.x-this.p0.x,_=this.p1.y-this.p0.y,A=f*f+_*_;return A<=0?D.NaN:((h.x-this.p0.x)*f+(h.y-this.p0.y)*_)/A},jr.prototype.closestPoints=function(h){var f=this.intersection(h);if(f!==null)return[f,f];var _=new Array(2).fill(null),A=D.MAX_VALUE,R=null,H=this.closestPoint(h.p0);A=H.distance(h.p0),_[0]=H,_[1]=h.p0;var te=this.closestPoint(h.p1);(R=te.distance(h.p1))<A&&(A=R,_[0]=te,_[1]=h.p1);var ge=h.closestPoint(this.p0);(R=ge.distance(this.p0))<A&&(A=R,_[0]=this.p0,_[1]=ge);var Ne=h.closestPoint(this.p1);return(R=Ne.distance(this.p1))<A&&(A=R,_[0]=this.p1,_[1]=Ne),_},jr.prototype.closestPoint=function(h){var f=this.projectionFactor(h);return f>0&&f<1?this.project(h):this.p0.distance(h)<this.p1.distance(h)?this.p0:this.p1},jr.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},jr.prototype.getLength=function(){return this.p0.distance(this.p1)},jr.prototype.compareTo=function(h){var f=h,_=this.p0.compareTo(f.p0);return _!==0?_:this.p1.compareTo(f.p1)},jr.prototype.reverse=function(){var h=this.p0;this.p0=this.p1,this.p1=h},jr.prototype.equalsTopo=function(h){return this.p0.equals(h.p0)&&(this.p1.equals(h.p1)||this.p0.equals(h.p1))&&this.p1.equals(h.p0)},jr.prototype.lineIntersection=function(h){try{return me.intersection(this.p0,this.p1,h.p0,h.p1)}catch(f){if(!(f instanceof fe))throw f}return null},jr.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},jr.prototype.pointAlongOffset=function(h,f){var _=this.p0.x+h*(this.p1.x-this.p0.x),A=this.p0.y+h*(this.p1.y-this.p0.y),R=this.p1.x-this.p0.x,H=this.p1.y-this.p0.y,te=Math.sqrt(R*R+H*H),ge=0,Ne=0;if(f!==0){if(te<=0)throw new Error("Cannot compute offset from zero-length line segment");ge=f*R/te,Ne=f*H/te}return new z(_-Ne,A+ge)},jr.prototype.setCoordinates=function(){if(arguments.length===1){var h=arguments[0];this.setCoordinates(h.p0,h.p1)}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this.p0.x=f.x,this.p0.y=f.y,this.p1.x=_.x,this.p1.y=_.y}},jr.prototype.segmentFraction=function(h){var f=this.projectionFactor(h);return f<0?f=0:(f>1||D.isNaN(f))&&(f=1),f},jr.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},jr.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},jr.prototype.distance=function(){if(arguments[0]instanceof jr){var h=arguments[0];return pt.distanceLineLine(this.p0,this.p1,h.p0,h.p1)}if(arguments[0]instanceof z){var f=arguments[0];return pt.distancePointLine(f,this.p0,this.p1)}},jr.prototype.pointAlong=function(h){var f=new z;return f.x=this.p0.x+h*(this.p1.x-this.p0.x),f.y=this.p0.y+h*(this.p1.y-this.p0.y),f},jr.prototype.hashCode=function(){var h=D.doubleToLongBits(this.p0.x);h^=31*D.doubleToLongBits(this.p0.y);var f=Math.trunc(h)^Math.trunc(h>>32),_=D.doubleToLongBits(this.p1.x);return _^=31*D.doubleToLongBits(this.p1.y),f^(Math.trunc(_)^Math.trunc(_>>32))},jr.prototype.interfaces_=function(){return[k,i]},jr.prototype.getClass=function(){return jr},jr.midPoint=function(h,f){return new z((h.x+f.x)/2,(h.y+f.y)/2)},xS.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(jr,xS);var xg=s(function(){this.tempEnv1=new Ae,this.tempEnv2=new Ae,this._overlapSeg1=new jr,this._overlapSeg2=new jr},"_n");xg.prototype.overlap=function(){if(arguments.length!==2&&arguments.length===4){var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];h.getLineSegment(f,this._overlapSeg1),_.getLineSegment(A,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},xg.prototype.interfaces_=function(){return[]},xg.prototype.getClass=function(){return xg};var Is=s(function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];this._pts=h,this._start=f,this._end=_,this._context=A},"mn");Is.prototype.getLineSegment=function(h,f){f.p0=this._pts[h],f.p1=this._pts[h+1]},Is.prototype.computeSelect=function(h,f,_,A){var R=this._pts[f],H=this._pts[_];if(A.tempEnv1.init(R,H),_-f==1)return A.select(this,f),null;if(!h.intersects(A.tempEnv1))return null;var te=Math.trunc((f+_)/2);f<te&&this.computeSelect(h,f,te,A),te<_&&this.computeSelect(h,te,_,A)},Is.prototype.getCoordinates=function(){for(var h=new Array(this._end-this._start+1).fill(null),f=0,_=this._start;_<=this._end;_++)h[f++]=this._pts[_];return h},Is.prototype.computeOverlaps=function(h,f){this.computeOverlapsInternal(this._start,this._end,h,h._start,h._end,f)},Is.prototype.setId=function(h){this._id=h},Is.prototype.select=function(h,f){this.computeSelect(h,this._start,this._end,f)},Is.prototype.getEnvelope=function(){if(this._env===null){var h=this._pts[this._start],f=this._pts[this._end];this._env=new Ae(h,f)}return this._env},Is.prototype.getEndIndex=function(){return this._end},Is.prototype.getStartIndex=function(){return this._start},Is.prototype.getContext=function(){return this._context},Is.prototype.getId=function(){return this._id},Is.prototype.computeOverlapsInternal=function(h,f,_,A,R,H){var te=this._pts[h],ge=this._pts[f],Ne=_._pts[A],Ye=_._pts[R];if(f-h==1&&R-A==1)return H.overlap(this,h,_,A),null;if(H.tempEnv1.init(te,ge),H.tempEnv2.init(Ne,Ye),!H.tempEnv1.intersects(H.tempEnv2))return null;var Mt=Math.trunc((h+f)/2),At=Math.trunc((A+R)/2);h<Mt&&(A<At&&this.computeOverlapsInternal(h,Mt,_,A,At,H),At<R&&this.computeOverlapsInternal(h,Mt,_,At,R,H)),Mt<f&&(A<At&&this.computeOverlapsInternal(Mt,f,_,A,At,H),At<R&&this.computeOverlapsInternal(Mt,f,_,At,R,H))},Is.prototype.interfaces_=function(){return[]},Is.prototype.getClass=function(){return Is};var ou=s(function(){},"vn");ou.prototype.interfaces_=function(){return[]},ou.prototype.getClass=function(){return ou},ou.getChainStartIndices=function(h){var f=0,_=new le;_.add(new ee(f));do{var A=ou.findChainEnd(h,f);_.add(new ee(A)),f=A}while(f<h.length-1);return ou.toIntArray(_)},ou.findChainEnd=function(h,f){for(var _=f;_<h.length-1&&h[_].equals2D(h[_+1]);)_++;if(_>=h.length-1)return h.length-1;for(var A=li.quadrant(h[_],h[_+1]),R=f+1;R<h.length&&!(!h[R-1].equals2D(h[R])&&li.quadrant(h[R-1],h[R])!==A);)R++;return R-1},ou.getChains=function(){if(arguments.length===1){var h=arguments[0];return ou.getChains(h,null)}if(arguments.length===2){for(var f=arguments[0],_=arguments[1],A=new le,R=ou.getChainStartIndices(f),H=0;H<R.length-1;H++){var te=new Is(f,R[H],R[H+1],_);A.add(te)}return A}},ou.toIntArray=function(h){for(var f=new Array(h.size()).fill(null),_=0;_<f.length;_++)f[_]=h.get(_).intValue();return f};var Ic=s(function(){},"In");Ic.prototype.computeNodes=function(h){},Ic.prototype.getNodedSubstrings=function(){},Ic.prototype.interfaces_=function(){return[]},Ic.prototype.getClass=function(){return Ic};var bg=s(function(){if(this._segInt=null,arguments.length!==0&&arguments.length===1){var h=arguments[0];this.setSegmentIntersector(h)}},"En");bg.prototype.setSegmentIntersector=function(h){this._segInt=h},bg.prototype.interfaces_=function(){return[Ic]},bg.prototype.getClass=function(){return bg};var Vx=function(h){function f(A){A?h.call(this,A):h.call(this),this._monoChains=new le,this._index=new mi,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}s(f,"e"),h&&(f.__proto__=h),(f.prototype=Object.create(h&&h.prototype)).constructor=f;var _={SegmentOverlapAction:{configurable:!0}};return f.prototype.getMonotoneChains=function(){return this._monoChains},f.prototype.getNodedSubstrings=function(){return ba.getNodedSubstrings(this._nodedSegStrings)},f.prototype.getIndex=function(){return this._index},f.prototype.add=function(A){for(var R=ou.getChains(A.getCoordinates(),A).iterator();R.hasNext();){var H=R.next();H.setId(this._idCounter++),this._index.insert(H.getEnvelope(),H),this._monoChains.add(H)}},f.prototype.computeNodes=function(A){this._nodedSegStrings=A;for(var R=A.iterator();R.hasNext();)this.add(R.next());this.intersectChains()},f.prototype.intersectChains=function(){for(var A=new bS(this._segInt),R=this._monoChains.iterator();R.hasNext();)for(var H=R.next(),te=this._index.query(H.getEnvelope()).iterator();te.hasNext();){var ge=te.next();if(ge.getId()>H.getId()&&(H.computeOverlaps(ge,A),this._nOverlaps++),this._segInt.isDone())return null}},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},_.SegmentOverlapAction.get=function(){return bS},Object.defineProperties(f,_),f}(bg),bS=function(h){function f(){h.call(this),this._si=null;var _=arguments[0];this._si=_}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.overlap=function(){if(arguments.length!==4)return h.prototype.overlap.apply(this,arguments);var _=arguments[0],A=arguments[1],R=arguments[2],H=arguments[3],te=_.getContext(),ge=R.getContext();this._si.processIntersections(te,A,ge,H)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(xg),Wi=s(function h(){if(this._quadrantSegments=h.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=h.CAP_ROUND,this._joinStyle=h.JOIN_ROUND,this._mitreLimit=h.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=h.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var f=arguments[0];this.setQuadrantSegments(f)}else if(arguments.length===2){var _=arguments[0],A=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(A)}else if(arguments.length===4){var R=arguments[0],H=arguments[1],te=arguments[2],ge=arguments[3];this.setQuadrantSegments(R),this.setEndCapStyle(H),this.setJoinStyle(te),this.setMitreLimit(ge)}}},"t"),Tc={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Wi.prototype.getEndCapStyle=function(){return this._endCapStyle},Wi.prototype.isSingleSided=function(){return this._isSingleSided},Wi.prototype.setQuadrantSegments=function(h){this._quadrantSegments=h,this._quadrantSegments===0&&(this._joinStyle=Wi.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Wi.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),h<=0&&(this._quadrantSegments=1),this._joinStyle!==Wi.JOIN_ROUND&&(this._quadrantSegments=Wi.DEFAULT_QUADRANT_SEGMENTS)},Wi.prototype.getJoinStyle=function(){return this._joinStyle},Wi.prototype.setJoinStyle=function(h){this._joinStyle=h},Wi.prototype.setSimplifyFactor=function(h){this._simplifyFactor=h<0?0:h},Wi.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Wi.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Wi.prototype.setEndCapStyle=function(h){this._endCapStyle=h},Wi.prototype.getMitreLimit=function(){return this._mitreLimit},Wi.prototype.setMitreLimit=function(h){this._mitreLimit=h},Wi.prototype.setSingleSided=function(h){this._isSingleSided=h},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi},Wi.bufferDistanceError=function(h){var f=Math.PI/2/h;return 1-Math.cos(f/2)},Tc.CAP_ROUND.get=function(){return 1},Tc.CAP_FLAT.get=function(){return 2},Tc.CAP_SQUARE.get=function(){return 3},Tc.JOIN_ROUND.get=function(){return 1},Tc.JOIN_MITRE.get=function(){return 2},Tc.JOIN_BEVEL.get=function(){return 3},Tc.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Tc.DEFAULT_MITRE_LIMIT.get=function(){return 5},Tc.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(Wi,Tc);var la=s(function(h){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=pt.COUNTERCLOCKWISE,this._inputLine=h||null},"Ln"),wg={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};la.prototype.isDeletable=function(h,f,_,A){var R=this._inputLine[h],H=this._inputLine[f],te=this._inputLine[_];return!!this.isConcave(R,H,te)&&!!this.isShallow(R,H,te,A)&&this.isShallowSampled(R,H,h,_,A)},la.prototype.deleteShallowConcavities=function(){for(var h=1,f=this.findNextNonDeletedIndex(h),_=this.findNextNonDeletedIndex(f),A=!1;_<this._inputLine.length;){var R=!1;this.isDeletable(h,f,_,this._distanceTol)&&(this._isDeleted[f]=la.DELETE,R=!0,A=!0),h=R?_:f,f=this.findNextNonDeletedIndex(h),_=this.findNextNonDeletedIndex(f)}return A},la.prototype.isShallowConcavity=function(h,f,_,A){return pt.computeOrientation(h,f,_)!==this._angleOrientation?!1:pt.distancePointLine(f,h,_)<A},la.prototype.isShallowSampled=function(h,f,_,A,R){var H=Math.trunc((A-_)/la.NUM_PTS_TO_CHECK);H<=0&&(H=1);for(var te=_;te<A;te+=H)if(!this.isShallow(h,f,this._inputLine[te],R))return!1;return!0},la.prototype.isConcave=function(h,f,_){var A=pt.computeOrientation(h,f,_)===this._angleOrientation;return A},la.prototype.simplify=function(h){this._distanceTol=Math.abs(h),h<0&&(this._angleOrientation=pt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var f=!1;do f=this.deleteShallowConcavities();while(f);return this.collapseLine()},la.prototype.findNextNonDeletedIndex=function(h){for(var f=h+1;f<this._inputLine.length&&this._isDeleted[f]===la.DELETE;)f++;return f},la.prototype.isShallow=function(h,f,_,A){return pt.distancePointLine(f,h,_)<A},la.prototype.collapseLine=function(){for(var h=new ze,f=0;f<this._inputLine.length;f++)this._isDeleted[f]!==la.DELETE&&h.add(this._inputLine[f]);return h.toCoordinateArray()},la.prototype.interfaces_=function(){return[]},la.prototype.getClass=function(){return la},la.simplify=function(h,f){return new la(h).simplify(f)},wg.INIT.get=function(){return 0},wg.DELETE.get=function(){return 1},wg.KEEP.get=function(){return 1},wg.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(la,wg);var Ws=s(function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new le},"wn"),wS={COORDINATE_ARRAY_TYPE:{configurable:!0}};Ws.prototype.getCoordinates=function(){return this._ptList.toArray(Ws.COORDINATE_ARRAY_TYPE)},Ws.prototype.setPrecisionModel=function(h){this._precisionModel=h},Ws.prototype.addPt=function(h){var f=new z(h);if(this._precisionModel.makePrecise(f),this.isRedundant(f))return null;this._ptList.add(f)},Ws.prototype.revere=function(){},Ws.prototype.addPts=function(h,f){if(f)for(var _=0;_<h.length;_++)this.addPt(h[_]);else for(var A=h.length-1;A>=0;A--)this.addPt(h[A])},Ws.prototype.isRedundant=function(h){if(this._ptList.size()<1)return!1;var f=this._ptList.get(this._ptList.size()-1);return h.distance(f)<this._minimimVertexDistance},Ws.prototype.toString=function(){return new Gr().createLineString(this.getCoordinates()).toString()},Ws.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var h=new z(this._ptList.get(0)),f=this._ptList.get(this._ptList.size()-1);if(h.equals(f))return null;this._ptList.add(h)},Ws.prototype.setMinimumVertexDistance=function(h){this._minimimVertexDistance=h},Ws.prototype.interfaces_=function(){return[]},Ws.prototype.getClass=function(){return Ws},wS.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Ws,wS);var Fi=s(function(){},"Tn"),cd={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Fi.prototype.interfaces_=function(){return[]},Fi.prototype.getClass=function(){return Fi},Fi.toDegrees=function(h){return 180*h/Math.PI},Fi.normalize=function(h){for(;h>Math.PI;)h-=Fi.PI_TIMES_2;for(;h<=-Math.PI;)h+=Fi.PI_TIMES_2;return h},Fi.angle=function(){if(arguments.length===1){var h=arguments[0];return Math.atan2(h.y,h.x)}if(arguments.length===2){var f=arguments[0],_=arguments[1],A=_.x-f.x,R=_.y-f.y;return Math.atan2(R,A)}},Fi.isAcute=function(h,f,_){var A=h.x-f.x,R=h.y-f.y;return A*(_.x-f.x)+R*(_.y-f.y)>0},Fi.isObtuse=function(h,f,_){var A=h.x-f.x,R=h.y-f.y;return A*(_.x-f.x)+R*(_.y-f.y)<0},Fi.interiorAngle=function(h,f,_){var A=Fi.angle(f,h),R=Fi.angle(f,_);return Math.abs(R-A)},Fi.normalizePositive=function(h){if(h<0){for(;h<0;)h+=Fi.PI_TIMES_2;h>=Fi.PI_TIMES_2&&(h=0)}else{for(;h>=Fi.PI_TIMES_2;)h-=Fi.PI_TIMES_2;h<0&&(h=0)}return h},Fi.angleBetween=function(h,f,_){var A=Fi.angle(f,h),R=Fi.angle(f,_);return Fi.diff(A,R)},Fi.diff=function(h,f){var _=null;return(_=h<f?f-h:h-f)>Math.PI&&(_=2*Math.PI-_),_},Fi.toRadians=function(h){return h*Math.PI/180},Fi.getTurn=function(h,f){var _=Math.sin(f-h);return _>0?Fi.COUNTERCLOCKWISE:_<0?Fi.CLOCKWISE:Fi.NONE},Fi.angleBetweenOriented=function(h,f,_){var A=Fi.angle(f,h),R=Fi.angle(f,_)-A;return R<=-Math.PI?R+Fi.PI_TIMES_2:R>Math.PI?R-Fi.PI_TIMES_2:R},cd.PI_TIMES_2.get=function(){return 2*Math.PI},cd.PI_OVER_2.get=function(){return Math.PI/2},cd.PI_OVER_4.get=function(){return Math.PI/4},cd.COUNTERCLOCKWISE.get=function(){return pt.COUNTERCLOCKWISE},cd.CLOCKWISE.get=function(){return pt.CLOCKWISE},cd.NONE.get=function(){return pt.COLLINEAR},Object.defineProperties(Fi,cd);var Vn=s(function h(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new jr,this._seg1=new jr,this._offset0=new jr,this._offset1=new jr,this._side=0,this._hasNarrowConcaveAngle=!1;var f=arguments[0],_=arguments[1],A=arguments[2];this._precisionModel=f,this._bufParams=_,this._li=new It,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===Wi.JOIN_ROUND&&(this._closingSegLengthFactor=h.MAX_CLOSING_SEG_LEN_FACTOR),this.init(A)},"t"),Ag={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Vn.prototype.addNextSegment=function(h,f){if(this._s0=this._s1,this._s1=this._s2,this._s2=h,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var _=pt.computeOrientation(this._s0,this._s1,this._s2),A=_===pt.CLOCKWISE&&this._side===Te.LEFT||_===pt.COUNTERCLOCKWISE&&this._side===Te.RIGHT;_===0?this.addCollinear(f):A?this.addOutsideTurn(_,f):this.addInsideTurn(_,f)},Vn.prototype.addLineEndCap=function(h,f){var _=new jr(h,f),A=new jr;this.computeOffsetSegment(_,Te.LEFT,this._distance,A);var R=new jr;this.computeOffsetSegment(_,Te.RIGHT,this._distance,R);var H=f.x-h.x,te=f.y-h.y,ge=Math.atan2(te,H);switch(this._bufParams.getEndCapStyle()){case Wi.CAP_ROUND:this._segList.addPt(A.p1),this.addFilletArc(f,ge+Math.PI/2,ge-Math.PI/2,pt.CLOCKWISE,this._distance),this._segList.addPt(R.p1);break;case Wi.CAP_FLAT:this._segList.addPt(A.p1),this._segList.addPt(R.p1);break;case Wi.CAP_SQUARE:var Ne=new z;Ne.x=Math.abs(this._distance)*Math.cos(ge),Ne.y=Math.abs(this._distance)*Math.sin(ge);var Ye=new z(A.p1.x+Ne.x,A.p1.y+Ne.y),Mt=new z(R.p1.x+Ne.x,R.p1.y+Ne.y);this._segList.addPt(Ye),this._segList.addPt(Mt)}},Vn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Vn.prototype.addMitreJoin=function(h,f,_,A){var R=!0,H=null;try{H=me.intersection(f.p0,f.p1,_.p0,_.p1),(A<=0?1:H.distance(h)/Math.abs(A))>this._bufParams.getMitreLimit()&&(R=!1)}catch(te){if(!(te instanceof fe))throw te;H=new z(0,0),R=!1}R?this._segList.addPt(H):this.addLimitedMitreJoin(f,_,A,this._bufParams.getMitreLimit())},Vn.prototype.addFilletCorner=function(h,f,_,A,R){var H=f.x-h.x,te=f.y-h.y,ge=Math.atan2(te,H),Ne=_.x-h.x,Ye=_.y-h.y,Mt=Math.atan2(Ye,Ne);A===pt.CLOCKWISE?ge<=Mt&&(ge+=2*Math.PI):ge>=Mt&&(ge-=2*Math.PI),this._segList.addPt(f),this.addFilletArc(h,ge,Mt,A,R),this._segList.addPt(_)},Vn.prototype.addOutsideTurn=function(h,f){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Vn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Wi.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Wi.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(f&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,h,this._distance),this._segList.addPt(this._offset1.p0))},Vn.prototype.createSquare=function(h){this._segList.addPt(new z(h.x+this._distance,h.y+this._distance)),this._segList.addPt(new z(h.x+this._distance,h.y-this._distance)),this._segList.addPt(new z(h.x-this._distance,h.y-this._distance)),this._segList.addPt(new z(h.x-this._distance,h.y+this._distance)),this._segList.closeRing()},Vn.prototype.addSegments=function(h,f){this._segList.addPts(h,f)},Vn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Vn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Vn.prototype.initSideSegments=function(h,f,_){this._s1=h,this._s2=f,this._side=_,this._seg1.setCoordinates(h,f),this.computeOffsetSegment(this._seg1,_,this._distance,this._offset1)},Vn.prototype.addLimitedMitreJoin=function(h,f,_,A){var R=this._seg0.p1,H=Fi.angle(R,this._seg0.p0),te=Fi.angleBetweenOriented(this._seg0.p0,R,this._seg1.p1)/2,ge=Fi.normalize(H+te),Ne=Fi.normalize(ge+Math.PI),Ye=A*_,Mt=_-Ye*Math.abs(Math.sin(te)),At=R.x+Ye*Math.cos(Ne),hr=R.y+Ye*Math.sin(Ne),gr=new z(At,hr),Sr=new jr(R,gr),Kr=Sr.pointAlongOffset(1,Mt),Vi=Sr.pointAlongOffset(1,-Mt);this._side===Te.LEFT?(this._segList.addPt(Kr),this._segList.addPt(Vi)):(this._segList.addPt(Vi),this._segList.addPt(Kr))},Vn.prototype.computeOffsetSegment=function(h,f,_,A){var R=f===Te.LEFT?1:-1,H=h.p1.x-h.p0.x,te=h.p1.y-h.p0.y,ge=Math.sqrt(H*H+te*te),Ne=R*_*H/ge,Ye=R*_*te/ge;A.p0.x=h.p0.x-Ye,A.p0.y=h.p0.y+Ne,A.p1.x=h.p1.x-Ye,A.p1.y=h.p1.y+Ne},Vn.prototype.addFilletArc=function(h,f,_,A,R){var H=A===pt.CLOCKWISE?-1:1,te=Math.abs(f-_),ge=Math.trunc(te/this._filletAngleQuantum+.5);if(ge<1)return null;for(var Ne=te/ge,Ye=0,Mt=new z;Ye<te;){var At=f+H*Ye;Mt.x=h.x+R*Math.cos(At),Mt.y=h.y+R*Math.sin(At),this._segList.addPt(Mt),Ye+=Ne}},Vn.prototype.addInsideTurn=function(h,f){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Vn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var _=new z((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_);var A=new z((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(A)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Vn.prototype.createCircle=function(h){var f=new z(h.x+this._distance,h.y);this._segList.addPt(f),this.addFilletArc(h,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Vn.prototype.addBevelJoin=function(h,f){this._segList.addPt(h.p1),this._segList.addPt(f.p0)},Vn.prototype.init=function(h){this._distance=h,this._maxCurveSegmentError=h*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ws,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(h*Vn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Vn.prototype.addCollinear=function(h){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Wi.JOIN_BEVEL||this._bufParams.getJoinStyle()===Wi.JOIN_MITRE?(h&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,pt.CLOCKWISE,this._distance))},Vn.prototype.closeRing=function(){this._segList.closeRing()},Vn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn},Ag.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Ag.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Ag.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ag.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Vn,Ag);var Po=s(function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var h=arguments[0],f=arguments[1];this._precisionModel=h,this._bufParams=f},"Mn");Po.prototype.getOffsetCurve=function(h,f){if(this._distance=f,f===0)return null;var _=f<0,A=Math.abs(f),R=this.getSegGen(A);h.length<=1?this.computePointCurve(h[0],R):this.computeOffsetCurve(h,_,R);var H=R.getCoordinates();return _&&De.reverse(H),H},Po.prototype.computeSingleSidedBufferCurve=function(h,f,_){var A=this.simplifyTolerance(this._distance);if(f){_.addSegments(h,!0);var R=la.simplify(h,-A),H=R.length-1;_.initSideSegments(R[H],R[H-1],Te.LEFT),_.addFirstSegment();for(var te=H-2;te>=0;te--)_.addNextSegment(R[te],!0)}else{_.addSegments(h,!1);var ge=la.simplify(h,A),Ne=ge.length-1;_.initSideSegments(ge[0],ge[1],Te.LEFT),_.addFirstSegment();for(var Ye=2;Ye<=Ne;Ye++)_.addNextSegment(ge[Ye],!0)}_.addLastSegment(),_.closeRing()},Po.prototype.computeRingBufferCurve=function(h,f,_){var A=this.simplifyTolerance(this._distance);f===Te.RIGHT&&(A=-A);var R=la.simplify(h,A),H=R.length-1;_.initSideSegments(R[H-1],R[0],f);for(var te=1;te<=H;te++){var ge=te!==1;_.addNextSegment(R[te],ge)}_.closeRing()},Po.prototype.computeLineBufferCurve=function(h,f){var _=this.simplifyTolerance(this._distance),A=la.simplify(h,_),R=A.length-1;f.initSideSegments(A[0],A[1],Te.LEFT);for(var H=2;H<=R;H++)f.addNextSegment(A[H],!0);f.addLastSegment(),f.addLineEndCap(A[R-1],A[R]);var te=la.simplify(h,-_),ge=te.length-1;f.initSideSegments(te[ge],te[ge-1],Te.LEFT);for(var Ne=ge-2;Ne>=0;Ne--)f.addNextSegment(te[Ne],!0);f.addLastSegment(),f.addLineEndCap(te[1],te[0]),f.closeRing()},Po.prototype.computePointCurve=function(h,f){switch(this._bufParams.getEndCapStyle()){case Wi.CAP_ROUND:f.createCircle(h);break;case Wi.CAP_SQUARE:f.createSquare(h)}},Po.prototype.getLineCurve=function(h,f){if(this._distance=f,f<0&&!this._bufParams.isSingleSided()||f===0)return null;var _=Math.abs(f),A=this.getSegGen(_);if(h.length<=1)this.computePointCurve(h[0],A);else if(this._bufParams.isSingleSided()){var R=f<0;this.computeSingleSidedBufferCurve(h,R,A)}else this.computeLineBufferCurve(h,A);return A.getCoordinates()},Po.prototype.getBufferParameters=function(){return this._bufParams},Po.prototype.simplifyTolerance=function(h){return h*this._bufParams.getSimplifyFactor()},Po.prototype.getRingCurve=function(h,f,_){if(this._distance=_,h.length<=2)return this.getLineCurve(h,_);if(_===0)return Po.copyCoordinates(h);var A=this.getSegGen(_);return this.computeRingBufferCurve(h,f,A),A.getCoordinates()},Po.prototype.computeOffsetCurve=function(h,f,_){var A=this.simplifyTolerance(this._distance);if(f){var R=la.simplify(h,-A),H=R.length-1;_.initSideSegments(R[H],R[H-1],Te.LEFT),_.addFirstSegment();for(var te=H-2;te>=0;te--)_.addNextSegment(R[te],!0)}else{var ge=la.simplify(h,A),Ne=ge.length-1;_.initSideSegments(ge[0],ge[1],Te.LEFT),_.addFirstSegment();for(var Ye=2;Ye<=Ne;Ye++)_.addNextSegment(ge[Ye],!0)}_.addLastSegment()},Po.prototype.getSegGen=function(h){return new Vn(this._precisionModel,this._bufParams,h)},Po.prototype.interfaces_=function(){return[]},Po.prototype.getClass=function(){return Po},Po.copyCoordinates=function(h){for(var f=new Array(h.length).fill(null),_=0;_<f.length;_++)f[_]=new z(h[_]);return f};var Wu=s(function(){this._subgraphs=null,this._seg=new jr,this._cga=new pt;var h=arguments[0];this._subgraphs=h},"An"),AS={DepthSegment:{configurable:!0}};Wu.prototype.findStabbedSegments=function(){if(arguments.length===1){for(var h=arguments[0],f=new le,_=this._subgraphs.iterator();_.hasNext();){var A=_.next(),R=A.getEnvelope();h.y<R.getMinY()||h.y>R.getMaxY()||this.findStabbedSegments(h,A.getDirectedEdges(),f)}return f}if(arguments.length===3){if(Y(arguments[2],oe)&&arguments[0]instanceof z&&arguments[1]instanceof _o){for(var H=arguments[0],te=arguments[1],ge=arguments[2],Ne=te.getEdge().getCoordinates(),Ye=0;Ye<Ne.length-1;Ye++)if(this._seg.p0=Ne[Ye],this._seg.p1=Ne[Ye+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<H.x)&&!(this._seg.isHorizontal()||H.y<this._seg.p0.y||H.y>this._seg.p1.y||pt.computeOrientation(this._seg.p0,this._seg.p1,H)===pt.RIGHT)){var Mt=te.getDepth(Te.LEFT);this._seg.p0.equals(Ne[Ye])||(Mt=te.getDepth(Te.RIGHT));var At=new sh(this._seg,Mt);ge.add(At)}}else if(Y(arguments[2],oe)&&arguments[0]instanceof z&&Y(arguments[1],oe))for(var hr=arguments[0],gr=arguments[1],Sr=arguments[2],Kr=gr.iterator();Kr.hasNext();){var Vi=Kr.next();Vi.isForward()&&this.findStabbedSegments(hr,Vi,Sr)}}},Wu.prototype.getDepth=function(h){var f=this.findStabbedSegments(h);return f.size()===0?0:Ge.min(f)._leftDepth},Wu.prototype.interfaces_=function(){return[]},Wu.prototype.getClass=function(){return Wu},AS.DepthSegment.get=function(){return sh},Object.defineProperties(Wu,AS);var sh=s(function(){this._upwardSeg=null,this._leftDepth=null;var h=arguments[0],f=arguments[1];this._upwardSeg=new jr(h),this._leftDepth=f},"Gn");sh.prototype.compareTo=function(h){var f=h;if(this._upwardSeg.minX()>=f._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=f._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(f._upwardSeg);return _!==0||(_=-1*f._upwardSeg.orientationIndex(this._upwardSeg))!=0?_:this._upwardSeg.compareTo(f._upwardSeg)},sh.prototype.compareX=function(h,f){var _=h.p0.compareTo(f.p0);return _!==0?_:h.p1.compareTo(f.p1)},sh.prototype.toString=function(){return this._upwardSeg.toString()},sh.prototype.interfaces_=function(){return[k]},sh.prototype.getClass=function(){return sh};var Xi=s(function(h,f,_){this.p0=h||null,this.p1=f||null,this.p2=_||null},"qn");Xi.prototype.area=function(){return Xi.area(this.p0,this.p1,this.p2)},Xi.prototype.signedArea=function(){return Xi.signedArea(this.p0,this.p1,this.p2)},Xi.prototype.interpolateZ=function(h){if(h===null)throw new T("Supplied point is null.");return Xi.interpolateZ(h,this.p0,this.p1,this.p2)},Xi.prototype.longestSideLength=function(){return Xi.longestSideLength(this.p0,this.p1,this.p2)},Xi.prototype.isAcute=function(){return Xi.isAcute(this.p0,this.p1,this.p2)},Xi.prototype.circumcentre=function(){return Xi.circumcentre(this.p0,this.p1,this.p2)},Xi.prototype.area3D=function(){return Xi.area3D(this.p0,this.p1,this.p2)},Xi.prototype.centroid=function(){return Xi.centroid(this.p0,this.p1,this.p2)},Xi.prototype.inCentre=function(){return Xi.inCentre(this.p0,this.p1,this.p2)},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi},Xi.area=function(h,f,_){return Math.abs(((_.x-h.x)*(f.y-h.y)-(f.x-h.x)*(_.y-h.y))/2)},Xi.signedArea=function(h,f,_){return((_.x-h.x)*(f.y-h.y)-(f.x-h.x)*(_.y-h.y))/2},Xi.det=function(h,f,_,A){return h*A-f*_},Xi.interpolateZ=function(h,f,_,A){var R=f.x,H=f.y,te=_.x-R,ge=A.x-R,Ne=_.y-H,Ye=A.y-H,Mt=te*Ye-ge*Ne,At=h.x-R,hr=h.y-H,gr=(Ye*At-ge*hr)/Mt,Sr=(-Ne*At+te*hr)/Mt;return f.z+gr*(_.z-f.z)+Sr*(A.z-f.z)},Xi.longestSideLength=function(h,f,_){var A=h.distance(f),R=f.distance(_),H=_.distance(h),te=A;return R>te&&(te=R),H>te&&(te=H),te},Xi.isAcute=function(h,f,_){return!!Fi.isAcute(h,f,_)&&!!Fi.isAcute(f,_,h)&&!!Fi.isAcute(_,h,f)},Xi.circumcentre=function(h,f,_){var A=_.x,R=_.y,H=h.x-A,te=h.y-R,ge=f.x-A,Ne=f.y-R,Ye=2*Xi.det(H,te,ge,Ne),Mt=Xi.det(te,H*H+te*te,Ne,ge*ge+Ne*Ne),At=Xi.det(H,H*H+te*te,ge,ge*ge+Ne*Ne);return new z(A-Mt/Ye,R+At/Ye)},Xi.perpendicularBisector=function(h,f){var _=f.x-h.x,A=f.y-h.y,R=new me(h.x+_/2,h.y+A/2,1),H=new me(h.x-A+_/2,h.y+_+A/2,1);return new me(R,H)},Xi.angleBisector=function(h,f,_){var A=f.distance(h),R=A/(A+f.distance(_)),H=_.x-h.x,te=_.y-h.y;return new z(h.x+R*H,h.y+R*te)},Xi.area3D=function(h,f,_){var A=f.x-h.x,R=f.y-h.y,H=f.z-h.z,te=_.x-h.x,ge=_.y-h.y,Ne=_.z-h.z,Ye=R*Ne-H*ge,Mt=H*te-A*Ne,At=A*ge-R*te,hr=Ye*Ye+Mt*Mt+At*At,gr=Math.sqrt(hr)/2;return gr},Xi.centroid=function(h,f,_){var A=(h.x+f.x+_.x)/3,R=(h.y+f.y+_.y)/3;return new z(A,R)},Xi.inCentre=function(h,f,_){var A=f.distance(_),R=h.distance(_),H=h.distance(f),te=A+R+H,ge=(A*h.x+R*f.x+H*_.x)/te,Ne=(A*h.y+R*f.y+H*_.y)/te;return new z(ge,Ne)};var Xs=s(function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new le;var h=arguments[0],f=arguments[1],_=arguments[2];this._inputGeom=h,this._distance=f,this._curveBuilder=_},"Bn");Xs.prototype.addPoint=function(h){if(this._distance<=0)return null;var f=h.getCoordinates(),_=this._curveBuilder.getLineCurve(f,this._distance);this.addCurve(_,V.EXTERIOR,V.INTERIOR)},Xs.prototype.addPolygon=function(h){var f=this._distance,_=Te.LEFT;this._distance<0&&(f=-this._distance,_=Te.RIGHT);var A=h.getExteriorRing(),R=De.removeRepeatedPoints(A.getCoordinates());if(this._distance<0&&this.isErodedCompletely(A,this._distance)||this._distance<=0&&R.length<3)return null;this.addPolygonRing(R,f,_,V.EXTERIOR,V.INTERIOR);for(var H=0;H<h.getNumInteriorRing();H++){var te=h.getInteriorRingN(H),ge=De.removeRepeatedPoints(te.getCoordinates());this._distance>0&&this.isErodedCompletely(te,-this._distance)||this.addPolygonRing(ge,f,Te.opposite(_),V.INTERIOR,V.EXTERIOR)}},Xs.prototype.isTriangleErodedCompletely=function(h,f){var _=new Xi(h[0],h[1],h[2]),A=_.inCentre();return pt.distancePointLine(A,_.p0,_.p1)<Math.abs(f)},Xs.prototype.addLineString=function(h){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var f=De.removeRepeatedPoints(h.getCoordinates()),_=this._curveBuilder.getLineCurve(f,this._distance);this.addCurve(_,V.EXTERIOR,V.INTERIOR)},Xs.prototype.addCurve=function(h,f,_){if(h===null||h.length<2)return null;var A=new ba(h,new lr(0,V.BOUNDARY,f,_));this._curveList.add(A)},Xs.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Xs.prototype.addPolygonRing=function(h,f,_,A,R){if(f===0&&h.length<ur.MINIMUM_VALID_SIZE)return null;var H=A,te=R;h.length>=ur.MINIMUM_VALID_SIZE&&pt.isCCW(h)&&(H=R,te=A,_=Te.opposite(_));var ge=this._curveBuilder.getRingCurve(h,_,f);this.addCurve(ge,H,te)},Xs.prototype.add=function(h){if(h.isEmpty())return null;h instanceof zt?this.addPolygon(h):h instanceof Je?this.addLineString(h):h instanceof ft?this.addPoint(h):h instanceof cr?this.addCollection(h):h instanceof Mi?this.addCollection(h):h instanceof Ar?this.addCollection(h):h instanceof Cr&&this.addCollection(h)},Xs.prototype.isErodedCompletely=function(h,f){var _=h.getCoordinates();if(_.length<4)return f<0;if(_.length===4)return this.isTriangleErodedCompletely(_,f);var A=h.getEnvelopeInternal(),R=Math.min(A.getHeight(),A.getWidth());return f<0&&2*Math.abs(f)>R},Xs.prototype.addCollection=function(h){for(var f=0;f<h.getNumGeometries();f++){var _=h.getGeometryN(f);this.add(_)}},Xs.prototype.interfaces_=function(){return[]},Xs.prototype.getClass=function(){return Xs};var hd=s(function(){},"Vn");hd.prototype.locate=function(h){},hd.prototype.interfaces_=function(){return[]},hd.prototype.getClass=function(){return hd};var su=s(function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var h=arguments[0];this._parent=h,this._atStart=!0,this._index=0,this._max=h.getNumGeometries()},"Un");su.prototype.next=function(){if(this._atStart)return this._atStart=!1,su.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new a;var h=this._parent.getGeometryN(this._index++);return h instanceof Cr?(this._subcollectionIterator=new su(h),this._subcollectionIterator.next()):h},su.prototype.remove=function(){throw new Error(this.getClass().getName())},su.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},su.prototype.interfaces_=function(){return[Oe]},su.prototype.getClass=function(){return su},su.isAtomic=function(h){return!(h instanceof Cr)};var xo=s(function(){this._geom=null;var h=arguments[0];this._geom=h},"zn");xo.prototype.locate=function(h){return xo.locate(h,this._geom)},xo.prototype.interfaces_=function(){return[hd]},xo.prototype.getClass=function(){return xo},xo.isPointInRing=function(h,f){return!!f.getEnvelopeInternal().intersects(h)&&pt.isPointInRing(h,f.getCoordinates())},xo.containsPointInPolygon=function(h,f){if(f.isEmpty())return!1;var _=f.getExteriorRing();if(!xo.isPointInRing(h,_))return!1;for(var A=0;A<f.getNumInteriorRing();A++){var R=f.getInteriorRingN(A);if(xo.isPointInRing(h,R))return!1}return!0},xo.containsPoint=function(h,f){if(f instanceof zt)return xo.containsPointInPolygon(h,f);if(f instanceof Cr)for(var _=new su(f);_.hasNext();){var A=_.next();if(A!==f&&xo.containsPoint(h,A))return!0}return!1},xo.locate=function(h,f){return f.isEmpty()?V.EXTERIOR:xo.containsPoint(h,f)?V.INTERIOR:V.EXTERIOR};var Lo=s(function(){this._edgeMap=new v,this._edgeList=null,this._ptInAreaLocation=[V.NONE,V.NONE]},"Xn");Lo.prototype.getNextCW=function(h){this.getEdges();var f=this._edgeList.indexOf(h),_=f-1;return f===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)},Lo.prototype.propagateSideLabels=function(h){for(var f=V.NONE,_=this.iterator();_.hasNext();){var A=_.next().getLabel();A.isArea(h)&&A.getLocation(h,Te.LEFT)!==V.NONE&&(f=A.getLocation(h,Te.LEFT))}if(f===V.NONE)return null;for(var R=f,H=this.iterator();H.hasNext();){var te=H.next(),ge=te.getLabel();if(ge.getLocation(h,Te.ON)===V.NONE&&ge.setLocation(h,Te.ON,R),ge.isArea(h)){var Ne=ge.getLocation(h,Te.LEFT),Ye=ge.getLocation(h,Te.RIGHT);if(Ye!==V.NONE){if(Ye!==R)throw new qt("side location conflict",te.getCoordinate());Ne===V.NONE&&Me.shouldNeverReachHere("found single null side (at "+te.getCoordinate()+")"),R=Ne}else Me.isTrue(ge.getLocation(h,Te.LEFT)===V.NONE,"found single null side"),ge.setLocation(h,Te.RIGHT,R),ge.setLocation(h,Te.LEFT,R)}}},Lo.prototype.getCoordinate=function(){var h=this.iterator();return h.hasNext()?h.next().getCoordinate():null},Lo.prototype.print=function(h){Re.out.println("EdgeEndStar:   "+this.getCoordinate());for(var f=this.iterator();f.hasNext();)f.next().print(h)},Lo.prototype.isAreaLabelsConsistent=function(h){return this.computeEdgeEndLabels(h.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Lo.prototype.checkAreaLabelsConsistent=function(h){var f=this.getEdges();if(f.size()<=0)return!0;var _=f.size()-1,A=f.get(_).getLabel().getLocation(h,Te.LEFT);Me.isTrue(A!==V.NONE,"Found unlabelled area edge");for(var R=A,H=this.iterator();H.hasNext();){var te=H.next().getLabel();Me.isTrue(te.isArea(h),"Found non-area edge");var ge=te.getLocation(h,Te.LEFT),Ne=te.getLocation(h,Te.RIGHT);if(ge===Ne||Ne!==R)return!1;R=ge}return!0},Lo.prototype.findIndex=function(h){this.iterator();for(var f=0;f<this._edgeList.size();f++)if(this._edgeList.get(f)===h)return f;return-1},Lo.prototype.iterator=function(){return this.getEdges().iterator()},Lo.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new le(this._edgeMap.values())),this._edgeList},Lo.prototype.getLocation=function(h,f,_){return this._ptInAreaLocation[h]===V.NONE&&(this._ptInAreaLocation[h]=xo.locate(f,_[h].getGeometry())),this._ptInAreaLocation[h]},Lo.prototype.toString=function(){var h=new ne;h.append("EdgeEndStar:   "+this.getCoordinate()),h.append(`
`);for(var f=this.iterator();f.hasNext();){var _=f.next();h.append(_),h.append(`
`)}return h.toString()},Lo.prototype.computeEdgeEndLabels=function(h){for(var f=this.iterator();f.hasNext();)f.next().computeLabel(h)},Lo.prototype.computeLabelling=function(h){this.computeEdgeEndLabels(h[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var f=[!1,!1],_=this.iterator();_.hasNext();)for(var A=_.next().getLabel(),R=0;R<2;R++)A.isLine(R)&&A.getLocation(R)===V.BOUNDARY&&(f[R]=!0);for(var H=this.iterator();H.hasNext();)for(var te=H.next(),ge=te.getLabel(),Ne=0;Ne<2;Ne++)if(ge.isAnyNull(Ne)){var Ye=V.NONE;if(f[Ne])Ye=V.EXTERIOR;else{var Mt=te.getCoordinate();Ye=this.getLocation(Ne,Mt,h)}ge.setAllLocationsIfNull(Ne,Ye)}},Lo.prototype.getDegree=function(){return this._edgeMap.size()},Lo.prototype.insertEdgeEnd=function(h,f){this._edgeMap.put(h,f),this._edgeList=null},Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo};var Y4=function(h){function f(){h.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var _=null,A=null,R=this._SCANNING_FOR_INCOMING,H=0;H<this._resultAreaEdgeList.size();H++){var te=this._resultAreaEdgeList.get(H),ge=te.getSym();if(te.getLabel().isArea())switch(_===null&&te.isInResult()&&(_=te),R){case this._SCANNING_FOR_INCOMING:if(!ge.isInResult())continue;A=ge,R=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!te.isInResult())continue;A.setNext(te),R=this._SCANNING_FOR_INCOMING}}if(R===this._LINKING_TO_OUTGOING){if(_===null)throw new qt("no outgoing dirEdge found",this.getCoordinate());Me.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),A.setNext(_)}},f.prototype.insert=function(_){var A=_;this.insertEdgeEnd(A,A)},f.prototype.getRightmostEdge=function(){var _=this.getEdges(),A=_.size();if(A<1)return null;var R=_.get(0);if(A===1)return R;var H=_.get(A-1),te=R.getQuadrant(),ge=H.getQuadrant();return li.isNorthern(te)&&li.isNorthern(ge)?R:li.isNorthern(te)||li.isNorthern(ge)?R.getDy()!==0?R:H.getDy()!==0?H:(Me.shouldNeverReachHere("found two horizontal edges incident on node"),null):H},f.prototype.print=function(_){Re.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var A=this.iterator();A.hasNext();){var R=A.next();_.print("out "),R.print(_),_.println(),_.print("in "),R.getSym().print(_),_.println()}},f.prototype.getResultAreaEdges=function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new le;for(var _=this.iterator();_.hasNext();){var A=_.next();(A.isInResult()||A.getSym().isInResult())&&this._resultAreaEdgeList.add(A)}return this._resultAreaEdgeList},f.prototype.updateLabelling=function(_){for(var A=this.iterator();A.hasNext();){var R=A.next().getLabel();R.setAllLocationsIfNull(0,_.getLocation(0)),R.setAllLocationsIfNull(1,_.getLocation(1))}},f.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var _=null,A=null,R=this._edgeList.size()-1;R>=0;R--){var H=this._edgeList.get(R),te=H.getSym();A===null&&(A=te),_!==null&&te.setNext(_),_=H}A.setNext(_)},f.prototype.computeDepths=function(){if(arguments.length===1){var _=arguments[0],A=this.findIndex(_),R=_.getDepth(Te.LEFT),H=_.getDepth(Te.RIGHT),te=this.computeDepths(A+1,this._edgeList.size(),R);if(this.computeDepths(0,A,te)!==H)throw new qt("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var ge=arguments[0],Ne=arguments[1],Ye=arguments[2],Mt=ge;Mt<Ne;Mt++){var At=this._edgeList.get(Mt);At.setEdgeDepths(Te.RIGHT,Ye),Ye=At.getDepth(Te.LEFT)}return Ye}},f.prototype.mergeSymLabels=function(){for(var _=this.iterator();_.hasNext();){var A=_.next();A.getLabel().merge(A.getSym().getLabel())}},f.prototype.linkMinimalDirectedEdges=function(_){for(var A=null,R=null,H=this._SCANNING_FOR_INCOMING,te=this._resultAreaEdgeList.size()-1;te>=0;te--){var ge=this._resultAreaEdgeList.get(te),Ne=ge.getSym();switch(A===null&&ge.getEdgeRing()===_&&(A=ge),H){case this._SCANNING_FOR_INCOMING:if(Ne.getEdgeRing()!==_)continue;R=Ne,H=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ge.getEdgeRing()!==_)continue;R.setNextMin(ge),H=this._SCANNING_FOR_INCOMING}}H===this._LINKING_TO_OUTGOING&&(Me.isTrue(A!==null,"found null for first outgoing dirEdge"),Me.isTrue(A.getEdgeRing()===_,"unable to link last incoming dirEdge"),R.setNextMin(A))},f.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var _=0,A=this.iterator();A.hasNext();)A.next().isInResult()&&_++;return _}if(arguments.length===1){for(var R=arguments[0],H=0,te=this.iterator();te.hasNext();)te.next().getEdgeRing()===R&&H++;return H}},f.prototype.getLabel=function(){return this._label},f.prototype.findCoveredLineEdges=function(){for(var _=V.NONE,A=this.iterator();A.hasNext();){var R=A.next(),H=R.getSym();if(!R.isLineEdge()){if(R.isInResult()){_=V.INTERIOR;break}if(H.isInResult()){_=V.EXTERIOR;break}}}if(_===V.NONE)return null;for(var te=_,ge=this.iterator();ge.hasNext();){var Ne=ge.next(),Ye=Ne.getSym();Ne.isLineEdge()?Ne.getEdge().setCovered(te===V.INTERIOR):(Ne.isInResult()&&(te=V.EXTERIOR),Ye.isInResult()&&(te=V.INTERIOR))}},f.prototype.computeLabelling=function(_){h.prototype.computeLabelling.call(this,_),this._label=new lr(V.NONE);for(var A=this.iterator();A.hasNext();)for(var R=A.next().getEdge().getLabel(),H=0;H<2;H++){var te=R.getLocation(H);te!==V.INTERIOR&&te!==V.BOUNDARY||this._label.setLocation(H,V.INTERIOR)}},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Lo),SS=function(h){function f(){h.apply(this,arguments)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.createNode=function(_){return new Bl(_,new Y4)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(hl),Pc=s(function h(){this._pts=null,this._orientation=null;var f=arguments[0];this._pts=f,this._orientation=h.orientation(f)},"t");Pc.prototype.compareTo=function(h){var f=h;return Pc.compareOriented(this._pts,this._orientation,f._pts,f._orientation)},Pc.prototype.interfaces_=function(){return[k]},Pc.prototype.getClass=function(){return Pc},Pc.orientation=function(h){return De.increasingDirection(h)===1},Pc.compareOriented=function(h,f,_,A){for(var R=f?1:-1,H=A?1:-1,te=f?h.length:-1,ge=A?_.length:-1,Ne=f?0:h.length-1,Ye=A?0:_.length-1;;){var Mt=h[Ne].compareTo(_[Ye]);if(Mt!==0)return Mt;var At=(Ne+=R)===te,hr=(Ye+=H)===ge;if(At&&!hr)return-1;if(!At&&hr)return 1;if(At&&hr)return 0}};var dl=s(function(){this._edges=new le,this._ocaMap=new v},"Hn");dl.prototype.print=function(h){h.print("MULTILINESTRING ( ");for(var f=0;f<this._edges.size();f++){var _=this._edges.get(f);f>0&&h.print(","),h.print("(");for(var A=_.getCoordinates(),R=0;R<A.length;R++)R>0&&h.print(","),h.print(A[R].x+" "+A[R].y);h.println(")")}h.print(")  ")},dl.prototype.addAll=function(h){for(var f=h.iterator();f.hasNext();)this.add(f.next())},dl.prototype.findEdgeIndex=function(h){for(var f=0;f<this._edges.size();f++)if(this._edges.get(f).equals(h))return f;return-1},dl.prototype.iterator=function(){return this._edges.iterator()},dl.prototype.getEdges=function(){return this._edges},dl.prototype.get=function(h){return this._edges.get(h)},dl.prototype.findEqualEdge=function(h){var f=new Pc(h.getCoordinates());return this._ocaMap.get(f)},dl.prototype.add=function(h){this._edges.add(h);var f=new Pc(h.getCoordinates());this._ocaMap.put(f,h)},dl.prototype.interfaces_=function(){return[]},dl.prototype.getClass=function(){return dl};var lu=s(function(){},"Wn");lu.prototype.processIntersections=function(h,f,_,A){},lu.prototype.isDone=function(){},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu};var Do=s(function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var h=arguments[0];this._li=h},"Kn");Do.prototype.isTrivialIntersection=function(h,f,_,A){if(h===_&&this._li.getIntersectionNum()===1){if(Do.isAdjacentSegments(f,A))return!0;if(h.isClosed()){var R=h.size()-1;if(f===0&&A===R||A===0&&f===R)return!0}}return!1},Do.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Do.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Do.prototype.getLineIntersector=function(){return this._li},Do.prototype.hasProperIntersection=function(){return this._hasProper},Do.prototype.processIntersections=function(h,f,_,A){if(h===_&&f===A)return null;this.numTests++;var R=h.getCoordinates()[f],H=h.getCoordinates()[f+1],te=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];this._li.computeIntersection(R,H,te,ge),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(h,f,_,A)||(this._hasIntersection=!0,h.addIntersections(this._li,f,0),_.addIntersections(this._li,A,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Do.prototype.hasIntersection=function(){return this._hasIntersection},Do.prototype.isDone=function(){return!1},Do.prototype.hasInteriorIntersection=function(){return this._hasInterior},Do.prototype.interfaces_=function(){return[lu]},Do.prototype.getClass=function(){return Do},Do.isAdjacentSegments=function(h,f){return Math.abs(h-f)===1};var uu=s(function(){this.coord=null,this.segmentIndex=null,this.dist=null;var h=arguments[0],f=arguments[1],_=arguments[2];this.coord=new z(h),this.segmentIndex=f,this.dist=_},"Jn");uu.prototype.getSegmentIndex=function(){return this.segmentIndex},uu.prototype.getCoordinate=function(){return this.coord},uu.prototype.print=function(h){h.print(this.coord),h.print(" seg # = "+this.segmentIndex),h.println(" dist = "+this.dist)},uu.prototype.compareTo=function(h){var f=h;return this.compare(f.segmentIndex,f.dist)},uu.prototype.isEndPoint=function(h){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===h},uu.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},uu.prototype.getDistance=function(){return this.dist},uu.prototype.compare=function(h,f){return this.segmentIndex<h?-1:this.segmentIndex>h?1:this.dist<f?-1:this.dist>f?1:0},uu.prototype.interfaces_=function(){return[k]},uu.prototype.getClass=function(){return uu};var fl=s(function(){this._nodeMap=new v,this.edge=null;var h=arguments[0];this.edge=h},"Qn");fl.prototype.print=function(h){h.println("Intersections:");for(var f=this.iterator();f.hasNext();)f.next().print(h)},fl.prototype.iterator=function(){return this._nodeMap.values().iterator()},fl.prototype.addSplitEdges=function(h){this.addEndpoints();for(var f=this.iterator(),_=f.next();f.hasNext();){var A=f.next(),R=this.createSplitEdge(_,A);h.add(R),_=A}},fl.prototype.addEndpoints=function(){var h=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[h],h,0)},fl.prototype.createSplitEdge=function(h,f){var _=f.segmentIndex-h.segmentIndex+2,A=this.edge.pts[f.segmentIndex],R=f.dist>0||!f.coord.equals2D(A);R||_--;var H=new Array(_).fill(null),te=0;H[te++]=new z(h.coord);for(var ge=h.segmentIndex+1;ge<=f.segmentIndex;ge++)H[te++]=this.edge.pts[ge];return R&&(H[te]=f.coord),new Sg(H,new lr(this.edge._label))},fl.prototype.add=function(h,f,_){var A=new uu(h,f,_),R=this._nodeMap.get(A);return R!==null?R:(this._nodeMap.put(A,A),A)},fl.prototype.isIntersection=function(h){for(var f=this.iterator();f.hasNext();)if(f.next().coord.equals(h))return!0;return!1},fl.prototype.interfaces_=function(){return[]},fl.prototype.getClass=function(){return fl};var lh=s(function(){},"Zn");lh.prototype.getChainStartIndices=function(h){var f=0,_=new le;_.add(new ee(f));do{var A=this.findChainEnd(h,f);_.add(new ee(A)),f=A}while(f<h.length-1);return lh.toIntArray(_)},lh.prototype.findChainEnd=function(h,f){for(var _=li.quadrant(h[f],h[f+1]),A=f+1;A<h.length&&li.quadrant(h[A-1],h[A])===_;)A++;return A-1},lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh},lh.toIntArray=function(h){for(var f=new Array(h.size()).fill(null),_=0;_<f.length;_++)f[_]=h.get(_).intValue();return f};var Xu=s(function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Ae,this.env2=new Ae;var h=arguments[0];this.e=h,this.pts=h.getCoordinates();var f=new lh;this.startIndex=f.getChainStartIndices(this.pts)},"$n");Xu.prototype.getCoordinates=function(){return this.pts},Xu.prototype.getMaxX=function(h){var f=this.pts[this.startIndex[h]].x,_=this.pts[this.startIndex[h+1]].x;return f>_?f:_},Xu.prototype.getMinX=function(h){var f=this.pts[this.startIndex[h]].x,_=this.pts[this.startIndex[h+1]].x;return f<_?f:_},Xu.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var h=arguments[0],f=arguments[1],_=arguments[2],A=arguments[3];this.computeIntersectsForChain(this.startIndex[h],this.startIndex[h+1],f,f.startIndex[_],f.startIndex[_+1],A)}else if(arguments.length===6){var R=arguments[0],H=arguments[1],te=arguments[2],ge=arguments[3],Ne=arguments[4],Ye=arguments[5],Mt=this.pts[R],At=this.pts[H],hr=te.pts[ge],gr=te.pts[Ne];if(H-R==1&&Ne-ge==1)return Ye.addIntersections(this.e,R,te.e,ge),null;if(this.env1.init(Mt,At),this.env2.init(hr,gr),!this.env1.intersects(this.env2))return null;var Sr=Math.trunc((R+H)/2),Kr=Math.trunc((ge+Ne)/2);R<Sr&&(ge<Kr&&this.computeIntersectsForChain(R,Sr,te,ge,Kr,Ye),Kr<Ne&&this.computeIntersectsForChain(R,Sr,te,Kr,Ne,Ye)),Sr<H&&(ge<Kr&&this.computeIntersectsForChain(Sr,H,te,ge,Kr,Ye),Kr<Ne&&this.computeIntersectsForChain(Sr,H,te,Kr,Ne,Ye))}},Xu.prototype.getStartIndexes=function(){return this.startIndex},Xu.prototype.computeIntersects=function(h,f){for(var _=0;_<this.startIndex.length-1;_++)for(var A=0;A<h.startIndex.length-1;A++)this.computeIntersectsForChain(_,h,A,f)},Xu.prototype.interfaces_=function(){return[]},Xu.prototype.getClass=function(){return Xu};var Wa=s(function h(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var f=0;f<2;f++)for(var _=0;_<3;_++)this._depth[f][_]=h.NULL_VALUE},"t"),Lv={NULL_VALUE:{configurable:!0}};Wa.prototype.getDepth=function(h,f){return this._depth[h][f]},Wa.prototype.setDepth=function(h,f,_){this._depth[h][f]=_},Wa.prototype.isNull=function(){if(arguments.length===0){for(var h=0;h<2;h++)for(var f=0;f<3;f++)if(this._depth[h][f]!==Wa.NULL_VALUE)return!1;return!0}if(arguments.length===1){var _=arguments[0];return this._depth[_][1]===Wa.NULL_VALUE}if(arguments.length===2){var A=arguments[0],R=arguments[1];return this._depth[A][R]===Wa.NULL_VALUE}},Wa.prototype.normalize=function(){for(var h=0;h<2;h++)if(!this.isNull(h)){var f=this._depth[h][1];this._depth[h][2]<f&&(f=this._depth[h][2]),f<0&&(f=0);for(var _=1;_<3;_++){var A=0;this._depth[h][_]>f&&(A=1),this._depth[h][_]=A}}},Wa.prototype.getDelta=function(h){return this._depth[h][Te.RIGHT]-this._depth[h][Te.LEFT]},Wa.prototype.getLocation=function(h,f){return this._depth[h][f]<=0?V.EXTERIOR:V.INTERIOR},Wa.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Wa.prototype.add=function(){if(arguments.length===1)for(var h=arguments[0],f=0;f<2;f++)for(var _=1;_<3;_++){var A=h.getLocation(f,_);A!==V.EXTERIOR&&A!==V.INTERIOR||(this.isNull(f,_)?this._depth[f][_]=Wa.depthAtLocation(A):this._depth[f][_]+=Wa.depthAtLocation(A))}else if(arguments.length===3){var R=arguments[0],H=arguments[1];arguments[2]===V.INTERIOR&&this._depth[R][H]++}},Wa.prototype.interfaces_=function(){return[]},Wa.prototype.getClass=function(){return Wa},Wa.depthAtLocation=function(h){return h===V.EXTERIOR?0:h===V.INTERIOR?1:Wa.NULL_VALUE},Lv.NULL_VALUE.get=function(){return-1},Object.defineProperties(Wa,Lv);var Sg=function(h){function f(){if(h.call(this),this.pts=null,this._env=null,this.eiList=new fl(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Wa,this._depthDelta=0,arguments.length===1){var _=arguments[0];f.call(this,_,null)}else if(arguments.length===2){var A=arguments[0],R=arguments[1];this.pts=A,this._label=R}}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.getDepth=function(){return this._depth},f.prototype.getCollapsedEdge=function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new f(_,lr.toLineLabel(this._label))},f.prototype.isIsolated=function(){return this._isIsolated},f.prototype.getCoordinates=function(){return this.pts},f.prototype.setIsolated=function(_){this._isIsolated=_},f.prototype.setName=function(_){this._name=_},f.prototype.equals=function(_){if(!(_ instanceof f))return!1;var A=_;if(this.pts.length!==A.pts.length)return!1;for(var R=!0,H=!0,te=this.pts.length,ge=0;ge<this.pts.length;ge++)if(this.pts[ge].equals2D(A.pts[ge])||(R=!1),this.pts[ge].equals2D(A.pts[--te])||(H=!1),!R&&!H)return!1;return!0},f.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}},f.prototype.print=function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var A=0;A<this.pts.length;A++)A>0&&_.print(","),_.print(this.pts[A].x+" "+this.pts[A].y);_.print(")  "+this._label+" "+this._depthDelta)},f.prototype.computeIM=function(_){f.updateIM(this._label,_)},f.prototype.isCollapsed=function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])},f.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},f.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},f.prototype.getDepthDelta=function(){return this._depthDelta},f.prototype.getNumPoints=function(){return this.pts.length},f.prototype.printReverse=function(_){_.print("edge "+this._name+": ");for(var A=this.pts.length-1;A>=0;A--)_.print(this.pts[A]+" ");_.println("")},f.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Xu(this)),this._mce},f.prototype.getEnvelope=function(){if(this._env===null){this._env=new Ae;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env},f.prototype.addIntersection=function(_,A,R,H){var te=new z(_.getIntersection(H)),ge=A,Ne=_.getEdgeDistance(R,H),Ye=ge+1;if(Ye<this.pts.length){var Mt=this.pts[Ye];te.equals2D(Mt)&&(ge=Ye,Ne=0)}this.eiList.add(te,ge,Ne)},f.prototype.toString=function(){var _=new ne;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var A=0;A<this.pts.length;A++)A>0&&_.append(","),_.append(this.pts[A].x+" "+this.pts[A].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()},f.prototype.isPointwiseEqual=function(_){if(this.pts.length!==_.pts.length)return!1;for(var A=0;A<this.pts.length;A++)if(!this.pts[A].equals2D(_.pts[A]))return!1;return!0},f.prototype.setDepthDelta=function(_){this._depthDelta=_},f.prototype.getEdgeIntersectionList=function(){return this.eiList},f.prototype.addIntersections=function(_,A,R){for(var H=0;H<_.getIntersectionNum();H++)this.addIntersection(_,A,R,H)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.updateIM=function(){if(arguments.length!==2)return h.prototype.updateIM.apply(this,arguments);var _=arguments[0],A=arguments[1];A.setAtLeastIfValid(_.getLocation(0,Te.ON),_.getLocation(1,Te.ON),1),_.isArea()&&(A.setAtLeastIfValid(_.getLocation(0,Te.LEFT),_.getLocation(1,Te.LEFT),2),A.setAtLeastIfValid(_.getLocation(0,Te.RIGHT),_.getLocation(1,Te.RIGHT),2))},f}(sn),Ro=s(function(h){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new dl,this._bufParams=h||null},"ii");Ro.prototype.setWorkingPrecisionModel=function(h){this._workingPrecisionModel=h},Ro.prototype.insertUniqueEdge=function(h){var f=this._edgeList.findEqualEdge(h);if(f!==null){var _=f.getLabel(),A=h.getLabel();f.isPointwiseEqual(h)||(A=new lr(h.getLabel())).flip(),_.merge(A);var R=Ro.depthDelta(A),H=f.getDepthDelta()+R;f.setDepthDelta(H)}else this._edgeList.add(h),h.setDepthDelta(Ro.depthDelta(h.getLabel()))},Ro.prototype.buildSubgraphs=function(h,f){for(var _=new le,A=h.iterator();A.hasNext();){var R=A.next(),H=R.getRightmostCoordinate(),te=new Wu(_).getDepth(H);R.computeDepth(te),R.findResultEdges(),_.add(R),f.add(R.getDirectedEdges(),R.getNodes())}},Ro.prototype.createSubgraphs=function(h){for(var f=new le,_=h.getNodes().iterator();_.hasNext();){var A=_.next();if(!A.isVisited()){var R=new mr;R.create(A),f.add(R)}}return Ge.sort(f,Ge.reverseOrder()),f},Ro.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Ro.prototype.getNoder=function(h){if(this._workingNoder!==null)return this._workingNoder;var f=new Vx,_=new It;return _.setPrecisionModel(h),f.setSegmentIntersector(new Do(_)),f},Ro.prototype.buffer=function(h,f){var _=this._workingPrecisionModel;_===null&&(_=h.getPrecisionModel()),this._geomFact=h.getFactory();var A=new Po(_,this._bufParams),R=new Xs(h,f,A).getCurves();if(R.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(R,_),this._graph=new ln(new SS),this._graph.addEdges(this._edgeList.getEdges());var H=this.createSubgraphs(this._graph),te=new Ia(this._geomFact);this.buildSubgraphs(H,te);var ge=te.getPolygons();return ge.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(ge)},Ro.prototype.computeNodedEdges=function(h,f){var _=this.getNoder(f);_.computeNodes(h);for(var A=_.getNodedSubstrings().iterator();A.hasNext();){var R=A.next(),H=R.getCoordinates();if(H.length!==2||!H[0].equals2D(H[1])){var te=R.getData(),ge=new Sg(R.getCoordinates(),new lr(te));this.insertUniqueEdge(ge)}}},Ro.prototype.setNoder=function(h){this._workingNoder=h},Ro.prototype.interfaces_=function(){return[]},Ro.prototype.getClass=function(){return Ro},Ro.depthDelta=function(h){var f=h.getLocation(0,Te.LEFT),_=h.getLocation(0,Te.RIGHT);return f===V.INTERIOR&&_===V.EXTERIOR?1:f===V.EXTERIOR&&_===V.INTERIOR?-1:0},Ro.convertSegStrings=function(h){for(var f=new Gr,_=new le;h.hasNext();){var A=h.next(),R=f.createLineString(A.getCoordinates());_.add(R)}return f.buildGeometry(_)};var Lc=s(function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var h=arguments[0],f=arguments[1];this._noder=h,this._scaleFactor=f,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var _=arguments[0],A=arguments[1],R=arguments[2],H=arguments[3];this._noder=_,this._scaleFactor=A,this._offsetX=R,this._offsetY=H,this._isScaled=!this.isIntegerPrecision()}},"ri");Lc.prototype.rescale=function(){if(Y(arguments[0],er))for(var h=arguments[0].iterator();h.hasNext();){var f=h.next();this.rescale(f.getCoordinates())}else if(arguments[0]instanceof Array){for(var _=arguments[0],A=0;A<_.length;A++)_[A].x=_[A].x/this._scaleFactor+this._offsetX,_[A].y=_[A].y/this._scaleFactor+this._offsetY;_.length===2&&_[0].equals2D(_[1])&&Re.out.println(_)}},Lc.prototype.scale=function(){if(Y(arguments[0],er)){for(var h=arguments[0],f=new le,_=h.iterator();_.hasNext();){var A=_.next();f.add(new ba(this.scale(A.getCoordinates()),A.getData()))}return f}if(arguments[0]instanceof Array){for(var R=arguments[0],H=new Array(R.length).fill(null),te=0;te<R.length;te++)H[te]=new z(Math.round((R[te].x-this._offsetX)*this._scaleFactor),Math.round((R[te].y-this._offsetY)*this._scaleFactor),R[te].z);return De.removeRepeatedPoints(H)}},Lc.prototype.isIntegerPrecision=function(){return this._scaleFactor===1},Lc.prototype.getNodedSubstrings=function(){var h=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(h),h},Lc.prototype.computeNodes=function(h){var f=h;this._isScaled&&(f=this.scale(h)),this._noder.computeNodes(f)},Lc.prototype.interfaces_=function(){return[Ic]},Lc.prototype.getClass=function(){return Lc};var cu=s(function(){this._li=new It,this._segStrings=null;var h=arguments[0];this._segStrings=h},"oi"),MS={fact:{configurable:!0}};cu.prototype.checkEndPtVertexIntersections=function(){if(arguments.length===0)for(var h=this._segStrings.iterator();h.hasNext();){var f=h.next().getCoordinates();this.checkEndPtVertexIntersections(f[0],this._segStrings),this.checkEndPtVertexIntersections(f[f.length-1],this._segStrings)}else if(arguments.length===2){for(var _=arguments[0],A=arguments[1].iterator();A.hasNext();)for(var R=A.next().getCoordinates(),H=1;H<R.length-1;H++)if(R[H].equals(_))throw new Lt("found endpt/interior pt intersection at index "+H+" :pt "+_)}},cu.prototype.checkInteriorIntersections=function(){if(arguments.length===0)for(var h=this._segStrings.iterator();h.hasNext();)for(var f=h.next(),_=this._segStrings.iterator();_.hasNext();){var A=_.next();this.checkInteriorIntersections(f,A)}else if(arguments.length===2)for(var R=arguments[0],H=arguments[1],te=R.getCoordinates(),ge=H.getCoordinates(),Ne=0;Ne<te.length-1;Ne++)for(var Ye=0;Ye<ge.length-1;Ye++)this.checkInteriorIntersections(R,Ne,H,Ye);else if(arguments.length===4){var Mt=arguments[0],At=arguments[1],hr=arguments[2],gr=arguments[3];if(Mt===hr&&At===gr)return null;var Sr=Mt.getCoordinates()[At],Kr=Mt.getCoordinates()[At+1],Vi=hr.getCoordinates()[gr],jn=hr.getCoordinates()[gr+1];if(this._li.computeIntersection(Sr,Kr,Vi,jn),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Sr,Kr)||this.hasInteriorIntersection(this._li,Vi,jn)))throw new Lt("found non-noded intersection at "+Sr+"-"+Kr+" and "+Vi+"-"+jn)}},cu.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},cu.prototype.checkCollapses=function(){if(arguments.length===0)for(var h=this._segStrings.iterator();h.hasNext();){var f=h.next();this.checkCollapses(f)}else if(arguments.length===1)for(var _=arguments[0].getCoordinates(),A=0;A<_.length-2;A++)this.checkCollapse(_[A],_[A+1],_[A+2])},cu.prototype.hasInteriorIntersection=function(h,f,_){for(var A=0;A<h.getIntersectionNum();A++){var R=h.getIntersection(A);if(!R.equals(f)&&!R.equals(_))return!0}return!1},cu.prototype.checkCollapse=function(h,f,_){if(h.equals(_))throw new Lt("found non-noded collapse at "+cu.fact.createLineString([h,f,_]))},cu.prototype.interfaces_=function(){return[]},cu.prototype.getClass=function(){return cu},MS.fact.get=function(){return new Gr},Object.defineProperties(cu,MS);var ys=s(function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var h=arguments[0],f=arguments[1],_=arguments[2];if(this._originalPt=h,this._pt=h,this._scaleFactor=f,this._li=_,f<=0)throw new T("Scale factor must be non-zero");f!==1&&(this._pt=new z(this.scale(h.x),this.scale(h.y)),this._p0Scaled=new z,this._p1Scaled=new z),this.initCorners(this._pt)},"ai"),ES={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ys.prototype.intersectsScaled=function(h,f){var _=Math.min(h.x,f.x),A=Math.max(h.x,f.x),R=Math.min(h.y,f.y),H=Math.max(h.y,f.y),te=this._maxx<_||this._minx>A||this._maxy<R||this._miny>H;if(te)return!1;var ge=this.intersectsToleranceSquare(h,f);return Me.isTrue(!(te&&ge),"Found bad envelope test"),ge},ys.prototype.initCorners=function(h){this._minx=h.x-.5,this._maxx=h.x+.5,this._miny=h.y-.5,this._maxy=h.y+.5,this._corner[0]=new z(this._maxx,this._maxy),this._corner[1]=new z(this._minx,this._maxy),this._corner[2]=new z(this._minx,this._miny),this._corner[3]=new z(this._maxx,this._miny)},ys.prototype.intersects=function(h,f){return this._scaleFactor===1?this.intersectsScaled(h,f):(this.copyScaled(h,this._p0Scaled),this.copyScaled(f,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ys.prototype.scale=function(h){return Math.round(h*this._scaleFactor)},ys.prototype.getCoordinate=function(){return this._originalPt},ys.prototype.copyScaled=function(h,f){f.x=this.scale(h.x),f.y=this.scale(h.y)},ys.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var h=ys.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ae(this._originalPt.x-h,this._originalPt.x+h,this._originalPt.y-h,this._originalPt.y+h)}return this._safeEnv},ys.prototype.intersectsPixelClosure=function(h,f){return this._li.computeIntersection(h,f,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(h,f,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(h,f,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(h,f,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},ys.prototype.intersectsToleranceSquare=function(h,f){var _=!1,A=!1;return this._li.computeIntersection(h,f,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(h,f,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(h,f,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(A=!0),this._li.computeIntersection(h,f,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!_||!A)||!!h.equals(this._pt)||!!f.equals(this._pt))))},ys.prototype.addSnappedNode=function(h,f){var _=h.getCoordinate(f),A=h.getCoordinate(f+1);return!!this.intersects(_,A)&&(h.addIntersection(this.getCoordinate(),f),!0)},ys.prototype.interfaces_=function(){return[]},ys.prototype.getClass=function(){return ys},ES.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(ys,ES);var Mg=s(function(){this.tempEnv1=new Ae,this.selectedSegment=new jr},"li");Mg.prototype.select=function(){if(arguments.length!==1&&arguments.length===2){var h=arguments[0],f=arguments[1];h.getLineSegment(f,this.selectedSegment),this.select(this.selectedSegment)}},Mg.prototype.interfaces_=function(){return[]},Mg.prototype.getClass=function(){return Mg};var Qo=s(function(){this._index=null;var h=arguments[0];this._index=h},"ci"),Df={HotPixelSnapAction:{configurable:!0}};Qo.prototype.snap=function(){if(arguments.length===1){var h=arguments[0];return this.snap(h,null,-1)}if(arguments.length===3){var f=arguments[0],_=arguments[1],A=arguments[2],R=f.getSafeEnvelope(),H=new jx(f,_,A);return this._index.query(R,{interfaces_:s(function(){return[qn]},"interfaces_"),visitItem:s(function(te){te.select(R,H)},"visitItem")}),H.isNodeAdded()}},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo},Df.HotPixelSnapAction.get=function(){return jx},Object.defineProperties(Qo,Df);var jx=function(h){function f(){h.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],A=arguments[1],R=arguments[2];this._hotPixel=_,this._parentEdge=A,this._hotPixelVertexIndex=R}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.isNodeAdded=function(){return this._isNodeAdded},f.prototype.select=function(){if(arguments.length!==2)return h.prototype.select.apply(this,arguments);var _=arguments[0],A=arguments[1],R=_.getContext();if(this._parentEdge!==null&&R===this._parentEdge&&A===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(R,A)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Mg),np=s(function(){this._li=null,this._interiorIntersections=null;var h=arguments[0];this._li=h,this._interiorIntersections=new le},"fi");np.prototype.processIntersections=function(h,f,_,A){if(h===_&&f===A)return null;var R=h.getCoordinates()[f],H=h.getCoordinates()[f+1],te=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];if(this._li.computeIntersection(R,H,te,ge),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Ne=0;Ne<this._li.getIntersectionNum();Ne++)this._interiorIntersections.add(this._li.getIntersection(Ne));h.addIntersections(this._li,f,0),_.addIntersections(this._li,A,1)}},np.prototype.isDone=function(){return!1},np.prototype.getInteriorIntersections=function(){return this._interiorIntersections},np.prototype.interfaces_=function(){return[lu]},np.prototype.getClass=function(){return np};var hu=s(function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var h=arguments[0];this._pm=h,this._li=new It,this._li.setPrecisionModel(h),this._scaleFactor=h.getScale()},"gi");hu.prototype.checkCorrectness=function(h){var f=ba.getNodedSubstrings(h),_=new cu(f);try{_.checkValid()}catch(A){if(!(A instanceof Le))throw A;A.printStackTrace()}},hu.prototype.getNodedSubstrings=function(){return ba.getNodedSubstrings(this._nodedSegStrings)},hu.prototype.snapRound=function(h,f){var _=this.findInteriorIntersections(h,f);this.computeIntersectionSnaps(_),this.computeVertexSnaps(h)},hu.prototype.findInteriorIntersections=function(h,f){var _=new np(f);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(h),_.getInteriorIntersections()},hu.prototype.computeVertexSnaps=function(){if(Y(arguments[0],er))for(var h=arguments[0].iterator();h.hasNext();){var f=h.next();this.computeVertexSnaps(f)}else if(arguments[0]instanceof ba)for(var _=arguments[0],A=_.getCoordinates(),R=0;R<A.length;R++){var H=new ys(A[R],this._scaleFactor,this._li);this._pointSnapper.snap(H,_,R)&&_.addIntersection(A[R],R)}},hu.prototype.computeNodes=function(h){this._nodedSegStrings=h,this._noder=new Vx,this._pointSnapper=new Qo(this._noder.getIndex()),this.snapRound(h,this._li)},hu.prototype.computeIntersectionSnaps=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next(),A=new ys(_,this._scaleFactor,this._li);this._pointSnapper.snap(A)}},hu.prototype.interfaces_=function(){return[Ic]},hu.prototype.getClass=function(){return hu};var oo=s(function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Wi,this._resultGeometry=null,this._saveException=null,arguments.length===1){var h=arguments[0];this._argGeom=h}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this._argGeom=f,this._bufParams=_}},"di"),ap={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};oo.prototype.bufferFixedPrecision=function(h){var f=new Lc(new hu(new si(1)),h.getScale()),_=new Ro(this._bufParams);_.setWorkingPrecisionModel(h),_.setNoder(f),this._resultGeometry=_.buffer(this._argGeom,this._distance)},oo.prototype.bufferReducedPrecision=function(){var h=this;if(arguments.length===0){for(var f=oo.MAX_PRECISION_DIGITS;f>=0;f--){try{h.bufferReducedPrecision(f)}catch(H){if(!(H instanceof qt))throw H;h._saveException=H}if(h._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],A=oo.precisionScaleFactor(this._argGeom,this._distance,_),R=new si(A);this.bufferFixedPrecision(R)}},oo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var h=this._argGeom.getFactory().getPrecisionModel();h.getType()===si.FIXED?this.bufferFixedPrecision(h):this.bufferReducedPrecision()},oo.prototype.setQuadrantSegments=function(h){this._bufParams.setQuadrantSegments(h)},oo.prototype.bufferOriginalPrecision=function(){try{var h=new Ro(this._bufParams);this._resultGeometry=h.buffer(this._argGeom,this._distance)}catch(f){if(!(f instanceof Lt))throw f;this._saveException=f}},oo.prototype.getResultGeometry=function(h){return this._distance=h,this.computeGeometry(),this._resultGeometry},oo.prototype.setEndCapStyle=function(h){this._bufParams.setEndCapStyle(h)},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo},oo.bufferOp=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];return new oo(h).getResultGeometry(f)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof $t&&typeof arguments[1]=="number"){var _=arguments[0],A=arguments[1],R=arguments[2],H=new oo(_);return H.setQuadrantSegments(R),H.getResultGeometry(A)}if(arguments[2]instanceof Wi&&arguments[0]instanceof $t&&typeof arguments[1]=="number"){var te=arguments[0],ge=arguments[1],Ne=arguments[2];return new oo(te,Ne).getResultGeometry(ge)}}else if(arguments.length===4){var Ye=arguments[0],Mt=arguments[1],At=arguments[2],hr=arguments[3],gr=new oo(Ye);return gr.setQuadrantSegments(At),gr.setEndCapStyle(hr),gr.getResultGeometry(Mt)}},oo.precisionScaleFactor=function(h,f,_){var A=h.getEnvelopeInternal(),R=he.max(Math.abs(A.getMaxX()),Math.abs(A.getMaxY()),Math.abs(A.getMinX()),Math.abs(A.getMinY()))+2*(f>0?f:0),H=_-Math.trunc(Math.log(R)/Math.log(10)+1);return Math.pow(10,H)},ap.CAP_ROUND.get=function(){return Wi.CAP_ROUND},ap.CAP_BUTT.get=function(){return Wi.CAP_FLAT},ap.CAP_FLAT.get=function(){return Wi.CAP_FLAT},ap.CAP_SQUARE.get=function(){return Wi.CAP_SQUARE},ap.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(oo,ap);var es=s(function(){this._pt=[new z,new z],this._distance=D.NaN,this._isNull=!0},"_i");es.prototype.getCoordinates=function(){return this._pt},es.prototype.getCoordinate=function(h){return this._pt[h]},es.prototype.setMinimum=function(){if(arguments.length===1){var h=arguments[0];this.setMinimum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A<this._distance&&this.initialize(f,_,A)}},es.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var h=arguments[0],f=arguments[1];this._pt[0].setCoordinate(h),this._pt[1].setCoordinate(f),this._distance=h.distance(f),this._isNull=!1}else if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2];this._pt[0].setCoordinate(_),this._pt[1].setCoordinate(A),this._distance=R,this._isNull=!1}},es.prototype.getDistance=function(){return this._distance},es.prototype.setMaximum=function(){if(arguments.length===1){var h=arguments[0];this.setMaximum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A>this._distance&&this.initialize(f,_,A)}},es.prototype.interfaces_=function(){return[]},es.prototype.getClass=function(){return es};var Ts=s(function(){},"mi");Ts.prototype.interfaces_=function(){return[]},Ts.prototype.getClass=function(){return Ts},Ts.computeDistance=function(){if(arguments[2]instanceof es&&arguments[0]instanceof Je&&arguments[1]instanceof z)for(var h=arguments[0],f=arguments[1],_=arguments[2],A=h.getCoordinates(),R=new jr,H=0;H<A.length-1;H++){R.setCoordinates(A[H],A[H+1]);var te=R.closestPoint(f);_.setMinimum(te,f)}else if(arguments[2]instanceof es&&arguments[0]instanceof zt&&arguments[1]instanceof z){var ge=arguments[0],Ne=arguments[1],Ye=arguments[2];Ts.computeDistance(ge.getExteriorRing(),Ne,Ye);for(var Mt=0;Mt<ge.getNumInteriorRing();Mt++)Ts.computeDistance(ge.getInteriorRingN(Mt),Ne,Ye)}else if(arguments[2]instanceof es&&arguments[0]instanceof $t&&arguments[1]instanceof z){var At=arguments[0],hr=arguments[1],gr=arguments[2];if(At instanceof Je)Ts.computeDistance(At,hr,gr);else if(At instanceof zt)Ts.computeDistance(At,hr,gr);else if(At instanceof Cr)for(var Sr=At,Kr=0;Kr<Sr.getNumGeometries();Kr++){var Vi=Sr.getGeometryN(Kr);Ts.computeDistance(Vi,hr,gr)}else gr.setMinimum(At.getCoordinate(),hr)}else if(arguments[2]instanceof es&&arguments[0]instanceof jr&&arguments[1]instanceof z){var jn=arguments[0],ts=arguments[1],mu=arguments[2],fh=jn.closestPoint(ts);mu.setMinimum(fh,ts)}};var Dc=s(function(h){this._maxPtDist=new es,this._inputGeom=h||null},"vi"),pd={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Dc.prototype.computeMaxMidpointDistance=function(h){var f=new Rc(this._inputGeom);h.apply(f),this._maxPtDist.setMaximum(f.getMaxPointDistance())},Dc.prototype.computeMaxVertexDistance=function(h){var f=new uh(this._inputGeom);h.apply(f),this._maxPtDist.setMaximum(f.getMaxPointDistance())},Dc.prototype.findDistance=function(h){return this.computeMaxVertexDistance(h),this.computeMaxMidpointDistance(h),this._maxPtDist.getDistance()},Dc.prototype.getDistancePoints=function(){return this._maxPtDist},Dc.prototype.interfaces_=function(){return[]},Dc.prototype.getClass=function(){return Dc},pd.MaxPointDistanceFilter.get=function(){return uh},pd.MaxMidpointDistanceFilter.get=function(){return Rc},Object.defineProperties(Dc,pd);var uh=s(function(h){this._maxPtDist=new es,this._minPtDist=new es,this._geom=h||null},"Ei");uh.prototype.filter=function(h){this._minPtDist.initialize(),Ts.computeDistance(this._geom,h,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},uh.prototype.getMaxPointDistance=function(){return this._maxPtDist},uh.prototype.interfaces_=function(){return[Fe]},uh.prototype.getClass=function(){return uh};var Rc=s(function(h){this._maxPtDist=new es,this._minPtDist=new es,this._geom=h||null},"xi");Rc.prototype.filter=function(h,f){if(f===0)return null;var _=h.getCoordinate(f-1),A=h.getCoordinate(f),R=new z((_.x+A.x)/2,(_.y+A.y)/2);this._minPtDist.initialize(),Ts.computeDistance(this._geom,R,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Rc.prototype.isDone=function(){return!1},Rc.prototype.isGeometryChanged=function(){return!1},Rc.prototype.getMaxPointDistance=function(){return this._maxPtDist},Rc.prototype.interfaces_=function(){return[Yr]},Rc.prototype.getClass=function(){return Rc};var Ps=s(function(h){this._comps=h||null},"Ni");Ps.prototype.filter=function(h){h instanceof zt&&this._comps.add(h)},Ps.prototype.interfaces_=function(){return[ni]},Ps.prototype.getClass=function(){return Ps},Ps.getPolygons=function(){if(arguments.length===1){var h=arguments[0];return Ps.getPolygons(h,new le)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f instanceof zt?_.add(f):f instanceof Cr&&f.apply(new Ps(_)),_}};var wa=s(function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var h=arguments[0];this._lines=h}else if(arguments.length===2){var f=arguments[0],_=arguments[1];this._lines=f,this._isForcedToLineString=_}},"Ci");wa.prototype.filter=function(h){if(this._isForcedToLineString&&h instanceof ur){var f=h.getFactory().createLineString(h.getCoordinateSequence());return this._lines.add(f),null}h instanceof Je&&this._lines.add(h)},wa.prototype.setForceToLineString=function(h){this._isForcedToLineString=h},wa.prototype.interfaces_=function(){return[Kt]},wa.prototype.getClass=function(){return wa},wa.getGeometry=function(){if(arguments.length===1){var h=arguments[0];return h.getFactory().buildGeometry(wa.getLines(h))}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f.getFactory().buildGeometry(wa.getLines(f,_))}},wa.getLines=function(){if(arguments.length===1){var h=arguments[0];return wa.getLines(h,!1)}if(arguments.length===2){if(Y(arguments[0],er)&&Y(arguments[1],er)){for(var f=arguments[0],_=arguments[1],A=f.iterator();A.hasNext();){var R=A.next();wa.getLines(R,_)}return _}if(arguments[0]instanceof $t&&typeof arguments[1]=="boolean"){var H=arguments[0],te=arguments[1],ge=new le;return H.apply(new wa(ge,te)),ge}if(arguments[0]instanceof $t&&Y(arguments[1],er)){var Ne=arguments[0],Ye=arguments[1];return Ne instanceof Je?Ye.add(Ne):Ne.apply(new wa(Ye)),Ye}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Y(arguments[0],er)&&Y(arguments[1],er)){for(var Mt=arguments[0],At=arguments[1],hr=arguments[2],gr=Mt.iterator();gr.hasNext();){var Sr=gr.next();wa.getLines(Sr,At,hr)}return At}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof $t&&Y(arguments[1],er)){var Kr=arguments[0],Vi=arguments[1],jn=arguments[2];return Kr.apply(new wa(Vi,jn)),Vi}}};var Zs=s(function(){if(this._boundaryRule=Xe.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0&&arguments.length===1){var h=arguments[0];if(h===null)throw new T("Rule must be non-null");this._boundaryRule=h}},"Si");Zs.prototype.locateInternal=function(){if(arguments[0]instanceof z&&arguments[1]instanceof zt){var h=arguments[0],f=arguments[1];if(f.isEmpty())return V.EXTERIOR;var _=f.getExteriorRing(),A=this.locateInPolygonRing(h,_);if(A===V.EXTERIOR)return V.EXTERIOR;if(A===V.BOUNDARY)return V.BOUNDARY;for(var R=0;R<f.getNumInteriorRing();R++){var H=f.getInteriorRingN(R),te=this.locateInPolygonRing(h,H);if(te===V.INTERIOR)return V.EXTERIOR;if(te===V.BOUNDARY)return V.BOUNDARY}return V.INTERIOR}if(arguments[0]instanceof z&&arguments[1]instanceof Je){var ge=arguments[0],Ne=arguments[1];if(!Ne.getEnvelopeInternal().intersects(ge))return V.EXTERIOR;var Ye=Ne.getCoordinates();return Ne.isClosed()||!ge.equals(Ye[0])&&!ge.equals(Ye[Ye.length-1])?pt.isOnLine(ge,Ye)?V.INTERIOR:V.EXTERIOR:V.BOUNDARY}if(arguments[0]instanceof z&&arguments[1]instanceof ft){var Mt=arguments[0];return arguments[1].getCoordinate().equals2D(Mt)?V.INTERIOR:V.EXTERIOR}},Zs.prototype.locateInPolygonRing=function(h,f){return f.getEnvelopeInternal().intersects(h)?pt.locatePointInRing(h,f.getCoordinates()):V.EXTERIOR},Zs.prototype.intersects=function(h,f){return this.locate(h,f)!==V.EXTERIOR},Zs.prototype.updateLocationInfo=function(h){h===V.INTERIOR&&(this._isIn=!0),h===V.BOUNDARY&&this._numBoundaries++},Zs.prototype.computeLocation=function(h,f){if(f instanceof ft&&this.updateLocationInfo(this.locateInternal(h,f)),f instanceof Je)this.updateLocationInfo(this.locateInternal(h,f));else if(f instanceof zt)this.updateLocationInfo(this.locateInternal(h,f));else if(f instanceof Mi)for(var _=f,A=0;A<_.getNumGeometries();A++){var R=_.getGeometryN(A);this.updateLocationInfo(this.locateInternal(h,R))}else if(f instanceof Ar)for(var H=f,te=0;te<H.getNumGeometries();te++){var ge=H.getGeometryN(te);this.updateLocationInfo(this.locateInternal(h,ge))}else if(f instanceof Cr)for(var Ne=new su(f);Ne.hasNext();){var Ye=Ne.next();Ye!==f&&this.computeLocation(h,Ye)}},Zs.prototype.locate=function(h,f){return f.isEmpty()?V.EXTERIOR:f instanceof Je?this.locateInternal(h,f):f instanceof zt?this.locateInternal(h,f):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(h,f),this._boundaryRule.isInBoundary(this._numBoundaries)?V.BOUNDARY:this._numBoundaries>0||this._isIn?V.INTERIOR:V.EXTERIOR)},Zs.prototype.interfaces_=function(){return[]},Zs.prototype.getClass=function(){return Zs};var Oo=s(function h(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var f=arguments[0],_=arguments[1];h.call(this,f,h.INSIDE_AREA,_)}else if(arguments.length===3){var A=arguments[0],R=arguments[1],H=arguments[2];this._component=A,this._segIndex=R,this._pt=H}},"t"),op={INSIDE_AREA:{configurable:!0}};Oo.prototype.isInsideArea=function(){return this._segIndex===Oo.INSIDE_AREA},Oo.prototype.getCoordinate=function(){return this._pt},Oo.prototype.getGeometryComponent=function(){return this._component},Oo.prototype.getSegmentIndex=function(){return this._segIndex},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo},op.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Oo,op);var Oc=s(function(h){this._pts=h||null},"wi");Oc.prototype.filter=function(h){h instanceof ft&&this._pts.add(h)},Oc.prototype.interfaces_=function(){return[ni]},Oc.prototype.getClass=function(){return Oc},Oc.getPoints=function(){if(arguments.length===1){var h=arguments[0];return h instanceof ft?Ge.singletonList(h):Oc.getPoints(h,new le)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f instanceof ft?_.add(f):f instanceof Cr&&f.apply(new Oc(_)),_}};var sp=s(function(){this._locations=null;var h=arguments[0];this._locations=h},"Oi");sp.prototype.filter=function(h){(h instanceof ft||h instanceof Je||h instanceof zt)&&this._locations.add(new Oo(h,0,h.getCoordinate()))},sp.prototype.interfaces_=function(){return[ni]},sp.prototype.getClass=function(){return sp},sp.getLocations=function(h){var f=new le;return h.apply(new sp(f)),f};var so=s(function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Zs,this._minDistanceLocation=null,this._minDistance=D.MAX_VALUE,arguments.length===2){var h=arguments[0],f=arguments[1];this._geom=[h,f],this._terminateDistance=0}else if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=_,this._geom[1]=A,this._terminateDistance=R}},"Ti");so.prototype.computeContainmentDistance=function(){if(arguments.length===0){var h=new Array(2).fill(null);if(this.computeContainmentDistance(0,h),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1],A=1-f,R=Ps.getPolygons(this._geom[f]);if(R.size()>0){var H=sp.getLocations(this._geom[A]);if(this.computeContainmentDistance(H,R,_),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[A]=_[0],this._minDistanceLocation[f]=_[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Y(arguments[0],oe)&&Y(arguments[1],oe)){for(var te=arguments[0],ge=arguments[1],Ne=arguments[2],Ye=0;Ye<te.size();Ye++)for(var Mt=te.get(Ye),At=0;At<ge.size();At++)if(this.computeContainmentDistance(Mt,ge.get(At),Ne),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Oo&&arguments[1]instanceof zt){var hr=arguments[0],gr=arguments[1],Sr=arguments[2],Kr=hr.getCoordinate();if(V.EXTERIOR!==this._ptLocator.locate(Kr,gr))return this._minDistance=0,Sr[0]=hr,Sr[1]=new Oo(gr,Kr),null}}},so.prototype.computeMinDistanceLinesPoints=function(h,f,_){for(var A=0;A<h.size();A++)for(var R=h.get(A),H=0;H<f.size();H++){var te=f.get(H);if(this.computeMinDistance(R,te,_),this._minDistance<=this._terminateDistance)return null}},so.prototype.computeFacetDistance=function(){var h=new Array(2).fill(null),f=wa.getLines(this._geom[0]),_=wa.getLines(this._geom[1]),A=Oc.getPoints(this._geom[0]),R=Oc.getPoints(this._geom[1]);return this.computeMinDistanceLines(f,_,h),this.updateMinDistance(h,!1),this._minDistance<=this._terminateDistance?null:(h[0]=null,h[1]=null,this.computeMinDistanceLinesPoints(f,R,h),this.updateMinDistance(h,!1),this._minDistance<=this._terminateDistance?null:(h[0]=null,h[1]=null,this.computeMinDistanceLinesPoints(_,A,h),this.updateMinDistance(h,!0),this._minDistance<=this._terminateDistance?null:(h[0]=null,h[1]=null,this.computeMinDistancePoints(A,R,h),void this.updateMinDistance(h,!1))))},so.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},so.prototype.updateMinDistance=function(h,f){if(h[0]===null)return null;f?(this._minDistanceLocation[0]=h[1],this._minDistanceLocation[1]=h[0]):(this._minDistanceLocation[0]=h[0],this._minDistanceLocation[1]=h[1])},so.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},so.prototype.computeMinDistance=function(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Je&&arguments[1]instanceof ft){var h=arguments[0],f=arguments[1],_=arguments[2];if(h.getEnvelopeInternal().distance(f.getEnvelopeInternal())>this._minDistance)return null;for(var A=h.getCoordinates(),R=f.getCoordinate(),H=0;H<A.length-1;H++){var te=pt.distancePointLine(R,A[H],A[H+1]);if(te<this._minDistance){this._minDistance=te;var ge=new jr(A[H],A[H+1]).closestPoint(R);_[0]=new Oo(h,H,ge),_[1]=new Oo(f,0,R)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Je&&arguments[1]instanceof Je){var Ne=arguments[0],Ye=arguments[1],Mt=arguments[2];if(Ne.getEnvelopeInternal().distance(Ye.getEnvelopeInternal())>this._minDistance)return null;for(var At=Ne.getCoordinates(),hr=Ye.getCoordinates(),gr=0;gr<At.length-1;gr++)for(var Sr=0;Sr<hr.length-1;Sr++){var Kr=pt.distanceLineLine(At[gr],At[gr+1],hr[Sr],hr[Sr+1]);if(Kr<this._minDistance){this._minDistance=Kr;var Vi=new jr(At[gr],At[gr+1]),jn=new jr(hr[Sr],hr[Sr+1]),ts=Vi.closestPoints(jn);Mt[0]=new Oo(Ne,gr,ts[0]),Mt[1]=new Oo(Ye,Sr,ts[1])}if(this._minDistance<=this._terminateDistance)return null}}}},so.prototype.computeMinDistancePoints=function(h,f,_){for(var A=0;A<h.size();A++)for(var R=h.get(A),H=0;H<f.size();H++){var te=f.get(H),ge=R.getCoordinate().distance(te.getCoordinate());if(ge<this._minDistance&&(this._minDistance=ge,_[0]=new Oo(R,0,R.getCoordinate()),_[1]=new Oo(te,0,te.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},so.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new T("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},so.prototype.computeMinDistanceLines=function(h,f,_){for(var A=0;A<h.size();A++)for(var R=h.get(A),H=0;H<f.size();H++){var te=f.get(H);if(this.computeMinDistance(R,te,_),this._minDistance<=this._terminateDistance)return null}},so.prototype.interfaces_=function(){return[]},so.prototype.getClass=function(){return so},so.distance=function(h,f){return new so(h,f).distance()},so.isWithinDistance=function(h,f,_){return new so(h,f,_).distance()<=_},so.nearestPoints=function(h,f){return new so(h,f).nearestPoints()};var ko=s(function(){this._pt=[new z,new z],this._distance=D.NaN,this._isNull=!0},"Ri");ko.prototype.getCoordinates=function(){return this._pt},ko.prototype.getCoordinate=function(h){return this._pt[h]},ko.prototype.setMinimum=function(){if(arguments.length===1){var h=arguments[0];this.setMinimum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A<this._distance&&this.initialize(f,_,A)}},ko.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var h=arguments[0],f=arguments[1];this._pt[0].setCoordinate(h),this._pt[1].setCoordinate(f),this._distance=h.distance(f),this._isNull=!1}else if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2];this._pt[0].setCoordinate(_),this._pt[1].setCoordinate(A),this._distance=R,this._isNull=!1}},ko.prototype.toString=function(){return at.toLineString(this._pt[0],this._pt[1])},ko.prototype.getDistance=function(){return this._distance},ko.prototype.setMaximum=function(){if(arguments.length===1){var h=arguments[0];this.setMaximum(h._pt[0],h._pt[1])}else if(arguments.length===2){var f=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(f,_),null;var A=f.distance(_);A>this._distance&&this.initialize(f,_,A)}},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko};var pu=s(function(){},"Pi");pu.prototype.interfaces_=function(){return[]},pu.prototype.getClass=function(){return pu},pu.computeDistance=function(){if(arguments[2]instanceof ko&&arguments[0]instanceof Je&&arguments[1]instanceof z)for(var h=arguments[0],f=arguments[1],_=arguments[2],A=new jr,R=h.getCoordinates(),H=0;H<R.length-1;H++){A.setCoordinates(R[H],R[H+1]);var te=A.closestPoint(f);_.setMinimum(te,f)}else if(arguments[2]instanceof ko&&arguments[0]instanceof zt&&arguments[1]instanceof z){var ge=arguments[0],Ne=arguments[1],Ye=arguments[2];pu.computeDistance(ge.getExteriorRing(),Ne,Ye);for(var Mt=0;Mt<ge.getNumInteriorRing();Mt++)pu.computeDistance(ge.getInteriorRingN(Mt),Ne,Ye)}else if(arguments[2]instanceof ko&&arguments[0]instanceof $t&&arguments[1]instanceof z){var At=arguments[0],hr=arguments[1],gr=arguments[2];if(At instanceof Je)pu.computeDistance(At,hr,gr);else if(At instanceof zt)pu.computeDistance(At,hr,gr);else if(At instanceof Cr)for(var Sr=At,Kr=0;Kr<Sr.getNumGeometries();Kr++){var Vi=Sr.getGeometryN(Kr);pu.computeDistance(Vi,hr,gr)}else gr.setMinimum(At.getCoordinate(),hr)}else if(arguments[2]instanceof ko&&arguments[0]instanceof jr&&arguments[1]instanceof z){var jn=arguments[0],ts=arguments[1],mu=arguments[2],fh=jn.closestPoint(ts);mu.setMinimum(fh,ts)}};var ml=s(function(){this._g0=null,this._g1=null,this._ptDist=new ko,this._densifyFrac=0;var h=arguments[0],f=arguments[1];this._g0=h,this._g1=f},"Di"),Dv={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};ml.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},ml.prototype.setDensifyFraction=function(h){if(h>1||h<=0)throw new T("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=h},ml.prototype.compute=function(h,f){this.computeOrientedDistance(h,f,this._ptDist),this.computeOrientedDistance(f,h,this._ptDist)},ml.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},ml.prototype.computeOrientedDistance=function(h,f,_){var A=new lp(f);if(h.apply(A),_.setMaximum(A.getMaxPointDistance()),this._densifyFrac>0){var R=new Zu(f,this._densifyFrac);h.apply(R),_.setMaximum(R.getMaxPointDistance())}},ml.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},ml.prototype.interfaces_=function(){return[]},ml.prototype.getClass=function(){return ml},ml.distance=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1];return new ml(h,f).distance()}if(arguments.length===3){var _=arguments[0],A=arguments[1],R=arguments[2],H=new ml(_,A);return H.setDensifyFraction(R),H.distance()}},Dv.MaxPointDistanceFilter.get=function(){return lp},Dv.MaxDensifiedByFractionDistanceFilter.get=function(){return Zu},Object.defineProperties(ml,Dv);var lp=s(function(){this._maxPtDist=new ko,this._minPtDist=new ko,this._euclideanDist=new pu,this._geom=null;var h=arguments[0];this._geom=h},"Ai");lp.prototype.filter=function(h){this._minPtDist.initialize(),pu.computeDistance(this._geom,h,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},lp.prototype.getMaxPointDistance=function(){return this._maxPtDist},lp.prototype.interfaces_=function(){return[Fe]},lp.prototype.getClass=function(){return lp};var Zu=s(function(){this._maxPtDist=new ko,this._minPtDist=new ko,this._geom=null,this._numSubSegs=0;var h=arguments[0],f=arguments[1];this._geom=h,this._numSubSegs=Math.trunc(Math.round(1/f))},"Fi");Zu.prototype.filter=function(h,f){if(f===0)return null;for(var _=h.getCoordinate(f-1),A=h.getCoordinate(f),R=(A.x-_.x)/this._numSubSegs,H=(A.y-_.y)/this._numSubSegs,te=0;te<this._numSubSegs;te++){var ge=_.x+te*R,Ne=_.y+te*H,Ye=new z(ge,Ne);this._minPtDist.initialize(),pu.computeDistance(this._geom,Ye,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Zu.prototype.isDone=function(){return!1},Zu.prototype.isGeometryChanged=function(){return!1},Zu.prototype.getMaxPointDistance=function(){return this._maxPtDist},Zu.prototype.interfaces_=function(){return[Yr]},Zu.prototype.getClass=function(){return Zu};var ua=s(function(h,f,_){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=h||null,this._bufDistance=f||null,this._result=_||null},"Gi"),Rv={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ua.prototype.checkMaximumDistance=function(h,f,_){var A=new ml(f,h);if(A.setDensifyFraction(.25),this._maxDistanceFound=A.orientedDistance(),this._maxDistanceFound>_){this._isValid=!1;var R=A.getCoordinates();this._errorLocation=R[1],this._errorIndicator=h.getFactory().createLineString(R),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+at.toLineString(R[0],R[1])+")"}},ua.prototype.isValid=function(){var h=Math.abs(this._bufDistance),f=ua.MAX_DISTANCE_DIFF_FRAC*h;return this._minValidDistance=h-f,this._maxValidDistance=h+f,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ua.VERBOSE&&Re.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ua.prototype.checkNegativeValid=function(){if(!(this._input instanceof zt||this._input instanceof Ar||this._input instanceof Cr))return null;var h=this.getPolygonLines(this._input);if(this.checkMinimumDistance(h,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(h,this._result,this._maxValidDistance)},ua.prototype.getErrorIndicator=function(){return this._errorIndicator},ua.prototype.checkMinimumDistance=function(h,f,_){var A=new so(h,f,_);if(this._minDistanceFound=A.distance(),this._minDistanceFound<_){this._isValid=!1;var R=A.nearestPoints();this._errorLocation=A.nearestPoints()[1],this._errorIndicator=h.getFactory().createLineString(R),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+at.toLineString(R[0],R[1])+" )"}},ua.prototype.checkPositiveValid=function(){var h=this._result.getBoundary();if(this.checkMinimumDistance(this._input,h,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,h,this._maxValidDistance)},ua.prototype.getErrorLocation=function(){return this._errorLocation},ua.prototype.getPolygonLines=function(h){for(var f=new le,_=new wa(f),A=Ps.getPolygons(h).iterator();A.hasNext();)A.next().apply(_);return h.getFactory().buildGeometry(f)},ua.prototype.getErrorMessage=function(){return this._errMsg},ua.prototype.interfaces_=function(){return[]},ua.prototype.getClass=function(){return ua},Rv.VERBOSE.get=function(){return!1},Rv.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(ua,Rv);var Pn=s(function(h,f,_){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=h||null,this._distance=f||null,this._result=_||null},"Bi"),gl={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Pn.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Pn.prototype.checkEnvelope=function(){if(this._distance<0)return null;var h=this._distance*Pn.MAX_ENV_DIFF_FRAC;h===0&&(h=.001);var f=new Ae(this._input.getEnvelopeInternal());f.expandBy(this._distance);var _=new Ae(this._result.getEnvelopeInternal());_.expandBy(h),_.contains(f)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(_)),this.report("Envelope")},Pn.prototype.checkDistance=function(){var h=new ua(this._input,this._distance,this._result);h.isValid()||(this._isValid=!1,this._errorMsg=h.getErrorMessage(),this._errorLocation=h.getErrorLocation(),this._errorIndicator=h.getErrorIndicator()),this.report("Distance")},Pn.prototype.checkArea=function(){var h=this._input.getArea(),f=this._result.getArea();this._distance>0&&h>f&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&h<f&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Pn.prototype.checkPolygonal=function(){this._result instanceof zt||this._result instanceof Ar||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Pn.prototype.getErrorIndicator=function(){return this._errorIndicator},Pn.prototype.getErrorLocation=function(){return this._errorLocation},Pn.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Pn.prototype.report=function(h){if(!Pn.VERBOSE)return null;Re.out.println("Check "+h+": "+(this._isValid?"passed":"FAILED"))},Pn.prototype.getErrorMessage=function(){return this._errorMsg},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Pn.isValidMsg=function(h,f,_){var A=new Pn(h,f,_);return A.isValid()?null:A.getErrorMessage()},Pn.isValid=function(h,f,_){return!!new Pn(h,f,_).isValid()},gl.VERBOSE.get=function(){return!1},gl.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Pn,gl);var vs=s(function(){this._pts=null,this._data=null;var h=arguments[0],f=arguments[1];this._pts=h,this._data=f},"Ui");vs.prototype.getCoordinates=function(){return this._pts},vs.prototype.size=function(){return this._pts.length},vs.prototype.getCoordinate=function(h){return this._pts[h]},vs.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},vs.prototype.getSegmentOctant=function(h){return h===this._pts.length-1?-1:pl.octant(this.getCoordinate(h),this.getCoordinate(h+1))},vs.prototype.setData=function(h){this._data=h},vs.prototype.getData=function(){return this._data},vs.prototype.toString=function(){return at.toLineString(new Ur(this._pts))},vs.prototype.interfaces_=function(){return[qs]},vs.prototype.getClass=function(){return vs};var ka=s(function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new le,this._intersectionCount=0,this._keepIntersections=!0;var h=arguments[0];this._li=h,this._interiorIntersection=null},"zi");ka.prototype.getInteriorIntersection=function(){return this._interiorIntersection},ka.prototype.setCheckEndSegmentsOnly=function(h){this._isCheckEndSegmentsOnly=h},ka.prototype.getIntersectionSegments=function(){return this._intSegments},ka.prototype.count=function(){return this._intersectionCount},ka.prototype.getIntersections=function(){return this._intersections},ka.prototype.setFindAllIntersections=function(h){this._findAllIntersections=h},ka.prototype.setKeepIntersections=function(h){this._keepIntersections=h},ka.prototype.processIntersections=function(h,f,_,A){if(!this._findAllIntersections&&this.hasIntersection()||h===_&&f===A||this._isCheckEndSegmentsOnly&&!(this.isEndSegment(h,f)||this.isEndSegment(_,A)))return null;var R=h.getCoordinates()[f],H=h.getCoordinates()[f+1],te=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];this._li.computeIntersection(R,H,te,ge),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=R,this._intSegments[1]=H,this._intSegments[2]=te,this._intSegments[3]=ge,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},ka.prototype.isEndSegment=function(h,f){return f===0||f>=h.size()-2},ka.prototype.hasIntersection=function(){return this._interiorIntersection!==null},ka.prototype.isDone=function(){return!this._findAllIntersections&&this._interiorIntersection!==null},ka.prototype.interfaces_=function(){return[lu]},ka.prototype.getClass=function(){return ka},ka.createAllIntersectionsFinder=function(h){var f=new ka(h);return f.setFindAllIntersections(!0),f},ka.createAnyIntersectionFinder=function(h){return new ka(h)},ka.createIntersectionCounter=function(h){var f=new ka(h);return f.setFindAllIntersections(!0),f.setKeepIntersections(!1),f};var Ls=s(function(){this._li=new It,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var h=arguments[0];this._segStrings=h},"Xi");Ls.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()},Ls.prototype.getIntersections=function(){return this._segInt.getIntersections()},Ls.prototype.isValid=function(){return this.execute(),this._isValid},Ls.prototype.setFindAllIntersections=function(h){this._findAllIntersections=h},Ls.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new ka(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var h=new Vx;if(h.setSegmentIntersector(this._segInt),h.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Ls.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new qt(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Ls.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var h=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+at.toLineString(h[0],h[1])+" and "+at.toLineString(h[2],h[3])},Ls.prototype.interfaces_=function(){return[]},Ls.prototype.getClass=function(){return Ls},Ls.computeIntersections=function(h){var f=new Ls(h);return f.setFindAllIntersections(!0),f.isValid(),f.getIntersections()};var Yu=s(function h(){this._nv=null;var f=arguments[0];this._nv=new Ls(h.toSegmentStrings(f))},"t");Yu.prototype.checkValid=function(){this._nv.checkValid()},Yu.prototype.interfaces_=function(){return[]},Yu.prototype.getClass=function(){return Yu},Yu.toSegmentStrings=function(h){for(var f=new le,_=h.iterator();_.hasNext();){var A=_.next();f.add(new vs(A.getCoordinates(),A))}return f},Yu.checkValid=function(h){new Yu(h).checkValid()};var ch=s(function(h){this._mapOp=h},"ki");ch.prototype.map=function(h){for(var f=new le,_=0;_<h.getNumGeometries();_++){var A=this._mapOp.map(h.getGeometryN(_));A.isEmpty()||f.add(A)}return h.getFactory().createGeometryCollection(Gr.toGeometryArray(f))},ch.prototype.interfaces_=function(){return[]},ch.prototype.getClass=function(){return ch},ch.map=function(h,f){return new ch(f).map(h)};var _s=s(function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new le,this._resultLineList=new le;var h=arguments[0],f=arguments[1],_=arguments[2];this._op=h,this._geometryFactory=f,this._ptLocator=_},"ji");_s.prototype.collectLines=function(h){for(var f=this._op.getGraph().getEdgeEnds().iterator();f.hasNext();){var _=f.next();this.collectLineEdge(_,h,this._lineEdgesList),this.collectBoundaryTouchEdge(_,h,this._lineEdgesList)}},_s.prototype.labelIsolatedLine=function(h,f){var _=this._ptLocator.locate(h.getCoordinate(),this._op.getArgGeometry(f));h.getLabel().setLocation(f,_)},_s.prototype.build=function(h){return this.findCoveredLineEdges(),this.collectLines(h),this.buildLines(h),this._resultLineList},_s.prototype.collectLineEdge=function(h,f,_){var A=h.getLabel(),R=h.getEdge();h.isLineEdge()&&(h.isVisited()||!fi.isResultOfOp(A,f)||R.isCovered()||(_.add(R),h.setVisitedEdge(!0)))},_s.prototype.findCoveredLineEdges=function(){for(var h=this._op.getGraph().getNodes().iterator();h.hasNext();)h.next().getEdges().findCoveredLineEdges();for(var f=this._op.getGraph().getEdgeEnds().iterator();f.hasNext();){var _=f.next(),A=_.getEdge();if(_.isLineEdge()&&!A.isCoveredSet()){var R=this._op.isCoveredByA(_.getCoordinate());A.setCovered(R)}}},_s.prototype.labelIsolatedLines=function(h){for(var f=h.iterator();f.hasNext();){var _=f.next(),A=_.getLabel();_.isIsolated()&&(A.isNull(0)?this.labelIsolatedLine(_,0):this.labelIsolatedLine(_,1))}},_s.prototype.buildLines=function(h){for(var f=this._lineEdgesList.iterator();f.hasNext();){var _=f.next(),A=this._geometryFactory.createLineString(_.getCoordinates());this._resultLineList.add(A),_.setInResult(!0)}},_s.prototype.collectBoundaryTouchEdge=function(h,f,_){var A=h.getLabel();return h.isLineEdge()||h.isVisited()||h.isInteriorAreaEdge()||h.getEdge().isInResult()?null:(Me.isTrue(!(h.isInResult()||h.getSym().isInResult())||!h.getEdge().isInResult()),void(fi.isResultOfOp(A,f)&&f===fi.INTERSECTION&&(_.add(h.getEdge()),h.setVisitedEdge(!0))))},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s};var up=s(function(){this._op=null,this._geometryFactory=null,this._resultPointList=new le;var h=arguments[0],f=arguments[1];this._op=h,this._geometryFactory=f},"Hi");up.prototype.filterCoveredNodeToPoint=function(h){var f=h.getCoordinate();if(!this._op.isCoveredByLA(f)){var _=this._geometryFactory.createPoint(f);this._resultPointList.add(_)}},up.prototype.extractNonCoveredResultNodes=function(h){for(var f=this._op.getGraph().getNodes().iterator();f.hasNext();){var _=f.next();if(!_.isInResult()&&!_.isIncidentEdgeInResult()&&(_.getEdges().getDegree()===0||h===fi.INTERSECTION)){var A=_.getLabel();fi.isResultOfOp(A,h)&&this.filterCoveredNodeToPoint(_)}}},up.prototype.build=function(h){return this.extractNonCoveredResultNodes(h),this._resultPointList},up.prototype.interfaces_=function(){return[]},up.prototype.getClass=function(){return up};var bo=s(function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1},"Wi");bo.prototype.transformPoint=function(h,f){return this._factory.createPoint(this.transformCoordinates(h.getCoordinateSequence(),h))},bo.prototype.transformPolygon=function(h,f){var _=!0,A=this.transformLinearRing(h.getExteriorRing(),h);A!==null&&A instanceof ur&&!A.isEmpty()||(_=!1);for(var R=new le,H=0;H<h.getNumInteriorRing();H++){var te=this.transformLinearRing(h.getInteriorRingN(H),h);te===null||te.isEmpty()||(te instanceof ur||(_=!1),R.add(te))}if(_)return this._factory.createPolygon(A,R.toArray([]));var ge=new le;return A!==null&&ge.add(A),ge.addAll(R),this._factory.buildGeometry(ge)},bo.prototype.createCoordinateSequence=function(h){return this._factory.getCoordinateSequenceFactory().create(h)},bo.prototype.getInputGeometry=function(){return this._inputGeom},bo.prototype.transformMultiLineString=function(h,f){for(var _=new le,A=0;A<h.getNumGeometries();A++){var R=this.transformLineString(h.getGeometryN(A),h);R!==null&&(R.isEmpty()||_.add(R))}return this._factory.buildGeometry(_)},bo.prototype.transformCoordinates=function(h,f){return this.copy(h)},bo.prototype.transformLineString=function(h,f){return this._factory.createLineString(this.transformCoordinates(h.getCoordinateSequence(),h))},bo.prototype.transformMultiPoint=function(h,f){for(var _=new le,A=0;A<h.getNumGeometries();A++){var R=this.transformPoint(h.getGeometryN(A),h);R!==null&&(R.isEmpty()||_.add(R))}return this._factory.buildGeometry(_)},bo.prototype.transformMultiPolygon=function(h,f){for(var _=new le,A=0;A<h.getNumGeometries();A++){var R=this.transformPolygon(h.getGeometryN(A),h);R!==null&&(R.isEmpty()||_.add(R))}return this._factory.buildGeometry(_)},bo.prototype.copy=function(h){return h.copy()},bo.prototype.transformGeometryCollection=function(h,f){for(var _=new le,A=0;A<h.getNumGeometries();A++){var R=this.transform(h.getGeometryN(A));R!==null&&(this._pruneEmptyGeometry&&R.isEmpty()||_.add(R))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Gr.toGeometryArray(_)):this._factory.buildGeometry(_)},bo.prototype.transform=function(h){if(this._inputGeom=h,this._factory=h.getFactory(),h instanceof ft)return this.transformPoint(h,null);if(h instanceof cr)return this.transformMultiPoint(h,null);if(h instanceof ur)return this.transformLinearRing(h,null);if(h instanceof Je)return this.transformLineString(h,null);if(h instanceof Mi)return this.transformMultiLineString(h,null);if(h instanceof zt)return this.transformPolygon(h,null);if(h instanceof Ar)return this.transformMultiPolygon(h,null);if(h instanceof Cr)return this.transformGeometryCollection(h,null);throw new T("Unknown Geometry subtype: "+h.getClass().getName())},bo.prototype.transformLinearRing=function(h,f){var _=this.transformCoordinates(h.getCoordinateSequence(),h);if(_===null)return this._factory.createLinearRing(null);var A=_.size();return A>0&&A<4&&!this._preserveType?this._factory.createLineString(_):this._factory.createLinearRing(_)},bo.prototype.interfaces_=function(){return[]},bo.prototype.getClass=function(){return bo};var Ds=s(function h(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new jr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Je&&typeof arguments[1]=="number"){var f=arguments[0],_=arguments[1];h.call(this,f.getCoordinates(),_)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var A=arguments[0],R=arguments[1];this._srcPts=A,this._isClosed=h.isClosed(A),this._snapTolerance=R}},"t");Ds.prototype.snapVertices=function(h,f){for(var _=this._isClosed?h.size()-1:h.size(),A=0;A<_;A++){var R=h.get(A),H=this.findSnapForVertex(R,f);H!==null&&(h.set(A,new z(H)),A===0&&this._isClosed&&h.set(h.size()-1,new z(H)))}},Ds.prototype.findSnapForVertex=function(h,f){for(var _=0;_<f.length;_++){if(h.equals2D(f[_]))return null;if(h.distance(f[_])<this._snapTolerance)return f[_]}return null},Ds.prototype.snapTo=function(h){var f=new ze(this._srcPts);return this.snapVertices(f,h),this.snapSegments(f,h),f.toCoordinateArray()},Ds.prototype.snapSegments=function(h,f){if(f.length===0)return null;var _=f.length;f[0].equals2D(f[f.length-1])&&(_=f.length-1);for(var A=0;A<_;A++){var R=f[A],H=this.findSegmentIndexToSnap(R,h);H>=0&&h.add(H+1,new z(R),!1)}},Ds.prototype.findSegmentIndexToSnap=function(h,f){for(var _=D.MAX_VALUE,A=-1,R=0;R<f.size()-1;R++){if(this._seg.p0=f.get(R),this._seg.p1=f.get(R+1),this._seg.p0.equals2D(h)||this._seg.p1.equals2D(h)){if(this._allowSnappingToSourceVertices)continue;return-1}var H=this._seg.distance(h);H<this._snapTolerance&&H<_&&(_=H,A=R)}return A},Ds.prototype.setAllowSnappingToSourceVertices=function(h){this._allowSnappingToSourceVertices=h},Ds.prototype.interfaces_=function(){return[]},Ds.prototype.getClass=function(){return Ds},Ds.isClosed=function(h){return!(h.length<=1)&&h[0].equals2D(h[h.length-1])};var Aa=s(function(h){this._srcGeom=h||null},"Ji"),yl={SNAP_PRECISION_FACTOR:{configurable:!0}};Aa.prototype.snapTo=function(h,f){var _=this.extractTargetCoordinates(h);return new Ov(f,_).transform(this._srcGeom)},Aa.prototype.snapToSelf=function(h,f){var _=this.extractTargetCoordinates(this._srcGeom),A=new Ov(h,_,!0).transform(this._srcGeom),R=A;return f&&Y(R,rt)&&(R=A.buffer(0)),R},Aa.prototype.computeSnapTolerance=function(h){return this.computeMinimumSegmentLength(h)/10},Aa.prototype.extractTargetCoordinates=function(h){for(var f=new E,_=h.getCoordinates(),A=0;A<_.length;A++)f.add(_[A]);return f.toArray(new Array(0).fill(null))},Aa.prototype.computeMinimumSegmentLength=function(h){for(var f=D.MAX_VALUE,_=0;_<h.length-1;_++){var A=h[_].distance(h[_+1]);A<f&&(f=A)}return f},Aa.prototype.interfaces_=function(){return[]},Aa.prototype.getClass=function(){return Aa},Aa.snap=function(h,f,_){var A=new Array(2).fill(null),R=new Aa(h);A[0]=R.snapTo(f,_);var H=new Aa(f);return A[1]=H.snapTo(A[0],_),A},Aa.computeOverlaySnapTolerance=function(){if(arguments.length===1){var h=arguments[0],f=Aa.computeSizeBasedSnapTolerance(h),_=h.getPrecisionModel();if(_.getType()===si.FIXED){var A=1/_.getScale()*2/1.415;A>f&&(f=A)}return f}if(arguments.length===2){var R=arguments[0],H=arguments[1];return Math.min(Aa.computeOverlaySnapTolerance(R),Aa.computeOverlaySnapTolerance(H))}},Aa.computeSizeBasedSnapTolerance=function(h){var f=h.getEnvelopeInternal();return Math.min(f.getHeight(),f.getWidth())*Aa.SNAP_PRECISION_FACTOR},Aa.snapToSelf=function(h,f,_){return new Aa(h).snapToSelf(f,_)},yl.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Aa,yl);var Ov=function(h){function f(_,A,R){h.call(this),this._snapTolerance=_||null,this._snapPts=A||null,this._isSelfSnap=R!==void 0&&R}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.snapLine=function(_,A){var R=new Ds(_,this._snapTolerance);return R.setAllowSnappingToSourceVertices(this._isSelfSnap),R.snapTo(A)},f.prototype.transformCoordinates=function(_,A){var R=_.toCoordinateArray(),H=this.snapLine(R,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(H)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(bo),ca=s(function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null},"$i");ca.prototype.getCommon=function(){return D.longBitsToDouble(this._commonBits)},ca.prototype.add=function(h){var f=D.doubleToLongBits(h);if(this._isFirst)return this._commonBits=f,this._commonSignExp=ca.signExpBits(this._commonBits),this._isFirst=!1,null;if(ca.signExpBits(f)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=ca.numCommonMostSigMantissaBits(this._commonBits,f),this._commonBits=ca.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))},ca.prototype.toString=function(){if(arguments.length===1){var h=arguments[0],f=D.longBitsToDouble(h),_="0000000000000000000000000000000000000000000000000000000000000000"+D.toBinaryString(h),A=_.substring(_.length-64);return A.substring(0,1)+"  "+A.substring(1,12)+"(exp) "+A.substring(12)+" [ "+f+" ]"}},ca.prototype.interfaces_=function(){return[]},ca.prototype.getClass=function(){return ca},ca.getBit=function(h,f){return(h&1<<f)!=0?1:0},ca.signExpBits=function(h){return h>>52},ca.zeroLowerBits=function(h,f){return h&~((1<<f)-1)},ca.numCommonMostSigMantissaBits=function(h,f){for(var _=0,A=52;A>=0;A--){if(ca.getBit(h,A)!==ca.getBit(f,A))return _;_++}return 52};var kc=s(function(){this._commonCoord=null,this._ccFilter=new Ul},"tr"),Rf={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};kc.prototype.addCommonBits=function(h){var f=new Ku(this._commonCoord);h.apply(f),h.geometryChanged()},kc.prototype.removeCommonBits=function(h){if(this._commonCoord.x===0&&this._commonCoord.y===0)return h;var f=new z(this._commonCoord);f.x=-f.x,f.y=-f.y;var _=new Ku(f);return h.apply(_),h.geometryChanged(),h},kc.prototype.getCommonCoordinate=function(){return this._commonCoord},kc.prototype.add=function(h){h.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},kc.prototype.interfaces_=function(){return[]},kc.prototype.getClass=function(){return kc},Rf.CommonCoordinateFilter.get=function(){return Ul},Rf.Translater.get=function(){return Ku},Object.defineProperties(kc,Rf);var Ul=s(function(){this._commonBitsX=new ca,this._commonBitsY=new ca},"nr");Ul.prototype.filter=function(h){this._commonBitsX.add(h.x),this._commonBitsY.add(h.y)},Ul.prototype.getCommonCoordinate=function(){return new z(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Ul.prototype.interfaces_=function(){return[Fe]},Ul.prototype.getClass=function(){return Ul};var Ku=s(function(){this.trans=null;var h=arguments[0];this.trans=h},"ir");Ku.prototype.filter=function(h,f){var _=h.getOrdinate(f,0)+this.trans.x,A=h.getOrdinate(f,1)+this.trans.y;h.setOrdinate(f,0,_),h.setOrdinate(f,1,A)},Ku.prototype.isDone=function(){return!1},Ku.prototype.isGeometryChanged=function(){return!0},Ku.prototype.interfaces_=function(){return[Yr]},Ku.prototype.getClass=function(){return Ku};var Na=s(function(h,f){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=h,this._geom[1]=f,this.computeSnapTolerance()},"rr");Na.prototype.selfSnap=function(h){return new Aa(h).snapTo(h,this._snapTolerance)},Na.prototype.removeCommonBits=function(h){this._cbr=new kc,this._cbr.add(h[0]),this._cbr.add(h[1]);var f=new Array(2).fill(null);return f[0]=this._cbr.removeCommonBits(h[0].copy()),f[1]=this._cbr.removeCommonBits(h[1].copy()),f},Na.prototype.prepareResult=function(h){return this._cbr.addCommonBits(h),h},Na.prototype.getResultGeometry=function(h){var f=this.snap(this._geom),_=fi.overlayOp(f[0],f[1],h);return this.prepareResult(_)},Na.prototype.checkValid=function(h){h.isValid()||Re.out.println("Snapped geometry is invalid")},Na.prototype.computeSnapTolerance=function(){this._snapTolerance=Aa.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Na.prototype.snap=function(h){var f=this.removeCommonBits(h);return Aa.snap(f[0],f[1],this._snapTolerance)},Na.prototype.interfaces_=function(){return[]},Na.prototype.getClass=function(){return Na},Na.overlayOp=function(h,f,_){return new Na(h,f).getResultGeometry(_)},Na.union=function(h,f){return Na.overlayOp(h,f,fi.UNION)},Na.intersection=function(h,f){return Na.overlayOp(h,f,fi.INTERSECTION)},Na.symDifference=function(h,f){return Na.overlayOp(h,f,fi.SYMDIFFERENCE)},Na.difference=function(h,f){return Na.overlayOp(h,f,fi.DIFFERENCE)};var Fa=s(function(h,f){this._geom=new Array(2).fill(null),this._geom[0]=h,this._geom[1]=f},"or");Fa.prototype.getResultGeometry=function(h){var f=null,_=!1,A=null;try{f=fi.overlayOp(this._geom[0],this._geom[1],h),_=!0}catch(R){if(!(R instanceof Lt))throw R;A=R}if(!_)try{f=Na.overlayOp(this._geom[0],this._geom[1],h)}catch(R){throw R instanceof Lt?A:R}return f},Fa.prototype.interfaces_=function(){return[]},Fa.prototype.getClass=function(){return Fa},Fa.overlayOp=function(h,f,_){return new Fa(h,f).getResultGeometry(_)},Fa.union=function(h,f){return Fa.overlayOp(h,f,fi.UNION)},Fa.intersection=function(h,f){return Fa.overlayOp(h,f,fi.INTERSECTION)},Fa.symDifference=function(h,f){return Fa.overlayOp(h,f,fi.SYMDIFFERENCE)},Fa.difference=function(h,f){return Fa.overlayOp(h,f,fi.DIFFERENCE)};var Nc=s(function(){this.mce=null,this.chainIndex=null;var h=arguments[0],f=arguments[1];this.mce=h,this.chainIndex=f},"sr");Nc.prototype.computeIntersections=function(h,f){this.mce.computeIntersectsForChain(this.chainIndex,h.mce,h.chainIndex,f)},Nc.prototype.interfaces_=function(){return[]},Nc.prototype.getClass=function(){return Nc};var No=s(function h(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var f=arguments[0],_=arguments[1];this._eventType=h.DELETE,this._xValue=f,this._insertEvent=_}else if(arguments.length===3){var A=arguments[0],R=arguments[1],H=arguments[2];this._eventType=h.INSERT,this._label=A,this._xValue=R,this._obj=H}},"t"),Of={INSERT:{configurable:!0},DELETE:{configurable:!0}};No.prototype.isDelete=function(){return this._eventType===No.DELETE},No.prototype.setDeleteEventIndex=function(h){this._deleteEventIndex=h},No.prototype.getObject=function(){return this._obj},No.prototype.compareTo=function(h){var f=h;return this._xValue<f._xValue?-1:this._xValue>f._xValue?1:this._eventType<f._eventType?-1:this._eventType>f._eventType?1:0},No.prototype.getInsertEvent=function(){return this._insertEvent},No.prototype.isInsert=function(){return this._eventType===No.INSERT},No.prototype.isSameLabel=function(h){return this._label!==null&&this._label===h._label},No.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},No.prototype.interfaces_=function(){return[k]},No.prototype.getClass=function(){return No},Of.INSERT.get=function(){return 1},Of.DELETE.get=function(){return 2},Object.defineProperties(No,Of);var Ys=s(function(){},"lr");Ys.prototype.interfaces_=function(){return[]},Ys.prototype.getClass=function(){return Ys};var Ln=s(function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var h=arguments[0],f=arguments[1],_=arguments[2];this._li=h,this._includeProper=f,this._recordIsolated=_},"cr");Ln.prototype.isTrivialIntersection=function(h,f,_,A){if(h===_&&this._li.getIntersectionNum()===1){if(Ln.isAdjacentSegments(f,A))return!0;if(h.isClosed()){var R=h.getNumPoints()-1;if(f===0&&A===R||A===0&&f===R)return!0}}return!1},Ln.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Ln.prototype.setIsDoneIfProperInt=function(h){this._isDoneWhenProperInt=h},Ln.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Ln.prototype.isBoundaryPointInternal=function(h,f){for(var _=f.iterator();_.hasNext();){var A=_.next().getCoordinate();if(h.isIntersection(A))return!0}return!1},Ln.prototype.hasProperIntersection=function(){return this._hasProper},Ln.prototype.hasIntersection=function(){return this._hasIntersection},Ln.prototype.isDone=function(){return this._isDone},Ln.prototype.isBoundaryPoint=function(h,f){return f!==null&&(!!this.isBoundaryPointInternal(h,f[0])||!!this.isBoundaryPointInternal(h,f[1]))},Ln.prototype.setBoundaryNodes=function(h,f){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=h,this._bdyNodes[1]=f},Ln.prototype.addIntersections=function(h,f,_,A){if(h===_&&f===A)return null;this.numTests++;var R=h.getCoordinates()[f],H=h.getCoordinates()[f+1],te=_.getCoordinates()[A],ge=_.getCoordinates()[A+1];this._li.computeIntersection(R,H,te,ge),this._li.hasIntersection()&&(this._recordIsolated&&(h.setIsolated(!1),_.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(h,f,_,A)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(h.addIntersections(this._li,f,0),_.addIntersections(this._li,A,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.isAdjacentSegments=function(h,f){return Math.abs(h-f)===1};var dd=function(h){function f(){h.call(this),this.events=new le,this.nOverlaps=null}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.prepareEvents=function(){Ge.sort(this.events);for(var _=0;_<this.events.size();_++){var A=this.events.get(_);A.isDelete()&&A.getInsertEvent().setDeleteEventIndex(_)}},f.prototype.computeIntersections=function(){if(arguments.length===1){var _=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var A=0;A<this.events.size();A++){var R=this.events.get(A);if(R.isInsert()&&this.processOverlaps(A,R.getDeleteEventIndex(),R,_),_.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Ln&&Y(arguments[0],oe)&&Y(arguments[1],oe)){var H=arguments[0],te=arguments[1],ge=arguments[2];this.addEdges(H,H),this.addEdges(te,te),this.computeIntersections(ge)}else if(typeof arguments[2]=="boolean"&&Y(arguments[0],oe)&&arguments[1]instanceof Ln){var Ne=arguments[0],Ye=arguments[1];arguments[2]?this.addEdges(Ne,null):this.addEdges(Ne),this.computeIntersections(Ye)}}},f.prototype.addEdge=function(_,A){for(var R=_.getMonotoneChainEdge(),H=R.getStartIndexes(),te=0;te<H.length-1;te++){var ge=new Nc(R,te),Ne=new No(A,R.getMinX(te),ge);this.events.add(Ne),this.events.add(new No(R.getMaxX(te),Ne))}},f.prototype.processOverlaps=function(_,A,R,H){for(var te=R.getObject(),ge=_;ge<A;ge++){var Ne=this.events.get(ge);if(Ne.isInsert()){var Ye=Ne.getObject();R.isSameLabel(Ne)||(te.computeIntersections(Ye,H),this.nOverlaps++)}}},f.prototype.addEdges=function(){if(arguments.length===1)for(var _=arguments[0].iterator();_.hasNext();){var A=_.next();this.addEdge(A,A)}else if(arguments.length===2)for(var R=arguments[0],H=arguments[1],te=R.iterator();te.hasNext();){var ge=te.next();this.addEdge(ge,H)}},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Ys),Fo=s(function(){this._min=D.POSITIVE_INFINITY,this._max=D.NEGATIVE_INFINITY},"hr"),Fc={NodeComparator:{configurable:!0}};Fo.prototype.getMin=function(){return this._min},Fo.prototype.intersects=function(h,f){return!(this._min>f||this._max<h)},Fo.prototype.getMax=function(){return this._max},Fo.prototype.toString=function(){return at.toLineString(new z(this._min,0),new z(this._max,0))},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo},Fc.NodeComparator.get=function(){return Ju},Object.defineProperties(Fo,Fc);var Ju=s(function(){},"gr");Ju.prototype.compare=function(h,f){var _=h,A=f,R=(_._min+_._max)/2,H=(A._min+A._max)/2;return R<H?-1:R>H?1:0},Ju.prototype.interfaces_=function(){return[U]},Ju.prototype.getClass=function(){return Ju};var CS=function(h){function f(){h.call(this),this._item=null;var _=arguments[0],A=arguments[1],R=arguments[2];this._min=_,this._max=A,this._item=R}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.query=function(_,A,R){if(!this.intersects(_,A))return null;R.visitItem(this._item)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Fo),$x=function(h){function f(){h.call(this),this._node1=null,this._node2=null;var _=arguments[0],A=arguments[1];this._node1=_,this._node2=A,this.buildExtent(this._node1,this._node2)}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.buildExtent=function(_,A){this._min=Math.min(_._min,A._min),this._max=Math.max(_._max,A._max)},f.prototype.query=function(_,A,R){if(!this.intersects(_,A))return null;this._node1!==null&&this._node1.query(_,A,R),this._node2!==null&&this._node2.query(_,A,R)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(Fo),Vl=s(function(){this._leaves=new le,this._root=null,this._level=0},"_r");Vl.prototype.buildTree=function(){Ge.sort(this._leaves,new Fo.NodeComparator);for(var h=this._leaves,f=null,_=new le;;){if(this.buildLevel(h,_),_.size()===1)return _.get(0);f=h,h=_,_=f}},Vl.prototype.insert=function(h,f,_){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new CS(h,f,_))},Vl.prototype.query=function(h,f,_){this.init(),this._root.query(h,f,_)},Vl.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()},Vl.prototype.printNode=function(h){Re.out.println(at.toLineString(new z(h._min,this._level),new z(h._max,this._level)))},Vl.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()},Vl.prototype.buildLevel=function(h,f){this._level++,f.clear();for(var _=0;_<h.size();_+=2){var A=h.get(_);if((_+1<h.size()?h.get(_):null)===null)f.add(A);else{var R=new $x(h.get(_),h.get(_+1));f.add(R)}}},Vl.prototype.interfaces_=function(){return[]},Vl.prototype.getClass=function(){return Vl};var wo=s(function(){this._items=new le},"mr");wo.prototype.visitItem=function(h){this._items.add(h)},wo.prototype.getItems=function(){return this._items},wo.prototype.interfaces_=function(){return[qn]},wo.prototype.getClass=function(){return wo};var ra=s(function(){this._index=null;var h=arguments[0];if(!Y(h,rt))throw new T("Argument must be Polygonal");this._index=new xs(h)},"vr"),xn={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};ra.prototype.locate=function(h){var f=new Et(h),_=new du(f);return this._index.query(h.y,h.y,_),f.getLocation()},ra.prototype.interfaces_=function(){return[hd]},ra.prototype.getClass=function(){return ra},xn.SegmentVisitor.get=function(){return du},xn.IntervalIndexedGeometry.get=function(){return xs},Object.defineProperties(ra,xn);var du=s(function(){this._counter=null;var h=arguments[0];this._counter=h},"Er");du.prototype.visitItem=function(h){var f=h;this._counter.countSegment(f.getCoordinate(0),f.getCoordinate(1))},du.prototype.interfaces_=function(){return[qn]},du.prototype.getClass=function(){return du};var xs=s(function(){this._index=new Vl;var h=arguments[0];this.init(h)},"xr");xs.prototype.init=function(h){for(var f=wa.getLines(h).iterator();f.hasNext();){var _=f.next().getCoordinates();this.addLine(_)}},xs.prototype.addLine=function(h){for(var f=1;f<h.length;f++){var _=new jr(h[f-1],h[f]),A=Math.min(_.p0.y,_.p1.y),R=Math.max(_.p0.y,_.p1.y);this._index.insert(A,R,_)}},xs.prototype.query=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1],_=new wo;return this._index.query(h,f,_),_.getItems()}if(arguments.length===3){var A=arguments[0],R=arguments[1],H=arguments[2];this._index.query(A,R,H)}},xs.prototype.interfaces_=function(){return[]},xs.prototype.getClass=function(){return xs};var fd=function(h){function f(){if(h.call(this),this._parentGeom=null,this._lineEdgeMap=new Vr,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Zs,arguments.length===2){var _=arguments[0],A=arguments[1],R=Xe.OGC_SFS_BOUNDARY_RULE;this._argIndex=_,this._parentGeom=A,this._boundaryNodeRule=R,A!==null&&this.add(A)}else if(arguments.length===3){var H=arguments[0],te=arguments[1],ge=arguments[2];this._argIndex=H,this._parentGeom=te,this._boundaryNodeRule=ge,te!==null&&this.add(te)}}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.insertBoundaryPoint=function(_,A){var R=this._nodes.addNode(A).getLabel(),H=1;V.NONE,R.getLocation(_,Te.ON)===V.BOUNDARY&&H++;var te=f.determineBoundary(this._boundaryNodeRule,H);R.setLocation(_,te)},f.prototype.computeSelfNodes=function(){if(arguments.length===2){var _=arguments[0],A=arguments[1];return this.computeSelfNodes(_,A,!1)}if(arguments.length===3){var R=arguments[0],H=arguments[1],te=arguments[2],ge=new Ln(R,!0,!1);ge.setIsDoneIfProperInt(te);var Ne=this.createEdgeSetIntersector(),Ye=this._parentGeom instanceof ur||this._parentGeom instanceof zt||this._parentGeom instanceof Ar,Mt=H||!Ye;return Ne.computeIntersections(this._edges,ge,Mt),this.addSelfIntersectionNodes(this._argIndex),ge}},f.prototype.computeSplitEdges=function(_){for(var A=this._edges.iterator();A.hasNext();)A.next().eiList.addSplitEdges(_)},f.prototype.computeEdgeIntersections=function(_,A,R){var H=new Ln(A,R,!0);return H.setBoundaryNodes(this.getBoundaryNodes(),_.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,_._edges,H),H},f.prototype.getGeometry=function(){return this._parentGeom},f.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},f.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},f.prototype.addPoint=function(){if(arguments[0]instanceof ft){var _=arguments[0].getCoordinate();this.insertPoint(this._argIndex,_,V.INTERIOR)}else if(arguments[0]instanceof z){var A=arguments[0];this.insertPoint(this._argIndex,A,V.INTERIOR)}},f.prototype.addPolygon=function(_){this.addPolygonRing(_.getExteriorRing(),V.EXTERIOR,V.INTERIOR);for(var A=0;A<_.getNumInteriorRing();A++){var R=_.getInteriorRingN(A);this.addPolygonRing(R,V.INTERIOR,V.EXTERIOR)}},f.prototype.addEdge=function(_){this.insertEdge(_);var A=_.getCoordinates();this.insertPoint(this._argIndex,A[0],V.BOUNDARY),this.insertPoint(this._argIndex,A[A.length-1],V.BOUNDARY)},f.prototype.addLineString=function(_){var A=De.removeRepeatedPoints(_.getCoordinates());if(A.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=A[0],null;var R=new Sg(A,new lr(this._argIndex,V.INTERIOR));this._lineEdgeMap.put(_,R),this.insertEdge(R),Me.isTrue(A.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,A[0]),this.insertBoundaryPoint(this._argIndex,A[A.length-1])},f.prototype.getInvalidPoint=function(){return this._invalidPoint},f.prototype.getBoundaryPoints=function(){for(var _=this.getBoundaryNodes(),A=new Array(_.size()).fill(null),R=0,H=_.iterator();H.hasNext();){var te=H.next();A[R++]=te.getCoordinate().copy()}return A},f.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},f.prototype.addSelfIntersectionNode=function(_,A,R){if(this.isBoundaryNode(_,A))return null;R===V.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(_,A):this.insertPoint(_,A,R)},f.prototype.addPolygonRing=function(_,A,R){if(_.isEmpty())return null;var H=De.removeRepeatedPoints(_.getCoordinates());if(H.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=H[0],null;var te=A,ge=R;pt.isCCW(H)&&(te=R,ge=A);var Ne=new Sg(H,new lr(this._argIndex,V.BOUNDARY,te,ge));this._lineEdgeMap.put(_,Ne),this.insertEdge(Ne),this.insertPoint(this._argIndex,H[0],V.BOUNDARY)},f.prototype.insertPoint=function(_,A,R){var H=this._nodes.addNode(A),te=H.getLabel();te===null?H._label=new lr(_,R):te.setLocation(_,R)},f.prototype.createEdgeSetIntersector=function(){return new dd},f.prototype.addSelfIntersectionNodes=function(_){for(var A=this._edges.iterator();A.hasNext();)for(var R=A.next(),H=R.getLabel().getLocation(_),te=R.eiList.iterator();te.hasNext();){var ge=te.next();this.addSelfIntersectionNode(_,ge.coord,H)}},f.prototype.add=function(){if(arguments.length!==1)return h.prototype.add.apply(this,arguments);var _=arguments[0];if(_.isEmpty())return null;if(_ instanceof Ar&&(this._useBoundaryDeterminationRule=!1),_ instanceof zt)this.addPolygon(_);else if(_ instanceof Je)this.addLineString(_);else if(_ instanceof ft)this.addPoint(_);else if(_ instanceof cr)this.addCollection(_);else if(_ instanceof Mi)this.addCollection(_);else if(_ instanceof Ar)this.addCollection(_);else{if(!(_ instanceof Cr))throw new Error(_.getClass().getName());this.addCollection(_)}},f.prototype.addCollection=function(_){for(var A=0;A<_.getNumGeometries();A++){var R=_.getGeometryN(A);this.add(R)}},f.prototype.locate=function(_){return Y(this._parentGeom,rt)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new ra(this._parentGeom)),this._areaPtLocator.locate(_)):this._ptLocator.locate(_,this._parentGeom)},f.prototype.findEdge=function(){if(arguments.length===1){var _=arguments[0];return this._lineEdgeMap.get(_)}return h.prototype.findEdge.apply(this,arguments)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f.determineBoundary=function(_,A){return _.isInBoundary(A)?V.BOUNDARY:V.INTERIOR},f}(ln),fu=s(function(){if(this._li=new It,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var h=arguments[0];this.setComputationPrecision(h.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new fd(0,h)}else if(arguments.length===2){var f=arguments[0],_=arguments[1],A=Xe.OGC_SFS_BOUNDARY_RULE;f.getPrecisionModel().compareTo(_.getPrecisionModel())>=0?this.setComputationPrecision(f.getPrecisionModel()):this.setComputationPrecision(_.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new fd(0,f,A),this._arg[1]=new fd(1,_,A)}else if(arguments.length===3){var R=arguments[0],H=arguments[1],te=arguments[2];R.getPrecisionModel().compareTo(H.getPrecisionModel())>=0?this.setComputationPrecision(R.getPrecisionModel()):this.setComputationPrecision(H.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new fd(0,R,te),this._arg[1]=new fd(1,H,te)}},"Cr");fu.prototype.getArgGeometry=function(h){return this._arg[h].getGeometry()},fu.prototype.setComputationPrecision=function(h){this._resultPrecisionModel=h,this._li.setPrecisionModel(this._resultPrecisionModel)},fu.prototype.interfaces_=function(){return[]},fu.prototype.getClass=function(){return fu};var hh=s(function(){},"Sr");hh.prototype.interfaces_=function(){return[]},hh.prototype.getClass=function(){return hh},hh.map=function(){if(arguments[0]instanceof $t&&Y(arguments[1],hh.MapOp)){for(var h=arguments[0],f=arguments[1],_=new le,A=0;A<h.getNumGeometries();A++){var R=f.map(h.getGeometryN(A));R!==null&&_.add(R)}return h.getFactory().buildGeometry(_)}if(Y(arguments[0],er)&&Y(arguments[1],hh.MapOp)){for(var H=arguments[0],te=arguments[1],ge=new le,Ne=H.iterator();Ne.hasNext();){var Ye=Ne.next(),Mt=te.map(Ye);Mt!==null&&ge.add(Mt)}return ge}},hh.MapOp=function(){};var fi=function(h){function f(){var _=arguments[0],A=arguments[1];h.call(this,_,A),this._ptLocator=new Zs,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new dl,this._resultPolyList=new le,this._resultLineList=new le,this._resultPointList=new le,this._graph=new ln(new SS),this._geomFact=_.getFactory()}return s(f,"e"),h&&(f.__proto__=h),f.prototype=Object.create(h&&h.prototype),f.prototype.constructor=f,f.prototype.insertUniqueEdge=function(_){var A=this._edgeList.findEqualEdge(_);if(A!==null){var R=A.getLabel(),H=_.getLabel();A.isPointwiseEqual(_)||(H=new lr(_.getLabel())).flip();var te=A.getDepth();te.isNull()&&te.add(R),te.add(H),R.merge(H)}else this._edgeList.add(_)},f.prototype.getGraph=function(){return this._graph},f.prototype.cancelDuplicateResultEdges=function(){for(var _=this._graph.getEdgeEnds().iterator();_.hasNext();){var A=_.next(),R=A.getSym();A.isInResult()&&R.isInResult()&&(A.setInResult(!1),R.setInResult(!1))}},f.prototype.isCoveredByLA=function(_){return!!this.isCovered(_,this._resultLineList)||!!this.isCovered(_,this._resultPolyList)},f.prototype.computeGeometry=function(_,A,R,H){var te=new le;return te.addAll(_),te.addAll(A),te.addAll(R),te.isEmpty()?f.createEmptyResult(H,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(te)},f.prototype.mergeSymLabels=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();)_.next().getEdges().mergeSymLabels()},f.prototype.isCovered=function(_,A){for(var R=A.iterator();R.hasNext();){var H=R.next();if(this._ptLocator.locate(_,H)!==V.EXTERIOR)return!0}return!1},f.prototype.replaceCollapsedEdges=function(){for(var _=new le,A=this._edgeList.iterator();A.hasNext();){var R=A.next();R.isCollapsed()&&(A.remove(),_.add(R.getCollapsedEdge()))}this._edgeList.addAll(_)},f.prototype.updateNodeLabelling=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();){var A=_.next(),R=A.getEdges().getLabel();A.getLabel().merge(R)}},f.prototype.getResultGeometry=function(_){return this.computeOverlay(_),this._resultGeom},f.prototype.insertUniqueEdges=function(_){for(var A=_.iterator();A.hasNext();){var R=A.next();this.insertUniqueEdge(R)}},f.prototype.computeOverlay=function(_){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var A=new le;this._arg[0].computeSplitEdges(A),this._arg[1].computeSplitEdges(A),this.insertUniqueEdges(A),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Yu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(_),this.cancelDuplicateResultEdges();var R=new Ia(this._geomFact);R.add(this._graph),this._resultPolyList=R.getPolygons();var H=new _s(this,this._geomFact,this._ptLocator);this._resultLineList=H.build(_);var te=new up(this,this._geomFact,this._ptLocator);this._resultPointList=te.build(_),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,_)},f.prototype.labelIncompleteNode=function(_,A){var R=this._ptLocator.locate(_.getCoordinate(),this._arg[A].getGeometry());_.getLabel().setLocation(A,R)},f.prototype.copyPoints=function(_){for(var A=this._arg[_].getNodeIterator();A.hasNext();){var R=A.next();this._graph.addNode(R.getCoordinate()).setLabel(_,R.getLabel().getLocation(_))}},f.prototype.findResultAreaEdges=function(_){for(var A=this._graph.getEdgeEnds().iterator();A.hasNext();){var R=A.next(),H=R.getLabel();H.isArea()&&!R.isInteriorAreaEdge()&&f.isResultOfOp(H.getLocation(0,Te.RIGHT),H.getLocation(1,Te.RIGHT),_)&&R.setInResult(!0)}},f.prototype.computeLabelsFromDepths=function(){for(var _=this._edgeList.iterator();_.hasNext();){var A=_.next(),R=A.getLabel(),H=A.getDepth();if(!H.isNull()){H.normalize();for(var te=0;te<2;te++)R.isNull(te)||!R.isArea()||H.isNull(te)||(H.getDelta(te)===0?R.toLine(te):(Me.isTrue(!H.isNull(te,Te.LEFT),"depth of LEFT side has not been initialized"),R.setLocation(te,Te.LEFT,H.getLocation(te,Te.LEFT)),Me.isTrue(!H.isNull(te,Te.RIGHT),"depth of RIGHT side has not been initialized"),R.setLocation(te,Te.RIGHT,H.getLocation(te,Te.RIGHT))))}}},f.prototype.computeLabelling=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();)_.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},f.prototype.labelIncompleteNodes=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();){var A=_.next(),R=A.getLabel();A.isIsolated()&&(R.isNull(0)?this.labelIncompleteNode(A,0):this.labelIncompleteNode(A,1)),A.getEdges().updateLabelling(R)}},f.prototype.isCoveredByA=function(_){return!!this.isCovered(_,this._resultPolyList)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(fu);fi.overlayOp=function(h,f,_){return new fi(h,f).getResultGeometry(_)},fi.intersection=function(h,f){if(h.isEmpty()||f.isEmpty())return fi.createEmptyResult(fi.INTERSECTION,h,f,h.getFactory());if(h.isGeometryCollection()){var _=f;return ch.map(h,{interfaces_:s(function(){return[hh.MapOp]},"interfaces_"),map:s(function(A){return A.intersection(_)},"map")})}return h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Fa.overlayOp(h,f,fi.INTERSECTION)},fi.symDifference=function(h,f){if(h.isEmpty()||f.isEmpty()){if(h.isEmpty()&&f.isEmpty())return fi.createEmptyResult(fi.SYMDIFFERENCE,h,f,h.getFactory());if(h.isEmpty())return f.copy();if(f.isEmpty())return h.copy()}return h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Fa.overlayOp(h,f,fi.SYMDIFFERENCE)},fi.resultDimension=function(h,f,_){var A=f.getDimension(),R=_.getDimension(),H=-1;switch(h){case fi.INTERSECTION:H=Math.min(A,R);break;case fi.UNION:H=Math.max(A,R);break;case fi.DIFFERENCE:H=A;break;case fi.SYMDIFFERENCE:H=Math.max(A,R)}return H},fi.createEmptyResult=function(h,f,_,A){var R=null;switch(fi.resultDimension(h,f,_)){case-1:R=A.createGeometryCollection(new Array(0).fill(null));break;case 0:R=A.createPoint();break;case 1:R=A.createLineString();break;case 2:R=A.createPolygon()}return R},fi.difference=function(h,f){return h.isEmpty()?fi.createEmptyResult(fi.DIFFERENCE,h,f,h.getFactory()):f.isEmpty()?h.copy():(h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Fa.overlayOp(h,f,fi.DIFFERENCE))},fi.isResultOfOp=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1],_=h.getLocation(0),A=h.getLocation(1);return fi.isResultOfOp(_,A,f)}if(arguments.length===3){var R=arguments[0],H=arguments[1],te=arguments[2];switch(R===V.BOUNDARY&&(R=V.INTERIOR),H===V.BOUNDARY&&(H=V.INTERIOR),te){case fi.INTERSECTION:return R===V.INTERIOR&&H===V.INTERIOR;case fi.UNION:return R===V.INTERIOR||H===V.INTERIOR;case fi.DIFFERENCE:return R===V.INTERIOR&&H!==V.INTERIOR;case fi.SYMDIFFERENCE:return R===V.INTERIOR&&H!==V.INTERIOR||R!==V.INTERIOR&&H===V.INTERIOR}return!1}},fi.INTERSECTION=1,fi.UNION=2,fi.DIFFERENCE=3,fi.SYMDIFFERENCE=4;var jl=s(function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Zs,this._seg=new jr;var h=arguments[0],f=arguments[1];this._g=h,this._boundaryDistanceTolerance=f,this._linework=this.extractLinework(h)},"br");jl.prototype.isWithinToleranceOfBoundary=function(h){for(var f=0;f<this._linework.getNumGeometries();f++)for(var _=this._linework.getGeometryN(f).getCoordinateSequence(),A=0;A<_.size()-1;A++)if(_.getCoordinate(A,this._seg.p0),_.getCoordinate(A+1,this._seg.p1),this._seg.distance(h)<=this._boundaryDistanceTolerance)return!0;return!1},jl.prototype.getLocation=function(h){return this.isWithinToleranceOfBoundary(h)?V.BOUNDARY:this._ptLocator.locate(h,this._g)},jl.prototype.extractLinework=function(h){var f=new Bc;h.apply(f);var _=f.getLinework(),A=Gr.toLineStringArray(_);return h.getFactory().createMultiLineString(A)},jl.prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl};var Bc=s(function(){this._linework=null,this._linework=new le},"wr");Bc.prototype.getLinework=function(){return this._linework},Bc.prototype.filter=function(h){if(h instanceof zt){var f=h;this._linework.add(f.getExteriorRing());for(var _=0;_<f.getNumInteriorRing();_++)this._linework.add(f.getInteriorRingN(_))}},Bc.prototype.interfaces_=function(){return[ni]},Bc.prototype.getClass=function(){return Bc};var ph=s(function(){this._g=null,this._doLeft=!0,this._doRight=!0;var h=arguments[0];this._g=h},"Or");ph.prototype.extractPoints=function(h,f,_){for(var A=h.getCoordinates(),R=0;R<A.length-1;R++)this.computeOffsetPoints(A[R],A[R+1],f,_)},ph.prototype.setSidesToGenerate=function(h,f){this._doLeft=h,this._doRight=f},ph.prototype.getPoints=function(h){for(var f=new le,_=wa.getLines(this._g).iterator();_.hasNext();){var A=_.next();this.extractPoints(A,h,f)}return f},ph.prototype.computeOffsetPoints=function(h,f,_,A){var R=f.x-h.x,H=f.y-h.y,te=Math.sqrt(R*R+H*H),ge=_*R/te,Ne=_*H/te,Ye=(f.x+h.x)/2,Mt=(f.y+h.y)/2;if(this._doLeft){var At=new z(Ye-Ne,Mt+ge);A.add(At)}if(this._doRight){var hr=new z(Ye+Ne,Mt-ge);A.add(hr)}},ph.prototype.interfaces_=function(){return[]},ph.prototype.getClass=function(){return ph};var Bo=s(function h(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=h.TOLERANCE,this._testCoords=new le;var f=arguments[0],_=arguments[1],A=arguments[2];this._boundaryDistanceTolerance=h.computeBoundaryDistanceTolerance(f,_),this._geom=[f,_,A],this._locFinder=[new jl(this._geom[0],this._boundaryDistanceTolerance),new jl(this._geom[1],this._boundaryDistanceTolerance),new jl(this._geom[2],this._boundaryDistanceTolerance)]},"t"),kv={TOLERANCE:{configurable:!0}};Bo.prototype.reportResult=function(h,f,_){Re.out.println("Overlay result invalid - A:"+V.toLocationSymbol(f[0])+" B:"+V.toLocationSymbol(f[1])+" expected:"+(_?"i":"e")+" actual:"+V.toLocationSymbol(f[2]))},Bo.prototype.isValid=function(h){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var f=this.checkValid(h);return f},Bo.prototype.checkValid=function(){if(arguments.length===1){for(var h=arguments[0],f=0;f<this._testCoords.size();f++){var _=this._testCoords.get(f);if(!this.checkValid(h,_))return this._invalidLocation=_,!1}return!0}if(arguments.length===2){var A=arguments[0],R=arguments[1];return this._location[0]=this._locFinder[0].getLocation(R),this._location[1]=this._locFinder[1].getLocation(R),this._location[2]=this._locFinder[2].getLocation(R),!!Bo.hasLocation(this._location,V.BOUNDARY)||this.isValidResult(A,this._location)}},Bo.prototype.addTestPts=function(h){var f=new ph(h);this._testCoords.addAll(f.getPoints(5*this._boundaryDistanceTolerance))},Bo.prototype.isValidResult=function(h,f){var _=fi.isResultOfOp(f[0],f[1],h),A=!(_^f[2]===V.INTERIOR);return A||this.reportResult(h,f,_),A},Bo.prototype.getInvalidLocation=function(){return this._invalidLocation},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo},Bo.hasLocation=function(h,f){for(var _=0;_<3;_++)if(h[_]===f)return!0;return!1},Bo.computeBoundaryDistanceTolerance=function(h,f){return Math.min(Aa.computeSizeBasedSnapTolerance(h),Aa.computeSizeBasedSnapTolerance(f))},Bo.isValid=function(h,f,_,A){return new Bo(h,f,A).isValid(_)},kv.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Bo,kv);var lo=s(function h(f){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=h.extractFactory(f),this._inputGeoms=f},"t");lo.prototype.extractElements=function(h,f){if(h===null)return null;for(var _=0;_<h.getNumGeometries();_++){var A=h.getGeometryN(_);this._skipEmpty&&A.isEmpty()||f.add(A)}},lo.prototype.combine=function(){for(var h=new le,f=this._inputGeoms.iterator();f.hasNext();){var _=f.next();this.extractElements(_,h)}return h.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(h)},lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo.combine=function(){if(arguments.length===1){var h=arguments[0];return new lo(h).combine()}if(arguments.length===2){var f=arguments[0],_=arguments[1];return new lo(lo.createList(f,_)).combine()}if(arguments.length===3){var A=arguments[0],R=arguments[1],H=arguments[2];return new lo(lo.createList(A,R,H)).combine()}},lo.extractFactory=function(h){return h.isEmpty()?null:h.iterator().next().getFactory()},lo.createList=function(){if(arguments.length===2){var h=arguments[0],f=arguments[1],_=new le;return _.add(h),_.add(f),_}if(arguments.length===3){var A=arguments[0],R=arguments[1],H=arguments[2],te=new le;return te.add(A),te.add(R),te.add(H),te}};var En=s(function(){this._inputPolys=null,this._geomFactory=null;var h=arguments[0];this._inputPolys=h,this._inputPolys===null&&(this._inputPolys=new le)},"Dr"),dh={STRTREE_NODE_CAPACITY:{configurable:!0}};En.prototype.reduceToGeometries=function(h){for(var f=new le,_=h.iterator();_.hasNext();){var A=_.next(),R=null;Y(A,oe)?R=this.unionTree(A):A instanceof $t&&(R=A),f.add(R)}return f},En.prototype.extractByEnvelope=function(h,f,_){for(var A=new le,R=0;R<f.getNumGeometries();R++){var H=f.getGeometryN(R);H.getEnvelopeInternal().intersects(h)?A.add(H):_.add(H)}return this._geomFactory.buildGeometry(A)},En.prototype.unionOptimized=function(h,f){var _=h.getEnvelopeInternal(),A=f.getEnvelopeInternal();if(!_.intersects(A))return lo.combine(h,f);if(h.getNumGeometries()<=1&&f.getNumGeometries()<=1)return this.unionActual(h,f);var R=_.intersection(A);return this.unionUsingEnvelopeIntersection(h,f,R)},En.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var h=new mi(En.STRTREE_NODE_CAPACITY),f=this._inputPolys.iterator();f.hasNext();){var _=f.next();h.insert(_.getEnvelopeInternal(),_)}this._inputPolys=null;var A=h.itemsTree();return this.unionTree(A)},En.prototype.binaryUnion=function(){if(arguments.length===1){var h=arguments[0];return this.binaryUnion(h,0,h.size())}if(arguments.length===3){var f=arguments[0],_=arguments[1],A=arguments[2];if(A-_<=1){var R=En.getGeometry(f,_);return this.unionSafe(R,null)}if(A-_==2)return this.unionSafe(En.getGeometry(f,_),En.getGeometry(f,_+1));var H=Math.trunc((A+_)/2),te=this.binaryUnion(f,_,H),ge=this.binaryUnion(f,H,A);return this.unionSafe(te,ge)}},En.prototype.repeatedUnion=function(h){for(var f=null,_=h.iterator();_.hasNext();){var A=_.next();f=f===null?A.copy():f.union(A)}return f},En.prototype.unionSafe=function(h,f){return h===null&&f===null?null:h===null?f.copy():f===null?h.copy():this.unionOptimized(h,f)},En.prototype.unionActual=function(h,f){return En.restrictToPolygons(h.union(f))},En.prototype.unionTree=function(h){var f=this.reduceToGeometries(h);return this.binaryUnion(f)},En.prototype.unionUsingEnvelopeIntersection=function(h,f,_){var A=new le,R=this.extractByEnvelope(_,h,A),H=this.extractByEnvelope(_,f,A),te=this.unionActual(R,H);return A.add(te),lo.combine(A)},En.prototype.bufferUnion=function(){if(arguments.length===1){var h=arguments[0];return h.get(0).getFactory().buildGeometry(h).buffer(0)}if(arguments.length===2){var f=arguments[0],_=arguments[1];return f.getFactory().createGeometryCollection([f,_]).buffer(0)}},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En},En.restrictToPolygons=function(h){if(Y(h,rt))return h;var f=Ps.getPolygons(h);return f.size()===1?f.get(0):h.getFactory().createMultiPolygon(Gr.toPolygonArray(f))},En.getGeometry=function(h,f){return f>=h.size()?null:h.get(f)},En.union=function(h){return new En(h).union()},dh.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(En,dh);var $l=s(function(){},"Ar");$l.prototype.interfaces_=function(){return[]},$l.prototype.getClass=function(){return $l},$l.union=function(h,f){if(h.isEmpty()||f.isEmpty()){if(h.isEmpty()&&f.isEmpty())return fi.createEmptyResult(fi.UNION,h,f,h.getFactory());if(h.isEmpty())return f.copy();if(f.isEmpty())return h.copy()}return h.checkNotGeometryCollection(h),h.checkNotGeometryCollection(f),Fa.overlayOp(h,f,fi.UNION)},r.GeoJSONReader=be,r.GeoJSONWriter=Ce,r.OverlayOp=fi,r.UnionOp=$l,r.BufferOp=oo,Object.defineProperty(r,"__esModule",{value:!0})})}),t3=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;var e=class{};s(e,"_CodeOrName");var r=e;t._CodeOrName=r,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var i=class extends r{constructor(k){if(super(),!t.IDENTIFIER.test(k))throw new Error("CodeGen: name must be a valid identifier");this.str=k}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};s(i,"Name");var n=i;t.Name=n;var a=class extends r{constructor(k){super(),this._items=typeof k=="string"?[k]:k}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let k=this._items[0];return k===""||k==='""'}get str(){var k;return(k=this._str)!==null&&k!==void 0?k:this._str=this._items.reduce((B,U)=>"".concat(B).concat(U),"")}get names(){var k;return(k=this._names)!==null&&k!==void 0?k:this._names=this._items.reduce((B,U)=>(U instanceof n&&(B[U.str]=(B[U.str]||0)+1),B),{})}};s(a,"_Code");var o=a;t._Code=o,t.nil=new o("");function l(F,...k){let B=[F[0]],U=0;for(;U<k.length;)p(B,k[U]),B.push(F[++U]);return new o(B)}s(l,"_"),t._=l;var u=new o("+");function c(F,...k){let B=[I(F[0])],U=0;for(;U<k.length;)B.push(u),p(B,k[U]),B.push(u,I(F[++U]));return m(B),new o(B)}s(c,"str"),t.str=c;function p(F,k){k instanceof o?F.push(...k._items):k instanceof n?F.push(k):F.push(E(k))}s(p,"addCodeArg"),t.addCodeArg=p;function m(F){let k=1;for(;k<F.length-1;){if(F[k]===u){let B=y(F[k-1],F[k+1]);if(B!==void 0){F.splice(k-1,3,B);continue}F[k++]="+"}k++}}s(m,"optimize");function y(F,k){if(k==='""')return F;if(F==='""')return k;if(typeof F=="string")return k instanceof n||F[F.length-1]!=='"'?void 0:typeof k!="string"?"".concat(F.slice(0,-1)).concat(k,'"'):k[0]==='"'?F.slice(0,-1)+k.slice(1):void 0;if(typeof k=="string"&&k[0]==='"'&&!(F instanceof n))return'"'.concat(F).concat(k.slice(1))}s(y,"mergeExprItems");var v;function x(F,k){return k.emptyStr()?F:F.emptyStr()?k:c(v||(v=je(["","",""])),F,k)}s(x,"strConcat"),t.strConcat=x;function E(F){return typeof F=="number"||typeof F=="boolean"||F===null?F:I(Array.isArray(F)?F.join(","):F)}s(E,"interpolate");function M(F){return new o(I(F))}s(M,"stringify"),t.stringify=M;function I(F){return JSON.stringify(F).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}s(I,"safeStringify"),t.safeStringify=I;var P;function C(F){return typeof F=="string"&&t.IDENTIFIER.test(F)?new o(".".concat(F)):l(P||(P=je(["[","]"])),F)}s(C,"getProperty"),t.getProperty=C;function T(F){if(typeof F=="string"&&t.IDENTIFIER.test(F))return new o("".concat(F));throw new Error("CodeGen: invalid export name: ".concat(F,", use explicit $id name mapping"))}s(T,"getEsmExportName"),t.getEsmExportName=T;function D(F){return new o(F.toString())}s(D,"regexpCode"),t.regexpCode=D}),SW=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;var e=t3(),r=class extends Error{constructor(P){super('CodeGen: "code" for '.concat(P," not defined")),this.value=P.value}};s(r,"ValueError");var i=r,n;(function(I){I[I.Started=0]="Started",I[I.Completed=1]="Completed"})(n||(t.UsedValueState=n={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};var a=class{constructor({prefixes:P,parent:C}={}){this._names={},this._prefixes=P,this._parent=C}toName(P){return P instanceof e.Name?P:this.name(P)}name(P){return new e.Name(this._newName(P))}_newName(P){let C=this._names[P]||this._nameGroup(P);return"".concat(P).concat(C.index++)}_nameGroup(P){var C,T;if(!((T=(C=this._parent)===null||C===void 0?void 0:C._prefixes)===null||T===void 0)&&T.has(P)||this._prefixes&&!this._prefixes.has(P))throw new Error('CodeGen: prefix "'.concat(P,'" is not allowed in this scope'));return this._names[P]={prefix:P,index:0}}};s(a,"Scope");var o=a;t.Scope=o;var l,u=class extends e.Name{constructor(P,C){super(C),this.prefix=P}setValue(P,{property:C,itemIndex:T}){this.value=P,this.scopePath=(0,e._)(l||(l=je([".","[","]"])),new e.Name(C),T)}};s(u,"ValueScopeName");var c=u;t.ValueScopeName=c;var p,m=(0,e._)(p||(p=je([`
`],["\\n"]))),y,v,x,E=class extends o{constructor(P){super(P),this._values={},this._scope=P.scope,this.opts=vt(Ee({},P),{_n:P.lines?m:e.nil})}get(){return this._scope}name(P){return new c(P,this._newName(P))}value(P,C){var T;if(C.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let D=this.toName(P),{prefix:F}=D,k=(T=C.key)!==null&&T!==void 0?T:C.ref,B=this._values[F];if(B){let q=B.get(k);if(q)return q}else B=this._values[F]=new Map;B.set(k,D);let U=this._scope[F]||(this._scope[F]=[]),z=U.length;return U[z]=C.ref,D.setValue(C,{property:F,itemIndex:z}),D}getValue(P,C){let T=this._values[P];if(T)return T.get(C)}scopeRefs(P,C=this._values){return this._reduceValues(C,T=>{if(T.scopePath===void 0)throw new Error('CodeGen: name "'.concat(T,'" has no value'));return(0,e._)(y||(y=je(["","",""])),P,T.scopePath)})}scopeCode(P=this._values,C,T){return this._reduceValues(P,D=>{if(D.value===void 0)throw new Error('CodeGen: name "'.concat(D,'" has no value'));return D.value.code},C,T)}_reduceValues(P,C,T={},D){let F=e.nil;for(let k in P){let B=P[k];if(!B)continue;let U=T[k]=T[k]||new Map;B.forEach(z=>{if(U.has(z))return;U.set(z,n.Started);let q=C(z);if(q){let Z=this.opts.es5?t.varKinds.var:t.varKinds.const;F=(0,e._)(v||(v=je(["",""," "," = ",";",""])),F,Z,z,q,this.opts._n)}else if(q=D==null?void 0:D(z))F=(0,e._)(x||(x=je(["","","",""])),F,q,this.opts._n);else throw new i(z);U.set(z,n.Completed)})}return F}};s(E,"ValueScope");var M=E;t.ValueScope=M}),an=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;var e=t3(),r=SW(),i=t3();Object.defineProperty(t,"_",{enumerable:!0,get:s(function(){return i._},"get")}),Object.defineProperty(t,"str",{enumerable:!0,get:s(function(){return i.str},"get")}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:s(function(){return i.strConcat},"get")}),Object.defineProperty(t,"nil",{enumerable:!0,get:s(function(){return i.nil},"get")}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:s(function(){return i.getProperty},"get")}),Object.defineProperty(t,"stringify",{enumerable:!0,get:s(function(){return i.stringify},"get")}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:s(function(){return i.regexpCode},"get")}),Object.defineProperty(t,"Name",{enumerable:!0,get:s(function(){return i.Name},"get")});var n=SW();Object.defineProperty(t,"Scope",{enumerable:!0,get:s(function(){return n.Scope},"get")}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:s(function(){return n.ValueScope},"get")}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:s(function(){return n.ValueScopeName},"get")}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:s(function(){return n.varKinds},"get")}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};var a=class{optimizeNodes(){return this}optimizeNames(Fe,Xe){return this}};s(a,"Node");var o=a,l=class extends o{constructor(Fe,Xe,ht){super(),this.varKind=Fe,this.name=Xe,this.rhs=ht}render({es5:Fe,_n:Xe}){let ht=Fe?r.varKinds.var:this.varKind,rr=this.rhs===void 0?"":" = ".concat(this.rhs);return"".concat(ht," ").concat(this.name).concat(rr,";")+Xe}optimizeNames(Fe,Xe){if(Fe[this.name.str])return this.rhs&&(this.rhs=dt(this.rhs,Fe,Xe)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}};s(l,"Def");var u=l,c=class extends o{constructor(Fe,Xe,ht){super(),this.lhs=Fe,this.rhs=Xe,this.sideEffects=ht}render({_n:Fe}){return"".concat(this.lhs," = ").concat(this.rhs,";")+Fe}optimizeNames(Fe,Xe){if(!(this.lhs instanceof e.Name&&!Fe[this.lhs.str]&&!this.sideEffects))return this.rhs=dt(this.rhs,Fe,Xe),this}get names(){let Fe=this.lhs instanceof e.Name?{}:Ee({},this.lhs.names);return Lt(Fe,this.rhs)}};s(c,"Assign");var p=c,m=class extends p{constructor(Fe,Xe,ht,rr){super(Fe,ht,rr),this.op=Xe}render({_n:Fe}){return"".concat(this.lhs," ").concat(this.op,"= ").concat(this.rhs,";")+Fe}};s(m,"AssignOp");var y=m,v=class extends o{constructor(Fe){super(),this.label=Fe,this.names={}}render({_n:Fe}){return"".concat(this.label,":")+Fe}};s(v,"Label");var x=v,E=class extends o{constructor(Fe){super(),this.label=Fe,this.names={}}render({_n:Fe}){let Xe=this.label?" ".concat(this.label):"";return"break".concat(Xe,";")+Fe}};s(E,"Break");var M=E,I=class extends o{constructor(Fe){super(),this.error=Fe}render({_n:Fe}){return"throw ".concat(this.error,";")+Fe}get names(){return this.error.names}};s(I,"Throw");var P=I,C=class extends o{constructor(Fe){super(),this.code=Fe}render({_n:Fe}){return"".concat(this.code,";")+Fe}optimizeNodes(){return"".concat(this.code)?this:void 0}optimizeNames(Fe,Xe){return this.code=dt(this.code,Fe,Xe),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}};s(C,"AnyCode");var T=C,D=class extends o{constructor(Fe=[]){super(),this.nodes=Fe}render(Fe){return this.nodes.reduce((Xe,ht)=>Xe+ht.render(Fe),"")}optimizeNodes(){let{nodes:Fe}=this,Xe=Fe.length;for(;Xe--;){let ht=Fe[Xe].optimizeNodes();Array.isArray(ht)?Fe.splice(Xe,1,...ht):ht?Fe[Xe]=ht:Fe.splice(Xe,1)}return Fe.length>0?this:void 0}optimizeNames(Fe,Xe){let{nodes:ht}=this,rr=ht.length;for(;rr--;){let ar=ht[rr];ar.optimizeNames(Fe,Xe)||(Me(Fe,ar.names),ht.splice(rr,1))}return ht.length>0?this:void 0}get names(){return this.nodes.reduce((Fe,Xe)=>at(Fe,Xe.names),{})}};s(D,"ParentNode");var F=D,k=class extends F{render(Fe){return"{"+Fe._n+super.render(Fe)+"}"+Fe._n}};s(k,"BlockNode");var B=k,U=class extends F{};s(U,"Root");var z=U,q=class extends B{};s(q,"Else");var Z=q;Z.kind="else";var Q=class dC extends B{constructor(Fe,Xe){super(Xe),this.condition=Fe}render(Fe){let Xe="if(".concat(this.condition,")")+super.render(Fe);return this.else&&(Xe+="else "+this.else.render(Fe)),Xe}optimizeNodes(){super.optimizeNodes();let Fe=this.condition;if(Fe===!0)return this.nodes;let Xe=this.else;if(Xe){let ht=Xe.optimizeNodes();Xe=this.else=Array.isArray(ht)?new Z(ht):ht}if(Xe)return Fe===!1?Xe instanceof dC?Xe:Xe.nodes:this.nodes.length?this:new dC(Ze(Fe),Xe instanceof dC?[Xe]:Xe.nodes);if(!(Fe===!1||!this.nodes.length))return this}optimizeNames(Fe,Xe){var ht;if(this.else=(ht=this.else)===null||ht===void 0?void 0:ht.optimizeNames(Fe,Xe),!!(super.optimizeNames(Fe,Xe)||this.else))return this.condition=dt(this.condition,Fe,Xe),this}get names(){let Fe=super.names;return Lt(Fe,this.condition),this.else&&at(Fe,this.else.names),Fe}};s(Q,"If");var V=Q;V.kind="if";var ae=class extends B{};s(ae,"For");var Y=ae;Y.kind="for";var he=class extends Y{constructor(Fe){super(),this.iteration=Fe}render(Fe){return"for(".concat(this.iteration,")")+super.render(Fe)}optimizeNames(Fe,Xe){if(super.optimizeNames(Fe,Xe))return this.iteration=dt(this.iteration,Fe,Xe),this}get names(){return at(super.names,this.iteration.names)}};s(he,"ForLoop");var J=he,ne=class extends Y{constructor(Fe,Xe,ht,rr){super(),this.varKind=Fe,this.name=Xe,this.from=ht,this.to=rr}render(Fe){let Xe=Fe.es5?r.varKinds.var:this.varKind,{name:ht,from:rr,to:ar}=this;return"for(".concat(Xe," ").concat(ht,"=").concat(rr,"; ").concat(ht,"<").concat(ar,"; ").concat(ht,"++)")+super.render(Fe)}get names(){let Fe=Lt(super.names,this.from);return Lt(Fe,this.to)}};s(ne,"ForRange");var ee=ne,ue=class extends Y{constructor(Fe,Xe,ht,rr){super(),this.loop=Fe,this.varKind=Xe,this.name=ht,this.iterable=rr}render(Fe){return"for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+super.render(Fe)}optimizeNames(Fe,Xe){if(super.optimizeNames(Fe,Xe))return this.iterable=dt(this.iterable,Fe,Xe),this}get names(){return at(super.names,this.iterable.names)}};s(ue,"ForIter");var K=ue,ce=class extends B{constructor(Fe,Xe,ht){super(),this.name=Fe,this.args=Xe,this.async=ht}render(Fe){let Xe=this.async?"async ":"";return"".concat(Xe,"function ").concat(this.name,"(").concat(this.args,")")+super.render(Fe)}};s(ce,"Func");var re=ce;re.kind="func";var se=class extends F{render(Fe){return"return "+super.render(Fe)}};s(se,"Return");var de=se;de.kind="return";var we=class extends B{render(Fe){let Xe="try"+super.render(Fe);return this.catch&&(Xe+=this.catch.render(Fe)),this.finally&&(Xe+=this.finally.render(Fe)),Xe}optimizeNodes(){var Fe,Xe;return super.optimizeNodes(),(Fe=this.catch)===null||Fe===void 0||Fe.optimizeNodes(),(Xe=this.finally)===null||Xe===void 0||Xe.optimizeNodes(),this}optimizeNames(Fe,Xe){var ht,rr;return super.optimizeNames(Fe,Xe),(ht=this.catch)===null||ht===void 0||ht.optimizeNames(Fe,Xe),(rr=this.finally)===null||rr===void 0||rr.optimizeNames(Fe,Xe),this}get names(){let Fe=super.names;return this.catch&&at(Fe,this.catch.names),this.finally&&at(Fe,this.finally.names),Fe}};s(we,"Try");var Le=we,fe=class extends B{constructor(Fe){super(),this.error=Fe}render(Fe){return"catch(".concat(this.error,")")+super.render(Fe)}};s(fe,"Catch");var Re=fe;Re.kind="catch";var me=class extends B{render(Fe){return"finally"+super.render(Fe)}};s(me,"Finally");var Ae=me;Ae.kind="finally";var Ue,_e,lt,tt=class{constructor(Fe,Xe={}){this._values={},this._blockStarts=[],this._constants={},this.opts=vt(Ee({},Xe),{_n:Xe.lines?`
`:""}),this._extScope=Fe,this._scope=new r.Scope({parent:Fe}),this._nodes=[new z]}toString(){return this._root.render(this.opts)}name(Fe){return this._scope.name(Fe)}scopeName(Fe){return this._extScope.name(Fe)}scopeValue(Fe,Xe){let ht=this._extScope.value(Fe,Xe);return(this._values[ht.prefix]||(this._values[ht.prefix]=new Set)).add(ht),ht}getScopeValue(Fe,Xe){return this._extScope.getValue(Fe,Xe)}scopeRefs(Fe){return this._extScope.scopeRefs(Fe,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Fe,Xe,ht,rr){let ar=this._scope.toName(Xe);return ht!==void 0&&rr&&(this._constants[ar.str]=ht),this._leafNode(new u(Fe,ar,ht)),ar}const(Fe,Xe,ht){return this._def(r.varKinds.const,Fe,Xe,ht)}let(Fe,Xe,ht){return this._def(r.varKinds.let,Fe,Xe,ht)}var(Fe,Xe,ht){return this._def(r.varKinds.var,Fe,Xe,ht)}assign(Fe,Xe,ht){return this._leafNode(new p(Fe,Xe,ht))}add(Fe,Xe){return this._leafNode(new y(Fe,t.operators.ADD,Xe))}code(Fe){return typeof Fe=="function"?Fe():Fe!==e.nil&&this._leafNode(new T(Fe)),this}object(...Fe){let Xe=["{"];for(let[ht,rr]of Fe)Xe.length>1&&Xe.push(","),Xe.push(ht),(ht!==rr||this.opts.es5)&&(Xe.push(":"),(0,e.addCodeArg)(Xe,rr));return Xe.push("}"),new e._Code(Xe)}if(Fe,Xe,ht){if(this._blockNode(new V(Fe)),Xe&&ht)this.code(Xe).else().code(ht).endIf();else if(Xe)this.code(Xe).endIf();else if(ht)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(Fe){return this._elseNode(new V(Fe))}else(){return this._elseNode(new Z)}endIf(){return this._endBlockNode(V,Z)}_for(Fe,Xe){return this._blockNode(Fe),Xe&&this.code(Xe).endFor(),this}for(Fe,Xe){return this._for(new J(Fe),Xe)}forRange(Fe,Xe,ht,rr,ar=this.opts.es5?r.varKinds.var:r.varKinds.let){let zr=this._scope.toName(Fe);return this._for(new ee(ar,zr,Xe,ht),()=>rr(zr))}forOf(Fe,Xe,ht,rr=r.varKinds.const){let ar=this._scope.toName(Fe);if(this.opts.es5){let zr=Xe instanceof e.Name?Xe:this.var("_arr",Xe);return this.forRange("_i",0,(0,e._)(Ue||(Ue=je(["",".length"])),zr),Qe=>{this.var(ar,(0,e._)(_e||(_e=je(["","[","]"])),zr,Qe)),ht(ar)})}return this._for(new K("of",rr,ar,Xe),()=>ht(ar))}forIn(Fe,Xe,ht,rr=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(Fe,(0,e._)(lt||(lt=je(["Object.keys(",")"])),Xe),ht);let ar=this._scope.toName(Fe);return this._for(new K("in",rr,ar,Xe),()=>ht(ar))}endFor(){return this._endBlockNode(Y)}label(Fe){return this._leafNode(new x(Fe))}break(Fe){return this._leafNode(new M(Fe))}return(Fe){let Xe=new de;if(this._blockNode(Xe),this.code(Fe),Xe.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(de)}try(Fe,Xe,ht){if(!Xe&&!ht)throw new Error('CodeGen: "try" without "catch" and "finally"');let rr=new Le;if(this._blockNode(rr),this.code(Fe),Xe){let ar=this.name("e");this._currNode=rr.catch=new Re(ar),Xe(ar)}return ht&&(this._currNode=rr.finally=new Ae,this.code(ht)),this._endBlockNode(Re,Ae)}throw(Fe){return this._leafNode(new P(Fe))}block(Fe,Xe){return this._blockStarts.push(this._nodes.length),Fe&&this.code(Fe).endBlock(Xe),this}endBlock(Fe){let Xe=this._blockStarts.pop();if(Xe===void 0)throw new Error("CodeGen: not in self-balancing block");let ht=this._nodes.length-Xe;if(ht<0||Fe!==void 0&&ht!==Fe)throw new Error("CodeGen: wrong number of nodes: ".concat(ht," vs ").concat(Fe," expected"));return this._nodes.length=Xe,this}func(Fe,Xe=e.nil,ht,rr){return this._blockNode(new re(Fe,Xe,ht)),rr&&this.code(rr).endFunc(),this}endFunc(){return this._endBlockNode(re)}optimize(Fe=1){for(;Fe-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Fe){return this._currNode.nodes.push(Fe),this}_blockNode(Fe){this._currNode.nodes.push(Fe),this._nodes.push(Fe)}_endBlockNode(Fe,Xe){let ht=this._currNode;if(ht instanceof Fe||Xe&&ht instanceof Xe)return this._nodes.pop(),this;throw new Error('CodeGen: not in block "'.concat(Xe?"".concat(Fe.kind,"/").concat(Xe.kind):Fe.kind,'"'))}_elseNode(Fe){let Xe=this._currNode;if(!(Xe instanceof V))throw new Error('CodeGen: "else" without "if"');return this._currNode=Xe.else=Fe,this}get _root(){return this._nodes[0]}get _currNode(){let Fe=this._nodes;return Fe[Fe.length-1]}set _currNode(Fe){let Xe=this._nodes;Xe[Xe.length-1]=Fe}};s(tt,"CodeGen");var We=tt;t.CodeGen=We;function at(Nt,Fe){for(let Xe in Fe)Nt[Xe]=(Nt[Xe]||0)+(Fe[Xe]||0);return Nt}s(at,"addNames");function Lt(Nt,Fe){return Fe instanceof e._CodeOrName?at(Nt,Fe.names):Nt}s(Lt,"addExprNames");function dt(Nt,Fe,Xe){if(Nt instanceof e.Name)return ht(Nt);if(!rr(Nt))return Nt;return new e._Code(Nt._items.reduce((ar,zr)=>(zr instanceof e.Name&&(zr=ht(zr)),zr instanceof e._Code?ar.push(...zr._items):ar.push(zr),ar),[]));function ht(ar){let zr=Xe[ar.str];return zr===void 0||Fe[ar.str]!==1?ar:(delete Fe[ar.str],zr)}function rr(ar){return ar instanceof e._Code&&ar._items.some(zr=>zr instanceof e.Name&&Fe[zr.str]===1&&Xe[zr.str]!==void 0)}}s(dt,"optimizeExpr");function Me(Nt,Fe){for(let Xe in Fe)Nt[Xe]=(Nt[Xe]||0)-(Fe[Xe]||0)}s(Me,"subtractNames");var ve;function Ze(Nt){return typeof Nt=="boolean"||typeof Nt=="number"||Nt===null?!Nt:(0,e._)(ve||(ve=je(["!",""])),jt(Nt))}s(Ze,"not"),t.not=Ze;var It=Kt(t.operators.AND);function Rt(...Nt){return Nt.reduce(It)}s(Rt,"and"),t.and=Rt;var Et=Kt(t.operators.OR);function pt(...Nt){return Nt.reduce(Et)}s(pt,"or"),t.or=pt;var Yt;function Kt(Nt){return(Fe,Xe)=>Fe===e.nil?Xe:Xe===e.nil?Fe:(0,e._)(Yt||(Yt=je([""," "," ",""])),jt(Fe),Nt,jt(Xe))}s(Kt,"mappend");var $t;function jt(Nt){return Nt instanceof e.Name?Nt:(0,e._)($t||($t=je(["(",")"])),Nt)}s(jt,"par")}),Fn=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;var e=an(),r=t3();function i(re){let se={};for(let de of re)se[de]=!0;return se}s(i,"toHash"),t.toHash=i;function n(re,se){return typeof se=="boolean"?se:Object.keys(se).length===0?!0:(a(re,se),!o(se,re.self.RULES.all))}s(n,"alwaysValidSchema"),t.alwaysValidSchema=n;function a(re,se=re.schema){let{opts:de,self:we}=re;if(!de.strictSchema||typeof se=="boolean")return;let Le=we.RULES.keywords;for(let fe in se)Le[fe]||ce(re,'unknown keyword: "'.concat(fe,'"'))}s(a,"checkUnknownRules"),t.checkUnknownRules=a;function o(re,se){if(typeof re=="boolean")return!re;for(let de in re)if(se[de])return!0;return!1}s(o,"schemaHasRules"),t.schemaHasRules=o;function l(re,se){if(typeof re=="boolean")return!re;for(let de in re)if(de!=="$ref"&&se.all[de])return!0;return!1}s(l,"schemaHasRulesButRef"),t.schemaHasRulesButRef=l;var u,c;function p({topSchemaRef:re,schemaPath:se},de,we,Le){if(!Le){if(typeof de=="number"||typeof de=="boolean")return de;if(typeof de=="string")return(0,e._)(u||(u=je(["",""])),de)}return(0,e._)(c||(c=je(["","","",""])),re,se,(0,e.getProperty)(we))}s(p,"schemaRefOrVal"),t.schemaRefOrVal=p;function m(re){return x(decodeURIComponent(re))}s(m,"unescapeFragment"),t.unescapeFragment=m;function y(re){return encodeURIComponent(v(re))}s(y,"escapeFragment"),t.escapeFragment=y;function v(re){return typeof re=="number"?"".concat(re):re.replace(/~/g,"~0").replace(/\//g,"~1")}s(v,"escapeJsonPointer"),t.escapeJsonPointer=v;function x(re){return re.replace(/~1/g,"/").replace(/~0/g,"~")}s(x,"unescapeJsonPointer"),t.unescapeJsonPointer=x;function E(re,se){if(Array.isArray(re))for(let de of re)se(de);else se(re)}s(E,"eachItem"),t.eachItem=E;function M({mergeNames:re,mergeToName:se,mergeValues:de,resultToName:we}){return(Le,fe,Re,me)=>{let Ae=Re===void 0?fe:Re instanceof e.Name?(fe instanceof e.Name?re(Le,fe,Re):se(Le,fe,Re),Re):fe instanceof e.Name?(se(Le,Re,fe),fe):de(fe,Re);return me===e.Name&&!(Ae instanceof e.Name)?we(Le,Ae):Ae}}s(M,"makeMergeEvaluated");var I,P,C,T,D,F,k,B,U,z;t.mergeEvaluated={props:M({mergeNames:s((re,se,de)=>re.if((0,e._)(I||(I=je([""," !== true && "," !== undefined"])),de,se),()=>{re.if((0,e._)(P||(P=je([""," === true"])),se),()=>re.assign(de,!0),()=>re.assign(de,(0,e._)(C||(C=je([""," || {}"])),de)).code((0,e._)(T||(T=je(["Object.assign(",", ",")"])),de,se)))}),"mergeNames"),mergeToName:s((re,se,de)=>re.if((0,e._)(D||(D=je([""," !== true"])),de),()=>{se===!0?re.assign(de,!0):(re.assign(de,(0,e._)(F||(F=je([""," || {}"])),de)),V(re,de,se))}),"mergeToName"),mergeValues:s((re,se)=>re===!0?!0:Ee(Ee({},re),se),"mergeValues"),resultToName:Z}),items:M({mergeNames:s((re,se,de)=>re.if((0,e._)(k||(k=je([""," !== true && "," !== undefined"])),de,se),()=>re.assign(de,(0,e._)(B||(B=je([""," === true ? true : "," > "," ? "," : ",""])),se,de,se,de,se))),"mergeNames"),mergeToName:s((re,se,de)=>re.if((0,e._)(U||(U=je([""," !== true"])),de),()=>re.assign(de,se===!0?!0:(0,e._)(z||(z=je([""," > "," ? "," : ",""])),de,se,de,se))),"mergeToName"),mergeValues:s((re,se)=>re===!0?!0:Math.max(re,se),"mergeValues"),resultToName:s((re,se)=>re.var("items",se),"resultToName")})};var q;function Z(re,se){if(se===!0)return re.var("props",!0);let de=re.var("props",(0,e._)(q||(q=je(["{}"]))));return se!==void 0&&V(re,de,se),de}s(Z,"evaluatedPropsToName"),t.evaluatedPropsToName=Z;var Q;function V(re,se,de){Object.keys(de).forEach(we=>re.assign((0,e._)(Q||(Q=je(["","",""])),se,(0,e.getProperty)(we)),!0))}s(V,"setEvaluated"),t.setEvaluated=V;var ae={};function Y(re,se){return re.scopeValue("func",{ref:se,code:ae[se.code]||(ae[se.code]=new r._Code(se.code))})}s(Y,"useFunc"),t.useFunc=Y;var he;(function(re){re[re.Num=0]="Num",re[re.Str=1]="Str"})(he||(t.Type=he={}));var J,ne,ee,ue;function K(re,se,de){if(re instanceof e.Name){let we=se===he.Num;return de?we?(0,e._)(J||(J=je(['"[" + ',' + "]"'])),re):(0,e._)(ne||(ne=je([`"['" + `,` + "']"`])),re):we?(0,e._)(ee||(ee=je(['"/" + ',""])),re):(0,e._)(ue||(ue=je(['"/" + ','.replace(/~/g, "~0").replace(/\\//g, "~1")'],['"/" + ','.replace(/~/g, "~0").replace(/\\\\//g, "~1")'])),re)}return de?(0,e.getProperty)(re).toString():"/"+v(re)}s(K,"getErrorPath"),t.getErrorPath=K;function ce(re,se,de=re.opts.strictSchema){if(de){if(se="strict mode: ".concat(se),de===!0)throw new Error(se);re.self.logger.warn(se)}}s(ce,"checkStrictMode"),t.checkStrictMode=ce}),cg=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};t.default=r}),jP=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;var e=an(),r=Fn(),i=cg(),n;t.keywordError={message:s(({keyword:se})=>(0,e.str)(n||(n=je(['must pass "','" keyword validation'])),se),"message")};var a,o;t.keyword$DataError={message:s(({keyword:se,schemaType:de})=>de?(0,e.str)(a||(a=je(['"','" keyword must be '," ($data)"])),se,de):(0,e.str)(o||(o=je(['"','" keyword is invalid ($data)'])),se),"message")};var l;function u(se,de=t.keywordError,we,Le){let{it:fe}=se,{gen:Re,compositeRule:me,allErrors:Ae}=fe,Ue=ae(se,de,we);Le??(me||Ae)?U(Re,Ue):Z(fe,(0,e._)(l||(l=je(["[","]"])),Ue))}s(u,"reportError"),t.reportError=u;function c(se,de=t.keywordError,we){let{it:Le}=se,{gen:fe,compositeRule:Re,allErrors:me}=Le,Ae=ae(se,de,we);U(fe,Ae),Re||me||Z(Le,i.default.vErrors)}s(c,"reportExtraError"),t.reportExtraError=c;var p,m;function y(se,de){se.assign(i.default.errors,de),se.if((0,e._)(p||(p=je([""," !== null"])),i.default.vErrors),()=>se.if(de,()=>se.assign((0,e._)(m||(m=je(["",".length"])),i.default.vErrors),de),()=>se.assign(i.default.vErrors,null)))}s(y,"resetErrorsCount"),t.resetErrorsCount=y;var v,x,E,M,I,P,C;function T({gen:se,keyword:de,schemaValue:we,data:Le,errsCount:fe,it:Re}){if(fe===void 0)throw new Error("ajv implementation error");let me=se.name("err");se.forRange("i",fe,i.default.errors,Ae=>{se.const(me,(0,e._)(v||(v=je(["","[","]"])),i.default.vErrors,Ae)),se.if((0,e._)(x||(x=je(["",".instancePath === undefined"])),me),()=>se.assign((0,e._)(E||(E=je(["",".instancePath"])),me),(0,e.strConcat)(i.default.instancePath,Re.errorPath))),se.assign((0,e._)(M||(M=je(["",".schemaPath"])),me),(0,e.str)(I||(I=je(["","/",""])),Re.errSchemaPath,de)),Re.opts.verbose&&(se.assign((0,e._)(P||(P=je(["",".schema"])),me),we),se.assign((0,e._)(C||(C=je(["",".data"])),me),Le))})}s(T,"extendErrors"),t.extendErrors=T;var D,F,k,B;function U(se,de){let we=se.const("err",de);se.if((0,e._)(D||(D=je([""," === null"])),i.default.vErrors),()=>se.assign(i.default.vErrors,(0,e._)(F||(F=je(["[","]"])),we)),(0,e._)(k||(k=je(["",".push(",")"])),i.default.vErrors,we)),se.code((0,e._)(B||(B=je(["","++"])),i.default.errors))}s(U,"addError");var z,q;function Z(se,de){let{gen:we,validateName:Le,schemaEnv:fe}=se;fe.$async?we.throw((0,e._)(z||(z=je(["new ","(",")"])),se.ValidationError,de)):(we.assign((0,e._)(q||(q=je(["",".errors"])),Le),de),we.return(!1))}s(Z,"returnErrors");var Q={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")},V;function ae(se,de,we){let{createErrors:Le}=se.it;return Le===!1?(0,e._)(V||(V=je(["{}"]))):Y(se,de,we)}s(ae,"errorObjectCode");function Y(se,de,we={}){let{gen:Le,it:fe}=se,Re=[J(fe,we),ue(se,we)];return re(se,de,Re),Le.object(...Re)}s(Y,"errorObject");var he;function J({errorPath:se},{instancePath:de}){let we=de?(0,e.str)(he||(he=je(["","",""])),se,(0,r.getErrorPath)(de,r.Type.Str)):se;return[i.default.instancePath,(0,e.strConcat)(i.default.instancePath,we)]}s(J,"errorInstancePath");var ne,ee;function ue({keyword:se,it:{errSchemaPath:de}},{schemaPath:we,parentSchema:Le}){let fe=Le?de:(0,e.str)(ne||(ne=je(["","/",""])),de,se);return we&&(fe=(0,e.str)(ee||(ee=je(["","",""])),fe,(0,r.getErrorPath)(we,r.Type.Str))),[Q.schemaPath,fe]}s(ue,"errorSchemaPath");var K,ce;function re(se,{params:de,message:we},Le){let{keyword:fe,data:Re,schemaValue:me,it:Ae}=se,{opts:Ue,propertyName:_e,topSchemaRef:lt,schemaPath:tt}=Ae;Le.push([Q.keyword,fe],[Q.params,typeof de=="function"?de(se):de||(0,e._)(K||(K=je(["{}"])))]),Ue.messages&&Le.push([Q.message,typeof we=="function"?we(se):we]),Ue.verbose&&Le.push([Q.schema,me],[Q.parentSchema,(0,e._)(ce||(ce=je(["","",""])),lt,tt)],[i.default.data,Re]),_e&&Le.push([Q.propertyName,_e])}s(re,"extraErrorProps")}),mqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;var e=jP(),r=an(),i=cg(),n={message:"boolean schema is false"},a;function o(c){let{gen:p,schema:m,validateName:y}=c;m===!1?u(c,!1):typeof m=="object"&&m.$async===!0?p.return(i.default.data):(p.assign((0,r._)(a||(a=je(["",".errors"])),y),null),p.return(!0))}s(o,"topBoolOrEmptySchema"),t.topBoolOrEmptySchema=o;function l(c,p){let{gen:m,schema:y}=c;y===!1?(m.var(p,!1),u(c)):m.var(p,!0)}s(l,"boolOrEmptySchema"),t.boolOrEmptySchema=l;function u(c,p){let{gen:m,data:y}=c,v={gen:m,keyword:"false schema",data:y,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:c};(0,e.reportError)(v,n,void 0,p)}s(u,"falseSchemaError")}),eye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;var e=["string","number","integer","boolean","null","object","array"],r=new Set(e);function i(a){return typeof a=="string"&&r.has(a)}s(i,"isJSONType"),t.isJSONType=i;function n(){let a={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:vt(Ee({},a),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},a.number,a.string,a.array,a.object],post:{rules:[]},all:{},keywords:{}}}s(n,"getRules"),t.getRules=n}),tye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0;function e({schema:n,self:a},o){let l=a.RULES.types[o];return l&&l!==!0&&r(n,l)}s(e,"schemaHasRulesForType"),t.schemaHasRulesForType=e;function r(n,a){return a.rules.some(o=>i(n,o))}s(r,"shouldUseGroup"),t.shouldUseGroup=r;function i(n,a){var o;return n[a.keyword]!==void 0||((o=a.definition.implements)===null||o===void 0?void 0:o.some(l=>n[l]!==void 0))}s(i,"shouldUseRule"),t.shouldUseRule=i}),r3=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;var e=eye(),r=tye(),i=jP(),n=an(),a=Fn(),o;(function(tt){tt[tt.Correct=0]="Correct",tt[tt.Wrong=1]="Wrong"})(o||(t.DataType=o={}));function l(tt){let We=u(tt.type);if(We.includes("null")){if(tt.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!We.length&&tt.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');tt.nullable===!0&&We.push("null")}return We}s(l,"getSchemaTypes"),t.getSchemaTypes=l;function u(tt){let We=Array.isArray(tt)?tt:tt?[tt]:[];if(We.every(e.isJSONType))return We;throw new Error("type must be JSONType or JSONType[]: "+We.join(","))}s(u,"getJSONTypes"),t.getJSONTypes=u;function c(tt,We){let{gen:at,data:Lt,opts:dt}=tt,Me=m(We,dt.coerceTypes),ve=We.length>0&&!(Me.length===0&&We.length===1&&(0,r.schemaHasRulesForType)(tt,We[0]));if(ve){let Ze=Re(We,Lt,dt.strictNumbers,o.Wrong);at.if(Ze,()=>{Me.length?Y(tt,We,Me):_e(tt)})}return ve}s(c,"coerceAndCheckDataType"),t.coerceAndCheckDataType=c;var p=new Set(["string","number","integer","boolean","null"]);function m(tt,We){return We?tt.filter(at=>p.has(at)||We==="array"&&at==="array"):[]}s(m,"coerceToTypes");var y,v,x,E,M,I,P,C,T,D,F,k,B,U,z,q,Z,Q,V,ae;function Y(tt,We,at){let{gen:Lt,data:dt,opts:Me}=tt,ve=Lt.let("dataType",(0,n._)(y||(y=je(["typeof ",""])),dt)),Ze=Lt.let("coerced",(0,n._)(v||(v=je(["undefined"]))));Me.coerceTypes==="array"&&Lt.if((0,n._)(x||(x=je([""," == 'object' && Array.isArray(",") && ",".length == 1"])),ve,dt,dt),()=>Lt.assign(dt,(0,n._)(E||(E=je(["","[0]"])),dt)).assign(ve,(0,n._)(M||(M=je(["typeof ",""])),dt)).if(Re(We,dt,Me.strictNumbers),()=>Lt.assign(Ze,dt))),Lt.if((0,n._)(I||(I=je([""," !== undefined"])),Ze));for(let Rt of at)(p.has(Rt)||Rt==="array"&&Me.coerceTypes==="array")&&It(Rt);Lt.else(),_e(tt),Lt.endIf(),Lt.if((0,n._)(P||(P=je([""," !== undefined"])),Ze),()=>{Lt.assign(dt,Ze),ne(tt,Ze)});function It(Rt){switch(Rt){case"string":Lt.elseIf((0,n._)(C||(C=je(["",' == "number" || ',' == "boolean"'])),ve,ve)).assign(Ze,(0,n._)(T||(T=je(['"" + ',""])),dt)).elseIf((0,n._)(D||(D=je([""," === null"])),dt)).assign(Ze,(0,n._)(F||(F=je(['""']))));return;case"number":Lt.elseIf((0,n._)(k||(k=je(["",' == "boolean" || ',` === null
              || (`,' == "string" && '," && "," == +",")"])),ve,dt,ve,dt,dt,dt)).assign(Ze,(0,n._)(B||(B=je(["+",""])),dt));return;case"integer":Lt.elseIf((0,n._)(U||(U=je(["",' === "boolean" || ',` === null
              || (`,' === "string" && '," && "," == +"," && !("," % 1))"])),ve,dt,ve,dt,dt,dt,dt)).assign(Ze,(0,n._)(z||(z=je(["+",""])),dt));return;case"boolean":Lt.elseIf((0,n._)(q||(q=je(["",' === "false" || '," === 0 || "," === null"])),dt,dt,dt)).assign(Ze,!1).elseIf((0,n._)(Z||(Z=je(["",' === "true" || '," === 1"])),dt,dt)).assign(Ze,!0);return;case"null":Lt.elseIf((0,n._)(Q||(Q=je(["",' === "" || '," === 0 || "," === false"])),dt,dt,dt)),Lt.assign(Ze,null);return;case"array":Lt.elseIf((0,n._)(V||(V=je(["",' === "string" || ',` === "number"
              || `,' === "boolean" || '," === null"])),ve,ve,ve,dt)).assign(Ze,(0,n._)(ae||(ae=je(["[","]"])),dt))}}s(It,"coerceSpecificType")}s(Y,"coerceData");var he,J;function ne({gen:tt,parentData:We,parentDataProperty:at},Lt){tt.if((0,n._)(he||(he=je([""," !== undefined"])),We),()=>tt.assign((0,n._)(J||(J=je(["","[","]"])),We,at),Lt))}s(ne,"assignParentData");var ee,ue,K,ce,re,se,de;function we(tt,We,at,Lt=o.Correct){let dt=Lt===o.Correct?n.operators.EQ:n.operators.NEQ,Me;switch(tt){case"null":return(0,n._)(ee||(ee=je([""," "," null"])),We,dt);case"array":Me=(0,n._)(ue||(ue=je(["Array.isArray(",")"])),We);break;case"object":Me=(0,n._)(K||(K=je([""," && typeof ",' == "object" && !Array.isArray(',")"])),We,We,We);break;case"integer":Me=ve((0,n._)(ce||(ce=je(["!("," % 1) && !isNaN(",")"])),We,We));break;case"number":Me=ve();break;default:return(0,n._)(re||(re=je(["typeof "," "," ",""])),We,dt,tt)}return Lt===o.Correct?Me:(0,n.not)(Me);function ve(Ze=n.nil){return(0,n.and)((0,n._)(se||(se=je(["typeof ",' == "number"'])),We),Ze,at?(0,n._)(de||(de=je(["isFinite(",")"])),We):n.nil)}}s(we,"checkDataType"),t.checkDataType=we;var Le,fe;function Re(tt,We,at,Lt){if(tt.length===1)return we(tt[0],We,at,Lt);let dt,Me=(0,a.toHash)(tt);if(Me.array&&Me.object){let ve=(0,n._)(Le||(Le=je(["typeof ",' != "object"'])),We);dt=Me.null?ve:(0,n._)(fe||(fe=je(["!"," || ",""])),We,ve),delete Me.null,delete Me.array,delete Me.object}else dt=n.nil;Me.number&&delete Me.integer;for(let ve in Me)dt=(0,n.and)(dt,we(ve,We,at,Lt));return dt}s(Re,"checkDataTypes"),t.checkDataTypes=Re;var me,Ae,Ue={message:s(({schema:tt})=>"must be ".concat(tt),"message"),params:s(({schema:tt,schemaValue:We})=>typeof tt=="string"?(0,n._)(me||(me=je(["{type: ","}"])),tt):(0,n._)(Ae||(Ae=je(["{type: ","}"])),We),"params")};function _e(tt){let We=lt(tt);(0,i.reportError)(We,Ue)}s(_e,"reportTypeError"),t.reportTypeError=_e;function lt(tt){let{gen:We,data:at,schema:Lt}=tt,dt=(0,a.schemaRefOrVal)(tt,Lt,"type");return{gen:We,keyword:"type",data:at,schema:Lt.type,schemaCode:dt,schemaValue:dt,parentSchema:Lt,params:{},it:tt}}s(lt,"getTypeErrorContext")}),gqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;var e=an(),r=Fn();function i(c,p){let{properties:m,items:y}=c.schema;if(p==="object"&&m)for(let v in m)u(c,v,m[v].default);else p==="array"&&Array.isArray(y)&&y.forEach((v,x)=>u(c,x,v.default))}s(i,"assignDefaults"),t.assignDefaults=i;var n,a,o,l;function u(c,p,m){let{gen:y,compositeRule:v,data:x,opts:E}=c;if(m===void 0)return;let M=(0,e._)(n||(n=je(["","",""])),x,(0,e.getProperty)(p));if(v){(0,r.checkStrictMode)(c,"default is ignored for: ".concat(M));return}let I=(0,e._)(a||(a=je([""," === undefined"])),M);E.useDefaults==="empty"&&(I=(0,e._)(o||(o=je([""," || "," === null || ",' === ""'])),I,M,M)),y.if(I,(0,e._)(l||(l=je([""," = ",""])),M,(0,e.stringify)(m)))}s(u,"assignDefault")}),Kh=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;var e=an(),r=Fn(),i=cg(),n=Fn(),a;function o(J,ne){let{gen:ee,data:ue,it:K}=J;ee.if(P(ee,ue,ne,K.opts.ownProperties),()=>{J.setParams({missingProperty:(0,e._)(a||(a=je(["",""])),ne)},!0),J.error()})}s(o,"checkReportMissingProp"),t.checkReportMissingProp=o;var l;function u({gen:J,data:ne,it:{opts:ee}},ue,K){return(0,e.or)(...ue.map(ce=>(0,e.and)(P(J,ne,ce,ee.ownProperties),(0,e._)(l||(l=je([""," = ",""])),K,ce))))}s(u,"checkMissingProp"),t.checkMissingProp=u;function c(J,ne){J.setParams({missingProperty:ne},!0),J.error()}s(c,"reportMissingProp"),t.reportMissingProp=c;var p;function m(J){return J.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,e._)(p||(p=je(["Object.prototype.hasOwnProperty"])))})}s(m,"hasPropFunc"),t.hasPropFunc=m;var y;function v(J,ne,ee){return(0,e._)(y||(y=je(["",".call(",", ",")"])),m(J),ne,ee)}s(v,"isOwnProperty"),t.isOwnProperty=v;var x,E;function M(J,ne,ee,ue){let K=(0,e._)(x||(x=je(["",""," !== undefined"])),ne,(0,e.getProperty)(ee));return ue?(0,e._)(E||(E=je([""," && ",""])),K,v(J,ne,ee)):K}s(M,"propertyInData"),t.propertyInData=M;var I;function P(J,ne,ee,ue){let K=(0,e._)(I||(I=je(["",""," === undefined"])),ne,(0,e.getProperty)(ee));return ue?(0,e.or)(K,(0,e.not)(v(J,ne,ee))):K}s(P,"noPropertyInData"),t.noPropertyInData=P;function C(J){return J?Object.keys(J).filter(ne=>ne!=="__proto__"):[]}s(C,"allSchemaProperties"),t.allSchemaProperties=C;function T(J,ne){return C(ne).filter(ee=>!(0,r.alwaysValidSchema)(J,ne[ee]))}s(T,"schemaProperties"),t.schemaProperties=T;var D,F,k,B;function U({schemaCode:J,data:ne,it:{gen:ee,topSchemaRef:ue,schemaPath:K,errorPath:ce},it:re},se,de,we){let Le=we?(0,e._)(D||(D=je(["",", ",", ","",""])),J,ne,ue,K):ne,fe=[[i.default.instancePath,(0,e.strConcat)(i.default.instancePath,ce)],[i.default.parentData,re.parentData],[i.default.parentDataProperty,re.parentDataProperty],[i.default.rootData,i.default.rootData]];re.opts.dynamicRef&&fe.push([i.default.dynamicAnchors,i.default.dynamicAnchors]);let Re=(0,e._)(F||(F=je(["",", ",""])),Le,ee.object(...fe));return de!==e.nil?(0,e._)(k||(k=je(["",".call(",", ",")"])),se,de,Re):(0,e._)(B||(B=je(["","(",")"])),se,Re)}s(U,"callValidateCode"),t.callValidateCode=U;var z,q=(0,e._)(z||(z=je(["new RegExp"]))),Z;function Q({gen:J,it:{opts:ne}},ee){let ue=ne.unicodeRegExp?"u":"",{regExp:K}=ne.code,ce=K(ee,ue);return J.scopeValue("pattern",{key:ce.toString(),ref:ce,code:(0,e._)(Z||(Z=je(["","(",", ",")"])),K.code==="new RegExp"?q:(0,n.useFunc)(J,K),ee,ue)})}s(Q,"usePattern"),t.usePattern=Q;var V;function ae(J){let{gen:ne,data:ee,keyword:ue,it:K}=J,ce=ne.name("valid");if(K.allErrors){let se=ne.let("valid",!0);return re(()=>ne.assign(se,!1)),se}return ne.var(ce,!0),re(()=>ne.break()),ce;function re(se){let de=ne.const("len",(0,e._)(V||(V=je(["",".length"])),ee));ne.forRange("i",0,de,we=>{J.subschema({keyword:ue,dataProp:we,dataPropType:r.Type.Num},ce),ne.if((0,e.not)(ce),se)})}}s(ae,"validateArray"),t.validateArray=ae;var Y;function he(J){let{gen:ne,schema:ee,keyword:ue,it:K}=J;if(!Array.isArray(ee))throw new Error("ajv implementation error");if(ee.some(se=>(0,r.alwaysValidSchema)(K,se))&&!K.opts.unevaluated)return;let ce=ne.let("valid",!1),re=ne.name("_valid");ne.block(()=>ee.forEach((se,de)=>{let we=J.subschema({keyword:ue,schemaProp:de,compositeRule:!0},re);ne.assign(ce,(0,e._)(Y||(Y=je([""," || ",""])),ce,re)),J.mergeValidEvaluated(we,re)||ne.if((0,e.not)(ce))})),J.result(ce,()=>J.reset(),()=>J.error(!0))}s(he,"validateUnion"),t.validateUnion=he}),yqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;var e=an(),r=cg(),i=Kh(),n=jP();function a(k,B){let{gen:U,keyword:z,schema:q,parentSchema:Z,it:Q}=k,V=B.macro.call(Q.self,q,Z,Q),ae=T(U,z,V);Q.opts.validateSchema!==!1&&Q.self.validateSchema(V,!0);let Y=U.name("valid");k.subschema({schema:V,schemaPath:e.nil,errSchemaPath:"".concat(Q.errSchemaPath,"/").concat(z),topSchemaRef:ae,compositeRule:!0},Y),k.pass(Y,()=>k.error(!0))}s(a,"macroKeywordCode"),t.macroKeywordCode=a;var o,l,u,c,p,m;function y(k,B){var U;let{gen:z,keyword:q,schema:Z,parentSchema:Q,$data:V,it:ae}=k;C(ae,B);let Y=!V&&B.compile?B.compile.call(ae.self,Z,Q,ae):B.validate,he=T(z,q,Y),J=z.let("valid");k.block$data(J,ne),k.ok((U=B.valid)!==null&&U!==void 0?U:J);function ne(){if(B.errors===!1)K(),B.modifying&&x(k),ce(()=>k.error());else{let re=B.async?ee():ue();B.modifying&&x(k),ce(()=>P(k,re))}}s(ne,"validateKeyword");function ee(){let re=z.let("ruleErrs",null);return z.try(()=>K((0,e._)(o||(o=je(["await "])))),se=>z.assign(J,!1).if((0,e._)(l||(l=je([""," instanceof ",""])),se,ae.ValidationError),()=>z.assign(re,(0,e._)(u||(u=je(["",".errors"])),se)),()=>z.throw(se))),re}s(ee,"validateAsync");function ue(){let re=(0,e._)(c||(c=je(["",".errors"])),he);return z.assign(re,null),K(e.nil),re}s(ue,"validateSync");function K(re=B.async?(0,e._)(p||(p=je(["await "]))):e.nil){let se=ae.opts.passContext?r.default.this:r.default.self,de=!("compile"in B&&!V||B.schema===!1);z.assign(J,(0,e._)(m||(m=je(["","",""])),re,(0,i.callValidateCode)(k,he,se,de)),B.modifying)}s(K,"assignValid");function ce(re){var se;z.if((0,e.not)((se=B.valid)!==null&&se!==void 0?se:J),re)}s(ce,"reportErrs")}s(y,"funcKeywordCode"),t.funcKeywordCode=y;var v;function x(k){let{gen:B,data:U,it:z}=k;B.if(z.parentData,()=>B.assign(U,(0,e._)(v||(v=je(["","[","]"])),z.parentData,z.parentDataProperty)))}s(x,"modifyData");var E,M,I;function P(k,B){let{gen:U}=k;U.if((0,e._)(E||(E=je(["Array.isArray(",")"])),B),()=>{U.assign(r.default.vErrors,(0,e._)(M||(M=je([""," === null ? "," : ",".concat(",")"])),r.default.vErrors,B,r.default.vErrors,B)).assign(r.default.errors,(0,e._)(I||(I=je(["",".length"])),r.default.vErrors)),(0,n.extendErrors)(k)},()=>k.error())}s(P,"addErrs");function C({schemaEnv:k},B){if(B.async&&!k.$async)throw new Error("async keyword in sync schema")}s(C,"checkAsyncKeyword");function T(k,B,U){if(U===void 0)throw new Error('keyword "'.concat(B,'" failed to compile'));return k.scopeValue("keyword",typeof U=="function"?{ref:U}:{ref:U,code:(0,e.stringify)(U)})}s(T,"useKeyword");function D(k,B,U=!1){return!B.length||B.some(z=>z==="array"?Array.isArray(k):z==="object"?k&&typeof k=="object"&&!Array.isArray(k):typeof k==z||U&&typeof k>"u")}s(D,"validSchemaType"),t.validSchemaType=D;function F({schema:k,opts:B,self:U,errSchemaPath:z},q,Z){if(Array.isArray(q.keyword)?!q.keyword.includes(Z):q.keyword!==Z)throw new Error("ajv implementation error");let Q=q.dependencies;if(Q!=null&&Q.some(V=>!Object.prototype.hasOwnProperty.call(k,V)))throw new Error("parent schema must have dependencies of ".concat(Z,": ").concat(Q.join(",")));if(q.validateSchema&&!q.validateSchema(k[Z])){let V='keyword "'.concat(Z,'" value is invalid at path "').concat(z,'": ')+U.errorsText(q.validateSchema.errors);if(B.validateSchema==="log")U.logger.error(V);else throw new Error(V)}}s(F,"validateKeywordUsage"),t.validateKeywordUsage=F}),vqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;var e=an(),r=Fn(),i,n;function a(m,{keyword:y,schemaProp:v,schema:x,schemaPath:E,errSchemaPath:M,topSchemaRef:I}){if(y!==void 0&&x!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(y!==void 0){let P=m.schema[y];return v===void 0?{schema:P,schemaPath:(0,e._)(i||(i=je(["","",""])),m.schemaPath,(0,e.getProperty)(y)),errSchemaPath:"".concat(m.errSchemaPath,"/").concat(y)}:{schema:P[v],schemaPath:(0,e._)(n||(n=je(["","","",""])),m.schemaPath,(0,e.getProperty)(y),(0,e.getProperty)(v)),errSchemaPath:"".concat(m.errSchemaPath,"/").concat(y,"/").concat((0,r.escapeFragment)(v))}}if(x!==void 0){if(E===void 0||M===void 0||I===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:x,schemaPath:E,topSchemaRef:I,errSchemaPath:M}}throw new Error('either "keyword" or "schema" must be passed')}s(a,"getSubschema"),t.getSubschema=a;var o,l,u;function c(m,y,{dataProp:v,dataPropType:x,data:E,dataTypes:M,propertyName:I}){if(E!==void 0&&v!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:P}=y;if(v!==void 0){let{errorPath:T,dataPathArr:D,opts:F}=y,k=P.let("data",(0,e._)(o||(o=je(["","",""])),y.data,(0,e.getProperty)(v)),!0);C(k),m.errorPath=(0,e.str)(l||(l=je(["","",""])),T,(0,r.getErrorPath)(v,x,F.jsPropertySyntax)),m.parentDataProperty=(0,e._)(u||(u=je(["",""])),v),m.dataPathArr=[...D,m.parentDataProperty]}if(E!==void 0){let T=E instanceof e.Name?E:P.let("data",E,!0);C(T),I!==void 0&&(m.propertyName=I)}M&&(m.dataTypes=M);function C(T){m.data=T,m.dataLevel=y.dataLevel+1,m.dataTypes=[],y.definedProperties=new Set,m.parentData=y.data,m.dataNames=[...y.dataNames,T]}s(C,"dataContextProps")}s(c,"extendSubschemaData"),t.extendSubschemaData=c;function p(m,{jtdDiscriminator:y,jtdMetadata:v,compositeRule:x,createErrors:E,allErrors:M}){x!==void 0&&(m.compositeRule=x),E!==void 0&&(m.createErrors=E),M!==void 0&&(m.allErrors=M),m.jtdDiscriminator=y,m.jtdMetadata=v}s(p,"extendSubschemaMode"),t.extendSubschemaMode=p}),rye=bt((t,e)=>{N(),e.exports=s(function r(i,n){if(i===n)return!0;if(i&&n&&typeof i=="object"&&typeof n=="object"){if(i.constructor!==n.constructor)return!1;var a,o,l;if(Array.isArray(i)){if(a=i.length,a!=n.length)return!1;for(o=a;o--!==0;)if(!r(i[o],n[o]))return!1;return!0}if(i.constructor===RegExp)return i.source===n.source&&i.flags===n.flags;if(i.valueOf!==Object.prototype.valueOf)return i.valueOf()===n.valueOf();if(i.toString!==Object.prototype.toString)return i.toString()===n.toString();if(l=Object.keys(i),a=l.length,a!==Object.keys(n).length)return!1;for(o=a;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,l[o]))return!1;for(o=a;o--!==0;){var u=l[o];if(!r(i[u],n[u]))return!1}return!0}return i!==i&&n!==n},"equal")}),_qe=bt((t,e)=>{N();var r=e.exports=function(a,o,l){typeof o=="function"&&(l=o,o={}),l=o.cb||l;var u=typeof l=="function"?l:l.pre||function(){},c=l.post||function(){};i(o,u,c,a,"",a)};r.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},r.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},r.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},r.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function i(a,o,l,u,c,p,m,y,v,x){if(u&&typeof u=="object"&&!Array.isArray(u)){o(u,c,p,m,y,v,x);for(var E in u){var M=u[E];if(Array.isArray(M)){if(E in r.arrayKeywords)for(var I=0;I<M.length;I++)i(a,o,l,M[I],c+"/"+E+"/"+I,p,c,E,u,I)}else if(E in r.propsKeywords){if(M&&typeof M=="object")for(var P in M)i(a,o,l,M[P],c+"/"+E+"/"+n(P),p,c,E,u,P)}else(E in r.keywords||a.allKeys&&!(E in r.skipKeywords))&&i(a,o,l,M,c+"/"+E,p,c,E,u)}l(u,c,p,m,y,v,x)}}s(i,"_traverse");function n(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}s(n,"escapeJsonPtr")}),$P=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;var e=Fn(),r=rye(),i=_qe(),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function a(M,I=!0){return typeof M=="boolean"?!0:I===!0?!l(M):I?u(M)<=I:!1}s(a,"inlineRef"),t.inlineRef=a;var o=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(M){for(let I in M){if(o.has(I))return!0;let P=M[I];if(Array.isArray(P)&&P.some(l)||typeof P=="object"&&l(P))return!0}return!1}s(l,"hasRef");function u(M){let I=0;for(let P in M)if(P==="$ref"||(I++,!n.has(P)&&(typeof M[P]=="object"&&(0,e.eachItem)(M[P],C=>I+=u(C)),I===1/0)))return 1/0;return I}s(u,"countKeys");function c(M,I="",P){P!==!1&&(I=y(I));let C=M.parse(I);return p(M,C)}s(c,"getFullPath"),t.getFullPath=c;function p(M,I){return M.serialize(I).split("#")[0]+"#"}s(p,"_getFullPath"),t._getFullPath=p;var m=/#\/?$/;function y(M){return M?M.replace(m,""):""}s(y,"normalizeId"),t.normalizeId=y;function v(M,I,P){return P=y(P),M.resolve(I,P)}s(v,"resolveUrl"),t.resolveUrl=v;var x=/^[a-z_][-a-z0-9._]*$/i;function E(M,I){if(typeof M=="boolean")return{};let{schemaId:P,uriResolver:C}=this.opts,T=y(M[P]||I),D={"":T},F=c(C,T,!1),k={},B=new Set;return i(M,{allKeys:!0},(q,Z,Q,V)=>{if(V===void 0)return;let ae=F+Z,Y=D[V];typeof q[P]=="string"&&(Y=he.call(this,q[P])),J.call(this,q.$anchor),J.call(this,q.$dynamicAnchor),D[Z]=Y;function he(ne){let ee=this.opts.uriResolver.resolve;if(ne=y(Y?ee(Y,ne):ne),B.has(ne))throw z(ne);B.add(ne);let ue=this.refs[ne];return typeof ue=="string"&&(ue=this.refs[ue]),typeof ue=="object"?U(q,ue.schema,ne):ne!==y(ae)&&(ne[0]==="#"?(U(q,k[ne],ne),k[ne]=q):this.refs[ne]=ae),ne}s(he,"addRef");function J(ne){if(typeof ne=="string"){if(!x.test(ne))throw new Error('invalid anchor "'.concat(ne,'"'));he.call(this,"#".concat(ne))}}s(J,"addAnchor")}),k;function U(q,Z,Q){if(Z!==void 0&&!r(q,Z))throw z(Q)}function z(q){return new Error('reference "'.concat(q,'" resolves to more than one schema'))}}s(E,"getSchemaRefs"),t.getSchemaRefs=E}),GP=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;var e=mqe(),r=r3(),i=tye(),n=r3(),a=gqe(),o=yqe(),l=vqe(),u=an(),c=cg(),p=$P(),m=Fn(),y=jP();function v(ke){if(Le(ke)&&(me(ke),we(ke))){ae(ke);return}I(ke,()=>(0,e.topBoolOrEmptySchema)(ke))}s(v,"validateFunctionCode"),t.validateFunctionCode=v;var x,E,M;function I({gen:ke,validateName:$e,schema:ot,schemaEnv:Ft,opts:Ht},fr){Ht.code.es5?ke.func($e,(0,u._)(x||(x=je(["",", ",""])),c.default.data,c.default.valCxt),Ft.$async,()=>{ke.code((0,u._)(E||(E=je(['"use strict"; ',""])),se(ot,Ht))),V(ke,Ht),ke.code(fr)}):ke.func($e,(0,u._)(M||(M=je(["",", ",""])),c.default.data,T(Ht)),Ft.$async,()=>ke.code(se(ot,Ht)).code(fr))}s(I,"validateFunction");var P,C;function T(ke){return(0,u._)(C||(C=je(["{",'="", ',", ",", ","=","","}={}"])),c.default.instancePath,c.default.parentData,c.default.parentDataProperty,c.default.rootData,c.default.data,ke.dynamicRef?(0,u._)(P||(P=je([", ","={}"])),c.default.dynamicAnchors):u.nil)}s(T,"destructureValCxt");var D,F,k,B,U,z,q,Z,Q;function V(ke,$e){ke.if(c.default.valCxt,()=>{ke.var(c.default.instancePath,(0,u._)(D||(D=je(["",".",""])),c.default.valCxt,c.default.instancePath)),ke.var(c.default.parentData,(0,u._)(F||(F=je(["",".",""])),c.default.valCxt,c.default.parentData)),ke.var(c.default.parentDataProperty,(0,u._)(k||(k=je(["",".",""])),c.default.valCxt,c.default.parentDataProperty)),ke.var(c.default.rootData,(0,u._)(B||(B=je(["",".",""])),c.default.valCxt,c.default.rootData)),$e.dynamicRef&&ke.var(c.default.dynamicAnchors,(0,u._)(U||(U=je(["",".",""])),c.default.valCxt,c.default.dynamicAnchors))},()=>{ke.var(c.default.instancePath,(0,u._)(z||(z=je(['""'])))),ke.var(c.default.parentData,(0,u._)(q||(q=je(["undefined"])))),ke.var(c.default.parentDataProperty,(0,u._)(Z||(Z=je(["undefined"])))),ke.var(c.default.rootData,c.default.data),$e.dynamicRef&&ke.var(c.default.dynamicAnchors,(0,u._)(Q||(Q=je(["{}"]))))})}s(V,"destructureValCxtES5");function ae(ke){let{schema:$e,opts:ot,gen:Ft}=ke;I(ke,()=>{ot.$comment&&$e.$comment&&dt(ke),_e(ke),Ft.let(c.default.vErrors,null),Ft.let(c.default.errors,0),ot.unevaluated&&ce(ke),Ae(ke),Rt(ke)})}s(ae,"topSchemaObjCode");var Y,he,J,ne,ee,ue,K;function ce(ke){let{gen:$e,validateName:ot}=ke;ke.evaluated=$e.const("evaluated",(0,u._)(Y||(Y=je(["",".evaluated"])),ot)),$e.if((0,u._)(he||(he=je(["",".dynamicProps"])),ke.evaluated),()=>$e.assign((0,u._)(J||(J=je(["",".props"])),ke.evaluated),(0,u._)(ne||(ne=je(["undefined"]))))),$e.if((0,u._)(ee||(ee=je(["",".dynamicItems"])),ke.evaluated),()=>$e.assign((0,u._)(ue||(ue=je(["",".items"])),ke.evaluated),(0,u._)(K||(K=je(["undefined"])))))}s(ce,"resetEvaluated");var re;function se(ke,$e){let ot=typeof ke=="object"&&ke[$e.schemaId];return ot&&($e.code.source||$e.code.process)?(0,u._)(re||(re=je(["/*# sourceURL="," */"])),ot):u.nil}s(se,"funcSourceUrl");function de(ke,$e){if(Le(ke)&&(me(ke),we(ke))){Re(ke,$e);return}(0,e.boolOrEmptySchema)(ke,$e)}s(de,"subschemaCode");function we({schema:ke,self:$e}){if(typeof ke=="boolean")return!ke;for(let ot in ke)if($e.RULES.all[ot])return!0;return!1}s(we,"schemaCxtHasRules");function Le(ke){return typeof ke.schema!="boolean"}s(Le,"isSchemaObj");var fe;function Re(ke,$e){let{schema:ot,gen:Ft,opts:Ht}=ke;Ht.$comment&&ot.$comment&&dt(ke),lt(ke),tt(ke);let fr=Ft.const("_errs",c.default.errors);Ae(ke,fr),Ft.var($e,(0,u._)(fe||(fe=je([""," === ",""])),fr,c.default.errors))}s(Re,"subSchemaObjCode");function me(ke){(0,m.checkUnknownRules)(ke),Ue(ke)}s(me,"checkKeywords");function Ae(ke,$e){if(ke.opts.jtd)return $t(ke,[],!1,$e);let ot=(0,r.getSchemaTypes)(ke.schema),Ft=(0,r.coerceAndCheckDataType)(ke,ot);$t(ke,ot,!Ft,$e)}s(Ae,"typeAndKeywords");function Ue(ke){let{schema:$e,errSchemaPath:ot,opts:Ft,self:Ht}=ke;$e.$ref&&Ft.ignoreKeywordsWithRef&&(0,m.schemaHasRulesButRef)($e,Ht.RULES)&&Ht.logger.warn('$ref: keywords ignored in schema at path "'.concat(ot,'"'))}s(Ue,"checkRefsAndKeywords");function _e(ke){let{schema:$e,opts:ot}=ke;$e.default!==void 0&&ot.useDefaults&&ot.strictSchema&&(0,m.checkStrictMode)(ke,"default is ignored in the schema root")}s(_e,"checkNoDefault");function lt(ke){let $e=ke.schema[ke.opts.schemaId];$e&&(ke.baseId=(0,p.resolveUrl)(ke.opts.uriResolver,ke.baseId,$e))}s(lt,"updateContext");function tt(ke){if(ke.schema.$async&&!ke.schemaEnv.$async)throw new Error("async schema in sync schema")}s(tt,"checkAsyncSchema");var We,at,Lt;function dt({gen:ke,schemaEnv:$e,schema:ot,errSchemaPath:Ft,opts:Ht}){let fr=ot.$comment;if(Ht.$comment===!0)ke.code((0,u._)(We||(We=je(["",".logger.log(",")"])),c.default.self,fr));else if(typeof Ht.$comment=="function"){let nr=(0,u.str)(at||(at=je(["","/$comment"])),Ft),Zr=ke.scopeValue("root",{ref:$e.root});ke.code((0,u._)(Lt||(Lt=je(["",".opts.$comment(",", ",", ",".schema)"])),c.default.self,fr,nr,Zr))}}s(dt,"commentKeyword");var Me,ve,Ze,It;function Rt(ke){let{gen:$e,schemaEnv:ot,validateName:Ft,ValidationError:Ht,opts:fr}=ke;ot.$async?$e.if((0,u._)(Me||(Me=je([""," === 0"])),c.default.errors),()=>$e.return(c.default.data),()=>$e.throw((0,u._)(ve||(ve=je(["new ","(",")"])),Ht,c.default.vErrors))):($e.assign((0,u._)(Ze||(Ze=je(["",".errors"])),Ft),c.default.vErrors),fr.unevaluated&&Yt(ke),$e.return((0,u._)(It||(It=je([""," === 0"])),c.default.errors)))}s(Rt,"returnResults");var Et,pt;function Yt({gen:ke,evaluated:$e,props:ot,items:Ft}){ot instanceof u.Name&&ke.assign((0,u._)(Et||(Et=je(["",".props"])),$e),ot),Ft instanceof u.Name&&ke.assign((0,u._)(pt||(pt=je(["",".items"])),$e),Ft)}s(Yt,"assignEvaluated");var Kt;function $t(ke,$e,ot,Ft){let{gen:Ht,schema:fr,data:nr,allErrors:Zr,opts:ni,self:Yr}=ke,{RULES:Cr}=Yr;if(fr.$ref&&(ni.ignoreKeywordsWithRef||!(0,m.schemaHasRulesButRef)(fr,Cr))){Ht.block(()=>De(ke,"$ref",Cr.all.$ref.definition));return}ni.jtd||Nt(ke,$e),Ht.block(()=>{for(let $r of Cr.rules)Mi($r);Mi(Cr.post)});function Mi($r){(0,i.shouldUseGroup)(fr,$r)&&($r.type?(Ht.if((0,n.checkDataType)($r.type,nr,ni.strictNumbers)),jt(ke,$r),$e.length===1&&$e[0]===$r.type&&ot&&(Ht.else(),(0,n.reportTypeError)(ke)),Ht.endIf()):jt(ke,$r),Zr||Ht.if((0,u._)(Kt||(Kt=je([""," === ",""])),c.default.errors,Ft||0)))}s(Mi,"groupKeywords")}s($t,"schemaKeywords");function jt(ke,$e){let{gen:ot,schema:Ft,opts:{useDefaults:Ht}}=ke;Ht&&(0,a.assignDefaults)(ke,$e.type),ot.block(()=>{for(let fr of $e.rules)(0,i.shouldUseRule)(Ft,fr)&&De(ke,fr.keyword,fr.definition,$e.type)})}s(jt,"iterateKeywords");function Nt(ke,$e){ke.schemaEnv.meta||!ke.opts.strictTypes||(Fe(ke,$e),ke.opts.allowUnionTypes||Xe(ke,$e),ht(ke,ke.dataTypes))}s(Nt,"checkStrictTypes");function Fe(ke,$e){if($e.length){if(!ke.dataTypes.length){ke.dataTypes=$e;return}$e.forEach(ot=>{ar(ke.dataTypes,ot)||Qe(ke,'type "'.concat(ot,'" not allowed by context "').concat(ke.dataTypes.join(","),'"'))}),zr(ke,$e)}}s(Fe,"checkContextTypes");function Xe(ke,$e){$e.length>1&&!($e.length===2&&$e.includes("null"))&&Qe(ke,"use allowUnionTypes to allow union type keyword")}s(Xe,"checkMultipleTypes");function ht(ke,$e){let ot=ke.self.RULES.all;for(let Ft in ot){let Ht=ot[Ft];if(typeof Ht=="object"&&(0,i.shouldUseRule)(ke.schema,Ht)){let{type:fr}=Ht.definition;fr.length&&!fr.some(nr=>rr($e,nr))&&Qe(ke,'missing type "'.concat(fr.join(","),'" for keyword "').concat(Ft,'"'))}}}s(ht,"checkKeywordTypes");function rr(ke,$e){return ke.includes($e)||$e==="number"&&ke.includes("integer")}s(rr,"hasApplicableType");function ar(ke,$e){return ke.includes($e)||$e==="integer"&&ke.includes("number")}s(ar,"includesType");function zr(ke,$e){let ot=[];for(let Ft of ke.dataTypes)ar($e,Ft)?ot.push(Ft):$e.includes("integer")&&Ft==="number"&&ot.push("integer");ke.dataTypes=ot}s(zr,"narrowSchemaTypes");function Qe(ke,$e){let ot=ke.schemaEnv.baseId+ke.errSchemaPath;$e+=' at "'.concat(ot,'" (strictTypes)'),(0,m.checkStrictMode)(ke,$e,ke.opts.strictTypes)}s(Qe,"strictTypesError");var er,Oe,oe,le,Se=class{constructor($e,ot,Ft){if((0,o.validateKeywordUsage)($e,ot,Ft),this.gen=$e.gen,this.allErrors=$e.allErrors,this.keyword=Ft,this.data=$e.data,this.schema=$e.schema[Ft],this.$data=ot.$data&&$e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,m.schemaRefOrVal)($e,this.schema,Ft,this.$data),this.schemaType=ot.schemaType,this.parentSchema=$e.schema,this.params={},this.it=$e,this.def=ot,this.$data)this.schemaCode=$e.gen.const("vSchema",Gt(this.$data,$e));else if(this.schemaCode=this.schemaValue,!(0,o.validSchemaType)(this.schema,ot.schemaType,ot.allowUndefined))throw new Error("".concat(Ft," value must be ").concat(JSON.stringify(ot.schemaType)));("code"in ot?ot.trackErrors:ot.errors!==!1)&&(this.errsCount=$e.gen.const("_errs",c.default.errors))}result($e,ot,Ft){this.failResult((0,u.not)($e),ot,Ft)}failResult($e,ot,Ft){this.gen.if($e),Ft?Ft():this.error(),ot?(this.gen.else(),ot(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass($e,ot){this.failResult((0,u.not)($e),void 0,ot)}fail($e){if($e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if($e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data($e){if(!this.$data)return this.fail($e);let{schemaCode:ot}=this;this.fail((0,u._)(er||(er=je([""," !== undefined && (",")"])),ot,(0,u.or)(this.invalid$data(),$e)))}error($e,ot,Ft){if(ot){this.setParams(ot),this._error($e,Ft),this.setParams({});return}this._error($e,Ft)}_error($e,ot){($e?y.reportExtraError:y.reportError)(this,this.def.error,ot)}$dataError(){(0,y.reportError)(this,this.def.$dataError||y.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,y.resetErrorsCount)(this.gen,this.errsCount)}ok($e){this.allErrors||this.gen.if($e)}setParams($e,ot){ot?Object.assign(this.params,$e):this.params=$e}block$data($e,ot,Ft=u.nil){this.gen.block(()=>{this.check$data($e,Ft),ot()})}check$data($e=u.nil,ot=u.nil){if(!this.$data)return;let{gen:Ft,schemaCode:Ht,schemaType:fr,def:nr}=this;Ft.if((0,u.or)((0,u._)(Oe||(Oe=je([""," === undefined"])),Ht),ot)),$e!==u.nil&&Ft.assign($e,!0),(fr.length||nr.validateSchema)&&(Ft.elseIf(this.invalid$data()),this.$dataError(),$e!==u.nil&&Ft.assign($e,!1)),Ft.else()}invalid$data(){let{gen:$e,schemaCode:ot,schemaType:Ft,def:Ht,it:fr}=this;return(0,u.or)(nr(),Zr());function nr(){if(Ft.length){if(!(ot instanceof u.Name))throw new Error("ajv implementation error");let ni=Array.isArray(Ft)?Ft:[Ft];return(0,u._)(oe||(oe=je(["",""])),(0,n.checkDataTypes)(ni,ot,fr.opts.strictNumbers,n.DataType.Wrong))}return u.nil}function Zr(){if(Ht.validateSchema){let ni=$e.scopeValue("validate$data",{ref:Ht.validateSchema});return(0,u._)(le||(le=je(["!","(",")"])),ni,ot)}return u.nil}}subschema($e,ot){let Ft=(0,l.getSubschema)(this.it,$e);(0,l.extendSubschemaData)(Ft,this.it,$e),(0,l.extendSubschemaMode)(Ft,$e);let Ht=vt(Ee(Ee({},this.it),Ft),{items:void 0,props:void 0});return de(Ht,ot),Ht}mergeEvaluated($e,ot){let{it:Ft,gen:Ht}=this;Ft.opts.unevaluated&&(Ft.props!==!0&&$e.props!==void 0&&(Ft.props=m.mergeEvaluated.props(Ht,$e.props,Ft.props,ot)),Ft.items!==!0&&$e.items!==void 0&&(Ft.items=m.mergeEvaluated.items(Ht,$e.items,Ft.items,ot)))}mergeValidEvaluated($e,ot){let{it:Ft,gen:Ht}=this;if(Ft.opts.unevaluated&&(Ft.props!==!0||Ft.items!==!0))return Ht.if(ot,()=>this.mergeEvaluated($e,u.Name)),!0}};s(Se,"KeywordCxt");var ze=Se;t.KeywordCxt=ze;function De(ke,$e,ot,Ft){let Ht=new ze(ke,ot,$e);"code"in ot?ot.code(Ht,Ft):Ht.$data&&ot.validate?(0,o.funcKeywordCode)(Ht,ot):"macro"in ot?(0,o.macroKeywordCode)(Ht,ot):(ot.compile||ot.validate)&&(0,o.funcKeywordCode)(Ht,ot)}s(De,"keywordCode");var yt=/^\/(?:[^~]|~0|~1)*$/,st=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/,kt,mt;function Gt(ke,{dataLevel:$e,dataNames:ot,dataPathArr:Ft}){let Ht,fr;if(ke==="")return c.default.rootData;if(ke[0]==="/"){if(!yt.test(ke))throw new Error("Invalid JSON-pointer: ".concat(ke));Ht=ke,fr=c.default.rootData}else{let Yr=st.exec(ke);if(!Yr)throw new Error("Invalid JSON-pointer: ".concat(ke));let Cr=+Yr[1];if(Ht=Yr[2],Ht==="#"){if(Cr>=$e)throw new Error(ni("property/index",Cr));return Ft[$e-Cr]}if(Cr>$e)throw new Error(ni("data",Cr));if(fr=ot[$e-Cr],!Ht)return fr}let nr=fr,Zr=Ht.split("/");for(let Yr of Zr)Yr&&(fr=(0,u._)(kt||(kt=je(["","",""])),fr,(0,u.getProperty)((0,m.unescapeJsonPointer)(Yr))),nr=(0,u._)(mt||(mt=je([""," && ",""])),nr,fr));return nr;function ni(Yr,Cr){return"Cannot access ".concat(Yr," ").concat(Cr," levels up, current level is ").concat($e)}}s(Gt,"getData"),t.getData=Gt}),QB=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=class extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}};s(e,"ValidationError");var r=e;t.default=r}),HP=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=$P(),r=class extends Error{constructor(a,o,l,u){super(u||"can't resolve reference ".concat(l," from id ").concat(o)),this.missingRef=(0,e.resolveUrl)(a,o,l),this.missingSchema=(0,e.normalizeId)((0,e.getFullPath)(a,this.missingRef))}};s(r,"MissingRefError");var i=r;t.default=i}),ez=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;var e=an(),r=QB(),i=cg(),n=$P(),a=Fn(),o=GP(),l=class{constructor(D){var F;this.refs={},this.dynamicAnchors={};let k;typeof D.schema=="object"&&(k=D.schema),this.schema=D.schema,this.schemaId=D.schemaId,this.root=D.root||this,this.baseId=(F=D.baseId)!==null&&F!==void 0?F:(0,n.normalizeId)(k==null?void 0:k[D.schemaId||"$id"]),this.schemaPath=D.schemaPath,this.localRefs=D.localRefs,this.meta=D.meta,this.$async=k==null?void 0:k.$async,this.refs={}}};s(l,"SchemaEnv");var u=l;t.SchemaEnv=u;var c,p;function m(T){let D=x.call(this,T);if(D)return D;let F=(0,n.getFullPath)(this.opts.uriResolver,T.root.baseId),{es5:k,lines:B}=this.opts.code,{ownProperties:U}=this.opts,z=new e.CodeGen(this.scope,{es5:k,lines:B,ownProperties:U}),q;T.$async&&(q=z.scopeValue("Error",{ref:r.default,code:(0,e._)(c||(c=je(['require("ajv/dist/runtime/validation_error").default'])))}));let Z=z.scopeName("validate");T.validateName=Z;let Q={gen:z,allErrors:this.opts.allErrors,data:i.default.data,parentData:i.default.parentData,parentDataProperty:i.default.parentDataProperty,dataNames:[i.default.data],dataPathArr:[e.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:z.scopeValue("schema",this.opts.code.source===!0?{ref:T.schema,code:(0,e.stringify)(T.schema)}:{ref:T.schema}),validateName:Z,ValidationError:q,schema:T.schema,schemaEnv:T,rootId:F,baseId:T.baseId||F,schemaPath:e.nil,errSchemaPath:T.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,e._)(p||(p=je(['""']))),opts:this.opts,self:this},V;try{this._compilations.add(T),(0,o.validateFunctionCode)(Q),z.optimize(this.opts.code.optimize);let ae=z.toString();V="".concat(z.scopeRefs(i.default.scope),"return ").concat(ae),this.opts.code.process&&(V=this.opts.code.process(V,T));let Y=new Function("".concat(i.default.self),"".concat(i.default.scope),V)(this,this.scope.get());if(this.scope.value(Z,{ref:Y}),Y.errors=null,Y.schema=T.schema,Y.schemaEnv=T,T.$async&&(Y.$async=!0),this.opts.code.source===!0&&(Y.source={validateName:Z,validateCode:ae,scopeValues:z._values}),this.opts.unevaluated){let{props:he,items:J}=Q;Y.evaluated={props:he instanceof e.Name?void 0:he,items:J instanceof e.Name?void 0:J,dynamicProps:he instanceof e.Name,dynamicItems:J instanceof e.Name},Y.source&&(Y.source.evaluated=(0,e.stringify)(Y.evaluated))}return T.validate=Y,T}catch(ae){throw delete T.validate,delete T.validateName,V&&this.logger.error("Error compiling schema, function code:",V),ae}finally{this._compilations.delete(T)}}s(m,"compileSchema"),t.compileSchema=m;function y(T,D,F){var k;F=(0,n.resolveUrl)(this.opts.uriResolver,D,F);let B=T.refs[F];if(B)return B;let U=M.call(this,T,F);if(U===void 0){let z=(k=T.localRefs)===null||k===void 0?void 0:k[F],{schemaId:q}=this.opts;z&&(U=new u({schema:z,schemaId:q,root:T,baseId:D}))}if(U!==void 0)return T.refs[F]=v.call(this,U)}s(y,"resolveRef"),t.resolveRef=y;function v(T){return(0,n.inlineRef)(T.schema,this.opts.inlineRefs)?T.schema:T.validate?T:m.call(this,T)}s(v,"inlineOrCompile");function x(T){for(let D of this._compilations)if(E(D,T))return D}s(x,"getCompilingSchema"),t.getCompilingSchema=x;function E(T,D){return T.schema===D.schema&&T.root===D.root&&T.baseId===D.baseId}s(E,"sameSchemaEnv");function M(T,D){let F;for(;typeof(F=this.refs[D])=="string";)D=F;return F||this.schemas[D]||I.call(this,T,D)}s(M,"resolve");function I(T,D){let F=this.opts.uriResolver.parse(D),k=(0,n._getFullPath)(this.opts.uriResolver,F),B=(0,n.getFullPath)(this.opts.uriResolver,T.baseId,void 0);if(Object.keys(T.schema).length>0&&k===B)return C.call(this,F,T);let U=(0,n.normalizeId)(k),z=this.refs[U]||this.schemas[U];if(typeof z=="string"){let q=I.call(this,T,z);return typeof(q==null?void 0:q.schema)!="object"?void 0:C.call(this,F,q)}if(typeof(z==null?void 0:z.schema)=="object"){if(z.validate||m.call(this,z),U===(0,n.normalizeId)(D)){let{schema:q}=z,{schemaId:Z}=this.opts,Q=q[Z];return Q&&(B=(0,n.resolveUrl)(this.opts.uriResolver,B,Q)),new u({schema:q,schemaId:Z,root:T,baseId:B})}return C.call(this,F,z)}}s(I,"resolveSchema"),t.resolveSchema=I;var P=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function C(T,{baseId:D,schema:F,root:k}){var B;if(((B=T.fragment)===null||B===void 0?void 0:B[0])!=="/")return;for(let q of T.fragment.slice(1).split("/")){if(typeof F=="boolean")return;let Z=F[(0,a.unescapeFragment)(q)];if(Z===void 0)return;F=Z;let Q=typeof F=="object"&&F[this.opts.schemaId];!P.has(q)&&Q&&(D=(0,n.resolveUrl)(this.opts.uriResolver,D,Q))}let U;if(typeof F!="boolean"&&F.$ref&&!(0,a.schemaHasRulesButRef)(F,this.RULES)){let q=(0,n.resolveUrl)(this.opts.uriResolver,D,F.$ref);U=I.call(this,k,q)}let{schemaId:z}=this.opts;if(U=U||new u({schema:F,schemaId:z,root:k,baseId:D}),U.schema!==U.root.schema)return U}s(C,"getJsonPointer")}),xqe=bt((t,e)=>{e.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}}),bqe=bt((t,e)=>{N();var r={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};e.exports={HEX:r}}),wqe=bt((t,e)=>{N();var{HEX:r}=bqe(),i=new RegExp("^(?:(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)$","u");function n(I){if(c(I,".")<3)return{host:I,isIPV4:!1};let P=I.match(i)||[],[C]=P;return C?{host:u(C,"."),isIPV4:!0}:{host:I,isIPV4:!1}}s(n,"normalizeIPv4");function a(I,P=!1){let C="",T=!0;for(let D of I){if(r[D]===void 0)return;D!=="0"&&T===!0&&(T=!1),T||(C+=D)}return P&&C.length===0&&(C="0"),C}s(a,"stringArrayToHexStripped");function o(I){let P=0,C={error:!1,address:"",zone:""},T=[],D=[],F=!1,k=!1,B=!1;function U(){if(D.length){if(F===!1){let z=a(D);if(z!==void 0)T.push(z);else return C.error=!0,!1}D.length=0}return!0}s(U,"consume");for(let z=0;z<I.length;z++){let q=I[z];if(!(q==="["||q==="]"))if(q===":"){if(k===!0&&(B=!0),!U())break;if(P++,T.push(":"),P>7){C.error=!0;break}z-1>=0&&I[z-1]===":"&&(k=!0);continue}else if(q==="%"){if(!U())break;F=!0}else{D.push(q);continue}}return D.length&&(F?C.zone=D.join(""):B?T.push(D.join("")):T.push(a(D))),C.address=T.join(""),C}s(o,"getIPV6");function l(I){if(c(I,":")<2)return{host:I,isIPV6:!1};let P=o(I);if(P.error)return{host:I,isIPV6:!1};{let C=P.address,T=P.address;return P.zone&&(C+="%"+P.zone,T+="%25"+P.zone),{host:C,escapedHost:T,isIPV6:!0}}}s(l,"normalizeIPv6");function u(I,P){let C="",T=!0,D=I.length;for(let F=0;F<D;F++){let k=I[F];k==="0"&&T?(F+1<=D&&I[F+1]===P||F+1===D)&&(C+=k,T=!1):(k===P?T=!0:T=!1,C+=k)}return C}s(u,"stripLeadingZeros");function c(I,P){let C=0;for(let T=0;T<I.length;T++)I[T]===P&&C++;return C}s(c,"findToken");var p=new RegExp("^\\.\\.?\\/","u"),m=new RegExp("^\\/\\.(?:\\/|$)","u"),y=new RegExp("^\\/\\.\\.(?:\\/|$)","u"),v=new RegExp("^\\/?(?:.|\\n)*?(?=\\/|$)","u");function x(I){let P=[];for(;I.length;)if(I.match(p))I=I.replace(p,"");else if(I.match(m))I=I.replace(m,"/");else if(I.match(y))I=I.replace(y,"/"),P.pop();else if(I==="."||I==="..")I="";else{let C=I.match(v);if(C){let T=C[0];I=I.slice(T.length),P.push(T)}else throw new Error("Unexpected dot segment condition")}return P.join("")}s(x,"removeDotSegments");function E(I,P){let C=P!==!0?escape:unescape;return I.scheme!==void 0&&(I.scheme=C(I.scheme)),I.userinfo!==void 0&&(I.userinfo=C(I.userinfo)),I.host!==void 0&&(I.host=C(I.host)),I.path!==void 0&&(I.path=C(I.path)),I.query!==void 0&&(I.query=C(I.query)),I.fragment!==void 0&&(I.fragment=C(I.fragment)),I}s(E,"normalizeComponentEncoding");function M(I){let P=[];if(I.userinfo!==void 0&&(P.push(I.userinfo),P.push("@")),I.host!==void 0){let C=unescape(I.host),T=n(C);if(T.isIPV4)C=T.host;else{let D=l(T.host);D.isIPV6===!0?C="[".concat(D.escapedHost,"]"):C=I.host}P.push(C)}return(typeof I.port=="number"||typeof I.port=="string")&&(P.push(":"),P.push(String(I.port))),P.length?P.join(""):void 0}s(M,"recomposeAuthority"),e.exports={recomposeAuthority:M,normalizeComponentEncoding:E,removeDotSegments:x,normalizeIPv4:n,normalizeIPv6:l,stringArrayToHexStripped:a}}),Aqe=bt((t,e)=>{N();var r=new RegExp("^[\\da-f]{8}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{12}$","iu"),i=new RegExp("([\\da-z][\\d\\-a-z]{0,31}):((?:[\\w!$'()*+,\\-.:;=@]|%[\\da-f]{2})+)","iu");function n(T){return typeof T.secure=="boolean"?T.secure:String(T.scheme).toLowerCase()==="wss"}s(n,"isSecure");function a(T){return T.host||(T.error=T.error||"HTTP URIs must have a host."),T}s(a,"httpParse");function o(T){let D=String(T.scheme).toLowerCase()==="https";return(T.port===(D?443:80)||T.port==="")&&(T.port=void 0),T.path||(T.path="/"),T}s(o,"httpSerialize");function l(T){return T.secure=n(T),T.resourceName=(T.path||"/")+(T.query?"?"+T.query:""),T.path=void 0,T.query=void 0,T}s(l,"wsParse");function u(T){if((T.port===(n(T)?443:80)||T.port==="")&&(T.port=void 0),typeof T.secure=="boolean"&&(T.scheme=T.secure?"wss":"ws",T.secure=void 0),T.resourceName){let[D,F]=T.resourceName.split("?");T.path=D&&D!=="/"?D:void 0,T.query=F,T.resourceName=void 0}return T.fragment=void 0,T}s(u,"wsSerialize");function c(T,D){if(!T.path)return T.error="URN can not be parsed",T;let F=T.path.match(i);if(F){let k=D.scheme||T.scheme||"urn";T.nid=F[1].toLowerCase(),T.nss=F[2];let B="".concat(k,":").concat(D.nid||T.nid),U=C[B];T.path=void 0,U&&(T=U.parse(T,D))}else T.error=T.error||"URN can not be parsed.";return T}s(c,"urnParse");function p(T,D){let F=D.scheme||T.scheme||"urn",k=T.nid.toLowerCase(),B="".concat(F,":").concat(D.nid||k),U=C[B];U&&(T=U.serialize(T,D));let z=T,q=T.nss;return z.path="".concat(k||D.nid,":").concat(q),D.skipEscape=!0,z}s(p,"urnSerialize");function m(T,D){let F=T;return F.uuid=F.nss,F.nss=void 0,!D.tolerant&&(!F.uuid||!r.test(F.uuid))&&(F.error=F.error||"UUID is not valid."),F}s(m,"urnuuidParse");function y(T){let D=T;return D.nss=(T.uuid||"").toLowerCase(),D}s(y,"urnuuidSerialize");var v={scheme:"http",domainHost:!0,parse:a,serialize:o},x={scheme:"https",domainHost:v.domainHost,parse:a,serialize:o},E={scheme:"ws",domainHost:!0,parse:l,serialize:u},M={scheme:"wss",domainHost:E.domainHost,parse:E.parse,serialize:E.serialize},I={scheme:"urn",parse:c,serialize:p,skipNormalize:!0},P={scheme:"urn:uuid",parse:m,serialize:y,skipNormalize:!0},C={http:v,https:x,ws:E,wss:M,urn:I,"urn:uuid":P};e.exports=C}),Sqe=bt((t,e)=>{N();var{normalizeIPv6:r,normalizeIPv4:i,removeDotSegments:n,recomposeAuthority:a,normalizeComponentEncoding:o}=wqe(),l=Aqe();function u(P,C){return typeof P=="string"?P=y(M(P,C),C):typeof P=="object"&&(P=M(y(P,C),C)),P}s(u,"normalize");function c(P,C,T){let D=Object.assign({scheme:"null"},T),F=p(M(P,D),M(C,D),D,!0);return y(F,vt(Ee({},D),{skipEscape:!0}))}s(c,"resolve");function p(P,C,T,D){let F={};return D||(P=M(y(P,T),T),C=M(y(C,T),T)),T=T||{},!T.tolerant&&C.scheme?(F.scheme=C.scheme,F.userinfo=C.userinfo,F.host=C.host,F.port=C.port,F.path=n(C.path||""),F.query=C.query):(C.userinfo!==void 0||C.host!==void 0||C.port!==void 0?(F.userinfo=C.userinfo,F.host=C.host,F.port=C.port,F.path=n(C.path||""),F.query=C.query):(C.path?(C.path.charAt(0)==="/"?F.path=n(C.path):((P.userinfo!==void 0||P.host!==void 0||P.port!==void 0)&&!P.path?F.path="/"+C.path:P.path?F.path=P.path.slice(0,P.path.lastIndexOf("/")+1)+C.path:F.path=C.path,F.path=n(F.path)),F.query=C.query):(F.path=P.path,C.query!==void 0?F.query=C.query:F.query=P.query),F.userinfo=P.userinfo,F.host=P.host,F.port=P.port),F.scheme=P.scheme),F.fragment=C.fragment,F}s(p,"resolveComponents");function m(P,C,T){return typeof P=="string"?(P=unescape(P),P=y(o(M(P,T),!0),vt(Ee({},T),{skipEscape:!0}))):typeof P=="object"&&(P=y(o(P,!0),vt(Ee({},T),{skipEscape:!0}))),typeof C=="string"?(C=unescape(C),C=y(o(M(C,T),!0),vt(Ee({},T),{skipEscape:!0}))):typeof C=="object"&&(C=y(o(C,!0),vt(Ee({},T),{skipEscape:!0}))),P.toLowerCase()===C.toLowerCase()}s(m,"equal");function y(P,C){let T={host:P.host,scheme:P.scheme,userinfo:P.userinfo,port:P.port,path:P.path,query:P.query,nid:P.nid,nss:P.nss,uuid:P.uuid,fragment:P.fragment,reference:P.reference,resourceName:P.resourceName,secure:P.secure,error:""},D=Object.assign({},C),F=[],k=l[(D.scheme||T.scheme||"").toLowerCase()];k&&k.serialize&&k.serialize(T,D),T.path!==void 0&&(D.skipEscape?T.path=unescape(T.path):(T.path=escape(T.path),T.scheme!==void 0&&(T.path=T.path.split("%3A").join(":")))),D.reference!=="suffix"&&T.scheme&&F.push(T.scheme,":");let B=a(T);if(B!==void 0&&(D.reference!=="suffix"&&F.push("//"),F.push(B),T.path&&T.path.charAt(0)!=="/"&&F.push("/")),T.path!==void 0){let U=T.path;!D.absolutePath&&(!k||!k.absolutePath)&&(U=n(U)),B===void 0&&(U=U.replace(new RegExp("^\\/\\/","u"),"/%2F")),F.push(U)}return T.query!==void 0&&F.push("?",T.query),T.fragment!==void 0&&F.push("#",T.fragment),F.join("")}s(y,"serialize");var v=Array.from({length:127},(P,C)=>new RegExp("[^!\"$&'()*+,\\-.;=_`a-z{}~]","u").test(String.fromCharCode(C)));function x(P){let C=0;for(let T=0,D=P.length;T<D;++T)if(C=P.charCodeAt(T),C>126||v[C])return!0;return!1}s(x,"nonSimpleDomain");var E=new RegExp("^(?:([^#/:?]+):)?(?:\\/\\/((?:([^#/?@]*)@)?(\\[[^#/?\\]]+\\]|[^#/:?]*)(?::(\\d*))?))?([^#?]*)(?:\\?([^#]*))?(?:#((?:.|[\\n\\r])*))?","u");function M(P,C){let T=Object.assign({},C),D={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},F=P.indexOf("%")!==-1,k=!1;T.reference==="suffix"&&(P=(T.scheme?T.scheme+":":"")+"//"+P);let B=P.match(E);if(B){if(D.scheme=B[1],D.userinfo=B[3],D.host=B[4],D.port=parseInt(B[5],10),D.path=B[6]||"",D.query=B[7],D.fragment=B[8],isNaN(D.port)&&(D.port=B[5]),D.host){let z=i(D.host);if(z.isIPV4===!1){let q=r(z.host);D.host=q.host.toLowerCase(),k=q.isIPV6}else D.host=z.host,k=!0}D.scheme===void 0&&D.userinfo===void 0&&D.host===void 0&&D.port===void 0&&D.query===void 0&&!D.path?D.reference="same-document":D.scheme===void 0?D.reference="relative":D.fragment===void 0?D.reference="absolute":D.reference="uri",T.reference&&T.reference!=="suffix"&&T.reference!==D.reference&&(D.error=D.error||"URI is not a "+T.reference+" reference.");let U=l[(T.scheme||D.scheme||"").toLowerCase()];if(!T.unicodeSupport&&(!U||!U.unicodeSupport)&&D.host&&(T.domainHost||U&&U.domainHost)&&k===!1&&x(D.host))try{D.host=URL.domainToASCII(D.host.toLowerCase())}catch(z){D.error=D.error||"Host's domain name can not be converted to ASCII: "+z}(!U||U&&!U.skipNormalize)&&(F&&D.scheme!==void 0&&(D.scheme=unescape(D.scheme)),F&&D.host!==void 0&&(D.host=unescape(D.host)),D.path&&(D.path=escape(unescape(D.path))),D.fragment&&(D.fragment=encodeURI(decodeURIComponent(D.fragment)))),U&&U.parse&&U.parse(D,T)}else D.error=D.error||"URI can not be parsed.";return D}s(M,"parse");var I={SCHEMES:l,normalize:u,resolve:c,resolveComponents:p,equal:m,serialize:y,parse:M};e.exports=I,e.exports.default=I,e.exports.fastUri=I}),Mqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Sqe();e.code='require("ajv/dist/runtime/uri").default',t.default=e}),Eqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=GP();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:s(function(){return e.KeywordCxt},"get")});var r=an();Object.defineProperty(t,"_",{enumerable:!0,get:s(function(){return r._},"get")}),Object.defineProperty(t,"str",{enumerable:!0,get:s(function(){return r.str},"get")}),Object.defineProperty(t,"stringify",{enumerable:!0,get:s(function(){return r.stringify},"get")}),Object.defineProperty(t,"nil",{enumerable:!0,get:s(function(){return r.nil},"get")}),Object.defineProperty(t,"Name",{enumerable:!0,get:s(function(){return r.Name},"get")}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:s(function(){return r.CodeGen},"get")});var i=QB(),n=HP(),a=eye(),o=ez(),l=an(),u=$P(),c=r3(),p=Fn(),m=xqe(),y=Mqe(),v=s((ue,K)=>new RegExp(ue,K),"defaultRegExp");v.code="new RegExp";var x=["removeAdditional","useDefaults","coerceTypes"],E=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),M={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},I={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},P=200;function C(ue){var K,ce,re,se,de,we,Le,fe,Re,me,Ae,Ue,_e,lt,tt,We,at,Lt,dt,Me,ve,Ze,It,Rt,Et;let pt=ue.strict,Yt=(K=ue.code)===null||K===void 0?void 0:K.optimize,Kt=Yt===!0||Yt===void 0?1:Yt||0,$t=(re=(ce=ue.code)===null||ce===void 0?void 0:ce.regExp)!==null&&re!==void 0?re:v,jt=(se=ue.uriResolver)!==null&&se!==void 0?se:y.default;return{strictSchema:(we=(de=ue.strictSchema)!==null&&de!==void 0?de:pt)!==null&&we!==void 0?we:!0,strictNumbers:(fe=(Le=ue.strictNumbers)!==null&&Le!==void 0?Le:pt)!==null&&fe!==void 0?fe:!0,strictTypes:(me=(Re=ue.strictTypes)!==null&&Re!==void 0?Re:pt)!==null&&me!==void 0?me:"log",strictTuples:(Ue=(Ae=ue.strictTuples)!==null&&Ae!==void 0?Ae:pt)!==null&&Ue!==void 0?Ue:"log",strictRequired:(lt=(_e=ue.strictRequired)!==null&&_e!==void 0?_e:pt)!==null&&lt!==void 0?lt:!1,code:ue.code?vt(Ee({},ue.code),{optimize:Kt,regExp:$t}):{optimize:Kt,regExp:$t},loopRequired:(tt=ue.loopRequired)!==null&&tt!==void 0?tt:P,loopEnum:(We=ue.loopEnum)!==null&&We!==void 0?We:P,meta:(at=ue.meta)!==null&&at!==void 0?at:!0,messages:(Lt=ue.messages)!==null&&Lt!==void 0?Lt:!0,inlineRefs:(dt=ue.inlineRefs)!==null&&dt!==void 0?dt:!0,schemaId:(Me=ue.schemaId)!==null&&Me!==void 0?Me:"$id",addUsedSchema:(ve=ue.addUsedSchema)!==null&&ve!==void 0?ve:!0,validateSchema:(Ze=ue.validateSchema)!==null&&Ze!==void 0?Ze:!0,validateFormats:(It=ue.validateFormats)!==null&&It!==void 0?It:!0,unicodeRegExp:(Rt=ue.unicodeRegExp)!==null&&Rt!==void 0?Rt:!0,int32range:(Et=ue.int32range)!==null&&Et!==void 0?Et:!0,uriResolver:jt}}s(C,"requiredOptions");var T=class{constructor(K={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,K=this.opts=Ee(Ee({},K),C(K));let{es5:ce,lines:re}=this.opts.code;this.scope=new l.ValueScope({scope:{},prefixes:E,es5:ce,lines:re}),this.logger=Q(K.logger);let se=K.validateFormats;K.validateFormats=!1,this.RULES=(0,a.getRules)(),F.call(this,M,K,"NOT SUPPORTED"),F.call(this,I,K,"DEPRECATED","warn"),this._metaOpts=q.call(this),K.formats&&U.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),K.keywords&&z.call(this,K.keywords),typeof K.meta=="object"&&this.addMetaSchema(K.meta),B.call(this),K.validateFormats=se}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:K,meta:ce,schemaId:re}=this.opts,se=m;re==="id"&&(se=Ee({},m),se.id=se.$id,delete se.$id),ce&&K&&this.addMetaSchema(se,se[re],!1)}defaultMeta(){let{meta:K,schemaId:ce}=this.opts;return this.opts.defaultMeta=typeof K=="object"?K[ce]||K:void 0}validate(K,ce){let re;if(typeof K=="string"){if(re=this.getSchema(K),!re)throw new Error('no schema with key or ref "'.concat(K,'"'))}else re=this.compile(K);let se=re(ce);return"$async"in re||(this.errors=re.errors),se}compile(K,ce){let re=this._addSchema(K,ce);return re.validate||this._compileSchemaEnv(re)}compileAsync(K,ce){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:re}=this.opts;return se.call(this,K,ce);async function se(me,Ae){await de.call(this,me.$schema);let Ue=this._addSchema(me,Ae);return Ue.validate||we.call(this,Ue)}async function de(me){me&&!this.getSchema(me)&&await se.call(this,{$ref:me},!0)}async function we(me){try{return this._compileSchemaEnv(me)}catch(Ae){if(!(Ae instanceof n.default))throw Ae;return Le.call(this,Ae),await fe.call(this,Ae.missingSchema),we.call(this,me)}}function Le({missingSchema:me,missingRef:Ae}){if(this.refs[me])throw new Error("AnySchema ".concat(me," is loaded but ").concat(Ae," cannot be resolved"))}async function fe(me){let Ae=await Re.call(this,me);this.refs[me]||await de.call(this,Ae.$schema),this.refs[me]||this.addSchema(Ae,me,ce)}async function Re(me){let Ae=this._loading[me];if(Ae)return Ae;try{return await(this._loading[me]=re(me))}finally{delete this._loading[me]}}}addSchema(K,ce,re,se=this.opts.validateSchema){if(Array.isArray(K)){for(let we of K)this.addSchema(we,void 0,re,se);return this}let de;if(typeof K=="object"){let{schemaId:we}=this.opts;if(de=K[we],de!==void 0&&typeof de!="string")throw new Error("schema ".concat(we," must be string"))}return ce=(0,u.normalizeId)(ce||de),this._checkUnique(ce),this.schemas[ce]=this._addSchema(K,re,ce,se,!0),this}addMetaSchema(K,ce,re=this.opts.validateSchema){return this.addSchema(K,ce,!0,re),this}validateSchema(K,ce){if(typeof K=="boolean")return!0;let re;if(re=K.$schema,re!==void 0&&typeof re!="string")throw new Error("$schema must be a string");if(re=re||this.opts.defaultMeta||this.defaultMeta(),!re)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let se=this.validate(re,K);if(!se&&ce){let de="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(de);else throw new Error(de)}return se}getSchema(K){let ce;for(;typeof(ce=k.call(this,K))=="string";)K=ce;if(ce===void 0){let{schemaId:re}=this.opts,se=new o.SchemaEnv({schema:{},schemaId:re});if(ce=o.resolveSchema.call(this,se,K),!ce)return;this.refs[K]=ce}return ce.validate||this._compileSchemaEnv(ce)}removeSchema(K){if(K instanceof RegExp)return this._removeAllSchemas(this.schemas,K),this._removeAllSchemas(this.refs,K),this;switch(typeof K){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let ce=k.call(this,K);return typeof ce=="object"&&this._cache.delete(ce.schema),delete this.schemas[K],delete this.refs[K],this}case"object":{let ce=K;this._cache.delete(ce);let re=K[this.opts.schemaId];return re&&(re=(0,u.normalizeId)(re),delete this.schemas[re],delete this.refs[re]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(K){for(let ce of K)this.addKeyword(ce);return this}addKeyword(K,ce){let re;if(typeof K=="string")re=K,typeof ce=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),ce.keyword=re);else if(typeof K=="object"&&ce===void 0){if(ce=K,re=ce.keyword,Array.isArray(re)&&!re.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(ae.call(this,re,ce),!ce)return(0,p.eachItem)(re,de=>Y.call(this,de)),this;J.call(this,ce);let se=vt(Ee({},ce),{type:(0,c.getJSONTypes)(ce.type),schemaType:(0,c.getJSONTypes)(ce.schemaType)});return(0,p.eachItem)(re,se.type.length===0?de=>Y.call(this,de,se):de=>se.type.forEach(we=>Y.call(this,de,se,we))),this}getKeyword(K){let ce=this.RULES.all[K];return typeof ce=="object"?ce.definition:!!ce}removeKeyword(K){let{RULES:ce}=this;delete ce.keywords[K],delete ce.all[K];for(let re of ce.rules){let se=re.rules.findIndex(de=>de.keyword===K);se>=0&&re.rules.splice(se,1)}return this}addFormat(K,ce){return typeof ce=="string"&&(ce=new RegExp(ce)),this.formats[K]=ce,this}errorsText(K=this.errors,{separator:ce=", ",dataVar:re="data"}={}){return!K||K.length===0?"No errors":K.map(se=>"".concat(re).concat(se.instancePath," ").concat(se.message)).reduce((se,de)=>se+ce+de)}$dataMetaSchema(K,ce){let re=this.RULES.all;K=JSON.parse(JSON.stringify(K));for(let se of ce){let de=se.split("/").slice(1),we=K;for(let Le of de)we=we[Le];for(let Le in re){let fe=re[Le];if(typeof fe!="object")continue;let{$data:Re}=fe.definition,me=we[Le];Re&&me&&(we[Le]=ee(me))}}return K}_removeAllSchemas(K,ce){for(let re in K){let se=K[re];(!ce||ce.test(re))&&(typeof se=="string"?delete K[re]:se&&!se.meta&&(this._cache.delete(se.schema),delete K[re]))}}_addSchema(K,ce,re,se=this.opts.validateSchema,de=this.opts.addUsedSchema){let we,{schemaId:Le}=this.opts;if(typeof K=="object")we=K[Le];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof K!="boolean")throw new Error("schema must be object or boolean")}let fe=this._cache.get(K);if(fe!==void 0)return fe;re=(0,u.normalizeId)(we||re);let Re=u.getSchemaRefs.call(this,K,re);return fe=new o.SchemaEnv({schema:K,schemaId:Le,meta:ce,baseId:re,localRefs:Re}),this._cache.set(fe.schema,fe),de&&!re.startsWith("#")&&(re&&this._checkUnique(re),this.refs[re]=fe),se&&this.validateSchema(K,!0),fe}_checkUnique(K){if(this.schemas[K]||this.refs[K])throw new Error('schema with key or id "'.concat(K,'" already exists'))}_compileSchemaEnv(K){if(K.meta?this._compileMetaSchema(K):o.compileSchema.call(this,K),!K.validate)throw new Error("ajv implementation error");return K.validate}_compileMetaSchema(K){let ce=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,K)}finally{this.opts=ce}}};s(T,"Ajv");var D=T;D.ValidationError=i.default,D.MissingRefError=n.default,t.default=D;function F(ue,K,ce,re="error"){for(let se in ue){let de=se;de in K&&this.logger[re]("".concat(ce,": option ").concat(se,". ").concat(ue[de]))}}s(F,"checkOptions");function k(ue){return ue=(0,u.normalizeId)(ue),this.schemas[ue]||this.refs[ue]}s(k,"getSchEnv");function B(){let ue=this.opts.schemas;if(ue)if(Array.isArray(ue))this.addSchema(ue);else for(let K in ue)this.addSchema(ue[K],K)}s(B,"addInitialSchemas");function U(){for(let ue in this.opts.formats){let K=this.opts.formats[ue];K&&this.addFormat(ue,K)}}s(U,"addInitialFormats");function z(ue){if(Array.isArray(ue)){this.addVocabulary(ue);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let K in ue){let ce=ue[K];ce.keyword||(ce.keyword=K),this.addKeyword(ce)}}s(z,"addInitialKeywords");function q(){let ue=Ee({},this.opts);for(let K of x)delete ue[K];return ue}s(q,"getMetaSchemaOptions");var Z={log(){},warn(){},error(){}};function Q(ue){if(ue===!1)return Z;if(ue===void 0)return console;if(ue.log&&ue.warn&&ue.error)return ue;throw new Error("logger must implement log, warn and error methods")}s(Q,"getLogger");var V=/^[a-z_$][a-z0-9_$:-]*$/i;function ae(ue,K){let{RULES:ce}=this;if((0,p.eachItem)(ue,re=>{if(ce.keywords[re])throw new Error("Keyword ".concat(re," is already defined"));if(!V.test(re))throw new Error("Keyword ".concat(re," has invalid name"))}),!!K&&K.$data&&!("code"in K||"validate"in K))throw new Error('$data keyword must have "code" or "validate" function')}s(ae,"checkKeyword");function Y(ue,K,ce){var re;let se=K==null?void 0:K.post;if(ce&&se)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:de}=this,we=se?de.post:de.rules.find(({type:fe})=>fe===ce);if(we||(we={type:ce,rules:[]},de.rules.push(we)),de.keywords[ue]=!0,!K)return;let Le={keyword:ue,definition:vt(Ee({},K),{type:(0,c.getJSONTypes)(K.type),schemaType:(0,c.getJSONTypes)(K.schemaType)})};K.before?he.call(this,we,Le,K.before):we.rules.push(Le),de.all[ue]=Le,(re=K.implements)===null||re===void 0||re.forEach(fe=>this.addKeyword(fe))}s(Y,"addRule");function he(ue,K,ce){let re=ue.rules.findIndex(se=>se.keyword===ce);re>=0?ue.rules.splice(re,0,K):(ue.rules.push(K),this.logger.warn("rule ".concat(ce," is not defined")))}s(he,"addBeforeRule");function J(ue){let{metaSchema:K}=ue;K!==void 0&&(ue.$data&&this.opts.$data&&(K=ee(K)),ue.validateSchema=this.compile(K,!0))}s(J,"keywordMetaschema");var ne={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ee(ue){return{anyOf:[ue,ne]}}s(ee,"schemaOrData")}),Cqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=e}),Iqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;var e=HP(),r=Kh(),i=an(),n=cg(),a=ez(),o=Fn(),l,u={keyword:"$ref",schemaType:"string",code(C){let{gen:T,schema:D,it:F}=C,{baseId:k,schemaEnv:B,validateName:U,opts:z,self:q}=F,{root:Z}=B;if((D==="#"||D==="#/")&&k===Z.baseId)return V();let Q=a.resolveRef.call(q,Z,k,D);if(Q===void 0)throw new e.default(F.opts.uriResolver,k,D);if(Q instanceof a.SchemaEnv)return ae(Q);return Y(Q);function V(){if(B===Z)return P(C,U,B,B.$async);let he=T.scopeValue("root",{ref:Z});return P(C,(0,i._)(l||(l=je(["",".validate"])),he),Z,Z.$async)}function ae(he){let J=p(C,he);P(C,J,he,he.$async)}function Y(he){let J=T.scopeValue("schema",z.code.source===!0?{ref:he,code:(0,i.stringify)(he)}:{ref:he}),ne=T.name("valid"),ee=C.subschema({schema:he,dataTypes:[],schemaPath:i.nil,topSchemaRef:J,errSchemaPath:D},ne);C.mergeEvaluated(ee),C.ok(ne)}}},c;function p(C,T){let{gen:D}=C;return T.validate?D.scopeValue("validate",{ref:T.validate}):(0,i._)(c||(c=je(["",".validate"])),D.scopeValue("wrapper",{ref:T}))}s(p,"getValidate"),t.getValidate=p;var m,y,v,x,E,M,I;function P(C,T,D,F){let{gen:k,it:B}=C,{allErrors:U,schemaEnv:z,opts:q}=B,Z=q.passContext?n.default.this:i.nil;F?Q():V();function Q(){if(!z.$async)throw new Error("async schema referenced by sync schema");let he=k.let("valid");k.try(()=>{k.code((0,i._)(m||(m=je(["await ",""])),(0,r.callValidateCode)(C,T,Z))),Y(T),U||k.assign(he,!0)},J=>{k.if((0,i._)(y||(y=je(["!("," instanceof ",")"])),J,B.ValidationError),()=>k.throw(J)),ae(J),U||k.assign(he,!1)}),C.ok(he)}s(Q,"callAsyncRef");function V(){C.result((0,r.callValidateCode)(C,T,Z),()=>Y(T),()=>ae(T))}s(V,"callSyncRef");function ae(he){let J=(0,i._)(v||(v=je(["",".errors"])),he);k.assign(n.default.vErrors,(0,i._)(x||(x=je([""," === null ? "," : ",".concat(",")"])),n.default.vErrors,J,n.default.vErrors,J)),k.assign(n.default.errors,(0,i._)(E||(E=je(["",".length"])),n.default.vErrors))}s(ae,"addErrorsFrom");function Y(he){var J;if(!B.opts.unevaluated)return;let ne=(J=D==null?void 0:D.validate)===null||J===void 0?void 0:J.evaluated;if(B.props!==!0)if(ne&&!ne.dynamicProps)ne.props!==void 0&&(B.props=o.mergeEvaluated.props(k,ne.props,B.props));else{let ee=k.var("props",(0,i._)(M||(M=je(["",".evaluated.props"])),he));B.props=o.mergeEvaluated.props(k,ee,B.props,i.Name)}if(B.items!==!0)if(ne&&!ne.dynamicItems)ne.items!==void 0&&(B.items=o.mergeEvaluated.items(k,ne.items,B.items));else{let ee=k.var("items",(0,i._)(I||(I=je(["",".evaluated.items"])),he));B.items=o.mergeEvaluated.items(k,ee,B.items,i.Name)}}s(Y,"addEvaluatedFrom")}s(P,"callRef"),t.callRef=P,t.default=u}),Tqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Cqe(),r=Iqe(),i=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",e.default,r.default];t.default=i}),Pqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=e.operators,i={maximum:{okStr:"<=",ok:r.LTE,fail:r.GT},minimum:{okStr:">=",ok:r.GTE,fail:r.LT},exclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},exclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},n,a,o={message:s(({keyword:c,schemaCode:p})=>(0,e.str)(n||(n=je(["must be "," ",""])),i[c].okStr,p),"message"),params:s(({keyword:c,schemaCode:p})=>(0,e._)(a||(a=je(["{comparison: ",", limit: ","}"])),i[c].okStr,p),"params")},l,u={keyword:Object.keys(i),type:"number",schemaType:"number",$data:!0,error:o,code(c){let{keyword:p,data:m,schemaCode:y}=c;c.fail$data((0,e._)(l||(l=je([""," "," "," || isNaN(",")"])),m,i[p].fail,y,m))}};t.default=u}),Lqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r,i,n={message:s(({schemaCode:c})=>(0,e.str)(r||(r=je(["must be multiple of ",""])),c),"message"),params:s(({schemaCode:c})=>(0,e._)(i||(i=je(["{multipleOf: ","}"])),c),"params")},a,o,l,u={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:n,code(c){let{gen:p,data:m,schemaCode:y,it:v}=c,x=v.opts.multipleOfPrecision,E=p.let("res"),M=x?(0,e._)(a||(a=je(["Math.abs(Math.round(",") - ",") > 1e-",""])),E,E,x):(0,e._)(o||(o=je([""," !== parseInt(",")"])),E,E);c.fail$data((0,e._)(l||(l=je(["("," === 0 || ("," = ","/",", ","))"])),y,E,m,y,M))}};t.default=u}),Dqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});function e(r){let i=r.length,n=0,a=0,o;for(;a<i;)n++,o=r.charCodeAt(a++),o>=55296&&o<=56319&&a<i&&(o=r.charCodeAt(a),(o&64512)===56320&&a++);return n}s(e,"ucs2length"),t.default=e,e.code='require("ajv/dist/runtime/ucs2length").default'}),Rqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i=Dqe(),n,a,o={message({keyword:m,schemaCode:y}){let v=m==="maxLength"?"more":"fewer";return(0,e.str)(n||(n=je(["must NOT have "," than "," characters"])),v,y)},params:s(({schemaCode:m})=>(0,e._)(a||(a=je(["{limit: ","}"])),m),"params")},l,u,c,p={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:o,code(m){let{keyword:y,data:v,schemaCode:x,it:E}=m,M=y==="maxLength"?e.operators.GT:e.operators.LT,I=E.opts.unicode===!1?(0,e._)(l||(l=je(["",".length"])),v):(0,e._)(u||(u=je(["","(",")"])),(0,r.useFunc)(m.gen,i.default),v);m.fail$data((0,e._)(c||(c=je([""," "," ",""])),I,M,x))}};t.default=p}),Oqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=an(),i,n,a={message:s(({schemaCode:c})=>(0,r.str)(i||(i=je(['must match pattern "','"'])),c),"message"),params:s(({schemaCode:c})=>(0,r._)(n||(n=je(["{pattern: ","}"])),c),"params")},o,l,u={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:a,code(c){let{data:p,$data:m,schema:y,schemaCode:v,it:x}=c,E=x.opts.unicodeRegExp?"u":"",M=m?(0,r._)(o||(o=je(["(new RegExp(",", ","))"])),v,E):(0,e.usePattern)(c,y);c.fail$data((0,r._)(l||(l=je(["!",".test(",")"])),M,p))}};t.default=u}),kqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r,i,n={message({keyword:l,schemaCode:u}){let c=l==="maxProperties"?"more":"fewer";return(0,e.str)(r||(r=je(["must NOT have "," than "," properties"])),c,u)},params:s(({schemaCode:l})=>(0,e._)(i||(i=je(["{limit: ","}"])),l),"params")},a,o={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:n,code(l){let{keyword:u,data:c,schemaCode:p}=l,m=u==="maxProperties"?e.operators.GT:e.operators.LT;l.fail$data((0,e._)(a||(a=je(["Object.keys(",").length "," ",""])),c,m,p))}};t.default=o}),Nqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=an(),i=Fn(),n,a,o={message:s(({params:{missingProperty:u}})=>(0,r.str)(n||(n=je(["must have required property '","'"])),u),"message"),params:s(({params:{missingProperty:u}})=>(0,r._)(a||(a=je(["{missingProperty: ","}"])),u),"params")},l={keyword:"required",type:"object",schemaType:"array",$data:!0,error:o,code(u){let{gen:c,schema:p,schemaCode:m,data:y,$data:v,it:x}=u,{opts:E}=x;if(!v&&p.length===0)return;let M=p.length>=E.loopRequired;if(x.allErrors?I():P(),E.strictRequired){let D=u.parentSchema.properties,{definedProperties:F}=u.it;for(let k of p)if((D==null?void 0:D[k])===void 0&&!F.has(k)){let B=x.schemaEnv.baseId+x.errSchemaPath,U='required property "'.concat(k,'" is not defined at "').concat(B,'" (strictRequired)');(0,i.checkStrictMode)(x,U,x.opts.strictRequired)}}function I(){if(M||v)u.block$data(r.nil,C);else for(let D of p)(0,e.checkReportMissingProp)(u,D)}s(I,"allErrorsMode");function P(){let D=c.let("missing");if(M||v){let F=c.let("valid",!0);u.block$data(F,()=>T(D,F)),u.ok(F)}else c.if((0,e.checkMissingProp)(u,p,D)),(0,e.reportMissingProp)(u,D),c.else()}s(P,"exitOnErrorMode");function C(){c.forOf("prop",m,D=>{u.setParams({missingProperty:D}),c.if((0,e.noPropertyInData)(c,y,D,E.ownProperties),()=>u.error())})}s(C,"loopAllRequired");function T(D,F){u.setParams({missingProperty:D}),c.forOf(D,m,()=>{c.assign(F,(0,e.propertyInData)(c,y,D,E.ownProperties)),c.if((0,r.not)(F),()=>{u.error(),c.break()})},r.nil)}s(T,"loopUntilMissing")}};t.default=l}),Fqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r,i,n={message({keyword:l,schemaCode:u}){let c=l==="maxItems"?"more":"fewer";return(0,e.str)(r||(r=je(["must NOT have "," than "," items"])),c,u)},params:s(({schemaCode:l})=>(0,e._)(i||(i=je(["{limit: ","}"])),l),"params")},a,o={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:n,code(l){let{keyword:u,data:c,schemaCode:p}=l,m=u==="maxItems"?e.operators.GT:e.operators.LT;l.fail$data((0,e._)(a||(a=je(["",".length "," ",""])),c,m,p))}};t.default=o}),tz=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=rye();e.code='require("ajv/dist/runtime/equal").default',t.default=e}),Bqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=r3(),r=an(),i=Fn(),n=tz(),a,o,l={message:s(({params:{i:B,j:U}})=>(0,r.str)(a||(a=je(["must NOT have duplicate items (items ## "," and "," are identical)"])),U,B),"message"),params:s(({params:{i:B,j:U}})=>(0,r._)(o||(o=je(["{i: ",", j: ","}"])),B,U),"params")},u,c,p,m,y,v,x,E,M,I,P,C,T,D,F,k={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:l,code(B){let{gen:U,data:z,$data:q,schema:Z,parentSchema:Q,schemaCode:V,it:ae}=B;if(!q&&!Z)return;let Y=U.let("valid"),he=Q.items?(0,e.getSchemaTypes)(Q.items):[];B.block$data(Y,J,(0,r._)(u||(u=je([""," === false"])),V)),B.ok(Y);function J(){let K=U.let("i",(0,r._)(c||(c=je(["",".length"])),z)),ce=U.let("j");B.setParams({i:K,j:ce}),U.assign(Y,!0),U.if((0,r._)(p||(p=je([""," > 1"])),K),()=>(ne()?ee:ue)(K,ce))}s(J,"validateUniqueItems");function ne(){return he.length>0&&!he.some(K=>K==="object"||K==="array")}s(ne,"canOptimize");function ee(K,ce){let re=U.name("item"),se=(0,e.checkDataTypes)(he,re,ae.opts.strictNumbers,e.DataType.Wrong),de=U.const("indices",(0,r._)(m||(m=je(["{}"]))));U.for((0,r._)(y||(y=je([";","--;"])),K),()=>{U.let(re,(0,r._)(v||(v=je(["","[","]"])),z,K)),U.if(se,(0,r._)(x||(x=je(["continue"])))),he.length>1&&U.if((0,r._)(E||(E=je(["typeof ",' == "string"'])),re),(0,r._)(M||(M=je(["",' += "_"'])),re)),U.if((0,r._)(I||(I=je(["typeof ","[",'] == "number"'])),de,re),()=>{U.assign(ce,(0,r._)(P||(P=je(["","[","]"])),de,re)),B.error(),U.assign(Y,!1).break()}).code((0,r._)(C||(C=je(["","[","] = ",""])),de,re,K))})}s(ee,"loopN");function ue(K,ce){let re=(0,i.useFunc)(U,n.default),se=U.name("outer");U.label(se).for((0,r._)(T||(T=je([";","--;"])),K),()=>U.for((0,r._)(D||(D=je([""," = ","; ","--;"])),ce,K,ce),()=>U.if((0,r._)(F||(F=je(["","(","[","], ","[","])"])),re,z,K,z,ce),()=>{B.error(),U.assign(Y,!1).break(se)})))}s(ue,"loopN2")}};t.default=k}),zqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i=tz(),n,a={message:"must be equal to constant",params:s(({schemaCode:c})=>(0,e._)(n||(n=je(["{allowedValue: ","}"])),c),"params")},o,l,u={keyword:"const",$data:!0,error:a,code(c){let{gen:p,data:m,$data:y,schemaCode:v,schema:x}=c;y||x&&typeof x=="object"?c.fail$data((0,e._)(o||(o=je(["!","(",", ",")"])),(0,r.useFunc)(p,i.default),m,v)):c.fail((0,e._)(l||(l=je([""," !== ",""])),x,m))}};t.default=u}),Uqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i=tz(),n,a={message:"must be equal to one of the allowed values",params:s(({schemaCode:p})=>(0,e._)(n||(n=je(["{allowedValues: ","}"])),p),"params")},o,l,u,c={keyword:"enum",schemaType:"array",$data:!0,error:a,code(p){let{gen:m,data:y,$data:v,schema:x,schemaCode:E,it:M}=p;if(!v&&x.length===0)throw new Error("enum must have non-empty array");let I=x.length>=M.opts.loopEnum,P,C=s(()=>P??(P=(0,r.useFunc)(m,i.default)),"getEql"),T;if(I||v)T=m.let("valid"),p.block$data(T,D);else{if(!Array.isArray(x))throw new Error("ajv implementation error");let k=m.const("vSchema",E);T=(0,e.or)(...x.map((B,U)=>F(k,U)))}p.pass(T);function D(){m.assign(T,!1),m.forOf("v",E,k=>m.if((0,e._)(o||(o=je(["","(",", ",")"])),C(),y,k),()=>m.assign(T,!0).break()))}s(D,"loopEnum");function F(k,B){let U=x[B];return typeof U=="object"&&U!==null?(0,e._)(l||(l=je(["","(",", ","[","])"])),C(),y,k,B):(0,e._)(u||(u=je([""," === ",""])),y,U)}s(F,"equalCode")}};t.default=c}),Vqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Pqe(),r=Lqe(),i=Rqe(),n=Oqe(),a=kqe(),o=Nqe(),l=Fqe(),u=Bqe(),c=zqe(),p=Uqe(),m=[e.default,r.default,i.default,n.default,a.default,o.default,l.default,u.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},c.default,p.default];t.default=m}),iye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;var e=an(),r=Fn(),i,n,a={message:s(({params:{len:m}})=>(0,e.str)(i||(i=je(["must NOT have more than "," items"])),m),"message"),params:s(({params:{len:m}})=>(0,e._)(n||(n=je(["{limit: ","}"])),m),"params")},o={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:a,code(m){let{parentSchema:y,it:v}=m,{items:x}=y;if(!Array.isArray(x)){(0,r.checkStrictMode)(v,'"additionalItems" is ignored when "items" is not an array of schemas');return}p(m,x)}},l,u,c;function p(m,y){let{gen:v,schema:x,data:E,keyword:M,it:I}=m;I.items=!0;let P=v.const("len",(0,e._)(l||(l=je(["",".length"])),E));if(x===!1)m.setParams({len:y.length}),m.pass((0,e._)(u||(u=je([""," <= ",""])),P,y.length));else if(typeof x=="object"&&!(0,r.alwaysValidSchema)(I,x)){let T=v.var("valid",(0,e._)(c||(c=je([""," <= ",""])),P,y.length));v.if((0,e.not)(T),()=>C(T)),m.ok(T)}function C(T){v.forRange("i",y.length,P,D=>{m.subschema({keyword:M,dataProp:D,dataPropType:r.Type.Num},T),I.allErrors||v.if((0,e.not)(T),()=>v.break())})}s(C,"validateItems")}s(p,"validateAdditionalItems"),t.validateAdditionalItems=p,t.default=o}),nye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;var e=an(),r=Fn(),i=Kh(),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(u){let{schema:c,it:p}=u;if(Array.isArray(c))return l(u,"additionalItems",c);p.items=!0,!(0,r.alwaysValidSchema)(p,c)&&u.ok((0,i.validateArray)(u))}},a,o;function l(u,c,p=u.schema){let{gen:m,parentSchema:y,data:v,keyword:x,it:E}=u;P(y),E.opts.unevaluated&&p.length&&E.items!==!0&&(E.items=r.mergeEvaluated.items(m,p.length,E.items));let M=m.name("valid"),I=m.const("len",(0,e._)(a||(a=je(["",".length"])),v));p.forEach((C,T)=>{(0,r.alwaysValidSchema)(E,C)||(m.if((0,e._)(o||(o=je([""," > ",""])),I,T),()=>u.subschema({keyword:x,schemaProp:T,dataProp:T},M)),u.ok(M))});function P(C){let{opts:T,errSchemaPath:D}=E,F=p.length,k=F===C.minItems&&(F===C.maxItems||C[c]===!1);if(T.strictTuples&&!k){let B='"'.concat(x,'" is ').concat(F,"-tuple, but minItems or maxItems/").concat(c,' are not specified or different at path "').concat(D,'"');(0,r.checkStrictMode)(E,B,T.strictTuples)}}s(P,"checkStrictTuple")}s(l,"validateTuple"),t.validateTuple=l,t.default=n}),jqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=nye(),r={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:s(i=>(0,e.validateTuple)(i,"items"),"code")};t.default=r}),$qe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i=Kh(),n=iye(),a,o,l={message:s(({params:{len:c}})=>(0,e.str)(a||(a=je(["must NOT have more than "," items"])),c),"message"),params:s(({params:{len:c}})=>(0,e._)(o||(o=je(["{limit: ","}"])),c),"params")},u={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:l,code(c){let{schema:p,parentSchema:m,it:y}=c,{prefixItems:v}=m;y.items=!0,!(0,r.alwaysValidSchema)(y,p)&&(v?(0,n.validateAdditionalItems)(c,v):c.ok((0,i.validateArray)(c)))}};t.default=u}),Gqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i,n,a,o,l={message:s(({params:{min:I,max:P}})=>P===void 0?(0,e.str)(i||(i=je(["must contain at least "," valid item(s)"])),I):(0,e.str)(n||(n=je(["must contain at least "," and no more than "," valid item(s)"])),I,P),"message"),params:s(({params:{min:I,max:P}})=>P===void 0?(0,e._)(a||(a=je(["{minContains: ","}"])),I):(0,e._)(o||(o=je(["{minContains: ",", maxContains: ","}"])),I,P),"params")},u,c,p,m,y,v,x,E,M={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:l,code(I){let{gen:P,schema:C,parentSchema:T,data:D,it:F}=I,k,B,{minContains:U,maxContains:z}=T;F.opts.next?(k=U===void 0?1:U,B=z):k=1;let q=P.const("len",(0,e._)(u||(u=je(["",".length"])),D));if(I.setParams({min:k,max:B}),B===void 0&&k===0){(0,r.checkStrictMode)(F,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(B!==void 0&&k>B){(0,r.checkStrictMode)(F,'"minContains" > "maxContains" is always invalid'),I.fail();return}if((0,r.alwaysValidSchema)(F,C)){let Y=(0,e._)(c||(c=je([""," >= ",""])),q,k);B!==void 0&&(Y=(0,e._)(p||(p=je([""," && "," <= ",""])),Y,q,B)),I.pass(Y);return}F.items=!0;let Z=P.name("valid");B===void 0&&k===1?V(Z,()=>P.if(Z,()=>P.break())):k===0?(P.let(Z,!0),B!==void 0&&P.if((0,e._)(m||(m=je(["",".length > 0"])),D),Q)):(P.let(Z,!1),Q()),I.result(Z,()=>I.reset());function Q(){let Y=P.name("_valid"),he=P.let("count",0);V(Y,()=>P.if(Y,()=>ae(he)))}s(Q,"validateItemsWithCount");function V(Y,he){P.forRange("i",0,q,J=>{I.subschema({keyword:"contains",dataProp:J,dataPropType:r.Type.Num,compositeRule:!0},Y),he()})}s(V,"validateItems");function ae(Y){P.code((0,e._)(y||(y=je(["","++"])),Y)),B===void 0?P.if((0,e._)(v||(v=je([""," >= ",""])),Y,k),()=>P.assign(Z,!0).break()):(P.if((0,e._)(x||(x=je([""," > ",""])),Y,B),()=>P.assign(Z,!1).break()),k===1?P.assign(Z,!0):P.if((0,e._)(E||(E=je([""," >= ",""])),Y,k),()=>P.assign(Z,!0)))}s(ae,"checkLimits")}};t.default=M}),Hqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;var e=an(),r=Fn(),i=Kh(),n,a;t.error={message:s(({params:{property:m,depsCount:y,deps:v}})=>{let x=y===1?"property":"properties";return(0,e.str)(n||(n=je(["must have "," "," when property "," is present"])),x,v,m)},"message"),params:s(({params:{property:m,depsCount:y,deps:v,missingProperty:x}})=>(0,e._)(a||(a=je(["{property: ",`,
    missingProperty: `,`,
    depsCount: `,`,
    deps: `,"}"])),m,x,y,v),"params")};var o={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(m){let[y,v]=l(m);c(m,y),p(m,v)}};function l({schema:m}){let y={},v={};for(let x in m){if(x==="__proto__")continue;let E=Array.isArray(m[x])?y:v;E[x]=m[x]}return[y,v]}s(l,"splitDependencies");var u;function c(m,y=m.schema){let{gen:v,data:x,it:E}=m;if(Object.keys(y).length===0)return;let M=v.let("missing");for(let I in y){let P=y[I];if(P.length===0)continue;let C=(0,i.propertyInData)(v,x,I,E.opts.ownProperties);m.setParams({property:I,depsCount:P.length,deps:P.join(", ")}),E.allErrors?v.if(C,()=>{for(let T of P)(0,i.checkReportMissingProp)(m,T)}):(v.if((0,e._)(u||(u=je([""," && (",")"])),C,(0,i.checkMissingProp)(m,P,M))),(0,i.reportMissingProp)(m,M),v.else())}}s(c,"validatePropertyDeps"),t.validatePropertyDeps=c;function p(m,y=m.schema){let{gen:v,data:x,keyword:E,it:M}=m,I=v.name("valid");for(let P in y)(0,r.alwaysValidSchema)(M,y[P])||(v.if((0,i.propertyInData)(v,x,P,M.opts.ownProperties),()=>{let C=m.subschema({keyword:E,schemaProp:P},I);m.mergeValidEvaluated(C,I)},()=>v.var(I,!0)),m.ok(I))}s(p,"validateSchemaDeps"),t.validateSchemaDeps=p,t.default=o}),qqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i,n={message:"property name must be valid",params:s(({params:o})=>(0,e._)(i||(i=je(["{propertyName: ","}"])),o.propertyName),"params")},a={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:n,code(o){let{gen:l,schema:u,data:c,it:p}=o;if((0,r.alwaysValidSchema)(p,u))return;let m=l.name("valid");l.forIn("key",c,y=>{o.setParams({propertyName:y}),o.subschema({keyword:"propertyNames",data:y,dataTypes:["string"],propertyName:y,compositeRule:!0},m),l.if((0,e.not)(m),()=>{o.error(!0),p.allErrors||l.break()})}),o.ok(m)}};t.default=a}),aye=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=an(),i=cg(),n=Fn(),a,o={message:"must NOT have additional properties",params:s(({params:y})=>(0,r._)(a||(a=je(["{additionalProperty: ","}"])),y.additionalProperty),"params")},l,u,c,p,m={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:o,code(y){let{gen:v,schema:x,parentSchema:E,data:M,errsCount:I,it:P}=y;if(!I)throw new Error("ajv implementation error");let{allErrors:C,opts:T}=P;if(P.props=!0,T.removeAdditional!=="all"&&(0,n.alwaysValidSchema)(P,x))return;let D=(0,e.allSchemaProperties)(E.properties),F=(0,e.allSchemaProperties)(E.patternProperties);k(),y.ok((0,r._)(l||(l=je([""," === ",""])),I,i.default.errors));function k(){v.forIn("key",M,Z=>{!D.length&&!F.length?z(Z):v.if(B(Z),()=>z(Z))})}s(k,"checkAdditionalProperties");function B(Z){let Q;if(D.length>8){let V=(0,n.schemaRefOrVal)(P,E.properties,"properties");Q=(0,e.isOwnProperty)(v,V,Z)}else D.length?Q=(0,r.or)(...D.map(V=>(0,r._)(u||(u=je([""," === ",""])),Z,V))):Q=r.nil;return F.length&&(Q=(0,r.or)(Q,...F.map(V=>(0,r._)(c||(c=je(["",".test(",")"])),(0,e.usePattern)(y,V),Z)))),(0,r.not)(Q)}s(B,"isAdditional");function U(Z){v.code((0,r._)(p||(p=je(["delete ","[","]"])),M,Z))}s(U,"deleteAdditional");function z(Z){if(T.removeAdditional==="all"||T.removeAdditional&&x===!1){U(Z);return}if(x===!1){y.setParams({additionalProperty:Z}),y.error(),C||v.break();return}if(typeof x=="object"&&!(0,n.alwaysValidSchema)(P,x)){let Q=v.name("valid");T.removeAdditional==="failing"?(q(Z,Q,!1),v.if((0,r.not)(Q),()=>{y.reset(),U(Z)})):(q(Z,Q),C||v.if((0,r.not)(Q),()=>v.break()))}}s(z,"additionalPropertyCode");function q(Z,Q,V){let ae={keyword:"additionalProperties",dataProp:Z,dataPropType:n.Type.Str};V===!1&&Object.assign(ae,{compositeRule:!0,createErrors:!1,allErrors:!1}),y.subschema(ae,Q)}s(q,"applyAdditionalSchema")}};t.default=m}),Wqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=GP(),r=Kh(),i=Fn(),n=aye(),a={keyword:"properties",type:"object",schemaType:"object",code(o){let{gen:l,schema:u,parentSchema:c,data:p,it:m}=o;m.opts.removeAdditional==="all"&&c.additionalProperties===void 0&&n.default.code(new e.KeywordCxt(m,n.default,"additionalProperties"));let y=(0,r.allSchemaProperties)(u);for(let I of y)m.definedProperties.add(I);m.opts.unevaluated&&y.length&&m.props!==!0&&(m.props=i.mergeEvaluated.props(l,(0,i.toHash)(y),m.props));let v=y.filter(I=>!(0,i.alwaysValidSchema)(m,u[I]));if(v.length===0)return;let x=l.name("valid");for(let I of v)E(I)?M(I):(l.if((0,r.propertyInData)(l,p,I,m.opts.ownProperties)),M(I),m.allErrors||l.else().var(x,!0),l.endIf()),o.it.definedProperties.add(I),o.ok(x);function E(I){return m.opts.useDefaults&&!m.compositeRule&&u[I].default!==void 0}s(E,"hasDefault");function M(I){o.subschema({keyword:"properties",schemaProp:I,dataProp:I},x)}s(M,"applyPropertySchema")}};t.default=a}),Xqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r=an(),i=Fn(),n=Fn(),a,o,l={keyword:"patternProperties",type:"object",schemaType:"object",code(u){let{gen:c,schema:p,data:m,parentSchema:y,it:v}=u,{opts:x}=v,E=(0,e.allSchemaProperties)(p),M=E.filter(k=>(0,i.alwaysValidSchema)(v,p[k]));if(E.length===0||M.length===E.length&&(!v.opts.unevaluated||v.props===!0))return;let I=x.strictSchema&&!x.allowMatchingProperties&&y.properties,P=c.name("valid");v.props!==!0&&!(v.props instanceof r.Name)&&(v.props=(0,n.evaluatedPropsToName)(c,v.props));let{props:C}=v;T();function T(){for(let k of E)I&&D(k),v.allErrors?F(k):(c.var(P,!0),F(k),c.if(P))}s(T,"validatePatternProperties");function D(k){for(let B in I)new RegExp(k).test(B)&&(0,i.checkStrictMode)(v,"property ".concat(B," matches pattern ").concat(k," (use allowMatchingProperties)"))}s(D,"checkMatchingProperties");function F(k){c.forIn("key",m,B=>{c.if((0,r._)(a||(a=je(["",".test(",")"])),(0,e.usePattern)(u,k),B),()=>{let U=M.includes(k);U||u.subschema({keyword:"patternProperties",schemaProp:k,dataProp:B,dataPropType:n.Type.Str},P),v.opts.unevaluated&&C!==!0?c.assign((0,r._)(o||(o=je(["","[","]"])),C,B),!0):!U&&!v.allErrors&&c.if((0,r.not)(P),()=>c.break())})})}s(F,"validateProperties")}};t.default=l}),Zqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Fn(),r={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(i){let{gen:n,schema:a,it:o}=i;if((0,e.alwaysValidSchema)(o,a)){i.fail();return}let l=n.name("valid");i.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},l),i.failResult(l,()=>i.reset(),()=>i.error())},error:{message:"must NOT be valid"}};t.default=r}),Yqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Kh(),r={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:e.validateUnion,error:{message:"must match a schema in anyOf"}};t.default=r}),Kqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i,n={message:"must match exactly one schema in oneOf",params:s(({params:u})=>(0,e._)(i||(i=je(["{passingSchemas: ","}"])),u.passing),"params")},a,o,l={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:n,code(u){let{gen:c,schema:p,parentSchema:m,it:y}=u;if(!Array.isArray(p))throw new Error("ajv implementation error");if(y.opts.discriminator&&m.discriminator)return;let v=p,x=c.let("valid",!1),E=c.let("passing",null),M=c.name("_valid");u.setParams({passing:E}),c.block(I),u.result(x,()=>u.reset(),()=>u.error(!0));function I(){v.forEach((P,C)=>{let T;(0,r.alwaysValidSchema)(y,P)?c.var(M,!0):T=u.subschema({keyword:"oneOf",schemaProp:C,compositeRule:!0},M),C>0&&c.if((0,e._)(a||(a=je([""," && ",""])),M,x)).assign(x,!1).assign(E,(0,e._)(o||(o=je(["[",", ","]"])),E,C)).else(),c.if(M,()=>{c.assign(x,!0),c.assign(E,C),T&&u.mergeEvaluated(T,e.Name)})})}s(I,"validateOneOf")}};t.default=l}),Jqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Fn(),r={keyword:"allOf",schemaType:"array",code(i){let{gen:n,schema:a,it:o}=i;if(!Array.isArray(a))throw new Error("ajv implementation error");let l=n.name("valid");a.forEach((u,c)=>{if((0,e.alwaysValidSchema)(o,u))return;let p=i.subschema({keyword:"allOf",schemaProp:c},l);i.ok(l),i.mergeEvaluated(p)})}};t.default=r}),Qqe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=Fn(),i,n,a={message:s(({params:c})=>(0,e.str)(i||(i=je(['must match "','" schema'])),c.ifClause),"message"),params:s(({params:c})=>(0,e._)(n||(n=je(["{failingKeyword: ","}"])),c.ifClause),"params")},o,l={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:a,code(c){let{gen:p,parentSchema:m,it:y}=c;m.then===void 0&&m.else===void 0&&(0,r.checkStrictMode)(y,'"if" without "then" and "else" is ignored');let v=u(y,"then"),x=u(y,"else");if(!v&&!x)return;let E=p.let("valid",!0),M=p.name("_valid");if(I(),c.reset(),v&&x){let C=p.let("ifClause");c.setParams({ifClause:C}),p.if(M,P("then",C),P("else",C))}else v?p.if(M,P("then")):p.if((0,e.not)(M),P("else"));c.pass(E,()=>c.error(!0));function I(){let C=c.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},M);c.mergeEvaluated(C)}s(I,"validateIf");function P(C,T){return()=>{let D=c.subschema({keyword:C},M);p.assign(E,M),c.mergeValidEvaluated(D,E),T?p.assign(T,(0,e._)(o||(o=je(["",""])),C)):c.setParams({ifClause:C})}}s(P,"validateClause")}};function u(c,p){let m=c.schema[p];return m!==void 0&&!(0,r.alwaysValidSchema)(c,m)}s(u,"hasSchema"),t.default=l}),eWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Fn(),r={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:i,parentSchema:n,it:a}){n.if===void 0&&(0,e.checkStrictMode)(a,'"'.concat(i,'" without "if" is ignored'))}};t.default=r}),tWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=iye(),r=jqe(),i=nye(),n=$qe(),a=Gqe(),o=Hqe(),l=qqe(),u=aye(),c=Wqe(),p=Xqe(),m=Zqe(),y=Yqe(),v=Kqe(),x=Jqe(),E=Qqe(),M=eWe();function I(P=!1){let C=[m.default,y.default,v.default,x.default,E.default,M.default,l.default,u.default,o.default,c.default,p.default];return P?C.push(r.default,n.default):C.push(e.default,i.default),C.push(a.default),C}s(I,"getApplicator"),t.default=I}),rWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r,i,n={message:s(({schemaCode:D})=>(0,e.str)(r||(r=je(['must match format "','"'])),D),"message"),params:s(({schemaCode:D})=>(0,e._)(i||(i=je(["{format: ","}"])),D),"params")},a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:n,code(D,F){let{gen:k,data:B,$data:U,schema:z,schemaCode:q,it:Z}=D,{opts:Q,errSchemaPath:V,schemaEnv:ae,self:Y}=Z;if(!Q.validateFormats)return;U?he():J();function he(){let ne=k.scopeValue("formats",{ref:Y.formats,code:Q.code.formats}),ee=k.const("fDef",(0,e._)(a||(a=je(["","[","]"])),ne,q)),ue=k.let("fType"),K=k.let("format");k.if((0,e._)(o||(o=je(["typeof ",' == "object" && !('," instanceof RegExp)"])),ee,ee),()=>k.assign(ue,(0,e._)(l||(l=je(["",'.type || "string"'])),ee)).assign(K,(0,e._)(u||(u=je(["",".validate"])),ee)),()=>k.assign(ue,(0,e._)(c||(c=je(['"string"'])))).assign(K,ee)),D.fail$data((0,e.or)(ce(),re()));function ce(){return Q.strictSchema===!1?e.nil:(0,e._)(p||(p=je([""," && !",""])),q,K)}s(ce,"unknownFmt");function re(){let se=ae.$async?(0,e._)(m||(m=je(["(",".async ? await ","(",") : ","(","))"])),ee,K,B,K,B):(0,e._)(y||(y=je(["","(",")"])),K,B),de=(0,e._)(v||(v=je(["(typeof ",' == "function" ? '," : ",".test(","))"])),K,se,K,B);return(0,e._)(x||(x=je([""," && "," !== true && "," === "," && !",""])),K,K,ue,F,de)}s(re,"invalidFmt")}s(he,"validate$DataFormat");function J(){let ne=Y.formats[z];if(!ne){ce();return}if(ne===!0)return;let[ee,ue,K]=re(ne);ee===F&&D.pass(se());function ce(){if(Q.strictSchema===!1){Y.logger.warn(de());return}throw new Error(de());function de(){return'unknown format "'.concat(z,'" ignored in schema at path "').concat(V,'"')}}s(ce,"unknownFormat");function re(de){let we=de instanceof RegExp?(0,e.regexpCode)(de):Q.code.formats?(0,e._)(E||(E=je(["","",""])),Q.code.formats,(0,e.getProperty)(z)):void 0,Le=k.scopeValue("formats",{key:z,ref:de,code:we});return typeof de=="object"&&!(de instanceof RegExp)?[de.type||"string",de.validate,(0,e._)(M||(M=je(["",".validate"])),Le)]:["string",de,Le]}s(re,"getFormat");function se(){if(typeof ne=="object"&&!(ne instanceof RegExp)&&ne.async){if(!ae.$async)throw new Error("async format in sync schema");return(0,e._)(I||(I=je(["await ","(",")"])),K,B)}return typeof ue=="function"?(0,e._)(P||(P=je(["","(",")"])),K,B):(0,e._)(C||(C=je(["",".test(",")"])),K,B)}s(se,"validCondition")}s(J,"validateFormat")}};t.default=T}),iWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=rWe(),r=[e.default];t.default=r}),nWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]}),aWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=Tqe(),r=Vqe(),i=tWe(),n=iWe(),a=nWe(),o=[e.default,r.default,(0,i.default)(),n.default,a.metadataVocabulary,a.contentVocabulary];t.default=o}),oWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0;var e;(function(r){r.Tag="tag",r.Mapping="mapping"})(e||(t.DiscrError=e={}))}),sWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var e=an(),r=oWe(),i=ez(),n=HP(),a=Fn(),o,l={message:s(({params:{discrError:y,tagName:v}})=>y===r.DiscrError.Tag?'tag "'.concat(v,'" must be string'):'value of tag "'.concat(v,'" must be in oneOf'),"message"),params:s(({params:{discrError:y,tag:v,tagName:x}})=>(0,e._)(o||(o=je(["{error: ",", tag: ",", tagValue: ","}"])),y,x,v),"params")},u,c,p,m={keyword:"discriminator",type:"object",schemaType:"object",error:l,code(y){let{gen:v,data:x,schema:E,parentSchema:M,it:I}=y,{oneOf:P}=M;if(!I.opts.discriminator)throw new Error("discriminator: requires discriminator option");let C=E.propertyName;if(typeof C!="string")throw new Error("discriminator: requires propertyName");if(E.mapping)throw new Error("discriminator: mapping is not supported");if(!P)throw new Error("discriminator: requires oneOf keyword");let T=v.let("valid",!1),D=v.const("tag",(0,e._)(u||(u=je(["","",""])),x,(0,e.getProperty)(C)));v.if((0,e._)(c||(c=je(["typeof ",' == "string"'])),D),()=>F(),()=>y.error(!1,{discrError:r.DiscrError.Tag,tag:D,tagName:C})),y.ok(T);function F(){let U=B();v.if(!1);for(let z in U)v.elseIf((0,e._)(p||(p=je([""," === ",""])),D,z)),v.assign(T,k(U[z]));v.else(),y.error(!1,{discrError:r.DiscrError.Mapping,tag:D,tagName:C}),v.endIf()}s(F,"validateMapping");function k(U){let z=v.name("valid"),q=y.subschema({keyword:"oneOf",schemaProp:U},z);return y.mergeEvaluated(q,e.Name),z}s(k,"applyTagSchema");function B(){var U;let z={},q=Q(M),Z=!0;for(let Y=0;Y<P.length;Y++){let he=P[Y];if(he!=null&&he.$ref&&!(0,a.schemaHasRulesButRef)(he,I.self.RULES)){let ne=he.$ref;if(he=i.resolveRef.call(I.self,I.schemaEnv.root,I.baseId,ne),he instanceof i.SchemaEnv&&(he=he.schema),he===void 0)throw new n.default(I.opts.uriResolver,I.baseId,ne)}let J=(U=he==null?void 0:he.properties)===null||U===void 0?void 0:U[C];if(typeof J!="object")throw new Error('discriminator: oneOf subschemas (or referenced schemas) must have "properties/'.concat(C,'"'));Z=Z&&(q||Q(he)),V(J,Y)}if(!Z)throw new Error('discriminator: "'.concat(C,'" must be required'));return z;function Q({required:Y}){return Array.isArray(Y)&&Y.includes(C)}function V(Y,he){if(Y.const)ae(Y.const,he);else if(Y.enum)for(let J of Y.enum)ae(J,he);else throw new Error('discriminator: "properties/'.concat(C,'" must have "const" or "enum"'))}function ae(Y,he){if(typeof Y!="string"||Y in z)throw new Error('discriminator: "'.concat(C,'" values must be unique strings'));z[Y]=he}}s(B,"getMapping")}};t.default=m}),lWe=bt((t,e)=>{e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}}),oye=bt((t,e)=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;var r=Eqe(),i=aWe(),n=sWe(),a=lWe(),o=["/properties"],l="http://json-schema.org/draft-07/schema",u=class extends r.default{_addVocabularies(){super._addVocabularies(),i.default.forEach(E=>this.addVocabulary(E)),this.opts.discriminator&&this.addKeyword(n.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let E=this.opts.$data?this.$dataMetaSchema(a,o):a;this.addMetaSchema(E,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}};s(u,"Ajv");var c=u;t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var p=GP();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:s(function(){return p.KeywordCxt},"get")});var m=an();Object.defineProperty(t,"_",{enumerable:!0,get:s(function(){return m._},"get")}),Object.defineProperty(t,"str",{enumerable:!0,get:s(function(){return m.str},"get")}),Object.defineProperty(t,"stringify",{enumerable:!0,get:s(function(){return m.stringify},"get")}),Object.defineProperty(t,"nil",{enumerable:!0,get:s(function(){return m.nil},"get")}),Object.defineProperty(t,"Name",{enumerable:!0,get:s(function(){return m.Name},"get")}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:s(function(){return m.CodeGen},"get")});var y=QB();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:s(function(){return y.default},"get")});var v=HP();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:s(function(){return v.default},"get")})}),uWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(U,z){return{validate:U,compare:z}}s(e,"fmtDef"),t.fullFormats={date:e(a,o),time:e(u,c),"date-time":e(m,y),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:E,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:new RegExp("^(?:https?|ftp):\\/\\/(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)(?:\\.(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$","iu"),email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:B,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:I,int32:{type:"number",validate:T},int64:{type:"number",validate:D},float:{type:"number",validate:F},double:{type:"number",validate:F},password:!0,binary:!0},t.fastFormats=vt(Ee({},t.fullFormats),{date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,y),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i}),t.formatNames=Object.keys(t.fullFormats);function r(U){return U%4===0&&(U%100!==0||U%400===0)}s(r,"isLeapYear");var i=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a(U){let z=i.exec(U);if(!z)return!1;let q=+z[1],Z=+z[2],Q=+z[3];return Z>=1&&Z<=12&&Q>=1&&Q<=(Z===2&&r(q)?29:n[Z])}s(a,"date");function o(U,z){if(U&&z)return U>z?1:U<z?-1:0}s(o,"compareDate");var l=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function u(U,z){let q=l.exec(U);if(!q)return!1;let Z=+q[1],Q=+q[2],V=+q[3],ae=q[5];return(Z<=23&&Q<=59&&V<=59||Z===23&&Q===59&&V===60)&&(!z||ae!=="")}s(u,"time");function c(U,z){if(!(U&&z))return;let q=l.exec(U),Z=l.exec(z);if(q&&Z)return U=q[1]+q[2]+q[3]+(q[4]||""),z=Z[1]+Z[2]+Z[3]+(Z[4]||""),U>z?1:U<z?-1:0}s(c,"compareTime");var p=/t|\s/i;function m(U){let z=U.split(p);return z.length===2&&a(z[0])&&u(z[1],!0)}s(m,"date_time");function y(U,z){if(!(U&&z))return;let[q,Z]=U.split(p),[Q,V]=z.split(p),ae=o(q,Q);if(ae!==void 0)return ae||c(Z,V)}s(y,"compareDateTime");var v=/\/|:/,x=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function E(U){return v.test(U)&&x.test(U)}s(E,"uri");var M=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function I(U){return M.lastIndex=0,M.test(U)}s(I,"byte");var P=-2147483648,C=2**31-1;function T(U){return Number.isInteger(U)&&U<=C&&U>=P}s(T,"validateInt32");function D(U){return Number.isInteger(U)}s(D,"validateInt64");function F(){return!0}s(F,"validateNumber");var k=/[^\\]\\Z/;function B(U){if(k.test(U))return!1;try{return new RegExp(U),!0}catch{return!1}}s(B,"regex")}),cWe=bt(t=>{N(),Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;var e=oye(),r=an(),i=r.operators,n={formatMaximum:{okStr:"<=",ok:i.LTE,fail:i.GT},formatMinimum:{okStr:">=",ok:i.GTE,fail:i.LT},formatExclusiveMaximum:{okStr:"<",ok:i.LT,fail:i.GTE},formatExclusiveMinimum:{okStr:">",ok:i.GT,fail:i.LTE}},a,o,l={message:s(({keyword:E,schemaCode:M})=>r.str(a||(a=je(["should be "," ",""])),n[E].okStr,M),"message"),params:s(({keyword:E,schemaCode:M})=>r._(o||(o=je(["{comparison: ",", limit: ","}"])),n[E].okStr,M),"params")},u,c,p,m,y,v;t.formatLimitDefinition={keyword:Object.keys(n),type:"string",schemaType:"string",$data:!0,error:l,code(E){let{gen:M,data:I,schemaCode:P,keyword:C,it:T}=E,{opts:D,self:F}=T;if(!D.validateFormats)return;let k=new e.KeywordCxt(T,F.RULES.all.format.definition,"format");k.$data?B():U();function B(){let q=M.scopeValue("formats",{ref:F.formats,code:D.code.formats}),Z=M.const("fmt",r._(u||(u=je(["","[","]"])),q,k.schemaCode));E.fail$data(r.or(r._(c||(c=je(["typeof ",' != "object"'])),Z),r._(p||(p=je([""," instanceof RegExp"])),Z),r._(m||(m=je(["typeof ",'.compare != "function"'])),Z),z(Z)))}s(B,"validate$DataFormat");function U(){let q=k.schema,Z=F.formats[q];if(!Z||Z===!0)return;if(typeof Z!="object"||Z instanceof RegExp||typeof Z.compare!="function")throw new Error('"'.concat(C,'": format "').concat(q,'" does not define "compare" function'));let Q=M.scopeValue("formats",{key:q,ref:Z,code:D.code.formats?r._(y||(y=je(["","",""])),D.code.formats,r.getProperty(q)):void 0});E.fail$data(z(Q))}s(U,"validateFormat");function z(q){return r._(v||(v=je(["",".compare(",", ",") "," 0"])),q,I,P,n[C].fail)}s(z,"compareCode")},dependencies:["format"]};var x=s(E=>(E.addKeyword(t.formatLimitDefinition),E),"formatLimitPlugin");t.default=x}),hWe=bt((t,e)=>{N(),Object.defineProperty(t,"__esModule",{value:!0});var r=uWe(),i=cWe(),n=an(),a=new n.Name("fullFormats"),o=new n.Name("fastFormats"),l=s((p,m={keywords:!0})=>{if(Array.isArray(m))return c(p,m,r.fullFormats,a),p;let[y,v]=m.mode==="fast"?[r.fastFormats,o]:[r.fullFormats,a],x=m.formats||r.formatNames;return c(p,x,y,v),m.keywords&&i.default(p),p},"formatsPlugin");l.get=(p,m="full")=>{let y=(m==="fast"?r.fastFormats:r.fullFormats)[p];if(!y)throw new Error('Unknown format "'.concat(p,'"'));return y};var u;function c(p,m,y,v){var x,E;(x=(E=p.opts.code).formats)!==null&&x!==void 0||(E.formats=n._(u||(u=je(['require("ajv-formats/dist/formats").',""])),v));for(let M of m)p.addFormat(M,y[M])}s(c,"addFormats"),e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l}),pWe=bt((t,e)=>{N();var r=A9();r.default&&(r=r.default),e.exports=i,e.exports.default=i;function i(c,p,m){p=p||1;for(var y,v,x,E,M=0;M<c[0].length;M++){var I=c[0][M];(!M||I[0]<y)&&(y=I[0]),(!M||I[1]<v)&&(v=I[1]),(!M||I[0]>x)&&(x=I[0]),(!M||I[1]>E)&&(E=I[1])}var P=x-y,C=E-v,T=Math.min(P,C),D=T/2;if(T===0){var F=[y,v];return F.distance=0,F}for(var k=new r(void 0,n),B=y;B<x;B+=T)for(var U=v;U<E;U+=T)k.push(new a(B+D,U+D,D,c));var z=l(c),q=new a(y+P/2,v+C/2,0,c);q.d>z.d&&(z=q);for(var Z=k.length;k.length;){var Q=k.pop();Q.d>z.d&&(z=Q,m&&console.log("found best %d after %d probes",Math.round(1e4*Q.d)/1e4,Z)),!(Q.max-z.d<=p)&&(D=Q.h/2,k.push(new a(Q.x-D,Q.y-D,D,c)),k.push(new a(Q.x+D,Q.y-D,D,c)),k.push(new a(Q.x-D,Q.y+D,D,c)),k.push(new a(Q.x+D,Q.y+D,D,c)),Z+=4)}m&&(console.log("num probes: "+Z),console.log("best distance: "+z.d));var V=[z.x,z.y];return V.distance=z.d,V}s(i,"polylabel");function n(c,p){return p.max-c.max}s(n,"compareMax");function a(c,p,m,y){this.x=c,this.y=p,this.h=m,this.d=o(c,p,y),this.max=this.d+this.h*Math.SQRT2}s(a,"Cell");function o(c,p,m){for(var y=!1,v=1/0,x=0;x<m.length;x++)for(var E=m[x],M=0,I=E.length,P=I-1;M<I;P=M++){var C=E[M],T=E[P];C[1]>p!=T[1]>p&&c<(T[0]-C[0])*(p-C[1])/(T[1]-C[1])+C[0]&&(y=!y),v=Math.min(v,u(c,p,C,T))}return v===0?0:(y?1:-1)*Math.sqrt(v)}s(o,"pointToPolygonDist");function l(c){for(var p=0,m=0,y=0,v=c[0],x=0,E=v.length,M=E-1;x<E;M=x++){var I=v[x],P=v[M],C=I[0]*P[1]-P[0]*I[1];m+=(I[0]+P[0])*C,y+=(I[1]+P[1])*C,p+=C*3}return p===0?new a(v[0][0],v[0][1],0,c):new a(m/p,y/p,0,c)}s(l,"getCentroidCell");function u(c,p,m,y){var v=m[0],x=m[1],E=y[0]-v,M=y[1]-x;if(E!==0||M!==0){var I=((c-v)*E+(p-x)*M)/(E*E+M*M);I>1?(v=y[0],x=y[1]):I>0&&(v+=E*I,x+=M*I)}return E=c-v,M=p-x,E*E+M*M}s(u,"getSegDistSq")}),sye=bt((t,e)=>{N();var r=200,i="__lodash_hash_undefined__",n=800,a=16,o=9007199254740991,l="[object Arguments]",u="[object Array]",c="[object AsyncFunction]",p="[object Boolean]",m="[object Date]",y="[object Error]",v="[object Function]",x="[object GeneratorFunction]",E="[object Map]",M="[object Number]",I="[object Null]",P="[object Object]",C="[object Proxy]",T="[object RegExp]",D="[object Set]",F="[object String]",k="[object Undefined]",B="[object WeakMap]",U="[object ArrayBuffer]",z="[object DataView]",q="[object Float32Array]",Z="[object Float64Array]",Q="[object Int8Array]",V="[object Int16Array]",ae="[object Int32Array]",Y="[object Uint8Array]",he="[object Uint8ClampedArray]",J="[object Uint16Array]",ne="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,ue=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,ce={};ce[q]=ce[Z]=ce[Q]=ce[V]=ce[ae]=ce[Y]=ce[he]=ce[J]=ce[ne]=!0,ce[l]=ce[u]=ce[U]=ce[p]=ce[z]=ce[m]=ce[y]=ce[v]=ce[E]=ce[M]=ce[P]=ce[T]=ce[D]=ce[F]=ce[B]=!1;var re=typeof global=="object"&&global&&global.Object===Object&&global,se=typeof self=="object"&&self&&self.Object===Object&&self,de=re||se||Function("return this")(),we=typeof t=="object"&&t&&!t.nodeType&&t,Le=we&&typeof e=="object"&&e&&!e.nodeType&&e,fe=Le&&Le.exports===we,Re=fe&&re.process,me=function(){try{var Ve=Le&&Le.require&&Le.require("util").types;return Ve||Re&&Re.binding&&Re.binding("util")}catch{}}(),Ae=me&&me.isTypedArray;function Ue(Ve,et,xe){switch(xe.length){case 0:return Ve.call(et);case 1:return Ve.call(et,xe[0]);case 2:return Ve.call(et,xe[0],xe[1]);case 3:return Ve.call(et,xe[0],xe[1],xe[2])}return Ve.apply(et,xe)}s(Ue,"apply");function _e(Ve,et){for(var xe=-1,Ge=Array(Ve);++xe<Ve;)Ge[xe]=et(xe);return Ge}s(_e,"baseTimes");function lt(Ve){return function(et){return Ve(et)}}s(lt,"baseUnary");function tt(Ve,et){return Ve==null?void 0:Ve[et]}s(tt,"getValue");function We(Ve,et){return function(xe){return Ve(et(xe))}}s(We,"overArg");var at=Array.prototype,Lt=Function.prototype,dt=Object.prototype,Me=de["__core-js_shared__"],ve=Lt.toString,Ze=dt.hasOwnProperty,It=function(){var Ve=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return Ve?"Symbol(src)_1."+Ve:""}(),Rt=dt.toString,Et=ve.call(Object),pt=RegExp("^"+ve.call(Ze).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yt=fe?de.Buffer:void 0,Kt=de.Symbol,$t=de.Uint8Array,jt=Yt?Yt.allocUnsafe:void 0,Nt=We(Object.getPrototypeOf,Object),Fe=Object.create,Xe=dt.propertyIsEnumerable,ht=at.splice,rr=Kt?Kt.toStringTag:void 0,ar=function(){try{var Ve=Gr(Object,"defineProperty");return Ve({},"",{}),Ve}catch{}}(),zr=Yt?Yt.isBuffer:void 0,Qe=Math.max,er=Date.now,Oe=Gr(de,"Map"),oe=Gr(Object,"create"),le=function(){function Ve(){}return s(Ve,"object"),function(et){if(!vo(et))return{};if(Fe)return Fe(et);Ve.prototype=et;var xe=new Ve;return Ve.prototype=void 0,xe}}();function Se(Ve){var et=-1,xe=Ve==null?0:Ve.length;for(this.clear();++et<xe;){var Ge=Ve[et];this.set(Ge[0],Ge[1])}}s(Se,"Hash");function ze(){this.__data__=oe?oe(null):{},this.size=0}s(ze,"hashClear");function De(Ve){var et=this.has(Ve)&&delete this.__data__[Ve];return this.size-=et?1:0,et}s(De,"hashDelete");function yt(Ve){var et=this.__data__;if(oe){var xe=et[Ve];return xe===i?void 0:xe}return Ze.call(et,Ve)?et[Ve]:void 0}s(yt,"hashGet");function st(Ve){var et=this.__data__;return oe?et[Ve]!==void 0:Ze.call(et,Ve)}s(st,"hashHas");function kt(Ve,et){var xe=this.__data__;return this.size+=this.has(Ve)?0:1,xe[Ve]=oe&&et===void 0?i:et,this}s(kt,"hashSet"),Se.prototype.clear=ze,Se.prototype.delete=De,Se.prototype.get=yt,Se.prototype.has=st,Se.prototype.set=kt;function mt(Ve){var et=-1,xe=Ve==null?0:Ve.length;for(this.clear();++et<xe;){var Ge=Ve[et];this.set(Ge[0],Ge[1])}}s(mt,"ListCache");function Gt(){this.__data__=[],this.size=0}s(Gt,"listCacheClear");function ke(Ve){var et=this.__data__,xe=ft(et,Ve);if(xe<0)return!1;var Ge=et.length-1;return xe==Ge?et.pop():ht.call(et,xe,1),--this.size,!0}s(ke,"listCacheDelete");function $e(Ve){var et=this.__data__,xe=ft(et,Ve);return xe<0?void 0:et[xe][1]}s($e,"listCacheGet");function ot(Ve){return ft(this.__data__,Ve)>-1}s(ot,"listCacheHas");function Ft(Ve,et){var xe=this.__data__,Ge=ft(xe,Ve);return Ge<0?(++this.size,xe.push([Ve,et])):xe[Ge][1]=et,this}s(Ft,"listCacheSet"),mt.prototype.clear=Gt,mt.prototype.delete=ke,mt.prototype.get=$e,mt.prototype.has=ot,mt.prototype.set=Ft;function Ht(Ve){var et=-1,xe=Ve==null?0:Ve.length;for(this.clear();++et<xe;){var Ge=Ve[et];this.set(Ge[0],Ge[1])}}s(Ht,"MapCache");function fr(){this.size=0,this.__data__={hash:new Se,map:new(Oe||mt),string:new Se}}s(fr,"mapCacheClear");function nr(Ve){var et=Ui(this,Ve).delete(Ve);return this.size-=et?1:0,et}s(nr,"mapCacheDelete");function Zr(Ve){return Ui(this,Ve).get(Ve)}s(Zr,"mapCacheGet");function ni(Ve){return Ui(this,Ve).has(Ve)}s(ni,"mapCacheHas");function Yr(Ve,et){var xe=Ui(this,Ve),Ge=xe.size;return xe.set(Ve,et),this.size+=xe.size==Ge?0:1,this}s(Yr,"mapCacheSet"),Ht.prototype.clear=fr,Ht.prototype.delete=nr,Ht.prototype.get=Zr,Ht.prototype.has=ni,Ht.prototype.set=Yr;function Cr(Ve){var et=this.__data__=new mt(Ve);this.size=et.size}s(Cr,"Stack");function Mi(){this.__data__=new mt,this.size=0}s(Mi,"stackClear");function $r(Ve){var et=this.__data__,xe=et.delete(Ve);return this.size=et.size,xe}s($r,"stackDelete");function Qi(Ve){return this.__data__.get(Ve)}s(Qi,"stackGet");function Gi(Ve){return this.__data__.has(Ve)}s(Gi,"stackHas");function Mn(Ve,et){var xe=this.__data__;if(xe instanceof mt){var Ge=xe.__data__;if(!Oe||Ge.length<r-1)return Ge.push([Ve,et]),this.size=++xe.size,this;xe=this.__data__=new Ht(Ge)}return xe.set(Ve,et),this.size=xe.size,this}s(Mn,"stackSet"),Cr.prototype.clear=Mi,Cr.prototype.delete=$r,Cr.prototype.get=Qi,Cr.prototype.has=Gi,Cr.prototype.set=Mn;function Ie(Ve,et){var xe=on(Ve),Ge=!xe&&Er(Ve),nt=!xe&&!Ge&&Bl(Ve),Wt=!xe&&!Ge&&!nt&&hl(Ve),Nr=xe||Ge||nt||Wt,Dr=Nr?_e(Ve.length,String):[],ui=Dr.length;for(var mi in Ve)(et||Ze.call(Ve,mi))&&!(Nr&&(mi=="length"||nt&&(mi=="offset"||mi=="parent")||Wt&&(mi=="buffer"||mi=="byteLength"||mi=="byteOffset")||j(mi,ui)))&&Dr.push(mi);return Dr}s(Ie,"arrayLikeKeys");function Je(Ve,et,xe){(xe!==void 0&&!lr(Ve[et],xe)||xe===void 0&&!(et in Ve))&&rt(Ve,et,xe)}s(Je,"assignMergeValue");function wt(Ve,et,xe){var Ge=Ve[et];(!(Ze.call(Ve,et)&&lr(Ge,xe))||xe===void 0&&!(et in Ve))&&rt(Ve,et,xe)}s(wt,"assignValue");function ft(Ve,et){for(var xe=Ve.length;xe--;)if(lr(Ve[xe][0],et))return xe;return-1}s(ft,"assocIndexOf");function rt(Ve,et,xe){et=="__proto__"&&ar?ar(Ve,et,{configurable:!0,enumerable:!0,value:xe,writable:!0}):Ve[et]=xe}s(rt,"baseAssignValue");var zt=ea();function cr(Ve){return Ve==null?Ve===void 0?k:I:rr&&rr in Object(Ve)?S(Ve):ct(Ve)}s(cr,"baseGetTag");function ur(Ve){return ki(Ve)&&cr(Ve)==l}s(ur,"baseIsArguments");function Ar(Ve){if(!vo(Ve)||be(Ve))return!1;var et=sa(Ve)?pt:ue;return et.test(xr(Ve))}s(Ar,"baseIsNative");function kr(Ve){return ki(Ve)&&li(Ve.length)&&!!ce[cr(Ve)]}s(kr,"baseIsTypedArray");function qr(Ve){if(!vo(Ve))return Te(Ve);var et=Ce(Ve),xe=[];for(var Ge in Ve)Ge=="constructor"&&(et||!Ze.call(Ve,Ge))||xe.push(Ge);return xe}s(qr,"baseKeysIn");function Wr(Ve,et,xe,Ge,nt){Ve!==et&&zt(et,function(Wt,Nr){if(nt||(nt=new Cr),vo(Wt))vi(Ve,et,Nr,xe,Wr,Ge,nt);else{var Dr=Ge?Ge(qt(Ve,Nr),Wt,Nr+"",Ve,et,nt):void 0;Dr===void 0&&(Dr=Wt),Je(Ve,Nr,Dr)}},Ia)}s(Wr,"baseMerge");function vi(Ve,et,xe,Ge,nt,Wt,Nr){var Dr=qt(Ve,xe),ui=qt(et,xe),mi=Nr.get(ui);if(mi){Je(Ve,xe,mi);return}var Ni=Wt?Wt(Dr,ui,xe+"",Ve,et,Nr):void 0,un=Ni===void 0;if(un){var Un=on(ui),Wn=!Un&&Bl(ui),pl=!Un&&!Wn&&hl(ui);Ni=ui,Un||Wn||pl?on(Dr)?Ni=Dr:sn(Dr)?Ni=Vr(Dr):Wn?(un=!1,Ni=yi(ui,!0)):pl?(un=!1,Ni=Xr(ui,!0)):Ni=[]:_o(ui)||Er(ui)?(Ni=Dr,Er(Dr)?Ni=ln(Dr):(!vo(Dr)||sa(Dr))&&(Ni=O(ui))):un=!1}un&&(Nr.set(ui,Ni),nt(Ni,ui,Ge,Wt,Nr),Nr.delete(ui)),Je(Ve,xe,Ni)}s(vi,"baseMergeDeep");function Li(Ve,et){return sr(_t(Ve,et,gs),Ve+"")}s(Li,"baseRest");var Ur=ar?function(Ve,et){return ar(Ve,"toString",{configurable:!0,enumerable:!1,value:Oa(et),writable:!0})}:gs;function yi(Ve,et){if(et)return Ve.slice();var xe=Ve.length,Ge=jt?jt(xe):new Ve.constructor(xe);return Ve.copy(Ge),Ge}s(yi,"cloneBuffer");function bi(Ve){var et=new Ve.constructor(Ve.byteLength);return new $t(et).set(new $t(Ve)),et}s(bi,"cloneArrayBuffer");function Xr(Ve,et){var xe=et?bi(Ve.buffer):Ve.buffer;return new Ve.constructor(xe,Ve.byteOffset,Ve.length)}s(Xr,"cloneTypedArray");function Vr(Ve,et){var xe=-1,Ge=Ve.length;for(et||(et=Array(Ge));++xe<Ge;)et[xe]=Ve[xe];return et}s(Vr,"copyArray");function si(Ve,et,xe,Ge){var nt=!xe;xe||(xe={});for(var Wt=-1,Nr=et.length;++Wt<Nr;){var Dr=et[Wt],ui=Ge?Ge(xe[Dr],Ve[Dr],Dr,xe,Ve):void 0;ui===void 0&&(ui=Ve[Dr]),nt?rt(xe,Dr,ui):wt(xe,Dr,ui)}return xe}s(si,"copyObject");function oa(Ve){return Li(function(et,xe){var Ge=-1,nt=xe.length,Wt=nt>1?xe[nt-1]:void 0,Nr=nt>2?xe[2]:void 0;for(Wt=Ve.length>3&&typeof Wt=="function"?(nt--,Wt):void 0,Nr&&X(xe[0],xe[1],Nr)&&(Wt=nt<3?void 0:Wt,nt=1),et=Object(et);++Ge<nt;){var Dr=xe[Ge];Dr&&Ve(et,Dr,Ge,Wt)}return et})}s(oa,"createAssigner");function ea(Ve){return function(et,xe,Ge){for(var nt=-1,Wt=Object(et),Nr=Ge(et),Dr=Nr.length;Dr--;){var ui=Nr[Ve?Dr:++nt];if(xe(Wt[ui],ui,Wt)===!1)break}return et}}s(ea,"createBaseFor");function Ui(Ve,et){var xe=Ve.__data__;return ie(et)?xe[typeof et=="string"?"string":"hash"]:xe.map}s(Ui,"getMapData");function Gr(Ve,et){var xe=tt(Ve,et);return Ar(xe)?xe:void 0}s(Gr,"getNative");function S(Ve){var et=Ze.call(Ve,rr),xe=Ve[rr];try{Ve[rr]=void 0;var Ge=!0}catch{}var nt=Rt.call(Ve);return Ge&&(et?Ve[rr]=xe:delete Ve[rr]),nt}s(S,"getRawTag");function O(Ve){return typeof Ve.constructor=="function"&&!Ce(Ve)?le(Nt(Ve)):{}}s(O,"initCloneObject");function j(Ve,et){var xe=typeof Ve;return et=et??o,!!et&&(xe=="number"||xe!="symbol"&&K.test(Ve))&&Ve>-1&&Ve%1==0&&Ve<et}s(j,"isIndex");function X(Ve,et,xe){if(!vo(xe))return!1;var Ge=typeof et;return(Ge=="number"?ta(xe)&&j(et,xe.length):Ge=="string"&&et in xe)?lr(xe[et],Ve):!1}s(X,"isIterateeCall");function ie(Ve){var et=typeof Ve;return et=="string"||et=="number"||et=="symbol"||et=="boolean"?Ve!=="__proto__":Ve===null}s(ie,"isKeyable");function be(Ve){return!!It&&It in Ve}s(be,"isMasked");function Ce(Ve){var et=Ve&&Ve.constructor,xe=typeof et=="function"&&et.prototype||dt;return Ve===xe}s(Ce,"isPrototype");function Te(Ve){var et=[];if(Ve!=null)for(var xe in Object(Ve))et.push(xe);return et}s(Te,"nativeKeysIn");function ct(Ve){return Rt.call(Ve)}s(ct,"objectToString");function _t(Ve,et,xe){return et=Qe(et===void 0?Ve.length-1:et,0),function(){for(var Ge=arguments,nt=-1,Wt=Qe(Ge.length-et,0),Nr=Array(Wt);++nt<Wt;)Nr[nt]=Ge[et+nt];nt=-1;for(var Dr=Array(et+1);++nt<et;)Dr[nt]=Ge[nt];return Dr[et]=xe(Nr),Ue(Ve,this,Dr)}}s(_t,"overRest");function qt(Ve,et){if(!(et==="constructor"&&typeof Ve[et]=="function")&&et!="__proto__")return Ve[et]}s(qt,"safeGet");var sr=mr(Ur);function mr(Ve){var et=0,xe=0;return function(){var Ge=er(),nt=a-(Ge-xe);if(xe=Ge,nt>0){if(++et>=n)return arguments[0]}else et=0;return Ve.apply(void 0,arguments)}}s(mr,"shortOut");function xr(Ve){if(Ve!=null){try{return ve.call(Ve)}catch{}try{return Ve+""}catch{}}return""}s(xr,"toSource");function lr(Ve,et){return Ve===et||Ve!==Ve&&et!==et}s(lr,"eq");var Er=ur(function(){return arguments}())?ur:function(Ve){return ki(Ve)&&Ze.call(Ve,"callee")&&!Xe.call(Ve,"callee")},on=Array.isArray;function ta(Ve){return Ve!=null&&li(Ve.length)&&!sa(Ve)}s(ta,"isArrayLike");function sn(Ve){return ki(Ve)&&ta(Ve)}s(sn,"isArrayLikeObject");var Bl=zr||qn;function sa(Ve){if(!vo(Ve))return!1;var et=cr(Ve);return et==v||et==x||et==c||et==C}s(sa,"isFunction");function li(Ve){return typeof Ve=="number"&&Ve>-1&&Ve%1==0&&Ve<=o}s(li,"isLength");function vo(Ve){var et=typeof Ve;return Ve!=null&&(et=="object"||et=="function")}s(vo,"isObject");function ki(Ve){return Ve!=null&&typeof Ve=="object"}s(ki,"isObjectLike");function _o(Ve){if(!ki(Ve)||cr(Ve)!=P)return!1;var et=Nt(Ve);if(et===null)return!0;var xe=Ze.call(et,"constructor")&&et.constructor;return typeof xe=="function"&&xe instanceof xe&&ve.call(xe)==Et}s(_o,"isPlainObject");var hl=Ae?lt(Ae):kr;function ln(Ve){return si(Ve,Ia(Ve))}s(ln,"toPlainObject");function Ia(Ve){return ta(Ve)?Ie(Ve,!0):qr(Ve)}s(Ia,"keysIn");var zl=oa(function(Ve,et,xe){Wr(Ve,et,xe)});function Oa(Ve){return function(){return Ve}}s(Oa,"constant");function gs(Ve){return Ve}s(gs,"identity");function qn(){return!1}s(qn,"stubFalse"),e.exports=zl}),lye=bt((t,e)=>{N();var r=200,i="__lodash_hash_undefined__",n=800,a=16,o=9007199254740991,l="[object Arguments]",u="[object Array]",c="[object AsyncFunction]",p="[object Boolean]",m="[object Date]",y="[object Error]",v="[object Function]",x="[object GeneratorFunction]",E="[object Map]",M="[object Number]",I="[object Null]",P="[object Object]",C="[object Proxy]",T="[object RegExp]",D="[object Set]",F="[object String]",k="[object Undefined]",B="[object WeakMap]",U="[object ArrayBuffer]",z="[object DataView]",q="[object Float32Array]",Z="[object Float64Array]",Q="[object Int8Array]",V="[object Int16Array]",ae="[object Int32Array]",Y="[object Uint8Array]",he="[object Uint8ClampedArray]",J="[object Uint16Array]",ne="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,ue=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,ce={};ce[q]=ce[Z]=ce[Q]=ce[V]=ce[ae]=ce[Y]=ce[he]=ce[J]=ce[ne]=!0,ce[l]=ce[u]=ce[U]=ce[p]=ce[z]=ce[m]=ce[y]=ce[v]=ce[E]=ce[M]=ce[P]=ce[T]=ce[D]=ce[F]=ce[B]=!1;var re=typeof global=="object"&&global&&global.Object===Object&&global,se=typeof self=="object"&&self&&self.Object===Object&&self,de=re||se||Function("return this")(),we=typeof t=="object"&&t&&!t.nodeType&&t,Le=we&&typeof e=="object"&&e&&!e.nodeType&&e,fe=Le&&Le.exports===we,Re=fe&&re.process,me=function(){try{var xe=Le&&Le.require&&Le.require("util").types;return xe||Re&&Re.binding&&Re.binding("util")}catch{}}(),Ae=me&&me.isTypedArray;function Ue(xe,Ge,nt){switch(nt.length){case 0:return xe.call(Ge);case 1:return xe.call(Ge,nt[0]);case 2:return xe.call(Ge,nt[0],nt[1]);case 3:return xe.call(Ge,nt[0],nt[1],nt[2])}return xe.apply(Ge,nt)}s(Ue,"apply");function _e(xe,Ge){for(var nt=-1,Wt=Array(xe);++nt<xe;)Wt[nt]=Ge(nt);return Wt}s(_e,"baseTimes");function lt(xe){return function(Ge){return xe(Ge)}}s(lt,"baseUnary");function tt(xe,Ge){return xe==null?void 0:xe[Ge]}s(tt,"getValue");function We(xe,Ge){return function(nt){return xe(Ge(nt))}}s(We,"overArg");var at=Array.prototype,Lt=Function.prototype,dt=Object.prototype,Me=de["__core-js_shared__"],ve=Lt.toString,Ze=dt.hasOwnProperty,It=function(){var xe=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return xe?"Symbol(src)_1."+xe:""}(),Rt=dt.toString,Et=ve.call(Object),pt=RegExp("^"+ve.call(Ze).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yt=fe?de.Buffer:void 0,Kt=de.Symbol,$t=de.Uint8Array,jt=Yt?Yt.allocUnsafe:void 0,Nt=We(Object.getPrototypeOf,Object),Fe=Object.create,Xe=dt.propertyIsEnumerable,ht=at.splice,rr=Kt?Kt.toStringTag:void 0,ar=function(){try{var xe=S(Object,"defineProperty");return xe({},"",{}),xe}catch{}}(),zr=Yt?Yt.isBuffer:void 0,Qe=Math.max,er=Date.now,Oe=S(de,"Map"),oe=S(Object,"create"),le=function(){function xe(){}return s(xe,"object"),function(Ge){if(!ki(Ge))return{};if(Fe)return Fe(Ge);xe.prototype=Ge;var nt=new xe;return xe.prototype=void 0,nt}}();function Se(xe){var Ge=-1,nt=xe==null?0:xe.length;for(this.clear();++Ge<nt;){var Wt=xe[Ge];this.set(Wt[0],Wt[1])}}s(Se,"Hash");function ze(){this.__data__=oe?oe(null):{},this.size=0}s(ze,"hashClear");function De(xe){var Ge=this.has(xe)&&delete this.__data__[xe];return this.size-=Ge?1:0,Ge}s(De,"hashDelete");function yt(xe){var Ge=this.__data__;if(oe){var nt=Ge[xe];return nt===i?void 0:nt}return Ze.call(Ge,xe)?Ge[xe]:void 0}s(yt,"hashGet");function st(xe){var Ge=this.__data__;return oe?Ge[xe]!==void 0:Ze.call(Ge,xe)}s(st,"hashHas");function kt(xe,Ge){var nt=this.__data__;return this.size+=this.has(xe)?0:1,nt[xe]=oe&&Ge===void 0?i:Ge,this}s(kt,"hashSet"),Se.prototype.clear=ze,Se.prototype.delete=De,Se.prototype.get=yt,Se.prototype.has=st,Se.prototype.set=kt;function mt(xe){var Ge=-1,nt=xe==null?0:xe.length;for(this.clear();++Ge<nt;){var Wt=xe[Ge];this.set(Wt[0],Wt[1])}}s(mt,"ListCache");function Gt(){this.__data__=[],this.size=0}s(Gt,"listCacheClear");function ke(xe){var Ge=this.__data__,nt=ft(Ge,xe);if(nt<0)return!1;var Wt=Ge.length-1;return nt==Wt?Ge.pop():ht.call(Ge,nt,1),--this.size,!0}s(ke,"listCacheDelete");function $e(xe){var Ge=this.__data__,nt=ft(Ge,xe);return nt<0?void 0:Ge[nt][1]}s($e,"listCacheGet");function ot(xe){return ft(this.__data__,xe)>-1}s(ot,"listCacheHas");function Ft(xe,Ge){var nt=this.__data__,Wt=ft(nt,xe);return Wt<0?(++this.size,nt.push([xe,Ge])):nt[Wt][1]=Ge,this}s(Ft,"listCacheSet"),mt.prototype.clear=Gt,mt.prototype.delete=ke,mt.prototype.get=$e,mt.prototype.has=ot,mt.prototype.set=Ft;function Ht(xe){var Ge=-1,nt=xe==null?0:xe.length;for(this.clear();++Ge<nt;){var Wt=xe[Ge];this.set(Wt[0],Wt[1])}}s(Ht,"MapCache");function fr(){this.size=0,this.__data__={hash:new Se,map:new(Oe||mt),string:new Se}}s(fr,"mapCacheClear");function nr(xe){var Ge=Gr(this,xe).delete(xe);return this.size-=Ge?1:0,Ge}s(nr,"mapCacheDelete");function Zr(xe){return Gr(this,xe).get(xe)}s(Zr,"mapCacheGet");function ni(xe){return Gr(this,xe).has(xe)}s(ni,"mapCacheHas");function Yr(xe,Ge){var nt=Gr(this,xe),Wt=nt.size;return nt.set(xe,Ge),this.size+=nt.size==Wt?0:1,this}s(Yr,"mapCacheSet"),Ht.prototype.clear=fr,Ht.prototype.delete=nr,Ht.prototype.get=Zr,Ht.prototype.has=ni,Ht.prototype.set=Yr;function Cr(xe){var Ge=this.__data__=new mt(xe);this.size=Ge.size}s(Cr,"Stack");function Mi(){this.__data__=new mt,this.size=0}s(Mi,"stackClear");function $r(xe){var Ge=this.__data__,nt=Ge.delete(xe);return this.size=Ge.size,nt}s($r,"stackDelete");function Qi(xe){return this.__data__.get(xe)}s(Qi,"stackGet");function Gi(xe){return this.__data__.has(xe)}s(Gi,"stackHas");function Mn(xe,Ge){var nt=this.__data__;if(nt instanceof mt){var Wt=nt.__data__;if(!Oe||Wt.length<r-1)return Wt.push([xe,Ge]),this.size=++nt.size,this;nt=this.__data__=new Ht(Wt)}return nt.set(xe,Ge),this.size=nt.size,this}s(Mn,"stackSet"),Cr.prototype.clear=Mi,Cr.prototype.delete=$r,Cr.prototype.get=Qi,Cr.prototype.has=Gi,Cr.prototype.set=Mn;function Ie(xe,Ge){var nt=ta(xe),Wt=!nt&&on(xe),Nr=!nt&&!Wt&&sa(xe),Dr=!nt&&!Wt&&!Nr&&ln(xe),ui=nt||Wt||Nr||Dr,mi=ui?_e(xe.length,String):[],Ni=mi.length;for(var un in xe)(Ge||Ze.call(xe,un))&&!(ui&&(un=="length"||Nr&&(un=="offset"||un=="parent")||Dr&&(un=="buffer"||un=="byteLength"||un=="byteOffset")||X(un,Ni)))&&mi.push(un);return mi}s(Ie,"arrayLikeKeys");function Je(xe,Ge,nt){(nt!==void 0&&!Er(xe[Ge],nt)||nt===void 0&&!(Ge in xe))&&rt(xe,Ge,nt)}s(Je,"assignMergeValue");function wt(xe,Ge,nt){var Wt=xe[Ge];(!(Ze.call(xe,Ge)&&Er(Wt,nt))||nt===void 0&&!(Ge in xe))&&rt(xe,Ge,nt)}s(wt,"assignValue");function ft(xe,Ge){for(var nt=xe.length;nt--;)if(Er(xe[nt][0],Ge))return nt;return-1}s(ft,"assocIndexOf");function rt(xe,Ge,nt){Ge=="__proto__"&&ar?ar(xe,Ge,{configurable:!0,enumerable:!0,value:nt,writable:!0}):xe[Ge]=nt}s(rt,"baseAssignValue");var zt=ea();function cr(xe){return xe==null?xe===void 0?k:I:rr&&rr in Object(xe)?O(xe):_t(xe)}s(cr,"baseGetTag");function ur(xe){return _o(xe)&&cr(xe)==l}s(ur,"baseIsArguments");function Ar(xe){if(!ki(xe)||Ce(xe))return!1;var Ge=li(xe)?pt:ue;return Ge.test(lr(xe))}s(Ar,"baseIsNative");function kr(xe){return _o(xe)&&vo(xe.length)&&!!ce[cr(xe)]}s(kr,"baseIsTypedArray");function qr(xe){if(!ki(xe))return ct(xe);var Ge=Te(xe),nt=[];for(var Wt in xe)Wt=="constructor"&&(Ge||!Ze.call(xe,Wt))||nt.push(Wt);return nt}s(qr,"baseKeysIn");function Wr(xe,Ge,nt,Wt,Nr){xe!==Ge&&zt(Ge,function(Dr,ui){if(Nr||(Nr=new Cr),ki(Dr))vi(xe,Ge,ui,nt,Wr,Wt,Nr);else{var mi=Wt?Wt(sr(xe,ui),Dr,ui+"",xe,Ge,Nr):void 0;mi===void 0&&(mi=Dr),Je(xe,ui,mi)}},Oa)}s(Wr,"baseMerge");function vi(xe,Ge,nt,Wt,Nr,Dr,ui){var mi=sr(xe,nt),Ni=sr(Ge,nt),un=ui.get(Ni);if(un){Je(xe,nt,un);return}var Un=Dr?Dr(mi,Ni,nt+"",xe,Ge,ui):void 0,Wn=Un===void 0;if(Wn){var pl=ta(Ni),qs=!pl&&sa(Ni),ip=!pl&&!qs&&ln(Ni);Un=Ni,pl||qs||ip?ta(mi)?Un=mi:Bl(mi)?Un=Vr(mi):qs?(Wn=!1,Un=yi(Ni,!0)):ip?(Wn=!1,Un=Xr(Ni,!0)):Un=[]:hl(Ni)||on(Ni)?(Un=mi,on(mi)?Un=Ia(mi):(!ki(mi)||li(mi))&&(Un=j(Ni))):Wn=!1}Wn&&(ui.set(Ni,Un),Nr(Un,Ni,Wt,Dr,ui),ui.delete(Ni)),Je(xe,nt,Un)}s(vi,"baseMergeDeep");function Li(xe,Ge){return mr(qt(xe,Ge,Ve),xe+"")}s(Li,"baseRest");var Ur=ar?function(xe,Ge){return ar(xe,"toString",{configurable:!0,enumerable:!1,value:qn(Ge),writable:!0})}:Ve;function yi(xe,Ge){if(Ge)return xe.slice();var nt=xe.length,Wt=jt?jt(nt):new xe.constructor(nt);return xe.copy(Wt),Wt}s(yi,"cloneBuffer");function bi(xe){var Ge=new xe.constructor(xe.byteLength);return new $t(Ge).set(new $t(xe)),Ge}s(bi,"cloneArrayBuffer");function Xr(xe,Ge){var nt=Ge?bi(xe.buffer):xe.buffer;return new xe.constructor(nt,xe.byteOffset,xe.length)}s(Xr,"cloneTypedArray");function Vr(xe,Ge){var nt=-1,Wt=xe.length;for(Ge||(Ge=Array(Wt));++nt<Wt;)Ge[nt]=xe[nt];return Ge}s(Vr,"copyArray");function si(xe,Ge,nt,Wt){var Nr=!nt;nt||(nt={});for(var Dr=-1,ui=Ge.length;++Dr<ui;){var mi=Ge[Dr],Ni=Wt?Wt(nt[mi],xe[mi],mi,nt,xe):void 0;Ni===void 0&&(Ni=xe[mi]),Nr?rt(nt,mi,Ni):wt(nt,mi,Ni)}return nt}s(si,"copyObject");function oa(xe){return Li(function(Ge,nt){var Wt=-1,Nr=nt.length,Dr=Nr>1?nt[Nr-1]:void 0,ui=Nr>2?nt[2]:void 0;for(Dr=xe.length>3&&typeof Dr=="function"?(Nr--,Dr):void 0,ui&&ie(nt[0],nt[1],ui)&&(Dr=Nr<3?void 0:Dr,Nr=1),Ge=Object(Ge);++Wt<Nr;){var mi=nt[Wt];mi&&xe(Ge,mi,Wt,Dr)}return Ge})}s(oa,"createAssigner");function ea(xe){return function(Ge,nt,Wt){for(var Nr=-1,Dr=Object(Ge),ui=Wt(Ge),mi=ui.length;mi--;){var Ni=ui[xe?mi:++Nr];if(nt(Dr[Ni],Ni,Dr)===!1)break}return Ge}}s(ea,"createBaseFor");function Ui(xe,Ge,nt,Wt,Nr,Dr){return ki(xe)&&ki(Ge)&&(Dr.set(Ge,xe),Wr(xe,Ge,void 0,Ui,Dr),Dr.delete(Ge)),xe}s(Ui,"customDefaultsMerge");function Gr(xe,Ge){var nt=xe.__data__;return be(Ge)?nt[typeof Ge=="string"?"string":"hash"]:nt.map}s(Gr,"getMapData");function S(xe,Ge){var nt=tt(xe,Ge);return Ar(nt)?nt:void 0}s(S,"getNative");function O(xe){var Ge=Ze.call(xe,rr),nt=xe[rr];try{xe[rr]=void 0;var Wt=!0}catch{}var Nr=Rt.call(xe);return Wt&&(Ge?xe[rr]=nt:delete xe[rr]),Nr}s(O,"getRawTag");function j(xe){return typeof xe.constructor=="function"&&!Te(xe)?le(Nt(xe)):{}}s(j,"initCloneObject");function X(xe,Ge){var nt=typeof xe;return Ge=Ge??o,!!Ge&&(nt=="number"||nt!="symbol"&&K.test(xe))&&xe>-1&&xe%1==0&&xe<Ge}s(X,"isIndex");function ie(xe,Ge,nt){if(!ki(nt))return!1;var Wt=typeof Ge;return(Wt=="number"?sn(nt)&&X(Ge,nt.length):Wt=="string"&&Ge in nt)?Er(nt[Ge],xe):!1}s(ie,"isIterateeCall");function be(xe){var Ge=typeof xe;return Ge=="string"||Ge=="number"||Ge=="symbol"||Ge=="boolean"?xe!=="__proto__":xe===null}s(be,"isKeyable");function Ce(xe){return!!It&&It in xe}s(Ce,"isMasked");function Te(xe){var Ge=xe&&xe.constructor,nt=typeof Ge=="function"&&Ge.prototype||dt;return xe===nt}s(Te,"isPrototype");function ct(xe){var Ge=[];if(xe!=null)for(var nt in Object(xe))Ge.push(nt);return Ge}s(ct,"nativeKeysIn");function _t(xe){return Rt.call(xe)}s(_t,"objectToString");function qt(xe,Ge,nt){return Ge=Qe(Ge===void 0?xe.length-1:Ge,0),function(){for(var Wt=arguments,Nr=-1,Dr=Qe(Wt.length-Ge,0),ui=Array(Dr);++Nr<Dr;)ui[Nr]=Wt[Ge+Nr];Nr=-1;for(var mi=Array(Ge+1);++Nr<Ge;)mi[Nr]=Wt[Nr];return mi[Ge]=nt(ui),Ue(xe,this,mi)}}s(qt,"overRest");function sr(xe,Ge){if(!(Ge==="constructor"&&typeof xe[Ge]=="function")&&Ge!="__proto__")return xe[Ge]}s(sr,"safeGet");var mr=xr(Ur);function xr(xe){var Ge=0,nt=0;return function(){var Wt=er(),Nr=a-(Wt-nt);if(nt=Wt,Nr>0){if(++Ge>=n)return arguments[0]}else Ge=0;return xe.apply(void 0,arguments)}}s(xr,"shortOut");function lr(xe){if(xe!=null){try{return ve.call(xe)}catch{}try{return xe+""}catch{}}return""}s(lr,"toSource");function Er(xe,Ge){return xe===Ge||xe!==xe&&Ge!==Ge}s(Er,"eq");var on=ur(function(){return arguments}())?ur:function(xe){return _o(xe)&&Ze.call(xe,"callee")&&!Xe.call(xe,"callee")},ta=Array.isArray;function sn(xe){return xe!=null&&vo(xe.length)&&!li(xe)}s(sn,"isArrayLike");function Bl(xe){return _o(xe)&&sn(xe)}s(Bl,"isArrayLikeObject");var sa=zr||et;function li(xe){if(!ki(xe))return!1;var Ge=cr(xe);return Ge==v||Ge==x||Ge==c||Ge==C}s(li,"isFunction");function vo(xe){return typeof xe=="number"&&xe>-1&&xe%1==0&&xe<=o}s(vo,"isLength");function ki(xe){var Ge=typeof xe;return xe!=null&&(Ge=="object"||Ge=="function")}s(ki,"isObject");function _o(xe){return xe!=null&&typeof xe=="object"}s(_o,"isObjectLike");function hl(xe){if(!_o(xe)||cr(xe)!=P)return!1;var Ge=Nt(xe);if(Ge===null)return!0;var nt=Ze.call(Ge,"constructor")&&Ge.constructor;return typeof nt=="function"&&nt instanceof nt&&ve.call(nt)==Et}s(hl,"isPlainObject");var ln=Ae?lt(Ae):kr;function Ia(xe){return si(xe,Oa(xe))}s(Ia,"toPlainObject");var zl=Li(function(xe){return xe.push(void 0,Ui),Ue(gs,void 0,xe)});function Oa(xe){return sn(xe)?Ie(xe,!0):qr(xe)}s(Oa,"keysIn");var gs=oa(function(xe,Ge,nt,Wt){Wr(xe,Ge,nt,Wt)});function qn(xe){return function(){return xe}}s(qn,"constant");function Ve(xe){return xe}s(Ve,"identity");function et(){return!1}s(et,"stubFalse"),e.exports=zl}),dWe=bt((t,e)=>{N();var r=!1,i={},n=!1;typeof e<"u"&&e.exports?(e.exports=i,n=!0):typeof document<"u"?window.ClipperLib=i:self.ClipperLib=i;var a;n?(o="chrome",a="Netscape"):(o=navigator.userAgent.toString().toLowerCase(),a=navigator.appName);var o,l={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?l.chrome=1:l.chrome=0,o.indexOf("chromium")!=-1?l.chromium=1:l.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?l.safari=1:l.safari=0,o.indexOf("firefox")!=-1?l.firefox=1:l.firefox=0,o.indexOf("firefox/17")!=-1?l.firefox17=1:l.firefox17=0,o.indexOf("firefox/15")!=-1?l.firefox15=1:l.firefox15=0,o.indexOf("firefox/3")!=-1?l.firefox3=1:l.firefox3=0,o.indexOf("opera")!=-1?l.opera=1:l.opera=0,o.indexOf("msie 10")!=-1?l.msie10=1:l.msie10=0,o.indexOf("msie 9")!=-1?l.msie9=1:l.msie9=0,o.indexOf("msie 8")!=-1?l.msie8=1:l.msie8=0,o.indexOf("msie 7")!=-1?l.msie7=1:l.msie7=0,o.indexOf("msie ")!=-1?l.msie=1:l.msie=0,i.biginteger_used=null;var u;function c(S,O,j){i.biginteger_used=1,S!=null&&(typeof S=="number"&&typeof O>"u"?this.fromInt(S):typeof S=="number"?this.fromNumber(S,O,j):O==null&&typeof S!="string"?this.fromString(S,256):this.fromString(S,O))}s(c,"BigInteger");function p(){return new c(null)}s(p,"nbi");function m(S,O,j,X,ie,be){for(;--be>=0;){var Ce=O*this[S++]+j[X]+ie;ie=Math.floor(Ce/67108864),j[X++]=Ce&67108863}return ie}s(m,"am1");function y(S,O,j,X,ie,be){for(var Ce=O&32767,Te=O>>15;--be>=0;){var ct=this[S]&32767,_t=this[S++]>>15,qt=Te*ct+_t*Ce;ct=Ce*ct+((qt&32767)<<15)+j[X]+(ie&1073741823),ie=(ct>>>30)+(qt>>>15)+Te*_t+(ie>>>30),j[X++]=ct&1073741823}return ie}s(y,"am2");function v(S,O,j,X,ie,be){for(var Ce=O&16383,Te=O>>14;--be>=0;){var ct=this[S]&16383,_t=this[S++]>>14,qt=Te*ct+_t*Ce;ct=Ce*ct+((qt&16383)<<14)+j[X]+ie,ie=(ct>>28)+(qt>>14)+Te*_t,j[X++]=ct&268435455}return ie}s(v,"am3"),a=="Microsoft Internet Explorer"?(c.prototype.am=y,u=30):a!="Netscape"?(c.prototype.am=m,u=26):(c.prototype.am=v,u=28),c.prototype.DB=u,c.prototype.DM=(1<<u)-1,c.prototype.DV=1<<u;var x=52;c.prototype.FV=Math.pow(2,x),c.prototype.F1=x-u,c.prototype.F2=2*u-x;var E="0123456789abcdefghijklmnopqrstuvwxyz",M=new Array,I,P;for(I=48,P=0;P<=9;++P)M[I++]=P;for(I=97,P=10;P<36;++P)M[I++]=P;for(I=65,P=10;P<36;++P)M[I++]=P;function C(S){return E.charAt(S)}s(C,"int2char");function T(S,O){var j=M[S.charCodeAt(O)];return j??-1}s(T,"intAt");function D(S){for(var O=this.t-1;O>=0;--O)S[O]=this[O];S.t=this.t,S.s=this.s}s(D,"bnpCopyTo");function F(S){this.t=1,this.s=S<0?-1:0,S>0?this[0]=S:S<-1?this[0]=S+this.DV:this.t=0}s(F,"bnpFromInt");function k(S){var O=p();return O.fromInt(S),O}s(k,"nbv");function B(S,O){var j;if(O==16)j=4;else if(O==8)j=3;else if(O==256)j=8;else if(O==2)j=1;else if(O==32)j=5;else if(O==4)j=2;else{this.fromRadix(S,O);return}this.t=0,this.s=0;for(var X=S.length,ie=!1,be=0;--X>=0;){var Ce=j==8?S[X]&255:T(S,X);if(Ce<0){S.charAt(X)=="-"&&(ie=!0);continue}ie=!1,be==0?this[this.t++]=Ce:be+j>this.DB?(this[this.t-1]|=(Ce&(1<<this.DB-be)-1)<<be,this[this.t++]=Ce>>this.DB-be):this[this.t-1]|=Ce<<be,be+=j,be>=this.DB&&(be-=this.DB)}j==8&&(S[0]&128)!=0&&(this.s=-1,be>0&&(this[this.t-1]|=(1<<this.DB-be)-1<<be)),this.clamp(),ie&&c.ZERO.subTo(this,this)}s(B,"bnpFromString");function U(){for(var S=this.s&this.DM;this.t>0&&this[this.t-1]==S;)--this.t}s(U,"bnpClamp");function z(S){if(this.s<0)return"-"+this.negate().toString(S);var O;if(S==16)O=4;else if(S==8)O=3;else if(S==2)O=1;else if(S==32)O=5;else if(S==4)O=2;else return this.toRadix(S);var j=(1<<O)-1,X,ie=!1,be="",Ce=this.t,Te=this.DB-Ce*this.DB%O;if(Ce-- >0)for(Te<this.DB&&(X=this[Ce]>>Te)>0&&(ie=!0,be=C(X));Ce>=0;)Te<O?(X=(this[Ce]&(1<<Te)-1)<<O-Te,X|=this[--Ce]>>(Te+=this.DB-O)):(X=this[Ce]>>(Te-=O)&j,Te<=0&&(Te+=this.DB,--Ce)),X>0&&(ie=!0),ie&&(be+=C(X));return ie?be:"0"}s(z,"bnToString");function q(){var S=p();return c.ZERO.subTo(this,S),S}s(q,"bnNegate");function Z(){return this.s<0?this.negate():this}s(Z,"bnAbs");function Q(S){var O=this.s-S.s;if(O!=0)return O;var j=this.t;if(O=j-S.t,O!=0)return this.s<0?-O:O;for(;--j>=0;)if((O=this[j]-S[j])!=0)return O;return 0}s(Q,"bnCompareTo");function V(S){var O=1,j;return(j=S>>>16)!=0&&(S=j,O+=16),(j=S>>8)!=0&&(S=j,O+=8),(j=S>>4)!=0&&(S=j,O+=4),(j=S>>2)!=0&&(S=j,O+=2),(j=S>>1)!=0&&(S=j,O+=1),O}s(V,"nbits");function ae(){return this.t<=0?0:this.DB*(this.t-1)+V(this[this.t-1]^this.s&this.DM)}s(ae,"bnBitLength");function Y(S,O){var j;for(j=this.t-1;j>=0;--j)O[j+S]=this[j];for(j=S-1;j>=0;--j)O[j]=0;O.t=this.t+S,O.s=this.s}s(Y,"bnpDLShiftTo");function he(S,O){for(var j=S;j<this.t;++j)O[j-S]=this[j];O.t=Math.max(this.t-S,0),O.s=this.s}s(he,"bnpDRShiftTo");function J(S,O){var j=S%this.DB,X=this.DB-j,ie=(1<<X)-1,be=Math.floor(S/this.DB),Ce=this.s<<j&this.DM,Te;for(Te=this.t-1;Te>=0;--Te)O[Te+be+1]=this[Te]>>X|Ce,Ce=(this[Te]&ie)<<j;for(Te=be-1;Te>=0;--Te)O[Te]=0;O[be]=Ce,O.t=this.t+be+1,O.s=this.s,O.clamp()}s(J,"bnpLShiftTo");function ne(S,O){O.s=this.s;var j=Math.floor(S/this.DB);if(j>=this.t){O.t=0;return}var X=S%this.DB,ie=this.DB-X,be=(1<<X)-1;O[0]=this[j]>>X;for(var Ce=j+1;Ce<this.t;++Ce)O[Ce-j-1]|=(this[Ce]&be)<<ie,O[Ce-j]=this[Ce]>>X;X>0&&(O[this.t-j-1]|=(this.s&be)<<ie),O.t=this.t-j,O.clamp()}s(ne,"bnpRShiftTo");function ee(S,O){for(var j=0,X=0,ie=Math.min(S.t,this.t);j<ie;)X+=this[j]-S[j],O[j++]=X&this.DM,X>>=this.DB;if(S.t<this.t){for(X-=S.s;j<this.t;)X+=this[j],O[j++]=X&this.DM,X>>=this.DB;X+=this.s}else{for(X+=this.s;j<S.t;)X-=S[j],O[j++]=X&this.DM,X>>=this.DB;X-=S.s}O.s=X<0?-1:0,X<-1?O[j++]=this.DV+X:X>0&&(O[j++]=X),O.t=j,O.clamp()}s(ee,"bnpSubTo");function ue(S,O){var j=this.abs(),X=S.abs(),ie=j.t;for(O.t=ie+X.t;--ie>=0;)O[ie]=0;for(ie=0;ie<X.t;++ie)O[ie+j.t]=j.am(0,X[ie],O,ie,0,j.t);O.s=0,O.clamp(),this.s!=S.s&&c.ZERO.subTo(O,O)}s(ue,"bnpMultiplyTo");function K(S){for(var O=this.abs(),j=S.t=2*O.t;--j>=0;)S[j]=0;for(j=0;j<O.t-1;++j){var X=O.am(j,O[j],S,2*j,0,1);(S[j+O.t]+=O.am(j+1,2*O[j],S,2*j+1,X,O.t-j-1))>=O.DV&&(S[j+O.t]-=O.DV,S[j+O.t+1]=1)}S.t>0&&(S[S.t-1]+=O.am(j,O[j],S,2*j,0,1)),S.s=0,S.clamp()}s(K,"bnpSquareTo");function ce(S,O,j){var X=S.abs();if(!(X.t<=0)){var ie=this.abs();if(ie.t<X.t){O!=null&&O.fromInt(0),j!=null&&this.copyTo(j);return}j==null&&(j=p());var be=p(),Ce=this.s,Te=S.s,ct=this.DB-V(X[X.t-1]);ct>0?(X.lShiftTo(ct,be),ie.lShiftTo(ct,j)):(X.copyTo(be),ie.copyTo(j));var _t=be.t,qt=be[_t-1];if(qt!=0){var sr=qt*(1<<this.F1)+(_t>1?be[_t-2]>>this.F2:0),mr=this.FV/sr,xr=(1<<this.F1)/sr,lr=1<<this.F2,Er=j.t,on=Er-_t,ta=O??p();for(be.dlShiftTo(on,ta),j.compareTo(ta)>=0&&(j[j.t++]=1,j.subTo(ta,j)),c.ONE.dlShiftTo(_t,ta),ta.subTo(be,be);be.t<_t;)be[be.t++]=0;for(;--on>=0;){var sn=j[--Er]==qt?this.DM:Math.floor(j[Er]*mr+(j[Er-1]+lr)*xr);if((j[Er]+=be.am(0,sn,j,on,0,_t))<sn)for(be.dlShiftTo(on,ta),j.subTo(ta,j);j[Er]<--sn;)j.subTo(ta,j)}O!=null&&(j.drShiftTo(_t,O),Ce!=Te&&c.ZERO.subTo(O,O)),j.t=_t,j.clamp(),ct>0&&j.rShiftTo(ct,j),Ce<0&&c.ZERO.subTo(j,j)}}}s(ce,"bnpDivRemTo");function re(S){var O=p();return this.abs().divRemTo(S,null,O),this.s<0&&O.compareTo(c.ZERO)>0&&S.subTo(O,O),O}s(re,"bnMod");function se(S){this.m=S}s(se,"Classic");function de(S){return S.s<0||S.compareTo(this.m)>=0?S.mod(this.m):S}s(de,"cConvert");function we(S){return S}s(we,"cRevert");function Le(S){S.divRemTo(this.m,null,S)}s(Le,"cReduce");function fe(S,O,j){S.multiplyTo(O,j),this.reduce(j)}s(fe,"cMulTo");function Re(S,O){S.squareTo(O),this.reduce(O)}s(Re,"cSqrTo"),se.prototype.convert=de,se.prototype.revert=we,se.prototype.reduce=Le,se.prototype.mulTo=fe,se.prototype.sqrTo=Re;function me(){if(this.t<1)return 0;var S=this[0];if((S&1)==0)return 0;var O=S&3;return O=O*(2-(S&15)*O)&15,O=O*(2-(S&255)*O)&255,O=O*(2-((S&65535)*O&65535))&65535,O=O*(2-S*O%this.DV)%this.DV,O>0?this.DV-O:-O}s(me,"bnpInvDigit");function Ae(S){this.m=S,this.mp=S.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<S.DB-15)-1,this.mt2=2*S.t}s(Ae,"Montgomery");function Ue(S){var O=p();return S.abs().dlShiftTo(this.m.t,O),O.divRemTo(this.m,null,O),S.s<0&&O.compareTo(c.ZERO)>0&&this.m.subTo(O,O),O}s(Ue,"montConvert");function _e(S){var O=p();return S.copyTo(O),this.reduce(O),O}s(_e,"montRevert");function lt(S){for(;S.t<=this.mt2;)S[S.t++]=0;for(var O=0;O<this.m.t;++O){var j=S[O]&32767,X=j*this.mpl+((j*this.mph+(S[O]>>15)*this.mpl&this.um)<<15)&S.DM;for(j=O+this.m.t,S[j]+=this.m.am(0,X,S,O,0,this.m.t);S[j]>=S.DV;)S[j]-=S.DV,S[++j]++}S.clamp(),S.drShiftTo(this.m.t,S),S.compareTo(this.m)>=0&&S.subTo(this.m,S)}s(lt,"montReduce");function tt(S,O){S.squareTo(O),this.reduce(O)}s(tt,"montSqrTo");function We(S,O,j){S.multiplyTo(O,j),this.reduce(j)}s(We,"montMulTo"),Ae.prototype.convert=Ue,Ae.prototype.revert=_e,Ae.prototype.reduce=lt,Ae.prototype.mulTo=We,Ae.prototype.sqrTo=tt;function at(){return(this.t>0?this[0]&1:this.s)==0}s(at,"bnpIsEven");function Lt(S,O){if(S>4294967295||S<1)return c.ONE;var j=p(),X=p(),ie=O.convert(this),be=V(S)-1;for(ie.copyTo(j);--be>=0;)if(O.sqrTo(j,X),(S&1<<be)>0)O.mulTo(X,ie,j);else{var Ce=j;j=X,X=Ce}return O.revert(j)}s(Lt,"bnpExp");function dt(S,O){var j;return S<256||O.isEven()?j=new se(O):j=new Ae(O),this.exp(S,j)}s(dt,"bnModPowInt"),c.prototype.copyTo=D,c.prototype.fromInt=F,c.prototype.fromString=B,c.prototype.clamp=U,c.prototype.dlShiftTo=Y,c.prototype.drShiftTo=he,c.prototype.lShiftTo=J,c.prototype.rShiftTo=ne,c.prototype.subTo=ee,c.prototype.multiplyTo=ue,c.prototype.squareTo=K,c.prototype.divRemTo=ce,c.prototype.invDigit=me,c.prototype.isEven=at,c.prototype.exp=Lt,c.prototype.toString=z,c.prototype.negate=q,c.prototype.abs=Z,c.prototype.compareTo=Q,c.prototype.bitLength=ae,c.prototype.mod=re,c.prototype.modPowInt=dt,c.ZERO=k(0),c.ONE=k(1);function Me(){var S=p();return this.copyTo(S),S}s(Me,"bnClone");function ve(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}s(ve,"bnIntValue");function Ze(){return this.t==0?this.s:this[0]<<24>>24}s(Ze,"bnByteValue");function It(){return this.t==0?this.s:this[0]<<16>>16}s(It,"bnShortValue");function Rt(S){return Math.floor(Math.LN2*this.DB/Math.log(S))}s(Rt,"bnpChunkSize");function Et(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}s(Et,"bnSigNum");function pt(S){if(S==null&&(S=10),this.signum()==0||S<2||S>36)return"0";var O=this.chunkSize(S),j=Math.pow(S,O),X=k(j),ie=p(),be=p(),Ce="";for(this.divRemTo(X,ie,be);ie.signum()>0;)Ce=(j+be.intValue()).toString(S).substr(1)+Ce,ie.divRemTo(X,ie,be);return be.intValue().toString(S)+Ce}s(pt,"bnpToRadix");function Yt(S,O){this.fromInt(0),O==null&&(O=10);for(var j=this.chunkSize(O),X=Math.pow(O,j),ie=!1,be=0,Ce=0,Te=0;Te<S.length;++Te){var ct=T(S,Te);if(ct<0){S.charAt(Te)=="-"&&this.signum()==0&&(ie=!0);continue}Ce=O*Ce+ct,++be>=j&&(this.dMultiply(X),this.dAddOffset(Ce,0),be=0,Ce=0)}be>0&&(this.dMultiply(Math.pow(O,be)),this.dAddOffset(Ce,0)),ie&&c.ZERO.subTo(this,this)}s(Yt,"bnpFromRadix");function Kt(S,O,j){if(typeof O=="number")if(S<2)this.fromInt(1);else for(this.fromNumber(S,j),this.testBit(S-1)||this.bitwiseTo(c.ONE.shiftLeft(S-1),ar,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(O);)this.dAddOffset(2,0),this.bitLength()>S&&this.subTo(c.ONE.shiftLeft(S-1),this);else{var X=new Array,ie=S&7;X.length=(S>>3)+1,O.nextBytes(X),ie>0?X[0]&=(1<<ie)-1:X[0]=0,this.fromString(X,256)}}s(Kt,"bnpFromNumber");function $t(){var S=this.t,O=new Array;O[0]=this.s;var j=this.DB-S*this.DB%8,X,ie=0;if(S-- >0)for(j<this.DB&&(X=this[S]>>j)!=(this.s&this.DM)>>j&&(O[ie++]=X|this.s<<this.DB-j);S>=0;)j<8?(X=(this[S]&(1<<j)-1)<<8-j,X|=this[--S]>>(j+=this.DB-8)):(X=this[S]>>(j-=8)&255,j<=0&&(j+=this.DB,--S)),(X&128)!=0&&(X|=-256),ie==0&&(this.s&128)!=(X&128)&&++ie,(ie>0||X!=this.s)&&(O[ie++]=X);return O}s($t,"bnToByteArray");function jt(S){return this.compareTo(S)==0}s(jt,"bnEquals");function Nt(S){return this.compareTo(S)<0?this:S}s(Nt,"bnMin");function Fe(S){return this.compareTo(S)>0?this:S}s(Fe,"bnMax");function Xe(S,O,j){var X,ie,be=Math.min(S.t,this.t);for(X=0;X<be;++X)j[X]=O(this[X],S[X]);if(S.t<this.t){for(ie=S.s&this.DM,X=be;X<this.t;++X)j[X]=O(this[X],ie);j.t=this.t}else{for(ie=this.s&this.DM,X=be;X<S.t;++X)j[X]=O(ie,S[X]);j.t=S.t}j.s=O(this.s,S.s),j.clamp()}s(Xe,"bnpBitwiseTo");function ht(S,O){return S&O}s(ht,"op_and");function rr(S){var O=p();return this.bitwiseTo(S,ht,O),O}s(rr,"bnAnd");function ar(S,O){return S|O}s(ar,"op_or");function zr(S){var O=p();return this.bitwiseTo(S,ar,O),O}s(zr,"bnOr");function Qe(S,O){return S^O}s(Qe,"op_xor");function er(S){var O=p();return this.bitwiseTo(S,Qe,O),O}s(er,"bnXor");function Oe(S,O){return S&~O}s(Oe,"op_andnot");function oe(S){var O=p();return this.bitwiseTo(S,Oe,O),O}s(oe,"bnAndNot");function le(){for(var S=p(),O=0;O<this.t;++O)S[O]=this.DM&~this[O];return S.t=this.t,S.s=~this.s,S}s(le,"bnNot");function Se(S){var O=p();return S<0?this.rShiftTo(-S,O):this.lShiftTo(S,O),O}s(Se,"bnShiftLeft");function ze(S){var O=p();return S<0?this.lShiftTo(-S,O):this.rShiftTo(S,O),O}s(ze,"bnShiftRight");function De(S){if(S==0)return-1;var O=0;return(S&65535)==0&&(S>>=16,O+=16),(S&255)==0&&(S>>=8,O+=8),(S&15)==0&&(S>>=4,O+=4),(S&3)==0&&(S>>=2,O+=2),(S&1)==0&&++O,O}s(De,"lbit");function yt(){for(var S=0;S<this.t;++S)if(this[S]!=0)return S*this.DB+De(this[S]);return this.s<0?this.t*this.DB:-1}s(yt,"bnGetLowestSetBit");function st(S){for(var O=0;S!=0;)S&=S-1,++O;return O}s(st,"cbit");function kt(){for(var S=0,O=this.s&this.DM,j=0;j<this.t;++j)S+=st(this[j]^O);return S}s(kt,"bnBitCount");function mt(S){var O=Math.floor(S/this.DB);return O>=this.t?this.s!=0:(this[O]&1<<S%this.DB)!=0}s(mt,"bnTestBit");function Gt(S,O){var j=c.ONE.shiftLeft(S);return this.bitwiseTo(j,O,j),j}s(Gt,"bnpChangeBit");function ke(S){return this.changeBit(S,ar)}s(ke,"bnSetBit");function $e(S){return this.changeBit(S,Oe)}s($e,"bnClearBit");function ot(S){return this.changeBit(S,Qe)}s(ot,"bnFlipBit");function Ft(S,O){for(var j=0,X=0,ie=Math.min(S.t,this.t);j<ie;)X+=this[j]+S[j],O[j++]=X&this.DM,X>>=this.DB;if(S.t<this.t){for(X+=S.s;j<this.t;)X+=this[j],O[j++]=X&this.DM,X>>=this.DB;X+=this.s}else{for(X+=this.s;j<S.t;)X+=S[j],O[j++]=X&this.DM,X>>=this.DB;X+=S.s}O.s=X<0?-1:0,X>0?O[j++]=X:X<-1&&(O[j++]=this.DV+X),O.t=j,O.clamp()}s(Ft,"bnpAddTo");function Ht(S){var O=p();return this.addTo(S,O),O}s(Ht,"bnAdd");function fr(S){var O=p();return this.subTo(S,O),O}s(fr,"bnSubtract");function nr(S){var O=p();return this.multiplyTo(S,O),O}s(nr,"bnMultiply");function Zr(){var S=p();return this.squareTo(S),S}s(Zr,"bnSquare");function ni(S){var O=p();return this.divRemTo(S,O,null),O}s(ni,"bnDivide");function Yr(S){var O=p();return this.divRemTo(S,null,O),O}s(Yr,"bnRemainder");function Cr(S){var O=p(),j=p();return this.divRemTo(S,O,j),new Array(O,j)}s(Cr,"bnDivideAndRemainder");function Mi(S){this[this.t]=this.am(0,S-1,this,0,0,this.t),++this.t,this.clamp()}s(Mi,"bnpDMultiply");function $r(S,O){if(S!=0){for(;this.t<=O;)this[this.t++]=0;for(this[O]+=S;this[O]>=this.DV;)this[O]-=this.DV,++O>=this.t&&(this[this.t++]=0),++this[O]}}s($r,"bnpDAddOffset");function Qi(){}s(Qi,"NullExp");function Gi(S){return S}s(Gi,"nNop");function Mn(S,O,j){S.multiplyTo(O,j)}s(Mn,"nMulTo");function Ie(S,O){S.squareTo(O)}s(Ie,"nSqrTo"),Qi.prototype.convert=Gi,Qi.prototype.revert=Gi,Qi.prototype.mulTo=Mn,Qi.prototype.sqrTo=Ie;function Je(S){return this.exp(S,new Qi)}s(Je,"bnPow");function wt(S,O,j){var X=Math.min(this.t+S.t,O);for(j.s=0,j.t=X;X>0;)j[--X]=0;var ie;for(ie=j.t-this.t;X<ie;++X)j[X+this.t]=this.am(0,S[X],j,X,0,this.t);for(ie=Math.min(S.t,O);X<ie;++X)this.am(0,S[X],j,X,0,O-X);j.clamp()}s(wt,"bnpMultiplyLowerTo");function ft(S,O,j){--O;var X=j.t=this.t+S.t-O;for(j.s=0;--X>=0;)j[X]=0;for(X=Math.max(O-this.t,0);X<S.t;++X)j[this.t+X-O]=this.am(O-X,S[X],j,0,0,this.t+X-O);j.clamp(),j.drShiftTo(1,j)}s(ft,"bnpMultiplyUpperTo");function rt(S){this.r2=p(),this.q3=p(),c.ONE.dlShiftTo(2*S.t,this.r2),this.mu=this.r2.divide(S),this.m=S}s(rt,"Barrett");function zt(S){if(S.s<0||S.t>2*this.m.t)return S.mod(this.m);if(S.compareTo(this.m)<0)return S;var O=p();return S.copyTo(O),this.reduce(O),O}s(zt,"barrettConvert");function cr(S){return S}s(cr,"barrettRevert");function ur(S){for(S.drShiftTo(this.m.t-1,this.r2),S.t>this.m.t+1&&(S.t=this.m.t+1,S.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);S.compareTo(this.r2)<0;)S.dAddOffset(1,this.m.t+1);for(S.subTo(this.r2,S);S.compareTo(this.m)>=0;)S.subTo(this.m,S)}s(ur,"barrettReduce");function Ar(S,O){S.squareTo(O),this.reduce(O)}s(Ar,"barrettSqrTo");function kr(S,O,j){S.multiplyTo(O,j),this.reduce(j)}s(kr,"barrettMulTo"),rt.prototype.convert=zt,rt.prototype.revert=cr,rt.prototype.reduce=ur,rt.prototype.mulTo=kr,rt.prototype.sqrTo=Ar;function qr(S,O){var j=S.bitLength(),X,ie=k(1),be;if(j<=0)return ie;j<18?X=1:j<48?X=3:j<144?X=4:j<768?X=5:X=6,j<8?be=new se(O):O.isEven()?be=new rt(O):be=new Ae(O);var Ce=new Array,Te=3,ct=X-1,_t=(1<<X)-1;if(Ce[1]=be.convert(this),X>1){var qt=p();for(be.sqrTo(Ce[1],qt);Te<=_t;)Ce[Te]=p(),be.mulTo(qt,Ce[Te-2],Ce[Te]),Te+=2}var sr=S.t-1,mr,xr=!0,lr=p(),Er;for(j=V(S[sr])-1;sr>=0;){for(j>=ct?mr=S[sr]>>j-ct&_t:(mr=(S[sr]&(1<<j+1)-1)<<ct-j,sr>0&&(mr|=S[sr-1]>>this.DB+j-ct)),Te=X;(mr&1)==0;)mr>>=1,--Te;if((j-=Te)<0&&(j+=this.DB,--sr),xr)Ce[mr].copyTo(ie),xr=!1;else{for(;Te>1;)be.sqrTo(ie,lr),be.sqrTo(lr,ie),Te-=2;Te>0?be.sqrTo(ie,lr):(Er=ie,ie=lr,lr=Er),be.mulTo(lr,Ce[mr],ie)}for(;sr>=0&&(S[sr]&1<<j)==0;)be.sqrTo(ie,lr),Er=ie,ie=lr,lr=Er,--j<0&&(j=this.DB-1,--sr)}return be.revert(ie)}s(qr,"bnModPow");function Wr(S){var O=this.s<0?this.negate():this.clone(),j=S.s<0?S.negate():S.clone();if(O.compareTo(j)<0){var X=O;O=j,j=X}var ie=O.getLowestSetBit(),be=j.getLowestSetBit();if(be<0)return O;for(ie<be&&(be=ie),be>0&&(O.rShiftTo(be,O),j.rShiftTo(be,j));O.signum()>0;)(ie=O.getLowestSetBit())>0&&O.rShiftTo(ie,O),(ie=j.getLowestSetBit())>0&&j.rShiftTo(ie,j),O.compareTo(j)>=0?(O.subTo(j,O),O.rShiftTo(1,O)):(j.subTo(O,j),j.rShiftTo(1,j));return be>0&&j.lShiftTo(be,j),j}s(Wr,"bnGCD");function vi(S){if(S<=0)return 0;var O=this.DV%S,j=this.s<0?S-1:0;if(this.t>0)if(O==0)j=this[0]%S;else for(var X=this.t-1;X>=0;--X)j=(O*j+this[X])%S;return j}s(vi,"bnpModInt");function Li(S){var O=S.isEven();if(this.isEven()&&O||S.signum()==0)return c.ZERO;for(var j=S.clone(),X=this.clone(),ie=k(1),be=k(0),Ce=k(0),Te=k(1);j.signum()!=0;){for(;j.isEven();)j.rShiftTo(1,j),O?((!ie.isEven()||!be.isEven())&&(ie.addTo(this,ie),be.subTo(S,be)),ie.rShiftTo(1,ie)):be.isEven()||be.subTo(S,be),be.rShiftTo(1,be);for(;X.isEven();)X.rShiftTo(1,X),O?((!Ce.isEven()||!Te.isEven())&&(Ce.addTo(this,Ce),Te.subTo(S,Te)),Ce.rShiftTo(1,Ce)):Te.isEven()||Te.subTo(S,Te),Te.rShiftTo(1,Te);j.compareTo(X)>=0?(j.subTo(X,j),O&&ie.subTo(Ce,ie),be.subTo(Te,be)):(X.subTo(j,X),O&&Ce.subTo(ie,Ce),Te.subTo(be,Te))}if(X.compareTo(c.ONE)!=0)return c.ZERO;if(Te.compareTo(S)>=0)return Te.subtract(S);if(Te.signum()<0)Te.addTo(S,Te);else return Te;return Te.signum()<0?Te.add(S):Te}s(Li,"bnModInverse");var Ur=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],yi=(1<<26)/Ur[Ur.length-1];function bi(S){var O,j=this.abs();if(j.t==1&&j[0]<=Ur[Ur.length-1]){for(O=0;O<Ur.length;++O)if(j[0]==Ur[O])return!0;return!1}if(j.isEven())return!1;for(O=1;O<Ur.length;){for(var X=Ur[O],ie=O+1;ie<Ur.length&&X<yi;)X*=Ur[ie++];for(X=j.modInt(X);O<ie;)if(X%Ur[O++]==0)return!1}return j.millerRabin(S)}s(bi,"bnIsProbablePrime");function Xr(S){var O=this.subtract(c.ONE),j=O.getLowestSetBit();if(j<=0)return!1;var X=O.shiftRight(j);S=S+1>>1,S>Ur.length&&(S=Ur.length);for(var ie=p(),be=0;be<S;++be){ie.fromInt(Ur[Math.floor(Math.random()*Ur.length)]);var Ce=ie.modPow(X,this);if(Ce.compareTo(c.ONE)!=0&&Ce.compareTo(O)!=0){for(var Te=1;Te++<j&&Ce.compareTo(O)!=0;)if(Ce=Ce.modPowInt(2,this),Ce.compareTo(c.ONE)==0)return!1;if(Ce.compareTo(O)!=0)return!1}}return!0}s(Xr,"bnpMillerRabin"),c.prototype.chunkSize=Rt,c.prototype.toRadix=pt,c.prototype.fromRadix=Yt,c.prototype.fromNumber=Kt,c.prototype.bitwiseTo=Xe,c.prototype.changeBit=Gt,c.prototype.addTo=Ft,c.prototype.dMultiply=Mi,c.prototype.dAddOffset=$r,c.prototype.multiplyLowerTo=wt,c.prototype.multiplyUpperTo=ft,c.prototype.modInt=vi,c.prototype.millerRabin=Xr,c.prototype.clone=Me,c.prototype.intValue=ve,c.prototype.byteValue=Ze,c.prototype.shortValue=It,c.prototype.signum=Et,c.prototype.toByteArray=$t,c.prototype.equals=jt,c.prototype.min=Nt,c.prototype.max=Fe,c.prototype.and=rr,c.prototype.or=zr,c.prototype.xor=er,c.prototype.andNot=oe,c.prototype.not=le,c.prototype.shiftLeft=Se,c.prototype.shiftRight=ze,c.prototype.getLowestSetBit=yt,c.prototype.bitCount=kt,c.prototype.testBit=mt,c.prototype.setBit=ke,c.prototype.clearBit=$e,c.prototype.flipBit=ot,c.prototype.add=Ht,c.prototype.subtract=fr,c.prototype.multiply=nr,c.prototype.divide=ni,c.prototype.remainder=Yr,c.prototype.divideAndRemainder=Cr,c.prototype.modPow=qr,c.prototype.modInverse=Li,c.prototype.pow=Je,c.prototype.gcd=Wr,c.prototype.isProbablePrime=bi,c.prototype.square=Zr;var Vr=c;Vr.prototype.IsNegative=function(){return this.compareTo(Vr.ZERO)==-1},Vr.op_Equality=function(S,O){return S.compareTo(O)==0},Vr.op_Inequality=function(S,O){return S.compareTo(O)!=0},Vr.op_GreaterThan=function(S,O){return S.compareTo(O)>0},Vr.op_LessThan=function(S,O){return S.compareTo(O)<0},Vr.op_Addition=function(S,O){return new Vr(S).add(new Vr(O))},Vr.op_Subtraction=function(S,O){return new Vr(S).subtract(new Vr(O))},Vr.Int128Mul=function(S,O){return new Vr(S).multiply(new Vr(O))},Vr.op_Division=function(S,O){return S.divide(O)},Vr.prototype.ToDouble=function(){return parseFloat(this.toString())},typeof si>"u"&&(si=s(function(S,O){var j;if(typeof Object.getOwnPropertyNames>"u"){for(j in O.prototype)(typeof S.prototype[j]>"u"||S.prototype[j]==Object.prototype[j])&&(S.prototype[j]=O.prototype[j]);for(j in O)typeof S[j]>"u"&&(S[j]=O[j]);S.$baseCtor=O}else{for(var X=Object.getOwnPropertyNames(O.prototype),ie=0;ie<X.length;ie++)typeof Object.getOwnPropertyDescriptor(S.prototype,X[ie])>"u"&&Object.defineProperty(S.prototype,X[ie],Object.getOwnPropertyDescriptor(O.prototype,X[ie]));for(j in O)typeof S[j]>"u"&&(S[j]=O[j]);S.$baseCtor=O}},"Inherit"));var si;i.Path=function(){return[]},i.Paths=function(){return[]},i.DoublePoint=function(){var S=arguments;this.X=0,this.Y=0,S.length==1?(this.X=S[0].X,this.Y=S[0].Y):S.length==2&&(this.X=S[0],this.Y=S[1])},i.DoublePoint0=function(){this.X=0,this.Y=0},i.DoublePoint1=function(S){this.X=S.X,this.Y=S.Y},i.DoublePoint2=function(S,O){this.X=S,this.Y=O},i.PolyNode=function(){this.m_Parent=null,this.m_polygon=new i.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},i.PolyNode.prototype.IsHoleNode=function(){for(var S=!0,O=this.m_Parent;O!==null;)S=!S,O=O.m_Parent;return S},i.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},i.PolyNode.prototype.Contour=function(){return this.m_polygon},i.PolyNode.prototype.AddChild=function(S){var O=this.m_Childs.length;this.m_Childs.push(S),S.m_Parent=this,S.m_Index=O},i.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},i.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},i.PolyNode.prototype.Childs=function(){return this.m_Childs},i.PolyNode.prototype.Parent=function(){return this.m_Parent},i.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},i.PolyTree=function(){this.m_AllPolys=[],i.PolyNode.call(this)},i.PolyTree.prototype.Clear=function(){for(var S=0,O=this.m_AllPolys.length;S<O;S++)this.m_AllPolys[S]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},i.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},i.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},si(i.PolyTree,i.PolyNode),i.Math_Abs_Int64=i.Math_Abs_Int32=i.Math_Abs_Double=function(S){return Math.abs(S)},i.Math_Max_Int32_Int32=function(S,O){return Math.max(S,O)},l.msie||l.opera||l.safari?i.Cast_Int32=function(S){return S|0}:i.Cast_Int32=function(S){return~~S},l.chrome?i.Cast_Int64=function(S){return S<-2147483648||S>2147483647?S<0?Math.ceil(S):Math.floor(S):~~S}:l.firefox&&typeof Number.toInteger=="function"?i.Cast_Int64=function(S){return Number.toInteger(S)}:l.msie7||l.msie8?i.Cast_Int64=function(S){return parseInt(S,10)}:l.msie?i.Cast_Int64=function(S){return S<-2147483648||S>2147483647?S<0?Math.ceil(S):Math.floor(S):S|0}:i.Cast_Int64=function(S){return S<0?Math.ceil(S):Math.floor(S)},i.Clear=function(S){S.length=0},i.PI=3.141592653589793,i.PI2=2*3.141592653589793,i.IntPoint=function(){var S=arguments,O=S.length,j,X;if(this.X=0,this.Y=0,!r)if(O==2)this.X=S[0],this.Y=S[1];else if(O==1)if(S[0]instanceof i.DoublePoint){var j=S[0];this.X=i.Clipper.Round(j.X),this.Y=i.Clipper.Round(j.Y)}else{var X=S[0];this.X=X.X,this.Y=X.Y}else this.X=0,this.Y=0},i.IntPoint.op_Equality=function(S,O){return S.X==O.X&&S.Y==O.Y},i.IntPoint.op_Inequality=function(S,O){return S.X!=O.X||S.Y!=O.Y},i.IntPoint0=function(){this.X=0,this.Y=0},i.IntPoint1=function(S){this.X=S.X,this.Y=S.Y},i.IntPoint1dp=function(S){this.X=i.Clipper.Round(S.X),this.Y=i.Clipper.Round(S.Y)},i.IntPoint2=function(S,O){this.X=S,this.Y=O},i.IntRect=function(){var S=arguments,O=S.length;O==4?(this.left=S[0],this.top=S[1],this.right=S[2],this.bottom=S[3]):O==1?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},i.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},i.IntRect1=function(S){this.left=S.left,this.top=S.top,this.right=S.right,this.bottom=S.bottom},i.IntRect4=function(S,O,j,X){this.left=S,this.top=O,this.right=j,this.bottom=X},i.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},i.PolyType={ptSubject:0,ptClip:1},i.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},i.JoinType={jtSquare:0,jtRound:1,jtMiter:2},i.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},i.EdgeSide={esLeft:0,esRight:1},i.Direction={dRightToLeft:0,dLeftToRight:1},i.TEdge=function(){this.Bot=new i.IntPoint,this.Curr=new i.IntPoint,this.Top=new i.IntPoint,this.Delta=new i.IntPoint,this.Dx=0,this.PolyTyp=i.PolyType.ptSubject,this.Side=i.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},i.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new i.IntPoint},i.MyIntersectNodeSort=function(){},i.MyIntersectNodeSort.Compare=function(S,O){return O.Pt.Y-S.Pt.Y},i.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},i.Scanbeam=function(){this.Y=0,this.Next=null},i.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},i.OutPt=function(){this.Idx=0,this.Pt=new i.IntPoint,this.Next=null,this.Prev=null},i.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new i.IntPoint},i.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},i.ClipperBase.horizontal=-9007199254740992,i.ClipperBase.Skip=-2,i.ClipperBase.Unassigned=-1,i.ClipperBase.tolerance=1e-20,i.ClipperBase.loRange=47453132,i.ClipperBase.hiRange=0xfffffffffffff,i.ClipperBase.near_zero=function(S){return S>-i.ClipperBase.tolerance&&S<i.ClipperBase.tolerance},i.ClipperBase.IsHorizontal=function(S){return S.Delta.Y===0},i.ClipperBase.prototype.PointIsVertex=function(S,O){var j=O;do{if(i.IntPoint.op_Equality(j.Pt,S))return!0;j=j.Next}while(j!=O);return!1},i.ClipperBase.prototype.PointOnLineSegment=function(S,O,j,X){return X?S.X==O.X&&S.Y==O.Y||S.X==j.X&&S.Y==j.Y||S.X>O.X==S.X<j.X&&S.Y>O.Y==S.Y<j.Y&&Vr.op_Equality(Vr.Int128Mul(S.X-O.X,j.Y-O.Y),Vr.Int128Mul(j.X-O.X,S.Y-O.Y)):S.X==O.X&&S.Y==O.Y||S.X==j.X&&S.Y==j.Y||S.X>O.X==S.X<j.X&&S.Y>O.Y==S.Y<j.Y&&(S.X-O.X)*(j.Y-O.Y)==(j.X-O.X)*(S.Y-O.Y)},i.ClipperBase.prototype.PointOnPolygon=function(S,O,j){for(var X=O;;){if(this.PointOnLineSegment(S,X.Pt,X.Next.Pt,j))return!0;if(X=X.Next,X==O)break}return!1},i.ClipperBase.prototype.SlopesEqual=i.ClipperBase.SlopesEqual=function(){var S=arguments,O=S.length,j,X,ie,be,Ce,Te,ct;return O==3?(j=S[0],X=S[1],ct=S[2],ct?Vr.op_Equality(Vr.Int128Mul(j.Delta.Y,X.Delta.X),Vr.Int128Mul(j.Delta.X,X.Delta.Y)):i.Cast_Int64(j.Delta.Y*X.Delta.X)==i.Cast_Int64(j.Delta.X*X.Delta.Y)):O==4?(ie=S[0],be=S[1],Ce=S[2],ct=S[3],ct?Vr.op_Equality(Vr.Int128Mul(ie.Y-be.Y,be.X-Ce.X),Vr.Int128Mul(ie.X-be.X,be.Y-Ce.Y)):i.Cast_Int64((ie.Y-be.Y)*(be.X-Ce.X))-i.Cast_Int64((ie.X-be.X)*(be.Y-Ce.Y))===0):(ie=S[0],be=S[1],Ce=S[2],Te=S[3],ct=S[4],ct?Vr.op_Equality(Vr.Int128Mul(ie.Y-be.Y,Ce.X-Te.X),Vr.Int128Mul(ie.X-be.X,Ce.Y-Te.Y)):i.Cast_Int64((ie.Y-be.Y)*(Ce.X-Te.X))-i.Cast_Int64((ie.X-be.X)*(Ce.Y-Te.Y))===0)},i.ClipperBase.SlopesEqual3=function(S,O,j){return j?Vr.op_Equality(Vr.Int128Mul(S.Delta.Y,O.Delta.X),Vr.Int128Mul(S.Delta.X,O.Delta.Y)):i.Cast_Int64(S.Delta.Y*O.Delta.X)==i.Cast_Int64(S.Delta.X*O.Delta.Y)},i.ClipperBase.SlopesEqual4=function(S,O,j,X){return X?Vr.op_Equality(Vr.Int128Mul(S.Y-O.Y,O.X-j.X),Vr.Int128Mul(S.X-O.X,O.Y-j.Y)):i.Cast_Int64((S.Y-O.Y)*(O.X-j.X))-i.Cast_Int64((S.X-O.X)*(O.Y-j.Y))===0},i.ClipperBase.SlopesEqual5=function(S,O,j,X,ie){return ie?Vr.op_Equality(Vr.Int128Mul(S.Y-O.Y,j.X-X.X),Vr.Int128Mul(S.X-O.X,j.Y-X.Y)):i.Cast_Int64((S.Y-O.Y)*(j.X-X.X))-i.Cast_Int64((S.X-O.X)*(j.Y-X.Y))===0},i.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var S=0,O=this.m_edges.length;S<O;++S){for(var j=0,X=this.m_edges[S].length;j<X;++j)this.m_edges[S][j]=null;i.Clear(this.m_edges[S])}i.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},i.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var S=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=S}this.m_CurrentLM=null},i.ClipperBase.prototype.RangeTest=function(S,O){O.Value?(S.X>i.ClipperBase.hiRange||S.Y>i.ClipperBase.hiRange||-S.X>i.ClipperBase.hiRange||-S.Y>i.ClipperBase.hiRange)&&i.Error("Coordinate outside allowed range in RangeTest()."):(S.X>i.ClipperBase.loRange||S.Y>i.ClipperBase.loRange||-S.X>i.ClipperBase.loRange||-S.Y>i.ClipperBase.loRange)&&(O.Value=!0,this.RangeTest(S,O))},i.ClipperBase.prototype.InitEdge=function(S,O,j,X){S.Next=O,S.Prev=j,S.Curr.X=X.X,S.Curr.Y=X.Y,S.OutIdx=-1},i.ClipperBase.prototype.InitEdge2=function(S,O){S.Curr.Y>=S.Next.Curr.Y?(S.Bot.X=S.Curr.X,S.Bot.Y=S.Curr.Y,S.Top.X=S.Next.Curr.X,S.Top.Y=S.Next.Curr.Y):(S.Top.X=S.Curr.X,S.Top.Y=S.Curr.Y,S.Bot.X=S.Next.Curr.X,S.Bot.Y=S.Next.Curr.Y),this.SetDx(S),S.PolyTyp=O},i.ClipperBase.prototype.FindNextLocMin=function(S){for(var O;;){for(;i.IntPoint.op_Inequality(S.Bot,S.Prev.Bot)||i.IntPoint.op_Equality(S.Curr,S.Top);)S=S.Next;if(S.Dx!=i.ClipperBase.horizontal&&S.Prev.Dx!=i.ClipperBase.horizontal)break;for(;S.Prev.Dx==i.ClipperBase.horizontal;)S=S.Prev;for(O=S;S.Dx==i.ClipperBase.horizontal;)S=S.Next;if(S.Top.Y!=S.Prev.Bot.Y){O.Prev.Bot.X<S.Bot.X&&(S=O);break}}return S},i.ClipperBase.prototype.ProcessBound=function(S,O){var j=S,X=S,ie,be;if(S.Dx==i.ClipperBase.horizontal&&(O?be=S.Prev.Bot.X:be=S.Next.Bot.X,S.Bot.X!=be&&this.ReverseHorizontal(S)),X.OutIdx!=i.ClipperBase.Skip)if(O){for(;X.Top.Y==X.Next.Bot.Y&&X.Next.OutIdx!=i.ClipperBase.Skip;)X=X.Next;if(X.Dx==i.ClipperBase.horizontal&&X.Next.OutIdx!=i.ClipperBase.Skip){for(ie=X;ie.Prev.Dx==i.ClipperBase.horizontal;)ie=ie.Prev;ie.Prev.Top.X==X.Next.Top.X?O||(X=ie.Prev):ie.Prev.Top.X>X.Next.Top.X&&(X=ie.Prev)}for(;S!=X;)S.NextInLML=S.Next,S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Prev.Top.X&&this.ReverseHorizontal(S),S=S.Next;S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Prev.Top.X&&this.ReverseHorizontal(S),X=X.Next}else{for(;X.Top.Y==X.Prev.Bot.Y&&X.Prev.OutIdx!=i.ClipperBase.Skip;)X=X.Prev;if(X.Dx==i.ClipperBase.horizontal&&X.Prev.OutIdx!=i.ClipperBase.Skip){for(ie=X;ie.Next.Dx==i.ClipperBase.horizontal;)ie=ie.Next;ie.Next.Top.X==X.Prev.Top.X?O||(X=ie.Next):ie.Next.Top.X>X.Prev.Top.X&&(X=ie.Next)}for(;S!=X;)S.NextInLML=S.Prev,S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Next.Top.X&&this.ReverseHorizontal(S),S=S.Prev;S.Dx==i.ClipperBase.horizontal&&S!=j&&S.Bot.X!=S.Next.Top.X&&this.ReverseHorizontal(S),X=X.Prev}if(X.OutIdx==i.ClipperBase.Skip){if(S=X,O){for(;S.Top.Y==S.Next.Bot.Y;)S=S.Next;for(;S!=X&&S.Dx==i.ClipperBase.horizontal;)S=S.Prev}else{for(;S.Top.Y==S.Prev.Bot.Y;)S=S.Prev;for(;S!=X&&S.Dx==i.ClipperBase.horizontal;)S=S.Next}if(S==X)O?X=S.Next:X=S.Prev;else{O?S=X.Next:S=X.Prev;var Ce=new i.LocalMinima;Ce.Next=null,Ce.Y=S.Bot.Y,Ce.LeftBound=null,Ce.RightBound=S,Ce.RightBound.WindDelta=0,X=this.ProcessBound(Ce.RightBound,O),this.InsertLocalMinima(Ce)}}return X},i.ClipperBase.prototype.AddPath=function(S,O,j){!j&&O==i.PolyType.ptClip&&i.Error("AddPath: Open paths must be subject.");var X=S.length-1;if(j)for(;X>0&&i.IntPoint.op_Equality(S[X],S[0]);)--X;for(;X>0&&i.IntPoint.op_Equality(S[X],S[X-1]);)--X;if(j&&X<2||!j&&X<1)return!1;for(var ie=new Array,be=0;be<=X;be++)ie.push(new i.TEdge);var Ce=!0;ie[1].Curr.X=S[1].X,ie[1].Curr.Y=S[1].Y;var Te={Value:this.m_UseFullRange};this.RangeTest(S[0],Te),this.m_UseFullRange=Te.Value,Te.Value=this.m_UseFullRange,this.RangeTest(S[X],Te),this.m_UseFullRange=Te.Value,this.InitEdge(ie[0],ie[1],ie[X],S[0]),this.InitEdge(ie[X],ie[0],ie[X-1],S[X]);for(var be=X-1;be>=1;--be)Te.Value=this.m_UseFullRange,this.RangeTest(S[be],Te),this.m_UseFullRange=Te.Value,this.InitEdge(ie[be],ie[be+1],ie[be-1],S[be]);for(var ct=ie[0],_t=ct,qt=ct;;){if(i.IntPoint.op_Equality(_t.Curr,_t.Next.Curr)){if(_t==_t.Next)break;_t==ct&&(ct=_t.Next),_t=this.RemoveEdge(_t),qt=_t;continue}if(_t.Prev==_t.Next)break;if(j&&i.ClipperBase.SlopesEqual(_t.Prev.Curr,_t.Curr,_t.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(_t.Prev.Curr,_t.Curr,_t.Next.Curr))){_t==ct&&(ct=_t.Next),_t=this.RemoveEdge(_t),_t=_t.Prev,qt=_t;continue}if(_t=_t.Next,_t==qt)break}if(!j&&_t==_t.Next||j&&_t.Prev==_t.Next)return!1;j||(this.m_HasOpenPaths=!0,ct.Prev.OutIdx=i.ClipperBase.Skip),_t=ct;do this.InitEdge2(_t,O),_t=_t.Next,Ce&&_t.Curr.Y!=ct.Curr.Y&&(Ce=!1);while(_t!=ct);if(Ce){if(j)return!1;_t.Prev.OutIdx=i.ClipperBase.Skip,_t.Prev.Bot.X<_t.Prev.Top.X&&this.ReverseHorizontal(_t.Prev);var sr=new i.LocalMinima;for(sr.Next=null,sr.Y=_t.Bot.Y,sr.LeftBound=null,sr.RightBound=_t,sr.RightBound.Side=i.EdgeSide.esRight,sr.RightBound.WindDelta=0;_t.Next.OutIdx!=i.ClipperBase.Skip;)_t.NextInLML=_t.Next,_t.Bot.X!=_t.Prev.Top.X&&this.ReverseHorizontal(_t),_t=_t.Next;return this.InsertLocalMinima(sr),this.m_edges.push(ie),!0}this.m_edges.push(ie);for(var mr,xr=null;_t=this.FindNextLocMin(_t),_t!=xr;){xr==null&&(xr=_t);var sr=new i.LocalMinima;sr.Next=null,sr.Y=_t.Bot.Y,_t.Dx<_t.Prev.Dx?(sr.LeftBound=_t.Prev,sr.RightBound=_t,mr=!1):(sr.LeftBound=_t,sr.RightBound=_t.Prev,mr=!0),sr.LeftBound.Side=i.EdgeSide.esLeft,sr.RightBound.Side=i.EdgeSide.esRight,j?sr.LeftBound.Next==sr.RightBound?sr.LeftBound.WindDelta=-1:sr.LeftBound.WindDelta=1:sr.LeftBound.WindDelta=0,sr.RightBound.WindDelta=-sr.LeftBound.WindDelta,_t=this.ProcessBound(sr.LeftBound,mr);var lr=this.ProcessBound(sr.RightBound,!mr);sr.LeftBound.OutIdx==i.ClipperBase.Skip?sr.LeftBound=null:sr.RightBound.OutIdx==i.ClipperBase.Skip&&(sr.RightBound=null),this.InsertLocalMinima(sr),mr||(_t=lr)}return!0},i.ClipperBase.prototype.AddPaths=function(S,O,j){for(var X=!1,ie=0,be=S.length;ie<be;++ie)this.AddPath(S[ie],O,j)&&(X=!0);return X},i.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(S,O,j){return i.IntPoint.op_Equality(S,j)||i.IntPoint.op_Equality(S,O)||i.IntPoint.op_Equality(j,O)?!1:S.X!=j.X?O.X>S.X==O.X<j.X:O.Y>S.Y==O.Y<j.Y},i.ClipperBase.prototype.RemoveEdge=function(S){S.Prev.Next=S.Next,S.Next.Prev=S.Prev;var O=S.Next;return S.Prev=null,O},i.ClipperBase.prototype.SetDx=function(S){S.Delta.X=S.Top.X-S.Bot.X,S.Delta.Y=S.Top.Y-S.Bot.Y,S.Delta.Y===0?S.Dx=i.ClipperBase.horizontal:S.Dx=S.Delta.X/S.Delta.Y},i.ClipperBase.prototype.InsertLocalMinima=function(S){if(this.m_MinimaList===null)this.m_MinimaList=S;else if(S.Y>=this.m_MinimaList.Y)S.Next=this.m_MinimaList,this.m_MinimaList=S;else{for(var O=this.m_MinimaList;O.Next!==null&&S.Y<O.Next.Y;)O=O.Next;S.Next=O.Next,O.Next=S}},i.ClipperBase.prototype.PopLocalMinima=function(){this.m_CurrentLM!==null&&(this.m_CurrentLM=this.m_CurrentLM.Next)},i.ClipperBase.prototype.ReverseHorizontal=function(S){var O=S.Top.X;S.Top.X=S.Bot.X,S.Bot.X=O},i.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!=null)for(var S=this.m_MinimaList;S!=null;){var O=S.LeftBound;O!=null&&(O.Curr.X=O.Bot.X,O.Curr.Y=O.Bot.Y,O.Side=i.EdgeSide.esLeft,O.OutIdx=i.ClipperBase.Unassigned),O=S.RightBound,O!=null&&(O.Curr.X=O.Bot.X,O.Curr.Y=O.Bot.Y,O.Side=i.EdgeSide.esRight,O.OutIdx=i.ClipperBase.Unassigned),S=S.Next}},i.Clipper=function(S){typeof S>"u"&&(S=0),this.m_PolyOuts=null,this.m_ClipType=i.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=i.PolyFillType.pftEvenOdd,this.m_SubjFillType=i.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,i.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=i.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&S)!==0,this.StrictlySimple=(2&S)!==0,this.PreserveCollinear=(4&S)!==0},i.Clipper.ioReverseSolution=1,i.Clipper.ioStrictlySimple=2,i.Clipper.ioPreserveCollinear=4,i.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),i.ClipperBase.prototype.Clear.call(this))},i.Clipper.prototype.DisposeScanbeamList=function(){for(;this.m_Scanbeam!==null;){var S=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=S}},i.Clipper.prototype.Reset=function(){i.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var S=this.m_MinimaList;S!==null;)this.InsertScanbeam(S.Y),S=S.Next},i.Clipper.prototype.InsertScanbeam=function(S){if(this.m_Scanbeam===null)this.m_Scanbeam=new i.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=S;else if(S>this.m_Scanbeam.Y){var O=new i.Scanbeam;O.Y=S,O.Next=this.m_Scanbeam,this.m_Scanbeam=O}else{for(var j=this.m_Scanbeam;j.Next!==null&&S<=j.Next.Y;)j=j.Next;if(S==j.Y)return;var O=new i.Scanbeam;O.Y=S,O.Next=j.Next,j.Next=O}},i.Clipper.prototype.Execute=function(){var S=arguments,O=S.length,j=S[1]instanceof i.PolyTree;if(O==4&&!j){var X=S[0],ie=S[1],be=S[2],Ce=S[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&i.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,i.Clear(ie),this.m_SubjFillType=be,this.m_ClipFillType=Ce,this.m_ClipType=X,this.m_UsingPolyTree=!1;try{var Te=this.ExecuteInternal();Te&&this.BuildResult(ie)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return Te}else if(O==4&&j){var X=S[0],ct=S[1],be=S[2],Ce=S[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=be,this.m_ClipFillType=Ce,this.m_ClipType=X,this.m_UsingPolyTree=!0;try{var Te=this.ExecuteInternal();Te&&this.BuildResult2(ct)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return Te}else if(O==2&&!j){var X=S[0],ie=S[1];return this.Execute(X,ie,i.PolyFillType.pftEvenOdd,i.PolyFillType.pftEvenOdd)}else if(O==2&&j){var X=S[0],ct=S[1];return this.Execute(X,ct,i.PolyFillType.pftEvenOdd,i.PolyFillType.pftEvenOdd)}},i.Clipper.prototype.FixHoleLinkage=function(S){if(!(S.FirstLeft===null||S.IsHole!=S.FirstLeft.IsHole&&S.FirstLeft.Pts!==null)){for(var O=S.FirstLeft;O!==null&&(O.IsHole==S.IsHole||O.Pts===null);)O=O.FirstLeft;S.FirstLeft=O}},i.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),this.m_CurrentLM===null)return!1;var S=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(S),i.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),this.m_Scanbeam===null)break;var O=this.PopScanbeam();if(!this.ProcessIntersections(S,O))return!1;this.ProcessEdgesAtTopOfScanbeam(O),S=O}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var j=0,X=this.m_PolyOuts.length;j<X;j++){var ie=this.m_PolyOuts[j];ie.Pts===null||ie.IsOpen||(ie.IsHole^this.ReverseSolution)==this.Area(ie)>0&&this.ReversePolyPtLinks(ie.Pts)}this.JoinCommonEdges();for(var j=0,X=this.m_PolyOuts.length;j<X;j++){var ie=this.m_PolyOuts[j];ie.Pts!==null&&!ie.IsOpen&&this.FixupOutPolygon(ie)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{i.Clear(this.m_Joins),i.Clear(this.m_GhostJoins)}},i.Clipper.prototype.PopScanbeam=function(){var S=this.m_Scanbeam.Y;return this.m_Scanbeam,this.m_Scanbeam=this.m_Scanbeam.Next,S},i.Clipper.prototype.DisposeAllPolyPts=function(){for(var S=0,O=this.m_PolyOuts.length;S<O;++S)this.DisposeOutRec(S);i.Clear(this.m_PolyOuts)},i.Clipper.prototype.DisposeOutRec=function(S){var O=this.m_PolyOuts[S];O.Pts!==null&&this.DisposeOutPts(O.Pts),O=null,this.m_PolyOuts[S]=null},i.Clipper.prototype.DisposeOutPts=function(S){if(S!==null)for(S.Prev.Next=null;S!==null;)S=S.Next},i.Clipper.prototype.AddJoin=function(S,O,j){var X=new i.Join;X.OutPt1=S,X.OutPt2=O,X.OffPt.X=j.X,X.OffPt.Y=j.Y,this.m_Joins.push(X)},i.Clipper.prototype.AddGhostJoin=function(S,O){var j=new i.Join;j.OutPt1=S,j.OffPt.X=O.X,j.OffPt.Y=O.Y,this.m_GhostJoins.push(j)},i.Clipper.prototype.InsertLocalMinimaIntoAEL=function(S){for(;this.m_CurrentLM!==null&&this.m_CurrentLM.Y==S;){var O=this.m_CurrentLM.LeftBound,j=this.m_CurrentLM.RightBound;this.PopLocalMinima();var X=null;if(O===null?(this.InsertEdgeIntoAEL(j,null),this.SetWindingCount(j),this.IsContributing(j)&&(X=this.AddOutPt(j,j.Bot))):j==null?(this.InsertEdgeIntoAEL(O,null),this.SetWindingCount(O),this.IsContributing(O)&&(X=this.AddOutPt(O,O.Bot)),this.InsertScanbeam(O.Top.Y)):(this.InsertEdgeIntoAEL(O,null),this.InsertEdgeIntoAEL(j,O),this.SetWindingCount(O),j.WindCnt=O.WindCnt,j.WindCnt2=O.WindCnt2,this.IsContributing(O)&&(X=this.AddLocalMinPoly(O,j,O.Bot)),this.InsertScanbeam(O.Top.Y)),j!=null&&(i.ClipperBase.IsHorizontal(j)?this.AddEdgeToSEL(j):this.InsertScanbeam(j.Top.Y)),!(O==null||j==null)){if(X!==null&&i.ClipperBase.IsHorizontal(j)&&this.m_GhostJoins.length>0&&j.WindDelta!==0)for(var ie=0,be=this.m_GhostJoins.length;ie<be;ie++){var Ce=this.m_GhostJoins[ie];this.HorzSegmentsOverlap(Ce.OutPt1.Pt,Ce.OffPt,j.Bot,j.Top)&&this.AddJoin(Ce.OutPt1,X,Ce.OffPt)}if(O.OutIdx>=0&&O.PrevInAEL!==null&&O.PrevInAEL.Curr.X==O.Bot.X&&O.PrevInAEL.OutIdx>=0&&i.ClipperBase.SlopesEqual(O.PrevInAEL,O,this.m_UseFullRange)&&O.WindDelta!==0&&O.PrevInAEL.WindDelta!==0){var Te=this.AddOutPt(O.PrevInAEL,O.Bot);this.AddJoin(X,Te,O.Top)}if(O.NextInAEL!=j){if(j.OutIdx>=0&&j.PrevInAEL.OutIdx>=0&&i.ClipperBase.SlopesEqual(j.PrevInAEL,j,this.m_UseFullRange)&&j.WindDelta!==0&&j.PrevInAEL.WindDelta!==0){var Te=this.AddOutPt(j.PrevInAEL,j.Bot);this.AddJoin(X,Te,j.Top)}var ct=O.NextInAEL;if(ct!==null)for(;ct!=j;)this.IntersectEdges(j,ct,O.Curr,!1),ct=ct.NextInAEL}}}},i.Clipper.prototype.InsertEdgeIntoAEL=function(S,O){if(this.m_ActiveEdges===null)S.PrevInAEL=null,S.NextInAEL=null,this.m_ActiveEdges=S;else if(O===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,S))S.PrevInAEL=null,S.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=S,this.m_ActiveEdges=S;else{for(O===null&&(O=this.m_ActiveEdges);O.NextInAEL!==null&&!this.E2InsertsBeforeE1(O.NextInAEL,S);)O=O.NextInAEL;S.NextInAEL=O.NextInAEL,O.NextInAEL!==null&&(O.NextInAEL.PrevInAEL=S),S.PrevInAEL=O,O.NextInAEL=S}},i.Clipper.prototype.E2InsertsBeforeE1=function(S,O){return O.Curr.X==S.Curr.X?O.Top.Y>S.Top.Y?O.Top.X<i.Clipper.TopX(S,O.Top.Y):S.Top.X>i.Clipper.TopX(O,S.Top.Y):O.Curr.X<S.Curr.X},i.Clipper.prototype.IsEvenOddFillType=function(S){return S.PolyTyp==i.PolyType.ptSubject?this.m_SubjFillType==i.PolyFillType.pftEvenOdd:this.m_ClipFillType==i.PolyFillType.pftEvenOdd},i.Clipper.prototype.IsEvenOddAltFillType=function(S){return S.PolyTyp==i.PolyType.ptSubject?this.m_ClipFillType==i.PolyFillType.pftEvenOdd:this.m_SubjFillType==i.PolyFillType.pftEvenOdd},i.Clipper.prototype.IsContributing=function(S){var O,j;switch(S.PolyTyp==i.PolyType.ptSubject?(O=this.m_SubjFillType,j=this.m_ClipFillType):(O=this.m_ClipFillType,j=this.m_SubjFillType),O){case i.PolyFillType.pftEvenOdd:if(S.WindDelta===0&&S.WindCnt!=1)return!1;break;case i.PolyFillType.pftNonZero:if(Math.abs(S.WindCnt)!=1)return!1;break;case i.PolyFillType.pftPositive:if(S.WindCnt!=1)return!1;break;default:if(S.WindCnt!=-1)return!1;break}switch(this.m_ClipType){case i.ClipType.ctIntersection:switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2!==0;case i.PolyFillType.pftPositive:return S.WindCnt2>0;default:return S.WindCnt2<0}case i.ClipType.ctUnion:switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2===0;case i.PolyFillType.pftPositive:return S.WindCnt2<=0;default:return S.WindCnt2>=0}case i.ClipType.ctDifference:if(S.PolyTyp==i.PolyType.ptSubject)switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2===0;case i.PolyFillType.pftPositive:return S.WindCnt2<=0;default:return S.WindCnt2>=0}else switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2!==0;case i.PolyFillType.pftPositive:return S.WindCnt2>0;default:return S.WindCnt2<0}case i.ClipType.ctXor:if(S.WindDelta===0)switch(j){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return S.WindCnt2===0;case i.PolyFillType.pftPositive:return S.WindCnt2<=0;default:return S.WindCnt2>=0}else return!0}return!0},i.Clipper.prototype.SetWindingCount=function(S){for(var O=S.PrevInAEL;O!==null&&(O.PolyTyp!=S.PolyTyp||O.WindDelta===0);)O=O.PrevInAEL;if(O===null)S.WindCnt=S.WindDelta===0?1:S.WindDelta,S.WindCnt2=0,O=this.m_ActiveEdges;else if(S.WindDelta===0&&this.m_ClipType!=i.ClipType.ctUnion)S.WindCnt=1,S.WindCnt2=O.WindCnt2,O=O.NextInAEL;else if(this.IsEvenOddFillType(S)){if(S.WindDelta===0){for(var j=!0,X=O.PrevInAEL;X!==null;)X.PolyTyp==O.PolyTyp&&X.WindDelta!==0&&(j=!j),X=X.PrevInAEL;S.WindCnt=j?0:1}else S.WindCnt=S.WindDelta;S.WindCnt2=O.WindCnt2,O=O.NextInAEL}else O.WindCnt*O.WindDelta<0?Math.abs(O.WindCnt)>1?O.WindDelta*S.WindDelta<0?S.WindCnt=O.WindCnt:S.WindCnt=O.WindCnt+S.WindDelta:S.WindCnt=S.WindDelta===0?1:S.WindDelta:S.WindDelta===0?S.WindCnt=O.WindCnt<0?O.WindCnt-1:O.WindCnt+1:O.WindDelta*S.WindDelta<0?S.WindCnt=O.WindCnt:S.WindCnt=O.WindCnt+S.WindDelta,S.WindCnt2=O.WindCnt2,O=O.NextInAEL;if(this.IsEvenOddAltFillType(S))for(;O!=S;)O.WindDelta!==0&&(S.WindCnt2=S.WindCnt2===0?1:0),O=O.NextInAEL;else for(;O!=S;)S.WindCnt2+=O.WindDelta,O=O.NextInAEL},i.Clipper.prototype.AddEdgeToSEL=function(S){this.m_SortedEdges===null?(this.m_SortedEdges=S,S.PrevInSEL=null,S.NextInSEL=null):(S.NextInSEL=this.m_SortedEdges,S.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=S,this.m_SortedEdges=S)},i.Clipper.prototype.CopyAELToSEL=function(){var S=this.m_ActiveEdges;for(this.m_SortedEdges=S;S!==null;)S.PrevInSEL=S.PrevInAEL,S.NextInSEL=S.NextInAEL,S=S.NextInAEL},i.Clipper.prototype.SwapPositionsInAEL=function(S,O){if(!(S.NextInAEL==S.PrevInAEL||O.NextInAEL==O.PrevInAEL)){if(S.NextInAEL==O){var j=O.NextInAEL;j!==null&&(j.PrevInAEL=S);var X=S.PrevInAEL;X!==null&&(X.NextInAEL=O),O.PrevInAEL=X,O.NextInAEL=S,S.PrevInAEL=O,S.NextInAEL=j}else if(O.NextInAEL==S){var j=S.NextInAEL;j!==null&&(j.PrevInAEL=O);var X=O.PrevInAEL;X!==null&&(X.NextInAEL=S),S.PrevInAEL=X,S.NextInAEL=O,O.PrevInAEL=S,O.NextInAEL=j}else{var j=S.NextInAEL,X=S.PrevInAEL;S.NextInAEL=O.NextInAEL,S.NextInAEL!==null&&(S.NextInAEL.PrevInAEL=S),S.PrevInAEL=O.PrevInAEL,S.PrevInAEL!==null&&(S.PrevInAEL.NextInAEL=S),O.NextInAEL=j,O.NextInAEL!==null&&(O.NextInAEL.PrevInAEL=O),O.PrevInAEL=X,O.PrevInAEL!==null&&(O.PrevInAEL.NextInAEL=O)}S.PrevInAEL===null?this.m_ActiveEdges=S:O.PrevInAEL===null&&(this.m_ActiveEdges=O)}},i.Clipper.prototype.SwapPositionsInSEL=function(S,O){if(!(S.NextInSEL===null&&S.PrevInSEL===null)&&!(O.NextInSEL===null&&O.PrevInSEL===null)){if(S.NextInSEL==O){var j=O.NextInSEL;j!==null&&(j.PrevInSEL=S);var X=S.PrevInSEL;X!==null&&(X.NextInSEL=O),O.PrevInSEL=X,O.NextInSEL=S,S.PrevInSEL=O,S.NextInSEL=j}else if(O.NextInSEL==S){var j=S.NextInSEL;j!==null&&(j.PrevInSEL=O);var X=O.PrevInSEL;X!==null&&(X.NextInSEL=S),S.PrevInSEL=X,S.NextInSEL=O,O.PrevInSEL=S,O.NextInSEL=j}else{var j=S.NextInSEL,X=S.PrevInSEL;S.NextInSEL=O.NextInSEL,S.NextInSEL!==null&&(S.NextInSEL.PrevInSEL=S),S.PrevInSEL=O.PrevInSEL,S.PrevInSEL!==null&&(S.PrevInSEL.NextInSEL=S),O.NextInSEL=j,O.NextInSEL!==null&&(O.NextInSEL.PrevInSEL=O),O.PrevInSEL=X,O.PrevInSEL!==null&&(O.PrevInSEL.NextInSEL=O)}S.PrevInSEL===null?this.m_SortedEdges=S:O.PrevInSEL===null&&(this.m_SortedEdges=O)}},i.Clipper.prototype.AddLocalMaxPoly=function(S,O,j){this.AddOutPt(S,j),O.WindDelta==0&&this.AddOutPt(O,j),S.OutIdx==O.OutIdx?(S.OutIdx=-1,O.OutIdx=-1):S.OutIdx<O.OutIdx?this.AppendPolygon(S,O):this.AppendPolygon(O,S)},i.Clipper.prototype.AddLocalMinPoly=function(S,O,j){var X,ie,be;if(i.ClipperBase.IsHorizontal(O)||S.Dx>O.Dx?(X=this.AddOutPt(S,j),O.OutIdx=S.OutIdx,S.Side=i.EdgeSide.esLeft,O.Side=i.EdgeSide.esRight,ie=S,ie.PrevInAEL==O?be=O.PrevInAEL:be=ie.PrevInAEL):(X=this.AddOutPt(O,j),S.OutIdx=O.OutIdx,S.Side=i.EdgeSide.esRight,O.Side=i.EdgeSide.esLeft,ie=O,ie.PrevInAEL==S?be=S.PrevInAEL:be=ie.PrevInAEL),be!==null&&be.OutIdx>=0&&i.Clipper.TopX(be,j.Y)==i.Clipper.TopX(ie,j.Y)&&i.ClipperBase.SlopesEqual(ie,be,this.m_UseFullRange)&&ie.WindDelta!==0&&be.WindDelta!==0){var Ce=this.AddOutPt(be,j);this.AddJoin(X,Ce,ie.Top)}return X},i.Clipper.prototype.CreateOutRec=function(){var S=new i.OutRec;return S.Idx=-1,S.IsHole=!1,S.IsOpen=!1,S.FirstLeft=null,S.Pts=null,S.BottomPt=null,S.PolyNode=null,this.m_PolyOuts.push(S),S.Idx=this.m_PolyOuts.length-1,S},i.Clipper.prototype.AddOutPt=function(S,O){var j=S.Side==i.EdgeSide.esLeft;if(S.OutIdx<0){var X=this.CreateOutRec();X.IsOpen=S.WindDelta===0;var ie=new i.OutPt;return X.Pts=ie,ie.Idx=X.Idx,ie.Pt.X=O.X,ie.Pt.Y=O.Y,ie.Next=ie,ie.Prev=ie,X.IsOpen||this.SetHoleState(S,X),S.OutIdx=X.Idx,ie}else{var X=this.m_PolyOuts[S.OutIdx],be=X.Pts;if(j&&i.IntPoint.op_Equality(O,be.Pt))return be;if(!j&&i.IntPoint.op_Equality(O,be.Prev.Pt))return be.Prev;var ie=new i.OutPt;return ie.Idx=X.Idx,ie.Pt.X=O.X,ie.Pt.Y=O.Y,ie.Next=be,ie.Prev=be.Prev,ie.Prev.Next=ie,be.Prev=ie,j&&(X.Pts=ie),ie}},i.Clipper.prototype.SwapPoints=function(S,O){var j=new i.IntPoint(S.Value);S.Value.X=O.Value.X,S.Value.Y=O.Value.Y,O.Value.X=j.X,O.Value.Y=j.Y},i.Clipper.prototype.HorzSegmentsOverlap=function(S,O,j,X){return S.X>j.X==S.X<X.X||O.X>j.X==O.X<X.X||j.X>S.X==j.X<O.X||X.X>S.X==X.X<O.X||S.X==j.X&&O.X==X.X?!0:S.X==X.X&&O.X==j.X},i.Clipper.prototype.InsertPolyPtBetween=function(S,O,j){var X=new i.OutPt;return X.Pt.X=j.X,X.Pt.Y=j.Y,O==S.Next?(S.Next=X,O.Prev=X,X.Next=O,X.Prev=S):(O.Next=X,S.Prev=X,X.Next=S,X.Prev=O),X},i.Clipper.prototype.SetHoleState=function(S,O){for(var j=!1,X=S.PrevInAEL;X!==null;)X.OutIdx>=0&&X.WindDelta!=0&&(j=!j,O.FirstLeft===null&&(O.FirstLeft=this.m_PolyOuts[X.OutIdx])),X=X.PrevInAEL;j&&(O.IsHole=!0)},i.Clipper.prototype.GetDx=function(S,O){return S.Y==O.Y?i.ClipperBase.horizontal:(O.X-S.X)/(O.Y-S.Y)},i.Clipper.prototype.FirstIsBottomPt=function(S,O){for(var j=S.Prev;i.IntPoint.op_Equality(j.Pt,S.Pt)&&j!=S;)j=j.Prev;var X=Math.abs(this.GetDx(S.Pt,j.Pt));for(j=S.Next;i.IntPoint.op_Equality(j.Pt,S.Pt)&&j!=S;)j=j.Next;var ie=Math.abs(this.GetDx(S.Pt,j.Pt));for(j=O.Prev;i.IntPoint.op_Equality(j.Pt,O.Pt)&&j!=O;)j=j.Prev;var be=Math.abs(this.GetDx(O.Pt,j.Pt));for(j=O.Next;i.IntPoint.op_Equality(j.Pt,O.Pt)&&j!=O;)j=j.Next;var Ce=Math.abs(this.GetDx(O.Pt,j.Pt));return X>=be&&X>=Ce||ie>=be&&ie>=Ce},i.Clipper.prototype.GetBottomPt=function(S){for(var O=null,j=S.Next;j!=S;)j.Pt.Y>S.Pt.Y?(S=j,O=null):j.Pt.Y==S.Pt.Y&&j.Pt.X<=S.Pt.X&&(j.Pt.X<S.Pt.X?(O=null,S=j):j.Next!=S&&j.Prev!=S&&(O=j)),j=j.Next;if(O!==null)for(;O!=j;)for(this.FirstIsBottomPt(j,O)||(S=O),O=O.Next;i.IntPoint.op_Inequality(O.Pt,S.Pt);)O=O.Next;return S},i.Clipper.prototype.GetLowermostRec=function(S,O){S.BottomPt===null&&(S.BottomPt=this.GetBottomPt(S.Pts)),O.BottomPt===null&&(O.BottomPt=this.GetBottomPt(O.Pts));var j=S.BottomPt,X=O.BottomPt;return j.Pt.Y>X.Pt.Y?S:j.Pt.Y<X.Pt.Y?O:j.Pt.X<X.Pt.X?S:j.Pt.X>X.Pt.X||j.Next==j?O:X.Next==X||this.FirstIsBottomPt(j,X)?S:O},i.Clipper.prototype.Param1RightOfParam2=function(S,O){do if(S=S.FirstLeft,S==O)return!0;while(S!==null);return!1},i.Clipper.prototype.GetOutRec=function(S){for(var O=this.m_PolyOuts[S];O!=this.m_PolyOuts[O.Idx];)O=this.m_PolyOuts[O.Idx];return O},i.Clipper.prototype.AppendPolygon=function(S,O){var j=this.m_PolyOuts[S.OutIdx],X=this.m_PolyOuts[O.OutIdx],ie;this.Param1RightOfParam2(j,X)?ie=X:this.Param1RightOfParam2(X,j)?ie=j:ie=this.GetLowermostRec(j,X);var be=j.Pts,Ce=be.Prev,Te=X.Pts,ct=Te.Prev,_t;S.Side==i.EdgeSide.esLeft?(O.Side==i.EdgeSide.esLeft?(this.ReversePolyPtLinks(Te),Te.Next=be,be.Prev=Te,Ce.Next=ct,ct.Prev=Ce,j.Pts=ct):(ct.Next=be,be.Prev=ct,Te.Prev=Ce,Ce.Next=Te,j.Pts=Te),_t=i.EdgeSide.esLeft):(O.Side==i.EdgeSide.esRight?(this.ReversePolyPtLinks(Te),Ce.Next=ct,ct.Prev=Ce,Te.Next=be,be.Prev=Te):(Ce.Next=Te,Te.Prev=Ce,be.Prev=ct,ct.Next=be),_t=i.EdgeSide.esRight),j.BottomPt=null,ie==X&&(X.FirstLeft!=j&&(j.FirstLeft=X.FirstLeft),j.IsHole=X.IsHole),X.Pts=null,X.BottomPt=null,X.FirstLeft=j;var qt=S.OutIdx,sr=O.OutIdx;S.OutIdx=-1,O.OutIdx=-1;for(var mr=this.m_ActiveEdges;mr!==null;){if(mr.OutIdx==sr){mr.OutIdx=qt,mr.Side=_t;break}mr=mr.NextInAEL}X.Idx=j.Idx},i.Clipper.prototype.ReversePolyPtLinks=function(S){if(S!==null){var O,j;O=S;do j=O.Next,O.Next=O.Prev,O.Prev=j,O=j;while(O!=S)}},i.Clipper.SwapSides=function(S,O){var j=S.Side;S.Side=O.Side,O.Side=j},i.Clipper.SwapPolyIndexes=function(S,O){var j=S.OutIdx;S.OutIdx=O.OutIdx,O.OutIdx=j},i.Clipper.prototype.IntersectEdges=function(S,O,j,X){var ie=!X&&S.NextInLML===null&&S.Top.X==j.X&&S.Top.Y==j.Y,be=!X&&O.NextInLML===null&&O.Top.X==j.X&&O.Top.Y==j.Y,Ce=S.OutIdx>=0,Te=O.OutIdx>=0;if(S.WindDelta===0||O.WindDelta===0){S.WindDelta===0&&O.WindDelta===0?(ie||be)&&Ce&&Te&&this.AddLocalMaxPoly(S,O,j):S.PolyTyp==O.PolyTyp&&S.WindDelta!=O.WindDelta&&this.m_ClipType==i.ClipType.ctUnion?S.WindDelta===0?Te&&(this.AddOutPt(S,j),Ce&&(S.OutIdx=-1)):Ce&&(this.AddOutPt(O,j),Te&&(O.OutIdx=-1)):S.PolyTyp!=O.PolyTyp&&(S.WindDelta===0&&Math.abs(O.WindCnt)==1&&(this.m_ClipType!=i.ClipType.ctUnion||O.WindCnt2===0)?(this.AddOutPt(S,j),Ce&&(S.OutIdx=-1)):O.WindDelta===0&&Math.abs(S.WindCnt)==1&&(this.m_ClipType!=i.ClipType.ctUnion||S.WindCnt2===0)&&(this.AddOutPt(O,j),Te&&(O.OutIdx=-1))),ie&&(S.OutIdx<0?this.DeleteFromAEL(S):i.Error("Error intersecting polylines")),be&&(O.OutIdx<0?this.DeleteFromAEL(O):i.Error("Error intersecting polylines"));return}if(S.PolyTyp==O.PolyTyp)if(this.IsEvenOddFillType(S)){var ct=S.WindCnt;S.WindCnt=O.WindCnt,O.WindCnt=ct}else S.WindCnt+O.WindDelta===0?S.WindCnt=-S.WindCnt:S.WindCnt+=O.WindDelta,O.WindCnt-S.WindDelta===0?O.WindCnt=-O.WindCnt:O.WindCnt-=S.WindDelta;else this.IsEvenOddFillType(O)?S.WindCnt2=S.WindCnt2===0?1:0:S.WindCnt2+=O.WindDelta,this.IsEvenOddFillType(S)?O.WindCnt2=O.WindCnt2===0?1:0:O.WindCnt2-=S.WindDelta;var _t,qt,sr,mr;S.PolyTyp==i.PolyType.ptSubject?(_t=this.m_SubjFillType,sr=this.m_ClipFillType):(_t=this.m_ClipFillType,sr=this.m_SubjFillType),O.PolyTyp==i.PolyType.ptSubject?(qt=this.m_SubjFillType,mr=this.m_ClipFillType):(qt=this.m_ClipFillType,mr=this.m_SubjFillType);var xr,lr;switch(_t){case i.PolyFillType.pftPositive:xr=S.WindCnt;break;case i.PolyFillType.pftNegative:xr=-S.WindCnt;break;default:xr=Math.abs(S.WindCnt);break}switch(qt){case i.PolyFillType.pftPositive:lr=O.WindCnt;break;case i.PolyFillType.pftNegative:lr=-O.WindCnt;break;default:lr=Math.abs(O.WindCnt);break}if(Ce&&Te)ie||be||xr!==0&&xr!=1||lr!==0&&lr!=1||S.PolyTyp!=O.PolyTyp&&this.m_ClipType!=i.ClipType.ctXor?this.AddLocalMaxPoly(S,O,j):(this.AddOutPt(S,j),this.AddOutPt(O,j),i.Clipper.SwapSides(S,O),i.Clipper.SwapPolyIndexes(S,O));else if(Ce)(lr===0||lr==1)&&(this.AddOutPt(S,j),i.Clipper.SwapSides(S,O),i.Clipper.SwapPolyIndexes(S,O));else if(Te)(xr===0||xr==1)&&(this.AddOutPt(O,j),i.Clipper.SwapSides(S,O),i.Clipper.SwapPolyIndexes(S,O));else if((xr===0||xr==1)&&(lr===0||lr==1)&&!ie&&!be){var Er,on;switch(sr){case i.PolyFillType.pftPositive:Er=S.WindCnt2;break;case i.PolyFillType.pftNegative:Er=-S.WindCnt2;break;default:Er=Math.abs(S.WindCnt2);break}switch(mr){case i.PolyFillType.pftPositive:on=O.WindCnt2;break;case i.PolyFillType.pftNegative:on=-O.WindCnt2;break;default:on=Math.abs(O.WindCnt2);break}if(S.PolyTyp!=O.PolyTyp)this.AddLocalMinPoly(S,O,j);else if(xr==1&&lr==1)switch(this.m_ClipType){case i.ClipType.ctIntersection:Er>0&&on>0&&this.AddLocalMinPoly(S,O,j);break;case i.ClipType.ctUnion:Er<=0&&on<=0&&this.AddLocalMinPoly(S,O,j);break;case i.ClipType.ctDifference:(S.PolyTyp==i.PolyType.ptClip&&Er>0&&on>0||S.PolyTyp==i.PolyType.ptSubject&&Er<=0&&on<=0)&&this.AddLocalMinPoly(S,O,j);break;case i.ClipType.ctXor:this.AddLocalMinPoly(S,O,j);break}else i.Clipper.SwapSides(S,O)}ie!=be&&(ie&&S.OutIdx>=0||be&&O.OutIdx>=0)&&(i.Clipper.SwapSides(S,O),i.Clipper.SwapPolyIndexes(S,O)),ie&&this.DeleteFromAEL(S),be&&this.DeleteFromAEL(O)},i.Clipper.prototype.DeleteFromAEL=function(S){var O=S.PrevInAEL,j=S.NextInAEL;O===null&&j===null&&S!=this.m_ActiveEdges||(O!==null?O.NextInAEL=j:this.m_ActiveEdges=j,j!==null&&(j.PrevInAEL=O),S.NextInAEL=null,S.PrevInAEL=null)},i.Clipper.prototype.DeleteFromSEL=function(S){var O=S.PrevInSEL,j=S.NextInSEL;O===null&&j===null&&S!=this.m_SortedEdges||(O!==null?O.NextInSEL=j:this.m_SortedEdges=j,j!==null&&(j.PrevInSEL=O),S.NextInSEL=null,S.PrevInSEL=null)},i.Clipper.prototype.UpdateEdgeIntoAEL=function(S){S.NextInLML===null&&i.Error("UpdateEdgeIntoAEL: invalid call");var O=S.PrevInAEL,j=S.NextInAEL;return S.NextInLML.OutIdx=S.OutIdx,O!==null?O.NextInAEL=S.NextInLML:this.m_ActiveEdges=S.NextInLML,j!==null&&(j.PrevInAEL=S.NextInLML),S.NextInLML.Side=S.Side,S.NextInLML.WindDelta=S.WindDelta,S.NextInLML.WindCnt=S.WindCnt,S.NextInLML.WindCnt2=S.WindCnt2,S=S.NextInLML,S.Curr.X=S.Bot.X,S.Curr.Y=S.Bot.Y,S.PrevInAEL=O,S.NextInAEL=j,i.ClipperBase.IsHorizontal(S)||this.InsertScanbeam(S.Top.Y),S},i.Clipper.prototype.ProcessHorizontals=function(S){for(var O=this.m_SortedEdges;O!==null;)this.DeleteFromSEL(O),this.ProcessHorizontal(O,S),O=this.m_SortedEdges},i.Clipper.prototype.GetHorzDirection=function(S,O){S.Bot.X<S.Top.X?(O.Left=S.Bot.X,O.Right=S.Top.X,O.Dir=i.Direction.dLeftToRight):(O.Left=S.Top.X,O.Right=S.Bot.X,O.Dir=i.Direction.dRightToLeft)},i.Clipper.prototype.PrepareHorzJoins=function(S,O){var j=this.m_PolyOuts[S.OutIdx].Pts;S.Side!=i.EdgeSide.esLeft&&(j=j.Prev),O&&(i.IntPoint.op_Equality(j.Pt,S.Top)?this.AddGhostJoin(j,S.Bot):this.AddGhostJoin(j,S.Top))},i.Clipper.prototype.ProcessHorizontal=function(S,O){var j={Dir:null,Left:null,Right:null};this.GetHorzDirection(S,j);for(var X=j.Dir,ie=j.Left,be=j.Right,Ce=S,Te=null;Ce.NextInLML!==null&&i.ClipperBase.IsHorizontal(Ce.NextInLML);)Ce=Ce.NextInLML;for(Ce.NextInLML===null&&(Te=this.GetMaximaPair(Ce));;){for(var ct=S==Ce,_t=this.GetNextInAEL(S,X);_t!==null&&!(_t.Curr.X==S.Top.X&&S.NextInLML!==null&&_t.Dx<S.NextInLML.Dx);){var qt=this.GetNextInAEL(_t,X);if(X==i.Direction.dLeftToRight&&_t.Curr.X<=be||X==i.Direction.dRightToLeft&&_t.Curr.X>=ie){if(S.OutIdx>=0&&S.WindDelta!=0&&this.PrepareHorzJoins(S,O),_t==Te&&ct){X==i.Direction.dLeftToRight?this.IntersectEdges(S,_t,_t.Top,!1):this.IntersectEdges(_t,S,_t.Top,!1),Te.OutIdx>=0&&i.Error("ProcessHorizontal error");return}else if(X==i.Direction.dLeftToRight){var sr=new i.IntPoint(_t.Curr.X,S.Curr.Y);this.IntersectEdges(S,_t,sr,!0)}else{var sr=new i.IntPoint(_t.Curr.X,S.Curr.Y);this.IntersectEdges(_t,S,sr,!0)}this.SwapPositionsInAEL(S,_t)}else if(X==i.Direction.dLeftToRight&&_t.Curr.X>=be||X==i.Direction.dRightToLeft&&_t.Curr.X<=ie)break;_t=qt}if(S.OutIdx>=0&&S.WindDelta!==0&&this.PrepareHorzJoins(S,O),S.NextInLML!==null&&i.ClipperBase.IsHorizontal(S.NextInLML)){S=this.UpdateEdgeIntoAEL(S),S.OutIdx>=0&&this.AddOutPt(S,S.Bot);var j={Dir:X,Left:ie,Right:be};this.GetHorzDirection(S,j),X=j.Dir,ie=j.Left,be=j.Right}else break}if(S.NextInLML!==null)if(S.OutIdx>=0){var mr=this.AddOutPt(S,S.Top);if(S=this.UpdateEdgeIntoAEL(S),S.WindDelta===0)return;var xr=S.PrevInAEL,qt=S.NextInAEL;if(xr!==null&&xr.Curr.X==S.Bot.X&&xr.Curr.Y==S.Bot.Y&&xr.WindDelta!==0&&xr.OutIdx>=0&&xr.Curr.Y>xr.Top.Y&&i.ClipperBase.SlopesEqual(S,xr,this.m_UseFullRange)){var lr=this.AddOutPt(xr,S.Bot);this.AddJoin(mr,lr,S.Top)}else if(qt!==null&&qt.Curr.X==S.Bot.X&&qt.Curr.Y==S.Bot.Y&&qt.WindDelta!==0&&qt.OutIdx>=0&&qt.Curr.Y>qt.Top.Y&&i.ClipperBase.SlopesEqual(S,qt,this.m_UseFullRange)){var lr=this.AddOutPt(qt,S.Bot);this.AddJoin(mr,lr,S.Top)}}else S=this.UpdateEdgeIntoAEL(S);else Te!==null?Te.OutIdx>=0?(X==i.Direction.dLeftToRight?this.IntersectEdges(S,Te,S.Top,!1):this.IntersectEdges(Te,S,S.Top,!1),Te.OutIdx>=0&&i.Error("ProcessHorizontal error")):(this.DeleteFromAEL(S),this.DeleteFromAEL(Te)):(S.OutIdx>=0&&this.AddOutPt(S,S.Top),this.DeleteFromAEL(S))},i.Clipper.prototype.GetNextInAEL=function(S,O){return O==i.Direction.dLeftToRight?S.NextInAEL:S.PrevInAEL},i.Clipper.prototype.IsMinima=function(S){return S!==null&&S.Prev.NextInLML!=S&&S.Next.NextInLML!=S},i.Clipper.prototype.IsMaxima=function(S,O){return S!==null&&S.Top.Y==O&&S.NextInLML===null},i.Clipper.prototype.IsIntermediate=function(S,O){return S.Top.Y==O&&S.NextInLML!==null},i.Clipper.prototype.GetMaximaPair=function(S){var O=null;return i.IntPoint.op_Equality(S.Next.Top,S.Top)&&S.Next.NextInLML===null?O=S.Next:i.IntPoint.op_Equality(S.Prev.Top,S.Top)&&S.Prev.NextInLML===null&&(O=S.Prev),O!==null&&(O.OutIdx==-2||O.NextInAEL==O.PrevInAEL&&!i.ClipperBase.IsHorizontal(O))?null:O},i.Clipper.prototype.ProcessIntersections=function(S,O){if(this.m_ActiveEdges==null)return!0;try{if(this.BuildIntersectList(S,O),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,i.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},i.Clipper.prototype.BuildIntersectList=function(S,O){if(this.m_ActiveEdges!==null){var j=this.m_ActiveEdges;for(this.m_SortedEdges=j;j!==null;)j.PrevInSEL=j.PrevInAEL,j.NextInSEL=j.NextInAEL,j.Curr.X=i.Clipper.TopX(j,O),j=j.NextInAEL;for(var X=!0;X&&this.m_SortedEdges!==null;){for(X=!1,j=this.m_SortedEdges;j.NextInSEL!==null;){var ie=j.NextInSEL,be=new i.IntPoint;if(j.Curr.X>ie.Curr.X){!this.IntersectPoint(j,ie,be)&&j.Curr.X>ie.Curr.X+1&&i.Error("Intersection error"),be.Y>S&&(be.Y=S,Math.abs(j.Dx)>Math.abs(ie.Dx)?be.X=i.Clipper.TopX(ie,S):be.X=i.Clipper.TopX(j,S));var Ce=new i.IntersectNode;Ce.Edge1=j,Ce.Edge2=ie,Ce.Pt.X=be.X,Ce.Pt.Y=be.Y,this.m_IntersectList.push(Ce),this.SwapPositionsInSEL(j,ie),X=!0}else j=ie}if(j.PrevInSEL!==null)j.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},i.Clipper.prototype.EdgesAdjacent=function(S){return S.Edge1.NextInSEL==S.Edge2||S.Edge1.PrevInSEL==S.Edge2},i.Clipper.IntersectNodeSort=function(S,O){return O.Pt.Y-S.Pt.Y},i.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var S=this.m_IntersectList.length,O=0;O<S;O++){if(!this.EdgesAdjacent(this.m_IntersectList[O])){for(var j=O+1;j<S&&!this.EdgesAdjacent(this.m_IntersectList[j]);)j++;if(j==S)return!1;var X=this.m_IntersectList[O];this.m_IntersectList[O]=this.m_IntersectList[j],this.m_IntersectList[j]=X}this.SwapPositionsInSEL(this.m_IntersectList[O].Edge1,this.m_IntersectList[O].Edge2)}return!0},i.Clipper.prototype.ProcessIntersectList=function(){for(var S=0,O=this.m_IntersectList.length;S<O;S++){var j=this.m_IntersectList[S];this.IntersectEdges(j.Edge1,j.Edge2,j.Pt,!0),this.SwapPositionsInAEL(j.Edge1,j.Edge2)}this.m_IntersectList.length=0};var oa=s(function(S){return S<0?Math.ceil(S-.5):Math.round(S)},"R1"),ea=s(function(S){return S<0?Math.ceil(S-.5):Math.floor(S+.5)},"R2"),Ui=s(function(S){return S<0?-Math.round(Math.abs(S)):Math.round(S)},"R3"),Gr=s(function(S){return S<0?(S-=.5,S<-2147483648?Math.ceil(S):S|0):(S+=.5,S>2147483647?Math.floor(S):S|0)},"R4");l.msie?i.Clipper.Round=oa:l.chromium?i.Clipper.Round=Ui:l.safari?i.Clipper.Round=Gr:i.Clipper.Round=ea,i.Clipper.TopX=function(S,O){return O==S.Top.Y?S.Top.X:S.Bot.X+i.Clipper.Round(S.Dx*(O-S.Bot.Y))},i.Clipper.prototype.IntersectPoint=function(S,O,j){j.X=0,j.Y=0;var X,ie;if(i.ClipperBase.SlopesEqual(S,O,this.m_UseFullRange)||S.Dx==O.Dx)return O.Bot.Y>S.Bot.Y?(j.X=O.Bot.X,j.Y=O.Bot.Y):(j.X=S.Bot.X,j.Y=S.Bot.Y),!1;if(S.Delta.X===0)j.X=S.Bot.X,i.ClipperBase.IsHorizontal(O)?j.Y=O.Bot.Y:(ie=O.Bot.Y-O.Bot.X/O.Dx,j.Y=i.Clipper.Round(j.X/O.Dx+ie));else if(O.Delta.X===0)j.X=O.Bot.X,i.ClipperBase.IsHorizontal(S)?j.Y=S.Bot.Y:(X=S.Bot.Y-S.Bot.X/S.Dx,j.Y=i.Clipper.Round(j.X/S.Dx+X));else{X=S.Bot.X-S.Bot.Y*S.Dx,ie=O.Bot.X-O.Bot.Y*O.Dx;var be=(ie-X)/(S.Dx-O.Dx);j.Y=i.Clipper.Round(be),Math.abs(S.Dx)<Math.abs(O.Dx)?j.X=i.Clipper.Round(S.Dx*be+X):j.X=i.Clipper.Round(O.Dx*be+ie)}if(j.Y<S.Top.Y||j.Y<O.Top.Y){if(S.Top.Y>O.Top.Y)return j.Y=S.Top.Y,j.X=i.Clipper.TopX(O,S.Top.Y),j.X<S.Top.X;j.Y=O.Top.Y,Math.abs(S.Dx)<Math.abs(O.Dx)?j.X=i.Clipper.TopX(S,j.Y):j.X=i.Clipper.TopX(O,j.Y)}return!0},i.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(S){for(var O=this.m_ActiveEdges;O!==null;){var j=this.IsMaxima(O,S);if(j){var X=this.GetMaximaPair(O);j=X===null||!i.ClipperBase.IsHorizontal(X)}if(j){var ie=O.PrevInAEL;this.DoMaxima(O),ie===null?O=this.m_ActiveEdges:O=ie.NextInAEL}else{if(this.IsIntermediate(O,S)&&i.ClipperBase.IsHorizontal(O.NextInLML)?(O=this.UpdateEdgeIntoAEL(O),O.OutIdx>=0&&this.AddOutPt(O,O.Bot),this.AddEdgeToSEL(O)):(O.Curr.X=i.Clipper.TopX(O,S),O.Curr.Y=S),this.StrictlySimple){var ie=O.PrevInAEL;if(O.OutIdx>=0&&O.WindDelta!==0&&ie!==null&&ie.OutIdx>=0&&ie.Curr.X==O.Curr.X&&ie.WindDelta!==0){var be=this.AddOutPt(ie,O.Curr),Ce=this.AddOutPt(O,O.Curr);this.AddJoin(be,Ce,O.Curr)}}O=O.NextInAEL}}for(this.ProcessHorizontals(!0),O=this.m_ActiveEdges;O!==null;){if(this.IsIntermediate(O,S)){var be=null;O.OutIdx>=0&&(be=this.AddOutPt(O,O.Top)),O=this.UpdateEdgeIntoAEL(O);var ie=O.PrevInAEL,Te=O.NextInAEL;if(ie!==null&&ie.Curr.X==O.Bot.X&&ie.Curr.Y==O.Bot.Y&&be!==null&&ie.OutIdx>=0&&ie.Curr.Y>ie.Top.Y&&i.ClipperBase.SlopesEqual(O,ie,this.m_UseFullRange)&&O.WindDelta!==0&&ie.WindDelta!==0){var Ce=this.AddOutPt(ie,O.Bot);this.AddJoin(be,Ce,O.Top)}else if(Te!==null&&Te.Curr.X==O.Bot.X&&Te.Curr.Y==O.Bot.Y&&be!==null&&Te.OutIdx>=0&&Te.Curr.Y>Te.Top.Y&&i.ClipperBase.SlopesEqual(O,Te,this.m_UseFullRange)&&O.WindDelta!==0&&Te.WindDelta!==0){var Ce=this.AddOutPt(Te,O.Bot);this.AddJoin(be,Ce,O.Top)}}O=O.NextInAEL}},i.Clipper.prototype.DoMaxima=function(S){var O=this.GetMaximaPair(S);if(O===null){S.OutIdx>=0&&this.AddOutPt(S,S.Top),this.DeleteFromAEL(S);return}for(var j=S.NextInAEL,X=!0;j!==null&&j!=O;)this.IntersectEdges(S,j,S.Top,!0),this.SwapPositionsInAEL(S,j),j=S.NextInAEL;S.OutIdx==-1&&O.OutIdx==-1?(this.DeleteFromAEL(S),this.DeleteFromAEL(O)):S.OutIdx>=0&&O.OutIdx>=0?this.IntersectEdges(S,O,S.Top,!1):X&&S.WindDelta===0?(S.OutIdx>=0&&(this.AddOutPt(S,S.Top),S.OutIdx=-1),this.DeleteFromAEL(S),O.OutIdx>=0&&(this.AddOutPt(O,S.Top),O.OutIdx=-1),this.DeleteFromAEL(O)):i.Error("DoMaxima error")},i.Clipper.ReversePaths=function(S){for(var O=0,j=S.length;O<j;O++)S[O].reverse()},i.Clipper.Orientation=function(S){return i.Clipper.Area(S)>=0},i.Clipper.prototype.PointCount=function(S){if(S===null)return 0;var O=0,j=S;do O++,j=j.Next;while(j!=S);return O},i.Clipper.prototype.BuildResult=function(S){i.Clear(S);for(var O=0,j=this.m_PolyOuts.length;O<j;O++){var X=this.m_PolyOuts[O];if(X.Pts!==null){var ie=X.Pts.Prev,be=this.PointCount(ie);if(!(be<2)){for(var Ce=new Array(be),Te=0;Te<be;Te++)Ce[Te]=ie.Pt,ie=ie.Prev;S.push(Ce)}}}},i.Clipper.prototype.BuildResult2=function(S){S.Clear();for(var O=0,j=this.m_PolyOuts.length;O<j;O++){var X=this.m_PolyOuts[O],ie=this.PointCount(X.Pts);if(!(X.IsOpen&&ie<2||!X.IsOpen&&ie<3)){this.FixHoleLinkage(X);var be=new i.PolyNode;S.m_AllPolys.push(be),X.PolyNode=be,be.m_polygon.length=ie;for(var Ce=X.Pts.Prev,Te=0;Te<ie;Te++)be.m_polygon[Te]=Ce.Pt,Ce=Ce.Prev}}for(var O=0,j=this.m_PolyOuts.length;O<j;O++){var X=this.m_PolyOuts[O];X.PolyNode!==null&&(X.IsOpen?(X.PolyNode.IsOpen=!0,S.AddChild(X.PolyNode)):X.FirstLeft!==null&&X.FirstLeft.PolyNode!=null?X.FirstLeft.PolyNode.AddChild(X.PolyNode):S.AddChild(X.PolyNode))}},i.Clipper.prototype.FixupOutPolygon=function(S){var O=null;S.BottomPt=null;for(var j=S.Pts;;){if(j.Prev==j||j.Prev==j.Next){this.DisposeOutPts(j),S.Pts=null;return}if(i.IntPoint.op_Equality(j.Pt,j.Next.Pt)||i.IntPoint.op_Equality(j.Pt,j.Prev.Pt)||i.ClipperBase.SlopesEqual(j.Prev.Pt,j.Pt,j.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(j.Prev.Pt,j.Pt,j.Next.Pt)))O=null,j.Prev.Next=j.Next,j.Next.Prev=j.Prev,j=j.Prev;else{if(j==O)break;O===null&&(O=j),j=j.Next}}S.Pts=j},i.Clipper.prototype.DupOutPt=function(S,O){var j=new i.OutPt;return j.Pt.X=S.Pt.X,j.Pt.Y=S.Pt.Y,j.Idx=S.Idx,O?(j.Next=S.Next,j.Prev=S,S.Next.Prev=j,S.Next=j):(j.Prev=S.Prev,j.Next=S,S.Prev.Next=j,S.Prev=j),j},i.Clipper.prototype.GetOverlap=function(S,O,j,X,ie){return S<O?j<X?(ie.Left=Math.max(S,j),ie.Right=Math.min(O,X)):(ie.Left=Math.max(S,X),ie.Right=Math.min(O,j)):j<X?(ie.Left=Math.max(O,j),ie.Right=Math.min(S,X)):(ie.Left=Math.max(O,X),ie.Right=Math.min(S,j)),ie.Left<ie.Right},i.Clipper.prototype.JoinHorz=function(S,O,j,X,ie,be){var Ce=S.Pt.X>O.Pt.X?i.Direction.dRightToLeft:i.Direction.dLeftToRight,Te=j.Pt.X>X.Pt.X?i.Direction.dRightToLeft:i.Direction.dLeftToRight;if(Ce==Te)return!1;if(Ce==i.Direction.dLeftToRight){for(;S.Next.Pt.X<=ie.X&&S.Next.Pt.X>=S.Pt.X&&S.Next.Pt.Y==ie.Y;)S=S.Next;be&&S.Pt.X!=ie.X&&(S=S.Next),O=this.DupOutPt(S,!be),i.IntPoint.op_Inequality(O.Pt,ie)&&(S=O,S.Pt.X=ie.X,S.Pt.Y=ie.Y,O=this.DupOutPt(S,!be))}else{for(;S.Next.Pt.X>=ie.X&&S.Next.Pt.X<=S.Pt.X&&S.Next.Pt.Y==ie.Y;)S=S.Next;!be&&S.Pt.X!=ie.X&&(S=S.Next),O=this.DupOutPt(S,be),i.IntPoint.op_Inequality(O.Pt,ie)&&(S=O,S.Pt.X=ie.X,S.Pt.Y=ie.Y,O=this.DupOutPt(S,be))}if(Te==i.Direction.dLeftToRight){for(;j.Next.Pt.X<=ie.X&&j.Next.Pt.X>=j.Pt.X&&j.Next.Pt.Y==ie.Y;)j=j.Next;be&&j.Pt.X!=ie.X&&(j=j.Next),X=this.DupOutPt(j,!be),i.IntPoint.op_Inequality(X.Pt,ie)&&(j=X,j.Pt.X=ie.X,j.Pt.Y=ie.Y,X=this.DupOutPt(j,!be))}else{for(;j.Next.Pt.X>=ie.X&&j.Next.Pt.X<=j.Pt.X&&j.Next.Pt.Y==ie.Y;)j=j.Next;!be&&j.Pt.X!=ie.X&&(j=j.Next),X=this.DupOutPt(j,be),i.IntPoint.op_Inequality(X.Pt,ie)&&(j=X,j.Pt.X=ie.X,j.Pt.Y=ie.Y,X=this.DupOutPt(j,be))}return Ce==i.Direction.dLeftToRight==be?(S.Prev=j,j.Next=S,O.Next=X,X.Prev=O):(S.Next=j,j.Prev=S,O.Prev=X,X.Next=O),!0},i.Clipper.prototype.JoinPoints=function(S,O,j){var X=S.OutPt1,ie=new i.OutPt,be=S.OutPt2,Ce=new i.OutPt,Te=S.OutPt1.Pt.Y==S.OffPt.Y;if(Te&&i.IntPoint.op_Equality(S.OffPt,S.OutPt1.Pt)&&i.IntPoint.op_Equality(S.OffPt,S.OutPt2.Pt)){for(ie=S.OutPt1.Next;ie!=X&&i.IntPoint.op_Equality(ie.Pt,S.OffPt);)ie=ie.Next;var ct=ie.Pt.Y>S.OffPt.Y;for(Ce=S.OutPt2.Next;Ce!=be&&i.IntPoint.op_Equality(Ce.Pt,S.OffPt);)Ce=Ce.Next;var _t=Ce.Pt.Y>S.OffPt.Y;return ct==_t?!1:ct?(ie=this.DupOutPt(X,!1),Ce=this.DupOutPt(be,!0),X.Prev=be,be.Next=X,ie.Next=Ce,Ce.Prev=ie,S.OutPt1=X,S.OutPt2=ie,!0):(ie=this.DupOutPt(X,!0),Ce=this.DupOutPt(be,!1),X.Next=be,be.Prev=X,ie.Prev=Ce,Ce.Next=ie,S.OutPt1=X,S.OutPt2=ie,!0)}else if(Te){for(ie=X;X.Prev.Pt.Y==X.Pt.Y&&X.Prev!=ie&&X.Prev!=be;)X=X.Prev;for(;ie.Next.Pt.Y==ie.Pt.Y&&ie.Next!=X&&ie.Next!=be;)ie=ie.Next;if(ie.Next==X||ie.Next==be)return!1;for(Ce=be;be.Prev.Pt.Y==be.Pt.Y&&be.Prev!=Ce&&be.Prev!=ie;)be=be.Prev;for(;Ce.Next.Pt.Y==Ce.Pt.Y&&Ce.Next!=be&&Ce.Next!=X;)Ce=Ce.Next;if(Ce.Next==be||Ce.Next==X)return!1;var qt={Left:null,Right:null};if(!this.GetOverlap(X.Pt.X,ie.Pt.X,be.Pt.X,Ce.Pt.X,qt))return!1;var sr=qt.Left,mr=qt.Right,xr=new i.IntPoint,lr;return X.Pt.X>=sr&&X.Pt.X<=mr?(xr.X=X.Pt.X,xr.Y=X.Pt.Y,lr=X.Pt.X>ie.Pt.X):be.Pt.X>=sr&&be.Pt.X<=mr?(xr.X=be.Pt.X,xr.Y=be.Pt.Y,lr=be.Pt.X>Ce.Pt.X):ie.Pt.X>=sr&&ie.Pt.X<=mr?(xr.X=ie.Pt.X,xr.Y=ie.Pt.Y,lr=ie.Pt.X>X.Pt.X):(xr.X=Ce.Pt.X,xr.Y=Ce.Pt.Y,lr=Ce.Pt.X>be.Pt.X),S.OutPt1=X,S.OutPt2=be,this.JoinHorz(X,ie,be,Ce,xr,lr)}else{for(ie=X.Next;i.IntPoint.op_Equality(ie.Pt,X.Pt)&&ie!=X;)ie=ie.Next;var Er=ie.Pt.Y>X.Pt.Y||!i.ClipperBase.SlopesEqual(X.Pt,ie.Pt,S.OffPt,this.m_UseFullRange);if(Er){for(ie=X.Prev;i.IntPoint.op_Equality(ie.Pt,X.Pt)&&ie!=X;)ie=ie.Prev;if(ie.Pt.Y>X.Pt.Y||!i.ClipperBase.SlopesEqual(X.Pt,ie.Pt,S.OffPt,this.m_UseFullRange))return!1}for(Ce=be.Next;i.IntPoint.op_Equality(Ce.Pt,be.Pt)&&Ce!=be;)Ce=Ce.Next;var on=Ce.Pt.Y>be.Pt.Y||!i.ClipperBase.SlopesEqual(be.Pt,Ce.Pt,S.OffPt,this.m_UseFullRange);if(on){for(Ce=be.Prev;i.IntPoint.op_Equality(Ce.Pt,be.Pt)&&Ce!=be;)Ce=Ce.Prev;if(Ce.Pt.Y>be.Pt.Y||!i.ClipperBase.SlopesEqual(be.Pt,Ce.Pt,S.OffPt,this.m_UseFullRange))return!1}return ie==X||Ce==be||ie==Ce||O==j&&Er==on?!1:Er?(ie=this.DupOutPt(X,!1),Ce=this.DupOutPt(be,!0),X.Prev=be,be.Next=X,ie.Next=Ce,Ce.Prev=ie,S.OutPt1=X,S.OutPt2=ie,!0):(ie=this.DupOutPt(X,!0),Ce=this.DupOutPt(be,!1),X.Next=be,be.Prev=X,ie.Prev=Ce,Ce.Next=ie,S.OutPt1=X,S.OutPt2=ie,!0)}},i.Clipper.GetBounds=function(S){for(var O=0,j=S.length;O<j&&S[O].length==0;)O++;if(O==j)return new i.IntRect(0,0,0,0);var X=new i.IntRect;for(X.left=S[O][0].X,X.right=X.left,X.top=S[O][0].Y,X.bottom=X.top;O<j;O++)for(var ie=0,be=S[O].length;ie<be;ie++)S[O][ie].X<X.left?X.left=S[O][ie].X:S[O][ie].X>X.right&&(X.right=S[O][ie].X),S[O][ie].Y<X.top?X.top=S[O][ie].Y:S[O][ie].Y>X.bottom&&(X.bottom=S[O][ie].Y);return X},i.Clipper.prototype.GetBounds2=function(S){var O=S,j=new i.IntRect;for(j.left=S.Pt.X,j.right=S.Pt.X,j.top=S.Pt.Y,j.bottom=S.Pt.Y,S=S.Next;S!=O;)S.Pt.X<j.left&&(j.left=S.Pt.X),S.Pt.X>j.right&&(j.right=S.Pt.X),S.Pt.Y<j.top&&(j.top=S.Pt.Y),S.Pt.Y>j.bottom&&(j.bottom=S.Pt.Y),S=S.Next;return j},i.Clipper.PointInPolygon=function(S,O){var j=0,X=O.length;if(X<3)return 0;for(var ie=O[0],be=1;be<=X;++be){var Ce=be==X?O[0]:O[be];if(Ce.Y==S.Y&&(Ce.X==S.X||ie.Y==S.Y&&Ce.X>S.X==ie.X<S.X))return-1;if(ie.Y<S.Y!=Ce.Y<S.Y){if(ie.X>=S.X)if(Ce.X>S.X)j=1-j;else{var Te=(ie.X-S.X)*(Ce.Y-S.Y)-(Ce.X-S.X)*(ie.Y-S.Y);if(Te==0)return-1;Te>0==Ce.Y>ie.Y&&(j=1-j)}else if(Ce.X>S.X){var Te=(ie.X-S.X)*(Ce.Y-S.Y)-(Ce.X-S.X)*(ie.Y-S.Y);if(Te==0)return-1;Te>0==Ce.Y>ie.Y&&(j=1-j)}}ie=Ce}return j},i.Clipper.prototype.PointInPolygon=function(S,O){for(var j=0,X=O;;){var ie=O.Pt.X,be=O.Pt.Y,Ce=O.Next.Pt.X,Te=O.Next.Pt.Y;if(Te==S.Y&&(Ce==S.X||be==S.Y&&Ce>S.X==ie<S.X))return-1;if(be<S.Y!=Te<S.Y){if(ie>=S.X)if(Ce>S.X)j=1-j;else{var ct=(ie-S.X)*(Te-S.Y)-(Ce-S.X)*(be-S.Y);if(ct==0)return-1;ct>0==Te>be&&(j=1-j)}else if(Ce>S.X){var ct=(ie-S.X)*(Te-S.Y)-(Ce-S.X)*(be-S.Y);if(ct==0)return-1;ct>0==Te>be&&(j=1-j)}}if(O=O.Next,X==O)break}return j},i.Clipper.prototype.Poly2ContainsPoly1=function(S,O){var j=S;do{var X=this.PointInPolygon(j.Pt,O);if(X>=0)return X!=0;j=j.Next}while(j!=S);return!0},i.Clipper.prototype.FixupFirstLefts1=function(S,O){for(var j=0,X=this.m_PolyOuts.length;j<X;j++){var ie=this.m_PolyOuts[j];ie.Pts!==null&&ie.FirstLeft==S&&this.Poly2ContainsPoly1(ie.Pts,O.Pts)&&(ie.FirstLeft=O)}},i.Clipper.prototype.FixupFirstLefts2=function(S,O){for(var j=0,X=this.m_PolyOuts,ie=X.length,be=X[j];j<ie;j++,be=X[j])be.FirstLeft==S&&(be.FirstLeft=O)},i.Clipper.ParseFirstLeft=function(S){for(;S!=null&&S.Pts==null;)S=S.FirstLeft;return S},i.Clipper.prototype.JoinCommonEdges=function(){for(var S=0,O=this.m_Joins.length;S<O;S++){var j=this.m_Joins[S],X=this.GetOutRec(j.OutPt1.Idx),ie=this.GetOutRec(j.OutPt2.Idx);if(!(X.Pts==null||ie.Pts==null)){var be;if(X==ie?be=X:this.Param1RightOfParam2(X,ie)?be=ie:this.Param1RightOfParam2(ie,X)?be=X:be=this.GetLowermostRec(X,ie),!!this.JoinPoints(j,X,ie))if(X==ie){if(X.Pts=j.OutPt1,X.BottomPt=null,ie=this.CreateOutRec(),ie.Pts=j.OutPt2,this.UpdateOutPtIdxs(ie),this.m_UsingPolyTree)for(var Ce=0,Te=this.m_PolyOuts.length;Ce<Te-1;Ce++){var ct=this.m_PolyOuts[Ce];ct.Pts==null||i.Clipper.ParseFirstLeft(ct.FirstLeft)!=X||ct.IsHole==X.IsHole||this.Poly2ContainsPoly1(ct.Pts,j.OutPt2)&&(ct.FirstLeft=ie)}this.Poly2ContainsPoly1(ie.Pts,X.Pts)?(ie.IsHole=!X.IsHole,ie.FirstLeft=X,this.m_UsingPolyTree&&this.FixupFirstLefts2(ie,X),(ie.IsHole^this.ReverseSolution)==this.Area(ie)>0&&this.ReversePolyPtLinks(ie.Pts)):this.Poly2ContainsPoly1(X.Pts,ie.Pts)?(ie.IsHole=X.IsHole,X.IsHole=!ie.IsHole,ie.FirstLeft=X.FirstLeft,X.FirstLeft=ie,this.m_UsingPolyTree&&this.FixupFirstLefts2(X,ie),(X.IsHole^this.ReverseSolution)==this.Area(X)>0&&this.ReversePolyPtLinks(X.Pts)):(ie.IsHole=X.IsHole,ie.FirstLeft=X.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(X,ie))}else ie.Pts=null,ie.BottomPt=null,ie.Idx=X.Idx,X.IsHole=be.IsHole,be==ie&&(X.FirstLeft=ie.FirstLeft),ie.FirstLeft=X,this.m_UsingPolyTree&&this.FixupFirstLefts2(ie,X)}}},i.Clipper.prototype.UpdateOutPtIdxs=function(S){var O=S.Pts;do O.Idx=S.Idx,O=O.Prev;while(O!=S.Pts)},i.Clipper.prototype.DoSimplePolygons=function(){for(var S=0;S<this.m_PolyOuts.length;){var O=this.m_PolyOuts[S++],j=O.Pts;if(j!==null)do{for(var X=j.Next;X!=O.Pts;){if(i.IntPoint.op_Equality(j.Pt,X.Pt)&&X.Next!=j&&X.Prev!=j){var ie=j.Prev,be=X.Prev;j.Prev=be,be.Next=j,X.Prev=ie,ie.Next=X,O.Pts=j;var Ce=this.CreateOutRec();Ce.Pts=X,this.UpdateOutPtIdxs(Ce),this.Poly2ContainsPoly1(Ce.Pts,O.Pts)?(Ce.IsHole=!O.IsHole,Ce.FirstLeft=O):this.Poly2ContainsPoly1(O.Pts,Ce.Pts)?(Ce.IsHole=O.IsHole,O.IsHole=!Ce.IsHole,Ce.FirstLeft=O.FirstLeft,O.FirstLeft=Ce):(Ce.IsHole=O.IsHole,Ce.FirstLeft=O.FirstLeft),X=j}X=X.Next}j=j.Next}while(j!=O.Pts)}},i.Clipper.Area=function(S){var O=S.length;if(O<3)return 0;for(var j=0,X=0,ie=O-1;X<O;++X)j+=(S[ie].X+S[X].X)*(S[ie].Y-S[X].Y),ie=X;return-j*.5},i.Clipper.prototype.Area=function(S){var O=S.Pts;if(O==null)return 0;var j=0;do j=j+(O.Prev.Pt.X+O.Pt.X)*(O.Prev.Pt.Y-O.Pt.Y),O=O.Next;while(O!=S.Pts);return j*.5},i.Clipper.SimplifyPolygon=function(S,O){var j=new Array,X=new i.Clipper(0);return X.StrictlySimple=!0,X.AddPath(S,i.PolyType.ptSubject,!0),X.Execute(i.ClipType.ctUnion,j,O,O),j},i.Clipper.SimplifyPolygons=function(S,O){typeof O>"u"&&(O=i.PolyFillType.pftEvenOdd);var j=new Array,X=new i.Clipper(0);return X.StrictlySimple=!0,X.AddPaths(S,i.PolyType.ptSubject,!0),X.Execute(i.ClipType.ctUnion,j,O,O),j},i.Clipper.DistanceSqrd=function(S,O){var j=S.X-O.X,X=S.Y-O.Y;return j*j+X*X},i.Clipper.DistanceFromLineSqrd=function(S,O,j){var X=O.Y-j.Y,ie=j.X-O.X,be=X*O.X+ie*O.Y;return be=X*S.X+ie*S.Y-be,be*be/(X*X+ie*ie)},i.Clipper.SlopesNearCollinear=function(S,O,j,X){return i.Clipper.DistanceFromLineSqrd(O,S,j)<X},i.Clipper.PointsAreClose=function(S,O,j){var X=S.X-O.X,ie=S.Y-O.Y;return X*X+ie*ie<=j},i.Clipper.ExcludeOp=function(S){var O=S.Prev;return O.Next=S.Next,S.Next.Prev=O,O.Idx=0,O},i.Clipper.CleanPolygon=function(S,O){typeof O>"u"&&(O=1.415);var j=S.length;if(j==0)return new Array;for(var X=new Array(j),ie=0;ie<j;++ie)X[ie]=new i.OutPt;for(var ie=0;ie<j;++ie)X[ie].Pt=S[ie],X[ie].Next=X[(ie+1)%j],X[ie].Next.Prev=X[ie],X[ie].Idx=0;for(var be=O*O,Ce=X[0];Ce.Idx==0&&Ce.Next!=Ce.Prev;)i.Clipper.PointsAreClose(Ce.Pt,Ce.Prev.Pt,be)?(Ce=i.Clipper.ExcludeOp(Ce),j--):i.Clipper.PointsAreClose(Ce.Prev.Pt,Ce.Next.Pt,be)?(i.Clipper.ExcludeOp(Ce.Next),Ce=i.Clipper.ExcludeOp(Ce),j-=2):i.Clipper.SlopesNearCollinear(Ce.Prev.Pt,Ce.Pt,Ce.Next.Pt,be)?(Ce=i.Clipper.ExcludeOp(Ce),j--):(Ce.Idx=1,Ce=Ce.Next);j<3&&(j=0);for(var Te=new Array(j),ie=0;ie<j;++ie)Te[ie]=new i.IntPoint(Ce.Pt),Ce=Ce.Next;return X=null,Te},i.Clipper.CleanPolygons=function(S,O){for(var j=new Array(S.length),X=0,ie=S.length;X<ie;X++)j[X]=i.Clipper.CleanPolygon(S[X],O);return j},i.Clipper.Minkowski=function(S,O,j,X){var ie=X?1:0,be=S.length,Ce=O.length,Te=new Array;if(j)for(var ct=0;ct<Ce;ct++){for(var _t=new Array(be),qt=0,sr=S.length,mr=S[qt];qt<sr;qt++,mr=S[qt])_t[qt]=new i.IntPoint(O[ct].X+mr.X,O[ct].Y+mr.Y);Te.push(_t)}else for(var ct=0;ct<Ce;ct++){for(var _t=new Array(be),qt=0,sr=S.length,mr=S[qt];qt<sr;qt++,mr=S[qt])_t[qt]=new i.IntPoint(O[ct].X-mr.X,O[ct].Y-mr.Y);Te.push(_t)}for(var xr=new Array,ct=0;ct<Ce-1+ie;ct++)for(var qt=0;qt<be;qt++){var lr=new Array;lr.push(Te[ct%Ce][qt%be]),lr.push(Te[(ct+1)%Ce][qt%be]),lr.push(Te[(ct+1)%Ce][(qt+1)%be]),lr.push(Te[ct%Ce][(qt+1)%be]),i.Clipper.Orientation(lr)||lr.reverse(),xr.push(lr)}var Er=new i.Clipper(0);return Er.AddPaths(xr,i.PolyType.ptSubject,!0),Er.Execute(i.ClipType.ctUnion,Te,i.PolyFillType.pftNonZero,i.PolyFillType.pftNonZero),Te},i.Clipper.MinkowskiSum=function(){var S=arguments,O=S.length;if(O==3){var j=S[0],X=S[1],ie=S[2];return i.Clipper.Minkowski(j,X,!0,ie)}else if(O==4){for(var j=S[0],be=S[1],Ce=S[2],ie=S[3],Te=new i.Clipper,ct,_t=0,qt=be.length;_t<qt;++_t){var ct=i.Clipper.Minkowski(j,be[_t],!0,ie);Te.AddPaths(ct,i.PolyType.ptSubject,!0)}ie&&Te.AddPaths(be,i.PolyType.ptClip,!0);var sr=new i.Paths;return Te.Execute(i.ClipType.ctUnion,sr,Ce,Ce),sr}},i.Clipper.MinkowskiDiff=function(S,O,j){return i.Clipper.Minkowski(S,O,!1,j)},i.Clipper.PolyTreeToPaths=function(S){var O=new Array;return i.Clipper.AddPolyNodeToPaths(S,i.Clipper.NodeType.ntAny,O),O},i.Clipper.AddPolyNodeToPaths=function(S,O,j){var X=!0;switch(O){case i.Clipper.NodeType.ntOpen:return;case i.Clipper.NodeType.ntClosed:X=!S.IsOpen;break}S.m_polygon.length>0&&X&&j.push(S.m_polygon);for(var ie=0,be=S.Childs(),Ce=be.length,Te=be[ie];ie<Ce;ie++,Te=be[ie])i.Clipper.AddPolyNodeToPaths(Te,O,j)},i.Clipper.OpenPathsFromPolyTree=function(S){for(var O=new i.Paths,j=0,X=S.ChildCount();j<X;j++)S.Childs()[j].IsOpen&&O.push(S.Childs()[j].m_polygon);return O},i.Clipper.ClosedPathsFromPolyTree=function(S){var O=new i.Paths;return i.Clipper.AddPolyNodeToPaths(S,i.Clipper.NodeType.ntClosed,O),O},si(i.Clipper,i.ClipperBase),i.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},i.ClipperOffset=function(S,O){typeof S>"u"&&(S=2),typeof O>"u"&&(O=i.ClipperOffset.def_arc_tolerance),this.m_destPolys=new i.Paths,this.m_srcPoly=new i.Path,this.m_destPoly=new i.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new i.IntPoint,this.m_polyNodes=new i.PolyNode,this.MiterLimit=S,this.ArcTolerance=O,this.m_lowest.X=-1},i.ClipperOffset.two_pi=6.28318530717959,i.ClipperOffset.def_arc_tolerance=.25,i.ClipperOffset.prototype.Clear=function(){i.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},i.ClipperOffset.Round=i.Clipper.Round,i.ClipperOffset.prototype.AddPath=function(S,O,j){var X=S.length-1;if(!(X<0)){var ie=new i.PolyNode;if(ie.m_jointype=O,ie.m_endtype=j,j==i.EndType.etClosedLine||j==i.EndType.etClosedPolygon)for(;X>0&&i.IntPoint.op_Equality(S[0],S[X]);)X--;ie.m_polygon.push(S[0]);for(var be=0,Ce=0,Te=1;Te<=X;Te++)i.IntPoint.op_Inequality(ie.m_polygon[be],S[Te])&&(be++,ie.m_polygon.push(S[Te]),(S[Te].Y>ie.m_polygon[Ce].Y||S[Te].Y==ie.m_polygon[Ce].Y&&S[Te].X<ie.m_polygon[Ce].X)&&(Ce=be));if(!(j==i.EndType.etClosedPolygon&&be<2||j!=i.EndType.etClosedPolygon&&be<0)&&(this.m_polyNodes.AddChild(ie),j==i.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new i.IntPoint(0,Ce);else{var ct=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(ie.m_polygon[Ce].Y>ct.Y||ie.m_polygon[Ce].Y==ct.Y&&ie.m_polygon[Ce].X<ct.X)&&(this.m_lowest=new i.IntPoint(this.m_polyNodes.ChildCount()-1,Ce))}}},i.ClipperOffset.prototype.AddPaths=function(S,O,j){for(var X=0,ie=S.length;X<ie;X++)this.AddPath(S[X],O,j)},i.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!i.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var S=0;S<this.m_polyNodes.ChildCount();S++){var O=this.m_polyNodes.Childs()[S];(O.m_endtype==i.EndType.etClosedPolygon||O.m_endtype==i.EndType.etClosedLine&&i.Clipper.Orientation(O.m_polygon))&&O.m_polygon.reverse()}else for(var S=0;S<this.m_polyNodes.ChildCount();S++){var O=this.m_polyNodes.Childs()[S];O.m_endtype==i.EndType.etClosedLine&&!i.Clipper.Orientation(O.m_polygon)&&O.m_polygon.reverse()}},i.ClipperOffset.GetUnitNormal=function(S,O){var j=O.X-S.X,X=O.Y-S.Y;if(j==0&&X==0)return new i.DoublePoint(0,0);var ie=1/Math.sqrt(j*j+X*X);return j*=ie,X*=ie,new i.DoublePoint(X,-j)},i.ClipperOffset.prototype.DoOffset=function(S){if(this.m_destPolys=new Array,this.m_delta=S,i.ClipperBase.near_zero(S)){for(var O=0;O<this.m_polyNodes.ChildCount();O++){var j=this.m_polyNodes.Childs()[O];j.m_endtype==i.EndType.etClosedPolygon&&this.m_destPolys.push(j.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var X;this.ArcTolerance<=0?X=i.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(S)*i.ClipperOffset.def_arc_tolerance?X=Math.abs(S)*i.ClipperOffset.def_arc_tolerance:X=this.ArcTolerance;var ie=3.14159265358979/Math.acos(1-X/Math.abs(S));this.m_sin=Math.sin(i.ClipperOffset.two_pi/ie),this.m_cos=Math.cos(i.ClipperOffset.two_pi/ie),this.m_StepsPerRad=ie/i.ClipperOffset.two_pi,S<0&&(this.m_sin=-this.m_sin);for(var O=0;O<this.m_polyNodes.ChildCount();O++){var j=this.m_polyNodes.Childs()[O];this.m_srcPoly=j.m_polygon;var be=this.m_srcPoly.length;if(!(be==0||S<=0&&(be<3||j.m_endtype!=i.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,be==1){if(j.m_jointype==i.JoinType.jtRound)for(var Ce=1,Te=0,ct=1;ct<=ie;ct++){this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+Ce*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y+Te*S)));var _t=Ce;Ce=Ce*this.m_cos-this.m_sin*Te,Te=_t*this.m_sin+Te*this.m_cos}else for(var Ce=-1,Te=-1,ct=0;ct<4;++ct)this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+Ce*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y+Te*S))),Ce<0?Ce=1:Te<0?Te=1:Ce=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var ct=0;ct<be-1;ct++)this.m_normals.push(i.ClipperOffset.GetUnitNormal(this.m_srcPoly[ct],this.m_srcPoly[ct+1]));if(j.m_endtype==i.EndType.etClosedLine||j.m_endtype==i.EndType.etClosedPolygon?this.m_normals.push(i.ClipperOffset.GetUnitNormal(this.m_srcPoly[be-1],this.m_srcPoly[0])):this.m_normals.push(new i.DoublePoint(this.m_normals[be-2])),j.m_endtype==i.EndType.etClosedPolygon){for(var qt=be-1,ct=0;ct<be;ct++)qt=this.OffsetPoint(ct,qt,j.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(j.m_endtype==i.EndType.etClosedLine){for(var qt=be-1,ct=0;ct<be;ct++)qt=this.OffsetPoint(ct,qt,j.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var sr=this.m_normals[be-1],ct=be-1;ct>0;ct--)this.m_normals[ct]=new i.DoublePoint(-this.m_normals[ct-1].X,-this.m_normals[ct-1].Y);this.m_normals[0]=new i.DoublePoint(-sr.X,-sr.Y),qt=0;for(var ct=be-1;ct>=0;ct--)qt=this.OffsetPoint(ct,qt,j.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var qt=0,ct=1;ct<be-1;++ct)qt=this.OffsetPoint(ct,qt,j.m_jointype);var mr;if(j.m_endtype==i.EndType.etOpenButt){var ct=be-1;mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[ct].X+this.m_normals[ct].X*S),i.ClipperOffset.Round(this.m_srcPoly[ct].Y+this.m_normals[ct].Y*S)),this.m_destPoly.push(mr),mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[ct].X-this.m_normals[ct].X*S),i.ClipperOffset.Round(this.m_srcPoly[ct].Y-this.m_normals[ct].Y*S)),this.m_destPoly.push(mr)}else{var ct=be-1;qt=be-2,this.m_sinA=0,this.m_normals[ct]=new i.DoublePoint(-this.m_normals[ct].X,-this.m_normals[ct].Y),j.m_endtype==i.EndType.etOpenSquare?this.DoSquare(ct,qt):this.DoRound(ct,qt)}for(var ct=be-1;ct>0;ct--)this.m_normals[ct]=new i.DoublePoint(-this.m_normals[ct-1].X,-this.m_normals[ct-1].Y);this.m_normals[0]=new i.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),qt=be-1;for(var ct=qt-1;ct>0;--ct)qt=this.OffsetPoint(ct,qt,j.m_jointype);j.m_endtype==i.EndType.etOpenButt?(mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*S)),this.m_destPoly.push(mr),mr=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*S),i.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*S)),this.m_destPoly.push(mr)):(qt=1,this.m_sinA=0,j.m_endtype==i.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},i.ClipperOffset.prototype.Execute=function(){var S=arguments,O=S[0]instanceof i.PolyTree;if(O){var j=S[0],X=S[1];j.Clear(),this.FixOrientations(),this.DoOffset(X);var ie=new i.Clipper(0);if(ie.AddPaths(this.m_destPolys,i.PolyType.ptSubject,!0),X>0)ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftPositive,i.PolyFillType.pftPositive);else{var be=i.Clipper.GetBounds(this.m_destPolys),Ce=new i.Path;if(Ce.push(new i.IntPoint(be.left-10,be.bottom+10)),Ce.push(new i.IntPoint(be.right+10,be.bottom+10)),Ce.push(new i.IntPoint(be.right+10,be.top-10)),Ce.push(new i.IntPoint(be.left-10,be.top-10)),ie.AddPath(Ce,i.PolyType.ptSubject,!0),ie.ReverseSolution=!0,ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftNegative,i.PolyFillType.pftNegative),j.ChildCount()==1&&j.Childs()[0].ChildCount()>0){var Te=j.Childs()[0];j.Childs()[0]=Te.Childs()[0];for(var ct=1;ct<Te.ChildCount();ct++)j.AddChild(Te.Childs()[ct])}else j.Clear()}}else{var j=S[0],X=S[1];i.Clear(j),this.FixOrientations(),this.DoOffset(X);var ie=new i.Clipper(0);if(ie.AddPaths(this.m_destPolys,i.PolyType.ptSubject,!0),X>0)ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftPositive,i.PolyFillType.pftPositive);else{var be=i.Clipper.GetBounds(this.m_destPolys),Ce=new i.Path;Ce.push(new i.IntPoint(be.left-10,be.bottom+10)),Ce.push(new i.IntPoint(be.right+10,be.bottom+10)),Ce.push(new i.IntPoint(be.right+10,be.top-10)),Ce.push(new i.IntPoint(be.left-10,be.top-10)),ie.AddPath(Ce,i.PolyType.ptSubject,!0),ie.ReverseSolution=!0,ie.Execute(i.ClipType.ctUnion,j,i.PolyFillType.pftNegative,i.PolyFillType.pftNegative),j.length>0&&j.splice(0,1)}}},i.ClipperOffset.prototype.OffsetPoint=function(S,O,j){if(this.m_sinA=this.m_normals[O].X*this.m_normals[S].Y-this.m_normals[S].X*this.m_normals[O].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return O;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_normals[O].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_normals[O].Y*this.m_delta))),this.m_destPoly.push(new i.IntPoint(this.m_srcPoly[S])),this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_normals[S].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_normals[S].Y*this.m_delta)));else switch(j){case i.JoinType.jtMiter:{var X=1+(this.m_normals[S].X*this.m_normals[O].X+this.m_normals[S].Y*this.m_normals[O].Y);X>=this.m_miterLim?this.DoMiter(S,O,X):this.DoSquare(S,O);break}case i.JoinType.jtSquare:this.DoSquare(S,O);break;case i.JoinType.jtRound:this.DoRound(S,O);break}return O=S,O},i.ClipperOffset.prototype.DoSquare=function(S,O){var j=Math.tan(Math.atan2(this.m_sinA,this.m_normals[O].X*this.m_normals[S].X+this.m_normals[O].Y*this.m_normals[S].Y)/4);this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_delta*(this.m_normals[O].X-this.m_normals[O].Y*j)),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_delta*(this.m_normals[O].Y+this.m_normals[O].X*j)))),this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_delta*(this.m_normals[S].X+this.m_normals[S].Y*j)),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_delta*(this.m_normals[S].Y-this.m_normals[S].X*j))))},i.ClipperOffset.prototype.DoMiter=function(S,O,j){var X=this.m_delta/j;this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+(this.m_normals[O].X+this.m_normals[S].X)*X),i.ClipperOffset.Round(this.m_srcPoly[S].Y+(this.m_normals[O].Y+this.m_normals[S].Y)*X)))},i.ClipperOffset.prototype.DoRound=function(S,O){for(var j=Math.atan2(this.m_sinA,this.m_normals[O].X*this.m_normals[S].X+this.m_normals[O].Y*this.m_normals[S].Y),X=i.Cast_Int32(i.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(j))),ie=this.m_normals[O].X,be=this.m_normals[O].Y,Ce,Te=0;Te<X;++Te)this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+ie*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+be*this.m_delta))),Ce=ie,ie=ie*this.m_cos-this.m_sin*be,be=Ce*this.m_sin+be*this.m_cos;this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[S].X+this.m_normals[S].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[S].Y+this.m_normals[S].Y*this.m_delta)))},i.Error=function(S){try{throw new Error(S)}catch(O){alert(O.message)}},i.JS={},i.JS.AreaOfPolygon=function(S,O){return O||(O=1),i.Clipper.Area(S)/(O*O)},i.JS.AreaOfPolygons=function(S,O){O||(O=1);for(var j=0,X=0;X<S.length;X++)j+=i.Clipper.Area(S[X]);return j/(O*O)},i.JS.BoundsOfPath=function(S,O){return i.JS.BoundsOfPaths([S],O)},i.JS.BoundsOfPaths=function(S,O){O||(O=1);var j=i.Clipper.GetBounds(S);return j.left/=O,j.bottom/=O,j.right/=O,j.top/=O,j},i.JS.Clean=function(X,O){if(!(X instanceof Array))return[];var j=X[0]instanceof Array,X=i.JS.Clone(X);if(typeof O!="number"||O===null)return i.Error("Delta is not a number in Clean()."),X;if(X.length===0||X.length==1&&X[0].length===0||O<0)return X;j||(X=[X]);for(var ie=X.length,be,Ce,Te,ct,_t,qt,sr,mr=[],xr=0;xr<ie;xr++)if(Ce=X[xr],be=Ce.length,be!==0){if(be<3){Te=Ce,mr.push(Te);continue}for(Te=Ce,ct=O*O,_t=Ce[0],qt=1,sr=1;sr<be;sr++)(Ce[sr].X-_t.X)*(Ce[sr].X-_t.X)+(Ce[sr].Y-_t.Y)*(Ce[sr].Y-_t.Y)<=ct||(Te[qt]=Ce[sr],_t=Ce[sr],qt++);_t=Ce[qt-1],(Ce[0].X-_t.X)*(Ce[0].X-_t.X)+(Ce[0].Y-_t.Y)*(Ce[0].Y-_t.Y)<=ct&&qt--,qt<be&&Te.splice(qt,be-qt),Te.length&&mr.push(Te)}return!j&&mr.length?mr=mr[0]:!j&&mr.length===0?mr=[]:j&&mr.length===0&&(mr=[[]]),mr},i.JS.Clone=function(S){if(!(S instanceof Array))return[];if(S.length===0)return[];if(S.length==1&&S[0].length===0)return[[]];var O=S[0]instanceof Array;O||(S=[S]);var j=S.length,X,ie,be,Ce,Te=new Array(j);for(ie=0;ie<j;ie++){for(X=S[ie].length,Ce=new Array(X),be=0;be<X;be++)Ce[be]={X:S[ie][be].X,Y:S[ie][be].Y};Te[ie]=Ce}return O||(Te=Te[0]),Te},i.JS.Lighten=function(S,O){if(!(S instanceof Array))return[];if(typeof O!="number"||O===null)return i.Error("Tolerance is not a number in Lighten()."),i.JS.Clone(S);if(S.length===0||S.length==1&&S[0].length===0||O<0)return i.JS.Clone(S);S[0]instanceof Array||(S=[S]);var j,X,ie,be,Ce,Te,ct,_t,qt,sr,mr,xr,lr,Er,on,ta,sn,Bl=S.length,sa=O*O,li=[];for(j=0;j<Bl;j++)if(ie=S[j],Te=ie.length,Te!=0){for(be=0;be<1e6;be++){for(Ce=[],Te=ie.length,ie[Te-1].X!=ie[0].X||ie[Te-1].Y!=ie[0].Y?(xr=1,ie.push({X:ie[0].X,Y:ie[0].Y}),Te=ie.length):xr=0,mr=[],X=0;X<Te-2;X++)ct=ie[X],qt=ie[X+1],_t=ie[X+2],ta=ct.X,sn=ct.Y,lr=_t.X-ta,Er=_t.Y-sn,(lr!==0||Er!==0)&&(on=((qt.X-ta)*lr+(qt.Y-sn)*Er)/(lr*lr+Er*Er),on>1?(ta=_t.X,sn=_t.Y):on>0&&(ta+=lr*on,sn+=Er*on)),lr=qt.X-ta,Er=qt.Y-sn,sr=lr*lr+Er*Er,sr<=sa&&(mr[X+1]=1,X++);for(Ce.push({X:ie[0].X,Y:ie[0].Y}),X=1;X<Te-1;X++)mr[X]||Ce.push({X:ie[X].X,Y:ie[X].Y});if(Ce.push({X:ie[Te-1].X,Y:ie[Te-1].Y}),xr&&ie.pop(),mr.length)ie=Ce;else break}Te=Ce.length,Ce[Te-1].X==Ce[0].X&&Ce[Te-1].Y==Ce[0].Y&&Ce.pop(),Ce.length>2&&li.push(Ce)}return!S[0]instanceof Array&&(li=li[0]),typeof li>"u"&&(li=[[]]),li},i.JS.PerimeterOfPath=function(S,O,j){if(typeof S>"u")return 0;var X=Math.sqrt,ie=0,be,Ce,Te=0,ct=0,_t=0,qt=0,sr=S.length;if(sr<2)return 0;for(O&&(S[sr]=S[0],sr++);--sr;)be=S[sr],Te=be.X,ct=be.Y,Ce=S[sr-1],_t=Ce.X,qt=Ce.Y,ie+=X((Te-_t)*(Te-_t)+(ct-qt)*(ct-qt));return O&&S.pop(),ie/j},i.JS.PerimeterOfPaths=function(S,O,j){j||(j=1);for(var X=0,ie=0;ie<S.length;ie++)X+=i.JS.PerimeterOfPath(S[ie],O,j);return X},i.JS.ScaleDownPath=function(S,O){var j,X;for(O||(O=1),j=S.length;j--;)X=S[j],X.X=X.X/O,X.Y=X.Y/O},i.JS.ScaleDownPaths=function(S,O){var j,X,ie;for(O||(O=1),j=S.length;j--;)for(X=S[j].length;X--;)ie=S[j][X],ie.X=ie.X/O,ie.Y=ie.Y/O},i.JS.ScaleUpPath=function(S,O){var j,X,ie=Math.round;for(O||(O=1),j=S.length;j--;)X=S[j],X.X=ie(X.X*O),X.Y=ie(X.Y*O)},i.JS.ScaleUpPaths=function(S,O){var j,X,ie,be=Math.round;for(O||(O=1),j=S.length;j--;)for(X=S[j].length;X--;)ie=S[j][X],ie.X=be(ie.X*O),ie.Y=be(ie.Y*O)},i.ExPolygons=function(){return[]},i.ExPolygon=function(){this.outer=null,this.holes=null},i.JS.AddOuterPolyNodeToExPolygons=function(S,O){var j=new i.ExPolygon;j.outer=S.Contour();var X=S.Childs(),ie=X.length;j.holes=new Array(ie);var be,Ce,Te,ct,_t,qt;for(Te=0;Te<ie;Te++)for(be=X[Te],j.holes[Te]=be.Contour(),ct=0,_t=be.Childs(),qt=_t.length;ct<qt;ct++)Ce=_t[ct],i.JS.AddOuterPolyNodeToExPolygons(Ce,O);O.push(j)},i.JS.ExPolygonsToPaths=function(S){var O,j,X,ie,be=new i.Paths;for(O=0,X=S.length;O<X;O++)for(be.push(S[O].outer),j=0,ie=S[O].holes.length;j<ie;j++)be.push(S[O].holes[j]);return be},i.JS.PolyTreeToExPolygons=function(S){var O=new i.ExPolygons,j,X,ie,be;for(X=0,ie=S.Childs(),be=ie.length;X<be;X++)j=ie[X],i.JS.AddOuterPolyNodeToExPolygons(j,O);return O},e.exports=i}),fWe=bt((t,e)=>{N(),function(){function r(u,c){var p=u.x-c.x,m=u.y-c.y;return p*p+m*m}s(r,"getSqDist");function i(u,c,p){var m=c.x,y=c.y,v=p.x-m,x=p.y-y;if(v!==0||x!==0){var E=((u.x-m)*v+(u.y-y)*x)/(v*v+x*x);E>1?(m=p.x,y=p.y):E>0&&(m+=v*E,y+=x*E)}return v=u.x-m,x=u.y-y,v*v+x*x}s(i,"getSqSegDist");function n(u,c){for(var p=u[0],m=[p],y,v=1,x=u.length;v<x;v++)y=u[v],r(y,p)>c&&(m.push(y),p=y);return p!==y&&m.push(y),m}s(n,"simplifyRadialDist");function a(u,c,p,m,y){for(var v=m,x,E=c+1;E<p;E++){var M=i(u[E],u[c],u[p]);M>v&&(x=E,v=M)}v>m&&(x-c>1&&a(u,c,x,m,y),y.push(u[x]),p-x>1&&a(u,x,p,m,y))}s(a,"simplifyDPStep");function o(u,c){var p=u.length-1,m=[u[0]];return a(u,0,p,c,m),m.push(u[p]),m}s(o,"simplifyDouglasPeucker");function l(u,c,p){if(u.length<=2)return u;var m=c!==void 0?c*c:1;return u=p?u:n(u,m),u=o(u,m),u}s(l,"simplify"),typeof define=="function"&&define.amd?define(function(){return l}):typeof e<"u"?(e.exports=l,e.exports.default=l):typeof self<"u"?self.simplify=l:window.simplify=l}()});N();N();var GO=class fC{constructor(e,r,i){$(this,"__type",fC.__type),$(this,"id",ga()),$(this,"latitude"),$(this,"longitude"),$(this,"floorId"),$(this,"verticalOffset");var n;if(typeof e=="object")this.latitude=e.latitude,this.longitude=e.longitude,this.floorId=e.floorId,this.verticalOffset=(n=e.verticalOffset)!=null?n:0;else{if(r==null)throw new Error("Coordinate longitude is required.");this.latitude=e,this.longitude=r,this.floorId=i,this.verticalOffset=0}}static is(e){return e.__type===fC.__type}get anchorTarget(){return this}get focusTarget(){return this}isEqual(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.floorId===e.floorId}toJSON(){return{__type:fC.__type,latitude:this.latitude,longitude:this.longitude,floor:this.floorId,verticalOffset:this.verticalOffset}}destroy(){}};s(GO,"Coordinate"),$(GO,"__type","coordinate");var mWe=GO,Rn=mWe;N();var uye=class{constructor(e){$(this,"id"),this.id=e}};s(uye,"BaseMetaData");var hg=uye,Od,bu,R0,qg,HO=class mC extends hg{constructor(e,r){super(r.mvfData.properties.id),$(this,"__type",mC.__type),Be(this,Od),Be(this,bu,{}),Be(this,R0),Be(this,qg),He(this,Od,e),He(this,R0,r.floorId),He(this,qg,r.mvfData)}static is(e){return e.__type===mC.__type}get locations(){return w(this,bu).locations?w(this,bu).locations:(w(this,bu).locations=(w(this,Od).locationIdsByNodeId[this.id]||[]).map(e=>w(this,Od).getById("enterprise-location",e)).filter(Boolean),w(this,bu).locations)}get space(){var e;return w(this,Od).getById("space",(e=w(this,Od).spaceIdsByNodeId[this.id])==null?void 0:e[0])}get floor(){let e=w(this,Od).getById("floor",w(this,R0));if(e==null)throw new Error("Floor ".concat(w(this,R0)," not found!"));return e}get coordinate(){if(w(this,bu).coordinate==null){let[e,r]=w(this,qg).geometry.coordinates;w(this,bu).coordinate=new Rn(r,e,w(this,R0))}return w(this,bu).coordinate}get externalId(){var e;return(e=w(this,qg).properties.externalId)!=null?e:""}get neighbors(){if(w(this,bu).neighbours==null){let e=w(this,qg).properties.neighbors.map(r=>{let i=w(this,Od).getById("node",r.id);if(i==null)throw new Error("Node ".concat(r.id," not found!"));return i});w(this,bu).neighbours=e}return w(this,bu).neighbours}get geoJSON(){return vt(Ee({},w(this,qg)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:mC.__type,id:this.id,floor:this.floor.id,coordinate:this.coordinate.toJSON(),neighbors:this.neighbors.map(e=>e.id)}}destroy(){for(let e of Object.keys(w(this,bu)))delete w(this,bu)[e]}};Od=new WeakMap,bu=new WeakMap,R0=new WeakMap,qg=new WeakMap,s(HO,"Node"),$(HO,"__type","node");var gWe=HO,qP=gWe;N();N();var O0,cye=class{constructor(e,r){$(this,"id"),Be(this,O0),this.id=e}get geoJSONBoundingBox(){return w(this,O0)?w(this,O0):"bbox"in this.geoJSON.geometry&&this.geoJSON.geometry.bbox?this.geoJSON.geometry.bbox:(He(this,O0,UA(this.geoJSON)),w(this,O0))}get geoJSON(){return{properties:null,type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}}};O0=new WeakMap,s(cye,"BaseMapData");var WP=cye,gy,wh,Mp,v2,gC,qO,WO=class yC extends WP{constructor(e,r){super(r.mvfData.id,e),Be(this,gC),$(this,"__type",yC.__type),Be(this,gy),Be(this,wh,{}),Be(this,Mp),Be(this,v2),He(this,gy,e),He(this,Mp,r.mvfData),He(this,v2,r.facadeId)}static is(e){return e.__type===yC.__type}get type(){return w(this,Mp).type}get name(){var e;return(e=dr(this,gC,qO).call(this,"name"))!=null?e:""}get shortName(){var e;return(e=dr(this,gC,qO).call(this,"shortName"))!=null?e:""}get externalId(){var e;return(e=w(this,Mp).externalId)!=null?e:""}get floors(){var e,r;if(w(this,wh).floors==null){let i=((r=(e=w(this,Mp).floors)!=null?e:w(this,Mp).maps)!=null?r:[]).reduce((n,a)=>{let o=w(this,gy).floorsById[a];return o&&n.push(o),n},[]);i.length===0&&Vt.error("Floor stack ".concat(this.id," has no floors")),w(this,wh).floors=i}return w(this,wh).floors}get defaultFloor(){if(w(this,wh).defaultFloor!=null)return w(this,wh).defaultFloor;let e=w(this,Mp).defaultFloor?w(this,gy).getById("floor",w(this,Mp).defaultFloor):void 0;return w(this,wh).defaultFloor=e||this.floors.reduce((r,i)=>Math.abs(i.elevation)<Math.abs(r.elevation)?i:r),w(this,wh).defaultFloor}get facade(){return w(this,v2)?w(this,gy).facadesById[w(this,v2)]:void 0}toJSON(){return{__type:yC.__type,id:this.id,name:this.name,shortName:this.shortName,type:this.type,floors:this.floors.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(w(this,wh)))delete w(this,wh)[e]}};gy=new WeakMap,wh=new WeakMap,Mp=new WeakMap,v2=new WeakMap,gC=new WeakSet,qO=s(function(t){return w(this,gy).getPropTranslation(this.__type,t,this.id,w(this,Mp)[t])},"#translate"),s(WO,"FloorStack"),$(WO,"__type","floor-stack");var yWe=WO,hye=yWe;N();N();N();N();N();N();var vC,fm,XO=class _C extends hg{constructor(e){super(String(ga())),$(this,"__type",_C.__type),Be(this,vC,{}),Be(this,fm),He(this,fm,e.mvfData)}static is(e){return e.__type===_C.__type}get url(){return w(this,fm).url}get name(){if("displayName"in w(this,fm))return w(this,fm).displayName;if("label"in w(this,fm))return w(this,fm).label}toJSON(){return{__type:_C.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(w(this,vC)))delete w(this,vC)[e]}};vC=new WeakMap,fm=new WeakMap,s(XO,"Hyperlink"),$(XO,"__type","hyperlink");var vWe=XO,i3=vWe;N();N();function n3(t){return typeof t=="string"?t:t.id}s(n3,"getId");function rz(t){return Array.isArray(t)&&Number.isFinite(t[0])&&Number.isFinite(t[1])}s(rz,"isPosition");var PD=8,dx=s(t=>typeof t=="number"?t.toFixed(PD):rz(t)?t[1].toFixed(PD)+"-"+t[0].toFixed(PD):t.map(e=>dx(e)).join("-"),"serializeCoords"),_We=s(t=>{let e=/^https:\/\/cdn\.mappedin\.com\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/,r=/^https:\/\/cdn-staging\.mappedin\.net\/[^/]+\/[^/]+\.[a-zA-Z0-9]+$/;return e.test(t)||r.test(t)},"isPrivateCdnAsset"),pye=s(t=>{if(!_We(t))return null;let e="";t.startsWith("https://")?(e="https://",t=t.slice(8)):t.startsWith("http://")&&(e="http://",t=t.slice(7));let[r,i,n]=t.split("/");return{origin:e+r,mapId:i,fileName:n}},"parseCdnAssetUrl"),xC,Wg,k0,ZO=class bC extends hg{constructor(e){super(String(ga())),$(this,"__type",bC.__type),Be(this,xC,{}),Be(this,Wg),Be(this,k0),He(this,Wg,e.mvfData),He(this,k0,e.mapData)}static is(e){return e.__type===bC.__type}get url(){let e=w(this,Wg).url;if(w(this,k0).tokenManager==null)return e;let r=pye(w(this,Wg).url);if(r==null)return e;let i=r.mapId;try{if(w(this,k0).tokenManager.isEnterpriseMode())return e;let n=w(this,k0).tokenManager.getSasToken(i).token;if(n==null||n==="")throw new Error("SAS token empty!");return"".concat(e,"?").concat(n)}catch(n){return Vt.error("Error getting SAS token for image",{error:n,url:e}),e}}get name(){return w(this,Wg).altText}get altText(){return w(this,Wg).altText}toJSON(){return{__type:bC.__type,id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(w(this,xC)))delete w(this,xC)[e]}};xC=new WeakMap,Wg=new WeakMap,k0=new WeakMap,s(ZO,"ImageMetaData"),$(ZO,"__type","image");var xWe=ZO,a3=xWe,_2,gp,mm,dye=class extends WP{constructor(e,r){super(r.properties.id,e),Be(this,_2),Be(this,gp),Be(this,mm,{}),He(this,_2,e),He(this,gp,r)}get externalId(){var e;return(e=w(this,gp).properties.externalId)!=null?e:""}get name(){var e,r,i,n,a;let o="";return"details"in w(this,gp).properties||(o=(e=w(this,gp).properties.externalId)!=null?e:""),o===""&&(o=(i=(r=w(this,gp).properties.details)==null?void 0:r.name)!=null?i:""),o===""&&(o=(a=(n=this.locationProfiles.find(l=>l.name&&l.name.length>0))==null?void 0:n.name)!=null?a:""),o}get description(){var e,r,i,n;let a=(r=(e=w(this,gp).properties.details)==null?void 0:e.description)!=null?r:"";return a===""&&(a=(n=(i=this.locationProfiles.find(o=>o.description&&o.description.length>0))==null?void 0:i.description)!=null?n:""),a}get images(){var e,r,i,n,a;if(w(this,mm).images!=null)return w(this,mm).images;let o=(i=(r=(e=w(this,gp).properties.details)==null?void 0:e.images)==null?void 0:r.map(l=>new a3({mvfData:l,mapData:w(this,_2)})))!=null?i:[];return(o==null||o.length===0)&&(o=(a=(n=this.locationProfiles.find(l=>l.images.length>0))==null?void 0:n.images)!=null?a:[]),w(this,mm).images=o,o}get links(){var e,r,i,n,a;if(w(this,mm).links!=null)return w(this,mm).links;let o=(i=(r=(e=w(this,gp).properties.details)==null?void 0:e.links)==null?void 0:r.map(l=>new i3({mvfData:l})))!=null?i:[];return(o==null||o.length===0)&&(o=(a=(n=this.locationProfiles.find(l=>l.links.length>0))==null?void 0:n.links)!=null?a:[]),w(this,mm).links=o,o}get locationProfiles(){var e;return(e=w(this,_2).locationProfilesByAttachedFeatureId[this.id])!=null?e:[]}};_2=new WeakMap,gp=new WeakMap,mm=new WeakMap,s(dye,"DetailedMapData");var mv=dye,wC,N0,x2,b2,YO=class AC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",AC.__type),Be(this,wC),Be(this,N0),Be(this,x2,{}),Be(this,b2),He(this,wC,e),He(this,N0,r.floorId),He(this,b2,r.mvfData)}static is(e){return e.__type===AC.__type}get center(){var e;if(w(this,x2).center==null){let[r,i]=(e=w(this,b2).properties.center)!=null?e:[0,0];w(this,x2).center=new Rn(i,r,w(this,N0))}return w(this,x2).center}get floor(){let e=w(this,wC).getById("floor",w(this,N0));if(e==null)throw new Error("Floor ".concat(w(this,N0)," not found!"));return e}get geoJSON(){return vt(Ee({},w(this,b2)),{properties:null})}get focusTarget(){return this}get anchorTarget(){return this.center}toJSON(){return{__type:AC.__type,id:this.id,name:this.name,floor:this.floor.id}}destroy(){}};wC=new WeakMap,N0=new WeakMap,x2=new WeakMap,b2=new WeakMap,s(YO,"Area"),$(YO,"__type","area");var bWe=YO,XP=bWe;N();var F0,gm,B0,w2,KO=class SC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",SC.__type),Be(this,F0),Be(this,gm),Be(this,B0),Be(this,w2),He(this,gm,{}),He(this,w2,r.mvfData),He(this,F0,e),He(this,B0,r.floorId)}static is(e){return e.__type===SC.__type}get floor(){let e=w(this,F0).getById("floor",w(this,B0));if(e==null)throw new Error("Floor ".concat(w(this,B0)," not found!"));return e}get center(){if(w(this,gm).center==null){let[[e,r],[i,n]]=w(this,w2).geometry.coordinates,a=(e+i)/2,o=(r+n)/2;w(this,gm).center=new Rn(o,a,w(this,B0))}return w(this,gm).center}get isExterior(){var e;let r=w(this,F0).obstructionIdByEntranceId[this.id],i=w(this,F0).getMVFFeatureById("obstruction",r);return(e=i==null?void 0:i.properties.footprintComponent)!=null?e:!1}get geoJSON(){return vt(Ee({},w(this,w2)),{properties:null})}get focusTarget(){return this.center}get anchorTarget(){return this.center}toJSON(){return{__type:SC.__type,id:this.id,name:this.name,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(w(this,gm)))delete w(this,gm)[e]}};F0=new WeakMap,gm=new WeakMap,B0=new WeakMap,w2=new WeakMap,s(KO,"Door"),$(KO,"__type","door");var wWe=KO,GA=wWe;N();var Xg,z0,$c,kd,JO=class MC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",MC.__type),Be(this,Xg),Be(this,z0),Be(this,$c,{}),Be(this,kd),He(this,Xg,e),He(this,z0,r.floorId),He(this,kd,r.mvfData)}getMvfData(){return w(this,kd)}static is(e){return e.__type===MC.__type}get type(){return fye(w(this,kd).properties.kind)}get locations(){if(w(this,$c).locations)return w(this,$c).locations;w(this,$c).locations=[];let e=w(this,Xg).mvfLocationsBySpaceId[w(this,kd).properties.id];if((e==null?void 0:e.length)>0)for(let r of e){let i=w(this,Xg).getById("enterprise-location",r.id);i&&w(this,$c).locations.push(i)}return w(this,$c).locations}get floor(){let e=w(this,Xg).getById("floor",w(this,z0));if(e==null)throw new Error("Floor ".concat(w(this,z0)," not found!"));return e}get doors(){return w(this,kd).properties.destinationNodes.reduce((e,r)=>{let i=w(this,Xg).doorsByNodeId[r];return i&&e.push(i),e},[])}get center(){var e;if(w(this,$c).center==null){let[r,i]=(e=w(this,kd).properties.center)!=null?e:[0,0];w(this,$c).center=new Rn(i,r,w(this,z0))}return w(this,$c).center}get geoJSON(){return vt(Ee({},w(this,kd)),{properties:null})}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}get anchorTarget(){return this.center}toJSON(){return{__type:MC.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(w(this,$c)))delete w(this,$c)[e]}};Xg=new WeakMap,z0=new WeakMap,$c=new WeakMap,kd=new WeakMap,s(JO,"Space"),$(JO,"__type","space");var AWe=JO,SWe=["room","hallway","exterior","void","connection.stairs","connection.elevator","poi"];function fye(t){if(t==null||t==="default")return"room";let e=t.toLowerCase();return SWe.includes(e)?e:"room"}s(fye,"validateSpaceType");var Zp=AWe;N();N();N();N();function rg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}s(rg,"getCoord");function gf(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}s(gf,"getCoords");function mye(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}s(mye,"featureOf");function HA(t){return t.type==="Feature"?t.geometry:t}s(HA,"getGeom");function gye(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}s(gye,"getType");Rr(GB(),1);N();Rr(PHe(),1);N();N();function yf(t,e,r){if(r===void 0&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=rg(t),n=HA(e),a=n.type,o=e.bbox,l=n.coordinates;if(o&&yye(i,o)===!1)return!1;a==="Polygon"&&(l=[l]);for(var u=!1,c=0;c<l.length&&!u;c++)if(QO(i,l[c][0],r.ignoreBoundary)){for(var p=!1,m=1;m<l[c].length&&!p;)QO(i,l[c][m],!r.ignoreBoundary)&&(p=!0),m++;p||(u=!0)}return u}s(yf,"booleanPointInPolygon");function QO(t,e,r){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],l=e[n][1],u=e[a][0],c=e[a][1],p=t[1]*(o-u)+l*(u-t[0])+c*(t[0]-o)===0&&(o-t[0])*(u-t[0])<=0&&(l-t[1])*(c-t[1])<=0;if(p)return!r;var m=l>t[1]!=c>t[1]&&t[0]<(u-o)*(t[1]-l)/(c-l)+o;m&&(i=!i)}return i}s(QO,"inRing");function yye(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}s(yye,"inBBox");N();N();function vye(t,e,r){r===void 0&&(r={});var i=rg(t),n=rg(e),a=eh(n[1]-i[1]),o=eh(n[0]-i[0]),l=eh(i[1]),u=eh(n[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(l)*Math.cos(u);return Xme(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)}s(vye,"distance");var U0=vye;N();(function(){function t(e,r,i){this.a=e,this.b=r,this.c=i;var n=r.x-e.x,a=r.y-e.y,o=i.x-e.x,l=i.y-e.y,u=n*(e.x+r.x)+a*(e.y+r.y),c=o*(e.x+i.x)+l*(e.y+i.y),p=2*(n*(i.y-r.y)-a*(i.x-r.x)),m,y;this.x=(l*u-a*c)/p,this.y=(n*c-o*u)/p,m=this.x-e.x,y=this.y-e.y,this.r=m*m+y*y}return s(t,"Triangle"),t})();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();Rr(Tge(),1);N();N();N();N();N();(function(){function t(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var r=0;r<this.length;r++)this.points[r].z=this.points[r].z||0;for(var r=0;r<this.length-1;r++){var i=this.points[r],n=this.points[r+1];this.centers.push({x:(i.x+n.x)/2,y:(i.y+n.y)/2,z:(i.z+n.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var r=0;r<this.centers.length-1;r++){var a=this.points[r+1].x-(this.centers[r].x+this.centers[r+1].x)/2,o=this.points[r+1].y-(this.centers[r].y+this.centers[r+1].y)/2,l=this.points[r+1].z-(this.centers[r].y+this.centers[r+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[r+1].x+this.sharpness*(this.centers[r].x+a),y:(1-this.sharpness)*this.points[r+1].y+this.sharpness*(this.centers[r].y+o),z:(1-this.sharpness)*this.points[r+1].z+this.sharpness*(this.centers[r].z+l)},{x:(1-this.sharpness)*this.points[r+1].x+this.sharpness*(this.centers[r+1].x+a),y:(1-this.sharpness)*this.points[r+1].y+this.sharpness*(this.centers[r+1].y+o),z:(1-this.sharpness)*this.points[r+1].z+this.sharpness*(this.centers[r+1].z+l)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return s(t,"Spline"),t.prototype.cacheSteps=function(e){var r=[],i=this.pos(0);r.push(0);for(var n=0;n<this.duration;n+=10){var a=this.pos(n),o=Math.sqrt((a.x-i.x)*(a.x-i.x)+(a.y-i.y)*(a.y-i.y)+(a.z-i.z)*(a.z-i.z));o>e&&(r.push(n),i=a)}return r},t.prototype.vector=function(e){var r=this.pos(e+10),i=this.pos(e-10);return{angle:180*Math.atan2(r.y-i.y,r.x-i.x)/3.14,speed:Math.sqrt((i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y)+(i.z-r.z)*(i.z-r.z))}},t.prototype.pos=function(e){var r=e-this.delay;r<0&&(r=0),r>this.duration&&(r=this.duration-1);var i=r/this.duration;if(i>=1)return this.points[this.length-1];var n=Math.floor((this.points.length-1)*i),a=(this.length-1)*i-n;return _ye(a,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])},t})();function _ye(t,e,r,i,n){var a=xye(t),o={x:n.x*a[0]+i.x*a[1]+r.x*a[2]+e.x*a[3],y:n.y*a[0]+i.y*a[1]+r.y*a[2]+e.y*a[3],z:n.z*a[0]+i.z*a[1]+r.z*a[2]+e.z*a[3]};return o}s(_ye,"bezier");function xye(t){var e=t*t,r=e*t;return[r,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}s(xye,"B");N();N();N();N();function bye(t,e){e===void 0&&(e={});var r=Number(t[0]),i=Number(t[1]),n=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[r,i],l=[r,a],u=[n,a],c=[n,i];return l_([[o,c,u,l,o]],e.properties,{bbox:t,id:e.id})}s(bye,"bboxPolygon");function wye(t){return bye(UA(t))}s(wye,"envelope");var MWe=wye;N();N();N();function kw(t,e,r,i){i===void 0&&(i={});var n=rg(t),a=eh(n[0]),o=eh(n[1]),l=eh(r),u=Zme(e,i.units),c=Math.asin(Math.sin(o)*Math.cos(u)+Math.cos(o)*Math.sin(u)*Math.cos(l)),p=a+Math.atan2(Math.sin(l)*Math.sin(u)*Math.cos(o),Math.cos(u)-Math.sin(o)*Math.sin(c)),m=JT(p),y=JT(c);return hf([m,y],i.properties)}s(kw,"destination");N();N();function iz(t,e,r){if(r===void 0&&(r={}),r.final===!0)return Aye(t,e);var i=rg(t),n=rg(e),a=eh(i[0]),o=eh(n[0]),l=eh(i[1]),u=eh(n[1]),c=Math.sin(o-a)*Math.cos(u),p=Math.cos(l)*Math.sin(u)-Math.sin(l)*Math.cos(u)*Math.cos(o-a);return JT(Math.atan2(c,p))}s(iz,"bearing");function Aye(t,e){var r=iz(e,t);return r=(r+180)%360,r}s(Aye,"calculateFinalBearing");N();function Sye(t,e){e===void 0&&(e={});var r=UA(t),i=(r[0]+r[2])/2,n=(r[1]+r[3])/2;return hf([i,n],e.properties,e)}s(Sye,"center");var nz=Sye;N();N();N();N();N();Rr(w9(),1);N();N();N();N();function Mye(t){if(!t)throw new Error("geojson is required");var e=[];return mf(t,function(r){Eye(r,e)}),Dw(e)}s(Mye,"lineSegment");function Eye(t,e){var r=[],i=t.geometry;if(i!==null){switch(i.type){case"Polygon":r=gf(i);break;case"LineString":r=[gf(i)]}r.forEach(function(n){var a=Cye(n,t.properties);a.forEach(function(o){o.id=e.length,e.push(o)})})}}s(Eye,"lineSegmentFeature");function Cye(t,e){var r=[];return t.reduce(function(i,n){var a=tg([i,n],e);return a.bbox=Iye(i,n),r.push(a),n}),r}s(Cye,"createSegments");function Iye(t,e){var r=t[0],i=t[1],n=e[0],a=e[1],o=r<n?r:n,l=i<a?i:a,u=r>n?r:n,c=i>a?i:a;return[o,l,u,c]}s(Iye,"bbox");var MW=Mye,EWe=Rr(HB(),1);function Tye(t,e){var r={},i=[];if(t.type==="LineString"&&(t=Vh(t)),e.type==="LineString"&&(e=Vh(e)),t.type==="Feature"&&e.type==="Feature"&&t.geometry!==null&&e.geometry!==null&&t.geometry.type==="LineString"&&e.geometry.type==="LineString"&&t.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var n=ek(t,e);return n&&i.push(n),Dw(i)}var a=(0,EWe.default)();return a.load(MW(e)),FO(MW(t),function(o){FO(a.search(o),function(l){var u=ek(o,l);if(u){var c=gf(u).join(",");r[c]||(r[c]=!0,i.push(u))}})}),Dw(i)}s(Tye,"lineIntersect");function ek(t,e){var r=gf(t),i=gf(e);if(r.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(i.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=r[0][0],a=r[0][1],o=r[1][0],l=r[1][1],u=i[0][0],c=i[0][1],p=i[1][0],m=i[1][1],y=(m-c)*(o-n)-(p-u)*(l-a),v=(p-u)*(a-c)-(m-c)*(n-u),x=(o-n)*(a-c)-(l-a)*(n-u);if(y===0)return null;var E=v/y,M=x/y;if(E>=0&&E<=1&&M>=0&&M<=1){var I=n+E*(o-n),P=a+E*(l-a);return hf([I,P])}return null}s(ek,"intersects");var ZP=Tye;function Pye(t,e,r){r===void 0&&(r={});var i=hf([1/0,1/0],{dist:1/0}),n=0;return mf(t,function(a){for(var o=gf(a),l=0;l<o.length-1;l++){var u=hf(o[l]);u.properties.dist=U0(e,u,r);var c=hf(o[l+1]);c.properties.dist=U0(e,c,r);var p=U0(u,c,r),m=Math.max(u.properties.dist,c.properties.dist),y=iz(u,c),v=kw(e,m,y+90,r),x=kw(e,m,y-90,r),E=ZP(tg([v.geometry.coordinates,x.geometry.coordinates]),tg([u.geometry.coordinates,c.geometry.coordinates])),M=null;E.features.length>0&&(M=E.features[0],M.properties.dist=U0(e,M,r),M.properties.location=n+U0(u,M,r)),u.properties.dist<i.properties.dist&&(i=u,i.properties.index=l,i.properties.location=n),c.properties.dist<i.properties.dist&&(i=c,i.properties.index=l+1,i.properties.location=n+p),M&&M.properties.dist<i.properties.dist&&(i=M,i.properties.index=l),n+=p}}),i}s(Pye,"nearestPointOnLine");var tk=Pye;N();N();N();Rr(GB(),1);N();N();N();N();N();N();function rk(t,e){return e===void 0&&(e={}),Qme(t,function(r,i){var n=i.geometry.coordinates;return r+U0(n[0],n[1],e)},0)}s(rk,"length");N();function Lye(t,e,r){var i=gf(r);if(gye(r)!=="LineString")throw new Error("line must be a LineString");var n=tk(r,t),a=tk(r,e),o;n.properties.index<=a.properties.index?o=[n,a]:o=[a,n];for(var l=[o[0].geometry.coordinates],u=o[0].properties.index+1;u<o[1].properties.index+1;u++)l.push(i[u]);return l.push(o[1].geometry.coordinates),tg(l,r.properties)}s(Lye,"lineSlice");var EW=Lye;N();N();N();N();function Dye(t,e,r){r===void 0&&(r={});for(var i=rg(t),n=gf(e),a=0;a<n.length-1;a++){var o=!1;if(r.ignoreEndVertices&&(a===0&&(o="start"),a===n.length-2&&(o="end"),a===0&&a+1===n.length-1&&(o="both")),Rye(n[a],n[a+1],i,o,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}s(Dye,"booleanPointOnLine");function Rye(t,e,r,i,n){var a=r[0],o=r[1],l=t[0],u=t[1],c=e[0],p=e[1],m=r[0]-l,y=r[1]-u,v=c-l,x=p-u,E=m*x-y*v;if(n!==null){if(Math.abs(E)>n)return!1}else if(E!==0)return!1;if(i){if(i==="start")return Math.abs(v)>=Math.abs(x)?v>0?l<a&&a<=c:c<=a&&a<l:x>0?u<o&&o<=p:p<=o&&o<u;if(i==="end")return Math.abs(v)>=Math.abs(x)?v>0?l<=a&&a<c:c<a&&a<=l:x>0?u<=o&&o<p:p<o&&o<=u;if(i==="both")return Math.abs(v)>=Math.abs(x)?v>0?l<a&&a<c:c<a&&a<l:x>0?u<o&&o<p:p<o&&o<u}else return Math.abs(v)>=Math.abs(x)?v>0?l<=a&&a<=c:c<=a&&a<=l:x>0?u<=o&&o<=p:p<=o&&o<=u;return!1}s(Rye,"isPointOnLineSegment");var CWe=Dye;N();N();N();N();Rr(Tge(),1);N();var CW=Math.PI/180,IW=180/Math.PI,Nw=s(function(t,e){this.lon=t,this.lat=e,this.x=CW*t,this.y=CW*e},"Coord");Nw.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Nw.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Nw(e,t)};var Oye=s(function(){this.coords=[],this.length=0},"LineString");Oye.prototype.move_to=function(t){this.length++,this.coords.push(t)};var az=s(function(t){this.properties=t||{},this.geometries=[]},"Arc");az.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}};az.prototype.wkt=function(){for(var t="",e="LINESTRING(",r=s(function(a){e+=a[0]+" "+a[1]+","},"collect"),i=0;i<this.geometries.length;i++){if(this.geometries[i].coords.length===0)return"LINESTRING(empty)";var n=this.geometries[i].coords;n.forEach(r),t+=e.substring(0,e.length-1)+")"}return t};var kye=s(function(t,e,r){if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Nw(t.x,t.y),this.end=new Nw(e.x,e.y),this.properties=r||{};var i=this.start.x-this.end.x,n=this.start.y-this.end.y,a=Math.pow(Math.sin(n/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)},"GreatCircle");kye.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),r=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+r*Math.cos(this.end.y)*Math.cos(this.end.x),n=e*Math.cos(this.start.y)*Math.sin(this.start.x)+r*Math.cos(this.end.y)*Math.sin(this.end.x),a=e*Math.sin(this.start.y)+r*Math.sin(this.end.y),o=IW*Math.atan2(a,Math.sqrt(Math.pow(i,2)+Math.pow(n,2))),l=IW*Math.atan2(n,i);return[l,o]};kye.prototype.Arc=function(t,e){var r=[];if(!t||t<=2)r.push([this.start.lon,this.start.lat]),r.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),n=0;n<t;++n){var a=i*n,o=this.interpolate(a);r.push(o)}for(var l=!1,u=0,c=e&&e.offset?e.offset:10,p=180-c,m=-180+c,y=360-c,v=1;v<r.length;++v){var x=r[v-1][0],E=r[v][0],M=Math.abs(E-x);M>y&&(E>p&&x<m||x>p&&E<m)?l=!0:M>u&&(u=M)}var I=[];if(l&&u<c){var P=[];I.push(P);for(var C=0;C<r.length;++C){var T=parseFloat(r[C][0]);if(C>0&&Math.abs(T-r[C-1][0])>y){var D=parseFloat(r[C-1][0]),F=parseFloat(r[C-1][1]),k=parseFloat(r[C][0]),B=parseFloat(r[C][1]);if(D>-180&&D<m&&k===180&&C+1<r.length&&r[C-1][0]>-180&&r[C-1][0]<m){P.push([-180,r[C][1]]),C++,P.push([r[C][0],r[C][1]]);continue}else if(D>p&&D<180&&k===-180&&C+1<r.length&&r[C-1][0]>p&&r[C-1][0]<180){P.push([180,r[C][1]]),C++,P.push([r[C][0],r[C][1]]);continue}if(D<m&&k>p){var U=D;D=k,k=U;var z=F;F=B,B=z}if(D>p&&k<m&&(k+=360),D<=180&&k>=180&&D<k){var q=(180-D)/(k-D),Z=q*B+(1-q)*F;P.push([r[C-1][0]>p?180:-180,Z]),P=[],P.push([r[C-1][0]>p?-180:180,Z]),I.push(P)}else P=[],I.push(P);P.push([T,r[C][1]])}else P.push([r[C][0],r[C][1]])}}else{var Q=[];I.push(Q);for(var V=0;V<r.length;++V)Q.push([r[V][0],r[V][1]])}for(var ae=new az(this.properties),Y=0;Y<I.length;++Y){var he=new Oye;ae.geometries.push(he);for(var J=I[Y],ne=0;ne<J.length;++ne)he.move_to(J[ne])}return ae};N();Rr(HB(),1);N();N();function o3(t,e){e===void 0&&(e={});var r=HA(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),r.type){case"Polygon":return Nye(r,e);case"MultiPolygon":return Fye(r,e);default:throw new Error("invalid poly")}}s(o3,"default");function Nye(t,e){e===void 0&&(e={});var r=HA(t),i=r.coordinates,n=e.properties?e.properties:t.type==="Feature"?t.properties:{};return oz(i,n)}s(Nye,"polygonToLine");function Fye(t,e){e===void 0&&(e={});var r=HA(t),i=r.coordinates,n=e.properties?e.properties:t.type==="Feature"?t.properties:{},a=[];return i.forEach(function(o){a.push(oz(o,n))}),Dw(a)}s(Fye,"multiPolygonToLine");function oz(t,e){return t.length>1?Hme(t,e):tg(t[0],e)}s(oz,"coordsToLine");N();N();N();N();Rr(HB(),1);Rr(Zge(),1);N();N();N();N();N();N();N();Rr(GB(),1);s(function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},"p00");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},"p01");s(function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},"p02");s(function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},"p03");s(function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},"p04");s(function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},"p05");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},"p06");s(function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},"p07");s(function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},"p08");s(function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},"p09");s(function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},"p10");s(function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},"p11");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},"p12");s(function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},"p13");s(function(){return[[0,0],[0,1],[1,1],[1,0]]},"p14");s(function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},"p15");s(function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},"p16");s(function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},"p17");s(function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},"p18");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},"p19");s(function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},"p20");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},"p21");s(function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},"p22");s(function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p23");s(function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},"p24");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},"p25");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},"p26");s(function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},"p27");s(function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},"p28");s(function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},"p29");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},"p30");s(function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},"p31");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p32");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},"p33");s(function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},"p34");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p35");s(function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},"p36");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},"p37");s(function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},"p38");s(function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},"p39");N();N();N();N();N();N();N();N();function Bye(t){return(t>0)-(t<0)||+t}s(Bye,"mathSign");function YP(t,e,r){var i=e[0]-t[0],n=e[1]-t[1],a=r[0]-e[0],o=r[1]-e[1];return Bye(i*o-a*n)}s(YP,"orientationIndex");function zye(t,e){var r=t.geometry.coordinates[0].map(function(o){return o[0]}),i=t.geometry.coordinates[0].map(function(o){return o[1]}),n=e.geometry.coordinates[0].map(function(o){return o[0]}),a=e.geometry.coordinates[0].map(function(o){return o[1]});return Math.max.apply(null,r)===Math.max.apply(null,n)&&Math.max.apply(null,i)===Math.max.apply(null,a)&&Math.min.apply(null,r)===Math.min.apply(null,n)&&Math.min.apply(null,i)===Math.min.apply(null,a)}s(zye,"envelopeIsEqual");function ik(t,e){return e.geometry.coordinates[0].every(function(r){return yf(hf(r),t)})}s(ik,"envelopeContains");function Uye(t,e){return t[0]===e[0]&&t[1]===e[1]}s(Uye,"coordinatesEqual");var IWe=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return s(t,"Node"),t.buildId=function(e){return e.join(",")},t.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(r){return r.from.id!==e.from.id})},t.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(r){return r.to.id!==e.to.id})},t.prototype.addOuterEdge=function(e){this.outerEdges.push(e),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var e=this;this.outerEdgesSorted||(this.outerEdges.sort(function(r,i){var n=r.to,a=i.to;if(n.coordinates[0]-e.coordinates[0]>=0&&a.coordinates[0]-e.coordinates[0]<0)return 1;if(n.coordinates[0]-e.coordinates[0]<0&&a.coordinates[0]-e.coordinates[0]>=0)return-1;if(n.coordinates[0]-e.coordinates[0]===0&&a.coordinates[0]-e.coordinates[0]===0)return n.coordinates[1]-e.coordinates[1]>=0||a.coordinates[1]-e.coordinates[1]>=0?n.coordinates[1]-a.coordinates[1]:a.coordinates[1]-n.coordinates[1];var o=YP(e.coordinates,n.coordinates,a.coordinates);if(o<0)return 1;if(o>0)return-1;var l=Math.pow(n.coordinates[0]-e.coordinates[0],2)+Math.pow(n.coordinates[1]-e.coordinates[1],2),u=Math.pow(a.coordinates[0]-e.coordinates[0],2)+Math.pow(a.coordinates[1]-e.coordinates[1],2);return l-u}),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(e){return this.sortOuterEdges(),this.outerEdges[e]},t.prototype.addInnerEdge=function(e){this.innerEdges.push(e)},t}(),TW=IWe;N();var TWe=function(){function t(e,r){this.from=e,this.to=r,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return s(t,"Edge"),t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(e){return this.from.id===e.from.id&&this.to.id===e.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return tg([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(e){return YP(e.from.coordinates,e.to.coordinates,this.to.coordinates)},t}(),PWe=TWe;N();var LWe=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return s(t,"EdgeRing"),t.prototype.push=function(e){this.edges.push(e),this.polygon=this.envelope=void 0},t.prototype.get=function(e){return this.edges[e]},Object.defineProperty(t.prototype,"length",{get:s(function(){return this.edges.length},"get"),enumerable:!0,configurable:!0}),t.prototype.forEach=function(e){this.edges.forEach(e)},t.prototype.map=function(e){return this.edges.map(e)},t.prototype.some=function(e){return this.edges.some(e)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var e=this,r=this.edges.reduce(function(o,l,u){return l.from.coordinates[1]>e.edges[o].from.coordinates[1]&&(o=u),o},0),i=(r===0?this.length:r)-1,n=(r+1)%this.length,a=YP(this.edges[i].from.coordinates,this.edges[r].from.coordinates,this.edges[n].from.coordinates);return a===0?this.edges[i].from.coordinates[0]>this.edges[n].from.coordinates[0]:a>0},t.prototype.toMultiPoint=function(){return qme(this.edges.map(function(e){return e.from.coordinates}))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var e=this.edges.map(function(r){return r.from.coordinates});return e.push(this.edges[0].from.coordinates),this.polygon=l_([e])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=MWe(this.toPolygon())},t.findEdgeRingContaining=function(e,r){var i=e.getEnvelope(),n,a;return r.forEach(function(o){var l=o.getEnvelope();if(a&&(n=a.getEnvelope()),!zye(l,i)&&ik(l,i)){for(var u=e.map(function(x){return x.from.coordinates}),c=void 0,p=s(function(x){o.some(function(E){return Uye(x,E.from.coordinates)})||(c=x)},"_loop_1"),m=0,y=u;m<y.length;m++){var v=y[m];p(v)}c&&o.inside(hf(c))&&(!a||ik(n,l))&&(a=o)}}),a},t.prototype.inside=function(e){return yf(e,this.toPolygon())},t}(),DWe=LWe;function Vye(t){if(!t)throw new Error("No geojson passed");if(t.type!=="FeatureCollection"&&t.type!=="GeometryCollection"&&t.type!=="MultiLineString"&&t.type!=="LineString"&&t.type!=="Feature")throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}s(Vye,"validateGeoJson");(function(){function t(){this.edges=[],this.nodes={}}return s(t,"Graph"),t.fromGeoJson=function(e){Vye(e);var r=new t;return mf(e,function(i){mye(i,"LineString","Graph::fromGeoJson"),Yme(i,function(n,a){if(n){var o=r.getNode(n),l=r.getNode(a);r.addEdge(o,l)}return a})}),r},t.prototype.getNode=function(e){var r=TW.buildId(e),i=this.nodes[r];return i||(i=this.nodes[r]=new TW(e)),i},t.prototype.addEdge=function(e,r){var i=new PWe(e,r),n=i.getSymetric();this.edges.push(i),this.edges.push(n)},t.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(r){return e.nodes[r]}).forEach(function(r){return e._removeIfDangle(r)})},t.prototype._removeIfDangle=function(e){var r=this;if(e.innerEdges.length<=1){var i=e.getOuterEdges().map(function(n){return n.to});this.removeNode(e),i.forEach(function(n){return r._removeIfDangle(n)})}},t.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(r){r.label===r.symetric.label&&(e.removeEdge(r.symetric),e.removeEdge(r))})},t.prototype._computeNextCWEdges=function(e){var r=this;typeof e>"u"?Object.keys(this.nodes).forEach(function(i){return r._computeNextCWEdges(r.nodes[i])}):e.getOuterEdges().forEach(function(i,n){e.getOuterEdge((n===0?e.getOuterEdges().length:n)-1).symetric.next=i})},t.prototype._computeNextCCWEdges=function(e,r){for(var i=e.getOuterEdges(),n,a,o=i.length-1;o>=0;--o){var l=i[o],u=l.symetric,c=void 0,p=void 0;l.label===r&&(c=l),u.label===r&&(p=u),!(!c||!p)&&(p&&(a=p),c&&(a&&(a.next=c,a=void 0),n||(n=c)))}a&&(a.next=n)},t.prototype._findLabeledEdgeRings=function(){var e=[],r=0;return this.edges.forEach(function(i){if(!(i.label>=0)){e.push(i);var n=i;do n.label=r,n=n.next;while(!i.isEqual(n));r++}}),e},t.prototype.getEdgeRings=function(){var e=this;this._computeNextCWEdges(),this.edges.forEach(function(i){i.label=void 0}),this._findLabeledEdgeRings().forEach(function(i){e._findIntersectionNodes(i).forEach(function(n){e._computeNextCCWEdges(n,i.label)})});var r=[];return this.edges.forEach(function(i){i.ring||r.push(e._findEdgeRing(i))}),r},t.prototype._findIntersectionNodes=function(e){var r=[],i=e,n=s(function(){var a=0;i.from.getOuterEdges().forEach(function(o){o.label===e.label&&++a}),a>1&&r.push(i.from),i=i.next},"_loop_1");do n();while(!e.isEqual(i));return r},t.prototype._findEdgeRing=function(e){var r=e,i=new DWe;do i.push(r),r.ring=i,r=r.next;while(!e.isEqual(r));return i},t.prototype.removeNode=function(e){var r=this;e.getOuterEdges().forEach(function(i){return r.removeEdge(i)}),e.innerEdges.forEach(function(i){return r.removeEdge(i)}),delete this.nodes[e.id]},t.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(r){return!r.isEqual(e)}),e.deleteEdge()},t})();N();function jye(t,e){var r=!0;return mf(t,function(i){mf(e,function(n){if(r===!1)return!1;r=$ye(i.geometry,n.geometry)})}),r}s(jye,"booleanDisjoint");function $ye(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!Wye(t.coordinates,e.coordinates);case"LineString":return!nk(e,t);case"Polygon":return!yf(t,e)}break;case"LineString":switch(e.type){case"Point":return!nk(t,e);case"LineString":return!Gye(t,e);case"Polygon":return!ak(e,t)}break;case"Polygon":switch(e.type){case"Point":return!yf(e,t);case"LineString":return!ak(t,e);case"Polygon":return!Hye(e,t)}}return!1}s($ye,"disjoint");function nk(t,e){for(var r=0;r<t.coordinates.length-1;r++)if(qye(t.coordinates[r],t.coordinates[r+1],e.coordinates))return!0;return!1}s(nk,"isPointOnLine");function Gye(t,e){var r=ZP(t,e);return r.features.length>0}s(Gye,"isLineOnLine");function ak(t,e){for(var r=0,i=e.coordinates;r<i.length;r++){var n=i[r];if(yf(n,t))return!0}var a=ZP(e,o3(t));return a.features.length>0}s(ak,"isLineInPoly");function Hye(t,e){for(var r=0,i=t.coordinates[0];r<i.length;r++){var n=i[r];if(yf(n,e))return!0}for(var a=0,o=e.coordinates[0];a<o.length;a++){var l=o[a];if(yf(l,t))return!0}var u=ZP(o3(t),o3(e));return u.features.length>0}s(Hye,"isPolyInPoly");function qye(t,e,r){var i=r[0]-t[0],n=r[1]-t[1],a=e[0]-t[0],o=e[1]-t[1],l=i*o-n*a;return l!==0?!1:Math.abs(a)>=Math.abs(o)?a>0?t[0]<=r[0]&&r[0]<=e[0]:e[0]<=r[0]&&r[0]<=t[0]:o>0?t[1]<=r[1]&&r[1]<=e[1]:e[1]<=r[1]&&r[1]<=t[1]}s(qye,"isPointOnLineSegment");function Wye(t,e){return t[0]===e[0]&&t[1]===e[1]}s(Wye,"compareCoords");var RWe=jye;N();N();N();Rr(Yge(),1);N();Rr(Yge(),1);N();function Xye(t,e){var r=!1;return mf(t,function(i){mf(e,function(n){if(r===!0)return!0;r=!RWe(i.geometry,n.geometry)})}),r}s(Xye,"booleanIntersects");N();Rr(hqe(),1);N();Rr(dqe(),1);N();N();function ok(t){for(var e=t,r=[];e.parent;)r.unshift(e),e=e.parent;return r}s(ok,"pathTo");function Zye(){return new lz(function(t){return t.f})}s(Zye,"getHeap");var sz={search:s(function(t,e,r,i){t.cleanDirty(),i=i||{};var n=i.heuristic||sz.heuristics.manhattan,a=i.closest||!1,o=Zye(),l=e;for(e.h=n(e,r),o.push(e);o.size()>0;){var u=o.pop();if(u===r)return ok(u);u.closed=!0;for(var c=t.neighbors(u),p=0,m=c.length;p<m;++p){var y=c[p];if(!(y.closed||y.isWall())){var v=u.g+y.getCost(u),x=y.visited;(!x||v<y.g)&&(y.visited=!0,y.parent=u,y.h=y.h||n(y,r),y.g=v,y.f=y.g+y.h,t.markDirty(y),a&&(y.h<l.h||y.h===l.h&&y.g<l.g)&&(l=y),x?o.rescoreElement(y):o.push(y))}}}return a?ok(l):[]},"search"),heuristics:{manhattan:s(function(t,e){var r=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return r+i},"manhattan"),diagonal:s(function(t,e){var r=1,i=Math.sqrt(2),n=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);return r*(n+a)+(i-2*r)*Math.min(n,a)},"diagonal")},cleanNode:s(function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null},"cleanNode")};function fx(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var r=0;r<t.length;r++){this.grid[r]=[];for(var i=0,n=t[r];i<n.length;i++){var a=new qA(r,i,n[i]);this.grid[r][i]=a,this.nodes.push(a)}}this.init()}s(fx,"Graph");fx.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)sz.cleanNode(this.nodes[t])};fx.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)sz.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]};fx.prototype.markDirty=function(t){this.dirtyNodes.push(t)};fx.prototype.neighbors=function(t){var e=[],r=t.x,i=t.y,n=this.grid;return n[r-1]&&n[r-1][i]&&e.push(n[r-1][i]),n[r+1]&&n[r+1][i]&&e.push(n[r+1][i]),n[r]&&n[r][i-1]&&e.push(n[r][i-1]),n[r]&&n[r][i+1]&&e.push(n[r][i+1]),this.diagonal&&(n[r-1]&&n[r-1][i-1]&&e.push(n[r-1][i-1]),n[r+1]&&n[r+1][i-1]&&e.push(n[r+1][i-1]),n[r-1]&&n[r-1][i+1]&&e.push(n[r-1][i+1]),n[r+1]&&n[r+1][i+1]&&e.push(n[r+1][i+1])),e};fx.prototype.toString=function(){for(var t=[],e=this.grid,r,i,n,a,o=0,l=e.length;o<l;o++){for(r=[],i=e[o],n=0,a=i.length;n<a;n++)r.push(i[n].weight);t.push(r.join(" "))}return t.join(`
`)};function qA(t,e,r){this.x=t,this.y=e,this.weight=r}s(qA,"GridNode");qA.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};qA.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?this.weight*1.41421:this.weight};qA.prototype.isWall=function(){return this.weight===0};function lz(t){this.content=[],this.scoreFunction=t}s(lz,"BinaryHeap");lz.prototype={push:s(function(t){this.content.push(t),this.sinkDown(this.content.length-1)},"push"),pop:s(function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},"pop"),remove:s(function(t){var e=this.content.indexOf(t),r=this.content.pop();e!==this.content.length-1&&(this.content[e]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},"remove"),size:s(function(){return this.content.length},"size"),rescoreElement:s(function(t){this.sinkDown(this.content.indexOf(t))},"rescoreElement"),sinkDown:s(function(t){for(var e=this.content[t];t>0;){var r=(t+1>>1)-1,i=this.content[r];if(this.scoreFunction(e)<this.scoreFunction(i))this.content[r]=e,this.content[t]=i,t=r;else break}},"sinkDown"),bubbleUp:s(function(t){for(var e=this.content.length,r=this.content[t],i=this.scoreFunction(r);;){var n=t+1<<1,a=n-1,o=null,l;if(a<e){var u=this.content[a];l=this.scoreFunction(u),l<i&&(o=a)}if(n<e){var c=this.content[n],p=this.scoreFunction(c);p<(o===null?i:l)&&(o=n)}if(o!==null)this.content[t]=this.content[o],this.content[o]=r,t=o;else break}},"bubbleUp")};N();N();N();N();N();N();N();N();function s3(){this._=null}s(s3,"RedBlackTree");function WA(t){t.U=t.C=t.L=t.R=t.P=t.N=null}s(WA,"RedBlackNode");s3.prototype={constructor:s3,insert:s(function(t,e){var r,i,n;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;r=t}else this._?(t=sk(this._),e.P=null,e.N=t,t.P=t.L=e,r=t):(e.P=e.N=null,this._=e,r=null);for(e.L=e.R=null,e.U=r,e.C=!0,t=e;r&&r.C;)i=r.U,r===i.L?(n=i.R,n&&n.C?(r.C=n.C=!1,i.C=!0,t=i):(t===r.R&&(V0(this,r),t=r,r=t.U),r.C=!1,i.C=!0,j0(this,i))):(n=i.L,n&&n.C?(r.C=n.C=!1,i.C=!0,t=i):(t===r.L&&(j0(this,r),t=r,r=t.U),r.C=!1,i.C=!0,V0(this,i))),r=t.U;this._.C=!1},"insert"),remove:s(function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,r,i=t.L,n=t.R,a,o;if(i?n?a=sk(n):a=i:a=n,e?e.L===t?e.L=a:e.R=a:this._=a,i&&n?(o=a.C,a.C=t.C,a.L=i,i.U=a,a!==n?(e=a.U,a.U=t.U,t=a.R,e.L=t,a.R=n,n.U=a):(a.U=e,e=a,t=a.R)):(o=t.C,t=a),t&&(t.U=e),!o){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(r=e.R,r.C&&(r.C=!1,e.C=!0,V0(this,e),r=e.R),r.L&&r.L.C||r.R&&r.R.C){(!r.R||!r.R.C)&&(r.L.C=!1,r.C=!0,j0(this,r),r=e.R),r.C=e.C,e.C=r.R.C=!1,V0(this,e),t=this._;break}}else if(r=e.L,r.C&&(r.C=!1,e.C=!0,j0(this,e),r=e.L),r.L&&r.L.C||r.R&&r.R.C){(!r.L||!r.L.C)&&(r.R.C=!1,r.C=!0,V0(this,r),r=e.L),r.C=e.C,e.C=r.L.C=!1,j0(this,e),t=this._;break}r.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}},"remove")};function V0(t,e){var r=e,i=e.R,n=r.U;n?n.L===r?n.L=i:n.R=i:t._=i,i.U=n,r.U=i,r.R=i.L,r.R&&(r.R.U=r),i.L=r}s(V0,"RedBlackRotateLeft");function j0(t,e){var r=e,i=e.L,n=r.U;n?n.L===r?n.L=i:n.R=i:t._=i,i.U=n,r.U=i,r.L=i.R,r.L&&(r.L.U=r),i.R=r}s(j0,"RedBlackRotateRight");function sk(t){for(;t.L;)t=t.L;return t}s(sk,"RedBlackFirst");var PW=s3;N();N();function F1(t,e,r,i){var n=[null,null],a=Il.push(n)-1;return n.left=t,n.right=e,r&&Fw(n,t,e,r),i&&Fw(n,e,t,i),dc[t.index].halfedges.push(a),dc[e.index].halfedges.push(a),n}s(F1,"createEdge");function $0(t,e,r){var i=[e,r];return i.left=t,i}s($0,"createBorderEdge");function Fw(t,e,r,i){!t[0]&&!t[1]?(t[0]=i,t.left=e,t.right=r):t.left===r?t[1]=i:t[0]=i}s(Fw,"setEdgeEnd");function Yye(t,e,r,i,n){var a=t[0],o=t[1],l=a[0],u=a[1],c=o[0],p=o[1],m=0,y=1,v=c-l,x=p-u,E;if(E=e-l,!(!v&&E>0)){if(E/=v,v<0){if(E<m)return;E<y&&(y=E)}else if(v>0){if(E>y)return;E>m&&(m=E)}if(E=i-l,!(!v&&E<0)){if(E/=v,v<0){if(E>y)return;E>m&&(m=E)}else if(v>0){if(E<m)return;E<y&&(y=E)}if(E=r-u,!(!x&&E>0)){if(E/=x,x<0){if(E<m)return;E<y&&(y=E)}else if(x>0){if(E>y)return;E>m&&(m=E)}if(E=n-u,!(!x&&E<0)){if(E/=x,x<0){if(E>y)return;E>m&&(m=E)}else if(x>0){if(E<m)return;E<y&&(y=E)}return!(m>0)&&!(y<1)||(m>0&&(t[0]=[l+m*v,u+m*x]),y<1&&(t[1]=[l+y*v,u+y*x])),!0}}}}}s(Yye,"clipEdge");function Kye(t,e,r,i,n){var a=t[1];if(a)return!0;var o=t[0],l=t.left,u=t.right,c=l[0],p=l[1],m=u[0],y=u[1],v=(c+m)/2,x=(p+y)/2,E,M;if(y===p){if(v<e||v>=i)return;if(c>m){if(!o)o=[v,r];else if(o[1]>=n)return;a=[v,n]}else{if(!o)o=[v,n];else if(o[1]<r)return;a=[v,r]}}else if(E=(c-m)/(y-p),M=x-E*v,E<-1||E>1)if(c>m){if(!o)o=[(r-M)/E,r];else if(o[1]>=n)return;a=[(n-M)/E,n]}else{if(!o)o=[(n-M)/E,n];else if(o[1]<r)return;a=[(r-M)/E,r]}else if(p<y){if(!o)o=[e,E*e+M];else if(o[0]>=i)return;a=[i,E*i+M]}else{if(!o)o=[i,E*i+M];else if(o[0]<e)return;a=[e,E*e+M]}return t[0]=o,t[1]=a,!0}s(Kye,"connectEdge");function Jye(t,e,r,i){for(var n=Il.length,a;n--;)(!Kye(a=Il[n],t,e,r,i)||!Yye(a,t,e,r,i)||!(Math.abs(a[0][0]-a[1][0])>Za||Math.abs(a[0][1]-a[1][1])>Za))&&delete Il[n]}s(Jye,"clipEdges");function Qye(t){return dc[t.index]={site:t,halfedges:[]}}s(Qye,"createCell");function eve(t,e){var r=t.site,i=e.left,n=e.right;return r===n&&(n=i,i=r),n?Math.atan2(n[1]-i[1],n[0]-i[0]):(r===i?(i=e[1],n=e[0]):(i=e[0],n=e[1]),Math.atan2(i[0]-n[0],n[1]-i[1]))}s(eve,"cellHalfedgeAngle");function uz(t,e){return e[+(e.left!==t.site)]}s(uz,"cellHalfedgeStart");function tve(t,e){return e[+(e.left===t.site)]}s(tve,"cellHalfedgeEnd");function rve(){for(var t=0,e=dc.length,r,i,n,a;t<e;++t)if((r=dc[t])&&(a=(i=r.halfedges).length)){var o=new Array(a),l=new Array(a);for(n=0;n<a;++n)o[n]=n,l[n]=eve(r,Il[i[n]]);for(o.sort(function(u,c){return l[c]-l[u]}),n=0;n<a;++n)l[n]=i[o[n]];for(n=0;n<a;++n)i[n]=l[n]}}s(rve,"sortCellHalfedges");function ive(t,e,r,i){var n=dc.length,a,o,l,u,c,p,m,y,v,x,E,M,I=!0;for(a=0;a<n;++a)if(o=dc[a]){for(l=o.site,c=o.halfedges,u=c.length;u--;)Il[c[u]]||c.splice(u,1);for(u=0,p=c.length;u<p;)x=tve(o,Il[c[u]]),E=x[0],M=x[1],m=uz(o,Il[c[++u%p]]),y=m[0],v=m[1],(Math.abs(E-y)>Za||Math.abs(M-v)>Za)&&(c.splice(u,0,Il.push($0(l,x,Math.abs(E-t)<Za&&i-M>Za?[t,Math.abs(y-t)<Za?v:i]:Math.abs(M-i)<Za&&r-E>Za?[Math.abs(v-i)<Za?y:r,i]:Math.abs(E-r)<Za&&M-e>Za?[r,Math.abs(y-r)<Za?v:e]:Math.abs(M-e)<Za&&E-t>Za?[Math.abs(v-e)<Za?y:t,e]:null))-1),++p);p&&(I=!1)}if(I){var P,C,T,D=1/0;for(a=0,I=null;a<n;++a)(o=dc[a])&&(l=o.site,P=l[0]-t,C=l[1]-e,T=P*P+C*C,T<D&&(D=T,I=o));if(I){var F=[t,e],k=[t,i],B=[r,i],U=[r,e];I.halfedges.push(Il.push($0(l=I.site,F,k))-1,Il.push($0(l,k,B))-1,Il.push($0(l,B,U))-1,Il.push($0(l,U,F))-1)}}for(a=0;a<n;++a)(o=dc[a])&&(o.halfedges.length||delete dc[a])}s(ive,"clipCells");N();var nve=[],cz;function ave(){WA(this),this.x=this.y=this.arc=this.site=this.cy=null}s(ave,"Circle");function Iy(t){var e=t.P,r=t.N;if(!(!e||!r)){var i=e.site,n=t.site,a=r.site;if(i!==a){var o=n[0],l=n[1],u=i[0]-o,c=i[1]-l,p=a[0]-o,m=a[1]-l,y=2*(u*m-c*p);if(!(y>=-1e-12)){var v=u*u+c*c,x=p*p+m*m,E=(m*v-c*x)/y,M=(u*x-p*v)/y,I=nve.pop()||new ave;I.arc=t,I.site=n,I.x=E+o,I.y=(I.cy=M+l)+Math.sqrt(E*E+M*M),t.circle=I;for(var P=null,C=Bw._;C;)if(I.y<C.y||I.y===C.y&&I.x<=C.x)if(C.L)C=C.L;else{P=C.P;break}else if(C.R)C=C.R;else{P=C;break}Bw.insert(P,I),P||(cz=I)}}}}s(Iy,"attachCircle");function Fy(t){var e=t.circle;e&&(e.P||(cz=e.N),Bw.remove(e),nve.push(e),WA(e),t.circle=null)}s(Fy,"detachCircle");var ove=[];function sve(){WA(this),this.edge=this.site=this.circle=null}s(sve,"Beach");function lk(t){var e=ove.pop()||new sve;return e.site=t,e}s(lk,"createBeach");function EC(t){Fy(t),c_.remove(t),ove.push(t),WA(t)}s(EC,"detachBeach");function lve(t){var e=t.circle,r=e.x,i=e.cy,n=[r,i],a=t.P,o=t.N,l=[t];EC(t);for(var u=a;u.circle&&Math.abs(r-u.circle.x)<Za&&Math.abs(i-u.circle.cy)<Za;)a=u.P,l.unshift(u),EC(u),u=a;l.unshift(u),Fy(u);for(var c=o;c.circle&&Math.abs(r-c.circle.x)<Za&&Math.abs(i-c.circle.cy)<Za;)o=c.N,l.push(c),EC(c),c=o;l.push(c),Fy(c);var p=l.length,m;for(m=1;m<p;++m)c=l[m],u=l[m-1],Fw(c.edge,u.site,c.site,n);u=l[0],c=l[p-1],c.edge=F1(u.site,c.site,null,n),Iy(u),Iy(c)}s(lve,"removeBeach");function uve(t){for(var e=t[0],r=t[1],i,n,a,o,l=c_._;l;)if(a=hz(l,r)-e,a>Za)l=l.L;else if(o=e-cve(l,r),o>Za){if(!l.R){i=l;break}l=l.R}else{a>-Za?(i=l.P,n=l):o>-Za?(i=l,n=l.N):i=n=l;break}Qye(t);var u=lk(t);if(c_.insert(i,u),!(!i&&!n)){if(i===n){Fy(i),n=lk(i.site),c_.insert(u,n),u.edge=n.edge=F1(i.site,u.site),Iy(i),Iy(n);return}if(!n){u.edge=F1(i.site,u.site);return}Fy(i),Fy(n);var c=i.site,p=c[0],m=c[1],y=t[0]-p,v=t[1]-m,x=n.site,E=x[0]-p,M=x[1]-m,I=2*(y*M-v*E),P=y*y+v*v,C=E*E+M*M,T=[(M*P-v*C)/I+p,(y*C-E*P)/I+m];Fw(n.edge,c,x,T),u.edge=F1(c,t,null,T),n.edge=F1(t,x,null,T),Iy(i),Iy(n)}}s(uve,"addBeach");function hz(t,e){var r=t.site,i=r[0],n=r[1],a=n-e;if(!a)return i;var o=t.P;if(!o)return-1/0;r=o.site;var l=r[0],u=r[1],c=u-e;if(!c)return l;var p=l-i,m=1/a-1/c,y=p/c;return m?(-y+Math.sqrt(y*y-2*m*(p*p/(-2*c)-u+c/2+n-a/2)))/m+i:(i+l)/2}s(hz,"leftBreakPoint");function cve(t,e){var r=t.N;if(r)return hz(r,e);var i=t.site;return i[1]===e?i[0]:1/0}s(cve,"rightBreakPoint");var Za=1e-6,c_,dc,Bw,Il;function hve(t,e,r){return(t[0]-r[0])*(e[1]-t[1])-(t[0]-e[0])*(r[1]-t[1])}s(hve,"triangleArea");function pve(t,e){return e[1]-t[1]||e[0]-t[0]}s(pve,"lexicographic");function uk(t,e){var r=t.sort(pve).pop(),i,n,a;for(Il=[],dc=new Array(t.length),c_=new PW,Bw=new PW;;)if(a=cz,r&&(!a||r[1]<a.y||r[1]===a.y&&r[0]<a.x))(r[0]!==i||r[1]!==n)&&(uve(r),i=r[0],n=r[1]),r=t.pop();else if(a)lve(a.arc);else break;if(rve(),e){var o=+e[0][0],l=+e[0][1],u=+e[1][0],c=+e[1][1];Jye(o,l,u,c),ive(o,l,u,c)}this.edges=Il,this.cells=dc,c_=Bw=Il=dc=null}s(uk,"Diagram");uk.prototype={constructor:uk,polygons:s(function(){var t=this.edges;return this.cells.map(function(e){var r=e.halfedges.map(function(i){return uz(e,t[i])});return r.data=e.site.data,r})},"polygons"),triangles:s(function(){var t=[],e=this.edges;return this.cells.forEach(function(r,i){if(l=(a=r.halfedges).length)for(var n=r.site,a,o=-1,l,u,c=e[a[l-1]],p=c.left===n?c.right:c.left;++o<l;)u=p,c=e[a[o]],p=c.left===n?c.right:c.left,u&&p&&i<u.index&&i<p.index&&hve(n,u,p)<0&&t.push([n.data,u.data,p.data])}),t},"triangles"),links:s(function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},"links"),find:s(function(t,e,r){for(var i=this,n,a=i._found||0,o=i.cells.length,l;!(l=i.cells[a]);)if(++a>=o)return null;var u=t-l.site[0],c=e-l.site[1],p=u*u+c*c;do l=i.cells[n=a],a=null,l.halfedges.forEach(function(m){var y=i.edges[m],v=y.left;if(!((v===l.site||!v)&&!(v=y.right))){var x=t-v[0],E=e-v[1],M=x*x+E*E;M<p&&(p=M,a=v.index)}});while(a!==null);return i._found=n,r==null||p<=r*r?l.site:null},"find")};N();N();N();N();N();N();N();N();N();N();N();N();Rr($A(),1);N();Rr(fqe(),1);N();N();N();function Sf(){return new zw}s(Sf,"default");function zw(){this.reset()}s(zw,"Adder");zw.prototype={constructor:zw,reset:s(function(){this.s=this.t=0},"reset"),add:s(function(t){ck(yE,t,this.t),ck(this,yE.s,this.s),this.s?this.t+=yE.t:this.s=yE.t},"add"),valueOf:s(function(){return this.s},"valueOf")};var yE=new zw;function ck(t,e,r){var i=t.s=e+r,n=i-e,a=i-n;t.t=e-a+(r-n)}s(ck,"add");N();var Jl=1e-6,Go=Math.PI,vc=Go/2,LW=Go/4,l3=Go*2,DW=Go/180,lf=Math.abs,XA=Math.atan,dve=Math.atan2,Dl=Math.cos,fve=Math.exp,mve=Math.log,qo=Math.sin,pz=Math.sqrt,gve=Math.tan;function yve(t){return t>1?0:t<-1?Go:Math.acos(t)}s(yve,"acos");function ZA(t){return t>1?vc:t<-1?-vc:Math.asin(t)}s(ZA,"asin");N();function dz(){}s(dz,"noop");N();Sf();Sf();N();N();function hk(t){var e=t[0],r=t[1],i=Dl(r);return[i*Dl(e),i*qo(e),qo(r)]}s(hk,"cartesian");function pk(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}s(pk,"cartesianCross");function dk(t){var e=pz(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}s(dk,"cartesianNormalizeInPlace");Sf();N();N();N();N();N();function fk(t,e){return[t>Go?t-l3:t<-Go?t+l3:t,e]}s(fk,"rotationIdentity");fk.invert=fk;N();N();function vve(){var t=[],e;return{point:s(function(r,i){e.push([r,i])},"point"),lineStart:s(function(){t.push(e=[])},"lineStart"),lineEnd:dz,rejoin:s(function(){t.length>1&&t.push(t.pop().concat(t.shift()))},"rejoin"),result:s(function(){var r=t;return t=[],e=null,r},"result")}}s(vve,"default");N();N();N();function _ve(t,e){return lf(t[0]-e[0])<Jl&&lf(t[1]-e[1])<Jl}s(_ve,"default");function A2(t,e,r,i){this.x=t,this.z=e,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}s(A2,"Intersection");function xve(t,e,r,i,n){var a=[],o=[],l,u;if(t.forEach(function(x){if(!((E=x.length-1)<=0)){var E,M=x[0],I=x[E],P;if(_ve(M,I)){for(n.lineStart(),l=0;l<E;++l)n.point((M=x[l])[0],M[1]);n.lineEnd();return}a.push(P=new A2(M,x,null,!0)),o.push(P.o=new A2(M,null,P,!1)),a.push(P=new A2(I,x,null,!1)),o.push(P.o=new A2(I,null,P,!0))}}),!!a.length){for(o.sort(e),mk(a),mk(o),l=0,u=o.length;l<u;++l)o[l].e=r=!r;for(var c=a[0],p,m;;){for(var y=c,v=!0;y.v;)if((y=y.n)===c)return;p=y.z,n.lineStart();do{if(y.v=y.o.v=!0,y.e){if(v)for(l=0,u=p.length;l<u;++l)n.point((m=p[l])[0],m[1]);else i(y.x,y.n.x,1,n);y=y.n}else{if(v)for(p=y.p.z,l=p.length-1;l>=0;--l)n.point((m=p[l])[0],m[1]);else i(y.x,y.p.x,-1,n);y=y.p}y=y.o,p=y.z,v=!v}while(!y.v);n.lineEnd()}}}s(xve,"default");function mk(t){if(e=t.length){for(var e,r=0,i=t[0],n;++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}s(mk,"link");N();N();N();function fz(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}s(fz,"default");N();function bve(t){return t.length===1&&(t=wve(t)),{left:s(function(e,r,i,n){for(i==null&&(i=0),n==null&&(n=e.length);i<n;){var a=i+n>>>1;t(e[a],r)<0?i=a+1:n=a}return i},"left"),right:s(function(e,r,i,n){for(i==null&&(i=0),n==null&&(n=e.length);i<n;){var a=i+n>>>1;t(e[a],r)>0?n=a:i=a+1}return i},"right")}}s(bve,"default");function wve(t){return function(e,r){return fz(t(e),r)}}s(wve,"ascendingComparator");var Ave=bve(fz);Ave.right;Ave.left;N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();function Sve(t){for(var e=t.length,r,i=-1,n=0,a,o;++i<e;)n+=t[i].length;for(a=new Array(n);--e>=0;)for(o=t[e],r=o.length;--r>=0;)a[--n]=o[r];return a}s(Sve,"default");N();N();N();N();N();N();N();N();N();var LD=Sf();function Mve(t,e){var r=e[0],i=e[1],n=[qo(r),-Dl(r),0],a=0,o=0;LD.reset();for(var l=0,u=t.length;l<u;++l)if(p=(c=t[l]).length)for(var c,p,m=c[p-1],y=m[0],v=m[1]/2+LW,x=qo(v),E=Dl(v),M=0;M<p;++M,y=P,x=T,E=D,m=I){var I=c[M],P=I[0],C=I[1]/2+LW,T=qo(C),D=Dl(C),F=P-y,k=F>=0?1:-1,B=k*F,U=B>Go,z=x*T;if(LD.add(dve(z*k*qo(B),E*D+z*Dl(B))),a+=U?F+k*l3:F,U^y>=r^P>=r){var q=pk(hk(m),hk(I));dk(q);var Z=pk(n,q);dk(Z);var Q=(U^F>=0?-1:1)*ZA(Z[2]);(i>Q||i===Q&&(q[0]||q[1]))&&(o+=U^F>=0?1:-1)}}return(a<-Jl||a<Jl&&LD<-Jl)^o&1}s(Mve,"default");N();N();Sf();N();N();N();N();N();Sf();Sf();N();N();N();function Eve(t){this._context=t}s(Eve,"PathContext");Eve.prototype={_radius:4.5,pointRadius:s(function(t){return this._radius=t,this},"pointRadius"),polygonStart:s(function(){this._line=0},"polygonStart"),polygonEnd:s(function(){this._line=NaN},"polygonEnd"),lineStart:s(function(){this._point=0},"lineStart"),lineEnd:s(function(){this._line===0&&this._context.closePath(),this._point=NaN},"lineEnd"),point:s(function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,l3);break}}},"point"),result:dz};N();Sf();N();function Cve(){this._string=[]}s(Cve,"PathString");Cve.prototype={_radius:4.5,_circle:gk(4.5),pointRadius:s(function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},"pointRadius"),polygonStart:s(function(){this._line=0},"polygonStart"),polygonEnd:s(function(){this._line=NaN},"polygonEnd"),lineStart:s(function(){this._point=0},"lineStart"),lineEnd:s(function(){this._line===0&&this._string.push("Z"),this._point=NaN},"lineEnd"),point:s(function(t,e){switch(this._point){case 0:{this._string.push("M",t,",",e),this._point=1;break}case 1:{this._string.push("L",t,",",e);break}default:{this._circle==null&&(this._circle=gk(this._radius)),this._string.push("M",t,",",e,this._circle);break}}},"point"),result:s(function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}else return null},"result")};function gk(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}s(gk,"circle");N();N();N();N();N();N();function OWe(t,e,r,i){return function(n,a){var o=e(a),l=n.invert(i[0],i[1]),u=vve(),c=e(u),p=!1,m,y,v,x={point:E,lineStart:I,lineEnd:P,polygonStart:s(function(){x.point=C,x.lineStart=T,x.lineEnd=D,y=[],m=[]},"polygonStart"),polygonEnd:s(function(){x.point=E,x.lineStart=I,x.lineEnd=P,y=Sve(y);var F=Mve(m,l);y.length?(p||(a.polygonStart(),p=!0),xve(y,Tve,F,r,a)):F&&(p||(a.polygonStart(),p=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),p&&(a.polygonEnd(),p=!1),y=m=null},"polygonEnd"),sphere:s(function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()},"sphere")};function E(F,k){var B=n(F,k);t(F=B[0],k=B[1])&&a.point(F,k)}s(E,"point");function M(F,k){var B=n(F,k);o.point(B[0],B[1])}s(M,"pointLine");function I(){x.point=M,o.lineStart()}s(I,"lineStart");function P(){x.point=E,o.lineEnd()}s(P,"lineEnd");function C(F,k){v.push([F,k]);var B=n(F,k);c.point(B[0],B[1])}s(C,"pointRing");function T(){c.lineStart(),v=[]}s(T,"ringStart");function D(){C(v[0][0],v[0][1]),c.lineEnd();var F=c.clean(),k=u.result(),B,U=k.length,z,q,Z;if(v.pop(),m.push(v),v=null,!!U){if(F&1){if(q=k[0],(z=q.length-1)>0){for(p||(a.polygonStart(),p=!0),a.lineStart(),B=0;B<z;++B)a.point((Z=q[B])[0],Z[1]);a.lineEnd()}return}U>1&&F&2&&k.push(k.pop().concat(k.shift())),y.push(k.filter(Ive))}}return s(D,"ringEnd"),x}}s(OWe,"default");function Ive(t){return t.length>1}s(Ive,"validSegment");function Tve(t,e){return((t=t.x)[0]<0?t[1]-vc-Jl:vc-t[1])-((e=e.x)[0]<0?e[1]-vc-Jl:vc-e[1])}s(Tve,"compareIntersection");function kWe(t){var e=NaN,r=NaN,i=NaN,n;return{lineStart:s(function(){t.lineStart(),n=1},"lineStart"),point:s(function(a,o){var l=a>0?Go:-Go,u=lf(a-e);lf(u-Go)<Jl?(t.point(e,r=(r+o)/2>0?vc:-vc),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(a,r),n=0):i!==l&&u>=Go&&(lf(e-i)<Jl&&(e-=i*Jl),lf(a-l)<Jl&&(a-=l*Jl),r=Pve(e,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),n=0),t.point(e=a,r=o),i=l},"point"),lineEnd:s(function(){t.lineEnd(),e=r=NaN},"lineEnd"),clean:s(function(){return 2-n},"clean")}}s(kWe,"clipAntimeridianLine");function Pve(t,e,r,i){var n,a,o=qo(t-r);return lf(o)>Jl?XA((qo(e)*(a=Dl(i))*qo(r)-qo(i)*(n=Dl(e))*qo(t))/(n*a*o)):(e+i)/2}s(Pve,"clipAntimeridianIntersect");function NWe(t,e,r,i){var n;if(t==null)n=r*vc,i.point(-Go,n),i.point(0,n),i.point(Go,n),i.point(Go,0),i.point(Go,-n),i.point(0,-n),i.point(-Go,-n),i.point(-Go,0),i.point(-Go,n);else if(lf(t[0]-e[0])>Jl){var a=t[0]<e[0]?Go:-Go;n=r*a/2,i.point(-a,n),i.point(0,n),i.point(a,n)}else i.point(e[0],e[1])}s(NWe,"clipAntimeridianInterpolate");N();N();function Lve(t){return function(e){var r=new u3;for(var i in t)r[i]=t[i];return r.stream=e,r}}s(Lve,"transformer");function u3(){}s(u3,"TransformStream");u3.prototype={constructor:u3,point:s(function(t,e){this.stream.point(t,e)},"point"),sphere:s(function(){this.stream.sphere()},"sphere"),lineStart:s(function(){this.stream.lineStart()},"lineStart"),lineEnd:s(function(){this.stream.lineEnd()},"lineEnd"),polygonStart:s(function(){this.stream.polygonStart()},"polygonStart"),polygonEnd:s(function(){this.stream.polygonEnd()},"polygonEnd")};N();N();Lve({point:s(function(t,e){this.stream.point(t*DW,e*DW)},"point")});N();N();N();N();function mz(t){return function(e,r){var i=Dl(e),n=Dl(r),a=t(i*n);return[a*n*qo(e),a*qo(r)]}}s(mz,"azimuthalRaw");function mx(t){return function(e,r){var i=pz(e*e+r*r),n=t(i),a=qo(n),o=Dl(n);return[dve(e*a,i*o),ZA(i&&r*a/i)]}}s(mx,"azimuthalInvert");var FWe=mz(function(t){return pz(2/(1+t))});FWe.invert=mx(function(t){return 2*ZA(t/2)});N();var BWe=mz(function(t){return(t=yve(t))&&t/qo(t)});BWe.invert=mx(function(t){return t});N();N();function Dve(t,e){return[t,mve(gve((vc+e)/2))]}s(Dve,"mercatorRaw");Dve.invert=function(t,e){return[t,2*XA(fve(e))-vc]};N();N();function yk(t,e){return[t,e]}s(yk,"equirectangularRaw");yk.invert=yk;N();function Rve(t,e){var r=Dl(e),i=Dl(t)*r;return[r*qo(t)/i,qo(e)/i]}s(Rve,"gnomonicRaw");Rve.invert=mx(XA);N();N();function Ove(t,e){var r=e*e,i=r*r;return[t*(.8707-.131979*r+i*(-.013791+i*(.003971*r-.001529*i))),e*(1.007226+r*(.015085+i*(-.044475+.028874*r-.005916*i)))]}s(Ove,"naturalEarth1Raw");Ove.invert=function(t,e){var r=e,i=25,n;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-e)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(lf(n)>Jl&&--i>0);return[t/(.8707+(a=r*r)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),r]};N();function kve(t,e){return[Dl(e)*qo(t),qo(e)]}s(kve,"orthographicRaw");kve.invert=mx(ZA);N();function Nve(t,e){var r=Dl(e),i=1+Dl(t)*r;return[r*qo(t)/i,qo(e)/i]}s(Nve,"stereographicRaw");Nve.invert=mx(function(t){return 2*XA(t)});N();function Fve(t,e){return[mve(gve((vc+e)/2)),-t]}s(Fve,"transverseMercatorRaw");Fve.invert=function(t,e){return[-e,2*XA(fve(t))-vc]};N();Rr($A(),1);N();Rr($A(),1);N();Rr($A(),1);N();N();Rr($A(),1);N();N();N();N();var Lh,aa,Xc,CC,vk,_k=class IC extends WP{constructor(e,r){super(r.mvfData.properties.id,e),Be(this,CC),$(this,"__type",IC.__type),Be(this,Lh),Be(this,aa,{}),Be(this,Xc),He(this,Lh,e),He(this,Xc,r.mvfData)}static is(e){return e.__type===IC.__type}get focusTarget(){return this}get name(){var e,r;return"name"in w(this,Xc).properties?(r=dr(this,CC,vk).call(this,"name"))!=null?r:"":(e=w(this,Xc).properties.externalId)!=null?e:""}get shortName(){var e,r;return"shortName"in w(this,Xc).properties?(r=dr(this,CC,vk).call(this,"shortName"))!=null?r:"":(e=w(this,Xc).properties.externalId)!=null?e:""}get externalId(){var e;return(e=w(this,Xc).properties.externalId)!=null?e:""}get elevation(){return w(this,Xc).properties.elevation}get spaces(){if(w(this,aa).spaces==null){let e=w(this,Lh).spaces.filter(r=>r.floor.id===this.id);w(this,aa).spaces=e}return w(this,aa).spaces}get geoJSON(){var e;return{type:"Feature",properties:null,geometry:(e=w(this,Xc).geometry)!=null?e:{type:"Polygon",coordinates:[]}}}get objects(){if(w(this,aa).objects==null){let e=w(this,Lh).objects.filter(r=>r.floor.id===this.id);w(this,aa).objects=e}return w(this,aa).objects}get connections(){if(w(this,aa).connections==null){let e=w(this,Lh).connections.filter(r=>r.floors.includes(this));w(this,aa).connections=e}return w(this,aa).connections}get doors(){if(w(this,aa).doors==null){let e=w(this,Lh).doors.filter(r=>r.floor.id===this.id);w(this,aa).doors=e}return w(this,aa).doors}get annotations(){if(w(this,aa).annotations==null){let e=w(this,Lh).annotations.filter(r=>r.floor.id===this.id);w(this,aa).annotations=e}return w(this,aa).annotations}get pois(){if(w(this,aa).pois==null){let e=w(this,Lh).pointsOfInterest.filter(r=>r.floor.id===this.id);w(this,aa).pois=e}return w(this,aa).pois}get floorStack(){if(w(this,aa).floorStack==null){let e=w(this,Lh).floorStacks.find(r=>r.floors.includes(this));w(this,aa).floorStack=e}return w(this,aa).floorStack}get center(){if(w(this,aa).center==null){let e=w(this,Xc).geometry;if(e==null)w(this,aa).center=new Rn({latitude:0,longitude:0,floorId:this.id});else{let r=nz(e);w(this,aa).center=new Rn({latitude:r.geometry.coordinates[1],longitude:r.geometry.coordinates[0],floorId:this.id})}}return w(this,aa).center}toJSON(){return{__type:IC.__type,id:this.id,name:this.name,shortName:this.shortName,elevation:this.elevation,spaces:this.spaces.map(e=>e.id),objects:this.objects.map(e=>e.id),connections:this.connections.map(e=>e.id),doors:this.doors.map(e=>e.id),annotations:this.annotations.map(e=>e.id),pois:this.pois.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(w(this,aa)))delete w(this,aa)[e]}};Lh=new WeakMap,aa=new WeakMap,Xc=new WeakMap,CC=new WeakSet,vk=s(function(t){let e=w(this,Xc).properties[t];return w(this,Lh).getPropTranslation(this.__type,t,this.id,e)},"#translate"),s(_k,"Floor"),$(_k,"__type","floor");var zWe=_k,jp=zWe;N();N();N();var Bve=s(t=>t!=null,"notNull");N();function c3(t){let e;if(Zp.is(t)||GA.is(t)||Ky.is(t)||XP.is(t)||ex.is(t))e=t.center;else if(QP.is(t)||e4.is(t))e=t.coordinate;else if(Rn.is(t))e=t;else if(qP.is(t))e=t.coordinate;else if(Uw.is(t))e=t.coordinates[0];else return;return e}s(c3,"getCoordinateFromStuffs");N();N();var S2={auto:!0,debug:!1,pitch:45,bearing:0,antialiasing:{enabled:!0},shadingAndOutlines:!0,outdoorView:{layersHiddenByGeometry:["building","building-top"]},imagePlacementOptions:{mode:"default"},flipImagesToFaceCamera:!0,multiFloorView:{enabled:!1,floorHeight:10}},N_="ExteriorWalls",KP="Walls",UWe=0,gz="InteriorDoors",yz="ExteriorDoors",rl="GeometryLayer",F_="LabelsLayer",By="MarkersLayer",xk="FootprintLayer",h3="OcclusionLayer",VWe="ImagesLayer",hw="FacadesLayer",jWe=["https://mappedin.auth0.com","https://mappedin-staging.auth0.com"],$We={orange:"#F26336",teal:"#057685",lightTeal:"#5DC7D0"};function zve(t){var e,r;(e=t.outdoorView)!=null&&e.enabled&&!((r=t.outdoorView)!=null&&r.token)&&Vt.error("Enable outdoor view requires a token. Provide token in `options.outdoorView.token`")}s(zve,"validateOptions");function Uve(t,e){var r,i,n,a,o,l;let u=((r=t==null?void 0:t.outdoorView)==null?void 0:r.token)||e.outdoorViewToken,c=vt(Ee(Ee({},S2),t),{outdoorView:Ee({enabled:((i=t==null?void 0:t.outdoorView)==null?void 0:i.enabled)===void 0?!!u:(n=t==null?void 0:t.outdoorView)==null?void 0:n.enabled,layersHiddenByGeometry:(a=S2.outdoorView)==null?void 0:a.layersHiddenByGeometry},t==null?void 0:t.outdoorView),bearing:(l=(o=t==null?void 0:t.bearing)!=null?o:e.naturalBearing)!=null?l:0,imagePlacementOptions:Ee(Ee({},S2.imagePlacementOptions),t==null?void 0:t.imagePlacementOptions),multiFloorView:Ee(Ee({},S2.multiFloorView),t==null?void 0:t.multiFloorView)});return u&&c.outdoorView&&(c.outdoorView.token=u),c}s(Uve,"handleShow3DMapOptionDefault");function Vve(t){let e={remove_watermark:!1};if(t)try{let r=RB(t);Object.assign(e,r.capabilities)}catch(r){Vt.error("Error decoding capabilities from token",r)}return e}s(Vve,"handleTokenCapabilities");var Zg,Ah,ym,bk=class TC extends mv{constructor(e,r){let i=Object.values(r.mvfDataByFloorId)[0];super(e,i),$(this,"__type",TC.__type),Be(this,Zg),Be(this,Ah),Be(this,ym),He(this,Ah,{}),He(this,Zg,e),He(this,ym,r.mvfDataByFloorId)}static is(e){return e.__type===TC.__type}get accessible(){var e;return(e=Object.values(w(this,ym))[0].properties.accessible)!=null?e:!1}get type(){var e,r;return(r=(e=Object.values(w(this,ym))[0].properties.kind)==null?void 0:e.split(".")[1])!=null?r:"unknown"}get extra(){return Object.values(w(this,ym))[0].properties.extra}get coordinates(){return w(this,Ah).coordinates==null&&(w(this,Ah).coordinates=Object.entries(w(this,ym)).map(([e,r])=>new Rn(r.geometry.coordinates[1],r.geometry.coordinates[0],e))),w(this,Ah).coordinates}get nodes(){return Object.values(w(this,ym))[0].properties.nodes.map(e=>w(this,Zg).getById("node",e))}get floors(){return this.coordinates.map(e=>e.floorId?w(this,Zg).getById("floor",e.floorId):void 0).filter(Bve)}get locationProfiles(){var e,r,i,n,a;if(w(this,Ah).locationProfiles!=null)return w(this,Ah).locationProfiles;let o=super.locationProfiles;if(o==null||o.length===0){let l=[(r=(e=this.coordinates[0])==null?void 0:e.longitude)!=null?r:0,(n=(i=this.coordinates[0])==null?void 0:i.latitude)!=null?n:0],u=dx(l),c=(a=w(this,Zg).mvfConnectionIdsByLatLon[u])!=null?a:[];for(let p of c){let m=w(this,Zg).locationProfilesByAttachedFeatureId[p];if(m!=null){o=m;break}}}return w(this,Ah).locationProfiles=o??[],o}get focusTarget(){return this.coordinates}toJSON(){return{__type:TC.__type,id:this.id,name:this.name,type:this.type,externalId:this.externalId,coordinates:this.coordinates.map(e=>e.toJSON()),floors:this.floors.map(e=>e.id),extra:this.extra}}destroy(){for(let e of Object.keys(w(this,Ah)))delete w(this,Ah)[e]}};Zg=new WeakMap,Ah=new WeakMap,ym=new WeakMap,s(bk,"Connection"),$(bk,"__type","connection");var GWe=bk,JP=GWe;N();var PC,G0,Yg,H0,wk=class LC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",LC.__type),Be(this,PC),Be(this,G0),Be(this,Yg,{}),Be(this,H0),He(this,PC,e),He(this,G0,r.floorId),He(this,H0,r.mvfData)}static is(e){return e.__type===LC.__type}get type(){let e=w(this,H0).properties.kind;return e==null&&(e="object"),e==="Desks"&&(e="desk"),e.toLowerCase()}get floor(){let e=w(this,PC).getById("floor",w(this,G0));if(e==null)throw new Error("Floor ".concat(w(this,G0)," not found!"));return e}get center(){var e;if(w(this,Yg).center==null){let[r,i]=(e=w(this,H0).properties.center)!=null?e:[0,0];w(this,Yg).center=new Rn(i,r,w(this,G0))}return w(this,Yg).center}get geoJSON(){return vt(Ee({},w(this,H0)),{properties:null})}get anchorTarget(){return this.center}get focusTarget(){return this.geoJSON.geometry.type==="Polygon"?this:this.center}toJSON(){return{__type:LC.__type,id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of globalThis.Object.keys(w(this,Yg)))w(this,Yg)[e]=null}};PC=new WeakMap,G0=new WeakMap,Yg=new WeakMap,H0=new WeakMap,s(wk,"MapObject"),$(wk,"__type","object");var HWe=wk,Ky=HWe;N();var DC,q0,Kg,M2,Ak=class RC extends mv{constructor(e,r){super(e,r.mvfData),$(this,"__type",RC.__type),Be(this,DC),Be(this,q0),Be(this,Kg,{}),Be(this,M2),He(this,DC,e),He(this,M2,r.mvfData),He(this,q0,r.floorId)}static is(e){return e.__type===RC.__type}get floor(){let e=w(this,DC).getById("floor",w(this,q0));if(e==null)throw new Error("Floor ".concat(w(this,q0)," not found!"));return e}get coordinate(){var e;if(w(this,Kg).coordinate==null){let[r,i]=(e=w(this,M2).geometry.coordinates)!=null?e:[0,0];w(this,Kg).coordinate=new Rn(i,r,w(this,q0))}return w(this,Kg).coordinate}get geoJSON(){return vt(Ee({},w(this,M2)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:RC.__type,id:this.id,name:this.name,floor:this.floor.id,coordinate:this.coordinate.toJSON()}}destroy(){for(let e in w(this,Kg))w(this,Kg)[e]=null}};DC=new WeakMap,q0=new WeakMap,Kg=new WeakMap,M2=new WeakMap,s(Ak,"PointOfInterest"),$(Ak,"__type","point-of-interest");var qWe=Ak,QP=qWe;N();var OC,W0,Jg,B1,kC,Sk,Mk=class NC extends mv{constructor(e,r){super(e,r.mvfData),Be(this,kC),$(this,"__type",NC.__type),Be(this,OC),Be(this,W0),Be(this,Jg,{}),Be(this,B1),He(this,OC,e),He(this,W0,r.floorId),He(this,B1,r.mvfData)}static is(e){return e.__type===NC.__type}get group(){return dr(this,kC,Sk).call(this).group}get type(){return dr(this,kC,Sk).call(this).type}get coordinate(){if(w(this,Jg).coordinate==null){let[e,r]=w(this,B1).geometry.coordinates;w(this,Jg).coordinate=new Rn(r,e,w(this,W0))}return w(this,Jg).coordinate}get floor(){let e=w(this,OC).getById("floor",w(this,W0));if(e==null)throw new Error("Floor ".concat(w(this,W0)," not found!"));return e}get geoJSON(){return vt(Ee({},w(this,B1)),{properties:null})}get focusTarget(){return this.coordinate}get anchorTarget(){return this.coordinate}toJSON(){return{__type:NC.__type,id:this.id,group:this.group,type:this.type,coordinate:this.coordinate.toJSON()}}destroy(){for(let e of Object.keys(w(this,Jg)))delete w(this,Jg)[e]}};OC=new WeakMap,W0=new WeakMap,Jg=new WeakMap,B1=new WeakMap,kC=new WeakSet,Sk=s(function(){let[t,e]=w(this,B1).properties.symbolId.split("--");return{group:t,type:e}},"#getGroupAndTypeFromSymbolId"),s(Mk,"Annotation"),$(Mk,"__type","annotation");var WWe=Mk,e4=WWe;N();var XWe=s((t,e)=>{var r,i,n,a,o,l,u,c,p,m,y;let v={},x={},E={},M={},I={},P={};for(let C of t["location.json"]||[]){let T=new Cj(e,{mvfData:C});if(v[C.id]=T,C.externalId&&(M[C.externalId]==null&&(M[C.externalId]=[]),M[C.externalId].push(T)),C.categories)for(let F of C.categories)I[F]==null&&(I[F]=[]),I[F].push(T);let D=[...(i=(r=C.obstructions)==null?void 0:r.map(F=>F.id))!=null?i:[],...(a=(n=C.spaces)==null?void 0:n.map(F=>F.id))!=null?a:[],...(l=(o=C.annotations)==null?void 0:o.map(F=>F.id))!=null?l:[],...(u=C.connections)!=null?u:[],...(p=(c=C.entrances)==null?void 0:c.map(F=>F.id))!=null?p:[],...(y=(m=C.areas)==null?void 0:m.map(F=>F.id))!=null?y:[]];for(let F of D)F&&(P[F]==null&&(P[F]=[]),P[F].push(T))}for(let C of t["category.json"]||[]){let T=new g6e(e,{mvfData:C});x[C.id]=T,C.parent&&(E[C.parent]==null&&(E[C.parent]=[]),E[C.parent].push(T))}return{locationCategoriesByParentId:E,locationProfilesById:v,locationCategoriesById:x,locationProfilesByExternalId:M,locationProfilesByCategoryId:I,locationProfilesByAttachedFeatureId:P}},"processMVFLocationProfilesAndCategories"),ZWe=s((t,e,r)=>{var i,n;let a={},o={},l={},u={},c={},p={},m={},y={},v={},x={},E={},M={},I=globalThis.Object.keys(t.space);for(let P of I){let C=t.space[P];if(C!=null)for(let T of C.features){M[T.properties.id]=P,m[T.properties.id]=T;for(let D of T.properties.destinationNodes)c[D]==null&&(c[D]=[]),c[D].push(T.properties.id);if(T.properties.kind==="desk-entrance"&&(p[T.properties.externalId]==null&&(p[T.properties.externalId]=[]),p[T.properties.externalId].push(...T.properties.destinationNodes)),!["void","desk-entrance"].includes((i=T.properties.kind)!=null?i:"")){if((n=T.properties.kind)!=null&&n.includes("connection")){let D=dx(T.geometry.coordinates);x[D]==null&&(x[D]=[]),x[D].push(T.properties.id);continue}if(T.properties.kind==="poi"){let D=new QP(r,{floorId:P,mvfData:T});l[T.properties.id]=D,v[P]||(v[P]=[]),v[P].push(T),T.properties.externalId&&(u[T.properties.externalId]==null&&(u[T.properties.externalId]=[]),u[T.properties.externalId].push(D))}else{let D=new Zp(r,{floorId:P,mvfData:T});a[T.properties.id]=D,T.properties.externalId&&(o[T.properties.externalId]==null&&(o[T.properties.externalId]=[]),o[T.properties.externalId].push(D)),y[P]||(y[P]=[]),y[P].push(T)}}}}for(let P in x){let C=x[P],T={};for(let F of C){let k=M[F],B=m[F],U=e==null?void 0:e["n_"+B.properties.id.split("s_")[1]];T[k]=vt(Ee({},B),{properties:vt(Ee({},B.properties),{accessible:(U==null?void 0:U.accessible)===!0})})}let D=new JP(r,{mvfDataByFloorId:T});E[D.id]=D}return{spacesById:a,spacesByExternalId:o,poisById:l,poisByExternalId:u,connectionsById:E,spaceIdsByDestinationNodeId:c,objectEntranceNodeIdsByObstructionId:p,mvfSpacesById:m,connectionIdsByLatLon:x,mvfSpacesByFloorId:y,mvfPoisByFloorId:v}},"processMVFSpaces"),YWe=s((t,e)=>{var r,i;let n={},a={},o={},l={};for(let u of t["node.geojson"].features){o[u.properties.id]=u;let c=new qP(e,{mvfData:u,floorId:(r=u.properties.floor)!=null?r:u.properties.map});n[u.properties.id]=c,u.properties.externalId&&(a[u.properties.externalId]==null&&(a[u.properties.externalId]=[]),a[u.properties.externalId].push(c));let p=(i=u.properties.floor)!=null?i:u.properties.map;l[p]||(l[p]=[]),l[p].push(u)}return{nodesById:n,nodesByExternalId:a,mvfNodesById:o,mvfNodesByFloorId:l}},"processMVFNodes"),KWe=s((t,e)=>{let r={},i={},n={},a={},o=globalThis.Object.keys(t.obstruction);for(let l of o){let u=t.obstruction[l];if(u!=null)for(let c of u.features){n[c.properties.id]=c;for(let m of c.properties.entrances)a[m]=c.properties.id;if(c.properties.kind==="Wall")continue;let p=new Ky(e,{floorId:l,mvfData:c});r[c.properties.id]=p,c.properties.externalId&&(i[c.properties.externalId]==null&&(i[c.properties.externalId]=[]),i[c.properties.externalId].push(p))}}return{objectsById:r,objectsByExternalId:i,mvfObstructionById:n,obstructionIdByEntranceId:a}},"processMVFObstructions"),JWe=s((t,e)=>{let r={},i={},n={};if("floor.geojson"in t&&t["floor.geojson"]!=null)for(let a of t["floor.geojson"].features){n[a.properties.id]=a.properties;let o=new jp(e,{mvfData:a});r[a.properties.id]=o,a.properties.externalId&&(i[a.properties.externalId]==null&&(i[a.properties.externalId]=[]),i[a.properties.externalId].push(o))}else for(let a of t["map.geojson"]){n[a.id]=a;let o=new jp(e,{mvfData:{properties:a}});r[a.id]=o}return{floorsById:r,floorsByExternalId:i,mvfFloorsById:n}},"processMVFFloors"),QWe=s((t,e)=>{var r;let i={},n={},a={},o={},l={},u=t["floorstack.json"]||t["mapstack.json"]||t["mapstack.geojson"];if(u!=null)for(let c of u){let p=(r=t.facade)==null?void 0:r[c.id],m=new hye(e,{mvfData:c,facadeId:p==null?void 0:p.id});if(i[c.id]=m,c.externalId&&(n[c.externalId]==null&&(n[c.externalId]=[]),n[c.externalId].push(m)),a[c.id]=c,p){let y=new ex(e,{mvfData:p,floorStackId:c.id});o[p.id]=y;for(let v of p.spaces)l[v.spaceId]=y}}return{floorStacksById:i,floorStacksByExternalId:n,mvfFloorStacksById:a,facadesById:o,facadesBySpaceId:l}},"processMVFFloorStacks"),eXe=s((t,e)=>{let r={},i={},n=t["connection.json"].reduce((a,o)=>{o.nodes.forEach(u=>a[u]=o),r[o.id]=o;let l=e==null?void 0:e[o.nodes[0]];if(l!=null){let u=dx(l.geometry.coordinates);i[u]==null&&(i[u]=[]),i[u].push(o.id)}return a},{});return{mvfConnectionsById:r,mvfConnectionsByNodeId:n,mvfConnectionIdsByLatLon:i}},"processMVFConnections"),tXe=s((t,e)=>{let r={},i={},n={},a={},o={},l=globalThis.Object.keys(t.entrance);for(let u of l){let c=t.entrance[u];if(c!=null)for(let p of c.features){a[p.properties.id]=p;let m=new GA(e,{floorId:u,mvfData:p});p.properties.node&&(n[p.properties.node]=m),r[p.properties.id]=m,p.properties.externalId&&(i[p.properties.externalId]==null&&(i[p.properties.externalId]=[]),i[p.properties.externalId].push(m)),o[u]||(o[u]=[]),o[u].push(p)}}return{doorsById:r,doorsByExternalId:i,doorsByNodeId:n,mvfEntrancesById:a,mvfEntrancesByFloorId:o}},"processMVFEntrances"),rXe=s((t,e,r)=>{var i;if(t.textAreas!=null)for(let n in t.textAreas){let a=(i=t.textAreas[n])==null?void 0:i.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let l=o==null?void 0:o.properties,u=e[l.anchorId]||r[l.anchorId];if(u!=null&&l!=null){let c=u.properties;c.textArea=l,c.textArea&&(c.textArea.position=o.geometry.coordinates)}}}}},"processMVFTextAreas"),iXe=s((t,e,r)=>{var i;if(t.floorImages!=null)for(let n in t.floorImages){let a=(i=t.floorImages[n])==null?void 0:i.features;if(a!=null){for(let o of a)if("anchorId"in o.properties){let l=o==null?void 0:o.properties,u=e[l.anchorId]||r[l.anchorId];if(u!=null&&l!=null){let c=u.properties;c.image=l,c.image&&(c.image.position=o.geometry.coordinates)}}}}},"processMVFPolygonImages"),nXe=s((t,e)=>{var r,i;if(((r=t.enterprise)==null?void 0:r.enterpriseStyles)==null)return;let n=(i=t.enterprise)==null?void 0:i.enterpriseStyles;for(let a in n){let o=n[a];o.geometryAnchors.forEach(l=>{let u=e[l.geometryId];if(u!=null){let c=u.properties;c.style={styleId:a,edgeOffset:o.edgeOffset}}})}},"processMVFEnterprisePolygonStyles"),aXe=s((t,e,r)=>{if(!(t.enterprise==null||t.enterprise.textures==null))for(let i of t.enterprise.textures)for(let n of i.geometryAnchors){let a=e[n.geometryId]||r[n.geometryId];if(a!=null){let o=a.properties;o.textures==null&&(o.textures=[]),o.textures.push(i)}}},"processMVFEnterpriseTextures"),oXe=s((t,e)=>{let r={},i={},n={};if(t.annotation==null)return{annotationsById:r,mvfAnnotationsById:i,mvfAnnotationsByFloorId:n};let a=globalThis.Object.keys(t.annotation);for(let o of a){let l=t.annotation[o];if(l!=null)for(let u of l.features){i[u.properties.id]=u;let c=new e4(e,{floorId:o,mvfData:u});r[u.properties.id]=c,n[o]||(n[o]=[]),n[o].push(u)}}return{annotationsById:r,mvfAnnotationsById:i,mvfAnnotationsByFloorId:n}},"processMVFAnnotations"),sXe=s((t,e)=>{let r={},i={},n={};if(t.area==null)return{areasById:r,areasByExternalId:i,mvfAreasById:n};let a=globalThis.Object.keys(t.area);for(let o of a){let l=t.area[o];if(l!=null)for(let u of l.features){n[u.properties.id]=u;let c=new XP(e,{floorId:o,mvfData:u});r[u.properties.id]=c,u.properties.externalId&&(i[u.properties.externalId]==null&&(i[u.properties.externalId]=[]),i[u.properties.externalId].push(c))}}return{areasById:r,areasByExternalId:i,mvfAreasById:n}},"processMVFAreas"),lXe=s((t,e)=>{var r,i,n,a,o,l,u,c,p,m,y,v,x;let E={},M={},I={},P={},C=((i=(r=t.enterprise)==null?void 0:r.locations)!=null?i:[]).reduce((V,ae)=>(V[ae.id]=ae,V),{}),T={},D={},F={},k={},B={},U={},z=((n=t.enterprise)==null?void 0:n.venue)||{},q={},Z={};for(let V of(o=(a=t.enterprise)==null?void 0:a.categories)!=null?o:[]){let ae=new e0e(e,{mvfData:V});T[V.id]=ae,V.externalId&&(D[V.externalId]==null&&(D[V.externalId]=[]),D[V.externalId].push(ae)),F[V.id]=V,V.locations.forEach(Y=>{B[Y]==null&&(B[Y]=[]),B[Y].push(V.id)})}let Q={};for(let V of(u=(l=t.enterprise)==null?void 0:l.locationInstances)!=null?u:[]){let ae=C[V.parent],Y=Object.keys(ae),he={};for(let ne of Y)he[ne]=void 0;let J=Ee(vt(Ee({},he),{polygons:[],nodes:[]}),V);Q[J.parent]==null&&(Q[J.parent]=[]),Q[J.parent].push(new Uw(e,{mvfData:J,categoryIds:((p=(c=t.enterprise)==null?void 0:c.categoryPriorities)==null?void 0:p[J.id])||B[J.id],parentId:V.parent})),q[J.id]=V}for(let V in t.space){let ae=t.space[V];if(ae!=null)for(let Y of ae.features)for(let he of Y.properties.destinationNodes)Z[he]==null&&(Z[he]=[]),Z[he].push(Y.properties.id)}for(let V of(y=(m=t.enterprise)==null?void 0:m.locations)!=null?y:[]){let ae=new Uw(e,{mvfData:V,categoryIds:((x=(v=t.enterprise)==null?void 0:v.categoryPriorities)==null?void 0:x[V.id])||B[V.id],locationInstances:Q[V.id]});I[V.id]=ae,V.externalId&&(P[V.externalId]==null&&(P[V.externalId]=[]),P[V.externalId].push(ae)),V.nodes.forEach(Y=>{U[Y.id]==null&&(U[Y.id]=[]),U[Y.id].push(V.id)});for(let Y of V.polygons)k[Y.id]==null&&(k[Y.id]=[]),k[Y.id].push(V)}if(e.enterpriseMode===!0){for(let V in e.mvfConnectionsById){let ae={},Y=e.mvfConnectionsById[V];for(let he of e.mvfConnectionsById[V].nodes){let J=e.nodesById[he];J!=null&&(ae[J.floor.id]={type:"Feature",geometry:{type:"Point",coordinates:[J.coordinate.longitude,J.coordinate.latitude]},properties:{id:V,externalId:Y.externalId,kind:"enterprise."+Y.type,destinationNodes:[],flags:"",type:Y.type,nodes:Y.nodes,accessible:Y.accessible,extra:Y.extra,details:Y.details}})}Object.keys(ae).length>0&&(E[V]=new JP(e,{mvfDataByFloorId:ae}),Y.externalId&&(M[Y.externalId]==null&&(M[Y.externalId]=[]),M[Y.externalId].push(E[V])))}e.connectionsById=E}return{spaceIdsByNodeId:Z,connectionsByExternalId:M,locationIdsByNodeId:U,mvfLocationsBySpaceId:k,mvfLocationsById:C,mvfCategoriesById:F,locationsById:I,locationsByExternalId:P,locationInstancesById:q,categoriesById:T,categoriesByExternalId:D,venue:z}},"createEnterpriseDataFromMVF"),uXe=s((t,e)=>{let{nodesById:r,nodesByExternalId:i,mvfNodesById:n,mvfNodesByFloorId:a}=YWe(t,e),{mvfConnectionsById:o,mvfConnectionsByNodeId:l,mvfConnectionIdsByLatLon:u}=eXe(t,n),{spacesById:c,spacesByExternalId:p,spaceIdsByDestinationNodeId:m,poisById:y,poisByExternalId:v,mvfSpacesById:x,objectEntranceNodeIdsByObstructionId:E,connectionsById:M,connectionIdsByLatLon:I,mvfSpacesByFloorId:P,mvfPoisByFloorId:C}=ZWe(t,l,e),{objectsById:T,objectsByExternalId:D,mvfObstructionById:F,obstructionIdByEntranceId:k}=KWe(t,e),{floorsById:B,floorsByExternalId:U,mvfFloorsById:z}=JWe(t,e),{floorStacksById:q,floorStacksByExternalId:Z,mvfFloorStacksById:Q,facadesById:V,facadesBySpaceId:ae}=QWe(t,e),{doorsById:Y,doorsByExternalId:he,doorsByNodeId:J,mvfEntrancesById:ne,mvfEntrancesByFloorId:ee}=tXe(t,e),{annotationsById:ue,mvfAnnotationsById:K,mvfAnnotationsByFloorId:ce}=oXe(t,e),{areasById:re,areasByExternalId:se,mvfAreasById:de}=sXe(t,e);iXe(t,x,F),rXe(t,x,F),nXe(t,x),aXe(t,x,F);let{locationCategoriesByParentId:we,locationProfilesById:Le,locationCategoriesById:fe,locationProfilesByExternalId:Re,locationProfilesByCategoryId:me,locationProfilesByAttachedFeatureId:Ae}=XWe(t,e);return{spacesById:c,spacesByExternalId:p,nodesById:r,nodesByExternalId:i,objectsById:T,objectsByExternalId:D,floorsById:B,floorsByExternalId:U,floorStacksById:q,floorStacksByExternalId:Z,facadesById:V,facadesBySpaceId:ae,connectionsById:M,doorsById:Y,doorsByExternalId:he,doorsByNodeId:J,poisById:y,poisByExternalId:v,annotationsById:ue,areasById:re,areasByExternalId:se,spaceIdsByDestinationNodeId:m,objectEntranceNodeIdsByObstructionId:E,obstructionIdByEntranceId:k,connectionIdsByLatLon:I,locationProfilesById:Le,locationCategoriesById:fe,locationProfilesByExternalId:Re,locationProfilesByCategoryId:me,locationCategoriesByParentId:we,mvfSpacesById:x,mvfNodesById:n,mvfObstructionById:F,mvfFloorsById:z,mvfFloorStacksById:Q,mvfConnectionsById:o,mvfConnectionsByNodeId:l,mvfEntrancesById:ne,mvfAnnotationsById:K,mvfNodesByFloorId:a,mvfSpacesByFloorId:P,mvfPoisByFloorId:C,mvfAreasById:de,mvfEntrancesByFloorId:ee,mvfAnnotationsByFloorId:ce,locationProfilesByAttachedFeatureId:Ae,mvfConnectionIdsByLatLon:u}},"createDataFromMVF");N();N();N();var cXe=s(function(){let t=globalThis.fetch;return{fetch(...e){if(!Bve(t))throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return t==null?void 0:t(...e)},setFetch(e){t=e}}},"createFetchControl")(),hXe=cXe.fetch,jve=["websdk","web","webv2","kiosk-v2","mobile","iossdk","androidsdk","reactnativesdk","gen7","bespoke"],$ve=jve[0],Gve="https://api-gateway.mappedin.com/track-analytics/a/",Hve="deny-watchposition",qve="load-mapview",Wve="load-mapdata",Xve="change-language",Zve="query-directions",Nd,Sh,Qg,Ek,FC,Yve=class{constructor(){Be(this,Qg),Be(this,Nd,Object.freeze({})),Be(this,Sh),$(this,"oneTimeEventsSent",new Set),$(this,"sendGetDirectionsEvent",Cme((e,r)=>this.sendAnalyticEvent(Zve,{start:e,end:r,type:"location_to_location"}),2500)),He(this,Sh,dr(this,Qg,FC).call(this,w(this,Nd)))}init(e){this.reset(),this.updateStateWithOptions(e)}reset(){He(this,Nd,{}),He(this,Sh,dr(this,Qg,FC).call(this,{})),this.oneTimeEventsSent.clear()}updateStateWithOptions(e){return He(this,Nd,Object.freeze(Object.assign({},w(this,Nd),e))),He(this,Sh,dr(this,Qg,FC).call(this,e)),dr(this,Qg,Ek).call(this,w(this,Sh)),w(this,Sh)}updateState(e){let r=Ee({},e);r.mapId&&(r.analyticsBaseUrl=p3(vt(Ee({},w(this,Sh)),{mapId:r.mapId}))),r.context&&(r.context=xz(r.context)),r.baseUri&&(r.analyticsBaseUrl=p3({baseUri:r.baseUri,mapId:w(this,Sh).mapId})),Object.assign(w(this,Sh),r),this.handleStateUpdate(e),dr(this,Qg,Ek).call(this,r)}handleStateUpdate(e){var r;(r=e.userPosition)!=null&&r.floorLevel?this.sendBlueDotEvents("found-floor"):e.userPosition&&this.sendBlueDotEvents("found-position")}get authReady(){let{key:e,secret:r,accessToken:i}=this.getState();return!!(e&&r)||!!i}getState(){return w(this,Sh)}getContext(){return this.getState().context||w(this,Nd).context||$ve}getSessionId(){return this.getState().sessionId||w(this,Nd).sessionId||_z()}getDeviceId(){return this.getState().deviceId||w(this,Nd).deviceId||vz()}sendAnalyticEvent(e,r={}){let i=this.getState(),n=Jve(i.analyticsBaseUrl,e),a={"mi-context":this.getContext(),"mi-session":this.getSessionId(),"mi-device":this.getDeviceId()};if(i.logEvents&&Vt.log("Analytics.track",n,a),!i.sendEvents)return Promise.resolve();if(!this.authReady)return Vt.warn("Auth needs to be ready to send analytics.");let o=vt(Ee({},r),{g:i.geolocationMode,sdk_version:i.version});return i.userPosition&&Object.assign(o,i.userPosition),a["Content-Type"]="application/json",i.accessToken?a.Authorization="Bearer ".concat(i.accessToken):i.noAuth||i.secret&&i.key&&(a["x-mappedin-key"]=btoa(i.key),a["x-mappedin-secret"]=btoa(i.secret)),hXe(n,{method:"POST",mode:"cors",headers:a,body:JSON.stringify(o)})}capture(e,r){if(dXe.includes(e))return Vt.warn("".concat(e," event is sent internally.")),Promise.resolve();let i=pXe.includes(e)?e.slice(1):e;return this.sendAnalyticEvent(i,r)}sendGetMapDataEvent(e){return this.sendAnalyticEvent(Wve,e)}sendChangeLanguageEvent(e){return this.sendAnalyticEvent(Xve,e)}sendWatchPositionDenied(){return this.sendAnalyticEvent(Hve)}sendMapViewLoadedEvent({firstRenderDuration:e,dimension:r}){return this.sendAnalyticEvent(qve,{type:"3d",firstRenderDuration:e,width:r.width,height:r.height,devicePixelRatio:globalThis.devicePixelRatio||1})}sendBlueDotEvents(e){if(!((e==="found-floor"||e==="found-position")&&this.oneTimeEventsSent.has(e)))return this.oneTimeEventsSent.add(e),this.sendAnalyticEvent(e)}};Nd=new WeakMap,Sh=new WeakMap,Qg=new WeakSet,Ek=s(function(t){t.sessionId&&O_.getInstance().saveSessionData("id",t.sessionId),t.deviceId&&O_.getInstance().saveLocalData("deviceId",t.deviceId)},"#saveStateToStorage"),FC=s(function(t){var e,r,i,n;let a=(e=t.baseUri)!=null?e:Gve;return{baseUri:a,analyticsBaseUrl:p3(vt(Ee({},t),{baseUri:a})),version:((r=ja==null?void 0:ja.env)==null?void 0:r.npm_package_version)||"v6",deviceId:t.deviceId||vz(),accessToken:t.accessToken,mapId:t.mapId,sessionId:t.sessionId||_z(),platformString:t.platformString||"",context:xz(t.context)||$ve,geolocationMode:!1,sendEvents:(i=t.sendEvents)!=null?i:!0,logEvents:(n=t.logEvents)!=null?n:!1,noAuth:t.noAuth||!1,key:t.key,secret:t.secret}},"#getStateWithOption"),s(Yve,"AnalyticsInternal");var Kve=Yve;function p3({mapId:t,baseUri:e=Gve}){return"".concat(e).concat(t,"/")}s(p3,"getBaseUrl");function vz(){return O_.getInstance().loadLocalData("deviceId")}s(vz,"getDeviceIDFromStorage");function _z(){return O_.getInstance().loadSessionData("id")}s(_z,"getSessionIDFromStorage");function Jve(t,e){return t+e}s(Jve,"buildUrl");function xz(t){return jve.find(e=>e===t)}s(xz,"getValidContext");var pXe=["$select-location","$select-category","$query-suggest","$query-search"],dXe=[qve,Wve,Zve,Hve,Xve];new Kve;var Mh,Qve=class{constructor(e){Be(this,Mh),$(this,"capture"),$(this,"updateState"),He(this,Mh,e),this.capture=w(this,Mh).capture.bind(w(this,Mh)),this.updateState=w(this,Mh).updateState.bind(w(this,Mh))}getState(){let e=w(this,Mh).getState(),{sessionId:r,deviceId:i}=e;return Nh(e,["sessionId","deviceId"])}getContext(){return w(this,Mh).getContext()}getSessionId(){return w(this,Mh).getSessionId()}getDeviceId(){return w(this,Mh).getDeviceId()}};Mh=new WeakMap,s(Qve,"Analytics");var fXe=Qve;N();var mXe=new Set(["polygons"]),yp,ho,oc,BC,Ck=class zC extends hg{constructor(e,r){super(r.mvfData.externalId),$(this,"__type",zC.__type),$(this,"description"),$(this,"name",""),$(this,"amenity"),$(this,"externalId",""),$(this,"extra"),$(this,"gallery"),$(this,"instances"),$(this,"logo"),$(this,"operationHours"),$(this,"phone"),$(this,"picture"),$(this,"shortName"),$(this,"showFloatingLabelWhenImagePresent"),$(this,"showLogo"),$(this,"siblingGroups"),$(this,"social"),$(this,"sortOrder",-1),$(this,"states"),$(this,"tags"),$(this,"type",""),$(this,"hidden",!1),Be(this,yp),Be(this,ho,{}),Be(this,oc),Be(this,BC),He(this,yp,e),He(this,oc,r.mvfData),He(this,BC,r.categoryIds||[]),this.instances=r.locationInstances||[];for(let i in r.mvfData)!mXe.has(i)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)&&Object.defineProperty(this,i,{enumerable:!0,get(){if(r.parentId){let n=w(this,yp).locationsById[r.parentId];return w(this,oc)[i]!=null?w(this,yp).getPropTranslation(this.__type,i,w(this,oc).id,w(this,oc)[i]):w(this,yp).getPropTranslation(this.__type,i,w(this,oc).id,n[i])}return w(this,yp).getPropTranslation(this.__type,i,w(this,oc).id,w(this,oc)[i])}})}static is(e){return e.__type===zC.__type}get focusTarget(){return this.spaces}get categories(){return w(this,ho).categories?w(this,ho).categories:(w(this,ho).categories=(w(this,BC).map(e=>w(this,yp).getById("enterprise-category",e))||[]).filter(Boolean),w(this,ho).categories)}get coordinates(){if(w(this,ho).coordinates)return w(this,ho).coordinates;w(this,ho).coordinates=[];for(let e=0;e<this.nodes.length;e++)w(this,ho).coordinates.push(this.nodes[e].coordinate);return w(this,ho).coordinates}get nodes(){if(w(this,ho).nodes)return w(this,ho).nodes;w(this,ho).nodes=[];for(let e=0;e<w(this,oc).nodes.length;e++){let r=w(this,yp).getById("node",w(this,oc).nodes[e].id);r&&w(this,ho).nodes.push(r)}return w(this,ho).nodes}get spaces(){if(w(this,ho).spaces)return w(this,ho).spaces;w(this,ho).spaces=[];for(let e=0;e<w(this,oc).polygons.length;e++){let r=w(this,yp).getById("space",w(this,oc).polygons[e].id);r&&w(this,ho).spaces.push(r)}return w(this,ho).spaces}toJSON(){return{__type:zC.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(w(this,ho)))delete w(this,ho)[e]}};yp=new WeakMap,ho=new WeakMap,oc=new WeakMap,BC=new WeakMap,s(Ck,"EnterpriseLocation"),$(Ck,"__type","enterprise-location");var gXe=Ck,Uw=gXe;N();var yXe=new Set,X0,wu,Fd,Ik=class UC extends hg{constructor(e,r){super(r.mvfData.externalId),$(this,"__type",UC.__type),$(this,"name",""),$(this,"color"),$(this,"externalId",""),$(this,"extra"),$(this,"icon"),$(this,"iconFromDefaultList"),$(this,"sortOrder",-1),$(this,"picture"),Be(this,X0),Be(this,wu,{}),Be(this,Fd),He(this,X0,e),He(this,Fd,r.mvfData);for(let i in r.mvfData)!yXe.has(i)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)&&Object.defineProperty(this,i,{get(){return w(this,X0).getPropTranslation(this.__type,i,w(this,Fd).id,w(this,Fd)[i])}})}static is(e){return e.__type===UC.__type}get children(){if(w(this,wu).children)return w(this,wu).children;w(this,wu).children=[];for(let e=0;e<w(this,Fd).children.length;e++){let r=w(this,X0).getById("enterprise-category",w(this,Fd).children[e]);r&&w(this,wu).children.push(r)}return w(this,wu).children}get locations(){if(w(this,wu).locations)return w(this,wu).locations;w(this,wu).locations=[];for(let e=0;e<w(this,Fd).locations.length;e++){let r=w(this,X0).getById("enterprise-location",w(this,Fd).locations[e]);r&&w(this,wu).locations.push(r)}return w(this,wu).locations}toJSON(){return{__type:UC.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(w(this,wu)))delete w(this,wu)[e]}};X0=new WeakMap,wu=new WeakMap,Fd=new WeakMap,s(Ik,"EnterpriseCategory"),$(Ik,"__type","enterprise-category");var vXe=Ik,e0e=vXe;N();var _Xe=new Set,VC,jC,Tk=class $C extends hg{constructor(e,r){super(r.mvfData.externalId),$(this,"__type",$C.__type),$(this,"countrycode"),$(this,"externalId",""),$(this,"defaultLanguage",{code:"en",name:"English"}),$(this,"defaultMap"),$(this,"extra"),$(this,"icon"),$(this,"languages",[]),$(this,"links",[]),$(this,"logo"),$(this,"mappedinWebUrl"),$(this,"slug",""),$(this,"topLocations"),$(this,"tzid"),Be(this,VC,{}),Be(this,jC),He(this,jC,r.mvfData);for(let i in r.mvfData)!_Xe.has(i)&&!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)&&(this[i]=r.mvfData[i])}static is(e){return e.__type===$C.__type}get name(){var e;return(e=w(this,jC).name)!=null?e:""}toJSON(){return{__type:$C.__type,id:this.id,name:this.name}}destroy(){for(let e of Object.keys(w(this,VC)))delete w(this,VC)[e]}};VC=new WeakMap,jC=new WeakMap,s(Tk,"EnterpriseVenue"),$(Tk,"__type","enterprise-venue");var xXe=Tk,t0e=xXe;N();N();N();N();N();N();var bXe=Rr(oye(),1),wXe=Rr(hWe(),1);N();var AXe=s(t=>{var e;let r=t;return((e=r==null?void 0:r.allOf)==null?void 0:e.length)===2},"isPotentiallyBadSchema");function d3(t){if(typeof t!="object"||t===null)return t;if(Array.isArray(t))return t.map(d3);let e=Ee({},t);for(let[r,i]of Object.entries(e))if(typeof i=="object"&&i!==null){let n=d3(i);if(AXe(n)){let a=n.allOf.findIndex(l=>l.type==="array"),o=n.allOf.findIndex(l=>l.type==="object");if(a!==-1&&o!==-1){e[r]=vt(Ee({},n),{allOf:[n.allOf[a]]});continue}}e[r]=n}return e}s(d3,"cleanupInvalidArrayAllOf");var SXe={$ref:"#/definitions/ParsedMVF",$schema:"http://json-schema.org/draft-07/schema#",definitions:{AnchoredFloorTextProperties:{additionalProperties:!1,properties:{align:{default:"center",description:"Horizontal alignment of multi-line text.",enum:["left","center","right"],type:"string"},color:{default:"black",description:"The color of the text in CSS format (e.g. `#000000`, `rgb(0, 0, 0)`, `black`).",type:"string"},fontFamily:{default:"Droid Sans",description:"The font family of the text.",type:"string"},fontSize:{default:12,description:"The em-height (multiplier of the font's height) at which to render the font, in meters. The font height is the distance between the ascender (highest point, height of an A) and descender (lowest point, bottom of a g) of the font. For example, if the font-size is 12, the space for a single character will be 12 meters high.",type:"number"},geometryId:{anyOf:[{$ref:"#/definitions/SpaceId"},{$ref:"#/definitions/ObstructionId"}],description:"The geometry to which this text belongs. It will be displayed on top of it."},rotation:{description:"Rotation in degrees, about the center of the text. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},text:{description:"The text to display. Newline characters are supported.",type:"string"},visible:{default:!0,description:"Whether the text is visible.",type:"boolean"}},required:["align","color","fontFamily","fontSize","geometryId","rotation","text","visible"],type:"object"},AnchoredImageProperties:{additionalProperties:!1,properties:{anchorId:{anyOf:[{$ref:"#/definitions/SpaceId"},{$ref:"#/definitions/ObstructionId"}],description:"The geometry to which this image belongs. It will be displayed on top of it."},height:{description:"The height of the image when represented on the map, in meters.",minimum:0,type:"number"},path:{description:"The path to the image. This will be a remote URL.",type:"string"},rotation:{description:"Rotation in degrees, about the center of the image. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},width:{description:"The width of the image when represented on the map, in meters.",minimum:0,type:"number"}},required:["anchorId","height","path","rotation","width"],type:"object"},AnchoredTextAreaProperties:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/TextAreaAlignment",description:"The alignment of the text within the label. 'Near' means the text will be aligned up against the position. Typically in the SDK the text will be rotated to always be upright, so either the start or end of the text will be up against the position. 'Center' means it will be centered in the middle of the area."},anchorId:{anyOf:[{$ref:"#/definitions/SpaceId"},{$ref:"#/definitions/ObstructionId"}],description:"The geometry to which this text area belongs. It will be displayed on top of it."},maxHeight:{description:"The maximum height of the label, in meters. Half the height will be above the feature's position, half below.",exclusiveMinimum:0,type:"number"},maxWidth:{description:"The maximum width of the label, in meters. The left edge will start at the feature's position and extend in the rotation direction.",exclusiveMinimum:0,type:"number"},rotation:{description:"Rotation in degrees relative to north, about the position of the label. North is 0, east is 90.",maximum:360,minimum:0,type:"number"}},required:["align","anchorId","maxHeight","maxWidth","rotation"],type:"object"},AnnotationCollection:{additionalProperties:!1,properties:{features:{items:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/AnnotationProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},AnnotationId:{pattern:"^a_[A-Za-z0-9_-]{8,}$",type:"string"},AnnotationProperties:{additionalProperties:!1,properties:{externalId:{type:"string"},id:{$ref:"#/definitions/AnnotationId"},symbolId:{type:"string"}},required:["id","symbolId"],type:"object"},Area:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Polygon"},properties:{$ref:"#/definitions/AreaProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},AreaCollection:{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Area"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},AreaId:{pattern:"^ar_[A-Za-z0-9_-]{8,}$",type:"string"},AreaProperties:{additionalProperties:!1,properties:{center:{$ref:"#/definitions/Position",description:"The center of mass of this area."},destinationNodes:{description:"A list of node IDs which can be used to navigate to this area.",items:{$ref:"#/definitions/NodeId"},type:"array"},details:{$ref:"#/definitions/Details"},externalId:{type:"string"},id:{$ref:"#/definitions/AreaId"}},required:["id"],type:"object"},Category:{additionalProperties:!1,properties:{icon:{description:"The category's icon",format:"uri",type:"string"},id:{$ref:"#/definitions/CategoryId"},name:{type:"string"},parent:{$ref:"#/definitions/CategoryId"}},required:["id","name","icon"],type:"object"},CategoryId:{description:"A category ID",pattern:"^cat_[A-Za-z0-9_-]{8,}$",type:"string"},Connection:{additionalProperties:!1,properties:{accessible:{type:"boolean"},details:{additionalProperties:!1,properties:{name:{type:"string"}},type:"object"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},id:{$ref:"#/definitions/ConnectionId"},metadata:{$ref:"#/definitions/Metadata"},nodes:{description:"A list of node IDs corresponding to nodes that are a part of this connection.",items:{$ref:"#/definitions/NodeId"},type:"array"},type:{type:"string"}},required:["id","type","nodes","externalId"],type:"object"},ConnectionId:{pattern:"^c_[A-Za-z0-9_-]{8,}$",type:"string"},Connections:{items:{$ref:"#/definitions/Connection"},type:"array"},Day:{enum:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],type:"string"},DayOrPublicHoliday:{anyOf:[{$ref:"#/definitions/Day"},{const:"PublicHolidays",type:"string"}]},Details:{additionalProperties:!1,description:"Additional information about a given entity.",properties:{description:{type:"string"},images:{items:{$ref:"#/definitions/Image"},type:"array"},links:{items:{$ref:"#/definitions/Hyperlink"},type:"array"},name:{type:"string"}},type:"object"},EnterpriseCategory:{additionalProperties:!1,properties:{children:{items:{$ref:"#/definitions/EnterpriseCategoryId"},type:"array"},color:{type:"string"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},icon:{description:"The category's icon",format:"uri",type:"string"},iconFromDefaultList:{type:["string","null"]},id:{$ref:"#/definitions/EnterpriseCategoryId"},locations:{items:{$ref:"#/definitions/EnterpriseLocationId"},type:"array"},name:{type:"string"},picture:{description:"The category's picture",format:"uri",type:"string"},sortOrder:{type:"number"}},required:["children","externalId","id","locations","name","sortOrder"],type:"object"},EnterpriseCategoryId:{description:"An ID for an enterprise category",pattern:"^ec_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseCategoryPriority:{additionalProperties:{items:{$ref:"#/definitions/EnterpriseCategoryId"},type:"array"},description:"The ordered list of category ids that this location belongs to The order here determines the priority of the categories, with the first category being the highest priority for determining application logic like icon and color preference.",propertyNames:{description:"An ID for an enterprise location",pattern:"^el_[A-Za-z0-9_-]{8,}$"},type:"object"},EnterpriseCollection:{additionalProperties:!1,properties:{categories:{items:{$ref:"#/definitions/EnterpriseCategory"},type:"array"},categoryPriorities:{$ref:"#/definitions/EnterpriseCategoryPriority"},enterpriseStyles:{$ref:"#/definitions/EnterpriseStyles"},floorText:{$ref:"#/definitions/EnterpriseFloorText"},layers:{items:{$ref:"#/definitions/EnterpriseLayer"},type:"array"},locationInstances:{items:{$ref:"#/definitions/EnterpriseLocationInstance"},type:"array"},locations:{items:{$ref:"#/definitions/EnterpriseLocation"},type:"array"},textures:{items:{$ref:"#/definitions/EnterpriseTexture"},type:"array"},venue:{$ref:"#/definitions/EnterpriseVenue"}},required:["locations","categories","venue","locationInstances","layers"],type:"object"},EnterpriseFloorText:{additionalProperties:{anyOf:[{$ref:"#/definitions/FloorTextFeatureCollection"},{not:{}}]},description:"The text to display on a map, split into  feature collection per floor.",type:"object"},EnterpriseLayer:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/EnterpriseLayerId"},name:{type:"string"},spaces:{items:{$ref:"#/definitions/EnterpriseLayerSpace"},minItems:1,type:"array"}},required:["id","name","spaces"],type:"object"},EnterpriseLayerId:{pattern:"^ely_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseLayerSpace:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},spaceId:{$ref:"#/definitions/SpaceId"}},required:["floorId","spaceId"],type:"object"},EnterpriseLocation:{additionalProperties:!1,properties:{amenity:{description:"The location's amenity type. Only set if the location is an amenity",type:"string"},description:{type:"string"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},gallery:{description:"The location's image gallery",items:{additionalProperties:!1,properties:{caption:{type:["string","null"]},embeddedUrl:{description:"The URL to link from the image",format:"uri",type:["string","null"]},image:{type:"string"}},required:["image"],type:"object"},type:"array"},hidden:{description:"Whether to show the location in applications",type:"boolean"},id:{$ref:"#/definitions/EnterpriseLocationId"},links:{description:"Web links for the location",items:{additionalProperties:!1,properties:{label:{type:"string"},url:{description:"The URL of the link",format:"uri",type:"string"}},required:["label","url"],type:"object"},type:"array"},logo:{description:"The location's logo",format:"uri",type:"string"},name:{type:"string"},nodes:{deprecated:"Use `spaces` instead. A location's nodes that are not attached to a polygon will be in the spaces array as a point space. Nodes that are attached to one of it's polygons will be destinationNodes on that polygon's space",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/NodeId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},operationHours:{items:{$ref:"#/definitions/OperationHours"},type:"array"},phone:{additionalProperties:!1,properties:{extension:{type:"string"},number:{type:"string"}},required:["number"],type:"object"},picture:{description:"The picture of the location",format:"uri",type:"string"},polygons:{deprecated:"Use `spaces` instead. All of a location's polygons will be in the spaces array.",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/SpaceId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},shortName:{type:"string"},showFloatingLabelWhenImagePresent:{description:"Whether to show the flat label when an image is present",type:"boolean"},showLogo:{description:"Whether to show the logo of the location",type:"boolean"},siblingGroups:{description:"Locations that are related to this location in some manner (described by the label)",items:{$ref:"#/definitions/SiblingGroup"},type:"array"},social:{additionalProperties:!1,description:"The location's social media links",properties:{facebook:{type:"string"},instagram:{type:"string"},twitter:{type:"string"},website:{type:"string"}},type:"object"},sortOrder:{type:"number"},spaces:{description:`The places that this location is anchored to in the physical world. These are either Polygon or Point spaces. A location can be attached to many spaces, and a space can be attached to many locations.

If there are different properties for the location on those spaces, they will show up in the location's  {@link  EnterpriseLocation.instances instances }  property`,items:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/SpaceId"}},required:["floor","id"],type:"object"},type:"array"},states:{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set",items:{$ref:"#/definitions/LocationState"},type:"array"},tags:{items:{type:"string"},type:"array"},type:{type:"string"}},required:["externalId","id","name","nodes","polygons","sortOrder","spaces","type"],type:"object"},EnterpriseLocationId:{description:"An ID for an enterprise location",pattern:"^el_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseLocationInstance:{additionalProperties:!1,description:`A locationInstance is a particular instace of an Enterprise Location that has some properties different from the parent. Eg, it may have different hours, or a slightly different name.

A LocationInstance:
- MUST have a parent, referring to an Enterprise Location.
- MUST have a unique ID, for localization to work.
- SHOULD have AT LEAST ONE polygon or node to anchor it in space.
- SHOULD have AT LEAST ONE other Enterprise Location property set.

It is otherwise a Partial<EnterpriseLocation>

Usage examples:
- A locationInstance for a location with a different externalId so a customer can identify them individually.
- A locationInstance with different operationHours, that might indicate different hours for that particular entrace.`,properties:{amenity:{description:"The location's amenity type. Only set if the location is an amenity",type:"string"},description:{type:"string"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},gallery:{description:"The location's image gallery",items:{additionalProperties:!1,properties:{caption:{type:["string","null"]},embeddedUrl:{description:"The URL to link from the image",format:"uri",type:["string","null"]},image:{type:"string"}},required:["image"],type:"object"},type:"array"},hidden:{description:"Whether to show the location in applications",type:"boolean"},id:{$ref:"#/definitions/EnterpriseLocationInstanceId"},links:{description:"Web links for the location",items:{additionalProperties:!1,properties:{label:{type:"string"},url:{description:"The URL of the link",format:"uri",type:"string"}},required:["label","url"],type:"object"},type:"array"},logo:{description:"The location's logo",format:"uri",type:"string"},name:{type:"string"},nodes:{deprecated:"Use `spaces` instead. A location's nodes that are not attached to a polygon will be in the spaces array as a point space. Nodes that are attached to one of it's polygons will be destinationNodes on that polygon's space",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/NodeId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},operationHours:{items:{$ref:"#/definitions/OperationHours"},type:"array"},parent:{$ref:"#/definitions/EnterpriseLocationId"},phone:{additionalProperties:!1,properties:{extension:{type:"string"},number:{type:"string"}},required:["number"],type:"object"},picture:{description:"The picture of the location",format:"uri",type:"string"},polygons:{deprecated:"Use `spaces` instead. All of a location's polygons will be in the spaces array.",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/SpaceId"},map:{$ref:"#/definitions/FloorId"}},required:["map","id"],type:"object"},type:"array"},shortName:{type:"string"},showFloatingLabelWhenImagePresent:{description:"Whether to show the flat label when an image is present",type:"boolean"},showLogo:{description:"Whether to show the logo of the location",type:"boolean"},siblingGroups:{description:"Locations that are related to this location in some manner (described by the label)",items:{$ref:"#/definitions/SiblingGroup"},type:"array"},social:{additionalProperties:!1,description:"The location's social media links",properties:{facebook:{type:"string"},instagram:{type:"string"},twitter:{type:"string"},website:{type:"string"}},type:"object"},sortOrder:{type:"number"},spaces:{description:`The places that this location is anchored to in the physical world. These are either Polygon or Point spaces. A location can be attached to many spaces, and a space can be attached to many locations.

If there are different properties for the location on those spaces, they will show up in the location's  {@link  EnterpriseLocation.instances instances }  property`,items:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/SpaceId"}},required:["floor","id"],type:"object"},type:"array"},states:{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set",items:{$ref:"#/definitions/LocationState"},type:"array"},tags:{items:{type:"string"},type:"array"},type:{type:"string"}},required:["id","parent"],type:"object"},EnterpriseLocationInstanceId:{description:"An ID for an enterprise location instance",pattern:"^eli_[A-Za-z0-9_-]{8,}$",type:"string"},EnterpriseStyles:{additionalProperties:{additionalProperties:!1,properties:{edgeOffset:{type:"number"},geometryAnchors:{items:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},geometryId:{$ref:"#/definitions/SpaceId"}},required:["geometryId","floorId"],type:"object"},type:"array"}},required:["geometryAnchors"],type:"object"},type:"object"},EnterpriseTexture:{additionalProperties:!1,properties:{bounds:{description:"Coordinates of the texture's bounding box in format: [minLon, minLat, maxLon, maxLat].",items:{type:"number"},maxItems:4,minItems:4,type:"array"},face:{$ref:"#/definitions/EnterpriseTextureFace",description:`Face of the polygon that the texture will be applied to.

'top' means that the texture will be applied to the upward-pointing face of the polygon.

'side' means that the texture will be applied to every side face of the polygon.`},geometryAnchors:{description:"Anchors for the texture on the geometry of the polygon.",items:{$ref:"#/definitions/EnterpriseTextureGeometryAnchor"},minItems:1,type:"array"},offset:{$ref:"#/definitions/EnterpriseTextureUV",description:"Controls the starting position of the texture on the surface. The u value shifts the texture horizontally and v shifts vertically."},path:{description:"Path to the texture image. Must be either a PNG or JPG format.",type:"string"},repeat:{$ref:"#/definitions/EnterpriseTextureUV",description:"Controls how many times the texture repeats across the surface. The u value controls horizontal repetition and v controls vertical repetition."},rotation:{description:`Rotation of the texture in degrees clockwise.

For top textures this is relative to north. North is 0, east is 90.

For side textures this is relative to the upward direction, with 0 degrees being upright.`,maximum:360,minimum:0,type:"number"},surface:{$ref:"#/definitions/EnterpriseTextureSurface",description:`Surface of the polygon that the texture will be applied to.

'inside' means that the texture will only be applied to the interior surface of the polygon.

'outside' means that the texture will only be applied to the exterior surface of the polygon.

'both' means that the texture will be applied to both interior and exterior surfaces of the polygon.`}},required:["repeat","offset","rotation","path","face","surface","bounds","geometryAnchors"],type:"object"},EnterpriseTextureFace:{enum:["top","side"],type:"string"},EnterpriseTextureGeometryAnchor:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},geometryId:{$ref:"#/definitions/SpaceId"}},required:["geometryId","floorId"],type:"object"},EnterpriseTextureSurface:{enum:["inside","outside","both"],type:"string"},EnterpriseTextureUV:{additionalProperties:!1,properties:{u:{type:"number"},v:{type:"number"}},required:["u","v"],type:"object"},EnterpriseVenue:{additionalProperties:!1,properties:{countrycode:{description:"The ISO 3166-1 alpha-2 country code of the venue, if known\n\nEg. `US` or `GB`",type:"string"},coverImage:{description:"The venue's cover image",format:"uri",type:"string"},defaultFloor:{$ref:"#/definitions/FloorId",description:"The venue's default floor"},defaultLanguage:{$ref:"#/definitions/Language"},defaultMap:{$ref:"#/definitions/FloorId",deprecated:"Use `defaultFloor` instead"},externalId:{type:"string"},extra:{additionalProperties:{},type:"object"},icon:{description:"The venue's icon",format:"uri",type:"string"},languages:{items:{$ref:"#/definitions/Language"},type:"array"},logo:{description:"The venue's logo",format:"uri",type:"string"},mappedinWebUrl:{description:`The base URL for Mappedin Web for this venue

Better name?`,type:"string"},name:{type:"string"},operationHours:{description:"When this venue is open.",items:{$ref:"#/definitions/OperationHours"},type:"array"},slug:{type:"string"},topLocations:{items:{$ref:"#/definitions/EnterpriseLocationId"},type:"array"},tzid:{description:"The venue's timezone, from the IANA Time Zone Database. Should be in the format of `America/New_York`",pattern:"^[A-Za-z0-9\\/_-]+$",type:"string"}},required:["defaultLanguage","externalId","languages","name","slug"],type:"object"},EntranceCollection:{$ref:"#/definitions/FeatureCollection%3CLineString%2CEntranceProperties%3E"},EntranceId:{pattern:"^e_[A-Za-z0-9_-]{8,}$",type:"string"},EntranceProperties:{additionalProperties:!1,properties:{details:{$ref:"#/definitions/Details"},externalId:{type:"string"},id:{$ref:"#/definitions/EntranceId"},isExterior:{type:"boolean"},metadata:{$ref:"#/definitions/Metadata"},node:{$ref:"#/definitions/NodeId"}},required:["id","externalId"],type:"object"},Facade:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/FacadeId"},spaces:{items:{$ref:"#/definitions/FacadeSpace"},minItems:1,type:"array"}},required:["id","spaces"],type:"object"},FacadeId:{pattern:"^fc_[A-Za-z0-9_-]{8,}$",type:"string"},FacadeSpace:{additionalProperties:!1,properties:{floorId:{$ref:"#/definitions/FloorId"},spaceId:{$ref:"#/definitions/SpaceId"}},required:["floorId","spaceId"],type:"object"},"Feature<(Polygon|LineString),ObstructionProperties>":{additionalProperties:!1,properties:{geometry:{anyOf:[{$ref:"#/definitions/Polygon"},{$ref:"#/definitions/LineString"}]},properties:{$ref:"#/definitions/ObstructionProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<(Polygon|LineString|Point),SpaceProperties>":{additionalProperties:!1,properties:{geometry:{anyOf:[{$ref:"#/definitions/Polygon"},{$ref:"#/definitions/LineString"},{$ref:"#/definitions/Point"}]},properties:{$ref:"#/definitions/SpaceProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<(Polygon|MultiPolygon|null),FloorProperties>":{additionalProperties:!1,properties:{geometry:{anyOf:[{$ref:"#/definitions/Polygon"},{$ref:"#/definitions/MultiPolygon"},{type:"null"}]},properties:{$ref:"#/definitions/FloorProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<LineString,EntranceProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/LineString"},properties:{$ref:"#/definitions/EntranceProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,FloorImageProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/FloorImageProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,FloorTextProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/FloorTextProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,NodeProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/NodeProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Point,TextAreaProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/TextAreaProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"Feature<Polygon,FloorStackFootprintProperties>":{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Polygon"},properties:{$ref:"#/definitions/FloorStackFootprintProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},"FeatureCollection<(Polygon|LineString),ObstructionProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3C(Polygon%7CLineString)%2CObstructionProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<(Polygon|LineString|Point),SpaceProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3C(Polygon%7CLineString%7CPoint)%2CSpaceProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<(Polygon|MultiPolygon|null),FloorProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3C(Polygon%7CMultiPolygon%7Cnull)%2CFloorProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<LineString,EntranceProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CLineString%2CEntranceProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,FloorImageProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CFloorImageProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,FloorTextProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CFloorTextProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,NodeProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CNodeProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Point,TextAreaProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPoint%2CTextAreaProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},"FeatureCollection<Polygon,FloorStackFootprintProperties>":{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/Feature%3CPolygon%2CFloorStackFootprintProperties%3E"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},FeatureCollectionType:{const:"FeatureCollection",description:"The type field used for a collection of GeoJSON features.",type:"string"},FeatureType:{const:"Feature",description:"The type field used for individual GeoJSON features.",type:"string"},FloatingFloorTextProperties:{additionalProperties:!1,properties:{align:{default:"center",description:"Horizontal alignment of multi-line text.",enum:["left","center","right"],type:"string"},color:{default:"black",description:"The color of the text in CSS format (e.g. `#000000`, `rgb(0, 0, 0)`, `black`).",type:"string"},fontFamily:{default:"Droid Sans",description:"The font family of the text.",type:"string"},fontSize:{default:12,description:"The em-height (multiplier of the font's height) at which to render the font, in meters. The font height is the distance between the ascender (highest point, height of an A) and descender (lowest point, bottom of a g) of the font. For example, if the font-size is 12, the space for a single character will be 12 meters high.",type:"number"},rotation:{description:"Rotation in degrees, about the center of the text. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},text:{description:"The text to display. Newline characters are supported.",type:"string"},verticalOffset:{description:"The vertical offset of the text, in meters.",type:"number"},visible:{default:!0,description:"Whether the text is visible.",type:"boolean"}},required:["align","color","fontFamily","fontSize","rotation","text","verticalOffset","visible"],type:"object"},FloatingImageProperties:{additionalProperties:!1,properties:{height:{description:"The height of the image when represented on the map, in meters.",minimum:0,type:"number"},path:{description:"The path to the image. This will be a remote URL.",type:"string"},rotation:{description:"Rotation in degrees, about the center of the image. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},verticalOffset:{description:"How high to position the image, in meters, relative to the ground plane.",minimum:0,type:"number"},width:{description:"The width of the image when represented on the map, in meters.",minimum:0,type:"number"}},required:["height","path","rotation","verticalOffset","width"],type:"object"},FloatingTextAreaProperties:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/TextAreaAlignment",description:"The alignment of the text within the label. 'Near' means the text will be aligned up against the position. Typically in the SDK the text will be rotated to always be upright, so either the start or end of the text will be up against the position. 'Center' means it will be centered in the middle of the area."},maxHeight:{description:"The maximum height of the label, in meters. Half the height will be above the feature's position, half below.",exclusiveMinimum:0,type:"number"},maxWidth:{description:"The maximum width of the label, in meters. The left edge will start at the feature's position and extend in the rotation direction.",exclusiveMinimum:0,type:"number"},rotation:{description:"Rotation in degrees relative to north, about the position of the label. North is 0, east is 90.",maximum:360,minimum:0,type:"number"},verticalOffset:{description:"How high to position the text area, in meters, relative to the ground plane.",minimum:0,type:"number"}},required:["align","maxHeight","maxWidth","rotation","verticalOffset"],type:"object"},FloorCollection:{$ref:"#/definitions/FeatureCollection%3C(Polygon%7CMultiPolygon%7Cnull)%2CFloorProperties%3E"},FloorId:{description:"The m_ prefix is deprecated, from when floors were previously called maps. Use f_ as the prefix instead.",pattern:"^[mf]_[A-Za-z0-9_-]{8,}$",type:"string"},FloorImageFeatureCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CFloorImageProperties%3E",description:"A collection of images to be displayed on a map. They are either attached to a polygon or are floating in space."},FloorImageProperties:{anyOf:[{$ref:"#/definitions/AnchoredImageProperties"},{$ref:"#/definitions/FloatingImageProperties"}]},FloorProperties:{additionalProperties:!1,properties:{elevation:{description:"The elevation of this map relative to other maps in the stack. Must be an integer.",type:"integer"},externalId:{description:"Use of this property as the name of the map is deprecated. Use the name property instead.",type:"string"},id:{$ref:"#/definitions/FloorId"},metadata:{$ref:"#/definitions/Metadata"},name:{type:"string"},shortName:{description:"A short name for the map, if it exists. Usually one or two characters (eg, 3, F1, L, etc.) For display in very small spaces, like a floor selector dropdown. Might line up with what is shown on elevator buttons in the physical world.",type:"string"},subtitle:{description:`A subtitle for the map, for display in larger spaces, usually beneath the full name. Provides additional context for what is actually on the map, if the name is not clear. For example, if the full name is "Level 1", the subtitle might be "Arrivals and Baggage Claim".

Should be no more than a few words.`,type:"string"}},required:["id","externalId","elevation"],type:"object"},FloorStack:{additionalProperties:!1,properties:{defaultFloor:{$ref:"#/definitions/FloorId",description:"The default floor to use when a floor is not specified."},externalId:{type:"string"},floors:{description:"A list of floor IDs that belong to this floor stack.",items:{$ref:"#/definitions/FloorId"},type:"array"},footprint:{$ref:"#/definitions/FeatureCollection%3CPolygon%2CFloorStackFootprintProperties%3E",description:"Provides a footprint for the map stack based on the geometry of the maps it contains. This is useful for rendering a map stack without loading all of its maps."},id:{$ref:"#/definitions/FloorStackId"},maps:{deprecated:"Use `floors` instead.",description:"A list of floor IDs that belong to this floor stack.",items:{$ref:"#/definitions/FloorId"},type:"array"},metadata:{$ref:"#/definitions/Metadata"},name:{type:"string"},shortName:{description:"A short name for the map stack, if it exists. For display in small spaces, like a floor selector dropdown.",type:"string"},type:{description:"The type of MapStack, e.g. Building, Outdoor. Defaults to Building.",enum:["Building","Outdoor"],type:"string"}},required:["id","externalId","name","maps"],type:"object"},FloorStackFootprintProperties:{additionalProperties:{not:{}},type:"object"},FloorStackId:{description:"The mg_ prefix is deprecated, from when floor stacks were previously called map groups. Use fs_ as the prefix instead.",pattern:"^fs_[A-Za-z0-9_-]{8,}$",type:"string"},FloorStacks:{items:{$ref:"#/definitions/FloorStack"},type:"array"},FloorTextFeatureCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CFloorTextProperties%3E",description:"A collection of text to be displayed on a map. They are either attached to a space or are floating."},FloorTextProperties:{anyOf:[{$ref:"#/definitions/AnchoredFloorTextProperties"},{$ref:"#/definitions/FloatingFloorTextProperties"}]},Hyperlink:{additionalProperties:!1,properties:{displayName:{type:"string"},url:{type:"string"}},required:["url"],type:"object"},Image:{additionalProperties:!1,properties:{altText:{type:"string"},url:{type:"string"}},required:["url"],type:"object"},Language:{additionalProperties:!1,properties:{code:{type:"string"},name:{type:"string"}},required:["name","code"],type:"object"},Latitude:{description:"A WGS 84-compatible latitude coordinate value.",maximum:90,minimum:-90,type:"number"},LineString:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON LineString geometry.",properties:{coordinates:{items:{$ref:"#/definitions/Position"},minItems:2,type:"array"},type:{const:"LineString",type:"string"}},required:["coordinates","type"],type:"object"},LineStringStyle:{additionalProperties:!1,properties:{altitude:{description:'How far off the "ground" the objects belonging to this layer should be drawn, in meters.',minimum:0,type:"number"},color:{description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB",pattern:"^#[0-9a-fA-F]{6}$",type:"string"},height:{description:"The height of the objects belonging to this layer, in meters.",minimum:0,type:"number"},lineStrings:{description:"The line strings which this style applies to.",items:{anyOf:[{$ref:"#/definitions/EntranceId"},{$ref:"#/definitions/ObstructionId"},{$ref:"#/definitions/SpaceId"}]},type:"array"},opacity:{maximum:1,minimum:0,type:"number"},width:{description:"The thickness of the line when rendered, in meters, measured from the center to the edge.",exclusiveMinimum:0,type:"number"}},required:["altitude","color","height","lineStrings","opacity","width"],type:"object"},LocalPosition:{description:"A position for a local coordinate system, measured in metres.",items:{type:"number"},maxItems:2,minItems:2,type:"array"},Location:{additionalProperties:!1,properties:{annotations:{items:{$ref:"#/definitions/LocationAnnotationMapping"},type:"array"},areas:{items:{$ref:"#/definitions/LocationAreaMapping"},type:"array"},categories:{items:{$ref:"#/definitions/CategoryId"},type:"array"},connections:{items:{$ref:"#/definitions/ConnectionId"},type:"array"},description:{type:"string"},entrances:{items:{$ref:"#/definitions/LocationEntranceMapping"},type:"array"},externalId:{type:"string"},icon:{description:"The location's icon, one of picture/category/logo",format:"uri",type:"string"},id:{$ref:"#/definitions/LocationId"},links:{description:"Web links for the location",items:{$ref:"#/definitions/LocationLink"},type:"array"},logo:{description:"The location's logo",format:"uri",type:"string"},name:{type:"string"},obstructions:{items:{$ref:"#/definitions/LocationObstructionMapping"},type:"array"},openingHoursSpecification:{description:"The location's opening hours",items:{$ref:"#/definitions/OpeningHoursSpecification"},type:"array"},phone:{type:"string"},pictures:{description:"The location's pictures",items:{$ref:"#/definitions/LocationPicture"},type:"array"},social:{description:"The location's social media links.",items:{$ref:"#/definitions/LocationSocial"},type:"array"},spaces:{items:{$ref:"#/definitions/LocationSpaceMapping"},type:"array"},website:{$ref:"#/definitions/LocationLink",description:"The location's website"}},required:["id","name","categories","spaces","obstructions","entrances","connections","annotations","areas","social","pictures","links","openingHoursSpecification"],type:"object"},LocationAnnotationMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/AnnotationId"}},required:["floor","id"],type:"object"},LocationAreaMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/AreaId"}},required:["floor","id"],type:"object"},LocationEntranceMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/EntranceId"}},required:["floor","id"],type:"object"},LocationId:{description:"An ID for a location",pattern:"^loc_[A-Za-z0-9_-]{8,}$",type:"string"},LocationLink:{additionalProperties:!1,properties:{label:{type:"string"},url:{description:"The URL of the link",format:"uri",type:"string"}},required:["label","url"],type:"object"},LocationObstructionMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/ObstructionId"}},required:["floor","id"],type:"object"},LocationPicture:{additionalProperties:!1,description:"The location's pictures Single-field object, because it's plausible we might add captions or comments in the future",properties:{url:{format:"uri",type:"string"}},type:"object"},LocationSocial:{additionalProperties:!1,properties:{name:{description:"The name of the social media platform.",type:"string"},url:{description:"The URL of the social media profile",format:"uri",type:"string"}},required:["name","url"],type:"object"},LocationSpaceMapping:{additionalProperties:!1,properties:{floor:{$ref:"#/definitions/FloorId"},id:{$ref:"#/definitions/SpaceId"}},required:["floor","id"],type:"object"},LocationState:{additionalProperties:!1,description:"The state of a location. Start and end dates are optional.",properties:{end:{description:"The start date of the state",format:"date",type:"string"},start:{description:"The start date of the state",format:"date",type:"string"},type:{description:`The type of the location state. Technically not limited, but should be one of the following:
- closed-temporarily
- new
- pop-up
- coming-soon
- relocated`,type:"string"}},required:["type"],type:"object"},Longitude:{description:"A WGS 84-compatible longitude coordinate value.",maximum:180,minimum:-180,type:"number"},ManifestCollection:{additionalProperties:!1,properties:{features:{items:{$ref:"#/definitions/ManifestFeature"},maxItems:1,minItems:1,type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},ManifestFeature:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/Point"},properties:{$ref:"#/definitions/ManifestProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},ManifestFile:{additionalProperties:!1,properties:{name:{type:"string"},type:{const:"file",type:"string"}},required:["type","name"],type:"object"},ManifestFolder:{additionalProperties:!1,properties:{children:{items:{$ref:"#/definitions/ManifestFile"},minItems:1,type:"array"},name:{type:"string"},type:{const:"folder",type:"string"}},required:["type","name","children"],type:"object"},ManifestProperties:{additionalProperties:!1,properties:{folder_struct:{items:{anyOf:[{$ref:"#/definitions/ManifestFolder"},{$ref:"#/definitions/ManifestFile"}]},type:"array"},language:{description:"The RFC 5646 language tag of the MVF. https://datatracker.ietf.org/doc/html/rfc5646",examples:["en-US"],type:"string"},map:{description:"The identifier of the map that this MVF is for.",type:"string"},name:{type:"string"},naturalBearing:{description:'The angle, in degrees, the map is considered to be "naturally oriented" as, rather than facing directly north. 90 degrees means East is "up"',maximum:360,minimum:0,type:"number"},org_id:{type:"string"},time:{description:"An ISO 8601 date-time string, including timezone offset.",format:"date-time",type:"string"},tzid:{description:"The map's timezone, from the IANA Time Zone Database. Should be in the format of `America/New_York`",examples:["America/New_York"],pattern:"^[A-Za-z0-9_-]+\\/[A-Za-z0-9_-]+$",type:"string"},version:{const:"2.0.0",type:"string"}},required:["name","folder_struct","version","time"],type:"object"},Maps:{deprecated:"This is only present on `map.geojson` which is deprecated. Use\nthe collection on `floor.geojson` instead.",items:{$ref:"#/definitions/FloorProperties"},type:"array"},Material:{additionalProperties:!1,description:`The color and/or texture that should be applied to an instance of a Shape.

If both a color and a texture are provided, the color will be applied to the texture via a multiply operation. If neither are provided, the shape will be white.`,properties:{color:{description:"The color of this mateial as a hex code.",pattern:"^#[0-9a-fA-F]{6}$",type:"string"},texture:{$ref:"#/definitions/Texture"}},type:"object"},Metadata:{additionalProperties:{},description:"Can be any extra metadata that is not part of the main MVF spec. Presence of any key or value is not guaranteed. Values are expected to be JSON-serializable.",type:"object"},ModelInstance:{additionalProperties:!1,description:"An instance of a 3D model.",properties:{altitude:{description:"The distance above ground, in metres, where this Decoration's origin point should be placed.",type:"number"},path:{description:"The path to this asset, relative to the MVF's models folder. Supports GLTF and OBJ.",minLength:1,type:"string"},position:{$ref:"#/definitions/Position",description:"The long/lat point that the Decoration's origin point correponds to."},rotation:{$ref:"#/definitions/Vector3",description:"The rotation, in Euler angles in XYZ order, that will be applied to this Decoration."},scale:{$ref:"#/definitions/Vector3",description:"The X, Y and Z scale that will be applied to this Decoration."}},required:["altitude","path","position","rotation","scale"],type:"object"},ModelInstanceCollection:{additionalProperties:{$ref:"#/definitions/ModelInstance"},description:"A map of model instances, where keys are valid polygon or obstruction IDs. Replaces the specified polygon.",type:"object"},MultiPolygon:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON MultiPolygon geometry.",properties:{coordinates:{items:{items:{items:{$ref:"#/definitions/Position"},type:"array"},type:"array"},type:"array"},type:{const:"MultiPolygon",type:"string"}},required:["coordinates","type"],type:"object"},NodeCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CNodeProperties%3E"},NodeId:{pattern:"^n_[A-Za-z0-9_-]{8,}$",type:"string"},NodeProperties:{additionalProperties:!1,properties:{externalId:{type:"string"},floor:{$ref:"#/definitions/FloorId",description:"The ID of the floor this node is found on."},id:{$ref:"#/definitions/NodeId"},map:{$ref:"#/definitions/FloorId",deprecated:"use `floor` instead.",description:"The ID of the floor this node is found on."},neighbors:{description:"A list of nodes that can be navigated to from this node.",items:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/NodeId"},weight:{description:"The cost of navigating to this node.",minimum:0,type:"number"}},required:["id","weight"],type:"object"},type:"array"},preventSmoothing:{description:"Flag that may optionally indicate that a node is part of a custom path network rather than auto generated and should not be removed during smoothing/simplifcation.",type:"boolean"},space:{description:"The IDs of any spaces this node may be contained within.",items:{$ref:"#/definitions/SpaceId"},type:"array"}},required:["id","externalId","map","space","neighbors"],type:"object"},ObstructionCollection:{$ref:"#/definitions/FeatureCollection%3C(Polygon%7CLineString)%2CObstructionProperties%3E"},ObstructionId:{pattern:"^o_[A-Za-z0-9_-]{8,}$",type:"string"},ObstructionProperties:{additionalProperties:!1,properties:{center:{$ref:"#/definitions/Position",description:"The center of mass of this obstruction, if it is a polygon. This is undefined for line strings as this can be trivially derived."},details:{$ref:"#/definitions/Details"},entrances:{description:"A list of entrance IDs corresponding to entrances that can be used to navigate through this obstruction.",items:{$ref:"#/definitions/EntranceId"},type:"array"},externalId:{type:"string"},footprintComponent:{description:"Indicates whether this obstruction is considered part of the footprint of the building it is a part of. For example, an exterior wall would be considered part of the building footprint.",type:"boolean"},id:{$ref:"#/definitions/ObstructionId"},kind:{type:"string"},metadata:{$ref:"#/definitions/Metadata"}},required:["id","externalId","entrances"],type:"object"},OpeningHoursSpecification:{additionalProperties:!1,description:`We (almost) follow this schema (http://schema.org/OpeningHoursSpecification) The only difference is that we (like Google: https://developers.google.com/search/docs/data-types/local-businesses) accept dayOfWeek as an array as well as an individual day.

Behavioral notes:
- if the "opens" property is not present, the location is closed, and the closes property is ignored (Schema.org style)
- if opens/closes are both set to 00:00, the location is closed (Google style)
- If special hours do not specifiy certain weekdays being open, those weekdays are closed.
- Not specifying dayOfWeek is equivalent to specifying every day of the week.
- we will omit the '@type' property when producing MVFs. But we won't reject 3rd party MVFs that include it.`,properties:{"@type":{const:"OpeningHoursSpecification",default:"OpeningHoursSpecification",description:"The type of opening hours",type:"string"},closes:{$ref:"#/definitions/Time",description:"The time the opening hours end"},dayOfWeek:{anyOf:[{$ref:"#/definitions/DayOrPublicHoliday"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},maxItems:1,minItems:1,type:"array"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},type:"array"}],description:"The days of the week the opening hours apply to"},opens:{$ref:"#/definitions/Time",description:"The time the opening hours start"},validFrom:{description:"The date the opening hours start, in ISO 8601 format",format:"date-time",type:"string"},validThrough:{description:"The date the opening hours end, in ISO 8601 format",format:"date-time",type:"string"}},type:"object"},OperationHours:{additionalProperties:!1,description:"We (almost) follow this schema (http://schema.org/OpeningHoursSpecification) The only difference is that we (like Google: https://developers.google.com/search/docs/data-types/local-businesses) accept dayOfWeek as an array as well as an individual day.",properties:{"@type":{const:"OpeningHoursSpecification",default:"OpeningHoursSpecification",description:"The type of operation hours",type:"string"},closes:{$ref:"#/definitions/Time",description:"The time the operation hours end"},dayOfWeek:{anyOf:[{$ref:"#/definitions/DayOrPublicHoliday"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},maxItems:1,minItems:1,type:"array"},{items:{$ref:"#/definitions/DayOrPublicHoliday"},type:"array"}],description:"The days of the week the operation hours apply to"},opens:{$ref:"#/definitions/Time",description:"The time the operation hours start"},validFrom:{description:"The date the operation hours start, in ISO 8601 format",format:"date-time",type:"string"},validThrough:{description:"The date the operation hours end, in ISO 8601 format",format:"date-time",type:"string"}},type:"object"},ParsedMVF:{additionalProperties:!1,properties:{annotation:{additionalProperties:{anyOf:[{$ref:"#/definitions/AnnotationCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},area:{additionalProperties:{anyOf:[{$ref:"#/definitions/AreaCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"category.json":{items:{$ref:"#/definitions/Category"},type:"array"},"connection.json":{$ref:"#/definitions/Connections"},enterprise:{$ref:"#/definitions/EnterpriseCollection"},entrance:{additionalProperties:{anyOf:[{$ref:"#/definitions/EntranceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},facade:{additionalProperties:{anyOf:[{$ref:"#/definitions/Facade"},{not:{}}]},propertyNames:{pattern:"^fs_[A-Za-z0-9_-]{8,}$"},type:"object"},"floor.geojson":{$ref:"#/definitions/FloorCollection"},floorImages:{additionalProperties:{anyOf:[{$ref:"#/definitions/FloorImageFeatureCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"floorstack.json":{$ref:"#/definitions/FloorStacks"},"location.json":{items:{$ref:"#/definitions/Location"},type:"array"},"manifest.geojson":{$ref:"#/definitions/ManifestCollection"},"map.geojson":{$ref:"#/definitions/Maps",deprecated:"Use `floor.geojson` instead."},"mapstack.geojson":{$ref:"#/definitions/FloorStacks",deprecated:"Use `floorstack.json` instead."},"mapstack.json":{$ref:"#/definitions/FloorStacks",deprecated:"Use `floorstack.json` instead."},modelInstances:{additionalProperties:{anyOf:[{$ref:"#/definitions/ModelInstanceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"node.geojson":{$ref:"#/definitions/NodeCollection"},obstruction:{additionalProperties:{anyOf:[{$ref:"#/definitions/ObstructionCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},shapeInstances:{additionalProperties:{anyOf:[{$ref:"#/definitions/ShapeInstanceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"shapes.json":{$ref:"#/definitions/ShapeCollection"},space:{additionalProperties:{anyOf:[{$ref:"#/definitions/SpaceCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"styles.json":{$ref:"#/definitions/StyleCollection"},textAreas:{additionalProperties:{anyOf:[{$ref:"#/definitions/TextAreaFeatureCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"},"tileset.json":{$ref:"#/definitions/TilesetCollection"},window:{additionalProperties:{anyOf:[{$ref:"#/definitions/WindowCollection"},{not:{}}]},propertyNames:{pattern:"^[mf]_[A-Za-z0-9_-]{8,}$"},type:"object"}},required:["manifest.geojson","mapstack.geojson","map.geojson","space","obstruction","connection.json","node.geojson","entrance"],type:"object"},Point:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON Point geometry.",properties:{coordinates:{$ref:"#/definitions/Position"},type:{const:"Point",type:"string"}},required:["coordinates","type"],type:"object"},PointStyle:{additionalProperties:!1,properties:{points:{description:"The points which this style applies to.",items:{$ref:"#/definitions/SpaceId"},type:"array"},showImage:{description:"Whether or not the first image attached to the space or obstruction should be displayed on the point.",type:"boolean"}},required:["points"],type:"object"},Polygon:{additionalProperties:!1,description:"An RFC-7946 compatible GeoJSON Polygon geometry.",properties:{coordinates:{items:{items:{$ref:"#/definitions/Position"},type:"array"},type:"array"},type:{const:"Polygon",type:"string"}},required:["coordinates","type"],type:"object"},PolygonStyle:{additionalProperties:!1,properties:{altitude:{description:'How far off the "ground" the objects belonging to this layer should be drawn, in meters.',minimum:0,type:"number"},color:{description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB",pattern:"^#[0-9a-fA-F]{6}$",type:"string"},height:{description:"The height of the objects belonging to this layer, in meters.",minimum:0,type:"number"},opacity:{maximum:1,minimum:0,type:"number"},polygons:{description:"The polygons which this style applies to.",items:{anyOf:[{$ref:"#/definitions/ObstructionId"},{$ref:"#/definitions/SpaceId"}]},type:"array"},showImage:{description:"Whether or not the first image attached to the space or obstruction should be displayed on the polygon.",type:"boolean"}},required:["altitude","color","height","opacity","polygons"],type:"object"},Position:{description:"A valid WGS 84 position consisting of a longitude coodinate, followed by a latitude coordinate.",items:[{$ref:"#/definitions/Longitude"},{$ref:"#/definitions/Latitude"}],maxItems:2,minItems:2,type:"array"},Ring:{description:"A simple shape for part of a complex polygon",items:{$ref:"#/definitions/LocalPosition"},minItems:3,type:"array"},Shape:{description:"A 3D object made from extruded 2D polygons, that can be rendered to the map as a ShapeInstance.",items:{$ref:"#/definitions/ShapeComponent"},minItems:1,type:"array"},ShapeCollection:{additionalProperties:{$ref:"#/definitions/Shape"},description:"A group of Shapes, without any information as to how they will be placed in a scene.",propertyNames:{pattern:"^sh_[A-Za-z0-9_-]{8,}$"},type:"object"},ShapeComponent:{additionalProperties:!1,description:"A single extruded 2D polygon.",properties:{altitude:{description:"In metres.",type:"number"},geometry:{description:"Can contain holes, like GeoJSON.",items:{$ref:"#/definitions/Ring"},minItems:1,type:"array"},height:{description:"In metres.",exclusiveMinimum:0,type:"number"}},required:["geometry","altitude","height"],type:"object"},ShapeId:{pattern:"^sh_[A-Za-z0-9_-]{8,}$",type:"string"},ShapeInstance:{additionalProperties:!1,description:"An instance of a Shape.",properties:{altitude:{description:"The distance above ground, in metres, where this Decoration's origin point should be placed.",type:"number"},id:{$ref:"#/definitions/ShapeId",description:"The identifier of the Shape to be placed."},material:{$ref:"#/definitions/Material",description:"The color and/or texture to apply to this shape instance."},position:{$ref:"#/definitions/Position",description:"The long/lat point that the Decoration's origin point correponds to."},rotation:{$ref:"#/definitions/Vector3",description:"The rotation, in Euler angles in XYZ order, that will be applied to this Decoration."},scale:{$ref:"#/definitions/Vector3",description:"The X, Y and Z scale that will be applied to this Decoration."}},required:["altitude","id","material","position","rotation","scale"],type:"object"},ShapeInstanceCollection:{additionalProperties:{$ref:"#/definitions/ShapeInstance"},description:"A map of shape instances, where keys are valid polygon or obstruction IDs. Replaces the specified polygon.",type:"object"},SiblingGroup:{additionalProperties:!1,properties:{label:{type:"string"},siblings:{items:{$ref:"#/definitions/EnterpriseLocationId"},type:"array"}},required:["label","siblings"],type:"object"},SpaceCollection:{$ref:"#/definitions/FeatureCollection%3C(Polygon%7CLineString%7CPoint)%2CSpaceProperties%3E"},SpaceId:{pattern:"^s_[A-Za-z0-9_-]{8,}$",type:"string"},SpaceProperties:{additionalProperties:!1,properties:{center:{$ref:"#/definitions/Position",description:"The center of mass of this space, if it is a polygon. This is undefined for line string and point spaces as these can be trivially derived."},destinationNodes:{description:"A list of node IDs which can be used to navigate to this space.",items:{$ref:"#/definitions/NodeId"},type:"array"},details:{$ref:"#/definitions/Details"},externalId:{type:"string"},id:{$ref:"#/definitions/SpaceId"},kind:{type:"string"},metadata:{$ref:"#/definitions/Metadata"},tags:{description:"A list of tags that may apply to categorize the space, e.g. Void",items:{type:"string"},type:"array"}},required:["id","externalId","destinationNodes"],type:"object"},StyleCollection:{additionalProperties:{anyOf:[{$ref:"#/definitions/PolygonStyle"},{$ref:"#/definitions/LineStringStyle"},{$ref:"#/definitions/PointStyle"},{not:{}}]},description:"A map of layer styles, where keys represent the group IDs of each style.",type:"object"},TextAreaAlignment:{enum:["near","center"],type:"string"},TextAreaFeatureCollection:{$ref:"#/definitions/FeatureCollection%3CPoint%2CTextAreaProperties%3E",description:"A collection of text areas to be displayed on a map. They are either attached to a polygon or are floating in space."},TextAreaProperties:{anyOf:[{$ref:"#/definitions/AnchoredTextAreaProperties"},{$ref:"#/definitions/FloatingTextAreaProperties"}]},Texture:{additionalProperties:!1,description:"A reference to an image texture and how it should be applied to a Component.",properties:{path:{description:"The path to this asset, relative to the MVF's images folder.",minLength:1,type:"string"},repeat:{$ref:"#/definitions/TextureRepeat"}},required:["path"],type:"object"},TextureRepeat:{additionalProperties:!1,description:"How a texture should be placed on a Component.",properties:{u:{type:"number"},v:{type:"number"}},required:["u","v"],type:"object"},TilesetCollection:{additionalProperties:!1,description:"Collection of tileset styles",properties:{default:{$ref:"#/definitions/TilesetStyle",description:"Default tileset style that should be used"},others:{description:"Additional tileset styles that can be used",items:{$ref:"#/definitions/TilesetStyle"},type:"array"}},required:["default"],type:"object"},TilesetStyle:{additionalProperties:!1,description:"A tileset style definition",properties:{key:{description:"Unique identifier for this tileset style",minLength:1,type:"string"},name:{description:"Display name for this tileset style",minLength:1,type:"string"},url:{description:"URL to the tileset style definition. This should be a JSON file matching the MapLibre style specification.",format:"uri",type:"string"}},required:["key","name","url"],type:"object"},Time:{description:"A time in the format of HH:MM:SS",pattern:"^[0-2][0-9]:[0-6][0-9](:[0-6][0-9])?$",type:"string"},Vector3:{description:"A three-number tuple.",items:{type:"number"},maxItems:3,minItems:3,type:"array"},WindowCollection:{additionalProperties:!1,properties:{features:{items:{additionalProperties:!1,properties:{geometry:{$ref:"#/definitions/LineString"},properties:{$ref:"#/definitions/WindowProperties"},type:{$ref:"#/definitions/FeatureType"}},required:["type","geometry","properties"],type:"object"},type:"array"},type:{$ref:"#/definitions/FeatureCollectionType"}},required:["type","features"],type:"object"},WindowId:{pattern:"^w_[A-Za-z0-9_-]{8,}$",type:"string"},WindowProperties:{additionalProperties:!1,properties:{id:{$ref:"#/definitions/WindowId"}},required:["id"],type:"object"}}};wXe.default.default(new bXe.default.default).compile(d3(SXe));N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();N();var Va={};kl(Va,{HasPropertyKey:()=>r0e,IsArray:()=>Ec,IsAsyncIterator:()=>bz,IsBigInt:()=>t4,IsBoolean:()=>gx,IsDate:()=>YA,IsFunction:()=>wz,IsIterator:()=>Az,IsNull:()=>Sz,IsNumber:()=>vf,IsObject:()=>ro,IsRegExp:()=>r4,IsString:()=>Yo,IsSymbol:()=>Mz,IsUint8Array:()=>gv,IsUndefined:()=>sl});N();function r0e(t,e){return e in t}s(r0e,"HasPropertyKey");function bz(t){return ro(t)&&!Ec(t)&&!gv(t)&&Symbol.asyncIterator in t}s(bz,"IsAsyncIterator");function Ec(t){return Array.isArray(t)}s(Ec,"IsArray");function t4(t){return typeof t=="bigint"}s(t4,"IsBigInt");function gx(t){return typeof t=="boolean"}s(gx,"IsBoolean");function YA(t){return t instanceof globalThis.Date}s(YA,"IsDate");function wz(t){return typeof t=="function"}s(wz,"IsFunction");function Az(t){return ro(t)&&!Ec(t)&&!gv(t)&&Symbol.iterator in t}s(Az,"IsIterator");function Sz(t){return t===null}s(Sz,"IsNull");function vf(t){return typeof t=="number"}s(vf,"IsNumber");function ro(t){return typeof t=="object"&&t!==null}s(ro,"IsObject");function r4(t){return t instanceof globalThis.RegExp}s(r4,"IsRegExp");function Yo(t){return typeof t=="string"}s(Yo,"IsString");function Mz(t){return typeof t=="symbol"}s(Mz,"IsSymbol");function gv(t){return t instanceof globalThis.Uint8Array}s(gv,"IsUint8Array");function sl(t){return t===void 0}s(sl,"IsUndefined");function i0e(t){return t.map(e=>Vw(e))}s(i0e,"ArrayType");function n0e(t){return new Date(t.getTime())}s(n0e,"DateType");function a0e(t){return new Uint8Array(t)}s(a0e,"Uint8ArrayType");function o0e(t){return new RegExp(t.source,t.flags)}s(o0e,"RegExpType");function s0e(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=Vw(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=Vw(t[r]);return e}s(s0e,"ObjectType");function Vw(t){return Ec(t)?i0e(t):YA(t)?n0e(t):gv(t)?a0e(t):r4(t)?o0e(t):ro(t)?s0e(t):t}s(Vw,"Visit");function Bu(t){return Vw(t)}s(Bu,"Clone");function l0e(t){return t.map(e=>i4(e))}s(l0e,"CloneRest");function i4(t,e){return Bu(e===void 0?t:Ee(Ee({},e),t))}s(i4,"CloneType");N();N();N();function Ez(t){return On(t)&&Symbol.asyncIterator in t}s(Ez,"IsAsyncIterator");function Cz(t){return On(t)&&Symbol.iterator in t}s(Cz,"IsIterator");function Iz(t){return On(t)&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}s(Iz,"IsStandardObject");function Tz(t){return t instanceof Promise}s(Tz,"IsPromise");function Mf(t){return t instanceof Date&&Number.isFinite(t.getTime())}s(Mf,"IsDate");function u0e(t){return t instanceof globalThis.Map}s(u0e,"IsMap");function c0e(t){return t instanceof globalThis.Set}s(c0e,"IsSet");function Ef(t){return ArrayBuffer.isView(t)}s(Ef,"IsTypedArray");function n4(t){return t instanceof globalThis.Uint8Array}s(n4,"IsUint8Array");function Oi(t,e){return e in t}s(Oi,"HasPropertyKey");function On(t){return t!==null&&typeof t=="object"}s(On,"IsObject");function Bn(t){return Array.isArray(t)&&!ArrayBuffer.isView(t)}s(Bn,"IsArray");function Hu(t){return t===void 0}s(Hu,"IsUndefined");function yx(t){return t===null}s(yx,"IsNull");function yv(t){return typeof t=="boolean"}s(yv,"IsBoolean");function xi(t){return typeof t=="number"}s(xi,"IsNumber");function Pz(t){return Number.isInteger(t)}s(Pz,"IsInteger");function fc(t){return typeof t=="bigint"}s(fc,"IsBigInt");function va(t){return typeof t=="string"}s(va,"IsString");function KA(t){return typeof t=="function"}s(KA,"IsFunction");function vx(t){return typeof t=="symbol"}s(vx,"IsSymbol");function od(t){return fc(t)||yv(t)||yx(t)||xi(t)||va(t)||vx(t)||Hu(t)}s(od,"IsValueType");var Co;(function(t){t.InstanceMode="default",t.ExactOptionalPropertyTypes=!1,t.AllowArrayObject=!1,t.AllowNaN=!1,t.AllowNullVoid=!1;function e(o,l){return t.ExactOptionalPropertyTypes?l in o:o[l]!==void 0}s(e,"IsExactOptionalProperty"),t.IsExactOptionalProperty=e;function r(o){let l=On(o);return t.AllowArrayObject?l:l&&!Bn(o)}s(r,"IsObjectLike"),t.IsObjectLike=r;function i(o){return r(o)&&!(o instanceof Date)&&!(o instanceof Uint8Array)}s(i,"IsRecordLike"),t.IsRecordLike=i;function n(o){return t.AllowNaN?xi(o):Number.isFinite(o)}s(n,"IsNumberLike"),t.IsNumberLike=n;function a(o){let l=Hu(o);return t.AllowNullVoid?l||o===null:l}s(a,"IsVoidLike"),t.IsVoidLike=a})(Co||(Co={}));N();function h0e(t){return globalThis.Object.freeze(t).map(e=>jw(e))}s(h0e,"ImmutableArray");function p0e(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=jw(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=jw(t[r]);return globalThis.Object.freeze(e)}s(p0e,"ImmutableObject");function jw(t){return Ec(t)?h0e(t):YA(t)||gv(t)||r4(t)?t:ro(t)?p0e(t):t}s(jw,"Immutable");function ri(t,e){let r=e!==void 0?Ee(Ee({},e),t):t;switch(Co.InstanceMode){case"freeze":return jw(r);case"clone":return Bu(r);default:return r}}s(ri,"CreateType");N();var d0e=class extends Error{constructor(e){super(e)}};s(d0e,"TypeBoxError");var Ca=d0e;N();N();N();var Du=Symbol.for("TypeBox.Transform"),JA=Symbol.for("TypeBox.Readonly"),pg=Symbol.for("TypeBox.Optional"),B_=Symbol.for("TypeBox.Hint"),br=Symbol.for("TypeBox.Kind");function f0e(t){return ro(t)&&t[JA]==="Readonly"}s(f0e,"IsReadonly");function vv(t){return ro(t)&&t[pg]==="Optional"}s(vv,"IsOptional");function Lz(t){return Sn(t,"Any")}s(Lz,"IsAny");function _x(t){return Sn(t,"Array")}s(_x,"IsArray");function a4(t){return Sn(t,"AsyncIterator")}s(a4,"IsAsyncIterator");function Dz(t){return Sn(t,"BigInt")}s(Dz,"IsBigInt");function Rz(t){return Sn(t,"Boolean")}s(Rz,"IsBoolean");function o4(t){return Sn(t,"Constructor")}s(o4,"IsConstructor");function m0e(t){return Sn(t,"Date")}s(m0e,"IsDate");function s4(t){return Sn(t,"Function")}s(s4,"IsFunction");function QA(t){return Sn(t,"Integer")}s(QA,"IsInteger");function oh(t){return Sn(t,"Intersect")}s(oh,"IsIntersect");function l4(t){return Sn(t,"Iterator")}s(l4,"IsIterator");function Sn(t,e){return ro(t)&&br in t&&t[br]===e}s(Sn,"IsKindOf");function xx(t){return Sn(t,"Literal")}s(xx,"IsLiteral");function dg(t){return Sn(t,"MappedKey")}s(dg,"IsMappedKey");function qu(t){return Sn(t,"MappedResult")}s(qu,"IsMappedResult");function bx(t){return Sn(t,"Never")}s(bx,"IsNever");function g0e(t){return Sn(t,"Not")}s(g0e,"IsNot");function y0e(t){return Sn(t,"Null")}s(y0e,"IsNull");function eS(t){return Sn(t,"Number")}s(eS,"IsNumber");function Jh(t){return Sn(t,"Object")}s(Jh,"IsObject");function tS(t){return Sn(t,"Promise")}s(tS,"IsPromise");function Oz(t){return Sn(t,"Record")}s(Oz,"IsRecord");function kz(t){return Sn(t,"Ref")}s(kz,"IsRef");function Nz(t){return Sn(t,"RegExp")}s(Nz,"IsRegExp");function u4(t){return Sn(t,"String")}s(u4,"IsString");function v0e(t){return Sn(t,"Symbol")}s(v0e,"IsSymbol");function fg(t){return Sn(t,"TemplateLiteral")}s(fg,"IsTemplateLiteral");function _0e(t){return Sn(t,"This")}s(_0e,"IsThis");function c4(t){return ro(t)&&Du in t}s(c4,"IsTransform");function _v(t){return Sn(t,"Tuple")}s(_v,"IsTuple");function x0e(t){return Sn(t,"Undefined")}s(x0e,"IsUndefined");function Gs(t){return Sn(t,"Union")}s(Gs,"IsUnion");function b0e(t){return Sn(t,"Uint8Array")}s(b0e,"IsUint8Array");function w0e(t){return Sn(t,"Unknown")}s(w0e,"IsUnknown");function A0e(t){return Sn(t,"Unsafe")}s(A0e,"IsUnsafe");function S0e(t){return Sn(t,"Void")}s(S0e,"IsVoid");function xv(t){return ro(t)&&br in t&&Yo(t[br])}s(xv,"IsKind");function Jy(t){return Lz(t)||_x(t)||Rz(t)||Dz(t)||a4(t)||o4(t)||m0e(t)||s4(t)||QA(t)||oh(t)||l4(t)||xx(t)||dg(t)||qu(t)||bx(t)||g0e(t)||y0e(t)||eS(t)||Jh(t)||tS(t)||Oz(t)||kz(t)||Nz(t)||u4(t)||v0e(t)||fg(t)||_0e(t)||_v(t)||x0e(t)||Gs(t)||b0e(t)||w0e(t)||A0e(t)||S0e(t)||xv(t)}s(Jy,"IsSchema");var it={};kl(it,{IsAny:()=>Uz,IsArray:()=>Vz,IsAsyncIterator:()=>jz,IsBigInt:()=>$z,IsBoolean:()=>Gz,IsConstructor:()=>Hz,IsDate:()=>qz,IsFunction:()=>Wz,IsInteger:()=>Xz,IsIntersect:()=>Zz,IsIterator:()=>Yz,IsKind:()=>xU,IsKindOf:()=>_n,IsLiteral:()=>wx,IsLiteralBoolean:()=>P0e,IsLiteralNumber:()=>Jz,IsLiteralString:()=>Kz,IsLiteralValue:()=>Qz,IsMappedKey:()=>eU,IsMappedResult:()=>tU,IsNever:()=>rU,IsNot:()=>iU,IsNull:()=>nU,IsNumber:()=>aU,IsObject:()=>oU,IsOptional:()=>T0e,IsPromise:()=>sU,IsProperties:()=>d4,IsReadonly:()=>I0e,IsRecord:()=>lU,IsRecursive:()=>L0e,IsRef:()=>uU,IsRegExp:()=>cU,IsSchema:()=>Gn,IsString:()=>hU,IsSymbol:()=>pU,IsTemplateLiteral:()=>dU,IsThis:()=>fU,IsTransform:()=>io,IsTuple:()=>mU,IsUint8Array:()=>gU,IsUndefined:()=>rS,IsUnion:()=>f4,IsUnionLiteral:()=>D0e,IsUnknown:()=>yU,IsUnsafe:()=>vU,IsVoid:()=>_U,TypeGuardUnknownTypeError:()=>MXe});N();var M0e=class extends Ca{};s(M0e,"TypeGuardUnknownTypeError");var MXe=M0e,EXe=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function Fz(t){try{return new RegExp(t),!0}catch{return!1}}s(Fz,"IsPattern");function h4(t){if(!Yo(t))return!1;for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);if(r>=7&&r<=13||r===27||r===127)return!1}return!0}s(h4,"IsControlCharacterFree");function Bz(t){return p4(t)||Gn(t)}s(Bz,"IsAdditionalProperties");function Z0(t){return sl(t)||t4(t)}s(Z0,"IsOptionalBigInt");function ya(t){return sl(t)||vf(t)}s(ya,"IsOptionalNumber");function p4(t){return sl(t)||gx(t)}s(p4,"IsOptionalBoolean");function Qn(t){return sl(t)||Yo(t)}s(Qn,"IsOptionalString");function E0e(t){return sl(t)||Yo(t)&&h4(t)&&Fz(t)}s(E0e,"IsOptionalPattern");function C0e(t){return sl(t)||Yo(t)&&h4(t)}s(C0e,"IsOptionalFormat");function zz(t){return sl(t)||Gn(t)}s(zz,"IsOptionalSchema");function I0e(t){return ro(t)&&t[JA]==="Readonly"}s(I0e,"IsReadonly");function T0e(t){return ro(t)&&t[pg]==="Optional"}s(T0e,"IsOptional");function Uz(t){return _n(t,"Any")&&Qn(t.$id)}s(Uz,"IsAny");function Vz(t){return _n(t,"Array")&&t.type==="array"&&Qn(t.$id)&&Gn(t.items)&&ya(t.minItems)&&ya(t.maxItems)&&p4(t.uniqueItems)&&zz(t.contains)&&ya(t.minContains)&&ya(t.maxContains)}s(Vz,"IsArray");function jz(t){return _n(t,"AsyncIterator")&&t.type==="AsyncIterator"&&Qn(t.$id)&&Gn(t.items)}s(jz,"IsAsyncIterator");function $z(t){return _n(t,"BigInt")&&t.type==="bigint"&&Qn(t.$id)&&Z0(t.exclusiveMaximum)&&Z0(t.exclusiveMinimum)&&Z0(t.maximum)&&Z0(t.minimum)&&Z0(t.multipleOf)}s($z,"IsBigInt");function Gz(t){return _n(t,"Boolean")&&t.type==="boolean"&&Qn(t.$id)}s(Gz,"IsBoolean");function Hz(t){return _n(t,"Constructor")&&t.type==="Constructor"&&Qn(t.$id)&&Ec(t.parameters)&&t.parameters.every(e=>Gn(e))&&Gn(t.returns)}s(Hz,"IsConstructor");function qz(t){return _n(t,"Date")&&t.type==="Date"&&Qn(t.$id)&&ya(t.exclusiveMaximumTimestamp)&&ya(t.exclusiveMinimumTimestamp)&&ya(t.maximumTimestamp)&&ya(t.minimumTimestamp)&&ya(t.multipleOfTimestamp)}s(qz,"IsDate");function Wz(t){return _n(t,"Function")&&t.type==="Function"&&Qn(t.$id)&&Ec(t.parameters)&&t.parameters.every(e=>Gn(e))&&Gn(t.returns)}s(Wz,"IsFunction");function Xz(t){return _n(t,"Integer")&&t.type==="integer"&&Qn(t.$id)&&ya(t.exclusiveMaximum)&&ya(t.exclusiveMinimum)&&ya(t.maximum)&&ya(t.minimum)&&ya(t.multipleOf)}s(Xz,"IsInteger");function d4(t){return ro(t)&&Object.entries(t).every(([e,r])=>h4(e)&&Gn(r))}s(d4,"IsProperties");function Zz(t){return _n(t,"Intersect")&&!(Yo(t.type)&&t.type!=="object")&&Ec(t.allOf)&&t.allOf.every(e=>Gn(e)&&!io(e))&&Qn(t.type)&&(p4(t.unevaluatedProperties)||zz(t.unevaluatedProperties))&&Qn(t.$id)}s(Zz,"IsIntersect");function Yz(t){return _n(t,"Iterator")&&t.type==="Iterator"&&Qn(t.$id)&&Gn(t.items)}s(Yz,"IsIterator");function _n(t,e){return ro(t)&&br in t&&t[br]===e}s(_n,"IsKindOf");function Kz(t){return wx(t)&&Yo(t.const)}s(Kz,"IsLiteralString");function Jz(t){return wx(t)&&vf(t.const)}s(Jz,"IsLiteralNumber");function P0e(t){return wx(t)&&gx(t.const)}s(P0e,"IsLiteralBoolean");function wx(t){return _n(t,"Literal")&&Qn(t.$id)&&Qz(t.const)}s(wx,"IsLiteral");function Qz(t){return gx(t)||vf(t)||Yo(t)}s(Qz,"IsLiteralValue");function eU(t){return _n(t,"MappedKey")&&Ec(t.keys)&&t.keys.every(e=>vf(e)||Yo(e))}s(eU,"IsMappedKey");function tU(t){return _n(t,"MappedResult")&&d4(t.properties)}s(tU,"IsMappedResult");function rU(t){return _n(t,"Never")&&ro(t.not)&&Object.getOwnPropertyNames(t.not).length===0}s(rU,"IsNever");function iU(t){return _n(t,"Not")&&Gn(t.not)}s(iU,"IsNot");function nU(t){return _n(t,"Null")&&t.type==="null"&&Qn(t.$id)}s(nU,"IsNull");function aU(t){return _n(t,"Number")&&t.type==="number"&&Qn(t.$id)&&ya(t.exclusiveMaximum)&&ya(t.exclusiveMinimum)&&ya(t.maximum)&&ya(t.minimum)&&ya(t.multipleOf)}s(aU,"IsNumber");function oU(t){return _n(t,"Object")&&t.type==="object"&&Qn(t.$id)&&d4(t.properties)&&Bz(t.additionalProperties)&&ya(t.minProperties)&&ya(t.maxProperties)}s(oU,"IsObject");function sU(t){return _n(t,"Promise")&&t.type==="Promise"&&Qn(t.$id)&&Gn(t.item)}s(sU,"IsPromise");function lU(t){return _n(t,"Record")&&t.type==="object"&&Qn(t.$id)&&Bz(t.additionalProperties)&&ro(t.patternProperties)&&(e=>{let r=Object.getOwnPropertyNames(e.patternProperties);return r.length===1&&Fz(r[0])&&ro(e.patternProperties)&&Gn(e.patternProperties[r[0]])})(t)}s(lU,"IsRecord");function L0e(t){return ro(t)&&B_ in t&&t[B_]==="Recursive"}s(L0e,"IsRecursive");function uU(t){return _n(t,"Ref")&&Qn(t.$id)&&Yo(t.$ref)}s(uU,"IsRef");function cU(t){return _n(t,"RegExp")&&Qn(t.$id)&&Yo(t.source)&&Yo(t.flags)&&ya(t.maxLength)&&ya(t.minLength)}s(cU,"IsRegExp");function hU(t){return _n(t,"String")&&t.type==="string"&&Qn(t.$id)&&ya(t.minLength)&&ya(t.maxLength)&&E0e(t.pattern)&&C0e(t.format)}s(hU,"IsString");function pU(t){return _n(t,"Symbol")&&t.type==="symbol"&&Qn(t.$id)}s(pU,"IsSymbol");function dU(t){return _n(t,"TemplateLiteral")&&t.type==="string"&&Yo(t.pattern)&&t.pattern[0]==="^"&&t.pattern[t.pattern.length-1]==="$"}s(dU,"IsTemplateLiteral");function fU(t){return _n(t,"This")&&Qn(t.$id)&&Yo(t.$ref)}s(fU,"IsThis");function io(t){return ro(t)&&Du in t}s(io,"IsTransform");function mU(t){return _n(t,"Tuple")&&t.type==="array"&&Qn(t.$id)&&vf(t.minItems)&&vf(t.maxItems)&&t.minItems===t.maxItems&&(sl(t.items)&&sl(t.additionalItems)&&t.minItems===0||Ec(t.items)&&t.items.every(e=>Gn(e)))}s(mU,"IsTuple");function rS(t){return _n(t,"Undefined")&&t.type==="undefined"&&Qn(t.$id)}s(rS,"IsUndefined");function D0e(t){return f4(t)&&t.anyOf.every(e=>Kz(e)||Jz(e))}s(D0e,"IsUnionLiteral");function f4(t){return _n(t,"Union")&&Qn(t.$id)&&ro(t)&&Ec(t.anyOf)&&t.anyOf.every(e=>Gn(e))}s(f4,"IsUnion");function gU(t){return _n(t,"Uint8Array")&&t.type==="Uint8Array"&&Qn(t.$id)&&ya(t.minByteLength)&&ya(t.maxByteLength)}s(gU,"IsUint8Array");function yU(t){return _n(t,"Unknown")&&Qn(t.$id)}s(yU,"IsUnknown");function vU(t){return _n(t,"Unsafe")}s(vU,"IsUnsafe");function _U(t){return _n(t,"Void")&&t.type==="void"&&Qn(t.$id)}s(_U,"IsVoid");function xU(t){return ro(t)&&br in t&&Yo(t[br])&&!EXe.includes(t[br])}s(xU,"IsKind");function Gn(t){return ro(t)&&(Uz(t)||Vz(t)||Gz(t)||$z(t)||jz(t)||Hz(t)||qz(t)||Wz(t)||Xz(t)||Zz(t)||Yz(t)||wx(t)||eU(t)||tU(t)||rU(t)||iU(t)||nU(t)||aU(t)||oU(t)||sU(t)||lU(t)||uU(t)||cU(t)||hU(t)||pU(t)||dU(t)||fU(t)||mU(t)||rS(t)||f4(t)||gU(t)||yU(t)||vU(t)||_U(t)||xU(t))}s(Gn,"IsSchema");N();var CXe="(true|false)",GC="(0|[1-9][0-9]*)",R0e="(.*)",IXe="(?!.*)",z_="^".concat(GC,"$"),U_="^".concat(R0e,"$"),TXe="^".concat(IXe,"$");N();var _f={};kl(_f,{Clear:()=>k0e,Delete:()=>N0e,Entries:()=>O0e,Get:()=>z0e,Has:()=>F0e,Set:()=>B0e});N();var Ax=new Map;function O0e(){return new Map(Ax)}s(O0e,"Entries");function k0e(){return Ax.clear()}s(k0e,"Clear");function N0e(t){return Ax.delete(t)}s(N0e,"Delete");function F0e(t){return Ax.has(t)}s(F0e,"Has");function B0e(t,e){Ax.set(t,e)}s(B0e,"Set");function z0e(t){return Ax.get(t)}s(z0e,"Get");var rh={};kl(rh,{Clear:()=>V0e,Delete:()=>j0e,Entries:()=>U0e,Get:()=>H0e,Has:()=>$0e,Set:()=>G0e});N();var Sx=new Map;function U0e(){return new Map(Sx)}s(U0e,"Entries");function V0e(){return Sx.clear()}s(V0e,"Clear");function j0e(t){return Sx.delete(t)}s(j0e,"Delete");function $0e(t){return Sx.has(t)}s($0e,"Has");function G0e(t,e){Sx.set(t,e)}s(G0e,"Set");function H0e(t){return Sx.get(t)}s(H0e,"Get");N();function q0e(t,e){return t.includes(e)}s(q0e,"SetIncludes");function W0e(t){return[...new Set(t)]}s(W0e,"SetDistinct");function X0e(t,e){return t.filter(r=>e.includes(r))}s(X0e,"SetIntersect");function Z0e(t,e){return t.reduce((r,i)=>X0e(r,i),e)}s(Z0e,"SetIntersectManyResolve");function Y0e(t){return t.length===1?t[0]:t.length>1?Z0e(t.slice(1),t[0]):[]}s(Y0e,"SetIntersectMany");function K0e(t){let e=[];for(let r of t)e.push(...r);return e}s(K0e,"SetUnionMany");N();function V_(t){return ri({[br]:"Any"},t)}s(V_,"Any");N();function bU(t,e){return ri({[br]:"Array",type:"array",items:t},e)}s(bU,"Array");N();function wU(t,e){return ri({[br]:"AsyncIterator",type:"AsyncIterator",items:t},e)}s(wU,"AsyncIterator");N();N();N();function J0e(t,e){let r=t,{[e]:i}=r;return Nh(r,[ZX(e)])}s(J0e,"DiscardKey");function Ac(t,e){return e.reduce((r,i)=>J0e(r,i),t)}s(Ac,"Discard");N();function ul(t){return ri({[br]:"Never",not:{}},t)}s(ul,"Never");N();N();function Hs(t){return ri({[br]:"MappedResult",properties:t})}s(Hs,"MappedResult");N();N();function AU(t,e,r){return ri({[br]:"Constructor",type:"Constructor",parameters:t,returns:e},r)}s(AU,"Constructor");N();function iS(t,e,r){return ri({[br]:"Function",type:"Function",parameters:t,returns:e},r)}s(iS,"Function");N();N();N();N();function f3(t,e){return ri({[br]:"Union",anyOf:t},e)}s(f3,"UnionCreate");function Q0e(t){return t.some(e=>vv(e))}s(Q0e,"IsUnionOptional");function Pk(t){return t.map(e=>vv(e)?e1e(e):e)}s(Pk,"RemoveOptionalFromRest");function e1e(t){return Ac(t,[pg])}s(e1e,"RemoveOptionalFromType");function t1e(t,e){return Q0e(t)?gg(f3(Pk(t),e)):f3(Pk(t),e)}s(t1e,"ResolveUnion");function bv(t,e){return t.length===0?ul(e):t.length===1?ri(t[0],e):t1e(t,e)}s(bv,"UnionEvaluated");N();function Fl(t,e){return t.length===0?ul(e):t.length===1?ri(t[0],e):f3(t,e)}s(Fl,"Union");N();N();N();var r1e=class extends Ca{};s(r1e,"TemplateLiteralParserError");var RW=r1e;function i1e(t){return t.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}s(i1e,"Unescape");function m4(t,e,r){return t[e]===r&&t.charCodeAt(e-1)!==92}s(m4,"IsNonEscaped");function $p(t,e){return m4(t,e,"(")}s($p,"IsOpenParen");function j_(t,e){return m4(t,e,")")}s(j_,"IsCloseParen");function SU(t,e){return m4(t,e,"|")}s(SU,"IsSeparator");function n1e(t){if(!($p(t,0)&&j_(t,t.length-1)))return!1;let e=0;for(let r=0;r<t.length;r++)if($p(t,r)&&(e+=1),j_(t,r)&&(e-=1),e===0&&r!==t.length-1)return!1;return!0}s(n1e,"IsGroup");function a1e(t){return t.slice(1,t.length-1)}s(a1e,"InGroup");function o1e(t){let e=0;for(let r=0;r<t.length;r++)if($p(t,r)&&(e+=1),j_(t,r)&&(e-=1),SU(t,r)&&e===0)return!0;return!1}s(o1e,"IsPrecedenceOr");function s1e(t){for(let e=0;e<t.length;e++)if($p(t,e))return!0;return!1}s(s1e,"IsPrecedenceAnd");function l1e(t){let[e,r]=[0,0],i=[];for(let a=0;a<t.length;a++)if($p(t,a)&&(e+=1),j_(t,a)&&(e-=1),SU(t,a)&&e===0){let o=t.slice(r,a);o.length>0&&i.push(Qy(o)),r=a+1}let n=t.slice(r);return n.length>0&&i.push(Qy(n)),i.length===0?{type:"const",const:""}:i.length===1?i[0]:{type:"or",expr:i}}s(l1e,"Or");function u1e(t){function e(n,a){if(!$p(n,a))throw new RW("TemplateLiteralParser: Index must point to open parens");let o=0;for(let l=a;l<n.length;l++)if($p(n,l)&&(o+=1),j_(n,l)&&(o-=1),o===0)return[a,l];throw new RW("TemplateLiteralParser: Unclosed group parens in expression")}s(e,"Group");function r(n,a){for(let o=a;o<n.length;o++)if($p(n,o))return[a,o];return[a,n.length]}s(r,"Range");let i=[];for(let n=0;n<t.length;n++)if($p(t,n)){let[a,o]=e(t,n),l=t.slice(a,o+1);i.push(Qy(l)),n=o}else{let[a,o]=r(t,n),l=t.slice(a,o);l.length>0&&i.push(Qy(l)),n=o-1}return i.length===0?{type:"const",const:""}:i.length===1?i[0]:{type:"and",expr:i}}s(u1e,"And");function Qy(t){return n1e(t)?Qy(a1e(t)):o1e(t)?l1e(t):s1e(t)?u1e(t):{type:"const",const:i1e(t)}}s(Qy,"TemplateLiteralParse");function g4(t){return Qy(t.slice(1,t.length-1))}s(g4,"TemplateLiteralParseExact");var c1e=class extends Ca{};s(c1e,"TemplateLiteralFiniteError");var PXe=c1e;function h1e(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="0"&&t.expr[1].type==="const"&&t.expr[1].const==="[1-9][0-9]*"}s(h1e,"IsNumberExpression");function p1e(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="true"&&t.expr[1].type==="const"&&t.expr[1].const==="false"}s(p1e,"IsBooleanExpression");function d1e(t){return t.type==="const"&&t.const===".*"}s(d1e,"IsStringExpression");function $_(t){return h1e(t)||d1e(t)?!1:p1e(t)?!0:t.type==="and"?t.expr.every(e=>$_(e)):t.type==="or"?t.expr.every(e=>$_(e)):t.type==="const"?!0:(()=>{throw new PXe("Unknown expression type")})()}s($_,"IsTemplateLiteralExpressionFinite");function MU(t){let e=g4(t.pattern);return $_(e)}s(MU,"IsTemplateLiteralFinite");N();var f1e=class extends Ca{};s(f1e,"TemplateLiteralGenerateError");var LXe=f1e;function*EU(t){if(t.length===1)return yield*vr(t[0]);for(let e of t[0])for(let r of EU(t.slice(1)))yield"".concat(e).concat(r)}s(EU,"GenerateReduce");function*m1e(t){return yield*vr(EU(t.expr.map(e=>[...nS(e)])))}s(m1e,"GenerateAnd");function*g1e(t){for(let e of t.expr)yield*vr(nS(e))}s(g1e,"GenerateOr");function*y1e(t){return yield t.const}s(y1e,"GenerateConst");function*nS(t){return t.type==="and"?yield*vr(m1e(t)):t.type==="or"?yield*vr(g1e(t)):t.type==="const"?yield*vr(y1e(t)):(()=>{throw new LXe("Unknown expression")})()}s(nS,"TemplateLiteralExpressionGenerate");function y4(t){let e=g4(t.pattern);return $_(e)?[...nS(e)]:[]}s(y4,"TemplateLiteralGenerate");N();N();function To(t,e){return ri({[br]:"Literal",const:t,type:typeof t},e)}s(To,"Literal");N();function CU(t){return ri({[br]:"Boolean",type:"boolean"},t)}s(CU,"Boolean");N();function v4(t){return ri({[br]:"BigInt",type:"bigint"},t)}s(v4,"BigInt");N();function wv(t){return ri({[br]:"Number",type:"number"},t)}s(wv,"Number");N();function xf(t){return ri({[br]:"String",type:"string"},t)}s(xf,"String");function*v1e(t){let e=t.trim().replace(/"|'/g,"");return e==="boolean"?yield CU():e==="number"?yield wv():e==="bigint"?yield v4():e==="string"?yield xf():yield(()=>{let r=e.split("|").map(i=>To(i.trim()));return r.length===0?ul():r.length===1?r[0]:bv(r)})()}s(v1e,"FromUnion");function*_1e(t){if(t[1]!=="{"){let e=To("$"),r=m3(t.slice(1));return yield*vr([e,...r])}for(let e=2;e<t.length;e++)if(t[e]==="}"){let r=v1e(t.slice(2,e)),i=m3(t.slice(e+1));return yield*vr([...r,...i])}yield To(t)}s(_1e,"FromTerminal");function*m3(t){for(let e=0;e<t.length;e++)if(t[e]==="$"){let r=To(t.slice(0,e)),i=_1e(t.slice(e));return yield*vr([r,...i])}yield To(t)}s(m3,"FromSyntax");function x1e(t){return[...m3(t)]}s(x1e,"TemplateLiteralSyntax");N();var b1e=class extends Ca{};s(b1e,"TemplateLiteralPatternError");var DXe=b1e;function w1e(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}s(w1e,"Escape");function IU(t,e){return fg(t)?t.pattern.slice(1,t.pattern.length-1):Gs(t)?"(".concat(t.anyOf.map(r=>IU(r,e)).join("|"),")"):eS(t)||QA(t)||Dz(t)?"".concat(e).concat(GC):u4(t)?"".concat(e).concat(R0e):xx(t)?"".concat(e).concat(w1e(t.const.toString())):Rz(t)?"".concat(e).concat(CXe):(()=>{throw new DXe("Unexpected Kind '".concat(t[br],"'"))})()}s(IU,"Visit");function Lk(t){return"^".concat(t.map(e=>IU(e,"")).join(""),"$")}s(Lk,"TemplateLiteralPattern");N();function $w(t){let e=y4(t).map(r=>To(r));return bv(e)}s($w,"TemplateLiteralToUnion");N();function TU(t,e){let r=Yo(t)?Lk(x1e(t)):Lk(t);return ri({[br]:"TemplateLiteral",type:"string",pattern:r},e)}s(TU,"TemplateLiteral");function A1e(t){return y4(t).map(e=>e.toString())}s(A1e,"FromTemplateLiteral");function S1e(t){let e=[];for(let r of t)e.push(...Cf(r));return e}s(S1e,"FromUnion");function M1e(t){return[t.toString()]}s(M1e,"FromLiteral");function Cf(t){return[...new Set(fg(t)?A1e(t):Gs(t)?S1e(t.anyOf):xx(t)?M1e(t.const):eS(t)?["[number]"]:QA(t)?["[number]"]:[])]}s(Cf,"IndexPropertyKeys");N();function E1e(t,e,r){let i={};for(let n of Object.getOwnPropertyNames(e))i[n]=x4(t,Cf(e[n]),r);return i}s(E1e,"FromProperties");function C1e(t,e,r){return E1e(t,e.properties,r)}s(C1e,"FromMappedResult");function I1e(t,e,r){let i=C1e(t,e,r);return Hs(i)}s(I1e,"IndexFromMappedResult");function PU(t,e){return t.map(r=>LU(r,e))}s(PU,"FromRest");function T1e(t){return t.filter(e=>!bx(e))}s(T1e,"FromIntersectRest");function P1e(t,e){return kU(T1e(PU(t,e)))}s(P1e,"FromIntersect");function L1e(t){return t.some(e=>bx(e))?[]:t}s(L1e,"FromUnionRest");function D1e(t,e){return bv(L1e(PU(t,e)))}s(D1e,"FromUnion");function R1e(t,e){return e in t?t[e]:e==="[number]"?bv(t):ul()}s(R1e,"FromTuple");function O1e(t,e){return e==="[number]"?t:ul()}s(O1e,"FromArray");function k1e(t,e){return e in t?t[e]:ul()}s(k1e,"FromProperty");function LU(t,e){var r;return oh(t)?P1e(t.allOf,e):Gs(t)?D1e(t.anyOf,e):_v(t)?R1e((r=t.items)!=null?r:[],e):_x(t)?O1e(t.items,e):Jh(t)?k1e(t.properties,e):ul()}s(LU,"IndexFromPropertyKey");function _4(t,e){return e.map(r=>LU(t,r))}s(_4,"IndexFromPropertyKeys");function Dk(t,e){return bv(_4(t,e))}s(Dk,"FromSchema");function x4(t,e,r){return qu(e)?I1e(t,e,r):dg(e)?z1e(t,e,r):ri(Jy(e)?Dk(t,Cf(e)):Dk(t,e),r)}s(x4,"Index");function N1e(t,e,r){return{[e]:x4(t,[e],Bu(r))}}s(N1e,"MappedIndexPropertyKey");function F1e(t,e,r){return e.reduce((i,n)=>Ee(Ee({},i),N1e(t,n,r)),{})}s(F1e,"MappedIndexPropertyKeys");function B1e(t,e,r){return F1e(t,e.keys,r)}s(B1e,"MappedIndexProperties");function z1e(t,e,r){let i=B1e(t,e,r);return Hs(i)}s(z1e,"IndexFromMappedKey");N();function DU(t,e){return ri({[br]:"Iterator",type:"Iterator",items:t},e)}s(DU,"Iterator");N();function U1e(t){let e=[];for(let r in t)vv(t[r])||e.push(r);return e}s(U1e,"RequiredKeys");function V1e(t,e){let r=U1e(t),i=r.length>0?{[br]:"Object",type:"object",properties:t,required:r}:{[br]:"Object",type:"object",properties:t};return ri(i,e)}s(V1e,"_Object");var js=V1e;N();function RU(t,e){return ri({[br]:"Promise",type:"Promise",item:t},e)}s(RU,"Promise");N();N();function j1e(t){return ri(Ac(t,[JA]))}s(j1e,"RemoveReadonly");function $1e(t){return ri(vt(Ee({},t),{[JA]:"Readonly"}))}s($1e,"AddReadonly");function G1e(t,e){return e===!1?j1e(t):$1e(t)}s(G1e,"ReadonlyWithFlag");function mg(t,e){let r=e??!0;return qu(t)?W1e(t,r):G1e(t,r)}s(mg,"Readonly");function H1e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=mg(t[i],e);return r}s(H1e,"FromProperties");function q1e(t,e){return H1e(t.properties,e)}s(q1e,"FromMappedResult");function W1e(t,e){let r=q1e(t,e);return Hs(r)}s(W1e,"ReadonlyFromMappedResult");N();function Mx(t,e){return ri(t.length>0?{[br]:"Tuple",type:"array",items:t,additionalItems:!1,minItems:t.length,maxItems:t.length}:{[br]:"Tuple",type:"array",minItems:t.length,maxItems:t.length},e)}s(Mx,"Tuple");function OU(t,e){return t in e?pc(t,e[t]):Hs(e)}s(OU,"FromMappedResult");function X1e(t){return{[t]:To(t)}}s(X1e,"MappedKeyToKnownMappedResultProperties");function Z1e(t){let e={};for(let r of t)e[r]=To(r);return e}s(Z1e,"MappedKeyToUnknownMappedResultProperties");function Y1e(t,e){return q0e(e,t)?X1e(t):Z1e(e)}s(Y1e,"MappedKeyToMappedResultProperties");function K1e(t,e){let r=Y1e(t,e);return OU(t,r)}s(K1e,"FromMappedKey");function Y0(t,e){return e.map(r=>pc(t,r))}s(Y0,"FromRest");function J1e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(e))r[i]=pc(t,e[i]);return r}s(J1e,"FromProperties");function pc(t,e){var r;let i=Ee({},e);return vv(e)?gg(pc(t,Ac(e,[pg]))):f0e(e)?mg(pc(t,Ac(e,[JA]))):qu(e)?OU(t,e.properties):dg(e)?K1e(t,e.keys):o4(e)?AU(Y0(t,e.parameters),pc(t,e.returns),i):s4(e)?iS(Y0(t,e.parameters),pc(t,e.returns),i):a4(e)?wU(pc(t,e.items),i):l4(e)?DU(pc(t,e.items),i):oh(e)?yg(Y0(t,e.allOf),i):Gs(e)?Fl(Y0(t,e.anyOf),i):_v(e)?Mx(Y0(t,(r=e.items)!=null?r:[]),i):Jh(e)?js(J1e(t,e.properties),i):_x(e)?bU(pc(t,e.items),i):tS(e)?RU(pc(t,e.item),i):e}s(pc,"FromSchemaType");function Q1e(t,e){let r={};for(let i of t)r[i]=pc(i,e);return r}s(Q1e,"MappedFunctionReturnType");function e_e(t,e,r){let i=Jy(t)?Cf(t):t,n=e({[br]:"MappedKey",keys:i}),a=Q1e(i,n);return js(a,r)}s(e_e,"Mapped");N();function t_e(t){return ri(Ac(t,[pg]))}s(t_e,"RemoveOptional");function r_e(t){return ri(vt(Ee({},t),{[pg]:"Optional"}))}s(r_e,"AddOptional");function i_e(t,e){return e===!1?t_e(t):r_e(t)}s(i_e,"OptionalWithFlag");function gg(t,e){let r=e??!0;return qu(t)?o_e(t,r):i_e(t,r)}s(gg,"Optional");function n_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=gg(t[i],e);return r}s(n_e,"FromProperties");function a_e(t,e){return n_e(t.properties,e)}s(a_e,"FromMappedResult");function o_e(t,e){let r=a_e(t,e);return Hs(r)}s(o_e,"OptionalFromMappedResult");N();function g3(t,e={}){let r=t.every(n=>Jh(n)),i=Jy(e.unevaluatedProperties)?{unevaluatedProperties:e.unevaluatedProperties}:{};return ri(e.unevaluatedProperties===!1||Jy(e.unevaluatedProperties)||r?vt(Ee({},i),{[br]:"Intersect",type:"object",allOf:t}):vt(Ee({},i),{[br]:"Intersect",allOf:t}),e)}s(g3,"IntersectCreate");function s_e(t){return t.every(e=>vv(e))}s(s_e,"IsIntersectOptional");function l_e(t){return Ac(t,[pg])}s(l_e,"RemoveOptionalFromType");function Rk(t){return t.map(e=>vv(e)?l_e(e):e)}s(Rk,"RemoveOptionalFromRest");function u_e(t,e){return s_e(t)?gg(g3(Rk(t),e)):g3(Rk(t),e)}s(u_e,"ResolveIntersect");function kU(t,e={}){if(t.length===0)return ul(e);if(t.length===1)return ri(t[0],e);if(t.some(r=>c4(r)))throw new Error("Cannot intersect transform types");return u_e(t,e)}s(kU,"IntersectEvaluated");N();function yg(t,e){if(t.length===0)return ul(e);if(t.length===1)return ri(t[0],e);if(t.some(r=>c4(r)))throw new Error("Cannot intersect transform types");return g3(t,e)}s(yg,"Intersect");function NU(t){return t.map(e=>b4(e))}s(NU,"FromRest");function c_e(t){return yg(NU(t))}s(c_e,"FromIntersect");function h_e(t){return Fl(NU(t))}s(h_e,"FromUnion");function p_e(t){return b4(t)}s(p_e,"FromPromise");function b4(t){return oh(t)?c_e(t.allOf):Gs(t)?h_e(t.anyOf):tS(t)?p_e(t.item):t}s(b4,"AwaitedResolve");function d_e(t,e){return ri(b4(t),e)}s(d_e,"Awaited");N();N();N();N();function FU(t){let e=[];for(let r of t)e.push(Qh(r));return e}s(FU,"FromRest");function f_e(t){let e=FU(t);return K0e(e)}s(f_e,"FromIntersect");function m_e(t){let e=FU(t);return Y0e(e)}s(m_e,"FromUnion");function g_e(t){return t.map((e,r)=>r.toString())}s(g_e,"FromTuple");function y_e(t){return["[number]"]}s(y_e,"FromArray");function v_e(t){return globalThis.Object.getOwnPropertyNames(t)}s(v_e,"FromProperties");function __e(t){return Ok?globalThis.Object.getOwnPropertyNames(t).map(e=>e[0]==="^"&&e[e.length-1]==="$"?e.slice(1,e.length-1):e):[]}s(__e,"FromPatternProperties");function Qh(t){var e;return oh(t)?f_e(t.allOf):Gs(t)?m_e(t.anyOf):_v(t)?g_e((e=t.items)!=null?e:[]):_x(t)?y_e(t.items):Jh(t)?v_e(t.properties):Oz(t)?__e(t.patternProperties):[]}s(Qh,"KeyOfPropertyKeys");var Ok=!1;function ev(t){Ok=!0;let e=Qh(t);Ok=!1;let r=e.map(i=>"(".concat(i,")"));return"^(".concat(r.join("|"),")$")}s(ev,"KeyOfPattern");function x_e(t){return t.map(e=>e==="[number]"?wv():To(e))}s(x_e,"KeyOfPropertyKeysToRest");function BU(t,e){if(qu(t))return A_e(t,e);{let r=Qh(t),i=x_e(r),n=bv(i);return ri(n,e)}}s(BU,"KeyOf");function b_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=BU(t[i],Bu(e));return r}s(b_e,"FromProperties");function w_e(t,e){return b_e(t.properties,e)}s(w_e,"FromMappedResult");function A_e(t,e){let r=w_e(t,e);return Hs(r)}s(A_e,"KeyOfFromMappedResult");N();function aS(t){let e=Qh(t),r=_4(t,e);return e.map((i,n)=>[e[n],r[n]])}s(aS,"KeyOfPropertyEntries");function S_e(t){let e=[];for(let r of t)e.push(...Qh(r));return W0e(e)}s(S_e,"CompositeKeys");function M_e(t){return t.filter(e=>!bx(e))}s(M_e,"FilterNever");function E_e(t,e){let r=[];for(let i of t)r.push(..._4(i,[e]));return M_e(r)}s(E_e,"CompositeProperty");function C_e(t,e){let r={};for(let i of e)r[i]=kU(E_e(t,i));return r}s(C_e,"CompositeProperties");function I_e(t,e){let r=S_e(t),i=C_e(t,r);return js(i,e)}s(I_e,"Composite");N();N();function zU(t){return ri({[br]:"Date",type:"Date"},t)}s(zU,"Date");N();function UU(t){return ri({[br]:"Null",type:"null"},t)}s(UU,"Null");N();function VU(t){return ri({[br]:"Symbol",type:"symbol"},t)}s(VU,"Symbol");N();function jU(t){return ri({[br]:"Undefined",type:"undefined"},t)}s(jU,"Undefined");N();function $U(t){return ri({[br]:"Uint8Array",type:"Uint8Array"},t)}s($U,"Uint8Array");N();function Ex(t){return ri({[br]:"Unknown"},t)}s(Ex,"Unknown");function T_e(t){return t.map(e=>w4(e,!1))}s(T_e,"FromArray");function P_e(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=mg(w4(t[r],!1));return e}s(P_e,"FromProperties");function E2(t,e){return e===!0?t:mg(t)}s(E2,"ConditionalReadonly");function w4(t,e){return bz(t)||Az(t)?E2(V_(),e):Ec(t)?mg(Mx(T_e(t))):gv(t)?$U():YA(t)?zU():ro(t)?E2(js(P_e(t)),e):wz(t)?E2(iS([],Ex()),e):sl(t)?jU():Sz(t)?UU():Mz(t)?VU():t4(t)?v4():vf(t)||gx(t)||Yo(t)?To(t):js({})}s(w4,"FromValue");function L_e(t,e){return ri(w4(t,!0),e)}s(L_e,"Const");N();function D_e(t,e){return Mx(t.parameters,e)}s(D_e,"ConstructorParameters");N();function Cx(t,e){return t.map(r=>ep(r,e))}s(Cx,"FromRest");function R_e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=ep(t[i],e);return r}s(R_e,"FromProperties");function O_e(t,e){return t.parameters=Cx(t.parameters,e),t.returns=ep(t.returns,e),t}s(O_e,"FromConstructor");function k_e(t,e){return t.parameters=Cx(t.parameters,e),t.returns=ep(t.returns,e),t}s(k_e,"FromFunction");function N_e(t,e){return t.allOf=Cx(t.allOf,e),t}s(N_e,"FromIntersect");function F_e(t,e){return t.anyOf=Cx(t.anyOf,e),t}s(F_e,"FromUnion");function B_e(t,e){return sl(t.items)||(t.items=Cx(t.items,e)),t}s(B_e,"FromTuple");function z_e(t,e){return t.items=ep(t.items,e),t}s(z_e,"FromArray");function U_e(t,e){return t.properties=R_e(t.properties,e),t}s(U_e,"FromObject");function V_e(t,e){return t.item=ep(t.item,e),t}s(V_e,"FromPromise");function j_e(t,e){return t.items=ep(t.items,e),t}s(j_e,"FromAsyncIterator");function $_e(t,e){return t.items=ep(t.items,e),t}s($_e,"FromIterator");function G_e(t,e){let r=e.find(n=>n.$id===t.$ref);if(r===void 0)throw Error("Unable to dereference schema with $id ".concat(t.$ref));let i=Ac(r,["$id"]);return ep(i,e)}s(G_e,"FromRef");function H_e(t,e){return o4(t)?O_e(t,e):s4(t)?k_e(t,e):oh(t)?N_e(t,e):Gs(t)?F_e(t,e):_v(t)?B_e(t,e):_x(t)?z_e(t,e):Jh(t)?U_e(t,e):tS(t)?V_e(t,e):a4(t)?j_e(t,e):l4(t)?$_e(t,e):kz(t)?G_e(t,e):t}s(H_e,"DerefResolve");function ep(t,e){return H_e(i4(t),l0e(e))}s(ep,"Deref");N();function q_e(t,e){if(sl(t))throw new Error("Enum undefined or empty");let r=globalThis.Object.getOwnPropertyNames(t).filter(n=>isNaN(n)).map(n=>t[n]),i=[...new Set(r)].map(n=>To(n));return Fl(i,vt(Ee({},e),{[B_]:"Enum"}))}s(q_e,"Enum");N();N();N();var W_e=class extends Ca{};s(W_e,"ExtendsResolverError");var RXe=W_e,Zt;(function(t){t[t.Union=0]="Union",t[t.True=1]="True",t[t.False=2]="False"})(Zt||(Zt={}));function Sc(t){return t===Zt.False?t:Zt.True}s(Sc,"IntoBooleanResult");function Av(t){throw new RXe(t)}s(Av,"Throw");function Ko(t){return it.IsNever(t)||it.IsIntersect(t)||it.IsUnion(t)||it.IsUnknown(t)||it.IsAny(t)}s(Ko,"IsStructuralRight");function Jo(t,e){return it.IsNever(e)?qU():it.IsIntersect(e)?oS(t,e):it.IsUnion(e)?S4(t,e):it.IsUnknown(e)?YU():it.IsAny(e)?A4():Av("StructuralRight")}s(Jo,"StructuralRight");function A4(t,e){return Zt.True}s(A4,"FromAnyRight");function X_e(t,e){return it.IsIntersect(e)?oS(t,e):it.IsUnion(e)&&e.anyOf.some(r=>it.IsAny(r)||it.IsUnknown(r))?Zt.True:it.IsUnion(e)?Zt.Union:it.IsUnknown(e)||it.IsAny(e)?Zt.True:Zt.Union}s(X_e,"FromAny");function Z_e(t,e){return it.IsUnknown(t)?Zt.False:it.IsAny(t)?Zt.Union:it.IsNever(t)?Zt.True:Zt.False}s(Z_e,"FromArrayRight");function Y_e(t,e){return it.IsObject(e)&&sS(e)?Zt.True:Ko(e)?Jo(t,e):it.IsArray(e)?Sc(_a(t.items,e.items)):Zt.False}s(Y_e,"FromArray");function K_e(t,e){return Ko(e)?Jo(t,e):it.IsAsyncIterator(e)?Sc(_a(t.items,e.items)):Zt.False}s(K_e,"FromAsyncIterator");function J_e(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsBigInt(e)?Zt.True:Zt.False}s(J_e,"FromBigInt");function GU(t,e){return it.IsLiteralBoolean(t)||it.IsBoolean(t)?Zt.True:Zt.False}s(GU,"FromBooleanRight");function Q_e(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsBoolean(e)?Zt.True:Zt.False}s(Q_e,"FromBoolean");function exe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsConstructor(e)?t.parameters.length>e.parameters.length?Zt.False:t.parameters.every((r,i)=>Sc(_a(e.parameters[i],r))===Zt.True)?Sc(_a(t.returns,e.returns)):Zt.False:Zt.False}s(exe,"FromConstructor");function txe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsDate(e)?Zt.True:Zt.False}s(txe,"FromDate");function rxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsFunction(e)?t.parameters.length>e.parameters.length?Zt.False:t.parameters.every((r,i)=>Sc(_a(e.parameters[i],r))===Zt.True)?Sc(_a(t.returns,e.returns)):Zt.False:Zt.False}s(rxe,"FromFunction");function HU(t,e){return it.IsLiteral(t)&&Va.IsNumber(t.const)||it.IsNumber(t)||it.IsInteger(t)?Zt.True:Zt.False}s(HU,"FromIntegerRight");function ixe(t,e){return it.IsInteger(e)||it.IsNumber(e)?Zt.True:Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):Zt.False}s(ixe,"FromInteger");function oS(t,e){return e.allOf.every(r=>_a(t,r)===Zt.True)?Zt.True:Zt.False}s(oS,"FromIntersectRight");function nxe(t,e){return t.allOf.some(r=>_a(r,e)===Zt.True)?Zt.True:Zt.False}s(nxe,"FromIntersect");function axe(t,e){return Ko(e)?Jo(t,e):it.IsIterator(e)?Sc(_a(t.items,e.items)):Zt.False}s(axe,"FromIterator");function oxe(t,e){return it.IsLiteral(e)&&e.const===t.const?Zt.True:Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsString(e)?ZU(t):it.IsNumber(e)?WU(t):it.IsInteger(e)?HU(t):it.IsBoolean(e)?GU(t):Zt.False}s(oxe,"FromLiteral");function qU(t,e){return Zt.False}s(qU,"FromNeverRight");function sxe(t,e){return Zt.True}s(sxe,"FromNever");function kk(t){let[e,r]=[t,0];for(;it.IsNot(e);)e=e.not,r+=1;return r%2===0?e:Ex()}s(kk,"UnwrapTNot");function lxe(t,e){return it.IsNot(t)?_a(kk(t),e):it.IsNot(e)?_a(t,kk(e)):Av("Invalid fallthrough for Not")}s(lxe,"FromNot");function uxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsNull(e)?Zt.True:Zt.False}s(uxe,"FromNull");function WU(t,e){return it.IsLiteralNumber(t)||it.IsNumber(t)||it.IsInteger(t)?Zt.True:Zt.False}s(WU,"FromNumberRight");function cxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsInteger(e)||it.IsNumber(e)?Zt.True:Zt.False}s(cxe,"FromNumber");function ru(t,e){return Object.getOwnPropertyNames(t.properties).length===e}s(ru,"IsObjectPropertyCount");function Nk(t){return sS(t)}s(Nk,"IsObjectStringLike");function Fk(t){return ru(t,0)||ru(t,1)&&"description"in t.properties&&it.IsUnion(t.properties.description)&&t.properties.description.anyOf.length===2&&(it.IsString(t.properties.description.anyOf[0])&&it.IsUndefined(t.properties.description.anyOf[1])||it.IsString(t.properties.description.anyOf[1])&&it.IsUndefined(t.properties.description.anyOf[0]))}s(Fk,"IsObjectSymbolLike");function HC(t){return ru(t,0)}s(HC,"IsObjectNumberLike");function Bk(t){return ru(t,0)}s(Bk,"IsObjectBooleanLike");function hxe(t){return ru(t,0)}s(hxe,"IsObjectBigIntLike");function pxe(t){return ru(t,0)}s(pxe,"IsObjectDateLike");function dxe(t){return sS(t)}s(dxe,"IsObjectUint8ArrayLike");function fxe(t){let e=wv();return ru(t,0)||ru(t,1)&&"length"in t.properties&&Sc(_a(t.properties.length,e))===Zt.True}s(fxe,"IsObjectFunctionLike");function mxe(t){return ru(t,0)}s(mxe,"IsObjectConstructorLike");function sS(t){let e=wv();return ru(t,0)||ru(t,1)&&"length"in t.properties&&Sc(_a(t.properties.length,e))===Zt.True}s(sS,"IsObjectArrayLike");function gxe(t){let e=iS([V_()],V_());return ru(t,0)||ru(t,1)&&"then"in t.properties&&Sc(_a(t.properties.then,e))===Zt.True}s(gxe,"IsObjectPromiseLike");function XU(t,e){return _a(t,e)===Zt.False||it.IsOptional(t)&&!it.IsOptional(e)?Zt.False:Zt.True}s(XU,"Property");function cl(t,e){return it.IsUnknown(t)?Zt.False:it.IsAny(t)?Zt.Union:it.IsNever(t)||it.IsLiteralString(t)&&Nk(e)||it.IsLiteralNumber(t)&&HC(e)||it.IsLiteralBoolean(t)&&Bk(e)||it.IsSymbol(t)&&Fk(e)||it.IsBigInt(t)&&hxe(e)||it.IsString(t)&&Nk(e)||it.IsSymbol(t)&&Fk(e)||it.IsNumber(t)&&HC(e)||it.IsInteger(t)&&HC(e)||it.IsBoolean(t)&&Bk(e)||it.IsUint8Array(t)&&dxe(e)||it.IsDate(t)&&pxe(e)||it.IsConstructor(t)&&mxe(e)||it.IsFunction(t)&&fxe(e)?Zt.True:it.IsRecord(t)&&it.IsString(y3(t))?e[B_]==="Record"?Zt.True:Zt.False:it.IsRecord(t)&&it.IsNumber(y3(t))&&ru(e,0)?Zt.True:Zt.False}s(cl,"FromObjectRight");function yxe(t,e){return Ko(e)?Jo(t,e):it.IsRecord(e)?Cc(t,e):it.IsObject(e)?(()=>{for(let r of Object.getOwnPropertyNames(e.properties)){if(!(r in t.properties)&&!it.IsOptional(e.properties[r]))return Zt.False;if(it.IsOptional(e.properties[r]))return Zt.True;if(XU(t.properties[r],e.properties[r])===Zt.False)return Zt.False}return Zt.True})():Zt.False}s(yxe,"FromObject");function vxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)&&gxe(e)?Zt.True:it.IsPromise(e)?Sc(_a(t.item,e.item)):Zt.False}s(vxe,"FromPromise");function y3(t){return z_ in t.patternProperties?wv():U_ in t.patternProperties?xf():Av("Unknown record key pattern")}s(y3,"RecordKey");function v3(t){return z_ in t.patternProperties?t.patternProperties[z_]:U_ in t.patternProperties?t.patternProperties[U_]:Av("Unable to get record value schema")}s(v3,"RecordValue");function Cc(t,e){let[r,i]=[y3(e),v3(e)];return it.IsLiteralString(t)&&it.IsNumber(r)&&Sc(_a(t,i))===Zt.True?Zt.True:it.IsUint8Array(t)&&it.IsNumber(r)||it.IsString(t)&&it.IsNumber(r)||it.IsArray(t)&&it.IsNumber(r)?_a(t,i):it.IsObject(t)?(()=>{for(let n of Object.getOwnPropertyNames(t.properties))if(XU(i,t.properties[n])===Zt.False)return Zt.False;return Zt.True})():Zt.False}s(Cc,"FromRecordRight");function _xe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?_a(v3(t),v3(e)):Zt.False}s(_xe,"FromRecord");function xxe(t,e){let r=it.IsRegExp(t)?xf():t,i=it.IsRegExp(e)?xf():e;return _a(r,i)}s(xxe,"FromRegExp");function ZU(t,e){return it.IsLiteral(t)&&Va.IsString(t.const)||it.IsString(t)?Zt.True:Zt.False}s(ZU,"FromStringRight");function bxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsString(e)?Zt.True:Zt.False}s(bxe,"FromString");function wxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsSymbol(e)?Zt.True:Zt.False}s(wxe,"FromSymbol");function Axe(t,e){return it.IsTemplateLiteral(t)?_a($w(t),e):it.IsTemplateLiteral(e)?_a(t,$w(e)):Av("Invalid fallthrough for TemplateLiteral")}s(Axe,"FromTemplateLiteral");function Sxe(t,e){return it.IsArray(e)&&t.items!==void 0&&t.items.every(r=>_a(r,e.items)===Zt.True)}s(Sxe,"IsArrayOfTuple");function Mxe(t,e){return it.IsNever(t)?Zt.True:it.IsUnknown(t)?Zt.False:it.IsAny(t)?Zt.Union:Zt.False}s(Mxe,"FromTupleRight");function Exe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)&&sS(e)||it.IsArray(e)&&Sxe(t,e)?Zt.True:it.IsTuple(e)?Va.IsUndefined(t.items)&&!Va.IsUndefined(e.items)||!Va.IsUndefined(t.items)&&Va.IsUndefined(e.items)?Zt.False:Va.IsUndefined(t.items)&&!Va.IsUndefined(e.items)||t.items.every((r,i)=>_a(r,e.items[i])===Zt.True)?Zt.True:Zt.False:Zt.False}s(Exe,"FromTuple");function Cxe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsUint8Array(e)?Zt.True:Zt.False}s(Cxe,"FromUint8Array");function Ixe(t,e){return Ko(e)?Jo(t,e):it.IsObject(e)?cl(t,e):it.IsRecord(e)?Cc(t,e):it.IsVoid(e)?Lxe(t):it.IsUndefined(e)?Zt.True:Zt.False}s(Ixe,"FromUndefined");function S4(t,e){return e.anyOf.some(r=>_a(t,r)===Zt.True)?Zt.True:Zt.False}s(S4,"FromUnionRight");function Txe(t,e){return t.anyOf.every(r=>_a(r,e)===Zt.True)?Zt.True:Zt.False}s(Txe,"FromUnion");function YU(t,e){return Zt.True}s(YU,"FromUnknownRight");function Pxe(t,e){return it.IsNever(e)?qU():it.IsIntersect(e)?oS(t,e):it.IsUnion(e)?S4(t,e):it.IsAny(e)?A4():it.IsString(e)?ZU(t):it.IsNumber(e)?WU(t):it.IsInteger(e)?HU(t):it.IsBoolean(e)?GU(t):it.IsArray(e)?Z_e(t):it.IsTuple(e)?Mxe(t):it.IsObject(e)?cl(t,e):it.IsUnknown(e)?Zt.True:Zt.False}s(Pxe,"FromUnknown");function Lxe(t,e){return it.IsUndefined(t)||it.IsUndefined(t)?Zt.True:Zt.False}s(Lxe,"FromVoidRight");function Dxe(t,e){return it.IsIntersect(e)?oS(t,e):it.IsUnion(e)?S4(t,e):it.IsUnknown(e)?YU():it.IsAny(e)?A4():it.IsObject(e)?cl(t,e):it.IsVoid(e)?Zt.True:Zt.False}s(Dxe,"FromVoid");function _a(t,e){return it.IsTemplateLiteral(t)||it.IsTemplateLiteral(e)?Axe(t,e):it.IsRegExp(t)||it.IsRegExp(e)?xxe(t,e):it.IsNot(t)||it.IsNot(e)?lxe(t,e):it.IsAny(t)?X_e(t,e):it.IsArray(t)?Y_e(t,e):it.IsBigInt(t)?J_e(t,e):it.IsBoolean(t)?Q_e(t,e):it.IsAsyncIterator(t)?K_e(t,e):it.IsConstructor(t)?exe(t,e):it.IsDate(t)?txe(t,e):it.IsFunction(t)?rxe(t,e):it.IsInteger(t)?ixe(t,e):it.IsIntersect(t)?nxe(t,e):it.IsIterator(t)?axe(t,e):it.IsLiteral(t)?oxe(t,e):it.IsNever(t)?sxe():it.IsNull(t)?uxe(t,e):it.IsNumber(t)?cxe(t,e):it.IsObject(t)?yxe(t,e):it.IsRecord(t)?_xe(t,e):it.IsString(t)?bxe(t,e):it.IsSymbol(t)?wxe(t,e):it.IsTuple(t)?Exe(t,e):it.IsPromise(t)?vxe(t,e):it.IsUint8Array(t)?Cxe(t,e):it.IsUndefined(t)?Ixe(t,e):it.IsUnion(t)?Txe(t,e):it.IsUnknown(t)?Pxe(t,e):it.IsVoid(t)?Dxe(t,e):Av("Unknown left type operand '".concat(t[br],"'"))}s(_a,"Visit");function Ix(t,e){return _a(t,e)}s(Ix,"ExtendsCheck");N();N();N();function Rxe(t,e,r,i,n){let a={};for(let o of globalThis.Object.getOwnPropertyNames(t))a[o]=M4(t[o],e,r,i,Bu(n));return a}s(Rxe,"FromProperties");function Oxe(t,e,r,i,n){return Rxe(t.properties,e,r,i,n)}s(Oxe,"FromMappedResult");function kxe(t,e,r,i,n){let a=Oxe(t,e,r,i,n);return Hs(a)}s(kxe,"ExtendsFromMappedResult");function Nxe(t,e,r,i){let n=Ix(t,e);return n===Zt.Union?Fl([r,i]):n===Zt.True?r:i}s(Nxe,"ExtendsResolve");function M4(t,e,r,i,n){return qu(t)?kxe(t,e,r,i,n):dg(t)?ri(Uxe(t,e,r,i,n)):ri(Nxe(t,e,r,i),n)}s(M4,"Extends");function Fxe(t,e,r,i,n){return{[t]:M4(To(t),e,r,i,Bu(n))}}s(Fxe,"FromPropertyKey");function Bxe(t,e,r,i,n){return t.reduce((a,o)=>Ee(Ee({},a),Fxe(o,e,r,i,n)),{})}s(Bxe,"FromPropertyKeys");function zxe(t,e,r,i,n){return Bxe(t.keys,e,r,i,n)}s(zxe,"FromMappedKey");function Uxe(t,e,r,i,n){let a=zxe(t,e,r,i,n);return Hs(a)}s(Uxe,"ExtendsFromMappedKey");N();function Vxe(t){return t.allOf.every(e=>Sv(e))}s(Vxe,"Intersect");function jxe(t){return t.anyOf.some(e=>Sv(e))}s(jxe,"Union");function $xe(t){return!Sv(t.not)}s($xe,"Not");function Sv(t){return t[br]==="Intersect"?Vxe(t):t[br]==="Union"?jxe(t):t[br]==="Not"?$xe(t):t[br]==="Undefined"}s(Sv,"ExtendsUndefinedCheck");N();function Gxe(t,e){return E4($w(t),e)}s(Gxe,"ExcludeFromTemplateLiteral");function Hxe(t,e){let r=t.filter(i=>Ix(i,e)===Zt.False);return r.length===1?r[0]:Fl(r)}s(Hxe,"ExcludeRest");function E4(t,e,r={}){return fg(t)?ri(Gxe(t,e),r):qu(t)?ri(Xxe(t,e),r):ri(Gs(t)?Hxe(t.anyOf,e):Ix(t,e)!==Zt.False?ul():t,r)}s(E4,"Exclude");function qxe(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=E4(t[i],e);return r}s(qxe,"FromProperties");function Wxe(t,e){return qxe(t.properties,e)}s(Wxe,"FromMappedResult");function Xxe(t,e){let r=Wxe(t,e);return Hs(r)}s(Xxe,"ExcludeFromMappedResult");N();N();N();function Zxe(t,e){return C4($w(t),e)}s(Zxe,"ExtractFromTemplateLiteral");function Yxe(t,e){let r=t.filter(i=>Ix(i,e)!==Zt.False);return r.length===1?r[0]:Fl(r)}s(Yxe,"ExtractRest");function C4(t,e,r){return fg(t)?ri(Zxe(t,e),r):qu(t)?ri(Qxe(t,e),r):ri(Gs(t)?Yxe(t.anyOf,e):Ix(t,e)!==Zt.False?t:ul(),r)}s(C4,"Extract");function Kxe(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=C4(t[i],e);return r}s(Kxe,"FromProperties");function Jxe(t,e){return Kxe(t.properties,e)}s(Jxe,"FromMappedResult");function Qxe(t,e){let r=Jxe(t,e);return Hs(r)}s(Qxe,"ExtractFromMappedResult");N();function ebe(t,e){return ri(t.returns,e)}s(ebe,"InstanceType");N();function tbe(t){return ri({[br]:"Integer",type:"integer"},t)}s(tbe,"Integer");N();N();N();function rbe(t,e,r){return{[t]:Mv(To(t),e,Bu(r))}}s(rbe,"MappedIntrinsicPropertyKey");function ibe(t,e,r){return t.reduce((i,n)=>Ee(Ee({},i),rbe(n,e,r)),{})}s(ibe,"MappedIntrinsicPropertyKeys");function nbe(t,e,r){return ibe(t.keys,e,r)}s(nbe,"MappedIntrinsicProperties");function abe(t,e,r){let i=nbe(t,e,r);return Hs(i)}s(abe,"IntrinsicFromMappedKey");function obe(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toLowerCase(),r].join("")}s(obe,"ApplyUncapitalize");function sbe(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toUpperCase(),r].join("")}s(sbe,"ApplyCapitalize");function lbe(t){return t.toUpperCase()}s(lbe,"ApplyUppercase");function ube(t){return t.toLowerCase()}s(ube,"ApplyLowercase");function cbe(t,e,r){let i=g4(t.pattern);if(!$_(i))return vt(Ee({},t),{pattern:KU(t.pattern,e)});let n=[...nS(i)].map(l=>To(l)),a=JU(n,e),o=Fl(a);return TU([o],r)}s(cbe,"FromTemplateLiteral");function KU(t,e){return typeof t=="string"?e==="Uncapitalize"?obe(t):e==="Capitalize"?sbe(t):e==="Uppercase"?lbe(t):e==="Lowercase"?ube(t):t:t.toString()}s(KU,"FromLiteralValue");function JU(t,e){return t.map(r=>Mv(r,e))}s(JU,"FromRest");function Mv(t,e,r={}){return dg(t)?abe(t,e,r):fg(t)?cbe(t,e,r):Gs(t)?Fl(JU(t.anyOf,e),r):xx(t)?To(KU(t.const,e),r):ri(t,r)}s(Mv,"Intrinsic");function hbe(t,e={}){return Mv(t,"Capitalize",e)}s(hbe,"Capitalize");N();function pbe(t,e={}){return Mv(t,"Lowercase",e)}s(pbe,"Lowercase");N();function dbe(t,e={}){return Mv(t,"Uncapitalize",e)}s(dbe,"Uncapitalize");N();function fbe(t,e={}){return Mv(t,"Uppercase",e)}s(fbe,"Uppercase");N();function mbe(t,e){return ri({[br]:"Not",not:t},e)}s(mbe,"Not");N();N();N();function gbe(t,e,r){let i={};for(let n of globalThis.Object.getOwnPropertyNames(t))i[n]=T4(t[n],e,Bu(r));return i}s(gbe,"FromProperties");function ybe(t,e,r){return gbe(t.properties,e,r)}s(ybe,"FromMappedResult");function vbe(t,e,r){let i=ybe(t,e,r);return Hs(i)}s(vbe,"OmitFromMappedResult");function _be(t,e){return t.map(r=>I4(r,e))}s(_be,"FromIntersect");function xbe(t,e){return t.map(r=>I4(r,e))}s(xbe,"FromUnion");function bbe(t,e){let r=t,{[e]:i}=r;return Nh(r,[ZX(e)])}s(bbe,"FromProperty");function wbe(t,e){return e.reduce((r,i)=>bbe(r,i),t)}s(wbe,"FromProperties");function Abe(t,e){let r=Ac(t,[Du,"$id","required","properties"]),i=wbe(t.properties,e);return js(i,r)}s(Abe,"FromObject");function I4(t,e){return oh(t)?yg(_be(t.allOf,e)):Gs(t)?Fl(xbe(t.anyOf,e)):Jh(t)?Abe(t,e):js({})}s(I4,"OmitResolve");function T4(t,e,r){if(dg(e))return Cbe(t,e,r);if(qu(t))return vbe(t,e,r);let i=Jy(e)?Cf(e):e;return ri(Ee(Ee({},I4(t,i)),r))}s(T4,"Omit");function Sbe(t,e,r){return{[e]:T4(t,[e],Bu(r))}}s(Sbe,"FromPropertyKey");function Mbe(t,e,r){return e.reduce((i,n)=>Ee(Ee({},i),Sbe(t,n,r)),{})}s(Mbe,"FromPropertyKeys");function Ebe(t,e,r){return Mbe(t,e.keys,r)}s(Ebe,"FromMappedKey");function Cbe(t,e,r){let i=Ebe(t,e,r);return Hs(i)}s(Cbe,"OmitFromMappedKey");N();function Ibe(t,e){return Mx(t.parameters,e)}s(Ibe,"Parameters");N();N();function zk(t){return t.map(e=>QU(e))}s(zk,"FromRest");function Tbe(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=gg(t[r]);return e}s(Tbe,"FromProperties");function Pbe(t){let e=Ac(t,[Du,"$id","required","properties"]),r=Tbe(t.properties);return js(r,e)}s(Pbe,"FromObject");function QU(t){return oh(t)?yg(zk(t.allOf)):Gs(t)?Fl(zk(t.anyOf)):Jh(t)?Pbe(t):js({})}s(QU,"PartialResolve");function eV(t,e){return qu(t)?Rbe(t,e):ri(Ee(Ee({},QU(t)),e))}s(eV,"Partial");function Lbe(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=eV(t[i],Bu(e));return r}s(Lbe,"FromProperties");function Dbe(t,e){return Lbe(t.properties,e)}s(Dbe,"FromMappedResult");function Rbe(t,e){let r=Dbe(t,e);return Hs(r)}s(Rbe,"PartialFromMappedResult");N();N();N();function Obe(t,e,r){let i={};for(let n of globalThis.Object.getOwnPropertyNames(t))i[n]=L4(t[n],e,Bu(r));return i}s(Obe,"FromProperties");function kbe(t,e,r){return Obe(t.properties,e,r)}s(kbe,"FromMappedResult");function Nbe(t,e,r){let i=kbe(t,e,r);return Hs(i)}s(Nbe,"PickFromMappedResult");function Fbe(t,e){return t.map(r=>P4(r,e))}s(Fbe,"FromIntersect");function Bbe(t,e){return t.map(r=>P4(r,e))}s(Bbe,"FromUnion");function zbe(t,e){let r={};for(let i of e)i in t&&(r[i]=t[i]);return r}s(zbe,"FromProperties");function Ube(t,e){let r=Ac(t,[Du,"$id","required","properties"]),i=zbe(t.properties,e);return js(i,r)}s(Ube,"FromObject");function P4(t,e){return oh(t)?yg(Fbe(t.allOf,e)):Gs(t)?Fl(Bbe(t.anyOf,e)):Jh(t)?Ube(t,e):js({})}s(P4,"PickResolve");function L4(t,e,r){if(dg(e))return Gbe(t,e,r);if(qu(t))return Nbe(t,e,r);let i=Jy(e)?Cf(e):e;return ri(Ee(Ee({},P4(t,i)),r))}s(L4,"Pick");function Vbe(t,e,r){return{[e]:L4(t,[e],Bu(r))}}s(Vbe,"FromPropertyKey");function jbe(t,e,r){return e.reduce((i,n)=>Ee(Ee({},i),Vbe(t,n,r)),{})}s(jbe,"FromPropertyKeys");function $be(t,e,r){return jbe(t,e.keys,r)}s($be,"FromMappedKey");function Gbe(t,e,r){let i=$be(t,e,r);return Hs(i)}s(Gbe,"PickFromMappedKey");N();function Hbe(t){return mg(gg(t))}s(Hbe,"ReadonlyOptional");N();function vg(t,e,r){return ri({[br]:"Record",type:"object",patternProperties:{[t]:e}},r)}s(vg,"RecordCreateFromPattern");function D4(t,e,r){let i={};for(let n of t)i[n]=e;return js(i,vt(Ee({},r),{[B_]:"Record"}))}s(D4,"RecordCreateFromKeys");function qbe(t,e,r){return MU(t)?D4(Cf(t),e,r):vg(t.pattern,e,r)}s(qbe,"FromTemplateLiteralKey");function Wbe(t,e,r){return D4(Cf(Fl(t)),e,r)}s(Wbe,"FromUnionKey");function Xbe(t,e,r){return D4([t.toString()],e,r)}s(Xbe,"FromLiteralKey");function Zbe(t,e,r){return vg(t.source,e,r)}s(Zbe,"FromRegExpKey");function Ybe(t,e,r){let i=sl(t.pattern)?U_:t.pattern;return vg(i,e,r)}s(Ybe,"FromStringKey");function Kbe(t,e,r){return vg(U_,e,r)}s(Kbe,"FromAnyKey");function Jbe(t,e,r){return vg(TXe,e,r)}s(Jbe,"FromNeverKey");function Qbe(t,e,r){return vg(z_,e,r)}s(Qbe,"FromIntegerKey");function e2e(t,e,r){return vg(z_,e,r)}s(e2e,"FromNumberKey");function t2e(t,e,r={}){return Gs(t)?Wbe(t.anyOf,e,r):fg(t)?qbe(t,e,r):xx(t)?Xbe(t.const,e,r):QA(t)?Qbe(t,e,r):eS(t)?e2e(t,e,r):Nz(t)?Zbe(t,e,r):u4(t)?Ybe(t,e,r):Lz(t)?Kbe(t,e,r):bx(t)?Jbe(t,e,r):ul(r)}s(t2e,"Record");N();var OXe=0;function r2e(t,e={}){sl(e.$id)&&(e.$id="T".concat(OXe++));let r=i4(t({[br]:"This",$ref:"".concat(e.$id)}));return r.$id=e.$id,ri(Ee({[B_]:"Recursive"},r),e)}s(r2e,"Recursive");N();function i2e(t,e){if(Yo(t))return ri({[br]:"Ref",$ref:t},e);if(sl(t.$id))throw new Error("Reference target type must specify an $id");return ri({[br]:"Ref",$ref:t.$id},e)}s(i2e,"Ref");N();function n2e(t,e){let r=Yo(t)?new globalThis.RegExp(t):t;return ri({[br]:"RegExp",type:"RegExp",source:r.source,flags:r.flags},e)}s(n2e,"RegExp");N();N();function Uk(t){return t.map(e=>tV(e))}s(Uk,"FromRest");function a2e(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=Ac(t[r],[pg]);return e}s(a2e,"FromProperties");function o2e(t){let e=Ac(t,[Du,"$id","required","properties"]),r=a2e(t.properties);return js(r,e)}s(o2e,"FromObject");function tV(t){return oh(t)?yg(Uk(t.allOf)):Gs(t)?Fl(Uk(t.anyOf)):Jh(t)?o2e(t):js({})}s(tV,"RequiredResolve");function rV(t,e){return qu(t)?u2e(t,e):ri(Ee(Ee({},tV(t)),e))}s(rV,"Required");function s2e(t,e){let r={};for(let i of globalThis.Object.getOwnPropertyNames(t))r[i]=rV(t[i],e);return r}s(s2e,"FromProperties");function l2e(t,e){return s2e(t.properties,e)}s(l2e,"FromMappedResult");function u2e(t,e){let r=l2e(t,e);return Hs(r)}s(u2e,"RequiredFromMappedResult");N();function c2e(t){var e;return oh(t)?t.allOf:Gs(t)?t.anyOf:_v(t)?(e=t.items)!=null?e:[]:[]}s(c2e,"RestResolve");function h2e(t){return c2e(t)}s(h2e,"Rest");N();function p2e(t,e){return ri(t.returns,e)}s(p2e,"ReturnType");N();function d2e(t){return JSON.parse(JSON.stringify(t))}s(d2e,"Strict");N();var f2e=class{constructor(e){this.schema=e}Decode(e){return new NXe(this.schema,e)}};s(f2e,"TransformDecodeBuilder");var kXe=f2e,m2e=class{constructor(e,r){this.schema=e,this.decode=r}EncodeTransform(e,r){let i={Encode:s(n=>r[Du].Encode(e(n)),"Encode"),Decode:s(n=>this.decode(r[Du].Decode(n)),"Decode")};return vt(Ee({},r),{[Du]:i})}EncodeSchema(e,r){let i={Decode:this.decode,Encode:e};return vt(Ee({},r),{[Du]:i})}Encode(e){return c4(this.schema)?this.EncodeTransform(e,this.schema):this.EncodeSchema(e,this.schema)}};s(m2e,"TransformEncodeBuilder");var NXe=m2e;function g2e(t){return new kXe(t)}s(g2e,"Transform");N();function iV(t={}){var e;return ri({[br]:(e=t[br])!=null?e:"Unsafe"},t)}s(iV,"Unsafe");N();function y2e(t){return ri({[br]:"Void",type:"void"},t)}s(y2e,"Void");N();var v2e={};kl(v2e,{Any:()=>V_,Array:()=>bU,AsyncIterator:()=>wU,Awaited:()=>d_e,BigInt:()=>v4,Boolean:()=>CU,Capitalize:()=>hbe,Composite:()=>I_e,Const:()=>L_e,Constructor:()=>AU,ConstructorParameters:()=>D_e,Date:()=>zU,Deref:()=>ep,Enum:()=>q_e,Exclude:()=>E4,Extends:()=>M4,Extract:()=>C4,Function:()=>iS,Index:()=>x4,InstanceType:()=>ebe,Integer:()=>tbe,Intersect:()=>yg,Iterator:()=>DU,KeyOf:()=>BU,Literal:()=>To,Lowercase:()=>pbe,Mapped:()=>e_e,Never:()=>ul,Not:()=>mbe,Null:()=>UU,Number:()=>wv,Object:()=>js,Omit:()=>T4,Optional:()=>gg,Parameters:()=>Ibe,Partial:()=>eV,Pick:()=>L4,Promise:()=>RU,Readonly:()=>mg,ReadonlyOptional:()=>Hbe,Record:()=>t2e,Recursive:()=>r2e,Ref:()=>i2e,RegExp:()=>n2e,Required:()=>rV,Rest:()=>h2e,ReturnType:()=>p2e,Strict:()=>d2e,String:()=>xf,Symbol:()=>VU,TemplateLiteral:()=>TU,Transform:()=>g2e,Tuple:()=>Mx,Uint8Array:()=>$U,Uncapitalize:()=>dbe,Undefined:()=>jU,Union:()=>Fl,Unknown:()=>Ex,Unsafe:()=>iV,Uppercase:()=>fbe,Void:()=>y2e});N();var pe=v2e,nu=s((t,e)=>pe.Unsafe(pe.String({$id:e,pattern:"^".concat(t,"_[A-Za-z0-9-]{8,}$")})),"Ident"),If=nu("g","GeometryId"),$s=nu("f","FloorId"),FXe=[If,$s];N();N();var _3=pe.Object({externalId:pe.String({description:"An identifier that can be used to link this entity to data outside of the MVF."}),name:pe.String({description:"The name of the entity."}),shortName:pe.String({description:"A short name for the entity."}),description:pe.String({description:"A description of the entity."}),icon:pe.String({format:"uri",description:"A URL to an icon for the entity."})},{$id:"BaseDetails",description:"Additional information about a given entity."}),_2e=pe.Partial(_3,{$id:"Details",description:"Additional information about a given entity."}),lS=pe.Object({details:pe.Optional(pe.Ref(_2e))},{$id:"WithDetails"}),nV=s(t=>{let e=[...t].sort(),r=pe.Pick(_3,t),i=pe.Omit(_3,t);return pe.Object({details:pe.Intersect([r,pe.Partial(i)])},{$id:"WithRequiredDetails_".concat(e.join("_"))})},"WithRequiredDetails"),BXe=[_3,_2e];N();N();var x2e=pe.Record(pe.String(),pe.Unknown(),{$id:"Extra"}),uS=pe.Object({extra:pe.Optional(pe.Ref(x2e))}),zXe=[x2e];N();N();var R4=pe.Object({geometryId:pe.Ref(If),floorId:pe.Ref($s)},{$id:"GeometryAnchor"});pe.Object({geometryAnchor:pe.Ref(R4)});var aV=s((t,e)=>pe.Object({geometryAnchors:pe.Array(pe.Ref(R4),t)},e),"WithGeometryAnchors"),UXe=[R4];N();N();N();N();N();var x3=pe.Number({$id:"Longitude",minimum:-180,maximum:180,description:"A WGS 84-compatible longitude coordinate value."}),b3=pe.Number({$id:"Latitude",minimum:-90,maximum:90,description:"A WGS 84-compatible latitude coordinate value."}),Tx=pe.Tuple([pe.Ref(x3),pe.Ref(b3)],{$id:"Position",minItems:2,maxItems:2,description:"A valid WGS 84 position consisting of a longitude value, followed by a latitude value."}),Tf=pe.Object({type:pe.Literal("Point"),coordinates:pe.Ref(Tx)},{$id:"Point",description:"An RFC-7946 compatible GeoJSON Point geometry."}),b2e=pe.Object({type:pe.Literal("MultiPoint"),coordinates:pe.Array(pe.Ref(Tx))},{$id:"MultiPoint",description:"An RFC-7946 compatible GeoJSON MultiPoint geometry."}),w2e=pe.Object({type:pe.Literal("LineString"),coordinates:pe.Array(pe.Ref(Tx),{minItems:2,description:"At least two positions are required."})},{$id:"LineString",description:"An RFC-7946 compatible GeoJSON LineString geometry."}),A2e=pe.Object({type:pe.Literal("MultiLineString"),coordinates:pe.Array(pe.Array(pe.Ref(Tx),{minItems:2}))},{$id:"MultiLineString",description:"An RFC-7946 compatible GeoJSON MultiLineString geometry."}),S2e=pe.Array(pe.Ref(Tx),{$id:"LinearRing",minItems:4,description:"A linear ring is a building block of a polygon or multi-polygon."}),oV=pe.Array(pe.Ref(S2e),{$id:"LinearRings",minItems:1,description:"A collection of linear rings, at least one of which is the exterior ring of a polygon."}),sV=pe.Object({type:pe.Literal("Polygon"),coordinates:pe.Ref(oV)},{$id:"Polygon",description:"An RFC-7946 compatible GeoJSON Polygon geometry."}),lV=pe.Object({type:pe.Literal("MultiPolygon"),coordinates:pe.Array(pe.Ref(oV))},{$id:"MultiPolygon",description:"An RFC-7946 compatible GeoJSON MultiPolygon geometry."}),Pf=s((t,e,r)=>pe.Object({type:pe.Literal("Feature"),geometry:t,properties:e},r),"Feature"),Ev=s((t,e,r)=>pe.Object({type:pe.Literal("FeatureCollection"),features:pe.Array(t,r)},e),"FeatureCollection"),VXe=[x3,b3,Tx,Tf,b2e,w2e,A2e,S2e,oV,sV,lV],M2e=pe.Intersect([pe.Object({id:pe.Ref($s),elevation:pe.Integer({description:"An ordinal representing the elevation of this map relative to other maps in the stack."}),subtitle:pe.Optional(pe.String({description:"The subtitle of the floor."}))}),lS],{$id:"FloorProperties"}),E2e=Pf(pe.Union([pe.Ref(sV),pe.Ref(lV),pe.Null()]),pe.Ref(M2e),{$id:"FloorFeature"}),C2e=Ev(pe.Ref(E2e),{$id:"FloorCollection"}),jXe=pe.Object({floors:pe.Ref(C2e)}),$Xe={name:"core:floors",intoBundle:s(function*(t){t.floors!=null&&(yield{path:"floors.geojson",contents:t.floors})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="floors.geojson")return{floors:r(e)}},"fromBundle"),schema:jXe,references:[M2e,E2e,C2e]};N();N();N();var I2e=class{constructor(e){$(this,"_value"),this._value=e}[Symbol.iterator](){return this}next(){if(this._value==null)return{done:!0,value:void 0};let e=this._value;return this._value=null,{done:!1,value:e}}};s(I2e,"OptionIterator");var T2e=I2e,P2e=class{constructor(e){$(this,"_tag","Some"),$(this,"_value"),this._value=e}get value(){return this._value}isSome(){return!0}isSomeAnd(e){return e(this.value)}isNone(){return!1}equals(e){return e.isSome()&&e.value===this.value}expect(e){return this.value}unwrap(){return this.value}unwrapOr(e){return this.value}unwrapOrElse(e){return this.value}inspect(e){return e(this.value),this}inspectNone(e){return this}map(e){return OW(e(this.value))}mapAsync(e){return e(this.value).then(r=>OW(r))}mapOr(e,r){return this.map(e).unwrapOr(r)}mapOrAsync(e,r){return this.mapAsync(e).then(i=>i.unwrapOr(r))}mapOrElse(e,r){return this.map(e).unwrapOrElse(r)}mapOrElseAsync(e,r){return this.mapAsync(e).then(i=>i.unwrapOrElse(r))}and(e){return e}andThen(e){return e(this.value)}andThenAsync(e){return e(this.value)}filter(e){return e(this.value)?this:Ty()}or(e){return this}orElse(e){return this}xor(e){return e.isSome()?Ty():this}toString(){return"Some(".concat(this.value,")")}okOr(e){return Ti(this.value)}okOrElse(e){return Ti(this.value)}iter(){return new T2e(this.value)}[Symbol.iterator](){return this.iter()}zip(e){return e.isSome()?Gw([this.value,e.value]):Ty()}zipWith(e,r){return e.isSome()?Gw(r(this.value,e.value)):Ty()}get[Symbol.toStringTag](){return"Some"}};s(P2e,"Some");var L2e=P2e,D2e=class{constructor(){$(this,"_tag","None")}get value(){return null}isSome(){return!1}isSomeAnd(e){return!1}isNone(){return!0}equals(e){return e.isNone()}expect(e){throw new Error(e)}unwrap(){throw new Error("Tried to unwrap a None value!")}unwrapOr(e){return e}unwrapOrElse(e){return e()}inspect(e){return this}inspectNone(e){return e(),this}map(e){return this}mapAsync(e){return Promise.resolve(this)}mapOr(e,r){return r}mapOrAsync(e,r){return Promise.resolve(r)}mapOrElse(e,r){return r()}mapOrElseAsync(e,r){return r()}and(e){return this}andThen(e){return this}andThenAsync(e){return Promise.resolve(this)}filter(e){return this}or(e){return e}orElse(e){return e()}xor(e){return e}toString(){return"None"}okOr(e){return Di(e)}okOrElse(e){return Di(e())}iter(){return new T2e(null)}[Symbol.iterator](){return this.iter()}zip(e){return this}zipWith(e,r){return this}get[Symbol.toStringTag](){return"None"}};s(D2e,"None");var R2e=D2e,Gw=s(t=>new L2e(t),"some"),Ty=s(()=>new R2e,"none"),OW=s(t=>t instanceof L2e||t instanceof R2e?t:t==null?Ty():Gw(t),"option"),O2e=class{constructor(e){$(this,"_value"),this._value=e}[Symbol.iterator](){return this}next(){if(this._value==null)return{done:!0,value:void 0};let e=this._value;return this._value=null,{done:!1,value:e}}};s(O2e,"ResultIterator");var k2e=O2e,N2e=class{constructor(e){$(this,"_tag","Ok"),$(this,"_value"),this._value=e}get value(){return this._value}get error(){return null}isOk(){return!0}isOkAnd(e){return e(this.value)}isErr(){return!1}isErrAnd(e){return!1}ok(){return Gw(this.value)}err(){return Ty()}expect(e){return this.value}expectErr(e){throw new Error(e)}unwrap(){return this.value}unwrapOr(e){return this.value}unwrapOrElse(e){return this.value}inspect(e){return e(this.value),this}inspectErr(){return this}map(e){return Ti(e(this.value))}async mapAsync(e){return e(this.value).then(Ti)}mapOr(e,r){return e(this.value)}async mapOrAsync(e,r){return e(this.value)}mapOrElse(e,r){return e(this.value)}async mapOrElseAsync(e,r){return e(this.value)}mapErr(e){return this}iter(){return new k2e(this.value)}[Symbol.iterator](){return this.iter()}and(e){return e}andThen(e){return e(this.value)}or(e){return this}orElse(e){return this}async andThenAsync(e){return e(this.value)}toString(){return"Ok(".concat(this.value,")")}get[Symbol.toStringTag](){return"Ok"}};s(N2e,"Ok");var GXe=N2e,F2e=class B2e{constructor(e){$(this,"_tag","Err"),$(this,"_error"),this._error=e}get value(){return null}get error(){return this._error}isOk(){return!1}isOkAnd(e){return!1}isErr(){return!0}isErrAnd(e){return e(this.error)}ok(){return Ty()}err(){return Gw(this.error)}expect(e){throw new Error(e)}expectErr(e){return this.error}unwrap(){throw this.error}unwrapOr(e){return e}unwrapOrElse(e){return e()}inspect(){return this}inspectErr(e){return e(this.error),this}map(e){return this}iter(){return new k2e(null)}[Symbol.iterator](){return this.iter()}async mapAsync(e){return this}mapOr(e,r){return r}async mapOrAsync(e,r){return r}mapOrElse(e,r){return r()}async mapOrElseAsync(e,r){return r()}mapErr(e){return new B2e(e(this.error))}and(e){return this}andThen(e){return this}async andThenAsync(e){return this}or(e){return e}orElse(e){return e(this.error)}toString(){return"Err(".concat(this.error,")")}get[Symbol.toStringTag](){return"Err"}};s(F2e,"Err");var HXe=F2e,Ti=s(t=>new GXe(t),"ok"),Di=s(t=>new HXe(t),"err");N();var tv;(function(t){t.GeometryMissingError="GeometryMissingError",t.FloorMissingError="FloorMissingError",t.UnknownFloorError="UnknownFloorError",t.UnknownGeometryError="UnknownGeometryError"})(tv||(tv={}));var qXe=s(t=>{var e,r;return new Map((r=(e=t.floors)==null?void 0:e.features.map(i=>[i.properties.id,i]))!=null?r:[])},"createFloorMap"),O4=s(t=>{let e=qXe(t);return s(r=>{let i=e.get(r);return i==null?Di({kind:tv.UnknownFloorError,properties:{floorId:r}}):Ti(i)},"floorLookup")},"createFloorLookup");N();N();N();N();var zu=s(t=>pe.Unsafe(t),"PartialRecord");N();var ps=s(t=>Object.keys(t),"typedKeys");N();var WXe=s(t=>{if(t.floors==null)return Di({kind:tv.FloorMissingError,properties:null});if(t.geometry==null)return Di({kind:tv.GeometryMissingError,properties:null});let e=O4(t);for(let r of ps(t.geometry)){let i=e(r);if(i.isErr())return i}return Ti(!0)},"validateGeometry"),z2e=pe.Intersect([pe.Object({id:pe.Ref(If)}),lS],{$id:"GeometryProperties"}),U2e=Pf(pe.Union([pe.Ref(Tf),pe.Ref(b2e),pe.Ref(w2e),pe.Ref(A2e),pe.Ref(sV),pe.Ref(lV)]),pe.Ref(z2e),{$id:"GeometryFeature"}),V2e=Ev(pe.Ref(U2e),{$id:"GeometryCollection"}),XXe=pe.Object({geometry:zu(pe.Record($s,pe.Ref(V2e),{additionalProperties:!1}))},{$id:"GeometrySchema"}),ZXe=/^geometry\/(.*)\.geojson$/,YXe={name:"core:geometry",schema:XXe,intoBundle:s(function*(t){if(t.geometry!=null)for(let e of ps(t.geometry))yield{path:"geometry/".concat(e,".geojson"),contents:t.geometry[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(ZXe))==null?void 0:i[1];if(n)return{geometry:{[n]:r(e)}}},"fromBundle"),references:[z2e,U2e,V2e],integrityCheck:WXe};N();N();var Es=s(t=>Object.entries(t),"typedEntries"),KXe=s(t=>{var e;let r=new Map;for(let[i,n]of Es((e=t.geometry)!=null?e:{}))r.set(i,new Map(n==null?void 0:n.features.map(a=>[a.properties.id,a])));return r},"createLookupMap"),Lf=s(t=>{let e=KXe(t);return s((r,i)=>{let n=e.get(r);if(n==null)return Di({kind:tv.UnknownFloorError,properties:{floorId:r}});let a=n.get(i);return a==null?Di({kind:tv.UnknownGeometryError,properties:{floorId:r,geometryId:i}}):Ti(a)},"geometryLookup")},"createGeometryLookup");N();var uV=pe.Object({type:pe.Literal("file"),name:pe.String({description:"The name of the file."})},{$id:"ManifestFile"}),j2e=pe.Recursive(t=>pe.Object({type:pe.Literal("folder"),name:pe.String({description:"The name of the folder."}),children:pe.Array(pe.Union([t,pe.Ref(uV)]),{minItems:1,description:"The children of the folder."})}),{$id:"ManifestFolder"}),$2e=pe.Object({name:pe.String({description:"The name of the map."}),version:pe.Literal("3.0.0",{description:"The version of the manifest."}),orgId:pe.Optional(pe.String({description:"The identifier of the organization that the map this MVF is for belongs to."})),mapId:pe.Optional(pe.String({description:"The identifier of the map that this MVF is for."})),contents:pe.Array(pe.Union([pe.Ref(j2e),pe.Ref(uV)]),{minItems:1,description:"The contents of the MVF bundle."}),time:pe.String({format:"date-time",description:"An ISO 8601 date-time string, including timezone offset."}),tzid:pe.Optional(pe.Unsafe(pe.String({description:"A valid IANA timezone identifier.",pattern:"^[A-Za-z0-9_-]+/[A-Za-z0-9_-]+$"}))),naturalBearing:pe.Optional(pe.Number({minimum:0,maximum:360,description:'The angle, in degrees, the map is considered to be "naturally oriented" as, rather than facing directly north. 90 degrees means East is "up"'})),defaultFloor:pe.Optional(pe.Ref($s,{description:"The default floor ID of the map."})),language:pe.Optional(pe.String({description:"The language code of the map."}))},{$id:"ManifestProperties"}),G2e=Ev(Pf(Tf,pe.Ref($2e)),{$id:"ManifestCollection"},{minItems:1,maxItems:1}),JXe=pe.Object({manifest:pe.Ref(G2e)}),QXe={name:"core:manifest",intoBundle:s(function*(t){t.manifest!=null&&(yield{path:"manifest.geojson",contents:t.manifest})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="manifest.geojson")return{manifest:r(e)}},"fromBundle"),schema:JXe,references:[uV,j2e,$2e,G2e]},Px=pe.Object({geometryId:pe.Ref(If)},{$id:"WithGeometryId"}),H2e=pe.Object({geometryIds:pe.Array(pe.Ref(If))},{$id:"WithGeometryIds"}),eZe=[Px,H2e];N();N();var tZe=s((t,e)=>pe.Unsafe(pe.Transform(pe.String(e)).Decode(r=>t.includes(r)?r:"unknown").Encode(r=>r)),"SafeStringEnumSchema"),Cv=s((t,e)=>{let r=tZe(t,e),i=[...t,"unknown"],n=Object.freeze(Object.fromEntries([...t,"unknown"].map(a=>[a,a])));return{schema:r,values:i,record:n}},"SafeStringEnum");N();N();N();var w3;(function(t){t.AnnotationNonPointGeometryError="AnnotationNonPointGeometryError",t.AnnotationUnknownSymbolError="AnnotationUnknownSymbolError"})(w3||(w3={}));var rZe=s(t=>{var e;if(t.annotations==null)return Ti(!0);let r=Lf(t),i=new Set(ps((e=t.annotationSymbols)!=null?e:{}));for(let n of ps(t.annotations)){let a=t.annotations[n];if(a!=null)for(let o of a){if(!i.has(o.symbolKey))return Di({kind:w3.AnnotationUnknownSymbolError,properties:{annotationId:o.id,symbolKey:o.symbolKey}});let l=r(n,o.geometryId);if(l.isErr())return l;if(l.value.geometry.type!=="Point")return Di({kind:w3.AnnotationNonPointGeometryError,properties:{annotationId:o.id,floorId:n,geometryId:o.geometryId}})}}return Ti(!0)},"validateAnnotations"),q2e=nu("a","AnnotationId"),Vk=pe.Intersect([Px,pe.Object({id:pe.Ref(q2e,{description:"The unique identifier for the annotation."}),externalId:pe.Optional(pe.String({description:"The external identifier for the annotation."})),symbolKey:pe.String({description:"The symbol identifier for the annotation."})})],{$id:"AnnotationProperties"}),W2e=pe.Object({url:pe.String({format:"uri",description:"The URL for the symbol."}),name:pe.String({description:"The name of the symbol."})},{$id:"AnnotationSymbol"}),iZe=pe.Object({annotations:zu(pe.Record($s,pe.Array(pe.Ref(Vk)),{additionalProperties:!1})),annotationSymbols:zu(pe.Record(pe.Index(Vk,["symbolKey"]),pe.Ref(W2e)))},{$id:"AnnotationsSchema"}),nZe=/^annotations\/(.*)\.json$/,aZe={name:"ext:mvf-annotations",schema:iZe,intoBundle:s(function*(t){if(t.annotations!=null)for(let e of ps(t.annotations))yield{path:"annotations/".concat(e,".json"),contents:t.annotations[e]};t.annotationSymbols!=null&&(yield{path:"annotation-symbols.json",contents:t.annotationSymbols})},"intoBundle"),fromBundle:s((t,e,r)=>{var i;if(t==="annotation-symbols.json")return{annotationSymbols:r(e)};let n=(i=t.match(nZe))==null?void 0:i[1];if(n)return{annotations:{[n]:r(e)}}},"fromBundle"),references:[q2e,Vk,W2e],integrityCheck:rZe};N();N();N();N();N();N();N();N();var X2e=class extends Ca{constructor(e){super("Duplicate type kind '".concat(e,"' detected"))}};s(X2e,"TypeSystemDuplicateTypeKind");var oZe=X2e,Z2e=class extends Ca{constructor(e){super("Duplicate string format '".concat(e,"' detected"))}};s(Z2e,"TypeSystemDuplicateFormat");var Y2e=Z2e,jk;(function(t){function e(i,n){if(rh.Has(i))throw new oZe(i);return rh.Set(i,n),(a={})=>iV(vt(Ee({},a),{[br]:i}))}s(e,"Type"),t.Type=e;function r(i,n){if(_f.Has(i))throw new Y2e(i);return _f.Set(i,n),i}s(r,"Format"),t.Format=r})(jk||(jk={}));N();N();N();function K2e(t){switch(t.errorType){case Bt.ArrayContains:return"Expected array to contain at least one matching value";case Bt.ArrayMaxContains:return"Expected array to contain no more than ".concat(t.schema.maxContains," matching values");case Bt.ArrayMinContains:return"Expected array to contain at least ".concat(t.schema.minContains," matching values");case Bt.ArrayMaxItems:return"Expected array length to be less or equal to ".concat(t.schema.maxItems);case Bt.ArrayMinItems:return"Expected array length to be greater or equal to ".concat(t.schema.minItems);case Bt.ArrayUniqueItems:return"Expected array elements to be unique";case Bt.Array:return"Expected array";case Bt.AsyncIterator:return"Expected AsyncIterator";case Bt.BigIntExclusiveMaximum:return"Expected bigint to be less than ".concat(t.schema.exclusiveMaximum);case Bt.BigIntExclusiveMinimum:return"Expected bigint to be greater than ".concat(t.schema.exclusiveMinimum);case Bt.BigIntMaximum:return"Expected bigint to be less or equal to ".concat(t.schema.maximum);case Bt.BigIntMinimum:return"Expected bigint to be greater or equal to ".concat(t.schema.minimum);case Bt.BigIntMultipleOf:return"Expected bigint to be a multiple of ".concat(t.schema.multipleOf);case Bt.BigInt:return"Expected bigint";case Bt.Boolean:return"Expected boolean";case Bt.DateExclusiveMinimumTimestamp:return"Expected Date timestamp to be greater than ".concat(t.schema.exclusiveMinimumTimestamp);case Bt.DateExclusiveMaximumTimestamp:return"Expected Date timestamp to be less than ".concat(t.schema.exclusiveMaximumTimestamp);case Bt.DateMinimumTimestamp:return"Expected Date timestamp to be greater or equal to ".concat(t.schema.minimumTimestamp);case Bt.DateMaximumTimestamp:return"Expected Date timestamp to be less or equal to ".concat(t.schema.maximumTimestamp);case Bt.DateMultipleOfTimestamp:return"Expected Date timestamp to be a multiple of ".concat(t.schema.multipleOfTimestamp);case Bt.Date:return"Expected Date";case Bt.Function:return"Expected function";case Bt.IntegerExclusiveMaximum:return"Expected integer to be less than ".concat(t.schema.exclusiveMaximum);case Bt.IntegerExclusiveMinimum:return"Expected integer to be greater than ".concat(t.schema.exclusiveMinimum);case Bt.IntegerMaximum:return"Expected integer to be less or equal to ".concat(t.schema.maximum);case Bt.IntegerMinimum:return"Expected integer to be greater or equal to ".concat(t.schema.minimum);case Bt.IntegerMultipleOf:return"Expected integer to be a multiple of ".concat(t.schema.multipleOf);case Bt.Integer:return"Expected integer";case Bt.IntersectUnevaluatedProperties:return"Unexpected property";case Bt.Intersect:return"Expected all values to match";case Bt.Iterator:return"Expected Iterator";case Bt.Literal:return"Expected ".concat(typeof t.schema.const=="string"?"'".concat(t.schema.const,"'"):t.schema.const);case Bt.Never:return"Never";case Bt.Not:return"Value should not match";case Bt.Null:return"Expected null";case Bt.NumberExclusiveMaximum:return"Expected number to be less than ".concat(t.schema.exclusiveMaximum);case Bt.NumberExclusiveMinimum:return"Expected number to be greater than ".concat(t.schema.exclusiveMinimum);case Bt.NumberMaximum:return"Expected number to be less or equal to ".concat(t.schema.maximum);case Bt.NumberMinimum:return"Expected number to be greater or equal to ".concat(t.schema.minimum);case Bt.NumberMultipleOf:return"Expected number to be a multiple of ".concat(t.schema.multipleOf);case Bt.Number:return"Expected number";case Bt.Object:return"Expected object";case Bt.ObjectAdditionalProperties:return"Unexpected property";case Bt.ObjectMaxProperties:return"Expected object to have no more than ".concat(t.schema.maxProperties," properties");case Bt.ObjectMinProperties:return"Expected object to have at least ".concat(t.schema.minProperties," properties");case Bt.ObjectRequiredProperty:return"Expected required property";case Bt.Promise:return"Expected Promise";case Bt.RegExp:return"Expected string to match regular expression";case Bt.StringFormatUnknown:return"Unknown format '".concat(t.schema.format,"'");case Bt.StringFormat:return"Expected string to match '".concat(t.schema.format,"' format");case Bt.StringMaxLength:return"Expected string length less or equal to ".concat(t.schema.maxLength);case Bt.StringMinLength:return"Expected string length greater or equal to ".concat(t.schema.minLength);case Bt.StringPattern:return"Expected string to match '".concat(t.schema.pattern,"'");case Bt.String:return"Expected string";case Bt.Symbol:return"Expected symbol";case Bt.TupleLength:return"Expected tuple to have ".concat(t.schema.maxItems||0," elements");case Bt.Tuple:return"Expected tuple";case Bt.Uint8ArrayMaxByteLength:return"Expected byte length less or equal to ".concat(t.schema.maxByteLength);case Bt.Uint8ArrayMinByteLength:return"Expected byte length greater or equal to ".concat(t.schema.minByteLength);case Bt.Uint8Array:return"Expected Uint8Array";case Bt.Undefined:return"Expected undefined";case Bt.Union:return"Expected union value";case Bt.Void:return"Expected void";case Bt.Kind:return"Expected kind '".concat(t.schema[br],"'");default:return"Unknown error type"}}s(K2e,"DefaultErrorFunction");var sZe=K2e;function J2e(){return sZe}s(J2e,"GetErrorFunction");N();var Q2e=class extends Ca{constructor(e){super("Unable to dereference schema with $id '".concat(e.$ref,"'")),this.schema=e}};s(Q2e,"TypeDereferenceError");var lZe=Q2e;function ewe(t,e){let r=e.find(i=>i.$id===t.$ref);if(r===void 0)throw new lZe(t);return ao(r,e)}s(ewe,"Resolve");function Iv(t,e){return!va(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}s(Iv,"Pushref");function ao(t,e){return t[br]==="This"||t[br]==="Ref"?ewe(t,e):t}s(ao,"Deref");N();var twe=class extends Ca{constructor(e){super("Unable to hash value"),this.value=e}};s(twe,"ValueHashError");var uZe=twe,Mc;(function(t){t[t.Undefined=0]="Undefined",t[t.Null=1]="Null",t[t.Boolean=2]="Boolean",t[t.Number=3]="Number",t[t.String=4]="String",t[t.Object=5]="Object",t[t.Array=6]="Array",t[t.Date=7]="Date",t[t.Uint8Array=8]="Uint8Array",t[t.Symbol=9]="Symbol",t[t.BigInt=10]="BigInt"})(Mc||(Mc={}));var z1=BigInt("14695981039346656037"),[cZe,hZe]=[BigInt("1099511628211"),BigInt("18446744073709551616")],pZe=Array.from({length:256}).map((t,e)=>BigInt(e)),rwe=new Float64Array(1),iwe=new DataView(rwe.buffer),nwe=new Uint8Array(rwe.buffer);function*awe(t){let e=t===0?1:Math.ceil(Math.floor(Math.log2(t)+1)/8);for(let r=0;r<e;r++)yield t>>8*(e-1-r)&255}s(awe,"NumberToBytes");function owe(t){ll(Mc.Array);for(let e of t)rv(e)}s(owe,"ArrayType");function swe(t){ll(Mc.Boolean),ll(t?1:0)}s(swe,"BooleanType");function lwe(t){ll(Mc.BigInt),iwe.setBigInt64(0,t);for(let e of nwe)ll(e)}s(lwe,"BigIntType");function uwe(t){ll(Mc.Date),rv(t.getTime())}s(uwe,"DateType");function cwe(t){ll(Mc.Null)}s(cwe,"NullType");function hwe(t){ll(Mc.Number),iwe.setFloat64(0,t);for(let e of nwe)ll(e)}s(hwe,"NumberType");function pwe(t){ll(Mc.Object);for(let e of globalThis.Object.getOwnPropertyNames(t).sort())rv(e),rv(t[e])}s(pwe,"ObjectType");function dwe(t){ll(Mc.String);for(let e=0;e<t.length;e++)for(let r of awe(t.charCodeAt(e)))ll(r)}s(dwe,"StringType");function fwe(t){ll(Mc.Symbol),rv(t.description)}s(fwe,"SymbolType");function mwe(t){ll(Mc.Uint8Array);for(let e=0;e<t.length;e++)ll(t[e])}s(mwe,"Uint8ArrayType");function gwe(t){return ll(Mc.Undefined)}s(gwe,"UndefinedType");function rv(t){if(Bn(t))return owe(t);if(yv(t))return swe(t);if(fc(t))return lwe(t);if(Mf(t))return uwe(t);if(yx(t))return cwe();if(xi(t))return hwe(t);if(On(t))return pwe(t);if(va(t))return dwe(t);if(vx(t))return fwe(t);if(n4(t))return mwe(t);if(Hu(t))return gwe();throw new uZe(t)}s(rv,"Visit");function ll(t){z1=z1^pZe[t],z1=z1*cZe%hZe}s(ll,"FNV1A64");function cS(t){return z1=BigInt("14695981039346656037"),rv(t),z1}s(cS,"Hash");N();var ywe=class extends Ca{constructor(e){super("Unknown type"),this.schema=e}};s(ywe,"ValueCheckUnknownTypeError");var dZe=ywe;function vwe(t){return t[br]==="Any"||t[br]==="Unknown"}s(vwe,"IsAnyOrUnknown");function pn(t){return t!==void 0}s(pn,"IsDefined");function _we(t,e,r){return!0}s(_we,"FromAny");function xwe(t,e,r){if(!Bn(r)||pn(t.minItems)&&!(r.length>=t.minItems)||pn(t.maxItems)&&!(r.length<=t.maxItems)||!r.every(a=>zs(t.items,e,a))||t.uniqueItems===!0&&!function(){let a=new Set;for(let o of r){let l=cS(o);if(a.has(l))return!1;a.add(l)}return!0}())return!1;if(!(pn(t.contains)||xi(t.minContains)||xi(t.maxContains)))return!0;let i=pn(t.contains)?t.contains:ul(),n=r.reduce((a,o)=>zs(i,e,o)?a+1:a,0);return!(n===0||xi(t.minContains)&&n<t.minContains||xi(t.maxContains)&&n>t.maxContains)}s(xwe,"FromArray");function bwe(t,e,r){return Ez(r)}s(bwe,"FromAsyncIterator");function wwe(t,e,r){return!(!fc(r)||pn(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||pn(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||pn(t.maximum)&&!(r<=t.maximum)||pn(t.minimum)&&!(r>=t.minimum)||pn(t.multipleOf)&&r%t.multipleOf!==BigInt(0))}s(wwe,"FromBigInt");function Awe(t,e,r){return yv(r)}s(Awe,"FromBoolean");function Swe(t,e,r){return zs(t.returns,e,r.prototype)}s(Swe,"FromConstructor");function Mwe(t,e,r){return!(!Mf(r)||pn(t.exclusiveMaximumTimestamp)&&!(r.getTime()<t.exclusiveMaximumTimestamp)||pn(t.exclusiveMinimumTimestamp)&&!(r.getTime()>t.exclusiveMinimumTimestamp)||pn(t.maximumTimestamp)&&!(r.getTime()<=t.maximumTimestamp)||pn(t.minimumTimestamp)&&!(r.getTime()>=t.minimumTimestamp)||pn(t.multipleOfTimestamp)&&r.getTime()%t.multipleOfTimestamp!==0)}s(Mwe,"FromDate");function Ewe(t,e,r){return KA(r)}s(Ewe,"FromFunction");function Cwe(t,e,r){return!(!Pz(r)||pn(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||pn(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||pn(t.maximum)&&!(r<=t.maximum)||pn(t.minimum)&&!(r>=t.minimum)||pn(t.multipleOf)&&r%t.multipleOf!==0)}s(Cwe,"FromInteger");function Iwe(t,e,r){let i=t.allOf.every(n=>zs(n,e,r));if(t.unevaluatedProperties===!1){let n=new RegExp(ev(t)),a=Object.getOwnPropertyNames(r).every(o=>n.test(o));return i&&a}else if(Gn(t.unevaluatedProperties)){let n=new RegExp(ev(t)),a=Object.getOwnPropertyNames(r).every(o=>n.test(o)||zs(t.unevaluatedProperties,e,r[o]));return i&&a}else return i}s(Iwe,"FromIntersect");function Twe(t,e,r){return Cz(r)}s(Twe,"FromIterator");function Pwe(t,e,r){return r===t.const}s(Pwe,"FromLiteral");function Lwe(t,e,r){return!1}s(Lwe,"FromNever");function Dwe(t,e,r){return!zs(t.not,e,r)}s(Dwe,"FromNot");function Rwe(t,e,r){return yx(r)}s(Rwe,"FromNull");function Owe(t,e,r){return!(!Co.IsNumberLike(r)||pn(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||pn(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||pn(t.minimum)&&!(r>=t.minimum)||pn(t.maximum)&&!(r<=t.maximum)||pn(t.multipleOf)&&r%t.multipleOf!==0)}s(Owe,"FromNumber");function kwe(t,e,r){if(!Co.IsObjectLike(r)||pn(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||pn(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let i=Object.getOwnPropertyNames(t.properties);for(let n of i){let a=t.properties[n];if(t.required&&t.required.includes(n)){if(!zs(a,e,r[n])||(Sv(a)||vwe(a))&&!(n in r))return!1}else if(Co.IsExactOptionalProperty(r,n)&&!zs(a,e,r[n]))return!1}if(t.additionalProperties===!1){let n=Object.getOwnPropertyNames(r);return t.required&&t.required.length===i.length&&n.length===i.length?!0:n.every(a=>i.includes(a))}else return typeof t.additionalProperties=="object"?Object.getOwnPropertyNames(r).every(n=>i.includes(n)||zs(t.additionalProperties,e,r[n])):!0}s(kwe,"FromObject");function Nwe(t,e,r){return Tz(r)}s(Nwe,"FromPromise");function Fwe(t,e,r){if(!Co.IsRecordLike(r)||pn(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||pn(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let[i,n]=Object.entries(t.patternProperties)[0],a=new RegExp(i),o=Object.entries(r).every(([c,p])=>a.test(c)?zs(n,e,p):!0),l=typeof t.additionalProperties=="object"?Object.entries(r).every(([c,p])=>a.test(c)?!0:zs(t.additionalProperties,e,p)):!0,u=t.additionalProperties===!1?Object.getOwnPropertyNames(r).every(c=>a.test(c)):!0;return o&&l&&u}s(Fwe,"FromRecord");function Bwe(t,e,r){return zs(ao(t,e),e,r)}s(Bwe,"FromRef");function zwe(t,e,r){let i=new RegExp(t.source,t.flags);return pn(t.minLength)&&!(r.length>=t.minLength)||pn(t.maxLength)&&!(r.length<=t.maxLength)?!1:i.test(r)}s(zwe,"FromRegExp");function Uwe(t,e,r){return!va(r)||pn(t.minLength)&&!(r.length>=t.minLength)||pn(t.maxLength)&&!(r.length<=t.maxLength)||pn(t.pattern)&&!new RegExp(t.pattern).test(r)?!1:pn(t.format)?_f.Has(t.format)?_f.Get(t.format)(r):!1:!0}s(Uwe,"FromString");function Vwe(t,e,r){return vx(r)}s(Vwe,"FromSymbol");function jwe(t,e,r){return va(r)&&new RegExp(t.pattern).test(r)}s(jwe,"FromTemplateLiteral");function $we(t,e,r){return zs(ao(t,e),e,r)}s($we,"FromThis");function Gwe(t,e,r){if(!Bn(r)||t.items===void 0&&r.length!==0||r.length!==t.maxItems)return!1;if(!t.items)return!0;for(let i=0;i<t.items.length;i++)if(!zs(t.items[i],e,r[i]))return!1;return!0}s(Gwe,"FromTuple");function Hwe(t,e,r){return Hu(r)}s(Hwe,"FromUndefined");function qwe(t,e,r){return t.anyOf.some(i=>zs(i,e,r))}s(qwe,"FromUnion");function Wwe(t,e,r){return!(!n4(r)||pn(t.maxByteLength)&&!(r.length<=t.maxByteLength)||pn(t.minByteLength)&&!(r.length>=t.minByteLength))}s(Wwe,"FromUint8Array");function Xwe(t,e,r){return!0}s(Xwe,"FromUnknown");function Zwe(t,e,r){return Co.IsVoidLike(r)}s(Zwe,"FromVoid");function Ywe(t,e,r){return rh.Has(t[br])?rh.Get(t[br])(t,r):!1}s(Ywe,"FromKind");function zs(t,e,r){let i=pn(t.$id)?[...e,t]:e,n=t;switch(n[br]){case"Any":return _we();case"Array":return xwe(n,i,r);case"AsyncIterator":return bwe(n,i,r);case"BigInt":return wwe(n,i,r);case"Boolean":return Awe(n,i,r);case"Constructor":return Swe(n,i,r);case"Date":return Mwe(n,i,r);case"Function":return Ewe(n,i,r);case"Integer":return Cwe(n,i,r);case"Intersect":return Iwe(n,i,r);case"Iterator":return Twe(n,i,r);case"Literal":return Pwe(n,i,r);case"Never":return Lwe();case"Not":return Dwe(n,i,r);case"Null":return Rwe(n,i,r);case"Number":return Owe(n,i,r);case"Object":return kwe(n,i,r);case"Promise":return Nwe(n,i,r);case"Record":return Fwe(n,i,r);case"Ref":return Bwe(n,i,r);case"RegExp":return zwe(n,i,r);case"String":return Uwe(n,i,r);case"Symbol":return Vwe(n,i,r);case"TemplateLiteral":return jwe(n,i,r);case"This":return $we(n,i,r);case"Tuple":return Gwe(n,i,r);case"Undefined":return Hwe(n,i,r);case"Union":return qwe(n,i,r);case"Uint8Array":return Wwe(n,i,r);case"Unknown":return Xwe();case"Void":return Zwe(n,i,r);default:if(!rh.Has(n[br]))throw new dZe(n);return Ywe(n,i,r)}}s(zs,"Visit");function xa(...t){return t.length===3?zs(t[0],t[1],t[2]):zs(t[0],[],t[1])}s(xa,"Check");var Bt;(function(t){t[t.ArrayContains=0]="ArrayContains",t[t.ArrayMaxContains=1]="ArrayMaxContains",t[t.ArrayMaxItems=2]="ArrayMaxItems",t[t.ArrayMinContains=3]="ArrayMinContains",t[t.ArrayMinItems=4]="ArrayMinItems",t[t.ArrayUniqueItems=5]="ArrayUniqueItems",t[t.Array=6]="Array",t[t.AsyncIterator=7]="AsyncIterator",t[t.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",t[t.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",t[t.BigIntMaximum=10]="BigIntMaximum",t[t.BigIntMinimum=11]="BigIntMinimum",t[t.BigIntMultipleOf=12]="BigIntMultipleOf",t[t.BigInt=13]="BigInt",t[t.Boolean=14]="Boolean",t[t.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",t[t.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",t[t.DateMaximumTimestamp=17]="DateMaximumTimestamp",t[t.DateMinimumTimestamp=18]="DateMinimumTimestamp",t[t.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",t[t.Date=20]="Date",t[t.Function=21]="Function",t[t.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",t[t.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",t[t.IntegerMaximum=24]="IntegerMaximum",t[t.IntegerMinimum=25]="IntegerMinimum",t[t.IntegerMultipleOf=26]="IntegerMultipleOf",t[t.Integer=27]="Integer",t[t.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",t[t.Intersect=29]="Intersect",t[t.Iterator=30]="Iterator",t[t.Kind=31]="Kind",t[t.Literal=32]="Literal",t[t.Never=33]="Never",t[t.Not=34]="Not",t[t.Null=35]="Null",t[t.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",t[t.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",t[t.NumberMaximum=38]="NumberMaximum",t[t.NumberMinimum=39]="NumberMinimum",t[t.NumberMultipleOf=40]="NumberMultipleOf",t[t.Number=41]="Number",t[t.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",t[t.ObjectMaxProperties=43]="ObjectMaxProperties",t[t.ObjectMinProperties=44]="ObjectMinProperties",t[t.ObjectRequiredProperty=45]="ObjectRequiredProperty",t[t.Object=46]="Object",t[t.Promise=47]="Promise",t[t.RegExp=48]="RegExp",t[t.StringFormatUnknown=49]="StringFormatUnknown",t[t.StringFormat=50]="StringFormat",t[t.StringMaxLength=51]="StringMaxLength",t[t.StringMinLength=52]="StringMinLength",t[t.StringPattern=53]="StringPattern",t[t.String=54]="String",t[t.Symbol=55]="Symbol",t[t.TupleLength=56]="TupleLength",t[t.Tuple=57]="Tuple",t[t.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",t[t.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",t[t.Uint8Array=60]="Uint8Array",t[t.Undefined=61]="Undefined",t[t.Union=62]="Union",t[t.Void=63]="Void"})(Bt||(Bt={}));var Kwe=class extends Ca{constructor(e){super("Unknown type"),this.schema=e}};s(Kwe,"ValueErrorsUnknownTypeError");var fZe=Kwe;function Dp(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}s(Dp,"EscapeKey");function hn(t){return t!==void 0}s(hn,"IsDefined");var Jwe=class{constructor(e){this.iterator=e}[Symbol.iterator](){return this.iterator}First(){let e=this.iterator.next();return e.done?void 0:e.value}};s(Jwe,"ValueErrorIterator");var Lx=Jwe;function Tr(t,e,r,i,n=[]){return{type:t,schema:e,path:r,value:i,message:J2e()({errorType:t,path:r,schema:e,value:i,errors:n}),errors:n}}s(Tr,"Create");function*Qwe(t,e,r,i){}s(Qwe,"FromAny");function*eAe(t,e,r,i){if(!Bn(i))return yield Tr(Bt.Array,t,r,i);hn(t.minItems)&&!(i.length>=t.minItems)&&(yield Tr(Bt.ArrayMinItems,t,r,i)),hn(t.maxItems)&&!(i.length<=t.maxItems)&&(yield Tr(Bt.ArrayMaxItems,t,r,i));for(let o=0;o<i.length;o++)yield*vr(Us(t.items,e,"".concat(r,"/").concat(o),i[o]));if(t.uniqueItems===!0&&!function(){let o=new Set;for(let l of i){let u=cS(l);if(o.has(u))return!1;o.add(u)}return!0}()&&(yield Tr(Bt.ArrayUniqueItems,t,r,i)),!(hn(t.contains)||hn(t.minContains)||hn(t.maxContains)))return;let n=hn(t.contains)?t.contains:ul(),a=i.reduce((o,l,u)=>Us(n,e,"".concat(r).concat(u),l).next().done===!0?o+1:o,0);a===0&&(yield Tr(Bt.ArrayContains,t,r,i)),xi(t.minContains)&&a<t.minContains&&(yield Tr(Bt.ArrayMinContains,t,r,i)),xi(t.maxContains)&&a>t.maxContains&&(yield Tr(Bt.ArrayMaxContains,t,r,i))}s(eAe,"FromArray");function*tAe(t,e,r,i){Ez(i)||(yield Tr(Bt.AsyncIterator,t,r,i))}s(tAe,"FromAsyncIterator");function*rAe(t,e,r,i){if(!fc(i))return yield Tr(Bt.BigInt,t,r,i);hn(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)&&(yield Tr(Bt.BigIntExclusiveMaximum,t,r,i)),hn(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)&&(yield Tr(Bt.BigIntExclusiveMinimum,t,r,i)),hn(t.maximum)&&!(i<=t.maximum)&&(yield Tr(Bt.BigIntMaximum,t,r,i)),hn(t.minimum)&&!(i>=t.minimum)&&(yield Tr(Bt.BigIntMinimum,t,r,i)),hn(t.multipleOf)&&i%t.multipleOf!==BigInt(0)&&(yield Tr(Bt.BigIntMultipleOf,t,r,i))}s(rAe,"FromBigInt");function*iAe(t,e,r,i){yv(i)||(yield Tr(Bt.Boolean,t,r,i))}s(iAe,"FromBoolean");function*nAe(t,e,r,i){yield*vr(Us(t.returns,e,r,i.prototype))}s(nAe,"FromConstructor");function*aAe(t,e,r,i){if(!Mf(i))return yield Tr(Bt.Date,t,r,i);hn(t.exclusiveMaximumTimestamp)&&!(i.getTime()<t.exclusiveMaximumTimestamp)&&(yield Tr(Bt.DateExclusiveMaximumTimestamp,t,r,i)),hn(t.exclusiveMinimumTimestamp)&&!(i.getTime()>t.exclusiveMinimumTimestamp)&&(yield Tr(Bt.DateExclusiveMinimumTimestamp,t,r,i)),hn(t.maximumTimestamp)&&!(i.getTime()<=t.maximumTimestamp)&&(yield Tr(Bt.DateMaximumTimestamp,t,r,i)),hn(t.minimumTimestamp)&&!(i.getTime()>=t.minimumTimestamp)&&(yield Tr(Bt.DateMinimumTimestamp,t,r,i)),hn(t.multipleOfTimestamp)&&i.getTime()%t.multipleOfTimestamp!==0&&(yield Tr(Bt.DateMultipleOfTimestamp,t,r,i))}s(aAe,"FromDate");function*oAe(t,e,r,i){KA(i)||(yield Tr(Bt.Function,t,r,i))}s(oAe,"FromFunction");function*sAe(t,e,r,i){if(!Pz(i))return yield Tr(Bt.Integer,t,r,i);hn(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)&&(yield Tr(Bt.IntegerExclusiveMaximum,t,r,i)),hn(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)&&(yield Tr(Bt.IntegerExclusiveMinimum,t,r,i)),hn(t.maximum)&&!(i<=t.maximum)&&(yield Tr(Bt.IntegerMaximum,t,r,i)),hn(t.minimum)&&!(i>=t.minimum)&&(yield Tr(Bt.IntegerMinimum,t,r,i)),hn(t.multipleOf)&&i%t.multipleOf!==0&&(yield Tr(Bt.IntegerMultipleOf,t,r,i))}s(sAe,"FromInteger");function*lAe(t,e,r,i){let n=!1;for(let a of t.allOf)for(let o of Us(a,e,r,i))n=!0,yield o;if(n)return yield Tr(Bt.Intersect,t,r,i);if(t.unevaluatedProperties===!1){let a=new RegExp(ev(t));for(let o of Object.getOwnPropertyNames(i))a.test(o)||(yield Tr(Bt.IntersectUnevaluatedProperties,t,"".concat(r,"/").concat(o),i))}if(typeof t.unevaluatedProperties=="object"){let a=new RegExp(ev(t));for(let o of Object.getOwnPropertyNames(i))if(!a.test(o)){let l=Us(t.unevaluatedProperties,e,"".concat(r,"/").concat(o),i[o]).next();l.done||(yield l.value)}}}s(lAe,"FromIntersect");function*uAe(t,e,r,i){Cz(i)||(yield Tr(Bt.Iterator,t,r,i))}s(uAe,"FromIterator");function*cAe(t,e,r,i){i!==t.const&&(yield Tr(Bt.Literal,t,r,i))}s(cAe,"FromLiteral");function*hAe(t,e,r,i){yield Tr(Bt.Never,t,r,i)}s(hAe,"FromNever");function*pAe(t,e,r,i){Us(t.not,e,r,i).next().done===!0&&(yield Tr(Bt.Not,t,r,i))}s(pAe,"FromNot");function*dAe(t,e,r,i){yx(i)||(yield Tr(Bt.Null,t,r,i))}s(dAe,"FromNull");function*fAe(t,e,r,i){if(!Co.IsNumberLike(i))return yield Tr(Bt.Number,t,r,i);hn(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)&&(yield Tr(Bt.NumberExclusiveMaximum,t,r,i)),hn(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)&&(yield Tr(Bt.NumberExclusiveMinimum,t,r,i)),hn(t.maximum)&&!(i<=t.maximum)&&(yield Tr(Bt.NumberMaximum,t,r,i)),hn(t.minimum)&&!(i>=t.minimum)&&(yield Tr(Bt.NumberMinimum,t,r,i)),hn(t.multipleOf)&&i%t.multipleOf!==0&&(yield Tr(Bt.NumberMultipleOf,t,r,i))}s(fAe,"FromNumber");function*mAe(t,e,r,i){if(!Co.IsObjectLike(i))return yield Tr(Bt.Object,t,r,i);hn(t.minProperties)&&!(Object.getOwnPropertyNames(i).length>=t.minProperties)&&(yield Tr(Bt.ObjectMinProperties,t,r,i)),hn(t.maxProperties)&&!(Object.getOwnPropertyNames(i).length<=t.maxProperties)&&(yield Tr(Bt.ObjectMaxProperties,t,r,i));let n=Array.isArray(t.required)?t.required:[],a=Object.getOwnPropertyNames(t.properties),o=Object.getOwnPropertyNames(i);for(let l of n)o.includes(l)||(yield Tr(Bt.ObjectRequiredProperty,t.properties[l],"".concat(r,"/").concat(Dp(l)),void 0));if(t.additionalProperties===!1)for(let l of o)a.includes(l)||(yield Tr(Bt.ObjectAdditionalProperties,t,"".concat(r,"/").concat(Dp(l)),i[l]));if(typeof t.additionalProperties=="object")for(let l of o)a.includes(l)||(yield*vr(Us(t.additionalProperties,e,"".concat(r,"/").concat(Dp(l)),i[l])));for(let l of a){let u=t.properties[l];t.required&&t.required.includes(l)?(yield*vr(Us(u,e,"".concat(r,"/").concat(Dp(l)),i[l])),Sv(t)&&!(l in i)&&(yield Tr(Bt.ObjectRequiredProperty,u,"".concat(r,"/").concat(Dp(l)),void 0))):Co.IsExactOptionalProperty(i,l)&&(yield*vr(Us(u,e,"".concat(r,"/").concat(Dp(l)),i[l])))}}s(mAe,"FromObject");function*gAe(t,e,r,i){Tz(i)||(yield Tr(Bt.Promise,t,r,i))}s(gAe,"FromPromise");function*yAe(t,e,r,i){if(!Co.IsRecordLike(i))return yield Tr(Bt.Object,t,r,i);hn(t.minProperties)&&!(Object.getOwnPropertyNames(i).length>=t.minProperties)&&(yield Tr(Bt.ObjectMinProperties,t,r,i)),hn(t.maxProperties)&&!(Object.getOwnPropertyNames(i).length<=t.maxProperties)&&(yield Tr(Bt.ObjectMaxProperties,t,r,i));let[n,a]=Object.entries(t.patternProperties)[0],o=new RegExp(n);for(let[l,u]of Object.entries(i))o.test(l)&&(yield*vr(Us(a,e,"".concat(r,"/").concat(Dp(l)),u)));if(typeof t.additionalProperties=="object")for(let[l,u]of Object.entries(i))o.test(l)||(yield*vr(Us(t.additionalProperties,e,"".concat(r,"/").concat(Dp(l)),u)));if(t.additionalProperties===!1){for(let[l,u]of Object.entries(i))if(!o.test(l))return yield Tr(Bt.ObjectAdditionalProperties,t,"".concat(r,"/").concat(Dp(l)),u)}}s(yAe,"FromRecord");function*vAe(t,e,r,i){yield*vr(Us(ao(t,e),e,r,i))}s(vAe,"FromRef");function*_Ae(t,e,r,i){if(!va(i))return yield Tr(Bt.String,t,r,i);if(hn(t.minLength)&&!(i.length>=t.minLength)&&(yield Tr(Bt.StringMinLength,t,r,i)),hn(t.maxLength)&&!(i.length<=t.maxLength)&&(yield Tr(Bt.StringMaxLength,t,r,i)),!new RegExp(t.source,t.flags).test(i))return yield Tr(Bt.RegExp,t,r,i)}s(_Ae,"FromRegExp");function*xAe(t,e,r,i){if(!va(i))return yield Tr(Bt.String,t,r,i);hn(t.minLength)&&!(i.length>=t.minLength)&&(yield Tr(Bt.StringMinLength,t,r,i)),hn(t.maxLength)&&!(i.length<=t.maxLength)&&(yield Tr(Bt.StringMaxLength,t,r,i)),va(t.pattern)&&(new RegExp(t.pattern).test(i)||(yield Tr(Bt.StringPattern,t,r,i))),va(t.format)&&(_f.Has(t.format)?_f.Get(t.format)(i)||(yield Tr(Bt.StringFormat,t,r,i)):yield Tr(Bt.StringFormatUnknown,t,r,i))}s(xAe,"FromString");function*bAe(t,e,r,i){vx(i)||(yield Tr(Bt.Symbol,t,r,i))}s(bAe,"FromSymbol");function*wAe(t,e,r,i){if(!va(i))return yield Tr(Bt.String,t,r,i);new RegExp(t.pattern).test(i)||(yield Tr(Bt.StringPattern,t,r,i))}s(wAe,"FromTemplateLiteral");function*AAe(t,e,r,i){yield*vr(Us(ao(t,e),e,r,i))}s(AAe,"FromThis");function*SAe(t,e,r,i){if(!Bn(i))return yield Tr(Bt.Tuple,t,r,i);if(t.items===void 0&&i.length!==0)return yield Tr(Bt.TupleLength,t,r,i);if(i.length!==t.maxItems)return yield Tr(Bt.TupleLength,t,r,i);if(t.items)for(let n=0;n<t.items.length;n++)yield*vr(Us(t.items[n],e,"".concat(r,"/").concat(n),i[n]))}s(SAe,"FromTuple");function*MAe(t,e,r,i){Hu(i)||(yield Tr(Bt.Undefined,t,r,i))}s(MAe,"FromUndefined");function*EAe(t,e,r,i){if(xa(t,e,i))return;let n=t.anyOf.map(a=>new Lx(Us(a,e,r,i)));yield Tr(Bt.Union,t,r,i,n)}s(EAe,"FromUnion");function*CAe(t,e,r,i){if(!n4(i))return yield Tr(Bt.Uint8Array,t,r,i);hn(t.maxByteLength)&&!(i.length<=t.maxByteLength)&&(yield Tr(Bt.Uint8ArrayMaxByteLength,t,r,i)),hn(t.minByteLength)&&!(i.length>=t.minByteLength)&&(yield Tr(Bt.Uint8ArrayMinByteLength,t,r,i))}s(CAe,"FromUint8Array");function*IAe(t,e,r,i){}s(IAe,"FromUnknown");function*TAe(t,e,r,i){Co.IsVoidLike(i)||(yield Tr(Bt.Void,t,r,i))}s(TAe,"FromVoid");function*PAe(t,e,r,i){rh.Get(t[br])(t,i)||(yield Tr(Bt.Kind,t,r,i))}s(PAe,"FromKind");function*Us(t,e,r,i){let n=hn(t.$id)?[...e,t]:e,a=t;switch(a[br]){case"Any":return yield*vr(Qwe());case"Array":return yield*vr(eAe(a,n,r,i));case"AsyncIterator":return yield*vr(tAe(a,n,r,i));case"BigInt":return yield*vr(rAe(a,n,r,i));case"Boolean":return yield*vr(iAe(a,n,r,i));case"Constructor":return yield*vr(nAe(a,n,r,i));case"Date":return yield*vr(aAe(a,n,r,i));case"Function":return yield*vr(oAe(a,n,r,i));case"Integer":return yield*vr(sAe(a,n,r,i));case"Intersect":return yield*vr(lAe(a,n,r,i));case"Iterator":return yield*vr(uAe(a,n,r,i));case"Literal":return yield*vr(cAe(a,n,r,i));case"Never":return yield*vr(hAe(a,n,r,i));case"Not":return yield*vr(pAe(a,n,r,i));case"Null":return yield*vr(dAe(a,n,r,i));case"Number":return yield*vr(fAe(a,n,r,i));case"Object":return yield*vr(mAe(a,n,r,i));case"Promise":return yield*vr(gAe(a,n,r,i));case"Record":return yield*vr(yAe(a,n,r,i));case"Ref":return yield*vr(vAe(a,n,r,i));case"RegExp":return yield*vr(_Ae(a,n,r,i));case"String":return yield*vr(xAe(a,n,r,i));case"Symbol":return yield*vr(bAe(a,n,r,i));case"TemplateLiteral":return yield*vr(wAe(a,n,r,i));case"This":return yield*vr(AAe(a,n,r,i));case"Tuple":return yield*vr(SAe(a,n,r,i));case"Undefined":return yield*vr(MAe(a,n,r,i));case"Union":return yield*vr(EAe(a,n,r,i));case"Uint8Array":return yield*vr(CAe(a,n,r,i));case"Unknown":return yield*vr(IAe());case"Void":return yield*vr(TAe(a,n,r,i));default:if(!rh.Has(a[br]))throw new fZe(t);return yield*vr(PAe(a,n,r,i))}}s(Us,"Visit");function Dx(...t){let e=t.length===3?Us(t[0],t[1],"",t[2]):Us(t[0],[],"",t[1]);return new Lx(e)}s(Dx,"Errors");N();var mZe=function(t,e,r,i,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},LAe=function(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)},$k,A3,DAe,RAe=class extends Ca{constructor(e){let r=e.First();super(r===void 0?"Invalid Value":r.message),$k.add(this),A3.set(this,void 0),mZe(this,A3,e),this.error=r}Errors(){return new Lx(LAe(this,$k,"m",DAe).call(this))}};s(RAe,"AssertError");var gZe=RAe;A3=new WeakMap,$k=new WeakSet,DAe=s(function*(){this.error&&(yield this.error),yield*vr(LAe(this,A3,"f"))},"_AssertError_Iterator");function Gk(t,e,r){if(!xa(t,e,r))throw new gZe(Dx(t,e,r))}s(Gk,"AssertValue");function cV(...t){return t.length===3?Gk(t[0],t[1],t[2]):Gk(t[0],[],t[1])}s(cV,"Assert");N();N();N();function OAe(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=Da(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=Da(t[r]);return e}s(OAe,"FromObject");function kAe(t){return t.map(e=>Da(e))}s(kAe,"FromArray");function NAe(t){return t.slice()}s(NAe,"FromTypedArray");function FAe(t){return new Map(Da([...t.entries()]))}s(FAe,"FromMap");function BAe(t){return new Set(Da([...t.entries()]))}s(BAe,"FromSet");function zAe(t){return new Date(t.toISOString())}s(zAe,"FromDate");function Da(t){if(Bn(t))return kAe(t);if(Mf(t))return zAe(t);if(Ef(t))return NAe(t);if(u0e(t))return FAe(t);if(c0e(t))return BAe(t);if(On(t))return OAe(t);if(od(t))return t;throw new Error("ValueClone: Unable to clone value")}s(Da,"Clone");var UAe=class extends Ca{constructor(e,r){super(r),this.schema=e}};s(UAe,"ValueCreateError");var jh=UAe;function An(t){return KA(t)?t():Da(t)}s(An,"FromDefault");function VAe(t,e){return Oi(t,"default")?An(t.default):{}}s(VAe,"FromAny");function jAe(t,e){if(t.uniqueItems===!0&&!Oi(t,"default"))throw new jh(t,"Array with the uniqueItems constraint requires a default value");if("contains"in t&&!Oi(t,"default"))throw new jh(t,"Array with the contains constraint requires a default value");return"default"in t?An(t.default):t.minItems!==void 0?Array.from({length:t.minItems}).map(r=>Uu(t.items,e)):[]}s(jAe,"FromArray");function $Ae(t,e){return Oi(t,"default")?An(t.default):function(){return QRe(this,null,function*(){})}()}s($Ae,"FromAsyncIterator");function GAe(t,e){return Oi(t,"default")?An(t.default):BigInt(0)}s(GAe,"FromBigInt");function HAe(t,e){return Oi(t,"default")?An(t.default):!1}s(HAe,"FromBoolean");function qAe(t,e){if(Oi(t,"default"))return An(t.default);{let r=Uu(t.returns,e);return typeof r=="object"&&!Array.isArray(r)?class{constructor(){for(let[i,n]of Object.entries(r)){let a=this;a[i]=n}}}:class{}}}s(qAe,"FromConstructor");function WAe(t,e){return Oi(t,"default")?An(t.default):t.minimumTimestamp!==void 0?new Date(t.minimumTimestamp):new Date}s(WAe,"FromDate");function XAe(t,e){return Oi(t,"default")?An(t.default):()=>Uu(t.returns,e)}s(XAe,"FromFunction");function ZAe(t,e){return Oi(t,"default")?An(t.default):t.minimum!==void 0?t.minimum:0}s(ZAe,"FromInteger");function YAe(t,e){if(Oi(t,"default"))return An(t.default);{let r=t.allOf.reduce((i,n)=>{let a=Uu(n,e);return typeof a=="object"?Ee(Ee({},i),a):a},{});if(!xa(t,e,r))throw new jh(t,"Intersect produced invalid value. Consider using a default value.");return r}}s(YAe,"FromIntersect");function KAe(t,e){return Oi(t,"default")?An(t.default):function*(){}()}s(KAe,"FromIterator");function JAe(t,e){return Oi(t,"default")?An(t.default):t.const}s(JAe,"FromLiteral");function QAe(t,e){if(Oi(t,"default"))return An(t.default);throw new jh(t,"Never types cannot be created. Consider using a default value.")}s(QAe,"FromNever");function eSe(t,e){if(Oi(t,"default"))return An(t.default);throw new jh(t,"Not types must have a default value")}s(eSe,"FromNot");function tSe(t,e){return Oi(t,"default")?An(t.default):null}s(tSe,"FromNull");function rSe(t,e){return Oi(t,"default")?An(t.default):t.minimum!==void 0?t.minimum:0}s(rSe,"FromNumber");function iSe(t,e){if(Oi(t,"default"))return An(t.default);{let r=new Set(t.required),i={};for(let[n,a]of Object.entries(t.properties))r.has(n)&&(i[n]=Uu(a,e));return i}}s(iSe,"FromObject");function nSe(t,e){return Oi(t,"default")?An(t.default):Promise.resolve(Uu(t.item,e))}s(nSe,"FromPromise");function aSe(t,e){let[r,i]=Object.entries(t.patternProperties)[0];if(Oi(t,"default"))return An(t.default);if(r===U_||r===z_)return{};{let n=r.slice(1,r.length-1).split("|"),a={};for(let o of n)a[o]=Uu(i,e);return a}}s(aSe,"FromRecord");function oSe(t,e){return Oi(t,"default")?An(t.default):Uu(ao(t,e),e)}s(oSe,"FromRef");function sSe(t,e){if(Oi(t,"default"))return An(t.default);throw new jh(t,"RegExp types cannot be created. Consider using a default value.")}s(sSe,"FromRegExp");function lSe(t,e){if(t.pattern!==void 0){if(Oi(t,"default"))return An(t.default);throw new jh(t,"String types with patterns must specify a default value")}else if(t.format!==void 0){if(Oi(t,"default"))return An(t.default);throw new jh(t,"String types with formats must specify a default value")}else return Oi(t,"default")?An(t.default):t.minLength!==void 0?Array.from({length:t.minLength}).map(()=>" ").join(""):""}s(lSe,"FromString");function uSe(t,e){return Oi(t,"default")?An(t.default):"value"in t?Symbol.for(t.value):Symbol()}s(uSe,"FromSymbol");function cSe(t,e){if(Oi(t,"default"))return An(t.default);if(!MU(t))throw new jh(t,"Can only create template literals that produce a finite variants. Consider using a default value.");return y4(t)[0]}s(cSe,"FromTemplateLiteral");function hSe(t,e){if(_Se++>yZe)throw new jh(t,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");return Oi(t,"default")?An(t.default):Uu(ao(t,e),e)}s(hSe,"FromThis");function pSe(t,e){return Oi(t,"default")?An(t.default):t.items===void 0?[]:Array.from({length:t.minItems}).map((r,i)=>Uu(t.items[i],e))}s(pSe,"FromTuple");function dSe(t,e){if(Oi(t,"default"))return An(t.default)}s(dSe,"FromUndefined");function fSe(t,e){if(Oi(t,"default"))return An(t.default);if(t.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");return Uu(t.anyOf[0],e)}s(fSe,"FromUnion");function mSe(t,e){return Oi(t,"default")?An(t.default):t.minByteLength!==void 0?new Uint8Array(t.minByteLength):new Uint8Array(0)}s(mSe,"FromUint8Array");function gSe(t,e){return Oi(t,"default")?An(t.default):{}}s(gSe,"FromUnknown");function ySe(t,e){if(Oi(t,"default"))return An(t.default)}s(ySe,"FromVoid");function vSe(t,e){if(Oi(t,"default"))return An(t.default);throw new Error("User defined types must specify a default value")}s(vSe,"FromKind");function Uu(t,e){let r=Iv(t,e),i=t;switch(i[br]){case"Any":return VAe(i);case"Array":return jAe(i,r);case"AsyncIterator":return $Ae(i);case"BigInt":return GAe(i);case"Boolean":return HAe(i);case"Constructor":return qAe(i,r);case"Date":return WAe(i);case"Function":return XAe(i,r);case"Integer":return ZAe(i);case"Intersect":return YAe(i,r);case"Iterator":return KAe(i);case"Literal":return JAe(i);case"Never":return QAe(i);case"Not":return eSe(i);case"Null":return tSe(i);case"Number":return rSe(i);case"Object":return iSe(i,r);case"Promise":return nSe(i,r);case"Record":return aSe(i,r);case"Ref":return oSe(i,r);case"RegExp":return sSe(i);case"String":return lSe(i);case"Symbol":return uSe(i);case"TemplateLiteral":return cSe(i);case"This":return hSe(i,r);case"Tuple":return pSe(i,r);case"Undefined":return dSe(i);case"Union":return fSe(i,r);case"Uint8Array":return mSe(i);case"Unknown":return gSe(i);case"Void":return ySe(i);default:if(!rh.Has(i[br]))throw new jh(i,"Unknown type");return vSe(i)}}s(Uu,"Visit");var yZe=512,_Se=0;function $h(...t){return _Se=0,t.length===2?Uu(t[0],t[1]):Uu(t[0],[])}s($h,"Create");var xSe=class extends Ca{constructor(e,r){super(r),this.schema=e}};s(xSe,"ValueCastError");var bSe=xSe;function wSe(t,e,r){if(t[br]==="Object"&&typeof r=="object"&&!yx(r)){let i=t,n=Object.getOwnPropertyNames(r),a=Object.entries(i.properties),[o,l]=[1/a.length,a.length];return a.reduce((u,[c,p])=>{let m=p[br]==="Literal"&&p.const===r[c]?l:0,y=xa(p,e,r[c])?o:0,v=n.includes(c)?o:0;return u+(m+y+v)},0)}else return xa(t,e,r)?1:0}s(wSe,"ScoreUnion");function ASe(t,e,r){let i=t.anyOf.map(o=>ao(o,e)),[n,a]=[i[0],0];for(let o of i){let l=wSe(o,e,r);l>a&&(n=o,a=l)}return n}s(ASe,"SelectUnion");function SSe(t,e,r){if("default"in t)return typeof r=="function"?t.default:Da(t.default);{let i=ASe(t,e,r);return hV(i,e,r)}}s(SSe,"CastUnion");function MSe(t,e,r){return xa(t,e,r)?Da(r):$h(t,e)}s(MSe,"DefaultClone");function ESe(t,e,r){return xa(t,e,r)?r:$h(t,e)}s(ESe,"Default");function CSe(t,e,r){if(xa(t,e,r))return Da(r);let i=Bn(r)?Da(r):$h(t,e),n=xi(t.minItems)&&i.length<t.minItems?[...i,...Array.from({length:t.minItems-i.length},()=>null)]:i,a=(xi(t.maxItems)&&n.length>t.maxItems?n.slice(0,t.maxItems):n).map(l=>Gh(t.items,e,l));if(t.uniqueItems!==!0)return a;let o=[...new Set(a)];if(!xa(t,e,o))throw new bSe(t,"Array cast produced invalid data due to uniqueItems constraint");return o}s(CSe,"FromArray");function ISe(t,e,r){if(xa(t,e,r))return $h(t,e);let i=new Set(t.returns.required||[]),n=s(function(){},"result");for(let[a,o]of Object.entries(t.returns.properties))!i.has(a)&&r.prototype[a]===void 0||(n.prototype[a]=Gh(o,e,r.prototype[a]));return n}s(ISe,"FromConstructor");function TSe(t,e,r){let i=$h(t,e),n=On(i)&&On(r)?Ee(Ee({},i),r):r;return xa(t,e,n)?n:$h(t,e)}s(TSe,"FromIntersect");function PSe(t,e,r){throw new bSe(t,"Never types cannot be cast")}s(PSe,"FromNever");function LSe(t,e,r){if(xa(t,e,r))return r;if(r===null||typeof r!="object")return $h(t,e);let i=new Set(t.required||[]),n={};for(let[a,o]of Object.entries(t.properties))!i.has(a)&&r[a]===void 0||(n[a]=Gh(o,e,r[a]));if(typeof t.additionalProperties=="object"){let a=Object.getOwnPropertyNames(t.properties);for(let o of Object.getOwnPropertyNames(r))a.includes(o)||(n[o]=Gh(t.additionalProperties,e,r[o]))}return n}s(LSe,"FromObject");function DSe(t,e,r){if(xa(t,e,r))return Da(r);if(r===null||typeof r!="object"||Array.isArray(r)||r instanceof Date)return $h(t,e);let i=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[i],a={};for(let[o,l]of Object.entries(r))a[o]=Gh(n,e,l);return a}s(DSe,"FromRecord");function RSe(t,e,r){return Gh(ao(t,e),e,r)}s(RSe,"FromRef");function OSe(t,e,r){return Gh(ao(t,e),e,r)}s(OSe,"FromThis");function kSe(t,e,r){return xa(t,e,r)?Da(r):Bn(r)?t.items===void 0?[]:t.items.map((i,n)=>Gh(i,e,r[n])):$h(t,e)}s(kSe,"FromTuple");function NSe(t,e,r){return xa(t,e,r)?Da(r):SSe(t,e,r)}s(NSe,"FromUnion");function Gh(t,e,r){let i=va(t.$id)?[...e,t]:e,n=t;switch(t[br]){case"Array":return CSe(n,i,r);case"Constructor":return ISe(n,i,r);case"Intersect":return TSe(n,i,r);case"Never":return PSe(n);case"Object":return LSe(n,i,r);case"Record":return DSe(n,i,r);case"Ref":return RSe(n,i,r);case"This":return OSe(n,i,r);case"Tuple":return kSe(n,i,r);case"Union":return NSe(n,i,r);case"Date":case"Symbol":case"Uint8Array":return MSe(t,e,r);default:return ESe(n,i,r)}}s(Gh,"Visit");function hV(...t){return t.length===3?Gh(t[0],t[1],t[2]):Gh(t[0],[],t[1])}s(hV,"Cast");N();function FSe(t){return xv(t)&&t[br]!=="Unsafe"}s(FSe,"IsCheckable");function BSe(t,e,r){return Bn(r)?r.map(i=>Vu(t.items,e,i)):r}s(BSe,"FromArray");function zSe(t,e,r){let i=t.unevaluatedProperties,n=t.allOf.map(o=>Vu(o,e,Da(r))).reduce((o,l)=>On(l)?Ee(Ee({},o),l):l,{});if(!On(r)||!On(n)||!xv(i))return n;let a=Qh(t);for(let o of Object.getOwnPropertyNames(r))a.includes(o)||xa(i,e,r[o])&&(n[o]=Vu(i,e,r[o]));return n}s(zSe,"FromIntersect");function USe(t,e,r){if(!On(r)||Bn(r))return r;let i=t.additionalProperties;for(let n of Object.getOwnPropertyNames(r)){if(Oi(t.properties,n)){r[n]=Vu(t.properties[n],e,r[n]);continue}if(xv(i)&&xa(i,e,r[n])){r[n]=Vu(i,e,r[n]);continue}delete r[n]}return r}s(USe,"FromObject");function VSe(t,e,r){if(!On(r))return r;let i=t.additionalProperties,n=Object.getOwnPropertyNames(r),[a,o]=Object.entries(t.patternProperties)[0],l=new RegExp(a);for(let u of n){if(l.test(u)){r[u]=Vu(o,e,r[u]);continue}if(xv(i)&&xa(i,e,r[u])){r[u]=Vu(i,e,r[u]);continue}delete r[u]}return r}s(VSe,"FromRecord");function jSe(t,e,r){return Vu(ao(t,e),e,r)}s(jSe,"FromRef");function $Se(t,e,r){return Vu(ao(t,e),e,r)}s($Se,"FromThis");function GSe(t,e,r){if(!Bn(r))return r;if(Hu(t.items))return[];let i=Math.min(r.length,t.items.length);for(let n=0;n<i;n++)r[n]=Vu(t.items[n],e,r[n]);return r.length>i?r.slice(0,i):r}s(GSe,"FromTuple");function HSe(t,e,r){for(let i of t.anyOf)if(FSe(i)&&xa(i,e,r))return Vu(i,e,r);return r}s(HSe,"FromUnion");function Vu(t,e,r){let i=va(t.$id)?[...e,t]:e,n=t;switch(n[br]){case"Array":return BSe(n,i,r);case"Intersect":return zSe(n,i,r);case"Object":return USe(n,i,r);case"Record":return VSe(n,i,r);case"Ref":return jSe(n,i,r);case"This":return $Se(n,i,r);case"Tuple":return GSe(n,i,r);case"Union":return HSe(n,i,r);default:return r}}s(Vu,"Visit");function pV(...t){return t.length===3?Vu(t[0],t[1],t[2]):Vu(t[0],[],t[1])}s(pV,"Clean");N();function hS(t){return va(t)&&!isNaN(t)&&!isNaN(parseFloat(t))}s(hS,"IsStringNumeric");function qSe(t){return fc(t)||yv(t)||xi(t)}s(qSe,"IsValueToString");function Rx(t){return t===!0||xi(t)&&t===1||fc(t)&&t===BigInt("1")||va(t)&&(t.toLowerCase()==="true"||t==="1")}s(Rx,"IsValueTrue");function Ox(t){return t===!1||xi(t)&&(t===0||Object.is(t,-0))||fc(t)&&t===BigInt("0")||va(t)&&(t.toLowerCase()==="false"||t==="0"||t==="-0")}s(Ox,"IsValueFalse");function WSe(t){return va(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}s(WSe,"IsTimeStringWithTimeZone");function XSe(t){return va(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}s(XSe,"IsTimeStringWithoutTimeZone");function ZSe(t){return va(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}s(ZSe,"IsDateTimeStringWithTimeZone");function YSe(t){return va(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}s(YSe,"IsDateTimeStringWithoutTimeZone");function KSe(t){return va(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(t)}s(KSe,"IsDateString");function JSe(t,e){let r=fV(t);return r===e?r:t}s(JSe,"TryConvertLiteralString");function QSe(t,e){let r=mV(t);return r===e?r:t}s(QSe,"TryConvertLiteralNumber");function eMe(t,e){let r=dV(t);return r===e?r:t}s(eMe,"TryConvertLiteralBoolean");function tMe(t,e){return va(t.const)?JSe(e,t.const):xi(t.const)?QSe(e,t.const):yv(t.const)?eMe(e,t.const):e}s(tMe,"TryConvertLiteral");function dV(t){return Rx(t)?!0:Ox(t)?!1:t}s(dV,"TryConvertBoolean");function rMe(t){let e=s(r=>r.split(".")[0],"truncateInteger");return hS(t)?BigInt(e(t)):xi(t)?BigInt(Math.trunc(t)):Ox(t)?BigInt(0):Rx(t)?BigInt(1):t}s(rMe,"TryConvertBigInt");function fV(t){return qSe(t)?t.toString():vx(t)&&t.description!==void 0?t.description.toString():t}s(fV,"TryConvertString");function mV(t){return hS(t)?parseFloat(t):Rx(t)?1:Ox(t)?0:t}s(mV,"TryConvertNumber");function iMe(t){return hS(t)?parseInt(t):xi(t)?t|0:Rx(t)?1:Ox(t)?0:t}s(iMe,"TryConvertInteger");function nMe(t){return va(t)&&t.toLowerCase()==="null"?null:t}s(nMe,"TryConvertNull");function aMe(t){return va(t)&&t==="undefined"?void 0:t}s(aMe,"TryConvertUndefined");function oMe(t){return Mf(t)?t:xi(t)?new Date(t):Rx(t)?new Date(1):Ox(t)?new Date(0):hS(t)?new Date(parseInt(t)):XSe(t)?new Date("1970-01-01T".concat(t,".000Z")):WSe(t)?new Date("1970-01-01T".concat(t)):YSe(t)?new Date("".concat(t,".000Z")):ZSe(t)?new Date(t):KSe(t)?new Date("".concat(t,"T00:00:00.000Z")):t}s(oMe,"TryConvertDate");function sMe(t,e,r){return(Bn(r)?r:[r]).map(i=>Hh(t.items,e,i))}s(sMe,"FromArray");function lMe(t,e,r){return rMe(r)}s(lMe,"FromBigInt");function uMe(t,e,r){return dV(r)}s(uMe,"FromBoolean");function cMe(t,e,r){return oMe(r)}s(cMe,"FromDate");function hMe(t,e,r){return iMe(r)}s(hMe,"FromInteger");function pMe(t,e,r){return t.allOf.reduce((i,n)=>Hh(n,e,i),r)}s(pMe,"FromIntersect");function dMe(t,e,r){return tMe(t,r)}s(dMe,"FromLiteral");function fMe(t,e,r){return nMe(r)}s(fMe,"FromNull");function mMe(t,e,r){return mV(r)}s(mMe,"FromNumber");function gMe(t,e,r){if(!On(r))return r;for(let i of Object.getOwnPropertyNames(t.properties))Oi(r,i)&&(r[i]=Hh(t.properties[i],e,r[i]));return r}s(gMe,"FromObject");function yMe(t,e,r){if(!On(r))return r;let i=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[i];for(let[a,o]of Object.entries(r))r[a]=Hh(n,e,o);return r}s(yMe,"FromRecord");function vMe(t,e,r){return Hh(ao(t,e),e,r)}s(vMe,"FromRef");function _Me(t,e,r){return fV(r)}s(_Me,"FromString");function xMe(t,e,r){return va(r)||xi(r)?Symbol(r):r}s(xMe,"FromSymbol");function bMe(t,e,r){return Hh(ao(t,e),e,r)}s(bMe,"FromThis");function wMe(t,e,r){return Bn(r)&&!Hu(t.items)?r.map((i,n)=>n<t.items.length?Hh(t.items[n],e,i):i):r}s(wMe,"FromTuple");function AMe(t,e,r){return aMe(r)}s(AMe,"FromUndefined");function SMe(t,e,r){for(let i of t.anyOf){let n=Hh(i,e,Da(r));if(xa(i,e,n))return n}return r}s(SMe,"FromUnion");function Hh(t,e,r){let i=Iv(t,e),n=t;switch(t[br]){case"Array":return sMe(n,i,r);case"BigInt":return lMe(n,i,r);case"Boolean":return uMe(n,i,r);case"Date":return cMe(n,i,r);case"Integer":return hMe(n,i,r);case"Intersect":return pMe(n,i,r);case"Literal":return dMe(n,i,r);case"Null":return fMe(n,i,r);case"Number":return mMe(n,i,r);case"Object":return gMe(n,i,r);case"Record":return yMe(n,i,r);case"Ref":return vMe(n,i,r);case"String":return _Me(n,i,r);case"Symbol":return xMe(n,i,r);case"This":return bMe(n,i,r);case"Tuple":return wMe(n,i,r);case"Undefined":return AMe(n,i,r);case"Union":return SMe(n,i,r);default:return r}}s(Hh,"Visit");function gV(...t){return t.length===3?Hh(t[0],t[1],t[2]):Hh(t[0],[],t[1])}s(gV,"Convert");N();N();var MMe=class extends Ca{constructor(e,r,i){super("Unable to decode value as it does not match the expected schema"),this.schema=e,this.value=r,this.error=i}};s(MMe,"TransformDecodeCheckError");var EMe=MMe,CMe=class extends Ca{constructor(e,r,i,n){super(n instanceof Error?n.message:"Unknown error"),this.schema=e,this.path=r,this.value=i,this.error=n}};s(CMe,"TransformDecodeError");var yV=CMe;function Qa(t,e,r){try{return io(t)?t[Du].Decode(r):r}catch(i){throw new yV(t,e,r,i)}}s(Qa,"Default");function IMe(t,e,r,i){return Bn(i)?Qa(t,r,i.map((n,a)=>tp(t.items,e,"".concat(r,"/").concat(a),n))):Qa(t,r,i)}s(IMe,"FromArray");function TMe(t,e,r,i){if(!On(i)||od(i))return Qa(t,r,i);let n=aS(t),a=n.map(p=>p[0]),o=Ee({},i);for(let[p,m]of n)p in o&&(o[p]=tp(m,e,"".concat(r,"/").concat(p),o[p]));if(!io(t.unevaluatedProperties))return Qa(t,r,o);let l=Object.getOwnPropertyNames(o),u=t.unevaluatedProperties,c=Ee({},o);for(let p of l)a.includes(p)||(c[p]=Qa(u,"".concat(r,"/").concat(p),c[p]));return Qa(t,r,c)}s(TMe,"FromIntersect");function PMe(t,e,r,i){return Qa(t,r,tp(t.not,e,r,i))}s(PMe,"FromNot");function LMe(t,e,r,i){if(!On(i))return Qa(t,r,i);let n=Qh(t),a=Ee({},i);for(let c of n)Oi(a,c)&&(Hu(a[c])&&(!rS(t.properties[c])||Co.IsExactOptionalProperty(a,c))||(a[c]=tp(t.properties[c],e,"".concat(r,"/").concat(c),a[c])));if(!Gn(t.additionalProperties))return Qa(t,r,a);let o=Object.getOwnPropertyNames(a),l=t.additionalProperties,u=Ee({},a);for(let c of o)n.includes(c)||(u[c]=Qa(l,"".concat(r,"/").concat(c),u[c]));return Qa(t,r,u)}s(LMe,"FromObject");function DMe(t,e,r,i){if(!On(i))return Qa(t,r,i);let n=Object.getOwnPropertyNames(t.patternProperties)[0],a=new RegExp(n),o=Ee({},i);for(let p of Object.getOwnPropertyNames(i))a.test(p)&&(o[p]=tp(t.patternProperties[n],e,"".concat(r,"/").concat(p),o[p]));if(!Gn(t.additionalProperties))return Qa(t,r,o);let l=Object.getOwnPropertyNames(o),u=t.additionalProperties,c=Ee({},o);for(let p of l)a.test(p)||(c[p]=Qa(u,"".concat(r,"/").concat(p),c[p]));return Qa(t,r,c)}s(DMe,"FromRecord");function RMe(t,e,r,i){let n=ao(t,e);return Qa(t,r,tp(n,e,r,i))}s(RMe,"FromRef");function OMe(t,e,r,i){let n=ao(t,e);return Qa(t,r,tp(n,e,r,i))}s(OMe,"FromThis");function kMe(t,e,r,i){return Bn(i)&&Bn(t.items)?Qa(t,r,t.items.map((n,a)=>tp(n,e,"".concat(r,"/").concat(a),i[a]))):Qa(t,r,i)}s(kMe,"FromTuple");function NMe(t,e,r,i){for(let n of t.anyOf){if(!xa(n,e,i))continue;let a=tp(n,e,r,i);return Qa(t,r,a)}return Qa(t,r,i)}s(NMe,"FromUnion");function tp(t,e,r,i){let n=Iv(t,e),a=t;switch(t[br]){case"Array":return IMe(a,n,r,i);case"Intersect":return TMe(a,n,r,i);case"Not":return PMe(a,n,r,i);case"Object":return LMe(a,n,r,i);case"Record":return DMe(a,n,r,i);case"Ref":return RMe(a,n,r,i);case"Symbol":return Qa(a,r,i);case"This":return OMe(a,n,r,i);case"Tuple":return kMe(a,n,r,i);case"Union":return NMe(a,n,r,i);default:return Qa(a,r,i)}}s(tp,"Visit");function k4(t,e,r){return tp(t,e,"",r)}s(k4,"TransformDecode");N();var FMe=class extends Ca{constructor(e,r,i){super("The encoded value does not match the expected schema"),this.schema=e,this.value=r,this.error=i}};s(FMe,"TransformEncodeCheckError");var BMe=FMe,zMe=class extends Ca{constructor(e,r,i,n){super("".concat(n instanceof Error?n.message:"Unknown error")),this.schema=e,this.path=r,this.value=i,this.error=n}};s(zMe,"TransformEncodeError");var vV=zMe;function al(t,e,r){try{return io(t)?t[Du].Encode(r):r}catch(i){throw new vV(t,e,r,i)}}s(al,"Default");function UMe(t,e,r,i){let n=al(t,r,i);return Bn(n)?n.map((a,o)=>qh(t.items,e,"".concat(r,"/").concat(o),a)):n}s(UMe,"FromArray");function VMe(t,e,r,i){let n=al(t,r,i);if(!On(i)||od(i))return n;let a=aS(t),o=a.map(m=>m[0]),l=Ee({},n);for(let[m,y]of a)m in l&&(l[m]=qh(y,e,"".concat(r,"/").concat(m),l[m]));if(!io(t.unevaluatedProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.unevaluatedProperties,p=Ee({},l);for(let m of u)o.includes(m)||(p[m]=al(c,"".concat(r,"/").concat(m),p[m]));return p}s(VMe,"FromIntersect");function jMe(t,e,r,i){return al(t.not,r,al(t,r,i))}s(jMe,"FromNot");function $Me(t,e,r,i){let n=al(t,r,i);if(!On(n))return n;let a=Qh(t),o=Ee({},n);for(let p of a)Oi(o,p)&&(Hu(o[p])&&(!rS(t.properties[p])||Co.IsExactOptionalProperty(o,p))||(o[p]=qh(t.properties[p],e,"".concat(r,"/").concat(p),o[p])));if(!Gn(t.additionalProperties))return o;let l=Object.getOwnPropertyNames(o),u=t.additionalProperties,c=Ee({},o);for(let p of l)a.includes(p)||(c[p]=al(u,"".concat(r,"/").concat(p),c[p]));return c}s($Me,"FromObject");function GMe(t,e,r,i){let n=al(t,r,i);if(!On(i))return n;let a=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(a),l=Ee({},n);for(let m of Object.getOwnPropertyNames(i))o.test(m)&&(l[m]=qh(t.patternProperties[a],e,"".concat(r,"/").concat(m),l[m]));if(!Gn(t.additionalProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,p=Ee({},l);for(let m of u)o.test(m)||(p[m]=al(c,"".concat(r,"/").concat(m),p[m]));return p}s(GMe,"FromRecord");function HMe(t,e,r,i){let n=ao(t,e),a=qh(n,e,r,i);return al(t,r,a)}s(HMe,"FromRef");function qMe(t,e,r,i){let n=ao(t,e),a=qh(n,e,r,i);return al(t,r,a)}s(qMe,"FromThis");function WMe(t,e,r,i){let n=al(t,r,i);return Bn(t.items)?t.items.map((a,o)=>qh(a,e,"".concat(r,"/").concat(o),n[o])):[]}s(WMe,"FromTuple");function XMe(t,e,r,i){for(let n of t.anyOf){if(!xa(n,e,i))continue;let a=qh(n,e,r,i);return al(t,r,a)}for(let n of t.anyOf){let a=qh(n,e,r,i);if(xa(t,e,a))return al(t,r,a)}return al(t,r,i)}s(XMe,"FromUnion");function qh(t,e,r,i){let n=Iv(t,e),a=t;switch(t[br]){case"Array":return UMe(a,n,r,i);case"Intersect":return VMe(a,n,r,i);case"Not":return jMe(a,n,r,i);case"Object":return $Me(a,n,r,i);case"Record":return GMe(a,n,r,i);case"Ref":return HMe(a,n,r,i);case"This":return qMe(a,n,r,i);case"Tuple":return WMe(a,n,r,i);case"Union":return XMe(a,n,r,i);default:return al(a,r,i)}}s(qh,"Visit");function _V(t,e,r){return qh(t,e,"",r)}s(_V,"TransformEncode");N();function ZMe(t,e){return io(t)||Cs(t.items,e)}s(ZMe,"FromArray");function YMe(t,e){return io(t)||Cs(t.items,e)}s(YMe,"FromAsyncIterator");function KMe(t,e){return io(t)||Cs(t.returns,e)||t.parameters.some(r=>Cs(r,e))}s(KMe,"FromConstructor");function JMe(t,e){return io(t)||Cs(t.returns,e)||t.parameters.some(r=>Cs(r,e))}s(JMe,"FromFunction");function QMe(t,e){return io(t)||io(t.unevaluatedProperties)||t.allOf.some(r=>Cs(r,e))}s(QMe,"FromIntersect");function eEe(t,e){return io(t)||Cs(t.items,e)}s(eEe,"FromIterator");function tEe(t,e){return io(t)||Cs(t.not,e)}s(tEe,"FromNot");function rEe(t,e){return io(t)||Object.values(t.properties).some(r=>Cs(r,e))||Gn(t.additionalProperties)&&Cs(t.additionalProperties,e)}s(rEe,"FromObject");function iEe(t,e){return io(t)||Cs(t.item,e)}s(iEe,"FromPromise");function nEe(t,e){let r=Object.getOwnPropertyNames(t.patternProperties)[0],i=t.patternProperties[r];return io(t)||Cs(i,e)||Gn(t.additionalProperties)&&io(t.additionalProperties)}s(nEe,"FromRecord");function aEe(t,e){return io(t)?!0:Cs(ao(t,e),e)}s(aEe,"FromRef");function oEe(t,e){return io(t)?!0:Cs(ao(t,e),e)}s(oEe,"FromThis");function sEe(t,e){return io(t)||!Hu(t.items)&&t.items.some(r=>Cs(r,e))}s(sEe,"FromTuple");function lEe(t,e){return io(t)||t.anyOf.some(r=>Cs(r,e))}s(lEe,"FromUnion");function Cs(t,e){let r=Iv(t,e),i=t;if(t.$id&&Hk.has(t.$id))return!1;switch(t.$id&&Hk.add(t.$id),t[br]){case"Array":return ZMe(i,r);case"AsyncIterator":return YMe(i,r);case"Constructor":return KMe(i,r);case"Function":return JMe(i,r);case"Intersect":return QMe(i,r);case"Iterator":return eEe(i,r);case"Not":return tEe(i,r);case"Object":return rEe(i,r);case"Promise":return iEe(i,r);case"Record":return nEe(i,r);case"Ref":return aEe(i,r);case"This":return oEe(i,r);case"Tuple":return sEe(i,r);case"Union":return lEe(i,r);default:return io(t)}}s(Cs,"Visit");var Hk=new Set;function kx(t,e){return Hk.clear(),Cs(t,e)}s(kx,"HasTransform");function uEe(...t){let[e,r,i]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]];if(!xa(e,r,i))throw new EMe(e,i,Dx(e,r,i).First());return kx(e,r)?k4(e,r,i):i}s(uEe,"Decode");N();function sd(t,e){let r=Oi(t,"default")?t.default:void 0,i=KA(r)?r():Da(r);return Hu(e)?i:On(e)&&On(i)?Object.assign(i,e):e}s(sd,"ValueOrDefault");function S3(t){return xv(t)&&"default"in t}s(S3,"HasDefaultProperty");function cEe(t,e,r){let i=sd(t,r);if(!Bn(i))return i;for(let n=0;n<i.length;n++)i[n]=Ou(t.items,e,i[n]);return i}s(cEe,"FromArray");function hEe(t,e,r){return Mf(r)?r:sd(t,r)}s(hEe,"FromDate");function pEe(t,e,r){let i=sd(t,r);return t.allOf.reduce((n,a)=>{let o=Ou(a,e,i);return On(o)?Ee(Ee({},n),o):o},{})}s(pEe,"FromIntersect");function dEe(t,e,r){let i=sd(t,r);if(!On(i))return i;let n=Object.getOwnPropertyNames(t.properties);for(let a of n){let o=Ou(t.properties[a],e,i[a]);Hu(o)||(i[a]=Ou(t.properties[a],e,i[a]))}if(!S3(t.additionalProperties))return i;for(let a of Object.getOwnPropertyNames(i))n.includes(a)||(i[a]=Ou(t.additionalProperties,e,i[a]));return i}s(dEe,"FromObject");function fEe(t,e,r){let i=sd(t,r);if(!On(i))return i;let n=t.additionalProperties,[a,o]=Object.entries(t.patternProperties)[0],l=new RegExp(a);for(let u of Object.getOwnPropertyNames(i))l.test(u)&&S3(o)&&(i[u]=Ou(o,e,i[u]));if(!S3(n))return i;for(let u of Object.getOwnPropertyNames(i))l.test(u)||(i[u]=Ou(n,e,i[u]));return i}s(fEe,"FromRecord");function mEe(t,e,r){return Ou(ao(t,e),e,sd(t,r))}s(mEe,"FromRef");function gEe(t,e,r){return Ou(ao(t,e),e,r)}s(gEe,"FromThis");function yEe(t,e,r){let i=sd(t,r);if(!Bn(i)||Hu(t.items))return i;let[n,a]=[t.items,Math.max(t.items.length,i.length)];for(let o=0;o<a;o++)o<n.length&&(i[o]=Ou(n[o],e,i[o]));return i}s(yEe,"FromTuple");function vEe(t,e,r){let i=sd(t,r);for(let n of t.anyOf){let a=Ou(n,e,Da(i));if(xa(n,e,a))return a}return i}s(vEe,"FromUnion");function Ou(t,e,r){let i=Iv(t,e),n=t;switch(n[br]){case"Array":return cEe(n,i,r);case"Date":return hEe(n,i,r);case"Intersect":return pEe(n,i,r);case"Object":return dEe(n,i,r);case"Record":return fEe(n,i,r);case"Ref":return mEe(n,i,r);case"This":return gEe(n,i,r);case"Tuple":return yEe(n,i,r);case"Union":return vEe(n,i,r);default:return sd(n,r)}}s(Ou,"Visit");function xV(...t){return t.length===3?Ou(t[0],t[1],t[2]):Ou(t[0],[],t[1])}s(xV,"Default");N();N();var Wm={};kl(Wm,{Delete:()=>SEe,Format:()=>Nx,Get:()=>EEe,Has:()=>MEe,Set:()=>AEe,ValuePointerRootDeleteError:()=>wEe,ValuePointerRootSetError:()=>xEe});N();var _Ee=class extends Ca{constructor(e,r,i){super("Cannot set root value"),this.value=e,this.path=r,this.update=i}};s(_Ee,"ValuePointerRootSetError");var xEe=_Ee,bEe=class extends Ca{constructor(e,r){super("Cannot delete root value"),this.value=e,this.path=r}};s(bEe,"ValuePointerRootDeleteError");var wEe=bEe;function qk(t){return t.indexOf("~")===-1?t:t.replace(/~1/g,"/").replace(/~0/g,"~")}s(qk,"Escape");function*Nx(t){if(t==="")return;let[e,r]=[0,0];for(let i=0;i<t.length;i++)t.charAt(i)==="/"?(i===0||(r=i,yield qk(t.slice(e,r))),e=i+1):r=i;yield qk(t.slice(e))}s(Nx,"Format");function AEe(t,e,r){if(e==="")throw new xEe(t,e,r);let[i,n,a]=[null,t,""];for(let o of Nx(e))n[o]===void 0&&(n[o]={}),i=n,n=n[o],a=o;i[a]=r}s(AEe,"Set");function SEe(t,e){if(e==="")throw new wEe(t,e);let[r,i,n]=[null,t,""];for(let a of Nx(e)){if(i[a]===void 0||i[a]===null)return;r=i,i=i[a],n=a}if(Array.isArray(r)){let a=parseInt(n);r.splice(a,1)}else delete r[n]}s(SEe,"Delete");function MEe(t,e){if(e==="")return!0;let[r,i,n]=[null,t,""];for(let a of Nx(e)){if(i[a]===void 0)return!1;r=i,i=i[a],n=a}return Object.getOwnPropertyNames(r).includes(n)}s(MEe,"Has");function EEe(t,e){if(e==="")return t;let r=t;for(let i of Nx(e)){if(r[i]===void 0)return;r=r[i]}return r}s(EEe,"Get");N();function CEe(t,e){if(!On(e))return!1;let r=[...Object.keys(t),...Object.getOwnPropertySymbols(t)],i=[...Object.keys(e),...Object.getOwnPropertySymbols(e)];return r.length!==i.length?!1:r.every(n=>Fx(t[n],e[n]))}s(CEe,"ObjectType");function IEe(t,e){return Mf(e)&&t.getTime()===e.getTime()}s(IEe,"DateType");function TEe(t,e){return!Bn(e)||t.length!==e.length?!1:t.every((r,i)=>Fx(r,e[i]))}s(TEe,"ArrayType");function PEe(t,e){return!Ef(e)||t.length!==e.length||Object.getPrototypeOf(t).constructor.name!==Object.getPrototypeOf(e).constructor.name?!1:t.every((r,i)=>Fx(r,e[i]))}s(PEe,"TypedArrayType");function LEe(t,e){return t===e}s(LEe,"ValueType");function Fx(t,e){if(Mf(t))return IEe(t,e);if(Ef(t))return PEe(t,e);if(Bn(t))return TEe(t,e);if(On(t))return CEe(t,e);if(od(t))return LEe(t,e);throw new Error("ValueEquals: Unable to compare value")}s(Fx,"Equal");var vZe=js({type:To("insert"),path:xf(),value:Ex()}),_Ze=js({type:To("update"),path:xf(),value:Ex()}),xZe=js({type:To("delete"),path:xf()}),bZe=Fl([vZe,_Ze,xZe]),DEe=class extends Ca{constructor(e,r){super(r),this.value=e}};s(DEe,"ValueDiffError");var REe=DEe;function pS(t,e){return{type:"update",path:t,value:e}}s(pS,"CreateUpdate");function bV(t,e){return{type:"insert",path:t,value:e}}s(bV,"CreateInsert");function wV(t){return{type:"delete",path:t}}s(wV,"CreateDelete");function Wk(t){if(globalThis.Object.getOwnPropertySymbols(t).length>0)throw new REe(t,"Cannot diff objects with symbols")}s(Wk,"AssertDiffable");function*OEe(t,e,r){if(Wk(e),Wk(r),!Iz(r))return yield pS(t,r);let i=globalThis.Object.getOwnPropertyNames(e),n=globalThis.Object.getOwnPropertyNames(r);for(let a of n)Oi(e,a)||(yield bV("".concat(t,"/").concat(a),r[a]));for(let a of i)Oi(r,a)&&(Fx(e,r)||(yield*vr(dS("".concat(t,"/").concat(a),e[a],r[a]))));for(let a of i)Oi(r,a)||(yield wV("".concat(t,"/").concat(a)))}s(OEe,"ObjectType");function*kEe(t,e,r){if(!Bn(r))return yield pS(t,r);for(let i=0;i<Math.min(e.length,r.length);i++)yield*vr(dS("".concat(t,"/").concat(i),e[i],r[i]));for(let i=0;i<r.length;i++)i<e.length||(yield bV("".concat(t,"/").concat(i),r[i]));for(let i=e.length-1;i>=0;i--)i<r.length||(yield wV("".concat(t,"/").concat(i)))}s(kEe,"ArrayType");function*NEe(t,e,r){if(!Ef(r)||e.length!==r.length||globalThis.Object.getPrototypeOf(e).constructor.name!==globalThis.Object.getPrototypeOf(r).constructor.name)return yield pS(t,r);for(let i=0;i<Math.min(e.length,r.length);i++)yield*vr(dS("".concat(t,"/").concat(i),e[i],r[i]))}s(NEe,"TypedArrayType");function*FEe(t,e,r){e!==r&&(yield pS(t,r))}s(FEe,"ValueType");function*dS(t,e,r){if(Iz(e))return yield*vr(OEe(t,e,r));if(Bn(e))return yield*vr(kEe(t,e,r));if(Ef(e))return yield*vr(NEe(t,e,r));if(od(e))return yield*vr(FEe(t,e,r));throw new REe(e,"Unable to diff value")}s(dS,"Visit");function BEe(t,e){return[...dS("",t,e)]}s(BEe,"Diff");function zEe(t){return t.length>0&&t[0].path===""&&t[0].type==="update"}s(zEe,"IsRootUpdate");function UEe(t){return t.length===0}s(UEe,"IsIdentity");function VEe(t,e){if(zEe(e))return Da(e[0].value);if(UEe(e))return Da(t);let r=Da(t);for(let i of e)switch(i.type){case"insert":{Wm.Set(r,i.path,i.value);break}case"update":{Wm.Set(r,i.path,i.value);break}case"delete":{Wm.Delete(r,i.path);break}}return r}s(VEe,"Patch");N();function jEe(...t){let[e,r,i]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]],n=kx(e,r)?_V(e,r,i):i;if(!xa(e,r,n))throw new BMe(e,n,Dx(e,r,n).First());return n}s(jEe,"Encode");N();var $Ee=class extends Ca{constructor(e){super(e)}};s($Ee,"ValueMutateError");var kW=$Ee;function GEe(t,e,r,i){if(!On(r))Wm.Set(t,e,Da(i));else{let n=Object.getOwnPropertyNames(r),a=Object.getOwnPropertyNames(i);for(let o of n)a.includes(o)||delete r[o];for(let o of a)n.includes(o)||(r[o]=null);for(let o of a)N4(t,"".concat(e,"/").concat(o),r[o],i[o])}}s(GEe,"ObjectType");function HEe(t,e,r,i){if(!Bn(r))Wm.Set(t,e,Da(i));else{for(let n=0;n<i.length;n++)N4(t,"".concat(e,"/").concat(n),r[n],i[n]);r.splice(i.length)}}s(HEe,"ArrayType");function qEe(t,e,r,i){if(Ef(r)&&r.length===i.length)for(let n=0;n<r.length;n++)r[n]=i[n];else Wm.Set(t,e,Da(i))}s(qEe,"TypedArrayType");function WEe(t,e,r,i){r!==i&&Wm.Set(t,e,i)}s(WEe,"ValueType");function N4(t,e,r,i){if(Bn(i))return HEe(t,e,r,i);if(Ef(i))return qEe(t,e,r,i);if(On(i))return GEe(t,e,r,i);if(od(i))return WEe(t,e,r,i)}s(N4,"Visit");function Xk(t){return Ef(t)||od(t)}s(Xk,"IsNonMutableValue");function XEe(t,e){return On(t)&&Bn(e)||Bn(t)&&On(e)}s(XEe,"IsMismatchedValue");function ZEe(t,e){if(Xk(t)||Xk(e))throw new kW("Only object and array types can be mutated at the root level");if(XEe(t,e))throw new kW("Cannot assign due type mismatch of assignable values");N4(t,"",t,e)}s(ZEe,"Mutate");N();var wZe=[(t,e,r)=>Da(r),(t,e,r)=>xV(t,e,r),(t,e,r)=>pV(t,e,r),(t,e,r)=>gV(t,e,r),(t,e,r)=>(cV(t,e,r),r),(t,e,r)=>kx(t,e)?k4(t,e,r):r];function Zk(t,e,r){return wZe.reduce((i,n)=>n(t,e,i),r)}s(Zk,"ParseValue");function YEe(...t){return t.length===3?Zk(t[0],t[1],t[2]):Zk(t[0],[],t[1])}s(YEe,"Parse");N();var M3={};kl(M3,{Assert:()=>cV,Cast:()=>hV,Check:()=>xa,Clean:()=>pV,Clone:()=>Da,Convert:()=>gV,Create:()=>$h,Decode:()=>uEe,Default:()=>xV,Diff:()=>BEe,Edit:()=>bZe,Encode:()=>jEe,Equal:()=>Fx,Errors:()=>Dx,Hash:()=>cS,Mutate:()=>ZEe,Parse:()=>YEe,Patch:()=>VEe,ValueErrorIterator:()=>Lx});N();N();var KEe=class extends Ca{constructor(e){super("Unable to dereference schema with $id '".concat(e.$ref,"'")),$(this,"schema"),this.schema=e}};s(KEe,"TypeDereferenceError");var AZe=KEe;function JEe(t,e){let r=e.find(i=>i.$id===t.$ref);if(r===void 0)throw new AZe(t);return Bx(r,e)}s(JEe,"Resolve");function AV(t,e){return!Va.IsString(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}s(AV,"Pushref");function Bx(t,e){return t[br]==="This"||t[br]==="Ref"?JEe(t,e):t}s(Bx,"Deref");N();function QEe(t,e,r){let i=t.get(e);if(i!==void 0)return i;let n=kx(e,r);return t.set(e,n),n}s(QEe,"HasTransformCached");function SV(){let t=new WeakMap;return{HasTransform:s((e,r)=>QEe(t,e,r),"HasTransform")}}s(SV,"CreateTransformCache");function eo(t,e,r){try{return it.IsTransform(t)?t[Du].Decode(r):r}catch(i){throw new yV(t,e,r,i)}}s(eo,"Default");function eCe(t,e,r,i,n){return Va.IsArray(i)?eo(t,r,i.map((a,o)=>rp(t.items,e,"".concat(r,"/").concat(o),a,n))):eo(t,r,i)}s(eCe,"FromArray");function tCe(t,e,r,i,n){if(!Va.IsObject(i)||od(i))return eo(t,r,i);let a=aS(t),o=a.map(m=>m[0]),l=Ee({},i);for(let[m,y]of a)m in l&&(l[m]=rp(y,e,"".concat(r,"/").concat(m),l[m],n));if(!it.IsTransform(t.unevaluatedProperties))return eo(t,r,l);let u=Object.getOwnPropertyNames(l),c=t.unevaluatedProperties,p=Ee({},l);for(let m of u)o.includes(m)||(p[m]=eo(c,"".concat(r,"/").concat(m),p[m]));return eo(t,r,p)}s(tCe,"FromIntersect");function rCe(t,e,r,i,n){return eo(t,r,rp(t.not,e,r,i,n))}s(rCe,"FromNot");function iCe(t,e,r,i,n){if(!Va.IsObject(i))return eo(t,r,i);let a=Qh(t),o=Ee({},i);for(let p of a)Va.HasPropertyKey(o,p)&&(Va.IsUndefined(o[p])&&(!it.IsUndefined(t.properties[p])||Co.IsExactOptionalProperty(o,p))||(o[p]=rp(t.properties[p],e,"".concat(r,"/").concat(p),o[p],n)));if(!it.IsSchema(t.additionalProperties))return eo(t,r,o);let l=Object.getOwnPropertyNames(o),u=t.additionalProperties,c=Ee({},o);for(let p of l)a.includes(p)||(c[p]=eo(u,"".concat(r,"/").concat(p),c[p]));return eo(t,r,c)}s(iCe,"FromObject");function nCe(t,e,r,i,n){if(!Va.IsObject(i))return eo(t,r,i);let a=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(a),l=Ee({},i);for(let m of Object.getOwnPropertyNames(i))o.test(m)&&(l[m]=rp(t.patternProperties[a],e,"".concat(r,"/").concat(m),l[m],n));if(!it.IsSchema(t.additionalProperties))return eo(t,r,l);let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,p=Ee({},l);for(let m of u)o.test(m)||(p[m]=eo(c,"".concat(r,"/").concat(m),p[m]));return eo(t,r,p)}s(nCe,"FromRecord");function aCe(t,e,r,i,n){let a=Bx(t,e);return eo(t,r,rp(a,e,r,i,n))}s(aCe,"FromRef");function oCe(t,e,r,i,n){let a=Bx(t,e);return eo(t,r,rp(a,e,r,i,n))}s(oCe,"FromThis");function sCe(t,e,r,i,n){return Va.IsArray(i)&&Va.IsArray(t.items)?eo(t,r,t.items.map((a,o)=>rp(a,e,"".concat(r,"/").concat(o),i[o],n))):eo(t,r,i)}s(sCe,"FromTuple");function lCe(t,e,r,i,n){for(let a of t.anyOf){if(!M3.Check(a,e,i))continue;let o=rp(a,e,r,i,n);return eo(t,r,o)}return eo(t,r,i)}s(lCe,"FromUnion");function rp(t,e,r,i,n){if(!n.HasTransform(t,e))return i;let a=AV(t,e),o=t;switch(t[br]){case"Array":return eCe(o,a,r,i,n);case"Intersect":return tCe(o,a,r,i,n);case"Not":return rCe(o,a,r,i,n);case"Object":return iCe(o,a,r,i,n);case"Record":return nCe(o,a,r,i,n);case"Ref":return aCe(o,a,r,i,n);case"Symbol":return eo(o,r,i);case"This":return oCe(o,a,r,i,n);case"Tuple":return sCe(o,a,r,i,n);case"Union":return lCe(o,a,r,i,n);default:return eo(o,r,i)}}s(rp,"Visit");function uCe(t,e,r){let i=SV();return rp(t,e,"",r,i)}s(uCe,"FastTransformDecode");N();function ol(t,e,r){try{return it.IsTransform(t)?t[Du].Encode(r):r}catch(i){throw new vV(t,e,r,i)}}s(ol,"Default");function cCe(t,e,r,i,n){let a=ol(t,r,i);return Va.IsArray(a)?a.map((o,l)=>Wh(t.items,e,"".concat(r,"/").concat(l),o,n)):a}s(cCe,"FromArray");function hCe(t,e,r,i,n){let a=ol(t,r,i);if(!Va.IsObject(i)||od(i))return a;let o=aS(t),l=o.map(y=>y[0]),u=Ee({},a);for(let[y,v]of o)y in u&&(u[y]=Wh(v,e,"".concat(r,"/").concat(y),u[y],n));if(!it.IsTransform(t.unevaluatedProperties))return u;let c=Object.getOwnPropertyNames(u),p=t.unevaluatedProperties,m=Ee({},u);for(let y of c)l.includes(y)||(m[y]=ol(p,"".concat(r,"/").concat(y),m[y]));return m}s(hCe,"FromIntersect");function pCe(t,e,r,i){return ol(t.not,r,ol(t,r,i))}s(pCe,"FromNot");function dCe(t,e,r,i,n){let a=ol(t,r,i);if(!Va.IsObject(a))return a;let o=Qh(t),l=Ee({},a);for(let m of o)Va.HasPropertyKey(l,m)&&(Va.IsUndefined(l[m])&&(!it.IsUndefined(t.properties[m])||Co.IsExactOptionalProperty(l,m))||(l[m]=Wh(t.properties[m],e,"".concat(r,"/").concat(m),l[m],n)));if(!it.IsSchema(t.additionalProperties))return l;let u=Object.getOwnPropertyNames(l),c=t.additionalProperties,p=Ee({},l);for(let m of u)o.includes(m)||(p[m]=ol(c,"".concat(r,"/").concat(m),p[m]));return p}s(dCe,"FromObject");function fCe(t,e,r,i,n){let a=ol(t,r,i);if(!Va.IsObject(i))return a;let o=Object.getOwnPropertyNames(t.patternProperties)[0],l=new RegExp(o),u=Ee({},a);for(let y of Object.getOwnPropertyNames(i))l.test(y)&&(u[y]=Wh(t.patternProperties[o],e,"".concat(r,"/").concat(y),u[y],n));if(!it.IsSchema(t.additionalProperties))return u;let c=Object.getOwnPropertyNames(u),p=t.additionalProperties,m=Ee({},u);for(let y of c)l.test(y)||(m[y]=ol(p,"".concat(r,"/").concat(y),m[y]));return m}s(fCe,"FromRecord");function mCe(t,e,r,i,n){let a=Bx(t,e),o=Wh(a,e,r,i,n);return ol(t,r,o)}s(mCe,"FromRef");function gCe(t,e,r,i,n){let a=Bx(t,e),o=Wh(a,e,r,i,n);return ol(t,r,o)}s(gCe,"FromThis");function yCe(t,e,r,i,n){let a=ol(t,r,i);return Va.IsArray(t.items)?t.items.map((o,l)=>Wh(o,e,"".concat(r,"/").concat(l),a[l],n)):[]}s(yCe,"FromTuple");function vCe(t,e,r,i,n){for(let a of t.anyOf){if(!M3.Check(a,e,i))continue;let o=Wh(a,e,r,i,n);return ol(t,r,o)}for(let a of t.anyOf){let o=Wh(a,e,r,i,n);if(M3.Check(t,e,o))return ol(t,r,o)}return ol(t,r,i)}s(vCe,"FromUnion");function Wh(t,e,r,i,n){if(!n.HasTransform(t,e))return i;let a=AV(t,e),o=t;switch(t[br]){case"Array":return cCe(o,a,r,i,n);case"Intersect":return hCe(o,a,r,i,n);case"Not":return pCe(o,a,r,i);case"Object":return dCe(o,a,r,i,n);case"Record":return fCe(o,a,r,i,n);case"Ref":return mCe(o,a,r,i,n);case"This":return gCe(o,a,r,i,n);case"Tuple":return yCe(o,a,r,i,n);case"Union":return vCe(o,a,r,i,n);default:return ol(o,r,i)}}s(Wh,"Visit");function _Ce(t,e,r){let i=SV();return Wh(t,e,"",r,i)}s(_Ce,"FastTransformEncode");N();var xCe=class{constructor(e,r,i,n){this.schema=e,this.references=r,this.checkFunc=i,this.code=n,this.hasTransform=kx(e,r)}Code(){return this.code}Errors(e){return Dx(this.schema,this.references,e)}Check(e){return this.checkFunc(e)}Decode(e){if(!this.checkFunc(e))throw new EMe(this.schema,e,this.Errors(e).First());return this.hasTransform?k4(this.schema,this.references,e):e}Encode(e){let r=this.hasTransform?_V(this.schema,this.references,e):e;if(!this.checkFunc(r))throw new BMe(this.schema,e,this.Errors(e).First());return r}};s(xCe,"TypeCheck");var SZe=xCe,nf;(function(t){function e(a){return a===36}s(e,"DollarSign"),t.DollarSign=e;function r(a){return a===95}s(r,"IsUnderscore"),t.IsUnderscore=r;function i(a){return a>=65&&a<=90||a>=97&&a<=122}s(i,"IsAlpha"),t.IsAlpha=i;function n(a){return a>=48&&a<=57}s(n,"IsNumeric"),t.IsNumeric=n})(nf||(nf={}));var E3;(function(t){function e(a){return a.length===0?!1:nf.IsNumeric(a.charCodeAt(0))}s(e,"IsFirstCharacterNumeric");function r(a){if(e(a))return!1;for(let o=0;o<a.length;o++){let l=a.charCodeAt(o);if(!(nf.IsAlpha(l)||nf.IsNumeric(l)||nf.DollarSign(l)||nf.IsUnderscore(l)))return!1}return!0}s(r,"IsAccessor");function i(a){return a.replace(/'/g,"\\'")}s(i,"EscapeHyphen");function n(a,o){return r(o)?"".concat(a,".").concat(o):"".concat(a,"['").concat(i(o),"']")}s(n,"Encode"),t.Encode=n})(E3||(E3={}));var Yk;(function(t){function e(r){let i=[];for(let n=0;n<r.length;n++){let a=r.charCodeAt(n);nf.IsNumeric(a)||nf.IsAlpha(a)?i.push(r.charAt(n)):i.push("_".concat(a,"_"))}return i.join("").replace(/__/g,"_")}s(e,"Encode"),t.Encode=e})(Yk||(Yk={}));var Kk;(function(t){function e(r){return r.replace(/'/g,"\\'")}s(e,"Escape"),t.Escape=e})(Kk||(Kk={}));var bCe=class extends Ca{constructor(e){super("Unknown type"),this.schema=e}};s(bCe,"TypeCompilerUnknownTypeError");var MZe=bCe,wCe=class extends Ca{constructor(e){super("Preflight validation check failed to guard for the given schema"),this.schema=e}};s(wCe,"TypeCompilerTypeGuardError");var NW=wCe,yy;(function(t){function e(o,l,u){return Co.ExactOptionalPropertyTypes?"('".concat(l,"' in ").concat(o," ? ").concat(u," : true)"):"(".concat(E3.Encode(o,l)," !== undefined ? ").concat(u," : true)")}s(e,"IsExactOptionalProperty"),t.IsExactOptionalProperty=e;function r(o){return Co.AllowArrayObject?"(typeof ".concat(o," === 'object' && ").concat(o," !== null)"):"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !Array.isArray(").concat(o,"))")}s(r,"IsObjectLike"),t.IsObjectLike=r;function i(o){return Co.AllowArrayObject?"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !(").concat(o," instanceof Date) && !(").concat(o," instanceof Uint8Array))"):"(typeof ".concat(o," === 'object' && ").concat(o," !== null && !Array.isArray(").concat(o,") && !(").concat(o," instanceof Date) && !(").concat(o," instanceof Uint8Array))")}s(i,"IsRecordLike"),t.IsRecordLike=i;function n(o){return Co.AllowNaN?"typeof ".concat(o," === 'number'"):"Number.isFinite(".concat(o,")")}s(n,"IsNumberLike"),t.IsNumberLike=n;function a(o){return Co.AllowNullVoid?"(".concat(o," === undefined || ").concat(o," === null)"):"".concat(o," === undefined")}s(a,"IsVoidLike"),t.IsVoidLike=a})(yy||(yy={}));var Jk;(function(t){function e(fe){return fe[br]==="Any"||fe[br]==="Unknown"}s(e,"IsAnyOrUnknown");function*r(fe,Re,me){yield"true"}s(r,"FromAny");function*i(fe,Re,me){yield"Array.isArray(".concat(me,")");let[Ae,Ue]=[re("value","any"),re("acc","number")];xi(fe.maxItems)&&(yield"".concat(me,".length <= ").concat(fe.maxItems)),xi(fe.minItems)&&(yield"".concat(me,".length >= ").concat(fe.minItems));let _e=ee(fe.items,Re,"value");if(yield"".concat(me,".every((").concat(Ae,") => ").concat(_e,")"),Gn(fe.contains)||xi(fe.minContains)||xi(fe.maxContains)){let lt=Gn(fe.contains)?fe.contains:ul(),tt=ee(lt,Re,"value"),We=xi(fe.minContains)?["(count >= ".concat(fe.minContains,")")]:[],at=xi(fe.maxContains)?["(count <= ".concat(fe.maxContains,")")]:[],Lt="const count = value.reduce((".concat(Ue,", ").concat(Ae,") => ").concat(tt," ? acc + 1 : acc, 0)"),dt=["(count > 0)",...We,...at].join(" && ");yield"((".concat(Ae,") => { ").concat(Lt,"; return ").concat(dt,"})(").concat(me,")")}if(fe.uniqueItems===!0){let lt="const set = new Set(); for(const element of value) { ".concat("const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true"," }");yield"((".concat(Ae,") => { ").concat(lt," )(").concat(me,")")}}s(i,"FromArray");function*n(fe,Re,me){yield"(typeof value === 'object' && Symbol.asyncIterator in ".concat(me,")")}s(n,"FromAsyncIterator");function*a(fe,Re,me){yield"(typeof ".concat(me," === 'bigint')"),fc(fe.exclusiveMaximum)&&(yield"".concat(me," < BigInt(").concat(fe.exclusiveMaximum,")")),fc(fe.exclusiveMinimum)&&(yield"".concat(me," > BigInt(").concat(fe.exclusiveMinimum,")")),fc(fe.maximum)&&(yield"".concat(me," <= BigInt(").concat(fe.maximum,")")),fc(fe.minimum)&&(yield"".concat(me," >= BigInt(").concat(fe.minimum,")")),fc(fe.multipleOf)&&(yield"(".concat(me," % BigInt(").concat(fe.multipleOf,")) === 0"))}s(a,"FromBigInt");function*o(fe,Re,me){yield"(typeof ".concat(me," === 'boolean')")}s(o,"FromBoolean");function*l(fe,Re,me){yield*vr(J(fe.returns,Re,"".concat(me,".prototype")))}s(l,"FromConstructor");function*u(fe,Re,me){yield"(".concat(me," instanceof Date) && Number.isFinite(").concat(me,".getTime())"),xi(fe.exclusiveMaximumTimestamp)&&(yield"".concat(me,".getTime() < ").concat(fe.exclusiveMaximumTimestamp)),xi(fe.exclusiveMinimumTimestamp)&&(yield"".concat(me,".getTime() > ").concat(fe.exclusiveMinimumTimestamp)),xi(fe.maximumTimestamp)&&(yield"".concat(me,".getTime() <= ").concat(fe.maximumTimestamp)),xi(fe.minimumTimestamp)&&(yield"".concat(me,".getTime() >= ").concat(fe.minimumTimestamp)),xi(fe.multipleOfTimestamp)&&(yield"(".concat(me,".getTime() % ").concat(fe.multipleOfTimestamp,") === 0"))}s(u,"FromDate");function*c(fe,Re,me){yield"(typeof ".concat(me," === 'function')")}s(c,"FromFunction");function*p(fe,Re,me){yield"Number.isInteger(".concat(me,")"),xi(fe.exclusiveMaximum)&&(yield"".concat(me," < ").concat(fe.exclusiveMaximum)),xi(fe.exclusiveMinimum)&&(yield"".concat(me," > ").concat(fe.exclusiveMinimum)),xi(fe.maximum)&&(yield"".concat(me," <= ").concat(fe.maximum)),xi(fe.minimum)&&(yield"".concat(me," >= ").concat(fe.minimum)),xi(fe.multipleOf)&&(yield"(".concat(me," % ").concat(fe.multipleOf,") === 0"))}s(p,"FromInteger");function*m(fe,Re,me){let Ae=fe.allOf.map(Ue=>ee(Ue,Re,me)).join(" && ");if(fe.unevaluatedProperties===!1){let Ue=K("".concat(new RegExp(ev(fe)),";")),_e="Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(Ue,".test(key))");yield"(".concat(Ae," && ").concat(_e,")")}else if(Gn(fe.unevaluatedProperties)){let Ue=K("".concat(new RegExp(ev(fe)),";")),_e="Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(Ue,".test(key) || ").concat(ee(fe.unevaluatedProperties,Re,"".concat(me,"[key]")),")");yield"(".concat(Ae," && ").concat(_e,")")}else yield"(".concat(Ae,")")}s(m,"FromIntersect");function*y(fe,Re,me){yield"(typeof value === 'object' && Symbol.iterator in ".concat(me,")")}s(y,"FromIterator");function*v(fe,Re,me){typeof fe.const=="number"||typeof fe.const=="boolean"?yield"(".concat(me," === ").concat(fe.const,")"):yield"(".concat(me," === '").concat(Kk.Escape(fe.const),"')")}s(v,"FromLiteral");function*x(fe,Re,me){yield"false"}s(x,"FromNever");function*E(fe,Re,me){let Ae=ee(fe.not,Re,me);yield"(!".concat(Ae,")")}s(E,"FromNot");function*M(fe,Re,me){yield"(".concat(me," === null)")}s(M,"FromNull");function*I(fe,Re,me){yield yy.IsNumberLike(me),xi(fe.exclusiveMaximum)&&(yield"".concat(me," < ").concat(fe.exclusiveMaximum)),xi(fe.exclusiveMinimum)&&(yield"".concat(me," > ").concat(fe.exclusiveMinimum)),xi(fe.maximum)&&(yield"".concat(me," <= ").concat(fe.maximum)),xi(fe.minimum)&&(yield"".concat(me," >= ").concat(fe.minimum)),xi(fe.multipleOf)&&(yield"(".concat(me," % ").concat(fe.multipleOf,") === 0"))}s(I,"FromNumber");function*P(fe,Re,me){yield yy.IsObjectLike(me),xi(fe.minProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length >= ").concat(fe.minProperties)),xi(fe.maxProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length <= ").concat(fe.maxProperties));let Ae=Object.getOwnPropertyNames(fe.properties);for(let Ue of Ae){let _e=E3.Encode(me,Ue),lt=fe.properties[Ue];if(fe.required&&fe.required.includes(Ue))yield*vr(J(lt,Re,_e)),(Sv(lt)||e(lt))&&(yield"('".concat(Ue,"' in ").concat(me,")"));else{let tt=ee(lt,Re,_e);yield yy.IsExactOptionalProperty(me,Ue,tt)}}if(fe.additionalProperties===!1)if(fe.required&&fe.required.length===Ae.length)yield"Object.getOwnPropertyNames(".concat(me,").length === ").concat(Ae.length);else{let Ue="[".concat(Ae.map(_e=>"'".concat(_e,"'")).join(", "),"]");yield"Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(Ue,".includes(key))")}if(typeof fe.additionalProperties=="object"){let Ue=ee(fe.additionalProperties,Re,"".concat(me,"[key]")),_e="[".concat(Ae.map(lt=>"'".concat(lt,"'")).join(", "),"]");yield"(Object.getOwnPropertyNames(".concat(me,").every(key => ").concat(_e,".includes(key) || ").concat(Ue,"))")}}s(P,"FromObject");function*C(fe,Re,me){yield"(typeof value === 'object' && typeof ".concat(me,".then === 'function')")}s(C,"FromPromise");function*T(fe,Re,me){yield yy.IsRecordLike(me),xi(fe.minProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length >= ").concat(fe.minProperties)),xi(fe.maxProperties)&&(yield"Object.getOwnPropertyNames(".concat(me,").length <= ").concat(fe.maxProperties));let[Ae,Ue]=Object.entries(fe.patternProperties)[0],_e=K("".concat(new RegExp(Ae))),lt=ee(Ue,Re,"value"),tt=Gn(fe.additionalProperties)?ee(fe.additionalProperties,Re,me):fe.additionalProperties===!1?"false":"true",We="(".concat(_e,".test(key) ? ").concat(lt," : ").concat(tt,")");yield"(Object.entries(".concat(me,").every(([key, value]) => ").concat(We,"))")}s(T,"FromRecord");function*D(fe,Re,me){let Ae=ao(fe,Re);if(ne.functions.has(fe.$ref))return yield"".concat(ue(fe.$ref),"(").concat(me,")");yield*vr(J(Ae,Re,me))}s(D,"FromRef");function*F(fe,Re,me){let Ae=K("".concat(new RegExp(fe.source,fe.flags),";"));yield"(typeof ".concat(me," === 'string')"),xi(fe.maxLength)&&(yield"".concat(me,".length <= ").concat(fe.maxLength)),xi(fe.minLength)&&(yield"".concat(me,".length >= ").concat(fe.minLength)),yield"".concat(Ae,".test(").concat(me,")")}s(F,"FromRegExp");function*k(fe,Re,me){if(yield"(typeof ".concat(me," === 'string')"),xi(fe.maxLength)&&(yield"".concat(me,".length <= ").concat(fe.maxLength)),xi(fe.minLength)&&(yield"".concat(me,".length >= ").concat(fe.minLength)),fe.pattern!==void 0){let Ae=K("".concat(new RegExp(fe.pattern),";"));yield"".concat(Ae,".test(").concat(me,")")}fe.format!==void 0&&(yield"format('".concat(fe.format,"', ").concat(me,")"))}s(k,"FromString");function*B(fe,Re,me){yield"(typeof ".concat(me," === 'symbol')")}s(B,"FromSymbol");function*U(fe,Re,me){yield"(typeof ".concat(me," === 'string')");let Ae=K("".concat(new RegExp(fe.pattern),";"));yield"".concat(Ae,".test(").concat(me,")")}s(U,"FromTemplateLiteral");function*z(fe,Re,me){yield"".concat(ue(fe.$ref),"(").concat(me,")")}s(z,"FromThis");function*q(fe,Re,me){if(yield"Array.isArray(".concat(me,")"),fe.items===void 0)return yield"".concat(me,".length === 0");yield"(".concat(me,".length === ").concat(fe.maxItems,")");for(let Ae=0;Ae<fe.items.length;Ae++){let Ue=ee(fe.items[Ae],Re,"".concat(me,"[").concat(Ae,"]"));yield"".concat(Ue)}}s(q,"FromTuple");function*Z(fe,Re,me){yield"".concat(me," === undefined")}s(Z,"FromUndefined");function*Q(fe,Re,me){let Ae=fe.anyOf.map(Ue=>ee(Ue,Re,me));yield"(".concat(Ae.join(" || "),")")}s(Q,"FromUnion");function*V(fe,Re,me){yield"".concat(me," instanceof Uint8Array"),xi(fe.maxByteLength)&&(yield"(".concat(me,".length <= ").concat(fe.maxByteLength,")")),xi(fe.minByteLength)&&(yield"(".concat(me,".length >= ").concat(fe.minByteLength,")"))}s(V,"FromUint8Array");function*ae(fe,Re,me){yield"true"}s(ae,"FromUnknown");function*Y(fe,Re,me){yield yy.IsVoidLike(me)}s(Y,"FromVoid");function*he(fe,Re,me){let Ae=ne.instances.size;ne.instances.set(Ae,fe),yield"kind('".concat(fe[br],"', ").concat(Ae,", ").concat(me,")")}s(he,"FromKind");function*J(fe,Re,me,Ae=!0){let Ue=va(fe.$id)?[...Re,fe]:Re,_e=fe;if(Ae&&va(fe.$id)){let lt=ue(fe.$id);if(ne.functions.has(lt))return yield"".concat(lt,"(").concat(me,")");{let tt=ce(lt,fe,Re,"value",!1);return ne.functions.set(lt,tt),yield"".concat(lt,"(").concat(me,")")}}switch(_e[br]){case"Any":return yield*vr(r());case"Array":return yield*vr(i(_e,Ue,me));case"AsyncIterator":return yield*vr(n(_e,Ue,me));case"BigInt":return yield*vr(a(_e,Ue,me));case"Boolean":return yield*vr(o(_e,Ue,me));case"Constructor":return yield*vr(l(_e,Ue,me));case"Date":return yield*vr(u(_e,Ue,me));case"Function":return yield*vr(c(_e,Ue,me));case"Integer":return yield*vr(p(_e,Ue,me));case"Intersect":return yield*vr(m(_e,Ue,me));case"Iterator":return yield*vr(y(_e,Ue,me));case"Literal":return yield*vr(v(_e,Ue,me));case"Never":return yield*vr(x());case"Not":return yield*vr(E(_e,Ue,me));case"Null":return yield*vr(M(_e,Ue,me));case"Number":return yield*vr(I(_e,Ue,me));case"Object":return yield*vr(P(_e,Ue,me));case"Promise":return yield*vr(C(_e,Ue,me));case"Record":return yield*vr(T(_e,Ue,me));case"Ref":return yield*vr(D(_e,Ue,me));case"RegExp":return yield*vr(F(_e,Ue,me));case"String":return yield*vr(k(_e,Ue,me));case"Symbol":return yield*vr(B(_e,Ue,me));case"TemplateLiteral":return yield*vr(U(_e,Ue,me));case"This":return yield*vr(z(_e,Ue,me));case"Tuple":return yield*vr(q(_e,Ue,me));case"Undefined":return yield*vr(Z(_e,Ue,me));case"Union":return yield*vr(Q(_e,Ue,me));case"Uint8Array":return yield*vr(V(_e,Ue,me));case"Unknown":return yield*vr(ae());case"Void":return yield*vr(Y(_e,Ue,me));default:if(!rh.Has(_e[br]))throw new MZe(fe);return yield*vr(he(_e,Ue,me))}}s(J,"Visit");let ne={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function ee(fe,Re,me,Ae=!0){return"(".concat([...J(fe,Re,me,Ae)].join(" && "),")")}s(ee,"CreateExpression");function ue(fe){return"check_".concat(Yk.Encode(fe))}s(ue,"CreateFunctionName");function K(fe){let Re="local_".concat(ne.variables.size);return ne.variables.set(Re,"const ".concat(Re," = ").concat(fe)),Re}s(K,"CreateVariable");function ce(fe,Re,me,Ae,Ue=!0){let[_e,lt]=[`
`,Lt=>"".padStart(Lt," ")],tt=re("value","any"),We=se("boolean"),at=[...J(Re,me,Ae,Ue)].map(Lt=>"".concat(lt(4)).concat(Lt)).join(" &&".concat(_e));return"function ".concat(fe,"(").concat(tt,")").concat(We," {").concat(_e).concat(lt(2),"return (").concat(_e).concat(at).concat(_e).concat(lt(2),`)
}`)}s(ce,"CreateFunction");function re(fe,Re){let me=ne.language==="typescript"?": ".concat(Re):"";return"".concat(fe).concat(me)}s(re,"CreateParameter");function se(fe){return ne.language==="typescript"?": ".concat(fe):""}s(se,"CreateReturns");function de(fe,Re,me){let Ae=ce("check",fe,Re,"value"),Ue=re("value","any"),_e=se("boolean"),lt=[...ne.functions.values()],tt=[...ne.variables.values()],We=va(fe.$id)?"return function check(".concat(Ue,")").concat(_e,` {
  return `).concat(ue(fe.$id),`(value)
}`):"return ".concat(Ae);return[...tt,...lt,We].join(`
`)}s(de,"Build");function we(...fe){let Re={language:"javascript"},[me,Ae,Ue]=fe.length===2&&Bn(fe[1])?[fe[0],fe[1],Re]:fe.length===2&&!Bn(fe[1])?[fe[0],[],fe[1]]:fe.length===3?[fe[0],fe[1],fe[2]]:fe.length===1?[fe[0],[],Re]:[null,[],Re];if(ne.language=Ue.language,ne.variables.clear(),ne.functions.clear(),ne.instances.clear(),!Gn(me))throw new NW(me);for(let _e of Ae)if(!Gn(_e))throw new NW(_e);return de(me,Ae)}s(we,"Code"),t.Code=we;function Le(fe,Re=[]){let me=we(fe,Re,{language:"javascript"}),Ae=globalThis.Function("kind","format","hash",me),Ue=new Map(ne.instances);function _e(at,Lt,dt){if(!rh.Has(at)||!Ue.has(Lt))return!1;let Me=rh.Get(at),ve=Ue.get(Lt);return Me(ve,dt)}s(_e,"typeRegistryFunction");function lt(at,Lt){return _f.Has(at)?_f.Get(at)(Lt):!1}s(lt,"formatRegistryFunction");function tt(at){return cS(at)}s(tt,"hashFunction");let We=Ae(_e,lt,tt);return new SZe(fe,Re,We,me)}s(Le,"Compile"),t.Compile=Le})(Jk||(Jk={}));N();N();var FW={},EZe=s(function(t,e,r,i,n){var a=new Worker(FW[e]||(FW[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(o){var l=o.data,u=l.$e$;if(u){var c=new Error(u[0]);c.code=u[1],c.stack=u[2],n(c,null)}else n(null,l)},a.postMessage(r,i),a},"wk"),La=Uint8Array,Ql=Uint16Array,fS=Int32Array,zx=new La([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ux=new La([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Hw=new La([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ACe=s(function(t,e){for(var r=new Ql(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new fS(r[30]),i=1;i<30;++i)for(var a=r[i];a<r[i+1];++a)n[a]=a-r[i]<<5|i;return{b:r,r:n}},"freb"),SCe=ACe(zx,2),MV=SCe.b,C3=SCe.r;MV[28]=258,C3[258]=28;var MCe=ACe(Ux,0),ECe=MCe.b,Qk=MCe.r,qw=new Ql(32768);for(Hn=0;Hn<32768;++Hn)Ld=(Hn&43690)>>1|(Hn&21845)<<1,Ld=(Ld&52428)>>2|(Ld&13107)<<2,Ld=(Ld&61680)>>4|(Ld&3855)<<4,qw[Hn]=((Ld&65280)>>8|(Ld&255)<<8)>>1;var Ld,Hn,ih=s(function(t,e,r){for(var i=t.length,n=0,a=new Ql(e);n<i;++n)t[n]&&++a[t[n]-1];var o=new Ql(e);for(n=1;n<e;++n)o[n]=o[n-1]+a[n-1]<<1;var l;if(r){l=new Ql(1<<e);var u=15-e;for(n=0;n<i;++n)if(t[n])for(var c=n<<4|t[n],p=e-t[n],m=o[t[n]-1]++<<p,y=m|(1<<p)-1;m<=y;++m)l[qw[m]>>u]=c}else for(l=new Ql(i),n=0;n<i;++n)t[n]&&(l[n]=qw[o[t[n]-1]++]>>15-t[n]);return l},"hMap"),bf=new La(288);for(Hn=0;Hn<144;++Hn)bf[Hn]=8;var Hn;for(Hn=144;Hn<256;++Hn)bf[Hn]=9;var Hn;for(Hn=256;Hn<280;++Hn)bf[Hn]=7;var Hn;for(Hn=280;Hn<288;++Hn)bf[Hn]=8;var Hn,G_=new La(32);for(Hn=0;Hn<32;++Hn)G_[Hn]=5;var Hn,CCe=ih(bf,9,0),ICe=ih(bf,9,1),TCe=ih(G_,5,0),PCe=ih(G_,5,1),qC=s(function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},"max"),Gc=s(function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&r},"bits"),WC=s(function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},"bits16"),mS=s(function(t){return(t+7)/8|0},"shft"),Tv=s(function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new La(t.subarray(e,r))},"slc"),LCe={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14},DCe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],cs=s(function(t,e,r){var i=new Error(e||DCe[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,cs),!r)throw i;return i},"err"),RCe=s(function(t,e,r,i){var n=t.length,a=i?i.length:0;if(!n||e.f&&!e.l)return r||new La(0);var o=!r,l=o||e.i!=2,u=e.i;o&&(r=new La(n*3));var c=s(function(me){var Ae=r.length;if(me>Ae){var Ue=new La(Math.max(Ae*2,me));Ue.set(r),r=Ue}},"cbuf"),p=e.f||0,m=e.p||0,y=e.b||0,v=e.l,x=e.d,E=e.m,M=e.n,I=n*8;do{if(!v){p=Gc(t,m,1);var P=Gc(t,m+1,3);if(m+=3,P)if(P==1)v=ICe,x=PCe,E=9,M=5;else if(P==2){var C=Gc(t,m,31)+257,T=Gc(t,m+10,15)+4,D=C+Gc(t,m+5,31)+1;m+=14;for(var F=new La(D),k=new La(19),B=0;B<T;++B)k[Hw[B]]=Gc(t,m+B*3,7);m+=T*3;for(var U=qC(k),z=(1<<U)-1,q=ih(k,U,1),B=0;B<D;){var Z=q[Gc(t,m,z)];m+=Z&15;var Q=Z>>4;if(Q<16)F[B++]=Q;else{var V=0,ae=0;for(Q==16?(ae=3+Gc(t,m,3),m+=2,V=F[B-1]):Q==17?(ae=3+Gc(t,m,7),m+=3):Q==18&&(ae=11+Gc(t,m,127),m+=7);ae--;)F[B++]=V}}var Y=F.subarray(0,C),he=F.subarray(C);E=qC(Y),M=qC(he),v=ih(Y,E,1),x=ih(he,M,1)}else cs(1);else{var Q=mS(m)+4,J=t[Q-4]|t[Q-3]<<8,ne=Q+J;if(ne>n){u&&cs(0);break}l&&c(y+J),r.set(t.subarray(Q,ne),y),e.b=y+=J,e.p=m=ne*8,e.f=p;continue}if(m>I){u&&cs(0);break}}l&&c(y+131072);for(var ee=(1<<E)-1,ue=(1<<M)-1,K=m;;K=m){var V=v[WC(t,m)&ee],ce=V>>4;if(m+=V&15,m>I){u&&cs(0);break}if(V||cs(2),ce<256)r[y++]=ce;else if(ce==256){K=m,v=null;break}else{var re=ce-254;if(ce>264){var B=ce-257,se=zx[B];re=Gc(t,m,(1<<se)-1)+MV[B],m+=se}var de=x[WC(t,m)&ue],we=de>>4;de||cs(3),m+=de&15;var he=ECe[we];if(we>3){var se=Ux[we];he+=WC(t,m)&(1<<se)-1,m+=se}if(m>I){u&&cs(0);break}l&&c(y+131072);var Le=y+re;if(y<he){var fe=a-he,Re=Math.min(he,Le);for(fe+y<0&&cs(3);y<Re;++y)r[y]=i[fe+y]}for(;y<Le;++y)r[y]=r[y-he]}}e.l=v,e.p=K,e.b=y,e.f=p,v&&(p=1,e.m=E,e.d=x,e.n=M)}while(!p);return y!=r.length&&o?Tv(r,0,y):r.subarray(0,y)},"inflt"),vp=s(function(t,e,r){r<<=e&7;var i=e/8|0;t[i]|=r,t[i+1]|=r>>8},"wbits"),K0=s(function(t,e,r){r<<=e&7;var i=e/8|0;t[i]|=r,t[i+1]|=r>>8,t[i+2]|=r>>16},"wbits16"),XC=s(function(t,e){for(var r=[],i=0;i<t.length;++i)t[i]&&r.push({s:i,f:t[i]});var n=r.length,a=r.slice();if(!n)return{t:CV,l:0};if(n==1){var o=new La(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(D,F){return D.f-F.f}),r.push({s:-1,f:25001});var l=r[0],u=r[1],c=0,p=1,m=2;for(r[0]={s:-1,f:l.f+u.f,l,r:u};p!=n-1;)l=r[r[c].f<r[m].f?c++:m++],u=r[c!=p&&r[c].f<r[m].f?c++:m++],r[p++]={s:-1,f:l.f+u.f,l,r:u};for(var y=a[0].s,i=1;i<n;++i)a[i].s>y&&(y=a[i].s);var v=new Ql(y+1),x=I3(r[p-1],v,0);if(x>e){var i=0,E=0,M=x-e,I=1<<M;for(a.sort(function(F,k){return v[k.s]-v[F.s]||F.f-k.f});i<n;++i){var P=a[i].s;if(v[P]>e)E+=I-(1<<x-v[P]),v[P]=e;else break}for(E>>=M;E>0;){var C=a[i].s;v[C]<e?E-=1<<e-v[C]++-1:++i}for(;i>=0&&E;--i){var T=a[i].s;v[T]==e&&(--v[T],++E)}x=e}return{t:new La(v),l:x}},"hTree"),I3=s(function(t,e,r){return t.s==-1?Math.max(I3(t.l,e,r+1),I3(t.r,e,r+1)):e[t.s]=r},"ln"),e8=s(function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ql(++e),i=0,n=t[0],a=1,o=s(function(u){r[i++]=u},"w"),l=1;l<=e;++l)if(t[l]==n&&l!=e)++a;else{if(!n&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(n),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(n);a=1,n=t[l]}return{c:r.subarray(0,i),n:e}},"lc"),J0=s(function(t,e){for(var r=0,i=0;i<e.length;++i)r+=t[i]*e[i];return r},"clen"),EV=s(function(t,e,r){var i=r.length,n=mS(e+2);t[n]=i&255,t[n+1]=i>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var a=0;a<i;++a)t[n+a+4]=r[a];return(n+4+i)*8},"wfblk"),t8=s(function(t,e,r,i,n,a,o,l,u,c,p){vp(e,p++,r),++n[256];for(var m=XC(n,15),y=m.t,v=m.l,x=XC(a,15),E=x.t,M=x.l,I=e8(y),P=I.c,C=I.n,T=e8(E),D=T.c,F=T.n,k=new Ql(19),B=0;B<P.length;++B)++k[P[B]&31];for(var B=0;B<D.length;++B)++k[D[B]&31];for(var U=XC(k,7),z=U.t,q=U.l,Z=19;Z>4&&!z[Hw[Z-1]];--Z);var Q=c+5<<3,V=J0(n,bf)+J0(a,G_)+o,ae=J0(n,y)+J0(a,E)+o+14+3*Z+J0(k,z)+2*k[16]+3*k[17]+7*k[18];if(u>=0&&Q<=V&&Q<=ae)return EV(e,p,t.subarray(u,u+c));var Y,he,J,ne;if(vp(e,p,1+(ae<V)),p+=2,ae<V){Y=ih(y,v,0),he=y,J=ih(E,M,0),ne=E;var ee=ih(z,q,0);vp(e,p,C-257),vp(e,p+5,F-1),vp(e,p+10,Z-4),p+=14;for(var B=0;B<Z;++B)vp(e,p+3*B,z[Hw[B]]);p+=3*Z;for(var ue=[P,D],K=0;K<2;++K)for(var ce=ue[K],B=0;B<ce.length;++B){var re=ce[B]&31;vp(e,p,ee[re]),p+=z[re],re>15&&(vp(e,p,ce[B]>>5&127),p+=ce[B]>>12)}}else Y=CCe,he=bf,J=TCe,ne=G_;for(var B=0;B<l;++B){var se=i[B];if(se>255){var re=se>>18&31;K0(e,p,Y[re+257]),p+=he[re+257],re>7&&(vp(e,p,se>>23&31),p+=zx[re]);var de=se&31;K0(e,p,J[de]),p+=ne[de],de>3&&(K0(e,p,se>>5&8191),p+=Ux[de])}else K0(e,p,Y[se]),p+=he[se]}return K0(e,p,Y[256]),p+he[256]},"wblk"),OCe=new fS([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),CV=new La(0),kCe=s(function(t,e,r,i,n,a){var o=a.z||t.length,l=new La(i+o+5*(1+Math.ceil(o/7e3))+n),u=l.subarray(i,l.length-n),c=a.l,p=(a.r||0)&7;if(e){p&&(u[0]=a.r>>3);for(var m=OCe[e-1],y=m>>13,v=m&8191,x=(1<<r)-1,E=a.p||new Ql(32768),M=a.h||new Ql(x+1),I=Math.ceil(r/3),P=2*I,C=s(function(_e){return(t[_e]^t[_e+1]<<I^t[_e+2]<<P)&x},"hsh"),T=new fS(25e3),D=new Ql(288),F=new Ql(32),k=0,B=0,U=a.i||0,z=0,q=a.w||0,Z=0;U+2<o;++U){var Q=C(U),V=U&32767,ae=M[Q];if(E[V]=ae,M[Q]=V,q<=U){var Y=o-U;if((k>7e3||z>24576)&&(Y>423||!c)){p=t8(t,u,0,T,D,F,B,z,Z,U-Z,p),z=k=B=0,Z=U;for(var he=0;he<286;++he)D[he]=0;for(var he=0;he<30;++he)F[he]=0}var J=2,ne=0,ee=v,ue=V-ae&32767;if(Y>2&&Q==C(U-ue))for(var K=Math.min(y,Y)-1,ce=Math.min(32767,U),re=Math.min(258,Y);ue<=ce&&--ee&&V!=ae;){if(t[U+J]==t[U+J-ue]){for(var se=0;se<re&&t[U+se]==t[U+se-ue];++se);if(se>J){if(J=se,ne=ue,se>K)break;for(var de=Math.min(ue,se-2),we=0,he=0;he<de;++he){var Le=U-ue+he&32767,fe=E[Le],Re=Le-fe&32767;Re>we&&(we=Re,ae=Le)}}}V=ae,ae=E[V],ue+=V-ae&32767}if(ne){T[z++]=268435456|C3[J]<<18|Qk[ne];var me=C3[J]&31,Ae=Qk[ne]&31;B+=zx[me]+Ux[Ae],++D[257+me],++F[Ae],q=U+J,++k}else T[z++]=t[U],++D[t[U]]}}for(U=Math.max(U,q);U<o;++U)T[z++]=t[U],++D[t[U]];p=t8(t,u,c,T,D,F,B,z,Z,U-Z,p),c||(a.r=p&7|u[p/8|0]<<3,p-=7,a.h=M,a.p=E,a.i=U,a.w=q)}else{for(var U=a.w||0;U<o+c;U+=65535){var Ue=U+65535;Ue>=o&&(u[p/8|0]=c,Ue=o),p=EV(u,p+1,t.subarray(U,Ue))}a.i=o}return Tv(l,0,i+mS(p)+n)},"dflt"),CZe=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,i=9;--i;)r=(r&1&&-306674912)^r>>>1;t[e]=r}return t}(),IZe=s(function(){var t=-1;return{p:s(function(e){for(var r=t,i=0;i<e.length;++i)r=CZe[r&255^e[i]]^r>>>8;t=r},"p"),d:s(function(){return~t},"d")}},"crc"),NCe=s(function(t,e,r,i,n){if(!n&&(n={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new La(a.length+t.length);o.set(a),o.set(t,a.length),t=o,n.w=a.length}return kCe(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,i,n)},"dopt"),IV=s(function(t,e){var r={};for(var i in t)r[i]=t[i];for(var i in e)r[i]=e[i];return r},"mrg"),BW=s(function(t,e,r){for(var i=t(),n=t.toString(),a=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<i.length;++o){var l=i[o],u=a[o];if(typeof l=="function"){e+=";"+u+"=";var c=l.toString();if(l.prototype)if(c.indexOf("[native code]")!=-1){var p=c.indexOf(" ",8)+1;e+=c.slice(p,c.indexOf("(",p))}else{e+=c;for(var m in l.prototype)e+=";"+u+".prototype."+m+"="+l.prototype[m].toString()}else e+=c}else r[u]=l}return e},"wcln"),vE=[],TZe=s(function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},"cbfs"),PZe=s(function(t,e,r,i){if(!vE[r]){for(var n="",a={},o=t.length-1,l=0;l<o;++l)n=BW(t[l],n,a);vE[r]={c:BW(t[o],n,a),e:a}}var u=IV({},vE[r].e);return EZe(vE[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,u,TZe(u),i)},"wrkr"),LZe=s(function(){return[La,Ql,fS,zx,Ux,Hw,MV,ECe,ICe,PCe,qw,DCe,ih,qC,Gc,WC,mS,Tv,cs,RCe,z4,F4,FCe]},"bInflt"),DZe=s(function(){return[La,Ql,fS,zx,Ux,Hw,C3,Qk,CCe,bf,TCe,G_,qw,OCe,CV,ih,vp,K0,XC,I3,e8,J0,EV,t8,mS,Tv,kCe,NCe,B4,F4]},"bDflt"),F4=s(function(t){return postMessage(t,[t.buffer])},"pbf"),FCe=s(function(t){return t&&{out:t.size&&new La(t.size),dictionary:t.dictionary}},"gopt"),BCe=s(function(t,e,r,i,n,a){var o=PZe(r,i,n,function(l,u){o.terminate(),a(l,u)});return o.postMessage([t,e],e.consume?[t.buffer]:[]),function(){o.terminate()}},"cbify"),Bp=s(function(t,e){return t[e]|t[e+1]<<8},"b2"),Rh=s(function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},"b4"),DD=s(function(t,e){return Rh(t,e)+Rh(t,e+4)*4294967296},"b8"),tl=s(function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},"wbytes");function zCe(t,e,r){return r||(r=e,e={}),typeof r!="function"&&cs(7),BCe(t,e,[DZe],function(i){return F4(B4(i.data[0],i.data[1]))},0,r)}s(zCe,"deflate");function B4(t,e){return NCe(t,e||{},0,0)}s(B4,"deflateSync");function UCe(t,e,r){return r||(r=e,e={}),typeof r!="function"&&cs(7),BCe(t,e,[LZe],function(i){return F4(z4(i.data[0],FCe(i.data[1])))},1,r)}s(UCe,"inflate");function z4(t,e){return RCe(t,{i:2},e&&e.out,e&&e.dictionary)}s(z4,"inflateSync");var VCe=s(function(t,e,r,i){for(var n in t){var a=t[n],o=e+n,l=i;Array.isArray(a)&&(l=IV(i,a[1]),a=a[0]),a instanceof La?r[o]=[a,l]:(r[o+="/"]=[new La(0),l],VCe(a,o,r,i))}},"fltn"),zW=typeof TextEncoder<"u"&&new TextEncoder,r8=typeof TextDecoder<"u"&&new TextDecoder,RZe=0;try{r8.decode(CV,{stream:!0}),RZe=1}catch{}var OZe=s(function(t){for(var e="",r=0;;){var i=t[r++],n=(i>127)+(i>223)+(i>239);if(r+n>t.length)return{s:e,r:Tv(t,r-1)};n?n==3?(i=((i&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):n&1?e+=String.fromCharCode((i&31)<<6|t[r++]&63):e+=String.fromCharCode((i&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(i)}},"dutf8");function T3(t,e){if(e){for(var r=new La(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}if(zW)return zW.encode(t);for(var n=t.length,a=new La(t.length+(t.length>>1)),o=0,l=s(function(m){a[o++]=m},"w"),i=0;i<n;++i){if(o+5>a.length){var u=new La(o+8+(n-i<<1));u.set(a),a=u}var c=t.charCodeAt(i);c<128||e?l(c):c<2048?(l(192|c>>6),l(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|t.charCodeAt(++i)&1023,l(240|c>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|c&63)):(l(224|c>>12),l(128|c>>6&63),l(128|c&63))}return Tv(a,0,o)}s(T3,"strToU8");function TV(t,e){if(e){for(var r="",i=0;i<t.length;i+=16384)r+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return r}else{if(r8)return r8.decode(t);var n=OZe(t),a=n.s,r=n.r;return r.length&&cs(8),a}}s(TV,"strFromU8");var kZe=s(function(t,e){return e+30+Bp(t,e+26)+Bp(t,e+28)},"slzh"),NZe=s(function(t,e,r){var i=Bp(t,e+28),n=TV(t.subarray(e+46,e+46+i),!(Bp(t,e+8)&2048)),a=e+46+i,o=Rh(t,e+20),l=r&&o==4294967295?FZe(t,a):[o,Rh(t,e+24),Rh(t,e+42)],u=l[0],c=l[1],p=l[2];return[Bp(t,e+10),u,c,n,a+Bp(t,e+30)+Bp(t,e+32),p]},"zh"),FZe=s(function(t,e){for(;Bp(t,e)!=1;e+=4+Bp(t,e+2));return[DD(t,e+12),DD(t,e+4),DD(t,e+20)]},"z64e"),i8=s(function(t){var e=0;if(t)for(var r in t){var i=t[r].length;i>65535&&cs(9),e+=i+4}return e},"exfl"),UW=s(function(t,e,r,i,n,a,o,l){var u=i.length,c=r.extra,p=l&&l.length,m=i8(c);tl(t,e,o!=null?33639248:67324752),e+=4,o!=null&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(a<0&&8),t[e++]=n&&8,t[e++]=r.compression&255,t[e++]=r.compression>>8;var y=new Date(r.mtime==null?Date.now():r.mtime),v=y.getFullYear()-1980;if((v<0||v>119)&&cs(10),tl(t,e,v<<25|y.getMonth()+1<<21|y.getDate()<<16|y.getHours()<<11|y.getMinutes()<<5|y.getSeconds()>>1),e+=4,a!=-1&&(tl(t,e,r.crc),tl(t,e+4,a<0?-a-2:a),tl(t,e+8,r.size)),tl(t,e+12,u),tl(t,e+14,m),e+=16,o!=null&&(tl(t,e,p),tl(t,e+6,r.attrs),tl(t,e+10,o),e+=14),t.set(i,e),e+=u,m)for(var x in c){var E=c[x],M=E.length;tl(t,e,+x),tl(t,e+2,M),t.set(E,e+4),e+=4+M}return p&&(t.set(l,e),e+=p),e},"wzh"),BZe=s(function(t,e,r,i,n){tl(t,e,101010256),tl(t,e+8,r),tl(t,e+10,r),tl(t,e+12,i),tl(t,e+16,n)},"wzf");function jCe(t,e,r){r||(r=e,e={}),typeof r!="function"&&cs(7);var i={};VCe(t,"",i,e);var n=Object.keys(i),a=n.length,o=0,l=0,u=a,c=new Array(a),p=[],m=s(function(){for(var M=0;M<p.length;++M)p[M]()},"tAll"),y=s(function(M,I){P3(function(){r(M,I)})},"cbd");P3(function(){y=r});var v=s(function(){var M=new La(l+22),I=o,P=l-o;l=0;for(var C=0;C<u;++C){var T=c[C];try{var D=T.c.length;UW(M,l,T,T.f,T.u,D);var F=30+T.f.length+i8(T.extra),k=l+F;M.set(T.c,k),UW(M,o,T,T.f,T.u,D,l,T.m),o+=16+F+(T.m?T.m.length:0),l=k+D}catch(B){return y(B,null)}}BZe(M,o,c.length,P,I),y(null,M)},"cbf");a||v();for(var x=s(function(M){var I=n[M],P=i[I],C=P[0],T=P[1],D=IZe(),F=C.length;D.p(C);var k=T3(I),B=k.length,U=T.comment,z=U&&T3(U),q=z&&z.length,Z=i8(T.extra),Q=T.level==0?0:8,V=s(function(ae,Y){if(ae)m(),y(ae,null);else{var he=Y.length;c[M]=IV(T,{size:F,crc:D.d(),c:Y,f:k,m:z,u:B!=I.length||z&&U.length!=q,compression:Q}),o+=30+B+Z+he,l+=76+2*(B+Z)+(q||0)+he,--a||v()}},"cbl");if(B>65535&&V(cs(11,0,1),null),!Q)V(null,C);else if(F<16e4)try{V(null,B4(C,T))}catch(ae){V(ae,null)}else p.push(zCe(C,T,V))},"_loop_1"),E=0;E<u;++E)x(E);return m}s(jCe,"zip");var P3=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(t){t()};function $Ce(t,e,r){r||(r=e,e={}),typeof r!="function"&&cs(7);var i=[],n=s(function(){for(var M=0;M<i.length;++M)i[M]()},"tAll"),a={},o=s(function(M,I){P3(function(){r(M,I)})},"cbd");P3(function(){o=r});for(var l=t.length-22;Rh(t,l)!=101010256;--l)if(!l||t.length-l>65558)return o(cs(13,0,1),null),n;var u=Bp(t,l+8);if(u){var c=u,p=Rh(t,l+16),m=p==4294967295||c==65535;if(m){var y=Rh(t,l-12);m=Rh(t,y)==101075792,m&&(c=u=Rh(t,y+32),p=Rh(t,y+48))}for(var v=e&&e.filter,x=s(function(M){var I=NZe(t,p,m),P=I[0],C=I[1],T=I[2],D=I[3],F=I[4],k=I[5],B=kZe(t,k);p=F;var U=s(function(q,Z){q?(n(),o(q,null)):(Z&&(a[D]=Z),--u||o(null,a))},"cbl");if(!v||v({name:D,size:C,originalSize:T,compression:P}))if(!P)U(null,Tv(t,B,B+C));else if(P==8){var z=t.subarray(B,B+C);if(T<524288||C>.8*T)try{U(null,z4(z,{out:new La(T)}))}catch(q){U(q,null)}else i.push(UCe(z,{size:T},U))}else U(cs(14,"unknown compression type "+P,1),null);else U(null,null)},"_loop_3"),E=0;E<c;++E)x(E)}else o(null,{});return n}s($Ce,"unzip");N();var zZe=s(t=>{if(t!=null)return t.trim()===""?void 0:t},"maybePath"),UZe=s(t=>t!=null,"notNull"),ZC=s((t,e,r=0)=>{var i;if(it.IsNull(t))return"null";if(it.IsUndefined(t))return"undefined";if(it.IsString(t))return"<string>";if(it.IsNumber(t))return"<number>";if(it.IsBoolean(t))return"<boolean>";if(it.IsLiteral(t))return typeof t.const=="string"?"'".concat(t.const,"'"):"".concat(t.const);if(it.IsRef(t)){let n=e.find(a=>a.$id===t.$ref);return n==null?t.$ref:ZC(n,e,r)}if(it.IsArray(t))return"".concat(ZC(t.items,e,r+1),"[]");if(it.IsUnion(t)&&(!(t.anyOf.length>5)||t.$id==null)){let n="".concat(t.anyOf.map(a=>ZC(a,e,r+1)).filter(UZe).join(" | "));return r>0?"(".concat(n,")"):n}return(i=t.$id)!=null?i:""},"resolveSchemaIdent"),VZe=s((t,e,r)=>{var i;let n=e.message;it.IsUnion(e.schema)&&(n="Expected one of: ".concat(ZC(e.schema,r)));let a="#/definitions/".concat(t).concat((i=zZe(e.path))!=null?i:"");return"".concat(a,": ").concat(n)},"errorHandler"),GCe=s((t,e,r)=>{let i=e.First();if(i!=null)return VZe(t,i,r)},"shortError"),H_;(function(t){t.Archive="Archive",t.Validate="Validate",t.Encode="Encode",t.Unknown="Unknown"})(H_||(H_={}));var HCe=class extends Error{constructor(e,r){super(r),$(this,"name"),$(this,"kind"),this.name="CompressError",this.kind=e}};s(HCe,"CompressError");var U4=HCe,jZe=s(t=>new U4(H_.Archive,t.message),"flateErrorIntoCompressError"),$Ze=s(t=>{let e=Object.values(LCe);return t instanceof Error&&"code"in t&&typeof t.code=="number"&&e.includes(t.code)},"isFlateError"),GZe=s((t,e,r)=>{var i;return new U4(H_.Validate,(i=GCe(t,e,r))!=null?i:"Unknown validate error")},"checkErrorIntoCompressError"),HZe=s(t=>new U4(H_.Encode,t.message),"encodeErrorIntoCompressError"),qZe=s(t=>new U4(H_.Unknown,t instanceof Error?t.message:String(t)),"unknownErrorIntoCompressError"),VW=s((t,e,r)=>e instanceof vV?HZe(e):e instanceof Lx?GZe(t,e,r):$Ze(e)?jZe(e):qZe(e),"intoCompressError");N();var q_;(function(t){t.Unarchive="Unarchive",t.Validate="Validate",t.Decode="Decode",t.Unknown="Unknown"})(q_||(q_={}));var qCe=class extends Error{constructor(e,r){super(r),$(this,"name"),$(this,"kind"),this.name="DecompressError",this.kind=e}};s(qCe,"DecompressError");var V4=qCe,WZe=s(t=>new V4(q_.Unarchive,t.message),"flateErrorIntoDecompressError"),XZe=s(t=>{let e=Object.values(LCe);return t instanceof Error&&"code"in t&&typeof t.code=="number"&&e.includes(t.code)},"isFlateError"),ZZe=s((t,e,r)=>{var i;return new V4(q_.Validate,(i=GCe(t,e,r))!=null?i:"Unknown validate error")},"checkErrorIntoDecompressError"),YZe=s(t=>new V4(q_.Decode,t.message),"decodeErrorIntoDecompressError"),KZe=s(t=>new V4(q_.Unknown,t instanceof Error?t.message:String(t)),"unknownErrorIntoDecompressError"),jW=s((t,e,r)=>e instanceof yV?YZe(e):e instanceof Lx?ZZe(t,e,r):XZe(e)?WZe(e):KZe(e),"intoDecompressError");N();N();N();var JZe=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,QZe=[0,31,28,31,30,31,30,31,31,30,31,30,31],eYe=s(t=>t%4===0&&(t%100!==0||t%400===0),"isLeapYear"),WCe=s(t=>{let e=JZe.exec(t);if(!e)return!1;let r=+e[1],i=+e[2],n=+e[3];return i>=1&&i<=12&&n>=1&&n<=(i===2&&eYe(r)?29:QZe[i])},"date");N();var tYe=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i,XCe=s(t=>{let e=tYe.exec(t);if(!e)return!1;let r=+e[1],i=+e[2],n=+e[3],a=e[4],o=e[5]==="-"?-1:1,l=+(e[6]||0),u=+(e[7]||0);if(l>23||u>59||!a)return!1;if(r<=23&&i<=59&&n<60)return!0;let c=i-u*o,p=r-l*o-(c<0?1:0);return(p===23||p===-1)&&(c===59||c===-1)&&n<61},"time"),rYe=/t|\s/i,iYe=s(t=>{let e=t.split(rYe);return e.length===2&&WCe(e[0])&&XCe(e[1])},"dateTime");N();var nYe=/\/|:/,aYe=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,oYe=s(t=>nYe.test(t)&&aYe.test(t),"uri"),sYe=[["date",WCe],["time",XCe],["date-time",iYe],["uri",oYe]],lYe=s(()=>{for(let[t,e]of sYe)try{jk.Format(t,e)}catch(r){if(r instanceof Y2e)continue;throw r}},"registerFormats");N();N();N();var uYe=s(t=>t instanceof Error?t:new Error(String(t)),"asError"),ZCe=s(t=>(...e)=>{try{return Ti(t(...e))}catch(r){return Di(uYe(r))}},"safeFn"),cYe=ZCe((t,e)=>{let r={};for(let i of e)for(let n of i.intoBundle(t))r[n.path]=T3(JSON.stringify(n.contents));return r}),$W=s(async(t,e,r)=>cYe(t,e).andThenAsync(i=>new Promise(n=>{jCe(i,vt(Ee({},r),{consume:!0}),(a,o)=>{n(a?Di(a):Ti(o))})})),"compress");N();N();function L3(t,e,r=[]){let i=Ee({},t);for(let[n,a]of Object.entries(e))if(a!==void 0)if(n in i){let o=n;if(Array.isArray(a)&&a.length>0){let l=YCe(a[0],r);if(l){let u=i[o];if(!Array.isArray(u))throw new Error("Expected array at ".concat(n,", got ").concat(typeof u));let c=new Map(a.map(m=>[n8(m,l),m])),p=u.map(m=>{let y=c.get(n8(m,l));return y?L3(m,y,r):m});i[o]=p}else i[o]=a}else{let l=i[o];typeof l=="object"&&l!==null&&typeof a=="object"&&a!==null?Object.keys(a).length===0?i[o]=a:i[o]=L3(l,a,r):i[n]=a}}else i[n]=a;return i}s(L3,"deepMergeOn");function YCe(t,e){function r(i){if(typeof i!="object"||i===null)return null;for(let n of e)if(n in i&&typeof i[n]<"u")return[n];if(Array.isArray(i))return null;for(let[n,a]of Object.entries(i)){let o=r(a);if(o)return[n,...o]}return null}return s(r,"search"),r(t)}s(YCe,"findIdentifierKey");function n8(t,e){return e.reduce((r,i)=>{if(r&&typeof r=="object")return r[i]},t)}s(n8,"getValueByKeyPath");var hYe=s(t=>t,"identity"),pYe=s(t=>JSON.parse(TV(t)),"jsonDecode"),dYe=s((t,e)=>e.some(r=>r.fromBundle(t.name,new Uint8Array,hYe)!==void 0),"isFileExpected"),fYe=ZCe((t,e)=>{let r={};for(let i of Object.keys(t)){let n=t[i];for(let a of e){let o=a.fromBundle(i,n,pYe);if(o){r=L3(r,o,[]);break}}}return r}),GW=s(async(t,e)=>new Promise(r=>$Ce(t,{filter:s(i=>dYe(i,e),"filter")},(i,n)=>{r(i?Di(i):Ti(n))})).then(r=>r.andThen(i=>fYe(i,e))),"decompress");N();var mYe=s(t=>typeof t=="object"&&t!=null&&"$ref"in t&&typeof t.$ref=="string","isRef"),gYe=s(t=>{if(t.length<2)return!1;let e=t.filter(mYe);if(e.length!==t.length)return!1;let r=e[0].$ref;return e.slice(1).every(i=>i.$ref===r)},"isDuplicateRef"),a8=s(t=>typeof t=="object"&&t!=null&&"allOf"in t&&Array.isArray(t.allOf)&&gYe(t.allOf)?t.allOf[0]:typeof t=="object"&&t!=null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,a8(r)])):Array.isArray(t)?t.map(a8):t,"fixDuplicateAllOf");N();var o8=s(t=>typeof t=="object"&&t!=null&&"$ref"in t?vt(Ee({},t),{$ref:"#/definitions/".concat(t.$ref)}):typeof t=="object"&&t!=null&&!Array.isArray(t)?Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o8(r)])):Array.isArray(t)?t.map(o8):t,"prefixReferences"),h_;(function(t){t.InvalidTypeboxSchema="InvalidTypeboxSchema",t.MissingReferenceId="MissingReferenceId",t.DuplicateReferenceId="DuplicateReferenceId",t.TypeboxError="TypeboxError",t.UnknownError="UnknownError"})(h_||(h_={}));var yYe=s(t=>({next(){for(let e of t){let r=e.next();if(!r.done)return r}return{done:!0,value:void 0}},[Symbol.iterator](){return this}}),"join"),vYe=s((...t)=>{let e=new Map;for(let r of yYe(t)){if(!r.$id)continue;let i=e.get(r.$id);if(i!=null&&i!==r)return Di({kind:h_.DuplicateReferenceId,message:"Failed to register a reference for a schema with an $id that has already been used",schema:r});e.set(r.$id,r)}return Ti(e)},"computeReferenceMap"),Eh,Q0,vm,_p,KCe=class JCe{constructor(e,r,i,n){Be(this,Eh),Be(this,Q0),Be(this,vm,[]),Be(this,_p),He(this,Eh,e),He(this,Q0,r),He(this,vm,i),He(this,_p,n),this.is=this.is.bind(this),this.parse=this.parse.bind(this),this.verify=this.verify.bind(this),this.jsonSchema=this.jsonSchema.bind(this),this.compress=this.compress.bind(this),this.decompress=this.decompress.bind(this)}static create(e,r="CoreMVF"){let i=pe.Composite(e.extensions.map(a=>a.schema),{$id:r});if(!it.IsSchema(i))return Di({kind:h_.InvalidTypeboxSchema,message:"Attempting to merge schemas produced an invalid schema",schema:i});let n=vYe(VXe.values(),FXe.values(),BXe.values(),zXe.values(),UXe.values(),eZe.values(),e.extensions.flatMap(a=>{var o;return(o=a.references)!=null?o:[]}).values());if(!n.isOk())return n;try{lYe();let a=Jk.Compile(i,[...n.value.values()]);return Ti(new JCe(i,a,e.extensions,n.value))}catch(a){return a instanceof Ca?Di({kind:h_.TypeboxError,message:a.message,original:a}):Di({kind:h_.UnknownError,message:"An unknown error occurred while compiling the schema",original:a})}}is(e){return w(this,Q0).Check(e)}parse(e){return w(this,Q0).Check(e)?Ti(e):Di(w(this,Q0).Errors(e))}decode(e){try{return Ti(uCe(w(this,Eh),[...w(this,_p).values()],e))}catch(r){return Di(r)}}encode(e){try{return Ti(_Ce(w(this,Eh),[...w(this,_p).values()],e))}catch(r){return Di(r)}}verify(e){for(let r of w(this,vm))if(r.integrityCheck){let i=r.integrityCheck(e);if(i.isErr())return Di(i.error)}return Ti(!0)}jsonSchema(){var e;let r=JSON.parse(JSON.stringify([w(this,Eh),...w(this,_p).values()])),i=a8(o8({$id:"#/definitions/".concat((e=w(this,Eh).$id)!=null?e:"CoreMVF"),$schema:"http://json-schema.org/draft-07/schema#",references:r}));return JSON.stringify(i,null,2)}async compress(e){return this.encode(e).andThen(r=>this.parse(r)).andThenAsync(r=>$W(r,w(this,vm))).then(r=>r.mapErr(i=>{var n;return VW((n=w(this,Eh).$id)!=null?n:"CoreMVF",i,[...w(this,_p).values()])}))}async compressUnsafe(e){return this.encode(e).andThenAsync(r=>$W(r,w(this,vm))).then(r=>r.mapErr(i=>{var n;return VW((n=w(this,Eh).$id)!=null?n:"CoreMVF",i,[...w(this,_p).values()])}))}async decompress(e){return GW(e,w(this,vm)).then(r=>r.andThen(i=>this.parse(i)).andThen(i=>this.decode(i)).mapErr(i=>{var n;return jW((n=w(this,Eh).$id)!=null?n:"CoreMVF",i,[...w(this,_p).values()])}))}async decompressUnsafe(e){return GW(e,w(this,vm)).then(r=>r.andThen(i=>this.decode(i)).mapErr(i=>{var n;return jW((n=w(this,Eh).$id)!=null?n:"CoreMVF",i,[...w(this,_p).values()])}))}};Eh=new WeakMap,Q0=new WeakMap,vm=new WeakMap,_p=new WeakMap,s(KCe,"MVFParser");var _Ye=KCe,C2,QCe=class{constructor(){Be(this,C2,[]),this.extend=this.extend.bind(this)}extend(e){return w(this,C2).push(e),this}extendOptional(e){let r=vt(Ee({},e),{schema:pe.Partial(e.schema)});return w(this,C2).push(r),this}build(){return _Ye.create(this)}get extensions(){return w(this,C2)}};C2=new WeakMap,s(QCe,"MVFParserBuilder");var xYe=QCe,bYe=s(()=>new xYe().extend($Xe).extend(YXe).extend(QXe),"createParser"),Ww=nu("lcat","LocationCategoryId"),eIe=pe.Intersect([pe.Object({id:pe.Ref(Ww),parent:pe.Optional(pe.Ref(Ww))}),nV(["name"]),uS],{$id:"LocationCategory"}),wYe=[Ww,eIe];N();N();var U1;(function(t){t.UnknownCategoryError="UnknownCategoryError",t.UnknownParentCategoryError="UnknownParentCategoryError",t.UnknownParentLocationError="UnknownParentLocationError"})(U1||(U1={}));var AYe=s(t=>{var e,r,i,n,a,o,l,u,c;if(t.locationCategories==null&&t.locations==null)return Ti(!0);let p=new Set((r=(e=t.locationCategories)==null?void 0:e.map(v=>v.id))!=null?r:[]);for(let v of(i=t.locationCategories)!=null?i:[])if(v.parent!=null&&!p.has(v.parent))return Di({kind:U1.UnknownParentCategoryError,properties:{categoryId:v.id,parentCategoryId:v.parent}});let m=Lf(t);for(let v of(n=t.locations)!=null?n:[]){for(let x of v.categories)if(!p.has(x))return Di({kind:U1.UnknownCategoryError,properties:{locationId:v.id,categoryId:x}});for(let x of v.geometryAnchors){let E=m(x.floorId,x.geometryId);if(E.isErr())return E}}let y=new Set((o=(a=t.locations)==null?void 0:a.map(v=>v.id))!=null?o:[]);for(let v of(l=t.locationInstances)!=null?l:[]){if(!y.has(v.parentId))return Di({kind:U1.UnknownParentLocationError,properties:{locationInstanceId:v.id,parentLocationId:v.parentId}});for(let x of(u=v.categories)!=null?u:[])if(!p.has(x))return Di({kind:U1.UnknownCategoryError,properties:{locationId:v.id,categoryId:x}});for(let x of(c=v.geometryAnchors)!=null?c:[]){let E=m(x.floorId,x.geometryId);if(E.isErr())return E}}return Ti(!0)},"validateLocations");N();var gS=nu("loc","LocationId"),PV=nu("loci","LocationInstanceId"),tIe=pe.Object({name:pe.String(),url:pe.String({format:"uri"})},{$id:"LocationSocial"}),rIe=pe.Object({url:pe.String({format:"uri"})},{$id:"LocationImage"}),s8=pe.Object({label:pe.String(),url:pe.String({format:"uri"})},{$id:"LocationLink"}),l8=pe.String({pattern:"^[0-2][0-9]:[0-6][0-9](:[0-6][0-9])?$",$id:"OpeningHoursTime"}),iIe=pe.Union([pe.Literal("Sunday"),pe.Literal("Monday"),pe.Literal("Tuesday"),pe.Literal("Wednesday"),pe.Literal("Thursday"),pe.Literal("Friday"),pe.Literal("Saturday")],{$id:"OpeningHoursDay"}),SYe="PublicHolidays",u8=pe.Union([iIe,pe.Literal(SYe)],{$id:"OpeningHoursDayOrPublicHoliday"}),LV=pe.Object({"@type":pe.Optional(pe.Literal("OpeningHoursSpecification",{description:"The type of opening hours"})),opens:pe.Optional(pe.Ref(l8,{description:"The time the opening hours start"})),closes:pe.Optional(pe.Ref(l8,{description:"The time the opening hours end"})),dayOfWeek:pe.Optional(pe.Union([pe.Ref(u8),pe.Array(pe.Ref(u8))],{description:"The days of the week the opening hours apply to"})),validFrom:pe.Optional(pe.String({format:"date-time",description:"The date the opening hours start, in ISO 8601 format"})),validTo:pe.Optional(pe.String({format:"date-time",description:"The date the opening hours end, in ISO 8601 format"}))},{$id:"OpeningHoursSpecification"}),DV=pe.Intersect([pe.Object({id:pe.Ref(gS),categories:pe.Array(pe.Ref(Ww)),logo:pe.Optional(pe.String({format:"uri"})),phone:pe.Optional(pe.String()),social:pe.Array(pe.Ref(tIe)),images:pe.Array(pe.Ref(rIe)),links:pe.Array(pe.Ref(s8)),website:pe.Optional(pe.Ref(s8)),openingHours:pe.Optional(pe.Array(pe.Ref(LV)))}),nV(["name"]),aV(),uS],{$id:"Location"}),nIe=pe.Intersect([pe.Object({id:pe.Ref(PV),parentId:pe.Ref(gS)}),pe.Partial(pe.Omit(DV,["id","parentId"]))],{$id:"LocationInstance"}),aIe=[gS,PV,tIe,rIe,s8,l8,iIe,u8,LV,DV,nIe],MYe=pe.Object({locations:pe.Array(pe.Ref(DV)),locationCategories:pe.Array(pe.Ref(eIe)),locationInstances:pe.Optional(pe.Array(pe.Ref(nIe)))},{$id:"LocationsExtensionSchema"}),HW="locations.json",qW="location-categories.json",WW="location-instances.json",EYe={name:"ext:locations",schema:MYe,intoBundle:s(function*(t){t.locations!=null&&(yield{path:HW,contents:t.locations}),t.locationCategories!=null&&(yield{path:qW,contents:t.locationCategories}),t.locationInstances!=null&&(yield{path:WW,contents:t.locationInstances})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===HW)return{locations:r(e)};if(t===qW)return{locationCategories:r(e)};if(t===WW)return{locationInstances:r(e)}},"fromBundle"),references:[...wYe,...aIe],integrityCheck:AYe};N();N();var Zd;(function(t){t.UnknownEnterpriseLocationError="UnknownEnterpriseLocationError",t.EnterpriseLocationWithUnknownLocationError="EnterpriseLocationWithUnknownLocationError",t.EnterpriseCategoryWithUnknownLocationCategoryError="EnterpriseCategoryWithUnknownLocationCategoryError",t.InstanceWithUnknownLocationInstanceError="InstanceWithUnknownLocationInstanceError",t.InstanceWithUnknownEnterpriseLocationError="InstanceWithUnknownEnterpriseLocationError",t.EnterpriseLocationWithUnknownSibling="EnterpriseLocationWithUnknownSibling",t.EnterpriseLocationInstanceWithUnknownSibling="EnterpriseLocationInstanceWithUnknownSibling"})(Zd||(Zd={}));var CYe=s(t=>{var e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T;if(t.enterprise==null)return Ti(!0);let D=t.enterprise,F=new Set((r=(e=t.locationCategories)==null?void 0:e.map(Z=>Z.id))!=null?r:[]);for(let Z of(i=D.categories)!=null?i:[])if(!F.has(Z.categoryId))return Di({kind:Zd.EnterpriseCategoryWithUnknownLocationCategoryError,properties:{enterpriseCategoryId:Z.id,locationCategoryId:Z.categoryId}});let k=new Set((a=(n=t.locations)==null?void 0:n.map(Z=>Z.id))!=null?a:[]);for(let Z of(o=D.locations)!=null?o:[]){if(!k.has(Z.locationId))return Di({kind:Zd.EnterpriseLocationWithUnknownLocationError,properties:{enterpriseLocationId:Z.id,locationId:Z.locationId}});for(let Q of(l=Z.siblingGroups)!=null?l:[])for(let V of(u=Q.siblings)!=null?u:[])if(!k.has(V))return Di({kind:Zd.EnterpriseLocationWithUnknownSibling,properties:{enterpriseLocationId:Z.id,siblingLocationId:V,label:Q.label}})}let B=new Set((p=(c=t.enterprise.locations)==null?void 0:c.map(Z=>Z.id))!=null?p:[]);if(((m=D.venue)==null?void 0:m.topLocations)!=null){for(let Z of D.venue.topLocations)if(!B.has(Z))return Di({kind:Zd.UnknownEnterpriseLocationError,properties:{enterpriseLocationId:Z}})}let U=new Set((v=(y=t.locationInstances)==null?void 0:y.map(Z=>Z.id))!=null?v:[]);for(let Z of(x=D.locationInstances)!=null?x:[]){if(!B.has(Z.parentId))return Di({kind:Zd.InstanceWithUnknownEnterpriseLocationError,properties:{enterpriseLocationInstanceId:Z.id,enterpriseLocationId:Z.parentId}});if(!U.has(Z.locationInstanceId))return Di({kind:Zd.InstanceWithUnknownLocationInstanceError,properties:{enterpriseLocationInstanceId:Z.id,locationInstanceId:Z.locationInstanceId}});for(let Q of(E=Z.siblingGroups)!=null?E:[])for(let V of(M=Q.siblings)!=null?M:[])if(!k.has(V))return Di({kind:Zd.EnterpriseLocationInstanceWithUnknownSibling,properties:{enterpriseLocationInstanceId:Z.id,siblingLocationId:V,label:Q.label}})}let z=O4(t),q=Lf(t);for(let[Z,Q]of Es((I=D.floorText)!=null?I:{})){let V=z(Z);if(V.isErr())return V;for(let ae of Q.features){if(!("geometryId"in ae.properties))continue;let Y=q(Z,ae.properties.geometryId);if(Y.isErr())return Y}}for(let[Z,Q]of Es((P=D.textures)!=null?P:{})){let V=z(Z);if(V.isErr())return V;for(let ae of Q){let Y=q(Z,ae.geometryId);if(Y.isErr())return Y}}for(let[Z,Q]of Es((C=D.layers)!=null?C:{})){let V=z(Z);if(V.isErr())return V;for(let ae of ps(Q??{})){let Y=q(Z,ae);if(Y.isErr())return Y}}for(let[Z,Q]of Es((T=D.textAreas)!=null?T:{})){let V=z(Z);if(V.isErr())return V;for(let ae of Q.features)if("geometryId"in ae.properties){let Y=q(Z,ae.properties.geometryId);if(Y.isErr())return Y}}return Ti(!0)},"validateCMS");N();N();var j4=nu("el","EnterpriseLocationId"),oIe=nu("ec","EnterpriseCategoryId"),sIe=nu("eli","EnterpriseLocationInstanceId"),lIe=nu("ev","EnterpriseVenueId"),uIe=nu("eft","EnterpriseFloorTextId"),IYe=[j4,oIe,sIe,lIe,uIe],cIe=pe.Object({id:pe.Ref(oIe),categoryId:pe.Ref(Ww),color:pe.Optional(pe.String()),sortOrder:pe.Number(),iconFromDefaultList:pe.Optional(pe.Union([pe.String(),pe.Null()])),picture:pe.Optional(pe.String({format:"uri",description:"The category's picture"}))},{$id:"EnterpriseCategory"}),hIe=pe.Object({categories:pe.Optional(pe.Array(pe.Ref(cIe)))},{$id:"EnterpriseCategoriesSchema"}),TYe=[cIe,hIe];N();var pIe=Cv(["left","center","right"]),PYe=pIe.schema;pIe.values;var RV=pe.Object({id:pe.Ref(uIe),text:pe.String(),visible:pe.Boolean({default:!0}),fontSize:pe.Number({default:12,minimum:1}),fontFamily:pe.String({default:"Droid Sans"}),color:pe.String({default:"black"}),rotation:pe.Number({minimum:0,maximum:360}),align:PYe},{$id:"FloorTextCommonProperties"}),OV=pe.Intersect([pe.Ref(RV),Px],{$id:"AnchoredFloorTextProperties"}),kV=pe.Intersect([pe.Ref(RV),pe.Object({verticalOffset:pe.Number()})],{$id:"FloatingFloorTextProperties"}),dIe=pe.Union([pe.Ref(OV),pe.Ref(kV)],{$id:"FloorTextProperties"}),fIe=Pf(Tf,pe.Ref(dIe),{$id:"FloorTextFeature"}),LYe=Pf(Tf,pe.Ref(OV),{$id:"AnchoredFloorTextFeature"}),DYe=Pf(Tf,pe.Ref(kV),{$id:"FloatingFloorTextFeature"}),mIe=Ev(pe.Ref(fIe),{$id:"EnterpriseFloorTextFeatureCollection"}),gIe=pe.Record($s,pe.Ref(mIe),{$id:"EnterpriseFloorTextCollectionsByFloor",additionalProperties:!1}),yIe=pe.Object({floorText:pe.Optional(pe.Ref(gIe))},{$id:"EnterpriseFloorTextSchema"}),RYe=[RV,OV,kV,dIe,fIe,LYe,DYe,mIe,gIe,yIe];N();var vIe=zu(pe.Record(If,pe.String({minLength:1}),{additionalProperties:!1,$id:"EnterpriseLayers"})),_Ie=zu(pe.Record($s,pe.Ref(vIe),{additionalProperties:!1,$id:"EnterpriseLayersByFloor"})),xIe=pe.Object({layers:pe.Optional(pe.Ref(_Ie))},{$id:"EnterpriseLayersSchema"}),OYe=[vIe,_Ie,xIe];N();N();N();var NV=Cv(["closed-temporarily","new","pop-up","coming-soon","relocated"]),kYe=NV.schema;NV.values;NV.record;var bIe=pe.Object({type:kYe,start:pe.Optional(pe.String({format:"date",description:"The start date of the state"})),end:pe.Optional(pe.String({format:"date",description:"The end date of the state"}))},{$id:"LocationState",description:"The state of a location. Start and end dates are optional."}),wIe=pe.Object({label:pe.String(),siblings:pe.Array(pe.Ref(gS))},{$id:"SiblingGroup"}),c8=pe.Object({name:pe.String(),code:pe.String()},{$id:"Language"}),NYe=[bIe,wIe,c8],FV=pe.Object({id:pe.Ref(j4),locationId:pe.Ref(gS),type:pe.String(),sortOrder:pe.Number(),tags:pe.Optional(pe.Array(pe.String())),picture:pe.Optional(pe.String({format:"uri",description:"The picture of the location"})),states:pe.Optional(pe.Array(pe.Ref(bIe),{description:"The location's state. No more than one state should be active at a time, and all but at most one should have dates set"})),siblingGroups:pe.Optional(pe.Array(pe.Ref(wIe))),gallery:pe.Optional(pe.Array(pe.Object({caption:pe.Optional(pe.String()),image:pe.String({format:"uri"}),embeddedUrl:pe.Optional(pe.String({format:"uri",description:"The URL to link from the image"}))},{description:"The location's image gallery"}),{description:"The location's image gallery"})),showFloatingLabelWhenImagePresent:pe.Optional(pe.Boolean({description:"Whether to show the flat label when an image is present"})),amenity:pe.Optional(pe.String({description:"The location's amenity type. Only set if the location is an amenity"})),showLogo:pe.Optional(pe.Boolean({description:"Whether to show the logo of the location"}))},{$id:"EnterpriseLocation"}),AIe=pe.Object({locations:pe.Optional(pe.Array(pe.Ref(FV)))},{$id:"EnterpriseLocationsSchema"}),FYe=[FV,AIe],SIe=pe.Intersect([pe.Object({id:pe.Ref(sIe),parentId:pe.Ref(j4),locationInstanceId:pe.Ref(PV)}),pe.Partial(pe.Omit(FV,["id","parentId","locationId"]))],{$id:"EnterpriseLocationInstance",description:"A locationInstance is a particular instance of an Enterprise Location that has some properties different from the parent."}),MIe=pe.Object({locationInstances:pe.Optional(pe.Array(pe.Ref(SIe)))},{$id:"EnterpriseLocationInstancesSchema"}),BYe=[SIe,MIe];N();var BV=Cv(["near","center"],{$id:"EnterpriseTextAreaAlignment"}),EIe=BV.schema;BV.values;BV.record;var zV=pe.Object({maxWidth:pe.Number({exclusiveMinimum:0,description:"The maximum width of the label, in meters."}),maxHeight:pe.Number({exclusiveMinimum:0,description:"The maximum height of the label, in meters."}),align:pe.Ref(EIe),rotation:pe.Number({minimum:0,maximum:360,description:"Rotation in degrees, about the center of the image. North is 0, east is 90."})},{$id:"EnterpriseBaseTextAreaProperties"}),CIe=pe.Intersect([pe.Ref(zV),Px],{$id:"EnterpriseAnchoredTextAreaProperties"}),IIe=pe.Intersect([pe.Ref(zV),pe.Object({verticalOffset:pe.Number({minimum:0,description:"How high to position the image, in meters, relative to the ground plane."})})],{$id:"EnterpriseFloatingTextAreaProperties"}),TIe=pe.Union([CIe,IIe],{$id:"EnterpriseTextAreaProperties"}),PIe=Pf(pe.Ref(Tf),TIe,{$id:"EnterpriseTextAreaFeature"}),LIe=Ev(pe.Ref(PIe),{$id:"EnterpriseTextAreaCollection"}),DIe=pe.Record($s,pe.Ref(LIe),{$id:"EnterpriseTextAreasByFloor",additionalProperties:!1}),zYe=pe.Object({textAreas:pe.Optional(pe.Ref(DIe))},{$id:"EnterpriseTextAreasSchema"}),UYe=[EIe,zV,CIe,IIe,TIe,PIe,LIe,DIe];N();var h8=pe.Object({u:pe.Number(),v:pe.Number()},{$id:"EnterpriseTextureUV"}),UV=Cv(["top","side"],{$id:"EnterpriseTextureFace"}),RIe=UV.schema;UV.values;UV.record;var VV=Cv(["inside","outside","both"],{$id:"EnterpriseTextureSurface"}),OIe=VV.schema;VV.values;VV.record;var kIe=pe.Tuple([x3,b3,x3,b3],{$id:"EnterpriseTextureBounds"}),NIe=pe.Intersect([pe.Object({repeat:pe.Ref(h8),offset:pe.Ref(h8),rotation:pe.Number({minimum:0,maximum:360}),path:pe.String({format:"uri"}),face:pe.Ref(RIe),surface:pe.Ref(OIe),bounds:pe.Ref(kIe)},{$id:"EnterpriseTextureProperties"}),Px],{$id:"EnterpriseTexture"}),FIe=pe.Array(pe.Ref(NIe),{$id:"EnterpriseTextures"}),BIe=pe.Record($s,pe.Ref(FIe),{$id:"EnterpriseTexturesByFloor",additionalProperties:!1}),zIe=pe.Object({textures:pe.Optional(pe.Ref(BIe))},{$id:"EnterpriseTexturesSchema"}),VYe=[NIe,FIe,zIe,h8,RIe,OIe,kIe,BIe];N();var UIe=pe.Intersect([pe.Object({id:pe.Ref(lIe),slug:pe.String(),defaultLanguage:pe.Ref(c8),languages:pe.Array(pe.Ref(c8)),countrycode:pe.Optional(pe.String()),logo:pe.Optional(pe.String({format:"uri"})),mappedinWebUrl:pe.Optional(pe.String({format:"uri"})),topLocations:pe.Optional(pe.Array(pe.Ref(j4))),operationHours:pe.Optional(pe.Array(pe.Ref(LV))),coverImage:pe.Optional(pe.String({format:"uri"}))}),nV(["name"]),uS],{$id:"EnterpriseVenue"}),VIe=pe.Object({venue:pe.Optional(pe.Ref(UIe))},{$id:"EnterpriseVenueSchema"}),jYe=[UIe,VIe],jIe=pe.Intersect([VIe,AIe,MIe,hIe,zIe,yIe,xIe,zYe],{$id:"EnterpriseProperties"}),XW=pe.Object({enterprise:pe.Optional(pe.Ref(jIe))},{$id:"CMSExtensionSchema"}),$Ye=/^enterprise\/(?:([^/]+)\/)?([^/]+)\.(?:json|geojson)$/,GYe={name:"ext:cms",schema:XW,intoBundle:s(function*(t){var e,r,i,n,a,o;if(t.enterprise==null)return;let l=t.enterprise;for(let u of ps(l))switch(u){case"floorText":for(let c of ps((e=l.floorText)!=null?e:{}))yield{path:"enterprise/floorText/".concat(c,".geojson"),contents:((r=l.floorText)!=null?r:{})[c]};continue;case"textures":for(let c of ps((i=l.textures)!=null?i:{}))yield{path:"enterprise/textures/".concat(c,".json"),contents:((n=l.textures)!=null?n:{})[c]};continue;case"textAreas":for(let c of ps((a=l.textAreas)!=null?a:{}))yield{path:"enterprise/textAreas/".concat(c,".geojson"),contents:((o=l.textAreas)!=null?o:{})[c]};continue;default:yield{path:"enterprise/".concat(u,".json"),contents:l[u]};continue}},"intoBundle"),fromBundle:s((t,e,r)=>{let i=t.match($Ye);if(!i)return;let[,n,a]=i,o=r(e);switch(n){case"floorText":case"textures":case"textAreas":return{enterprise:{[n]:{[a]:o}}};default:return{enterprise:{[a]:o}}}},"fromBundle"),references:[jIe,XW,...jYe,...FYe,...BYe,...TYe,...VYe,...OYe,...RYe,...UYe,...IYe,...NYe,...aIe],integrityCheck:CYe};N();N();N();N();var uf;(function(t){t.NavigationFlagMissingDeclaration="NavigationFlagMissingDeclaration",t.NavigationFlagDuplicateBit="NavigationFlagDuplicateBit",t.NavigationFlagIncorrectFlagsLength="NavigationFlagIncorrectFlagsLength",t.NavigationFlagValueTooBig="NavigationFlagValueTooBig"})(uf||(uf={}));var HYe=s(t=>{let{navigationFlags:e}=t;if(!e||Object.keys(e).length===0)return Ti(!0);let r=Object.entries(e).map(([a,o])=>Ee({key:a},o)).sort((a,o)=>a.index!==o.index?a.index-o.index:a.bit-o.bit),i=0,n=-1;for(let a of r){if(a.bit===n)return Di({kind:uf.NavigationFlagDuplicateBit,properties:{index:a.index,bit:a.bit,path:"navigationFlags.".concat(a.key)}});if(a.index!=i){if(n!=31)return Di({kind:uf.NavigationFlagMissingDeclaration,properties:{index:i,bit:n+1,path:"navigationFlags"}});if(a.index!=i+1||a.bit!=0)return Di({kind:uf.NavigationFlagMissingDeclaration,properties:{index:i+1,bit:0,path:"navigationFlags"}});i=a.index,n=0}else{if(a.bit!==n+1)return Di({kind:uf.NavigationFlagMissingDeclaration,properties:{index:a.index,bit:n+1,path:"navigationFlags"}});n=a.bit}}return Ti(!0)},"validateNavigationFlags");N();function Xw(t,e){return e&&(t.flags[e.index]&1<<e.bit)!==0}s(Xw,"hasFlag");N();var ZW=2**32-1,$Ie=s(t=>{var e;let r=Object.keys((e=t.navigationFlags)!=null?e:{}).length;if(r===0)return{index:-1,flag:0};let i=Math.floor(r/32),n=r%32;return{index:i,flag:2**n-1}},"determineMaxNavigationFlags"),p8=s((t,e,r)=>{if(e.index==-1&&t.length===0)return Ti(!0);let i=e.flag>0||e.index===-1?e.index+1:e.index;if(t.length!==i)return Di({kind:uf.NavigationFlagIncorrectFlagsLength,properties:{expected:i,actual:t.length,path:r}});for(let n=0;n<t.length;n++){let a=t[n];if(n<e.index){if(a>ZW)return Di({kind:uf.NavigationFlagValueTooBig,properties:{index:n,flagValue:a,expectedMaxFlagValue:ZW,path:r}});continue}else if(a>e.flag)return Di({kind:uf.NavigationFlagValueTooBig,properties:{index:n,flagValue:a,expectedMaxFlagValue:e.flag,path:r}})}return Ti(!0)},"validateFlags"),qYe=pe.Object({index:pe.Integer({description:"The index of the flag in a flags array.",minimum:0}),bit:pe.Integer({description:"The bit position of the flag in a flag's bitfield.",minimum:0,maximum:31})},{$id:"NavigationFlagDeclarationCore"}),GIe=pe.Intersect([qYe,lS],{$id:"NavigationFlagDeclaration",description:'A NavigationFlagDeclaration describes the relationship between a "key" that a developer might use to wayfind using that flag, and the index and bit position in an object\'s `flags` array.'}),YW={accessible:"accessible",outdoors:"outdoors"},HIe=pe.Record(pe.String(),GIe,{$id:"NavigationFlagDeclarations",description:"Any well known and custom flags present in the MVF"}),WYe=pe.Object({navigationFlags:pe.Ref(HIe)},{$id:"NavigationFlagsSchema"}),jV=pe.Array(pe.Integer({minimum:0,maximum:Math.pow(2,32)-1}),{$id:"Flags"}),qIe=pe.Object({flags:pe.Ref(jV)},{$id:"WithFlags"}),W_=pe.Intersect([R4,qIe],{$id:"FlaggedGeometryAnchor"}),XYe=pe.Object({geometryAnchor:W_},{$id:"WithFlaggedGeometryAnchor"}),ZYe=pe.Object({geometryAnchors:pe.Array(W_)},{$id:"WithFlaggedGeometryAnchors"}),YYe={name:"ext:mvf-navigation-flags",schema:WYe,intoBundle:s(function*(t){t.navigationFlags!=null&&(yield{path:"navigationFlags.json",contents:t.navigationFlags})},"intoBundle"),fromBundle:s((t,e,r)=>t!=="navigationFlags.json"?void 0:{navigationFlags:r(e)},"fromBundle"),references:[GIe,HIe,jV,W_,XYe,ZYe],integrityCheck:HYe};N();var KYe=s(t=>{if(t.connections==null)return Ti(!0);let e=Lf(t),r=$Ie(t);for(let[i,n]of t.connections.entries()){for(let[a,o]of n.entrances.entries()){let l=e(o.floorId,o.geometryId);if(l.isErr())return l;let u=p8(o.flags,r,"connections[".concat(i,"].entrances[").concat(a,"]"));if(u.isErr())return u}for(let[a,o]of n.exits.entries()){let l=e(o.floorId,o.geometryId);if(l.isErr())return l;let u=p8(o.flags,r,"connections[".concat(i,"].exits[").concat(a,"]"));if(u.isErr())return u}}return Ti(!0)},"validateConnections"),WIe=nu("c","ConnectionId"),{schema:JYe,values:Jpt,record:QYe}=Cv(["elevator","escalator","travelator","stairs","door","ramp"],{$id:"ConnectionType"}),XIe=JYe,ZIe=QYe,YIe=pe.Intersect([pe.Object({id:pe.Ref(WIe,{description:"The unique identifier for the connection."}),entrances:pe.Array(pe.Ref(W_)),exits:pe.Array(pe.Ref(W_)),entryCost:pe.Number({description:"The cost to enter the connection.",minimum:0}),floorCostMultiplier:pe.Number({description:"The cost multiplier for each floor transitioned.",minimum:1}),type:pe.Ref(XIe,{description:"The type of connection."})}),lS,uS],{$id:"ConnectionsProperties"}),KIe=pe.Array(pe.Ref(YIe),{$id:"ConnectionsCollection"}),eKe=pe.Object({connections:pe.Ref(KIe)},{$id:"ConnectionsExtensionSchema"}),KW="connections.json",tKe={name:"ext:connections",schema:eKe,intoBundle:s(function*(t){t.connections!=null&&(yield{path:KW,contents:t.connections})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===KW)return{connections:r(e)}},"fromBundle"),references:[YIe,KIe,XIe,WIe,W_,jV],integrityCheck:KYe};N();N();var rKe=s(t=>{if(t.defaultStyle==null)return Ti(!0);let e=Lf(t);for(let r of Object.values(t.defaultStyle))if(r!=null)for(let i of r.geometryAnchors){let n=e(i.floorId,i.geometryId);if(n.isErr())return n}return Ti(!0)},"validateDefaultStyle"),JIe=pe.Intersect([aV(),uS,pe.Object({altitude:pe.Number({description:"How far off the bottom of the floor the objects with this style should be drawn, in meters."}),color:pe.String({pattern:"^#[0-9a-fA-F]{6}$",description:"Color should be represented with a hash (#), followed by 6 hexadecimal digits. ex: #RRGGBB"}),height:pe.Number({minimum:0,description:"The height of the objects belonging to this layer, in meters."}),opacity:pe.Number({minimum:0,maximum:1,description:"The opacity of the objects belonging to this layer, from 0 to 1."}),buffer:pe.Number({description:"The buffer amount to apply to the geometry, in meters. This can be used to inflate line string geometry for walls, but might also be applicable as a way to grow or shrink polygon geometry for aesthetic purposes. Can be negative."}),hidden:pe.Optional(pe.Boolean({description:"Whether or not the objects with this style should be hidden."}))})],{$id:"DefaultStyle"}),QIe=pe.Record(pe.String(),pe.Ref(JIe),{$id:"DefaultStyleCollection",additionalProperties:!1}),iKe=pe.Object({defaultStyle:pe.Ref(QIe)},{$id:"DefaultStyleSchema"}),nKe={name:"ext:mvf-default-style",schema:iKe,intoBundle:s(function*(t){t.defaultStyle!=null&&(yield{path:"default-style.json",contents:t.defaultStyle})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="default-style.json")return{defaultStyle:r(e)}},"fromBundle"),references:[JIe,QIe],integrityCheck:rKe};N();N();N();N();var d8;(function(t){t.InvalidDefaultFloorError="InvalidDefaultFloorError"})(d8||(d8={}));var aKe=s(t=>{if(t.floorStacks==null)return Ti(!0);let e=O4(t);for(let r of t.floorStacks){for(let i of r.floors){let n=e(i);if(n.isErr())return n}if(r.defaultFloor!=null&&!r.floors.includes(r.defaultFloor))return Di({kind:d8.InvalidDefaultFloorError,properties:{floorStackId:r.id,floorId:r.defaultFloor}})}return Ti(!0)},"validateFloorStacks"),$V=nu("fs","FloorStackId"),eTe=pe.Intersect([pe.Object({id:pe.Ref($V,{description:"The unique identifier for the floor stack."}),floors:pe.Array(pe.Ref($s),{uniqueItems:!0,minItems:1,description:"The floors that are part of this floor stack."}),defaultFloor:pe.Optional(pe.Ref($s,{description:"The default floor for the floor stack."}))}),lS],{$id:"FloorStacksProperties"}),tTe=pe.Array(pe.Ref(eTe),{$id:"FloorStackCollection"}),oKe=pe.Object({floorStacks:pe.Ref(tTe)},{$id:"FloorStackExtensionSchema"}),JW="floor-stacks.json",sKe={name:"ext:floor-stacks",schema:oKe,intoBundle:s(function*(t){t.floorStacks!=null&&(yield{path:JW,contents:t.floorStacks})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===JW)return{floorStacks:r(e)}},"fromBundle"),references:[$V,eTe,tTe],integrityCheck:aKe};N();N();var D3;(function(t){t.MissingFloorStackError="MissingFloorStackError",t.UnknownFloorStackError="UnknownFloorStackError"})(D3||(D3={}));var lKe=s(t=>{if(t.facade==null)return Ti(!0);if(t.floorStacks==null)return Di({kind:D3.MissingFloorStackError,properties:null});let e=new Set(t.floorStacks.map(i=>i.id)),r=Lf(t);for(let[i,n]of Es(t.facade))if(n!=null){if(!e.has(i))return Di({kind:D3.UnknownFloorStackError,properties:{floorStackId:i}});for(let a of n.geometryAnchors){let o=r(a.floorId,a.geometryId);if(o.isErr())return o}}return Ti(!0)},"validateFacade"),rTe=nu("fc","FacadeId"),iTe=pe.Intersect([pe.Object({id:pe.Ref(rTe)}),aV({minItems:1})],{$id:"FacadeProperties"}),uKe=pe.Object({facade:zu(pe.Record($V,pe.Ref(iTe),{additionalProperties:!1}))},{$id:"FacadeExtensionSchema"}),cKe=/^facade\/(.*)\.json$/,hKe={name:"ext:facade",schema:uKe,intoBundle:s(function*(t){if(t.facade!=null)for(let e of ps(t.facade))yield{path:"facade/".concat(e,".json"),contents:t.facade[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(cKe))==null?void 0:i[1];if(n)return{facade:{[n]:r(e)}}},"fromBundle"),references:[rTe,iTe],integrityCheck:lKe};N();N();var pKe=s(t=>{if(t.floorImages==null)return Ti(!0);let e=Lf(t);for(let[r,i]of Es(t.floorImages))if(i!=null)for(let n of i.features){if(!("geometryId"in n.properties))continue;let a=n.properties.geometryId,o=e(r,a);if(o.isErr())return o}return Ti(!0)},"validateFloorImages"),GV=pe.Object({path:pe.String({format:"uri",description:"The path to the image. This will be a remote URL."}),width:pe.Number({minimum:0,description:"The width of the image when represented on the map, in meters."}),height:pe.Number({minimum:0,description:"The height of the image when represented on the map, in meters."}),rotation:pe.Number({minimum:0,maximum:360,description:"Rotation in degrees, about the center of the image. North is 0, east is 90."})},{$id:"BaseFloorImageProperties"}),nTe=pe.Intersect([pe.Ref(GV),Px],{$id:"AnchoredFloorImageProperties"}),aTe=pe.Intersect([pe.Ref(GV),pe.Object({verticalOffset:pe.Number({minimum:0,description:"How high to position the image, in meters, relative to the ground plane."})})],{$id:"FloatingFloorImageProperties"}),oTe=pe.Union([nTe,aTe],{$id:"FloorImageProperties"}),sTe=Pf(pe.Ref(Tf),oTe,{$id:"FloorImageFeature"}),lTe=Ev(pe.Ref(sTe),{$id:"FloorImageCollection"}),dKe=pe.Object({floorImages:zu(pe.Record($s,pe.Ref(lTe),{additionalProperties:!1}))},{$id:"FloorImagesExtensionSchema"}),fKe=/^floorImages\/(.*)\.geojson$/,mKe={name:"ext:floor-images",schema:dKe,intoBundle:s(function*(t){if(t.floorImages!=null)for(let e of ps(t.floorImages))yield{path:"floorImages/".concat(e,".geojson"),contents:t.floorImages[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(fKe))==null?void 0:i[1];if(n)return{floorImages:{[n]:r(e)}}},"fromBundle"),references:[GV,nTe,aTe,oTe,sTe,lTe],integrityCheck:pKe};N();N();var gKe=s(t=>{if(t.kinds==null)return Ti(!0);let e=Lf(t);for(let[r,i]of Es(t.kinds))if(i!=null)for(let n of ps(i)){let a=e(r,n);if(a.isErr())return a}return Ti(!0)},"validateKinds"),{values:Qpt,schema:yKe,record:edt}=Cv(["room","hallway","wall","desk","poi","area","window"],{$id:"Kind"}),uTe=yKe,cTe=zu(pe.Record(If,pe.Ref(uTe),{additionalProperties:!1,$id:"GeometryKinds"})),vKe=pe.Object({kinds:zu(pe.Record($s,pe.Ref(cTe),{additionalProperties:!1}))},{$id:"KindsExtensionSchema"}),_Ke=/^kinds\/(.*)\.json$/,xKe={name:"ext:kinds",schema:vKe,intoBundle:s(function*(t){if(t.kinds!=null)for(let e of ps(t.kinds))yield{path:"kinds/".concat(e,".json"),contents:t.kinds[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(_Ke))==null?void 0:i[1];if(n)return{kinds:{[n]:r(e)}}},"fromBundle"),references:[uTe,cTe],integrityCheck:gKe};N();N();N();var f8;(function(t){t.UnknownNeighbor="UnknownNeighbor"})(f8||(f8={}));var bKe=s(t=>{if(t.nodes==null)return Ti(!0);let e=Lf(t),r=$Ie(t);for(let[i,n]of Es(t.nodes)){if(n==null)continue;let a=new Set(n.features.map(o=>o.properties.id));for(let[o,l]of n.features.entries()){for(let u of l.properties.geometryIds){let c=e(i,u);if(c.isErr())return c}for(let[u,c]of l.properties.neighbors.entries()){if(!a.has(c.id))return Di({kind:f8.UnknownNeighbor,properties:{floorId:i,nodeId:l.properties.id,neighborId:c.id}});let p=p8(c.flags,r,'nodes["'.concat(i,'"].features[').concat(o,"].properties.neighbors[").concat(u,"]"));if(p.isErr())return p}}}return Ti(!0)},"validateNodes"),HV=nu("n","NodeId"),hTe=pe.Intersect([pe.Object({id:pe.Ref(HV,{description:"The unique identifier for the node."}),extraCost:pe.Number({minimum:0,description:"The extra cost to traverse to the node, above the straight-line distance."})}),qIe],{$id:"NodeNeighbor"}),pTe=pe.Intersect([pe.Object({id:pe.Ref(HV,{description:"The unique identifier for the node."}),neighbors:pe.Array(pe.Ref(hTe),{description:"The neighbors of the node."})}),H2e],{$id:"NodeProperties"}),dTe=Pf(pe.Ref(Tf),pTe,{$id:"NodeFeature"}),fTe=Ev(pe.Ref(dTe),{$id:"NodeCollection"}),wKe=pe.Object({nodes:zu(pe.Record($s,pe.Ref(fTe),{additionalProperties:!1}))},{$id:"NodesExtensionSchema"}),AKe=/^nodes\/(.*)\.json$/,SKe={name:"ext:nodes",schema:wKe,intoBundle:s(function*(t){if(t.nodes!=null)for(let e of ps(t.nodes))yield{path:"nodes/".concat(e,".json"),contents:t.nodes[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i;let n=(i=t.match(AKe))==null?void 0:i[1];if(n)return{nodes:{[n]:r(e)}}},"fromBundle"),references:[HV,hTe,pTe,dTe,fTe],integrityCheck:bKe};N();N();N();var m8;(function(t){t.FloorInFloorStackError="FloorInFloorStackError"})(m8||(m8={}));var MKe=s(t=>{if(t.outdoors==null)return Ti(!0);let e=O4(t);for(let r of t.outdoors.floors){let i=e(r);if(i.isErr())return i;if(t.floorStacks!=null){for(let n of t.floorStacks)if(n.floors.includes(r))return Di({kind:m8.FloorInFloorStackError,properties:{floorId:r,floorStackId:n.id}})}}return Ti(!0)},"validateOutdoors"),mTe=pe.Object({floors:pe.Array(pe.Ref($s),{uniqueItems:!0,description:"A list of floor IDs that should be considered to contain outdoor features."})},{$id:"Outdoors"}),EKe=pe.Object({outdoors:pe.Ref(mTe)},{$id:"OutdoorsExtensionSchema"}),QW="outdoors.json",CKe={name:"ext:outdoors",schema:EKe,intoBundle:s(function*(t){t.outdoors!=null&&(yield{path:QW,contents:t.outdoors})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t===QW)return{outdoors:r(e)}},"fromBundle"),references:[mTe],integrityCheck:MKe};N();N();N();var g8;(function(t){t.TilesetDuplicateKeyError="TilesetDuplicateKeyError"})(g8||(g8={}));var IKe=s(t=>{if(t.tileset==null)return Ti(!0);let e=new Set;if(e.add(t.tileset.default.key),t.tileset.others)for(let r of t.tileset.others){if(e.has(r.key))return Di({kind:g8.TilesetDuplicateKeyError,properties:{key:r.key}});e.add(r.key)}return Ti(!0)},"validateTilesets"),y8=pe.Object({key:pe.String({minLength:1,description:"Unique identifier for the tileset style."}),name:pe.String({minLength:1,description:"Display name of the tileset style."}),url:pe.String({format:"uri",description:"URL of the tileset style."})},{$id:"TilesetStyle",description:"A tileset style definition."}),gTe=pe.Object({default:pe.Ref(y8,{description:"The default tileset style, which should be used."}),others:pe.Optional(pe.Array(pe.Ref(y8,{description:"Additional tileset styles that can be used."})))},{$id:"TilesetCollection"}),TKe=pe.Object({tileset:pe.Ref(gTe)},{$id:"TilesetExtensionSchema"}),PKe={name:"ext:mvf-tileset",schema:TKe,intoBundle:s(function*(t){t.tileset!=null&&(yield{path:"tileset.json",contents:t.tileset})},"intoBundle"),fromBundle:s((t,e,r)=>{if(t==="tileset.json")return{tileset:r(e)}},"fromBundle"),references:[y8,gTe],integrityCheck:IKe};N();var yTe=pe.Object({},{$id:"WalkableProperties"}),vTe=pe.Object({},{$id:"NonWalkableProperties"}),_Te=zu(pe.Record(If,pe.Ref(yTe),{$id:"WalkableGeometries",additionalProperties:!1})),xTe=zu(pe.Record(If,pe.Ref(vTe),{$id:"NonWalkableGeometries",additionalProperties:!1})),LKe=pe.Object({walkable:zu(pe.Record($s,pe.Ref(_Te),{additionalProperties:!1})),nonwalkable:zu(pe.Record($s,pe.Ref(xTe),{additionalProperties:!1}))},{$id:"TraversabilitySchema"}),DKe=/^walkable\/(.*)\.json$/,RKe=/^nonwalkable\/(.*)\.json$/,OKe={name:"ext:mvf-traversability",schema:LKe,intoBundle:s(function*(t){if(t.walkable!=null)for(let e of ps(t.walkable))yield{path:"walkable/".concat(e,".json"),contents:t.walkable[e]};if(t.nonwalkable!=null)for(let e of ps(t.nonwalkable))yield{path:"nonwalkable/".concat(e,".json"),contents:t.nonwalkable[e]}},"intoBundle"),fromBundle:s((t,e,r)=>{var i,n;let a=(i=t.match(DKe))==null?void 0:i[1];if(a!=null)return{walkable:{[a]:r(e)}};let o=(n=t.match(RKe))==null?void 0:n[1];if(o!=null)return{nonwalkable:{[o]:r(e)}}},"fromBundle"),references:[yTe,vTe,_Te,xTe]};N();N();function v8(t){return t.replace(/^g_/,"s_")}s(v8,"toSpaceId");function bTe(t){return t.replace(/^g_/,"o_")}s(bTe,"toObstructionId");function wTe(t){return t.replace(/^g_/,"w_")}s(wTe,"toWindowId");function ATe(t){return t.replace(/^g_/,"ar_")}s(ATe,"convertAreaId");function STe(t,e,r){switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":{let i=[],n=0,a=t.geometry.type.replace("Multi","");for(let o of t.geometry.coordinates)i.push(vt(Ee({},t),{geometry:{type:a,coordinates:o},properties:vt(Ee({},t.properties),{id:"".concat(e,"-").concat(n++),kind:r})}));return i}default:return[vt(Ee({},t),{properties:vt(Ee({},t.properties),{id:e,kind:r})})]}}s(STe,"splitMultiPartGeometryFeatureWithNewId");function e1(t,e,r,i){let n=new Map;for(let{feature:a,floorId:o}of t){let l=a.properties.id,u=i.get(l);if(e.has(l)){let c=STe(a,r(l),u),p=c.map(y=>y.properties.id),m=p.map(y=>({geometryId:y,floorId:o}));n.set(l,{ids:p,features:c,anchors:m})}}return n}s(e1,"mapGeometryToOtherIds");function MTe(t){var e,r,i;let n={space:new Map,obstruction:new Map,area:new Map,window:new Map};if(!t.geometry)return n;let a=new Map(Object.values((e=t.kinds)!=null?e:{}).filter(m=>m!==void 0).flatMap(Es)),o=Es(t.geometry).flatMap(([m,y])=>{var v;return((v=y==null?void 0:y.features)!=null?v:[]).map(x=>({feature:x,floorId:m}))}).flat(),l=new Set(Object.values((r=t.walkable)!=null?r:{}).filter(m=>m!==void 0).flatMap(ps)),u=new Set(Object.values((i=t.nonwalkable)!=null?i:{}).filter(m=>m!==void 0).flatMap(ps)),c=new Set(Array.from(a.entries()).filter(([m,y])=>y==="area").map(([m])=>m)),p=new Set(Array.from(a.entries()).filter(([m,y])=>y==="window").map(([m])=>m));return l.size>0&&(n.space=e1(o,l,v8,a)),u.size>0&&(n.obstruction=e1(o,u,bTe,a)),c.size>0&&(n.area=e1(o,c,ATe,a)),p.size>0&&(n.window=e1(o,p,wTe,a)),l.size===0&&u.size===0&&c.size===0&&(n.space=e1(o,new Set(o.map(m=>m.feature.properties.id)),v8,a)),n}s(MTe,"createGeometryMaps");function ETe(t){let e=CTe(t),r=MTe(t),i=ITe(t);return{geometryMaps:r,nodesByGeometryId:e,geometryFeatureById:i}}s(ETe,"buildBuilderOptions");function CTe(t){var e,r,i;let n=new Map;for(let a of Object.values((e=t.nodes)!=null?e:{}))for(let o of(r=a==null?void 0:a.features)!=null?r:[])if(o.properties.geometryIds.length>0)for(let l of o.properties.geometryIds){let u=(i=n.get(l))!=null?i:[];u.push(o.properties.id),n.set(l,u)}return n}s(CTe,"buildNodesByGeometryId");function ITe(t){var e,r;let i=new Map;for(let n of Object.values((e=t.geometry)!=null?e:{}))for(let a of(r=n==null?void 0:n.features)!=null?r:[])i.set(a.properties.id,a);return i}s(ITe,"buildGeometryFeatureById");N();function TTe(t,e){if(!t.annotations||!t.annotationSymbols||!t.geometry)return{};let r={};for(let[i,n]of Es(t.annotations)){if(!n||n.length===0||!t.geometry[i]||t.geometry[i].features.length===0)continue;let a=new Map(t.geometry[i].features.map(l=>[l.properties.id,l])),o={type:"FeatureCollection",features:[]};for(let l of n){let u=a.get(l.geometryId);if(!u||u.geometry.type!=="Point")continue;let c={id:l.id,externalId:l.externalId,symbolId:l.symbolKey};o.features.push({type:"Feature",geometry:u.geometry,properties:c})}r[i]=o}return{annotation:r}}s(TTe,"buildAnnotations");N();function PTe(t,{nodesByGeometryId:e}){var r,i,n,a,o,l,u;let c={"connection.json":[],entrance:{}},p=(r=t.navigationFlags)==null?void 0:r[YW.accessible],m=(i=t.navigationFlags)==null?void 0:i[YW.outdoors],y=new Map(Object.values((n=t.geometry)!=null?n:{}).flatMap(v=>{var x;return(x=v==null?void 0:v.features)!=null?x:[]}).map(v=>[v.properties.id,v]));for(let v of(a=t.connections)!=null?a:[]){if(qV(v,y)){let I=LTe(v,y,e,m);for(let[P,C]of I)c.entrance[P]||(c.entrance[P]={type:"FeatureCollection",features:[]}),c.entrance[P].features.push(C);continue}let x=p!=null&&v.entrances.every(I=>Xw(I,p))&&v.exits.every(I=>Xw(I,p)),E=Array.from(new Set([...v.entrances.map(I=>e.get(I.geometryId)),...v.exits.map(I=>e.get(I.geometryId))].flat().filter(I=>I!=null))),M={id:v.id,externalId:(l=(o=v.details)==null?void 0:o.externalId)!=null?l:"",type:v.type,accessible:x,nodes:E};(u=v.details)!=null&&u.name&&(M.details={name:v.details.name}),v.extra&&(M.extra=v.extra),c["connection.json"].push(M)}return c}s(PTe,"buildConnections");function qV(t,e){return t.type==ZIe.door&&t.entrances.every(r=>{let i=e.get(r.geometryId);return(i==null?void 0:i.geometry.type)==="LineString"})}s(qV,"isLineDoor");function LTe(t,e,r,i){var n,a;if(t.type!==ZIe.door)return[];let o=[];for(let l of t.entrances){let u=e.get(l.geometryId);if((u==null?void 0:u.geometry.type)==="LineString"){let c={type:"Feature",geometry:u.geometry,properties:{id:t.id,externalId:(a=(n=t.details)==null?void 0:n.externalId)!=null?a:"",isExterior:DTe(t,i)}},p=t.details;p&&(c.properties.details={name:p.name,description:p.description},p.icon&&(c.properties.details.images=[{url:p.icon,altText:"".concat(p.name," icon")}]));let m=r.get(l.geometryId);m&&m.length>0&&(c.properties.node=m[0]),o.push([l.floorId,c])}}return o}s(LTe,"buildEntranceFeaturesFromConnection");function DTe(t,e){return t.entrances.some(r=>Xw(r,e))||t.exits.some(r=>Xw(r,e))}s(DTe,"isExterior");N();function RTe(t,{geometryMaps:e,nodesByGeometryId:r}){var i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T,D,F,k,B,U;if(!t.enterprise)return{};let z={categories:[],locations:[],locationInstances:[],layers:[],venue:{slug:"",name:"",externalId:"",defaultLanguage:{name:"",code:""},languages:[]}},q=(i=t.manifest)==null?void 0:i.features[0];if(q&&(z.venue.defaultFloor=q.properties.defaultFloor,z.venue.tzid=q.properties.tzid,z.venue.name=q.properties.name),t.enterprise.venue){let se=t.enterprise.venue;z.venue=vt(Ee({},z.venue),{slug:se.slug,name:(n=se.details.name)!=null?n:z.venue.name,externalId:(a=se.details.externalId)!=null?a:"",defaultLanguage:se.defaultLanguage,languages:se.languages,countrycode:se.countrycode,coverImage:se.coverImage,logo:se.logo,icon:se.details.icon,extra:se.extra,mappedinWebUrl:se.mappedinWebUrl,operationHours:se.operationHours,topLocations:se.topLocations})}let Z=new Map,Q=new Map,V=t.locations,ae=t.enterprise.locations;if(V&&ae){let se=new Map(V.map(de=>[de.id,de]));for(let de of ae){let we=se.get(de.locationId);if(we){let Le=we.details,fe={id:de.id,name:Le.name,externalId:(o=Le.externalId)!=null?o:"",type:de.type,sortOrder:de.sortOrder,amenity:de.amenity,description:Le.description,extra:we.extra,links:we.links,operationHours:we.openingHours,gallery:de.gallery,logo:we.logo,shortName:Le.shortName,picture:de.picture,showFloatingLabelWhenImagePresent:de.showFloatingLabelWhenImagePresent,showLogo:de.showLogo,siblingGroups:de.siblingGroups,states:de.states,tags:de.tags,spaces:[],nodes:[],polygons:[]};we.phone&&(fe.phone={number:we.phone});let Re=_8(we.social);we.website&&(Re.website=we.website.url),fe.social=Re;for(let me of we.geometryAnchors){let Ae=e.space.get(me.geometryId);if(Ae){let _e=new Set(Ae.features.filter(lt=>lt.geometry.type==="Polygon").map(lt=>lt.properties.id));for(let lt of Ae.anchors)fe.spaces.push({floor:lt.floorId,id:lt.geometryId}),_e.has(lt.geometryId)&&fe.polygons.push({map:lt.floorId,id:lt.geometryId})}let Ue=r.get(me.geometryId);for(let _e of Ue??[])fe.nodes.push({map:me.floorId,id:_e})}z.locations.push(fe);for(let me of we.categories)Z.set(me,[...(l=Z.get(me))!=null?l:[],de.id]);Q.set(de.id,we.categories)}}}let Y=t.enterprise.locationInstances,he=t.locationInstances;if(Y&&he){let se=new Map(he.map(we=>[we.id,we])),de=[];for(let we of Y){let Le=se.get(we.locationInstanceId);if(Le){let fe={id:we.id,parent:we.parentId,name:(u=Le.details)==null?void 0:u.name,externalId:(c=Le.details)==null?void 0:c.externalId,type:we.type,sortOrder:we.sortOrder,amenity:we.amenity,description:(p=Le.details)==null?void 0:p.description,extra:Le.extra,links:Le.links,operationHours:Le.openingHours,gallery:we.gallery,picture:we.picture,showFloatingLabelWhenImagePresent:we.showFloatingLabelWhenImagePresent,showLogo:we.showLogo,siblingGroups:we.siblingGroups,states:we.states,tags:we.tags,logo:Le.logo,shortName:(m=Le.details)==null?void 0:m.shortName};Le.phone&&(fe.phone={number:Le.phone});let Re=_8((y=Le.social)!=null?y:[]);if(Le.website&&(Re.website=Le.website.url),Object.keys(Re).length>0&&(fe.social=Re),(v=Le.geometryAnchors)!=null&&v.length){let me=Le.geometryAnchors.flatMap(Ae=>{var Ue,_e;return(_e=(Ue=e.space.get(Ae.geometryId))==null?void 0:Ue.anchors)!=null?_e:[]});me.length>0&&(fe.spaces=me.map(Ae=>({floor:Ae.floorId,id:Ae.geometryId})))}if(Le.geometryAnchors){fe.spaces=[],fe.polygons=[],fe.nodes=[];for(let me of Le.geometryAnchors){let Ae=e.space.get(me.geometryId);if(Ae){let _e=new Set(Ae.features.filter(lt=>lt.geometry.type==="Polygon").map(lt=>lt.properties.id));for(let lt of Ae.anchors)fe.spaces.push({floor:lt.floorId,id:lt.geometryId}),_e.has(lt.geometryId)&&fe.polygons.push({map:lt.floorId,id:lt.geometryId})}let Ue=r.get(me.geometryId);for(let _e of Ue??[])fe.nodes.push({map:me.floorId,id:_e})}}de.push(fe)}}de.length>0&&(z.locationInstances=de)}let J=t.locationCategories,ne=t.enterprise.categories;if(J&&ne){let se=[],de=new Map(J.map(Re=>[Re.id,Re])),we=new Map(ne.map(Re=>[Re.categoryId,Re.id])),Le=new Map;for(let Re of J){let me=we.get(Re.parent);if(me){let Ae=(x=Le.get(me))!=null?x:[];Ae.push(Re.id),Le.set(me,Ae)}}for(let Re of ne){let me=de.get(Re.categoryId);if(me){let Ae=((E=Le.get(Re.id))!=null?E:[]).map(_e=>we.get(_e)).filter(_e=>_e!==void 0),Ue={id:Re.id,name:me.details.name,externalId:(M=me.details.externalId)!=null?M:"",sortOrder:Re.sortOrder,children:Ae,locations:(I=Z.get(Re.categoryId))!=null?I:[],icon:me.details.icon,picture:Re.picture,color:Re.color,extra:me.extra,iconFromDefaultList:Re.iconFromDefaultList};se.push(Ue)}}z.categories=se;let fe={};for(let[Re,me]of Q.entries())fe[Re]=me.map(Ae=>we.get(Ae)).filter(Ae=>Ae!==void 0);z.categoryPriorities=fe}let ee={};for(let[se,de]of Object.entries((P=t.defaultStyle)!=null?P:{}))if(de.buffer>0){let we=de.geometryAnchors.flatMap(Le=>{var fe,Re;return(Re=(fe=e.space.get(Le.geometryId))==null?void 0:fe.anchors)!=null?Re:[]});ee[se]={edgeOffset:de.buffer,geometryAnchors:we}}Object.keys(ee).length>0&&(z.enterpriseStyles=ee);let ue=new Map;for(let se of Object.values((C=t.enterprise.layers)!=null?C:{}))if(se)for(let[de,we]of Es(se)){if(typeof we!="string")continue;let Le=(T=ue.get(we))!=null?T:{name:we,id:"ely_".concat(we),spaces:[]};Le.spaces.push(...(F=(D=e.space.get(de))==null?void 0:D.anchors.map(fe=>({floorId:fe.floorId,spaceId:fe.geometryId})))!=null?F:[]),ue.set(we,Le)}ue.size>0&&(z.layers=Array.from(ue.values()));let K=[];for(let se of Object.values((k=t.enterprise.textures)!=null?k:{}))for(let de of se){let we=(B=e.space.get(de.geometryId))==null?void 0:B.anchors;!we||we.length<1||de.face==="unknown"||de.surface==="unknown"||K.push({repeat:de.repeat,offset:de.offset,rotation:de.rotation,path:de.path,face:de.face,surface:de.surface,bounds:de.bounds,geometryAnchors:we})}K.length>0&&(z.textures=K);let ce={};for(let[se,de]of Object.entries((U=t.enterprise.floorText)!=null?U:{})){let we={type:"FeatureCollection",features:[]};for(let Le of de.features){if(Le.properties.align==="unknown")continue;let fe={align:Le.properties.align,color:Le.properties.color,fontFamily:Le.properties.fontFamily,fontSize:Le.properties.fontSize,rotation:Le.properties.rotation,text:Le.properties.text,visible:Le.properties.visible};"geometryId"in Le.properties?fe.geometryId=Le.properties.geometryId:fe.verticalOffset=Le.properties.verticalOffset,we.features.push({type:"Feature",geometry:Le.geometry,properties:fe})}we.features.length>0&&(ce[se]=we)}Object.keys(ce).length>0&&(z.floorText=ce);let re={enterprise:z};if(t.enterprise.textAreas){let se={};for(let[de,we]of Es(t.enterprise.textAreas)){let Le={type:"FeatureCollection",features:[]};for(let fe of we.features){if(fe.properties.align==="unknown")continue;let Re={align:fe.properties.align,maxWidth:fe.properties.maxWidth,maxHeight:fe.properties.maxHeight,rotation:fe.properties.rotation};"geometryId"in fe.properties?Re.anchorId=fe.properties.geometryId:Re.verticalOffset=fe.properties.verticalOffset;let me={type:"Feature",geometry:fe.geometry,properties:Re};Le.features.push(me)}se[de]=Le}re.textAreas=se}return re}s(RTe,"buildEnterprise");var kKe=["facebook","instagram","twitter"];function _8(t){let e={};for(let{name:r,url:i}of t){let n=r.toLowerCase();kKe.includes(n)&&(e[n]=i)}return e}s(_8,"convertSocials");N();function OTe(t,{geometryMaps:e}){if(!t.facade)return{};let r={},i={};for(let[n,a]of Es(t.facade))a&&(i[n]={id:a.id,spaces:a.geometryAnchors.flatMap(({floorId:o,geometryId:l})=>{var u;return(u=e.space.get(l))==null?void 0:u.ids.map(c=>({floorId:o,spaceId:c}))}).filter(o=>o!==void 0)});return Object.keys(i).length>0&&(r.facade=i),r}s(OTe,"buildFacade");N();function kTe(t,e={}){var r,i,n,a,o,l,u,c,p,m,y,v;let x={type:"FeatureCollection",features:[]},E=[];for(let M of t.floors.features)E.push({id:M.properties.id.replace(/^f_/,"m_"),externalId:(i=(r=M.properties.details)==null?void 0:r.externalId)!=null?i:"",elevation:M.properties.elevation,name:(a=(n=M.properties.details)==null?void 0:n.name)!=null?a:"",shortName:(l=(o=M.properties.details)==null?void 0:o.shortName)!=null?l:"",subtitle:M.properties.subtitle}),x.features.push({type:"Feature",geometry:M.geometry,properties:{id:M.properties.id,externalId:(c=(u=M.properties.details)==null?void 0:u.externalId)!=null?c:"",elevation:M.properties.elevation,name:(m=(p=M.properties.details)==null?void 0:p.name)!=null?m:"",shortName:(v=(y=M.properties.details)==null?void 0:y.shortName)!=null?v:"",subtitle:M.properties.subtitle}});return{"floor.geojson":x,"map.geojson":E}}s(kTe,"buildFloors");N();function NTe(t,{geometryMaps:e}){var r,i,n,a,o;let l={},u={};for(let[c,p]of Es((r=t.floorImages)!=null?r:{})){let m={features:[],type:"FeatureCollection"};for(let y of(i=p==null?void 0:p.features)!=null?i:[])if("verticalOffset"in y.properties)m.features.push(y);else{let v=y.properties,{geometryId:x}=v,E=Nh(v,["geometryId"]),M=(o=(n=e.space.get(x))==null?void 0:n.ids[0])!=null?o:(a=e.obstruction.get(x))==null?void 0:a.ids[0];if(!M)continue;let I={geometry:y.geometry,properties:vt(Ee({},E),{anchorId:M}),type:y.type};m.features.push(I)}u[c]=m}return Object.keys(u).length>0&&(l.floorImages=u),l}s(NTe,"buildFloorImages");N();function FTe(t,e={}){var r,i,n,a,o,l,u;let c=[];for(let p of(r=t==null?void 0:t.floorStacks)!=null?r:[]){let m={id:p.id,floors:p.floors,maps:p.floors,externalId:(n=(i=p.details)==null?void 0:i.externalId)!=null?n:"",name:(o=(a=p.details)==null?void 0:a.name)!=null?o:"",shortName:(u=(l=p.details)==null?void 0:l.shortName)!=null?u:"",type:"Building"};p.defaultFloor&&(m.defaultFloor=p.defaultFloor),c.push(m)}if(t.outdoors){let p={id:"outdoors",floors:t.outdoors.floors,maps:t.outdoors.floors,type:"Outdoor",name:"Outdoors",externalId:"outdoors"};c.push(p)}return{"floorstack.json":c,"mapstack.geojson":c}}s(FTe,"buildFloorStacks");N();N();var NKe=Rr(pWe(),1),FKe=s(t=>{let e=t.geometry.coordinates[0],r=0;for(let i=0;i<e.length-1;i++)r+=e[i][0]*e[i+1][1]-e[i+1][0]*e[i][1];return Math.abs(r/2)},"calculateArea"),BKe=s((t,e)=>{let[r,i]=t,n=e.geometry.coordinates[0],a=!1;for(let o=0,l=n.length-1;o<n.length;l=o++){let[u,c]=n[o],[p,m]=n[l];c>i!=m>i&&r<(p-u)*(i-c)/(m-c)+u&&(a=!a)}return a},"pointInPolygon"),zKe=s(t=>{let e=t.geometry.coordinates[0],r=0,i=0;for(let n=0;n<e.length-1;n++)r+=e[n][0],i+=e[n][1];return{geometry:{coordinates:[r/(e.length-1),i/(e.length-1)]}}},"calculateCenterOfMass"),UKe=s(t=>{let e=FKe(t),r=Number.isFinite(e)?Math.max(e,1):1;return Math.sqrt(r)*1e-6},"estimatePrecision"),WV=s(t=>{try{let e=zKe(t).geometry.coordinates;if(!BKe(e,t)){let r=(0,NKe.default)(t.geometry.coordinates,UKe(t));return Ti([r[0],r[1]])}return Ti(e)}catch{return Di(new Error("Unable to calculate center of polygon"))}},"labelCenter");function $4(t){var e;return((e=t==null?void 0:t.geometry)==null?void 0:e.type)==="Polygon"}s($4,"isPolygonFeature");function BTe(t,{geometryMaps:e,nodesByGeometryId:r}){var i,n,a,o,l,u,c,p,m;let y=$Te(t.defaultStyle),v={},x={},E={},M={};for(let P of ps(t.geometry)){let C=t.geometry[P];if(!C)continue;let T=[],D=[],F=[],k=[];for(let B of C.features){let U=B.properties.id,z=y.has(U),q=(i=r.get(U))!=null?i:[];for(let Z of(a=(n=e.space.get(U))==null?void 0:n.features)!=null?a:[])T.push(zTe(Z,q));for(let Z of(l=(o=e.obstruction.get(U))==null?void 0:o.features)!=null?l:[])D.push(UTe(Z,z));for(let Z of(c=(u=e.area.get(U))==null?void 0:u.features)!=null?c:[])F.push(VTe(Z,q));for(let Z of(m=(p=e.window.get(U))==null?void 0:p.features)!=null?m:[])k.push(jTe(Z))}T.length>0&&(v[P]={type:"FeatureCollection",features:T.filter(B=>B!==null)}),D.length>0&&(x[P]={type:"FeatureCollection",features:D.filter(B=>B!==null)}),F.length>0&&(E[P]={type:"FeatureCollection",features:F.filter(B=>B!==null)}),k.length>0&&(M[P]={type:"FeatureCollection",features:k.filter(B=>B!==null)})}let I={space:v,obstruction:x};return Object.keys(E).length>0&&(I.area=E),Object.keys(M).length>0&&(I.window=M),I}s(BTe,"buildGeometry");function zTe(t,e){var r,i;switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":return null}let n={type:"Feature",geometry:t.geometry,properties:{destinationNodes:e,id:t.properties.id,externalId:(i=(r=t.properties.details)==null?void 0:r.externalId)!=null?i:"",kind:t.properties.kind}};return t.properties.details&&(n.properties.details={name:t.properties.details.name,description:t.properties.details.description,images:t.properties.details.icon?[{url:t.properties.details.icon,altText:t.properties.details.name?"".concat(t.properties.details.name," icon"):"icon"}]:void 0}),$4(n)&&(n.properties.center=WV(n).unwrapOr(void 0)),n}s(zTe,"buildSpace");function UTe(t,e){var r,i;switch(t.geometry.type){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"Point":return null}let n=t.properties,a={type:"Feature",geometry:t.geometry,properties:{id:n.id,externalId:(i=(r=n.details)==null?void 0:r.externalId)!=null?i:"",entrances:[],kind:n.kind,footprintComponent:e}};return $4(a)&&(a.properties.center=WV(a).unwrapOr(void 0)),n.details&&(a.properties.details={name:n.details.name,description:n.details.description,images:n.details.icon?[{url:n.details.icon,altText:n.details.name?"".concat(n.details.name," icon"):"icon"}]:void 0}),a}s(UTe,"buildObstruction");function VTe(t,e){var r,i;if(t.geometry.type!=="Polygon")return null;let n=t.properties,a={type:"Feature",geometry:t.geometry,properties:{id:n.id,externalId:(i=(r=n.details)==null?void 0:r.externalId)!=null?i:"",destinationNodes:e}};return $4(a)&&(a.properties.center=WV(a).unwrapOr(void 0)),n.details&&(a.properties.details={name:n.details.name,description:n.details.description,images:n.details.icon?[{url:n.details.icon,altText:n.details.name?"".concat(n.details.name," icon"):"icon"}]:void 0}),a}s(VTe,"buildArea");function jTe(t){return t.geometry.type!=="LineString"?null:{type:"Feature",geometry:t.geometry,properties:{id:t.properties.id}}}s(jTe,"buildWindow");function $Te(t){var e,r,i,n;let a=[...(r=(e=t==null?void 0:t.ExteriorWalls)==null?void 0:e.geometryAnchors)!=null?r:[],...(n=(i=t==null?void 0:t.Walls)==null?void 0:i.geometryAnchors)!=null?n:[]];return new Set(a.map(o=>o.geometryId))}s($Te,"calculateFootprintGeometry");N();function GTe(t,{geometryMaps:e,geometryFeatureById:r}){var i,n,a,o,l,u,c,p,m,y,v,x,E;if(!t.locationCategories&&!t.locations)return{};let M={};if((i=t.locationCategories)!=null&&i.length){let I=[];for(let P of t.locationCategories){let C={id:P.id,name:P.details.name,icon:(n=P.details.icon)!=null?n:""};P.parent&&(C.parent=P.parent),I.push(C)}M["category.json"]=I}if((a=t.locations)!=null&&a.length){let I=HTe(t,{geometryFeatureById:r}),P=[];for(let C of t.locations){let T={id:C.id,name:C.details.name,categories:C.categories,spaces:[],obstructions:[],areas:[],annotations:[],connections:[],entrances:[],links:C.links,openingHoursSpecification:(o=C.openingHours)!=null?o:[],pictures:C.images,social:C.social,description:C.details.description,externalId:C.details.externalId,icon:C.details.icon,logo:C.logo,phone:C.phone,website:C.website};P.push(T);for(let{geometryId:D,floorId:F}of C.geometryAnchors)T.spaces.push(...(u=(l=e.space.get(D))==null?void 0:l.ids.map(k=>({id:k,floor:F})))!=null?u:[]),T.obstructions.push(...(p=(c=e.obstruction.get(D))==null?void 0:c.ids.map(k=>({id:k,floor:F})))!=null?p:[]),T.areas.push(...(y=(m=e.area.get(D))==null?void 0:m.ids.map(k=>({id:k,floor:F})))!=null?y:[]),T.entrances.push(...(v=I.entrancesByGeometryId.get(D))!=null?v:[]),T.connections.push(...(x=I.connectionsByGeometryId.get(D))!=null?x:[]),T.annotations.push(...(E=I.annotationsByGeometryId.get(D))!=null?E:[])}M["location.json"]=P}return M}s(GTe,"buildLocations");function HTe(t,{geometryFeatureById:e}){var r,i,n;let a={annotationsByGeometryId:new Map,connectionsByGeometryId:new Map,entrancesByGeometryId:new Map};if(t.annotations)for(let[o,l]of Es(t.annotations))for(let u of l??[]){let c=u.geometryId,p=u.id,m=(r=a.annotationsByGeometryId.get(c))!=null?r:[];m.push({floor:o,id:p}),a.annotationsByGeometryId.set(c,m)}if(t.connections)for(let o of t.connections){let l=qV(o,e),u=Array.from(new Map([...o.entrances,...o.exits].map(c=>["".concat(c.geometryId,"_").concat(c.floorId),c])).values());for(let c of u){let p=c.geometryId;if(l){let m=(i=a.entrancesByGeometryId.get(p))!=null?i:[];m.push({floor:c.floorId,id:o.id}),a.entrancesByGeometryId.set(p,m)}else{let m=(n=a.connectionsByGeometryId.get(p))!=null?n:[];m.push(o.id),a.connectionsByGeometryId.set(p,m)}}}return a}s(HTe,"buildLocationAttachmentMaps");N();function qTe(t,e){let r={features:[],type:"FeatureCollection"},i={"manifest.geojson":r},n=t.manifest;if(n.features.length>0){let a=n.features[0],o=a.properties,l={type:"Feature",geometry:a.geometry,properties:{folder_struct:[],version:"2.0.0",time:o.time,name:o.name,naturalBearing:o.naturalBearing,tzid:o.tzid,map:o.mapId,org_id:o.orgId,language:o.language}};r.features.push(l)}return i}s(qTe,"buildManifest");N();function WTe(t,{geometryMaps:e}){var r,i,n,a,o,l,u,c,p,m,y,v,x,E,M;let I={"node.geojson":{type:"FeatureCollection",features:[]}},P=I["node.geojson"].features,C=new Map;for(let F of(i=(r=t.floors)==null?void 0:r.features)!=null?i:[])C.set(F.properties.id,F.properties.elevation);let T=new Map;for(let F of Object.values((n=t.nodes)!=null?n:{}))for(let k of(a=F==null?void 0:F.features)!=null?a:[])for(let B of k.properties.geometryIds)T.set(B,[...(o=T.get(B))!=null?o:[],k.properties.id]);let D=new Map;for(let F of(l=t.connections)!=null?l:[]){let k=F.exits.map(B=>{var U;return vt(Ee({},B),{nodes:(U=T.get(B.geometryId))!=null?U:[]})});for(let B of F.entrances){let U=(u=T.get(B.geometryId))!=null?u:[];for(let z of U)for(let q of k){let Z=Math.abs(((c=C.get(B.floorId))!=null?c:0)-((p=C.get(q.floorId))!=null?p:0))*F.floorCostMultiplier,Q=(m=D.get(z))!=null?m:[];Q.push(...q.nodes.map(V=>({id:V,weight:Z+F.entryCost}))),D.set(z,Q)}}}for(let[F,k]of Es((y=t.nodes)!=null?y:{}))for(let B of(v=k==null?void 0:k.features)!=null?v:[]){let U=(x=e.space.get(B.properties.geometryIds[0]))==null?void 0:x.features[0],z=(U==null?void 0:U.geometry.type)==="Point"&&(E=U==null?void 0:U.properties.details)!=null&&E.externalId?U.properties.details.externalId:"",q={type:"Feature",geometry:B.geometry,properties:{id:B.properties.id,floor:F,space:B.properties.geometryIds.map(Z=>{var Q;return(Q=e.space.get(Z))==null?void 0:Q.ids}).flat().filter(Z=>Z!==void 0),neighbors:[...B.properties.neighbors.map(Z=>({id:Z.id,weight:Z.extraCost})),...(M=D.get(B.properties.id))!=null?M:[]],map:F,externalId:z}};P.push(q)}return I}s(WTe,"buildNodes");N();function XTe(t,e){let r={};for(let i of t){let n=e.get(i);n&&(r[n]!=null||(r[n]=[]),r[n].push(i))}return r}s(XTe,"groupGeometryByType");function ZTe(t,{geometryMaps:e}){var r,i,n;if(!t.defaultStyle)return{};let a={},o={};a["styles.json"]=o;let l=[...Array.from(e.space.values()).map(c=>c.features),...Array.from(e.obstruction.values()).map(c=>c.features)],u=new Map(l.flatMap(c=>c.map(p=>[p.properties.id,p.geometry.type])));for(let[c,p]of Es(t.defaultStyle)){let m=XTe(p.geometryAnchors.flatMap(y=>{var v,x,E,M;return[...(x=(v=e.space.get(y.geometryId))==null?void 0:v.ids)!=null?x:[],...(M=(E=e.obstruction.get(y.geometryId))==null?void 0:E.ids)!=null?M:[]]}),u);if(m.Point&&m.Point.length>0){let y={points:Array.from(m.Point.values()),showImage:((r=p.extra)==null?void 0:r.showImage)!==void 0?((i=p.extra)==null?void 0:i.showImage)===!0:p.opacity!==0};o["".concat(c,".Point")]=y}if(m.LineString&&m.LineString.length>0){let y={lineStrings:Array.from(m.LineString.values()),altitude:p.altitude,color:p.color,height:p.height,opacity:p.opacity,width:p.buffer};o["".concat(c,".LineString")]=y}if(m.Polygon&&m.Polygon.length>0){let y={polygons:Array.from(m.Polygon.values()),altitude:p.altitude,color:p.color,height:p.height,opacity:p.opacity};((n=p.extra)==null?void 0:n.showImage)!==void 0&&(y.showImage=p.extra.showImage===!0),o["".concat(c,".Polygon")]=y}}return a}s(ZTe,"buildStyles");var VKe=bYe().extendOptional(YYe).extendOptional(SKe).extendOptional(tKe).extendOptional(xKe).extendOptional(OKe).extendOptional(nKe).extendOptional(sKe).extendOptional(CKe).extendOptional(PKe).extendOptional(mKe).extendOptional(hKe).extendOptional(aZe).extendOptional(EYe).extendOptional(GYe).build().expect("Invalid parser, this should never happen. Likely a bug in the MVFv2 library, or one of the extensions.");function YTe(t){let e=ETe(t),r=kTe(t,e),i=BTe(t,e),n=WTe(t,e),a=PTe(t,e),o=ZTe(t,e),l=FTe(t,e),u=NTe(t,e),c=OTe(t,e),p=TTe(t),m=GTe(t,e),y=RTe(t,e),v=qTe(t);return Ee(Ee(Ee(Ee(Ee(Ee(vt(Ee(Ee(Ee(Ee(Ee(Ee({},r),i),n),a),o),l),{"tileset.json":t.tileset}),u),c),p),m),y),v)}s(YTe,"convertUnzippedStandardMVFv3ToParsedMVFv2");async function KTe(t){let e=await VKe.decompress(t);return e.isOk()?Ti(YTe(e.value)):Di(e.error)}s(KTe,"extractAndConvertMVFv3");N();function G4(t){return t.endsWith("/")?t:"".concat(t,"/")}s(G4,"normalizeUrl");N();var XV="https://app.mappedin.com/",jKe="https://auth.mappedin.com/";N();N();var $Ke=s(t=>{let e=Date.now();return t-e},"fromNow"),JTe=s((t,e)=>$Ke(t)<=e*60*1e3,"shouldRefreshToken"),QTe=60,GKe=QTe*60*1e3,eX="accessTokens";async function ZV(t,e=!1){let r="".concat(t.key),i=O_.getInstance(),n=(i==null?void 0:i.loadSessionData(eX))||{},a=Math.floor(Date.now()/1e3);if(n[r]&&!JTe(n[r].expiresTimestamp*1e3,QTe))return n[r];let o=e?await e3e(t,a):await t3e(t,a),l=vt(Ee({},n),{[r]:o});return i==null||i.saveSessionData(eX,l),o}s(ZV,"getAccessToken");async function e3e(t,e){var r;let i="".concat((r=t.baseAuthUri)!=null?r:jKe,"oauth2/token"),n=await ld()(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials",client_id:t.key,client_secret:t.secret})});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText,": ").concat(await n.text()));let a=await n.json();return{accessToken:a.access_token,expiresTimestamp:e+a.expires_in}}s(e3e,"fetchAccessTokenEnterprise");async function t3e(t,e){let r="".concat(t.baseAuthUri?G4(t.baseAuthUri):XV,"api/api-key/token"),i=await ld()(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t.key,secret:t.secret})});if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText,": ").concat(await i.text()));let n=await i.json();return{accessToken:n.access_token,expiresTimestamp:e+n.expires_in}}s(t3e,"fetchAccessToken");N();var r3e=60,HKe=r3e*60*1e3,tX="miSasTokens";async function i3e(t,e){let r="".concat(e,"__").concat(t.mapId),i=O_.getInstance(),n=(i==null?void 0:i.loadSessionData(tX))||{};if(n[r]&&!JTe(n[r].expires,r3e))return n[r];let a=await n3e(t,e),o=vt(Ee({},n),{[r]:{token:a.token,expires:new Date(a.expires).getTime()}});return i==null||i.saveSessionData(tX,o),a}s(i3e,"getSasToken");async function n3e(t,e){let r="".concat(t.baseUri?G4(t.baseUri):XV,"api/v1/venue/").concat(t.mapId,"/sas-token"),i=await ld()(r,{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText,": ").concat(await i.text()));let n=await i.json();return{token:n.token,expires:new Date(n.expires).getTime()}}s(n3e,"fetchSasToken");var rX=globalThis.fetch,iX,qKe=(iX=ja==null?void 0:ja.env)==null?void 0:iX.npm_package_version;function ld(){if(rX==null)throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return rX}s(ld,"isomorphicFetch");var x8={supplementaryUrl:"https://api-gateway.mappedin.com/analytics/",headers:{},accessToken:"",clientId:"",noAuth:!1,includeHidden:!0,clientSecret:"",apiGateway:"",authorization:"",perspective:"Website",language:"",venue:""};function a3e(t){var e;let r=Ee(Ee({},x8),t);return r.headers=vt(Ee({},r.headers),{"mappedin-sdk-version":qKe}),r.things=[],"platformString"in t&&(r.headers=vt(Ee({},r.headers),{"mappedin-platform-version":t.platformString})),r.noAuth||(r.accessToken?r.authorization="Bearer ".concat(r.accessToken):r.clientId&&r.clientSecret&&(r.authorization="Basic ".concat(globalThis.btoa("".concat(r.clientId,":").concat(r.clientSecret))))),r.language=(e=r.language)==null?void 0:e.toLowerCase(),r}s(a3e,"parseOptions");function o3e(t,e,r=!1){t.language,t.clientId,t.clientSecret;let{headers:i}=t;i["Content-Type"]=i["Content-Type"]||"text/json",t.accessToken?i.Authorization="Bearer ".concat(t.accessToken):t.noAuth||t.clientId&&t.clientSecret&&(i["x-mappedin-key"]=btoa(t.clientId),i["x-mappedin-secret"]=btoa(t.clientSecret));let n={method:"GET",headers:i};return t.secure&&(e+="&withcdntoken"),{req:n,url:e}}s(o3e,"constructParamsForRequest");async function s3e(t,e,r=!1){let i=o3e(t,e,r),n=await ld()(i.url,i.req);if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText));return n.json()}s(s3e,"generateAPIRequest");var WKe=s(t=>{let e=t!=null&&typeof t=="object"&&"perspectives"in t&&t.perspectives!=null&&typeof t.perspectives=="object"?t.perspectives:null;if(e==null||Object.keys(e).length===0)return Vt.warn("No perspectives available in response!"),null;let r={};for(let[i,n]of Object.entries(e)){let a="url"in n&&typeof n.url=="string"?n.url:null,o="locale_packs"in n&&typeof n.locale_packs=="object"?n.locale_packs:null;if(a==null||o==null){Vt.warn("Perspective ".concat(i," is missing url or locale_packs!"));continue}r[i]={url:a,locale_packs:o}}return r},"getPerspectivesFromResponse");async function l3e(t,e="exports/mvf/1/bundle"){var r,i;let n=a3e(Ee(Ee({baseUri:"https://api-gateway.mappedin.com/"},x8),t)),a="".concat(n.baseUri+e,"?venue=").concat(n.venue,"&version=").concat((r=n.version)!=null?r:"2.0.0");n.headers["Content-Type"]="application/zip";let o=await s3e(n,a),l=o.url,u=o.locale_packs,c=(i=n.perspective)!=null?i:x8.perspective,p=WKe(o);if(c!=null&&c!==""&&p!=null){let m=p[c];m==null?Vt.warn("Perspective ".concat(c," not found in response! Loading default perspective instead.")):(Vt.log('Loading perspective "'.concat(c,'"')),l=m.url,u=m.locale_packs)}return{url:l,localePacks:u,updated_at:o.updated_at}}s(l3e,"getVenueMVFURL");var zb=function(){let t;return()=>(t||(t=new TextDecoder),t)}();async function b8(t,{signal:e}){let r=await(await ld()(t,{signal:e})).arrayBuffer();return new Uint8Array(r)}s(b8,"getLanguagePackUnitArray");async function H4(t){let e=(await ag(async()=>{const{unzipSync:i}=await import("./browser-CR4WWHP7-DXjBdY_C.js");return{unzipSync:i}},[])).unzipSync(t),r={};if(e["enterprise/"]!=null){r.enterprise={};let i=e["enterprise/locations.json"];i&&(r.enterprise.locations=JSON.parse(zb().decode(i)));let n=e["enterprise/categories.json"];n&&(r.enterprise.categories=JSON.parse(zb().decode(n)))}return e["floorstack.json"]&&(r["floorstack.json"]=JSON.parse(zb().decode(e["floorstack.json"]))),e["floor.geojson"]&&(r["floor.geojson"]=JSON.parse(zb().decode(e["floor.geojson"]))),e["manifest.json"]&&(r["manifest.geojson"]=JSON.parse(zb().decode(e["manifest.json"]))),r}s(H4,"parseLanguagePack");async function u3e(t,{signal:e}){try{let r=await(await ld()(t,{signal:e})).arrayBuffer();if(e.aborted)return;let i=new Uint8Array(r);return await H4(i)}catch(r){let i=new Error("downloadLanguagePack failed");throw i.cause=r,i}}s(u3e,"downloadLanguagePack");async function c3e(t){return new Promise(async(e,r)=>{try{let i=t.useDraftData?"exports/mvf2-draft/1/bundle":"exports/mvf2/1/bundle",{url:n,localePacks:a}=await l3e(t,i),o=await ld()(n).then(u=>u.arrayBuffer()),l=new Uint8Array(o);e({compressed:l,localePacks:a})}catch(i){r(i)}})}s(c3e,"downloadVenueBundleMVFAPIGateway");async function h3e(t,e){return new Promise(async(r,i)=>{try{let{url:n}=await p3e(t,e),a=await ld()(n).then(l=>l.arrayBuffer()),o=new Uint8Array(a);r(o)}catch(n){i(n)}})}s(h3e,"downloadMVF");async function p3e(t,e){let r=new URL("".concat(t.baseUri?G4(t.baseUri):XV,"api/venue/").concat(t.mapId,"/mvf"));t.viewId&&r.searchParams.set("configId",t.viewId),t.mvfVersion&&r.searchParams.set("version",t.mvfVersion);let i=await ld()(r.toString(),{headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("".concat(i.status," ").concat(i.statusText));return i.json()}s(p3e,"getMakerBundleURL");function YV(t){var e,r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P;let C=new TextDecoder,T=C.decode.bind(C);try{let D={"connection.json":JSON.parse(T(t["connection.json"])),"manifest.geojson":JSON.parse(T(t["manifest.geojson"])),"map.geojson":t["map.geojson"]?JSON.parse(T(t["map.geojson"])):void 0,"mapstack.geojson":t["mapstack.geojson"]?JSON.parse(T(t["mapstack.geojson"])):void 0,"node.geojson":JSON.parse(T(t["node.geojson"])),obstruction:{},space:{},entrance:{},facade:{},"tileset.json":t["tileset.json"]?JSON.parse(T(t["tileset.json"])):void 0};if(t.enterprise!=null&&(D.enterprise={},(e=t.enterprise)!=null&&e["locations.json"]&&(D.enterprise.locations=JSON.parse(T((r=t.enterprise)==null?void 0:r["locations.json"]))),(i=t.enterprise)!=null&&i["categories.json"]&&(D.enterprise.categories=JSON.parse(T((n=t.enterprise)==null?void 0:n["categories.json"]))),(a=t.enterprise)!=null&&a["venue.json"]&&(D.enterprise.venue=JSON.parse(T((o=t.enterprise)==null?void 0:o["venue.json"]))),(l=t.enterprise)!=null&&l["layers.json"]&&(D.enterprise.layers=JSON.parse(T((u=t.enterprise)==null?void 0:u["layers.json"]))),(c=t.enterprise)!=null&&c["locationInstances.json"]&&(D.enterprise.locationInstances=JSON.parse(T((p=t.enterprise)==null?void 0:p["locationInstances.json"]))),(m=t.enterprise)!=null&&m["enterpriseStyles.json"]&&(D.enterprise.enterpriseStyles=JSON.parse(T((y=t.enterprise)==null?void 0:y["enterpriseStyles.json"]))),(v=t.enterprise)!=null&&v["textures.json"]&&(D.enterprise.textures=JSON.parse(T((x=t.enterprise)==null?void 0:x["textures.json"]))),(E=t.enterprise)!=null&&E["floorText.json"]&&(D.enterprise.floorText=JSON.parse(T((M=t.enterprise)==null?void 0:M["floorText.json"]))),(I=t.enterprise)!=null&&I["categoryPriorities.json"]&&(D.enterprise.categoryPriorities=JSON.parse(T((P=t.enterprise)==null?void 0:P["categoryPriorities.json"])))),t["floorstack.json"]!=null?D["floorstack.json"]=JSON.parse(T(t["floorstack.json"])):t["mapstack.json"]!=null&&(D["mapstack.json"]=JSON.parse(T(t["mapstack.json"]))),D["floorstack.json"]==null&&D["mapstack.json"]==null&&D["mapstack.geojson"]==null)throw new Error("MVF is missing floorstack.json or mapstack.json/mapstack.geojson");if(t["floor.geojson"]&&(D["floor.geojson"]=JSON.parse(T(t["floor.geojson"]))),D["floor.geojson"]==null&&D["map.geojson"]==null)throw new Error("MVF is missing floor.geojson or map.geojson");if("styles.json"in t&&(D["styles.json"]=JSON.parse(T(t["styles.json"]))),"shapes.json"in t&&(D["shapes.json"]=JSON.parse(T(t["shapes.json"]))),"location.json"in t&&(D["location.json"]=JSON.parse(T(t["location.json"]))),"category.json"in t&&(D["category.json"]=JSON.parse(T(t["category.json"]))),t.annotation!=null){D.annotation={};let k=Object.keys(t.annotation);for(let B of k){let U=B.replace(/\.json|\.geojson/g,"");D.annotation[U]=JSON.parse(T(t.annotation[B]))}}let F=Object.keys(t.space);for(let k of F){let B=k.replace(/\.json|\.geojson/g,"");D.space[B]=JSON.parse(T(t.space[k]))}if(t.obstruction!=null){let k=Object.keys(t.obstruction);for(let B of k){let U=B.replace(/\.json|\.geojson/g,"");D.obstruction[U]=JSON.parse(T(t.obstruction[B]))}}else D.obstruction={};if(t.entrance!=null){let k=Object.keys(t.entrance);for(let B of k){let U=B.replace(/\.json|\.geojson/g,"");D.entrance[U]=JSON.parse(T(t.entrance[B]))}}else D.entrance={};if("floorImages"in t&&t.floorImages!=null){D.floorImages={};for(let k of Object.keys(t.floorImages)){let B=k.replace(/\.json|\.geojson/g,"");D.floorImages[B]=JSON.parse(T(t.floorImages[k]))}}if("textAreas"in t&&t.textAreas!=null){D.textAreas={};for(let k of Object.keys(t.textAreas)){let B=k.replace(/\.json|\.geojson/g,"");D.textAreas[B]=JSON.parse(T(t.textAreas[k]))}}if("facade"in t&&t.facade!=null){D.facade={};for(let k of Object.keys(t.facade)){let B=k.replace(/\.json|\.geojson/g,"");D.facade[B]=JSON.parse(T(t.facade[k]))}}if("area"in t&&t.area!=null){D.area={};for(let k of Object.keys(t.area)){let B=k.replace(/\.json|\.geojson/g,"");D.area[B]=JSON.parse(T(t.area[k]))}}return D}catch(D){throw Vt.error(D),new Error("MVF parsing failed! Probably encountered a bad file.")}}s(YV,"parseMVF");function d3e(t){if(t==null||typeof t!="object")return!1;let e=["connection.json","manifest.geojson","floor.geojson"in t?"floor.geojson":"map.geojson","node.geojson","floorstack.json"in t?"floorstack.json":"mapstack.json"in t?"mapstack.json":"mapstack.geojson"];"styles.json"in t&&e.push("styles.json"),"shapes.json"in t&&e.push("shapes.json");for(let r of e)if(t[r]==null||t[r][Symbol.toStringTag]!=="Uint8Array")return!1;return!0}s(d3e,"validateStaticMVFFiles");async function KV(t){return new Promise(async(e,r)=>{try{if(t==null||typeof t!="object")throw new Error("Error parsing data! Unzipping failed.");if(t[Symbol.toStringTag]!=="Uint8Array")throw new Error("Unexpected file type! Unzipping failed.");let i=(await ag(async()=>{const{unzipSync:o}=await import("./browser-CR4WWHP7-DXjBdY_C.js");return{unzipSync:o}},[])).unzipSync(t);if(!d3e(i))throw new Error("MVF is missing some expect static files. Unzipping failed.");let n={},a=Object.keys(i);for(let o of a){if(i[o].length===0)continue;let l=o.split("/");if(l.length<0)throw new Error("Encounted a file with no name! Unzipping failed.");if(l.length>2)throw new Error("Encountered unexpected nesting in MVF! Unzipping failed.");if(l.length===1){n[l[0]]=i[o];continue}if(l[0]==="image"){Vt.warn("MVF unzipping encountered an image. Ignoring as this case has not been implemented.");continue}else n[l[0]]==null&&(n[l[0]]={}),n[l[0]][l[1]]=i[o]}e(n)}catch(i){r(i)}})}s(KV,"unzipMVF");function yS(){let t="us",e={};function r(){return m3e(g3e(t),e)}return s(r,"getState"),{updateByUserOption(i){var n,a;i.environment&&(t=i.environment),i.baseUri&&(e.baseUri=i.baseUri),i.baseAuthUri&&(e.baseAuthUri=i.baseAuthUri),(n=i.analytics)!=null&&n.baseUri&&(e.analyticsBaseUri=(a=i.analytics)==null?void 0:a.baseUri)},updateTileServerBaseUrl(i){e.tileServerUri=i},updateEnvironment(i){t=i},getBaseUri(i){return t==="us"&&i?nX.baseUri:r().baseUri},getBaseAuthUri(i=!1){return t==="us"&&i?nX.baseAuthUri:r().baseAuthUri},getAnalyticsBaseUri(){return r().analyticsBaseUri},getTileServerUri(){return r().tileServerUri},reset(){t="us",e={}},__getState:r}}s(yS,"createEnvControl");var f3e=Object.freeze({baseUri:"https://app.mappedin.com/",baseAuthUri:"https://app.mappedin.com/",analyticsBaseUri:"https://api-gateway.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),nX=Object.freeze(vt(Ee({},f3e),{baseUri:"https://api-gateway.mappedin.com/",baseAuthUri:"https://auth.mappedin.com/"})),XKe=Object.freeze({baseUri:"https://api-gateway.eu.mappedin.com/",baseAuthUri:"https://auth.eu.mappedin.com/",analyticsBaseUri:"https://api-gateway.eu.mappedin.com/track-analytics/a/",tileServerUri:"https://tiles-cdn.eu.mappedin.com/styles/mappedin/style.json"}),ZKe=Object.freeze({baseUri:"https://api-gateway-staging.mappedin.net/",baseAuthUri:"https://auth-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"}),YKe=Object.freeze({baseUri:"https://app-staging.mappedin.net/",baseAuthUri:"https://app-staging.mappedin.net/",analyticsBaseUri:"https://api-gateway-staging.mappedin.net/track-analytics/a/",tileServerUri:"https://tiles-cdn.mappedin.com/styles/mappedin/style.json"});function m3e(t,e){return Ee(Ee({},t),e)}s(m3e,"getAuthStateByEnvironment");var KKe={eu:XKe,us:f3e,"us-staging-enterprise":ZKe,"us-staging-self-serve":YKe};function g3e(t){return KKe[t]}s(g3e,"getEnvironmentAuthState");var y3e=s(t=>{var e,r;let i=Object.values((r=(e=t["floorstack.json"])!=null?e:t["mapstack.json"])!=null?r:{});return i.length===1?[]:i.filter(n=>n.type!=="Outdoor").map(n=>n.id.replace("fs_","").replace("ms_",""))},"getBuildingIds"),aX=s(async t=>{let e=performance.now(),r=await KTe(t);return Vt.log("Parsed MVFv3 in ".concat(performance.now()-e,"ms")),r.inspectErr(i=>{throw Vt.error(i),new Error("MVFv3 parsing failed!")}),r.unwrap()},"unzipAndParseMVFv3ToMVFv2");async function JV(t,e="2.0.0"){switch(e){case"2.0.0":try{let r=await KV(t);return YV(r)}catch{return aX(t)}case"3.0.0":return aX(t);default:throw new Error("Unsupported MVF version: ".concat(e))}}s(JV,"unzipAndParseMVFv2");N();function w8(t){var e,r,i,n,a,o;let l=((r=(e=t.enterprise)==null?void 0:e.locations)==null?void 0:r.reduce((p,m)=>(p[m.id]=m,p),{}))||{};for(let p of((i=t.enterprise)==null?void 0:i.locationInstances)||[])l[p.id]=p;let u={};for(let p of t["floorstack.json"]||[])u[p.id]=p;let c={};for(let p of((n=t["floor.geojson"])==null?void 0:n.features)||[])p.properties&&p.properties.id&&(c[p.properties.id]=p.properties);return{type:"downloaded",data:t,optimized:{"enterprise-location":l,"enterprise-category":((o=(a=t.enterprise)==null?void 0:a.categories)==null?void 0:o.reduce((p,m)=>(p[m.id]=m,p),{}))||{},"floor-stack":u,floor:c}}}s(w8,"parseLocalePackToLanguagePack");function v3e(t){return/^https?:\/\/cdn\.mappedin\.com/.test(t)}s(v3e,"isMappedinCdnUrl");function _3e(t){let e=t.split("?")[1];return!!(e!=null&&e.includes("sv="))}s(_3e,"hasSasToken");N();N();N();N();N();N();N();var x3e=class{constructor({origin:e,destination:r,distance:i=0,angle:n=0,pathWeight:a=0,multiplicativeDistanceWeightScaling:o=!0}){if($(this,"origin"),$(this,"destination"),$(this,"distance"),$(this,"angle"),$(this,"weight"),this.origin=e,this.destination=r,this.distance=i,this.angle=n,this.weight=a||0,o?e.properties.floor===r.properties.floor&&(this.weight=(this.weight>=0?this.distance*this.weight:0)+this.distance):e.properties.map===r.properties.map&&(this.weight=this.weight>=0?this.distance+this.weight:0),isNaN(this.angle))throw new Error("Invalid angle: Expected a numeric value, but received NaN.")}};s(x3e,"Edge");var A8=x3e;N();N();N();N();function zy([t,e],[r,i]){let n=e-i,a=t-r;return(Math.atan2(a,n)+Math.PI*3)%(Math.PI*2)}s(zy,"getAngle");N();var JKe=63710088e-1;function Xm(t,e){let[r,i]=t.map(p=>p*Math.PI/180),[n,a]=e.map(p=>p*Math.PI/180),o=a-i,l=n-r,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i)*Math.cos(a)*Math.sin(l/2)*Math.sin(l/2),c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return JKe*c}s(Xm,"getDistance");N();N();function YC(t,e,r,i){let[n,a]=t,[o,l]=e,[u,c]=r,[p,m]=i;if(a===l&&n===o||c===m&&u===p)return null;let y=(p-u)*(l-a)-(m-c)*(o-n);if(y===0)return null;let v=((m-c)*(n-u)-(p-u)*(a-c))/y,x=((l-a)*(n-u)-(o-n)*(a-c))/y;if(v<0||v>1||x<0||x>1)return null;let E=a+v*(l-a);return[n+v*(o-n),E]}s(YC,"getLineIntersection");N();function S8(t,e,r,i){let n=kw(t,r/1e3,i),a=kw(e,r/1e3,i);return[n.geometry.coordinates,a.geometry.coordinates]}s(S8,"getOffsetLine");N();function M8(t){let e=t*(180/Math.PI);return e=e%360,e>180?e-=360:e<-180&&(e+=360),Object.is(e,-0)?0:e}s(M8,"radToDegNormalized");var oX=111e3;function b3e(t,e,r=[],i=0){let n=!0,a=t.geometry.coordinates,o=e.geometry.coordinates,l=M8(zy(a,o)-Math.PI/2),u=M8(zy(a,o)+Math.PI/2),c=i/oX,p=i/(oX*Math.cos(a[1]*Math.PI/180)),m=Math.min(a[1],o[1])-c,y=Math.max(a[1],o[1])+c,v=Math.min(a[0],o[0])-p,x=Math.max(a[0],o[0])+p;for(let E of r)if(!(Math.max(E[0][1],E[1][1])<m||Math.min(E[0][1],E[1][1])>y||Math.max(E[0][0],E[1][0])<v||Math.min(E[0][0],E[1][0])>x)){if(i>0){let M=S8(a,o,i,l),I=S8(a,o,i,u);if(YC(M[0],M[1],E[0],E[1])||YC(I[0],I[1],E[0],E[1])){n=!1;return}}else if(YC(a,o,E[0],E[1])){n=!1;return}}return n}s(b3e,"hasLineOfSight");var t1,xp,E8,w3e,A3e,S3e,M3e,E3e,C3e,C8,I3e=class{constructor({nodes:e,groupBy:r,multiplicativeDistanceWeightScaling:i}){Be(this,xp),$(this,"edges",{}),$(this,"nodesById"),$(this,"nodesByGroup",new Map),Be(this,t1),Be(this,C8,s((a,o)=>{let l=0;for(let u of o)(!u[w(this,t1)]||u[w(this,t1)]===a.properties[w(this,t1)])&&yf(a.geometry.coordinates,u.geometry.geometry)&&(l+=Math.max(0,u.cost));return l},"#getZonalCost")),He(this,t1,r);let{features:n}=e;this.nodesById=dr(this,xp,w3e).call(this,n),dr(this,xp,A3e).call(this),dr(this,xp,S3e).call(this,n,r,{multiplicativeDistanceWeightScaling:i})}getShortestEuclideanDistance(e,r){return r.reduce((i,n)=>{let a=Xm(e.geometry.coordinates,n.geometry.coordinates);return Math.min(i,a)},Number.MAX_VALUE)}aStar({originIds:e,destinationNodeIds:r,excludedNodeIds:i,disabledConnectionNodeIds:n,zones:a,overrideEdgeWeights:o}){var l;let u=dr(this,xp,E8).call(this,e),c=dr(this,xp,E8).call(this,r);if(u.length===0||c.length===0)return[];let{frontier:p,cameFrom:m,costSoFar:y}=dr(this,xp,M3e).call(this,u,c);for(;p.length>0;){let v=p.shift();if(!v)break;if(dr(this,xp,E3e).call(this,v.origin,c))return dr(this,xp,C3e).call(this,m,v.origin.properties.id);for(let x of this.edges[v.origin.properties.id]){let E=(l=o==null?void 0:o.get(x))!=null?l:x.weight;if(n!=null&&n.has(x.origin.properties.id)&&x.destination.properties.map!==x.origin.properties.map)continue;let M=y[v.origin.properties.id]+E+w(this,C8).call(this,x.destination,a);if(!(M===1/0||i!=null&&i.has(x.destination.properties.id))&&(y[x.destination.properties.id]==null||M<y[x.destination.properties.id])){let I=M+this.getShortestEuclideanDistance(x.destination,c);y[x.destination.properties.id]=M,m[x.destination.properties.id]=x,p.push({origin:x.destination,priority:I})}}p.sort((x,E)=>x.priority-E.priority)}return[]}};t1=new WeakMap,xp=new WeakSet,E8=s(function(t){return t.map(e=>this.nodesById[e]).filter(Boolean)},"#filterValidNodes"),w3e=s(function(t){return t.reduce((e,r)=>(e[r.properties.id]=r,e),{})},"#createNodesById"),A3e=s(function(){for(let t in this.nodesById)this.nodesById.hasOwnProperty(t)&&(this.nodesById[t].properties.neighbors=this.nodesById[t].properties.neighbors.filter(({id:e})=>!!this.nodesById[e]))},"#removeInvalidNeighbors"),S3e=s(function(t,e,r){t.forEach(i=>{let n=e==="default"?e:i.properties[e];this.nodesByGroup.has(n)||this.nodesByGroup.set(n,[]),this.nodesByGroup.get(n).push(i),this.edges[i.properties.id]=i.properties.neighbors.map(({id:a,weight:o})=>{let l=this.nodesById[a],u=Xm(i.geometry.coordinates,l.geometry.coordinates),c=zy(i.geometry.coordinates,l.geometry.coordinates);return new A8({origin:i,destination:l,pathWeight:o,distance:u,angle:c,multiplicativeDistanceWeightScaling:r==null?void 0:r.multiplicativeDistanceWeightScaling})})})},"#initializeEdgesAndGroups"),M3e=s(function(t,e){let r=[],i={},n={};return t.forEach(a=>{let o=this.getShortestEuclideanDistance(a,e);r.push({origin:a,priority:o}),i[a.properties.id]=null,n[a.properties.id]=0}),r.sort((a,o)=>a.priority-o.priority),{frontier:r,cameFrom:i,costSoFar:n}},"#initializeSearch"),E3e=s(function(t,e){return e.some(r=>r.properties.id===t.properties.id)},"#isDestinationNode"),C3e=s(function(t,e){let r=[],i=t[e];for(;i;)r.push(i),i=t[i.origin.properties.id];return r.reverse()},"#reconstructPath"),C8=new WeakMap,s(I3e,"NavigationGraph");var QKe=I3e,eJe=.4,T3e=class{constructor({nodes:e,geojsonCollection:r,groupBy:i="default",multiplicativeDistanceWeightScaling:n}){$(this,"groupBy"),$(this,"graph"),$(this,"geometryEdgesByMapId",new Map),$(this,"generatePath",s(a=>{let{destination:o}=a[a.length-1],l={type:"FeatureCollection",features:[]};for(let c=0;c<a.length;c++){let{origin:p,destination:m}=a[c],y={id:p.properties.id,angle:a[c].angle,distance:a[c].distance,destination:m.properties.id,edges:this.graph.edges[p.properties.id]};this.groupBy!=="default"&&(y.groupBy=p.properties[this.groupBy]),l.features.push({type:"Feature",geometry:{type:"Point",coordinates:[p.geometry.coordinates[0],p.geometry.coordinates[1]]},properties:y})}let u={id:o.properties.id,edges:this.graph.edges[o.properties.id]};return this.groupBy!=="default"&&(u.groupBy=o.properties[this.groupBy]),l.features.push({type:"Feature",geometry:{type:"Point",coordinates:[o.geometry.coordinates[0],o.geometry.coordinates[1]]},properties:u}),l},"generatePath")),$(this,"getDistance",s((a,o)=>Xm(a,o),"getDistance")),$(this,"getAngle",s((a,o)=>zy(a,o),"getAngle")),this.groupBy=i,this.graph=new QKe({nodes:e,groupBy:this.groupBy,multiplicativeDistanceWeightScaling:n}),((r==null?void 0:r.features)||[]).forEach(a=>{let o=null;if(a.geometry.type==="LineString"?o=a.geometry.coordinates:a.geometry.type==="Polygon"&&(o=a.geometry.coordinates.flat()),o){let l=this.groupBy==="default"?this.groupBy:a.properties[this.groupBy];this.geometryEdgesByMapId.has(l)||this.geometryEdgesByMapId.set(l,[]),o.forEach((u,c)=>{this.geometryEdgesByMapId.get(l).push([u,o[c+1]||o[0]])})}})}getDirections({zones:e,originIds:r,destinationNodeIds:i,excludedNodeIds:n,disabledConnectionNodeIds:a,simplify:o,multiplicativeDistanceWeightScaling:l,overrideEdgeWeights:u}){var c,p;let m=(c=o==null?void 0:o.enabled)!=null?c:!0,y=e??[],v=this.graph.aStar({originIds:r,destinationNodeIds:i,zones:y,excludedNodeIds:new Set(n),disabledConnectionNodeIds:new Set(a),overrideEdgeWeights:u});return v.length===0?{type:"FeatureCollection",features:[]}:(m&&(v=this.simplifyAllSteps(v,(p=o==null?void 0:o.bufferRadius)!=null?p:eJe,l)),this.generatePath(v))}simplifyAllSteps(e,r,i){var n,a;let o=[],l=[e[0]];for(let m=1;m<e.length;m++)if(this.groupBy!=="default"&&e[m].origin.properties[this.groupBy]!==e[m-1].origin.properties[this.groupBy]){let y=e[m-1].origin.properties[this.groupBy],v=(n=this.geometryEdgesByMapId.get(y))!=null?n:[];o.push(...this.simplifySteps(l,v,r,i)),l=[e[m]]}else l.push(e[m]);let u=e[e.length-1],c=this.groupBy==="default"?this.groupBy:u.origin.properties[this.groupBy],p=(a=this.geometryEdgesByMapId.get(c))!=null?a:[];return o.push(...this.simplifySteps(l,p,r,i)),o}simplifySteps(e,r,i,n){if(e.length<3)return e;let a=[e[0]],o=1;for(let l=o+2;l<e.length;l++)if(e[o].origin.properties.preventSmoothing||!b3e(e[o].origin,e[l].origin,r,i)){let u=l-1;a.push(new A8(vt(Ee({},e[o]),{destination:e[u].origin,distance:Xm(e[o].origin.geometry.coordinates,e[u].origin.geometry.coordinates),angle:zy(e[o].origin.geometry.coordinates,e[u].origin.geometry.coordinates)}))),o=u}return a.push(new A8(vt(Ee({},e[o]),{destination:e[e.length-1].origin,distance:Xm(e[o].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),angle:zy(e[o].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),multiplicativeDistanceWeightScaling:n})),e[e.length-1]),a}};s(T3e,"Navigator");var tJe=T3e;N();var rJe={};kl(rJe,{Annotation:()=>e4,Area:()=>XP,Connection:()=>JP,Coordinate:()=>Rn,DOORS:()=>NLe,Door:()=>GA,E_SDK_LOG_LEVEL:()=>Tme,EnterpriseCategory:()=>e0e,EnterpriseLocation:()=>Uw,EnterpriseVenue:()=>t0e,Facade:()=>ex,Floor:()=>jp,FloorStack:()=>hye,Hyperlink:()=>i3,ImageMetaData:()=>a3,LocationCategory:()=>g6e,LocationProfile:()=>Cj,MAPPEDIN_COLORS:()=>$We,MapObject:()=>Ky,Node:()=>qP,PointOfInterest:()=>QP,Space:()=>Zp,WALLS:()=>kLe,__setWatermarkOnClickFn:()=>kDe,createMapLibreOverlay:()=>Qrt,disableText3DWorker:()=>ADe,enableTestMode:()=>N3e,getMapData:()=>wj,getMapDataEnterprise:()=>Jrt,hydrateMapData:()=>jrt,hydrateMapDataFromMVF:()=>Krt,parseMVF:()=>YV,preloadFont:()=>k4e,setLoggerLevel:()=>Dme,setUseEnterpriseAPI:()=>FDe,setWorkersUrl:()=>EDe,show3dMap:()=>Aj,show3dMapGeojson:()=>eit,unzipMVF:()=>KV});N();N();N();N();var KC,JC,QC,P3e=class{constructor(e,r,{enabled:i=!1}={}){Be(this,KC),$(this,"searchInstance"),Be(this,JC),Be(this,QC),$(this,"enabled",!1),He(this,KC,e),He(this,JC,r),He(this,QC,()=>{var n;(n=this.searchInstance)==null||n.then(a=>a.populate())}),i&&this.enable()}async query(e,r={}){if(this.enabled||await this.enable(),!this.searchInstance)return Vt.error("Search should be enabled by now"),{places:[],enterpriseLocations:[],enterpriseCategories:[]};try{return await(await this.searchInstance).search(e,r)}catch(i){return Vt.error("Search.query failed due to",i),{places:[],enterpriseLocations:[],enterpriseCategories:[]}}}async suggest(e,r={}){if(this.enabled||await this.enable(),!this.searchInstance)return Vt.error("Search should be enabled by now"),[];try{return await(await this.searchInstance).suggest(e,r)}catch(i){return Vt.error("Search.suggest failed due to",i),[]}}async enable(){this.enabled||(this.enabled=!0,this.searchInstance||(this.searchInstance=ag(async()=>{const{InternalSearch:e}=await import("./internal-ZUMRQSCJ-BxY5Eq93.js");return{InternalSearch:e}},[]).then(({InternalSearch:e})=>new e(w(this,KC)))),w(this,JC).on("language-change",w(this,QC)),await this.searchInstance)}};KC=new WeakMap,JC=new WeakMap,QC=new WeakMap,s(P3e,"Search");var iJe=P3e,L3e=new WeakMap,jo,D3e=class extends qa{constructor(e,{search:r}={}){super(),Be(this,jo),$(this,"Analytics"),$(this,"Search"),$(this,"Query"),$(this,"getDirections",s((i,n,a)=>w(this,jo).getDirections(i,n,a),"getDirections")),$(this,"getDirectionsMultiDestination",s((i,n,a)=>w(this,jo).getDirectionsMultiDestination(i,n,a),"getDirectionsMultiDestination")),He(this,jo,e),L3e.set(this,e),this.Analytics=new fXe(e.Analytics),this.Query=e.Query,this.Search=new iJe(this,e,{enabled:r==null?void 0:r.enabled}),w(this,jo).on("language-change",i=>{this.publish("language-change",i)})}getEnv(){return w(this,jo).getEnv()}getAccessToken(){var e;return(e=w(this,jo).tokenManager)==null?void 0:e.getAccessToken().token}get mapName(){return w(this,jo).mapName}get mapCenter(){return w(this,jo).mapCenter}get organizationId(){return w(this,jo).organizationId}get outdoorViewToken(){return w(this,jo).outdoorViewToken}getByType(e){return w(this,jo).getByType(e)}getById(e,r){return w(this,jo).getById(e,r)}getByExternalId(e,r){return w(this,jo).getByExternalId(e,r)}getGeoJSON(e){return e.geoJSON}async changeLanguage(e){return w(this,jo).changeLanguage(e)}get currentLanguage(){return w(this,jo).currentLanguage}get naturalBearing(){var e;return(e=w(this,jo).naturalBearing)!=null?e:0}getDistance(e,r){return w(this,jo).getDistance(e,r)}toBinaryBundle({downloadLanguagePacks:e=!0}={}){return w(this,jo).toBinaryBundle({downloadLanguagePacks:e})}toJSONBundle({downloadLanguagePacks:e=!0}={}){return w(this,jo).toJSONBundle({downloadLanguagePacks:e})}};jo=new WeakMap,s(D3e,"MapData");var nJe=D3e,QV=nJe;function R3(t){let e=L3e.get(t);if(!e)throw new Error("MapDataInternal not found");return e}s(R3,"getMapDataInternal");N();N();N();N();var aJe=1e-7;function eI(t){return{type:"Point",coordinates:t}}s(eI,"point");function R3e(t,e){let{coordinates:r}=e.geometry,{coordinates:i}=t.geometry,n=r.map(a=>tk(t,eI(a)));return i.reduce((a,o)=>{let l=EW(eI(o),n[0],t),u=EW(eI(o),n[1],t),c=rk(l)<rk(u)?l:u;return c.properties=vt(Ee({},t.properties),{entrances:[]}),a.concat([c])},[])}s(R3e,"splitObstructionByEntrance");function O3e(t,e){return e.reduce((r,i)=>{let n={epsilon:aJe},a=r.obstructions.findIndex(l=>CWe(nz(i),l,n)),o=r.obstructions[a];if(o){let[l,u]=R3e(o,i);r.entrances.push(i),r.obstructions.splice(a,1,l,u)}return r},{obstructions:[t],entrances:[]})}s(O3e,"findAndSplitObstructionByAllEntrances");N();N();N();N();(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:s(function(){return this},"get"),configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var oJe="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAkGBwgHBgkICAgKCgkLDhcPDg0NDhwUFREXIh4jIyEeICAlKjUtJScyKCAgLj8vMjc5PDw8JC1CRkE6RjU7PDn/2wBDAQoKCg4MDhsPDxs5JiAmOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTn/wgARCAIABAADAREAAhEBAxEB/8QAGwABAAMBAQEBAAAAAAAAAAAAAAECAwQFBgf/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAP3EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAIAAAJAFAAAAAAAAAAAAAAAAAAAAAAAAABAgAAEgCgAAAAAAAAAAAAAAAAAAAABERLSM1zM4zXMzjMoUIqCCSSS8XNC9mpoaVomharWTQAAAAAAAAAAAAAAAAEREtIoZrnGZkucUKFStQQSTFixdNDStF0TWrmiWqbJoAAAAAAAAAAAAAIgiWkZy4HNLzHLXKcxzpzmFYmRkUKFSCCSSxcuampsbR0HSdK9R1R1HTZvWll0mlAAAAAAAAAAAIiKLnLjHNLynLXKcycxzmNYmJmUKFSCAWLFy5qamxvHQvSdJ0nVHUdFm1aparWKAjNWSKAAAAARBEtYzlyXnjmOSuM4U4q4jjOM5a5k5zAyMjOqFCCCCSSS5c0jU1NzoOk6pew7TtjuO1e0646jezWr2WSaUAAAAAECIqtZco55eY464zhTirhOI5Dks5jAwMTIzqhUqQASWLFzSNTY3Og6V646zsO2O47V7DrjqNzWy9nlZ1c0LlrLEk0EQQVipRczIyMU5q5F4U8+vOPOrgThOOuU5jAxMjMzKpUggigJiSSxY0XQ1Njc6TqjtO49CX0D0T0Y7l7E6JdzU1NEvViSalBAWIqVKLSMjIxOauM4U86vPPOrz04TjrkOYwMTIzKJQqQQCKmBJJYutzQ1Njc6TrOyO475fRPRPQjuXsToXWPn6kkkEkhCkEAgggqVMjlrzzzDy7PMPPrhOQ5jBMqoVIIIAAIAJAAJJJLFzWN16TsO49CPTPUl9Q9A6o1LFiSSSSQpCwQQCCCpVMjlrzzyzy7PMPPrhOM5kwM6zKlQQAAQASAASCxY0NI3XpOw7j0I9M9SX0z0DqjU+UqpQqVIBFgEyixJYuWLFDkrzE8o8yvOONOasipBAAAAAAAAAAABJJY2OiO1fQPUj1T0pewuVKlCCqQsBIUSSSSWLlyTM5K808pPLrzziTnrEqQQAAAAAAAAAAASSWNjojtX0D1I9VfSOuND4uzMzqhQqVIALEli5c1jUuQc1vnp5pwJzVmQQAAAAAAAAAAAAAASSaHTHevpHoHTFjMyM6zKlSpABJJcsaGkamhU5q88804E5qzIIAAAAAAAAAAAAAAJJNDpjvX0j0Dqix8dVDMolSpAqCYElixc0XU0IMjlTlrIqAAAAAAAAAAAAAAAAAWNTqjqXYGZkZpUoQQRSFIsSXLroaGhBkcqctZFQAAAAAAAAAAAAAAAACxqdUdS7EngWQCAAQASACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYFSCCAACCQACSSSwKlSCAAAAAAAAAAAAAAAAAACSSxYGIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAAAAAAAAAAAAAAAAABIAJAJAJBAAIAIABAAAAJABAAAAAAAAAJBILEli5Y0LlzQ0Lly5csWLAkgFSChUoUMyhmUMyhQqVKkEEAEAAAAAAAAAkEgsSWLljQuXNDQuXLlyxYsCSAVIKFShQzKGZQzKFCpUqQe+ZmZkUKFCpUEEAAkksWLFzQ0NTU2NzY3Og3NzoNzc2NjU1NS5csSAQVKmZmZGRiYmBgYHOYGBgYGBiZGRkUMypUqQCAASSWLFi5oaGpqbG5sbnQbm50G5ubGxqampcuWJAIIKGZmZGRiYmBgYHOYGBgYGR+jmBzmBzmJiZGZQoQQSSWLmhqbGxudB0nSdJ1HSdR1HSdJ0G5qamhcsWJJJBIIIBUqVKFDIyMDA5jmOU5TlOY5TmOc5znMTEyMyhQggFixc0NTY2NzoOk6TpOo6TqOo6TpOg3NTU0LlixJJIJBAIKkFChQyMjAwOY5jlOU5jnP00yMTnOc5zAwMjMoVIJJLmhqbmx0HQdBubmxqXLkkgAAAAAAAAAAAAAEEFTMzMTEwOc5znMDAyMyhUgkkuaGpsbnQdB0G5ubGpcuSSAAAAAAAAAAAAAAQQVKGZ1gAEEEEFSCACSSxJJJIAAAAAAAAAAAAAAAAAAAAAAABBBBBUggAkkksSSSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSSSSAAAAAAAAAAAAAAAAAAQCCpBUqQVIKggAkFiSSxYksSWBIAAKFiQAAAAAAAAACCpUoUMzIyMzMzMyhQoVKkEEAgkEkklixYuXNDQ0NTQ1NC5cuWJAAAAAAAAAAIKlShQzMjIzMzMzKFChUqQQQCCQSSSWLFyxoXNDQ1NDU0LljUkkAAAAAAAAAAggggEEAgAAAAAAAAAAAAAEkgkkkkkAAAAAAAAAAgggggEAgAAAAAEgEAAAAAAEkgkkuAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADyyCCCCCCCCAQASCSQWJJJJLEkkkkkgkkEgkAEgAAEAAgEAggEEEEEEEFSCCCCCCAQASCSQWJJJJLEkkkkkgkkEgEgEgAAEAAgEAggEEEEEH5AQQQQVBBAIAAJBIJJJLEkkkkliSSSSSQSSCQSAAAQAQQCCCCCCCCCpBBBBBUEEEAgAAkEgkkksSSSSSWJJJJJJBJIJBIAABABBAIIIIIIIIKg/LCAQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQAQQCACAAAACQCQSCQSASSASCQCQAAAAAAQCAQAQCAQfPgAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAgAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAApEAAABQUBAQACAwACAwAAAAABAgQFFQMGERQWEhNAUAAgMGCAkKCw/9oACAEBAAECAP8AwTZznOf3mc5/YZE41xVivFyM6i7C8C8C8zMzMzMyDyDyDyDwV4K7ldSuZV5VgVwqZ/SCca4qxXmcjOouwvAvEzMzMzMzMyDyDyDwV4K7ldSuRVwKgrgf88TDWMrO4VHOo61Hao7ndzvB3k7yZ5M8i8i8zMzMzMyDyDyDyV5K8keSPJHmm8U3em70nam603Mi8qotUDfk5GqZUdfUc6jrUdqjvUeDvB3kzyZ5M8i8i8zMzMzMzMg8g8leSvJHkjyR5pvFN4pu9N2pOtNzIvKqLWA39PX+/saplJlh1tRfVcKrlVdKrrVdqrvVdzu53Y7sZ2M6mdRdRdBdJSUk5SUB0B0B1K6kdSOxHam7Unek70nei7UXWi6UXKk40l9NaRWWuB8/75E41zKjraq+q41nOq6VXas7VXeq71Hc7ud2O7GdRdRdZQXSUlJSUlAdCugOpXUjqR2I7U3em70nek70nai60XSk5UnGkvItIrKoCsC0FwLgXAuBbube3ubm7uiuFcZcZaZYdZUWVl1dwruVdzrulZ0qulVzqOR3EzgZeZcZcK0Vm3t7W1tbW1tgrBYC0q0q4q8jgRxpuVJzoulB0oOlBzoOVBworqa0iwi0i0q4FwLQWAr2trZ2trb3RWiuFcZaZadbUW1l1ZwruVd0rulZ0qulVzqOR3E7gZeZeK4VorNzb29ra2tsFe2CwFpVxVxV5HAjjTcqTnRdKDpQdKDnQcqDhRXU1pFhVm/ISUnKSkrLSsrKyspJyUhvitOtrLq69Q4qHGu41nGqvqLjrDKhUDW+nv1nP+Oc+vYVArFUEVEWUl1FfQcU7imckzinX0VxFoLgXyMlJykrLS0tLS0rKSclI74rjraq6uvUuKhxruNdxqr6i46wysVA1vp79Zz/AI5z6A4VArFUEVkWUl1FfQcU7imcUzinX0VxFoLZKTlJWVlpaXl5eWlpWUB0BzBxkDr669SvUr666stqqz1xqes/j5AxahFFJXRWp1yZemX0F5HCQkpOUlZaWlpeXl5aWB2lQdAcwcZE7hWcFLgpXqF1ZbVVnUDU9Z/HyBi1CV6SuitTrky9MvoLyL5AXEXEXIXIXKSkpKSkpIHIHIHIrkVxK4yJnCsvrra6uqpPVE354GJVpKaCtOtoryuEiZxM5C5C5C5SUnJSclJSQOQORXIrkVxBxM4VV9dbXV1VJ6om/PAxKtFTQVp1tFeRwkRWitFYKvb2tra2draBUCsFgLCrSrQWitOsqqT1RN+jAxKtJTTWFWitMtMtFYKzb29ra2tnaBUCsFZVhVpVoLRWnWVFJ6om/RgYlWkpprAW73v36zn++c+gOFQKv1GoJv04GCp9Rq/T36zn++c+gOFT7fUagm/TgYKn1+3/AKEeMefHjx8/n8vl8vn8/Hjx5xj9bjHnx48fP5/L5fL5/Px48ecY/wAvOPxceQIFIKIJgSAiBAVuK2FaitINAM4MwMwMsJCQkJCQkJCwosws4tAtItQtgtot4oRSCm+Hy8ecfi48gQKQUQTAkBECArcVsK1FaQaAZwZgZgZYSEhISEhISFhRZhZxaBaRahbBbRbxQikFN8BpfMWgWozWLaLcKAUWpq62vr/DX19YEoJARAhBvK2laytRGgjORlIyEYiMJLfJbxLdJbhLbJbRLaJbJbZLbAWxzHMcxzHMcxzHMDbBrYNbJraNbRrbPbh7dPbx7fOwHYjsZ2UzMZoM0maxbRbhQCi1NXW19fX19fW1QSAiBCDeVtK1laiNBGYjKRkIxEYSW+S3iW6S3CW2S2iW0S2S2yW2AtgLY5jmOY5jmOY5gbYNbJrZNbRraPbZ7cPbp7ePb52A7EdjOymZjW4e3D26e3j2+ZgMwmYhYxY4SEhISEBjKxlYiMJGAjAS3iW9TtynblO26dtUrap2zTtmnbNO2SW2S3isRWYGkG0EAItTW1/h8Phr6+rp6AtwtQs5mI9vntw9tHtk9s1LZqWzUto9tnts9uHt09vHt8zAZhMxCxixwkJCQkIDGVjKxEYSMBGAlvEt6nblO3Kdt0rap21TtmnbNO2SWyS2yW8ViKzA1A2ggBFqa2v8Ph8NfW1dPRFuFqMzGYjW+e3D20e2T2zUtk9tHto1tCzHYj2+e3T24e3D24a3DW4Nuc5znOc4FuBbhbcLbhLcJblO3CW4S3iMRGcrYVECcKYB+cJBoCjM2maDsZ7fPbp7cPbh7cNbhrcG3Oc5znOcC3C24W3C24S3CW5TtwluEt4jERnK2FRAnCmAfnCQaAoxb/7ePl8NbU09PT1NYKHy8Y/ZePl8NbU09PT1NYKHy8Y/4Z6+g1tjb3d+Rk5SVlZWVlZSTkd8Fu3s/b6es/pvX0Gtsbe7vyMnKSkrKysrKSciC8Fu3s/YKnrP9gqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqoqsqsqoFIVwqAb8X0NQawqBVCrMrMqMoGuNUTiYf4ICT5/L4/H4fD4fH4hSCmBAAP4AgctUtYqgqkqsqsqsFIV/Hn8XHj5/H4a+traurq6mpqampqampqampqampqampqampqamrq62tr/D4/Lx5/Fx4+fx+Gvra2rq6upqampqampqamrq6upqampqampqamrq6utra/w+Py/wCgEzNTc5OTs7PT09PT8/Pz09PT07Ozk3Ng9TMxLy0rKSclJSMhIb+9vbu9u7u7u7u7u729vb2/vyEjJSUnKSstLzEzNTc5OTs7Oz09PT8/Pz09PT07Ozk5NzUzMS8tKyknJSUjISG/v727vbu7u7u7u7u9u729v78hIyUlJykrLS8x0nR9H0fR9H0XRdF0XRdD0PQ9F0XRdF0XRdF0fR9H0nSdJ0vS9L0vTdN03TdP0/T9P0/T9P0/T9P0/T9R0/T9P0/T9P0/TdN03S9L0vS9J0nSdJ0fR9H0XRdF0PRdD0PQ9D0PRdF0XRdF0XR9H0fSdJ0nS9L0vS9N03TdN0/T9P0/T9P0/T9P0/T9P1HT9P0/T9P0/T9N03TdL0vS9L0vSS8tLy0tLS0rKysrKysrKysrKystLS0vLS8vLy8vMTExMTExMzMzMTMzMzM1NTUzMzMzMzMzMzExMTExMS8vLy8vLy8tKy0tKysrKysrKysrKysrLS0tLy0vLy8vLzExMTExMTMzMzEzMzMzNTU1MzMzMzMzMzMxMTExMTEvLy8vnOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5znOc5znOc5znOc5znOc5znOc59ZznPr169evXr169evXr169evXr16znOfWc5z/9YD//xAArEAEAAgIDAQABBAICAQUAAAAAAVICYgNRYQRBEEBQUzFCIDARYICQoLD/2gAIAQEAAz8A/wDgmhCEI/nYQj+RhjH5ccflxw44YMe0dtmzZs2bNmzZs2bIsjtiwlxy45/Ljn8se0fwuPbjj8uOPy44YQxR2izZs2bNmzZs2bNkWR2xYS45cc/lhP5Y9/wEQwj8sIRD1s2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNmyLMZYZMZ/KJ/dRDCPywhjCI/LZs2bNmzZs2bNmzZs2bNmzZs2bNmzZs2bNkWYywlhP5RP/ABj9hDGGMIh69bNmzZs2bNmzZsmybJsmybJsmybJsmybJsmybJs2bNmzZs2bNmzZ7+mMsZYyj9hDGGMIj9NmzZs2bNmzZs2bJsmybJsmybJs2TZNk2TZNk2bJs2bNmzZs2bNmzZ6iWMsXr16hiwYMGDBgwYo/T169/T162bNmzZs2TZNk2T2ntPae09pSlKUpSlPae09p7T2mybJsmzZs2bNmz17+nr16hiwYOPtx9uPtx9sO2DBih69evXr1s2bNmzZsmybJsmye09p7T2lKUpSlKU9p7T2ntNk2TZNmzZs2bNmz17+vr1s2bNmzZs2bNmzZs2evXr169bNmye09p7SlKUp/wC6UpSlKe09p7etmzZs9evWzZs2bNmzZs2bNmzZs2bPXr1s9bNmye09p7SlKUp/7pSlKUp7T29bPWz169evWzZs2bNmzZs2bNmzZs2bNmzZs2evU9plM/vJhMJ7T29bNnrZ62bNmzZs2bNmzZs2bNmzZs2bNnr39J7TKZ/eTCYT3+nr162bNnrZs2bJsntNk2TZPabNmzZs2etnr39JlM/wUwmP09etmzZs2bNk2TZNk2TZNk2bNmzZs2bNnv6TKZ/gphMfp69etk9p7T2ntKUpSlKUp7T2nt69e/pMpn+GmH/j9PXr1Pae09pSySlklKU9p7T29evf0mUz/DTCY/T16lP/AHSlKU/xUpSlP/dKUpT/ABUpT/8AQllKWTJl0y6ZdMumXTLpl0y6ZJSn+QlKWTJl0y6ZdMumXTLpl0y6ZJSn/sn9xKWXTLpn0z6Z9M+mXTLplVlVlVlVlVlVlVlVlVlVlRlVlVlRlVlVlVlVlVlVlVl0z6Z9M4/DPpn0z6ZdMkp/byll0y6Z9M+mfTPpn0y6ZVZVZVZVZVZVZVZVZUZVZUZVZVZVZVZVZVZVZVZVZVZdM+mfTOPwz6Z9M+mTJlVlVlVl0yZ9M2fTPpn0z6Z9M+mbPpn0z6Z9M2fTPpl0yqyqyqyqyqyomiaJomiaJomiaJomjRo0aNGjRo0aNGjRNE0TRNE0TRNE0TRNE0ZVZVZVZVZVZVZM+mbPpn0z6Z9M+mfTNn0z6Z9M+mfTPpl0y6ZVZVZVTVlVlRNE0TRlRNE0TRNE0TRo0aNGjRo0aNGjRomiaJomiaJomiaJomqaJqyq0TRNE0TRNE0TVNE1TVNU1TRNE1TVNU0TRNE0TRNGjRo0aNGjRhWHFHTgh88Pmj8Pnj/V89HBRwf1w4f64cNMXFSHFTFxUxcVIcP9cOGkOCkPno+ej55/D55cEuKemHUIo0aNGjRo0TRNE0TRNE0TVNE0TVNE1TVNE1TRNU0TRNE0TRNGjRo0aNGjRhWHFHThh88Pnj8Pnq+ejgo4P64cP9cOKkOKkOKmLipi4aYuH+uHBSHBSHz0fPR88/h88uCXFNWHUIo0aNGjRo4ZcU9MOoRRFGjRo0aNGjRo0aNGjRo0RRhVxR04IcGP4cGP+jij/GEMI/xjCP3+M/5xhxT/AJwhwT/o4Mv9XBk4p6YdQiiKNGjRo0aNGjRo0aNGjRoijGsOKOnBi4Mfw4I/0cUf4whhH+MYR+/xn/OMOKf84Q4J/wBHBP8Ar/zxrDCsOKkOKjhq4auGrhq4auGjipDjpDGsI/k8awwrDipDio4aOGrhq4auGrho4qQ46QxrCP8A0bHcMLQ47w4rw4buCzgs4O3A4HA4XA4HA4HA4O3BZwWcN3Fdx3hhaGNoR/Dx3DC0OO8OK8OG7gs4LODtwOBwOFwOBwOBwODtwWcFnDdxXcd4YWhjaEf88UftoQh4y6ZuRyuVzOZzeudz+uf1z+uf1z+uf1z+uf1zuf1z+uf1z+uf1z+udzR25nM5o7c3rlcrlZsniOkSj9tCEPGXTNyuVy+uZzOb1z+uf1z+uf1z+uf1z+uf1z+udz+uf1z+uf1z+uf1z+ueO3O5nM5vXK5XKzZPEdMUftoYsemHTDpx9OPpxVcVXDVw1cNXDVw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDRw0cNHDVw1cNXFVxVcVXFVx9OPph0w6Yo/bQxY9MOnH04+nH04quKrhq4auGrhq4aOGjho4aOGjho4aOGkOGkOGkOGjho4aOGjho4aOGjhq4auGriq4quKriq4+nH0w6Ydf+wHgcLhcLicTjYdww7hh3DDuGPcMe4Y9ww7hh3DDuGHcONxuJxOFwuBwOB8753z2fPZ89nz3fNd893zXfPd893z3fP/Y+e757uC75/wCyHz/2Q+f+yHBd893z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDgcLhcLicTjYdww7hh3DDuGHcMe4Ydww7hh3DDuGHcONxuJxOFwuBwPnfO+d89nz2fPZ893zXfPd813z3fPd893z/2Pnu+e7gu+f8Ash8/9kPn/shwXcF3z3fPd893z3fPd893zXfNd893z2fPZ8/b5+3zvncDdu3bt03bt26bpum6bpum6bt27du3bt26bt26bpum6bpum6bpum6bt03TdN26bpum6bpum7dN03TdN03TdN03TdN03Tdum7dum7dN27dum6bpum6bpum6bpum7du3bt03bpu3bpum6bpum6bpum6bpu3TdN03bpum6bpum6bt03TdN03TdN03TdN03TdN03TduysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysysmzKzKzKybMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrMrJT+2lKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpSn9tKUpSlKUpSlKUpSlKUpSlKUpSlKUpSlKUpT/wDrA//EAB0RAAMBAAMBAQEAAAAAAAAAAAABERIwQFAgkMD/2gAIAQIBAT8A/COlKioqKioqKi+zSoqKioqL59Ro0aKyvpVlZWaNFXiVGkaNFZWV9CsrNGjRpFXepo0V8c69Zo0u1pGilfVnJWaNF+NFXNUaNFfmU0aReamkaNPzNM19VlZWaKysrK/XrKzTNGjRWaKyv+u0/8QAHREBAQACAQUAAAAAAAAAAAAAEQBAUCAQITCQwP/aAAgBAwEBPwD1NkRER07eYiIiNMRERGARERGgIiNAREZRERoCIjiYBERqiIwiI1REcCIiIiIjbkREREREfXZ//9k=";N();N();var k3e=!1;function N3e(){k3e=!0}s(N3e,"enableTestMode");function F3e(){return k3e}s(F3e,"isTestMode");var B3e=class{constructor(e){$(this,"backgroundAlpha",1),$(this,"backgroundColor",new oi),$(this,"width",0),$(this,"height",0),$(this,"options",{}),$(this,"renderer"),$(this,"enabledLayers",new Set([0,1])),$(this,"handleWebGLContextCreationError",s(l=>{var u,c;(c=(u=this.options).onWebGLContextCreationError)==null||c.call(u,l)},"handleWebGLContextCreationError")),$(this,"handleWebGLContextLost",s(l=>{var u,c;(c=(u=this.options).onWebGLContextLost)==null||c.call(u,l)},"handleWebGLContextLost")),$(this,"handleWebGLContextRestored",s(l=>{var u,c;(c=(u=this.options).onWebGLContextRestored)==null||c.call(u,l)},"handleWebGLContextRestored"));var r,i,n,a,o;try{this.options=e,F3e()?(this.renderer={setSize:s(()=>{},"setSize"),state:{reset:s(()=>{},"reset")},properties:{get:s(()=>{},"get")},getSize:s(()=>({width:window.innerWidth,height:innerHeight}),"getSize"),getDrawingBufferSize:s(()=>({width:window.innerWidth,height:innerHeight}),"getDrawingBufferSize"),getClearAlpha:s(()=>1,"getClearAlpha"),getClearColor:s(()=>new oi,"getClearColor"),autoUpdate:!0,shadowMap:{autoUpdate:!0},getContext:s(()=>({getContextAttributes(){return{alpha:!0,antialias:!1,depth:!0,stencil:!1}}}),"getContext"),readRenderTargetPixelsAsync:s(()=>Promise.resolve([]),"readRenderTargetPixelsAsync"),setRenderTarget:s(()=>{},"setRenderTarget"),setClearColor:s(()=>{},"setClearColor"),clear:s(()=>{},"clear"),render:s(()=>{},"render"),clearStencil:s(()=>{},"clearStencil"),clearDepth:s(()=>{},"clearDepth"),domElement:document.createElement("canvas"),capabilities:{isWebGL2:!0}},this.renderer.domElement.style.width="1920px",Object.defineProperty(this.renderer.domElement,"clientWidth",{value:1920}),this.renderer.domElement.style.height="1080px",Object.defineProperty(this.renderer.domElement,"clientHeight",{value:1080})):this.renderer=new vHe({canvas:e.canvas,alpha:e.alpha||!1,stencil:!0,antialias:typeof e.antialias=="boolean"?e.antialias:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0}),this.backgroundColor=new oi((r=e.backgroundColor)!=null?r:"#ffffff"),this.backgroundAlpha=(i=e.backgroundAlpha)!=null?i:1}catch(l){Vt.error(l),e.onWebGLRendererError&&e.onWebGLRendererError(l)}(n=this.domElement())==null||n.addEventListener("webglcontextlost",this.handleWebGLContextLost),(a=this.domElement())==null||a.addEventListener("webglcontextrestored",this.handleWebGLContextRestored),(o=this.domElement())==null||o.addEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}destroy(){var e,r,i,n,a;this.renderer&&((r=(e=this.renderer).dispose)==null||r.call(e)),(i=this.domElement())==null||i.removeEventListener("webglcontextlost",this.handleWebGLContextLost),(n=this.domElement())==null||n.removeEventListener("webglcontextrestored",this.handleWebGLContextRestored),(a=this.domElement())==null||a.removeEventListener("webglcontextcreationerror",this.handleWebGLContextCreationError)}render(e,r){if(this.renderer){this.renderer.state.reset(),r.layers.disableAll();for(let i of this.enabledLayers.values())r.layers.enable(i);this.renderer.clearStencil(),this.renderer.autoClear=!1,this.renderer.setRenderTarget(null),this.renderer.render(e,r),this.renderer.clearDepth(),r.layers.disableAll(),r.layers.enable(pge.ALWAYS_ON_TOP),this.renderer.render(e,r),this.renderer.state.reset()}}clear(){this.renderer&&(this.renderer.setClearColor(this.backgroundColor,this.backgroundAlpha),this.renderer.clear())}setBufferSize(e,r){ja.env.NODE_ENV==="test"||!this.renderer||(this.width=e,this.height=r,this.renderer.setSize(e,r,!1))}setBackgroundColor(e,r){this.backgroundColor=e,this.backgroundAlpha=r}domElement(){var e;return(e=this.renderer)==null?void 0:e.domElement}};s(B3e,"Renderer");var sJe=B3e;N();N();var lJe=`"use strict";(()=>{var G=Object.defineProperty;var J=(n,e,t)=>e in n?G(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>J(n,typeof e!="symbol"?e+"":e,t);function M(n,e){return e.x+e.w<n.x+n.w&&e.x>n.x&&e.y>n.y&&e.y+e.h<n.y+n.h}function j(n,e){let[t,i]=e;return t>=n.x&&t<=n.x+n.w&&i>=n.y&&i<=n.y+n.h}function q(n,e){let t=e.x,i=e.y,o=e.x+e.w,h=e.y+e.h,k=n.x,p=n.y,f=n.x+n.w,g=n.y+n.h;return t<f&&k<o&&i<g&&p<h}function c(n,e){for(let t=0;t<e.length;t++)n.push(e[t])}var s=class{constructor(e,t,i,o,h){l(this,"x");l(this,"y");l(this,"w");l(this,"h");l(this,"userData");this.userData=typeof h>"u"?null:h,this.x=e,this.y=t,this.w=i,this.h=o}contains(e){return e===this?!1:M(this,e)}intersects(e){return q(this,e)}intersectsPoint(e){return j(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.8)",e.fillRect(this.x,this.y,this.w,this.h)}};var w=class n{constructor(e,t){l(this,"topLeft");l(this,"topRight");l(this,"bottomLeft");l(this,"bottomRight");l(this,"divided",!1);l(this,"boundary");l(this,"capacity",16);l(this,"objects",[]);l(this,"parent");this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:i,h:o}=this.boundary;this.topLeft=new n(new s(e,t,i/2,o/2),this),this.topRight=new n(new s(e+i/2,t,i/2,o/2),this),this.bottomLeft=new n(new s(e,t+o/2,i/2,o/2),this),this.bottomRight=new n(new s(e+i/2,t+o/2,i/2,o/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(c(t,this.topLeft.queryRect(e)),c(t,this.topRight.queryRect(e)),c(t,this.bottomLeft.queryRect(e)),c(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(c(t,this.topLeft.queryPoint(e)),c(t,this.topRight.queryPoint(e)),c(t,this.bottomLeft.queryPoint(e)),c(t,this.bottomRight.queryPoint(e))),t}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};var d=200,S=10;function z(n,e,t,i,o,h,k="-1"){let p=1/0,f=1/0,g=-1/0,P=-1/0,O=new s(-S,0,5,t),K=new s(-S,0,e,5),W=new s(e-5,0,e+S,t),V=new s(0,t-5,e,t+S),Q=Z(e,t,i,o,h),Y=[O,K,W,V],E=new s(-d,-d,e+d*2,t+d*2);for(let r of n){let R,T;for(let u=0;u<r.bboxes.length;u++){if(r.bboxes[u]==null||(R=r.bboxes[u].boundingBox,T=r.bboxes[u].index,r.lockedToStrategyIndex!==-1&&T!==r.lockedToStrategyIndex))continue;let[I,a,b,N]=R,[m,F,D,U]=[r.y-I,r.y+a,r.x-b,r.x+N],B=D,L=m,A=U-D,_=F-m;p=Math.min(p,B)-d,f=Math.min(f,L)-d,g=Math.max(g,B+A)+d,P=Math.max(P,L+_)+d,r.bboxes[u].boundingRect=new s(B,L,A,_)}}let y={msgId:k,colliders:new Array(n.length),debug:[]},C=new w(new s(p,f,g-p,P-f)),x;for(let r=0;r<n.length;r++)if(x=n[r],y.colliders[r]=[-1,0],x.enabledAndVisible){let[R,T,u]=[1/0,-1,void 0];for(let{index:I,boundingRect:a}of x.bboxes){if(a==null)continue;let b=[];if(b=C.queryRect(a).filter(m=>a.intersects(m)),x.shouldCollideWithScreenEdges&&Y.forEach(m=>{a.intersects(m)&&b.push(m)}),a.intersects(Q)){y.colliders[r]=[-1,0,a];break}if(b.length<=R&&(u=a,T=I,R=b.length),b.length===0){C.insert(a),y.colliders[r]=[I,E.contains(a)?0:1,a];break}}x.rank===5&&u!=null&&(C.insert(u),y.colliders[r]=[T,E.contains(u)?0:1,u])}else y.colliders[r]=[-1,0];return y}function Z(n,e,t,i,o){switch(o){case"top-right":return new s(n-t,0,t,i);case"bottom-left":return new s(0,e-i,t,i);case"bottom-right":return new s(n-t,e-i,t,i);case"top-left":return new s(0,0,t,i)}}function X(n){let e=n[0].map(t=>{let i=t[0].map(o=>({index:o[4],boundingBox:[o[0],o[1],o[2],o[3]]}));return{enabledAndVisible:t[1]===1,rank:t[2]===1?5:0,x:t[3],y:t[4],shouldCollideWithScreenEdges:t[5]===1,bboxes:i,lockedToStrategyIndex:t[6]}});return{msgId:"-1",totalWidth:n[3],totalHeight:n[2],watermarkWidth:n[4],watermarkHeight:n[5],watermarkPosition:n[6],colliders:e,devicePixelRatio:n[1]}}self.onmessage=n=>{let e=X(n.data);self.postMessage(z(e.colliders,e.totalWidth,e.totalHeight,e.watermarkWidth,e.watermarkHeight,e.watermarkPosition,e.msgId))};})();
`;N();N();N();N();N();function z3e(t,e){return e.x+e.w<t.x+t.w&&e.x>t.x&&e.y>t.y&&e.y+e.h<t.y+t.h}s(z3e,"contains");N();function U3e(t,e){let[r,i]=e;return r>=t.x&&r<=t.x+t.w&&i>=t.y&&i<=t.y+t.h}s(U3e,"intersectPoint");N();function V3e(t,e){let r=e.x,i=e.y,n=e.x+e.w,a=e.y+e.h,o=t.x,l=t.y,u=t.x+t.w,c=t.y+t.h;return r<u&&o<n&&i<c&&l<a}s(V3e,"intersects");N();function Bd(t,e){for(let r=0;r<e.length;r++)t.push(e[r])}s(Bd,"appendItems");N();var j3e=class{constructor(e,r,i,n,a){$(this,"x"),$(this,"y"),$(this,"w"),$(this,"h"),$(this,"userData"),this.userData=typeof a>"u"?null:a,this.x=e,this.y=r,this.w=i,this.h=n}contains(e){return e===this?!1:z3e(this,e)}intersects(e){return V3e(this,e)}intersectsPoint(e){return U3e(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.8)",e.fillRect(this.x,this.y,this.w,this.h)}};s(j3e,"Rectangle");var Jc=j3e,$3e=class I2{constructor(e,r){$(this,"topLeft"),$(this,"topRight"),$(this,"bottomLeft"),$(this,"bottomRight"),$(this,"divided",!1),$(this,"boundary"),$(this,"capacity",16),$(this,"objects",[]),$(this,"parent"),this.parent=r,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:r,w:i,h:n}=this.boundary;this.topLeft=new I2(new Jc(e,r,i/2,n/2),this),this.topRight=new I2(new Jc(e+i/2,r,i/2,n/2),this),this.bottomLeft=new I2(new Jc(e,r+n/2,i/2,n/2),this),this.bottomRight=new I2(new Jc(e+i/2,r+n/2,i/2,n/2),this),this.divided=!0}queryRect(e){let r=[];if(this.boundary.intersects(e))r.push(...this.objects);else return[];return this.divided&&(Bd(r,this.topLeft.queryRect(e)),Bd(r,this.topRight.queryRect(e)),Bd(r,this.bottomLeft.queryRect(e)),Bd(r,this.bottomRight.queryRect(e))),r}queryPoint(e){let r=[];if(this.boundary.intersectsPoint(e))r.push(...this.objects);else return[];return this.divided&&(Bd(r,this.topLeft.queryPoint(e)),Bd(r,this.topRight.queryPoint(e)),Bd(r,this.bottomLeft.queryPoint(e)),Bd(r,this.bottomRight.queryPoint(e))),r}insert(e){return(this.parent?!this.boundary.contains(e):!this.boundary.intersects(e))?!1:this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0)}drawObjects(e){this.objects.forEach(r=>r.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};s($3e,"QuadTree");var T2=$3e;N();N();var G3e=["","","low","medium","high","always-visible"];function ej(t){return Math.min(5,Math.max(2,t))}s(ej,"clampTierNumber");function q4(t){if(typeof t=="number")return ej(t);let e=G3e.indexOf(t);return e===-1?3:e}s(q4,"convertCollisionRankingTierToNumber");function P2(t){let e=ej(t);return G3e[e]}s(P2,"convertNumberToCollisionRankingTier");function H3e(t,e,r){let i,n,a,o=null,l=0;r||(r={});let u=s(function(){l=r.leading===!1?0:Date.now(),o=null,a=t.apply(i,n),o||(i=n=null)},"later");return function(){let c=Date.now();!l&&r.leading===!1&&(l=c);let p=e-(c-l);return i=globalThis,n=arguments,p<=0||p>e?(o&&(clearTimeout(o),o=null),l=c,a=t.apply(i,n),o||(i=n=null)):!o&&r.trailing!==!1&&(o=setTimeout(u,p)),a}}s(H3e,"throttle");var Ug=!1,I8="",uJe=150,q3e=class extends qa{constructor(e,r,i=I8?new Worker(I8):new Worker(URL.createObjectURL(new Blob([lJe],{type:"text/javascript"})))){super(),$(this,"worker"),$(this,"debugContext"),$(this,"debugCanvas"),$(this,"collidersDirty",!0),$(this,"packedMessage",[[],0,0,0,0,0,"bottom-left"]),$(this,"visibleCollidersQTree",new T2(new Jc(0,0,0,0))),$(this,"interactiveCollidersQTree",new T2(new Jc(0,0,0,0))),$(this,"coreState"),$(this,"postMessage"),$(this,"showCollisionBoxes",s(()=>{Ug=!0,this.debugCanvas.style.display="block"},"showCollisionBoxes")),$(this,"hideCollisionBoxes",s(()=>{Ug=!1,this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugCanvas.style.display="none"},"hideCollisionBoxes")),$(this,"currentMsgId",""),$(this,"working",!1),$(this,"_postMessage",s(()=>{this.worker.postMessage(this.packedMessage)},"_postMessage")),$(this,"componentArray",[]),$(this,"update",s((n,a,o="bottom-left",l=!1)=>{let u=!1;if(this.collidersDirty){this.packedMessage=[[],0,0,0,0,0,"bottom-left"],this.componentArray=[];let c;for(let p of this.coreState.geometry2DIdsInScene){let m=this.coreState.geometry2DMap.get(p);m&&(c=m.components[0],this.componentArray.push(c))}this.resize(n,a,o),this.collidersDirty=!1,u=!0}else u=this.componentArray.some(c=>c.collisionDirty===!0);u&&this.componentArray.sort((c,p)=>p.rank-c.rank);for(let c=0;c<this.componentArray.length;c++)if(this.packedMessage){let p=this.componentArray[c].toPackedMessage(l&&!u);this.packedMessage[0][c]==null&&(this.packedMessage[0][c]=[]),this.packedMessage[0][c][0]==null&&(this.packedMessage[0][c][0]=[]),this.packedMessage[0][c][0]=p.bboxes,this.packedMessage[0][c][1]=p.enabled&&this.componentArray[c].visible&&!this.componentArray[c].isOccluded?1:0,this.packedMessage[0][c][2]=p.rank===5?1:0,this.packedMessage[0][c][3]=p.x,this.packedMessage[0][c][4]=p.y,this.packedMessage[0][c][5]=p.shouldCollideWithScreenEdges?1:0,this.packedMessage[0][c][6]=p.lockedToStrategyIndex}this.working||this.postMessage()},"update")),$(this,"resolve",s(n=>{if(this.working=!1,this.collidersDirty||!n.data)return;let a=n.data.colliders,o=-1,l,u,c;Ug&&(this.visibleCollidersQTree=new T2(new Jc(0,0,this.debugCanvas.width,this.debugCanvas.height))),this.interactiveCollidersQTree=new T2(new Jc(0,0,this.debugCanvas.width,this.debugCanvas.height));for(let p=0;p<this.componentArray.length;p++){let m=this.componentArray[p];a[p]!=null&&(o=a[p][0],l=a[p][2],m.offscreen=a[p][1]===1,o!==-1&&l!=null?(c=new Jc(l.x,l.y,l.w,l.h,{entityId:m.id}),Ug&&this.visibleCollidersQTree.insert(c),u=this.coreState.geometry2DMap.get(m.id),(u==null?void 0:u.components[1])!=null&&this.interactiveCollidersQTree.insert(new Jc(l.x,l.y,l.w,l.h,{entityId:m.id})),(m.canShow===!1||m.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in m&&(m.visibilityNeedsUpdate="show"),o!==-1&&o!==m.currentStrategyIndex&&(m.activeBoundingBox=c,m.onStrategySelected(o))):((m.canShow===!0||m.visibilityNeedsUpdate!==!1)&&"visibilityNeedsUpdate"in m&&(m.visibilityNeedsUpdate="hide"),o!==-1&&o!==m.currentStrategyIndex&&m.onStrategySelected(o)))}Ug&&this.drawDebug(),this.publish("visibility-changed")},"resolve")),$(this,"drawDebug",s(()=>{Ug&&this.visibleCollidersQTree&&(this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugContext.beginPath(),this.visibleCollidersQTree.drawObjects(this.debugContext))},"drawDebug")),$(this,"destroy",s(()=>{this.worker.terminate()},"destroy")),this.coreState=r,this.debugCanvas=e,this.debugContext=e.getContext("2d"),this.worker=i,this.worker.onmessage=n=>this.resolve(n),this.postMessage=H3e(this._postMessage,uJe,!1),Ug?this.showCollisionBoxes():this.hideCollisionBoxes()}resize(e,r,i){this.packedMessage[6]=i,this.packedMessage[5]=r,this.packedMessage[4]=e,this.packedMessage[3]=this.debugCanvas.width,this.packedMessage[2]=this.debugCanvas.height}};s(q3e,"CollisionSystem");var cJe=q3e;function W3e(t){I8=t}s(W3e,"setWorkerUrl");N();N();N();N();var X3e=class{constructor(e){$(this,"type"),$(this,"event"),this.type=0,this.event=e}get timestamp(){return this.event.timeStamp}};s(X3e,"Tap");var hJe=X3e,Z3e=class{constructor(){$(this,"taps",[])}add(e){this.lastPointerDown&&e.timestamp-this.lastPointerDown.timestamp<50?this.lastPointerDown.type=1:this.taps.push(e)}get lastPointerDown(){return this.taps.length>=1?this.taps[this.taps.length-1]:void 0}get isSingleTapWithTwoFingers(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===1}get isSingleTapWithOneFinger(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===0}get isDoubleTapWithOneFinger(){var e,r;return this.isDoubleTap&&((e=this.taps[0])==null?void 0:e.type)===0&&((r=this.taps[1])==null?void 0:r.type)===0}get isSingleTap(){return this.taps.length===1}get isDoubleTap(){return this.taps.length===2}discardOutsideOfWaitWindow(e){this.taps=this.taps.filter(r=>e-r.timestamp<300)}flush(){this.taps=[]}get _taps(){return this.taps}destroy(){this.flush()}};s(Z3e,"TapsController");var pJe=Z3e;N();function Y3e(t){let e=new Set;for(let r of t){let i=r.object;for(;i.parent&&!e.has(i.parent);)i=i.parent,i instanceof Yn&&i.type==="group-container"&&i.visible&&i.components[1]&&e.add(i)}return Array.from(e)}s(Y3e,"getUniqueIntersectedGroupContainers");var L2,K3e=class extends qa{constructor(e,r,i,n,a){super(),$(this,"raycaster",new FA),$(this,"state",{hovered3DEntity:void 0,hovered2DEntity:void 0,hovered3DContainers:void 0,lastHover:void 0,interaction:{mouseDownStart:void 0,distanceFromMouseDown:void 0,isPanning:!1}}),$(this,"coreState"),$(this,"camera"),$(this,"worldPlane"),$(this,"_quadtree",new T2(new Jc(0,0,0,0))),$(this,"_container"),$(this,"lastPointerEvent"),$(this,"cursor","grab"),$(this,"touchesCount",0),$(this,"isUserInteracting"),$(this,"hasTouched",!1),Be(this,L2),$(this,"onPointerMoveRaf",s(o=>{this.lastPointerEvent=o,w(this,L2)&&cancelAnimationFrame(w(this,L2)),He(this,L2,requestAnimationFrame(()=>{this.onPointerMove(o)}))},"onPointerMoveRaf")),$(this,"onPointerMove",s(o=>{o.preventDefault(),this.updateInteractionStateIfPanning(o),(o.pointerType!=="touch"||o.pointerType===void 0&&this.hasTouched)&&this.handleHover(o),this.handleCursor()},"onPointerMove")),$(this,"tapsControl",new pJe),$(this,"onPointerDown",s(o=>{o.target===this._container&&(this._container.addEventListener("pointerup",this.onPointerUp,!1),this._container.addEventListener("pointercancel",this.onPointerUp,!1),this.state.interaction.mouseDownStart={time:Date.now(),timestamp:o.timeStamp,clientX:o.clientX,clientY:o.clientY},this.lastPointerEvent=o,this.state.interaction.distanceFromMouseDown=0,this.handleCursor(),o.pointerType==="touch"&&(this.tapsControl.add(new hJe(o)),this.touchesCount=Math.max(0,this.touchesCount+1)))},"onPointerDown")),$(this,"clickTimeout"),$(this,"onPointerUp",s(o=>{this.tapsControl.discardOutsideOfWaitWindow(o.timeStamp),this.lastPointerEvent=o,this.touchesCount=Math.max(0,this.touchesCount-1),this.touchesCount===0&&(this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)),this.updateInteractionStateIfPanning(o);let{mouseDownStart:l}=this.state.interaction;!l||this.state.interaction.distanceFromMouseDown==null||(Date.now()<l.time+300&&(this.tapsControl.isSingleTapWithTwoFingers||this.state.interaction.distanceFromMouseDown<=15)&&(o.pointerType==="touch"?this.tapsControl.isSingleTapWithTwoFingers?(this.publish("singletap-with-twofinger",o),this.flush()):this.tapsControl.isSingleTapWithOneFinger&&this.touchesCount===0?(this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=window.setTimeout(()=>{this.handleClick(o),this.flush()},300)):this.tapsControl.isDoubleTapWithOneFinger&&(this.publish("doubletap-with-onefinger",o),this.flush()):this.handleClick(o)),this.state.interaction.mouseDownStart=void 0,this.state.interaction.distanceFromMouseDown=void 0,this.state.interaction.isPanning=!1,this.handleCursor())},"onPointerUp")),$(this,"dirty3D",!0),$(this,"cachedHitBoxes",{entities:[],groups:[]}),$(this,"ndcPoint",new Jt),$(this,"debugPanel"),this.isUserInteracting=a,this.raycaster.layers.enableAll(),this.raycaster.layers.disable(1),this.camera=i,this._container=e,this.coreState=r,this.worldPlane=n,this._container.addEventListener("pointerdown",this.onPointerDown,!1),this._container.addEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.classList.add("mappedin-interactive")}updateQuadtree(e){this._quadtree=e}setHovered3DEntityInteractionComponentDirty(){if(this.state.hovered3DEntity){let e=this.state.hovered3DEntity.components[2];e&&(e.dirty=!0)}}getThreeDIntersectsFromXY(e){this.raycaster.setFromCamera(e,this.camera),this.raycaster.layers.enable(0);let r=this.raycaster.intersectObjects(this._hitBoxes.entities,!1).filter(n=>{var a,o;return((a=n.object)==null?void 0:a.name)==="worldPlane"||((o=n.object)==null?void 0:o.visible)}),i=r.findIndex(n=>{var a;return((a=n.object)==null?void 0:a.name)==="worldPlane"});return i!==-1&&r.push(r.splice(i,1)[0]),r}getGroupContainerIntersectsFromXY(e){this.raycaster.setFromCamera(e,this.camera),this.raycaster.layers.enable(0);let r=this.raycaster.intersectObjects(this._hitBoxes.groups,!0).filter(n=>n.object.visible),i;return r!=null&&r.length>0&&(i=Y3e(r)),i}flush(){this.tapsControl.flush(),this.clickTimeout!=null&&(clearTimeout(this.clickTimeout),this.clickTimeout=void 0)}handleHover(e){let r=e||this.lastPointerEvent;if(this.state.interaction.mouseDownStart||!r||this.isUserInteracting())return;let{entity3D:i,entity2D:n,position:a,groupContainers:o}=this.intersect(r);(this.detect3DEntityHover(i)||this.detect2DEntityHover(n)||this.detect3DContainerHover(o))&&(this.state.hovered3DEntity=i,this.state.lastHover=i,this.state.hovered2DEntity=n,this.state.hovered3DContainers=o,this.publish("hover",{entity2D:this.state.hovered2DEntity,entity3D:this.state.hovered3DEntity,position:a,groupContainers:o})),this.handleCursor()}handleCursor(){var e;let r=!!(this.state.hovered3DEntity&&(e=this.state.hovered3DEntity)!=null&&e.components[2]||this.state.hovered2DEntity),i=!!this.state.interaction.mouseDownStart,n=this.state.interaction.isPanning,a=J3e(r,n,i);this.cursor!==a&&(this.cursor=a,a==="pointer"?this._container.classList.add("mappedin-interaction-hover"):this._container.classList.remove("mappedin-interaction-hover"))}detect2DEntityHover(e){return this.state.hovered2DEntity!==e}handleClick(e){let r=this.intersect(e);this.publish("click",{entity2D:r.entity2D,entity3D:r.entity3D,position:r.position,groupContainers:r.groupContainers,pointerEvent:{button:e.button}})}get _hitBoxes(){if(this.dirty3D){this.cachedHitBoxes.entities=[],this.cachedHitBoxes.groups=[];let e;for(let r of this.coreState.geometry3DIdsInScene)e=this.coreState.geometry3DMap.get(r),(e==null?void 0:e.type)==="geometry"||(e==null?void 0:e.type)==="model"||(e==null?void 0:e.type)==="path"||(e==null?void 0:e.type)==="custom-geometry"?e.components[0].mesh&&!this.cachedHitBoxes.entities.includes(e.components[0].mesh)&&this.cachedHitBoxes.entities.push(e.components[0].mesh):(e==null?void 0:e.type)==="group-container"&&e.components[1]&&!this.cachedHitBoxes.groups.includes(e)&&this.cachedHitBoxes.groups.push(e);return this.dirty3D=!1,this.cachedHitBoxes.entities.push(this.worldPlane),this.cachedHitBoxes}return this.cachedHitBoxes}intersect(e){var r,i,n,a,o;let l=[e.offsetX,e.offsetY],u=this._quadtree.queryPoint(l),[c]=u.filter(T=>T.intersectsPoint(l)),p=this.coreState.containerOffset[0],m=this.coreState.containerOffset[1];this.ndcPoint.x=(e.clientX-m)/this._container.clientWidth*2-1,this.ndcPoint.y=-((e.clientY-p)/this._container.clientHeight)*2+1;let y=this.getThreeDIntersectsFromXY(this.ndcPoint),v=(r=y[0])==null?void 0:r.point,x=[],E=[];for(let T of y.filter(D=>D.object.name!=="worldPlane"))T.object instanceof Tn&&T.object.material.depthTest===!1?x.push(T):E.push(T);let M=(n=(i=x[0])!=null?i:E[0])!=null?n:void 0,I,P;if(M!=null){if(I=ePe(M.object,this.coreState.geometry3DMap),!I){let T=(a=M==null?void 0:M.instanceId)!=null?a:M==null?void 0:M.batchId;I=T!=null&&M!=null&&M.object.userData.entities?this.coreState.geometry3DMap.get(M==null?void 0:M.object.userData.entities[T]):this.coreState.geometry3DMap.get(M==null?void 0:M.object.userData.entityId)}I!=null&&I.components[2]&&(P=I)}let C=this.getGroupContainerIntersectsFromXY(this.ndcPoint);return{entity2D:((o=c==null?void 0:c.userData)==null?void 0:o.entityId)==="watermark"?{id:"watermark"}:this.coreState.geometry2DMap.get(c==null?void 0:c.userData.entityId),entity3D:P,position:v,groupContainers:C}}detect3DEntityHover(e){return this.state.lastHover!==e&&(this.state.lastHover&&T8(this.state.lastHover,!1,this.coreState),e&&T8(e,!0,this.coreState)),this.state.hovered3DEntity!==e}detect3DContainerHover(e){return!zme(this.state.hovered3DContainers,e)}updateInteractionStateIfPanning(e){this.state.interaction.mouseDownStart&&(this.state.interaction.distanceFromMouseDown=Math.sqrt(Math.pow(e.clientX-this.state.interaction.mouseDownStart.clientX,2)+Math.pow(e.clientY-this.state.interaction.mouseDownStart.clientY,2)),!this.state.interaction.isPanning&&this.state.interaction.distanceFromMouseDown>15&&(this.state.interaction.isPanning=!0))}getMouseRayIntersects(){return this.raycaster.intersectObjects([this.worldPlane],!1)}destroy(){this._container.removeEventListener("pointerdown",this.onPointerDown,!1),this._container.removeEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)}enableDebug(){let e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.backgroundColor="white",e.style.padding="10px",document.body.append(e),e.id="interaction-debug-panel",this.debugPanel=e,this.on("doubletap-with-onefinger",()=>{this.queueDebugMessage("doubletap-with-onefinger","#ffadad")}),this.on("singletap-with-twofinger",()=>{this.queueDebugMessage("singletap-with-twofinger","#ffd6a5")}),this.on("click",r=>{var i,n,a;this.queueDebugMessage(`CLICK 
3D: `.concat((i=r.entity3D)==null?void 0:i.id,` 
2D: `).concat((n=r.entity2D)==null?void 0:n.id,` 
Pos: `).concat((a=r.position)==null?void 0:a.toArray().join(", ")),"#fdffb6")}),this.on("hover",r=>{var i,n,a;this.queueDebugMessage(`HOVER 
3D: `.concat((i=r.entity3D)==null?void 0:i.id,` 
2D: `).concat((n=r.entity2D)==null?void 0:n.id,` 
Pos: `).concat((a=r.position)==null?void 0:a.toArray().join(", ")),"#caffbf")})}get _state(){return this.state}queueDebugMessage(e,r){var i;let n=document.createElement("pre");n.style.maxWidth="300px",n.style.transition="opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)",n.style.backgroundColor=r,n.textContent=e,(i=this.debugPanel)==null||i.prepend(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},500)},2500)}getCursor(){return this.cursor}};L2=new WeakMap,s(K3e,"InteractionSystem");var dJe=K3e;function T8(t,e,r){var i;let n=t.components[2];n&&n.hover!==!0&&(n.hover=e?"user-interaction":!1,n.dirty=!0);let a=(i=t.components[0].textMesh)==null?void 0:i.userData.entityId;if(!a)return;let o=r.geometry3DMap.get(a);(o==null?void 0:o.type)==="text3d"&&(o.components[1].hoverByPolygon=e,o.components[1].dirty=!0)}s(T8,"updateHover");function J3e(t,e,r){return e?"grabbing":t?"pointer":r?"grabbing":"grab"}s(J3e,"processCursor");function Q3e(t){let e=t;for(;e!=null&&e.parent;){if(e instanceof xB)return;if(e.userData.isSingleModel)return e;e=e.parent}}s(Q3e,"findModelParent");function ePe(t,e){let r=Q3e(t);return r?e.get(r.userData.entityId):void 0}s(ePe,"findModelParentEntity");N();N();N();var xt={};kl(xt,{BRAND:()=>RJe,DIRTY:()=>V1,EMPTY_PATH:()=>gJe,INVALID:()=>Ai,NEVER:()=>gQe,OK:()=>iu,ParseStatus:()=>ju,Schema:()=>Ji,ZodAny:()=>Y_,ZodArray:()=>nv,ZodBigInt:()=>Jw,ZodBoolean:()=>Qw,ZodBranded:()=>nj,ZodCatch:()=>uA,ZodDate:()=>eA,ZodDefault:()=>lA,ZodDiscriminatedUnion:()=>RPe,ZodEffects:()=>Xh,ZodEnum:()=>vS,ZodError:()=>Uh,ZodFirstPartyTypeKind:()=>Si,ZodFunction:()=>jPe,ZodIntersection:()=>nA,ZodIssueCode:()=>yr,ZodLazy:()=>aA,ZodLiteral:()=>oA,ZodMap:()=>B3,ZodNaN:()=>U3,ZodNativeEnum:()=>sA,ZodNever:()=>wf,ZodNull:()=>rA,ZodNullable:()=>ng,ZodNumber:()=>Kw,ZodObject:()=>nh,ZodOptional:()=>Yp,ZodParsedType:()=>Br,ZodPipeline:()=>aj,ZodPromise:()=>K_,ZodReadonly:()=>cA,ZodRecord:()=>BPe,ZodSchema:()=>Ji,ZodSet:()=>z3,ZodString:()=>Z_,ZodSymbol:()=>k3,ZodTransformer:()=>Xh,ZodTuple:()=>ig,ZodType:()=>Ji,ZodUndefined:()=>tA,ZodUnion:()=>iA,ZodUnknown:()=>Uy,ZodVoid:()=>N3,addIssueToContext:()=>Ir,any:()=>jJe,array:()=>qJe,bigint:()=>FJe,boolean:()=>o4e,coerce:()=>mQe,custom:()=>oj,date:()=>BJe,datetimeRegex:()=>rj,defaultErrorMap:()=>X_,discriminatedUnion:()=>YJe,effect:()=>lX,enum:()=>aQe,function:()=>rQe,getErrorMap:()=>Zw,getParsedType:()=>Qd,instanceof:()=>kJe,intersection:()=>KJe,isAborted:()=>L8,isAsync:()=>Yw,isDirty:()=>D8,isValid:()=>iv,late:()=>OJe,lazy:()=>iQe,literal:()=>nQe,makeIssue:()=>O3,map:()=>eQe,nan:()=>NJe,nativeEnum:()=>oQe,never:()=>GJe,null:()=>VJe,nullable:()=>uQe,number:()=>a4e,object:()=>WJe,objectUtil:()=>P8,oboolean:()=>fQe,onumber:()=>dQe,optional:()=>lQe,ostring:()=>pQe,pipeline:()=>hQe,preprocess:()=>cQe,promise:()=>sQe,quotelessJson:()=>fJe,record:()=>QJe,set:()=>tQe,setErrorMap:()=>nPe,strictObject:()=>XJe,string:()=>n4e,symbol:()=>zJe,transformer:()=>lX,tuple:()=>JJe,undefined:()=>UJe,union:()=>ZJe,unknown:()=>$Je,util:()=>In,void:()=>HJe});N();N();N();N();N();var In;(function(t){t.assertEqual=n=>{};function e(n){}s(e,"assertIs"),t.assertIs=e;function r(n){throw new Error}s(r,"assertNever"),t.assertNever=r,t.arrayToEnum=n=>{let a={};for(let o of n)a[o]=o;return a},t.getValidEnumValues=n=>{let a=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(let l of a)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(a){return n[a]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let a=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&a.push(o);return a},t.find=(n,a)=>{for(let o of n)if(a(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function i(n,a=" | "){return n.map(o=>typeof o=="string"?"'".concat(o,"'"):o).join(a)}s(i,"joinValues"),t.joinValues=i,t.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(In||(In={}));var P8;(function(t){t.mergeShapes=(e,r)=>Ee(Ee({},e),r)})(P8||(P8={}));var Br=In.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qd=s(t=>{switch(typeof t){case"undefined":return Br.undefined;case"string":return Br.string;case"number":return Number.isNaN(t)?Br.nan:Br.number;case"boolean":return Br.boolean;case"function":return Br.function;case"bigint":return Br.bigint;case"symbol":return Br.symbol;case"object":return Array.isArray(t)?Br.array:t===null?Br.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Br.promise:typeof Map<"u"&&t instanceof Map?Br.map:typeof Set<"u"&&t instanceof Set?Br.set:typeof Date<"u"&&t instanceof Date?Br.date:Br.object;default:return Br.unknown}},"getParsedType"),yr=In.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),fJe=s(t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),"quotelessJson"),tPe=class rPe extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},i={_errors:[]},n=s(a=>{for(let o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)i._errors.push(r(o));else{let l=i,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(r(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}},"processError");return n(this),i}static assert(e){if(!(e instanceof rPe))throw new Error("Not a ZodError: ".concat(e))}toString(){return this.message}get message(){return JSON.stringify(this.issues,In.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};s(tPe,"ZodError");var Uh=tPe;Uh.create=t=>new Uh(t);var mJe=s((t,e)=>{let r;switch(t.code){case yr.invalid_type:t.received===Br.undefined?r="Required":r="Expected ".concat(t.expected,", received ").concat(t.received);break;case yr.invalid_literal:r="Invalid literal value, expected ".concat(JSON.stringify(t.expected,In.jsonStringifyReplacer));break;case yr.unrecognized_keys:r="Unrecognized key(s) in object: ".concat(In.joinValues(t.keys,", "));break;case yr.invalid_union:r="Invalid input";break;case yr.invalid_union_discriminator:r="Invalid discriminator value. Expected ".concat(In.joinValues(t.options));break;case yr.invalid_enum_value:r="Invalid enum value. Expected ".concat(In.joinValues(t.options),", received '").concat(t.received,"'");break;case yr.invalid_arguments:r="Invalid function arguments";break;case yr.invalid_return_type:r="Invalid function return type";break;case yr.invalid_date:r="Invalid date";break;case yr.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r='Invalid input: must include "'.concat(t.validation.includes,'"'),typeof t.validation.position=="number"&&(r="".concat(r," at one or more positions greater than or equal to ").concat(t.validation.position))):"startsWith"in t.validation?r='Invalid input: must start with "'.concat(t.validation.startsWith,'"'):"endsWith"in t.validation?r='Invalid input: must end with "'.concat(t.validation.endsWith,'"'):In.assertNever(t.validation):t.validation!=="regex"?r="Invalid ".concat(t.validation):r="Invalid";break;case yr.too_small:t.type==="array"?r="Array must contain ".concat(t.exact?"exactly":t.inclusive?"at least":"more than"," ").concat(t.minimum," element(s)"):t.type==="string"?r="String must contain ".concat(t.exact?"exactly":t.inclusive?"at least":"over"," ").concat(t.minimum," character(s)"):t.type==="number"?r="Number must be ".concat(t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than ").concat(t.minimum):t.type==="date"?r="Date must be ".concat(t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(t.minimum))):r="Invalid input";break;case yr.too_big:t.type==="array"?r="Array must contain ".concat(t.exact?"exactly":t.inclusive?"at most":"less than"," ").concat(t.maximum," element(s)"):t.type==="string"?r="String must contain ".concat(t.exact?"exactly":t.inclusive?"at most":"under"," ").concat(t.maximum," character(s)"):t.type==="number"?r="Number must be ".concat(t.exact?"exactly":t.inclusive?"less than or equal to":"less than"," ").concat(t.maximum):t.type==="bigint"?r="BigInt must be ".concat(t.exact?"exactly":t.inclusive?"less than or equal to":"less than"," ").concat(t.maximum):t.type==="date"?r="Date must be ".concat(t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(t.maximum))):r="Invalid input";break;case yr.custom:r="Invalid input";break;case yr.invalid_intersection_types:r="Intersection results could not be merged";break;case yr.not_multiple_of:r="Number must be a multiple of ".concat(t.multipleOf);break;case yr.not_finite:r="Number must be finite";break;default:r=e.defaultError,In.assertNever(t)}return{message:r}},"errorMap"),X_=mJe,iPe=X_;function nPe(t){iPe=t}s(nPe,"setErrorMap");function Zw(){return iPe}s(Zw,"getErrorMap");N();var O3=s(t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,a=[...r,...n.path||[]],o=vt(Ee({},n),{path:a});if(n.message!==void 0)return vt(Ee({},n),{path:a,message:n.message});let l="",u=i.filter(c=>!!c).slice().reverse();for(let c of u)l=c(o,{data:e,defaultError:l}).message;return vt(Ee({},n),{path:a,message:l})},"makeIssue"),gJe=[];function Ir(t,e){let r=Zw(),i=O3({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===X_?void 0:X_].filter(n=>!!n)});t.common.issues.push(i)}s(Ir,"addIssueToContext");var aPe=class oPe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return Ai;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let a=await n.key,o=await n.value;i.push({key:a,value:o})}return oPe.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:a,value:o}=n;if(a.status==="aborted"||o.status==="aborted")return Ai;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(i[a.value]=o.value)}return{status:e.value,value:i}}};s(aPe,"ParseStatus");var ju=aPe,Ai=Object.freeze({status:"aborted"}),V1=s(t=>({status:"dirty",value:t}),"DIRTY"),iu=s(t=>({status:"valid",value:t}),"OK"),L8=s(t=>t.status==="aborted","isAborted"),D8=s(t=>t.status==="dirty","isDirty"),iv=s(t=>t.status==="valid","isValid"),Yw=s(t=>typeof Promise<"u"&&t instanceof Promise,"isAsync");N();N();N();var ai;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ai||(ai={}));var sPe=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}};s(sPe,"ParseInputLazyPath");var td=sPe,sX=s((t,e)=>{if(iv(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Uh(t.common.issues);return this._error=r,this._error}}},"handleResult");function zi(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:s((a,o)=>{var l,u;let{message:c}=t;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??i)!=null?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??r)!=null?u:o.defaultError}},"customMap"),description:n}}s(zi,"processCreateParams");var lPe=class{get description(){return this._def.description}_getType(e){return Qd(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Qd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ju,ctx:{common:e.parent.common,data:e.data,parsedType:Qd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Yw(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r==null?void 0:r.async)!=null?i:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qd(e)},a=this._parseSync({data:e,path:n.path,parent:n});return sX(n,a)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qd(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:n});return iv(a)?{value:a.value}:{issues:n.common.issues}}catch(a){(i=(r=a==null?void 0:a.message)==null?void 0:r.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>iv(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qd(e)},n=this._parse({data:e,path:i.path,parent:i}),a=await(Yw(n)?n:Promise.resolve(n));return sX(i,a)}refine(e,r){let i=s(n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r,"getIssueProperties");return this._refinement((n,a)=>{let o=e(n),l=s(()=>a.addIssue(Ee({code:yr.custom},i(n))),"setError");return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new Xh({schema:this,typeName:Si.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s(r=>this["~validate"](r),"validate")}}optional(){return Yp.create(this,this._def)}nullable(){return ng.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nv.create(this)}promise(){return K_.create(this,this._def)}or(e){return iA.create([this,e],this._def)}and(e){return nA.create(this,e,this._def)}transform(e){return new Xh(vt(Ee({},zi(this._def)),{schema:this,typeName:Si.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){let r=typeof e=="function"?e:()=>e;return new lA(vt(Ee({},zi(this._def)),{innerType:this,defaultValue:r,typeName:Si.ZodDefault}))}brand(){return new nj(Ee({typeName:Si.ZodBranded,type:this},zi(this._def)))}catch(e){let r=typeof e=="function"?e:()=>e;return new uA(vt(Ee({},zi(this._def)),{innerType:this,catchValue:r,typeName:Si.ZodCatch}))}describe(e){let r=this.constructor;return new r(vt(Ee({},this._def),{description:e}))}pipe(e){return aj.create(this,e)}readonly(){return cA.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};s(lPe,"ZodType");var Ji=lPe,yJe=/^c[^\s-]{8,}$/i,vJe=/^[0-9a-z]+$/,_Je=/^[0-9A-HJKMNP-TV-Z]{26}$/i,xJe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bJe=/^[a-z0-9_-]{21}$/i,wJe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,AJe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,SJe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,MJe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",RD,EJe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,CJe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,IJe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,TJe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,PJe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,LJe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,uPe="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",DJe=new RegExp("^".concat(uPe,"$"));function tj(t){let e="[0-5]\\d";t.precision?e="".concat(e,"\\.\\d{").concat(t.precision,"}"):t.precision==null&&(e="".concat(e,"(\\.\\d+)?"));let r=t.precision?"+":"?";return"([01]\\d|2[0-3]):[0-5]\\d(:".concat(e,")").concat(r)}s(tj,"timeRegexSource");function cPe(t){return new RegExp("^".concat(tj(t),"$"))}s(cPe,"timeRegex");function rj(t){let e="".concat(uPe,"T").concat(tj(t)),r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e="".concat(e,"(").concat(r.join("|"),")"),new RegExp("^".concat(e,"$"))}s(rj,"datetimeRegex");function hPe(t,e){return!!((e==="v4"||!e)&&EJe.test(t)||(e==="v6"||!e)&&IJe.test(t))}s(hPe,"isValidIP");function pPe(t,e){if(!wJe.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||e&&n.alg!==e)}catch{return!1}}s(pPe,"isValidJWT");function dPe(t,e){return!!((e==="v4"||!e)&&CJe.test(t)||(e==="v6"||!e)&&TJe.test(t))}s(dPe,"isValidCidr");var fPe=class D2 extends Ji{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Br.string){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_type,expected:Br.string,received:n.parsedType}),Ai}let r=new ju,i;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="max")e.data.length>n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="length"){let a=e.data.length>n.value,o=e.data.length<n.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?Ir(i,{code:yr.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&Ir(i,{code:yr.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),r.dirty())}else if(n.kind==="email")SJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"email",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="emoji")RD||(RD=new RegExp(MJe,"u")),RD.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"emoji",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="uuid")xJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"uuid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="nanoid")bJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"nanoid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid")yJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"cuid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid2")vJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"cuid2",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="ulid")_Je.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"ulid",code:yr.invalid_string,message:n.message}),r.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),Ir(i,{validation:"url",code:yr.invalid_string,message:n.message}),r.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"regex",code:yr.invalid_string,message:n.message}),r.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),r.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:{startsWith:n.value},message:n.message}),r.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:{endsWith:n.value},message:n.message}),r.dirty()):n.kind==="datetime"?rj(n).test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:"datetime",message:n.message}),r.dirty()):n.kind==="date"?DJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:"date",message:n.message}),r.dirty()):n.kind==="time"?cPe(n).test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.invalid_string,validation:"time",message:n.message}),r.dirty()):n.kind==="duration"?AJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"duration",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="ip"?hPe(e.data,n.version)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"ip",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="jwt"?pPe(e.data,n.alg)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"jwt",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="cidr"?dPe(e.data,n.version)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"cidr",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="base64"?PJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"base64",code:yr.invalid_string,message:n.message}),r.dirty()):n.kind==="base64url"?LJe.test(e.data)||(i=this._getOrReturnCtx(e,i),Ir(i,{validation:"base64url",code:yr.invalid_string,message:n.message}),r.dirty()):In.assertNever(n);return{status:r.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),Ee({validation:r,code:yr.invalid_string},ai.errToObj(i)))}_addCheck(e){return new D2(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}email(e){return this._addCheck(Ee({kind:"email"},ai.errToObj(e)))}url(e){return this._addCheck(Ee({kind:"url"},ai.errToObj(e)))}emoji(e){return this._addCheck(Ee({kind:"emoji"},ai.errToObj(e)))}uuid(e){return this._addCheck(Ee({kind:"uuid"},ai.errToObj(e)))}nanoid(e){return this._addCheck(Ee({kind:"nanoid"},ai.errToObj(e)))}cuid(e){return this._addCheck(Ee({kind:"cuid"},ai.errToObj(e)))}cuid2(e){return this._addCheck(Ee({kind:"cuid2"},ai.errToObj(e)))}ulid(e){return this._addCheck(Ee({kind:"ulid"},ai.errToObj(e)))}base64(e){return this._addCheck(Ee({kind:"base64"},ai.errToObj(e)))}base64url(e){return this._addCheck(Ee({kind:"base64url"},ai.errToObj(e)))}jwt(e){return this._addCheck(Ee({kind:"jwt"},ai.errToObj(e)))}ip(e){return this._addCheck(Ee({kind:"ip"},ai.errToObj(e)))}cidr(e){return this._addCheck(Ee({kind:"cidr"},ai.errToObj(e)))}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck(Ee({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!=null?r:!1,local:(i=e==null?void 0:e.local)!=null?i:!1},ai.errToObj(e==null?void 0:e.message)))}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck(Ee({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision},ai.errToObj(e==null?void 0:e.message)))}duration(e){return this._addCheck(Ee({kind:"duration"},ai.errToObj(e)))}regex(e,r){return this._addCheck(Ee({kind:"regex",regex:e},ai.errToObj(r)))}includes(e,r){return this._addCheck(Ee({kind:"includes",value:e,position:r==null?void 0:r.position},ai.errToObj(r==null?void 0:r.message)))}startsWith(e,r){return this._addCheck(Ee({kind:"startsWith",value:e},ai.errToObj(r)))}endsWith(e,r){return this._addCheck(Ee({kind:"endsWith",value:e},ai.errToObj(r)))}min(e,r){return this._addCheck(Ee({kind:"min",value:e},ai.errToObj(r)))}max(e,r){return this._addCheck(Ee({kind:"max",value:e},ai.errToObj(r)))}length(e,r){return this._addCheck(Ee({kind:"length",value:e},ai.errToObj(r)))}nonempty(e){return this.min(1,ai.errToObj(e))}trim(){return new D2(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new D2(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new D2(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};s(fPe,"ZodString");var Z_=fPe;Z_.create=t=>{var e;return new Z_(Ee({checks:[],typeName:Si.ZodString,coerce:(e=t==null?void 0:t.coerce)!=null?e:!1},zi(t)))};function mPe(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,a=Number.parseInt(t.toFixed(n).replace(".","")),o=Number.parseInt(e.toFixed(n).replace(".",""));return a%o/10**n}s(mPe,"floatSafeRemainder");var gPe=class R8 extends Ji{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Br.number){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_type,expected:Br.number,received:n.parsedType}),Ai}let r,i=new ju;for(let n of this._def.checks)n.kind==="int"?In.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.invalid_type,expected:"integer",received:"float",message:n.message}),i.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="multipleOf"?mPe(e.data,n.value)!==0&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.not_finite,message:n.message}),i.dirty()):In.assertNever(n);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,ai.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ai.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ai.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ai.toString(r))}setLimit(e,r,i,n){return new R8(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:ai.toString(n)}]}))}_addCheck(e){return new R8(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}int(e){return this._addCheck({kind:"int",message:ai.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ai.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ai.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ai.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ai.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ai.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:ai.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ai.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ai.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&In.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};s(gPe,"ZodNumber");var Kw=gPe;Kw.create=t=>new Kw(Ee({checks:[],typeName:Si.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1},zi(t)));var yPe=class O8 extends Ji{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Br.bigint)return this._getInvalidInput(e);let r,i=new ju;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ir(r,{code:yr.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):In.assertNever(n);return{status:i.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.bigint,received:r.parsedType}),Ai}gte(e,r){return this.setLimit("min",e,!0,ai.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ai.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ai.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ai.toString(r))}setLimit(e,r,i,n){return new O8(vt(Ee({},this._def),{checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:ai.toString(n)}]}))}_addCheck(e){return new O8(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ai.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ai.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ai.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ai.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ai.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};s(yPe,"ZodBigInt");var Jw=yPe;Jw.create=t=>{var e;return new Jw(Ee({checks:[],typeName:Si.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!=null?e:!1},zi(t)))};var vPe=class extends Ji{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Br.boolean){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.boolean,received:r.parsedType}),Ai}return iu(e.data)}};s(vPe,"ZodBoolean");var Qw=vPe;Qw.create=t=>new Qw(Ee({typeName:Si.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1},zi(t)));var _Pe=class xPe extends Ji{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Br.date){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_type,expected:Br.date,received:n.parsedType}),Ai}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return Ir(n,{code:yr.invalid_date}),Ai}let r=new ju,i;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(i=this._getOrReturnCtx(e,i),Ir(i,{code:yr.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):In.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new xPe(vt(Ee({},this._def),{checks:[...this._def.checks,e]}))}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:ai.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:ai.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};s(_Pe,"ZodDate");var eA=_Pe;eA.create=t=>new eA(Ee({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Si.ZodDate},zi(t)));var bPe=class extends Ji{_parse(e){if(this._getType(e)!==Br.symbol){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.symbol,received:r.parsedType}),Ai}return iu(e.data)}};s(bPe,"ZodSymbol");var k3=bPe;k3.create=t=>new k3(Ee({typeName:Si.ZodSymbol},zi(t)));var wPe=class extends Ji{_parse(e){if(this._getType(e)!==Br.undefined){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.undefined,received:r.parsedType}),Ai}return iu(e.data)}};s(wPe,"ZodUndefined");var tA=wPe;tA.create=t=>new tA(Ee({typeName:Si.ZodUndefined},zi(t)));var APe=class extends Ji{_parse(e){if(this._getType(e)!==Br.null){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.null,received:r.parsedType}),Ai}return iu(e.data)}};s(APe,"ZodNull");var rA=APe;rA.create=t=>new rA(Ee({typeName:Si.ZodNull},zi(t)));var SPe=class extends Ji{constructor(){super(...arguments),this._any=!0}_parse(e){return iu(e.data)}};s(SPe,"ZodAny");var Y_=SPe;Y_.create=t=>new Y_(Ee({typeName:Si.ZodAny},zi(t)));var MPe=class extends Ji{constructor(){super(...arguments),this._unknown=!0}_parse(e){return iu(e.data)}};s(MPe,"ZodUnknown");var Uy=MPe;Uy.create=t=>new Uy(Ee({typeName:Si.ZodUnknown},zi(t)));var EPe=class extends Ji{_parse(e){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.never,received:r.parsedType}),Ai}};s(EPe,"ZodNever");var wf=EPe;wf.create=t=>new wf(Ee({typeName:Si.ZodNever},zi(t)));var CPe=class extends Ji{_parse(e){if(this._getType(e)!==Br.undefined){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.void,received:r.parsedType}),Ai}return iu(e.data)}};s(CPe,"ZodVoid");var N3=CPe;N3.create=t=>new N3(Ee({typeName:Si.ZodVoid},zi(t)));var IPe=class tI extends Ji{_parse(e){let{ctx:r,status:i}=this._processInputParams(e),n=this._def;if(r.parsedType!==Br.array)return Ir(r,{code:yr.invalid_type,expected:Br.array,received:r.parsedType}),Ai;if(n.exactLength!==null){let o=r.data.length>n.exactLength.value,l=r.data.length<n.exactLength.value;(o||l)&&(Ir(r,{code:o?yr.too_big:yr.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),i.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(Ir(r,{code:yr.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),i.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(Ir(r,{code:yr.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>n.type._parseAsync(new td(r,o,r.path,l)))).then(o=>ju.mergeArray(i,o));let a=[...r.data].map((o,l)=>n.type._parseSync(new td(r,o,r.path,l)));return ju.mergeArray(i,a)}get element(){return this._def.type}min(e,r){return new tI(vt(Ee({},this._def),{minLength:{value:e,message:ai.toString(r)}}))}max(e,r){return new tI(vt(Ee({},this._def),{maxLength:{value:e,message:ai.toString(r)}}))}length(e,r){return new tI(vt(Ee({},this._def),{exactLength:{value:e,message:ai.toString(r)}}))}nonempty(e){return this.min(1,e)}};s(IPe,"ZodArray");var nv=IPe;nv.create=(t,e)=>new nv(Ee({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Si.ZodArray},zi(e)));function vy(t){if(t instanceof nh){let e={};for(let r in t.shape){let i=t.shape[r];e[r]=Yp.create(vy(i))}return new nh(vt(Ee({},t._def),{shape:s(()=>e,"shape")}))}else return t instanceof nv?new nv(vt(Ee({},t._def),{type:vy(t.element)})):t instanceof Yp?Yp.create(vy(t.unwrap())):t instanceof ng?ng.create(vy(t.unwrap())):t instanceof ig?ig.create(t.items.map(e=>vy(e))):t}s(vy,"deepPartialify");var TPe=class Ch extends Ji{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=In.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==Br.object){let u=this._getOrReturnCtx(e);return Ir(u,{code:yr.invalid_type,expected:Br.object,received:u.parsedType}),Ai}let{status:r,ctx:i}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof wf&&this._def.unknownKeys==="strip"))for(let u in i.data)a.includes(u)||o.push(u);let l=[];for(let u of a){let c=n[u],p=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new td(i,p,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof wf){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")o.length>0&&(Ir(i,{code:yr.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of o){let p=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new td(i,p,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let p=await c.key,m=await c.value;u.push({key:p,value:m,alwaysSet:c.alwaysSet})}return u}).then(u=>ju.mergeObjectSync(r,u)):ju.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return ai.errToObj,new Ch(Ee(vt(Ee({},this._def),{unknownKeys:"strict"}),e!==void 0?{errorMap:s((r,i)=>{var n,a,o,l;let u=(o=(a=(n=this._def).errorMap)==null?void 0:a.call(n,r,i).message)!=null?o:i.defaultError;return r.code==="unrecognized_keys"?{message:(l=ai.errToObj(e).message)!=null?l:u}:{message:u}},"errorMap")}:{}))}strip(){return new Ch(vt(Ee({},this._def),{unknownKeys:"strip"}))}passthrough(){return new Ch(vt(Ee({},this._def),{unknownKeys:"passthrough"}))}extend(e){return new Ch(vt(Ee({},this._def),{shape:s(()=>Ee(Ee({},this._def.shape()),e),"shape")}))}merge(e){return new Ch({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:s(()=>Ee(Ee({},this._def.shape()),e._def.shape()),"shape"),typeName:Si.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Ch(vt(Ee({},this._def),{catchall:e}))}pick(e){let r={};for(let i of In.objectKeys(e))e[i]&&this.shape[i]&&(r[i]=this.shape[i]);return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}omit(e){let r={};for(let i of In.objectKeys(this.shape))e[i]||(r[i]=this.shape[i]);return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}deepPartial(){return vy(this)}partial(e){let r={};for(let i of In.objectKeys(this.shape)){let n=this.shape[i];e&&!e[i]?r[i]=n:r[i]=n.optional()}return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}required(e){let r={};for(let i of In.objectKeys(this.shape))if(e&&!e[i])r[i]=this.shape[i];else{let n=this.shape[i];for(;n instanceof Yp;)n=n._def.innerType;r[i]=n}return new Ch(vt(Ee({},this._def),{shape:s(()=>r,"shape")}))}keyof(){return ij(In.objectKeys(this.shape))}};s(TPe,"ZodObject");var nh=TPe;nh.create=(t,e)=>new nh(Ee({shape:s(()=>t,"shape"),unknownKeys:"strip",catchall:wf.create(),typeName:Si.ZodObject},zi(e)));nh.strictCreate=(t,e)=>new nh(Ee({shape:s(()=>t,"shape"),unknownKeys:"strict",catchall:wf.create(),typeName:Si.ZodObject},zi(e)));nh.lazycreate=(t,e)=>new nh(Ee({shape:t,unknownKeys:"strip",catchall:wf.create(),typeName:Si.ZodObject},zi(e)));var PPe=class extends Ji{_parse(e){let{ctx:r}=this._processInputParams(e),i=this._def.options;function n(a){for(let l of a)if(l.result.status==="valid")return l.result;for(let l of a)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;let o=a.map(l=>new Uh(l.ctx.common.issues));return Ir(r,{code:yr.invalid_union,unionErrors:o}),Ai}if(s(n,"handleResults"),r.common.async)return Promise.all(i.map(async a=>{let o=vt(Ee({},r),{common:vt(Ee({},r.common),{issues:[]}),parent:null});return{result:await a._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let a,o=[];for(let u of i){let c=vt(Ee({},r),{common:vt(Ee({},r.common),{issues:[]}),parent:null}),p=u._parseSync({data:r.data,path:r.path,parent:c});if(p.status==="valid")return p;p.status==="dirty"&&!a&&(a={result:p,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;let l=o.map(u=>new Uh(u));return Ir(r,{code:yr.invalid_union,unionErrors:l}),Ai}}get options(){return this._def.options}};s(PPe,"ZodUnion");var iA=PPe;iA.create=(t,e)=>new iA(Ee({options:t,typeName:Si.ZodUnion},zi(e)));var _m=s(t=>t instanceof aA?_m(t.schema):t instanceof Xh?_m(t.innerType()):t instanceof oA?[t.value]:t instanceof vS?t.options:t instanceof sA?In.objectValues(t.enum):t instanceof lA?_m(t._def.innerType):t instanceof tA?[void 0]:t instanceof rA?[null]:t instanceof Yp?[void 0,..._m(t.unwrap())]:t instanceof ng?[null,..._m(t.unwrap())]:t instanceof nj||t instanceof cA?_m(t.unwrap()):t instanceof uA?_m(t._def.innerType):[],"getDiscriminator"),LPe=class DPe extends Ji{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Br.object)return Ir(r,{code:yr.invalid_type,expected:Br.object,received:r.parsedType}),Ai;let i=this.discriminator,n=r.data[i],a=this.optionsMap.get(n);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(Ir(r,{code:yr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),Ai)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,i){let n=new Map;for(let a of r){let o=_m(a.shape[e]);if(!o.length)throw new Error("A discriminator value for key `".concat(e,"` could not be extracted from all schema options"));for(let l of o){if(n.has(l))throw new Error("Discriminator property ".concat(String(e)," has duplicate value ").concat(String(l)));n.set(l,a)}}return new DPe(Ee({typeName:Si.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:n},zi(i)))}};s(LPe,"ZodDiscriminatedUnion");var RPe=LPe;function F3(t,e){let r=Qd(t),i=Qd(e);if(t===e)return{valid:!0,data:t};if(r===Br.object&&i===Br.object){let n=In.objectKeys(e),a=In.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o=Ee(Ee({},t),e);for(let l of a){let u=F3(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(r===Br.array&&i===Br.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let a=0;a<t.length;a++){let o=t[a],l=e[a],u=F3(o,l);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return r===Br.date&&i===Br.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}s(F3,"mergeValues");var OPe=class extends Ji{_parse(e){let{status:r,ctx:i}=this._processInputParams(e),n=s((a,o)=>{if(L8(a)||L8(o))return Ai;let l=F3(a.value,o.value);return l.valid?((D8(a)||D8(o))&&r.dirty(),{status:r.value,value:l.data}):(Ir(i,{code:yr.invalid_intersection_types}),Ai)},"handleParsed");return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([a,o])=>n(a,o)):n(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}};s(OPe,"ZodIntersection");var nA=OPe;nA.create=(t,e,r)=>new nA(Ee({left:t,right:e,typeName:Si.ZodIntersection},zi(r)));var kPe=class NPe extends Ji{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Br.array)return Ir(i,{code:yr.invalid_type,expected:Br.array,received:i.parsedType}),Ai;if(i.data.length<this._def.items.length)return Ir(i,{code:yr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ai;!this._def.rest&&i.data.length>this._def.items.length&&(Ir(i,{code:yr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let n=[...i.data].map((a,o)=>{let l=this._def.items[o]||this._def.rest;return l?l._parse(new td(i,a,i.path,o)):null}).filter(a=>!!a);return i.common.async?Promise.all(n).then(a=>ju.mergeArray(r,a)):ju.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new NPe(vt(Ee({},this._def),{rest:e}))}};s(kPe,"ZodTuple");var ig=kPe;ig.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ig(Ee({items:t,typeName:Si.ZodTuple,rest:null},zi(e)))};var FPe=class k8 extends Ji{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Br.object)return Ir(i,{code:yr.invalid_type,expected:Br.object,received:i.parsedType}),Ai;let n=[],a=this._def.keyType,o=this._def.valueType;for(let l in i.data)n.push({key:a._parse(new td(i,l,i.path,l)),value:o._parse(new td(i,i.data[l],i.path,l)),alwaysSet:l in i.data});return i.common.async?ju.mergeObjectAsync(r,n):ju.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(e,r,i){return r instanceof Ji?new k8(Ee({keyType:e,valueType:r,typeName:Si.ZodRecord},zi(i))):new k8(Ee({keyType:Z_.create(),valueType:e,typeName:Si.ZodRecord},zi(r)))}};s(FPe,"ZodRecord");var BPe=FPe,zPe=class extends Ji{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Br.map)return Ir(i,{code:yr.invalid_type,expected:Br.map,received:i.parsedType}),Ai;let n=this._def.keyType,a=this._def.valueType,o=[...i.data.entries()].map(([l,u],c)=>({key:n._parse(new td(i,l,i.path,[c,"key"])),value:a._parse(new td(i,u,i.path,[c,"value"]))}));if(i.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,p=await u.value;if(c.status==="aborted"||p.status==="aborted")return Ai;(c.status==="dirty"||p.status==="dirty")&&r.dirty(),l.set(c.value,p.value)}return{status:r.value,value:l}})}else{let l=new Map;for(let u of o){let c=u.key,p=u.value;if(c.status==="aborted"||p.status==="aborted")return Ai;(c.status==="dirty"||p.status==="dirty")&&r.dirty(),l.set(c.value,p.value)}return{status:r.value,value:l}}}};s(zPe,"ZodMap");var B3=zPe;B3.create=(t,e,r)=>new B3(Ee({valueType:e,keyType:t,typeName:Si.ZodMap},zi(r)));var UPe=class N8 extends Ji{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==Br.set)return Ir(i,{code:yr.invalid_type,expected:Br.set,received:i.parsedType}),Ai;let n=this._def;n.minSize!==null&&i.data.size<n.minSize.value&&(Ir(i,{code:yr.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&i.data.size>n.maxSize.value&&(Ir(i,{code:yr.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());let a=this._def.valueType;function o(u){let c=new Set;for(let p of u){if(p.status==="aborted")return Ai;p.status==="dirty"&&r.dirty(),c.add(p.value)}return{status:r.value,value:c}}s(o,"finalizeSet");let l=[...i.data.values()].map((u,c)=>a._parse(new td(i,u,i.path,c)));return i.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,r){return new N8(vt(Ee({},this._def),{minSize:{value:e,message:ai.toString(r)}}))}max(e,r){return new N8(vt(Ee({},this._def),{maxSize:{value:e,message:ai.toString(r)}}))}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};s(UPe,"ZodSet");var z3=UPe;z3.create=(t,e)=>new z3(Ee({valueType:t,minSize:null,maxSize:null,typeName:Si.ZodSet},zi(e)));var VPe=class rI extends Ji{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Br.function)return Ir(r,{code:yr.invalid_type,expected:Br.function,received:r.parsedType}),Ai;function i(l,u){return O3({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zw(),X_].filter(c=>!!c),issueData:{code:yr.invalid_arguments,argumentsError:u}})}s(i,"makeArgsIssue");function n(l,u){return O3({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zw(),X_].filter(c=>!!c),issueData:{code:yr.invalid_return_type,returnTypeError:u}})}s(n,"makeReturnsIssue");let a={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof K_){let l=this;return iu(async function(...u){let c=new Uh([]),p=await l._def.args.parseAsync(u,a).catch(y=>{throw c.addIssue(i(u,y)),c}),m=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(m,a).catch(y=>{throw c.addIssue(n(m,y)),c})})}else{let l=this;return iu(function(...u){let c=l._def.args.safeParse(u,a);if(!c.success)throw new Uh([i(u,c.error)]);let p=Reflect.apply(o,this,c.data),m=l._def.returns.safeParse(p,a);if(!m.success)throw new Uh([n(p,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new rI(vt(Ee({},this._def),{args:ig.create(e).rest(Uy.create())}))}returns(e){return new rI(vt(Ee({},this._def),{returns:e}))}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,i){return new rI(Ee({args:e||ig.create([]).rest(Uy.create()),returns:r||Uy.create(),typeName:Si.ZodFunction},zi(i)))}};s(VPe,"ZodFunction");var jPe=VPe,$Pe=class extends Ji{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};s($Pe,"ZodLazy");var aA=$Pe;aA.create=(t,e)=>new aA(Ee({getter:t,typeName:Si.ZodLazy},zi(e)));var GPe=class extends Ji{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return Ir(r,{received:r.data,code:yr.invalid_literal,expected:this._def.value}),Ai}return{status:"valid",value:e.data}}get value(){return this._def.value}};s(GPe,"ZodLiteral");var oA=GPe;oA.create=(t,e)=>new oA(Ee({value:t,typeName:Si.ZodLiteral},zi(e)));function ij(t,e){return new vS(Ee({values:t,typeName:Si.ZodEnum},zi(e)))}s(ij,"createZodEnum");var HPe=class F8 extends Ji{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),i=this._def.values;return Ir(r,{expected:In.joinValues(i),received:r.parsedType,code:yr.invalid_type}),Ai}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),i=this._def.values;return Ir(r,{received:r.data,code:yr.invalid_enum_value,options:i}),Ai}return iu(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return F8.create(e,Ee(Ee({},this._def),r))}exclude(e,r=this._def){return F8.create(this.options.filter(i=>!e.includes(i)),Ee(Ee({},this._def),r))}};s(HPe,"ZodEnum");var vS=HPe;vS.create=ij;var qPe=class extends Ji{_parse(e){let r=In.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==Br.string&&i.parsedType!==Br.number){let n=In.objectValues(r);return Ir(i,{expected:In.joinValues(n),received:i.parsedType,code:yr.invalid_type}),Ai}if(this._cache||(this._cache=new Set(In.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let n=In.objectValues(r);return Ir(i,{received:i.data,code:yr.invalid_enum_value,options:n}),Ai}return iu(e.data)}get enum(){return this._def.values}};s(qPe,"ZodNativeEnum");var sA=qPe;sA.create=(t,e)=>new sA(Ee({values:t,typeName:Si.ZodNativeEnum},zi(e)));var WPe=class extends Ji{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Br.promise&&r.common.async===!1)return Ir(r,{code:yr.invalid_type,expected:Br.promise,received:r.parsedType}),Ai;let i=r.parsedType===Br.promise?r.data:Promise.resolve(r.data);return iu(i.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}};s(WPe,"ZodPromise");var K_=WPe;K_.create=(t,e)=>new K_(Ee({type:t,typeName:Si.ZodPromise},zi(e)));var XPe=class extends Ji{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Si.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:i}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:s(o=>{Ir(i,o),o.fatal?r.abort():r.dirty()},"addIssue"),get path(){return i.path}};if(a.addIssue=a.addIssue.bind(a),n.type==="preprocess"){let o=n.transform(i.data,a);if(i.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return Ai;let u=await this._def.schema._parseAsync({data:l,path:i.path,parent:i});return u.status==="aborted"?Ai:u.status==="dirty"||r.value==="dirty"?V1(u.value):u});{if(r.value==="aborted")return Ai;let l=this._def.schema._parseSync({data:o,path:i.path,parent:i});return l.status==="aborted"?Ai:l.status==="dirty"||r.value==="dirty"?V1(l.value):l}}if(n.type==="refinement"){let o=s(l=>{let u=n.refinement(l,a);if(i.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l},"executeRefinement");if(i.common.async===!1){let l=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return l.status==="aborted"?Ai:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(l=>l.status==="aborted"?Ai:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(n.type==="transform")if(i.common.async===!1){let o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!iv(o))return Ai;let l=n.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>iv(o)?Promise.resolve(n.transform(o.value,a)).then(l=>({status:r.value,value:l})):Ai);In.assertNever(n)}};s(XPe,"ZodEffects");var Xh=XPe;Xh.create=(t,e,r)=>new Xh(Ee({schema:t,typeName:Si.ZodEffects,effect:e},zi(r)));Xh.createWithPreprocess=(t,e,r)=>new Xh(Ee({schema:e,effect:{type:"preprocess",transform:t},typeName:Si.ZodEffects},zi(r)));var ZPe=class extends Ji{_parse(e){return this._getType(e)===Br.undefined?iu(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};s(ZPe,"ZodOptional");var Yp=ZPe;Yp.create=(t,e)=>new Yp(Ee({innerType:t,typeName:Si.ZodOptional},zi(e)));var YPe=class extends Ji{_parse(e){return this._getType(e)===Br.null?iu(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};s(YPe,"ZodNullable");var ng=YPe;ng.create=(t,e)=>new ng(Ee({innerType:t,typeName:Si.ZodNullable},zi(e)));var KPe=class extends Ji{_parse(e){let{ctx:r}=this._processInputParams(e),i=r.data;return r.parsedType===Br.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};s(KPe,"ZodDefault");var lA=KPe;lA.create=(t,e)=>new lA(Ee({innerType:t,typeName:Si.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default},zi(e)));var JPe=class extends Ji{_parse(e){let{ctx:r}=this._processInputParams(e),i=vt(Ee({},r),{common:vt(Ee({},r.common),{issues:[]})}),n=this._def.innerType._parse({data:i.data,path:i.path,parent:Ee({},i)});return Yw(n)?n.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Uh(i.common.issues)},input:i.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Uh(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}};s(JPe,"ZodCatch");var uA=JPe;uA.create=(t,e)=>new uA(Ee({innerType:t,typeName:Si.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch},zi(e)));var QPe=class extends Ji{_parse(e){if(this._getType(e)!==Br.nan){let r=this._getOrReturnCtx(e);return Ir(r,{code:yr.invalid_type,expected:Br.nan,received:r.parsedType}),Ai}return{status:"valid",value:e.data}}};s(QPe,"ZodNaN");var U3=QPe;U3.create=t=>new U3(Ee({typeName:Si.ZodNaN},zi(t)));var RJe=Symbol("zod_brand"),e4e=class extends Ji{_parse(e){let{ctx:r}=this._processInputParams(e),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}};s(e4e,"ZodBranded");var nj=e4e,t4e=class r4e extends Ji{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.common.async)return s(async()=>{let n=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?Ai:n.status==="dirty"?(r.dirty(),V1(n.value)):this._def.out._parseAsync({data:n.value,path:i.path,parent:i})},"handleAsync")();{let n=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?Ai:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:i.path,parent:i})}}static create(e,r){return new r4e({in:e,out:r,typeName:Si.ZodPipeline})}};s(t4e,"ZodPipeline");var aj=t4e,i4e=class extends Ji{_parse(e){let r=this._def.innerType._parse(e),i=s(n=>(iv(n)&&(n.value=Object.freeze(n.value)),n),"freeze");return Yw(r)?r.then(n=>i(n)):i(r)}unwrap(){return this._def.innerType}};s(i4e,"ZodReadonly");var cA=i4e;cA.create=(t,e)=>new cA(Ee({innerType:t,typeName:Si.ZodReadonly},zi(e)));function B8(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}s(B8,"cleanParams");function oj(t,e={},r){return t?Y_.create().superRefine((i,n)=>{var a,o;let l=t(i);if(l instanceof Promise)return l.then(u=>{var c,p;if(!u){let m=B8(e,i),y=(p=(c=m.fatal)!=null?c:r)!=null?p:!0;n.addIssue(vt(Ee({code:"custom"},m),{fatal:y}))}});if(!l){let u=B8(e,i),c=(o=(a=u.fatal)!=null?a:r)!=null?o:!0;n.addIssue(vt(Ee({code:"custom"},u),{fatal:c}))}}):Y_.create()}s(oj,"custom");var OJe={object:nh.lazycreate},Si;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Si||(Si={}));var kJe=s((t,e={message:"Input not instance of ".concat(t.name)})=>oj(r=>r instanceof t,e),"instanceOfType"),n4e=Z_.create,a4e=Kw.create,NJe=U3.create,FJe=Jw.create,o4e=Qw.create,BJe=eA.create,zJe=k3.create,UJe=tA.create,VJe=rA.create,jJe=Y_.create,$Je=Uy.create,GJe=wf.create,HJe=N3.create,qJe=nv.create,WJe=nh.create,XJe=nh.strictCreate,ZJe=iA.create,YJe=RPe.create,KJe=nA.create,JJe=ig.create,QJe=BPe.create,eQe=B3.create,tQe=z3.create,rQe=jPe.create,iQe=aA.create,nQe=oA.create,aQe=vS.create,oQe=sA.create,sQe=K_.create,lX=Xh.create,lQe=Yp.create,uQe=ng.create,cQe=Xh.createWithPreprocess,hQe=aj.create,pQe=s(()=>n4e().optional(),"ostring"),dQe=s(()=>a4e().optional(),"onumber"),fQe=s(()=>o4e().optional(),"oboolean"),mQe={string:s(t=>Z_.create(vt(Ee({},t),{coerce:!0})),"string"),number:s(t=>Kw.create(vt(Ee({},t),{coerce:!0})),"number"),boolean:s(t=>Qw.create(vt(Ee({},t),{coerce:!0})),"boolean"),bigint:s(t=>Jw.create(vt(Ee({},t),{coerce:!0})),"bigint"),date:s(t=>eA.create(vt(Ee({},t),{coerce:!0})),"date")},gQe=Ai,yQe=xt,Xl=yQe,vQe=Rr(sye()),Ub=4,_Qe=8,xQe="0.6",uX="low-priority-pin",s4e=xt.object({rank:xt.union([xt.enum(["low","medium","high","always-visible"]),xt.number()]).optional(),interactive:xt.union([xt.boolean(),xt.literal("pointer-events-auto")]).optional(),id:xt.string().optional(),anchor:xt.union([xt.enum(["top","bottom","left","right","center","top-left","top-right","bottom-left","bottom-right"]),xt.array(xt.enum(["top","bottom","left","right","center","top-left","top-right","bottom-left","bottom-right"]))]).optional(),dynamicResize:xt.boolean().optional(),zIndex:xt.number().optional(),lowPriorityPin:xt.object({enabled:xt.boolean().optional(),size:xt.number().positive().optional(),color:xt.string().optional()}).optional()});function l4e(t,e,r){xt.array(xt.number()).min(2).max(3).parse(t),xt.string().parse(e),s4e.parse(r)}s(l4e,"validateMarker");var bQe=Object.freeze({enabled:!0,size:_Qe,color:"#666"}),z8=class iI{constructor(e,r={}){$(this,"id"),$(this,"type","marker"),$(this,"rank",0),$(this,"initialRank",0),$(this,"activeAnchor","center"),$(this,"pointerEvents","none"),$(this,"options",{rank:"low",interactive:!1,id:"",anchor:"center",dynamicResize:!1,occluderId:0,zIndex:void 0,verticalOffset:0,lowPriorityPin:Ee({},bQe)}),$(this,"projection",new Jt),$(this,"enabled",!0),$(this,"canShow",!1),$(this,"visible",!0),$(this,"isOccluded",!1),$(this,"offscreen",!1),$(this,"strategyIndex",-1),$(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),$(this,"dimensions",{width:0,height:0}),$(this,"markerContainer"),$(this,"containerEl"),$(this,"contentEl",null),$(this,"contentHtml",""),$(this,"style",{top:"0px",left:"0px"}),$(this,"dirty",!1),$(this,"attachedDirty",!0),$(this,"collisionDirty",!0),$(this,"visibilityNeedsUpdate","show"),$(this,"animation",null),$(this,"currentStrategyIndex",-1),$(this,"onStrategySelected",s((o,l=!1)=>{var u,c;if(!(this.currentStrategyIndex===o&&!l)){if(this.currentStrategyIndex=o,o===this.lowPriorityPinStrategyIndex){this.activeAnchor="center",this.markerContainer.setAttribute("data-anchor",uX);let p=this.options.lowPriorityPin,m=p.size,y=p.color;this.markerContainer.style.setProperty("--mappedin-pin-size","".concat(m,"px")),this.markerContainer.style.setProperty("--pin-color",y),this.markerContainer.style.opacity=xQe,this.style.top=-m/2+"px",this.style.left=-m/2+"px"}else{this.activeAnchor=(c=(u=this.strategies[o])==null?void 0:u.name)!=null?c:"center",this.markerContainer.setAttribute("data-anchor",this.activeAnchor),this.markerContainer.style.removeProperty("--mappedin-pin-size"),this.markerContainer.style.removeProperty("--pin-color"),this.markerContainer.style.opacity="1";let{width:p,height:m}=this.dimensions,y=-m/2+"px",v=-p/2+"px";switch(this.style.top=y,this.style.left=v,this.activeAnchor){case"top":{this.style.top=-m+"px";break}case"bottom":{this.style.top="0px";break}case"left":{this.style.left=-p+"px";break}case"right":{this.style.left="0px";break}case"top-left":{this.style.top=-m+"px",this.style.left=-p+"px";break}case"top-right":{this.style.top=-m+"px",this.style.left="0px";break}case"bottom-left":{this.style.top="0px",this.style.left=-p+"px";break}case"bottom-right":{this.style.top="0px",this.style.left="0px";break}default:this.style.top=y,this.style.left=v}}this.markerContainer.style.top=this.style.top,this.markerContainer.style.left=this.style.left}},"onStrategySelected")),$(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],lockedToStrategyIndex:-1,shouldCollideWithScreenEdges:!1});var i,n,a;if(this.id=(r==null?void 0:r.id)||ga(),this.options=(0,vQe.default)(this.options,r),typeof r.rank=="string")this.rank=q4(r.rank);else if(r.rank!=null&&r.rank>0)this.rank=r.rank;else{let o=Math.trunc(ja.env.NODE_ENV==="test"?iI.testId:iI.testId*10)/10;iI.testId+=.001,this.rank=o}typeof r.interactive=="string"&&(this.pointerEvents=r.interactive==="pointer-events-auto"?"auto":"none"),this.contentHtml=e,this.initialRank=this.rank,this.markerContainer=document.createElement("div"),this.markerContainer.className="mappedin-marker",this.markerContainer.style.opacity="0",this.markerContainer.innerHTML='<div class="mappedin-marker-content">'.concat(this.contentHtml,"</div>"),this.markerContainer.setAttribute("data-marker-id",this.id.toString()),this.containerEl=(i=this.markerContainer.firstElementChild)!=null?i:null,this.contentEl=(a=(n=this.markerContainer.firstElementChild)==null?void 0:n.firstElementChild)!=null?a:null}updateDimensions(e,r){if(e!=null&&r!=null)this.dimensions={width:e,height:r};else{let{width:i,height:n}=this.markerContainer.getBoundingClientRect();this.dimensions={width:i,height:n}}Object.assign(this.markerContainer,{width:this.dimensions.width+"px",height:this.dimensions.height+"px"}),this.currentStrategyIndex=-1}get strategies(){var e;let{width:r,height:i}=this.dimensions;if(r===0||i===0)return[];let n=(Array.isArray(this.options.anchor)?this.options.anchor:[this.options.anchor]).map(a=>({name:a,getBoundingBox:s(()=>{let o=i/2,l=i/2,u=r/2,c=r/2;switch(a){case"top":{o=i,l=0;break}case"bottom":{o=0,l=i;break}case"left":{u=r,c=0;break}case"right":{u=0,c=r;break}case"top-left":{o=i,u=r,l=0,c=0;break}case"top-right":{o=i,c=r,l=0,u=0;break}case"bottom-left":{l=i,u=r,o=0,c=0;break}case"bottom-right":{l=i,c=r,o=0,u=0;break}}return[o+Ub,l+Ub,u+Ub,c+Ub]},"getBoundingBox")}));if((e=this.options.lowPriorityPin)!=null&&e.enabled&&this.options.rank!=="always-visible"){let a={name:uX,getBoundingBox:s(()=>{let o=Math.max(2,Ub/2);return[this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o,this.options.lowPriorityPin.size/2+o]},"getBoundingBox")};n.push(a)}return n}toPackedMessage(e=!1){var r;this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.packedMessage.shouldCollideWithScreenEdges=!0;let i=this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityPinStrategyIndex;if(this.visible&&e&&i&&this.collisionDirty===!1?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,i&&this.currentStrategyIndex!==((r=this.packedMessage.bboxes[0])==null?void 0:r[4])){let n=this.packedMessage.bboxes.findIndex(a=>a[4]===this.currentStrategyIndex);if(n!==-1){let a=this.packedMessage.bboxes.splice(n,1)[0];this.packedMessage.bboxes.unshift(a)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let n=0;n<this.strategies.length;n++){let a=this.strategies[n];n===this.currentStrategyIndex&&i?this.packedMessage.bboxes.unshift([...a.getBoundingBox(),n]):this.packedMessage.bboxes.push([...a.getBoundingBox(),n])}return this.collisionDirty=!1,this.packedMessage}get lowPriorityPinStrategyIndex(){var e;return!((e=this.options.lowPriorityPin)!=null&&e.enabled)||this.options.rank==="always-visible"?-1:Array.isArray(this.options.anchor)?this.options.anchor.length:1}destroy(){}};s(z8,"MarkerComponent"),$(z8,"testId",0);var pw=z8;N();N();N();N();N();var u4e=class{constructor(){$(this,"hover",!1),$(this,"dirty",!1)}};s(u4e,"InteractionComponent");var OD=u4e;N();N();function hA(t){"@babel/helpers - typeof";return hA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hA(t)}s(hA,"_typeof");var wQe=/^\s+/,AQe=/\s+$/;function ii(t,e){if(t=t||"",e=e||{},t instanceof ii)return t;if(!(this instanceof ii))return new ii(t,e);var r=c4e(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}s(ii,"tinycolor");ii.prototype={isDark:s(function(){return this.getBrightness()<128},"isDark"),isLight:s(function(){return!this.isDark()},"isLight"),isValid:s(function(){return this._ok},"isValid"),getOriginalInput:s(function(){return this._originalInput},"getOriginalInput"),getFormat:s(function(){return this._format},"getFormat"),getAlpha:s(function(){return this._a},"getAlpha"),getBrightness:s(function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},"getBrightness"),getLuminance:s(function(){var t=this.toRgb(),e,r,i,n,a,o;return e=t.r/255,r=t.g/255,i=t.b/255,e<=.03928?n=e/12.92:n=Math.pow((e+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*n+.7152*a+.0722*o},"getLuminance"),setAlpha:s(function(t){return this._a=sj(t),this._roundA=Math.round(100*this._a)/100,this},"setAlpha"),toHsv:s(function(){var t=V8(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},"toHsv"),toHsvString:s(function(){var t=V8(this._r,this._g,this._b),e=Math.round(t.h*360),r=Math.round(t.s*100),i=Math.round(t.v*100);return this._a==1?"hsv("+e+", "+r+"%, "+i+"%)":"hsva("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},"toHsvString"),toHsl:s(function(){var t=U8(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},"toHsl"),toHslString:s(function(){var t=U8(this._r,this._g,this._b),e=Math.round(t.h*360),r=Math.round(t.s*100),i=Math.round(t.l*100);return this._a==1?"hsl("+e+", "+r+"%, "+i+"%)":"hsla("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},"toHslString"),toHex:s(function(t){return j8(this._r,this._g,this._b,t)},"toHex"),toHexString:s(function(t){return"#"+this.toHex(t)},"toHexString"),toHex8:s(function(t){return f4e(this._r,this._g,this._b,this._a,t)},"toHex8"),toHex8String:s(function(t){return"#"+this.toHex8(t)},"toHex8String"),toRgb:s(function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},"toRgb"),toRgbString:s(function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},"toRgbString"),toPercentageRgb:s(function(){return{r:Math.round(Ua(this._r,255)*100)+"%",g:Math.round(Ua(this._g,255)*100)+"%",b:Math.round(Ua(this._b,255)*100)+"%",a:this._a}},"toPercentageRgb"),toPercentageRgbString:s(function(){return this._a==1?"rgb("+Math.round(Ua(this._r,255)*100)+"%, "+Math.round(Ua(this._g,255)*100)+"%, "+Math.round(Ua(this._b,255)*100)+"%)":"rgba("+Math.round(Ua(this._r,255)*100)+"%, "+Math.round(Ua(this._g,255)*100)+"%, "+Math.round(Ua(this._b,255)*100)+"%, "+this._roundA+")"},"toPercentageRgbString"),toName:s(function(){return this._a===0?"transparent":this._a<1?!1:SQe[j8(this._r,this._g,this._b,!0)]||!1},"toName"),toFilter:s(function(t){var e="#"+$8(this._r,this._g,this._b,this._a),r=e,i=this._gradientType?"GradientType = 1, ":"";if(t){var n=ii(t);r="#"+$8(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+r+")"},"toFilter"),toString:s(function(t){var e=!!t;t=t||this._format;var r=!1,i=this._a<1&&this._a>=0,n=!e&&i&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return n?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(r=this.toRgbString()),t==="prgb"&&(r=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(r=this.toHexString()),t==="hex3"&&(r=this.toHexString(!0)),t==="hex4"&&(r=this.toHex8String(!0)),t==="hex8"&&(r=this.toHex8String()),t==="name"&&(r=this.toName()),t==="hsl"&&(r=this.toHslString()),t==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},"toString"),clone:s(function(){return ii(this.toString())},"clone"),_applyModification:s(function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},"_applyModification"),lighten:s(function(){return this._applyModification(v4e,arguments)},"lighten"),brighten:s(function(){return this._applyModification(_4e,arguments)},"brighten"),darken:s(function(){return this._applyModification(x4e,arguments)},"darken"),desaturate:s(function(){return this._applyModification(m4e,arguments)},"desaturate"),saturate:s(function(){return this._applyModification(g4e,arguments)},"saturate"),greyscale:s(function(){return this._applyModification(y4e,arguments)},"greyscale"),spin:s(function(){return this._applyModification(b4e,arguments)},"spin"),_applyCombination:s(function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},"_applyCombination"),analogous:s(function(){return this._applyCombination(S4e,arguments)},"analogous"),complement:s(function(){return this._applyCombination(w4e,arguments)},"complement"),monochromatic:s(function(){return this._applyCombination(M4e,arguments)},"monochromatic"),splitcomplement:s(function(){return this._applyCombination(A4e,arguments)},"splitcomplement"),triad:s(function(){return this._applyCombination(G8,[3])},"triad"),tetrad:s(function(){return this._applyCombination(G8,[4])},"tetrad")};ii.fromRatio=function(t,e){if(hA(t)=="object"){var r={};for(var i in t)t.hasOwnProperty(i)&&(i==="a"?r[i]=t[i]:r[i]=j1(t[i]));t=r}return ii(t,e)};function c4e(t){var e={r:0,g:0,b:0},r=1,i=null,n=null,a=null,o=!1,l=!1;return typeof t=="string"&&(t=T4e(t)),hA(t)=="object"&&(bp(t.r)&&bp(t.g)&&bp(t.b)?(e=h4e(t.r,t.g,t.b),o=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):bp(t.h)&&bp(t.s)&&bp(t.v)?(i=j1(t.s),n=j1(t.v),e=d4e(t.h,i,n),o=!0,l="hsv"):bp(t.h)&&bp(t.s)&&bp(t.l)&&(i=j1(t.s),a=j1(t.l),e=p4e(t.h,i,a),o=!0,l="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=sj(r),{ok:o,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}s(c4e,"inputToRGB");function h4e(t,e,r){return{r:Ua(t,255)*255,g:Ua(e,255)*255,b:Ua(r,255)*255}}s(h4e,"rgbToRgb");function U8(t,e,r){t=Ua(t,255),e=Ua(e,255),r=Ua(r,255);var i=Math.max(t,e,r),n=Math.min(t,e,r),a,o,l=(i+n)/2;if(i==n)a=o=0;else{var u=i-n;switch(o=l>.5?u/(2-i-n):u/(i+n),i){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s:o,l}}s(U8,"rgbToHsl");function p4e(t,e,r){var i,n,a;t=Ua(t,360),e=Ua(e,100),r=Ua(r,100);function o(c,p,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?c+(p-c)*6*m:m<1/2?p:m<2/3?c+(p-c)*(2/3-m)*6:c}if(s(o,"hue2rgb"),e===0)i=n=a=r;else{var l=r<.5?r*(1+e):r+e-r*e,u=2*r-l;i=o(u,l,t+1/3),n=o(u,l,t),a=o(u,l,t-1/3)}return{r:i*255,g:n*255,b:a*255}}s(p4e,"hslToRgb");function V8(t,e,r){t=Ua(t,255),e=Ua(e,255),r=Ua(r,255);var i=Math.max(t,e,r),n=Math.min(t,e,r),a,o,l=i,u=i-n;if(o=i===0?0:u/i,i==n)a=0;else{switch(i){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s:o,v:l}}s(V8,"rgbToHsv");function d4e(t,e,r){t=Ua(t,360)*6,e=Ua(e,100),r=Ua(r,100);var i=Math.floor(t),n=t-i,a=r*(1-e),o=r*(1-n*e),l=r*(1-(1-n)*e),u=i%6,c=[r,o,a,a,l,r][u],p=[l,r,r,o,a,a][u],m=[a,a,l,r,r,o][u];return{r:c*255,g:p*255,b:m*255}}s(d4e,"hsvToRgb");function j8(t,e,r,i){var n=[th(Math.round(t).toString(16)),th(Math.round(e).toString(16)),th(Math.round(r).toString(16))];return i&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}s(j8,"rgbToHex");function f4e(t,e,r,i,n){var a=[th(Math.round(t).toString(16)),th(Math.round(e).toString(16)),th(Math.round(r).toString(16)),th(lj(i))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}s(f4e,"rgbaToHex");function $8(t,e,r,i){var n=[th(lj(i)),th(Math.round(t).toString(16)),th(Math.round(e).toString(16)),th(Math.round(r).toString(16))];return n.join("")}s($8,"rgbaToArgbHex");ii.equals=function(t,e){return!t||!e?!1:ii(t).toRgbString()==ii(e).toRgbString()};ii.random=function(){return ii.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function m4e(t,e){e=e===0?0:e||10;var r=ii(t).toHsl();return r.s-=e/100,r.s=_S(r.s),ii(r)}s(m4e,"_desaturate");function g4e(t,e){e=e===0?0:e||10;var r=ii(t).toHsl();return r.s+=e/100,r.s=_S(r.s),ii(r)}s(g4e,"_saturate");function y4e(t){return ii(t).desaturate(100)}s(y4e,"_greyscale");function v4e(t,e){e=e===0?0:e||10;var r=ii(t).toHsl();return r.l+=e/100,r.l=_S(r.l),ii(r)}s(v4e,"_lighten");function _4e(t,e){e=e===0?0:e||10;var r=ii(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),ii(r)}s(_4e,"_brighten");function x4e(t,e){e=e===0?0:e||10;var r=ii(t).toHsl();return r.l-=e/100,r.l=_S(r.l),ii(r)}s(x4e,"_darken");function b4e(t,e){var r=ii(t).toHsl(),i=(r.h+e)%360;return r.h=i<0?360+i:i,ii(r)}s(b4e,"_spin");function w4e(t){var e=ii(t).toHsl();return e.h=(e.h+180)%360,ii(e)}s(w4e,"_complement");function G8(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=ii(t).toHsl(),i=[ii(t)],n=360/e,a=1;a<e;a++)i.push(ii({h:(r.h+a*n)%360,s:r.s,l:r.l}));return i}s(G8,"polyad");function A4e(t){var e=ii(t).toHsl(),r=e.h;return[ii(t),ii({h:(r+72)%360,s:e.s,l:e.l}),ii({h:(r+216)%360,s:e.s,l:e.l})]}s(A4e,"_splitcomplement");function S4e(t,e,r){e=e||6,r=r||30;var i=ii(t).toHsl(),n=360/r,a=[ii(t)];for(i.h=(i.h-(n*e>>1)+720)%360;--e;)i.h=(i.h+n)%360,a.push(ii(i));return a}s(S4e,"_analogous");function M4e(t,e){e=e||6;for(var r=ii(t).toHsv(),i=r.h,n=r.s,a=r.v,o=[],l=1/e;e--;)o.push(ii({h:i,s:n,v:a})),a=(a+l)%1;return o}s(M4e,"_monochromatic");ii.mix=function(t,e,r){r=r===0?0:r||50;var i=ii(t).toRgb(),n=ii(e).toRgb(),a=r/100,o={r:(n.r-i.r)*a+i.r,g:(n.g-i.g)*a+i.g,b:(n.b-i.b)*a+i.b,a:(n.a-i.a)*a+i.a};return ii(o)};ii.readability=function(t,e){var r=ii(t),i=ii(e);return(Math.max(r.getLuminance(),i.getLuminance())+.05)/(Math.min(r.getLuminance(),i.getLuminance())+.05)};ii.isReadable=function(t,e,r){var i=ii.readability(t,e),n,a;switch(a=!1,n=P4e(r),n.level+n.size){case"AAsmall":case"AAAlarge":a=i>=4.5;break;case"AAlarge":a=i>=3;break;case"AAAsmall":a=i>=7;break}return a};ii.mostReadable=function(t,e,r){var i=null,n=0,a,o,l,u;r=r||{},o=r.includeFallbackColors,l=r.level,u=r.size;for(var c=0;c<e.length;c++)a=ii.readability(t,e[c]),a>n&&(n=a,i=ii(e[c]));return ii.isReadable(t,i,{level:l,size:u})||!o?i:(r.includeFallbackColors=!1,ii.mostReadable(t,["#fff","#000"],r))};var H8=ii.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},SQe=ii.hexNames=E4e(H8);function E4e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}s(E4e,"flip");function sj(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}s(sj,"boundAlpha");function Ua(t,e){C4e(t)&&(t="100%");var r=I4e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}s(Ua,"bound01");function _S(t){return Math.min(1,Math.max(0,t))}s(_S,"clamp01");function Cu(t){return parseInt(t,16)}s(Cu,"parseIntFromHex");function C4e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}s(C4e,"isOnePointZero");function I4e(t){return typeof t=="string"&&t.indexOf("%")!=-1}s(I4e,"isPercentage");function th(t){return t.length==1?"0"+t:""+t}s(th,"pad2");function j1(t){return t<=1&&(t=t*100+"%"),t}s(j1,"convertToPercentage");function lj(t){return Math.round(parseFloat(t)*255).toString(16)}s(lj,"convertDecimalToHex");function q8(t){return Cu(t)/255}s(q8,"convertHexToDecimal");var Ih=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function bp(t){return!!Ih.CSS_UNIT.exec(t)}s(bp,"isValidCSSUnit");function T4e(t){t=t.replace(wQe,"").replace(AQe,"").toLowerCase();var e=!1;if(H8[t])t=H8[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=Ih.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=Ih.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Ih.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=Ih.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Ih.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=Ih.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Ih.hex8.exec(t))?{r:Cu(r[1]),g:Cu(r[2]),b:Cu(r[3]),a:q8(r[4]),format:e?"name":"hex8"}:(r=Ih.hex6.exec(t))?{r:Cu(r[1]),g:Cu(r[2]),b:Cu(r[3]),format:e?"name":"hex"}:(r=Ih.hex4.exec(t))?{r:Cu(r[1]+""+r[1]),g:Cu(r[2]+""+r[2]),b:Cu(r[3]+""+r[3]),a:q8(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=Ih.hex3.exec(t))?{r:Cu(r[1]+""+r[1]),g:Cu(r[2]+""+r[2]),b:Cu(r[3]+""+r[3]),format:e?"name":"hex"}:!1}s(T4e,"stringInputToObject");function P4e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}s(P4e,"validateWCAG2Parms");var cX=Rr(lye()),L4e=xt.object({rank:xt.union([xt.enum(["low","medium","high","always-visible"]),xt.number()]).optional(),interactive:xt.boolean().optional(),appearance:xt.object({margin:xt.number().min(6).optional(),text:xt.object({numLines:xt.number().optional(),lineHeight:xt.number().optional(),size:xt.number().optional(),maxWidth:xt.number().optional(),foregroundColor:xt.string().optional(),backgroundColor:xt.string().optional()}).optional(),marker:xt.object({size:xt.number().optional(),foregroundColor:xt.object({active:xt.string().optional(),inactive:xt.string().optional()}).optional(),backgroundColor:xt.object({active:xt.string().optional(),inactive:xt.string().optional()}).optional(),iconSizeInterpolation:xt.object({nearZoomLevel:xt.number().optional(),farZoomLevel:xt.number().optional(),nearScale:xt.number().optional(),farScale:xt.number().optional()}).optional()}).optional()}).optional()});function D4e(t,e,r){xt.array(xt.number()).min(2).max(3).parse(t),xt.string().parse(e),L4e.parse(r||{})}s(D4e,"validateLabel");var v0={margin:6,text:{numLines:2,lineHeight:1.2,size:11.5,maxWidth:150,foregroundColor:"white",backgroundColor:"#333"},marker:{size:5,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},MQe={lightOnDark:vt(Ee({},v0),{text:vt(Ee({},v0.text),{foregroundColor:"white",backgroundColor:"#333"}),marker:vt(Ee({},v0.marker),{foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}})}),darkOnLight:vt(Ee({},v0),{text:vt(Ee({},v0.text),{foregroundColor:"#333",backgroundColor:"white"}),marker:vt(Ee({},v0.marker),{foregroundColor:{active:"#333",inactive:void 0},backgroundColor:{active:"white",inactive:void 0}})})},EQe="LOW_PRIORITY",hX=4,CQe=6,IQe=20,TQe=2.5,PQe=2,LQe="cover",DQe=-1/0,pX=6.5,dX={heightAbovePolygon:0,appearance:MQe.darkOnLight},RQe=s((t,e)=>["numLines","lineHeight","size","maxWidth","foregroundColor","backgroundColor"].some(r=>{var i,n,a;return((i=e.text)==null?void 0:i[r])!=null&&((n=t.text)==null?void 0:n[r])!==((a=e.text)==null?void 0:a[r])}),"isOneOfTextDirtyOptions"),OQe=s((t,e)=>["foregroundColor","backgroundColor","icon"].some(r=>{var i,n,a;return((i=e.marker)==null?void 0:i[r])!=null&&((n=t.marker)==null?void 0:n[r])!==((a=e.marker)==null?void 0:a[r])}),"isOneOfMarkerDirtyOptions"),nI,aI,W8=class oI{constructor(e,r,i){$(this,"lines",0),$(this,"id"),$(this,"rank"),$(this,"type","label"),$(this,"initialRank"),$(this,"contextConfigured",!1),$(this,"fillText"),$(this,"newStyle",{}),$(this,"opacity",0),$(this,"visibilityNeedsUpdate",!1),$(this,"text"),$(this,"style",{top:0,left:0,textLabelVisible:!0,pinVisibility:1,textAlign:"left"}),$(this,"projection",new Jt),$(this,"labelCacheId"),$(this,"_cache",{}),$(this,"appearance"),$(this,"options"),$(this,"visible",!0),$(this,"enabled",!0),$(this,"isOccluded",!1),$(this,"offscreen",!1),$(this,"canShow",!1),$(this,"activeBoundingBox",{x:0,y:0,w:0,h:0}),$(this,"dimensions",{width:0,height:0}),$(this,"currentStrategyIndex",-1),Be(this,nI,0),$(this,"iconScale",1),Be(this,aI),$(this,"dirty",!0),$(this,"textDirty",!0),$(this,"markerDirty",!0),$(this,"attachedDirty",!0),$(this,"collisionDirty",!0),$(this,"lastTextAlign"),$(this,"imageHash"),$(this,"markerSize",0),$(this,"iconVisible",!1),$(this,"dp"),$(this,"animate",!0),$(this,"onStrategySelected",s(l=>{if(this.currentStrategyIndex===l)return;this.currentStrategyIndex=l;let u=this.strategies[this.currentStrategyIndex];if(u){u.onStrategySelected();let c=this.style;this.style=this.newStyle,this.newStyle=c}},"onStrategySelected")),$(this,"packedMessage",{x:0,y:0,enabled:!1,rank:0,bboxes:[],shouldCollideWithScreenEdges:!1,lockedToStrategyIndex:-1});var n,a;if(this.id=(n=r.id)!=null?n:ga(),this.options=(0,cX.default)({},r,dX),this.text=e,this.dp=(l=1)=>l*i.pixelRatio,typeof r.rank=="string")this.rank=q4(r.rank),this.initialRank=this.rank;else if(r.rank!=null&&r.rank>0)this.rank=r.rank,this.initialRank=r.rank;else{let l=Math.trunc(ja.env.NODE_ENV==="test"?oI.testId:oI.testId*10)/10;oI.testId+=.001,this.rank=l,this.initialRank=l}let o=(0,cX.default)({},this.options.appearance,dX.appearance);this.appearance={margin:o.margin,text:{lineHeight:o.text.lineHeight,numLines:o.text.numLines,size:o.text.size,maxWidth:o.text.maxWidth,foregroundColor:o.text.foregroundColor,backgroundColor:o.text.backgroundColor},marker:{foregroundColor:{active:o.marker.foregroundColor.active,inactive:o.marker.foregroundColor.inactive||ii(o.marker.foregroundColor.active).setAlpha(.5).toRgbString()},backgroundColor:{active:o.marker.backgroundColor.active,inactive:o.marker.backgroundColor.inactive||ii(o.marker.backgroundColor.active).setAlpha(.5).toRgbString()},icon:o.marker.icon,iconSize:o.marker.iconSize||IQe,iconPadding:(a=o.marker.iconPadding)!=null?a:PQe,iconFit:o.marker.iconFit||LQe,iconOverflow:o.marker.iconOverflow||"hidden",iconVisibleAtZoomLevel:o.marker.iconVisibleAtZoomLevel==null?DQe:o.marker.iconVisibleAtZoomLevel,iconSizeInterpolation:o.marker.iconSizeInterpolation}},this.scaledIconPadding=this.appearance.marker.iconPadding}get totalMarkerSize(){return w(this,nI)*this.iconScale}set totalMarkerSize(e){He(this,nI,e)}get scaledIconPadding(){return(w(this,aI)||this.appearance.marker.iconPadding||0)*this.iconScale}set scaledIconPadding(e){He(this,aI,e)}setEntity(){}calculateMarkerSize(){let e=this.dp();this.iconVisible&&typeof this.appearance.marker.iconSize<"u"&&this.imageHash?this.markerSize=this.dp(this.appearance.marker.iconSize):this.markerSize=this.dp(pX),this.totalMarkerSize=Math.ceil((this.markerSize+TQe)/e)}get lowPriorityStrategyIndex(){return this.text===""?-1:3}get strategies(){let{width:e,height:r}=this.dimensions,{margin:i}=this.appearance,n=Math.max(CQe,i),a=this.iconVisible?n/2:0,o=this.iconVisible?this.totalMarkerSize:pX/2,l=[{name:"RIGHT",getBoundingBox:s(()=>{let u=Math.max(this.totalMarkerSize,r);return[u/2+n,u/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+e+n]},"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.textAlign="left",this.newStyle.pinVisibility=1,this.newStyle.top=-r/2,this.newStyle.left=this.totalMarkerSize/2+hX,this.newStyle.textLabelVisible=!0},"onStrategySelected")},{name:"LEFT",getBoundingBox:s(()=>{let u=Math.max(this.totalMarkerSize,r);return[u/2+n,u/2+n,this.totalMarkerSize/2+e+n,this.totalMarkerSize/2+n]},"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.textAlign="right",this.newStyle.pinVisibility=1,this.newStyle.top=-r/2,this.newStyle.left=-e-this.totalMarkerSize/2-hX,this.newStyle.textLabelVisible=!0},"onStrategySelected")},{name:"TOP",getBoundingBox:s(()=>{let u=this.dp();return[r+this.totalMarkerSize/2/u+n,this.totalMarkerSize/2+n,e/2+n,e/2+n]},"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.pinVisibility=1,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-r-this.totalMarkerSize/2,this.newStyle.left=-e/2},"onStrategySelected")},{name:EQe,getBoundingBox:s(()=>[o+a,o+a,o+a,o+a],"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.pinVisibility=.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0},"onStrategySelected")}];return this.text===""?[{name:"ICON_ONLY",getBoundingBox:s(()=>[this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n],"getBoundingBox"),onStrategySelected:s(()=>{this.newStyle.pinVisibility=1,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0},"onStrategySelected")}]:l}recomputeCurrentStrategy(e=this.iconScale){if(this.iconScale!==e||this.dirty){let r=this.strategies[this.currentStrategyIndex];if(this.iconScale=e,this.collisionDirty=!0,r){r.onStrategySelected(e);let i=this.style;this.style=this.newStyle,this.newStyle=i}this.dirty=!1}}updatePosition(){}disable(){this.visible=!1}toPackedMessage(e=!1){var r;if(this.visible&&e&&this.collisionDirty===!1&&this.currentStrategyIndex!=null&&this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex?this.packedMessage.lockedToStrategyIndex=this.currentStrategyIndex:this.packedMessage.lockedToStrategyIndex=-1,this.packedMessage.x=this.projection.x,this.packedMessage.y=this.projection.y,this.packedMessage.enabled=this.enabled,this.packedMessage.rank=this.rank,this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex&&this.currentStrategyIndex!==((r=this.packedMessage.bboxes[0])==null?void 0:r[4])){let i=this.packedMessage.bboxes.findIndex(n=>n[4]===this.currentStrategyIndex);if(i!==-1){let n=this.packedMessage.bboxes.splice(i,1)[0];this.packedMessage.bboxes.unshift(n)}}if(!this.collisionDirty)return this.packedMessage;this.packedMessage.bboxes=[];for(let i=0;i<this.strategies.length;i++){let n=this.strategies[i];i===this.currentStrategyIndex&&this.currentStrategyIndex!==-1&&this.currentStrategyIndex!==this.lowPriorityStrategyIndex?this.packedMessage.bboxes.unshift([...n.getBoundingBox(),i]):this.packedMessage.bboxes.push([...n.getBoundingBox(),i])}return this.packedMessage.shouldCollideWithScreenEdges=!1,this.collisionDirty=!1,this.packedMessage}destroy(){}};nI=new WeakMap,aI=new WeakMap,s(W8,"LabelComponent"),$(W8,"testId",0);var kQe=W8,p_=kQe;N();N();var R4e=class extends qa{constructor(e,r){super(),$(this,"rendererState"),$(this,"convertTo3DMapPosition"),$(this,"textSet",new Set),$(this,"batchedTextMap",new Map),$(this,"debugTextAreaMesh",new Map),this.rendererState=e,this.convertTo3DMapPosition=r}remove(e){this.textSet.delete(e)}update(e){var r,i,n;let a,o,l,u=[];for(let c of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(c),(a==null?void 0:a.type)==="text3d"){o=a.components[0],l=a.components[1];let p=(r=o.mesh)==null?void 0:r.parent;if(!p||!(p instanceof Yn)||!(o instanceof sI))continue;if("textArea"in o.feature.properties&&o.mesh!=null&&o.polygonEntityId!=null&&o.textMesh==null&&o.mesh.parent!=null&&((n=(i=o.feature.properties)==null?void 0:i.textArea)==null?void 0:n.position)!=null){if(this.textSet.has(o.polygonEntityId))continue;this.textSet.add(o.polygonEntityId),this.batchedTextMap.has(p)||this.batchedTextMap.set(p,av().then(({BatchedText:v})=>{let x=new v;return x.type="batchedtext",p.add(x),x}));let y=this.batchedTextMap.get(p);if(!y)throw new Error("batched text required");u.push(X8({entityId:c,textComponent:o,styleComponent:l,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:y,rendererState:this.rendererState,type:"text-area"}).then(()=>{this.publish("render")}))}else if(o.mesh!=null&&o.textMesh==null&&o.mesh.parent!=null){if(this.textSet.has(c.toString()))continue;this.textSet.add(c.toString()),this.batchedTextMap.has(p)||this.batchedTextMap.set(p,av().then(({BatchedText:v})=>{let x=new v;return x.type="batchedtext",p.add(x),x}));let y=this.batchedTextMap.get(p);if(!y)throw new Error("batched text required");u.push(X8({entityId:c,textComponent:o,styleComponent:l,convertTo3DMapPosition:this.convertTo3DMapPosition,batchedMeshPromise:y,rendererState:this.rendererState,type:"point"}).then(()=>{this.publish("render")}))}let m=this.batchedTextMap.get(p);o.textMesh&&m&&o.polygonEntityId!=null&&Promise.all([m,Promise.resolve({meshComponent:o,styleComponent:l})]).then(([y,{meshComponent:v,styleComponent:x}])=>{let{textMesh:E}=v;if(y&&E){let M=uj(y,E);v.visible&&!M?y.add(E):!v.visible&&M&&y.remove(E)}x.flipToFaceCamera&&this.flipIfNeeded(v,e)})}return Promise.all(u)}flipIfNeeded(e,r){let i=e.textMesh;if(!i)return!1;let n=i.rotation.z,a=kO(n+r);a>Math.PI/2&&a<3*Math.PI/2&&(i.rotation.z=kO(n+Math.PI))}showTextAreaMesh(){let e,r;for(let i of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(i),(e==null?void 0:e.type)==="text3d"&&(r=e.components[0],"textArea"in r.feature.properties)){let n=r.feature.properties.textArea;if(!n)continue;let a=new pv(n.maxWidth,n.maxHeight),o=new Tn(a,new ug({color:"pink"})),{textMesh:l}=r;if(!l)continue;let u=this.convertTo3DMapPosition(n.position,Vb);o.position.copy(u),o.position.z=l.position.z-.1,o.rotation.z=l.rotation.z,kD.identity(),kD.makeRotationAxis(new qe(0,0,1),l.userData.rotationZ),Vb.set(n.maxWidth/2,0,0),Vb.applyMatrix4(kD),o.position.x-=Vb.x,o.position.y-=Vb.y,this.rendererState.entityScene.add(o),this.debugTextAreaMesh.set(i,o)}this.publish("render")}hideTextAreaMesh(){this.debugTextAreaMesh.forEach(e=>{this.rendererState.entityScene.remove(e)}),this.debugTextAreaMesh.clear(),this.publish("render")}};s(R4e,"Text3DSystem");var NQe=R4e;function O4e(t){av().then(({configureTroikaTextBuilder:e})=>{e({useWorker:t})})}s(O4e,"configureWorker");var kD=new Ri,Vb=new qe,ND;async function k4e(t){let{preloadFont:e}=await av();return e(t)}s(k4e,"preloadFont");function av(){return ND||(ND=ag(()=>import("./text3d-DNZ77VLG-jbrvVpdR.js"),[]).then(t=>t)),ND}s(av,"getText3DService");async function X8({entityId:t,textComponent:e,styleComponent:r,convertTo3DMapPosition:i,batchedMeshPromise:n,rendererState:a,type:o="text-area"}){return Promise.all([av(),Promise.resolve({entityId:t,meshComponent:e,styleComponent:r})]).then(([{createTroikaTextPoint:l,createTroikaTextArea:u},c])=>o==="text-area"?u(c.entityId,c.meshComponent,c.styleComponent,i):l(c.entityId,c.meshComponent,c.styleComponent,i)).catch(l=>{Vt.warn("Trouble creating text: ",l)}).then(l=>{if(!(l!=null&&l.text))return;let u=[Promise.resolve(l.text),n,Promise.resolve()];if(e.polygonEntityId){let c=a.geometry3DMap.get(e.polygonEntityId);if((c==null?void 0:c.type)==="geometry"){let p=c.components[0],m=c.components[1];p.textMesh=l.text,p.mesh!=null&&(l.text.position.z=m.altitude+m.height+FQe)}}else u[2]=av().then(({syncText:c})=>c(l.text));return Promise.all(u)}).then(l=>{if(!l)return;let[u,c]=l;c.add(u),e.batchedText||(e.batchedText=c)})}s(X8,"createText");function uj(t,e){return t._members.has(e)}s(uj,"doesBatchedTextContainsText");var FQe=.5,BQe=xt.object({visible:xt.boolean(),color:xt.string(),flipToFaceCamera:xt.boolean(),font:xt.string().optional(),fontSize:xt.number(),margin:xt.union([xt.number(),xt.tuple([xt.number(),xt.number(),xt.number(),xt.number()])]),outlineColor:xt.string(),outlineOpacity:xt.number(),outlineBlur:xt.union([xt.number(),xt.string()]),outlineWidth:xt.number(),outlineOffsetX:xt.number(),outlineOffsetY:xt.number(),strokeWidth:xt.number(),maxWidth:xt.number().optional(),maxHeight:xt.number().optional(),strokeOpacity:xt.number(),strokeColor:xt.string(),fillOpacity:xt.number(),hoverColor:xt.string().optional(),id:xt.union([xt.string(),xt.number()]),type:xt.literal("text3d"),position:xt.tuple([xt.number(),xt.number(),xt.number()]),content:xt.string()}),N4e=BQe.partial().omit({id:!0,type:!0}).strict(),zQe=N4e.omit({margin:!0,position:!0,maxWidth:!0,maxHeight:!0,content:!0}).strict(),UQe=xt.object({appearance:N4e.optional(),parentId:xt.string().optional()}).strict(),F4e=class{constructor(e){$(this,"mesh",new cx),$(this,"textMesh"),$(this,"type","text3d"),$(this,"feature"),$(this,"parent"),$(this,"batchedText"),$(this,"polygonEntityId"),this.feature=e}get visible(){return this.batchedText&&this.textMesh?uj(this.batchedText,this.textMesh):this.textMesh?this.textMesh.visible:!1}set visible(e){this.batchedText&&this.textMesh?e?this.batchedText.addText(this.textMesh):this.batchedText.removeText(this.textMesh):this.textMesh&&(this.textMesh.visible=e),this.mesh.visible=e}};s(F4e,"Text3DComponent");var sI=F4e;N();var B4e=class{constructor(e){$(this,"color"),$(this,"dirty",!0),$(this,"visible",!0),$(this,"edgeColors"),$(this,"geometry"),$(this,"ranges"),$(this,"topFaceVerticesIndices"),this.color=e}get currentOpacity(){return this.edgeColors&&this.ranges?this.edgeColors.array[3]:0}get currentColor(){return this.edgeColors&&this.ranges?[this.edgeColors.array[0],this.edgeColors.array[1],this.edgeColors.array[2]]:[0,0,0]}};s(B4e,"OutlineComponent");var z4e=B4e;N();N();N();var U4e=class extends a_{constructor(e){let r=e,i=3,n=i*4;super(new Float32Array(e*n),i,e,Ll,Lu),$(this,"_width"),$(this,"_height"),$(this,"_propertiesLength"),this._width=n,this._height=r,this._propertiesLength=i}setColor(e,r,i){let n=this.image.data,a=e*this._width;n[a]=r.r,n[a+1]=r.g,n[a+2]=r.b,n[a+3]=0,n[a+4]=i.r,n[a+5]=i.g,n[a+6]=i.b,n[a+7]=0,this.needsUpdate=!0}getColor(e){let r=this.image.data,i=e*this._width,n=new oi(r[i],r[i+1],r[i+2]),a=new oi(r[i+4],r[i+5],r[i+6]);return{color:n,topColor:a}}setTexture(e,r,i){let n=this.image.data,a=e*this._width;n[a+8]=r?1:0,n[a+9]=i?1:0,n[a+10]=0,n[a+11]=0,this.needsUpdate=!0}};s(U4e,"BatchedPropertiesTexture");var VQe=U4e;N();var jQe=`#define LAMBERT
varying vec3 vViewPosition;
varying vec4 vPosition;
varying vec2 vUv;
varying vec4 finalPosition;
varying vec3 vWorldPosition;
varying vec3 worldNormal;
varying float vBatchId;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
	
  // To mitigate visual defects on machines such as windows and iOS
	vBatchId = getIndirectIndex(gl_DrawID) + 0.5;
	vViewPosition = - mvPosition.xyz;
	worldNormal = normal;
	vUv = uv;
	vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
}
`;N();var $Qe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
uniform float uGradientEnd;
uniform float uGradientIntensity;
uniform float uMinSideAlpha;
uniform float uMaxSideAlpha;
uniform float uGradientStart;
uniform highp sampler2D uPropertiesTexture;
uniform highp sampler2D uTopTexture;
uniform highp sampler2D uTexture;
uniform float uRepeatYFactor;
uniform bool uBlendTexture;
varying float vBatchId;

varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 worldNormal;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

vec3 blendTextureColor(vec3 diffuseColor, vec4 texColor) {
	vec3 texturedColor = diffuseColor * texColor.rgb;
	return mix(diffuseColor, texturedColor, texColor.a);
}

void main() {
	#include <clipping_planes_fragment>

	// get the normalized world normal of vertex fragment
	vec3 surfaceNormal = normalize(worldNormal);

	// get angle relative to Z up
	float angle = degrees(acos(abs(dot(surfaceNormal, vec3(0.0, 0.0, 1.0)))));

	int idx = int(vBatchId) * 1;
	vec3 diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(0, idx), 0).rgb);
	bool shouldShowTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).r > 0.99;

	if(shouldShowTexture) {
		vec4 tex2d = texture2D(uTexture, vec2(vUv.x, vUv.y * uRepeatYFactor));
		diffuse = uBlendTexture ? blendTextureColor(diffuse, tex2d) : tex2d.rgb;
	}

	// if this is a fragment facing upwards, use topColor. Avoid any sort of '==' comparison, due to floating point precision issue
	if(angle < 0.02) {
		bool shouldShowTopTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).g > 0.99;

		if(shouldShowTopTexture) {
			vec4 topTex2d = texture2D(uTopTexture, vUv);
			diffuse = uBlendTexture ? blendTextureColor(diffuse, topTex2d) : topTex2d.rgb;
		} else {
			diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(1, idx), 0).rgb);
		}
	}

	vec4 diffuseColor = vec4(diffuse, opacity);

	// only for vertical surfaces
	if(angle > 89.0 && angle < 91.0) {

		// get the percentage of the z position from the ground, up
		float percentFromZeroZ = max((abs(vWorldPosition.z) - uGradientStart) / uGradientEnd, 0.0);

		// gradient based on percentage
		float alpha = smoothstep(uMinSideAlpha, uMaxSideAlpha, percentFromZeroZ);

		// mix the shadow color with the diffuse color based on the alpha and opacity
		diffuseColor = vec4(mix(diffuseColor.rgb, diffuseColor.rgb * (1.0 - uGradientIntensity), 1.0 - alpha), opacity);
	}

	ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,GQe=-.05,HQe=1,V4e=class extends R_{constructor(e,r,i=1){super(e),$(this,"propertiesTexture"),$(this,"uniforms",{uGradientIntensity:{value:0},uGradientEnd:{value:0},uGradientStart:{value:0},uTopTexture:{value:null},uTexture:{value:null},uRepeatYFactor:{value:1},uBlendTexture:{value:!1}}),$(this,"colorSpace",il),$(this,"showTextures",s(n=>{let a=!!this.uniforms.uTexture.value,o=!!this.uniforms.uTopTexture.value;(a||o)&&(this.propertiesTexture.setTexture(n,a,o),this.needsUpdate=!0)},"showTextures")),this.propertiesTexture=new VQe(r),this.uniforms.uRepeatYFactor.value=i,this.onBeforeCompile=n=>{let a=this.uniforms.uGradientIntensity,o=this.uniforms.uGradientEnd,l=this.uniforms.uGradientStart,u=this.uniforms.uTopTexture,c=this.uniforms.uTexture,p=this.uniforms.uRepeatYFactor,m=this.uniforms.uBlendTexture;this.uniforms=n.uniforms,n.vertexShader=jQe,n.fragmentShader=$Qe,Object.assign(this.uniforms,{uGradientIntensity:a,uGradientEnd:o,uGradientStart:l,uMinSideAlpha:{value:GQe},uMaxSideAlpha:{value:HQe},uPropertiesTexture:{value:this.propertiesTexture},uTopTexture:u,uTexture:c,uRepeatYFactor:p,uBlendTexture:m})}}get repeatYFactor(){return this.uniforms.uRepeatYFactor.value}set repeatYFactor(e){e!==this.uniforms.uRepeatYFactor.value&&(this.uniforms.uRepeatYFactor.value=e,this.needsUpdate=!0)}get texture(){return this.uniforms.uTexture.value}set texture(e){e.wrapS=Bh,e.wrapT=Bh,e.colorSpace=this.colorSpace,this.uniforms.uTexture.value=e}get topTexture(){return this.uniforms.uTopTexture.value}set topTexture(e){e.wrapS=Bh,e.wrapT=Bh,e.colorSpace=this.colorSpace,this.uniforms.uTopTexture.value=e}get blendTexture(){return this.uniforms.uBlendTexture.value}set blendTexture(e){e!==this.uniforms.uBlendTexture.value&&(this.uniforms.uBlendTexture.value=e,this.colorSpace=e?Wy:il,this.texture&&(this.texture.colorSpace=this.colorSpace),this.topTexture&&(this.topTexture.colorSpace=this.colorSpace),this.needsUpdate=!0)}setGradientShading(e,r,i){this.uniforms.uGradientStart.value=e,this.uniforms.uGradientEnd.value=r,this.uniforms.uGradientIntensity.value=i}setColor(e,r,i){this.propertiesTexture.setColor(e,r,i)}getColor(e){return this.propertiesTexture.getColor(e)}hideTextures(e){let r=!!this.uniforms.uTexture.value,i=!!this.uniforms.uTopTexture.value;(r||i)&&(this.propertiesTexture.setTexture(e,!1,!1),this.needsUpdate=!0)}removeSideTexture(e){if(this.texture){this.texture.dispose(),this.uniforms.uTexture.value=null;let r=!!this.uniforms.uTopTexture.value;this.propertiesTexture.setTexture(e,!1,r),this.needsUpdate=!0}}removeTopTexture(e){if(this.topTexture){this.topTexture.dispose(),this.uniforms.uTopTexture.value=null;let r=!!this.uniforms.uTexture.value;this.propertiesTexture.setTexture(e,r,!1),this.needsUpdate=!0}}dispose(){super.dispose(),this.propertiesTexture.dispose()}};s(V4e,"BatchedStandardMaterial");var Z8=V4e;N();function j4e(t,e){var r,i,n;let a=0;for(let p of t)a+=((i=(r=p.components[0])==null?void 0:r.geometry)==null?void 0:i.attributes.position.count)||0;let o=new oi(e.color),l;l=new Z8({color:o,side:e.side==="back"?eu:e.side==="front"?Qp:Pu,opacity:(n=e.opacity)!=null?n:1,transparent:e.opacity!==void 0?e.opacity<1:!1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1},t.length);let u=new FB(t.length,a,0,l),c;for(let p of t)c=p.components[0],!(!(c instanceof tu)||!c.geometry)&&(c.mesh=u,c.material=l,c.instanceIndex=u.addGeometry(c.geometry),u.addInstance(c.instanceIndex),u.userData.entities[c.instanceIndex]=p.id,l instanceof Z8&&l.setColor(c.instanceIndex,o,e.topColor?new oi(e.topColor):o));return u.perObjectFrustumCulled=!0,u.matrixAutoUpdate=!1,u}s(j4e,"batchGeometries");function cj(t){return ii(t).darken(30).toRgbString()}s(cj,"darkenColorForOutline");function $4e(t,e,r,i){if(e.length<1)return;t.boundingBox||t.computeBoundingBox();let n=t.boundingBox,a=t.getAttribute("position"),o=t.getAttribute("normal"),l=t.getAttribute("uv"),u,c;t.index?(u=t.index.count/3,c=s(function(C,T){return t.index.getX(C*3+T)},"meshIndex")):(u=a.count/3,c=s(function(C,T){return C*3+T},"meshIndex"));let p=new Ri;p.makeRotationFromQuaternion(new ff().setFromEuler(new Nu(0,0,r/180*Math.PI)));let m=e.find(C=>C.face==="top"),y;m&&(y={min:i(m.bounds[1],m.bounds[0],0),max:i(m.bounds[3],m.bounds[2],n.max.z)});let v=e.find(C=>C.face==="side"),x;if(v&&(x={min:i(v.bounds[1],v.bounds[0],0),max:i(v.bounds[3],v.bounds[2],n.max.z)}),!(!x&&!y))for(let C=0;C<u;++C){let T=o.getX(c(C,0))+o.getX(c(C,1))+o.getX(c(C,2)),D=o.getY(c(C,0))+o.getY(c(C,1))+o.getY(c(C,2)),F=o.getZ(c(C,0))+o.getZ(c(C,1))+o.getZ(c(C,2)),k=Math.abs(T),B=Math.abs(D),U=Math.abs(F);var E,M;k<=B&&k<=U?(E="x",B<=U?M="y":M="z"):B<=k&&B<=U?(E="y",k<=U?M="x":M="z"):(E="z",k<=B?M="x":M="y"),E==="z"&&(E=M,M="z");let z,q,Z,Q,V,ae;if(M==="z"||E==="z"){if(!v||!x)continue;z=v.repeat.u,q=v.repeat.v,Z=v.offset.u,Q=v.offset.v,V=v.rotation,ae=x}else{if(!m||!y)continue;z=m.repeat.u,q=m.repeat.v,Z=m.offset.u,Q=m.offset.v,V=(360-r+m.rotation)%360,ae=y}let{min:Y,max:he}=ae,J=new Ha;J.position.set(Y.x,Y.y,0),J.updateMatrix(),J.updateMatrixWorld();let ne=Y.clone().applyMatrix4(p),ee=he.clone().applyMatrix4(p),ue=Math.abs(ee.x-ne.x),K=Math.abs(ee.y-ne.y),ce=new qe(ue,K,he.z).applyMatrix4(J.matrixWorld),re=Math.abs(ce[E]-Y[E]),se=Math.abs(ce[M]-Y[M]),de=V*Math.PI/180||0,we=Math.cos(de),Le=Math.sin(de),fe=J.matrixWorld.clone().invert(),Re=new ff().setFromEuler(new Nu(0,0,r/180*Math.PI));for(let me=0;me<3;me++){let Ae=new qe(a.getX(c(C,me)),a.getY(c(C,me)),a.getZ(c(C,me))).applyMatrix4(fe);Ae.applyQuaternion(Re);let Ue=Ae.applyMatrix4(J.matrixWorld),_e=Ue.x,lt=Ue.y,tt=Ue.z;var I,P;E==="x"?I=z*(_e-Y[E])/re+Z:E==="y"?I=z*(lt-Y[E])/re+Z:I=z*(tt-Y[E])/re+Z,M==="x"?P=q*(_e-Y[M])/se+Q:M==="y"?P=q*(lt-Y[M])/se+Q:P=q*(tt-Y[M])/se+Q,I-=.5,P-=.5;let We=I*we-P*Le+.5,at=I*Le+P*we+.5;l.setX(c(C,me),We),l.setY(c(C,me),at)}}}s($4e,"updateUVsLegacy");N();var G4e=class{constructor(){$(this,"focusMesh"),$(this,"dirty",!0)}};s(G4e,"FocusableComponent");var H4e=G4e;function Ml(t,e,r){if(e!==void 0){if(t.type==="model"||t.type==="path"||t.type==="marker"||t.type==="label"||t.type==="geometry"||t.type==="group-container"||t.type==="custom-geometry")return e===!0?(t instanceof k_&&t.components[1]===void 0?(t.components[1]=new OD,t.components[1].dirty=!0):t instanceof za&&t.components[2]===void 0?(t.components[2]=new OD,t.components[2].dirty=!0):t instanceof Yn&&t.components[1]===void 0&&(t.components[1]=new OD,t.components[1].dirty=!0),!0):(t instanceof k_?t.components[1]=void 0:t instanceof za?t.components[2]=void 0:t instanceof Yn&&(t.components[1]=void 0),!0);if(t.type==="geometry-group"){let i;for(let n of t.userData.entities3D.values())i=r.geometry3DMap.get(n),Ml(i,e,r);return!0}}return!1}s(Ml,"updateInteractivity");function q4e(t,e,r){if(!(!(r!=null&&r.color)&&!("topColor"in r))){if(r!==void 0&&t.type==="geometry-group"&&t.components[0]!=null){let i,n,a=t.components[0];for(let o of t.userData.entities3D.values())if(i=e.geometry3DMap.get(o),i){n=i.components[1],n.color===a.color&&(n.initialColor=r.color||a.color,n.color=r.color||a.color,n.dirty=!0);let l=i.components[3];l&&(l.color=cj(n.color||a.color),l.dirty=!0),n.topColor===a.topColor&&(n.topColor=r.topColor||a.topColor,n.dirty=!0)}return r.color!==void 0&&(a.color=r.color,a.dirty=!0),"topColor"in r&&(a.topColor=r.topColor,a.dirty=!0),!0}return!1}}s(q4e,"updateGroupColor");function W4e(t,e){if(e!==void 0&&t.type==="geometry-group"&&t.components[0]!=null){let r=t.components[0];return r.shading=r.shading||{},r.shading&&(e.start!==r.shading.start||e.end!==r.shading.end||e.intensity!==r.shading.intensity)&&(Object.assign(r.shading,e),t.userData.shadingDirty=!0),!0}return!1}s(W4e,"updateGroupShading");function X4e(t,e){e!==void 0&&t.type==="geometry"&&(e.showImage!==void 0&&(t.components[1].showImage=e.showImage),e.flipImageToFaceCamera!==void 0&&(t.components[1].flipImageToFaceCamera=e.flipImageToFaceCamera))}s(X4e,"updateImageProps");function Y8(t,e,r){if(r!==void 0){if(t.type==="geometry"){let i=t.components[1];if(i.height!==r)return i.height=r,i.dirty=!0,t.components[3]&&(t.components[3].dirty=!0),!0}else if(t.type==="geometry-group"){let i=t.components[0];for(let n of t.userData.entities3D.values()){let a=e.geometry3DMap.get(n),o;((a==null?void 0:a.type)==="geometry"||(a==null?void 0:a.type)==="model")&&(o=a.components[1],o.height===i.height&&(a.components[1].height=r,a.components[1].dirty=!0),a.components[3]&&(a.components[3].dirty=!0))}return t.components[0].height=r,!0}}return!1}s(Y8,"updateHeight");function hj(t,e){if(e!==void 0){let r=!1;(t.type==="path"||t.type==="geometry")&&(e.initialColor!==void 0&&e.initialColor!==t.components[1].initialColor&&(t.components[1].initialColor=e.initialColor,r=!0),e.color!==void 0&&e.color!==t.components[1].color&&(t.components[1].color=e.color,r=!0,t.components[3]&&(t.components[3].color=e.color,t.components[3].dirty=!0)),"topColor"in e&&(t.components[1].topColor=e.topColor,r=!0),r&&(t.components[1].dirty=!0))}}s(hj,"updateColor");function K8(t,e,r){e!==void 0&&(t.type==="label"||t.type==="marker"?t.updatePosition(r(e[1],e[0],e[2]||0)):t.type==="custom-geometry"&&t.components[0].position.copy(r(e[1],e[0],e[2]||0)))}s(K8,"updatePosition");function J8(t,e){var r;return e!==void 0&&(t.type==="marker"||t.type==="label"||t.type==="custom-geometry")&&t.parentObject3D!==e&&t.parentObject3D instanceof Yn?((r=t.parentObject3D)==null||r.removeEntity(t),e.addEntity(t),!0):!1}s(J8,"updateParent");function Z4e(t,e){e!==void 0&&(t.type==="marker"||t.type==="label")&&t.components[0].enabled!==e&&(t.components[0].enabled=e)}s(Z4e,"updateEnabled");function Y4e(t,e,r){if(e!==void 0&&t.type==="marker"){let i=t.components[0];if(e.contentHTML!==void 0)return i.containerEl.innerHTML=e.contentHTML,i.contentHtml=e.contentHTML,!0;if(e.anchor!==void 0&&(i.options.anchor=e.anchor,i.collisionDirty=!0),e.dynamicResize!==void 0)return i.options.dynamicResize=e.dynamicResize,!0;if(e.options!=null){try{s4e.parse(e.options||{})}catch(n){return Vt.error(n),!1}return e.options.interactive!=null&&(e.options.interactive==="pointer-events-auto"?(i.pointerEvents="auto",Ml(t,!1,r)):(i.pointerEvents="none",Ml(t,e.options.interactive,r))),pj(t,e.options.rank),!0}}return!1}s(Y4e,"updateMarker");function pj(t,e){return e!==void 0&&(t.type==="marker"||t.type==="label")?(t.components[0].rank=q4(e),!0):!1}s(pj,"updateRank");function K4e(t,e,r){var i,n,a,o,l;if(e!==void 0&&t.type==="label"){let u=t.components[0];e.text!==void 0&&e.text!==u.text&&(u.text=e.text,u.textDirty=!0);try{L4e.parse(e.options||{})}catch(c){Vt.error(c);return}RQe(u.appearance,((i=e.options)==null?void 0:i.appearance)||{})&&(u.textDirty=!0),OQe(u.appearance,((n=e.options)==null?void 0:n.appearance)||{})&&(u.markerDirty=!0),jB(u.appearance,((a=e.options)==null?void 0:a.appearance)||{}),Ml(t,(o=e.options)==null?void 0:o.interactive,r),pj(t,(l=e.options)==null?void 0:l.rank)}}s(K4e,"updateLabel");function J4e(t,e){e!==void 0&&t.type==="geometry"&&(t.components[1].hoverColor=e,t.components[1].dirty=!0)}s(J4e,"updateHoverColor");function Q4e(t,e){if(e!==void 0){let r=t.components[2];if(t.type==="geometry"&&r!=null)return r.hover=e,r.dirty=!0,!0}return!1}s(Q4e,"updateHovered");function Q8(t,e){e!==void 0&&t.type==="image"&&(t.components[1].flipImageToFaceCamera=e)}s(Q8,"updateFlipImageToFaceCamera");function Cp(t,e,r){if(r!==void 0){if(t.type==="model"||t.type==="path"||t.type==="geometry"||t.type==="custom-geometry"||t.type==="image"||t.type==="text3d"){r!==t.components[1].visible&&(t.components[1].visible=r,t.components[1].dirty=!0);let i=t.components[3];i&&(i.visible=r,i.dirty=!0)}else t.type==="geometry-group"?t.setVisible(r):t.type==="group-container"?(t.setVisible(r),r===!1&&t.traverse(i=>{if(i instanceof Rw){let n=e.geometry2DMap.get(i.userData.entityId);if(n){let a=n.components[0];a instanceof p_&&(a.canShow=r)}}})):t.type==="label"&&(t.components[0].visible=r);return!0}return!1}s(Cp,"updateVisibility");function eN(t,e,r){if(r!==void 0){if(t.type==="geometry-group"){let i=t.components[0];if(i.opacity!==r){for(let n of t.userData.entities3D.values()){let a=e.geometry3DMap.get(n),o;((a==null?void 0:a.type)==="geometry"||(a==null?void 0:a.type)==="model")&&(o=a.components[1],(!o.opacity||o.opacity===i.opacity)&&(o.opacity=r,o.dirty=!0))}return t.setOpacity(r),i.opacity=r,!0}}else if(t.type==="group-container"&&t.opacity!==r){t.setOpacity(r);let i=1;return t.parent instanceof Yn&&(i=t.parent.opacity),dj(t,e,i),!0}}return!1}s(eN,"updateOpacity");function dj(t,e,r=1){if(t.type==="group-container"&&"children"in t&&t.children.length>0){let i=r*t.opacity;t.userData.computedOpacity=i;for(let n of t.children)(n instanceof Fu&&n.type==="geometry-group"||n instanceof Yn&&n.type==="group-container")&&dj(n,e,i)}else if(t.type==="geometry-group")for(let i of t.userData.entities3D.values()){let n=e.geometry3DMap.get(i),a;((n==null?void 0:n.type)==="geometry"||(n==null?void 0:n.type)==="model")&&(a=n.components[1],a.dirty=!0)}}s(dj,"cascadeOpacity");function e5e(t,e){if(e!==void 0&&t.type==="geometry-group"){let r=t.components[0];(e==null?void 0:e.texture)!=null&&r.texture!==(e==null?void 0:e.texture)&&(r.texture=e.texture,r.dirty=!0),(e==null?void 0:e.topTexture)!=null&&r.topTexture!==(e==null?void 0:e.topTexture)&&(r.topTexture=e.topTexture,r.dirty=!0)}}s(e5e,"updateGroupTexture");function t5e(t,e){if(t.type==="geometry"){let r=!1,i=t.components[1];if((e==null?void 0:e.texture)!=null&&i.texture!==(e==null?void 0:e.texture)&&(i.texture=e.texture,r=!0),(e==null?void 0:e.topTexture)!=null&&i.topTexture!==(e==null?void 0:e.topTexture)&&(i.topTexture=e.topTexture,r=!0),r&&t.components[0]instanceof tu){let n=t.components[0];return n.detached===!1&&(n.detached=!0,n.dirty=!0),t.components[1].dirty=!0,!0}}return!1}s(t5e,"updateIndividualGeometryTexture");function r5e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1];if(r.opacity!==e){r.opacity=e;let i=t.components[0],n=t.components[3];n&&(n.dirty=!0),i.detached===!1&&(i.detached=!0,i.dirty=!0),e===0?r.visible=!1:r.visible=!0,r.dirty=!0;let a=t.parentObject3D;return(a==null?void 0:a.type)==="geometry-group"&&(a.userData.shadingDirty=!0),!0}}return!1}s(r5e,"updateIndividualGeometryOpacity");function lI(t,e){if(e!==void 0){if(t.type==="path"||t.type==="geometry"||t.type==="custom-geometry")t.components[1].altitude=e,t.components[1].dirty=!0;else if(t.type==="group-container"&&t.altitude!==e||t.type==="geometry-group")return t.setAltitude(e),!0}return!1}s(lI,"updateAltitude");function V3(t,e,r){if(r!==void 0){if(t.type==="geometry-group"&&t.components[0]!=null)for(let i of t.userData.entities3D.values()){let n=e.geometry3DMap.get(i);n instanceof za&&V3(n,e,r)}else if(t.type==="geometry"){let i=t.components[3],n=t.components[1];!i&&r===!0?t.components[3]=new z4e(n.color):i&&(i.visible=r,i.dirty=!0)}return!0}return!1}s(V3,"updateOutline");function tN(t,e){if(e!==void 0){if(t.type==="geometry"){let r=t.components[0];if(t.type==="geometry"&&r&&r instanceof tu&&r.focusable!==e)return r.focusable=e,!0}else if(t.type==="group-container"){let r=t.components[2]!==void 0;if(e===!0&&!r)return t.components[2]=new H4e,!0;if(e===!1&&r)return t.components[2]=void 0,!0}}return!1}s(tN,"updateFocusable");function i5e(t,e){if(e!==void 0&&t.type==="geometry"){let r=t.components[1];if(r.renderOrder!==e){r.renderOrder=e;let i=t.components[0];return i.detached===!1&&(i.detached=!0,i.dirty=!0),i.imageMesh&&(i.imageMesh.renderOrder=e+1),r.dirty=!0,!0}}return!1}s(i5e,"updateIndividualGeometryRenderOrder");function n5e(t,e,r){let{visible:i,color:n}=r;if(t.type!=="path")return;let a=t.components[0];i!=null&&Cp(t,e,i),n!=null&&hj(t,{color:n}),Object.assign(a,fj(r)),gge(r)||(a.materialDirty=!0,(r.nearRadius!=null||r.farRadius!=null)&&(a.dirty=!0),(r.nearZoomLevel!=null||r.farZoomLevel!=null)&&(a.dirty=!0))}s(n5e,"handlePathUpdate");function fj(t){return Zc(t,qQe)}s(fj,"pickPathOptions");var qQe=["animateArrowsOnPath","displayArrowsOnPath","nearRadius","farRadius","accentColor","completeFraction","nearZoomLevel","farZoomLevel","dashed","visibleThroughGeometry"];function a5e(t){if(!(t instanceof za&&t.type==="text3d"))throw new Error("expect target is TextGeometry3D")}s(a5e,"assetGeometryIsText3D");var o5e=["visible","color","strokeWidth","outlineOffsetX","outlineOffsetY","outlineWidth","outlineBlur","outlineOpacity","outlineColor","strokeWidth","strokeColor","strokeOpacity","maxWidth","maxHeight","font","hoverColor","fillOpacity","fontSize","flipToFaceCamera"];function s5e(t,e,r){Cp(t,e,r.visible);let i=t.components[1],n=Zc(r,o5e);"margin"in r&&Vt.warn("update to margin is not supported atm"),"content"in r&&Vt.warn("content update is not supported atm");try{zQe.parse(n)}catch(a){Vt.error(a);return}Object.keys(n).length>0&&(Object.assign(i,n),i.dirty=!0)}s(s5e,"handleText3DUpdate");var WQe=["color","material","opacity","verticalOffset","rotation","position","scale"];function l5e(t,e){let r=Zc(e,WQe),i=t.components[1],n=t.components[0];Object.keys(r).length>0&&(r.material&&(i.material=r.material),r.opacity!=null&&(i.opacity=r.opacity,r.opacity===0?i.visible=!1:i.visible=!0,i.dirty=!0),r.verticalOffset!=null&&(i.verticalOffset=r.verticalOffset),r.color!=null&&(i.color=r.color),r.position!=null&&(n.feature.geometry.coordinates=r.position,n.positionDirty=!0),r.rotation!=null&&(i.rotation=r.rotation),r.scale!=null&&(i.scale=r.scale),i.dirty=!0)}s(l5e,"handleModelStyleUpdate");var $1,ef,rN,R2,u5e,uI,iN,c5e,h5e,cI,nN,hI,j3,aN,p5e=class{constructor(e){Be(this,R2),Be(this,$1,null),Be(this,ef),$(this,"getCurrentSceneGLTF",s(async r=>{let i=Ee({onlyVisible:!0,binary:!0,light:!0,scale:1},r),n=await dr(this,R2,u5e).call(this),a=w(this,rN).call(this,i),o=await n.parseAsync(a,{trs:!1,maxTextureSize:1/0,onlyVisible:i.onlyVisible,binary:i.binary,scale:i.scale}),l;if(o instanceof ArrayBuffer)l=new Blob([o],{type:"application/octet-stream"});else{let u=JSON.stringify(o,null,2);l=new Blob([u],{type:"text/plain"})}return l},"getCurrentSceneGLTF")),Be(this,rN,s(r=>{let{scale:i,light:n,onlyVisible:a}=r,o=new xB,l=new to().setFromObject(w(this,ef).entityScene);if(w(this,uI).call(this,w(this,ef).entityScene,o,a),n){let u=new xde(16777215,.3*Math.PI);u.position.set(0,Math.max(l.max.x,l.max.y)*i*.5,l.max.y*i*4),u.lookAt(0,0,-1),u.target.position.set(0,0,-1),u.add(u.target),o.add(u)}return o},"#getExportedScene")),Be(this,uI,s((r,i,n)=>{r.material&&(r instanceof bB?dr(this,R2,c5e).call(this,r).forEach(a=>i.add(a)):r instanceof kP&&i.add(dr(this,R2,h5e).call(this,r))),r.children.forEach(a=>{(!n||a.visible)&&w(this,uI).call(this,a,i,n)})},"#processObject3D")),Be(this,iN,s((r,i,n)=>{let a=new kpe({color:new oi(r),metalness:0});return a.opacity=i,a.transparent=n,a},"#createStandardMaterial")),Be(this,cI,s(r=>{let{geometry:i,material:n,position:a,rotation:o,quaternion:l,scale:u}=r;if(!(i!=null&&i.isBufferGeometry))return r;let c=i.attributes.position,p=i.attributes.normal,m=i.attributes.uv;return w(this,nN).call(this,c,p),w(this,j3).call(this,a,u,o,l),m&&w(this,aN).call(this,m),n!=null&&n.map&&i.type==="PlaneGeometry"&&(r.side=Pu),r},"#convertGeometry")),Be(this,nN,s((r,i)=>{let n=new qe,a=new qe;for(let o=0;o<r.count;o++)n.fromBufferAttribute(r,o),w(this,hI).call(this,n),r.setXYZ(o,n.x,n.y,n.z),i&&(a.fromBufferAttribute(i,o),w(this,hI).call(this,a),i.setXYZ(o,a.x,a.y,a.z))},"#convertAttributes")),Be(this,hI,s(r=>{let i=r.y;r.y=r.z,r.z=-i},"#convertVector")),Be(this,j3,s((r,i,n,a)=>{let o=r.y;r.y=r.z,r.z=-o;let l=i.y;if(i.y=i.z,i.z=l,n instanceof Nu)n.order="YXZ",n.set(n.x,n.y,n.z,n.order);else{let u=a.y;a.set(a.x,a.z,-u,a.w)}},"#convertObjectProperties")),Be(this,aN,s(r=>{for(let i=0;i<r.count;i++){let n=r.getX(i),a=r.getY(i);r.setXY(i,n,a)}},"#convertUVs")),He(this,ef,e),w(this,ef).entityScene=e.entityScene,w(this,ef).geometry3DMap=e.geometry3DMap}destroy(){He(this,$1,null)}};$1=new WeakMap,ef=new WeakMap,rN=new WeakMap,R2=new WeakSet,u5e=s(async function(){if(!w(this,$1)){let{GLTFExporter:t}=await ag(()=>import("./GLTFExporter-U7TU265Z-DuNTqrX7.js"),[]);He(this,$1,new t)}return w(this,$1)},"#getGLTFExporter"),uI=new WeakMap,iN=new WeakMap,c5e=s(function(t){var e,r;let i=[],n=((e=t.userData)!=null&&e.entities?Object.values((r=t.userData)==null?void 0:r.entities):[]).map(o=>w(this,ef).geometry3DMap.get(o)),a=new Map;return n.forEach(o=>{var l;if(!o||!(o instanceof za))return;let u=o.components[1],c=o.components[2];if(!u.visible||u instanceof u_&&u.opacity===0||u instanceof VO||u instanceof Cge)return;let p=c!=null&&c.hover?u.hoverColor||w(this,ef).hoverColor:u.color,m="".concat(p,"-").concat(u.opacity,"-").concat(Number(u.visible));a.has(m)||a.set(m,[]),(l=a.get(m))==null||l.push(o)}),a.forEach((o,l)=>{let[u,c,p]=l.split("-"),m=o.reduce((E,M)=>{if(M.type==="custom-geometry")return E;let I=M.components[0];return"geometry"in I&&I.geometry instanceof Vs&&E.push(I.geometry),E},[]),y=w(this,iN).call(this,u,Number(c),t.material.transparent),v=fv(m,!0),x=new Tn(v,y);x.position.copy(t.position),x.rotation.copy(t.rotation),x.scale.copy(t.scale),x.visible=!!p,w(this,j3).call(this,x.position,x.scale,x.rotation,x.quaternion),i.push(w(this,cI).call(this,x))}),i},"#processBatchedMesh"),h5e=s(function(t){let e=t.geometry.clone(),r=t.material,i=new ug({color:r.color,side:Pu});i.opacity=r.opacity,i.transparent=r.transparent;let n=new kP(e,i);return n.position.copy(t.position),n.rotation.copy(t.rotation),n.scale.copy(t.scale),n.visible=t.visible,w(this,cI).call(this,n)},"#processLineSegments"),cI=new WeakMap,nN=new WeakMap,hI=new WeakMap,j3=new WeakMap,aN=new WeakMap,s(p5e,"ExporterSystem");var XQe=p5e;N();N();N();var d5e=Rr(dWe());function mj(t){this.name="JSClipperError",this.message=t,this.stack=new Error().stack}s(mj,"JSClipperError");mj.prototype=Error.prototype;d5e.default.Error=function(t){throw new mj(t)};var Tl=d5e.default,ZQe="gray",YQe=.1,jb=100,FD=new Tl.ClipperOffset;function f5e(t,e){FD.Clear(),e/=2;let r=t.map(n=>({X:n.x*jb,Y:n.y*jb}));FD.AddPath(r,Tl.JoinType.jtMiter,Tl.EndType.etClosedPolygon);let i=new Tl.Paths;return FD.Execute(i,e*jb),i.length?i.map(n=>n.map(a=>({x:a.X/jb,y:a.Y/jb}))):[t]}s(f5e,"offset");function gj(t,e,r){var i,n,a,o,l;let{color:u=ZQe,opacity:c=1,altitude:p=0,height:m=YQe}=r||{};Array.isArray(c)&&(c=1);let y={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},v=t.geometry.coordinates[0].map(M=>{let I=e(M[1],M[0]);return y.min.x=Math.min(y.min.x,I.x),y.min.y=Math.min(y.min.y,I.y),y.max.x=Math.max(y.max.x,I.x),y.max.y=Math.max(y.max.y,I.y),I});((n=(i=t.properties)==null?void 0:i.style)==null?void 0:n.edgeOffset)!=null&&t.properties.style.edgeOffset!==0||((a=t.properties)==null?void 0:a.image)!=null?v=f5e(v,((l=(o=t.properties)==null?void 0:o.style)==null?void 0:l.edgeOffset)||0):v=[v];let x=[];for(let M of v){let I=new ox;I.moveTo(M[0].x,M[0].y),M.slice(1).forEach(D=>I.lineTo(D.x,D.y)),I.lineTo(M[0].x,M[0].y);let P=t.geometry.coordinates.slice(1);I.holes=P.map(D=>{let F=D.map(B=>e(B[1],B[0])),k=new T_;return k.moveTo(F[0].x,F[0].y),F.slice(1).forEach(B=>k.lineTo(B.x,B.y)),k.lineTo(F[0].x,F[0].y),k});let C={bevelEnabled:!1,depth:m},T=new kA(I,C);T.userData={style:{color:u,opacity:c}},x.push(T)}if(x.length===1)return x[0];let E=fv(x);return E.userData={style:{color:u,opacity:c},_split:!0},E}s(gj,"renderPolygonGeometry");N();var KQe="gray",JQe=.1;function yj(t,e,r){let{color:i=KQe,opacity:n=1,altitude:a=0,height:o=JQe}=r||{};Array.isArray(n)&&(n=1);let l={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},u={bevelEnabled:!1,depth:o},c=[];t.geometry.coordinates.forEach(m=>{let y=new ox,v=m[0].map(M=>{let I=e(M[1],M[0]);return l.min.x=Math.min(l.min.x,I.x),l.min.y=Math.min(l.min.y,I.y),l.max.x=Math.max(l.max.x,I.x),l.max.y=Math.max(l.max.y,I.y),I});y.moveTo(v[0].x,v[0].y),v.slice(1).forEach(M=>y.lineTo(M.x,M.y)),y.lineTo(v[0].x,v[0].y);let x=m.slice(1);y.holes=x.map(M=>{let I=M.map(C=>e(C[1],C[0])),P=new T_;return P.moveTo(I[0].x,I[0].y),I.slice(1).forEach(C=>P.lineTo(C.x,C.y)),P.lineTo(I[0].x,I[0].y),P});let E=new kA(y,u);c.push(E)});let p=fv(c);return p.translate(0,0,a||0),p.userData={style:{color:i,opacity:n}},p}s(yj,"renderMultiPolygonGeometry");N();var QQe="gray",BD=new Tl.ClipperOffset,Hl=100;function m5e(t,e,r){let{color:i=QQe,opacity:n=1,width:a=1,join:o="round",cap:l="round",height:u=.01,altitude:c=0}=r||{};Array.isArray(n)&&(n=0);let p=[];for(let E=0;E<t.geometry.coordinates.length-1;E++){let M=e(t.geometry.coordinates[E][1],t.geometry.coordinates[E][0]),I=e(t.geometry.coordinates[E+1][1],t.geometry.coordinates[E+1][0]);p.push([M,I])}BD.AddPaths(p.map(E=>E.map(M=>({X:M.x*Hl,Y:M.y*Hl}))),o==="round"?Tl.JoinType.jsRound:o==="miter"?Tl.JoinType.jsMiter:Tl.JoinType.jsSquare,l==="round"?Tl.EndType.etOpenRound:l==="butt"?Tl.EndType.etOpenButt:Tl.EndType.etOpenSquare);let m=new Tl.PolyTree;BD.Execute(m,a/2*Hl);let y=[],v={bevelEnabled:!1,depth:u};for(let E of m.m_AllPolys){let M=new ox;if(E.IsHole())continue;let I=E.m_polygon;M.moveTo(I[0].X/Hl,I[0].Y/Hl),I.slice(1).forEach(P=>M.lineTo(P.X/Hl,P.Y/Hl)),M.lineTo(I[0].X/Hl,I[0].Y/Hl),M.holes=E.m_Childs.map(P=>{let C=new T_,T=P.m_polygon;return C.moveTo(T[0].X/Hl,T[0].Y/Hl),T.slice(1).forEach(D=>C.lineTo(D.X/Hl,D.Y/Hl)),C.lineTo(T[0].X/Hl,T[0].Y/Hl),C}),y.push(new kA(M,v))}let x=fv(y);return x.translate(0,0,c||0),x.userData={style:{color:i,opacity:n}},BD.Clear(),x}s(m5e,"renderLineStringGeometry");N();var ql=100,eet=.22,tet=.01;function g5e(t,e,r={}){let{width:i=eet,height:n=tet,color:a="gray",opacity:o=1,altitude:l=0}=r,u={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},c={bevelEnabled:!1,depth:n},p=new Tl.ClipperOffset,m=t.geometry.coordinates.map(E=>E.map(M=>e(M[1],M[0])));p.AddPaths(m.map(E=>E.map(M=>({X:M.x*ql,Y:M.y*ql}))),Tl.JoinType.jsMiter,Tl.EndType.etOpenRound);let y=new Tl.PolyTree;p.Execute(y,i/2*ql);let v=[];for(let E of y.m_AllPolys){let M=new ox;if(E.IsHole())continue;u.min.x=Math.min(u.min.x,E.m_polygon[0].X),u.min.y=Math.min(u.min.y,E.m_polygon[0].Y),u.max.x=Math.max(u.max.x,E.m_polygon[0].X),u.max.y=Math.max(u.max.y,E.m_polygon[0].Y);let I=E.m_polygon;M.moveTo(I[0].X/ql,I[0].Y/ql),I.slice(1).forEach(P=>M.lineTo(P.X/ql,P.Y/ql)),M.lineTo(I[0].X/ql,I[0].Y/ql),M.holes=E.m_Childs.map(P=>{let C=new T_,T=P.m_polygon;return C.moveTo(T[0].X/ql,T[0].Y/ql),T.slice(1).forEach(D=>C.lineTo(D.X/ql,D.Y/ql)),C.lineTo(T[0].X/ql,T[0].Y/ql),C}),v.push(new kA(M,c))}let x=fv(v);return x.translate(0,0,l||0),x.userData={style:{color:a,opacity:o}},p.Clear(),x}s(g5e,"renderMultiLineStringGeometry");N();N();var vj=xt.object({type:xt.enum(["Point"]),coordinates:xt.array(xt.number()).min(2).max(3)}),ret=xt.object({rotation:xt.array(xt.number()).length(3).optional(),altitude:xt.number().optional(),scale:xt.array(xt.number()).length(3).optional(),interactive:xt.boolean().optional(),verticalOffset:xt.number().optional(),id:xt.union([xt.number(),xt.string()]).optional()}),iet=xt.object({type:xt.enum(["Feature"]),geometry:vj,properties:ret}),net=xt.object({type:xt.enum(["FeatureCollection"]),features:xt.array(iet)}),aet=xt.object({color:xt.string()}),oet=xt.object({url:xt.string(),color:xt.string().optional(),opacity:xt.number().optional(),material:xt.record(xt.string(),aet).optional()});function y5e(t,e,r){xt.union([xt.number(),xt.string()]).parse(t),net.parse(e),oet.parse(r)}s(y5e,"validateModelGroup");var pI,dI,v5e=class{constructor(e){$(this,"mesh"),$(this,"type","model"),$(this,"positionDirty",!0),$(this,"outline"),$(this,"geometry"),$(this,"material"),$(this,"feature"),$(this,"instanceIndex",-1),$(this,"visible",!0),$(this,"color",new oi),$(this,"position",new qe),Be(this,pI,0),Be(this,dI,1),this.feature=e}setOpacity(){}setColor(){}get altitude(){return w(this,pI)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,pI,e))}getRotation(){return this.mesh?[this.mesh.rotation.x,this.mesh.rotation.y,this.mesh.rotation.z]:void 0}setRotation(e){this.mesh&&this.mesh.rotation.set($n.degToRad(e[0]),$n.degToRad(e[1]),$n.degToRad(e[2]))}getScale(){return this.mesh?[this.mesh.scale.x,this.mesh.scale.y,this.mesh.scale.z]:void 0}setScale(e){this.mesh&&this.mesh.scale.set(e[0],e[1],e[2])}get opacity(){return w(this,dI)}set opacity(e){var r,i,n;if(this.mesh){if(this.mesh.children[0]instanceof VT){for(let a of this.mesh.children)if(a instanceof VT){((r=a.userData)==null?void 0:r.originalOpacity)===void 0&&(a.userData.originalOpacity=a.material.opacity);let o=Yy(e,0,(i=a.userData)==null?void 0:i.originalOpacity,0,1);a.material.opacity=o,a.material.transparent=o<1,a.material.needsUpdate=!0}}else(n=this.mesh)==null||n.traverse(a=>{a instanceof Tn&&a.material&&(Array.isArray(a.material)?a.material.forEach(o=>{oN(o,e)}):oN(a.material,e))});He(this,dI,e)}}};pI=new WeakMap,dI=new WeakMap,s(v5e,"ModelComponent");var fI=v5e;function oN(t,e){t.opacity!==e&&(e===1?(t.opacity=1,t.transparent=!1):(t.opacity=e,t.transparent=!0),t.needsUpdate=!0)}s(oN,"updateMaterialOpacity");N();function _j(t){var e,r;let i=t.components[0],n=t.components[1];n.opacity!=null&&n.opacity!==i.opacity&&(i.opacity=n.opacity);let a=n.material,o=n.color;if(a||o){let c=_5e(o,a);(e=i.mesh)==null||e.traverse(p=>{p instanceof Tn&&p.material&&(Array.isArray(p.material)?p.material.forEach(m=>{c[m.name]?m.color.set(c[m.name].color):m.color.set(o)}):c[p.material.name]?p.material.color.set(c[p.material.name].color):p.material.color.set(o))})}let l=(r=i.feature.geometry.coordinates[2])!=null?r:0,u=n.verticalOffset+l;i.altitude!==u&&(i.altitude=u),n.visible!==i.visible&&(i.visible=n.visible),n.rotation&&i.setRotation(n.rotation),n.scale&&i.setScale(n.scale)}s(_j,"applyModelGeometryStyle");function _5e(t,e){let r={};if(t&&Object.assign(r,{Default:{color:t},Fabric:{color:t},Mpdn_Logo:{color:t},CouchLogo:{color:t}}),e)for(let i in e)e[i].color&&(r[i]?r[i].color=e[i].color:r[i]={color:e[i].color});return r}s(_5e,"consolidateColorAndMaterial");function x5e(t,e){var r,i;let n=t.components[0],a=(r=t.components[1].verticalOffset)!=null?r:0,o=n.feature.geometry.coordinates.slice();o[2]=((i=o[2])!=null?i:0)+a,n.mesh?n.mesh.position.copy(e(o)):n.position.copy(e(o))}s(x5e,"applyModelPosition");function b5e(t){let{color:e,opacity:r,topColor:i,texture:n,topTexture:a}=t;return"".concat(e).concat(r).concat(i||"").concat(n||"").concat(a||"")}s(b5e,"generateIndex");var set=1e4,w5e=class extends qa{constructor(e,r){super(),$(this,"state"),$(this,"convertTo3DMapPosition"),$(this,"loader"),$(this,"optimizePromise",[]),this.state=e,this.convertTo3DMapPosition=r}async getGLTFLoader(){if(this.loader)return this.loader;let{GLTFLoader:e}=await ag(()=>import("./GLTFLoader-6MJPEGD7-ZXN_JtdG.js"),[]);return this.loader=new e,this.loader}createEntityFromFeature(e,r,i){var n,a;let o=new tu(r),l=new za(o,new u_(vt(Ee({},i),{url:(a=(n=r.properties)==null?void 0:n.image)==null?void 0:a.path})));return i!=null&&i.outline&&(l.components[3]=new z4e(cj(i.color))),l.id=e,l}createModelFromFeature(e,r,i){let n=new fI(r),a=Ee({},i);r.properties.verticalOffset!=null&&(a.verticalOffset=r.properties.verticalOffset),r.properties.rotation!=null&&(a.rotation=r.properties.rotation),r.properties.scale!=null&&(a.scale=r.properties.scale);let o=new Cge(a),l=new za(n,o);return l.id=e,l}populateEntityMesh(e,r){let i=e.components[0];i.geometry=r,i.currentHeight=e.components[1].height,i.dirty=!1}async populateModelGroup(e,r,i){let n=new Ri,a=new Nu,o=new ff,l=new qe,u=new cx,c=await this.getGLTFLoader(),p=new Promise(m=>{c.load(r,y=>{"entities3D"in i.userData&&(i.userData.entities3D.size>1?y.scene.traverse(v=>{let x=v;if("isMesh"in x&&x.isMesh===!0){let E=new VT(x.geometry,x.material,e.size);E.userData={entities:{}},u.add(E),i.add(u)}}):(y.scene.traverse(v=>{"isMesh"in v&&v.isMesh===!0&&(v.position.set(0,0,0),v.rotation.set(0,0,0),v.scale.set(1,1,1),v.updateMatrix())}),u.add(y.scene),i.add(u),u.userData.isSingleModel=!0,u.userData.entityId=e.values().next().value,u.userData.type="model")),m()})});return this.optimizePromise.push(p.then(()=>{var m,y,v,x,E,M,I,P,C,T,D,F;let k=0,B;for(let U of e.values()){if(B=this.state.geometry3DMap.get(U),!B||(B==null?void 0:B.type)!=="model")continue;let z=B.components[0],q=B.components[1],Z=B.components[0].feature;z.mesh=u,z.instanceIndex=k,_j(B),B.components[1].dirty=!1;let{x:Q,y:V}=this.convertTo3DMapPosition(Z.geometry.coordinates[1],Z.geometry.coordinates[0],0);z.position.set(Q,V,z.altitude),a.set($n.degToRad((y=(m=q.rotation)==null?void 0:m[0])!=null?y:hC[0]),$n.degToRad((x=(v=q.rotation)==null?void 0:v[1])!=null?x:hC[1]),$n.degToRad((M=(E=q.rotation)==null?void 0:E[2])!=null?M:hC[2])),l.set((P=(I=q.scale)==null?void 0:I[0])!=null?P:cC[0],(T=(C=q.scale)==null?void 0:C[1])!=null?T:cC[1],(F=(D=q.scale)==null?void 0:D[2])!=null?F:cC[2]),o.setFromEuler(a),n.compose(z.position,o,l),u.children.forEach(ae=>{!B||(B==null?void 0:B.type)!=="model"||!(ae instanceof VT)||(ae.setMatrixAt(k,n),ae.userData.entities[k]=B.id)}),z.mesh.userData.isSingleModel&&(z.mesh.matrix.copy(n),z.mesh.matrix.decompose(z.mesh.position,z.mesh.quaternion,z.mesh.scale)),k++}this.publish("model-loaded")})),u}populateEntityGroup(e){var r;let i,n,a,o;for(let l of e.values())o=this.state.geometry3DMap.get(l),o.components[0]instanceof tu&&(n=o.components[0].feature,a=o.components[1],n.geometry.type==="Polygon"?(i=gj(n,this.convertTo3DMapPosition,a),(r=n.properties)!=null&&r.textures&&n.properties.textures.length>0&&$4e(i,n.properties.textures,this.state.naturalBearing,this.convertTo3DMapPosition),this.populateEntityMesh(o,i)):n.geometry.type==="MultiPolygon"?(i=yj(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,i)):n.geometry.type==="LineString"?(i=m5e(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,i)):n.geometry.type==="MultiLineString"&&(i=g5e(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,i)));return e}optimize(e){var r;if((e.visible||e.userData.preloadGeometry)&&(e instanceof Fu||e instanceof Yn)){for(let a of e.children)this.optimize(a);if(e instanceof Yn||e.userData.dirty===!1)return;let i={};if(!e.userData.modelURL&&e.userData.dirty)try{this.populateEntityGroup(e.userData.entities3D)}catch(a){Vt.warn(a)}else e.userData.modelURL&&e.userData.dirty&&(this.populateModelGroup(e.userData.entities3D,e.userData.modelURL,e),e.userData.dirty=!1);let n=0;if(e.userData.dirty){let a=0,o;for(let l of e.userData.entities3D.values()){o=this.state.geometry3DMap.get(l);let u=o==null?void 0:o.components[0];if((o==null?void 0:o.type)==="geometry"){let c=o.components[1];a++,a>=set&&(a=0,n++);let p=b5e(c)+n;i[p]===void 0&&(i[p]={style:c,entities:[]}),i[p].entities.push(o)}else u&&"mesh"in u&&u.mesh&&((r=u.mesh)==null?void 0:r.parent)!==e&&e.add(u.mesh)}for(let l in i){let u=j4e(i[l].entities,i[l].style);e.add(u),e.userData.dirty=!1}for(let l of e.userData.entities3D.values())if(o=this.state.geometry3DMap.get(l),o!=null&&o.entities2D.size>0)for(let u of o.entities2D.values())u&&(o.attach(u),this.publish("geometry-2d-added"))}}}update(){return this.optimizePromise=[],this.optimize(this.state.entityScene),this.optimizePromise.length>0?Promise.all(this.optimizePromise):void 0}};s(w5e,"MeshCreationAndOptimizationSystem");var uet=w5e;N();var A5e=class{constructor(e,r){$(this,"state"),$(this,"dirty",!0),$(this,"domTree"),this.state=e,this.domTree=r}update(){if(this.dirty){let e;for(let r of Array.from(this.domTree.children))if(e=this.state.geometry2DMap.get(r.userData.entityId),e){let i=e.components[0];(!i.enabled||!i.visible||!this.state.geometry2DIdsInScene.has(r.userData.entityId))&&this.domTree.removeChild(r)}else this.domTree.removeChild(r);for(let r of this.state.geometry2DIdsInScene)if(e=this.state.geometry2DMap.get(r),e){let i=e.components[0];i instanceof pw&&i.enabled&&i.markerContainer&&!this.domTree.contains(i.markerContainer)&&(i.markerContainer.userData={entityId:e.id},this.domTree.appendChild(i.markerContainer),i.updateDimensions())}this.dirty=!1}}};s(A5e,"DOMVisibilitySystem");var cet=A5e;N();var S5e=class{constructor(e,r){$(this,"state"),$(this,"project"),this.state=e,this.project=r}update(){let e,r=0,i,n;for(let a of this.state.geometry2DIdsInScene)if(e=this.state.geometry2DMap.get(a),e){n=e.components[0];let o=e.attachedTo?this.state.geometry3DMap.get(e.attachedTo):void 0;if(o instanceof za)if(this.state.geometry3DIdsInScene.has(o.id)){i=o.components[1],n=e.components[0],(i.dirty||e.components[0].attachedDirty)&&(r=i.height,e.setAltitude(r));let l=i.visible&&i.opacity>0;n.visible!==l&&(n.visible=l)}else n.visible===!0&&(n.visible=!1);this.project(e.components[0].projection,e.position),e.components[0].attachedDirty=!1}}};s(S5e,"TwoDProjectionSystem");var het=S5e;N();N();var pet=s(function(){let t,e;return r=>{if((!e||!e)&&(t=document.createElement("canvas"),t.width=500*r,t.height=500*r,t.style.width="500px",t.style.height="500px",e=t.getContext("2d")),!e)throw new Error("Could not get 2D context");return{measureCanvas:t,measureCanvasContext:e}}},"createMeasureCanvasContext")(),det=s(({text:t,size:e,maxWidth:r,pixelRatio:i,maxLines:n=2,lineHeight:a=1.2,options:o={strokeText:!0}})=>{let l="bold ".concat(e*i,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),{measureCanvasContext:u}=pet(i);u.font=l;let c=[],p=t.split(" "),m=0,y=0,v=0;for(;y<p.length;){let M=p[y];if(m===n&&m>0){c[m-1]+="...";break}if(c[m]==null&&(c[m]=M,y++),p.length===1){c[m]=M;break}if(p[y]==null)break;let{width:I}=u.measureText(c[m]+" "+p[y]);I<=r*i?(c[m]+=" "+p[y],y++):m++}c.forEach(M=>{let{width:I}=u.measureText(M);v=Math.max(I,v)});let x=e*i*a,E=c.length*x;return{maxWidth:v,maxHeight:E,lines:c.length,draw:s((M,I,P)=>{c.length===1?(o.strokeText&&M.strokeText(c[0],I,P),M.fillText(c[0],I,P)):(o.strokeText&&(M.strokeText(c[0],I,P-x/2),M.strokeText(c[1],I,P+x/2)),M.fillText(c[0],I,P-x/2),M.fillText(c[1],I,P+x/2))},"draw")}},"shaveText");N();function M5e(t){let e=new Image;return t&&(/<svg[\s\S]*>/i.test(t)?e.src="data:image/svg+xml;base64,".concat(btoa(t)):e.src=t),e}s(M5e,"createImage");var fet=3.5,met=2.5,get=2,yet=5,$b=2.5,E5e=class extends qa{constructor(e,r,i){super(),$(this,"dirty",!1),$(this,"state"),$(this,"colliderContext"),$(this,"colliderCanvas"),$(this,"transformRequestFunc"),$(this,"transformRequest",s(async n=>this.transformRequestFunc?await this.transformRequestFunc(n):{url:n},"transformRequest")),$(this,"pinCache",{}),$(this,"imageCache",{}),$(this,"imagePromiseCache",{}),$(this,"imageDimensionsCache",{}),$(this,"textCache",{}),$(this,"update",s(n=>{let a=this.state.pixelRatio;this.colliderContext.clearRect(0,0,this.colliderCanvas.width,this.colliderCanvas.height);let o,l,u,c,p,m,y;for(let v of this.state.geometry2DIdsInScene)if(y=this.state.geometry2DMap.get(v),y!=null&&(m=y.components[0],m instanceof p_&&!y.disposed)){if(p=m.appearance.marker.iconVisibleAtZoomLevel,m.appearance.marker.icon!=null&&p&&n>=p!==m.iconVisible&&(m.iconVisible=n>=p,m.dirty=!0),(m.dirty||this.dirty)&&m.calculateMarkerSize(),l=m.appearance.marker.foregroundColor,u=m.appearance.marker.backgroundColor,c=zA(m.markerSize,2),o="".concat(l.active,"-").concat(l.inactive,"-").concat(u.active,"-").concat(u.inactive,"-").concat(c,"-").concat(m.iconVisible),m.labelCacheId=o,(!this.pinCache[o]||this.dirty)&&(this.prepare(m,o,this.colliderContext),m.dirty=!0),(m.appearance.marker.icon&&(!m.imageHash||m.markerDirty)||this.dirty)&&this.cacheImage(m),this.textCache[m.id]==null||m.textDirty||this.dirty){m.dirty=!0,this.textCache[m.id]={};let{textDrawFn:E,width:M,height:I}=this.processText(m.text,m.appearance.text.size,m.appearance.text.maxWidth,m.appearance.text.numLines,m.appearance.text.lineHeight);["left","center","right"].forEach(P=>{this.textCache[m.id][P]=this.textToCanvas(E,m.appearance.text.size,P,M,I,m.appearance.text.foregroundColor,m.appearance.text.backgroundColor)}),m.dimensions={width:Math.ceil(M/a),height:Math.ceil(I/a)}}let x=1;if(m.appearance.marker.iconSizeInterpolation&&m.appearance.marker.iconSize){let{minZoomLevel:E,maxZoomLevel:M,minScale:I,maxScale:P}=m.appearance.marker.iconSizeInterpolation;x=Yy(n,E,M,I,P)}m.recomputeCurrentStrategy(m.iconVisible?x:1),m.canShow&&m.visible&&(m.enabled||m.visibilityNeedsUpdate!==!1)&&this.draw(m,o,this.colliderContext),m.textDirty=!1,m.markerDirty=!1}this.dirty=!1},"update")),$(this,"processText",s((n,a,o,l,u)=>{let c=this.state.pixelRatio,{draw:p,maxWidth:m,maxHeight:y}=det({text:n,size:a,pixelRatio:c,maxWidth:o,maxLines:l,lineHeight:u});return{textDrawFn:p,width:m+$b*c*2,height:y+$b*c*2}},"processText")),$(this,"textToCanvas",s((n,a,o,l,u,c,p)=>{let m=this.state.pixelRatio,y,v=l,x=u;window.OffscreenCanvas!=null&&!wHe()?y=new OffscreenCanvas(v,x):(y=document.createElement("canvas"),y.width=v,y.height=x,y.style.width=v+"px",y.style.height=x+"px");let E=y.getContext("2d",{willReadFrequently:!0});if(!E)return;E.textAlign=o,E.font="bold ".concat(a*m,"px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif"),E.textBaseline="middle",E.lineJoin="miter",E.miterLimit=2,E.strokeStyle="white",E.lineWidth=$b*m,E.fillStyle=c,E.strokeStyle=p;let M=o==="left"?0:o==="center"?v/2:v-$b*m/2;return n(E,M,(x+$b*m/2)/2),y},"textToCanvas")),$(this,"cacheImage",s(n=>{if(!n.appearance.marker.icon)return;let a=bge(n.appearance.marker.icon);this.imagePromiseCache[a]||(this.imagePromiseCache[a]=new Promise(o=>{this.transformRequest(n.appearance.marker.icon).then(l=>{let u=M5e(l.url);u.onload=()=>{this.imageCache[a]=u,this.publish("img:loaded"),o(u)}})})),n.imageHash!==a&&(n.imageHash=a,this.imagePromiseCache[a].then(()=>{n.dirty=!0}))},"cacheImage")),$(this,"createPinCanvas",s((n,a,o,l,u=1)=>{let c,p=this.state.pixelRatio,m=n.totalMarkerSize*2*p*u;window.OffscreenCanvas!=null?c=new OffscreenCanvas(m,m):(c=document.createElement("canvas"),c.width=m,c.height=m,c.style.width=m/p+"px",c.style.height=m/p+"px");let y=c.getContext("2d");return y.shadowColor="rgba(0,0,0,0.3)",y.shadowOffsetY=get*p,y.shadowBlur=yet*p,y.beginPath(),y.arc(m/2,m/2,(a/2+met*p/2)*u,0,2*Math.PI),y.fillStyle=o,y.fill(),y.beginPath(),y.arc(m/2,m/2,a/2*u,0,2*Math.PI),y.shadowColor="transparent",y.fillStyle=l,y.fill(),c},"createPinCanvas")),$(this,"prepare",s((n,a,o)=>{var l,u;let c=this.state.pixelRatio;o.lineWidth=4*c;let p=this.createPinCanvas(n,n.markerSize,n.appearance.marker.backgroundColor.active,n.appearance.marker.foregroundColor.active,(l=n.appearance.marker.iconSizeInterpolation)==null?void 0:l.maxScale),m=this.createPinCanvas(n,n.iconVisible?n.markerSize:fet*c,n.appearance.marker.backgroundColor.inactive,n.appearance.marker.foregroundColor.inactive,(u=n.appearance.marker.iconSizeInterpolation)==null?void 0:u.maxScale);this.pinCache[a]=[p,m]},"prepare")),this.state=e,this.colliderCanvas=r,this.colliderContext=r.getContext("2d"),this.transformRequestFunc=i}draw(e,r,i){var n,a;if(!e.canShow||!e.visible)return;i.save(),i.globalAlpha=e.opacity;let o=this.state.pixelRatio,l=e.projection.x*o,u=e.projection.y*o,c=e.style.pinVisibility===1?this.pinCache[r][0]:this.pinCache[r][1];if(i.drawImage(c,l-e.totalMarkerSize*o,u-e.totalMarkerSize*o,e.totalMarkerSize*2*o,e.totalMarkerSize*2*o),e.appearance.marker.icon&&e.iconVisible&&e.imageHash&&e.appearance.marker.iconSize&&this.imageCache[e.imageHash]){let p=this.imageCache[e.imageHash],m=(e.totalMarkerSize-e.scaledIconPadding)*o,y=e.appearance.marker.iconFit,v=m,x=m,E="".concat(e.imageHash,"_").concat(y);if(this.imageDimensionsCache[E])v=this.imageDimensionsCache[E].width,x=this.imageDimensionsCache[E].height;else{let M=p.width*o,I=p.height*o;if(y==="contain"){let P=Math.sqrt(M**2+I**2),C=m/P;v=M*C,x=I*C}if(y==="cover"){let P=m/M,C=m/I,T=Math.max(P,C);v=M*T,x=I*T}}i.save(),i.beginPath(),i.arc(l,u,m/2,0,2*Math.PI),i.closePath(),((a=(n=e==null?void 0:e.appearance)==null?void 0:n.marker)==null?void 0:a.iconOverflow)!=="visible"&&i.clip(),i.drawImage(p,l-v/2,u-x/2,v,x),i.restore()}e.style.textLabelVisible&&e.style.textAlign!=null&&e.style.left!=null&&e.style.top!=null&&i.drawImage(this.textCache[e.id][e.style.textAlign],l+e.style.left*o,u+e.style.top*o),i.restore()}};s(E5e,"TwoDDrawSystem");var vet=E5e;N();N();var sN=class O2{constructor(){$(this,"loader"),this.loader=new IB}static getInstance(){return O2.instance||(O2.instance=new O2),O2.instance}getLoader(){return this.loader}load(e){return new Promise((r,i)=>{this.loader.load(e,r,void 0,i)})}};s(sN,"TextureLoaderSingleton"),$(sN,"instance");var _et=sN,W4=_et.getInstance();function C5e(t,e){let r=t.components[2],i=t.components[1];return r!=null&&r.hover?[i.hoverColor||e,i.hoverColor||e]:[i.color,i.topColor||i.color]}s(C5e,"processColor");var r1,k2,I5e=class extends qa{constructor(e,r){super(),Be(this,r1),$(this,"state"),$(this,"convertTo3DMapPosition"),$(this,"textureLoadingCache",new Map),this.convertTo3DMapPosition=r,this.state=e}setShading(e,r){e.material&&e.material.setGradientShading(r.start,r.end,r.intensity)}processTextures(e,r,i){var n;if(r.texture!==e.texture&&r.texture!==""&&dr(this,r1,k2).call(this,r.texture,e,"texture"),r.topTexture!==e.topTexture&&r.topTexture!==""&&dr(this,r1,k2).call(this,r.topTexture,e,"topTexture"),(e.texture==null||e.topTexture==null)&&Array.isArray((n=e.feature.properties)==null?void 0:n.textures)&&e.feature.properties.textures.length>0)for(let a of e.feature.properties.textures)a.face==="top"&&e.topTexture!==a.path?dr(this,r1,k2).call(this,a.path,e,"topTexture"):a.face==="side"&&e.texture!==a.path&&dr(this,r1,k2).call(this,a.path,e,"texture"),e.blendTexture=!0;(e.texture!=null||e.topTexture!=null)&&(i!=null&&i.hover&&e.texturesVisible?e.hideTextures():e.texturesVisible||e.showTextures(),r.texture===""&&e.removeSideTexture(),r.topTexture===""&&e.removeTopTexture())}update(){var e,r,i,n,a,o,l,u;let c,p,m;for(let y of this.state.geometry3DIdsInScene)if(m=this.state.geometry3DMap.get(y),m instanceof Fu&&m.type==="geometry-group"){let v=m.components[0];if(m.userData.shadingDirty){let x=m.userData.entities3D.values().next().value;if(x==null)continue;let E=this.state.geometry3DMap.get(x);E instanceof za&&(E.type==="geometry"||E.type==="custom-geometry")&&(c=E.components[0],m.userData.shadingDirty&&v.shading&&this.setShading(c,v.shading));let M,I;for(let P of m.userData.entities3D.values())M=this.state.geometry3DMap.get(P),I=M.components[0],M.type==="geometry"&&I.detached&&m.userData.shadingDirty&&v.shading&&this.setShading(I,v.shading);m.userData.shadingDirty=!1}if(v.dirty){let x=m.getfirstChildEntityId();if(x){let M=this.state.geometry3DMap.get(x),I=M==null?void 0:M.components[0];I instanceof tu&&this.processTextures(I,v)}let E=v.opacity*Ow(m);m.getOpacity()!==E&&m.setOpacity(E),v.dirty=!1}}else if(m&&(m.type==="geometry"||m.type==="custom-geometry")&&((e=m.components[1])!=null&&e.dirty||(r=m.components[2])!=null&&r.dirty)){let v=m.components[0],x=m.components[1];p=m.components[2];let E=C5e(m,this.state.hoverColor);if(v.setColor(E[0],E[1]),x.visible!==v.visible&&(v.visible=x.visible,v instanceof tu&&v.textMesh)){let I=this.state.geometry3DMap.get(v.textMesh.userData.entityId);(I==null?void 0:I.type)==="text3d"&&I.components[0].polygonEntityId!=null&&(I.components[0].visible=x.visible)}x.altitude!==v.altitude&&(v.altitude=x.altitude);let M=x.opacity*Ow(m);M!==v.opacity&&(v.opacity=M),x.renderOrder!==v.renderOrder&&(v.renderOrder=x.renderOrder),x.dirty=!1,v instanceof tu&&this.processTextures(v,x,p),m.components[2]&&(m.components[2].dirty=!1)}else if((m==null?void 0:m.type)==="model")m.components[1].dirty&&(_j(m),m.components[1].dirty=!1),m.components[0].positionDirty&&(x5e(m,this.convertTo3DMapPosition),m.components[0].positionDirty=!1);else if((m==null?void 0:m.type)==="image"&&(i=m.components[1])!=null&&i.dirty){c=m.components[0];let v=m.components[1];v.visible!==c.visible&&(c.visible=v.visible),v.dirty=!1}else if((m==null?void 0:m.type)==="text3d"&&(n=m.components[1])!=null&&n.dirty&&m.components[0].polygonEntityId!=null){c=m.components[0];let v=m.components[1];v.visible!=null&&v.visible!==c.visible&&(c.visible=v.visible);let{textMesh:x}=c;if(x){Object.assign(x,v.getState());let E=(a=v.hoverColor)!=null?a:this.state.text3dHoverColor;x.color=v.hoverByPolygon?E:(o=v.color)!=null?o:cw.color,x.outlineColor=v.hoverByPolygon?E:(l=v.outlineColor)!=null?l:cw.outlineColor,x.strokeColor=v.hoverByPolygon?E:(u=v.strokeColor)!=null?u:cw.strokeColor}v.dirty=!1}}destroy(){this.textureLoadingCache.forEach(async e=>{(await e).dispose()}),this.textureLoadingCache.clear()}};r1=new WeakSet,k2=s(async function(t,e,r){if(!(!t||!e.showTextures))if(this.textureLoadingCache.has(t)){r==="topTexture"?e.topTexture=await this.textureLoadingCache.get(t):e.texture=await this.textureLoadingCache.get(t),e.showTextures();return}else{let i=new Promise((n,a)=>{W4.getLoader().load(t,o=>{r==="topTexture"?e.topTexture=o:e.texture=o,e.showTextures(),this.publish("texture-loaded"),n(o)},void 0,()=>{Vt.error("Failed to load texture: ".concat(t)),a("Failed to load texture: ".concat(t))})});this.textureLoadingCache.set(t,i)}},"#loadTexture"),s(I5e,"DrawSystem");var xet=I5e;N();var T5e=class extends qa{constructor(e){super(),$(this,"state"),$(this,"animating",new Map),$(this,"isAnimating",!1),$(this,"startTime",-1),$(this,"showDuration",300),$(this,"hideDuration",250),$(this,"update",s(()=>{this.animating.clear();let r,i;for(let n of this.state.geometry2DIdsInScene)r=this.state.geometry2DMap.get(n),r&&(i=r.components[0],i instanceof p_&&(i.visibilityNeedsUpdate==="show"?(i.canShow=!0,this.animating.set(i,[i.opacity,1])):i.visibilityNeedsUpdate==="hide"&&this.animating.set(i,[i.opacity,0])));this.startTime=performance.now(),this.publish("animate:2d")},"update")),$(this,"playAnimations"),this.state=e,this.playAnimations=this._playAnimations}_playAnimations(){let e=performance.now();for(let[r,[i,n]]of this.animating.entries()){let a=n===1?this.showDuration:this.hideDuration,o=(e-this.startTime)/a;r.opacity=Yy(o,0,1,i,n,n===0?wge:SHe),e-this.startTime>=a&&(n===1?r.canShow=!0:n===0&&(r.canShow=!1),r.visibilityNeedsUpdate=!1,this.animating.delete(r))}this.publish("draw:2d"),this.animating.size>0&&this.publish("animate:2d")}};s(T5e,"TwoDVisibilitySystem");var bet=T5e;N();var P5e=class extends qa{constructor(e,r,i,n,a,o,l){super(),$(this,"state"),$(this,"renderer"),$(this,"mode"),$(this,"scene"),$(this,"cameraObject"),$(this,"viewCamera"),$(this,"systems"),$(this,"needs2DRecompute",!1),$(this,"twoDdirty",!0),$(this,"threeDdirty",!0),$(this,"frameId",null),$(this,"twoDFrameId",null),$(this,"animationFrameId",null),$(this,"nextFrame",null),$(this,"update",s((u=!1)=>{var c;if(((c=this.renderer)==null?void 0:c.renderer)==null)return Promise.resolve();if(u){let p=this.commitRenderState();return this.paint(),p}else return this.frameId?Promise.resolve():new Promise(p=>{this.frameId=requestAnimationFrame(()=>{var m,y;return((m=this.renderer)==null?void 0:m.renderer)==null?p():this.mode==="standalone"?(y=this.commitRenderState())==null?void 0:y.then(()=>{this.paint(),p()}):p()})})},"update")),$(this,"animate2D",s(()=>{this.animationFrameId=requestAnimationFrame(()=>{this.animationFrameId=null,this.systems.twoDVisiblitySystem.playAnimations()})},"animate2D")),$(this,"drawEntities2D",s(()=>{this.twoDFrameId||(this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel())}))},"drawEntities2D")),$(this,"updateEntities2D",s(()=>{this.twoDFrameId&&(cancelAnimationFrame(this.twoDFrameId),this.twoDFrameId=null),this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.watermarkSystem.insertIntoQuadTree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.interactionSystem.updateQuadtree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.twoDVisiblitySystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting())})},"updateEntities2D")),$(this,"commitRenderState",s(()=>{try{let u=[];this.frameId=null,this.publish("pre-render"),this.state.tweenGroup.update(),(this.mode==="outdoors-interleaved"||this.mode==="standalone")&&this.systems.cameraSystem.update(),this.state.shouldMeasureCanvas&&(this.state.shouldMeasureCanvas=!1,this.publish("measure-canvas")),this.twoDdirty&&(this.state.geometry2DIdsInScene.clear(),vge(this.state.entityScene,this.state.geometry2DIdsInScene),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.systems.domMutationSystem.dirty=!0,this.systems.panBoundsSystem.dirty=!0,this.twoDdirty=!1),this.threeDdirty&&(this.state.geometry3DIdsInScene.clear(),yge(this.state.entityScene,this.state.geometry3DIdsInScene),this.threeDdirty=!1,this.systems.interactionSystem.dirty3D=!0,this.systems.panBoundsSystem.dirty=!0,this.systems.outlineInterpolationSystem.geometries3DDirty=!0,this.systems.geometryInFocusSystem.focusablesDirty=!0);let c=this.systems.meshOptimizationSystem.update();c&&u.push(c),this.systems.meshModificationSystem.update(),this.systems.meshDetachmentSystem.update(),this.systems.imageSystem.update(this.systems.cameraSystem.getRotation()),u.push(this.systems.text3DSystem.update(this.systems.cameraSystem.getRotation())),this.systems.customGeometrySystem.update(),this.systems.panBoundsSystem.update(),this.systems.geometryInFocusSystem.update(this.systems.cameraSystem.isCameraMoving(),this.systems.cameraSystem.lastCameraStoppedMovingTime()),this.systems.stackSystem.update(),this.systems.outlineInterpolationSystem.update(this.systems.cameraSystem.getZoomLevel(),this.systems.cameraSystem.zoomDirty),this.systems.pathSystem.update(this.systems.cameraSystem.minZoomAltitude,this.systems.cameraSystem.maxZoomAltitude,this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getRotation()),this.systems.cameraSystem.postRender(),this.systems.domVisiblitySystem.update(),this.systems.domMutationSystem.update(),this.systems.twoDProjectionSystem.update(),this.systems.occlusion2DSystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomLevel()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting()),this.systems.watermarkSystem.update();let p=this.needs2DRecompute;return this.nextFrame=requestAnimationFrame(()=>{this.systems.collisionSystem.update(this.systems.watermarkSystem.width,this.systems.watermarkSystem.height,this.systems.watermarkSystem.options.position,!p)}),this.systems.drawSystem.update(),this.systems.cameraSystem.dirty=!1,this.systems.cameraSystem.zoomDirty=!1,this.systems.cameraSystem.rotationDirty=!1,this.publish("post-render"),Promise.all(u)}catch(u){Vt.error("Render failed: ",u)}},"commitRenderState")),this.renderer=e,this.state=r,this.mode=i,this.scene=n,this.cameraObject=a,this.viewCamera=o,this.systems=l,this.systems.collisionSystem.on("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.on("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.on("animate:2d",this.animate2D),this.systems.cameraSystem.on("pan-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("zoom-end",()=>this.needs2DRecompute=!0),this.systems.cameraSystem.on("rotate-start",()=>this.needs2DRecompute=!1),this.systems.cameraSystem.on("rotate-end",()=>this.needs2DRecompute=!0)}paint(){var e;(e=this.renderer)!=null&&e.renderer&&(this.mode==="standalone"&&this.renderer.clear(),this.renderer.render(this.scene,this.state.useStandaloneCamera||this.mode==="standalone"?this.cameraObject:this.viewCamera))}destroy(){this.frameId&&cancelAnimationFrame(this.frameId),this.twoDFrameId&&cancelAnimationFrame(this.twoDFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.nextFrame&&cancelAnimationFrame(this.nextFrame),this.state.geometry2DIdsInScene.clear(),this.state.geometry3DIdsInScene.clear(),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.collidersDirty=!0,this.update(),this.systems.collisionSystem.off("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.off("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.off("animate:2d",this.animate2D)}};s(P5e,"RenderSystem");var wet=P5e;N();var Aet=xt.object({interactive:xt.boolean().optional(),id:xt.string().optional(),nearRadius:xt.number().optional(),farRadius:xt.number().optional(),accentColor:xt.string().optional(),displayArrowsOnPath:xt.boolean().optional(),animateArrowsOnPath:xt.boolean().optional(),nearZoomLevel:xt.number().optional(),farZoomLevel:xt.number().optional(),visibleThroughGeometry:xt.boolean().optional(),dashed:xt.boolean().optional()}),Met=xt.object({type:xt.enum(["Feature"]),geometry:vj,properties:xt.object({parentId:xt.any().optional()})});function L5e(t,e){xt.object({features:xt.array(Met)}).parse(t),Aet.parse(e)}s(L5e,"validatePath");var mI,D5e=class{constructor(e,r){$(this,"type","path"),$(this,"mesh",new cx),$(this,"material"),$(this,"geometry"),$(this,"outline"),$(this,"feature"),$(this,"options"),$(this,"nearRadius",.2),$(this,"farRadius",.4),$(this,"nearZoomLevel"),$(this,"farZoomLevel"),$(this,"nearZoomAltitude"),$(this,"farZoomAltitude"),$(this,"accentColor","blue"),$(this,"completeFraction",1),$(this,"altitudeAdjustment",1),$(this,"displayArrowsOnPath",!1),$(this,"animateArrowsOnPath",!1),$(this,"visibleThroughGeometry",!1),$(this,"dashed",!1),$(this,"isVertical",!1),$(this,"dirty",!0),$(this,"materialDirty",!0),$(this,"position",new qe),Be(this,mI,0);var i,n,a,o,l,u,c;this.feature=e,this.options=r||{},this.accentColor=(i=r==null?void 0:r.accentColor)!=null?i:this.accentColor,this.nearRadius=(n=r==null?void 0:r.nearRadius)!=null?n:this.nearRadius,this.farRadius=(a=r==null?void 0:r.farRadius)!=null?a:this.farRadius,this.nearZoomLevel=r==null?void 0:r.nearZoomLevel,this.farZoomLevel=r==null?void 0:r.farZoomLevel,this.displayArrowsOnPath=(o=r==null?void 0:r.displayArrowsOnPath)!=null?o:this.displayArrowsOnPath,this.animateArrowsOnPath=(l=r==null?void 0:r.animateArrowsOnPath)!=null?l:this.animateArrowsOnPath,this.visibleThroughGeometry=(u=r==null?void 0:r.visibleThroughGeometry)!=null?u:this.visibleThroughGeometry,this.dashed=(c=r==null?void 0:r.dashed)!=null?c:this.dashed}setColor(){}setOpacity(){}set visible(e){this.mesh&&(this.mesh.visible=e)}get visible(){return this.mesh?this.mesh.visible:!1}get altitude(){return w(this,mI)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,mI,e))}set complete(e){this.material&&(this.material.uniforms.complete.value=e,this.material.needsUpdate=!0)}};mI=new WeakMap,s(D5e,"PathComponent");var gI=D5e;N();var R5e=class{constructor(e){$(this,"rendererState"),this.rendererState=e}update(){let e;for(let r of this.rendererState.geometry3DIdsInScene)if(e=this.rendererState.geometry3DMap.get(r),e instanceof Yn&&e.components[0]){let i=e.components[0];if(i.dirty){for(let n of e.children)(n instanceof Fu||n instanceof Yn)&&(n.userData.entityId!==e.components[0].activeId?n.setVisible(!1):n.setVisible(!0));i.dirty=!1}}}};s(R5e,"StackSystem");var Eet=R5e;N();N();N();var Rl=Object.freeze({Linear:Object.freeze({None:s(function(t){return t},"None"),In:s(function(t){return t},"In"),Out:s(function(t){return t},"Out"),InOut:s(function(t){return t},"InOut")}),Quadratic:Object.freeze({In:s(function(t){return t*t},"In"),Out:s(function(t){return t*(2-t)},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},"InOut")}),Cubic:Object.freeze({In:s(function(t){return t*t*t},"In"),Out:s(function(t){return--t*t*t+1},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},"InOut")}),Quartic:Object.freeze({In:s(function(t){return t*t*t*t},"In"),Out:s(function(t){return 1- --t*t*t*t},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},"InOut")}),Quintic:Object.freeze({In:s(function(t){return t*t*t*t*t},"In"),Out:s(function(t){return--t*t*t*t*t+1},"Out"),InOut:s(function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},"InOut")}),Sinusoidal:Object.freeze({In:s(function(t){return 1-Math.sin((1-t)*Math.PI/2)},"In"),Out:s(function(t){return Math.sin(t*Math.PI/2)},"Out"),InOut:s(function(t){return .5*(1-Math.sin(Math.PI*(.5-t)))},"InOut")}),Exponential:Object.freeze({In:s(function(t){return t===0?0:Math.pow(1024,t-1)},"In"),Out:s(function(t){return t===1?1:1-Math.pow(2,-10*t)},"Out"),InOut:s(function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)},"InOut")}),Circular:Object.freeze({In:s(function(t){return 1-Math.sqrt(1-t*t)},"In"),Out:s(function(t){return Math.sqrt(1- --t*t)},"Out"),InOut:s(function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},"InOut")}),Elastic:Object.freeze({In:s(function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)},"In"),Out:s(function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1},"Out"),InOut:s(function(t){return t===0?0:t===1?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)},"InOut")}),Back:Object.freeze({In:s(function(t){var e=1.70158;return t===1?1:t*t*((e+1)*t-e)},"In"),Out:s(function(t){var e=1.70158;return t===0?0:--t*t*((e+1)*t+e)+1},"Out"),InOut:s(function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},"InOut")}),Bounce:Object.freeze({In:s(function(t){return 1-Rl.Bounce.Out(1-t)},"In"),Out:s(function(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375},"Out"),InOut:s(function(t){return t<.5?Rl.Bounce.In(t*2)*.5:Rl.Bounce.Out(t*2-1)*.5+.5},"InOut")}),generatePow:s(function(t){return t===void 0&&(t=4),t=t<Number.EPSILON?Number.EPSILON:t,t=t>1e4?1e4:t,{In:s(function(e){return Math.pow(e,t)},"In"),Out:s(function(e){return 1-Math.pow(1-e,t)},"Out"),InOut:s(function(e){return e<.5?Math.pow(e*2,t)/2:(1-Math.pow(2-e*2,t))/2+.5},"InOut")}},"generatePow")}),N2=s(function(){return performance.now()},"now"),O5e=function(){function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return s(t,"Group"),t.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(r){return e._tweens[r]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var n=0,a=r;n<a.length;n++){var o=a[n];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},t.prototype.remove=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=0,n=e;i<n.length;i++){var a=n[i];a._group=void 0,delete this._tweens[a.getId()],delete this._tweensAddedDuringUpdate[a.getId()]}},t.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},t.prototype.update=function(e,r){e===void 0&&(e=N2()),r===void 0&&(r=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var a=this._tweens[i[n]],o=!r;a&&a.update(e,o)===!1&&!r&&this.remove(a)}i=Object.keys(this._tweensAddedDuringUpdate)}},t}(),G1={Linear:s(function(t,e){var r=t.length-1,i=r*e,n=Math.floor(i),a=G1.Utils.Linear;return e<0?a(t[0],t[1],i):e>1?a(t[r],t[r-1],r-i):a(t[n],t[n+1>r?r:n+1],i-n)},"Linear"),Bezier:s(function(t,e){for(var r=0,i=t.length-1,n=Math.pow,a=G1.Utils.Bernstein,o=0;o<=i;o++)r+=n(1-e,i-o)*n(e,o)*t[o]*a(i,o);return r},"Bezier"),CatmullRom:s(function(t,e){var r=t.length-1,i=r*e,n=Math.floor(i),a=G1.Utils.CatmullRom;return t[0]===t[r]?(e<0&&(n=Math.floor(i=r*(1+e))),a(t[(n-1+r)%r],t[n],t[(n+1)%r],t[(n+2)%r],i-n)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[r]-(a(t[r],t[r],t[r-1],t[r-1],i-r)-t[r]):a(t[n?n-1:0],t[n],t[r<n+1?r:n+1],t[r<n+2?r:n+2],i-n)},"CatmullRom"),Utils:{Linear:s(function(t,e,r){return(e-t)*r+t},"Linear"),Bernstein:s(function(t,e){var r=G1.Utils.Factorial;return r(t)/r(e)/r(t-e)},"Bernstein"),Factorial:function(){var t=[1];return function(e){var r=1;if(t[e])return t[e];for(var i=e;i>1;i--)r*=i;return t[e]=r,r}}(),CatmullRom:s(function(t,e,r,i,n){var a=(r-t)*.5,o=(i-e)*.5,l=n*n,u=n*l;return(2*e-2*r+a+o)*u+(-3*e+3*r-2*a-o)*l+a*n+e},"CatmullRom")}},k5e=function(){function t(){}return s(t,"Sequence"),t.nextId=function(){return t._nextId++},t._nextId=0,t}(),lN=new O5e,pf=function(){function t(e,r){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Rl.Linear.None,this._interpolationFunction=G1.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=k5e.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof r=="object"?(this._group=r,r.add(this)):r===!0&&(this._group=lN,lN.add(this))}return s(t,"Tween"),t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.getDuration=function(){return this._duration},t.prototype.to=function(e,r){if(r===void 0&&(r=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=r<0?0:r,this},t.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},t.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},t.prototype.start=function(e,r){if(e===void 0&&(e=N2()),r===void 0&&(r=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||r){if(this._propertiesAreSetUp=!0,!this._isDynamic){var n={};for(var a in this._valuesEnd)n[a]=this._valuesEnd[a];this._valuesEnd=n}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,r)}return this},t.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},t.prototype._setupProperties=function(e,r,i,n,a){for(var o in i){var l=e[o],u=Array.isArray(l),c=u?"array":typeof l,p=!u&&Array.isArray(i[o]);if(!(c==="undefined"||c==="function")){if(p){var m=i[o];if(m.length===0)continue;for(var y=[l],v=0,x=m.length;v<x;v+=1){var E=this._handleRelativeValue(l,m[v]);if(isNaN(E)){p=!1,console.warn("Found invalid interpolation list. Skipping.");break}y.push(E)}p&&(i[o]=y)}if((c==="object"||u)&&l&&!p){r[o]=u?[]:{};var M=l;for(var I in M)r[o][I]=M[I];n[o]=u?[]:{};var m=i[o];if(!this._isDynamic){var P={};for(var I in m)P[I]=m[I];i[o]=m=P}this._setupProperties(M,r[o],m,n[o],a)}else(typeof r[o]>"u"||a)&&(r[o]=l),u||(r[o]*=1),p?n[o]=i[o].slice().reverse():n[o]=r[o]||0}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},t.prototype.pause=function(e){return e===void 0&&(e=N2()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},t.prototype.resume=function(e){return e===void 0&&(e=N2()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},t.prototype.stopChainedTweens=function(){for(var e=0,r=this._chainedTweens.length;e<r;e++)this._chainedTweens[e].stop();return this},t.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},t.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},t.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},t.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},t.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},t.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},t.prototype.easing=function(e){return e===void 0&&(e=Rl.Linear.None),this._easingFunction=e,this},t.prototype.interpolation=function(e){return e===void 0&&(e=G1.Linear),this._interpolationFunction=e,this},t.prototype.chain=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._chainedTweens=e,this},t.prototype.onStart=function(e){return this._onStartCallback=e,this},t.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},t.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},t.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},t.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},t.prototype.onStop=function(e){return this._onStopCallback=e,this},t.prototype.update=function(e,r){var i=this,n;if(e===void 0&&(e=N2()),r===void 0&&(r=t.autoStartOnUpdate),this._isPaused)return!0;var a;if(!this._goToEnd&&!this._isPlaying)if(r)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,l=this._duration+((n=this._repeatDelayTime)!==null&&n!==void 0?n:this._delayTime),u=this._duration+this._repeat*l,c=s(function(){if(i._duration===0||o>u)return 1;var E=Math.trunc(o/l),M=o-E*l,I=Math.min(M/i._duration,1);return I===0&&o===i._duration?1:I},"calculateElapsedPortion"),p=c(),m=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,m),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||o>=this._duration)if(this._repeat>0){var y=Math.min(Math.trunc((o-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=y);for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*y,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,x=this._chainedTweens.length;v<x;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(e,r,i,n){for(var a in i)if(r[a]!==void 0){var o=r[a]||0,l=i[a],u=Array.isArray(e[a]),c=Array.isArray(l),p=!u&&c;p?e[a]=this._interpolationFunction(l,n):typeof l=="object"&&l?this._updateProperties(e[a],o,l,n):(l=this._handleRelativeValue(o,l),typeof l=="number"&&(e[a]=o+(l-o)*n))}},t.prototype._handleRelativeValue=function(e,r){return typeof r!="string"?r:r.charAt(0)==="+"||r.charAt(0)==="-"?e+parseFloat(r):parseFloat(r)},t.prototype._swapEndStartRepeatValues=function(e){var r=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=r},t.autoStartOnUpdate=!1,t}();k5e.nextId;var rd=lN;rd.getAll.bind(rd);rd.removeAll.bind(rd);rd.add.bind(rd);rd.remove.bind(rd);rd.update.bind(rd);N();N();N();var Cet=s((t,e)=>(e-t+Math.PI)%(Math.PI*2)+Math.PI*2%(Math.PI*2)-Math.PI,"differenceBetweenAngles"),Iet=s((t,e)=>new Jt(t.clientX-e.offsetLeft,t.clientY-e.offsetTop),"getTouchPos"),fX=s((t,e)=>Math.atan2(e.y-t.y,e.x-t.x),"angle"),_E=s((t,e)=>Math.sqrt((e.y-t.y)**2+(e.x-t.x)**2),"distance"),mX=s((t,e)=>new Jt((t.x+e.x)/2,(t.y+e.y)/2),"average"),gX=s(t=>{let e=0,{wheelDelta:r,detail:i}=t;return r!==void 0?e=r:i!==void 0&&(e=-i),e},"getScrollDelta"),N5e=class{constructor(e,r){$(this,"input1"),$(this,"input2"),$(this,"lastAngle"),$(this,"lastDistance"),$(this,"totalDistance"),$(this,"first"),$(this,"second"),this.input1=e,this.input2=r,this.lastAngle=fX(e,r),this.lastDistance=_E(e,r),this.totalDistance=0,this.first=e,this.second=r}update(e,r){let i=_E(e,r);this.input1=e,this.input2=r;let n=fX(e,r);this.lastAngle=n,this.lastDistance=i,this.totalDistance+=(_E(this.first,e)+_E(this.second,r))/2,this.first=mX(this.first,e),this.second=mX(this.second,r)}};s(N5e,"InputSet");var Tet=N5e;N();var F5e=class{constructor(e,r,i){$(this,"touch"),$(this,"camera"),$(this,"cameraPlane"),$(this,"viewCoordinate"),$(this,"snapHolderMatrix"),$(this,"snapCamera"),$(this,"cameraPosition"),$(this,"raycaster"),$(this,"worldCoordinate"),$(this,"snapshotted",!1),this.touch=e,this.camera=r,this.cameraPlane=i,this.viewCoordinate={x:e.x,y:e.y},this.camera.updateMatrixWorld(),this.camera.updateMatrix(),this.snapHolderMatrix=this.camera.matrixWorld.clone(),this.snapCamera=this.camera.clone(),this.snapshotCameraState()}snapshotCameraState(){this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraPosition=this.camera.position.clone();let e=new Jt(this.viewCoordinate.x,this.viewCoordinate.y);this.raycaster=this.raycaster||new FA,this.raycaster.setFromCamera(e,this.snapCamera);let r=this.raycaster.intersectObject(this.cameraPlane,!0);this.worldCoordinate=r&&r.length>0?r[0].point:null,this.snapshotted=!0}updateAnchorState(e,r){this.camera=e,this.snapCamera=e.clone(),this.snapHolderMatrix=e.matrixWorld.clone(),this.updateViewCoordinate(r),this.snapshotCameraState()}updateViewCoordinate(e){this.viewCoordinate={x:e.x,y:e.y}}reUnproject(){var e,r;let i=new Jt(this.viewCoordinate.x,this.viewCoordinate.y);(e=this.raycaster)==null||e.setFromCamera(i,this.snapCamera);let n=(r=this.raycaster)==null?void 0:r.intersectObject(this.cameraPlane,!0)[0];return n?n.point:void 0}};s(F5e,"TouchAnchor");var yX=F5e,_y={};kl(_y,{BLOCK_MERCATOR_ZOOM_LEVEL:()=>Det,CLIPPING_RADIUS:()=>yI,CONTROL_OPTIONS:()=>Let,DEFAULT_ANIMATION_DURATION:()=>j5e,DEFAULT_BEARING:()=>Fet,DEFAULT_MAX_ZOOM_LEVEL:()=>ket,DEFAULT_MIN_ZOOM_LEVEL:()=>$5e,DEFAULT_PITCH:()=>Net,DEFAULT_ZOOM_LEVEL:()=>Oet,EVENTS:()=>hN,MAPLIBRE_TILE_SIZE:()=>Pet,MAX_LAT:()=>z5e,MAX_MERCATOR_ZOOM_LEVEL:()=>cN,MIN_LAT:()=>B5e,MIN_MERCATOR_ZOOM_LEVEL:()=>uN,ROOM_MERCATOR_ZOOM_LEVEL:()=>Ret,TWO_PI:()=>U5e,WHEEL_ZOOM_MULTIPLIER:()=>V5e,ZRANGE:()=>F2});N();var Pet=512,B5e=-85.051129,z5e=85.051129,yI=1e4,Let={chain:"chain",cancel:"cancel"},U5e=Math.PI*2,F2=100,V5e=1e4,uN=0,cN=24,Det=17,Ret=20,j5e=200,hN=["change","pan-start","pan-end","rotate-start","rotate-end","zoom-start","zoom-end","multi-start","multi-end","multi-cancel","pedestal-start","pedestal-change","pedestal-end","user-pan-start","user-pedestal-start","user-rotate-start","user-dolly-start","user-zoom-start","user-tilt-start","user-pan-end","user-pedestal-end","user-rotate-end","user-dolly-end","user-zoom-end","user-tilt-end","position-updated","zoom-updated","tilt-updated","rotation-updated"],Oet=18,$5e=12,ket=22,Net=0,Fet=0;N();function pN(t){t&&(t.map&&(t.map.dispose(),t.map=void 0),t.dispose())}s(pN,"scrubMaterial");function El(t){for(let e=t.children.length-1;e>=0;e--)El(t.children[e]);"geometry"in t&&t.geometry&&t.geometry.dispose(),t.parent&&t.parent.remove(t),"material"in t&&Array.isArray(t.material)?t.material.forEach(function(e){pN(e)}):"material"in t&&typeof t.material<"u"&&pN(t.material)}s(El,"destroyObject3D");var vX=!1,dN,fN=class extends qa{constructor(e,r,i,n,a){super(),$(this,"dirty",!1),$(this,"zoomDirty",!1),$(this,"rotationDirty",!1),$(this,"panDirty",!1),Be(this,dN,$5e),$(this,"zoomSpeed",5),$(this,"rotateSpeed",100),$(this,"enabled",!0),$(this,"enableZoom",!0),$(this,"enablePan",!0),$(this,"enablePedestal",!1),$(this,"maxPedestal",1/0),$(this,"minPedestal",0),$(this,"enableRotate",!0),$(this,"minZoomAltitude",0),$(this,"maxZoomAltitude",1/0),$(this,"ignoreZoomLimits",!1),$(this,"zoomFactor",1),$(this,"panBounds",{min:new qe(1/0,1/0),max:new qe(-1/0,-1/0),center:new qe(0,0,0),radius:1/0}),$(this,"minTilt",0),$(this,"maxTilt",1.2),$(this,"MOUSE_BUTTONS",{ORBIT:$L.RIGHT,ZOOM:$L.MIDDLE,PAN:$L.LEFT}),$(this,"camera"),$(this,"scene"),$(this,"renderer"),$(this,"elevation"),$(this,"orbit"),$(this,"cameraPlane"),$(this,"raycaster",new FA),$(this,"rendererState"),$(this,"options"),$(this,"state",-1),$(this,"intersection"),$(this,"viewState",null),$(this,"tweens",new Map),$(this,"clock",new sje(!0)),$(this,"coords",{mouse:new Jt,rotateStart:new Jt,rotateEnd:new Jt,rotateDelta:new Jt,panStart:new qe,panCameraStart:new qe,panEnd:new qe,panDelta:new qe,initialShiftPos:new Jt,initialPedestal:0,floorAnchor:new qe}),$(this,"touch",{origin:{offsetLeft:0,offsetTop:0},touches:[],anchor1:null,anchor2:null,inputs:null}),$(this,"scrollTimer",null),$(this,"lastWheelTime",0),$(this,"resetZoom",!1),$(this,"zoomStart"),$(this,"pedestalScaleFactor",1),$(this,"isUserZooming",!1),$(this,"stayInsideBounds",!0),$(this,"userInteracting",!1),$(this,"cameraMoving",!1),$(this,"lastCameraMoveTime",Date.now()),$(this,"raycastToFloor",s(o=>{this.raycaster.setFromCamera(o,this.camera);let l=this.raycaster.intersectObject(this.cameraPlane,!1)[0];return l?l.point:new qe},"raycastToFloor")),$(this,"isUserInteracting",s(()=>this.userInteracting,"isUserInteracting")),$(this,"getPosition",s(()=>new qe(this.orbit.position.x,this.orbit.position.y,this.orbit.position.z),"getPosition")),$(this,"getPedestal",s(()=>this.orbit.position.z,"getPedestal")),$(this,"pan",s((o,l)=>{isNaN(o)||isNaN(l)||(this.setPosition(this.orbit.position.x+o,this.orbit.position.y+l),this.publish("position-updated"))},"pan")),$(this,"postRender",s(()=>{(this.state===2||this.state===6)&&(this.raycaster.setFromCamera(this.coords.mouse,this.camera),this.intersection=this.raycaster.intersectObject(this.cameraPlane,!1)[0],this.intersection&&(this.coords.panStart.set(this.intersection.point.x,this.intersection.point.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0))),this.state===3&&this.resetZoom&&(this.resetZoom=!1,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0)),this.state===7&&this.isAnimating===!1&&(this.state=-1,this.publish("multi-end"))},"postRender")),$(this,"isCameraMoving",s(()=>this.cameraMoving,"isCameraMoving")),$(this,"lastCameraStoppedMovingTime",s(()=>this.lastCameraMoveTime,"lastCameraStoppedMovingTime")),$(this,"setPosition",s((o,l)=>{o===void 0||l===void 0||isNaN(o)||isNaN(l)||(this.state===-1&&this.publish("pan-start"),this.updateCameraPosition(o,l),this.publish("position-updated"),this.publish("change"),this.state===-1&&this.publish("pan-end"),this.dirty=!0)},"setPosition")),$(this,"updateCameraPosition",s((o,l)=>{let u=o-this.panBounds.center.x,c=l-this.panBounds.center.y,p=Math.sqrt(u*u+c*c);if(this.stayInsideBounds&&p>this.panBounds.radius){let m=Math.atan2(c,u),y={x:Math.cos(m)*this.panBounds.radius+this.panBounds.center.x,y:Math.sin(m)*this.panBounds.radius+this.panBounds.center.y};this.orbit.position.x=y.x,this.orbit.position.y=y.y}else this.orbit.position.x=o,this.orbit.position.y=l},"updateCameraPosition")),$(this,"tilt",s(o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let l=this.stayInsideBounds?Math.max(Math.min(o+this.getTilt(),this.maxTilt),this.minTilt):o+this.getTilt();l!==this.elevation.rotation.x&&(this.elevation.rotation.x=l,this.publish("tilt-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end")},"tilt")),$(this,"zoomIn",s((o,l,u)=>{let c=this.getZoomAltitude();this.animateCamera({zoom:c/1.5},o,l,u)},"zoomIn")),$(this,"zoomOut",s((o,l,u)=>{let c=this.getZoomAltitude();this.animateCamera({zoom:c*1.5},o,l,u)},"zoomOut")),$(this,"getRotation",s(()=>(-this.orbit.rotation.z+Math.PI*2)%(Math.PI*2),"getRotation")),$(this,"cancelAnimation",s(()=>{let o=Array.from(this.tweens.keys()),l=o[o.length-1];l.state===7&&this.publish("multi-cancel",{zooming:!0,rotating:!0,tilting:!0}),this.completeTween(l)},"cancelAnimation")),$(this,"animateCamera",s((o,l,u,c,p,m)=>{let y=Ee({interruptible:!0},m),v={},x={},E=this.getPosition();if(o.position!=null&&(o.position.x!==void 0&&(v.x=E.x,x.x=o.position.x),o.position.y!==void 0&&(v.y=E.y,x.y=o.position.y),o.position.z!==void 0&&(v.z=E.z,x.z=o.position.z)),o.zoom!==void 0&&(v.zoom=this.stayInsideBounds?Math.min(Math.max(this.getZoomAltitude(),this.getZoomScaledMin()),this.getZoomScaledMax()):this.getZoomAltitude(),this.viewState==="multi_floor"||!this.stayInsideBounds?x.zoom=o.zoom:x.zoom=Math.min(Math.max(o.zoom,this.getZoomScaledMin()),this.getZoomScaledMax())),o.rotation!==void 0){let{start:k,end:B}=kB(this.getRotation(),o.rotation);v.rotation=k,x.rotation=B}o.tilt!==void 0&&(v.tilt=this.getTilt(),this.viewState==="multi_floor"||!this.stayInsideBounds?x.tilt=o.tilt:x.tilt=Math.max(Math.min(o.tilt,this.maxTilt),this.minTilt));let M=v.zoom!==x.zoom,I=v.rotation!==x.rotation,P=v.tilt!==x.tilt,C=new pf(v).to(x,ja.env.TESTING?0:l).onUpdate(k=>{this.setMulti({x:k.x,y:k.y,z:k.z},k.zoom,k.rotation,k.tilt)}).onComplete(()=>{this.completeTween(C),this.publish("multi-end",{zooming:M,rotating:I,tilting:P}),c&&c()}).onStart(()=>{this.state!==7&&(this.state=7,C.state=7,this.publish("multi-start",{zooming:M,rotating:I,tilting:P})),this.publish("change")});this.rendererState.tweenGroup.add(C);let T=Array.from(this.tweens.entries()),D=T[T.length-1],F=!1;return D!=null&&(D[1].interruptible?(typeof D[1].cancelledCallback=="function"&&D[1].cancelledCallback(),this.completeTween(D[0])):(F=!0,D[0].chain(C))),this.tweens.set(C,{cancelledCallback:p,interruptible:y.interruptible}),u?C.easing(u):C.easing(Rl.Quadratic.In),!o.doNotAutoStart&&!F&&(C.start(),this.publish("change")),C.cameraAnimation=!0,C},"animateCamera")),$(this,"setMulti",s((o,l,u,c,p=!0)=>{this.state===-1&&this.publish("multi-start");let m=!1;o!=null&&(o.x!==void 0&&!isNaN(o.x)&&o.y!==void 0&&!isNaN(o.y)&&(this.updateCameraPosition(o.x,o.y),m=!0),o.z!==void 0&&!isNaN(o.z)&&(this.setPedestal(o.z,!0),m=!0)),m&&this.publish("position-updated");let y={zooming:!1,tilting:!!l,rotating:!1};if(l!==void 0&&!isNaN(l)){let v=this.stayInsideBounds?Math.min(Math.max(l,this.getZoomScaledMin()),this.getZoomScaledMax()):l;v!==this.camera.position.z&&(y.zooming=!0,this.camera.position.z=v,this.publish("zoom-updated"),this.zoomDirty=!0,this.viewState==="multi_floor"?l>yI&&(this.camera.near=l-yI,this.camera.far=l+yI):(this.camera.near=l/F2,this.camera.far=l*F2),this.camera.updateProjectionMatrix())}if(u!==void 0&&!isNaN(u)&&u!==this.getRotation()&&(y.rotating=!0,this.orbit.rotation.z=-u,this.publish("rotation-updated")),c!==void 0&&!isNaN(c)){let v=this.stayInsideBounds?Math.max(Math.min(c,this.maxTilt),this.minTilt):c;v!==this.elevation.rotation.x&&(y.tilting=!0,this.elevation.rotation.x=v,this.publish("tilt-updated"))}p&&this.publish("change"),this.state===-1&&this.publish("multi-end",y)},"setMulti")),$(this,"getZoomScaledMin",s(()=>this.minZoomAltitude*this.zoomFactor,"getZoomScaledMin")),$(this,"getZoomScaledMax",s(()=>{let o=this.minZoomAltitude*this.zoomFactor;return Math.max(this.maxZoomAltitude,o)},"getZoomScaledMax")),$(this,"setRotation",s((o,l)=>{if(isNaN(o))return;this.state===-1&&!l&&this.publish("rotate-start");let u=-(o%U5e);u!==this.orbit.rotation.z&&(this.orbit.rotation.z=u,l||this.publish("rotation-updated")),l||this.publish("change"),this.state===-1&&!l&&this.publish("rotate-end"),this.dirty=!0,this.rotationDirty=!0},"setRotation")),$(this,"setZoomAltitude",s(o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let l=this.stayInsideBounds?Math.min(Math.max(o,this.getZoomScaledMin()),this.getZoomScaledMax()):o;l!==this.camera.position.z&&(this.camera.position.z=l,this.publish("zoom-updated"),this.zoomDirty=!0),this.camera.near=l/F2,this.camera.far=l*F2,this.camera.updateProjectionMatrix(),this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.dirty=!0},"setZoomAltitude")),$(this,"setZoomLevel",s(o=>{this.setZoomAltitude(this.convertZoomLevelToAltitude(o))},"setZoomLevel")),$(this,"getZoomAltitude",s(()=>this.camera.position.z,"getZoomAltitude")),$(this,"getZoomLevel",s(()=>this.convertAltitudeToZoomLevel(this.getZoomAltitude()),"getZoomLevel")),$(this,"setTilt",s((o,l)=>{if(isNaN(o))return;this.state===-1&&!l&&this.publish("rotate-start");let u=this.stayInsideBounds?Math.max(Math.min(o,this.maxTilt),this.minTilt):o;u!==this.elevation.rotation.x&&(this.elevation.rotation.x=u,l||this.publish("tilt-updated")),l||this.publish("change"),this.state===-1&&!l&&this.publish("rotate-end"),this.dirty=!0},"setTilt")),$(this,"getTilt",s(()=>this.elevation.rotation.x,"getTilt")),$(this,"setCameraPlaneElevation",s(o=>{this.cameraPlane.position.z=o},"setCameraPlaneElevation")),$(this,"zoom",s(o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let l=this.getZoomAltitude()-o;this.camera.position.z=this.stayInsideBounds?Math.min(Math.max(l,this.minZoomAltitude*this.zoomFactor),this.maxZoomAltitude*this.zoomFactor):l,this.publish("zoom-updated"),this.zoomDirty=!0,this.publish("change"),this.state===-1&&this.publish("zoom-end")},"zoom")),$(this,"getProjectionScaleFactor",s((o,l,u)=>UO(o,l,u),"getProjectionScaleFactor")),$(this,"update",s(()=>{this.orbit.updateMatrixWorld(),this.lastWheelTime>0&&this.state===3&&this.clock.getElapsedTime()-this.lastWheelTime>.2&&(this.lastWheelTime=0,this.state=-1,this.publish("zoom-end"),this.removeMouseMoveEventListeners())},"update")),$(this,"setPedestal",s((o,l=!1)=>{typeof o=="number"&&!isNaN(o)&&(this.orbit.position.z=o,l&&(this.publishPedestalChangeEvent(o),this.publish("pedestal-change",{pedestal:o})),this.publish("change"),this.dirty=!0)},"setPedestal")),$(this,"dispose",s(()=>{for(let o of hN)o.endsWith("start")?(this.off(o,this.setCameraMoving),o.startsWith("user")&&this.off(o,this.setUserInteracting)):(o.endsWith("end")||o.endsWith("cancel"))&&(this.off(o,this.unsetCameraMoving),o.startsWith("user")&&this.off(o,this.unsetUserInteracting));this.removeEventListeners(),this.scene.remove(this.cameraPlane)},"dispose")),$(this,"createCameraPlane",s(()=>{let o=1e10,l=1,u=new pv(o,o,l,l),c=new ug({color:0,wireframe:vX,visible:vX}),p=new Tn(u,c);return this.scene.add(p),p},"createCameraPlane")),$(this,"addEventListeners",s(()=>{let{domElement:o}=this.renderer;for(let l of hN)l.endsWith("start")?(this.on(l,this.setCameraMoving),l.startsWith("user")&&this.on(l,this.setUserInteracting)):(l.endsWith("end")||l.endsWith("cancel"))&&(this.on(l,this.unsetCameraMoving),l.startsWith("user")&&this.on(l,this.unsetUserInteracting));o.addEventListener("contextmenu",this.onContextMenu,!1),o.addEventListener("mousedown",this.onMouseDown,!1),o.addEventListener("wheel",this.onMouseWheel,{passive:!1}),o.addEventListener("touchstart",this.onTouchStart,!1),o.addEventListener("touchend",this.onTouchEnd,!1),o.addEventListener("touchmove",this.onTouchMove,!1)},"addEventListeners")),$(this,"addMouseEventListeners",s(()=>{this.addMouseMoveEventListeners(),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("mouseout",this.onMouseUp,!1)},"addMouseEventListeners")),$(this,"addMouseMoveEventListeners",s(()=>{this.renderer.domElement.addEventListener("mousemove",this.onMouseMove,!1)},"addMouseMoveEventListeners")),$(this,"removeMouseMoveEventListeners",s(()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1)},"removeMouseMoveEventListeners")),$(this,"removeEventListeners",s(()=>{let{domElement:o}=this.renderer;o.removeEventListener("contextmenu",this.onContextMenu,!1),o.removeEventListener("mousedown",this.onMouseDown,!1),o.removeEventListener("wheel",this.onMouseWheel,!1),o.removeEventListener("touchstart",this.onTouchStart,!1),o.removeEventListener("touchend",this.onTouchEnd,!1),o.removeEventListener("touchmove",this.onTouchMove,!1),o.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)},"removeEventListeners")),$(this,"removeMouseUpEventListeners",s(()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)},"removeMouseUpEventListeners")),$(this,"onContextMenu",s(o=>{o.preventDefault()},"onContextMenu")),$(this,"onMouseUp",s(()=>{if(this.enabled!==!1){switch(this.removeMouseUpEventListeners(),this.state){case 2:this.publish("pan-end"),this.publish("user-pan-end");break;case 1:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}this.state=-1,this.panDirty=!1}},"onMouseUp")),$(this,"onMouseMove",s(o=>{if(this.enabled!==!1)if(o.preventDefault(),this.mouseToScene(o),this.state===0){if(this.enableRotate===!1)return;this.handleMouseMoveRotate(o)}else if(this.state===2){if(this.enablePan===!1)return;this.handleMouseMovePan()}else this.state===3?(this.resetZoom=!0,this.state=-1):this.state===8&&this.handleMouseMovePedestal(o)},"onMouseMove")),$(this,"onTouchStart",s(o=>{if(this.enabled!==!1){switch(this.updateTouchOrigin(),this.touchToScene(o),o.touches.length){case 1:this.enablePedestal?(this.handleTouchStartPedestal(o),this.state=9):this.enablePan&&(this.handleTouchStartPan(o),this.state=6);break;case 2:this.touch.inputs=new Tet(this.touch.touches[0],this.touch.touches[1]);break;default:this.state=-1}this.state}},"onTouchStart")),$(this,"onTouchMove",s(o=>{if(this.enabled!==!1)switch(this.touchToScene(o),o.touches.length){case 2:o.preventDefault(),o.stopPropagation();let l=Ee({},this.touch.inputs.first),u=Ee({},this.touch.inputs.second),c=new Jt(this.touch.touches[0].x,this.touch.touches[0].y),p=new Jt(this.touch.touches[1].x,this.touch.touches[1].y);if(this.touch.inputs.update(this.touch.touches[0],this.touch.touches[1]),this.enableRotate&&this.state===4)this.handleTouchMoveTilt(o);else if(this.state===5)this.handleTouchMoveDolly();else if(this.state!==5&&this.touch.inputs.totalDistance>.05){let m=l.y<c.y&&u.y<p.y,y=l.y>c.y&&u.y>p.y;this.enableRotate&&this.state!==4&&(y||m)?(this.handleTouchStartTilt(o),this.state=4):(this.handleTouchStartDolly(),this.state=5)}break;case 1:(this.enablePedestal||this.enablePan)&&(o.preventDefault(),o.stopPropagation()),this.enablePedestal&&this.state===9?this.handleTouchMovePedestal(o):this.enablePan&&this.state===6&&this.handleTouchMovePan(o);break;default:this.state=-1}},"onTouchMove")),$(this,"onTouchEnd",s(o=>{if(this.enabled!==!1){switch(this.handleTouchEnd(),this.state){case 2:case 6:this.publish("user-pan-end");break;case 4:this.publish("pan-end"),this.publish("user-tilt-end");break;case 1:case 5:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:case 9:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}o.touches.length?this.onTouchStart(o):this.state=-1}},"onTouchEnd")),$(this,"handleTouchMovePan",s(o=>{let l=Object.hasOwn(o,"x")?new Jt(o.x,o.y):this.touch.touches[0],u=this.raycastToFloor(l);this.coords.panEnd.set(u.x,u.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0},"handleTouchMovePan")),$(this,"handleTouchStartDolly",s(()=>{let o=this.touch.touches[0].x-this.touch.touches[1].x,l=this.touch.touches[0].y-this.touch.touches[1].y;this.zoomStart=this.getZoomAltitude();let u=new Jt(this.touch.touches[0].x-o/2,this.touch.touches[0].y-l/2);this.coords.floorAnchor=this.raycastToFloor(u),this.orbit.updateMatrixWorld(),this.touch.anchor1=new yX(this.touch.touches[0],this.camera,this.cameraPlane),this.touch.anchor2=new yX(this.touch.touches[1],this.camera,this.cameraPlane),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-dolly-start"),this.publish("zoom-start"),this.publish("multi-start")},"handleTouchStartDolly")),$(this,"handleMouseMovePan",s(()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panEnd.set(o.x,o.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change"),this.panDirty=!0},"handleMouseMovePan")),$(this,"handleTouchStartTilt",s(o=>{this.coords.rotateStart.set(o.touches[1].clientX,o.touches[1].clientY),this.publish("user-tilt-start"),this.publish("rotate-start")},"handleTouchStartTilt")),$(this,"handleTouchMovePedestal",s(o=>{this.handleMouseMovePedestal(o.touches[0])},"handleTouchMovePedestal")),$(this,"handleTouchMoveTilt",s(o=>{this.coords.rotateEnd.set(o.touches[1].clientX,o.touches[1].clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd)},"handleTouchMoveTilt")),$(this,"handleTouchMoveDolly",s(()=>{let o=this.touch.inputs.first,l=this.touch.inputs.second;this.touch.anchor1.viewCoordinate={x:o.x,y:o.y},this.touch.anchor2.viewCoordinate={x:l.x,y:l.y};let u=this.makeTransformFromTouchAnchors(this.touch.anchor1,this.touch.anchor2);u&&this.setCameraFromTransformMatrix(u),this.orbit.updateMatrixWorld(),this.touch.anchor1.updateAnchorState(this.camera,o),this.touch.anchor2.updateAnchorState(this.camera,l)},"handleTouchMoveDolly")),$(this,"handleTouchEnd",s(()=>{this.state===4||this.state===5?this.publish("multi-end"):this.state===6&&this.publish("pan-end"),this.panDirty=!1},"handleTouchEnd")),$(this,"handleTouchStartPan",s(o=>{let l=Object.hasOwn(o,"x")?new Jt(o.x,o.y):this.touch.touches[0],u=this.raycastToFloor(l);this.coords.panStart.set(u.x,u.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-pan-start"),this.publish("pan-start")},"handleTouchStartPan")),$(this,"handleTouchStartPedestal",s(o=>{this.handleMouseDownPedestal(o.touches[0])},"handleTouchStartPedestal")),$(this,"onMouseDown",s(o=>{if(this.enabled!==!1){if(this.mouseToScene(o),o.preventDefault(),this.state===3&&this.publish("zoom-end"),o.button===this.MOUSE_BUTTONS.ORBIT){if(this.enableRotate===!1)return;this.handleMouseDownRotate(o),this.state=0}else o.button===this.MOUSE_BUTTONS.PAN&&(this.enablePan?(this.handleMouseDownPan(),this.state=2):this.enablePedestal&&(this.handleMouseDownPedestal(o),this.state=8));this.state!==-1&&this.addMouseEventListeners()}},"onMouseDown")),$(this,"onMouseWheel",s(o=>{this.enabled===!1||this.enableZoom===!1||this.state!==-1&&this.state!==3||(o.preventDefault(),o.stopPropagation(),this.mouseToScene(o),this.canScrollZoom(o)&&(this.lastWheelTime=this.clock.getElapsedTime(),this.publishUserZoomEvent()),this.state!==3&&this.canScrollZoom(o)&&(this.addMouseMoveEventListeners(),this.state=3,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("zoom-start")),this.scrollTimer!=null&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.publish("zoom-end")},50),this.handleMouseWheel(o))},"onMouseWheel")),$(this,"handleMouseWheel",s(o=>{if(this.publish("zoom-start"),!this.canScrollZoom(o)){this.lastWheelTime>0&&this.publish("zoom-end"),this.lastWheelTime=0,this.state=-1;return}let l=this.getZoomAltitude(),u=l-gX(o)*l/V5e*this.zoomSpeed;if(this.setZoomAltitude(u),this.enablePan){let c=u/this.zoomStart;this.coords.panDelta.subVectors(this.coords.floorAnchor,this.coords.panCameraStart).multiplyScalar(1-c),this.setPosition(this.coords.panCameraStart.x+this.coords.panDelta.x,this.coords.panCameraStart.y+this.coords.panDelta.y)}this.publish("change")},"handleMouseWheel")),$(this,"setCameraFromTransformMatrix",s(o=>{this.orbit.updateMatrixWorld();let l=new Nu;l.setFromRotationMatrix(o,"ZYX");let u=(o.elements[14]-this.cameraPlane.position.z)/Math.cos(l.x),c=l.z,p=new qe(0,0,1);p.applyEuler(l),p.setLength(u);let m=new qe;m.setFromMatrixPosition(o),m.sub(p),this.enablePan&&this.setPosition(m.x,m.y),this.enableZoom&&this.setZoomAltitude(u),this.enableRotate&&this.setRotation(-c)},"setCameraFromTransformMatrix")),$(this,"makeTransformFromTouchAnchors",s((o,l)=>{this.orbit.updateMatrixWorld(),this.camera.updateProjectionMatrix();let u=this.camera.projectionMatrix.clone(),c=o.worldCoordinate,p=l.worldCoordinate,m=o.reUnproject(),y=l.reUnproject();if(!m||!y||!c||!p)return null;let v=o.viewCoordinate,x=l.viewCoordinate,E=p.x-c.x,M=p.y-c.y,I=Math.atan2(M,E),P=y.x-m.x,C=y.y-m.y,T=Math.atan2(C,P),D=Cet(I,T),F=new Ri;F.makeRotationZ(-D);let k=F.clone();k.multiply(o.snapHolderMatrix);let B=s((Xe,ht,rr)=>Xe.elements[(ht-1)*4+rr-1],"m"),U=B(u,1,1)*B(k,1,1)-v.x*B(u,3,4)*B(k,3,1),z=B(u,1,1)*B(k,1,2)-v.x*B(u,3,4)*B(k,3,2),q=B(u,1,1)*B(k,1,3)-v.x*B(u,3,4)*B(k,3,3),Z=c.x*U+c.y*z+c.z*q,Q=B(u,2,2)*B(k,2,1)-v.y*B(u,3,4)*B(k,3,1),V=B(u,2,2)*B(k,2,2)-v.y*B(u,3,4)*B(k,3,2),ae=B(u,2,2)*B(k,2,3)-v.y*B(u,3,4)*B(k,3,3),Y=c.x*Q+c.y*V+c.z*ae,he=B(u,1,1)*B(k,1,1)-x.x*B(u,3,4)*B(k,3,1),J=B(u,1,1)*B(k,1,2)-x.x*B(u,3,4)*B(k,3,2),ne=B(u,1,1)*B(k,1,3)-x.x*B(u,3,4)*B(k,3,3),ee=p.x*he+p.y*J+p.z*ne,ue=B(u,2,2)*B(k,2,1)-x.y*B(u,3,4)*B(k,3,1),K=B(u,2,2)*B(k,2,2)-x.y*B(u,3,4)*B(k,3,2),ce=B(u,2,2)*B(k,2,3)-x.y*B(u,3,4)*B(k,3,3),re=p.x*ue+p.y*K+p.z*ce,se=Math.abs(he-U),de=Math.abs(J-z),we=Math.abs(ne-q),Le=Math.abs(he-Q),fe=Math.abs(J-V),Re=Math.abs(ne-ae),me=Math.abs(ue-U),Ae=Math.abs(K-z),Ue=Math.abs(ce-q),_e=Math.abs(ue-Q),lt=Math.abs(K-V),tt=Math.abs(ce-ae),We=Math.min(se+de+we,Le+fe+Re),at=Math.min(me+Ae+Ue,_e+lt+tt);We<at&&(he=ue,J=K,ne=ce,ee=re);let Lt=Q*q-U*ae,dt=V*q-z*ae,Me=Y*q-Z*ae,ve=he*ae-Q*ne,Ze=J*ae-V*ne,It=ee*ae-Y*ne,Rt=(It*dt-Me*Ze)/(ve*dt-Lt*Ze),Et=(It*Lt-Me*ve)/(Ze*Lt-dt*ve),pt=V*U-z*Q,Yt=ae*U-q*Q,Kt=Y*U-Z*Q,$t=J*Q-V*he,jt=ne*Q-ae*he,Nt=((ee*Q-Y*he)*pt-Kt*$t)/(jt*pt-Yt*$t),Fe=k.clone();return Fe.elements[12]=Rt,Fe.elements[13]=Et,Fe.elements[14]=Nt,Nt>0?Fe:null},"makeTransformFromTouchAnchors")),$(this,"updateTouchOrigin",s(()=>{let o=this.renderer.domElement;this.touch.origin.offsetLeft=o.getBoundingClientRect().left,this.touch.origin.offsetTop=o.getBoundingClientRect().top},"updateTouchOrigin")),$(this,"touchToScene",s(o=>{this.touch.touches=[];for(let l=0,u=o.touches.length;l<u;l++){let c=o.touches[l],p=Iet(c,this.touch.origin);this.touch.touches.push(new Jt(p.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,-(p.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1))}this.coords.mouse=this.touch.touches[0]},"touchToScene")),$(this,"canScrollZoom",s(o=>{let l=gX(o),u=this.getZoomAltitude();return!(l<0&&u===this.getZoomScaledMax()||l>0&&u===this.getZoomScaledMin())},"canScrollZoom")),$(this,"mouseToScene",s(o=>{let l=this.getMousePos(o);return this.coords.mouse.x=l.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,this.coords.mouse.y=-(l.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1,this.coords.mouse},"mouseToScene")),$(this,"getMousePos",s(o=>({x:o.offsetX,y:o.offsetY}),"getMousePos")),$(this,"handleMouseDownRotate",s(o=>{this.coords.rotateStart.set(o.clientX,o.clientY),this.publish("rotate-start"),this.publish("user-rotate-start")},"handleMouseDownRotate")),$(this,"handleMouseDownPan",s(()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panStart.set(o.x,o.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("pan-start"),this.publish("user-pan-start")},"handleMouseDownPan")),$(this,"handleMouseDownPedestal",s(o=>{let l=new Jt(o.clientX,o.clientY);this.coords.initialShiftPos=l,this.coords.initialPedestal=this.getPedestal(),this.pedestalScaleFactor=UO(this.camera.fov,this.renderer.domElement.clientHeight,this.getZoomAltitude()),this.publish("pedestal-start"),this.publish("user-pedestal-start")},"handleMouseDownPedestal")),$(this,"handleMouseMovePedestal",s(o=>{let l={x:o.clientX,y:o.clientY},u=this.coords.initialPedestal+this.pedestalScaleFactor*(l.y-this.coords.initialShiftPos.y);this.stayInsideBounds&&(u<this.minPedestal?u=Math.max(u,this.minPedestal):u>this.maxPedestal&&(u=Math.min(u,this.maxPedestal))),u!==this.getPedestal()&&this.setPedestal(u,!0)},"handleMouseMovePedestal")),$(this,"handleMouseMoveRotate",s(o=>{this.coords.rotateEnd.set(o.clientX,o.clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setRotation(this.getRotation()+this.coords.rotateDelta.x/this.rotateSpeed),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd),this.publish("change")},"handleMouseMoveRotate")),$(this,"publishUserZoomDebounced",e3(()=>{this.isUserZooming=!1,this.publish("user-zoom-end")},250)),$(this,"publishUserZoomEvent",s(()=>{this.isUserZooming?this.publishUserZoomDebounced():(this.publish("user-zoom-start"),this.isUserZooming=!0,this.publishUserZoomDebounced())},"publishUserZoomEvent")),$(this,"setCameraMoving",s(()=>{this.cameraMoving=!0},"setCameraMoving")),$(this,"unsetCameraMoving",s(()=>{this.cameraMoving=!1,this.lastCameraMoveTime=Date.now()},"unsetCameraMoving")),$(this,"setUserInteracting",s(()=>{this.userInteracting=!0},"setUserInteracting")),$(this,"unsetUserInteracting",s(()=>{this.userInteracting=!1},"unsetUserInteracting")),$(this,"publishPedestalChangeEvent",s(o=>{this.publish("pedestal-change",{pedestal:o,scrolledToTop:this.scrolledToTop,scrolledToBottom:this.scrolledToBottom,scrollPercent:this.scrollPercent})},"publishPedestalChangeEvent")),$(this,"convertAltitudeToZoomLevel",s(o=>{let[,l]=this.center,u=o*2*Math.tan($n.degToRad(this.camera.fov)/2)/this.options.canvasHeight,c=Math.cos($n.degToRad(l))*2*Math.PI*Zy/u;return $n.clamp(Math.log2(c/512),uN,cN)},"convertAltitudeToZoomLevel")),$(this,"convertZoomLevelToAltitude",s(o=>{let[,l]=this.center,u=$n.clamp(o,uN,cN),c=Math.pow(2,u),p=$n.clamp(l,B5e,z5e),m=c*512;return Math.cos($n.degToRad(p))*Math.PI*2*Zy/m*this.options.canvasHeight/2/Math.tan($n.degToRad(this.camera.fov)/2)},"convertZoomLevelToAltitude")),$(this,"completeTween",s(o=>{o.isPlaying()&&o.stop(),this.rendererState.tweenGroup.remove(o),this.tweens.delete(o)},"completeTween")),$(this,"debugContainer",new Ha),this.camera=e,this.renderer=i,this.rendererState=n,this.scene=r,this.options=a,this.elevation=e.parent,this.orbit=this.elevation.parent,this.cameraPlane=this.createCameraPlane(),this.zoomStart=e.position.z,a.mode!=="outdoors-overlay"&&this.addEventListeners()}get maxZoomLevel(){return this.convertAltitudeToZoomLevel(this.minZoomAltitude)}setMaxZoomLevel(e){this.minZoomAltitude=this.convertZoomLevelToAltitude(e)}get defaultMinZoomLevel(){return w(this,dN)}get minZoomLevel(){return this.convertAltitudeToZoomLevel(this.maxZoomAltitude)}setMinZoomLevel(e){this.maxZoomAltitude=this.convertZoomLevelToAltitude(e)}get scrollPercent(){let e=this.minPedestal,r=this.maxPedestal,i=this.getPedestal();return i=Math.min(i,r),i=Math.max(i,e),(i-e)/(r-e)*100}get fov(){return this.camera.fov}get scrolledToBottom(){return this.minPedestal===0||Math.floor(this.getPedestal())<=this.minPedestal}get scrolledToTop(){return this.maxPedestal===0||Math.ceil(this.getPedestal())>=this.maxPedestal}get center(){var e,r,i,n;let a=this.getPosition(),{lat:o,lon:l}=UB((r=(e=this.rendererState.center)==null?void 0:e[1])!=null?r:0,(n=(i=this.rendererState.center)==null?void 0:i[0])!=null?n:0,a.x,a.y);return[l,o]}setCenter(e,r){var i,n,a,o;let{x:l,y:u}=VB((n=(i=this.rendererState.center)==null?void 0:i[1])!=null?n:0,(o=(a=this.rendererState.center)==null?void 0:a[0])!=null?o:0,r,e);this.setPosition(l,u)}get isAnimating(){return this.rendererState.tweenGroup.getAll().some(e=>e.cameraAnimation)}getCameraFrameForCoordinates(e,r){let i=r.minZoom!==void 0?r.minZoom:this.minZoomAltitude,n=r.maxZoom!==void 0?r.maxZoom:this.maxZoomAltitude,a=this.options.canvasWidth,o=this.options.canvasHeight,l=this.getRotation(),u=this.getTilt(),c=this.getPosition();this.setRotation(r.rotation||l,!0),this.setTilt(r.tilt||u,!0);let p=mN(e,{canvasWidth:a,canvasHeight:o,paddingOption:r.padding,verticalPadding:r.verticalPadding,minZoom:i,maxZoom:n,position:c,camera:this.camera,orbit:this.orbit});return this.setRotation(l,!0),this.setTilt(u,!0),{center:p.position,zoomLevel:this.convertAltitudeToZoomLevel(p.zoom)}}focusOn(e,r){let i=r.curve,n=r.callback,a=r.cancelledCallback,o=r.minZoom!==void 0?r.minZoom:this.minZoomAltitude,l=r.maxZoom!==void 0?r.maxZoom:this.maxZoomAltitude,u=this.options.canvasWidth,c=this.options.canvasHeight,p;r.duration!==void 0?p=r.duration:ja.env.TESTING==="true"?p=0:p=j5e;let m=r.padding,y=this.getRotation(),v=this.getTilt();r.rotation!=null&&this.setRotation(r.rotation),r.tilt!=null&&this.setTilt(r.tilt);let x=mN(e,{canvasHeight:c,paddingOption:m,canvasWidth:u,minZoom:o,maxZoom:l,camera:this.camera,orbit:this.orbit,position:this.getPosition(),verticalPadding:r.verticalPadding});this.setRotation(y),this.setTilt(v),this.animateCamera({position:x.position,tilt:r.tilt,rotation:r.rotation,zoom:x.zoom},p,i,n,a,r)}resize(e,r){this.options.canvasWidth=e,this.options.canvasHeight=r}};dN=new WeakMap,s(fN,"CameraSystem"),$(fN,"CAMERA_FRAME_PADDING_SIDES",["top","bottom","left","right"]);var G5e=fN;function mN(t,{canvasWidth:e,orbit:r,paddingOption:i,verticalPadding:n=0,canvasHeight:a,minZoom:o,maxZoom:l,camera:u,position:c}){let p={zoom:o,position:c};if(t.length===0)return p;for(let _e of G5e.CAMERA_FRAME_PADDING_SIDES)typeof i[_e]!="number"&&(i[_e]=0);let m=i.type==="portion"?{top:i.top*a,bottom:i.bottom*a,left:i.left*e,right:i.right*e}:i;if(m.left+m.right>=e||m.top+m.bottom>=a)return p;r.updateMatrixWorld();let y=u.matrixWorldInverse,v=u.fov*(Math.PI/180)/2,x=v,E=Math.atan(Math.tan(v)*(e/a)),M=new qe(1/0,1/0,1/0),I=new qe(-1/0,-1/0,-1/0),P=new to,C=new qe;for(let _e=0,lt=t.length;_e<lt;_e++)C.copy(t[_e]),P.expandByPoint(C),C.applyMatrix4(y),M.min(C),I.max(C),C.copy(t[_e]),C.z-=n,C.applyMatrix4(y),M.min(C),I.max(C),C.copy(t[_e]),C.z+=n,C.applyMatrix4(y),M.min(C),I.max(C);let T=I.x-M.x,D=I.y-M.y,F=e-m.left-m.right,k=a-m.top-m.bottom,B=(I.x+M.x)/2,U=(I.y+M.y)/2,z=T/F,q=D/k,Z=o,Q=l,V=Z*Math.tan(E)*2,ae=Q*Math.tan(E)*2,Y=V/e,he=ae/e,J=Math.max(z,q);J=$n.clamp(J,Y,he);let ne=F*J,ee=k*J,ue={min:{x:B-ne/2-m.left*J,y:U-ee/2-m.bottom*J},max:{x:B+ne/2+m.right*J,y:U+ee/2+m.top*J}},K=(ue.min.x+ue.max.x)/2,ce=(ue.min.y+ue.max.y)/2,re=P.getCenter(new qe),se=Math.abs(K-ue.min.x),de=Math.abs(ce-ue.min.y),we=se/Math.tan(E),Le=de/Math.tan(x),fe=new qe;fe.set(K,ce,I.z+Math.max(we,Le)),fe.applyMatrix4(u.matrixWorld);let Re=new qe;Re.set(K,ce,I.z),Re.applyMatrix4(u.matrixWorld);let me=new qe().subVectors(Re,fe),Ae=(re.z-fe.z)/me.z,Ue=new qe().copy(fe).add(me.clone().multiplyScalar(Ae));return Re.set(Ue.x,Ue.y,Ue.z),fe.sub(Re),{position:Ue,zoom:fe.length()}}s(mN,"getCameraFrameForPoints");N();var Bet=300,vI,_I,H5e=class{constructor(e){$(this,"state"),Be(this,vI,new qe),Be(this,_I,new qe),this.state=e}update(e){var r;let i,n;this.state.cameraObject.getWorldPosition(w(this,_I));for(let a of this.state.geometry2DIdsInScene)if(i=this.state.geometry2DMap.get(a),i&&(n=i.components[0],n&&"containerEl"in n&&n.markerContainer!=null)){if(n.visibilityNeedsUpdate!==!1&&(n.visibilityNeedsUpdate==="show"?n.canShow=!0:n.canShow=!1),(n.canShow&&n.visible===!0||((r=n.animation)==null?void 0:r.pending)===!0)&&!n.offscreen)if(n.options.zIndex!=null)n.markerContainer.style.transform="translate3D(".concat(n.projection.x,"px, ").concat(n.projection.y,"px, ").concat(n.options.zIndex,"px)");else{i.object3d.getWorldPosition(w(this,vI));let o=w(this,_I).distanceTo(w(this,vI));n.markerContainer.style.transform="translate3D(".concat(n.projection.x,"px, ").concat(n.projection.y,"px, ").concat(-o,"px)")}if(n.canShow===!0&&n.visible===!0?n.markerContainer.style.pointerEvents=e?"none":n.pointerEvents:n.markerContainer.style.pointerEvents="none",n.currentStrategyIndex===-1&&n.visible&&n.visibilityNeedsUpdate==="show")continue;n.visibilityNeedsUpdate!==!1&&!n.offscreen&&(n.visibilityNeedsUpdate==="show"&&(n.markerContainer.style.opacity="0"),n.animation&&n.animation.cancel(),n.animation=n.markerContainer.animate([{opacity:n.canShow&&n.visible?"1":"0"}],{duration:Bet,easing:"ease-in-out",fill:"forwards"}),n.visibilityNeedsUpdate=!1)}}};vI=new WeakMap,_I=new WeakMap,s(H5e,"DOMDrawSystem");var zet=H5e;N();var q5e=class{constructor(){$(this,"percentExpanded",0),$(this,"activeId",""),$(this,"gap",20),$(this,"dirty",!0)}};s(q5e,"StackComponent");var Uet=q5e;N();var W5e=class extends qa{constructor(e,r){super(),$(this,"state"),$(this,"dirty",!0),$(this,"domTree"),$(this,"observers",new Map),$(this,"updateDimensions",s(i=>{i.forEach(n=>{var a;let o=(a=n.target.parentElement)==null?void 0:a.getAttribute("data-marker-id");if(o){let l=this.state.geometry2DMap.get(o),u=l==null?void 0:l.components[0];l&&u instanceof pw&&(u.updateDimensions(n.contentRect.width,n.contentRect.height),u.collisionDirty=!0)}}),this.publish("dimensions-update")},"updateDimensions")),this.state=e,this.domTree=r}setupObserver(){var e;if(this.observers){for(let n of this.observers.values())n.disconnect();this.observers.clear()}let r,i;for(let n of this.domTree.children){let a=n.getAttribute("data-marker-id");if(a!=null&&(r=this.state.geometry2DMap.get(a),i=r.components[0],(e=i.options)!=null&&e.dynamicResize)){let o=new ResizeObserver(this.updateDimensions);o.observe(i.containerEl),this.observers.set(n.userData.entityId,o)}}}update(){this.dirty&&(this.setupObserver(),this.dirty=!1)}destroy(){for(let e of this.observers.values())e.disconnect();this.observers.clear()}};s(W5e,"DOMResizeSystem");var Vet=W5e;N();var jet=0,$et=90;ja.env.NODE_ENV;var J_={linear:Rl.Linear.None,"ease-in":Rl.Quadratic.In,"ease-out":Rl.Quadratic.Out,"ease-in-out":Rl.Quadratic.InOut},Get=-50,ci,Ci,ey,xI,bI,gN,X5e=class{constructor(e,r,i){Be(this,bI),Be(this,ci),Be(this,Ci),Be(this,ey),Be(this,xI),He(this,ci,e),He(this,Ci,r),He(this,ey,i),w(this,Ci).cameraSystem.on("pedestal-change",({pedestal:n})=>{w(this,ci).map&&(w(this,ci).map.transform.elevation=n,w(this,ci).map.transform.minElevationForCurrentTile=Get,w(this,ci).map.triggerRepaint()),w(this,Ci).cameraSystem.setCameraPlaneElevation(n)})}get center(){return w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?w(this,ci).map.getCenter().toArray():w(this,Ci).cameraSystem.center}setCenter(e){var r;if(w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map){(r=w(this,ci).map)==null||r.setCenter(e),w(this,Ci).interactionSystem.handleHover();return}w(this,Ci).cameraSystem.setCenter(e[0],e[1]),w(this,Ci).interactionSystem.handleHover()}get zoomLevel(){var e;return w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?(e=w(this,ci).map)==null?void 0:e.getZoom():w(this,Ci).cameraSystem.getZoomLevel()}setZoomLevel(e){var r;w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map&&((r=w(this,ci).map)==null||r.setZoom(e)),w(this,Ci).cameraSystem.setZoomLevel(Lp(e,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits."))}get isAnimating(){return w(this,Ci).cameraSystem.isAnimating}cancelAnimation(){w(this,Ci).cameraSystem.cancelAnimation()}get maxZoomLevel(){return w(this,Ci).cameraSystem.maxZoomLevel}get minZoomLevel(){return w(this,Ci).cameraSystem.minZoomLevel}setAutoMinZoomLevel(e){w(this,Ci).panBoundsSystem.autoMinZoomLevel=e,e&&(w(this,Ci).panBoundsSystem.dirty=!0,w(this,Ci).panBoundsSystem.update())}get autoMinZoomLevel(){return w(this,Ci).panBoundsSystem.autoMinZoomLevel}setMinZoomLevel(e,r=!1){var i;r&&this.setAutoMinZoomLevel(!1);let n=Lp(e,_y.MIN_MERCATOR_ZOOM_LEVEL,this.maxZoomLevel,"setMinZoomLevel was clamped. minZoomLevel must be between ".concat(_y.MIN_MERCATOR_ZOOM_LEVEL," and maxZoomLevel."));w(this,Ci).cameraSystem.setMinZoomLevel(n),this.zoomLevel<n&&this.setZoomLevel(n),(i=w(this,ci).map)==null||i.setMinZoom(n)}setMaxZoomLevel(e){var r;let i=Lp(e,this.minZoomLevel,_y.MAX_MERCATOR_ZOOM_LEVEL,"setMaxZoomLevel was clamped. maxZoomLevel must be between minZoomLevel and ".concat(_y.MAX_MERCATOR_ZOOM_LEVEL,"."));w(this,Ci).cameraSystem.setMaxZoomLevel(i),this.zoomLevel>i&&this.setZoomLevel(i),(r=w(this,ci).map)==null||r.setMaxZoom(i)}get maxPitch(){var e;return w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?(e=w(this,ci).map)==null?void 0:e.getMaxPitch():$n.radToDeg(w(this,Ci).cameraSystem.maxTilt)}get minPitch(){var e;return w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?(e=w(this,ci).map)==null?void 0:e.getMinPitch():$n.radToDeg(w(this,Ci).cameraSystem.minTilt)}setMinPitch(e){var r;let i=Math.max(jet,e);(r=w(this,ci).map)==null||r.setMinPitch(i),w(this,Ci).cameraSystem.minTilt=$n.degToRad(i)}setMaxPitch(e){var r;let i=Math.min($et,e);(r=w(this,ci).map)==null||r.setMaxPitch(i),w(this,Ci).cameraSystem.maxTilt=$n.degToRad(i)}get bearing(){var e;return w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?(e=w(this,ci).map)==null?void 0:e.getBearing():$n.radToDeg(w(this,Ci).cameraSystem.getRotation())}setBearing(e){var r;if(w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map){(r=w(this,ci).map)==null||r.setBearing(e);return}w(this,Ci).cameraSystem.setRotation($n.degToRad(e))}get pitch(){var e;return w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?(e=w(this,ci).map)==null?void 0:e.getPitch():$n.radToDeg(w(this,Ci).cameraSystem.getTilt())}setPitch(e){var r;if(w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map){(r=w(this,ci).map)==null||r.setPitch(e);return}w(this,Ci).cameraSystem.setTilt($n.degToRad(Lp(e,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")))}get elevation(){return w(this,Ci).cameraSystem.getPedestal()}setElevation(e){w(this,Ci).cameraSystem.setPedestal(e,!0)}animateElevation(e,r){return w(this,xI)&&w(this,xI).stop(),new Promise(i=>{var n;let a=w(this,Ci).cameraSystem.getPosition();a.z=e,w(this,Ci).cameraSystem.animateCamera({position:a},(r==null?void 0:r.duration)||300,J_[(r==null?void 0:r.easing)||"ease-in-out"],i,i,{interruptible:(n=r==null?void 0:r.interruptible)!=null?n:!0})})}get insetsPadding(){return w(this,ey).insetsPadding}get panMode(){return w(this,Ci).cameraSystem.enablePan===!1&&w(this,Ci).cameraSystem.enablePedestal===!0?"elevation":"default"}setPanMode(e){if(e!=="default"&&e!=="elevation")throw new Error("Invalid pan mode");e!==this.panMode&&(e==="default"?(w(this,Ci).cameraSystem.enablePan=!0,w(this,Ci).cameraSystem.enablePedestal=!1):(w(this,Ci).cameraSystem.enablePan=!1,w(this,Ci).cameraSystem.enablePedestal=!0))}setInsetPadding(e){w(this,ey).insetsPadding=Object.assign({},BB,e)}animateTo(e){var r,i,n,a,o,l;if(w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map)return(l=w(this,ci).map)==null||l.flyTo({center:(r=e.center)!=null?r:this.center,zoom:(i=e.zoomLevel)!=null?i:this.zoomLevel,bearing:(n=e.bearing)!=null?n:this.bearing,pitch:(a=e.pitch)!=null?a:this.pitch,duration:(o=e.duration)!=null?o:600}),Promise.resolve();let u=e.center?w(this,ci).convertTo3DMapPosition(e.center[1],e.center[0],e.center[2]||this.elevation):void 0,c=e.zoomLevel!==void 0?w(this,Ci).cameraSystem.convertZoomLevelToAltitude(Lp(e.zoomLevel,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits.")):void 0,p=e.bearing!==void 0?$n.degToRad(e.bearing):void 0,m=e.pitch!==void 0?$n.degToRad(Lp(e.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0;return new Promise(y=>{var v;w(this,Ci).cameraSystem.animateCamera({position:u,zoom:c,rotation:p,tilt:m},e.duration||0,J_[e.easing||"ease-in-out"],()=>{w(this,Ci).interactionSystem.handleHover(),y()},y,{interruptible:(v=e==null?void 0:e.interruptible)!=null?v:!0})})}getCameraFrameForCoordinates(e,r){let i=dr(this,bI,gN).call(this,r||{},()=>Promise.resolve()),{pointCloud:n}=yN(e,w(this,ci),w(this,ey).geometry3DMap);if(n.length===0)return Vt.error("No valid coordinates found in targets:",e),{center:this.center,zoomLevel:this.zoomLevel};let{center:a,zoomLevel:o}=w(this,Ci).cameraSystem.getCameraFrameForCoordinates(n,i);return{center:w(this,ci).convert3DMapPositionToCoordinate(a),zoomLevel:o}}focusOn(e,r){var i,n,a,o;let{pointCloud:l,geoBounds:u,firstPosition:c}=yN(e,w(this,ci),w(this,ey).geometry3DMap);return l.length===0?(Vt.error("No valid coordinates found in targets:",e),Promise.resolve()):w(this,ci).mode==="outdoors-overlay"&&w(this,ci).map?(l.length===1&&c?(i=w(this,ci).map)==null||i.flyTo({center:[c[0],c[1]],duration:(r==null?void 0:r.duration)||w(this,ci).map.getBearing(),animate:!0,bearing:(r==null?void 0:r.bearing)===void 0?w(this,ci).map.getBearing():r==null?void 0:r.bearing,pitch:(r==null?void 0:r.pitch)===void 0?w(this,ci).map.getPitch():r==null?void 0:r.pitch,zoom:(r==null?void 0:r.maxZoomLevel)||w(this,ci).map.getMaxZoom()}):(o=w(this,ci).map)==null||o.fitBounds(u,{duration:(n=r==null?void 0:r.duration)!=null?n:_y.DEFAULT_ANIMATION_DURATION,bearing:(r==null?void 0:r.bearing)===void 0?w(this,ci).map.getBearing():r==null?void 0:r.bearing,pitch:(r==null?void 0:r.pitch)===void 0?w(this,ci).map.getPitch():r==null?void 0:r.pitch,maxZoom:(a=r==null?void 0:r.maxZoomLevel)!=null?a:w(this,ci).map.getMaxZoom()}),w(this,Ci).interactionSystem.handleHover(),Promise.resolve()):new Promise(p=>{w(this,Ci).cameraSystem.focusOn(l,dr(this,bI,gN).call(this,r||{},p))})}};ci=new WeakMap,Ci=new WeakMap,ey=new WeakMap,xI=new WeakMap,bI=new WeakSet,gN=s(function(t,e){var r;return{minZoom:(t==null?void 0:t.maxZoomLevel)===void 0?void 0:w(this,Ci).cameraSystem.convertZoomLevelToAltitude(Lp(t.maxZoomLevel,this.minZoomLevel,this.maxZoomLevel,"maxZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMaxZoomLevel() to adjust limits.")),maxZoom:(t==null?void 0:t.minZoomLevel)===void 0?void 0:w(this,Ci).cameraSystem.convertZoomLevelToAltitude(Lp(t.minZoomLevel,this.minZoomLevel,this.maxZoomLevel,"minZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() to adjust limits.")),padding:t!=null&&t.padding?Object.assign({},BB,t==null?void 0:t.padding):this.insetsPadding,curve:J_[(t==null?void 0:t.easing)||"ease-in-out"],rotation:(t==null?void 0:t.bearing)===void 0?void 0:$n.degToRad(t.bearing),tilt:(t==null?void 0:t.pitch)!==void 0?$n.degToRad(Lp(t.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0,duration:t==null?void 0:t.duration,callback:s(()=>{w(this,Ci).interactionSystem.handleHover(),e()},"callback"),cancelledCallback:e,interruptible:(r=t==null?void 0:t.interruptible)!=null?r:!0,verticalPadding:t==null?void 0:t.verticalPadding}},"#convertToLegacy"),s(X5e,"Camera");var Het=X5e;function wI(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}s(wI,"updateBounds");function yN(t,e,r){var i;let n=[],a=[1/0,1/0,-1/0,-1/0],o=null;if(!t||!Array.isArray(t)||t.length===0)return{pointCloud:n,geoBounds:a,firstPosition:o};let l=e.getSystems().renderSystem;(l.threeDdirty||l.twoDdirty)&&e.renderSync();for(let u of t)if(typeof u=="string"){let c=r.get(u);if(!c){Vt.error("Entity not found with id:",u);continue}let p=new to;fge(e,"userData"in c&&(i=c.userData.entityId)!=null?i:c.id,n,p,c instanceof Yn?c.position.z:void 0);let m=e.convert3DMapPositionToCoordinate(p.min),y=e.convert3DMapPositionToCoordinate(p.max);wI(a,m),wI(a,y),o||(o=e.convert3DMapPositionToCoordinate(p.getCenter(new qe)))}else n.push(e.convertTo3DMapPosition(u[1],u[0],u[2]||0)),wI(a,u),o||(o=u);return{pointCloud:n,geoBounds:a,firstPosition:o}}s(yN,"processTargets");function qet(t,e){var r,i,n,a;let o=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]];(r=t.map)!=null&&r.getLayer("bounds-outline")&&t.map.removeLayer("bounds-outline"),(i=t.map)!=null&&i.getSource("bounds-source")&&t.map.removeSource("bounds-source"),(n=t.map)==null||n.addSource("bounds-source",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:o}}}),(a=t.map)==null||a.addLayer({id:"bounds-outline",type:"line",source:"bounds-source",layout:{},paint:{"line-color":"#FF0000","line-width":2,"line-opacity":.8}})}s(qet,"drawBounds");N();N();var Wet=`uniform vec4 uSize;
varying vec2 vUv;
void main() {
  vUv = uv;
  // Scale the position by the size of the quad
  // and shift to top left corner for 0,0
	vec2 transformed = position.xy * uSize.xy - vec2(1.0, -1.0);
  // Apply width .x and height .y of image
  transformed += vec2(uSize.x, -uSize.y);
  // Apply left .w and top .z offset
  transformed += vec2(uSize.w, -uSize.z) * 2.0;
  gl_Position = vec4(transformed, 1.0, 1.0);
}`;N();var Xet=`varying vec2 vUv;
uniform sampler2D uTexture;
uniform float uOpacity;
void main() {
  #ifndef debug
  vec4 texture = texture2D(uTexture, vUv);
  gl_FragColor = vec4(texture.rgb, texture.a * uOpacity);
  #else
  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  #endif
}`;N();var Zet=4.291666666666667,Yet=15,Ket=25,Jet=43/60;N();var _X=["horizontal","icon"],Qet=new Map([[_X[0],`<svg viewBox="0 0 206 48">
      <path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z"/>
      <path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z"/>
      <path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z"/>
      <path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z"/>
    </svg>`],[_X[1],`<svg viewBox="0 0 43 60">
      <path d="M14.0291 7.06645C14.0291 10.9691 10.8885 14.1329 7.01453 14.1329C3.14051 14.1329 0 10.9691 0 7.06645C0 3.16376 3.14051 0 7.01453 0C10.8885 0 14.0291 3.16376 14.0291 7.06645Z"/>
      <path d="M28.7335 18.3468H35.1045C36.7455 18.3468 37.5178 19.0599 37.5821 20.6158V57.7309C37.5821 59.2868 36.8099 60 35.1367 60H28.9588C27.1569 60 26.642 59.7406 25.6767 58.282L12.6452 38.282V57.7309C12.6452 59.2868 11.8729 60 10.1997 60H3.82873C2.15554 60 1.3833 59.2868 1.3833 57.7309V20.6158C1.3833 19.0599 2.15554 18.3468 3.82873 18.3468H10.1032C11.9051 18.4116 12.4843 18.671 13.3852 20.0648L26.3524 40.162V20.6158C26.3524 19.0599 27.1247 18.3468 28.7335 18.3468Z"/>
      <path d="M41.5 60C42.3362 60 43 59.3143 43 58.5V58.4914C43 57.6771 42.3448 57 41.5 57C40.6638 57 40 57.6857 40 58.5V58.5086C40 59.3229 40.6552 60 41.5 60ZM41.5 59.8371C40.7414 59.8371 40.1724 59.2371 40.1724 58.5086V58.5C40.1724 57.7714 40.75 57.1629 41.5 57.1629C42.2586 57.1629 42.8276 57.7629 42.8276 58.4914V58.5C42.8276 59.2286 42.25 59.8371 41.5 59.8371ZM40.9138 59.2286H41.2069V58.7057H41.5259L41.8879 59.2286H42.2414L41.8362 58.6543C42.0431 58.5943 42.1897 58.44 42.1897 58.1914C42.1897 57.8743 41.9397 57.7114 41.6034 57.7114H40.9138V59.2286ZM41.2069 58.4657V57.9686H41.5776C41.7759 57.9686 41.8879 58.0543 41.8879 58.2171C41.8879 58.3629 41.7759 58.4657 41.5776 58.4657H41.2069Z"/>
    </svg>`]]),ett=/<svg([^>]*)>/g;function Z5e(t,e,r,i){let n=Qet.get(t);return n?n.replace(ett,'<svg$1 width="'.concat(r,'" height="').concat(i,'" xmlns="http://www.w3.org/2000/svg" style="fill: ').concat(e,';">')):""}s(Z5e,"getLogoIcon");var xX=!1,Ma,xm,B2,Fs,Au,i1,wp,zd,Y5e=class extends qa{constructor(e,r,i){super(),Be(this,Ma,{padding:16,scale:1,iconOnly:!1,position:"bottom-left",color:"dark",onClick:s(()=>{window!=null&&window.open("https://www.mappedin.com")},"onClick"),interactive:!0,visible:!0}),Be(this,xm),Be(this,B2),Be(this,Fs),Be(this,Au),Be(this,i1),Be(this,wp,0),Be(this,zd,0),$(this,"dirty",!0),$(this,"getPositionAlignedCanvasCoordinates",s((n,a)=>({"top-left":{x:0,y:0},"top-right":{x:n,y:0},"bottom-left":{x:0,y:a},"bottom-right":{x:n,y:a},center:{x:n/2,y:a/2},top:{x:n/2,y:0},bottom:{x:n/2,y:a},left:{x:0,y:a/2},right:{x:n,y:a/2}})[w(this,Ma).position],"getPositionAlignedCanvasCoordinates")),$(this,"getPositionAlignedPadding",s(()=>{var n,a,o,l;let u=w(this,Ma).padding;if(typeof u=="number")return{"top-left":{x:u,y:u},"top-right":{x:-u,y:u},"bottom-left":{x:u,y:-u},"bottom-right":{x:-u,y:-u},center:{x:0,y:0},top:{x:0,y:u},bottom:{x:0,y:-u},left:{x:u,y:0},right:{x:-u,y:0}}[w(this,Ma).position];let c={top:(n=u.top)!=null?n:0,right:(a=u.right)!=null?a:0,bottom:(o=u.bottom)!=null?o:0,left:(l=u.left)!=null?l:0};return{x:c.left-c.right,y:c.top-c.bottom}},"getPositionAlignedPadding")),i&&Object.entries(i).forEach(([n,a])=>{a!==void 0&&(w(this,Ma)[n]=a)}),He(this,B2,e),He(this,xm,r)}get color(){return w(this,Ma).color==="light"?"white":"#293136"}get iconName(){return w(this,Ma).iconOnly?"icon":"horizontal"}get minWidth(){return w(this,Ma).iconOnly?Yet:75}get defaultWidth(){return w(this,Ma).iconOnly?Ket:150}get aspectRatio(){return w(this,Ma).iconOnly?Jet:Zet}get options(){return Ee({},w(this,Ma))}set options(e){var r,i;He(this,Ma,{padding:e.padding||w(this,Ma).padding,position:e.position||w(this,Ma).position,iconOnly:e.iconOnly||w(this,Ma).iconOnly,color:e.color||w(this,Ma).color,scale:e.scale||w(this,Ma).scale,onClick:w(this,Ma).onClick,interactive:(r=e.interactive)!=null?r:w(this,Ma).interactive,visible:(i=e.visible)!=null?i:w(this,Ma).visible})}get icon(){return Z5e(this.iconName,this.color,w(this,wp)*w(this,xm).pixelRatio,w(this,zd)*w(this,xm).pixelRatio)}setSize(e,r){w(this,Au)&&(w(this,Au).uniforms.uSize.value.x=e,w(this,Au).uniforms.uSize.value.y=r)}setXY(e,r){w(this,Au)&&(w(this,Au).uniforms.uSize.value.w=e,w(this,Au).uniforms.uSize.value.z=r)}get width(){return w(this,wp)}get height(){return w(this,zd)}getPositionAlignedOffset(e,r){return{"top-left":{x:0,y:0},"top-right":{x:-e,y:0},"bottom-left":{x:0,y:-r},"bottom-right":{x:-e,y:-r},center:{x:-(e/2),y:-(r/2)},top:{x:-(e/2),y:0},bottom:{x:-(e/2),y:-r},left:{x:0,y:-(r/2)},right:{x:-e,y:-(r/2)}}[w(this,Ma).position]}insertIntoQuadTree(e){w(this,i1)!=null&&typeof w(this,Ma).onClick=="function"&&w(this,Ma).interactive&&e.insert(w(this,i1))}resize(e,r){if(w(this,Ma).visible!==!0)return;let i=this.getPositionAlignedCanvasCoordinates(e,r),n=this.getPositionAlignedPadding(),a=this.getPositionAlignedOffset(w(this,wp),w(this,zd)),o=Math.min(e-w(this,wp),Math.max(0,i.x+n.x+a.x)),l=Math.min(r-w(this,zd),Math.max(0,i.y+n.y+a.y));this.setSize(w(this,wp)/e,w(this,zd)/r),this.setXY(o/e,l/r),He(this,i1,new Jc(o,l,w(this,wp),w(this,zd),{entityId:"watermark"}))}update(){this.dirty&&(w(this,Ma).visible===!0?(He(this,wp,Math.min(w(this,xm).canvasWidth,Math.max(this.minWidth,this.defaultWidth*w(this,Ma).scale))),He(this,zd,w(this,wp)/this.aspectRatio),W4.getLoader().load("data:image/svg+xml;base64,".concat(btoa(this.icon)),e=>{if(He(this,Au,new bc({uniforms:{uTexture:{value:e},uSize:{value:new Jn(0,0,0,0)},uOpacity:{value:.7}},vertexShader:Wet,fragmentShader:Xet,depthWrite:!1,depthTest:!1,defines:{debug:xX},wireframe:xX,transparent:!0,visible:!0})),w(this,Fs))w(this,Fs).visible=!0,w(this,Fs).material=w(this,Au),w(this,Fs).material.needsUpdate=!0;else{let r=new pv(2,2,1,1);He(this,Fs,new Tn(r,w(this,Au))),w(this,Fs).position.set(0,0,-1),w(this,Fs).frustumCulled=!1,w(this,Fs).renderOrder=999;let i=new DA(1,1,1),n=new Tn(i,new ug({transparent:!0,opacity:0,depthTest:!1,depthWrite:!1}));n.frustumCulled=!1,n.layers.set(1),w(this,Fs).add(n),w(this,B2).add(w(this,Fs))}this.resize(w(this,xm).canvasWidth,w(this,xm).canvasHeight),this.publish("texture-loaded")})):w(this,Fs)&&(w(this,Fs).visible=!1),this.dirty=!1)}destroy(){w(this,Fs)&&(w(this,B2).remove(w(this,Fs)),El(w(this,Fs))),He(this,Fs,void 0),w(this,Au)&&w(this,Au).dispose(),He(this,Au,void 0),He(this,i1,void 0)}};Ma=new WeakMap,xm=new WeakMap,B2=new WeakMap,Fs=new WeakMap,Au=new WeakMap,i1=new WeakMap,wp=new WeakMap,zd=new WeakMap,s(Y5e,"WatermarkSystem");var ttt=Y5e;N();var xE=100,rtt=!1,K5e=class extends qa{constructor(e,r){super(),$(this,"currentTotalBoundingBox"),$(this,"state"),$(this,"cameraSystem"),$(this,"debugMesh",null),$(this,"dirty",!0),$(this,"autoMinZoomLevel",!0),this.state=e,this.cameraSystem=r}update(){if(this.dirty){this.currentTotalBoundingBox==null&&(this.currentTotalBoundingBox=new to,this.state.entityScene.children.length===0?this.currentTotalBoundingBox.setFromCenterAndSize(new qe(0,0,0),new qe(xE*2,xE*2,0)):(this.currentTotalBoundingBox.setFromObject(this.state.entityScene),this.currentTotalBoundingBox.expandByScalar(xE)));let e=new to().setFromObject(this.state.entityScene);this.currentTotalBoundingBox.union(e);let r=e.getSize(new qe),i=Math.max(r.x,r.y,r.z);for(let a of this.state.geometry2DMap.values())a.positionDirty===!0&&(this.currentTotalBoundingBox.expandByPoint(a.position),a.positionDirty=!1);let n=zD.copy(this.currentTotalBoundingBox).expandByScalar(Math.max(i,xE)).getBoundingSphere(ntt).radius;this.cameraSystem.panBounds={center:this.currentTotalBoundingBox.getCenter(new qe),min:zD.min,max:zD.max,radius:n},this.publish("update"),this.cameraSystem.dirty=!0,this.dirty=!1}}};s(K5e,"PanBoundsSystem");var itt=K5e,zD=new to,ntt=new Ru;N();var bX=" Mappedin",att="https://info.mappedin.com/feedback",wX=["top-left","top-right","bottom-left","bottom-right"],ott=640,stt=s(()=>`<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15' fill-rule='evenodd' viewBox='0 0 20 20'>
						<circle cx='10' cy='10' r='5.9' style='fill:rgba(255,255,255,1);'/>
						<path style='fill:rgba(0,0,0,0.7);' d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/>
					</svg>`,"getAttributionButtonIcon"),UD={custom:[],position:"bottom-right",feedback:!0},J5e=class{constructor(e){$(this,"controlContainerEl"),$(this,"controlPositions"),$(this,"compact"),$(this,"attribContainerEl"),$(this,"attribInnerEl"),$(this,"attribButtonEl"),$(this,"feedbackLinkEl"),$(this,"attribHTML",bX),$(this,"customAttributions",[]),$(this,"toggleAttribution",s(r=>{this.attribContainerEl!=null&&(r.preventDefault(),this.attribContainerEl.classList.contains("mappedin-compact")&&(this.attribContainerEl.classList.contains("mappedin-compact-show")?(this.attribContainerEl.removeAttribute("open"),this.attribContainerEl.classList.remove("mappedin-compact-show")):(this.attribContainerEl.classList.add("mappedin-compact-show"),this.attribContainerEl.setAttribute("open",""))))},"toggleAttribution")),this.controlContainerEl=document.createElement("div"),this.controlContainerEl.classList.add("mappedin-control-container"),e.appendChild(this.controlContainerEl),this.controlPositions=wX.reduce((r,i)=>{let n=document.createElement("div");return n.classList.add("mappedin-ctrl-".concat(i)),this.controlContainerEl.appendChild(n),r[i]=n,r},{})}addAttributionControl(e=UD){var r;let i=e.position&&wX.includes(e.position)?e.position:UD.position;this.attribContainerEl=document.createElement("details"),this.attribContainerEl.classList.add("mappedin-ctrl-attrib","mappedin-ctrl-attrib-".concat(i)),this.attribContainerEl.open=!0,this.attribContainerEl.tabIndex=0,this.attribContainerEl.ariaLabel="Attribution",this.controlPositions[i].appendChild(this.attribContainerEl),this.attribButtonEl=document.createElement("summary"),this.attribButtonEl.addEventListener("click",this.toggleAttribution),this.attribButtonEl.classList.add("mappedin-ctrl-attrib-button"),this.attribButtonEl.title="Toggle attribution",this.attribButtonEl.ariaLabel="Toggle attribution",this.attribButtonEl.tabIndex=0,this.attribButtonEl.innerHTML=stt(),this.attribContainerEl.appendChild(this.attribButtonEl),this.attribInnerEl=document.createElement("div"),this.attribInnerEl.classList.add("mappedin-ctrl-attrib-inner"),this.attribInnerEl.innerHTML=this.attribHTML,this.attribContainerEl.appendChild(this.attribInnerEl),((r=e.feedback)!=null?r:UD.feedback)&&(this.feedbackLinkEl=document.createElement("a"),this.feedbackLinkEl.href=att,this.feedbackLinkEl.target="_blank",this.feedbackLinkEl.rel="noopener",this.feedbackLinkEl.textContent="Provide Feedback",this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner"),this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner-bold"),this.attribContainerEl.appendChild(this.feedbackLinkEl)),e.custom&&(this.customAttributions=e.custom),this.updateAttributionDisplay()}updateAttribution(e){if(!e.style||!this.attribInnerEl||!this.attribContainerEl)return;let r=[bX],i=e.style.sourceCaches;for(let n in i){let a=i[n];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&r.indexOf(o.attribution)<0&&r.push(o.attribution)}}r=r.filter(n=>String(n).trim()),r=r.filter((n,a)=>{for(let o=a+1;o<r.length;o++)if(r[o].indexOf(n)>=0)return!1;return!0}),this.attribHTML=r.join(" "),this.updateAttributionDisplay()}updateAttributionDisplay(){let e=[...new Set([this.attribHTML,...this.customAttributions])].filter(Boolean).join(" ");this.attribInnerEl&&(this.attribInnerEl.innerHTML=e)}resizeAttribution(e){this.attribContainerEl&&(e<=ott||this.compact?this.compact===!1?this.attribContainerEl.setAttribute("open",""):!this.attribContainerEl.classList.contains("mappedin-compact")&&!this.attribContainerEl.classList.contains("mappedin-attrib-empty")&&(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.add("mappedin-compact","mappedin-compact-show")):(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.contains("mappedin-compact")&&this.attribContainerEl.classList.remove("mappedin-compact","mappedin-compact-show")))}destroyAttributionControl(){this.attribButtonEl&&this.attribButtonEl.removeEventListener("click",this.toggleAttribution),this.attribContainerEl&&(this.attribContainerEl.remove(),this.attribContainerEl=void 0,this.attribInnerEl=void 0,this.attribButtonEl=void 0)}resize(e){this.resizeAttribution(e)}updateData(e){this.updateAttribution(e)}destroy(){this.destroyAttributionControl(),this.controlContainerEl.remove(),this.compact=void 0}};s(J5e,"HTMLControlsSystem");var ltt=J5e;N();var AI,SI,Q5e=class{constructor(e,r){$(this,"mesh"),$(this,"type","custom-geometry"),$(this,"dirty",!0),$(this,"feature"),$(this,"builder"),$(this,"outline"),Be(this,AI,1),$(this,"color",new oi),Be(this,SI,0),this.mesh=new cx,this.feature=e,this.builder=r}get visible(){return this.mesh.visible}set visible(e){this.mesh.visible=e}set opacity(e){He(this,AI,e)}get opacity(){return w(this,AI)}setColor(e){this.color.set(e)}get position(){var e;return(e=this.mesh)==null?void 0:e.position}get altitude(){return w(this,SI)}set altitude(e){this.mesh&&(this.mesh.position.z=e,He(this,SI,e))}get renderOrder(){return this.mesh?this.mesh.renderOrder:0}set renderOrder(e){this.mesh&&(this.mesh.renderOrder=e)}};AI=new WeakMap,SI=new WeakMap,s(Q5e,"CustomGeometryComponent");var VD=Q5e;N();var eLe=class{constructor(e,r){$(this,"state"),$(this,"convertTo3DMapPosition"),this.state=e,this.convertTo3DMapPosition=r}update(){let e,r;for(let i of this.state.geometry3DIdsInScene){let n=this.state.geometry3DMap.get(i);(n==null?void 0:n.type)==="custom-geometry"&&(e=n.components[0],r=n.components[1],e.dirty&&r.visible!==!1&&(e.position.copy(this.convertTo3DMapPosition(e.feature.geometry.coordinates[1],e.feature.geometry.coordinates[0],r.altitude)),e.builder.setup(e.mesh),e.mesh.traverse(a=>{a.userData={entityId:i,type:"custom-geometry"}}),e.dirty=!1),r.visible!==!1&&e.builder.update(e.mesh))}}};s(eLe,"CustomGeometrySystem");var utt=eLe;N();N();function tLe(t){return t.children.some(e=>e.userData.isOutline)}s(tLe,"hasOutline");var ctt=80,n1,z2,vN,_N,rLe=class{constructor(e){$(this,"rendererState"),$(this,"outlineOpacitiesDirty",!0),Be(this,n1,!0),Be(this,z2,-1/0),Be(this,vN,new Map),Be(this,_N,new wB({vertexColors:!0,linewidth:1,transparent:!0,opacity:1,side:Qp})),this.rendererState=e}get geometries3DDirty(){return w(this,n1)}set geometries3DDirty(e){He(this,n1,e)}update(e,r=!0){let i;if(this.geometries3DDirty){for(let a of this.rendererState.geometry3DMap.values())if(a instanceof Yn&&(a.visible||a.userData.preloadGeometry)){for(let o of a.children)if(o instanceof Fu&&o.components[0].outline&&(o.visible||a.userData.preloadGeometry)&&!tLe(o)&&o.userData.entities3D.size>0)for(let l of o.userData.entities3D.values()){let u=this.rendererState.geometry3DMap.get(l),c=[];if(u instanceof za&&u.type==="geometry"&&u.components[3]&&u.components[3].dirty===!0&&u.components[0].geometry!=null&&u.components[0].material!=null){let M=u.components[0].geometry;if(!M)continue;c.push([u.components[3],new VVe(M,ctt)])}if(c.length===0)continue;let p=fv(c.map(M=>M[1]),!1);if(p==null)continue;let m=p.getAttribute("position"),y=new Float32Array(m.count*4),v=new Zo(y,4);p.setAttribute("color",v);let x=0;for(let M=0;M<c.length;M++){let[I,P]=c[M],C=P.getAttribute("position").count;I.edgeColors=v,I.geometry=p,I.ranges={count:C,start:x},x+=C,P.dispose()}let E=new kP(p,w(this,_N));E.userData.isOutline=!0,o.add(E)}}He(this,n1,!1),this.outlineOpacitiesDirty=!0}for(let a of this.rendererState.geometry3DIdsInScene){let o=this.rendererState.geometry3DMap.get(a);if(o instanceof za&&o.type==="geometry"&&o.components[3]&&o.components[3].dirty===!0&&o.components[0].geometry!=null&&o.components[0].material!=null&&o.parentObject3D instanceof Fu){let l=o.components[3].geometry;if(!l)continue;let u=o.components[3];if(!u)continue;let c=u.edgeColors;if(!c)continue;let p=new oi(u.color);for(let x=0;x<u.ranges.count;x++){let E=u.ranges.start+x;c.setXYZ(E,p.r,p.g,p.b)}let m=o.components[1].height,y=l.getAttribute("position").array,v=-1/0;for(let x=0;x<u.ranges.count;x++){let E=(u.ranges.start+x)*3,M=y[E+2];v=Math.max(v,M)}for(let x=0;x<u.ranges.count;x++){let E=(u.ranges.start+x)*3,M=y[E+2];Math.abs(M-v)<1e-4&&(y[E+2]=Math.max(m,2e-4))}l.attributes.color.needsUpdate=!0,l.attributes.position.needsUpdate=!0,u.dirty=!1}}let n=r?Yy(e,16,19,0,1):w(this,z2);if((n!==w(this,z2)||this.outlineOpacitiesDirty)&&this.rendererState.geometry3DIdsInScene.size>0){for(let a of this.rendererState.geometry3DIdsInScene)if(i=this.rendererState.geometry3DMap.get(a),(i==null?void 0:i.type)==="geometry"&&i.components[0]instanceof tu){let o=i.components[3];if(o&&o.edgeColors&&o.geometry){let l=o.visible,u=Math.min(n,l?i.components[1].opacity*Ow(i):0);if(o.currentOpacity!==u){for(let c=0;c<o.ranges.count;c++){let p=o.ranges.start+c;o.edgeColors.setW(p,u)}o.geometry.attributes.color.needsUpdate=!0}}}}He(this,z2,n),He(this,n1,!1),this.outlineOpacitiesDirty=!1}destroy(){w(this,vN).clear()}};n1=new WeakMap,z2=new WeakMap,vN=new WeakMap,_N=new WeakMap,s(rLe,"OutlineInterpolationSystem");var htt=rLe;N();N();var iLe=class extends Tn{constructor(){super(...arguments),$(this,"userData",{entityId:""})}};s(iLe,"EntityMesh");var ptt=iLe,dtt=xt.object({flipImageToFaceCamera:xt.boolean().optional(),url:xt.string()}),ftt=xt.object({type:xt.enum(["Feature"]),properties:xt.object({width:xt.number(),height:xt.number(),rotation:xt.number().min(0).max(360).optional(),verticalOffset:xt.number().optional()}),geometry:vj});function nLe(t,e,r){xt.union([xt.number(),xt.string()]).parse(t),ftt.parse(e),dtt.parse(r)}s(nLe,"validateImage");var aLe=class{constructor(e){$(this,"mesh",new cx),$(this,"imageMesh"),$(this,"outline"),$(this,"type","image"),$(this,"instanceIndex",-1),$(this,"geometry"),$(this,"material"),$(this,"feature"),$(this,"position",new qe),this.feature=e}get visible(){var e,r;return(r=(e=this.mesh)==null?void 0:e.visible)!=null?r:!1}set visible(e){this.mesh&&(this.mesh.visible=e)}};s(aLe,"ImageComponent");var mtt=aLe;N();function $3(t,e){return{x:t.x*Math.cos(e)-t.y*Math.sin(e),y:t.x*Math.sin(e)+t.y*Math.cos(e)}}s($3,"rotatePoint");function oLe(t,e){return t.map(r=>$3(r,e))}s(oLe,"rotatePoints");function sLe(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let a of t)e=Math.min(e,a.x),r=Math.min(r,a.y),i=Math.max(i,a.x),n=Math.max(n,a.y);return{minX:e,minY:r,maxX:i,maxY:n}}s(sLe,"getBounds");function lLe(t,e){let r=!1;for(let i=0,n=e.length-1;i<e.length;n=i++){let a=e[i].x,o=e[i].y,l=e[n].x,u=e[n].y;o>t.y!=u>t.y&&t.x<(l-a)*(t.y-o)/(u-o)+a&&(r=!r)}return r}s(lLe,"pointInPolygon");function xj(t,e,r,i,n){for(let a=0;a<n;a++)for(let o=0;o<i;o++)if(t[r+a][e+o]!==1)return!1;return!0}s(xj,"isValidRectangle");function uLe(t,e,r){let i=t.maxX-t.minX,n=t.maxY-t.minY,a,o,l=Ee({},t);return i/n>e?(o=n/r,a=o*e,l.minX+=(i-a*r)/2):(a=i/r,o=a/e,l.minY+=(n-o*r)/2),{dx:a,dy:o,gridBounds:l}}s(uLe,"calculateGridDimensions");function cLe(t,e,r,i,n){let a=Array(r).fill(0).map(()=>Array(r).fill(0));for(let o=0;o<r;o++)for(let l=0;l<r;l++){let u={x:e.minX+l*i,y:e.minY+o*n};lLe(u,t)&&(a[o][l]=1)}return a}s(cLe,"createAndFillGrid");function hLe(t,e){let r=Array(e).fill(0).map(()=>Array(e).fill(0));for(let i=0;i<e;i++)for(let n=0;n<e;n++)if(t[i][n]===1){let a=0;for(let o=1;o<=Math.min(e-n,e-i)&&xj(t,n,i,o,o);o++)a=o;r[i][n]=a}return r}s(hLe,"calculateRectSizes");function pLe(t,e,r,i,n,a){let o=0,l=0,u=0;for(let c=0;c<i;c++)for(let p=0;p<i;p++)if(t[c][p]===1){let m=Math.pow(e[c][p],2),y=r.minX+p*n,v=r.minY+c*a;o+=m,l+=y*m,u+=v*m}return{x:l/o,y:u/o}}s(pLe,"calculatePolygonCenter");function dLe(t,e,r,i,n,a,o){let l=-1/0,u=null,c=t.length,p=Math.sqrt(Math.pow(e.maxX-e.minX,2)+Math.pow(e.maxY-e.minY,2));for(let m=0;m<c;m++)for(let y=0;y<c;y++)if(t[m][y]===1)for(let v=1;v<=c-y;v++){let x=v;if(!(x>c-m)&&xj(t,y,m,v,x)){let E=v*x,M=e.minX+(y+v/2)*r,I=e.minY+(m+x/2)*i,P={x:M,y:I},C=Math.sqrt(Math.pow(P.x-n.x,2)+Math.pow(P.y-n.y,2))/p,T=E*(1-a)-C*a*E;T>l&&(l=T,u={center:P,width:v*r*o,height:v*i*o})}}return u}s(dLe,"findBestRectangle");function xN(t,e,r,i={}){let{scaleFactor:n=.9,centerPriority:a=.5,resolution:o=100,minimumSizeRatio:l=.5}=i,u=Vp(r),c=t.width/t.height,p=oLe(e,u),m=sLe(p),{dx:y,dy:v,gridBounds:x}=uLe(m,c,o),E=cLe(p,x,o,y,v),M=hLe(E,o),I=pLe(E,M,x,o,y,v),P=dLe(E,x,y,v,I,a,n);return!P||P.width<t.width*l||P.height<t.height*l?t:vt(Ee({},P),{center:$3(P.center,-u),rotation:r,polygonCenter:$3(I,-u)})}s(xN,"findLargestInteriorRectangle");var Gb=Math.PI*2,gtt=Math.PI/2,ytt=Math.PI*1.5,vtt=zA(gtt,2),_tt=zA(ytt,2),xtt=.01,btt=!1,fLe=class extends qa{constructor(e,r,i=0,n=0,a={}){super(),$(this,"rendererState"),$(this,"convertTo3DMapPosition"),$(this,"initialBearing",0),$(this,"naturalBearing",0),$(this,"imagePlacementOptions"),$(this,"imageLoadingCache",new Map),this.rendererState=e,this.convertTo3DMapPosition=r,this.initialBearing=i,this.naturalBearing=n,this.imagePlacementOptions=a}createImageMesh(e,r,i,n=0,a,o){var l,u,c;let p={width:i.width,height:i.height,center:this.convertTo3DMapPosition(a),rotation:(l=i.rotation)!=null?l:0},m=(u=this.imagePlacementOptions.mode)!=null?u:"default",y=(()=>{switch(m){case"fit-nearest-90":let M=(this.initialBearing-this.naturalBearing+360)%180;return M>=45&&M<=135?xN(p,o,p.rotation+90,this.imagePlacementOptions):p;case"fit-initial-bearing":return xN(p,o,this.initialBearing,this.imagePlacementOptions);case"default":case"none":default:return p}})(),v=new R_({transparent:!0,depthWrite:!1,side:Pu}),x=new pv(y.width,y.height),E=new ptt(x);return E.visible=!1,(c=this.getOrDownloadImage(r))==null||c.then(M=>{v.map=M,v.needsUpdate=!0,v.map.colorSpace=il,E.visible=!0,this.publish("image-loaded")}),E.userData.entityId=e,E.material=v,E.position.set(y.center.x,y.center.y,n+xtt),E.rotation.z=(-$n.degToRad(y.rotation)+Gb)%Gb,E}getOrDownloadImage(e){var r;if(this.imageLoadingCache.has(e))return(r=this.imageLoadingCache.get(e))==null?void 0:r.promise;{let i=new Promise(n=>{W4.getLoader().load(e,a=>{let o=this.imageLoadingCache.get(e);o&&!o.loaded&&(o.loaded=!0),n(a)})});return this.imageLoadingCache.set(e,{loaded:!1,promise:i}),i}}flipIfNeeded(e,r){if(e.imageMesh==null)return;let i=-r,n=e.imageMesh.rotation.z,a=zA((n-i+Gb)%Gb,2);a>vtt&&a<_tt&&(e.imageMesh.rotation.z=(n+Math.PI)%Gb)}update(e){var r,i,n,a,o;let l,u,c;for(let p of this.rendererState.geometry3DIdsInScene)if(l=this.rendererState.geometry3DMap.get(p),(l==null?void 0:l.type)==="image"){if(u=l.components[0],c=l.components[1],c.url&&u.imageMesh==null){let m=this.convertTo3DMapPosition(u.feature.geometry.coordinates),y={x:m.x,y:m.y};u.imageMesh=this.createImageMesh(l.id,c.url,u.feature.properties,u.feature.properties.verticalOffset,u.feature.geometry.coordinates,[y]),u.mesh.add(u.imageMesh),u.position.copy(u.imageMesh.position)}u.imageMesh&&c.flipImageToFaceCamera&&this.flipIfNeeded(u,e)}else if((l==null?void 0:l.type)==="geometry"){if(u=l.components[0],c=l.components[1],c.showImage&&(r=u.feature.properties)!=null&&r.image&&u.imageMesh==null&&u.visible&&u.mesh!=null&&u.mesh.parent!=null&&((i=u.feature.properties)==null?void 0:i.image.position)!=null&&u.feature.geometry.coordinates!=null&&u.feature.geometry.coordinates.length>0){let m=u.feature.geometry.coordinates[0].map(v=>{let x=this.convertTo3DMapPosition(v);return{x:x.x,y:x.y}}),y=this.createImageMesh(p,(n=u.feature.properties)==null?void 0:n.image.path,(a=u.feature.properties)==null?void 0:a.image,c.height,(o=u.feature.properties)==null?void 0:o.image.position,m);u.mesh.parent.add(y),u.imageMesh=y}if(u.imageMesh){if(!u.visible)u.imageMesh.visible=!1;else if(c.showImage&&!u.imageMesh.visible)if(c.url){let m=this.imageLoadingCache.get(c.url);m&&m.loaded&&(u.imageMesh.visible=!0)}else u.imageMesh.visible=!0;else!c.showImage&&u.imageMesh.visible&&(u.imageMesh.visible=!1);c.flipImageToFaceCamera&&this.flipIfNeeded(u,e)}}}};s(fLe,"ImageSystem");var wtt=fLe;N();var Att=250,ty,mLe=class extends qa{constructor(e,r){super(),$(this,"cameraDirty",!0),$(this,"focusablesDirty",!0),$(this,"state"),$(this,"camera"),$(this,"debugEl",null),$(this,"raycasters",[]),$(this,"collisions",new Map),$(this,"focusableEntities",new Set),$(this,"debugRaycasters",!1),Be(this,ty),$(this,"update",s((i=!1,n=Date.now())=>{i||Date.now()-n>Att||(w(this,ty)&&cancelAnimationFrame(w(this,ty)),He(this,ty,requestAnimationFrame(()=>{this.updateRaf()})))},"update")),this.state=e,this.camera=r,this.buildRaycasters()}resize(){this.buildRaycasters()}buildRaycasters(){this.debugEl&&this.debugEl.remove();let e=new Jt(this.state.canvasWidth/2,this.state.canvasHeight/2),r=new Jt(e.x/1.2,e.y/1.2),i=new Jt(e.x+(e.x-r.x),r.y),n=new Jt(r.x,e.y+(e.y-r.y)),a=new Jt(i.x,n.y),o=new Jt(e.x,e.y/1.5),l=new Jt(e.x,e.y+(e.y-o.y));this.debugEl=document.createElement("div"),Object.assign(this.debugEl.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"}),document.body.append(this.debugEl),this.raycasters=[e,o,l,r,i,n,a].map((u,c)=>{if(this.debugRaycasters){let x=document.createElement("div");x.style.position="absolute",x.style.top=u.y+"px",x.style.left=u.x+"px",x.style.width="10px",x.style.height="10px",x.style.backgroundColor="red",this.debugEl.append(x)}let p=u.x/this.state.canvasWidth*2-1,m=-(u.y/this.state.canvasHeight)*2+1,y=new Jt(p,m),v=new FA;return v.setFromCamera(y,this.camera),[v,y,c===0?10:c<7?2:1]})}updateFocusableEntities(){this.focusableEntities.clear();let e,r;for(let i of this.state.geometry3DIdsInScene)if(r=this.state.geometry3DMap.get(i),r!=null){if(r.type==="group-container"&&r.components[2]!==void 0&&r.components[2]instanceof H4e){let n=r.components[2];if(n.dirty===!0||n.focusMesh==null){n.focusMesh&&El(n.focusMesh);let a=new to;a.setFromObject(r);let o=new DA(a.max.x-a.min.x,a.max.y-a.min.y,a.max.z-a.min.z),l=new ug({transparent:!0,opacity:this.debugRaycasters?1:0,visible:this.debugRaycasters}),u=new Tn(o,l);u.position.set((a.min.x+a.max.x)/2,(a.min.y+a.max.y)/2,(a.min.z+a.max.z)/2),u.userData={entityId:r.userData.entityId},n.focusMesh=u,r.add(u),r.components[2].dirty=!1}this.focusableEntities.add(n.focusMesh)}else if(r.components[0]&&r.components[0]instanceof tu&&r.components[0].focusable&&r.components[0].geometry!=null&&(e=r.components[0],e instanceof tu&&e.focusable&&e.geometry!=null)){if(e.focusMesh==null){let n=new Tn(e.geometry);n.userData={entityId:r.id},e.focusMesh=n}this.focusableEntities.add(e.focusMesh)}}this.focusablesDirty=!1}updateRaf(){if(this.cameraDirty){if(this.focusablesDirty&&this.updateFocusableEntities(),this.focusableEntities.size===0){this.publish("geometry-in-focus",[]);return}this.raycast()}}raycast(){this.collisions.clear();for(let[r,i]of this.raycasters)r.setFromCamera(i,this.camera);for(let[r,i,n]of this.raycasters)r.intersectObjects(Array.from(this.focusableEntities.values())).forEach(a=>{var o;if((a==null?void 0:a.object)!=null&&"isMesh"in a.object&&a!=null&&a.object.isMesh){let l=a.object.userData.entityId,u=(o=this.collisions.get(l))!=null?o:0;this.collisions.set(l,u+n)}});let e=Array.from(this.collisions,([r,i])=>({entityId:r,weight:i})).sort((r,i)=>i.weight-r.weight).map(({entityId:r})=>r);this.publish("geometry-in-focus",e),this.cameraDirty=!1}showRaycasters(){this.debugRaycasters=!0,this.buildRaycasters()}hideRaycasters(){this.debugRaycasters=!1,this.buildRaycasters()}destroy(){w(this,ty)&&cancelAnimationFrame(w(this,ty)),this.debugEl&&this.debugEl.remove(),this.collisions.clear(),this.focusableEntities.clear(),this.raycasters=[]}};ty=new WeakMap,s(mLe,"GeometryInFocusSystem");var Stt=mLe;N();var AX=20,Mtt=5e3,Th,MI,EI,ry,a1,o1,bN,CI,gLe=class{constructor(e){$(this,"dirty",!0),$(this,"map"),$(this,"stylesheetId",""),$(this,"userHiddenLayers",new Set),$(this,"hiddenLayersInStyle",new Set),$(this,"centerPoint"),$(this,"bbox"),$(this,"polygons"),Be(this,Th,null),Be(this,MI,s(()=>{w(this,Th)&&(clearTimeout(w(this,Th)),He(this,Th,null),this.dirty=!1)},"#stopTrying")),Be(this,EI,s(()=>{w(this,Th)&&(clearTimeout(w(this,Th)),He(this,Th,null)),He(this,Th,setTimeout(()=>{w(this,MI).call(this)},Mtt))},"#startTrying")),$(this,"handleRender",s(async()=>{if(!(!this.map||!this.dirty)&&!(!this.hiddenLayersInStyle||this.hiddenLayersInStyle.size===0)){if(w(this,ry)&&(w(this,bN).call(this),He(this,ry,!1)),this.centerPoint){let r=this.map.project(this.centerPoint),i=this.map.queryRenderedFeatures(r,{layers:Array.from(this.hiddenLayersInStyle)});if(i.length>0){for(let n of i)this.expr.push(["!=",["id"],n.id]);this.expr.length>0&&this.hiddenLayersInStyle.forEach(n=>{this.map.setFilter(n,["all",...this.expr])}),this.expr=[],He(this,ry,!1),this.dirty=!1}}else if(this.bbox&&this.polygons){let r=this.map.queryRenderedFeatures([this.map.project([this.bbox[0],this.bbox[1]]),this.map.project([this.bbox[2],this.bbox[3]])],{layers:Array.from(this.hiddenLayersInStyle)});if(r.length>0){He(this,ry,!0);for(let i=0;i<r.length;i+=AX){let n=r.slice(i,i+AX);w(this,a1).push(()=>{for(let a of n)if(a.geometry!=null&&"coordinates"in a.geometry){if(this.polygons==null)return;let o;if(a.geometry.type==="Polygon"?o=l_(a.geometry.coordinates):a.geometry.type==="MultiPolygon"&&(o=Wme(a.geometry.coordinates)),!o)continue;for(let l of this.polygons)if(Xye(l,o)){this.expr.push(["!=",["id"],a.id]);continue}}})}w(this,CI).call(this)}}}},"handleRender")),$(this,"expr",[]),Be(this,ry,!1),Be(this,a1,[]),Be(this,o1,null),Be(this,bN,s(()=>{w(this,o1)&&(globalThis.cancelAnimationFrame(w(this,o1)),He(this,o1,null)),He(this,a1,[])},"#cancelJobs")),Be(this,CI,s(()=>{let r=w(this,a1).pop();typeof r=="function"&&(r(),w(this,a1).length>0&&He(this,o1,globalThis.requestAnimationFrame(w(this,CI)))),this.expr.length>0&&(this.hiddenLayersInStyle.forEach(i=>{this.map.setFilter(i,["all",...this.expr])}),this.dirty=!1),this.expr=[],He(this,ry,!1),w(this,MI).call(this)},"#runJobs")),$(this,"handleStyleChange",s(r=>{var i,n;if(this.map&&r&&r.dataType==="style"&&r.type==="styledata"&&this.userHiddenLayers.size>0){let a=(n=(i=r==null?void 0:r.style)==null?void 0:i.stylesheet)==null?void 0:n.id;(!a||a!==this.stylesheetId)&&(this.stylesheetId=a,this.filterStylesInMap(),this.dirty=!0)}},"handleStyleChange")),e&&(this.map=e,this.map.on("styledata",this.handleStyleChange),this.map.on("render",this.handleRender))}hideLayersUnderPoint(e,r){w(this,EI).call(this),this.centerPoint=e;for(let i of r)this.userHiddenLayers.add(i);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}hideLayersIntersectingPolygons(e,r,i){w(this,Th)&&clearTimeout(w(this,Th)),w(this,EI).call(this),this.bbox=e,this.polygons=r.reduce((n,a)=>{if(a.geometry.type==="Polygon"){let o=l_(a.geometry.coordinates);n.push(o)}else a.geometry.type==="MultiPolygon"&&n.push(...a.geometry.coordinates.map(o=>l_(o)));return n},[]);for(let n of i)this.userHiddenLayers.add(n);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}filterStylesInMap(){if(this.hiddenLayersInStyle=new Set,this.map)for(let e of this.userHiddenLayers)this.map.getLayer(e)&&this.hiddenLayersInStyle.add(e)}destroy(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("render",this.handleRender))}};Th=new WeakMap,MI=new WeakMap,EI=new WeakMap,ry=new WeakMap,a1=new WeakMap,o1=new WeakMap,bN=new WeakMap,CI=new WeakMap,s(gLe,"OutdoorLayers");var Ett=gLe;N();N();N();N();var jD=`attribute float pathDistance;
attribute vec3 pathNormal;
attribute vec3 pathTangent;

uniform vec2 uvScale;
uniform float vertexes;
uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform float nearZoom;
uniform float farZoom;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform vec2 cameraParameters;
uniform float flattenFactor;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping y = mx + b where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main() {
	fragPathDistance = pathDistance;

	// We can get an origin point for the cross-section of the path by
	// subtracting the surface normal times the radius, since the surface normal
	// points strictly away from the centre.
	vec3 origin = position - nearRadius * normal;

	// Inflate the path along its surface normal to increase its radius from
	// 'nearRadius' to 'farRadius' when the camera is at 'farZoom'.
	vec3 adjustedPosition = position;
	zoomLevel = clampRemap(cameraParameters.x, nearZoom, farZoom, 0.0, 1.0);
	adjustedPosition += normal * (farRadius - nearRadius) * zoomLevel;

	// Determine how far the path extends "up" or "down" in the direction of the
	// path normal.
	float height = dot(adjustedPosition - origin, pathNormal);

	// Flatten the bottom half of the path entirely so that it's flat
	// against the floor. This makes the path look nicer when it's
	// semitransparent behind opaque geometry, so you don't see it
	// peeking through.
	float desiredHeight = max(height, 0.0);

	desiredHeight = desiredHeight * flattenFactor;

	float flattenMagnitude = height - desiredHeight;
	adjustedPosition = adjustedPosition - pathNormal * flattenMagnitude;

	// Transform the vertices into NDC.
	vec4 mvPosition = modelViewMatrix * vec4(adjustedPosition, 1.0);
	gl_Position = projectionMatrix * mvPosition;

	fragTexcoord = uv;

	// Compute a texture coordinate for mapping the arrow texture to the path.
	// We don't want to use the u-value that Three.js provides, because the
	// path may end up twisting arbitrarily -- but we want the arrow texture to
	// always be on the top of the path.
	vec3 bitangent = cross(normal, pathTangent);
	fragTopTextureU = -dot(bitangent, pathNormal) * 0.5 + 0.5;

	radius = mix(nearRadius, farRadius, zoomLevel);
}
`;N();var SX=`#define ARROW_FADING_POINT 0.15

uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform vec2 resolution;
uniform vec2 cameraParameters;
uniform vec3 color;
uniform float pathLength;
uniform bool showPulse;
uniform vec3 pulseColor;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform float arrowAnimationTimer;
uniform float opacityMultiplier;
uniform bool dashed;
uniform sampler2D arrowTexture;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// How long the arrow should be, as a factor of pathRadius. Since we've
// mostly flattened the top of the path, values near 2.0 (the diameter)
// will probably look best.
const float arrowLength = 2.0;

// How much of a relative margin the arrow texture should have inside the
// area laid out for it. Useful to pull the arrow away from the edges of the
// path, which slope down.
const float arrowMargin = 0.1;

// How many arrow-lengths of space should be between arrows on a short path.
const float arrowSpacingOnShortPath = 6.0;

// How many arrow-lengths of space should be between arrows on a long path.
const float arrowSpacingOnLongPath = 7.5;

// How long a path must be to be considered "long", as a factor of
// the path radius.
const float longPathLength = 200.;

// How long a path must be to be considered "short", as a factor of the
// path radius.
const float shortPathLength = 75.;

// How much of the path's length the fade-in should comprise when going from
// zero opacity to full opacity.
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping 'y = mx + b' where
// 'm = (yMax - yMin) / (xMax - xMin)',
// 'b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin'.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// Compute the opacity of the path based on the distance from the current
	// fragment to the 'complete' value as it varies from 0.0 to 1.0.
	// Fragments that are at the 'complete' value or past it will be fully
	// transparent, while fragments that are at 'complete - completeLength'
	// or before it will be fully opaque. However, we adjust the 'complete'
	// value here so that it overshoots by one full 'completeLength', so that
	// the entire path will be opaque when the 'complete' value is at 1.0.
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	// Push in the texture coordinates so that they ramp up
	// at 'arrowMargin' instead of at zero; this remapping looks somewhat
	// like this:
	// 1 ^        ___
	//   |       /
	//   |      /
	//   |     /
	//   |    /
	//   |___/
	// 0 +---------->
	//   0   ^      1
	//       arrowMargin
	// Making the arrows narrower on the path.
	float u = fragTopTextureU;
	u = clamp(
		u * (1. / (1. - arrowMargin * 2.)) - (1. / (1. - arrowMargin * 2.) - 1.) / 2.,
		0.0,
		1.0
	);

	float arrowSpacing = clampRemap(
		pathLength,
		shortPathLength * radius,
		longPathLength * radius,
		arrowSpacingOnShortPath,
		arrowSpacingOnLongPath
	);

	// Reduce the spacing between arrows when the camera zooms out, as increasing
	// the path radius will increase the arrow size and thus be able to fit
	// fewer arrows on in total, and this secondary movement of the arrows
	// "zooming off" the end of the path is unpleasant
	float expandAmount = mix(1.0, farRadius / nearRadius, zoomLevel);
	float effectiveArrowSpacing =
		arrowSpacing * 1.0 / expandAmount +
		arrowMargin * 2.0;

	float effectiveArrowLength = arrowLength * radius * (1. - arrowMargin * 2.0);

	// Adjust the slope of the vertical texture coordinate so that it goes
	// from 0 to 1 along the length of the arrow plus the spacing between
	// arrows, and adjust its x-intercept so that one arrow moves to the
	// exact position of the next arrow as 'arrowAnimationTimer' goes
	// from 0 to 1
	float v = (
		fragTexcoord.x * (pathLength / effectiveArrowLength)
		- arrowAnimationTimer * (1. + effectiveArrowSpacing)
	);

	// Compute a "looping sawtooth" wave for determining the vertical texture
	// coordinates of the arrow texture, roughly as follows:
	// 3 ^              /
	//   |          ___/
	// 2 |         /
	//   |     ___/
	// 1 |    /
	//   |___/
	// 0 +--------------->
	//   0   ^ ^
	//   ^   |_|
	//   |   effectiveArrowLength
	//   |___|
	//   effectiveArrowSpacing
	//
	// This is effectively equivalent to this sort of sawtooth wave:
	//   ^
	// 1 |    /    /    /
	//   |___/ ___/ ___/
	// 0 +--------------->
	//
	// Causing the image of the arrow to repeat, with dead space (the bottom
	// edge of the texture stretched out) between the arrows at the provided
	// spacing. The reason why the "looping" design is preferred is because
	// it takes advantage of WebGL's 'GL_REPEAT' texture wrapping behaviour
	// to avoid the discontinuity that can end up causing visual artifacts.
	if (mod(v, (1. + effectiveArrowSpacing)) < 1.) {
		v = v - effectiveArrowSpacing * floor(v / (1. + effectiveArrowSpacing));
	} else {
		v = ceil(v / (1. + effectiveArrowSpacing));
	}

	// Use the r-component of the texture to determine whether the arrow covers
	// this fragment or not
	vec2 sampleTexcoord = vec2(u, v);
	float arrowAmount = 0.0;
	vec3 secondColor = pulseColor;

	if (displayArrowsOnPath) {
		arrowAmount = texture2D(arrowTexture, sampleTexcoord).r;
		float delta = 1.0 - abs(fragPathDistance * 2.0 - 1.0);
		secondColor = mix(color, pulseColor, 1.0 - smoothstep(ARROW_FADING_POINT, 0.0, delta));
	}

	if (dashed) {
		float dashLength = 0.1; // Adjust this value to change the dash length
		float gapLength = 0.1; // Adjust this value to change the gap length
		float totalLength = dashLength + gapLength;
		float numSegments = ceil(1.0 / totalLength);
		float adjustedTotalLength = 1.0 / numSegments;
		float adjustedDashLength = adjustedTotalLength * (dashLength / (dashLength + gapLength));
		float pattern = mod(fragPathDistance, adjustedTotalLength);
		opacity = pattern < adjustedDashLength ? 1.0 : 0.0;
	}


	if (showPulse) {
		// Add the pulse color to the path by determining how far the current fragment
		// is from 'pulse'
		float pulseLocation = remap(
		pulse,
		0.0,
		1.0,
		-pulseLength,
		1.0 + pulseLength
		);
		float pulseDistance = smoothstep(
		0.0,
		pulseLength,
		abs(fragPathDistance - pulseLocation)
		);

		// Blend the pulse color to the path based on how close this fragment is to
		// the 'pulse' value and whether it's covered by an arrow -- but if it's
		// covered by *both*, then we go back to using the regular path color
		// (making arrows look like "holes" when they're overlapping the pulse.)
		float pulseLevel = abs(1.0 - pulseDistance - arrowAmount);

		gl_FragColor = vec4(mix(color, secondColor, pulseLevel), opacity * opacityMultiplier);
	} else if (displayArrowsOnPath) {
		gl_FragColor = vec4(mix(color, pulseColor, arrowAmount), opacity * opacityMultiplier);
	} else {
		gl_FragColor = vec4(color, opacity * opacityMultiplier);
	}
	#include <colorspace_fragment>
}
`;N();var Ctt=`void main(void) {
	gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
}`,Itt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAQkHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZpZciQ7rkT/uYpeAicQ5HI4mr0dvOX3ATOl0li3q3SVJkUqFMEBcHc4IuX2///fcf/hK7cSXRatpZXi+cott9h5U/3j63EMPt+fL1/h+fPdeff6NnJMHNPjD2U/7+qcl183aH6eH+/PO52PN7E+B3qZ+Tlgspkjb57X1edAKT7Oh+fvrj3v6/nNdp7ftd057abHnz78npVgLGG8FF3cKSTPz2oXJFaQWuocCz9D0mhnEu8Tx54k6dexc98F77vY+f48n96HwvnyvKB8iNHzfJCvY3cj9HZF4dfM7/6QZ4j+7deb2J2z6jn7sbueC5Eq7rmpl63cd1w4GCrd2wov5Vt4r/fVeFW2OMnYIpuD13ShhUi0T8hhhR5O2Pc4w2SJOe5IuGOMM6Z7rhL+FudNSrZXOFFJz3KpkqtJ1hKn4+tawp233flmqMy8AlfGwGCBOz693Fcn/+b1OtA5Bt0QfH2NFeuKFnCWYZmzn1xFQsJ5xlRufO/LvcGNf5PYRAblhrmywe7HY4gh4Re20s1z4jrx2fkHNYKu5wCEiLmFxYREBnwJSUIJXmPUEIhjJT+dlceU4yADQSSu4A65SamQnBptbu7RcK+NEh+nkRYSIZBGSQ0EIlk5C/jRXMFQlyTZiUgRlSpNekklFymlaDGN6po0q2hR1apNe001V6mlaq211d5iS0iYtNLUtdpa651JO0N37u5c0fuII408ZJSho442+gQ+M0+ZZeqss82+4koL+q+y1K262uo7bKC085Zdtu662+4HrJ108pFTjp562umvWXtm9X3WwofM/T5r4Zk1y1i+1+mvrHFa9WWIYHIiljMyFnMg42oZANDRcuZryDla5ixnvkVIIZGsBbHkrGAZI4N5hygnvObuV+Z+mzcn+Y/yFr/LnLPU/RuZc5a6Z+Y+5+2LrK1+K0q6CTIWWkx9OggbF+zaY+1Wk/766H46wF8ONFY+O8hBMEc7oc4Vdh+8JsE+PUSrVjr70Zz1+H56PH3o9sRR1ql5Ha8bUMQxpe89Tki8Sb0tE23cw3DcfEo+ugnj2G3WEmononVfoag71pVjR+EmAE53eT5tqYfEHl/7ThMusaI+St0jktFa9gKnreiQqCNpZ2mJdSkbaiK6DrovYR4/JhJfRsx5d5EVZnEIPetHnU5KynJPTSuCPuC0lOuXH7n1DNq7DpUtHbhM5lDA0c2bnDCJoOObMnyj+aPjPwx0yiDUxKKsg35VnRnBEVhonKwK5hOk5NttUrhr2+tMOXkPJb1RZ+iAelYjL2MuO3pGRQ78GdxwOOaTAcJZcewq7ilB1RJCSozUdSEdwVJVb6asiBsHH1Bqgbiv3Cmkkis6ktVnZGRRwMNJjUA3Ao2127YWdhAIblxF51hzMcZsVZc0r0dJo5Liqfn41Q+q193SGhhkMkgaLJRNnEpqBtyVvbcVffIk+LE9QPFBTMTQe0aWkMXMnx3dy5sfHreDE60Ql50E+SqRcmfK16L2p0Ol8JFATu3qASXy7SvmiGW2cdMBxsty44CvtLogfGlv7WkCSV0WId2270EaD5Ym40cs+SAwZuNjPSTywAvEfLmzQhtLDntfCnhl/fNmUNnzyA2g76Zn0SP+c+I6bCC0FONUQ4L50e95dif+DH/m9htQjBEhPPpOjYjmm2ChbfEMIUaYtAIxmWJHlilLU8ZRs9pCsHbDpFaRgZljz2QandjDIBPZDGTuoZW1KdlYh52ALzisKJRNWSQmLAWx8iv9mGttT15bBc2oxd57bZtVF98CYtK3UH22Yd/A7WaKa+ZjNTOXEzNhMJ5kmQOvfzsbxbZALJ2xwGBjX2HFQybhi7kpbA7DVpS3RxMJwFyHwGk5gs6a4lrRHVqhYT0QTJC9UZcC9Yrelkn6yXch68NKNtG7CiU3vf/zMZAYXPWdrR9XZ/ctMV1sJQ2wJEGxzaHs7LmmHIwnUwbwnNAapBY9xhE19DNJW3ua0dDk/AjwITacR0PqZxkbyJ+E5jYbxI84x1TBE+y90hwDCYZIM0tqAKPZfCzFrbH8kYCm3eqQkZ2+2GovcL8Suokyg8yyCJes6dcouSLiNSLb0ETJU+/N/WFsBBSOXBbm9Cwp4CzlOag7ro7R2vC19nSsCPmAjIEMiobFwaoVXhjTU2XMpgEsDH/L3Sx54OCTMUSXI/IIA2V4QcLQpwVz12pInI0bY56pIQ2BSGRLL+yLfZ7JkiimbK+aepsbwRStpokx5gCqe1hjdMAwcINbkk5jmedrNRAG5pUXPe0sZIoXy1h7lSDxApzheg24JeDNtDS1oBDBUC4iWZFilBPhZx0Kqx2lihpbG9q4sYidksCN4yRYhNM4nxfBbTi4E3AT6B3igbvs9Gv8ZkHsIfdlep+2HelEDbkJdNjqZQ90B7k6OIoFfkkPNoY+z0gzACa1f2qcBYxVJpT2QQgS19dKQlbC24S92xiEAFRKB5Uy1qrBgOtwIge55G0kRPfIytGx0tMOrGfrijB2FHOk/TKcMjDTMPeBo4FnXD5cQ8vtdgoAN0yuzZQHQI09wm/5vAB6RHyI9rYKiZ6YWC6rbaiLmDtoaToC1bViXQFNtgWsOfEEKCleC3GWPSfgQWRQWMgw/9FDgvOZrFAT3SmsA3DLbqlsSppQG5QeOjPXavUUkxF/qgLM05vW5o7UakuBqo2ZW8Nj0LB7imVJC9QSA+wd7RPztIUZ80xQZq0ROrc8CSVncWzkTA/RwmunldCPAQKjqVC7bhRuTIv0plbk7gOX4m5OAi2YesYZ0KBQRToG8iv9x8dgGtgECYRBeEU87OxoSc8epu+s7Mq/MN0VbBT19dii7ekO66UZwdAMtoAVQd13J5nwZe98OgGslmVqAGBkeLZNVNVlWpV18qihntXKnBZvrDIVgFpx4q5poLqREOVplMPSpTF2KvjBAzDpprkruXIaaUmUD4Xo2yrGWcYlixKIwRFjl0jPQhKznUXZAoSjlg9c/NwAI4p3Q/w5bCNfhUZS7bGfqesHqKAlyZZxZgNrhGevZXccaqBys4NEqB3Vqfptji9uUrhCL6yXFqxtm0hhLyYU3Tjd8I/HZaWD1oyVjnG5hhpCN5yHSf8BQUZlVNd00OP4M0TK+JSM7iqWi01SinFkCQXWxiZJLqqAHiEt3G3I2WYd46KU9pIJIOkoRQYCcEAAPguHo0Y4k8Hl6SW50MoW0uZU8jJOUghKo38Nl5ZSwsJNAUC2/lFZWkfMjrU8dFrTjHpJnUrLCILQIxINiYdQlDXaE/razQ4jjQluN5jW1Eh/S7yYvI5gigSjdLYU9TiFXAcHjISiLhQd9obb3OQmwY+YqVwiBMCkOGLXaK/ljBShh56c1g0uyIb2lBRKO7ZTAFncw5c5UGjGSy3CsI1Jt2mtruZkfhBZmbR+842Yu1eDiWEl0V6LZcGem6Ct+LW4Wy3oAjyNObazKBHomhJ3HMKEKHgiGksH+Ig1nTidfNMyA+oYHqVFaRGLiQreVLc9GvQgftKjW9cfUSKNYL80rqU7Um2rwqQJR1ai31Wq7vzKJEsFHDj0bAEMUKXgvfD5bWbaLPBTKz1Nk/Fg+GUZvUzFw80CLaKtPAACVAWrismh863FU4IJ0716SXBUNVb/SDMVvZgDt34CXoOq1JKvg0n08gPHTwXBNgD5W8pZZ8E9EVWcv1DZMB2NFysIwkqBSaH5QRmsAHdkHB+UANvLJvFpQKAahSmYTLEd2AFO+5rsqRRU6sVv5IP0wsSPLcWsbC1Y95mte71CUm6RJJWwkg6Q4k+xWMM0ByElJPQ6j2ED5hY42ALpZRytx9RlgQlJLijzhKi5eX5JBSIRGfo9o2xhd/0aWku8OS+4D9ZnovHDQMPaYo4qm2mlZbUnd7pR6oQj29Z2BqJ9n3LRT+MTLu3IR+ZP2TCPh3EDw8H1NHpoT7FibNYU8WHd9ESHcY12aDOQCUBddi4Ucp+4yuzz8ybcCCu1h8zvzXhDN4HYLq1R+U0xzUqg5QSA3iSBgdDouy55Ifx0DaeEhgezxBRGmoEJ6AJitVuzwtKPlUskHgU2F0LS7AFIwW5jPu0RUL7sp+fkNk0ee8P6uXYgl40WM+cdCOW21r13e0ivt0ff/mYcUfrQZWs2BiN6G+MDTGz1BKORmUTNQp9YGSHFxAeTkQrKd6FoVUogyytW25OLy3OpaO5oZCQp46aPzb5LnJiFEIwAKkmbYVYIjzVv3vj7rA6HignEeQAXTAHKDhoD7Uujh0QjtsB6fTP1NzO7T1Nzq4F1GnfHdXCG1Yxjwdtjf+PGRGTzEtEAUCz7KLfTdItLwCXuSOAzVjaZB6LvbUZhYGWmifSZlcMDnGHPd6gPeiK9erhpiw7ZP9ahTrMhFDa1J53m9ri2DloziqGETTcVSppCbTDDjExg6RrZ6cPEzB8XArEjQSB29odrUoLyoS/65RfM9fprGGjlHpbhGgbYD8MtmW1eFcAWX5dbcMHcl8sUI2k+H7GPW9VrArw3G+BefcCrCaAT/N53YLvP26Uy0kMFnDEZz0DJkmQqEOlL7SlKweYhH8gxpYeAYi0f9magqPbMYZuUI6007lSZQoyoGfYQHsNRzHXR3MMINTSMZpq1KD2A5MDJgtMLdRU6R4CEOJcKGiIJ7K6P/vAM6xpECHI8rRHsaEj6smkngAUjXTzrRoSI48ZpHOqgOY5OejKVdpnmiYUChQnVdIPa6ekGqRSRgEO119oDHOiIUQ5ciYVgaF1oG8Udo8WYtD+DEi8D/w8rAJE2k2PoyV0oMtpauxreaFjpujAvxFlwBhjuNqM9P0IfI5iD8Nh8y1kG4igjJkDNkOijnlLhItAd9lhRd670yNRTu95cR/Xuu0c5WO4DEFk5YQAPtLvU4TYPGRh4APPEDNiuuwR6SC21JoFbQBBMr+zJmT32QplNI6p16PbculN/pCX1wAyTWGTeJ774aln0gvQikw7TmkfsNbdQNs0adutYUDqNtGc0RqngUYdhUYuHSL1/eLrgvqDTC5neu++vufRkEgP9D2T64Kg/c4n+s7k3dDr3me8nOr0c72MRNmgF7D4WySPP0YAI/bI4eixwc7K13QiRiL85A8fnSsUj+mvTrsZtVUEQZ6sTpVafW8nYJZyaZS0U+0xIb6et9PhhtoObozQbjKAoDf6eiFgx1UUvpUYj1GweH0MNMrofhynfWn7+KYu7n5r83hN9aqm+6qjcH7dUlgvZVLV3xqq4fbP16qv+eofuTz43eomAqfS7GBAB9zEE31WJ37eVIPtdGN5A8nMYPvvLt8t2/V/6gM19G4g/hIL7UXf9JgbuLRZ+AoW//AzyMxTcWyz8BAruLRZ+AgX3r3y2+mT/PwfiN1DoVI+QT3CZDmvb8022JeYb6HiQPQpPPvboFB+i1MZdcqWZqthHmix6vttw0UAI1z8oEnGwVe++c7JamxslC+8xKJE41XJmug1npz+6CUAKyURd9gSxo+kWxvtZth848GBlws/0SKjYhmbZ9IiV+mcGBSdWHk8sqSr2zz5J7QME/0yD+z4Pe+JuGn1MV/vUyZwOHojWPlmPXgf9CuoeN9UAT+FGwaLg44v3dWe6QpvuL3Ln/p3k/2AgqNDcfwHgqUmIIqn+hwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wYRESAMujenGAAAB9FJREFUeNrtnWlsFVUUx899fS1gUoKioEY+WBRUEohGkUhAKxgEjSgGoRGB4AJCNKAIJBJZJSiyGYMKKkIoLlEUKhUraxFkKUE2kU1aCrRgW2jpg9f29R2/sBTo67v3zL2zvfP73MzM+XU6mf+5504BGIZhGIZhGIZhGIZhGMZGGq3JvSmR62++BXHH7Ylbf9ouRMT99yVq/e0PICIiHumUmPV3PooXOf5EItafXoCXOdUn8ep/pgjrUDY40ervX4JXUTEiocoXL5/FawiNEwlU/6hzeB3hqQljQIwJYT3UzEkQA2JiGOslsiAhDIgZ1RiD6NIEMBD8NIKxyQr6vv7FtdgQa31uILg0ig2zsZmv4//yePUj7rjNv/U3yUEJ/r7Xr/XfvBmlOPKwT+vfhpIUdvdj/Wm7UZpTz/mv/g4HUYGyQb5r/+SjEhXD/VV/j5OoSGisj16LRe9iVCY8xTcGxIulSKBmtk8MiKHlSMIn8ViMqkQivojHgfcuIJ0VAc/XPzmMVljrcQOBmdVojY1NvVx/8mcRtEqeh+NxypJatM6+ezxb/7Io6uBwR4/e/1moicJunvz956A2ip/1Xv3Nt6JGSgd6rf47/0KtlHssHrfZi5rxVDwWDx5C7XgoHotHC9AANbO8YqBXERohMt8bv/8X/kNDRDM9cA+IgWVojhWuNxAYXo4mWePyeBwYHUKz5Lo6HidNvICmybvVxfXPqEbz7Gvr2vrn1KAdHH7IpX//8yNoD8dcGY+TM6NoF26MxzLTL26Mx0majtM4q5ed7yhNulVsd5WAxqset/mGS6/d5CIBLXI62/7I6ZKyzjUC0rIfsP+hE3zkxt9c8vy7tPnJbiKfuyP+Xdn8ZDeuiMei+zF0juWOGyBNv+iMxw4bEBkl6CzOxmPx6ll0mryWDtb/ViU6z17H4rEYG0I3cMiheByYFEZ34Ew8Dn5UjW7BiXisY/rFDfGYmgWCCwcngXto0q08z1YBSUsy3NWgb5Qe2WSjgJRlfdy2RJPcNXm9bQIarexpsP5VdxHjcbMcm2Q3/5P64i71U8k/ELuLNsVjcct2cnST+rGg+Jo4XmhLPBZ376GOfoOkAIB5NWTHxuu/nzj9ElkA8gLgA+pLlvF43IU4/VI9G1QEAHnIPjfVaP1PnqRdVngKqAkActDMa2Hw/u9zijjjNg5UBcBr1FbD3jbG6h9QSruk8ovfyFESABnUWSNT8VgMI06/lF7aBqomAJ4n3m+G4nHgbeJfZfHljcCKAqDHcWo87m2g/gnE53LhlS+lqQqATv9S4/FL2u//qcT2T34XoAuAdvuJBspf11z/LOKbyYG6q4bqAqDVTqKByjFa21/U6ZfdaWBNADTdTDQQnqSv/pRMYjrZevVLCUUAiF+JBqpnaqv/J2I+zb3mxZwkAMTPDq8ep1A3P/1y3ZOEJABgiaPxuOnvxLN/B7oEwELq/sPl1utvSdz8VPsl6BMAn1AbBKut1t96F+3ENXOFTgFiehXRwAZL8Vi0JW5+qppW7+HIAgDGnyca2G4hHouOh2knvTARdAuAkedsj8cinTj9Ujka9AuAV87YHI/F08TNT2eHgQkB0I/aIDhGmuIU/YnnKxkAZgTAU8SGHC0eDyJufiqKfTKrAqBrPtFAiXo8HlFBO1VBA7ebZQHQifhUVo7H4p2QgQeOdQHQbp8t8Tg4idj+2dPgwJIGAdBqhw3xmDz9EuelQ4cASP3DeDwOziW+ecdbldEiACDbcDxOWkBs/8QNHpoEAPXjLNFMmfpv+IZ4+PjRU5cAWGwwHqcQNz/J2NUmAMgjavHjMfEPTGpvvz4BQH1MrzMkoHoW2CsAppEaBFskemQUA+HJYLcAeJfQINgpNVuvbiA0FuwXAG8qNwh2S07WqxqQ/saPXgEwRDGu7W8te2Q1A6XSH0HWLAD6nVa5zoPS9asZKJb/DLZuAdDzhPx1Hu2gkobkDRQq/J8w7QJAfstevuI3+WQN1F39dkAAtP9H7jpPdFVtiMgZOKC0Z9aAAEiT+mrbScLQjIyBXWngtABokRf/kKefonRF4xvYqrjmYEQApG6Md8SyvrS+eDwDG5QbzUYExL3QMxnUlZGGD5wFbhEADQ7YVwyhr401YCD6LbhHACyK3SA4N9TK6mhMA5EvwE0CYF6sBkFopLXl8exYq9/gLgHwYf3x+PxoqwMC9RoIvw9uE1D/gH3VeOsjItnSq9/OCqhvwL5qAoABA5XU28qsAHjj2tW8mukABgzEXP12WgAMvrpBEPkYwICB2KvfjguAvnUH7GvnARgwUGRhEt24gLoD9tGvAAwYKLDyySzzAqDzpQH76CIAAwYOWtqNYoMAaH9xwP57AAMG9ljbj2SHALhjJyLijwAGDGyzuCPNFgGQuhlxpfw1yR94dfAxi5cmojI/lRyx+rtaX9XDhADr2CVABc//JycWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWIDToH8FyJUWtVWAALedDoFhGIZhGIZhGIZhGIYxyf+YwEMsIhMo/AAAAABJRU5ErkJggg==",Ttt=new IB;function yLe(t,e,r){let{nearRadius:i,farRadius:n,accentColor:a,completeFraction:o,isVertical:l,visibleThroughGeometry:u,dashed:c}=e,{color:p}=r,m=0,y=1/0,v=e.displayArrowsOnPath,x=!0,E=v,M=i/2+Ptt,I=0;t[0].z+=M;for(let we=1;we<t.length;++we){t[we].z+=M;let Le=t[we].x-t[we-1].x,fe=t[we].z-t[we-1].z;if(l)I+=Math.sqrt(Le*Le+fe*fe);else{let Re=t[we].y-t[we-1].y;I+=Math.sqrt(Le*Le+Re*Re+fe*fe)}}if(!l){let we=t[0],Le=t[t.length-1];t.push(Le.clone().setZ(Le.z-.01)),t.unshift(we.clone().setZ(we.z-.01))}let P=new Gu;E&&(P=Ttt.load(Itt),P.colorSpace=il);let C=new oi(p),T=new oi(a),D={vertexes:{type:"f",value:1},resolution:{type:"v2",value:new Jt(1,1)},cameraParameters:{type:"v2",value:new Jt(m,0)},complete:{type:"f",value:0},color:{type:"c",value:C},pathLength:{type:"f",value:I},nearRadius:{type:"f",value:i},farRadius:{type:"f",value:n},nearZoom:{type:"f",value:m},farZoom:{type:"f",value:y},pulseColor:{type:"c",value:T},pulse:{type:"f",value:0},pulseLength:{type:"f",value:.075},pathIsVertical:{type:"b",value:l},arrowAnimationTimer:{type:"f",value:0},arrowTexture:{type:"t",value:P},displayArrowsOnPath:{type:"b",value:v},showPulse:{type:"b",value:x},opacityMultiplier:{type:"f",value:1},dashed:{type:"b",value:c}},F=new Nhe(t);F.curveType="catmullrom",F.tension=0;let k=30,B=8,U=k*t.length,z=new HVe(F,U,i,B,!1),q=new Float32Array(z.attributes.position.count);for(let we=t.length;we<q.length;we++)q[we]=we;z.setAttribute("vertexIndex",new Zo(q,1));let Z=new Float32Array(z.attributes.position.count),Q=new Zo(Z,1);for(let we=0;we<=U;we++)for(let Le=0;Le<=B;++Le)Q.setX(we*(B+1)+Le,we/U);z.setAttribute("pathDistance",Q);let V=new Float32Array(z.attributes.normal.count*3),ae=new Zo(V,3);for(let we=0;we<U;we++){let Le=z.tangents[we];for(let fe=0;fe<=B;++fe)ae.setXYZ(we*(B+1)+fe,Le.x,Le.y,Le.z)}z.setAttribute("pathTangent",ae);let Y=new Float32Array(z.attributes.normal.count*3),he=new Zo(Y,3);for(let we=0;we<U;we++){let Le=z.tangents[we];var J,ne,ee;l?(J=Le.x*Le.y,ne=-1+Le.y*Le.y,ee=Le.z*Le.y):(J=-Le.x*Le.z,ne=-Le.y*Le.z,ee=1-Le.z*Le.z);let fe=Math.sqrt(J*J+ne*ne+ee*ee);fe===0&&(fe=1);let Re=J/fe,me=ne/fe,Ae=ee/fe;for(let Ue=0;Ue<=B;++Ue)he.setXYZ(we*(B+1)+Ue,Re,me,Ae)}z.setAttribute("pathNormal",he);let ue=new bc({uniforms:D,vertexShader:jD,fragmentShader:SX});ue.transparent=!0,ue.alphaTest=.5,D.resolution.value.x=1,D.resolution.value.y=1,D.vertexes.value=q.length,D.arrowTexture.value.wrapS=Bh,D.arrowTexture.value.wrapT=Bh,D.arrowTexture.value.anisotropy=16;let K=new Tn(z,ue),ce=K.clone(),re=vt(Ee({},D),{opacityMultiplier:{type:"f",value:.25}});re.complete.value=1,ce.material=new bc({uniforms:re,vertexShader:jD,fragmentShader:SX}),ce.material.transparent=!0,ce.material.alphaTest=.5,ce.material.depthWrite=!1,ce.material.depthTest=!1,re.resolution.value.x=1,re.resolution.value.y=1,re.vertexes.value=q.length,re.arrowTexture.value.wrapS=Bh,re.arrowTexture.value.wrapT=Bh,re.arrowTexture.value.anisotropy=16,re.complete.value=o,K.userData=ce.userData=e.mesh.userData;let se=e.mesh;if(!u){let we=new bc({uniforms:D,vertexShader:jD,fragmentShader:Ctt}),Le=new Tn(z,we);Le.name="stencil",Le.material.colorWrite=!1,Le.material.stencilWrite=!0,Le.material.stencilRef=1,Le.material.stencilFunc=nO,Le.material.stencilZPass=qL,Le.material.stencilZFail=qL,Le.material.stencilFail=qL,Le.material.depthWrite=!1,Le.material.depthTest=!1,se.add(Le),se.add(ce)}if(se.add(K),l){let we=new to().setFromObject(K),Le=new qe;we.getCenter(Le),se.children.forEach(fe=>{fe.geometry.center(),fe.position.copy(Le)})}u&&(K.material.stencilWrite=!0,K.material.stencilRef=1,K.material.stencilFunc=JUe,K.material.stencilZPass=Jd,K.material.stencilZFail=Jd,K.material.stencilFail=Jd,K.material.needsUpdate=!0,K.layers.disableAll(),K.layers.enable(pge.ALWAYS_ON_TOP)),z.computeBoundingBox();let de=new qe;return z.boundingBox.getCenter(de),{mesh:se,material:ue,center:de}}s(yLe,"buildPath");var Ptt=.15,Ltt=.5,vLe=class extends qa{constructor(e,r,i,n){super(),$(this,"rendererState"),$(this,"altitudeDirty",!0),$(this,"convertTo3DMapPosition"),$(this,"getParentContainer"),$(this,"convertZoomLevelToAltitude"),this.rendererState=e,this.convertTo3DMapPosition=r,this.getParentContainer=i,this.convertZoomLevelToAltitude=n}update(e,r,i,n=0){let a,o=!1;for(let l of this.rendererState.geometry3DIdsInScene)if(a=this.rendererState.geometry3DMap.get(l),a&&a.type==="path"&&a.components[0].type==="path"){let u=a.components[0],c=a.components[1],p=u.isVertical&&this.altitudeDirty;if(!(u instanceof gI))continue;let m=[];if(u.dirty||p){if(u.mesh.parent!=null)for(let y=u.mesh.children.length-1;y>=0;y--)El(u.mesh.children[0]);if(u.feature.features.length===2&&u.feature.features[0].properties.parentId&&u.feature.features[1].properties.parentId){let y=u.feature.features[0],v=u.feature.features[u.feature.features.length-1],x,E,M=y.geometry.coordinates[2]||0,I=v.geometry.coordinates[2]||0;y.properties.parentId&&(x=this.getParentContainer(y.properties.parentId,!0),x!=null&&x.altitude!=null&&(M+=x.altitude,u.isVertical=!0)),v.properties.parentId&&(E=this.getParentContainer(v.properties.parentId,!0),E!=null&&E.altitude!=null&&(I+=E.altitude,u.isVertical=!0));let P=this.convertTo3DMapPosition(y.geometry.coordinates[1],y.geometry.coordinates[0],M),C=this.convertTo3DMapPosition(v.geometry.coordinates[1],v.geometry.coordinates[0],I);Math.abs(P.z-C.z)>Ltt&&x!=null&&x.visible&&E!=null&&E.visible&&(m=[P,C])}else m=u.feature.features.map(y=>this.convertTo3DMapPosition(y.geometry.coordinates[1],y.geometry.coordinates[0],y.geometry.coordinates[2]||0));if(m.length>1){let{mesh:y,material:v,center:x}=yLe(m,u,{color:c.color});u.mesh=y,u.material=v,u.position=x}u.dirty&&(u.nearZoomLevel!=null&&(u.nearZoomAltitude=this.convertZoomLevelToAltitude(u.nearZoomLevel)),u.farZoomLevel!=null&&(u.farZoomAltitude=this.convertZoomLevelToAltitude(u.farZoomLevel))),u.dirty=!1}c.dirty&&(u.mesh.children.forEach(y=>{y.name!=="stencil"&&(y.material.uniforms.color.value.set(c.color),y.material.visible=c.visible,y.material.needsUpdate=!0)}),u.mesh.position.z=c.altitude,c.dirty=!1),u.isVertical&&u.mesh.children.forEach(y=>{y.rotation.z=-n}),u.material&&(u.mesh.children.forEach(y=>{var v,x;if(y.name==="stencil")return;let E=y.material.uniforms;E.nearZoom.value=(v=u.nearZoomAltitude)!=null?v:e,E.farZoom.value=(x=u.farZoomAltitude)!=null?x:r,E.cameraParameters.value.x=i,u.materialDirty&&(E.nearRadius.value=u.nearRadius,E.displayArrowsOnPath.value=u.displayArrowsOnPath,E.farRadius.value=u.farRadius,E.pulseColor.value.set(u.accentColor),E.complete.value=u.completeFraction),y.material.needsUpdate=!0}),u.displayArrowsOnPath&&u.animateArrowsOnPath&&(u.mesh.children.forEach(y=>{y.name!=="stencil"&&(y.material.uniforms.arrowAnimationTimer.value=performance.now()/3e3,y.material.needsUpdate=!0)}),o=!0),u.materialDirty=!1)}this.altitudeDirty=!1,o&&this.publish("animate:path")}};s(vLe,"PathSystem");var Dtt=vLe;N();var Bs,U2,bm,_Le=class{constructor(e){$(this,"rendererState"),$(this,"dirty",!1),Be(this,Bs),Be(this,U2),Be(this,bm),this.rendererState=e}updateOne(e){if(e instanceof za&&e.components[0]instanceof tu&&e.components[1]instanceof u_&&e.parentObject3D instanceof Fu&&(He(this,Bs,e.components[0]),He(this,bm,e.components[1]),w(this,Bs).detached&&w(this,Bs).dirty&&w(this,Bs).geometry!=null&&w(this,Bs).material!=null)){He(this,U2,e.parentObject3D),w(this,Bs).visible=!1;let r=new oi(w(this,bm).color),i=w(this,bm).opacity*Ow(e),n=new Z8({color:r,side:Pu,opacity:i??1,transparent:i!==void 0?i<1:!1},1,w(this,Bs).material.repeatYFactor),a=new FB(1,w(this,Bs).geometry.attributes.position.count||0,0,n),o=a.addGeometry(w(this,Bs).geometry);a.addInstance(o),a.userData={entities:{0:e.id},detached:!0},w(this,Bs).instanceIndex=o,w(this,Bs).material.setColor(w(this,Bs).instanceIndex,r,w(this,bm).topColor?new oi(w(this,bm).topColor):r),w(this,Bs).mesh=a,w(this,Bs).material=n,w(this,U2).add(a),w(this,Bs).dirty=!1}}update(){if(!this.dirty)return;let e;for(let r of this.rendererState.geometry3DIdsInScene)e=this.rendererState.geometry3DMap.get(r),this.updateOne(e);this.dirty=!1,this.cleanup()}cleanup(){He(this,Bs,void 0),He(this,U2,void 0),He(this,bm,void 0)}};Bs=new WeakMap,U2=new WeakMap,bm=new WeakMap,s(_Le,"MeshDetachmentSystem");var Rtt=_Le;N();N();function xLe(t,e,r){var i;if(t.geometry!=null){let n=e||1e-4,a=n/t.currentHeight,o=n/r;t.geometry.scale(1,1,a),t.material&&(t.material.repeatYFactor=o),(i=t.mesh)==null||i.setGeometryAt(t.instanceIndex,t.geometry),t.currentHeight=n}}s(xLe,"updateHeight");var s1,iy,bLe=class{constructor(e){$(this,"rendererState"),$(this,"dirty",!1),Be(this,s1),Be(this,iy),this.rendererState=e}updateOne(e){var r;e instanceof za&&e.type==="geometry"&&(r=e.components[1])!=null&&r.dirty&&(He(this,s1,e.components[0]),He(this,iy,e.components[1]),e.type==="geometry"&&w(this,iy).height!==w(this,s1).currentHeight&&xLe(w(this,s1),w(this,iy).height,w(this,iy).initialHeight))}update(){let e;for(let r of this.rendererState.geometry3DIdsInScene)e=this.rendererState.geometry3DMap.get(r),this.updateOne(e);this.cleanup()}cleanup(){He(this,s1,void 0),He(this,iy,void 0)}};s1=new WeakMap,iy=new WeakMap,s(bLe,"MeshModificationSystem");var Ott=bLe;N();var ktt={showPolygonLabelTextAreaMesh:!1,showEnvMap:!1,showCollisionBoxes:!1},wLe=class{constructor(e){$(this,"state",ktt),$(this,"core"),this.core=e}update(e){let r={};for(let[i,n]of Object.entries(e))i in this.state&&this.state[i]!==e[i]&&(this.state[i]=n,r[i]=n);this.handleUpdate(r)}handleUpdate(e){e.showPolygonLabelTextAreaMesh!=null&&(e.showPolygonLabelTextAreaMesh?this.core.getSystems().text3DSystem.showTextAreaMesh():this.core.getSystems().text3DSystem.hideTextAreaMesh()),e.showEnvMap!=null&&(e.showEnvMap?this.core.setEnvironment("basic"):this.core.setEnvironment(!1)),e.showCollisionBoxes!=null&&(e.showCollisionBoxes?(this.core.getSystems().collisionSystem.showCollisionBoxes(),this.core.render()):this.core.getSystems().collisionSystem.hideCollisionBoxes())}};s(wLe,"Debug");var Ntt=wLe;N();var bE=9,MX=.1;function ALe(t,e,r){for(let i=0;i<e;i++){let n=(r&16711680)>>16,a=(r&65280)>>8,o=r&255;t[i*3]=n/255,t[i*3+1]=a/255,t[i*3+2]=o/255}}s(ALe,"fillArrayWithColor");var SLe=class{constructor(e,r,i){if($(this,"state"),$(this,"renderer"),$(this,"renderService"),$(this,"pickingTexture"),$(this,"pickingMaterial"),$(this,"pixelBuffer"),$(this,"width",0),$(this,"height",0),$(this,"scale",1/2),$(this,"color",1),$(this,"convertTo3DMapPosition"),$(this,"destroyed",!1),$(this,"enabled",!1),$(this,"backgroundId",16777215),$(this,"resize",s(()=>{let n=this.state.pixelRatio;this.width=Math.floor(this.renderer.domElement.width/n*this.scale),this.height=Math.floor(this.renderer.domElement.height/n*this.scale),this.pixelBuffer=new Uint8Array(4*this.width*this.height),this.pickingTexture=new Qm(this.width,this.height,{format:Ll,type:ed,internalFormat:"RGBA"})},"resize")),$(this,"shouldShowByXY",s((n,a,o)=>{if(this.pixelBuffer==null)return!1;let l=n+(this.height-a-1)*this.width,u=this.pixelBuffer[l*4],c=this.pixelBuffer[l*4+1],p=this.pixelBuffer[l*4+2],m=u<<16|c<<8|p;return m===o||m===this.backgroundId},"shouldShowByXY")),$(this,"activeOccluders",new Set),$(this,"update",s(()=>{if(!this.enabled||(this.activeOccluders.clear(),this.activeOccluders.add(this.backgroundId),!this.pickingTexture||!this.pixelBuffer))return;let n,a;for(let l of this.state.geometry3DIdsInScene){let u=this.state.geometry3DMap.get(l);if(u&&u instanceof Yn&&u.userData.occluderFeature!=null&&u.userData.occluderId!=null&&(this.activeOccluders.add(u.userData.occluderId),u.userData.occluderDirty)){if(n=u.userData.occluderFeature,n.geometry.type==="Polygon"){let c=gj(n,this.convertTo3DMapPosition,{color:"white",height:MX});a=this.createOccluderMesh(c,u.userData.occluderId),u.add(a)}else if(n.geometry.type==="MultiPolygon"){let c=yj(n,this.convertTo3DMapPosition,{color:"white",height:MX});a=this.createOccluderMesh(c,u.userData.occluderId),u==null||u.add(a)}u.userData.occluderDirty=!1}}this.renderer.setRenderTarget(this.pickingTexture);let o=new oi(this.backgroundId);this.renderer.setClearColor(o),this.renderer.clear(),this.state.cameraObject.layers.disableAll(),this.state.cameraObject.layers.enable(bE),this.renderer.render(this.state.entityScene.parent,this.state.cameraObject),this.renderer.setRenderTarget(null),this.state.cameraObject.layers.disable(bE),this.renderService.enabledLayers.delete(bE),this.renderer.readRenderTargetPixelsAsync(this.pickingTexture,0,0,this.width,this.height,this.pixelBuffer).then(()=>{if(!this.destroyed)for(let l of this.state.geometry2DIdsInScene){let u=this.state.geometry2DMap.get(l);if(u&&(u==null?void 0:u.occluderId)!=null&&this.activeOccluders.has(u==null?void 0:u.occluderId)){let c=u.components[0].projection,p=Math.floor(c.x*this.scale),m=Math.floor(c.y*this.scale),y=this.shouldShowByXY(p,m,u.occluderId);u.components[0].isOccluded=!y}}})},"update")),this.state=e,this.convertTo3DMapPosition=r,(i==null?void 0:i.renderer)==null)throw new Error("No Renderer");this.renderService=i,this.renderer=i.renderer,this.resize(),this.pickingMaterial=new bc({glslVersion:oO,vertexShader:`
				attribute vec3 color;
				varying vec3 vColor;
				void main() {
					vColor = color;
					gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
				}
			`,fragmentShader:`
				varying vec3 vColor;
				out vec4 fragColor;

				void main() {
					fragColor = vec4(vColor, 1.0);
				}
			`})}applyId(e,r){let i=e.attributes.position,n=new Float32Array(i.count*3);ALe(n,i.count,r),e.setAttribute("color",new Zo(n,3))}createOccluderMesh(e,r){let i=new Tn(e,this.pickingMaterial);return i.layers.set(bE),this.applyId(i.geometry,r),i.userData.occluderId=r,i}reserveOccluderId(){return this.color++,this.color}enable(){this.enabled=!0}disable(){this.enabled=!1}destroy(){var e;this.destroyed=!0,(e=this.pickingTexture)==null||e.dispose(),this.pickingMaterial.dispose(),this.pickingTexture=void 0,this.pixelBuffer=void 0}};s(SLe,"Occlusion2DSystem");var Ftt=SLe,EX=new FA,{DEFAULT_PITCH:MLe,DEFAULT_BEARING:ELe,DEFAULT_ZOOM_LEVEL:CLe,DEFAULT_MIN_ZOOM_LEVEL:Btt,DEFAULT_MAX_ZOOM_LEVEL:ztt}=_y,Utt=$n.radToDeg(.6435011087932844),$o,So,l1,II,V2,ny,u1,j2,Ph,wN,Tt,fa,Ep,Mo,af,el,Pt,TI,ws,Ea,ILe,TLe,PLe,xy,PI,LI,DI,$2,AN,RI,OI,kI,G2,SN,c1,NI,Su,Mu,MN,H2,FI,LLe=class extends qa{constructor(e,r={}){var i,n,a,o,l,u,c,p,m,y,v,x;if(super(),Be(this,Ph),$(this,"options"),$(this,"container"),$(this,"Debug"),Be(this,$o),Be(this,So),Be(this,l1),Be(this,II),Be(this,V2),Be(this,ny),Be(this,u1),Be(this,j2),$(this,"rendererDomElement"),Be(this,Tt,{geometry3DMap:new Map,geometry2DMap:new Map,geometry2DIdsInScene:new Set,geometry3DIdsInScene:new Set,entityScene:new Yn("__scene"),hoverColor:"#f6efff",text3dHoverColor:"white",insetsPadding:BB,shouldMeasureCanvas:!0,pixelRatio:this.resolutionScale,canvasWidth:0,canvasHeight:0,tweenGroup:new O5e,cameraObject:new Yl,naturalBearing:0,containerOffset:[0,0],useStandaloneCamera:!1}),$(this,"camera"),Be(this,fa),Be(this,Ep),Be(this,Mo),Be(this,af),Be(this,el),Be(this,Pt,{}),Be(this,TI,window.matchMedia("screen and (min-resolution: 2dppx)")),$(this,"map"),Be(this,ws,s(()=>{w(this,Pt).renderSystem.twoDdirty=!0},"#invalidate2DEntities")),Be(this,Ea,s(()=>{w(this,Pt).renderSystem.threeDdirty=!0},"#invalidate3DEntities")),Be(this,xy,"standalone"),Be(this,PI,s(k=>Math.trunc(k*10)/10,"#round10")),Be(this,LI,s(()=>{dr(this,Ph,wN).call(this,uw()),w(this,Pt).twoDDrawSystem.dirty=!0,w(this,$2).call(this,void 0,void 0,!0)},"#handlePixelRatioChange")),Be(this,DI,s(()=>{w(this,$2).call(this)},"#handleWindowResizeWithEvent")),Be(this,$2,s((k,B,U=!1)=>{let z=k??this.rendererDomElement.clientWidth,q=B??this.rendererDomElement.clientHeight;if((z===0||q===0)&&!U)return;w(this,Tt).canvasWidth=z,w(this,Tt).canvasHeight=q,dr(this,Ph,wN).call(this,uw()),w(this,G2).call(this),dr(this,Ph,PLe).call(this),w(this,Pt).cameraSystem.resize(this.canvasWidth,this.canvasHeight),w(this,Pt).cameraSystem.dirty=!0,w(this,Pt).watermarkSystem.resize(this.canvasWidth,this.canvasHeight),w(this,Pt).htmlControlsSystem.resize(this.canvasWidth),w(this,Pt).geometryInFocusSystem.resize(),w(this,Pt).occlusion2DSystem.resize();let{top:Z,left:Q}=this.container.getBoundingClientRect();w(this,Tt).containerOffset=[Z,Q],this.publish("resize"),this.render()},"#handleWindowResize")),Be(this,AN,s(()=>{this.renderSync()},"#renderFull")),Be(this,RI,new qe),Be(this,OI,s((k,B)=>{let U=this.mode==="standalone"?w(this,So):this.viewCamera;if(w(this,So).position.z+this.camera.elevation>B.z){w(this,RI).copy(B);let z=w(this,RI).project(U),q=(z.x+1)/2*this.canvasWidth-0/2,Z=(-z.y+1)/2*this.canvasHeight-0/2,Q=w(this,PI).call(this,q),V=w(this,PI).call(this,Z);k.x=Q,k.y=V}else k.x=-1e3,k.y=-1e3},"#project")),Be(this,kI,s((k,B)=>{w(this,el).setBufferSize(k,B),w(this,So).aspect=k/B,w(this,So).updateProjectionMatrix(),w(this,So).updateMatrixWorld(!0),w(this,V2).x=k,w(this,V2).y=B},"#setBufferSize")),Be(this,G2,s(()=>{var k;let B=w(this,Tt).canvasWidth=this.rendererDomElement.clientWidth,U=w(this,Tt).canvasHeight=this.rendererDomElement.clientHeight,z=Math.floor(B*this.resolutionScale),q=Math.floor(U*this.resolutionScale);w(this,kI).call(this,z,q),(k=this.map)==null||k.resize(),w(this,Tt).shouldMeasureCanvas=!1},"#measureCanvas")),$(this,"getParentContainer",s((k,B=!0)=>{if(!k)return B?w(this,Tt).entityScene:void 0;if(typeof k=="string"||typeof k=="number"){let U=w(this,Tt).geometry3DMap.get(k);return U instanceof Yn?U:(Vt.warn("Parent (".concat(typeof k=="object"?k.id:k,") is not a valid container, adding to scene")),B?w(this,Tt).entityScene:void 0)}else if(k.type==="group-container"){let U=w(this,Tt).geometry3DMap.get(k.id);if(U instanceof Yn)return U}return B?w(this,Tt).entityScene:void 0},"getParentContainer")),$(this,"showCollisionBoxes",s(()=>{w(this,Pt).collisionSystem.showCollisionBoxes(),this.render()},"showCollisionBoxes")),$(this,"hideCollisionBoxes",s(()=>{w(this,Pt).collisionSystem.hideCollisionBoxes(),this.render()},"hideCollisionBoxes")),$(this,"projectScreenXYToCoordinate",s((k,B,U=!1)=>{var z,q;let Z=w(this,Tt).containerOffset[0],Q=w(this,Tt).containerOffset[1],V=(k-Q)/w(this,Tt).canvasWidth*2-1,ae=-((B-Z)/w(this,Tt).canvasHeight)*2+1,Y=new Jt(V,ae),he,J;if(U)EX.setFromCamera(Y,w(this,So)),he=(z=EX.intersectObject(w(this,ny),!1)[0])==null?void 0:z.point;else{let ne=w(this,Pt).interactionSystem.getThreeDIntersectsFromXY(Y);he=(q=ne==null?void 0:ne[0])==null?void 0:q.point,J=w(this,Pt).interactionSystem.getGroupContainerIntersectsFromXY(Y)}if(he)return{coordinate:this.convert3DMapPositionToCoordinate(he),groupContainers:J}},"projectScreenXYToCoordinate")),$(this,"projectCoordinateToScreenXY",s(k=>{let B=this.convertTo3DMapPosition(k[1],k[0],k[2]||0),U=new Jt;return w(this,OI).call(this,U,B),{x:U.x,y:U.y}},"projectCoordinateToScreenXY")),$(this,"convert3DMapPositionToCoordinate",s(k=>{var B,U,z,q;let{lat:Z,lon:Q}=UB((U=(B=w(this,Tt).center)==null?void 0:B[1])!=null?U:0,(q=(z=w(this,Tt).center)==null?void 0:z[0])!=null?q:0,k.x,k.y);return[Q,Z,k.z]},"convert3DMapPositionToCoordinate")),$(this,"setBackgroundColor",s((k,B)=>{w(this,el).setBackgroundColor(k,B)},"setBackgroundColor")),$(this,"getMetresPerPixel",s(()=>{let k=this.container.clientWidth,B=this.container.clientHeight/2,U=this.projectScreenXYToCoordinate(0,B,!0),z=this.projectScreenXYToCoordinate(k,B,!0);return U==null||z==null?void 0:OB(U.coordinate,z.coordinate)/k},"getMetresPerPixel")),$(this,"hideOutdoorLayersUnderPoint",s((k,B)=>{!this.map||(B==null?void 0:B.length)===0||(w(this,Pt).outdoorLayersSystem.hideLayersUnderPoint(k,B),this.render())},"hideOutdoorLayersUnderPoint")),$(this,"hideOutdoorLayersIntersectingPolygons",s((k,B,U)=>{w(this,Pt).outdoorLayersSystem.hideLayersIntersectingPolygons(k,B,U),this.render()},"hideOutdoorLayersIntersectingPolygons")),Be(this,c1,new RA),Be(this,NI,new Ri),$(this,"render",s(()=>{var k;if(((k=w(this,Pt))==null?void 0:k.renderSystem)!=null)if(this.map&&(this.mode==="outdoors-interleaved"||this.mode==="outdoors-overlay"))this.map.triggerRepaint();else return w(this,Pt).renderSystem.update()},"render")),$(this,"renderSync",s(()=>w(this,Pt).renderSystem.update(!0),"renderSync")),Be(this,Su,e3(()=>{this.publish("user-interaction-start",void 0)},0,!0)),Be(this,Mu,e3(()=>{this.publish("user-interaction-end",void 0),this.render()},0,!0)),$(this,"on",s((k,B)=>{super.on(k,B),["outdoor-view-loaded","outdoor-style-loaded"].includes(k)&&this.mode==="standalone"&&ja.env.NODE_ENV!=="test"&&(Vt.warn('"'.concat(k,'" was subscribed to but outdoor view is disabled. The event has been triggered immediately. Enable outdoor view or remove the listener.')),this.publish(k))},"on")),$(this,"off",s((k,B)=>{super.off(k,B)},"off")),$(this,"getCursor",s(()=>w(this,Pt).interactionSystem.getCursor(),"getCursor")),$(this,"destroy",s(()=>{var k;w(this,Pt)&&(w(this,Pt).cameraSystem.off("user-dolly-start",w(this,Su)),w(this,Pt).cameraSystem.off("user-pan-start",w(this,Su)),w(this,Pt).cameraSystem.off("user-rotate-start",w(this,Su)),w(this,Pt).cameraSystem.off("user-zoom-start",w(this,Su)),w(this,Pt).cameraSystem.off("user-tilt-start",w(this,Su)),w(this,Pt).cameraSystem.off("user-pedestal-start",w(this,Su)),w(this,Pt).cameraSystem.off("user-dolly-end",w(this,Mu)),w(this,Pt).cameraSystem.off("user-pan-end",w(this,Mu)),w(this,Pt).cameraSystem.off("user-rotate-end",w(this,Mu)),w(this,Pt).cameraSystem.off("user-zoom-end",w(this,Mu)),w(this,Pt).cameraSystem.off("user-tilt-end",w(this,Mu)),w(this,Pt).cameraSystem.off("user-pedestal-end",w(this,Mu)),w(this,Pt).renderSystem.off("measure-canvas",w(this,G2)),w(this,Pt).meshOptimizationSystem.off("geometry-2d-added",this.render),w(this,Pt).meshOptimizationSystem.off("model-loaded",this.render),this.remove("__scene"),w(this,ws).call(this),w(this,Ea).call(this),this.renderSync(),w(this,Pt).renderSystem.destroy(),w(this,Pt).cameraSystem.off("change",this.render),w(this,Pt).pathSystem.off("animate:path",this.render),w(this,Pt).cameraSystem.dispose(),w(this,Pt).exporterSystem.destroy(),w(this,Pt).outdoorLayersSystem.destroy(),w(this,Pt).drawSystem.destroy(),window.removeEventListener("resize",w(this,DI),!1),w(this,TI).removeEventListener("change",w(this,LI)),w(this,u1)&&w(this,u1).disconnect(),this._subscribers={},w(this,el).destroy(),(k=w(this,$o))==null||k.traverse(B=>{El(B),"dispose"in B&&typeof B.dispose=="function"&&B.dispose()}),He(this,$o,void 0),w(this,Pt).htmlControlsSystem.destroy(),w(this,Pt).collisionSystem.destroy(),w(this,Pt).interactionSystem.destroy(),w(this,Pt).domMutationSystem.destroy(),w(this,Pt).geometryInFocusSystem.destroy(),He(this,Pt,void 0),w(this,xy)!=="outdoors-overlay"&&(this.map&&(this.map.transform.getElevation=void 0,this.map.remove()),this.container.contains(this.rendererDomElement)&&this.container.removeChild(this.rendererDomElement)),this.container.removeChild(w(this,af)),this.container.removeChild(w(this,fa)),He(this,el,void 0))},"destroy")),Be(this,H2,new qe),Be(this,FI,new qe),w(this,Tt).useStandaloneCamera=(i=r.useStandaloneCamera)!=null?i:!1,w(this,Tt).naturalBearing=(n=r.naturalBearing)!=null?n:0,this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),!e.clientWidth||!e.clientHeight)throw new Error("[MappedinJS] Container width and height must be greater than 0");this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),(r.mode==="outdoors-interleaved"||r.mode==="outdoors-overlay")&&r.map&&(He(this,xy,r.mode),this.map=r.map),w(this,Tt).entityScene.addEventListener("childadded",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),w(this,Tt).entityScene.addEventListener("childremoved",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),w(this,Tt).geometry3DMap.set(w(this,Tt).entityScene.userData.entityId,w(this,Tt).entityScene),r.center&&(w(this,Tt).center=r.center?[...r.center]:[0,0]),this.options=r,this.container=e,dr(this,Ph,ILe).call(this),dr(this,Ph,TLe).call(this),w(this,Pt).htmlControlsSystem=new ltt(this.container),w(this,xy)!=="outdoors-overlay"&&w(this,Pt).htmlControlsSystem.addAttributionControl(this.options.attribution),window.MappedinDebug||(window.MappedinDebug={}),ja.env.NODE_ENV==="test"&&(window.MappedinDebug.mapViewCoreInstance=this),He(this,el,new sJe({antialias:typeof r.antialias=="boolean"?r.antialias:!0,alpha:!1,canvas:this.mode!=="standalone"?(a=r.gl)==null?void 0:a.canvas:void 0,onWebGLContextCreationError:r.onWebGLContextCreationError,onWebGLContextLost:r.onWebGLContextLost,onWebGLContextRestored:s(k=>{var B;(B=r.onWebGLContextRestored)==null||B.call(r,k),w(this,ws).call(this),w(this,Ea).call(this),this.render()},"onWebGLContextRestored"),onWebGLRendererError:r.onWebGLRendererError,backgroundColor:r.backgroundColor||"#ffffff",backgroundAlpha:(o=r.backgroundAlpha)!=null?o:1})),He(this,$o,new xB),w(this,$o).add(w(this,Tt).entityScene);let E=window.__THREE_DEVTOOLS__;ja.env.NODE_ENV==="dev"&&typeof E<"u"&&(E.dispatchEvent(new CustomEvent("observe",{detail:w(this,$o)})),E.dispatchEvent(new CustomEvent("observe",{detail:w(this,el)}))),He(this,So,new Yl(Utt,this.aspect,50,1e5)),w(this,Tt).cameraObject=w(this,So),He(this,II,new _B),w(this,So).renderOrder=999;let M=new Ha;M.add(w(this,So)),He(this,j2,new Ha),w(this,j2).add(M),w(this,$o).add(w(this,j2)),w(this,So).updateProjectionMatrix(),w(this,So).updateMatrixWorld(!0),this.referenceMap={scale:1,latitude:0,longitude:0,getNorth:s(()=>0,"getNorth"),georeference:[{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}}]},this.rendererDomElement=w(this,el).domElement(),He(this,V2,new Jt);let I=new pv(1e6,1e6),P=new ug({color:0,visible:!1});He(this,ny,new Tn(I,P)),w(this,ny).name="worldPlane",w(this,$o).add(w(this,ny)),(l=r.gl)!=null&&l.canvas||e.appendChild(this.rendererDomElement),window.addEventListener("resize",w(this,DI),!1),w(this,TI).addEventListener("change",w(this,LI)),typeof ResizeObserver=="function"&&((u=ja.env)==null?void 0:u.NODE_ENV)!=="test"&&(He(this,u1,new ResizeObserver(PP(k=>{w(this,$2).call(this,k[0].contentRect.width,k[0].contentRect.height)},50))),(c=w(this,u1))==null||c.observe(e)),e.classList.add("mappedin-map"),this.rendererDomElement.style.width=(p=globalThis.MappedinDebug)!=null&&p.TEST_IOS?"1080px":"100%",this.rendererDomElement.style.height=(m=globalThis.MappedinDebug)!=null&&m.TEST_IOS?"1920px":"100%",ja.env.NODE_ENV==="test"&&this.rendererDomElement.setAttribute("data-testid","mappedin-canvas"),w(this,Tt).canvasWidth=this.rendererDomElement.clientWidth,w(this,Tt).canvasHeight=this.rendererDomElement.clientHeight,this.rendererDomElement.style.touchAction="manipulation";let C=this.canvasWidth,T=this.canvasHeight;w(this,Pt).watermarkSystem=new ttt(w(this,So),w(this,Tt),r==null?void 0:r.watermark),w(this,Pt).watermarkSystem.on("texture-loaded",this.render),w(this,Tt).shouldMeasureCanvas=!0,w(this,Tt).pixelRatio=this.resolutionScale,w(this,kI).call(this,Math.floor(C*this.resolutionScale),Math.floor(T*this.resolutionScale));let D=new xde(16777215,.3*Math.PI);D.position.set(-150,-150,350),w(this,$o).add(D);let F=new aje(16777215,.741*Math.PI);w(this,$o).add(F),w(this,Pt).cameraSystem=new G5e(w(this,So),w(this,$o),w(this,el).renderer,w(this,Tt),{mode:this.mode,canvasHeight:T,canvasWidth:C}),w(this,Pt).cameraSystem.on("user-dolly-start",w(this,Su)),w(this,Pt).cameraSystem.on("user-pan-start",w(this,Su)),w(this,Pt).cameraSystem.on("user-rotate-start",w(this,Su)),w(this,Pt).cameraSystem.on("user-zoom-start",w(this,Su)),w(this,Pt).cameraSystem.on("user-tilt-start",w(this,Su)),w(this,Pt).cameraSystem.on("user-pedestal-start",w(this,Su)),w(this,Pt).cameraSystem.on("user-dolly-end",w(this,Mu)),w(this,Pt).cameraSystem.on("user-pan-end",w(this,Mu)),w(this,Pt).cameraSystem.on("user-rotate-end",w(this,Mu)),w(this,Pt).cameraSystem.on("user-zoom-end",w(this,Mu)),w(this,Pt).cameraSystem.on("user-tilt-end",w(this,Mu)),w(this,Pt).cameraSystem.on("user-pedestal-end",w(this,Mu)),w(this,Pt).cameraSystem.on("change",()=>{this.publish("camera-change",this.camera),w(this,Pt).geometryInFocusSystem&&(w(this,Pt).geometryInFocusSystem.cameraDirty=!0),this.render()}),w(this,Pt).pathSystem=new Dtt(w(this,Tt),this.convertTo3DMapPosition,this.getParentContainer,w(this,Pt).cameraSystem.convertZoomLevelToAltitude),w(this,Pt).pathSystem.on("animate:path",this.render),w(this,Pt).panBoundsSystem=new itt(w(this,Tt),w(this,Pt).cameraSystem),w(this,Pt).panBoundsSystem.on("update",()=>{let{panBounds:k,fov:B,convertAltitudeToZoomLevel:U}=w(this,Pt).cameraSystem;if(w(this,Pt).panBoundsSystem.autoMinZoomLevel){if(k.radius<=0)return;let z=Math.min(w(this,Tt).canvasWidth/w(this,Tt).canvasHeight,1),q=B*Math.PI/180*z,Z=Math.tan(q/2),{radius:Q,center:V}=w(this,Pt).cameraSystem.panBounds,ae=Q/Z,Y=this.getThreeCamera().getWorldPosition(new qe),he=V.distanceTo(Y),J=Math.abs(Y.z-V.z),ne=ae*J/he,ee=U(ne);Sge(ee,this.camera.minZoomLevel)&&this.camera.setMinZoomLevel(ee)}}),this.camera=new Het(this,w(this,Pt),w(this,Tt)),this.camera.setZoomLevel((y=r.zoomLevel)!=null?y:CLe),this.camera.setBearing((v=r.bearing)!=null?v:ELe),this.camera.setPitch((x=r.pitch)!=null?x:MLe),this.camera.setMaxZoomLevel(ztt),this.camera.setMinZoomLevel(Btt),w(this,Pt).domVisiblitySystem=new cet(w(this,Tt),w(this,af)),w(this,Pt).domMutationSystem=new Vet(w(this,Tt),w(this,af)),w(this,Pt).domMutationSystem.on("dimensions-update",()=>{w(this,Pt).collisionSystem.collidersDirty=!0,this.render()}),w(this,Pt).domDrawSystem=new zet(w(this,Tt)),w(this,Pt).collisionSystem=new cJe(w(this,Ep),w(this,Tt)),w(this,Pt).twoDDrawSystem=new vet(w(this,Tt),w(this,Mo),r.transformImageRequest),w(this,Pt).twoDDrawSystem.on("img:loaded",this.render),w(this,Pt).interactionSystem=new dJe(this.rendererDomElement,w(this,Tt),w(this,So),w(this,ny),w(this,Pt).cameraSystem.isUserInteracting),w(this,Pt).interactionSystem.on("doubletap-with-onefinger",k=>{var B;this.camera.animateTo({center:(B=this.projectScreenXYToCoordinate(k.clientX,k.clientY))==null?void 0:B.coordinate,zoomLevel:this.camera.zoomLevel+1,duration:wW,easing:"ease-out"})}),w(this,Pt).interactionSystem.on("singletap-with-twofinger",()=>{this.camera.animateTo({zoomLevel:this.camera.zoomLevel-1,duration:wW,easing:"ease-out"})}),w(this,Pt).interactionSystem.on("hover",this.render),w(this,Pt).interactionSystem.on("click",k=>{var B,U,z,q,Z,Q;if(((B=k.entity2D)==null?void 0:B.id)==="watermark"&&typeof w(this,Pt).watermarkSystem.options.onClick=="function"&&w(this,Pt).watermarkSystem.options.interactive){w(this,Pt).watermarkSystem.options.onClick();return}this.publish("click",{coordinate:this.convert3DMapPositionToCoordinate(k.position),geometry:k.entity3D?[(U=k.entity3D)==null?void 0:U.id]:[],paths:((z=k.entity3D)==null?void 0:z.components[0])instanceof gI?[k.entity3D.id]:[],markers:((q=k.entity2D)==null?void 0:q.components[0])instanceof pw?[k.entity2D.id]:[],models:((Z=k.entity3D)==null?void 0:Z.components[0])instanceof fI?[k.entity3D.id]:[],labels:((Q=k.entity2D)==null?void 0:Q.components[0])instanceof p_?[k.entity2D.id]:[],containers:Array.isArray(k.groupContainers)?k.groupContainers.map(V=>V.userData.entityId):[],pointerEvent:k.pointerEvent})}),w(this,Pt).interactionSystem.on("hover",k=>{var B,U,z,q,Z,Q;k.position&&((B=k.entity2D)==null?void 0:B.id)!=="watermark"&&this.publish("hover",{coordinate:this.convert3DMapPositionToCoordinate(k.position),geometry:k.entity3D?[(U=k.entity3D)==null?void 0:U.id]:[],paths:((z=k.entity3D)==null?void 0:z.components[0])instanceof gI?[k.entity3D.id]:[],markers:((q=k.entity2D)==null?void 0:q.components[0])instanceof pw?[k.entity2D.id]:[],models:((Z=k.entity3D)==null?void 0:Z.components[0])instanceof fI?[k.entity3D.id]:[],labels:((Q=k.entity2D)==null?void 0:Q.components[0])instanceof p_?[k.entity2D.id]:[],containers:Array.isArray(k.groupContainers)?k.groupContainers.map(V=>V.userData.entityId):[]})}),w(this,Pt).geometryInFocusSystem=new Stt(w(this,Tt),w(this,So)),w(this,Pt).geometryInFocusSystem.on("geometry-in-focus",k=>{this.publish("geometry-in-focus",k)}),w(this,Pt).twoDVisiblitySystem=new bet(w(this,Tt)),w(this,Pt).drawSystem=new xet(w(this,Tt),this.convertTo3DMapPosition),w(this,Pt).drawSystem.on("texture-loaded",this.render),w(this,Pt).stackSystem=new Eet(w(this,Tt)),w(this,Pt).twoDProjectionSystem=new het(w(this,Tt),w(this,OI)),w(this,Pt).exporterSystem=new XQe(w(this,Tt)),w(this,Pt).meshOptimizationSystem=new uet(w(this,Tt),this.convertTo3DMapPosition),w(this,Pt).meshOptimizationSystem.on("model-loaded",this.render),w(this,Pt).meshOptimizationSystem.on("geometry-2d-added",this.render),w(this,Pt).meshDetachmentSystem=new Rtt(w(this,Tt)),w(this,Pt).meshModificationSystem=new Ott(w(this,Tt)),w(this,Pt).customGeometrySystem=new utt(w(this,Tt),this.convertTo3DMapPosition),w(this,Pt).outlineInterpolationSystem=new htt(w(this,Tt)),w(this,Pt).renderSystem=new wet(w(this,el),w(this,Tt),this.mode,w(this,$o),w(this,So),this.viewCamera,w(this,Pt)),w(this,Pt).imageSystem=new wtt(w(this,Tt),this.convertTo3DMapPosition,r.bearing,r.naturalBearing,r.imagePlacementOptions),w(this,Pt).text3DSystem=new NQe(w(this,Tt),this.convertTo3DMapPosition),w(this,Pt).text3DSystem.on("render",this.render),w(this,Pt).imageSystem.on("image-loaded",this.render),w(this,Pt).renderSystem.on("pre-render",()=>this.publish("pre-render")),w(this,Pt).renderSystem.on("post-render",()=>this.publish("post-render")),w(this,Pt).renderSystem.on("measure-canvas",w(this,G2)),w(this,Pt).outdoorLayersSystem=new Ett(this.map),w(this,Pt).occlusion2DSystem=new Ftt(w(this,Tt),this.convertTo3DMapPosition,w(this,el)),r.occlusionEnabled&&w(this,Pt).occlusion2DSystem.enable(),this.Debug=new Ntt(this),r.environment!==!1&&He(this,l1,dr(this,Ph,MN).call(this)),w(this,AN).call(this)}get viewCamera(){return w(this,II)}get canvasWidth(){return w(this,Tt).canvasWidth}get canvasHeight(){return w(this,Tt).canvasHeight}get resolutionScale(){var e,r;return(r=(e=this.map)==null?void 0:e._getClampedPixelRatio(this.canvasWidth,this.canvasHeight))!=null?r:uw()}get aspect(){return this.canvasWidth/this.canvasHeight}get mode(){return w(this,xy)}addGroupContainer(e,r,i){if(!w(this,Tt).geometry3DMap.has(e)&&!w(this,Tt).geometry2DMap.has(e)){let n=new Yn(e);n.addEventListener("childadded",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),n.addEventListener("childremoved",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),(r==null?void 0:r.visible)!==void 0&&(n.visible=r.visible),(r==null?void 0:r.altitude)!==void 0&&n.setAltitude(r.altitude),(r==null?void 0:r.interactive)!==void 0&&Ml(n,r.interactive,w(this,Tt)),(r==null?void 0:r.focusable)!==void 0&&tN(n,r.focusable),(r==null?void 0:r.preloadGeometry)!==void 0&&(n.userData.preloadGeometry=r.preloadGeometry),w(this,Tt).geometry3DMap.set(e,n);let a=this.getParentContainer(i);a instanceof Yn&&a.addEntity(n),w(this,Ea).call(this),this.render()}else Vt.error("Group container with ID '".concat(e,"' already exists. The group container cannot be added."));return{id:e,type:"group-container"}}addStackContainer(e,r,i){if(w(this,Tt).geometry3DMap.has(e))Vt.error("Stack container with ID '".concat(e,"' already exists. The stack container cannot be added."));else{let n=new Yn(e);n.addEventListener("childadded",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),n.addEventListener("childremoved",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),n.components[0]=new Uet,(r==null?void 0:r.visible)!==void 0&&(n.visible=r.visible),w(this,Tt).geometry3DMap.set(e,n);let a=this.getParentContainer(i);a instanceof Yn&&a.addEntity(n)}return{id:e,type:"stack-container"}}addCustomGeometry(e,r,i,n,a){if(w(this,Tt).geometry3DMap.has(e))Vt.error("Custom geometry with ID '".concat(e,"' already exists. The custom geometry cannot be added."));else{let o=new VD(r,i),l=new za(o,new u_(n));(n==null?void 0:n.interactive)!==void 0&&Ml(l,n.interactive,w(this,Tt)),l.id=e,o.mesh.userData={entityId:e,type:"custom-geometry"},w(this,Tt).geometry3DMap.set(l.id,l);let u=this.getParentContainer(a);u instanceof Yn&&u.addEntity(l),w(this,Ea).call(this),this.render()}return{id:e,type:"custom-geometry"}}addGeometryGroup(e,r,i,n){var a,o;if(!w(this,Tt).geometry3DMap.has(e)&&!w(this,Tt).geometry2DMap.has(e)){let l=new Fu(e,new zO(i));l.addEventListener("childadded",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),l.addEventListener("childremoved",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),l.userData.dirty=!0,w(this,Tt).geometry3DMap.set(e,l);for(let c of r.features){if(c.geometry==null||!["Polygon","MultiPolygon","LineString","MultiLineString"].includes(c.geometry.type))continue;let p=(c==null?void 0:c.id)||((a=c==null?void 0:c.properties)==null?void 0:a.id)||ga(),m=i||{color:BO},{visible:y}=m,v=Nh(m,["visible"]),x=w(this,Pt).meshOptimizationSystem.createEntityFromFeature(p,c,vt(Ee({},v),{outline:!0}));w(this,Tt).geometry3DMap.set(p,x),l.userData.entities3D.add(p)}l.setVisible((o=i==null?void 0:i.visible)!=null?o:!0),(i==null?void 0:i.altitude)!=null&&l.setAltitude(i.altitude);let u=this.getParentContainer(n);u instanceof Yn&&u.addEntity(l),w(this,Ea).call(this),this.render()}else Vt.error("Geometry group with ID '".concat(e,"' already exists. The geometry group cannot be added."));return w(this,Pt).outlineInterpolationSystem.geometries3DDirty=!0,{id:e,type:"geometry-group"}}addOccluder(e,r){let i=this.getParentContainer(r),n=w(this,Pt).occlusion2DSystem.reserveOccluderId();return i==null||i.addOccluderFeature(e,n),n}addImage(e,r,i,n){try{nLe(e,r,i)}catch(a){Vt.error(a);return}if(!w(this,Tt).geometry3DMap.has(e)&&!w(this,Tt).geometry2DMap.has(e)){let a=new mtt(r),o=new za(a,new u_(i));o.id=e||ga(),a.mesh.userData={entityId:o.id,type:"path"},w(this,Tt).geometry3DMap.set(o.id,o);let l=this.getParentContainer(n);l instanceof Yn&&l.addEntity(o),w(this,Ea).call(this),this.render()}else Vt.error("Image with ID '".concat(e,"' already exists. The image cannot be added."));return{id:e,type:"image"}}addModelGroup(e,r,i,{parent:n,onComplete:a}={}){var o,l;try{y5e(e,r,i)}catch(u){Vt.error(u);return}if(!w(this,Tt).geometry3DMap.has(e)&&!w(this,Tt).geometry2DMap.has(e)){let u=new Fu(e,new zO(vt(Ee({},i),{outline:!1})));u.addEventListener("childadded",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),u.addEventListener("childremoved",()=>{w(this,Ea).call(this),w(this,ws).call(this)}),w(this,Tt).geometry3DMap.set(e,u),u.userData.dirty=!0,u.userData.modelURL=i.url;for(let p of r.features){let m=p.id||p.properties.id||ga(),y=w(this,Pt).meshOptimizationSystem.createModelFromFeature(m,p,i);(p.properties.interactive!==void 0||i.interactive!=null)&&Ml(y,(o=p.properties.interactive)!=null?o:i.interactive,w(this,Tt)),w(this,Tt).geometry3DMap.set(m,y),u.userData.entities3D.add(m)}let c=this.getParentContainer(n);c instanceof Yn&&c.addEntity(u),w(this,Ea).call(this),(l=this.render())==null||l.then(a)}else Vt.error("Model group with ID '".concat(e,"' already exists. The model group cannot be added."));return{id:e,type:"geometry-group"}}addMarker2D(e,r,i,n){var a;let o=i==null?void 0:i.id;try{l4e(e,r,i||{})}catch(l){Vt.error(l);return}if(o===void 0||!w(this,Tt).geometry2DMap.has(o)&&!w(this,Tt).geometry3DMap.has(o)){let l=dr(this,Ph,SN).call(this,e,new pw(r,i),i==null?void 0:i.occluderId,i==null?void 0:i.verticalOffset);l.id=o||String(l.id),o=l.id,(i==null?void 0:i.interactive)!=null&&i.interactive!=="pointer-events-auto"&&Ml(l,i==null?void 0:i.interactive,w(this,Tt));let u=typeof(i==null?void 0:i.attachTo)=="string"||typeof(i==null?void 0:i.attachTo)=="number"?w(this,Tt).geometry3DMap.get(i.attachTo):void 0;u instanceof za&&u.attach(l),(a=this.getParentContainer(n))==null||a.addEntity(l),this.render()}else Vt.error("Marker2D with ID '".concat(o,"' already exists. The marker cannot be added."));return{id:o,type:"marker"}}addText3D(e,r,i,n){if(!w(this,Tt).geometry3DMap.has(e)&&!w(this,Tt).geometry2DMap.has(e)){let a=new sI(vt(Ee({},r),{properties:vt(Ee({},r.properties),{id:e,content:r.properties.text})})),o=new za(a,new VO(i==null?void 0:i.appearance));o.id=e,a.mesh.userData.entityId=e.toString(),a.mesh.userData.type="text3d",w(this,Tt).geometry3DMap.set(e,o);let l=this.getParentContainer(n);l instanceof Yn&&l.addEntity(o),w(this,Ea).call(this),this.render()}else Vt.error("Text3D with ID '".concat(e,"' already exists. The text3d cannot be added."));return{id:e,type:"text3d"}}labelText3D(e,r,i={}){var n,a;try{if(!r||!e)throw new Error("content and meshGeometryId are required");UQe.parse(i)}catch(p){Vt.error(p);return}let o=w(this,Tt).geometry3DMap.get(e);if((o==null?void 0:o.type)!=="geometry"){Vt.error(".labelText3D failed: target incorrect");return}let l=o==null?void 0:o.components[0];if(!l.feature.properties.textArea)return;if(l.textEntityId){let p=w(this,Tt).geometry3DMap.get(l.textEntityId);if((p==null?void 0:p.type)!=="text3d"){Vt.error(".labelText3D failed: existing text3d not found");return}return{id:p.id,type:p.type}}let u=new sI({type:"Feature",geometry:{coordinates:(n=l.feature.properties.textArea)==null?void 0:n.position,type:"Point"},properties:{textArea:l.feature.properties.textArea,content:r,id:ga()}});u.polygonEntityId=e;let c=new za(u,new VO(i==null?void 0:i.appearance));return l.textEntityId=c.id.toString(),u.mesh.userData.entityId=c.id.toString(),u.mesh.userData.type="text3d",w(this,Tt).geometry3DMap.set(c.id.toString(),c),i.parentId&&((a=this.getParentContainer(i.parentId))==null||a.addEntity(c)),this.render(),{id:c.id,type:"text3d"}}addLabel2D(e,r,i,n){var a;let o=i==null?void 0:i.id;try{D4e(e,r,i||{})}catch(l){Vt.error(l);return}if(o===void 0||!w(this,Tt).geometry2DMap.has(o)&&!w(this,Tt).geometry3DMap.has(o)){let l=dr(this,Ph,SN).call(this,e,new p_(r,i||{},w(this,Tt)),i==null?void 0:i.occluderId,i==null?void 0:i.verticalOffset);l.id=o||String(l.id),o=l.id,(i==null?void 0:i.interactive)!=null&&Ml(l,i==null?void 0:i.interactive,w(this,Tt));let u=typeof(i==null?void 0:i.attachTo)=="string"||typeof(i==null?void 0:i.attachTo)=="number"?w(this,Tt).geometry3DMap.get(i.attachTo):void 0;u instanceof za&&u.attach(l),(a=this.getParentContainer(n))==null||a.addEntity(l),w(this,ws).call(this),this.render()}else Vt.error("Label2D with ID '".concat(o,"' already exists. The label cannot be added."));return{id:o,type:"label"}}addPath(e,r={},i){var n;try{L5e(e,r||{})}catch(u){Vt.error(u);return}let a=new gI(e,fj(r)),o=new za(a,new u_({color:(n=r==null?void 0:r.color)!=null?n:"#ff834c"}));o.id=(r==null?void 0:r.id)||ga(),a.mesh.userData={entityId:o.id,type:"path"},w(this,Tt).geometry3DMap.set(o.id,o),(r==null?void 0:r.interactive)!=null&&Ml(o,r==null?void 0:r.interactive,w(this,Tt));let l=this.getParentContainer(i);return l instanceof Yn&&l.addEntity(o),w(this,Ea).call(this),this.render(),{id:o.id,type:"path"}}updateWatermark(e){w(this,Pt).watermarkSystem.options=e,w(this,Pt).watermarkSystem.dirty=!0,w(this,Pt).collisionSystem.collidersDirty=!0,this.render()}remove(e){var r;let i;if(typeof e=="string"||typeof e=="number"?(i=w(this,Tt).geometry2DMap.get(e),i==null&&(i=w(this,Tt).geometry3DMap.get(e))):typeof e.id=="string"||typeof e.id=="number"?(i=w(this,Tt).geometry2DMap.get(e.id),i==null&&(i=w(this,Tt).geometry3DMap.get(e.id))):i=e,i!=null){if(i.type==="custom-geometry")w(this,Tt).geometry3DMap.delete(i.id),i.object3d&&El(i.object3d);else if(i.type==="group-container"){w(this,Tt).geometry3DMap.delete(i.userData.entityId);for(let a of i.childrenIds.values())this.remove(a),i.userData.entities2D.delete(a);let n=i.components[2];n&&n.focusMesh&&El(n.focusMesh),El(i)}else if(i.type==="geometry-group"){w(this,Tt).geometry3DMap.delete(i.userData.entityId);for(let n of i.userData.entities3D.values())this.remove(n),i.userData.entities3D.delete(n);El(i)}else if(i.type==="geometry"||i.type==="model"||i.type==="path"){let n=i.components[0];if(i.entities2D.size>0){for(let a of i.entities2D.values())this.remove(a);i.removeAllEntities()}if(i.object3d&&(((r=i.parentObject3D)==null?void 0:r.type)==="geometry-group"&&i.parentObject3D.userData.entities3D.delete(i.id),El(i.object3d)),i.type==="geometry"){let a=i.components[3];a&&(a.visible=!1,a.dirty=!0)}"focusMesh"in n&&n.focusMesh!=null&&El(n.focusMesh),"textMesh"in n&&n.textMesh!=null&&this.remove(n.textMesh.userData.entityId),w(this,Tt).geometry3DMap.delete(i.id)}else if(i.type==="marker"||i.type==="label"){let n=i.attachedTo;if(n){let a=w(this,Tt).geometry3DMap.get(n);a instanceof za&&a.detach(i)}i.object3d&&El(i.object3d),i.type==="label"&&delete w(this,Pt).twoDDrawSystem.textCache[i.id],w(this,Tt).geometry2DMap.delete(i.id)}else if(i.type==="image")i.object3d&&El(i.object3d),w(this,Tt).geometry3DMap.delete(i.id);else if(i.type==="text3d"){El(i.object3d);let{batchedText:n,textMesh:a,polygonEntityId:o}=i.components[0];if(a&&(n&&n.removeText(a),El(a)),o){w(this,Pt).text3DSystem.remove(o);let l=w(this,Tt).geometry3DMap.get(o);(l==null?void 0:l.type)==="geometry"&&(l.components[0].textMesh=void 0,l.components[0].textEntityId=void 0)}w(this,Tt).geometry3DMap.delete(i.id)}w(this,Ea).call(this),w(this,ws).call(this),this.render()}}getScene(){return this.getState("__scene")}getThreeScene(){return w(this,$o)}getThreeCamera(){return w(this,So)}async setEnvironment(e){if(w(this,$o))if(e==="basic"){w(this,l1)||He(this,l1,dr(this,Ph,MN).call(this));let r=await w(this,l1);w(this,$o).environment=r}else w(this,$o).environment=null}getEnvironment(){var e;return(e=w(this,$o))!=null&&e.environment?"basic":!1}getCurrentSceneGLTF(e){return w(this,Pt).exporterSystem.getCurrentSceneGLTF(e)}getBoundingArea(e){(w(this,Pt).renderSystem.threeDdirty||w(this,Pt).renderSystem.twoDdirty)&&this.renderSync();let r=new to;if(e==null)r.setFromObject(w(this,Tt).entityScene);else{let i=N1(w(this,Tt),e);if((i==null?void 0:i.type)==="geometry"&&(i==null?void 0:i.object3d)!=null){let n=i.components[0],a=n instanceof tu?n.geometry:void 0;n.mesh instanceof bB&&a?(a.computeBoundingBox(),a.boundingBox&&r.union(a.boundingBox)):r.setFromObject(i.object3d)}else((i==null?void 0:i.type)==="geometry-group"||(i==null?void 0:i.type)==="group-container")&&(i==null?void 0:i.userData.entityId)!=null&&r.setFromObject(i)}if(KT(r))return dge(r).map(this.convert3DMapPositionToCoordinate)}getState(e){var r,i,n,a,o,l,u,c,p,m;if(e==null)return{type:"map-view",hoverColor:w(this,Tt).hoverColor,text3dHoverColor:w(this,Tt).text3dHoverColor};let y=N1(w(this,Tt),e);if((y==null?void 0:y.type)==="custom-geometry"){let v=y.components[0],x=y.components[1];return{id:y.id,type:"custom-geometry",visible:x.visible,altitude:x.altitude,parent:(r=y.parentObject3D)==null?void 0:r.userData.entityId,position:this.convert3DMapPositionToCoordinate(v.position)}}else if((y==null?void 0:y.type)==="geometry-group"){let v=[];for(let E of y.userData.entities3D.values()){let M=this.getState(E);((M==null?void 0:M.type)==="geometry"||(M==null?void 0:M.type)==="model")&&v.push(M)}let x=y.components[0];return{id:y.userData.entityId,type:"geometry-group",visible:y.visible,opacity:x.opacity,color:x.color,initialColor:x.initialColor,height:x.height,altitude:y.altitude,topColor:x.topColor,outline:x.outline,shading:x.shading,texture:x.texture,topTexture:x.topTexture,interactive:Array.from(y.userData.entities3D.values()).map(E=>w(this,Tt).geometry3DMap.get(E)).every(E=>E&&E.components[2]!=null),children:Array.from(y.userData.entities3D.values()).map(E=>this.getState(E)).filter(Boolean)}}else{if((y==null?void 0:y.type)==="group-container")return{id:y.userData.entityId,type:"group-container",visible:y.visible,altitude:y.altitude,opacity:y.opacity,interactive:!!y.components[1],children:Array.from(y.childrenIds.values()).map(v=>this.getState(v)).filter(Boolean)};if((y==null?void 0:y.type)==="label"){let v=y.components[0],x=y.object3d.parent,E=x==null?void 0:x.userData.entityId;return{id:y.id,type:"label",text:v.text||"",parent:{id:E,type:x==null?void 0:x.type},position:this.convert3DMapPositionToCoordinate(y.position),enabled:v.enabled,visible:v.visible,initialRank:P2(v.initialRank),options:{rank:P2(v.rank),appearance:v.appearance,interactive:y.components[1]!=null,verticalOffset:y.verticalOffset,attachTo:y.attachedTo}}}else if((y==null?void 0:y.type)==="marker"){let v=y.components[0],x=y.object3d.parent,E=x==null?void 0:x.userData.entityId;return{id:y.id,type:"marker",enabled:v.enabled,visible:v.visible,anchor:v.options.anchor,dynamicResize:v.options.dynamicResize,parent:{id:E,type:x==null?void 0:x.type},position:this.convert3DMapPositionToCoordinate(y.position),element:v.containerEl,initialRank:P2(v.initialRank),options:{rank:P2(v.rank),interactive:y.components[1]!=null||!1,verticalOffset:y.verticalOffset,attachTo:y.attachedTo,lowPriorityPin:v.options.lowPriorityPin}}}else if((y==null?void 0:y.type)==="geometry"){let{color:v,hoverColor:x,initialColor:E,initialTopColor:M,topColor:I}=y.components[1],P=y.components[0],C=y.components[1],T=y.components[2],D=y.components[3],F=y.parentObject3D;return{id:y.id,type:"geometry",opacity:C.opacity,initialColor:E,color:v,focusable:P.focusable,initialTopColor:M,topColor:I,hoverColor:x,hovered:!!(T!=null&&T.hover),height:C.height,visible:C.visible,outline:D==null?void 0:D.visible,showImage:C.showImage,texture:C.texture,topTexture:C.topTexture,flipImageToFaceCamera:C.flipImageToFaceCamera,parent:{id:F==null?void 0:F.userData.entityId,type:F==null?void 0:F.type},position:this.convert3DMapPositionToCoordinate(P.position),interactive:y.components[2]!=null}}else if((y==null?void 0:y.type)==="model"){let v=y.components[0],x=y.components[1],E=y.components[2];return{id:y.id,type:"model",position:v.mesh?this.convert3DMapPositionToCoordinate((i=v.mesh)==null?void 0:i.getWorldPosition(new qe)):this.convert3DMapPositionToCoordinate(v.position),interactive:E!=null,material:x.material,parent:(n=y.parentObject3D)!=null&&n.parent?{id:y.parentObject3D.parent.userData.entityId,type:y.parentObject3D.parent.type}:void 0,visible:x.visible,verticalOffset:x.verticalOffset,color:x.color,opacity:x.opacity,rotation:(a=x.rotation)!=null?a:hC,scale:(o=x.scale)!=null?o:cC}}else if((y==null?void 0:y.type)==="path"){let v=y.components[0],x=y.components[2],E=y.components[1];return{id:y.id,type:"path",position:this.convert3DMapPositionToCoordinate(v.position),visible:E.visible,interactive:x!=null,completeFraction:v.completeFraction,color:E.color,accentColor:v.accentColor,nearRadius:v.nearRadius,farRadius:v.farRadius,animateArrowsOnPath:v.animateArrowsOnPath,displayArrowsOnPath:v.displayArrowsOnPath,nearZoomLevel:v.nearZoomLevel,farZoomLevel:v.farZoomLevel}}else if((y==null?void 0:y.type)==="image"){let v=y.components[0];return{id:y.id,type:"image",position:this.convert3DMapPositionToCoordinate(v.position),visible:y.components[1].visible,verticalOffset:(l=v.feature.properties.verticalOffset)!=null?l:0,flipImageToFaceCamera:y.components[1].flipImageToFaceCamera}}else if((y==null?void 0:y.type)==="text3d"&&y.components[0]instanceof sI&&"textArea"in y.components[0].feature.properties){a5e(y);let v=y.components[0],x=y.components[1],{textMesh:E}=v,M=(u=v.mesh)==null?void 0:u.parent;M instanceof Yn&&((c=M.children.find(P=>P.type==="batchedtext"))==null||c.getWorldPosition(w(this,FI))),w(this,H2).set(0,0,0);let I=E?E.getWorldPosition(w(this,H2)):w(this,H2);return Object.assign({},cw,x.getState(),{id:y.id,type:"text3d",position:this.convert3DMapPositionToCoordinate(I.add(w(this,FI))),visible:(p=v.visible)!=null?p:!1,content:(m=v.feature.properties.content)!=null?m:""})}else return}}setState(e,r){var i,n;if(typeof e=="object"&&r==null){"hoverColor"in e&&(w(this,Tt).hoverColor=(i=e.hoverColor)!=null?i:w(this,Tt).hoverColor),"text3dHoverColor"in e&&(w(this,Tt).text3dHoverColor=(n=e.text3dHoverColor)!=null?n:w(this,Tt).text3dHoverColor);return}let a=N1(w(this,Tt),e);if(a!=null){if(a.type==="custom-geometry"){let o=w(this,Tt).geometry3DMap.get(a.id);if(o instanceof za&&o.components[0]instanceof VD){let l=r;Cp(a,w(this,Tt),l.visible),lI(a,l.altitude),K8(a,l.position,this.convertTo3DMapPosition),J8(a,this.getParentContainer(l.parent,!1))}}else if(a.type==="path"){let o=r;Ml(a,o.interactive,w(this,Tt))&&w(this,Ea).call(this),lI(a,o.altitude),n5e(a,w(this,Tt),o)}else if(a.type==="model"){let o=r;Ml(a,o.interactive,w(this,Tt))&&w(this,Ea).call(this),Cp(a,w(this,Tt),o.visible),l5e(a,o)}else if(a.type==="group-container"){let o=r;Cp(a,w(this,Tt),o.visible)&&(w(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0,w(this,Pt).pathSystem.altitudeDirty=!0),lI(a,o.altitude)&&(w(this,Pt).pathSystem.altitudeDirty=!0),Ml(a,o.interactive,w(this,Tt))&&w(this,Ea).call(this),eN(a,w(this,Tt),o.opacity)&&(w(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),o.preloadGeometry&&a.userData.preloadGeometry!==!0&&(a.userData.preloadGeometry=!0,w(this,Pt).outlineInterpolationSystem.geometries3DDirty=!0)}else if(a.type==="geometry-group"){let o=r;Cp(a,w(this,Tt),o.visible)&&(w(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),q4e(a,w(this,Tt),o),V3(a,w(this,Tt),o.outline),o.height!=null&&Y8(a,w(this,Tt),o.height),o.altitude!=null&&a.setAltitude(o.altitude),e5e(a,o),W4e(a,o.shading),eN(a,w(this,Tt),o.opacity)&&(w(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),Ml(a,o.interactive,w(this,Tt))&&(w(this,Ea).call(this),w(this,ws).call(this))}else if(a.type==="geometry"){if(a.components[0]instanceof tu){let o=r;Cp(a,w(this,Tt),o.visible)&&(w(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),V3(a,w(this,Tt),o.outline),X4e(a,o),tN(a,o.focusable)&&(w(this,Pt).geometryInFocusSystem.focusablesDirty=!0),i5e(a,o.renderOrder)&&(w(this,Pt).meshDetachmentSystem.dirty=!0),r5e(a,o.opacity)&&(w(this,Pt).meshDetachmentSystem.dirty=!0,w(this,Pt).outlineInterpolationSystem.outlineOpacitiesDirty=!0),Q8(a,o.flipImageToFaceCamera),o.height!=null&&Y8(a,w(this,Tt),o.height),t5e(a,o)&&(w(this,Pt).meshDetachmentSystem.dirty=!0),hj(a,o),J4e(a,o.hoverColor),Ml(a,o.interactive,w(this,Tt)),Q4e(a,o.hovered)}w(this,Ea).call(this)}else if(a.type==="label"||a.type==="marker"){let o=r;K4e(a,r,w(this,Tt)),Y4e(a,r,w(this,Tt))&&(w(this,ws).call(this),w(this,Pt).domMutationSystem.dirty=!0),K8(a,o.position,this.convertTo3DMapPosition),J8(a,this.getParentContainer(o.parent,!1))&&(w(this,ws).call(this),w(this,Pt).panBoundsSystem.dirty=!0),Z4e(a,o.enabled),Cp(a,w(this,Tt),o.visible)}else if(a.type==="image"){let o=r;Cp(a,w(this,Tt),o.visible),Q8(a,o.flipImageToFaceCamera)}else if(a.type==="text3d"){let o=r;s5e(a,w(this,Tt),o)}this.render()}}convertTo3DMapPosition(e,r,i=0,n){var a,o,l,u,c;if(Array.isArray(e))return this.convertTo3DMapPosition(e[1],e[0],(a=e[2])!=null?a:i,typeof r=="function"?r:void 0);if(typeof r!="number")throw new Error("convertTo3DMapPosition failed: longitude must be a number");let{x:p,y:m}=VB((l=(o=w(this,Tt).center)==null?void 0:o[1])!=null?l:0,(c=(u=w(this,Tt).center)==null?void 0:u[0])!=null?c:0,e,r);return n?(n.set(p,m,i),n):new qe(p,m,i)}get backgroundColor(){return typeof w(this,el).backgroundColor=="string"?w(this,el).backgroundColor:"#".concat(w(this,el).backgroundColor.getHexString())}get backgroundAlpha(){return w(this,el).backgroundAlpha}getThreeRenderer(){return w(this,el)}getCenter(e){let r=Array.isArray(e)?e:this.getBoundingArea(e);return r?Age(r):void 0}isInView(e){let r=N1(w(this,Tt),e);if(w(this,NI).identity().multiply(w(this,So).projectionMatrix).multiply(w(this,So).matrixWorldInverse),w(this,c1).setFromProjectionMatrix(w(this,NI)),r instanceof k_)return w(this,c1).containsPoint(r.position);if(r instanceof za){let i=r==null?void 0:r.components[0];if(i instanceof VD||i instanceof fI)return w(this,c1).containsPoint(this.convertTo3DMapPosition(i.feature.geometry.coordinates));if(i instanceof tu){let n=new to(this.convertTo3DMapPosition(i.featureBbox[1],i.featureBbox[0],0),this.convertTo3DMapPosition(i.featureBbox[3],i.featureBbox[2],0));return w(this,c1).intersectsBox(n)}}return!1}getSystems(){return w(this,Pt)}getInternalState(){return w(this,Tt)}getTweenGroup(){return w(this,Tt).tweenGroup}};$o=new WeakMap,So=new WeakMap,l1=new WeakMap,II=new WeakMap,V2=new WeakMap,ny=new WeakMap,u1=new WeakMap,j2=new WeakMap,Ph=new WeakSet,wN=s(function(t){var e;w(this,xy)!=="outdoors-overlay"&&((e=this.map)==null||e.setPixelRatio(t)),w(this,Tt).pixelRatio=this.resolutionScale},"#setResolutionScale"),Tt=new WeakMap,fa=new WeakMap,Ep=new WeakMap,Mo=new WeakMap,af=new WeakMap,el=new WeakMap,Pt=new WeakMap,TI=new WeakMap,ws=new WeakMap,Ea=new WeakMap,ILe=s(function(){He(this,fa,document.createElement("div")),w(this,fa).classList.add("mappedin__smart-collision-engine__container"),He(this,Ep,document.createElement("canvas")),w(this,Ep).classList.add("mappedin__smart-collision-engine-debug__container"),this.container.appendChild(w(this,fa)),He(this,Mo,document.createElement("canvas")),w(this,Mo).classList.add("mappedin__smart-collision-engine__container"),w(this,Mo).width=w(this,fa).clientWidth*this.resolutionScale,w(this,Mo).height=w(this,fa).clientHeight*this.resolutionScale,w(this,Mo).style.width=w(this,fa).clientWidth+"px",w(this,Mo).style.height=w(this,fa).clientHeight+"px",w(this,fa).appendChild(w(this,Ep)),w(this,fa).appendChild(w(this,Mo)),w(this,Ep).width=w(this,fa).clientWidth,w(this,Ep).height=w(this,fa).clientHeight,w(this,Mo).width=w(this,fa).clientWidth*this.resolutionScale,w(this,Mo).height=w(this,fa).clientHeight*this.resolutionScale,w(this,Mo).style.width=w(this,fa).clientWidth+"px",w(this,Mo).style.height=w(this,fa).clientHeight+"px"},"#renderEntity2DContainer"),TLe=s(function(){He(this,af,document.createElement("div")),w(this,af).classList.add("mappedin-2d-entities"),Object.assign(w(this,af).style,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",pointerEvents:"none","transform-style":"preserve-3d"}),this.container.appendChild(w(this,af))},"#renderEntityDOMContainer"),PLe=s(function(){w(this,Mo).width=w(this,fa).clientWidth*this.resolutionScale,w(this,Mo).height=w(this,fa).clientHeight*this.resolutionScale,w(this,Mo).style.width=w(this,fa).clientWidth+"px",w(this,Mo).style.height=w(this,fa).clientHeight+"px",w(this,Ep).width=w(this,fa).clientWidth,w(this,Ep).height=w(this,fa).clientHeight,w(this,Mo).width=w(this,fa).clientWidth*this.resolutionScale,w(this,Mo).height=w(this,fa).clientHeight*this.resolutionScale,w(this,Mo).style.width=w(this,fa).clientWidth+"px",w(this,Mo).style.height=w(this,fa).clientHeight+"px",w(this,Pt).collisionSystem.collidersDirty=!0},"#resizeCollisionCanvas"),xy=new WeakMap,PI=new WeakMap,LI=new WeakMap,DI=new WeakMap,$2=new WeakMap,AN=new WeakMap,RI=new WeakMap,OI=new WeakMap,kI=new WeakMap,G2=new WeakMap,SN=s(function(t,e,r,i){let n=new k_(e,this.convertTo3DMapPosition(t[1],t[0],t[2]||0),i);return n.occluderId=r??w(this,Pt).occlusion2DSystem.backgroundId,w(this,Tt).geometry2DMap.set(n.id,n),n},"#createEntity2D"),c1=new WeakMap,NI=new WeakMap,Su=new WeakMap,Mu=new WeakMap,MN=s(async function(){return W4.load(oJe).then(t=>{var e;return w(this,$o)&&((e=w(this,$o).environment)==null||e.dispose(),t.mapping=FT,w(this,$o).environment=t,this.render()),t})},"#loadEnvMap"),H2=new WeakMap,FI=new WeakMap,s(LLe,"Core");var Vtt=LLe,EN=Vtt;N();function jtt(t,e){DLe(t,e)(t.getScene(),e),RLe(t,e),e.addFolder("Export").add({export:s(async()=>{let n=await t.getCurrentSceneGLTF({binary:!0}),a=new Blob([n],{type:"application/octet-stream"});var o=document.createElement("a");document.body.appendChild(o),o.style.display="none";let l=window.URL.createObjectURL(a);o.href=l,o.download="scene.glb",o.click(),window.URL.revokeObjectURL(l)},"export")},"export");let r=e.addFolder("Camera"),i={get bearing(){return t.camera.bearing},set bearing(n){t.camera.setBearing(n)},get pitch(){return t.camera.pitch},set pitch(n){t.camera.setPitch(n)},get zoomLevel(){return t.camera.zoomLevel},set zoomLevel(n){t.camera.setZoomLevel(n)}};r.add(i,"bearing",-359,359,1),r.add(i,"pitch",t.camera.minPitch,t.camera.maxPitch,1),r.add(i,"zoomLevel",t.camera.minZoomLevel,t.camera.maxZoomLevel,.1)}s(jtt,"mountSceneGraphVisualizer");function DLe(t,e){let r=e;return s(function i(n,a){let o=a.addFolder("".concat([n.type]," ").concat(n.id.slice(0,16)));if(a.close(),n.type==="geometry"||n.type==="model"||n.type==="path"||n.type==="image"){let l={get height(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"?u.height:0},set height(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(n,{height:u})},set flipImageToFaceCamera(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="image"&&t.setState(n,{flipImageToFaceCamera:u})},get flipImageToFaceCamera(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="image"?u.flipImageToFaceCamera:!1},set visible(u){let c=t.getState(n.id);((c==null?void 0:c.type)==="geometry"||(c==null?void 0:c.type)==="path"||(c==null?void 0:c.type)==="image")&&t.setState(n,{visible:u})},get visible(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="path"||(u==null?void 0:u.type)==="image"?u.visible:!1},set outline(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(n,{outline:u})},get outline(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"?u.outline:!1},get opacity(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"?u.opacity:1},set opacity(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(c,{opacity:u})},get color(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"&&u.color?ii(u.color).toHexString():"#ffffff"},set color(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry"&&t.setState(c,{color:u})},set interactive(u){let c=t.getState(n.id);((c==null?void 0:c.type)==="geometry"||(c==null?void 0:c.type)==="model"||(c==null?void 0:c.type)==="path")&&(t.setState(n,{interactive:u}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get interactive(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="model"||(u==null?void 0:u.type)==="path"?u.interactive:!1},get completeFraction(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="path"?u.completeFraction:1},set completeFraction(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="path"&&t.setState(c,{completeFraction:u})},focus:s(()=>{},"focus")};o.add(l,"focus").onChange(()=>{let u=t.getState(n.id);(u==null?void 0:u.type)==="model"||(u==null?void 0:u.type)==="path"||(u==null?void 0:u.type)==="image"?t.camera.focusOn([u.position]):(u==null?void 0:u.type)==="geometry"&&t.camera.focusOn(t.getBoundingArea(u))}),o.add(l,"visible"),n.type==="image"?o.add(l,"flipImageToFaceCamera"):(o.add(l,"interactive"),n.type==="path"&&o.add(l,"completeFraction",0,1,.1),n.type!=="model"&&(o.addColor(l,"color"),o.add(l,"outline"))),n.type==="geometry"&&(o.add(l,"height"),o.add(l,"opacity",0,1,.1))}else if(n.type==="marker"){let l={get interactive(){var u;let c=t.getState(n.id);return(c==null?void 0:c.type)==="marker"?(u=c.options)==null?void 0:u.interactive:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="marker"&&(t.setState(c,{options:{interactive:u}}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},focus:s(()=>{},"focus")};o.add(l,"focus").onChange(()=>{let u=t.getState(n.id);(u==null?void 0:u.type)==="marker"&&t.camera.focusOn([u.position])}),o.add(l,"interactive")}else if(n.type==="label"){let l={get interactive(){var u;let c=t.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=c.options)==null?void 0:u.interactive:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&(t.setState(c,{options:{interactive:u}}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get text(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="label"?u.text:""},set text(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(c,{text:u})},get"Text Color"(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=p.options.appearance)==null?void 0:u.text)==null?void 0:c.foregroundColor:"#000000"},set"Text Color"(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(n.id,{text:l.text,options:{appearance:{text:{foregroundColor:u}}}})},get"Text Size"(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=p.options.appearance)==null?void 0:u.text)==null?void 0:c.size:10},set"Text Size"(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(c,{text:l.text,options:{appearance:{text:{size:u}}}})},get"Icon Size"(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.iconSize:10},set"Icon Size"(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="label"&&t.setState(c,{text:l.text,options:{appearance:{marker:{iconSize:u}}}})},get"Active Foreground Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor)==null?void 0:p.active:"#000000"},set"Active Foreground Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{foregroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.foregroundColor),{active:u})}}}})},get"Inactive Foreground Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor)==null?void 0:p.inactive:"#000000"},set"Inactive Foreground Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{foregroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.foregroundColor),{inactive:u})}}}})},get"Active Background Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor)==null?void 0:p.active:"#000000"},set"Active Background Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{backgroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.backgroundColor),{active:u})}}}})},get"Inactive Background Color"(){var u,c,p;let m=t.getState(n.id);return(m==null?void 0:m.type)==="label"?(p=(c=(u=m.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor)==null?void 0:p.inactive:"#000000"},set"Inactive Background Color"(u){var c,p;let m=t.getState(n.id);(m==null?void 0:m.type)==="label"&&t.setState(m,{text:l.text,options:{appearance:{marker:{backgroundColor:vt(Ee({},(p=(c=m.options.appearance)==null?void 0:c.marker)==null?void 0:p.backgroundColor),{inactive:u})}}}})},focus:s(()=>{},"focus")};o.add(l,"focus").onChange(()=>{let u=t.getState(n.id);(u==null?void 0:u.type)==="label"&&t.camera.focusOn([u.position])}),o.add(l,"interactive"),o.add(l,"text"),o.add(l,"Text Size",10,50),o.add(l,"Icon Size",10,50),o.addColor(l,"Text Color"),o.addColor(l,"Active Background Color"),o.addColor(l,"Inactive Background Color"),o.addColor(l,"Active Foreground Color"),o.addColor(l,"Inactive Foreground Color")}else if(n.type==="geometry-group"){let l={get opacity(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.opacity:1},set opacity(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(n,{opacity:u})},set visible(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(n,{visible:u})},get visible(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.visible:!1},set outline(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(n,{outline:u})},get outline(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.outline:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&(t.setState(n,{interactive:u}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get interactive(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="geometry-group"?u.interactive:!1},get shadingStart(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="geometry-group"&&(c=(u=p.shading)==null?void 0:u.start)!=null?c:0},set shadingStart(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(c,{shading:{start:u}})},get shadingEnd(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="geometry-group"&&(c=(u=p.shading)==null?void 0:u.end)!=null?c:0},set shadingEnd(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(c,{shading:{end:u}})},get shadingIntensity(){var u,c;let p=t.getState(n.id);return(p==null?void 0:p.type)==="geometry-group"&&(c=(u=p.shading)==null?void 0:u.intensity)!=null?c:0},set shadingIntensity(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="geometry-group"&&t.setState(c,{shading:{intensity:u}})}};o.add(l,"visible"),o.add(l,"opacity",0,1,.1),o.add(l,"interactive"),o.add(l,"outline"),o.add(l,"shadingStart",0,1,.1),o.add(l,"shadingEnd",0,1,.1),o.add(l,"shadingIntensity",0,1,.1)}else if(n.type==="group-container"){let l={set visible(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="group-container"&&t.setState(n,{visible:u})},get visible(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="group-container"?u.visible:!1},set interactive(u){let c=t.getState(n.id);(c==null?void 0:c.type)==="group-container"&&(t.setState(c,{interactive:u}),r.controllersRecursive().forEach(p=>p.updateDisplay()))},get interactive(){let u=t.getState(n.id);return(u==null?void 0:u.type)==="group-container"?u.interactive:!1}};o.add(l,"visible"),o.add(l,"interactive")}if(o.close(),n.children)for(let l of n.children.values())i(l,o)},"parseChild")}s(DLe,"createParseChild");function RLe(t,e){let r=e.addFolder("Watermark"),i={padding:16,iconOnly:!1,position:"bottom-left",color:"dark",scale:1};r.add(i,"padding",0,100,1),r.add(i,"scale",.5,1.5,.1),r.add(i,"color",["dark","light"]),r.add(i,"position",["top-left","top-right","bottom-left","bottom-right","center","top","bottom","left","right"]),r.add(i,"iconOnly"),r.onChange(()=>{t.updateWatermark(i)})}s(RLe,"createWatermarkChild");var CX="https://tiles-cdn.mappedin.com/styles/mappedin/style.json",$tt="https://auth.mappedin.com/oauth2/token";async function OLe(t,e){var r,i,n,a,o,l;if((r=e==null?void 0:e.outdoorView)!=null&&r.enabled){let{Map:u,MercatorCoordinate:c}=await ag(()=>import("./outdoor-context-v4-ME4STCCK-BrRUssV-.js"),[]),p=e.outdoorView.headers;p==null&&(p=await xge($tt));let m=e.center||[0,0],y=new u({container:t,style:e.outdoorView.style||CX,center:m,attributionControl:!1,zoom:(i=e.zoomLevel)!=null?i:CLe,pitch:(n=e.pitch)!=null?n:MLe,bearing:(a=e.bearing)!=null?a:ELe,transformRequest:AHe(p),trackResize:!1,pixelRatio:e.outdoorView.lowDpi?1:uw(),antialias:typeof e.antialias=="boolean"?e.antialias:!0,boxZoom:!1,doubleClickZoom:!1,scrollZoom:!1,dragPan:!1,dragRotate:!1,keyboard:!1,touchZoomRotate:!1}),v=y.painter.context.gl,x=new EN(t,{center:m,zoomLevel:y.getZoom(),pitch:y.getPitch(),bearing:y.getBearing(),gl:v,map:y,mode:"outdoors-interleaved",watermark:e.watermark,attribution:e.attribution,antialias:e.antialias,occlusionEnabled:e.occlusionEnabled,transformImageRequest:e.transformImageRequest,naturalBearing:(o=e.naturalBearing)!=null?o:0,imagePlacementOptions:e.imagePlacementOptions,onWebGLContextCreationError:e.onWebGLContextCreationError,onWebGLContextLost:e.onWebGLContextLost,onWebGLContextRestored:e.onWebGLContextRestored,onWebGLRendererError:e.onWebGLRendererError,useStandaloneCamera:(l=e.useStandaloneCamera)!=null?l:!1}),E={center:y.getCenter().toArray(),zoom:y.getZoom(),bearing:y.getBearing(),pitch:y.getPitch()};y.setMinZoom(x.camera.minZoomLevel),y.setMaxZoom(x.camera.maxZoomLevel),x.on("camera-change",D=>{E.center=D.center,E.zoom=D.zoomLevel,E.bearing=D.bearing,E.pitch=D.pitch,y.jumpTo(E)});let M=c.fromLngLat(m,0),I=$B(M,x.viewCamera,x.camera,()=>{x.renderSync()});y.on("style.load",async()=>{y&&(y.addLayer(I),x.renderSync())});let P=!1,C=!1;y.on("idle",()=>{y&&(P||(x.publish("outdoor-view-loaded"),P=!0),C||(C=!0,x.publish("outdoor-style-loaded")))});let T=s(D=>{D&&(D.sourceDataType==="metadata"||D.sourceDataType==="visibility"||D.dataType==="style"||D.type==="terrain")&&x.getSystems().htmlControlsSystem.updateData(y)},"updateData");return y.on("styledata",D=>{y&&D&&D.dataType==="style"&&D.type==="styledata"&&(C=!1),T(D)}),y.on("sourcedata",T),y.on("terrain",T),y.on("error",D=>{var F;if(((F=D.error)==null?void 0:F.url)===CX){Vt.error('Failed to load outdoor view style, possibly due to invalid token "'.concat(p["x-mappedin-tiles-key"],'"'));return}Vt.warn(D)}),x}else return new EN(t,e)}s(OLe,"createRenderer");N();N();N();var kLe=(t=>(t.Exterior="exterior-walls",t.Interior="interior-walls",t))(kLe||{}),NLe=(t=>(t.Interior="interior-doors",t.Exterior="exterior-doors",t))(NLe||{});N();N();var CN=class IN{constructor(e,r,i){$(this,"id"),$(this,"text"),$(this,"target"),$(this,"__type",IN.__type),this.id=e,this.text=r,this.target=i}static is(e){return e.__type===IN.__type}get focusTarget(){return this.target.anchorTarget}};s(CN,"Label"),$(CN,"__type","Label");var TN=CN;N();var h1,PN=class LN{constructor(e,r,i){$(this,"id"),Be(this,h1),$(this,"__type",LN.__type),$(this,"contentEl"),this.id=e,this.contentEl=r,He(this,h1,i)}get target(){return w(this,h1)}get coordinate(){return w(this,h1).anchorTarget}static is(e){return e.__type===LN.__type}get focusTarget(){return this.target.anchorTarget}updateTarget(e){He(this,h1,e)}};h1=new WeakMap,s(PN,"Marker"),$(PN,"__type","Marker");var bj=PN;N();var BI,zI,DN=class RN{constructor(e,r,i){Be(this,BI),Be(this,zI),$(this,"target"),$(this,"__type",RN.__type),He(this,BI,e),He(this,zI,r),this.target=i}static is(e){return e.__type===RN.__type}get id(){return w(this,BI)}get url(){return w(this,zI)}};BI=new WeakMap,zI=new WeakMap,s(DN,"Image"),$(DN,"__type","Image");var Gtt=DN;N();var q2,ON=class kN{constructor(e,r,i){$(this,"id"),$(this,"groupId"),$(this,"__type",kN.__type),Be(this,q2),this.id=e,this.groupId=r,He(this,q2,i)}get target(){return w(this,q2)}static is(e){return e.__type===kN.__type}updateTarget(e){He(this,q2,e)}};q2=new WeakMap,s(ON,"Model"),$(ON,"__type","Model");var FLe=ON;N();var NN=class FN{constructor(e,r){$(this,"id"),$(this,"coordinates"),$(this,"__type",FN.__type),this.id=e,this.coordinates=r}static is(e){return e.__type===FN.__type}get focusTarget(){return this.coordinates}};s(NN,"PathSegment"),$(NN,"__type","PathSegment");var BLe=NN,BN=class zN{constructor(e,r,i,n){$(this,"id"),$(this,"animation"),$(this,"coordinates"),$(this,"segments"),$(this,"__type",zN.__type),this.id=e,this.animation=r,this.coordinates=i,this.segments=n.map(({id:a,coordinates:o})=>new BLe(a.toString(),o))}static is(e){return e.__type===zN.__type}get focusTarget(){return this.coordinates}};s(BN,"Path"),$(BN,"__type","Path");var pA=BN;N();var ay,zLe=class{constructor(e){Be(this,ay),He(this,ay,e)}get center(){return w(this,ay).center}get bearing(){return w(this,ay).bearing}get pitch(){return w(this,ay).pitch}get zoomLevel(){return w(this,ay).zoomLevel}};ay=new WeakMap,s(zLe,"CameraTransform");var Htt=zLe;N();var UN=class VN{constructor(e){$(this,"id"),$(this,"__type",VN.__type),this.id=e}static is(e){return e.__type===VN.__type}get focusTarget(){return this}};s(UN,"Shape"),$(UN,"__type","Shape");var jN=UN;N();var $N=class ULe{constructor(e,r){$(this,"id"),$(this,"target"),$(this,"__type","Text3D"),this.id=e,this.target=r}static is(e){return e.__type===ULe.__type}};s($N,"Text3D"),$($N,"__type","Text3D");var GN=$N;N();N();N();var qtt=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				// Do not change these to fillRule or clipRule, since they need to be rendered as actual SVGs in labels, not React SVGs
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),Wtt=/<svg([^>]*)>/g;function VLe(t,e,r){let i=qtt.get(t);return i?i.replace(Wtt,'<svg$1 style="fill:'.concat(e,"; width:").concat(r,"px; height:").concat(r,'px">')):""}s(VLe,"getStyledIcon");var Xtt=s(t=>`
		<div class="pin-shadow" style="background: `.concat(t,`"></div>
		<svg width="`).concat(20*.9,'px" height="').concat(48*.9,`px" viewBox="0 0 20 48">
			<path
				d="M1.37965 29.3246C1.5778 31.2167 2.27661 33.0694 3.83078 33.775C4.0998 37.1861 4.7451 40.2227 5.65918 42.4784C6.14556 43.6787 6.72883 44.71 7.41453 45.4578C8.10027 46.2056 8.97065 46.7527 9.99989 46.7527C11.0292 46.7527 11.8995 46.2055 12.585 45.4576C13.2706 44.7098 13.8536 43.6785 14.3398 42.4783C15.2536 40.2226 15.8988 37.186 16.1688 33.7752C17.7232 33.0697 18.422 31.2169 18.6201 29.3247C18.8386 27.2385 18.5165 24.6502 17.6475 22.0285L17.6473 22.0278C16.9657 19.9761 16.0319 18.1622 14.9848 16.7474C17.0884 15.1587 18.4471 12.5964 18.4471 9.7152C18.4471 4.93539 14.6967 1 9.99966 1C5.30272 1 1.54993 4.93527 1.54993 9.7152C1.54993 12.5961 2.90839 15.1583 5.01167 16.747C3.9635 18.1625 3.03185 19.977 2.3522 22.0286C1.48319 24.6503 1.16118 27.2385 1.37965 29.3246Z"
				fill="`).concat(t,`"
				stroke="white"
				strokeWidth="2"
			/>
		</svg>
	`),"getDeparturePin"),Ztt=s(t=>`
		<div class="pin-shadow" style="background: `.concat(t,`"></div>
		<svg width="36" height="42" viewBox="-2 -2 40 46">
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="none"
				stroke="white"
				strokeWidth="4"
			/>
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="`).concat(t,`"
			/>
		</svg>
    `),"getDestinationPin"),jLe="#722ED1",$Le="#1890FF",Ytt=s(({type:t="departure",color:e=$Le})=>`<div class="dropped-pin-wrapper">
			`.concat(t==="departure"?Xtt(e):Ztt(e),`
		</div>`),"DroppedPin"),Ktt=s(t=>{switch(t){case"default":return 28;case"selection":return 28;case"navigation":return 32}},"getSize"),Jtt=s(({type:t="stairs",color:e=jLe,direction:r="up"})=>{let i=Ktt("default"),n=i/2+2,a=r&&r!=="none";return`<div class="mappedin-connection-marker">
			<div class="connection-circle"
				role="button"
                style="background:`.concat(e,"; width:").concat(i,"px; height:").concat(i,`px;"
			>
                `).concat(VLe("connection-"+t+"-16x16","white",n)||"",`
			</div>
			`).concat(a?'<div style="margin-left: -'.concat(i*.2,`px;">
					<div class="bouncey">
						<div class="connection-circle"
							role="button"
							style="width: `).concat(i,"px; height: ").concat(i,`px;">
							<div class="`).concat(r==="up"?"":"arrow--down",`">
                                <svg viewBox="0 0 16 16" style="fill: white; width: `).concat(n,"px; height: ").concat(n,`px">
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
                                        stroke="none"
                                    />
                                </svg>
							</div>
						</div>
					</div>
				</div>`):"",`
		</div>`)},"ConnectionMarker");N();var Qtt=s(async t=>new Promise(e=>setTimeout(e,t)),"ms"),ert={drawDuration:1e3,color:"#40A9FF",interactive:!1,accentColor:"blue",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1,animateArrowsOnPath:!1},trt={drawDuration:1e3,color:"#B3DDFF",interactive:!1,accentColor:"#40A9FF",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1,animateArrowsOnPath:!1},wm={setMapOnConnectionClick:!0,setMapToDeparture:!0,createMarkers:{departure:!0,destination:!0,connection:!0},pathOptions:ert,inactivePathOptions:trt,markerOptions:{departureColor:$Le,destinationColor:jLe},animatePathDrawing:!0},Fm,zp,km,bn,UI,Bm,p1,As,Rp,cc,Op,by,Cl,IX,GLe,HN,VI,H1,qN,dw,HLe=class{constructor(e,r,i){Be(this,Cl),Be(this,Fm,new Map),Be(this,zp),Be(this,km),Be(this,bn,wm),Be(this,UI),Be(this,Bm),Be(this,p1),Be(this,As,[]),Be(this,Rp),Be(this,cc,new Map),Be(this,Op,new Map),Be(this,by,new Map),Be(this,dw,s(n=>{var a;if((a=w(this,bn).createMarkers)!=null&&a.connection&&n.markers.length>0){let{instruction:o}=w(this,Fm).get(n.markers[0]);o!=null&&o.action.toFloor&&(w(this,bn).setMapOnConnectionClick&&this.currentMap.setFloor(o.action.toFloor.id,"navigation-connection-click"),this.currentMap.publish("navigation-connection-click",{instruction:o,fromFloor:o.action.fromFloor,toFloor:o.action.toFloor}))}},"#handleClick")),He(this,zp,e),He(this,UI,i),He(this,km,r)}get currentMap(){return w(this,UI).call(this)}get isMultiFloor(){if(!w(this,As).length)return!1;let e=new Set;for(let r of w(this,As))for(let i of r.coordinates)if(i.floorId&&(e.add(i.floorId),e.size>1))return!0;return!1}getPathById(e){return w(this,cc).get(e)}getMarkerById(e){return w(this,Fm).get(e)}get paths(){let e=new Set;return w(this,cc).forEach(({path:r})=>e.add(r)),Array.from(e)}get activeDirections(){return w(this,by).get(w(this,Rp))}get activePath(){var e;if(w(this,Rp))return(e=w(this,cc).get(w(this,Rp).id))==null?void 0:e.path}get floorStacks(){let e=w(this,km).getMapData();if(!w(this,As).length||!e)return[];let r=new Set;for(let i of w(this,As))for(let n of i.coordinates)if(n.floorId){let a=e.getById("floor",n.floorId);a&&r.add(a.floorStack)}return Array.from(r)}get floors(){let e=w(this,km).getMapData();if(!w(this,As).length||!e)return[];let r=new Set;for(let i of w(this,As))for(let n of i.coordinates)if(n.floorId){let a=e.getById("floor",n.floorId);a&&r.add(a)}return Array.from(r)}setActivePathByIndex(e){let r=w(this,As)[e];if(!w(this,As).length){Vt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!w(this,As)[e]){Vt.warn("Direction #".concat(e," does not exist"));return}let i=w(this,Op).get(r);if(!i){Vt.warn("The direction is not a part of muli-direcional path");return}dr(this,Cl,VI).call(this,i)}setActivePath(e){if(!w(this,As).length){Vt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}if(!w(this,by).get(e)){Vt.warn('Path "'.concat(e.id,'" is not a part of muli-direcional path'));return}dr(this,Cl,VI).call(this,e)}setActivePathByDirections(e){if(!w(this,As).length){Vt.warn("Cannot set an active path before drawing. Call Navigation.draw() first.");return}let r=w(this,Op).get(e);if(!r){Vt.warn("The direction is not a part of muli-direcional path");return}dr(this,Cl,VI).call(this,r)}drawSync(e,r={}){var i,n,a;w(this,p1)&&this.clear(),He(this,p1,!0),dr(this,Cl,HN).call(this,r);let o=Array.isArray(e)?e:[e],l=o[0],u=o[o.length-1],c=l.coordinates[0];He(this,As,o),c.floorId&&w(this,bn).setMapToDeparture&&this.currentMap.setFloor(c.floorId),(i=w(this,bn).createMarkers)!=null&&i.departure&&dr(this,Cl,H1).call(this,l.coordinates[0],"departure",l.instructions[0]);for(let p=0;p<o.length;p++){let m=o[p],y=p?Ee({},w(this,bn).inactivePathOptions):Ee({},w(this,bn).pathOptions);if(m.coordinates.length<2){Vt.warn("Directions must have at least 2 coordinates");return}let v=this.currentMap.Paths.add(m.coordinates,vt(Ee({},y),{animateDrawing:w(this,bn).animatePathDrawing})),x=v.paths.map(M=>M.id.toString()),E=new pA(ga(),v.animation,m.coordinates,v.paths);for(let M of x){w(this,cc).set(M,{path:E,entityIds:x});let I=p?vt(Ee({},w(this,bn).inactivePathOptions),{altitude:0}):vt(Ee({},w(this,bn).pathOptions),{altitude:.05});w(this,zp).setState(M,I)}w(this,cc).set(E.id,{path:E,entityIds:x}),w(this,Op).set(m,E),w(this,by).set(E,m),(n=w(this,bn).createMarkers)!=null&&n.connection&&dr(this,Cl,qN).call(this,m.instructions,"connection"),p===0&&(He(this,Rp,w(this,Op).get(w(this,As)[0])),w(this,zp).on("click",w(this,dw)))}(a=w(this,bn).createMarkers)!=null&&a.destination&&dr(this,Cl,H1).call(this,u.coordinates[u.coordinates.length-1],"destination",u.instructions[u.instructions.length-1]),w(this,km).mapObjects.forEach(p=>{p.processFloorChange(p.currentFloorId)})}async draw(e,r={}){w(this,Bm)&&this.clear(),dr(this,Cl,HN).call(this,r);let i=Array.isArray(e)?e:[e],n=i[0].coordinates[0];return He(this,As,i),n.floorId&&w(this,bn).setMapToDeparture&&this.currentMap.setFloor(n.floorId),dr(this,Cl,GLe).call(this,i)}clear(){w(this,Fm).forEach((e,r)=>{this.currentMap.Markers.remove(r.toString())}),w(this,Fm).clear(),w(this,cc).forEach(({path:e,entityIds:r})=>{w(this,cc).delete(e.id),r.forEach(i=>w(this,cc).delete(i)),this.currentMap.Paths.remove(r)}),w(this,Bm)&&(w(this,Bm).cancel(),He(this,Bm,void 0)),w(this,p1)&&He(this,p1,!1),He(this,As,[]),w(this,Op).clear(),w(this,by).clear(),He(this,Rp,void 0),w(this,zp).off("click",w(this,dw)),w(this,km).mapObjects.forEach(e=>{e.processFloorChange(e.currentFloorId)})}};Fm=new WeakMap,zp=new WeakMap,km=new WeakMap,bn=new WeakMap,UI=new WeakMap,Bm=new WeakMap,p1=new WeakMap,As=new WeakMap,Rp=new WeakMap,cc=new WeakMap,Op=new WeakMap,by=new WeakMap,Cl=new WeakSet,IX=s(function(t){return t!=null&&["TakeConnection","ExitConnection","TakeVortex","ExitVortex"].includes(t.type)},"#isVortexAction"),GLe=s(function(t){let e=t[0],r=t[t.length-1],i=!1;return He(this,Bm,{promise:new Promise(async n=>{var a,o,l;if(ja.env.NODE_ENV!=="test"&&await Qtt(500),i||!t.length){n();return}(a=w(this,bn).createMarkers)!=null&&a.departure&&dr(this,Cl,H1).call(this,e.coordinates[0],"departure",e.instructions[0]);for(let u=0;u<t.length;u++){let c=t[u],p=u?Ee({},w(this,bn).inactivePathOptions):Ee({},w(this,bn).pathOptions);if(c.coordinates.length<2){Vt.warn("Directions must have at least 2 coordinates"),n();return}let m=this.currentMap.Paths.add(c.coordinates,vt(Ee({},p),{animateDrawing:w(this,bn).animatePathDrawing})),y=m.paths.map(x=>x.id.toString()),v=new pA(ga(),m.animation,c.coordinates,m.paths);for(let x of y){w(this,cc).set(x,{path:v,entityIds:y});let E=u?vt(Ee({},w(this,bn).inactivePathOptions),{altitude:0}):vt(Ee({},w(this,bn).pathOptions),{altitude:.05});w(this,zp).setState(x,E)}if(w(this,cc).set(v.id,{path:v,entityIds:y}),w(this,Op).set(c,v),w(this,by).set(v,c),ja.env.NODE_ENV!=="test"&&await m.animation,i){n();return}(o=w(this,bn).createMarkers)!=null&&o.connection&&dr(this,Cl,qN).call(this,c.instructions,"connection"),u===0&&(He(this,Rp,w(this,Op).get(w(this,As)[0])),w(this,zp).on("click",w(this,dw)))}if((l=w(this,bn).createMarkers)!=null&&l.destination&&dr(this,Cl,H1).call(this,r.coordinates[r.coordinates.length-1],"destination",r.instructions[r.instructions.length-1]),i){n();return}w(this,km).mapObjects.forEach(u=>{u.processFloorChange(u.currentFloorId)}),n()}),cancel:s(()=>{i=!0},"cancel")}),w(this,Bm).promise},"#drawAsync"),HN=s(function(t){var e,r,i;He(this,bn,{setMapOnConnectionClick:(e=t.setMapOnConnectionClick)!=null?e:wm.setMapOnConnectionClick,setMapToDeparture:(r=t.setMapToDeparture)!=null?r:wm.setMapToDeparture,pathOptions:Ee(Ee({},wm.pathOptions),t.pathOptions),inactivePathOptions:Ee(Ee({},wm.inactivePathOptions),t.inactivePathOptions),createMarkers:Ee(Ee({},wm.createMarkers),t.createMarkers),markerOptions:Ee(Ee({},wm.markerOptions),t.markerOptions),animatePathDrawing:(i=t.animatePathDrawing)!=null?i:wm.animatePathDrawing})},"#setupOptions"),VI=s(function(t){He(this,Rp,t),w(this,As).forEach(e=>{let r=w(this,Op).get(e);if(r){let i=w(this,cc).get(r.id),n=i.path.id===w(this,Rp).id?vt(Ee({},w(this,bn).pathOptions),{altitude:.05}):vt(Ee({},w(this,bn).inactivePathOptions),{altitude:0});i.entityIds.forEach(a=>{w(this,zp).setState(a,n)})}}),this.currentMap.publish("navigation-active-path-change",{directions:this.activeDirections,path:this.activePath})},"#setActiveDirections"),H1=s(function(t,e,r){var i,n,a,o,l;if(e==="connection"&&r){let u=r.action.type==="ExitConnection"?w(this,bn).markerOptions.departureColor:w(this,bn).markerOptions.destinationColor,c;if(typeof((i=w(this,bn).createMarkers)==null?void 0:i.connection)=="function"){let m=w(this,bn).createMarkers.connection(r);w(this,zp).setState(m.id.toString(),{options:{interactive:!0}}),c={id:m.id,type:"marker"}}else c=this.currentMap.Markers.add(r.coordinate,Jtt({type:(a=(n=r.action.connection)==null?void 0:n.type)!=null?a:r.action.connectionType,color:u,direction:r.action.direction}),{interactive:!0,anchor:"top",rank:"always-visible"});let p=this.currentMap.Markers.getContentEl(c.id.toString());if(!p)throw new Error("marker component should exist");w(this,Fm).set(c.id,{instruction:r,marker:new bj(c.id.toString(),p,r.coordinate)})}else{let u=e==="departure"?w(this,bn).markerOptions.departureColor:w(this,bn).markerOptions.destinationColor,c;typeof((o=w(this,bn).createMarkers)==null?void 0:o.departure)=="function"&&e==="departure"?c={id:w(this,bn).createMarkers.departure(r).id,type:"marker"}:typeof((l=w(this,bn).createMarkers)==null?void 0:l.destination)=="function"&&e==="destination"?c={id:w(this,bn).createMarkers.destination(r).id,type:"marker"}:c=this.currentMap.Markers.add(t,Ytt({type:e,color:u}),{anchor:"top",rank:"always-visible"}),w(this,Fm).set(c.id,void 0)}},"#addMarker"),qN=s(function(t,e){t.filter(r=>dr(this,Cl,IX).call(this,r.action)).forEach(r=>{dr(this,Cl,H1).call(this,r.coordinate,e,r)})},"#addMarkers"),dw=new WeakMap,s(HLe,"Navigation");var rrt=HLe;N();N();N();var irt=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),nrt=/<svg([^>]*)>/g;function qLe(t,e,r){let i=irt.get(t);return i?i.replace(nrt,'<svg$1 xmlns="http://www.w3.org/2000/svg" style="fill:'.concat(e,"; width:").concat(r,"px; height:").concat(r,'px">')):""}s(qLe,"getStyledIcon");var d1,W2,tf,WN,TX,PX,$D,LX,WLe=class{constructor(e,r){Be(this,tf),Be(this,d1),Be(this,W2),$(this,"colors",{default:"#3D5676",connection:"#128387",washroom:"#3161B4",point:"#AD468F"}),He(this,d1,e),He(this,W2,r)}auto(){let e=[],r=w(this,W2)[Object.keys(w(this,W2))[0]];return[...r.getByType("connection"),...r.getByType("point-of-interest"),...r.getByType("space")].forEach(i=>{if(i.__type==="connection")i.coordinates.forEach(n=>{let a=i.name||i.externalId;if(a){let o=w(this,d1).Labels.add(n,a,dr(this,tf,WN).call(this,i));e.push(o)}});else{i.__type==="space"&&i.name!==""&&w(this,d1).updateState(i,{interactive:!0,hoverColor:"#F0F0F0"});let n=i.name;if(n){let a=w(this,d1).Labels.add(i,n,dr(this,tf,WN).call(this,i));e.push(a)}}}),{labels:e}}};d1=new WeakMap,W2=new WeakMap,tf=new WeakSet,WN=s(function(t){let e=qLe(dr(this,tf,TX).call(this,t),"white",12);return{appearance:{text:{foregroundColor:dr(this,tf,$D).call(this,t)},marker:{foregroundColor:{active:dr(this,tf,$D).call(this,t)},icon:e,iconSize:12}},interactive:!0,rank:dr(this,tf,LX).call(this,t)}},"#generatLabelAppearance"),TX=s(function(t){return t.__type==="connection"?dr(this,tf,PX).call(this,t.type):t.name.includes("Washroom")?"washroom-14x14":t.__type==="point-of-interest"?"point-of-interest-12x12":""},"#getIconName"),PX=s(function(t){let e="";switch(t){case"elevator":e="connection-elevator-12x12";break;case"escalator":e="connection-escalator-12x12";break;case"stairs":e="connection-stairs-12x12";break}return e},"#attemptIconNameForConnection"),$D=s(function(t){return t.__type==="connection"?this.colors.connection:t.__type==="point-of-interest"?this.colors.point:"name"in t&&t.name.includes("Washroom")?this.colors.washroom:this.colors.default},"#getLabelColor"),LX=s(function(t){return t.__type==="connection"?"high":(t.__type,"medium")},"#getDefaultLabelRank"),s(WLe,"Labels");var art=WLe,XLe=class{constructor(e,r){$(this,"Labels"),$(this,"auto",s(()=>this.Labels.auto(),"auto")),this.Labels=new art(e,r)}};s(XLe,"DefaultTheme");var ort=XLe;N();var Ii,G3,Py,wE,XN,ZLe=class{constructor(e){Be(this,Py),Be(this,Ii),Be(this,G3),$(this,"interactions",{set:s(r=>{(r==null?void 0:r.pan)!=null&&(w(this,Ii).getSystems().cameraSystem.enablePan=r.pan),(r==null?void 0:r.zoom)!=null&&(w(this,Ii).getSystems().cameraSystem.enableZoom=r.zoom),(r==null?void 0:r.bearingAndPitch)!=null&&(w(this,Ii).getSystems().cameraSystem.enableRotate=r.bearingAndPitch)},"set"),enable:s(()=>{w(this,Ii).getSystems().cameraSystem.enablePan=!0,w(this,Ii).getSystems().cameraSystem.enableZoom=!0,w(this,Ii).getSystems().cameraSystem.enableRotate=!0},"enable"),disable:s(()=>{w(this,Ii).getSystems().cameraSystem.enablePan=!1,w(this,Ii).getSystems().cameraSystem.enableZoom=!1,w(this,Ii).getSystems().cameraSystem.enableRotate=!1},"disable")}),$(this,"setMinPitch",s(r=>{w(this,Ii).camera.setMinPitch(r)},"setMinPitch")),$(this,"setMaxPitch",s(r=>{w(this,Ii).camera.setMaxPitch(r)},"setMaxPitch")),$(this,"setMinZoomLevel",s(r=>{w(this,Ii).camera.setMinZoomLevel(r,!0)},"setMinZoomLevel")),$(this,"setMaxZoomLevel",s(r=>{w(this,Ii).camera.setMaxZoomLevel(r)},"setMaxZoomLevel")),He(this,G3,e),He(this,Ii,e.core)}setScreenOffsets(e){w(this,Ii).camera.setInsetPadding(e)}get screenOffsets(){return w(this,Ii).camera.insetsPadding}get panMode(){return w(this,Ii).camera.panMode}setPanMode(e){if(e!=="default"&&e!=="elevation")throw new Error("Invalid pan mode");e!==this.panMode&&w(this,Ii).camera.setPanMode(e)}getFocusOnTransform(e,r){var i;let n=w(this,Ii).camera.getCameraFrameForCoordinates(dr(this,Py,XN).call(this,e),{pitch:r==null?void 0:r.pitch,bearing:r==null?void 0:r.bearing,padding:(r==null?void 0:r.screenOffsets)||this.screenOffsets,maxZoomLevel:r==null?void 0:r.maxZoomLevel,verticalPadding:(i=r==null?void 0:r.axisAlignedPadding)==null?void 0:i.vertical,minZoomLevel:r==null?void 0:r.minZoomLevel,duration:r==null?void 0:r.duration,easing:r==null?void 0:r.easing});return{center:new Rn(n.center[1],n.center[0]),zoomLevel:n.zoomLevel}}focusOn(e,r){var i;return w(this,Ii).camera.focusOn(dr(this,Py,XN).call(this,e),{pitch:r==null?void 0:r.pitch,bearing:r==null?void 0:r.bearing,padding:(r==null?void 0:r.screenOffsets)||this.screenOffsets,maxZoomLevel:r==null?void 0:r.maxZoomLevel,minZoomLevel:r==null?void 0:r.minZoomLevel,duration:r==null?void 0:r.duration,verticalPadding:(i=r==null?void 0:r.axisAlignedPadding)==null?void 0:i.vertical,easing:r==null?void 0:r.easing})}animateTo(e,r){var i;let{center:n,zoomLevel:a,bearing:o,pitch:l}=e,u=n??this.center;return w(this,Ii).camera.animateTo({center:n!=null?[u.longitude,u.latitude,w(this,Ii).camera.elevation]:void 0,zoomLevel:a,bearing:o,pitch:l,duration:(i=r==null?void 0:r.duration)!=null?i:600,easing:r==null?void 0:r.easing})}set(e){let{center:r=this.center,zoomLevel:i=this.zoomLevel,bearing:n=this.bearing,pitch:a=this.pitch}=e,o=[r.longitude,r.latitude];w(this,Ii).camera.setCenter(o),w(this,Ii).camera.setZoomLevel(i),w(this,Ii).camera.setBearing(n),w(this,Ii).camera.setPitch(a)}get center(){let e=w(this,Ii).camera.center;return new Rn(e[1],e[0],void 0)}setAutoMinZoomLevel(e){w(this,Ii).camera.setAutoMinZoomLevel(e)}get autoMinZoomLevel(){return w(this,Ii).camera.autoMinZoomLevel}get zoomLevel(){return w(this,Ii).camera.zoomLevel}get pitch(){return w(this,Ii).camera.pitch}get minPitch(){return w(this,Ii).camera.minPitch}get maxPitch(){return w(this,Ii).camera.maxPitch}get bearing(){let e=w(this,Ii).camera.bearing;return(e<0?e+360:e)%360}get minZoomLevel(){return w(this,Ii).camera.minZoomLevel}get maxZoomLevel(){return w(this,Ii).camera.maxZoomLevel}setElevation(e){w(this,Ii).camera.setElevation(e)}get elevation(){return w(this,Ii).camera.elevation}animateElevation(e,r){return w(this,Ii).camera.animateElevation(e,r)}updateFacadesInView(){w(this,Ii).getSystems().geometryInFocusSystem.raycast()}};Ii=new WeakMap,G3=new WeakMap,Py=new WeakSet,wE=s(function(t){var e,r,i,n,a,o;let l=w(this,Ii).camera.elevation;return Rn.is(t)&&t.floorId!=null?(r=(e=w(this,Ii).getState(t.floorId))==null?void 0:e.altitude)!=null?r:l:jp.is(t)?(n=(i=w(this,Ii).getState(t.id))==null?void 0:i.altitude)!=null?n:l:"floor"in t&&jp.is(t.floor)&&(o=(a=w(this,Ii).getState(t.floor.id))==null?void 0:a.altitude)!=null?o:l},"#getFloorAltitude"),XN=s(function(t){var e;let r=[],i=(Array.isArray(t)?t:[t]).flatMap(n=>{var a;return(a=n==null?void 0:n.focusTarget)!=null?a:[n]});for(let n of i)if(n!=null)if(Rn.is(n)){let a=dr(this,Py,wE).call(this,n);r.push([n.longitude,n.latitude,a])}else if((n==null?void 0:n.id)!=null){let a=dr(this,Py,wE).call(this,n);if(jp.is(n)&&(e=w(this,G3).getMapDataInternal())!=null&&e.enterpriseMode){r.push(n.id);continue}else if("geoJSON"in n&&n.geoJSON.geometry.coordinates.length>0){ux(n.geoJSON,l=>{r.push([l[0],l[1],a])});continue}let o=w(this,Ii).getBoundingArea(n.id);if(o)r.push(...o.map(l=>[l[0],l[1],a]));else if("geoJSONBoundingBox"in n){let l=dr(this,Py,wE).call(this,n);if(n.geoJSONBoundingBox!=null){let u=[[n.geoJSONBoundingBox[0],n.geoJSONBoundingBox[1],l],[n.geoJSONBoundingBox[2],n.geoJSONBoundingBox[3],l]];r.push(...u)}}}else rz(n)&&r.push(n);return r},"#computeCoordinateCloud"),s(ZLe,"Camera");var srt=ZLe;N();var X2,YLe=class{constructor({currentMapGetter:e}){Be(this,X2),He(this,X2,e)}get currentMap(){return w(this,X2).call(this)}async getCurrentSceneGLTF(e){let r=w(this,X2).call(this);return r?r==null?void 0:r.Exporter.getCurrentSceneGLTF(e):(Vt.error("There is no map to export. Please load a map first."),new Blob)}};X2=new WeakMap,s(YLe,"Exporter");var lrt=YLe;N();var Ud,jI,KLe=class{constructor({currentMapGetter:e}){Be(this,Ud,new Map),Be(this,jI),He(this,jI,e)}get currentMap(){return w(this,jI).call(this)}getById(e){return w(this,Ud).get(e)}add(e,r,i){let n=e.anchorTarget,a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Labels.add(n,r,vt(Ee({},i),{attachTo:X4(e),rank:(i==null?void 0:i.rank)==null||(i==null?void 0:i.rank)==="initial"?"medium":i.rank})),l=new TN(o.id.toString(),r,e);return w(this,Ud).set(l.id,{label:l,entityId:l.id}),l}all(e){var r;let i=[];return(r=this.currentMap)==null||r.Labels.all({onCreate:s((n,a,o)=>{let l=new TN(n.toString(),a,o);w(this,Ud).set(l.id,{label:l,entityId:l.id}),i.push(l)},"onCreate"),labelOptions:e}),i}remove(e){var r;let i=w(this,Ud).get(e.id);i&&((r=this.currentMap)==null||r.Labels.remove(i),w(this,Ud).delete(e.id.toString()))}removeAll(){let e=[];return w(this,Ud).forEach(({label:r})=>{this.remove(r),e.push(r),w(this,Ud).delete(r.id.toString())}),e}};Ud=new WeakMap,jI=new WeakMap,s(KLe,"Labels");var urt=KLe;N();N();var GD={altitude:0,height:1,color:"#ffffff",opacity:1,width:.15},DX={opacity:.25,color:"#a7d1ec",height:.8,width:.05,altitude:.1,cap:"square",visible:!1},RX=.5,JLe=class{constructor(e,r,i=new Map){$(this,"containerId"),$(this,"layers"),$(this,"renderer"),this.containerId=r,this.layers=i,this.renderer=e}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(e){this.renderer.setState(this.containerId,{visible:e})}};s(JLe,"Layer");var Vg=JLe,f1,QLe=class{constructor(e,r,i,n,a,o,l,u){$(this,"id"),$(this,"name"),$(this,"elevation"),$(this,"containerId"),$(this,"externalId"),$(this,"metadata"),$(this,"shortName"),$(this,"subtitle"),$(this,"occluderId"),$(this,"loaded",!1),$(this,"styleMap",{}),$(this,"obstructions"),$(this,"entrances"),$(this,"spaces"),$(this,"floorImages"),$(this,"floorText"),$(this,"renderer"),$(this,"options"),$(this,"layers",new Map),$(this,"footprint"),$(this,"floorStackId"),$(this,"multiFloorView"),$(this,"mapDataInternal"),$(this,"facadesByStyleId",new Map),Be(this,f1),$(this,"load",s(()=>{var E,M,I,P,C,T,D,F,k,B,U,z,q,Z;if(this.loaded||this.obstructions==null&&this.spaces==null)return this;this.loaded=!0;let Q=this.renderer.addGroupContainer("".concat(F_,"-").concat(this.id),{},this.id);this.layers.set(F_,new Vg(this.renderer,Q.id.toString()));let V=this.renderer.addGroupContainer("".concat(By,"-").concat(this.id),{},this.id);this.layers.set(By,new Vg(this.renderer,V.id.toString()));let ae=this.renderer.addGroupContainer("".concat(rl,"-").concat(this.id),{},this.id);if(this.layers.set(rl,new Vg(this.renderer,ae.id.toString())),((E=this.footprint)==null?void 0:E.geometry)!=null&&((M=this.footprint)==null?void 0:M.geometry.coordinates.length)!==0){let Y=GD;if(this.obstructions!=null&&this.obstructions.features.length>0){let ne=this.obstructions.features.filter(ee=>ee.geometry.type==="LineString"&&ee.properties.kind==="Wall"&&ee.properties.footprintComponent===!0);ne!=null&&ne.length>0&&(Y=this.styleMap[(I=ne[0].properties)==null?void 0:I.id])}let he=this.renderer.addGeometryGroup("Footprint-".concat(this.id),{features:[{geometry:this.footprint.geometry,properties:{id:"Footprint-Floor-".concat(this.id)}}]},vt(Ee({},Y),{height:(C=(P=this.multiFloorView)==null?void 0:P.floorHeight)!=null?C:10,altitude:0,visible:!1,opacity:this.elevation<0?1:.4,side:this.elevation<0?"back":"front",color:this.elevation<0?"#F0EEE8":Y.color,renderOrder:2}),this.id);this.layers.set(xk,new Vg(this.renderer,he.id.toString()));let J=this.renderer.addGroupContainer("".concat(h3,"-").concat(this.id),{},this.id);this.layers.set(h3,new Vg(this.renderer,J.id.toString())),this.occluderId=this.renderer.addOccluder(this.footprint,J.id)}if(this.spaces!=null&&this.spaces.features.length>0){let Y=[],he=new Map;this.spaces.features.filter(ue=>{var K;return ue.geometry.type==="Polygon"&&((K=ue.properties.kind)==null?void 0:K.toLowerCase())!=="void"}).forEach(ue=>{var K;let ce=(K=this.mapDataInternal)==null?void 0:K.facadesBySpaceId[ue.properties.id];if(ce){let re=he.get(ce.id)||[];he.set(ce.id,[...re,ue])}else Y.push(ue)});let J=dT(Y,this.styleMap),ne=this.renderer.addGroupContainer("spaces-".concat(this.id),{},ae),ee=0;for(let[ue,K]of J){let ce=this.renderer.addGeometryGroup("Spaces-".concat(this.id,"-").concat(ee),{features:K},M1(ue,this.options),ne);ee++;let re=ne.id.toString();this.layers.get(rl).layers.set(ue.id||re,ce.id.toString())}if(he.size>0){let ue=this.renderer.addGroupContainer("".concat(hw,"-").concat(this.id),{},this.id);this.layers.set(hw,new Vg(this.renderer,ue.id.toString()));for(let[K,ce]of he){let re=this.renderer.addGroupContainer(K,{focusable:!0},ue),se=this.renderer.addGroupContainer("".concat(K,"-geometry"),{},re),de=dT(ce,this.styleMap),we=0;for(let[Le,fe]of de){let Re=this.renderer.addGeometryGroup("Facades-".concat(this.id,"-").concat(K,"-").concat(we),{features:fe},vt(Ee({},M1(Le,this.options)),{renderOrder:3}),se);we++;let me=Le.id||Re.id.toString();this.layers.get(hw).layers.set("".concat(K,"-").concat(me),Re.id.toString()),this.facadesByStyleId.has(me)?(T=this.facadesByStyleId.get(me))==null||T.push(K):this.facadesByStyleId.set(me,[K])}}}}if(this.obstructions!=null&&this.obstructions.features.length>0){let Y=this.obstructions.features.filter(se=>se.geometry.type==="Polygon"&&se.properties.kind==="object"),he=dT(Y,this.styleMap),J=this.renderer.addGroupContainer("objects-".concat(this.id),{},ae),ne=0;for(let[se,de]of he){let we=this.renderer.addGeometryGroup("Objects-".concat(this.id,"-").concat(ne),{features:de},M1(se,this.options),J);ne++;let Le=J.id.toString();this.layers.get(rl).layers.set(se.id||Le,we.id.toString())}let ee=this.obstructions.features.filter(se=>se.geometry.type==="LineString"&&se.properties.kind==="Wall"&&se.properties.footprintComponent===!1),ue=this.obstructions.features.filter(se=>se.geometry.type==="LineString"&&se.properties.kind==="Wall"&&se.properties.footprintComponent===!0),K=this.entrances,ce=GD,re=GD;if(ee!=null&&ee.length>0){let se=this.styleMap[(D=ee[0].properties)==null?void 0:D.id];se!=null&&(ce=Ee({},se)),re=ce;let{walls:de,entrances:we}=GX(ee,(K==null?void 0:K.features)||[]),Le=Math.max(ce.height-.11,RX),fe=vt(Ee({},DX),{height:Le}),Re=this.renderer.addGeometryGroup("InteriorDoors-".concat(this.id),we,fe,ae);this.layers.get(rl).layers.set(gz,Re.id.toString());let me=this.renderer.addGeometryGroup("Walls-".concat(this.id),{features:[de]},M1(ce,this.options),ae);this.layers.get(rl).layers.set(KP,me.id.toString())}if(ue!=null&&ue.length>0){let se=this.styleMap[(F=ue[0].properties)==null?void 0:F.id];se!=null&&(re=vt(Ee({},se),{id:N_}));let{walls:de,entrances:we}=GX(ue,(K==null?void 0:K.features)||[]),Le=Math.max(re.height-.11,RX),fe=vt(Ee({},DX),{height:Le}),Re=this.renderer.addGeometryGroup("ExteriorDoors-".concat(this.id),we,fe,ae);this.layers.get(rl).layers.set(yz,Re.id.toString());let me=this.renderer.addGeometryGroup("ExteriorWalls-".concat(this.id),{features:[de]},M1(re,this.options),ae);this.layers.get(rl).layers.set(N_,me.id.toString())}}if(this.floorImages!=null){let Y=this.renderer.addGroupContainer("images-".concat(this.id),{},this.id);for(let he of this.floorImages.features||[])"anchorId"in he.properties||"anchorId"in he.properties&&((k=he.properties)==null?void 0:k.anchorId)==null||this.renderer.addImage(ga(),he,{url:he.properties.path,flipImageToFaceCamera:(B=this.options.flipImagesToFaceCamera)!=null?B:!0},Y);this.layers.set(VWe,new Vg(this.renderer,Y.id.toString()))}if(this.floorText!=null)for(let Y of this.floorText.features||[]){let he=0;"geometryId"in Y.properties?he=(z=(U=this.renderer.getState(Y.properties.geometryId))==null?void 0:U.height)!=null?z:0:he=(q=Y.properties.verticalOffset)!=null?q:0,this.renderer.addText3D(ga(),vt(Ee({},Y),{properties:vt(Ee({},Y.properties),{verticalOffset:he})}),{},this.id)}return(Z=this.multiFloorView)!=null&&Z.enabled&&this.renderer.setState(this.id,{altitude:this.elevation*this.multiFloorView.floorHeight}),this.renderer.render(),this},"load"));var c,p,m,y,v;this.id=r.id,this.options=a;let x=i.addGroupContainer(this.id,{visible:!1,interactive:!0,preloadGeometry:(c=a.preloadFloors)==null?void 0:c.map(E=>E.id).includes(r.id)},e);this.containerId=x.id.toString(),this.externalId=r.externalId,this.metadata=r.metadata,this.shortName=r.shortName,this.subtitle=r.subtitle,this.name=r.name,this.elevation=r.elevation,o!=null&&l!=null&&(this.styleMap=l,this.spaces=o.space[this.id],this.entrances=o.entrance[this.id],this.obstructions=o.obstruction[this.id],this.floorImages=(p=o.floorImages)==null?void 0:p[this.id],this.floorText=(y=(m=o.enterprise)==null?void 0:m.floorText)==null?void 0:y[this.id],this.footprint=(v=o["floor.geojson"])==null?void 0:v.features.find(E=>E.properties.id===r.id)),this.renderer=i,this.floorStackId=e,this.multiFloorView=n,this.mapDataInternal=u}get geoJSONBoundingBox(){if(w(this,f1))return w(this,f1);if(!this.footprint){Vt.warn("Attempting to get bounding box with no footprint for floor ".concat(this.id));return}return He(this,f1,Sj(this.footprint)),w(this,f1)}get visible(){return this.renderer.getState(this.containerId).visible}setVisible(e){this.renderer.setState(this.containerId,{visible:e})}};f1=new WeakMap,s(QLe,"FloorObject");var OX=QLe;N();var HD=50,kX=!1,crt=1e3,po,Z2,Vd,Ap,Sl,$I,oy,Y2,m1,Yd,ZN,g1,GI,HI,qI,WI,Am,eDe,XI,wy,YN,NX,tDe,y1,rDe=class extends qa{constructor({currentMapGetter:e}){super(),Be(this,Yd),Be(this,po),Be(this,Z2,0),Be(this,Vd),Be(this,Ap,!1),Be(this,Sl,[]),Be(this,$I,0),Be(this,oy,HD),Be(this,Y2,!1),Be(this,m1,"collapsed"),$(this,"expandedFactor",0),Be(this,g1,"all-floors"),Be(this,GI,s(()=>{let i=w(this,po).call(this);if(w(this,$I)===this.expandedFactor||i==null||!w(this,Ap))return;He(this,$I,this.expandedFactor);let n=Yy(this.expandedFactor,0,1,0,this.distanceBetweenFloors),a=Yy(this.expandedFactor,0,.1,0,1)===0;w(this,Sl).forEach((o,l)=>{i.api.updateState(o.containerId,{visible:a?o.id===i.currentFloorId:!0,altitude:n*l})}),this.expandedFactor===0?(He(this,Ap,!1),i.renderer.camera.setPanMode("default"),w(this,wy)&&w(this,wy).call(this)):this.expandedFactor===1&&(He(this,Ap,!1),w(this,wy)&&w(this,wy).call(this))},"#handlePreRender")),Be(this,HI,s(()=>{var i,n,a;this.expanded&&He(this,Z2,(n=(i=w(this,po).call(this))==null?void 0:i.renderer.camera.elevation)!=null?n:0),(a=w(this,po).call(this))==null||a.renderer.on("user-interaction-end",w(this,WI))},"#handleUserInteractionStart")),Be(this,qI,s(()=>{var i;let n=w(this,po).call(this);if(n!=null&&this.expanded&&w(this,Y2)&&!w(this,Ap)){let a=n.currentFloorId,o=[1/0,n.currentFloorId];for(let l=0;l<w(this,Sl).length;l++){let u=w(this,Sl)[l],c=Math.abs(((i=n.renderer.camera.elevation)!=null?i:0)-l*this.distanceBetweenFloors);c<this.distanceBetweenFloors/3&&(o[0]=c,o[1]=u.id)}o[1]!==n.currentFloorId&&(n.currentFloorId=o[1],w(this,Sl).forEach(l=>{n.api.updateState(l.containerId,{visible:w(this,g1)==="all-floors"?!0:n.currentFloor.id===l.id})}),n.publish("floor-change",{reason:"stacked-maps-elevation-change",floorId:n.currentFloorId,previousFloorId:a}))}},"#determineCurrentMapBasedOnElevation")),Be(this,WI,s(()=>{var i,n;let a=w(this,po).call(this);if(this.expanded&&a&&w(this,Z2)!==((i=a.renderer.camera.elevation)!=null?i:0)){let o=[1/0,a.currentFloorId,0];for(let l=0;l<w(this,Sl).length;l++){let u=w(this,Sl)[l],c=Math.abs(((n=a.renderer.camera.elevation)!=null?n:0)-l*this.distanceBetweenFloors);c<o[0]&&(o[0]=c,o[1]=u.id,o[2]=l*this.distanceBetweenFloors)}w(this,Y2)&&dr(this,Yd,eDe).call(this,o[2]),He(this,Z2,0),a.renderer.off("user-interaction-end",w(this,WI))}},"#handleUserInteractionEnd")),Be(this,Am,null),Be(this,XI,null),Be(this,wy),Be(this,y1),He(this,po,e);let r=w(this,po).call(this);r!=null&&r.id!=="outdoors"&&(r.renderer.on("user-interaction-start",w(this,HI)),r.renderer.on("camera-change",w(this,qI)),r.renderer.on("pre-render",w(this,GI)))}get state(){return w(this,m1)}get expanded(){return w(this,m1)!=="collapsed"}get distanceBetweenFloors(){if(w(this,oy)==="auto"){if(w(this,y1)!=null)return w(this,y1);let e=dr(this,Yd,tDe).call(this);if(e)return He(this,y1,e),e}return typeof w(this,oy)=="number"?w(this,oy):HD}clearCachedFloorSeparationDistance(){He(this,y1,void 0)}get includedFloors(){var e;return(e=w(this,Yd,ZN))!=null&&e.api.mapData?w(this,Sl).map(r=>{var i,n;return(n=(i=w(this,Yd,ZN))==null?void 0:i.api.mapData)==null?void 0:n.getById("floor",r.id)}).filter(Boolean):[]}get floorVisibilityMode(){return w(this,g1)}setFloorVisiblityMode(e){He(this,g1,e);let r=w(this,po).call(this);r!=null&&w(this,Sl).forEach(i=>{r.api.updateState(i.containerId,{visible:w(this,g1)==="all-floors"?!0:r.currentFloor.id===i.id})})}changeFloorOnElevationChanges(e){He(this,Y2,e)}async expand(e){var r,i,n;let a=w(this,po).call(this);if(a!=null)return(e==null?void 0:e.distanceBetweenFloors)==="auto"?He(this,oy,"auto"):He(this,oy,(r=e==null?void 0:e.distanceBetweenFloors)!=null?r:HD),He(this,Sl,(e==null?void 0:e.includedFloors)!=null&&(e==null?void 0:e.includedFloors.length)>0?e==null?void 0:e.includedFloors.map(o=>a.floorsById.get(o.id)).filter(Boolean):a.currentFloorStack.floorObjects),w(this,Sl).sort((o,l)=>o.elevation-l.elevation),w(this,Sl).length<=1||this.expanded===!0?Promise.resolve():(He(this,Ap,!0),a.api.Camera.setPanMode((i=e==null?void 0:e.cameraPanMode)!=null?i:"elevation"),this.changeFloorOnElevationChanges((n=e==null?void 0:e.changeFloorOnElevationChanges)!=null?n:!0),dr(this,Yd,YN).call(this,"expand",e).then(()=>{He(this,m1,"expanded"),this.publish("stacked-maps-state-change",{state:"expanded"})}).finally(()=>{He(this,Ap,!1)}))}async collapse(e){let r=w(this,po).call(this);if(r!=null)return this.expanded===!0?(He(this,Ap,!0),r.api.Camera.setPanMode("default"),this.changeFloorOnElevationChanges(!1),dr(this,Yd,YN).call(this,"collapse",e).then(()=>{He(this,m1,"collapsed"),this.publish("stacked-maps-state-change",{state:"collapsed"})}).finally(()=>{He(this,Ap,!1)})):Promise.resolve()}destroy(){let e=w(this,po).call(this);e!=null&&(e.renderer.off("user-interaction-start",w(this,HI)),e.renderer.off("camera-change",w(this,qI)),e.renderer.off("pre-render",w(this,GI)))}};po=new WeakMap,Z2=new WeakMap,Vd=new WeakMap,Ap=new WeakMap,Sl=new WeakMap,$I=new WeakMap,oy=new WeakMap,Y2=new WeakMap,m1=new WeakMap,Yd=new WeakSet,ZN=s(function(){return w(this,po).call(this)},"#currentMap"),g1=new WeakMap,GI=new WeakMap,HI=new WeakMap,qI=new WeakMap,WI=new WeakMap,Am=new WeakMap,eDe=s(function(t){var e,r,i;w(this,Am)&&w(this,Am).stop();let n=w(this,po).call(this);n!=null&&(He(this,Am,new pf({elevation:(e=n.renderer.camera.elevation)!=null?e:0}).to({elevation:t},150).easing(Rl.Quadratic.Out).onComplete(()=>{var a;w(this,Am)&&((a=w(this,po).call(this))==null||a.renderer.getTweenGroup().remove(w(this,Am)))}).onUpdate(({elevation:a})=>{n.renderer.camera.setElevation(a)}).start()),(r=w(this,po).call(this))==null||r.renderer.getTweenGroup().add(w(this,Am)),(i=w(this,po).call(this))==null||i.renderer.render())},"#animateElevationTo"),XI=new WeakMap,wy=new WeakMap,YN=s(function(t,e){var r,i,n,a;w(this,Vd)&&w(this,Vd).stop();let o=w(this,po).call(this);if(o==null)return Promise.reject(new Error("No current map"));let l=w(this,Sl).indexOf(o.currentFloor),u=(r=o.renderer.camera.elevation)!=null?r:0;return He(this,XI,new Promise(c=>{He(this,wy,c)})),He(this,Vd,new pf({percentExpanded:this.expandedFactor}).to({percentExpanded:t==="expand"?1:0},(i=e==null?void 0:e.duration)!=null?i:crt).easing(J_[(e==null?void 0:e.easing)||"ease-in-out"]).onUpdate(({percentExpanded:c})=>{this.expandedFactor=c;let p=l*this.distanceBetweenFloors;o.renderer.camera.setElevation(t==="expand"?p*c:u*c)}).onComplete(()=>{var c;w(this,Vd)&&((c=w(this,po).call(this))==null||c.renderer.getTweenGroup().remove(w(this,Vd)))}).start()),w(this,Vd).cameraAnimation=!0,(n=w(this,po).call(this))==null||n.renderer.getTweenGroup().add(w(this,Vd)),(a=w(this,po).call(this))==null||a.renderer.render(),w(this,XI)},"#animate"),NX=s(function(t,e,r,i){let n=ZI(t,r),a=e.clone(),o=ZI(a,r);if(!KT(n)||!KT(o))return-1;let l=0,u;do{if(l>1e4)return-1;l+=20,a.position.z=l,a.updateMatrixWorld(),o.makeEmpty(),ZI(a,r,o),u=n.intersectsBox(o)}while(u);return l},"#computeMinZOffsetToSeparateFirstTwoFloors"),tDe=s(function(){let t=w(this,po).call(this);if(!t)return;let e=t.renderer,r=e.getThreeScene();if(!t.api.mapData||!r)return;let i=w(this,Sl).length>0?w(this,Sl):t.currentFloorStack.floorObjects;if(i.length<2)return;let n=e.getInternalState().geometry3DMap.get(i[0].id),a=e.getInternalState().geometry3DMap.get(i[1].id);if(!n||!a)return;RO(n,"group-container"),RO(a,"group-container");let o=dr(this,Yd,NX).call(this,n,a,e.getThreeCamera(),e.container);if(o!==-1)return o},"#computeZOffsetSeparatesFirstTwoFloorsInClipSpace"),y1=new WeakMap,s(rDe,"StackedMaps");var hrt=rDe,um=new qe,FX=new Jt;function ZI(t,e,r=new Lde){return t.traverse(i=>{if(i instanceof Tn){let n=i.geometry.attributes.position;if(e.position.distanceTo(i.position)<e.near)return;for(let a=0;a<n.count;a++)um.fromBufferAttribute(n,a),um.applyMatrix4(i.matrixWorld),um.applyMatrix4(e.matrixWorldInverse),um.applyMatrix4(e.projectionMatrix),um.z<1&&um.z>0&&(FX.set(um.x,um.y),r.expandByPoint(FX))}}),r}s(ZI,"projectToBox2D");function KN(t,e){let r=e.clientWidth,i=e.clientHeight;return new Jt((t.x+1)*r/2,(1-t.y)*i/2)}s(KN,"ndcToScreen");function prt(t,e,r){let i=document.createElement("div");i.style.position="absolute",i.style.border="2px solid ".concat(e),i.style.pointerEvents="none";let n=KN(new Jt(t.min.x,t.min.y),r),a=KN(new Jt(t.max.x,t.max.y),r);i.style.left="".concat(n.x,"px"),i.style.top="".concat(a.y,"px");let o=Math.abs(a.x-n.x),l=Math.abs(a.y-n.y);return i.style.width="".concat(o,"px"),i.style.height="".concat(l,"px"),r.appendChild(i),i}s(prt,"drawProjectedBox");N();N();function iDe(t,e){return"".concat(e," ").concat(t)}s(iDe,"formatMessage");var nDe=class extends Error{constructor(e,r=Ime){super(iDe(e,r)),this.name="MappedinError"}};s(nDe,"MappedinError");var Oh=nDe,K2,aDe=class{constructor(e,r,i,n){$(this,"id"),$(this,"externalId"),$(this,"name"),$(this,"type"),$(this,"floorIds"),$(this,"defaultFloorId"),$(this,"floorObjects",[]),$(this,"floorObjectsByElevation",new Map),$(this,"metadata"),$(this,"containerId"),$(this,"facade"),$(this,"renderer"),Be(this,K2);var a;this.id=e.id,this.externalId=e.externalId,this.name=e.name,this.type=e.type,this.metadata=e.metadata,this.floorIds=(a=e.floors)!=null?a:e.maps,this.defaultFloorId=e.defaultFloor,this.renderer=i;let o=i.addGroupContainer(this.id,{visible:!0,interactive:!0},r);this.containerId=o.id.toString(),this.facade=n}get defaultFloor(){if(w(this,K2)==null){if(this.floorObjects.length===0)throw new Oh("No floors in floor stack (".concat(this.id,"). Could not get default floor."));let e;this.defaultFloorId&&(e=this.floorObjects.find(r=>r.id===this.defaultFloorId)),e||(e=this.floorObjects.reduce((r,i)=>Math.abs(i.elevation)<Math.abs(r.elevation)?i:r)),He(this,K2,e)}return w(this,K2)}addFloor(e){if(this.floorObjectsByElevation.has(e.elevation)){Vt.error("Floor with same elevation ".concat(e.elevation," already exists in Stack (").concat(this.id,"). Floor (").concat(e.id,") will not be added."));return}e.load(),this.floorObjects.push(e),this.floorObjectsByElevation.set(e.elevation,e)}setFacadeVisible(e){var r,i;(i=(r=this.facade)==null?void 0:r.spaces)==null||i.forEach(n=>{this.renderer.setState(n.spaceId,{visible:e})})}};K2=new WeakMap,s(aDe,"FloorStackObject");var BX=aDe;N();function oDe(t,e,r,i){let n={outdoorOpacity:1,floorStates:[]},a=t.sort((p,m)=>p.elevation-m.elevation),o=Math.min(0,a[0].elevation),l=a[a.length-1].elevation,u,c;for(let p=o;p<=l;p++){let m=a.find(M=>M.elevation===p);if(m==null){p>=0&&(u==null?u=p:c=p);continue}let y=0,v=p<0?Math.abs(m.elevation)*r:r,x=!1;if(u===0&&c!=null){let M=r*c;y=-M,v=M,x=!0}else if(u!=null&&c!=null){let M=u,I=t.find(C=>C.elevation===M-1),P=n.floorStates.find(C=>C.floor===I);if(P){let C=r*(c-u+2);P.state.footprint=vt(Ee({},P.state.footprint),{altitude:0,height:C,visible:!0})}}u=void 0,c=void 0;let E={floor:m,state:{type:"floor",visible:!1,geometry:{visible:!1},labels:{enabled:!1},markers:{enabled:!1},footprint:{visible:!1},occlusion:{enabled:!1}}};n.floorStates.push(E),m.id===e.id?(E.state.visible=!0,E.state.geometry.visible=!0,E.state.labels.enabled=!0,E.state.markers.enabled=!0,E.state.occlusion.enabled=!0,(m.elevation<0||x)&&(m.elevation<0&&(n.outdoorOpacity=.2),E.state.footprint.height=v,E.state.footprint.altitude=y,E.state.footprint.visible=!0)):i.includes(m.id)&&m.elevation<e.elevation?(E.state.visible=!0,E.state.geometry.visible=!0,E.state.markers.enabled=!0,E.state.occlusion.enabled=!0,E.state.footprint.visible=!0,m.elevation<0?(E.state.footprint.height=v,E.state.footprint.altitude=y,n.outdoorOpacity=.2):(E.state.footprint.height=v,E.state.footprint.altitude=y)):e.elevation>0&&m.elevation<e.elevation&&m.elevation>=0&&(E.state.visible=!0,E.state.footprint.visible=!0,E.state.footprint.height=r,E.state.footprint.altitude=y)}return n}s(oDe,"getVisiblityState");var drt={linear:Rl.Linear.None,easeIn:Rl.Quadratic.In,easeOut:Rl.Quadratic.Out,easeInOut:Rl.Quadratic.InOut},jd,sDe=class extends qa{constructor(e,r,i,n){var a,o,l,u;super(),$(this,"floorStacksById",new Map),$(this,"floorsById",new Map),$(this,"currentFloorId",""),$(this,"currentFloorStackId",""),$(this,"outdoorFloorStacks",new Set),$(this,"id"),$(this,"renderer"),$(this,"api"),$(this,"mvf"),$(this,"options",{}),$(this,"styleMap"),$(this,"StackedMaps"),$(this,"animations",new Map),$(this,"Models",{add:s((y,v,x)=>{let E=x,{floorId:M,scale:I}=E,P=Nh(E,["floorId","scale"]),C=M?this.floorsById.get(M):this.currentFloor,T=Ee({},P);I!=null&&(T.scale=Array.isArray(x.scale)?x.scale:[x.scale,x.scale,x.scale]);let D=this.renderer.addModelGroup(y,{type:"FeatureCollection",features:v.map(F=>{var k;return{type:"Feature",properties:{id:ga(),rotation:x.rotation,scale:T.scale,interactive:x.interactive,verticalOffset:F.verticalOffset+((k=x.verticalOffset)!=null?k:0)},geometry:{type:"Point",coordinates:Np(F)}}})},T,{parent:C.id});if(D==null)throw new Oh("error creating model");return this.renderer.getState(D).children},"add"),remove:s((y,v)=>{this.renderer.remove(y),this.renderer.getState(v).children.length===0&&this.renderer.remove(v)},"remove")}),$(this,"Images",{add:s((y,v,x)=>{let E=x,{floorId:M,flipImageToFaceCamera:I}=E,P=Nh(E,["floorId","flipImageToFaceCamera"]),C=M?this.floorsById.get(M):this.currentFloor,T={type:"Feature",properties:P,geometry:{type:"Point",coordinates:y}};return this.renderer.addImage(ga(),T,{url:v,flipImageToFaceCamera:I??!1},C.id)},"add"),remove:s(y=>{this.renderer.remove(y)},"remove"),removeAll:s(()=>{},"removeAll")}),$(this,"Markers",{add:s((y,v,x)=>{let E=h9(y,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),M=x,{attachTo:I}=M,P=Nh(M,["attachTo"]),C=P;P.rank==="initial"&&(C.rank="medium");let T=E.layers.get(By),D=this.renderer.addMarker2D(Np(y),v,vt(Ee({},C),{occluderId:E==null?void 0:E.occluderId,attachTo:I}),T==null?void 0:T.containerId);if(!D)throw new Oh("Failed to create Marker");return D},"add"),remove:s(y=>{this.renderer.remove(y)},"remove"),getContentEl:s(y=>{let v=this.renderer.getState(y);if((v==null?void 0:v.type)==="marker")return v.element},"getContentEl"),removeAll:s(()=>{},"removeAll"),setPosition:s((y,v,x)=>{var E;let M=this.renderer.getState(y),I=x?this.floorsById.get(x):this.currentFloor;if(!M){Vt.error('Failed to retrieve state for Marker with id "'.concat(y,'".'));return}if(M.type!=="marker"){Vt.error('Geometry with id "'.concat(y,'" is not of type "marker".'));return}this.renderer.setState(M,{position:v,parent:(E=I==null?void 0:I.layers.get(By))==null?void 0:E.containerId})},"setPosition"),animateTo:s((y,v,x,E)=>{let M=this.renderer.getState(y),I=x?this.floorsById.get(x):this.currentFloor;if(!M)return Vt.error('Failed to retrieve state for Marker with id "'.concat(y,'".')),Promise.resolve();if(M.type!=="marker")return Vt.error('Geometry with id "'.concat(y,'" is not of type "marker".')),Promise.resolve();let P=Ee({duration:1e3,easing:"ease-in-out"},E);this.cancelAnimation(y);let C=new pf({lon:M.position[0],lat:M.position[1]}).to({lon:v[0],lat:v[1]},P.duration).easing(drt[P.easing]).onUpdate(({lon:T,lat:D})=>{var F;if(!this.renderer.getState(y))this.cancelAnimation(y);else{let k=(F=I==null?void 0:I.layers.get(By))==null?void 0:F.containerId;k&&this.Markers.setPosition(y,[T,D],k)}}).start();return this.renderer.getTweenGroup().add(C),this.renderer.render(),this.animations.set(y,C),c9(C).then(()=>{this.animations.delete(y)})},"animateTo")}),$(this,"Exporter",{getCurrentSceneGLTF:s(async y=>this.renderer.getCurrentSceneGLTF(y),"getCurrentSceneGLTF")}),$(this,"Shapes",{add:s((y,v,x)=>{let E=x!=null&&x.floorId?this.floorsById.get(x==null?void 0:x.floorId):this.currentFloor,M=ga();return this.renderer.addGeometryGroup(M,y,v,E.id),M},"add"),remove:s(y=>(this.renderer.remove(y.id),y.id),"remove")}),$(this,"Text3D",{label:s((y,v,x)=>{var E;if(!((E=this.api.getMapDataInternal())!=null&&E.enterpriseMode)){Vt.warn("Enterprise mode is not enabled, skipping label creation");return}let M=JN(this.renderer,y,v,x);if(M)return{textInfo:M,target:y}},"label"),labelAll:s((y={})=>{var v;if(!((v=this.api.getMapDataInternal())!=null&&v.enterpriseMode))return Vt.warn("Enterprise mode is not enabled, skipping label creation"),[];let x=this.api.getMapData();if(!x)return[];let E=[];return x.getByType("space").forEach(M=>{var I,P;if(M.locations[0]){let C=JN(this.renderer,M,(P=(I=M.locations[0])==null?void 0:I.name)!=null?P:M.name,y);C&&E.push({textInfo:C,target:M})}}),E},"labelAll"),remove:s(y=>{var v;if(!((v=this.api.getMapDataInternal())!=null&&v.enterpriseMode)){Vt.warn("Remove text label only works in enterprise mode");return}return this.renderer.remove(y),y},"remove")}),$(this,"Labels",{all:s(({onCreate:y,labelOptions:v={}})=>{for(let x of Object.entries(this.mvf.space)){let[E,M]=x;M&&M.features.forEach(I=>{var P,C,T,D,F;let k=(P=this.api.getMapData())==null?void 0:P.getById("space",I.properties.id);if(!k)return;let B=(C=this.styleMap[I.properties.id])==null?void 0:C.showImage,U=(T=I.properties.details)==null?void 0:T.images,z=B&&(D=U==null?void 0:U[0])!=null&&D.url?{icon:U[0].url}:{},q=Ee({marker:Ee(Ee({},z),(F=v.appearance)==null?void 0:F.marker)},v.appearance),Z=(E?this.floorsById.get(E):this.currentFloor).layers.get(F_);if(I.properties.center&&k.name!==""){let Q=this.renderer.addLabel2D(I.properties.center,k.name,vt(Ee({id:I.properties.id+"-label"},v),{appearance:q,rank:v.rank,attachTo:X4(k)}),Zp.is(k)?k.id:Z==null?void 0:Z.containerId);Q&&y(Q.id,k.name,k)}})}},"all"),add:s((y,v,x={})=>{let E=x,{attachTo:M}=E,I=Nh(E,["attachTo"]),P=h9(y,this.floorsById,this.api.mapObjects[0].floorsById.get("default-floor")),C=P.layers.get(F_),T=this.renderer.addLabel2D(Np(y),v,vt(Ee({},I),{occluderId:P.occluderId,attachTo:M}),C==null?void 0:C.containerId);if(!T)throw new Oh("label creating failed");return T},"add"),remove:s(({entityId:y})=>{this.renderer.remove(y)},"remove"),removeAll:s(()=>{},"removeAll")}),$(this,"Paths",{add:s((y,v)=>{var x;let E=(x=v==null?void 0:v.animateDrawing)!=null?x:!0,M=[],I=y[0].floorId||"root",P=0;for(let T of y){let{floorId:D="root",latitude:F,longitude:k}=T;D!==I&&(P++,I=D),M[P]==null&&M.push({floorId:D,coordinates:[]});let B=D===T.floorId?T:new Rn({longitude:k,latitude:F,floorId:D});M[P].coordinates.push(B)}let C=M.reduce((T,{floorId:D,coordinates:F},k)=>{if(k!==0){let U=M[k-1],z=U.coordinates[U.coordinates.length-1],q=F[0],Z=Np(z),Q=Np(q),V=this.renderer.addPath({type:"FeatureCollection",features:[{type:"Feature",properties:{parentId:U.floorId},geometry:{type:"Point",coordinates:Z}},{type:"Feature",properties:{parentId:D},geometry:{type:"Point",coordinates:Q}}]},v,this.id);V&&(v!=null&&v.animateDrawing&&this.renderer.setState(V.id,{completeFraction:0}),T.push(vt(Ee({},V),{coordinates:[z,q]})))}let B=this.renderer.addPath({type:"FeatureCollection",features:F.map(U=>({type:"Feature",properties:{},geometry:{type:"Point",coordinates:Np(U)}}))},v,D);return B&&(v!=null&&v.animateDrawing&&this.renderer.setState(B.id,{completeFraction:0}),T.push(vt(Ee({},B),{coordinates:F}))),T},[]);if(E){let T=[],D=this.api.getMapData();return C.forEach(F=>{var k;let B=WDe(F,D,this.api);T.push(new pf({fraction:0}).to({fraction:1},B===!1?0:(k=v==null?void 0:v.drawDuration)!=null?k:1500).onUpdate(U=>{this.renderer.setState(F.id,{completeFraction:U.fraction})}))}),T.forEach((F,k)=>{k<T.length-1&&F.chain(T[k+1]),this.renderer.getTweenGroup().add(F)}),T[0].start(),this.renderer.render(),this.animations.set(C[0].id.toString(),T[0]),{paths:C,animation:c9(T[T.length-1]).then(()=>{this.animations.delete(C[0].id.toString())})}}else return{paths:C,animation:Promise.resolve()}},"add"),remove:s(y=>{y.forEach(v=>{this.cancelAnimation(v),this.renderer.remove(v)})},"remove")}),Be(this,jd,{enabled:!1,floorHeight:10,updateCameraElevationOnFloorChange:!0}),this.renderer=n.core,this.api=n,this.id=e,this.renderer.addGroupContainer(e,{},"root"),this.options=i??{},this.StackedMaps=new hrt({currentMapGetter:s(()=>this,"currentMapGetter")}),this.mvf=(a=r==null?void 0:r.mvf)!=null?a:{};let c=GDe(this.mvf["styles.json"]||{});if(this.styleMap=c,He(this,jd,Ee({enabled:!1,floorHeight:10,updateCameraElevationOnFloorChange:!0},i==null?void 0:i.multiFloorView)),!r){this.id!=="outdoors-container"&&Vt.warn("Map (".concat(this.id,") created with no data."));let y=new BX({id:"default-stack",externalId:"default-stack",name:"Default Stack",maps:["default-floor"]},this.id,this.renderer);this.floorStacksById.set(y.id,y),this.currentFloorStackId=y.id;let v=new OX(y.id,{id:"default-floor",externalId:"default-floor",name:"Default Floor",elevation:0},this.renderer,w(this,jd),i??{});y.addFloor(v),this.floorsById.set(v.id,v),this.setFloor(v.id);return}let p=r.getMVFFeatureByType("floor-stack");if(p==null||p.length===0)throw new Oh("MVF does not contain any Floor Stacks.");for(let y of p){let v=new BX(y,this.id,this.renderer,(o=this.mvf.facade)==null?void 0:o[y.id]);if(v.floorIds.length!==0){for(let x of v.floorIds){let E=r.getMVFFeatureById("floor",x);if(E!=null){let M=this.mvf.space[E.id],I=this.mvf.obstruction[E.id];if((M==null||M.features.length===0)&&(I==null||I.features.length===0))continue;let P=new OX(v.id,E,this.renderer,w(this,jd),i??{},this.mvf,c,r);v.addFloor(P),this.floorsById.set(P.id,P)}}this.floorStacksById.set(y.id,v),this.currentFloorStackId||(this.currentFloorStackId=y.id)}}for(let[y]of Object.entries(r.facadesBySpaceId)){let v=r.getById("space",y);v&&(this.outdoorFloorStacks.add(v.floor.floorStack.id),(l=this.floorsById.get(v.floor.id))==null||l.setVisible(!0))}let m=(u=this.mvf.enterprise)==null?void 0:u.venue.defaultMap;if(i!=null&&i.initialFloor){let y=n3(i.initialFloor);y&&this.floorsById.has(y)?m=y:Vt.error("Invalid initial floor specified (".concat(i.initialFloor,"), using default behavior instead"))}m||(m=this.currentFloorStack.defaultFloor.id),this.setFloor(m)}get currentFloorStack(){let e=this.floorStacksById.get(this.currentFloorStackId);if(!e)throw new Oh('Current floor stack with id "'.concat(this.currentFloorStackId,'" not found'));return e}setFloorStack(e,r){if(this.currentFloorStackId===e)return;let i=this.floorStacksById.get(e);if(i==null){Vt.error("Invalid floor stack passed to setFloorStack (".concat(e,"), the floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}if(i.floorObjects.length===0){Vt.error("Floor stack (".concat(e,") has no floors. The floor stack was not changed. Current floor stack is still ").concat(this.currentFloorStack.id,"."));return}this.setFloor(i.defaultFloor.id,r)}get currentFloor(){let e=this.floorsById.get(this.currentFloorId);if(!e)throw new Oh('Floor with id "'.concat(this.currentFloorId,'" not found'));return e}get floors(){return Array.from(this.floorsById.values())}processFloorChange(e){var r,i,n,a,o;if(this.api.manualFloorVisibility===!0||this.StackedMaps.expandedFactor!==0)return;let l=this.floorsById.get(e),u=this.floorStacksById.get(this.currentFloorStackId);if(l&&u)if(!((r=w(this,jd))!=null&&r.enabled)||l.floorStackId!==(u==null?void 0:u.id))for(let c of this.floorStacksById.values())c.floorObjects.forEach(p=>{p.id!==e&&p.setVisible(!1)});else{let c=oDe(this.currentFloorStack.floorObjects,l,w(this,jd).floorHeight,((n=(i=this.api.Navigation)==null?void 0:i.floors)==null?void 0:n.map(p=>p.id))||[]);(o=(a=this.api)==null?void 0:a.Outdoor)==null||o.setOpacity(c.outdoorOpacity),c.floorStates.forEach(p=>{p.floor&&this.api.updateState(p.floor.id,p.state)}),w(this,jd).updateCameraElevationOnFloorChange&&this.api.Camera.setElevation(l.elevation*w(this,jd).floorHeight)}}setFloor(e,r){if(this.currentFloorId===e)return;if(!this.floorsById.get(e)){Vt.error("Invalid floor passed to setFloor (".concat(e,"), the floor was not changed. Current floor is still ").concat(this.currentFloor.id));return}let i=this.currentFloorId;this.publish("floor-change-start",{previousFloorId:i,floorId:e,reason:r}),!this.StackedMaps.expanded&&this.currentFloorStack&&this.processFloorChange(e),this.currentFloorId=e,this.currentFloorStackId=this.currentFloor.floorStackId,this.currentFloor.setVisible(!0),this.publish("floor-change",{reason:r,floorId:this.currentFloor.id,previousFloorId:i})}cancelAnimation(e){let r=this.animations.get(e);r&&(r.stop(),this.animations.delete(e),this.renderer.getTweenGroup().remove(r))}};jd=new WeakMap,s(sDe,"GeojsonApiMapObject");var zX=sDe;function JN(t,e,r,i){return t.labelText3D(e.id,r??e.name,vt(Ee({},i),{parentId:e.floor.id}))}s(JN,"labelSpace");N();var Sp,YI,lDe=class{constructor({currentMapGetter:e}){Be(this,Sp,new Map),Be(this,YI),He(this,YI,e)}get currentMap(){return w(this,YI).call(this)}getById(e){return w(this,Sp).get(e)}add(e,r,i){let n=e.anchorTarget;if(!n)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Markers.add(n,r,vt(Ee({},i),{rank:(i==null?void 0:i.rank)||"medium",dynamicResize:(i==null?void 0:i.dynamicResize)||!1,attachTo:X4(e)}));if(o==null)throw new Error("error creating marker");let l=a.Markers.getContentEl(o.id.toString());if(!l)throw new Error("marker component should exist");let u=new bj(o.id.toString(),l,e);return w(this,Sp).set(u.id,{marker:u,entityId:o.id.toString()}),u}remove(e){var r;let i=w(this,Sp).get(e.id);i&&((r=this.currentMap)==null||r.Markers.remove(i.entityId),w(this,Sp).delete(e.id.toString()))}removeAll(){let e=[];return w(this,Sp).forEach(({marker:r})=>{this.remove(r),e.push(r),w(this,Sp).delete(r.id.toString())}),e}setPosition(e,r){var i;let n=r.anchorTarget;if(!n){Vt.error("Cannot determine coordinate from target.");return}let a=this.currentMap;if(!a){Vt.error("Cannot determine the current map.");return}let o=w(this,Sp).get(e.id);if(!o){Vt.error('Cannot find the Marker with id "'.concat(e.id,'".'));return}a.Markers.setPosition(o.entityId,Np(n),(i=n.floorId)!=null?i:a.currentFloorId),o.marker.updateTarget(r)}animateTo(e,r,i){var n;let a=r.anchorTarget;if(!a)return Vt.error("Cannot determine coordinate from target."),Promise.resolve();let o=this.currentMap;if(!o)return Vt.error("Cannot determine the current map."),Promise.resolve();let l=w(this,Sp).get(e.id);return l?(l.marker.updateTarget(r),o.Markers.animateTo(l.entityId,Np(a),(n=a.floorId)!=null?n:o.currentFloorId,i)):(Vt.error('Cannot find the Marker with id "'.concat(e.id,'".')),Promise.resolve())}};Sp=new WeakMap,YI=new WeakMap,s(lDe,"Markers");var frt=lDe;N();var Sm,KI,uDe=class{constructor({currentMapGetter:e}){Be(this,Sm,new Map),Be(this,KI),He(this,KI,e)}get currentMap(){return w(this,KI).call(this)}getById(e){return w(this,Sm).get(e)}add(e,r,i){var n;let a=e.anchorTarget;if(!a)throw new Error("Target does not implement IAnchorable.");let o=this.currentMap;if(!o)throw new Error("currentMap should exist");let l=o.Images.add(Np(a),r,vt(Ee({},i),{floorId:a.floorId,verticalOffset:a.verticalOffset+((n=i.verticalOffset)!=null?n:0)}));if(!l)throw new Error("image component should exist");let u=new Gtt(l.id.toString(),r,e);return w(this,Sm).set(u.id,{image:u,entityId:l.id.toString()}),u}remove(e){var r;let i=w(this,Sm).get(e.id);i&&((r=this.currentMap)==null||r.Images.remove(i.entityId),w(this,Sm).delete(e.id.toString()))}removeAll(){let e=[];return w(this,Sm).forEach(({image:r})=>{this.remove(r),e.push(r),w(this,Sm).delete(r.id.toString())}),e}};Sm=new WeakMap,KI=new WeakMap,s(uDe,"Images");var mrt=uDe;N();var $d,JI,cDe=class{constructor({currentMapGetter:e}){Be(this,$d,new Map),Be(this,JI),He(this,JI,e)}get currentMap(){return w(this,JI).call(this)}getById(e){return w(this,$d).get(e)}add(e,r,i){let n=[e],a=n.reduce((u,c)=>{var p;return c?(u.has(c.floorId)||u.set(c.floorId,[]),(p=u.get(c.floorId))==null||p.push(c),u):(Vt.error("Cannot determine coordinate from options."),u)},new Map);if(!n.length)throw new Error("targets should not be empty when adding a model");let o=this.currentMap;if(!o)throw new Error("currentMap should exist");let l=[];return a.forEach((u,c)=>{let p=ga();o.Models.add(p,u,vt(Ee({},i),{url:r,floorId:c})).forEach(({id:m})=>{let y=new FLe(m.toString(),p,u[0]);w(this,$d).set(y.id,{model:y,entityId:m.toString(),groupId:p}),l.push(y)})}),l[0]}remove(e){var r;let i=w(this,$d).get(e.id);i&&((r=this.currentMap)==null||r.Models.remove(i.entityId,i.groupId),w(this,$d).delete(e.id.toString()))}removeAll(){let e=[];return w(this,$d).forEach(({model:r})=>{var i;let n=w(this,$d).get(r.id);n&&(e.push(r),(i=this.currentMap)==null||i.Models.remove(n.entityId,n.groupId),w(this,$d).delete(r.id.toString()))}),e}};$d=new WeakMap,JI=new WeakMap,s(cDe,"Models");var grt=cDe;N();var Gd,QI,hDe=class{constructor({currentMapGetter:e}){Be(this,Gd,new Map),Be(this,QI),He(this,QI,e)}get currentMap(){return w(this,QI).call(this)}getById(e){return w(this,Gd).get(e)}add(e,r){let i=this.currentMap;if(!i)throw new Error("currentMap should exist");let n=i.Paths.add(e,r),a=n.paths.map(l=>l.id.toString()),o=new pA(ga(),n.animation,e,n.paths);for(let l of a)w(this,Gd).set(l,{path:o,entityIds:a});return w(this,Gd).set(o.id,{path:o,entityIds:a}),o}remove(e){var r;let i=w(this,Gd).get(e.id);i&&((r=this.currentMap)==null||r.Paths.remove(i.entityIds),w(this,Gd).delete(e.id),i.entityIds.forEach(n=>w(this,Gd).delete(n)))}removeAll(){let e=[];return w(this,Gd).forEach(({path:r})=>{this.remove(r),e.push(r)}),e}};Gd=new WeakMap,QI=new WeakMap,s(hDe,"Paths");var yrt=hDe;N();var vrt=Rr(lye(),1);N();var qD="#2266ff",_rt="#808080",xrt="#f5f5f5",brt={radius:10,color:qD,inactiveColor:_rt,heading:{color:qD,opacity:.7},accuracyRing:{color:qD,opacity:.3},timeout:3e4,watchDevicePosition:!0,debug:!1};N();var wrt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAkklEQVRoge3awQ3AIAxD0VAMYf+F0yUixbL8JshXuLSwIqJCwDc9QBeZEOy9p2doAQDTM7TQ2cg5Z3qGFjpHS2YjDiGDe+/0DC0cwkYpJKdnaIFMkY1kymzEIVQcwsYhbPDem56hhc5GHELGIWwcwsYhbJS+2R1CxSFsdH5iO4SMr97Y6FxPqxytVVV+HcTEIWx+9mcIqHSOm9QAAAAASUVORK5CYII=";N();var Art=s((t,e,r=0)=>{if(Math.abs(t)>=Math.PI)throw new Error("Sector angle too wide!");let i=r/Math.tan(t/2),n=r/Math.sin(t/2),a=n+e,o=10,l=new ox;l.moveTo(-n*Math.sin(t/2),n*Math.cos(t/2)-i);for(let u=0;u<o;u++)l.lineTo(-(a*Math.sin(t/2-t/o*u)),a*Math.cos(t/2-t/o*u)-i);for(let u=0;u<o;u++)l.lineTo(-(r*Math.sin(Math.PI/-2+Math.PI/o*u)),r*Math.cos(Math.PI/-2+Math.PI/o*u));return new kA(l,{depth:.1,bevelEnabled:!1,UVGenerator:Srt(e)})},"createSectorGeometry"),WD=s((t,e,r)=>{let i=Math.sqrt(Math.pow(t,2)+Math.pow(e,2))/r;return i>1?i=1:i<0&&(i=0),new Jt(0,i)},"generateRadialUV"),Srt=s(t=>({generateTopUV:s((e,r,i,n,a)=>{let o=r[i*3],l=r[i*3+1],u=r[n*3],c=r[n*3+1],p=r[a*3],m=r[a*3+1];return[WD(o,l,t),WD(u,c,t),WD(p,m,t)]},"generateTopUV"),generateSideWallUV:s(()=>[new Jt(0,1),new Jt(0,1),new Jt(0,1),new Jt(0,1)],"generateSideWallUV")}),"radialUVGenerator");function pDe(t,e){if(e==null)return t;let r={latitude:t==null?void 0:t.latitude,longitude:t==null?void 0:t.longitude,accuracy:t==null?void 0:t.accuracy,floor:t==null?void 0:t.floor,heading:t==null?void 0:t.heading};return"latitude"in e&&(r.latitude=(e==null?void 0:e.latitude)==null||e.latitude==="device"?t==null?void 0:t.latitude:e.latitude),"longitude"in e&&(r.longitude=e.longitude==null||e.longitude==="device"?t==null?void 0:t.longitude:e.longitude),"accuracy"in e&&(r.accuracy=e.accuracy==="device"?t==null?void 0:t.accuracy:e.accuracy),"floor"in e&&(r.floor=e.floor==="device"?t==null?void 0:t.floor:e.floor),"heading"in e&&(r.heading=e.heading==="device"?t==null?void 0:t.heading:e.heading),r}s(pDe,"getPositionWithOverrides");function dDe([t,e],[r,i],[n,a]){let o=r-t,l=i-e,u=o**2+l**2;if(u===0)return;let c=((n-t)*o+(a-e)*l)/u,p;c<=0?p=[t,e]:c>=1?p=[r,i]:p=[t+c*o,e+c*l];let m=OB([n,a],p);return{proportion:Math.max(0,Math.min(1,c)),intersection:p,distance:m}}s(dDe,"getPointLineIntersection");function fDe(t,e){if(t==null||t.length<2)return;let r=Number.MAX_SAFE_INTEGER,i,n=0,a=0;for(let o=0;o<t.length-1;o++){let l=t[o],u=t[o+1],c=dDe(l,u,e);c!=null&&c.distance<r&&(r=c.distance,i=c.intersection,n=o,a=c.proportion)}if(i)return{intersection:i,distance:r,segmentIndex:n,proportion:a}}s(fDe,"findBlueDotOnPath");function mDe(t,e){let r=new R_({color:t,opacity:e,transparent:!0,depthTest:!1,depthWrite:!1}),i=.35,n=.35*4,a=Art(Math.PI/6,n,i);new IB().load(wrt,l=>{r.alphaMap=l,r.needsUpdate=!0});let o=new Tn(a,r);return o.position.z=-.05,o.renderOrder=0,o}s(mDe,"createHeadingCone");function gDe(t,e){let r=new hO(1,1,.05,32),i=new R_({transparent:!0,color:t,opacity:e,depthTest:!1,depthWrite:!1}),n=new Tn(r,i);return n.scale.set(0,0,.05),n.renderOrder=1,n.rotation.x=Math.PI/2,n}s(gDe,"createAccuracyRing");function yDe(t){let e=new hO(.35,.35,.07,32),r=new R_({transparent:!0,color:xrt,depthTest:!1,depthWrite:!1}),i=new Tn(e,r);i.renderOrder=2;let n=new hO(.35*.8,.35*.8,.01,32),a=new R_({transparent:!0,color:t,depthTest:!1,depthWrite:!1}),o=new Tn(n,a);return o.renderOrder=3,i.rotation.x=Math.PI/2,i.position.z=.07/2,o.rotation.x=Math.PI/2,o.position.z=.07,{outerMesh:i,innerMesh:o}}s(yDe,"createBlueDot");var Mrt=Rr(fWe(),1),QN="blue-dot",v1,Mm,Hc,qc,Em,_1,x1,b1,ss,sc,eT,Cm,tT,rT,iT,nT,e9,Hd,Im,t9,w1,aT,qd,vDe=class extends qa{constructor(e,r){super(),this.core=e,this.geoJSONApi=r,Be(this,v1,null),$(this,"geometry"),Be(this,Mm),Be(this,Hc),Be(this,qc),Be(this,Em),Be(this,_1),Be(this,x1),Be(this,b1),Be(this,ss,brt),Be(this,sc,1),Be(this,eT),Be(this,Cm),$(this,"state","disabled"),$(this,"following",!1),Be(this,tT,s(i=>{var n;return(n=this.geoJSONApi.getMapData())==null?void 0:n.getById("floor",i)},"#getFloorByFloorId")),Be(this,rT,s(i=>{var n;let a;if(i!=null){let o=(n=this.geoJSONApi.currentMap)==null?void 0:n.currentFloorStack.floorObjectsByElevation.get(i);a=o?w(this,tT).call(this,o.id):void 0}return a},"#getFloorByFloorLevel")),Be(this,iT,s(i=>{if(this.state==="hidden"||this.state==="disabled")return;let[n,a,o,l]=i.children;if(w(this,e9).call(this),a.scale.set(w(this,sc),w(this,sc),w(this,sc)),a.position.z=.07/2*w(this,sc),o.scale.set(w(this,sc),w(this,sc),w(this,sc)),o.position.z=.07*w(this,sc),this.state==="active"){o.material.color.set(w(this,ss).color);let u=this.accuracy;u!=null?(n.visible=!0,w(this,x1)&&w(this,x1).stop(),He(this,x1,new pf({scale:n.scale.x}).to({scale:u/2},150).onUpdate(({scale:p})=>{n.scale.set(p,1,p)}).start()),this.core.getTweenGroup().add(w(this,x1))):n.visible=!1;let c=this.heading;if(c!=null){l.visible=!0,w(this,b1)&&w(this,b1).stop();let{start:p,end:m}=kB(l.rotation.z,-$n.degToRad(c));He(this,b1,new pf({rotation:p}).to({rotation:m},150).onUpdate(({rotation:y})=>{l.rotation.z=y}).start()),this.core.getTweenGroup().add(w(this,b1)),l.scale.set(w(this,sc),w(this,sc),1)}else l.visible=!1}else this.state==="inactive"&&(o.material.color.set(w(this,ss).inactiveColor),l.visible=!1,n.visible=!1)},"#updateGeometryPerFrame")),Be(this,nT,s(i=>{var n,a;let o;try{o=Trt.parse(pDe(i,w(this,Hc)))}catch(c){w(this,Hd).call(this,"error"),Vt.error("BlueDot: Position parse failed",c instanceof xt.ZodError?c.message:String(c)),this.publish("error");return}w(this,ss).debug&&Vt.log("BlueDot: Parsed position",o),He(this,qc,o),w(this,Hd).call(this,"position-update"),w(this,Em)&&clearTimeout(w(this,Em)),typeof w(this,ss).timeout=="number"&&w(this,ss).timeout<1/0&&He(this,Em,setTimeout(()=>{w(this,ss).debug&&Vt.log("BlueDot: Position timed out after ".concat(w(this,ss).timeout,"ms")),w(this,Hd).call(this,"timeout"),this.core.render()},w(this,ss).timeout)),(a=this.geoJSONApi.getMapDataInternal())==null||a.Analytics.updateState({userPosition:{bluedotTimestamp:Date.now(),latitude:o.latitude,longitude:o.longitude,floorLevel:(n=o.floor)==null?void 0:n.elevation,accuracy:o.accuracy}});let l=o.floor!=null?o.floor.id:this.geoJSONApi.currentFloor.id||"outdoors-container",u=[o.longitude,o.latitude];if(!this.geometry)this.geometry=this.core.addCustomGeometry(QN,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:u}},{setup:s(c=>{let p=gDe(w(this,ss).accuracyRing.color,w(this,ss).accuracyRing.opacity),{outerMesh:m,innerMesh:y}=yDe(w(this,ss).color),v=mDe(w(this,ss).heading.color,w(this,ss).heading.opacity);c.add(p),p.visible=!1,c.add(m),c.add(y),c.add(v),v.visible=!1,w(this,iT).call(this,c)},"setup"),update:w(this,iT)},{visible:!0,interactive:!0},l);else{let c=this.core.getState(this.geometry);u=[c.position[0],c.position[1]]}w(this,_1)&&w(this,_1).stop(),He(this,_1,new pf(u).to([o.longitude,o.latitude],1e3).easing(Rl.Cubic.Out).onUpdate(c=>{if(this.geometry){let p={position:[c[0],c[1]]};p.parent=l,this.core.setState(this.geometry,p)}}).start()),this.core.getTweenGroup().add(w(this,_1)),this.publish("position-update",{floor:this.floor,heading:this.heading,accuracy:this.accuracy,coordinate:this.coordinate}),this.core.render()},"#setPosition")),$(this,"onPositionUpdate",s(i=>{var n,a,o,l,u;if(this.state!=="disabled"){try{Irt.parse(i)}catch(c){w(this,Hd).call(this,"error"),Vt.error("BlueDot: Browser sent invalid position",c instanceof xt.ZodError?c.message:String(c)),this.publish("error");return}He(this,Mm,{latitude:(n=i.coords)==null?void 0:n.latitude,longitude:(a=i.coords)==null?void 0:a.longitude,accuracy:(o=i.coords)==null?void 0:o.accuracy,heading:(l=i.coords)==null?void 0:l.heading,floor:w(this,rT).call(this,(u=i.coords)==null?void 0:u.floorLevel)}),w(this,nT).call(this,w(this,Mm))}},"onPositionUpdate")),$(this,"onPositionError",s(i=>{var n;switch(w(this,Hd).call(this,"error"),i.code){case i.PERMISSION_DENIED:Vt.error("Geolocation permission denied by the user.",i),(n=this.geoJSONApi.getMapDataInternal())==null||n.Analytics.sendWatchPositionDenied();break;case i.POSITION_UNAVAILABLE:Vt.error("Geolocation position unavailable.",i);break;case i.TIMEOUT:Vt.error("Geolocation request timed out.",i);break;default:Vt.error("An unknown geolocation error occurred.",i);break}this.publish("error",i)},"onPositionError")),Be(this,e9,s(()=>{var i;let n=Math.round(this.core.camera.zoomLevel*1e5);if(n!==w(this,eT)){He(this,eT,n);let a=(i=this.core.getMetresPerPixel())!=null?i:1;He(this,sc,Math.max(w(this,ss).radius/(.35/a),1))}},"#updateScale")),Be(this,Hd,s(i=>{let n=Crt[this.state].actions[i];if(n){switch(w(this,ss).debug&&Vt.log("BlueDot: Transitioning from ".concat(this.state," to ").concat(n," using ").concat(i)),n){case"hidden":case"disabled":this.geometry&&this.core.setState(this.geometry,{visible:!1});break;case"active":this.geometry&&this.core.setState(this.geometry,{visible:!0});break}this.state!==n&&(this.publish("state-change",{state:n,action:i}),this.state=n)}else Vt.warn("BlueDot: Invalid state transition from ".concat(this.state," to ").concat(n," using ").concat(i))},"#transitionAction")),Be(this,Im),Be(this,t9,s(()=>{if(w(this,Im)==null&&this.geoJSONApi.Navigation.activeDirections!=null){let i=(Array.isArray(this.geoJSONApi.Navigation.activeDirections)?this.geoJSONApi.Navigation.activeDirections.flatMap(n=>n.coordinates):this.geoJSONApi.Navigation.activeDirections.coordinates).filter(n=>n.floorId===this.geoJSONApi.currentFloor.id);He(this,Im,(0,Mrt.default)(i.map(n=>({x:n.longitude,y:n.latitude})),1e-5).map(n=>[n.x,n.y]))}return w(this,Im)},"#getSimplifiedDirections")),Be(this,w1,s(()=>{this.core.camera.isAnimating&&this.core.camera.cancelAnimation(),w(this,qd)&&(this.off("position-update",w(this,qd)),He(this,qd,void 0)),this.following=!1,He(this,Im,void 0),this.core.off("user-interaction-start",w(this,w1)),this.geoJSONApi.currentMap.off("navigation-active-path-change",w(this,aT)),this.publish("follow-change",{following:!1})},"#cancelFollow")),Be(this,aT,s(()=>{He(this,Im,void 0)},"#pathChangeHandler")),Be(this,qd),$(this,"follow",s((i,n)=>{var a,o,l,u;if(i===!1){w(this,w1).call(this);return}i!=="position-only"&&(n==null?void 0:n.bearing)!=null&&Vt.warn("BlueDot: Camera bearing option will be ignored in follow mode '".concat(i,"'. To control the bearing manually, use mode 'position-only'."));let c={zoomLevel:(a=n==null?void 0:n.zoomLevel)!=null?a:21,bearing:i==="position-only"?n==null?void 0:n.bearing:void 0,pitch:(o=n==null?void 0:n.pitch)!=null?o:45,duration:(l=n==null?void 0:n.duration)!=null?l:1e3,easing:(u=n==null?void 0:n.easing)!=null?u:"ease-in-out"};this.following?w(this,qd)&&this.off("position-update",w(this,qd)):(this.following=!0,this.core.on("user-interaction-start",w(this,w1)),this.geoJSONApi.currentMap.on("navigation-active-path-change",w(this,aT))),He(this,qd,p=>{let{coordinate:m,heading:y,floor:v}=p;if(c.center=[m.longitude,m.latitude],v!=null&&v.id!==this.geoJSONApi.currentFloor.id&&(this.geoJSONApi.currentMap.setFloor(v.id),He(this,Im,void 0)),i==="position-and-heading")c.bearing=y??void 0;else if(i==="position-and-path-direction"){let x=w(this,t9).call(this);if(x!=null){let E=fDe(x,[m.longitude,m.latitude]);if(E!=null){let M=x[E.segmentIndex],I=x[E.segmentIndex+1];c.bearing=Bme(M,I)}}}this.core.camera.animateTo(c)}),this.on("position-update",w(this,qd)),this.publish("follow-change",{following:!0,mode:i})},"follow"))}get heading(){var e;return(e=w(this,qc))==null?void 0:e.heading}get accuracy(){var e;return(e=w(this,qc))==null?void 0:e.accuracy}get coordinate(){var e,r;if(w(this,qc)!=null)return(w(this,Cm)==null||((e=this.floor)==null?void 0:e.id)!==w(this,Cm).floorId||w(this,qc).latitude!==w(this,Cm).latitude||w(this,qc).longitude!==w(this,Cm).longitude)&&He(this,Cm,new Rn(w(this,qc).latitude,w(this,qc).longitude,(r=this.floor)==null?void 0:r.id)),w(this,Cm)}get floor(){var e;return(e=w(this,qc))==null?void 0:e.floor}enable(e){He(this,ss,(0,vrt.default)({},e,w(this,ss))),w(this,Hd).call(this,"enable"),this.watchDevicePosition(w(this,ss).watchDevicePosition)}disable(){this.geometry&&(this.core.remove(this.geometry.id),this.geometry=void 0),w(this,Em)&&(clearTimeout(w(this,Em)),He(this,Em,void 0)),this.following&&w(this,w1).call(this),this.watchDevicePosition(!1),He(this,qc,void 0),He(this,Hc,void 0),w(this,Hd).call(this,"disable")}watchDevicePosition(e){if(w(this,v1)&&(navigator.geolocation.clearWatch(w(this,v1)),He(this,v1,null)),w(this,Mm)&&He(this,Mm,void 0),e){if(this.state==="disabled"){Vt.warn("BlueDot must be enabled before watching browser position.");return}He(this,v1,navigator.geolocation.watchPosition(this.onPositionUpdate,this.onPositionError,{enableHighAccuracy:!0}))}}update(e){var r,i;e==null?He(this,Hc,void 0):"coords"in e?He(this,Hc,Object.assign({},w(this,Hc),{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,heading:e.coords.heading,floor:w(this,rT).call(this,e.coords.floorLevel)})):(He(this,Hc,Object.assign({},w(this,Hc),e)),"floorOrFloorId"in e&&(w(this,Hc).floor=typeof e.floorOrFloorId=="string"&&e.floorOrFloorId!=="device"?w(this,tT).call(this,e.floorOrFloorId):e.floorOrFloorId)),(((r=w(this,Hc))==null?void 0:r.latitude)!=null&&((i=w(this,Hc))==null?void 0:i.longitude)!=null||w(this,Mm)!=null)&&w(this,nT).call(this,w(this,Mm))}};v1=new WeakMap,Mm=new WeakMap,Hc=new WeakMap,qc=new WeakMap,Em=new WeakMap,_1=new WeakMap,x1=new WeakMap,b1=new WeakMap,ss=new WeakMap,sc=new WeakMap,eT=new WeakMap,Cm=new WeakMap,tT=new WeakMap,rT=new WeakMap,iT=new WeakMap,nT=new WeakMap,e9=new WeakMap,Hd=new WeakMap,Im=new WeakMap,t9=new WeakMap,w1=new WeakMap,aT=new WeakMap,qd=new WeakMap,s(vDe,"BlueDot");var Ert=vDe,Crt={hidden:{actions:{enable:"hidden",error:"hidden","position-update":"active",disable:"disabled",timeout:"hidden"}},active:{actions:{enable:"active",disable:"disabled","position-update":"active",error:"inactive",timeout:"inactive"}},inactive:{actions:{enable:"inactive",disable:"disabled","position-update":"active",error:"inactive",timeout:"inactive"}},disabled:{actions:{enable:"hidden",disable:"disabled"}}},Irt=xt.object({coords:xt.object({latitude:xt.number(),longitude:xt.number(),accuracy:xt.number(),altitude:xt.number().optional().nullable(),altitudeAccuracy:xt.number().optional().nullable(),heading:xt.number().optional().nullable(),speed:xt.number().optional().nullable(),floorLevel:xt.number().optional().nullable()}),timestamp:xt.number()}),Trt=xt.object({latitude:xt.number(),longitude:xt.number(),floor:xt.custom().optional(),accuracy:xt.number().optional(),heading:xt.number().optional().nullable()});N();var Tm,oT,_De=class{constructor({currentMapGetter:e}){Be(this,Tm,new Map),Be(this,oT),He(this,oT,e)}get currentMap(){return w(this,oT).call(this)}getById(e){return w(this,Tm).get(e)}add(e,r,i){let n=this.currentMap;if(!n)throw new Error("currentMap should exist");let a=n.Shapes.add(e,r||{},{floorId:i==null?void 0:i.id}),o=new jN(a);return w(this,Tm).set(o.id,o),o}remove(e){var r;w(this,Tm).get(e.id)&&((r=this.currentMap)==null||r.Shapes.remove(e),w(this,Tm).delete(e.id.toString()))}removeAll(){let e=[];return w(this,Tm).forEach(r=>{this.remove(r),e.push(r.id),w(this,Tm).delete(r.id.toString())}),e}};Tm=new WeakMap,oT=new WeakMap,s(_De,"Shapes");var Prt=_De;N();var sT,xDe=class{constructor({currentMapGetter:e}){Be(this,sT),He(this,sT,e)}get currentMap(){return w(this,sT).call(this)}setFromStyleCollection(e){var r,i,n,a;for(let o in e)for(let l of((r=this.currentMap)==null?void 0:r.floors)||[]){if(e[o]==null||!l.layers.has(rl))continue;let u=l.layers.get(rl);if(u!=null&&u.layers.has(o)&&"color"in e[o]){let m=u.layers.get(o);m&&((i=this.currentMap)==null||i.renderer.setState(m,{color:e[o].color}))}if(u&&o===KP&&!(N_ in e)){let m=u.layers.get(N_);m&&"color"in e[o]&&((n=this.currentMap)==null||n.renderer.setState(m,{color:e[o].color}))}if(!l.layers.has(hw))continue;let c=l.layers.get(hw),p=l.facadesByStyleId.get(o);if(p&&p.length>0)for(let m of p){let y=c.layers.get("".concat(m,"-").concat(o));y&&"color"in e[o]&&((a=this.currentMap)==null||a.renderer.setState(y,{color:e[o].color}))}}}};sT=new WeakMap,s(xDe,"Style");var Lrt=xDe;N();var XD={opacity:1},Wl,lT,uT,Ly,Pm,J2,r9,bDe,wDe=class{constructor(e,r){Be(this,J2),Be(this,Wl),Be(this,lT,[]),Be(this,uT,{opacity:"initial"}),Be(this,Ly,{opacity:new Map}),Be(this,Pm,new Set),He(this,Wl,e),He(this,lT,r||[]);let i=w(this,Wl).map;i&&i.on("idle",()=>{w(this,Ly).opacity.size||dr(this,J2,r9).call(this,i)})}setStyle(e){var r,i;if(w(this,Wl).map){(r=w(this,Wl).map)==null||r.setStyle(e),w(this,Pm).size&&(w(this,Pm).clear(),this.hide()),dr(this,J2,bDe).call(this),dr(this,J2,r9).call(this,w(this,Wl).map),this.setOpacity(w(this,uT).opacity),(i=w(this,Wl).map)==null||i.moveLayer(hge);for(let[n,a,o]of w(this,lT)||[])w(this,Wl).hideOutdoorLayersIntersectingPolygons(n,a,o)}}get map(){return w(this,Wl).map}get enabled(){return!!w(this,Wl).map}get visible(){return w(this,Pm).size===0}show(){let e=w(this,Wl).map;if(!e)return;let r=e.getStyle().layers;r&&(r.forEach(i=>{w(this,Pm).has(i.id)&&e.setLayoutProperty(i.id,"visibility","visible")}),w(this,Pm).clear())}hide(e=[]){let r=w(this,Wl).map;if(!r)return;let i=r.getStyle().layers;i&&i.forEach(n=>{let a=r.getLayoutProperty(n.id,"visibility");!e.includes(n.id)&&a!=="none"&&(r.setLayoutProperty(n.id,"visibility","none"),w(this,Pm).add(n.id))})}setOpacity(e,r=[]){var i,n;let a=w(this,Wl).map;if(!a)return;let o=(n=(i=w(this,Wl).map)==null?void 0:i.getStyle())==null?void 0:n.layers;o&&a.once("idle",()=>{o.forEach(l=>{let u=a.getLayoutProperty(l.id,"visibility");if(!r.includes(l.id)&&u!=="none")try{let c=w(this,Ly).opacity.get(l.id);c!==void 0&&(l.id==="background"||(l.type==="symbol"?(a.setPaintProperty(l.id,"icon-opacity",e==="initial"?c[0]:e),a.setPaintProperty(l.id,"text-opacity",e==="initial"?c[1]:e)):a.setPaintProperty(l.id,"".concat(l.type,"-opacity"),e==="initial"?c[0]:e)),w(this,uT).opacity=e)}catch(c){Vt.warn("Error setting opacity:",c)}})})}};Wl=new WeakMap,lT=new WeakMap,uT=new WeakMap,Ly=new WeakMap,Pm=new WeakMap,J2=new WeakSet,r9=s(function(t){let e=t.getStyle().layers;e&&e.forEach(r=>{var i,n,a;t.getLayoutProperty(r.id,"visibility")!=="none"&&(r.id==="background"||(r.type==="symbol"?w(this,Ly).opacity.set(r.id,[(i=t.getPaintProperty(r.id,"icon-opacity"))!=null?i:XD.opacity,(n=t.getPaintProperty(r.id,"text-opacity"))!=null?n:XD.opacity]):w(this,Ly).opacity.set(r.id,[(a=t.getPaintProperty(r.id,"".concat(r.type,"-opacity")))!=null?a:XD.opacity,void 0])))})},"#setInitialStyle"),bDe=s(function(){Object.values(w(this,Ly)).forEach(t=>t.clear())},"#clearInitialStyle"),s(wDe,"Outdoor");var Drt=wDe;N();function ADe(){O4e(!1)}s(ADe,"disableText3DWorker");var Lm,Dm,sy,SDe=class{constructor({currentMapGetter:e}){Be(this,Lm),Be(this,Dm,new Map),Be(this,sy,new Map),He(this,Lm,e)}labelAll(e={}){var r,i;let n=[],a=new Set;return(i=(r=w(this,Lm).call(this))==null?void 0:r.Text3D.labelAll(e))==null||i.forEach(({textInfo:o,target:l})=>{let u=o.id.toString(),c=w(this,sy).get(u);if(c){a.has(u)||n.push(c.text3DView),a.add(u);return}a.add(u);let p=new GN(u,l);w(this,Dm).set(p.id,{targetId:l.id,text3d:u,text3DView:p}),w(this,sy).set(u,{text3DView:p}),n.push(p)}),n}label(e,r,i={}){var n;if(w(this,Lm).call(this))if(Zp.is(e)){let a=(n=w(this,Lm).call(this))==null?void 0:n.Text3D.label(e,r,i);if(!a)return;let o=a.textInfo.id.toString(),l=w(this,sy).get(o);if(l)return l.text3DView;let u=new GN(o,a.target);return w(this,Dm).set(u.id,{targetId:a.target.id,text3d:o,text3DView:u}),w(this,sy).set(o,{text3DView:u}),u}else throw new Error("Non-space target is not supported")}remove(e){var r;let i=typeof e=="string"?e:e.id,n=w(this,Dm).get(i);n&&((r=w(this,Lm).call(this))==null||r.Text3D.remove(n.text3d),w(this,Dm).delete(i),w(this,sy).delete(n.text3d))}removeAll(){w(this,Dm).forEach(e=>{var r;(r=w(this,Lm).call(this))==null||r.Text3D.remove(e.text3d)}),w(this,Dm).clear()}};Lm=new WeakMap,Dm=new WeakMap,sy=new WeakMap,s(SDe,"Text3D");var Rrt=SDe,AE=.05,MDe=class{constructor(e,r){$(this,"core"),$(this,"mapObjects",[]),$(this,"id"),$(this,"mapDataExternal",{}),$(this,"mapsByFloorId",{}),$(this,"mapData"),$(this,"currentMap"),$(this,"hiddenOutdoorGeometries",[]),$(this,"lastFacadeIntersected"),$(this,"manualFloorVisibility",!1),$(this,"mapView"),$(this,"Camera"),$(this,"Labels"),$(this,"Text3D"),$(this,"Markers"),$(this,"Models"),$(this,"Paths"),$(this,"Exporter"),$(this,"Navigation"),$(this,"Outdoor"),$(this,"BlueDot"),$(this,"Shapes"),$(this,"Style"),$(this,"Images"),$(this,"update",s(()=>{this.core.render()},"update")),this.core=e,this.mapView=r,this.Camera=new srt(this),this.id=this.core.addGroupContainer("root").id.toString();let i=new zX("outdoors-container",void 0,void 0,this);this.mapObjects.push(i),this.currentMap=i,this.core.on("pre-render",()=>{this.mapView.publish("pre-render")}),this.core.on("post-render",()=>{this.mapView.publish("post-render")}),this.core.on("resize",()=>{this.mapView.publish("resize")}),this.core.on("geometry-in-focus",u=>{this.mapView.publish("facades-in-view-change",{facades:u.map(c=>{var p;return(p=this.getMapDataInternal())==null?void 0:p.facadesById[c]}).filter(c=>c!=null)})});let n=new Htt(this.Camera);this.core.on("camera-change",()=>{this.mapView.publish("camera-change",n)});let a=s(u=>c=>{var p,m,y;let v=[],x=[],E=[],M=[];c.labels.forEach(U=>{let z=this.Labels.getById(U.toString());z&&v.push(z.label)}),c.markers.forEach(U=>{let z=this.Markers.getById(U.toString())||this.Navigation.getMarkerById(U.toString());z&&x.push(z.marker)}),c.models.forEach(U=>{let z=this.Models.getById(U.toString());z&&E.push(z.model)}),c.paths.forEach(U=>{let z=this.Paths.getById(U.toString())||this.Navigation.getPathById(U.toString());z&&M.push(z.path)});let I=c.geometry.includes(QN),P=c.geometry.filter(U=>U!==QN)[0],C;P&&(C=(p=this.getMapDataInternal())==null?void 0:p.getById("space",P)),C||(C=(m=this.getMapDataInternal())==null?void 0:m.getById("object",P));let T=c.containers.reduce((U,z)=>{var q;let Z=(q=this.getMapDataInternal())==null?void 0:q.getById("floor",z);return Z&&jp.is(Z)&&U.push(Z),U},[]),D,F=0;if(T.length>0){D=T[0].id;let U=this.core.getState(D);F=c.coordinate[2]?c.coordinate[2]-U.altitude:F}let k;this.lastFacadeIntersected&&this.lastFacadeIntersected.spaces.forEach(U=>{this.core.setState(U.id,{hovered:!1})}),C&&Zp.is(C)&&(k=(y=this.getMapDataInternal())==null?void 0:y.facadesBySpaceId[P],k&&k.spaces.forEach(U=>{this.core.setState(U.id,{hovered:!0})})),this.lastFacadeIntersected=k;let B={coordinate:new Rn({latitude:c.coordinate[1],longitude:c.coordinate[0],floorId:D,verticalOffset:F}),spaces:C&&Zp.is(C)?[C]:[],objects:C&&Ky.is(C)?[C]:[],markers:x,labels:v,models:E,paths:M,blueDot:I,floors:T,facades:k?[k]:[]};"pointerEvent"in c&&(B.pointerEvent=c.pointerEvent),this.mapView.publish(u,B)},"createHandler");this.core.on("hover",a("hover")),this.core.on("click",a("click")),this.core.on("user-interaction-start",()=>{this.mapView.publish("user-interaction-start")}),this.core.on("user-interaction-end",()=>{this.mapView.publish("user-interaction-end")});let o={currentMapGetter:s(()=>this.currentMap,"currentMapGetter")};this.Markers=new frt(o),this.Models=new grt(o),this.Labels=new urt(o),this.Text3D=new Rrt(o),this.Exporter=new lrt(o),this.Paths=new yrt(o),this.Navigation=new rrt(this.core,this,o.currentMapGetter),this.BlueDot=new Ert(this.core,this),this.BlueDot.on("position-update",u=>{this.mapView.publish("blue-dot-position-update",u)}),this.BlueDot.on("state-change",u=>{this.mapView.publish("blue-dot-state-change",u)}),this.BlueDot.on("error",u=>{this.mapView.publish("blue-dot-error",u)}),this.BlueDot.on("follow-change",u=>{this.mapView.publish("blue-dot-follow-change",u)}),this.Outdoor=new Drt(this.core,this.hiddenOutdoorGeometries),this.Outdoor.enabled&&(this.core.on("outdoor-view-loaded",()=>{this.mapView.publish("outdoor-view-loaded")}),this.core.on("outdoor-style-loaded",()=>{this.mapView.publish("outdoor-style-loaded")})),this.Images=new mrt(o),this.Shapes=new Prt(o),this.Style=new Lrt(o);let l=new ort(r,this.mapDataExternal);this.auto=l.auto}get StackedMaps(){return this.currentMap.StackedMaps}preloadFloors(e){e.forEach(r=>{r instanceof jp&&this.core.setState(r.id,{preloadGeometry:!0})})}updateState(e,r){if(e==="interior-walls"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(rl);if(a){let o=a.layers.get(KP);o&&this.core.setState(o,u9(r,this.core.getState(o)))}});return}else if(e==="exterior-walls"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(rl);if(a){let o=a.layers.get(N_);o&&this.core.setState(o,u9(r,this.core.getState(o)))}});return}else if(e==="interior-doors"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(rl);if(a){let o=a.layers.get(gz);o&&this.core.setState(o,pT(r,this.core.getState(o)))}});return}else if(e==="exterior-doors"){this.currentMap.floors.forEach(n=>{let a=n.layers.get(rl);if(a){let o=a.layers.get(yz);o&&this.core.setState(o,pT(r,this.core.getState(o)))}});return}let i=typeof e=="string"?this.getMapDataObject(e):e;if(i){if(TN.is(i))return this.core.setState(i.id,zDe(vt(Ee({},r),{type:"label"}),this.core.getState(i.id)));if(bj.is(i))return this.core.setState(i.id,UDe(vt(Ee({},r),{type:"marker"}),this.core.getState(i.id)));if((Zp.is(i)||Ky.is(i))&&this.core.setState(i.id,VDe(vt(Ee({},r),{type:"geometry"}),this.core.getState(i.id))),GA.is(i)&&this.core.setState(i.id,pT(vt(Ee({},r),{type:"doors"}),this.core.getState(i.id))),jN.is(i)&&this.core.setState(i.id,Zc(r,["altitude","color","opacity"])),FLe.is(i)){let n=r,{position:a,scale:o}=n,l=Nh(n,["position","scale"]);a&&(l.position=[a.longitude,a.latitude,a.verticalOffset]),o!=null&&(Array.isArray(o)?l.scale=o:l.scale=[o,o,o]),a&&i.updateTarget(a),this.core.setState(i.id,l)}if(jp.is(i)){let n=this.currentMap.floorsById.get(i.id);if(n==null)return;this.core.setState(i.id,Zc(r,["visible","altitude"]));let a=n.layers.get(rl);a!=null&&"geometry"in r&&this.core.setState(a.containerId,Zc(r.geometry,["opacity","visible"]));let o=n.layers.get(F_);o!=null&&"labels"in r&&"enabled"in r.labels&&typeof r.labels.enabled=="boolean"&&o.setVisible(r.labels.enabled);let l=n.layers.get(By);l!=null&&"markers"in r&&"enabled"in r.markers&&typeof r.markers.enabled=="boolean"&&l.setVisible(r.markers.enabled);let u=n.layers.get(xk);u!=null&&"footprint"in r&&this.core.setState(u.containerId,Zc(r.footprint,["visible","height","opacity","side","color","altitude"]));let c=n.layers.get(h3);c!=null&&"occlusion"in r&&"enabled"in r.occlusion&&typeof r.occlusion.enabled=="boolean"&&c.setVisible(r.occlusion.enabled)}if(ex.is(i)){let n=this.core.getState(i.id);for(let a of n.children)a.type==="group-container"&&this.core.setState(a.id,Zc(r,["opacity","visible"]))}if(GN.is(i)&&this.core.setState(i.id,Zc(r,o5e)),pA.is(i))for(let n of i.segments)this.core.setState(n.id,Zc(r,["color","nearRadius","farRadius","visible","completeFraction"]));BLe.is(i)&&this.core.setState(i.id,Zc(r,["color"]))}}getMapDataObject(e){var r;return(r=this.getMapDataInternal())==null?void 0:r.getMapDataById(e)}getMapDataInternal(){if(this.mapData)return R3(this.mapData)}getMapData(){return this.mapData}addMap(e,r){return new Promise(i=>{var n,a,o,l;let u;try{u=R3(e)}catch(E){Vt.error("Error adding map",E),i(e);return}this.mapDataExternal[e.mapName]=e;let{mvf:c}=u,p=c["manifest.geojson"].features[0].geometry.coordinates;this.core.mode!=="outdoors-overlay"&&this.Camera.set({center:new Rn(p[1],p[0])});let m=c["manifest.geojson"].features[0].properties.name,y=new zX("mapObject-".concat(m),u,r,this),v=this.core.getBoundingArea(y.currentFloor.id);v==null&&Vt.error("Could not determine bounding box for map:",y.currentFloor.id);let x=(a=(n=r==null?void 0:r.outdoorView)==null?void 0:n.layersHiddenByGeometry)!=null?a:[];if(x.length>0){let E,M=[];for(let I of y.floorStacksById.values())if(I.defaultFloor.footprint&&I.defaultFloor.footprint.geometry!=null&&((o=I.defaultFloor.footprint.geometry)==null?void 0:o.coordinates.length)>0){let P=I.defaultFloor.footprint,C=Sj(P);E==null?E=C:HDe(E,C),M.push(P)}M.length>0&&E!=null&&(this.core.hideOutdoorLayersIntersectingPolygons(E,M,x),this.hiddenOutdoorGeometries.push([E,M,x]))}if(this.mapObjects.push(y),u.getMVFFeatureByType("floor").forEach(E=>{this.mapsByFloorId[E.id]=y}),y.on("navigation-connection-click",E=>{this.mapView.publish("navigation-connection-click",E)}),y.on("navigation-active-path-change",E=>{this.mapView.publish("navigation-active-path-change",E)}),y.StackedMaps.on("stacked-maps-state-change",({state:E})=>{this.mapView.publish("stacked-maps-state-change",{state:E})}),y.on("floor-change-start",E=>{var M,I,P,C;this.mapView.publish("floor-change-start",{reason:E.reason,floor:(I=(M=this.getMapDataInternal())==null?void 0:M.getById("floor",E.floorId))!=null?I:this.currentFloor,previousFloor:(C=(P=this.getMapDataInternal())==null?void 0:P.getById("floor",E.previousFloorId))!=null?C:this.currentFloor})}),y.on("floor-change",E=>{var M,I;this.mapView.publish("floor-change",{reason:E.reason,floor:this.currentFloor,previousFloor:(I=(M=this.getMapDataInternal())==null?void 0:M.getById("floor",E.previousFloorId))!=null?I:this.currentFloor})}),this.currentMap=y,this.mapData=e,(r==null?void 0:r.zoomLevel)!=null)this.core.camera.setZoomLevel(r.zoomLevel),i(e);else if(this.core.mode!=="outdoors-overlay"&&v){let E=(l=r==null?void 0:r.screenOffsets)!=null?l:{top:AE*this.core.canvasHeight,left:AE*this.core.canvasWidth,right:AE*this.core.canvasWidth,bottom:AE*this.core.canvasHeight};this.core.camera.focusOn(v,{duration:UWe,padding:E}).then(()=>{i(e)})}else i(e)})}setFloor(e,r){return this.currentMap.setFloor(n3(e),r)}setFloorStack(e,r){return this.currentMap.setFloorStack(n3(e),r)}updateWatermark(e){this.core.updateWatermark(e)}get currentFloorStack(){var e;let r=this.currentMap.currentFloorStack.id;if(!r)throw new Oh("Missing currentFloorStack.");let i=(e=this.mapData)==null?void 0:e.getById("floor-stack",r);if(!i)throw new Oh("FloorStack was not found in map data.");return i}get currentFloor(){var e;let r=this.currentMap.currentFloor.id;if(!r)throw new Oh("Missing currentFloor object from GeoJsonApi");let i=(e=this.mapData)==null?void 0:e.getById("floor",r);if(!i)throw new Oh("Missing currentFloor");return i}getState(e){var r,i,n,a,o,l,u,c,p,m,y,v,x,E,M,I,P,C,T,D;typeof e=="object"&&pA.is(e)&&Vt.warn("Cannot get state of a Path directly. Use getState() on individual segments within Path.segments[] instead.");let F=tit(e,this),k=this.core.getState(F);if(k)if(["interior-walls","exterior-walls"].includes(e)){let{color:B,topColor:U,texture:z,topTexture:q,visible:Z,height:Q,opacity:V}=k;return{type:"walls",visible:Z,color:B,topColor:U,texture:z?{url:z}:void 0,topTexture:q?{url:q}:void 0,height:Q,opacity:V}}else if(["interior-doors","exterior-doors"].includes(e)){let{color:B,topColor:U,texture:z,topTexture:q,visible:Z,opacity:Q}=k;return{type:"doors",visible:Z,color:B,topColor:U,opacity:Q,texture:z?{url:z}:void 0,topTexture:q?{url:q}:void 0}}else{if(k.type==="geometry")return{type:"geometry",interactive:k.interactive,hoverColor:k.hoverColor,color:k.color,visible:k.visible,opacity:k.opacity,height:k.height,texture:k.texture?{url:k.texture}:void 0,topTexture:k.topTexture?{url:k.topTexture}:void 0,flipImageToFaceCamera:k.flipImageToFaceCamera,topColor:k.topColor};if(k.type==="label"&&k.options.appearance&&k.options.rank!==void 0&&k.options.interactive!==void 0)return{type:"label",text:k.text,appearance:k.options.appearance,rank:k.options.rank,enabled:k.enabled,interactive:k.options.interactive};if(k.type==="marker"&&((r=k.options)==null?void 0:r.rank)!==void 0&&k.options.interactive!==void 0){let B=typeof k.parent=="object"?k.parent.id:k.parent,U=this.Markers.getById(k.id.toString()),z=U!=null&&U.marker.target?U==null?void 0:U.marker.target.anchorTarget:void 0;return z==null&&(z=new Rn(k.position[1],k.position[0],B.toString())),{type:"marker",rank:k.options.rank,interactive:k.options.interactive,enabled:k.enabled,element:k.element,anchor:k.anchor,zIndex:k.options.zIndex,dynamicResize:k.dynamicResize,lowPriorityPin:k.options.lowPriorityPin}}else if(k.type==="model"){let B=k!=null&&typeof k.parent=="object"?k.parent.id.toString():(i=k.parent)==null?void 0:i.toString();return delete k.parent,vt(Ee({},k),{position:new Rn({latitude:k.position[1],longitude:k.position[0],verticalOffset:k.position[2],floorId:B}),type:"model"})}else{if(k.type==="image")return{type:"image"};if(k.type==="text3d")return k;if(k.type==="geometry-group"&&e&&typeof e!="string"&&jN.is(e)){let[B]=k.children;if(B.type!=="geometry")throw new Error("expect shape first child to be geometry");return{type:"Shape",altitude:(n=k.altitude)!=null?n:0,visible:k.visible,color:k.color,height:B.height,opacity:k.opacity}}else{if(k.type==="path")return{type:"path",color:k.color,visible:k.visible,nearRadius:k.nearRadius,farRadius:k.farRadius,completeFraction:k.completeFraction};if(k.type==="group-container"&&typeof e!="string"&&jp.is(e)){let B=(a=this.currentMap.floorsById.get(e.id))==null?void 0:a.layers.get(rl),U=B?this.core.getState(B.containerId):void 0,z=(o=this.currentMap.floorsById.get(e.id))==null?void 0:o.layers.get(F_),q=(l=this.currentMap.floorsById.get(e.id))==null?void 0:l.layers.get(By),Z=(u=this.currentMap.floorsById.get(e.id))==null?void 0:u.layers.get(xk),Q=Z?this.core.getState(Z.containerId):void 0,V=(c=this.currentMap.floorsById.get(e.id))==null?void 0:c.layers.get(h3),ae=V?this.core.getState(V.containerId):void 0;return{type:"floor",geometry:{opacity:(p=U==null?void 0:U.opacity)!=null?p:0,visible:(m=U==null?void 0:U.visible)!=null?m:!0},labels:{enabled:(y=z==null?void 0:z.visible)!=null?y:!1},markers:{enabled:(v=q==null?void 0:q.visible)!=null?v:!1},footprint:{altitude:(x=Q==null?void 0:Q.altitude)!=null?x:0,visible:(E=Q==null?void 0:Q.visible)!=null?E:!1,height:(M=Q==null?void 0:Q.height)!=null?M:0,opacity:(I=Q==null?void 0:Q.opacity)!=null?I:0,side:(P=Q==null?void 0:Q.side)!=null?P:"double",color:(C=Q==null?void 0:Q.color)!=null?C:"white"},occlusion:{enabled:(T=ae==null?void 0:ae.visible)!=null?T:!1},visible:k.visible,altitude:(D=k.altitude)!=null?D:0}}else if(k.type==="group-container"&&k.children.length>0&&typeof e!="string"&&ex.is(e)){let B=this.core.getState(k.children[0].id);return{type:"facade",opacity:B.opacity,visible:B.visible}}}}}}setHoverColor(e){this.core.setState({hoverColor:e})}getHoverColor(){let e=this.core.getState();return(e==null?void 0:e.type)==="map-view"?e.hoverColor:void 0}createCoordinateFromScreenCoordinate(e,r,i){var n;if(i!=null){let c=this.core.projectScreenXYToCoordinate(e,r,!0);return c?new Rn(c.coordinate[1],c.coordinate[0],i.id):void 0}let a=this.core.projectScreenXYToCoordinate(e,r);if(a==null||a.coordinate==null)return;let{coordinate:o,groupContainers:l}=a,u=(n=l==null?void 0:l.find(c=>{let p=c.userData.entityId.toString();return p.includes("f_")||p.includes("m_")}))==null?void 0:n.userData.entityId.toString();return new Rn(o[1],o[0],u)}getScreenCoordinateFromCoordinate(e){var r,i,n;let a=0;if(e.floorId!=null){let o=(r=this.mapData)==null?void 0:r.getById("floor",e.floorId);o!=null&&(a=(n=(i=this.getState(o))==null?void 0:i.altitude)!=null?n:0)}return this.core.projectCoordinateToScreenXY([e.longitude,e.latitude,a])}isInView(e){return this.core.isInView(typeof e=="string"?e:e.id)}auto(){return{labels:this.Labels.all()}}tween(e){let r=new pf(e);return this.core.getTweenGroup().add(r),this.core.render(),r}removeTween(e){this.core.getTweenGroup().remove(e)}get __core(){return this.core}clear(){this.Navigation.clear(),this.BlueDot.disable(),this.Shapes.removeAll(),this.Paths.removeAll(),this.Models.removeAll(),this.Markers.removeAll(),this.Images.removeAll(),this.Labels.removeAll()}destroy(){this.clear(),this.core.destroy()}};s(MDe,"GeoJsonApi");var Ort=MDe;function EDe(t){Sue("".concat(t,"/maplibre-worker.csp.js")),W3e("".concat(t,"/collision-worker.csp.js"))}s(EDe,"setWorkersUrl");N();N();var CDe=class{constructor(e){$(this,"state"),$(this,"update"),this.update=e.Debug.update.bind(e.Debug),this.state=e.Debug.state}};s(CDe,"Debug");var krt=CDe;N();var Nrt=Xl.object({environment:Xl.union([Xl.literal("basic"),Xl.literal(!1)]).optional(),text3d:Xl.object({hoverColor:Xl.string().optional()}).optional(),geometry:Xl.object({hoverColor:Xl.string().optional()}).optional(),backgroundColor:Xl.string().optional(),backgroundAlpha:Xl.number().optional()}).strict();N();var UX=Rr(sye(),1),VX=s(t=>{if(["#","rgb(","rgba(","hsl(","hsla("].some(r=>t.startsWith(r)))return!0;let e=console.warn;return console.warn=()=>{},t==="white"||i9(t).some(r=>r<1)?!0:(console.warn=e,!1)},"isProbablyColor"),i9=s(t=>{let e=new oi(t);return[e.r,e.g,e.b]},"stringToRgbArray"),Frt=s(t=>{let e=new oi;return e.setRGB(t[0],t[1],t[2],il),"#"+e.getHexString()},"rgbArrayToString"),Brt=s((t,e)=>{let r={},i=s((n,a,o)=>{for(let l in a){let u=n[l],c=a[l];typeof c=="object"&&!Array.isArray(c)&&c!==null&&typeof u=="object"&&!Array.isArray(u)&&u!==null?(o[l]={},i(u,c,o[l])):o[l]=u}},"processObject");return i(t,e,r),r},"extractProperties"),zrt=s((t,e)=>{let r=Brt(t,e),i=(0,UX.default)({},r,e),n=s((a,o,l)=>{for(let u in o){let c=a[u],p=o[u];if(typeof p=="number"&&typeof c=="number")a[u]=c+(p-c)*l;else if(typeof p=="string"&&typeof c=="string"){if(VX(c)&&VX(p)){let m=i9(c),y=i9(p);m&&y?a[u]=Frt([m[0]+(y[0]-m[0])*l,m[1]+(y[1]-m[1])*l,m[2]+(y[2]-m[2])*l]):Vt.warn('Color "'.concat(u,'" could not be animated!'))}}else typeof p=="object"&&p!==null&&typeof c=="object"&&c!==null?n(c,p,l):Vt.warn('Value "'.concat(u,'" could not be animated!'))}},"interpolate");return a=>{if(a=Math.min(Math.max(a,0),1),a===0)return t;if(a===1)return i;let o=(0,UX.default)({},r);return n(o,e,a),o}},"animationFactory"),cT,Jr,Rm,IDe=class extends qa{constructor(e){super(),Be(this,cT,{}),Be(this,Jr),Be(this,Rm),$(this,"Camera"),$(this,"Labels"),$(this,"Text3D"),$(this,"Markers"),$(this,"Images"),$(this,"Models"),$(this,"Paths"),$(this,"Exporter"),$(this,"Navigation"),$(this,"BlueDot"),$(this,"Style"),$(this,"Shapes"),$(this,"Outdoor"),$(this,"update",s(()=>{w(this,Jr).core.render()},"update")),$(this,"getDirections",s((i,n,a)=>{var o;return(o=w(this,Jr).getMapData())==null?void 0:o.getDirections(i,n,a)},"getDirections")),$(this,"getDirectionsMultiDestination",s((i,n,a)=>{var o;return(o=w(this,Jr).getMapData())==null?void 0:o.getDirectionsMultiDestination(i,n,a)},"getDirectionsMultiDestination")),$(this,"on",s((i,n)=>{super.on(i,n)},"on")),$(this,"off",s((i,n)=>{super.off(i,n)},"off")),$(this,"Debug"),He(this,Rm,e);let r=new Ort(e,this);He(this,Jr,r),this.Camera=w(this,Jr).Camera,He(this,cT,w(this,Jr).mapDataExternal),this.Markers=w(this,Jr).Markers,this.Models=w(this,Jr).Models,this.Labels=w(this,Jr).Labels,this.Text3D=w(this,Jr).Text3D,this.Exporter=w(this,Jr).Exporter,this.Paths=w(this,Jr).Paths,this.Navigation=w(this,Jr).Navigation,this.BlueDot=w(this,Jr).BlueDot,this.Shapes=w(this,Jr).Shapes,this.Style=w(this,Jr).Style,this.auto=w(this,Jr).auto,this.Outdoor=w(this,Jr).Outdoor,this.Images=w(this,Jr).Images,w(this,Rm).container.dataset.version=ja.env.npm_package_version,this.Debug=new krt(w(this,Jr).core)}get StackedMaps(){return w(this,Jr).currentMap.StackedMaps}updateState(e,r){return w(this,Jr).updateState(e,r)}animateState(e,r,i){var n;let a=w(this,Jr).getState(e);if(a==null)return Vt.warn("Cannot animate state of ".concat(e,".")),new Promise(c=>c());let o=zrt(a,r),l=w(this,Jr).tween({percent:0}).to({percent:1},(n=i==null?void 0:i.duration)!=null?n:1e3).onUpdate(({percent:c})=>{w(this,Jr).updateState(e,o(c))});i!=null&&i.easing&&i.easing in J_&&l.easing(J_[i.easing]);let u=new Promise(c=>{l.onComplete(()=>{w(this,Jr).removeTween(l),c()}).onStop(()=>{w(this,Jr).removeTween(l),c()}),l.start()});return u.cancel=()=>{l.stop(),w(this,Jr).updateState(e,o(0))},u}updateGlobalState(e){var r,i,n,a;try{Nrt.parse(e)}catch(o){Vt.error("updateGlobalState",o);return}if(typeof e=="object"){let o={};if((r=e.text3d)!=null&&r.hoverColor&&(o.text3dHoverColor=e.text3d.hoverColor),(i=e.geometry)!=null&&i.hoverColor&&(o.hoverColor=e.geometry.hoverColor),e.backgroundColor||e.backgroundAlpha!==void 0){let l=(n=e.backgroundColor)!=null?n:w(this,Jr).core.backgroundColor,u=(a=e.backgroundAlpha)!=null?a:w(this,Jr).core.backgroundAlpha;w(this,Jr).core.setBackgroundColor(l,u)}e.environment!=null&&w(this,Jr).core.setEnvironment(e.environment),w(this,Jr).core.setState(o)}}getGlobalState(){let e=w(this,Jr).core.getState();return{backgroundColor:w(this,Jr).core.backgroundColor,backgroundAlpha:w(this,Jr).core.backgroundAlpha,environment:w(this,Jr).core.getEnvironment(),geometry:{hoverColor:e.hoverColor},text3d:{hoverColor:e.text3dHoverColor}}}getMapData(){return w(this,cT)}getDimensions(){return{width:w(this,Rm).canvasWidth,height:w(this,Rm).canvasHeight}}expand(e){var r;return(r=w(this,Jr).currentMap)==null?void 0:r.StackedMaps.expand(e)}collapse(e){var r;return(r=w(this,Jr).currentMap)==null?void 0:r.StackedMaps.collapse(e)}addMap(e,r){return w(this,Jr).addMap(e,r)}setFloor(e,r){return w(this,Jr).setFloor(e,r==null?void 0:r.context)}setFloorStack(e,r){return w(this,Jr).setFloorStack(e,r==null?void 0:r.context)}preloadFloors(e){w(this,Jr).preloadFloors(e)}tween(e){return w(this,Jr).tween(e)}removeTween(e){w(this,Jr).removeTween(e)}get currentFloorStack(){return w(this,Jr).currentFloorStack}get currentFloor(){return w(this,Jr).currentFloor}updateWatermark(e){w(this,Jr).updateWatermark(e)}getState(e){return w(this,Jr).getState(e)}setHoverColor(e){w(this,Jr).setHoverColor(e)}getHoverColor(){return w(this,Jr).getHoverColor()}convertAltitudeToMercatorZoomLevel(e){return w(this,Jr).core.getSystems().cameraSystem.convertAltitudeToZoomLevel(e)}convertMercatorZoomLevelToAltitude(e){return w(this,Jr).core.getSystems().cameraSystem.convertZoomLevelToAltitude(e)}isInView(e){return w(this,Jr).isInView(e)}getDistance(e,r){var i;return(i=w(this,Jr).getMapData())==null?void 0:i.getDistance(e,r)}createCoordinate(e,r,i){return typeof e=="object"?new Rn(e):new Rn(e,r,i==null?void 0:i.id)}createCoordinateFromScreenCoordinate(e,r,i){return w(this,Jr).createCoordinateFromScreenCoordinate(e,r,i)}getScreenCoordinateFromCoordinate(e){return w(this,Jr).getScreenCoordinateFromCoordinate(e)}auto(){return{labels:this.Labels.all()}}get __core(){if(ja.env.INTERNAL==="true")return w(this,Jr).core;throw new Error("__core is not available.")}clear(){w(this,Jr).clear()}destroy(){w(this,Jr).destroy()}async enableDebug(e={}){let{Inspector:r}=await ag(()=>import("./inspector-U6M4QW4R-DaW-1ezE.js"),[]);await new r(this,w(this,Jr)).enable(e)}async takeScreenshot(){return await w(this,Rm).renderSync(),w(this,Rm).rendererDomElement.toDataURL("image/png")}get manualFloorVisibility(){return w(this,Jr).manualFloorVisibility}set manualFloorVisibility(e){w(this,Jr).manualFloorVisibility=e}};cT=new WeakMap,Jr=new WeakMap,Rm=new WeakMap,s(IDe,"MapView");var TDe=IDe;N();N();var PDe=class extends qa{constructor(e){super(),$(this,"gl"),$(this,"el",document.createElement("div")),$(this,"core"),$(this,"origin"),$(this,"map"),$(this,"layer"),$(this,"handleStyleChange",s(()=>{!this.map||!this.layer||this.map.getLayer(this.layer.id)||(this.map.addLayer(this.layer),this.core.camera.setMinZoomLevel(this.map.getMinZoom()),this.core.camera.setMaxZoomLevel(this.map.getMaxZoom()),this.core.camera.setMinPitch(this.map.getMinPitch()),this.core.camera.setMaxPitch(this.map.getMaxPitch()))},"handleStyleChange")),$(this,"handleMove",s(()=>{if(!this.map)return;let[r,i]=this.map.getCenter().toArray();this.core.getSystems().cameraSystem.setCenter(r,i),this.core.getSystems().cameraSystem.setZoomLevel(this.map.getZoom()),this.core.getSystems().cameraSystem.setRotation($n.degToRad(this.map.getBearing())),this.core.getSystems().cameraSystem.setTilt($n.degToRad(this.map.getPitch()))},"handleMove")),$(this,"handleError",s(r=>{Vt.warn(r)},"handleError")),this.origin=e}onAdd(e){this.origin=this.origin||e.getCenter().toArray(),this.gl=e.painter.context.gl,this.core=new EN(e._container,{center:this.origin,zoomLevel:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing(),gl:this.gl,map:e,mode:"outdoors-overlay"}),this.map=e,this.core.camera.setMinZoomLevel(e.getMinZoom()),this.core.camera.setMaxZoomLevel(e.getMaxZoom()),this.core.camera.setMinPitch(e.getMinPitch()),this.core.camera.setMaxPitch(e.getMaxPitch()),this.map.on("error",this.handleError);let r=nl.fromLngLat(this.origin,0);return this.layer=$B(r,this.core.viewCamera,this.core.camera,()=>{this.core.renderSync()}),this.map.on("styledata",this.handleStyleChange),this.map.on("move",this.handleMove),this.handleStyleChange(),this.el}onRemove(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("move",this.handleMove),this.map.off("error",this.handleError),this.layer&&this.map.removeLayer(this.layer.id)),this.layer=void 0,this.map=void 0,this.core&&this.core.destroy(),this.core=void 0}};s(PDe,"MapLibreOverlay");var Urt=PDe,A1,Q2,ly,S1,n9=class LDe extends qa{constructor(e,r,i){super(),Be(this,A1),Be(this,Q2),Be(this,ly),Be(this,S1),$(this,"on",s((n,a)=>{super.on(n,a)},"on")),$(this,"off",s((n,a)=>{super.off(n,a)},"off")),He(this,S1,new Urt(e)),He(this,A1,r),He(this,Q2,i)}onAdd(e){var r,i;let n=w(this,S1).onAdd(e),a=vt(Ee(Ee({},S2),(r=w(this,Q2))!=null?r:{}),{outdoorView:Ee({token:w(this,A1).outdoorViewToken},(i=w(this,Q2))==null?void 0:i.outdoorView)});return He(this,ly,new TDe(w(this,S1).core)),w(this,ly).addMap(w(this,A1),a).then(()=>{this.publish("loaded",{mapView:w(this,ly),mapData:w(this,A1)})}),n}onRemove(){w(this,ly)&&w(this,ly).clear(),LDe.instance=null,w(this,S1).onRemove()}};A1=new WeakMap,Q2=new WeakMap,ly=new WeakMap,S1=new WeakMap,s(n9,"MappedinMapLibreOverlay"),$(n9,"instance");var ZD=n9;N();var Vrt=1e3*60*60*2,Dy,fw,Ba,Ip,Tp,Dh,kp,ew,tw,hT,us,a9,jX,$X,d_,H3,o9,s9,l9,DDe=class{constructor(e,r){Be(this,us),Be(this,Dy,new qa),Be(this,fw),Be(this,Ba),Be(this,Ip),Be(this,Tp),Be(this,Dh),Be(this,kp),Be(this,ew),Be(this,tw),Be(this,hT,s(()=>{"key"in w(this,Ba)&&"secret"in w(this,Ba)&&dr(this,us,d_).call(this),dr(this,us,H3).call(this)},"#handleWindowFocus")),$(this,"on",s((i,n)=>w(this,Dy).on(i,n),"on")),$(this,"off",s((i,n)=>w(this,Dy).off(i,n),"off")),He(this,fw,e),He(this,Ba,r)}setMapIds(e){He(this,fw,e)}setEnterprise(e){w(this,Ba).enterprise=e}async readySync(){if((!("key"in w(this,Ba))||!("secret"in w(this,Ba)))&&!("accessToken"in w(this,Ba))){Vt.error("No API keys or access token provided! Cannot preload tokens.");return}let e=[dr(this,us,d_).call(this),null];w(this,Ba).enterprise||(e[1]=this.getSasTokensAsync());let[r,i]=await Promise.all(e);dr(this,us,l9).call(this),dr(this,us,o9).call(this,r),i!=null&&dr(this,us,s9).call(this,i),dr(this,us,a9).call(this)&&globalThis.addEventListener("focus",w(this,hT))}async refreshing(){let e=[];return w(this,Ip)!=null&&e.push(w(this,Ip)),w(this,Tp)!=null&&e.push(w(this,Tp)),Promise.all(e)}getAccessTokenAsync(){return dr(this,us,d_).call(this)}getSasTokensAsync(){return dr(this,us,H3).call(this)}getAccessToken(){return w(this,Dh)==null?(Vt.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):w(this,Dh)}getSasToken(e){return this.isEnterpriseMode()?(Vt.error("SAS tokens are not available in the enterprise mode!"),{token:""}):w(this,kp)==null?(Vt.error("Tokens must be loaded before reading synchronously! Try awaiting readySync() first."),{token:""}):e in w(this,kp).tokens?w(this,kp).tokens[e]:(Vt.error("SAS token for map ".concat(e," not found!")),{token:""})}isEnterpriseMode(){var e;return(e=w(this,Ba).enterprise)!=null?e:!1}destroy(){dr(this,us,l9).call(this),w(this,Dy).destroy(),dr(this,us,a9).call(this)&&globalThis.removeEventListener("focus",w(this,hT))}};Dy=new WeakMap,fw=new WeakMap,Ba=new WeakMap,Ip=new WeakMap,Tp=new WeakMap,Dh=new WeakMap,kp=new WeakMap,ew=new WeakMap,tw=new WeakMap,hT=new WeakMap,us=new WeakSet,a9=s(function(){return typeof window<"u"&&window!==null},"#isBrowser"),jX=s(function(t){var e;let r=t.token!==((e=w(this,Dh))==null?void 0:e.token);He(this,Dh,t),r&&w(this,Dy).publish("access-token-refreshed",{accessToken:t})},"#setAccessToken"),$X=s(function(t){var e;let r=JSON.stringify(t.tokens)!==JSON.stringify((e=w(this,kp))==null?void 0:e.tokens);He(this,kp,t),r&&w(this,Dy).publish("sas-tokens-refreshed",{sasTokens:t.tokens})},"#setSasTokens"),d_=s(async function(t=!1){var e;if("accessToken"in w(this,Ba)&&typeof w(this,Ba).accessToken=="string"){let r={token:w(this,Ba).accessToken,expires:Date.now()+72e5};return He(this,Dh,r),r}if(!("key"in w(this,Ba))||!("secret"in w(this,Ba))||typeof w(this,Ba).key!="string"||typeof w(this,Ba).secret!="string")throw new Error("No API keys or access token provided!");return w(this,Ip)!=null?w(this,Ip):w(this,Dh)!=null&&w(this,Dh).expires!=null&&w(this,Dh).expires>Date.now()&&!t?w(this,Dh):(He(this,Ip,ZV(vt(Ee({},w(this,Ba)),{key:w(this,Ba).key,secret:w(this,Ba).secret}),(e=w(this,Ba).enterprise)!=null?e:!1).then(r=>{let i={token:r.accessToken,expires:r.expiresTimestamp*1e3};return dr(this,us,jX).call(this,i),i})),w(this,Ip).finally(()=>{He(this,Ip,void 0)}),w(this,Ip))},"#refreshAccessToken"),H3=s(async function(t=!1){return this.isEnterpriseMode()?{tokens:{},expires:1/0}:w(this,Tp)!=null?w(this,Tp):w(this,kp)!=null&&w(this,kp).expires>Date.now()&&!t?w(this,kp):(He(this,Tp,new Promise((e,r)=>{dr(this,us,d_).call(this).then(i=>{let n={},a=w(this,fw).map(o=>i3e(vt(Ee({},w(this,Ba)),{mapId:o}),i.token).then(l=>{n[o]={token:l.token,expires:l.expires}}).catch(l=>{Vt.error("Error getting SAS token for map ".concat(o,":"),l)}));Promise.all(a).then(()=>{let o={tokens:n,expires:Math.min(...Object.values(n).map(l=>{var u;return(u=l.expires)!=null?u:1/0}))};dr(this,us,$X).call(this,o),e(o)})}).catch(i=>{r(i)})})),w(this,Tp).catch(e=>{throw e}).finally(()=>{He(this,Tp,void 0)}),w(this,Tp))},"#refreshSasTokens"),o9=s(function(t){if(!("key"in w(this,Ba))||!("secret"in w(this,Ba)))return;let e=t.expires!=null?t.expires-Date.now():Vrt;isFinite(e)&&He(this,ew,setTimeout(()=>{dr(this,us,d_).call(this,!0).then(r=>{dr(this,us,o9).call(this,r)})},e-GKe))},"#setAccessTokenRefresh"),s9=s(function(t){let e=t.expires-Date.now();isFinite(e)&&He(this,tw,setTimeout(()=>{dr(this,us,H3).call(this,!0).then(r=>{dr(this,us,s9).call(this,r)})},e-HKe))},"#setSasTokensRefresh"),l9=s(function(){w(this,ew)!=null&&clearTimeout(w(this,ew)),w(this,tw)!=null&&clearTimeout(w(this,tw))},"#stopRefreshing"),s(DDe,"TokenManager");var RDe=DDe;N();var jrt=s(async(t,e)=>{var r,i,n,a,o,l,u;let c=(n="mvfVersion"in(e??{})?e==null?void 0:e.mvfVersion:void 0)!=null?n:"options"in t&&"version"in((r=t.options)!=null?r:{})?(i=t.options)==null?void 0:i.version:void 0,p=vt(Ee({},e||{}),{mvfVersion:c}),m,y=yS();y.updateByUserOption(p);let v={};if("type"in t&&typeof t.type=="string"){if(v.enterprise=(a=t.options)==null?void 0:a.enterprise,t.type==="binary"&&t.main instanceof Uint8Array){m=await JV(t.main,p.mvfVersion),v.languagePacks=[];for(let T of(o=t.languagePacks)!=null?o:[])T.localePack instanceof Uint8Array&&v.languagePacks.push({language:T.language,localePack:await H4(T.localePack)})}else if(t.type==="json")m=t.main,v.languagePacks=(l=t.languagePacks)!=null?l:[];else throw new Error("Invalid backup type");t.type==="binary"&&t.main instanceof Uint8Array&&(v.binaryBundle=t.main)}else m=t,v.enterprise=m.enterprise!=null;let x=y3e(m),E=x.length>0?x:[p.mapId],M=new RDe(E,vt(Ee({},p),{enterprise:v.enterprise})),I;if("accessToken"in p)I=p.accessToken;else if("key"in p&&"secret"in p){p.baseAuthUri=y.getBaseAuthUri(v.enterprise);let T=await M.getAccessTokenAsync();I=(T==null?void 0:T.token)||""}v.outdoorViewToken=I,v.env=y,v.getMapDataOptions=p;try{await M.readySync()}catch(T){Vt.error("Failed to ready token manager!",T)}let P=new Ij(m,v);I&&P.Analytics.init(vt(Ee({accessToken:I,mapId:p.mapId,key:"key"in p?p.key:void 0,secret:"secret"in p?p.secret:void 0},p.analytics),{baseUri:y.getAnalyticsBaseUri(),context:(u=p.analytics)==null?void 0:u.context}));let C=new QV(P);if("language"in p)try{await C.changeLanguage(p.language)}catch{}return typeof(e==null?void 0:e.onMVFParsed)=="function"&&e.onMVFParsed(m),C},"hydrateMapData");N();var $rt=s((t,{id:e}={})=>{let r=Array.isArray(t)?t:[t];if(!r.every(a=>typeof a=="string"))return;let i=r.join(""),n=null;if(e){let a=document.getElementById(e);a instanceof HTMLStyleElement&&(n=a)}n==null&&(n=document.createElement("style")),e&&e!==""&&(n.id=e),n.textContent=i,document.head.appendChild(n)},"injectCSS"),Grt=`:root {
	--pin-shadow-hover-scale: 0.9;
	--pin-shadow-width: 12px;
	--pin-shadow-height: 5px;
	--pin-shadow-opacity: 0.35;
	--pin-drop-animation-duration-ms: 250ms;
}

@keyframes drop-pin {
	0% {
		transform: translateY(-200%);
	}

	100% {
		transform: translateY(0);
	}
}

@keyframes pin-shadow {
	0% {
		transform: scale(var(--pin-shadow-hover-scale));
	}

	100% {
		transform: scale(1);
	}
}

.mappedin-dropped-pin-wrapper {
	position: relative;

	width: fit-content;
	height: fit-content;
	width: 36px;
	height: 42px;

	& svg {
		position: absolute;
		left: calc(50% - var(--pin-shadow-width));
		animation: drop-pin var(--pin-drop-animation-duration-ms) ease-in;
	}

	& > .pin-shadow {
		position: absolute;
		left: calc(50% - (var(--pin-shadow-width) / 2));
		bottom: 0;

		height: var(--pin-shadow-height);
		width: var(--pin-shadow-width);
		border-radius: 100%;

		opacity: var(--pin-shadow-opacity);

		animation: pin-shadow 250ms ease-in;
	}
}

@keyframes bounce {
	0% {
		transform: translateY(-10px);
		opacity: 0;
	}
	12.5% {
		transform: translateY(0);
		opacity: 1;
	}
	25% {
		transform: translateY(0);
	}
	37.5% {
		transform: translateY(-10px);
	}
	50% {
		transform: translateY(0);
	}
	62.5% {
		transform: translateY(-10px);
	}
	75% {
		transform: translateY(0);
	}
	87.5% {
		transform: translateY(-10px);
	}
	100% {
		transform: translateY(0);
	}
}

.mappedin-connection-marker {
	position: relative;
	display: flex;

	.bouncey {
		animation: bounce 2.5s linear;
	}

	.arrow--down {
		transform: rotate(180deg);
	}

	.connection-circle {
		display: flex;
		box-sizing: border-box;
		justify-content: center;
		align-items: center;
		border-radius: 50%;
		border: 2px solid white;
		box-shadow: 0px 2px 8px 0px rgba(0, 0, 0, 0.15);
		background: #595959;
	}
}
`,Hrt=`.mappedin-marker {
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
	font-weight: normal;
	top: 0;
	position: absolute;
	font-weight: bold;
	color: black;
	display: flex;
	flex-direction: row;
	will-change: transform, opacity;
	transition: opacity 150ms ease-in-out;
	justify-content: center;
	opacity: 0;
}

/* Low priority pin strategy styles */

/* Hide all content including text nodes by setting font-size to 0 */
.mappedin-marker[data-anchor="low-priority-pin"] {
	font-size: 0;
	line-height: 0;
}

/* Hide child elements as well */
.mappedin-marker[data-anchor="low-priority-pin"]>* {
	visibility: hidden;
}

/* Create the pin using ::before pseudo-element */
.mappedin-marker[data-anchor="low-priority-pin"]::before {
	content: '';
	display: block;
	border-radius: 50%;
	position: relative;
	/* Default values - will be overridden by inline styles */
	width: var(--mappedin-pin-size, 2px);
	height: var(--mappedin-pin-size, 2px);
	background-color: var(--pin-color, #666);
}
`,qrt=`.mappedin__smart-collision-engine__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	pointer-events: none;
	/* Enables colliders to use translate3D */
	transform-style: preserve-3d;
	font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;
}

.mappedin__smart-collision-engine-debug__container {
	position: absolute;
	left: 0px;
	top: 0px;
	bottom: 0px;
	right: 0px;
	transition: opacity 300ms ease-in-out;
	pointer-events: none;
	will-change: opacity;
	&.interacting {
		opacity: 0.2;
	}
}
`,Wrt=`.mappedin-map {
	.mappedin-interactive {
		cursor: grab;

		&:active {
			cursor: grabbing;
		}

		&.mappedin-interaction-hover {
			cursor: pointer;
		}
	}
}
`,Xrt=`.mappedin-map {
	.mappedin-control-container {
		position: absolute;
		left: 0px;
		top: 0px;
		bottom: 0px;
		right: 0px;
		pointer-events: none;
		font-family: 'InterUI-Regular', Helvetica, Arial, sans-serif;

		.mappedin-ctrl-top-left,
		.mappedin-ctrl-top-right,
		.mappedin-ctrl-bottom-left,
		.mappedin-ctrl-bottom-right {
			position: absolute;
			pointer-events: none;
		}

		.mappedin-ctrl-top-left {
			top: 0;
			left: 0;
		}

		.mappedin-ctrl-top-right {
			top: 0;
			right: 0;
		}

		.mappedin-ctrl-bottom-left {
			bottom: 0;
			left: 0;
		}

		.mappedin-ctrl-bottom-right {
			bottom: 0;
			right: 0;
		}

		.mappedin-ctrl-attrib {
			display: block;
			position: relative;
			pointer-events: auto;
			font: 9px/11px 'InterUI-Regular', Helvetica, Arial, sans-serif;
			padding: 3px 5px 1px 5px;
			background-color: rgba(255, 255, 255, 0.5);
			margin: 0;
			min-width: 11px;
			min-height: 11px;
			user-select: none;

			summary.mappedin-ctrl-attrib-button {
				appearance: none;
				list-style: none;
			}

			summary.mappedin-ctrl-attrib-button::-webkit-details-marker {
				display: none;
			}

			&.mappedin-compact .mappedin-ctrl-attrib-button,
			&.mappedin-compact-show .mappedin-ctrl-attrib-inner {
				display: inline-block;
			}

			&.mappedin-compact {
				background-color: transparent;
			}

			&.mappedin-compact-show {
				min-width: 15px;
				min-height: 15px;
				box-sizing: border-box;
				background-color: rgba(255, 255, 255, 0.5);
			}
		}

		.mappedin-ctrl-attrib-top-left {
			float: left;
			border-bottom-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-top-right {
			float: right;
			border-bottom-left-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-left {
			float: left;
			border-top-right-radius: 4px;
		}

		.mappedin-ctrl-attrib-bottom-right {
			float: right;
			border-top-left-radius: 4px;
		}
		.mappedin-ctrl-attrib-top-left,
		.mappedin-ctrl-attrib-bottom-left {
			padding: 3px 5px 1px 20px;
		}

		.mappedin-ctrl-attrib-inner {
			display: inline-block;
			margin-right: 12px;
		}

		.mappedin-ctrl-attrib-inner,
		.mappedin-ctrl-attrib-inner a {
			color: rgba(0, 0, 0, 0.75);
			text-decoration: none;
		}

		.mappedin-ctrl-attrib-inner-bold,
		.mappedin-ctrl-attrib-inner-bold a {
			font-weight: bold;
		}

		.mappedin-ctrl-attrib-inner a:hover {
			color: #017ef1;
			text-decoration: underline;
			cursor: pointer;
		}

		.mappedin-ctrl-attrib-button {
			display: none;
			cursor: pointer;
			position: absolute;
			width: 15px;
			height: 15px;
			box-sizing: border-box;
			border-radius: 50%;
			top: 0;
			right: 2px;
			border: 1px;
		}
		.mappedin-ctrl-attrib-top-left .mappedin-ctrl-attrib-button,
		.mappedin-ctrl-attrib-bottom-left .mappedin-ctrl-attrib-button {
			left: 2px;
		}
	}
}
`,Zrt=`.maplibregl-map {
    font: 12px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
    overflow: hidden;
    position: relative;
    -webkit-tap-highlight-color: rgb(0 0 0 / 0%);
}

.maplibregl-canvas {
    position: absolute;
    left: 0;
    top: 0;
}

.maplibregl-map:fullscreen {
    width: 100%;
    height: 100%;
}

.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-interactive,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass {
    cursor: grab;
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer {
    cursor: pointer;
}

.maplibregl-canvas-container.maplibregl-interactive:active,
.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active {
    cursor: grabbing;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: pinch-zoom;
}

.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,
.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas {
    touch-action: none;
}

.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,
.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas {
    touch-action: pan-x pan-y;
}

.maplibregl-ctrl-top-left,
.maplibregl-ctrl-top-right,
.maplibregl-ctrl-bottom-left,
.maplibregl-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }

.maplibregl-ctrl-top-left { top: 0; left: 0; }

.maplibregl-ctrl-top-right { top: 0; right: 0; }

.maplibregl-ctrl-bottom-left { bottom: 0; left: 0; }

.maplibregl-ctrl-bottom-right { right: 0; bottom: 0; }

.maplibregl-ctrl {
    clear: both;
    pointer-events: auto;

    /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
    transform: translate(0, 0);
}

.maplibregl-ctrl-top-left .maplibregl-ctrl { margin: 10px 0 0 10px; float: left; }

.maplibregl-ctrl-top-right .maplibregl-ctrl { margin: 10px 10px 0 0; float: right; }

.maplibregl-ctrl-bottom-left .maplibregl-ctrl { margin: 0 0 10px 10px; float: left; }

.maplibregl-ctrl-bottom-right .maplibregl-ctrl { margin: 0 10px 10px 0; float: right; }

.maplibregl-ctrl-group {
    border-radius: 4px;
    background: #fff;
}

.maplibregl-ctrl-group:not(:empty) {
    box-shadow: 0 0 0 2px rgb(0 0 0 / 10%);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl-group:not(:empty) {
        box-shadow: 0 0 0 2px ButtonText;
    }
}

.maplibregl-ctrl-group button {
    width: 29px;
    height: 29px;
    display: block;
    padding: 0;
    outline: none;
    border: 0;
    box-sizing: border-box;
    background-color: transparent;
    cursor: pointer;
}

.maplibregl-ctrl-group button + button {
    border-top: 1px solid #ddd;
}

.maplibregl-ctrl button .maplibregl-ctrl-icon {
    display: block;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: center center;
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl-icon {
        background-color: transparent;
    }

    .maplibregl-ctrl-group button + button {
        border-top: 1px solid ButtonText;
    }
}

/* https://bugzilla.mozilla.org/show_bug.cgi?id=140562 */
.maplibregl-ctrl button::-moz-focus-inner {
    border: 0;
    padding: 0;
}

.maplibregl-ctrl-attrib-button:focus,
.maplibregl-ctrl-group button:focus {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl button:disabled {
    cursor: not-allowed;
}

.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon {
    opacity: 0.25;
}

.maplibregl-ctrl button:not(:disabled):hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-ctrl-group button:focus:focus-visible {
    box-shadow: 0 0 2px 2px rgb(0 150 255 / 100%);
}

.maplibregl-ctrl-group button:focus:not(:focus-visible) {
    box-shadow: none;
}

.maplibregl-ctrl-group button:focus:first-child {
    border-radius: 4px 4px 0 0;
}

.maplibregl-ctrl-group button:focus:last-child {
    border-radius: 0 0 4px 4px;
}

.maplibregl-ctrl-group button:focus:only-child {
    border-radius: inherit;
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #333);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #fff);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-out.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-zoom-in.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #333);
}

.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-shrink.svg");
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #fff);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #fff);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-fullscreen.svg", fill: #000);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-shrink.svg", fill: #000);
    }
}

.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
    background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #333);
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        @svg-load ctrl-compass-white url("svg/maplibregl-ctrl-compass.svg") {
            fill: #fff;
            #south { fill: #999; }
        }

        background-image: svg-inline(ctrl-compass-white);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon {
        background-image: svg-load("svg/maplibregl-ctrl-compass.svg", fill: #000);
    }
}

@svg-load ctrl-terrain url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-terrain-enabled url("svg/maplibregl-ctrl-terrain.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain);
}

.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-terrain-enabled);
}

@svg-load ctrl-geolocate url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #333;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #fff;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #000;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-disabled url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #aaa;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-white url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #999;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-disabled-black url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #666;
    #stroke { fill: #f00; }
}

@svg-load ctrl-geolocate-active url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-active-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e58978;
    #stroke { display: none; }
}

@svg-load ctrl-geolocate-background url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #33b5e5;
    #stroke { display: none; }
    #dot { display: none; }
}

@svg-load ctrl-geolocate-background-error url("svg/maplibregl-ctrl-geolocate.svg") {
    fill: #e54e33;
    #stroke { display: none; }
    #dot { display: none; }
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-disabled);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-active-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
    background-image: svg-inline(ctrl-geolocate-background-error);
}

.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon {
    animation: maplibregl-spin 2s infinite linear;
}

@media (-ms-high-contrast: active) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-white);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-active-error);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-background-error);
    }
}

@media (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-black);
    }

    .maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon {
        background-image: svg-inline(ctrl-geolocate-disabled-black);
    }
}

@keyframes maplibregl-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

a.maplibregl-ctrl-logo {
    width: 88px;
    height: 23px;
    margin: 0 0 -4px -4px;
    display: block;
    background-repeat: no-repeat;
    cursor: pointer;
    overflow: hidden;
    background-image: svg-load("svg/maplibregl-ctrl-logo.svg");
}

a.maplibregl-ctrl-logo.maplibregl-compact {
    width: 14px;
}

@media (-ms-high-contrast: active) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-white url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; }
            #fill { opacity: 1; }
        }

        background-color: transparent;
        background-image: svg-inline(ctrl-logo-white);
    }
}

@media (-ms-high-contrast: black-on-white) {
    a.maplibregl-ctrl-logo {
        @svg-load ctrl-logo-black url("svg/maplibregl-ctrl-logo.svg") {
            #outline { opacity: 1; fill: #fff; stroke: #fff; }
            #fill { opacity: 1; fill: #000; }
        }

        background-image: svg-inline(ctrl-logo-black);
    }
}

.maplibregl-ctrl.maplibregl-ctrl-attrib {
    padding: 0 5px;
    background-color: rgb(255 255 255 / 50%);
    margin: 0;
}

@media screen {
    .maplibregl-ctrl-attrib.maplibregl-compact {
        min-height: 20px;
        padding: 2px 24px 2px 0;
        margin: 10px;
        position: relative;
        background-color: #fff;
        color: #000;
        border-radius: 12px;
        box-sizing: content-box;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 28px 2px 8px;
        visibility: visible;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact-show,
    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact-show {
        padding: 2px 8px 2px 28px;
        border-radius: 12px;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner {
        display: none;
    }

    .maplibregl-ctrl-attrib-button {
        display: none;
        cursor: pointer;
        position: absolute;
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
        background-color: rgb(255 255 255 / 50%);
        width: 24px;
        height: 24px;
        box-sizing: border-box;
        border-radius: 12px;
        outline: none;
        top: 0;
        right: 0;
        border: 0;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button {
        appearance: none;
        list-style: none;
    }

    .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker {
        display: none;
    }

    .maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button {
        left: 0;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,
    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner {
        display: block;
    }

    .maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button {
        background-color: rgb(0 0 0 / 5%);
    }

    .maplibregl-ctrl-bottom-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-right > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        right: 0;
    }

    .maplibregl-ctrl-top-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        top: 0;
        left: 0;
    }

    .maplibregl-ctrl-bottom-left > .maplibregl-ctrl-attrib.maplibregl-compact::after {
        bottom: 0;
        left: 0;
    }
}

@media screen and (-ms-high-contrast: active) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg", fill=#fff);
    }
}

@media screen and (-ms-high-contrast: black-on-white) {
    .maplibregl-ctrl-attrib.maplibregl-compact::after {
        background-image: svg-load("svg/maplibregl-ctrl-attrib.svg");
    }
}

.maplibregl-ctrl-attrib a {
    color: rgb(0 0 0 / 75%);
    text-decoration: none;
}

.maplibregl-ctrl-attrib a:hover {
    color: inherit;
    text-decoration: underline;
}

.maplibregl-attrib-empty {
    display: none;
}

.maplibregl-ctrl-scale {
    background-color: rgb(255 255 255 / 75%);
    font-size: 10px;
    border-width: medium 2px 2px;
    border-style: none solid solid;
    border-color: #333;
    padding: 0 5px;
    color: #333;
    box-sizing: border-box;
}

.maplibregl-popup {
    position: absolute;
    top: 0;
    left: 0;
    display: flex;
    will-change: transform;
    pointer-events: none;
}

.maplibregl-popup-anchor-top,
.maplibregl-popup-anchor-top-left,
.maplibregl-popup-anchor-top-right {
    flex-direction: column;
}

.maplibregl-popup-anchor-bottom,
.maplibregl-popup-anchor-bottom-left,
.maplibregl-popup-anchor-bottom-right {
    flex-direction: column-reverse;
}

.maplibregl-popup-anchor-left {
    flex-direction: row;
}

.maplibregl-popup-anchor-right {
    flex-direction: row-reverse;
}

.maplibregl-popup-tip {
    width: 0;
    height: 0;
    border: 10px solid transparent;
    z-index: 1;
}

.maplibregl-popup-anchor-top .maplibregl-popup-tip {
    align-self: center;
    border-top: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-top: none;
    border-left: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-top: none;
    border-right: none;
    border-bottom-color: #fff;
}

.maplibregl-popup-anchor-bottom .maplibregl-popup-tip {
    align-self: center;
    border-bottom: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip {
    align-self: flex-start;
    border-bottom: none;
    border-left: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip {
    align-self: flex-end;
    border-bottom: none;
    border-right: none;
    border-top-color: #fff;
}

.maplibregl-popup-anchor-left .maplibregl-popup-tip {
    align-self: center;
    border-left: none;
    border-right-color: #fff;
}

.maplibregl-popup-anchor-right .maplibregl-popup-tip {
    align-self: center;
    border-right: none;
    border-left-color: #fff;
}

.maplibregl-popup-close-button {
    position: absolute;
    right: 0;
    top: 0;
    border: 0;
    border-radius: 0 3px 0 0;
    cursor: pointer;
    background-color: transparent;
}

.maplibregl-popup-close-button:hover {
    background-color: rgb(0 0 0 / 5%);
}

.maplibregl-popup-content {
    position: relative;
    background: #fff;
    border-radius: 3px;
    box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
    padding: 15px 10px;
    pointer-events: auto;
}

.maplibregl-popup-anchor-top-left .maplibregl-popup-content {
    border-top-left-radius: 0;
}

.maplibregl-popup-anchor-top-right .maplibregl-popup-content {
    border-top-right-radius: 0;
}

.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content {
    border-bottom-left-radius: 0;
}

.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content {
    border-bottom-right-radius: 0;
}

.maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-popup-track-pointer * {
    pointer-events: none;
    user-select: none;
}

.maplibregl-map:hover .maplibregl-popup-track-pointer {
    display: flex;
}

.maplibregl-map:active .maplibregl-popup-track-pointer {
    display: none;
}

.maplibregl-marker {
    position: absolute;
    top: 0;
    left: 0;
    will-change: transform;
    transition: opacity 0.2s;
}

.maplibregl-user-location-dot {
    background-color: #1da1f2;
    width: 15px;
    height: 15px;
    border-radius: 50%;
}

.maplibregl-user-location-dot::before {
    background-color: #1da1f2;
    content: "";
    width: 15px;
    height: 15px;
    border-radius: 50%;
    position: absolute;
    animation: maplibregl-user-location-dot-pulse 2s infinite;
}

.maplibregl-user-location-dot::after {
    border-radius: 50%;
    border: 2px solid #fff;
    content: "";
    height: 19px;
    left: -2px;
    position: absolute;
    top: -2px;
    width: 19px;
    box-sizing: border-box;
    box-shadow: 0 0 3px rgb(0 0 0 / 35%);
}

@keyframes maplibregl-user-location-dot-pulse {
    0%   { transform: scale(1); opacity: 1; }
    70%  { transform: scale(3); opacity: 0; }
    100% { transform: scale(1); opacity: 0; }
}

.maplibregl-user-location-dot-stale {
    background-color: #aaa;
}

.maplibregl-user-location-dot-stale::after {
    display: none;
}

.maplibregl-user-location-accuracy-circle {
    background-color: #1da1f233;
    width: 1px;
    height: 1px;
    border-radius: 100%;
}

.maplibregl-crosshair,
.maplibregl-crosshair .maplibregl-interactive,
.maplibregl-crosshair .maplibregl-interactive:active {
    cursor: crosshair;
}

.maplibregl-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
}

.maplibregl-cooperative-gesture-screen {
    background: rgba(0 0 0 / 40%);
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    padding: 1rem;
    font-size: 1.4em;
    line-height: 1.2;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1s ease 1s;
    z-index: 99999;
}

.maplibregl-cooperative-gesture-screen.maplibregl-show {
    opacity: 1;
    transition: opacity 0.05s;
}

.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
    display: none;
}

@media (hover: none), (width <= 480px) {
    .maplibregl-cooperative-gesture-screen .maplibregl-desktop-message {
        display: none;
    }

    .maplibregl-cooperative-gesture-screen .maplibregl-mobile-message {
        display: block;
    }
}

.maplibregl-pseudo-fullscreen {
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    top: 0 !important;
    left: 0 !important;
    z-index: 99999;
}
`,Yrt=[Grt,Hrt,qrt,Wrt,Xrt,Zrt],ODe;function kDe(t){ODe=t}s(kDe,"__setWatermarkOnClickFn");var Krt=s(async(t,e)=>{let r,i=yS();e&&i.updateByUserOption(e);try{e&&(r=(await ZV(vt(Ee({},e),{baseAuthUri:i.getBaseAuthUri()}))).accessToken)}catch(a){Vt.warn("Getting access token failed. Outdoor map disabled.",a)}let n=new Ij(t,{outdoorViewToken:r,languagePacks:e==null?void 0:e.languagePacks,env:i});return new QV(n)},"hydrateMapDataFromMVF"),NDe=!1;function FDe(t){NDe=t}s(FDe,"setUseEnterpriseAPI");var wj=s(async t=>{var e;let r=NDe,i,n=yS();n.updateByUserOption(t);let a=Ee({},t),o=new RDe([a.mapId],a);if("accessToken"in a){i=a.accessToken;let{aud:M,sub:I}=RB(i);(jWe.some(P=>M.includes(P))||I&&I.startsWith("client"))&&(r=!0,o.setEnterprise(r))}else if("key"in a&&"secret"in a)a.key.startsWith("mik_")||(r=!0,o.setEnterprise(r)),a.baseAuthUri=n.getBaseAuthUri(r),i=(await o.getAccessTokenAsync()).token;else throw new Error("Missing key or secret.");a.layoutId!=null&&(r?a.layoutId!=="draft"&&Vt.warn('Invalid layoutId! Use "draft" to load draft data or leave unspecified to load live data.'):Vt.warn("layoutId is currently unsupported!")),a.baseUri=n.getBaseUri(r);let l=performance.now(),u,c;if(r){let M=vt(Ee({},a),{venue:a.mapId,clientId:a.key,clientSecret:a.secret,version:"1.0.0",perspective:a.viewId,useDraftData:a.layoutId==="draft"}),I=await c3e(M);u=I.compressed,c=I.localePacks}else u=await h3e(a,i);let p=performance.now(),m=await JV(u,a.mvfVersion),y=performance.now();typeof t.onMVFParsed=="function"&&t.onMVFParsed(m);let v=y3e(m);v.length>0?o.setMapIds(v):o.setMapIds([a.mapId]);try{await o.readySync()}catch(M){Vt.error("Failed to ready token manager!",M)}let x=new Ij(m,{env:n,outdoorViewToken:i,tokenManager:o,enterprise:r,localePacksUrls:c,binaryBundle:u,getMapDataOptions:a}),E=new QV(x,{search:t.search});if(x.Analytics.init(vt(Ee({accessToken:i,mapId:a.mapId,key:"key"in a?a.key:void 0,secret:"secret"in a?a.secret:void 0},a.analytics),{baseUri:n.getAnalyticsBaseUri(),context:(e=a.analytics)==null?void 0:e.context})),x.Analytics.sendGetMapDataEvent({parseDuration:y-p,downloadDuration:p-l,viewId:a.viewId}),"language"in a)try{await E.changeLanguage(a.language)}catch{}return E},"getMapData"),Jrt=wj,Qrt=s((t,e)=>{ZD.instance!=null&&Vt.warn("Only a single map venue is supported at this time.");let r=new ZD([t.mapCenter.longitude,t.mapCenter.latitude],t,e);return ZD.instance=r,r},"createMapLibreOverlay"),Aj=s(async(t,e,r)=>{var i,n,a,o,l,u,c,p,m,y,v,x,E,M,I;let P=performance.now(),C=Uve(r,e);C&&zve(C),((i=C.injectStyles)==null||i)&&$rt(Yrt,{id:"mappedin__styles"});let T=Vve((n=e.outdoorViewToken)!=null?n:""),D=R3(e);(a=C.outdoorView)!=null&&a.style&&D.envControl.updateTileServerBaseUrl((o=C.outdoorView)==null?void 0:o.style);let F=await OLe(t,{center:[e.mapCenter.longitude,e.mapCenter.latitude],bearing:C.bearing,pitch:C.pitch,zoomLevel:C.zoomLevel,backgroundAlpha:(l=C.style)==null?void 0:l.backgroundAlpha,backgroundColor:(u=C.style)==null?void 0:u.backgroundColor,outdoorView:(c=C.outdoorView)!=null&&c.token?{headers:{"x-mappedin-tiles-key":(p=C.outdoorView)==null?void 0:p.token},style:e.getEnv().tileServerUri,enabled:!!((m=C.outdoorView)!=null&&m.enabled),lowDpi:(y=C.outdoorView)==null?void 0:y.lowDpi}:void 0,watermark:vt(Ee({},C.watermark),{visible:(x=(v=C.watermark)==null?void 0:v.visible)!=null?x:!D.enterpriseMode&&!T.remove_watermark,onClick:ODe||void 0}),attribution:C.attribution,antialias:typeof C.antialiasing=="boolean"?C.antialiasing:!!((E=C.antialiasing)!=null&&E.enabled),accessToken:e.outdoorViewToken,occlusionEnabled:(M=C.occlusion)==null?void 0:M.enabled,transformImageRequest:D.enterpriseMode?void 0:D.transformImageRequest,naturalBearing:e.naturalBearing,imagePlacementOptions:C.imagePlacementOptions,onWebGLContextCreationError:C.onWebGLContextCreationError,onWebGLContextLost:C.onWebGLContextLost,onWebGLContextRestored:C.onWebGLContextRestored,onWebGLRendererError:C.onWebGLRendererError,useStandaloneCamera:(I=C.useStandaloneCamera)!=null?I:!1}),k=new TDe(F);return await k.addMap(e,C),D.Analytics.sendMapViewLoadedEvent({firstRenderDuration:performance.now()-P,dimension:k.getDimensions()}),k},"show3dMap"),eit=Aj;function Np(t){return t.verticalOffset===0?[t.longitude,t.latitude]:[t.longitude,t.latitude,t.verticalOffset]}s(Np,"convertCoordinateToPosition");function BDe(t){return new Map(t.map(e=>{let{properties:r}=e,{id:i}=r;return[i,e]}))}s(BDe,"getEntranceMap");var GX=s((t,e)=>{let r=BDe(e),i={entrances:{type:"FeatureCollection",features:[]},walls:{type:"Feature",properties:{id:t[0].properties.id},geometry:{type:"MultiLineString",coordinates:[]}}};for(let n of t){let a=[n.geometry.coordinates],o=(n.properties.entrances||[]).reduce((l,u)=>(r.has(u)&&l.push(r.get(u)),l),[]);if(o.length){let{entrances:l,obstructions:u}=O3e(n,o);a=u.map(c=>c.geometry.coordinates),i.entrances.features.push(...l)}i.walls.geometry.coordinates.push(...a)}return i},"cutEntrancesFromLineStrings");function zDe(t,e){let r={options:{}};if(!r.options)throw new Error("options should exist");return t.text&&(r.text=t.text),t.appearance&&(r.options.appearance=t.appearance),t.rank!=null&&(t.rank==="initial"?r.options.rank=e.initialRank||2:r.options.rank=t.rank),t.enabled!==void 0&&(r.enabled=t.enabled),t.interactive!==null&&(r.options.interactive=t.interactive),t.enabled!==null&&(r.enabled=t.enabled),r}s(zDe,"translateLabelStateToGeojsonCore");function UDe(t,e){let r={options:{}};if(!r.options)throw new Error("options should exist");return t.rank!=null&&(t.rank==="initial"?r.options.rank=e.initialRank||2:r.options.rank=t.rank),t.enabled!=null&&(r.enabled=t.enabled),t.interactive!=null&&(r.options.interactive=t.interactive),t.enabled!==null&&(r.enabled=t.enabled),r}s(UDe,"translateMarkerStateToGeojsonCore");function pT(t,e){var r,i;let n={};return e==null||(t.color&&(t.color==="initial"?n.color=e.initialColor:n.color=t.color),t.topColor&&(t.topColor==="initial"?n.topColor=e.initialTopColor:n.topColor=t.topColor),t.visible!==void 0&&(n.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(n.texture=t.texture.url),((i=t.topTexture)==null?void 0:i.url)!==void 0&&(n.topTexture=t.topTexture.url),t.opacity!==void 0&&(n.opacity=t.opacity)),n}s(pT,"translateDoorsStateToGeojsonCore");function u9(t,e){var r,i;let n={};return e==null||(t.color&&(t.color==="initial"?n.color=e.initialColor:n.color=t.color),t.topColor&&(t.topColor==="initial"?n.topColor=e.initialTopColor:n.topColor=t.topColor),t.visible!==void 0&&(n.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(n.texture=t.texture.url),((i=t.topTexture)==null?void 0:i.url)!==void 0&&(n.topTexture=t.topTexture.url),t.height!==void 0&&(n.height=t.height),t.opacity!==void 0&&(n.opacity=t.opacity)),n}s(u9,"translateWallsStateToGeojsonCore");function VDe(t,e){var r,i;let n={};return e==null||(t.color&&(t.color==="initial"?n.color=e.initialColor:n.color=t.color),t.topColor&&(t.topColor==="initial"?n.topColor=e.initialTopColor:n.topColor=t.topColor),t.visible!==void 0&&(n.visible=t.visible),((r=t.texture)==null?void 0:r.url)!==void 0&&(n.texture=t.texture.url),((i=t.topTexture)==null?void 0:i.url)!==void 0&&(n.topTexture=t.topTexture.url),t.hoverColor!==void 0&&(n.hoverColor=t.hoverColor),t.interactive!==void 0&&(n.interactive=t.interactive),t.height!==void 0&&(n.height=t.height),t.opacity!==void 0&&(n.opacity=t.opacity),t.flipImageToFaceCamera!==void 0&&(n.flipImageToFaceCamera=t.flipImageToFaceCamera)),n}s(VDe,"translateSpaceStateToGeojsonCore");function jDe(t,e){return((e-t+Math.PI)%(Math.PI*2)+Math.PI*2)%(Math.PI*2)-Math.PI}s(jDe,"differenceBetweenAngles");function $De(t,e){let r="Left";return t<=-Math.PI/4?r="Right":t<=-e?r="SlightRight":t<=e?r="Straight":t<=Math.PI/4?r="SlightLeft":r="Left",r}s($De,"getRelativeBearing");function GDe(t){let e={};for(let r in t){let i=t[r];if(i!=null){if(i.id=r,"polygons"in i)for(let n of i.polygons)e[n]=i;else if("lineStrings"in i)for(let n of i.lineStrings)e[n]=i;else if("points"in i)for(let n of i.points)e[n]=i}}return e}s(GDe,"extractStyleMap");function dT(t,e){return t.reduce((r,i)=>{let n=e[i.properties.id];if(n==null)return r;if("textures"in i.properties&&Array.isArray(i.properties.textures)&&i.properties.textures.length>0){let a=vt(Ee({},n),{id:n.id+"-textures"});r.set(a,[i])}else r.has(n)||r.set(n,[]),r.get(n).push(i);return r},new Map)}s(dT,"groupGeometryByStyle");function M1(t,e={}){var r,i,n,a,o,l,u;let c=vt(Ee({},t),{flipImageToFaceCamera:(r=e==null?void 0:e.flipImagesToFaceCamera)!=null?r:!0}),p=(n=(i=e==null?void 0:e.style)==null?void 0:i.shading)!=null?n:e==null?void 0:e.shadingAndOutlines;if(p===!0?c.shading={start:.1,end:.15,intensity:.4}:typeof p=="object"&&(c.shading={start:p.start,end:p.end,intensity:p.intensity}),c.outline=(o=(a=e==null?void 0:e.style)==null?void 0:a.outlines)!=null?o:e==null?void 0:e.shadingAndOutlines,"lineStrings"in t){let m=(u=(l=e==null?void 0:e.style)==null?void 0:l.wallTopColor)!=null?u:e==null?void 0:e.wallTopColor;m!=null&&(c.topColor=m)}return c}s(M1,"translateToCoreStyle");var tit=s((t,e)=>{var r;let i=((r=e.currentMap)==null?void 0:r.currentFloor).layers.get(rl);switch(t){case"interior-walls":return i==null?void 0:i.layers.get(KP);case"exterior-walls":return i==null?void 0:i.layers.get(N_);case"interior-doors":return i==null?void 0:i.layers.get(gz);case"exterior-doors":return i==null?void 0:i.layers.get(yz);default:return typeof t=="string"?t:t.id}},"getTargetID");function c9(t){return new Promise(e=>{t.onComplete(e),t.onStop(e)})}s(c9,"tweenToPromise");function Sj(t){return t.bbox?t.bbox:UA(t)}s(Sj,"getBoundingBox");function HDe(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.max(t[2],e[2]),Math.max(t[3],e[3])]}s(HDe,"expandBbox");function qDe(t){return[...new Set(t)]}s(qDe,"unique");function h9(t,e,r){return t.floorId&&e.has(t.floorId)?e.get(t.floorId):r}s(h9,"getTargetFloorObject");function X4(t){if(Zp.is(t)||Ky.is(t))return t.id}s(X4,"getAttachableGeometryId");function WDe(t,e,r){var i,n,a,o,l,u;let c=t.coordinates.length===2,p=!0;if(c&&t.coordinates[0].floorId!=null&&t.coordinates[1].floorId!=null){let m=e==null?void 0:e.getById("floor",t.coordinates[0].floorId),y=e==null?void 0:e.getById("floor",t.coordinates[1].floorId);m&&y&&(p=((n=(i=r.getState(m))==null?void 0:i.visible)!=null?n:!0)&&((o=(a=r.getState(y))==null?void 0:a.visible)!=null?o:!0))}else{let m=t.coordinates[0].floorId!=null?e==null?void 0:e.getById("floor",t.coordinates[0].floorId):void 0;p=m&&(u=(l=r.getState(m))==null?void 0:l.visible)!=null?u:!0}return p}s(WDe,"determineFloorVisibleBasedOnPath");var HX=Math.PI*.1,ls,Zl,Eu,E1,C1,Om,I1,rw,Kd,XDe,_0,qX,ZDe=class{constructor(e,r,i,n){Be(this,Kd),Be(this,ls,{}),Be(this,Zl),Be(this,Eu),Be(this,E1),Be(this,C1),Be(this,Om),Be(this,I1),Be(this,rw),He(this,Zl,r),He(this,Eu,e.features),He(this,E1,i),He(this,C1,n)}get path(){return w(this,Eu).map(e=>w(this,Zl).getById("node",e.properties.id)).filter(Boolean)}get departure(){if(w(this,ls).departure)return w(this,ls).departure;let e=w(this,Eu)[0].properties.id,r=w(this,E1)[0];if(w(this,E1).length>1){for(let i of w(this,E1))if(Q_(i,w(this,Zl)).includes(e)){r=i;break}}return w(this,ls).departure=r,r}get destination(){if(w(this,ls).destination)return w(this,ls).destination;let e=w(this,Eu)[w(this,Eu).length-1].properties.id,r=w(this,C1)[0];if(w(this,C1).length>1){for(let i of w(this,C1))if(Q_(i,w(this,Zl)).includes(e)){r=i;break}}return w(this,ls).destination=r,r}get coordinates(){return w(this,ls).coordinates?w(this,ls).coordinates:(w(this,ls).coordinates=w(this,Eu).map(e=>new Rn(e.geometry.coordinates[1],e.geometry.coordinates[0],e.properties.groupBy)),w(this,ls).coordinates)}get distance(){return w(this,ls).distance?w(this,ls).distance:(w(this,ls).distance=w(this,Eu).reduce((e,r)=>e+(r.properties.distance||0),0),w(this,ls).distance)}get instructions(){if(w(this,Eu).length<2)return[];if(w(this,ls).instructions)return w(this,ls).instructions;let e=[],r=0;for(let i=0;i<w(this,Eu).length;i++){let n=w(this,Eu)[i],a=w(this,Eu)[i-1],o=w(this,Eu)[i+1],l=new Rn(n.geometry.coordinates[1],n.geometry.coordinates[0],n.properties.groupBy),u=dr(this,Kd,XDe).call(this,{prevDirection:a,direction:n,nextDirection:o});r+=(a==null?void 0:a.properties.distance)||0;for(let c of u)c&&(e.push({action:c,distance:r,coordinate:l,node:w(this,Zl).getById("node",n.properties.id)}),r=0)}return w(this,ls).instructions=e,w(this,ls).instructions}};ls=new WeakMap,Zl=new WeakMap,Eu=new WeakMap,E1=new WeakMap,C1=new WeakMap,Om=new WeakMap,I1=new WeakMap,rw=new WeakMap,Kd=new WeakSet,XDe=s(function(t){var e,r;let{prevDirection:i,direction:n,nextDirection:a}=t,o=i&&w(this,Zl).getById("floor",i.properties.groupBy),l=w(this,Zl).getById("floor",n.properties.groupBy),u=a&&w(this,Zl).getById("floor",a.properties.groupBy),c=[];i||c.push({type:"Departure"});let p=w(this,Zl).getMVFFeatureByNodeId("connection",n.properties.id),m=p?w(this,Zl).getById("connection",p.id):void 0,y=p&&p.nodes.length>1,v=w(this,Zl).enterpriseMode&&(!n.properties.destination||!(p!=null&&p.nodes.includes(n.properties.destination))||!(p!=null&&p.nodes.includes(n.properties.id)));if(p&&!(!y||v))if(!w(this,Om)||w(this,Om)==="exit")c.push(dr(this,Kd,_0).call(this,"TakeConnection",l,u,m,p)),He(this,Om,"take"),He(this,I1,m),He(this,rw,p);else{let x=w(this,Zl).getMVFFeatureByNodeId("connection",(e=i==null?void 0:i.properties.id)!=null?e:""),E=w(this,Zl).getById("connection",(r=x==null?void 0:x.id)!=null?r:"");c.push(dr(this,Kd,_0).call(this,"ExitConnection",l,o,E,x)),He(this,Om,"exit"),He(this,I1,m),He(this,rw,p)}else w(this,Om)==="take"?(c.push(dr(this,Kd,_0).call(this,"ExitConnection",l,o,w(this,I1),w(this,rw))),He(this,Om,"exit"),He(this,I1,m)):u&&l.id!==u.id?c.push(dr(this,Kd,_0).call(this,"TakeConnection",l,u,m)):o&&o.id!==l.id?c.push(dr(this,Kd,_0).call(this,"ExitConnection",l,o,m)):c.push(dr(this,Kd,qX).call(this,i,n));return a||c.push({type:"Arrival"}),c},"#getActions"),_0=s(function(t,e,r,i,n){var a,o;let l="none";if(e.elevation!=null&&(r==null?void 0:r.elevation)!=null){let c=e.elevation-r.elevation;c>0?l="down":c<0&&(l="up")}let u=(o=(a=i==null?void 0:i.type)!=null?a:n==null?void 0:n.type)!=null?o:"stairs";return{type:t,fromFloor:e,toFloor:r,direction:l,connection:i,connectionType:u}},"#createConnectionAction"),qX=s(function(t,e){let r=e.properties.edges;if(!r||r.filter(n=>n.destination.properties.id!==(t==null?void 0:t.properties.id)&&n.destination.properties.id!==e.properties.destination).length===0)return null;let i=t?-jDe(t.properties.angle,e.properties.angle):0;return Math.abs(i)>=HX?{type:"Turn",bearing:$De(i,HX),referencePosition:"At"}:null},"#createTurnAction"),s(ZDe,"Directions");var rit=ZDe,YDe=class{constructor({nodes:e,geojsonCollection:r,connections:i,groupBy:n,multiplicativeDistanceWeightScaling:a}){$(this,"navigator"),$(this,"connections"),$(this,"getDirections",s((o,l,u,c)=>{let{accessible:p,smoothing:{enabled:m,radius:y},connectionIdWeightMap:v}=u,x=o.flatMap(D=>Q_(D,c)),E=l.flatMap(D=>Q_(D,c)),M=this.getExcludedNodeIds(u.excludedConnections).filter(D=>!x.includes(D)&&!E.includes(D)),I=this.getDisabledConnectionNodeIds(p).filter(D=>!x.includes(D)&&!E.includes(D)),P=new Map;for(let D in v){let F=c.getMVFFeatureById("connection",D);if(!F)continue;let k=this.navigator.graph.edges[F.nodes[0]];if(k){let B=k.find(U=>U.destination.properties.id===F.nodes[1]);B&&P.set(B,v[D])}}let C=this.navigator.getDirections({zones:u.zones.map(D=>{var F;return{geometry:D.geometry,cost:D.cost,map:(F=D.floor)==null?void 0:F.id}}),originIds:x,destinationNodeIds:E,excludedNodeIds:M,disabledConnectionNodeIds:I,simplify:{enabled:m,bufferRadius:y},overrideEdgeWeights:P,multiplicativeDistanceWeightScaling:!c.enterpriseMode});this.addCoordinateDirections(C,o,l);let T=new rit(C,c,o,l);if(!(T.distance===0&&new Set([...x,...E]).size===x.length+E.length))return T},"getDirections")),$(this,"getExcludedNodeIds",s(o=>{if(o.length===0)return[];let l=new Set(o.map(u=>u.id));return this.connections.reduce((u,c)=>l.has(c.id)?u.concat(c.nodes):u,[])},"getExcludedNodeIds")),$(this,"getDisabledConnectionNodeIds",s(o=>o===!1?[]:this.connections.reduce((l,u)=>u.accessible?l:l.concat(u.nodes),[]),"getDisabledConnectionNodeIds")),$(this,"addCoordinateDirections",s((o,[l],[u])=>{if(o.features.length){if(Rn.is(l)){let c=this.createDirectionFeature(l,this.navigator.getAngle([l.longitude,l.latitude],o.features[0].geometry.coordinates),this.navigator.getDistance([l.longitude,l.latitude],o.features[0].geometry.coordinates));o.features.splice(0,0,c)}if(Rn.is(u)){let c=this.createDirectionFeature(u,0,0),p=o.features[o.features.length-1];p.properties.distance=this.navigator.getDistance(p.geometry.coordinates,[u.longitude,u.latitude]),p.properties.angle=this.navigator.getAngle(p.geometry.coordinates,[u.longitude,u.latitude]),o.features.push(c)}}},"addCoordinateDirections")),$(this,"createDirectionFeature",s((o,l,u)=>({type:"Feature",geometry:{type:"Point",coordinates:[o.longitude,o.latitude]},properties:{groupBy:o.floorId,id:o.id,angle:l,distance:u,edges:[]}}),"createDirectionFeature")),this.navigator=new tJe({nodes:e,geojsonCollection:this.createCollection(r),groupBy:n,multiplicativeDistanceWeightScaling:a}),this.connections=i}createCollection(e){return{type:"FeatureCollection",features:Object.entries(e).reduce((r,[i,n])=>r.concat(n.features.map(a=>(a.properties.map=i,a))),[])}}};s(YDe,"DirectionsInternal");var iit=YDe;function Q_(t,e){var r,i,n,a;if(Cj.is(t))return t.navigationTarget.flatMap(o=>Q_(o,e));if(e4.is(t)){let o=e.Query.nearest(t,{types:["node"]});return(r=o==null?void 0:o[0])!=null&&r.feature.id?[o[0].feature.id]:[]}else if(Rn.is(t)){let o=e.Query.nearest(t,{types:["node"]});return(i=o==null?void 0:o[0])!=null&&i.feature.id?[o[0].feature.id]:[]}else if(QP.is(t)){let o=e.Query.nearest(t,{types:["node"]});return(n=o==null?void 0:o[0])!=null&&n.feature.id?[o[0].feature.id]:[]}else if(GA.is(t)){let o=e==null?void 0:e.getMVFFeatureById("entrance",t.id);return o!=null&&o.properties.node?[o==null?void 0:o.properties.node]:[]}else if(XP.is(t)){let o=e==null?void 0:e.getMVFFeatureById("area",t.id);return(a=o==null?void 0:o.properties.destinationNodes)!=null?a:[]}else if(Zp.is(t)){let o=e==null?void 0:e.getMVFFeatureById("space",t.id);return o==null?[]:o.properties.destinationNodes}else{if(JP.is(t))return t.coordinates.reduce((o,l)=>{var u;let c=e.Query.nearest(l,{types:["node"]});return(u=c==null?void 0:c[0])!=null&&u.feature.id&&o.push(c[0].feature.id),o},[]);if(Ky.is(t)){let o=e==null?void 0:e.objectEntranceNodeIdsByObstructionId[t.id];return o??[]}else return ex.is(t)?t.spaces.flatMap(o=>{var l,u;return(u=(l=e==null?void 0:e.getMVFFeatureById("space",o.id))==null?void 0:l.properties.destinationNodes)!=null?u:[]}).filter(o=>typeof o=="string"):Uw.is(t)?t.nodes.map(o=>o.id):qP.is(t)?[t.id]:[]}}s(Q_,"getNodesFromTarget");N();N();N();N();N();N();function KDe(t){let e=+this._x.call(null,t),r=+this._y.call(null,t);return Mj(this.cover(e,r),e,r,t)}s(KDe,"default");function Mj(t,e,r,i){if(isNaN(e)||isNaN(r))return t;var n,a=t._root,o={data:i},l=t._x0,u=t._y0,c=t._x1,p=t._y1,m,y,v,x,E,M,I,P;if(!a)return t._root=o,t;for(;a.length;)if((E=e>=(m=(l+c)/2))?l=m:c=m,(M=r>=(y=(u+p)/2))?u=y:p=y,n=a,!(a=a[I=M<<1|E]))return n[I]=o,t;if(v=+t._x.call(null,a.data),x=+t._y.call(null,a.data),e===v&&r===x)return o.next=a,n?n[I]=o:t._root=o,t;do n=n?n[I]=new Array(4):t._root=new Array(4),(E=e>=(m=(l+c)/2))?l=m:c=m,(M=r>=(y=(u+p)/2))?u=y:p=y;while((I=M<<1|E)===(P=(x>=y)<<1|v>=m));return n[P]=a,n[I]=o,t}s(Mj,"add");function JDe(t){var e,r,i=t.length,n,a,o=new Array(i),l=new Array(i),u=1/0,c=1/0,p=-1/0,m=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(a=+this._y.call(null,e))||(o[r]=n,l[r]=a,n<u&&(u=n),n>p&&(p=n),a<c&&(c=a),a>m&&(m=a));if(u>p||c>m)return this;for(this.cover(u,c).cover(p,m),r=0;r<i;++r)Mj(this,o[r],l[r],t[r]);return this}s(JDe,"addAll");N();function QDe(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,i=this._y0,n=this._x1,a=this._y1;if(isNaN(r))n=(r=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var o=n-r||1,l=this._root,u,c;r>t||t>=n||i>e||e>=a;)switch(c=(e<i)<<1|t<r,u=new Array(4),u[c]=l,l=u,o*=2,c){case 0:n=r+o,a=i+o;break;case 1:r=n-o,a=i+o;break;case 2:n=r+o,i=a-o;break;case 3:r=n-o,i=a-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=r,this._y0=i,this._x1=n,this._y1=a,this}s(QDe,"default");N();function e6e(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}s(e6e,"default");N();function t6e(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}s(t6e,"default");N();N();function Pl(t,e,r,i,n){this.node=t,this.x0=e,this.y0=r,this.x1=i,this.y1=n}s(Pl,"default");function r6e(t,e,r){var i,n=this._x0,a=this._y0,o,l,u,c,p=this._x1,m=this._y1,y=[],v=this._root,x,E;for(v&&y.push(new Pl(v,n,a,p,m)),r==null?r=1/0:(n=t-r,a=e-r,p=t+r,m=e+r,r*=r);x=y.pop();)if(!(!(v=x.node)||(o=x.x0)>p||(l=x.y0)>m||(u=x.x1)<n||(c=x.y1)<a))if(v.length){var M=(o+u)/2,I=(l+c)/2;y.push(new Pl(v[3],M,I,u,c),new Pl(v[2],o,I,M,c),new Pl(v[1],M,l,u,I),new Pl(v[0],o,l,M,I)),(E=(e>=I)<<1|t>=M)&&(x=y[y.length-1],y[y.length-1]=y[y.length-1-E],y[y.length-1-E]=x)}else{var P=t-+this._x.call(null,v.data),C=e-+this._y.call(null,v.data),T=P*P+C*C;if(T<r){var D=Math.sqrt(r=T);n=t-D,a=e-D,p=t+D,m=e+D,i=v.data}}return i}s(r6e,"default");N();function i6e(t){if(isNaN(p=+this._x.call(null,t))||isNaN(m=+this._y.call(null,t)))return this;var e,r=this._root,i,n,a,o=this._x0,l=this._y0,u=this._x1,c=this._y1,p,m,y,v,x,E,M,I;if(!r)return this;if(r.length)for(;;){if((x=p>=(y=(o+u)/2))?o=y:u=y,(E=m>=(v=(l+c)/2))?l=v:c=v,e=r,!(r=r[M=E<<1|x]))return this;if(!r.length)break;(e[M+1&3]||e[M+2&3]||e[M+3&3])&&(i=e,I=M)}for(;r.data!==t;)if(n=r,!(r=r.next))return this;return(a=r.next)&&delete r.next,n?(a?n.next=a:delete n.next,this):e?(a?e[M]=a:delete e[M],(r=e[0]||e[1]||e[2]||e[3])&&r===(e[3]||e[2]||e[1]||e[0])&&!r.length&&(i?i[I]=r:this._root=r),this):(this._root=a,this)}s(i6e,"default");function n6e(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this}s(n6e,"removeAll");N();function a6e(){return this._root}s(a6e,"default");N();function o6e(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}s(o6e,"default");N();function s6e(t){var e=[],r,i=this._root,n,a,o,l,u;for(i&&e.push(new Pl(i,this._x0,this._y0,this._x1,this._y1));r=e.pop();)if(!t(i=r.node,a=r.x0,o=r.y0,l=r.x1,u=r.y1)&&i.length){var c=(a+l)/2,p=(o+u)/2;(n=i[3])&&e.push(new Pl(n,c,p,l,u)),(n=i[2])&&e.push(new Pl(n,a,p,c,u)),(n=i[1])&&e.push(new Pl(n,c,o,l,p)),(n=i[0])&&e.push(new Pl(n,a,o,c,p))}return this}s(s6e,"default");N();function l6e(t){var e=[],r=[],i;for(this._root&&e.push(new Pl(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var n=i.node;if(n.length){var a,o=i.x0,l=i.y0,u=i.x1,c=i.y1,p=(o+u)/2,m=(l+c)/2;(a=n[0])&&e.push(new Pl(a,o,l,p,m)),(a=n[1])&&e.push(new Pl(a,p,l,u,m)),(a=n[2])&&e.push(new Pl(a,o,m,p,c)),(a=n[3])&&e.push(new Pl(a,p,m,u,c))}r.push(i)}for(;i=r.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}s(l6e,"default");N();function u6e(t){return t[0]}s(u6e,"defaultX");function c6e(t){return arguments.length?(this._x=t,this):this._x}s(c6e,"default");N();function h6e(t){return t[1]}s(h6e,"defaultY");function p6e(t){return arguments.length?(this._y=t,this):this._y}s(p6e,"default");function Ej(t,e,r){var i=new Z4(e??u6e,r??h6e,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}s(Ej,"quadtree");function Z4(t,e,r,i,n,a){this._x=t,this._y=e,this._x0=r,this._y0=i,this._x1=n,this._y1=a,this._root=void 0}s(Z4,"Quadtree");function p9(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}s(p9,"leaf_copy");var au=Ej.prototype=Z4.prototype;au.copy=function(){var t=new Z4(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,r,i;if(!e)return t;if(!e.length)return t._root=p9(e),t;for(r=[{source:e,target:t._root=new Array(4)}];e=r.pop();)for(var n=0;n<4;++n)(i=e.source[n])&&(i.length?r.push({source:i,target:e.target[n]=new Array(4)}):e.target[n]=p9(i));return t};au.add=KDe;au.addAll=JDe;au.cover=QDe;au.data=e6e;au.extent=t6e;au.find=r6e;au.remove=i6e;au.removeAll=n6e;au.root=a6e;au.size=o6e;au.visit=s6e;au.visitAfter=l6e;au.x=c6e;au.y=p6e;var Wc,uy,d6e=class{constructor(e){Be(this,Wc,{}),Be(this,uy),He(this,uy,e)}getTreeByType(e,r,i){var n;if(w(this,Wc)[e]||(w(this,Wc)[e]={}),w(this,Wc)[e][r]&&w(this,Wc)[e][r][i])return w(this,Wc)[e][r][i];w(this,Wc)[e][r]||(w(this,Wc)[e][r]={}),w(this,Wc)[e][r][i]||(w(this,Wc)[e][r][i]=Ej());let a=w(this,Wc)[e][r][i];a.x(l=>l.geometry.coordinates[1]),a.y(l=>l.geometry.coordinates[0]);let o=[];switch(e){case"node":o=((n=w(this,uy).directions.navigator.graph.nodesByGroup.get(i))==null?void 0:n.filter(l=>l.properties.neighbors.length>0))||[];break;case"point-of-interest":o=w(this,uy).mvfPoisByFloorId[i]||[];break;case"door":o=w(this,uy).mvfEntrancesByFloorId[i]||[];break;case"annotation":o=w(this,uy).mvfAnnotationsByFloorId[i]||[];break}return(o==null?void 0:o.length)>0&&a.addAll(o),a}};Wc=new WeakMap,uy=new WeakMap,s(d6e,"QueryCache");var nit=d6e,ait=Xl.object({limit:Xl.enum(["same-floor","same-elevation"]).optional(),radius:Xl.number().optional(),types:Xl.array(Xl.enum(["node","point-of-interest"])).min(1)}),Wd,fT,f6e=class{constructor(e){Be(this,Wd),Be(this,fT),He(this,Wd,e),He(this,fT,new nit(w(this,Wd)))}nearest(e,r){try{ait.parse(r)}catch(o){Vt.error(o);return}let i=c3(e);if(!i)return;let n=i.floorId?[i.floorId]:[];if(i.floorId==null)for(let o of w(this,Wd).getByType("floor-stack")){let l=o.defaultFloor;l&&n.push(l.id)}else if(r.limit==="same-elevation"){let o=w(this,Wd).floorsById[i.floorId];if(o){let l=o==null?void 0:o.elevation;l&&(n=w(this,Wd).getByType("floor-stack").map(u=>{var c;return(c=u.floors.find(p=>p.elevation===l))==null?void 0:c.id}).filter(Boolean))}}let a=[];for(let o of qDe(r.types))for(let l of n){let u=w(this,fT).getTreeByType(o,w(this,Wd).mapName,l).find(i.latitude,i.longitude,r.radius);if(u){let c=w(this,Wd).getById(o,u==null?void 0:u.properties.id);c&&a.push({distance:Xm([i.longitude,i.latitude],u.geometry.coordinates),feature:c})}}return a.sort((o,l)=>o.distance-l.distance)}};Wd=new WeakMap,fT=new WeakMap,s(f6e,"Query");var oit=f6e;N();N();var mT,m6e=class{constructor(e){Be(this,mT),He(this,mT,e||[])}get raw(){return w(this,mT)}};mT=new WeakMap,s(m6e,"OpeningHours");var sit=m6e,wl,ei,Pa,d9=class gT extends hg{constructor(e,r){super(r.mvfData.id),$(this,"__type",gT.__type),$(this,"id","loc_"),$(this,"name",""),$(this,"externalId"),$(this,"description"),$(this,"logo"),$(this,"phone"),$(this,"social",[]),$(this,"images",[]),$(this,"links",[]),$(this,"website"),$(this,"icon"),Be(this,wl),Be(this,ei,{}),Be(this,Pa),He(this,wl,e),He(this,Pa,r.mvfData);for(let i in r.mvfData)i==="links"?this.links=r.mvfData.links.map(n=>new i3({mvfData:n})):i==="pictures"?this.images=r.mvfData.pictures.map(n=>{var a;return n.url?new a3({mvfData:vt(Ee({},n),{url:(a=n.url)!=null?a:""}),mapData:w(this,wl)}):void 0}).filter(n=>n!=null):i==="website"?r.mvfData.website&&(this.website=new i3({mvfData:r.mvfData.website})):i==="icon"?r.mvfData.icon&&(this.icon=new a3({mvfData:{url:r.mvfData.icon},mapData:w(this,wl)})):Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)||Object.defineProperty(this,i,{enumerable:!0,get(){return w(this,Pa)[i]}})}static is(e){return e.__type===gT.__type}get spaces(){if(w(this,ei).spaces)return w(this,ei).spaces;if(w(this,Pa).spaces==null)return w(this,ei).spaces=[],w(this,ei).spaces;w(this,ei).spaces=[];for(let e=0;e<w(this,Pa).spaces.length;e++){let r=w(this,wl).getById("space",w(this,Pa).spaces[e].id);r&&w(this,ei).spaces.push(r)}return w(this,ei).spaces}get points(){if(w(this,ei).points)return w(this,ei).points;if(w(this,Pa).spaces==null)return w(this,ei).points=[],w(this,ei).points;w(this,ei).points=[];for(let e=0;e<w(this,Pa).spaces.length;e++){let r=w(this,wl).getById("point-of-interest",w(this,Pa).spaces[e].id);r&&w(this,ei).points.push(r)}return w(this,ei).points}get doors(){if(w(this,ei).doors)return w(this,ei).doors;if(w(this,Pa).entrances==null)return w(this,ei).doors=[],w(this,ei).doors;w(this,ei).doors=[];for(let e=0;e<w(this,Pa).entrances.length;e++){let r=w(this,wl).getById("door",w(this,Pa).entrances[e].id);r&&w(this,ei).doors.push(r)}return w(this,ei).doors}get connections(){var e;if(w(this,ei).connections)return w(this,ei).connections;if(w(this,Pa).connections==null)return w(this,ei).connections=[],w(this,ei).connections;let r=new Set;for(let i=0;i<w(this,Pa).connections.length;i++){let n=w(this,Pa).connections[i],a=w(this,wl).mvfConnectionsById[n],o=(a==null?[]:a.nodes).map(l=>w(this,wl).getById("node",l)).filter(Boolean);for(let l of o){if(l==null)continue;let u=dx([l.coordinate.longitude,l.coordinate.latitude]),c=((e=w(this,wl).connectionSpaceIdsByLatLon[u])!=null?e:[]).map(p=>w(this,wl).connectionsById[p]).filter(p=>p!=null);for(let p of c)r.add(p)}}return w(this,ei).connections=Array.from(r),w(this,ei).connections}get annotations(){if(w(this,ei).annotations)return w(this,ei).annotations;if(w(this,Pa).annotations==null)return w(this,ei).annotations=[],w(this,ei).annotations;w(this,ei).annotations=[];for(let e=0;e<w(this,Pa).annotations.length;e++){let r=w(this,wl).getById("annotation",w(this,Pa).annotations[e].id);r&&w(this,ei).annotations.push(r)}return w(this,ei).annotations}get categories(){return w(this,ei).categories?w(this,ei).categories:w(this,Pa).categories==null?(w(this,ei).categories=[],w(this,ei).categories):(w(this,ei).categories=w(this,Pa).categories.map(e=>w(this,wl).getById("location-category",e)).filter(e=>e!=null),w(this,ei).categories)}get mapObjects(){return w(this,ei).mapObjects?w(this,ei).mapObjects:w(this,Pa).obstructions==null?(w(this,ei).mapObjects=[],w(this,ei).mapObjects):(w(this,ei).mapObjects=w(this,Pa).obstructions.map(e=>w(this,wl).getById("object",e.id)).filter(e=>e!=null),w(this,ei).mapObjects)}get areas(){return w(this,ei).areas?w(this,ei).areas:w(this,Pa).areas==null?(w(this,ei).areas=[],w(this,ei).areas):(w(this,ei).areas=w(this,Pa).areas.map(e=>w(this,wl).getById("area",e.id)).filter(e=>e!=null),w(this,ei).areas)}get focusTarget(){if(w(this,ei).focusTarget)return w(this,ei).focusTarget;let e=[];for(let r of this.spaces)e.push(r);for(let r of this.connections)e.push(...r.coordinates);for(let r of this.doors)e.push(r.focusTarget);for(let r of this.mapObjects)e.push(r.focusTarget);for(let r of this.annotations)e.push(r.focusTarget);return w(this,ei).focusTarget=e,e}get openingHours(){var e;return w(this,ei).openingHours?w(this,ei).openingHours:(w(this,ei).openingHours=new sit((e=w(this,Pa).openingHoursSpecification)!=null?e:[]),w(this,ei).openingHours)}get navigationTarget(){if(w(this,ei).navigationTarget)return w(this,ei).navigationTarget;let e=[];for(let r of this.spaces)e.push(r);for(let r of this.connections)e.push(...r.coordinates);for(let r of this.doors)e.push(r.focusTarget);for(let r of this.mapObjects)e.push(r.focusTarget);for(let r of this.annotations)e.push(r.focusTarget);for(let r of this.points)e.push(r.focusTarget);return w(this,ei).navigationTarget=e,e}toJSON(){return{__type:gT.__type,id:this.id,name:this.name}}};wl=new WeakMap,ei=new WeakMap,Pa=new WeakMap,s(d9,"LocationProfile"),$(d9,"__type","location-profile");var lit=d9,Cj=lit;N();var cy,lc,T1,f9=class yT extends hg{constructor(e,r){super(r.mvfData.id),$(this,"__type",yT.__type),$(this,"id","cat_"),$(this,"name",""),$(this,"icon",""),Be(this,cy),Be(this,lc,{}),Be(this,T1),He(this,cy,e),He(this,T1,r.mvfData);for(let i in r.mvfData)Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),i)||Object.defineProperty(this,i,{enumerable:!0,get(){return w(this,T1)[i]}})}static is(e){return e.__type===yT.__type}get parent(){return w(this,lc).parent?w(this,lc).parent:(w(this,lc).parent=w(this,T1).parent?w(this,cy).getById("location-category",w(this,T1).parent):void 0,w(this,lc).parent)}get children(){return w(this,lc).children?w(this,lc).children:(w(this,lc).children=w(this,cy).locationCategoriesByParentId[this.id]||[],w(this,lc).children)}get locationProfiles(){if(w(this,lc).locationProfiles)return w(this,lc).locationProfiles;let e=[];for(let r of w(this,cy).locationProfilesByCategoryId[this.id]||[]){let i=w(this,cy).getById("location-profile",r.id);i&&e.push(i)}return w(this,lc).locationProfiles=e,e}toJSON(){return{__type:yT.__type,id:this.id,name:this.name}}};cy=new WeakMap,lc=new WeakMap,T1=new WeakMap,s(f9,"LocationCategory"),$(f9,"__type","location-category");var uit=f9,g6e=uit,gi,m9,y6e,iw,v6e=class extends qa{constructor(e,r){var i,n,a,o,l;super(),Be(this,m9),$(this,"Analytics"),Be(this,gi,{}),$(this,"Query"),$(this,"mvf"),$(this,"outdoorViewToken"),$(this,"spaceIdsByDestinationNodeId"),$(this,"objectEntranceNodeIdsByObstructionId"),$(this,"obstructionIdByEntranceId"),$(this,"venue"),$(this,"tokenManager"),$(this,"directions"),$(this,"enterpriseMode",!1),$(this,"nodesById"),$(this,"spacesById"),$(this,"floorsById"),$(this,"floorStacksById"),$(this,"facadesById"),$(this,"facadesBySpaceId"),$(this,"connectionsById"),$(this,"objectsById"),$(this,"doorsById"),$(this,"pointsOfInterestById"),$(this,"annotationsById"),$(this,"areasById"),$(this,"locationProfilesById"),$(this,"locationCategoriesById"),$(this,"locationProfilesByExternalId"),$(this,"locationsById"),$(this,"locationProfilesByCategoryId"),$(this,"locationCategoriesByParentId"),$(this,"categoriesById"),$(this,"doorsByNodeId"),$(this,"mvfLocationsBySpaceId"),$(this,"locationIdsByNodeId"),$(this,"spaceIdsByNodeId"),$(this,"mvfAnnotationsById"),$(this,"mvfConnectionsById"),$(this,"mvfConnectionsByNodeId"),$(this,"mvfConnectionIdsByLatLon"),$(this,"mvfEntrancesById"),$(this,"mvfNodesById"),$(this,"mvfObstructionById"),$(this,"mvfSpacesById"),$(this,"mvfFloorsById"),$(this,"mvfFloorStacksById"),$(this,"mvfAreasById"),$(this,"connectionSpaceIdsByLatLon"),$(this,"locationProfilesByAttachedFeatureId"),$(this,"spacesByExternalId"),$(this,"nodesByExternalId"),$(this,"objectsByExternalId"),$(this,"poisByExternalId"),$(this,"floorsByExternalId"),$(this,"floorStacksByExternalId"),$(this,"doorsByExternalId"),$(this,"areasByExternalId"),$(this,"connectionsByExternalId"),$(this,"locationsByExternalId"),$(this,"categoriesByExternalId"),$(this,"mvfNodesByFloorId"),$(this,"mvfSpacesByFloorId"),$(this,"mvfPoisByFloorId"),$(this,"mvfEntrancesByFloorId"),$(this,"mvfAnnotationsByFloorId"),$(this,"localePacksUrls"),$(this,"currentLanguage"),$(this,"languagePacks",{}),$(this,"tilesets",{}),$(this,"binaryBundle"),$(this,"envControl"),$(this,"getMapDataOptions"),Be(this,iw),$(this,"getDirectionsMultiDestination",s((m,y,v)=>this.getDirections(m,y,vt(Ee({},v),{multiDestination:!0})),"getDirectionsMultiDestination")),$(this,"getDirections",s((m,y,v)=>{let{accessible:x=!1,smoothing:E=!0,multiDestination:M=!1}=v||{},I=typeof E=="object"?E.enabled:E,P=typeof E=="object"?E.radius:void 0,C=(v==null?void 0:v.zones)||[],T={accessible:x,zones:C,smoothing:{enabled:I??!0,radius:P??.75},excludedConnections:(v==null?void 0:v.excludedConnections)||[],connectionIdWeightMap:(v==null?void 0:v.connectionIdWeightMap)||{}};if(M&&Array.isArray(y)){let D=Array.isArray(m)?m:[m],F=[];for(let k of y){let B=Array.isArray(k)?k:[k],U=this.directions.getDirections(D,B,T,this);if(!U){Vt.error("getDirections failed due to missing directions for one of the segments");return}D=B,F.push(U)}return F}else{let D=Array.isArray(m)?m:[m],F=Array.isArray(y)?y:[y];if(Array.isArray(F[0])){Vt.error("getDirections does not support multi-destination without multisegment option");return}return D[0].id&&F[0].id&&this.Analytics.sendGetDirectionsEvent(D[0].id,F[0].id),this.directions.getDirections(D,F,T,this)}},"getDirections")),$(this,"transformImageRequest",s(async m=>{var y;if(this.enterpriseMode||!this.getMapDataOptions)return{url:m};if(!v3e(m))return{url:m};if(_3e(m))return{url:m};let v=pye(m);if(!v)return{url:m};try{let x=await((y=this.tokenManager)==null?void 0:y.getSasTokensAsync()),E=x==null?void 0:x[v.mapId];if(E==null)throw new Error("SAS token not found");let[M]=m.split("?");return{url:"".concat(M,"?").concat(E.token)}}catch(x){return Vt.error("Failed to append SAS token to image request. Requests for private images may fail.",x),{url:m}}},"transformImageRequest"));let u=(i=r==null?void 0:r.env)!=null?i:yS();if(this.envControl=u,this.binaryBundle=r==null?void 0:r.binaryBundle,this.Analytics=new Kve,this.localePacksUrls=(n=r==null?void 0:r.localePacksUrls)!=null?n:{},this.mvf=e,this.outdoorViewToken=r==null?void 0:r.outdoorViewToken,this.getMapDataOptions=r==null?void 0:r.getMapDataOptions,((a=e["tileset.json"])==null?void 0:a.default)!=null&&(this.tilesets[e["tileset.json"].default.key]=e["tileset.json"].default,u.updateTileServerBaseUrl(e["tileset.json"].default.url),e["tileset.json"].others!=null))for(let m of e["tileset.json"].others)this.tilesets[m.key]=m;this.enterpriseMode=(o=r==null?void 0:r.enterprise)!=null?o:!1,this.tokenManager=r==null?void 0:r.tokenManager;let c=uXe(e,this);this.nodesById=c.nodesById,this.spacesById=c.spacesById,this.floorsById=c.floorsById,this.floorStacksById=c.floorStacksById,this.facadesById=c.facadesById,this.facadesBySpaceId=c.facadesBySpaceId,this.connectionsById=c.connectionsById,this.objectsById=c.objectsById,this.doorsById=c.doorsById,this.pointsOfInterestById=c.poisById,this.annotationsById=c.annotationsById,this.areasById=c.areasById,this.locationProfilesById=c.locationProfilesById,this.locationCategoriesById=c.locationCategoriesById,this.locationProfilesByCategoryId=c.locationProfilesByCategoryId,this.locationCategoriesByParentId=c.locationCategoriesByParentId,this.spacesByExternalId=c.spacesByExternalId,this.nodesByExternalId=c.nodesByExternalId,this.objectsByExternalId=c.objectsByExternalId,this.floorsByExternalId=c.floorsByExternalId,this.locationProfilesByExternalId=c.locationProfilesByExternalId,this.floorStacksByExternalId=c.floorStacksByExternalId,this.poisByExternalId=c.poisByExternalId,this.doorsByExternalId=c.doorsByExternalId,this.areasByExternalId=c.areasByExternalId,this.mvfAnnotationsById=c.mvfAnnotationsById,this.mvfConnectionsById=c.mvfConnectionsById,this.mvfConnectionsByNodeId=c.mvfConnectionsByNodeId,this.mvfConnectionIdsByLatLon=c.mvfConnectionIdsByLatLon,this.mvfEntrancesById=c.mvfEntrancesById,this.mvfNodesById=c.mvfNodesById,this.mvfObstructionById=c.mvfObstructionById,this.mvfSpacesById=c.mvfSpacesById,this.mvfFloorsById=c.mvfFloorsById,this.mvfFloorStacksById=c.mvfFloorStacksById,this.mvfNodesByFloorId=c.mvfNodesByFloorId,this.mvfSpacesByFloorId=c.mvfSpacesByFloorId,this.mvfPoisByFloorId=c.mvfPoisByFloorId,this.mvfEntrancesByFloorId=c.mvfEntrancesByFloorId,this.mvfAnnotationsByFloorId=c.mvfAnnotationsByFloorId,this.mvfAreasById=c.mvfAreasById,this.doorsByNodeId=c.doorsByNodeId,this.spaceIdsByDestinationNodeId=c.spaceIdsByDestinationNodeId,this.objectEntranceNodeIdsByObstructionId=c.objectEntranceNodeIdsByObstructionId,this.obstructionIdByEntranceId=c.obstructionIdByEntranceId;let p=lXe(e,this);if(this.locationsById=p.locationsById,this.categoriesById=p.categoriesById,this.mvfLocationsBySpaceId=p.mvfLocationsBySpaceId,this.locationIdsByNodeId=p.locationIdsByNodeId,this.connectionSpaceIdsByLatLon=c.connectionIdsByLatLon,this.locationProfilesByAttachedFeatureId=c.locationProfilesByAttachedFeatureId,this.spaceIdsByNodeId=p.spaceIdsByNodeId,this.connectionsByExternalId=p.connectionsByExternalId,this.locationsByExternalId=p.locationsByExternalId,this.categoriesByExternalId=p.categoriesByExternalId,p.venue.name!=null){this.venue=new t0e(this,{mvfData:p.venue});let m={};for(let y in p.mvfLocationsById)m[y]=p.mvfLocationsById[y];for(let y in p.locationInstancesById)m[y]=p.locationInstancesById[y];this.languagePacks[this.venue.defaultLanguage.code]={type:"initial",optimized:{"enterprise-location":m,"enterprise-category":p.mvfCategoriesById,"floor-stack":c.mvfFloorStacksById,floor:c.mvfFloorsById}},(l=r==null?void 0:r.languagePacks)==null||l.forEach(({language:y,localePack:v})=>{this.languagePacks[y.code]=w8(v)}),this.currentLanguage=this.venue.defaultLanguage}this.Query=new oit(this),this.directions=new iit({nodes:e["node.geojson"],geojsonCollection:e.enterprise?e.space:e.obstruction,connections:e["connection.json"],groupBy:"map",multiplicativeDistanceWeightScaling:!this.enterpriseMode})}getEnv(){let e=this;return{get baseUri(){var r;return e.envControl.getBaseUri((r=e.enterpriseMode)!=null?r:!1)},get baseAuthUri(){return e.envControl.getBaseAuthUri()},get analyticsBaseUri(){return e.envControl.getAnalyticsBaseUri()},get tileServerUri(){return e.envControl.getTileServerUri()}}}get mapName(){return this.mvf["manifest.geojson"].features[0].properties.name}get organizationId(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.org_id)!=null?e:""}get mapCenter(){return new Rn(this.mvf["manifest.geojson"].features[0].geometry.coordinates[1],this.mvf["manifest.geojson"].features[0].geometry.coordinates[0])}get naturalBearing(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.naturalBearing)!=null?e:0}get spaces(){return w(this,gi).spaces==null&&(w(this,gi).spaces=globalThis.Object.values(this.spacesById)),w(this,gi).spaces}get objects(){return w(this,gi).objects==null&&(w(this,gi).objects=globalThis.Object.values(this.objectsById)),w(this,gi).objects}get connections(){return w(this,gi).connections==null&&(w(this,gi).connections=globalThis.Object.values(this.connectionsById)),w(this,gi).connections}get floors(){return w(this,gi).floors==null&&(w(this,gi).floors=globalThis.Object.values(this.floorsById)),w(this,gi).floors}get floorStacks(){return w(this,gi).floorStacks==null&&(w(this,gi).floorStacks=globalThis.Object.values(this.floorStacksById)),w(this,gi).floorStacks}get facades(){return w(this,gi).facades==null&&(w(this,gi).facades=globalThis.Object.values(this.facadesById)),w(this,gi).facades}get doors(){return w(this,gi).doors==null&&(w(this,gi).doors=globalThis.Object.values(this.doorsById)),w(this,gi).doors}get pointsOfInterest(){return w(this,gi).pointsOfInterest==null&&(w(this,gi).pointsOfInterest=globalThis.Object.values(this.pointsOfInterestById)),w(this,gi).pointsOfInterest}get annotations(){return w(this,gi).annotations==null&&(w(this,gi).annotations=globalThis.Object.values(this.annotationsById)),w(this,gi).annotations}get areas(){return w(this,gi).areas==null&&(w(this,gi).areas=globalThis.Object.values(this.areasById)),w(this,gi).areas}get nodes(){return w(this,gi).nodes==null&&(w(this,gi).nodes=globalThis.Object.values(this.nodesById)),w(this,gi).nodes}get locations(){return w(this,gi).locations==null&&(w(this,gi).locations=globalThis.Object.values(this.locationsById)),globalThis.Object.values(this.locationsById)}get categories(){return w(this,gi).categories==null&&(w(this,gi).categories=globalThis.Object.values(this.categoriesById)),globalThis.Object.values(this.categoriesById)}get locationProfiles(){return w(this,gi).locationProfiles==null&&(w(this,gi).locationProfiles=globalThis.Object.values(this.locationProfilesById)),w(this,gi).locationProfiles}get locationCategories(){return w(this,gi).locationCategories==null&&(w(this,gi).locationCategories=globalThis.Object.values(this.locationCategoriesById)),w(this,gi).locationCategories}get mvfFloors(){return w(this,gi).mvfFloors==null&&(w(this,gi).mvfFloors=globalThis.Object.values(this.mvfFloorsById)),w(this,gi).mvfFloors}get mvfFloorStacks(){return w(this,gi).mvfFloorStacks==null&&(w(this,gi).mvfFloorStacks=globalThis.Object.values(this.mvfFloorStacksById)),w(this,gi).mvfFloorStacks}getByType(e){switch(e){case"location-profile":return this.locationProfiles;case"location-category":return this.locationCategories;case"area":return this.areas;case"node":return this.nodes;case"space":return this.spaces;case"door":return this.doors;case"floor":return this.floors;case"floor-stack":return this.floorStacks;case"connection":return this.connections;case"object":return this.objects;case"point-of-interest":return this.pointsOfInterest;case"annotation":return this.annotations;case"enterprise-location":return this.locations;case"enterprise-category":return this.categories;case"enterprise-venue":return this.venue;case"facade":return this.facades;default:return[]}}getById(e,r){switch(e){case"location-profile":return this.locationProfilesById[r];case"location-category":return this.locationCategoriesById[r];case"space":return this.spacesById[r];case"floor":return this.floorsById[r];case"floor-stack":return this.floorStacksById[r];case"facade":return this.facadesById[r];case"node":return this.nodesById[r];case"door":return this.doorsById[r];case"connection":let i=this.connectionsById[r];return i==null&&(i=dr(this,m9,y6e).call(this,this.mvfConnectionsById[r])),i;case"object":return this.objectsById[r];case"point-of-interest":return this.pointsOfInterestById[r];case"annotation":return this.annotationsById[r];case"area":return this.areasById[r];case"enterprise-location":return this.locationsById[r];case"enterprise-category":return this.categoriesById[r];default:return}}getByExternalId(e,r){var i,n,a,o,l,u,c,p,m,y,v,x;switch(e){case"location-profile":return(i=this.locationProfilesByExternalId[r])!=null?i:[];case"location-category":return[];case"space":return(n=this.spacesByExternalId[r])!=null?n:[];case"floor":return(a=this.floorsByExternalId[r])!=null?a:[];case"floor-stack":return(o=this.floorStacksByExternalId[r])!=null?o:[];case"node":return(l=this.nodesByExternalId[r])!=null?l:[];case"door":return(u=this.doorsByExternalId[r])!=null?u:[];case"connection":return(c=this.connectionsByExternalId[r])!=null?c:[];case"object":return(p=this.objectsByExternalId[r])!=null?p:[];case"point-of-interest":return(m=this.poisByExternalId[r])!=null?m:[];case"area":return(y=this.areasByExternalId[r])!=null?y:[];case"enterprise-location":return(v=this.locationsByExternalId[r])!=null?v:[];case"enterprise-category":return(x=this.categoriesByExternalId[r])!=null?x:[];default:return[]}}getMapDataById(e){var r,i,n,a,o,l,u,c,p,m;return(m=(p=(c=(u=(l=(o=(a=(n=(i=(r=this.spacesById[e])!=null?r:this.floorsById[e])!=null?i:this.floorStacksById[e])!=null?n:this.facadesById[e])!=null?a:this.nodesById[e])!=null?o:this.doorsById[e])!=null?l:this.connectionsById[e])!=null?u:this.objectsById[e])!=null?c:this.pointsOfInterestById[e])!=null?p:this.annotationsById[e])!=null?m:this.areasById[e]}getMVFFeatureById(e,r){switch(e){case"space":return this.mvfSpacesById[r];case"node":return this.mvfNodesById[r];case"obstruction":return this.mvfObstructionById[r];case"floor":return this.mvfFloorsById[r];case"floor-stack":return this.mvfFloorStacksById[r];case"connection":return this.mvfConnectionsById[r];case"entrance":return this.mvfEntrancesById[r];case"annotation":return this.mvfAnnotationsById[r];case"area":return this.mvfAreasById[r];default:throw new Error("Unknown MVF feature type: ".concat(e))}}getMVFFeatureByNodeId(e,r){switch(e){case"connection":return this.mvfConnectionsByNodeId[r];default:throw new Error("Unsupported MVF feature type: ".concat(e))}}getMVFFeatureByType(e){switch(e){case"floor-stack":return this.mvfFloorStacks;case"floor":return this.mvfFloors;default:throw new Error("Unsupported MVF feature type: ".concat(e))}}getPropTranslation(e,r,i,n){var a,o;if(!this.currentLanguage)return n;let{code:l}=this.currentLanguage,u=(o=(a=this.languagePacks[l])==null?void 0:a.optimized)==null?void 0:o[e];if(u){let c=u[i];if(c!=null&&c[r]!==void 0)return c[r]}return n}async changeLanguage(e){var r;let i=e.toLowerCase();if(!i){Vt.error("language code must be defined");return}if(!this.currentLanguage){Vt.error("languageCode feature is not supported");return}let n=this.currentLanguage.code,a=(r=this.venue)==null?void 0:r.languages.find(({code:l})=>l.toLowerCase()===i.toLowerCase());if(!a){Vt.warn("language not found");return}if(n===a.code)return;let o=this.languagePacks[a.code];if(!o){let l=this.localePacksUrls[a.code];if(!l){Vt.error("locale packs url not found for ".concat(a.code));return}w(this,iw)&&w(this,iw).abort();let u=new AbortController;He(this,iw,u);let c;try{c=await u3e(l,{signal:u.signal})}catch(p){Vt.error("failed downloading language pack",p);return}if(!c||u.signal.aborted)return;o=w8(c),this.languagePacks[a.code]=o}this.Analytics.sendChangeLanguageEvent({fromLanguage:this.currentLanguage.code}),this.currentLanguage=a,this.publish("language-change",this.currentLanguage)}getDistance(e,r){let i=c3(e),n=c3(r);return Xm([i.longitude,i.latitude],[n.longitude,n.latitude])}async toJSONBundle({downloadLanguagePacks:e=!0}={}){var r;let i=[];if(e&&this.enterpriseMode){let n=new AbortController;for(let a of((r=this.venue)==null?void 0:r.languages)||[])try{if(this.localePacksUrls[a.code]){let o=await b8(this.localePacksUrls[a.code],{signal:n.signal}),l=await H4(o);l&&i.push({language:{code:a.code,name:a.name},localePack:l})}}catch(o){Vt.warn("failed downloading language pack",o)}}return{type:"json",options:{enterprise:this.enterpriseMode},languagePacks:i,main:this.mvf}}async toBinaryBundle({downloadLanguagePacks:e=!0}={}){var r;if(!this.binaryBundle){Vt.error("binary bundle not found");return}let i=[];if(e&&this.enterpriseMode){let n=new AbortController;for(let a of((r=this.venue)==null?void 0:r.languages)||[])try{if(this.localePacksUrls[a.code]){let o=await b8(this.localePacksUrls[a.code],{signal:n.signal});o&&i.push({language:{code:a.code,name:a.name},localePack:o})}}catch(o){Vt.warn("failed downloading language pack",o)}}return{type:"binary",options:{enterprise:this.enterpriseMode},languagePacks:i,main:this.binaryBundle}}destroy(){for(let e of globalThis.Object.keys(w(this,gi)))w(this,gi)[e]=null}};gi=new WeakMap,m9=new WeakSet,y6e=s(function(t){var e;let r=(e=t==null?void 0:t.nodes)==null?void 0:e[0],i=this.getById("node",r);if(i==null)return;let n=dx([i.coordinate.longitude,i.coordinate.latitude]),a=this.connectionSpaceIdsByLatLon[n];return a==null?void 0:a.map(o=>this.connectionsById[o]).find(o=>o!=null)},"#getConnectionFromMVFConnection"),iw=new WeakMap,s(v6e,"MapDataInternal");var Ij=v6e,nw,P1,vT,Xd,g9=class y9 extends WP{constructor(e,r){super(r.mvfData.id,e),$(this,"__type",y9.__type),Be(this,nw),Be(this,P1),Be(this,vT),Be(this,Xd,{}),He(this,nw,r.mvfData),He(this,P1,e),He(this,vT,r.floorStackId)}static is(e){return e.__type===y9.__type}get floorStack(){return w(this,P1).getById("floor-stack",w(this,vT))}get spaces(){if(!w(this,Xd).spaces){w(this,Xd).spaces=[];for(let e of w(this,nw).spaces){let r=w(this,P1).getById("space",e.spaceId);r&&w(this,Xd).spaces.push(r)}}return w(this,Xd).spaces}get center(){if(!w(this,Xd).center){let e={type:"FeatureCollection",features:[]};for(let i of this.spaces){let n=w(this,P1).mvfSpacesById[i.id];n&&e.features.push(n)}if(e.features.length===0)throw new Error("No geometry found for facade!");let r=nz(e);w(this,Xd).center=new Rn(r.geometry.coordinates[1],r.geometry.coordinates[0],w(this,nw).spaces[0].floorId)}return w(this,Xd).center}get focusTarget(){return this.spaces}get anchorTarget(){return this.center}};nw=new WeakMap,P1=new WeakMap,vT=new WeakMap,Xd=new WeakMap,s(g9,"Facade"),$(g9,"__type","facade");var cit=g9,ex=cit,hit=WX();N();N();N();N();var _6e=class extends Error{constructor(e){super("".concat(e," must be used within a MapView component."))}};s(_6e,"MapViewNullError");var _g=_6e,ud=ti.createContext({mapData:void 0,mapView:void 0});function x6e(){let{mapData:t,mapView:e}=ti.useContext(ud);if(!t||!e)throw new _g("useMap");return{mapData:t,mapView:e}}s(x6e,"useMap");N();function Pv(t,e){ti.useEffect(()=>{e!=null&&typeof t=="function"&&t(e)},[t,e])}s(Pv,"useOnLoad");function b6e(t){let{mapView:e}=ti.useContext(ud),r=ti.useRef(),[i,n]=ti.useState(null);return ti.useEffect(()=>{if(e==null)throw new _g("Marker");return r.current=e.Markers.add(t.target,"",vt(Ee({},t.options),{dynamicResize:!0})),n(r.current),()=>{e==null||r.current==null||e.Markers.remove(r.current)}},[e,t.target]),ti.useEffect(()=>{i&&(e==null||e.updateState(i,Ee({},t.options)))},[t.options]),Pv(t.onLoad,i),e==null||i==null?null:hit.createPortal(t.children,i.contentEl,i.id)}s(b6e,"Marker");function pit(t){let{mapView:e}=ti.useContext(ud),[r,i]=ti.useState(null),n=ti.useRef(ga()),a=ti.useRef(t.target),o=ti.useCallback(u=>{var c;i(u),(c=t.onLoad)==null||c.call(t,u)},[t.onLoad]);ti.useEffect(()=>{if(e==null)throw new _g("Marker");if(r&&r.target!==t.target){let{duration:u=300,easing:c="linear"}=t;e.Markers.animateTo(r,t.target,{duration:u,easing:c})}},[e,t.target,r]);let l=ti.useMemo(()=>vt(Ee({},t),{duration:void 0,easing:void 0}),[t.duration,t.easing]);return Hb.createElement(b6e,vt(Ee({},l),{key:n.current,target:a.current,onLoad:o}))}s(pit,"AnimatedMarker");N();function dit(t){let{mapView:e}=ti.useContext(ud),r=ti.useRef(),[i,n]=ti.useState(void 0);return ti.useEffect(()=>{if(e==null)throw new _g("Label");return r.current=e.Labels.add(t.target,t.text,t.options),n(r.current),()=>{e==null||r.current==null||e.Labels.remove(r.current)}},[e,t.target]),ti.useEffect(()=>{r.current&&(e==null||e.updateState(r.current,Ee({text:t.text},t.options)))},[t.text,t.options]),Pv(t.onLoad,i),null}s(dit,"Label");N();function fit(t,e){let{mapView:r}=ti.useContext(ud),i=ti.useCallback(n=>e(n),[e]);ti.useEffect(()=>{if(r==null)throw new _g("useEvent");return r.on(t,i),()=>{r!=null&&r.off(t,i)}},[r,t,e])}s(fit,"useEvent");N();function mit(t){let{mapView:e}=ti.useContext(ud),r=ti.useRef(),[i,n]=ti.useState(void 0);return ti.useEffect(()=>{if(e==null)throw new _g("Path");let a=e.Paths.add(t.coordinate,t.options);return a.animation.then(()=>{var o;(o=t.onDrawComplete)==null||o.call(t)}),n(a),r.current=a,()=>{r.current&&e.Paths.remove(r.current)}},[e,t.coordinate,t.options]),Pv(t.onLoad,i),null}s(mit,"Path");N();var git={width:"100%",height:"100%",position:"relative"};function w6e(t){let e=t,{mapData:r,options:i,style:n,fallback:a,children:o}=e,l=Nh(e,["mapData","options","style","fallback","children"]),u=ti.useRef(!1),[c,p]=ti.useState(void 0),[m,y]=ti.useState(!0),v=ti.useRef(null),x=ti.useMemo(()=>i,[]),E=ti.useCallback(()=>{if(r&&v!=null&&v.current){if(c)return;Aj(v.current,r,x).then(M=>{p(M)}).catch(M=>{Vt.error("Failed to render MapView",M)}).finally(()=>{y(!1)})}},[r,v.current,x]);return ti.useEffect(()=>{u.current||(u.current=!0,E())},[E]),Pv(t.onLoad,c),Hb.createElement(ud.Provider,{value:{mapData:r,mapView:c}},Hb.createElement("div",Ee({"data-testid":"mappedin-map",ref:v,style:Ee(Ee({},git),n)},l)),m?Hb.createElement(Hb.Fragment,null,a):o)}s(w6e,"MapView");N();function yit(t){let{mapView:e}=ti.useContext(ud),[r,i]=ti.useState(!1);return ti.useEffect(()=>{if(e==null)throw new _g("Navigation");return e.Navigation.draw(t.directions,t.options).then(()=>{var n;i(!0),(n=t.onDrawComplete)==null||n.call(t)}),()=>{e.Navigation.clear()}},[e,t.directions,t.options]),ti.useEffect(()=>{r!==!1&&typeof t.onLoad=="function"&&t.onLoad()},[t.onLoad,r]),null}s(yit,"Navigation");N();function vit(t){let{mapView:e}=ti.useContext(ud),r=ti.useRef(),[i,n]=ti.useState(void 0);return ti.useEffect(()=>{if(e==null)throw new Error("MapView not initialized");return r.current=e.Shapes.add(t.geometry,t.style,t.floor),n(r.current),()=>{e==null||r.current==null||e.Shapes.remove(r.current)}},[e,t.geometry,t.style,t.floor]),Pv(t.onLoad,i),null}s(vit,"Shape");N();function _it(t){let{mapView:e}=ti.useContext(ud),r=ti.useRef(),[i,n]=ti.useState(void 0);return ti.useEffect(()=>{if(e==null)throw new _g("Model");return r.current=e.Models.add(t.target,t.url,t.options),n(r.current),()=>{e==null||r.current==null||e.Models.remove(r.current)}},[e,t.url]),ti.useEffect(()=>{r.current&&(e==null||e.updateState(r.current,Ee({position:t.target},t.options)))},[t.options,t.target]),Pv(t.onLoad,i),null}s(_it,"Model");N();function A6e(t){let[e,r]=ti.useState(void 0),[i,n]=ti.useState(!0),[a,o]=ti.useState(void 0),l=ti.useRef(0),u=ti.useMemo(()=>t,[]),c=ti.useCallback(()=>{let p=++l.current;n(!0),o(void 0),wj(u).then(m=>{l.current===p&&r(m)}).catch(m=>{l.current===p&&(Vt.error("Failed to fetch MapData",m),o(m))}).finally(()=>{l.current===p&&n(!1)})},[u]);return ti.useEffect(()=>{c()},[c]),{mapData:e,isLoading:i,error:a}}s(A6e,"useMapData");function xit(){const{mapView:t,mapData:e}=x6e(),[r,i]=ti.useState([]),[n,a]=ti.useState(""),[o,l]=ti.useState(null),[u,c]=ti.useState(null),[p,m]=ti.useState(!1),[y,v]=ti.useState({show:!1,message:"",type:""}),x=(C,T="info")=>{v({show:!0,message:C,type:T}),setTimeout(()=>{v({show:!1,message:"",type:""})},2e3)},E=C=>{if(!t||!e)return;e.getByType("space").forEach(D=>{try{t.updateState(D,{interactive:C,hoverColor:C?"rgba(83, 97, 228)":void 0})}catch(F){console.warn("Could not update state for space:",D.name,F)}})};ti.useEffect(()=>{if(!t||!e)return;t.currentFloor&&!n&&a(t.currentFloor.id),e.getByType("space").forEach(D=>{if(D.name)try{t.Markers.add(D,D.name,{interactive:!0})}catch(F){console.warn("Could not add marker for space:",D.name,F)}try{t.updateState(D,{interactive:!0,hoverColor:"rgba(83, 97, 228)"})}catch(F){console.warn("Could not update state for space:",D.name,F)}}),t.Camera.set({zoomLevel:20.5,pitch:50});const T=async D=>{if(D)if(p)if(!o)D.spaces&&D.spaces.length>0&&(l(D.spaces[0]),x(`Start point selected: ${D.spaces[0].name},
 Click Destination Space`,"success"),console.log("Start point selected: "+D.spaces[0].name));else if(!u&&D.spaces&&D.spaces[0]){const F=e.getDirections(o,D.spaces[0]);if(!F){x("No path found between these spaces","error");return}const k=t.Paths.add(F.coordinates,{nearRadius:.5,farRadius:.5,color:"#1871fb"});c(k),E(!1),x(`Path created to: ${D.spaces[0].name}`,"success"),console.log("Path created")}else u&&(t.Paths.removeAll(),l(null),c(null),E(!0),x("Path cleared. Click a space to start new path","info"),console.log("Path removed"));else D.spaces&&D.spaces.length>0&&(x(`Clicked: ${D.spaces[0].name}`,"info"),console.log("Clicked on Space: "+D.spaces[0].name))};return t.on("click",T),()=>{try{t.off("click",T)}catch(D){console.warn("Error removing click listener:",D)}}},[t,e,o,u,p]);const M=C=>{if(!e)return[];try{const T=e.getById("floor-stack",C);return!T||!T.floors?[]:T.floors.sort((D,F)=>F.elevation-D.elevation)}catch(T){return console.warn("Error getting floor stack:",T),[]}},I=C=>{if(!(!t||!C))try{const T=e.getById("floor",C);T&&(t.setFloor(T),a(C))}catch(T){console.warn("Error changing floor:",T)}},P=e?e.getByType("floor-stack"):[];return Iu.jsxs("div",{style:{position:"absolute",top:"1vh",left:"10px",zIndex:1e3},children:[Iu.jsx("div",{style:{background:"transparent",padding:"10px",marginBottom:"5px"},children:Iu.jsx("button",{onClick:()=>{m(!p),p&&u?(t.Paths.removeAll(),l(null),c(null),E(!0),x("Pathfinding disabled and paths cleared","info")):p||x("Pathfinding enabled. Click a space to start","success")},style:{width:"200px",height:"3vh",padding:"5px",borderRadius:"10px",border:"1px solid #ccc",backgroundColor:p?"#1871fb":"rgba(255, 255, 255, 0.8)",color:p?"white":"#333",cursor:"pointer",fontSize:"14px"},children:p?"Disable Pathfinding":"Enable Pathfinding"})}),P.length>0&&Iu.jsx("div",{style:{background:"transparent",padding:"10px"},children:Iu.jsx("select",{id:"floor-selector",value:n,onChange:C=>I(C.target.value),style:{width:"200px",height:"3vh",padding:"5px",borderRadius:"10px",border:"1px solid #ccc",backgroundColor:"rgba(255, 255, 255, 0.8)",color:"#333"},children:P[0]&&M(P[0].id).map(C=>Iu.jsx("option",{value:C.id,children:C.name},C.id))})}),y.show&&Iu.jsx("div",{style:{position:"absolute",top:"50%",left:"150%",transform:"translate(-50%, -50%)",backgroundColor:y.type==="error"?"#ff4444":(y.type==="success","#4488ff"),color:"white",padding:"15px 20px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",zIndex:2e3,fontSize:"16px",fontWeight:"bold",textAlign:"center",minWidth:"200px",animation:"fadeInOut 2s ease-in-out"},children:y.message}),Iu.jsx("style",{children:`
        @keyframes fadeInOut {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
          15% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
          85% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
          100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }
      `})]})}function bit(){const{isLoading:t,error:e,mapData:r}=A6e({key:"mik_yeBk0Vf0nNJtpesfu560e07e5",secret:"mis_2g9ST8ZcSFb5R9fPnsvYhrX3RyRwPtDGbMGweCYKEq385431022",mapId:"64ef49e662fd90fe020bee61"});return t?Iu.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"Loading map..."}):e?Iu.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"red",fontSize:"16px"},children:["Error loading map: ",e.message]}):r?Iu.jsx(w6e,{mapData:r,style:{width:"100%",height:"100%"},children:Iu.jsx(xit,{})}):null}jRe.createRoot(document.getElementById("root")).render(Iu.jsx(ti.StrictMode,{children:Iu.jsx(bit,{})}));export{Jn as $,Ru as A,N as B,Ee as C,hye as D,Xq as E,ex as F,s as G,Zi as H,qe as I,ja as J,ff as K,Cme as L,$ as M,Zo as N,Lu as O,w as P,Be as Q,He as R,dr as S,sB as T,Uw as U,Ri as V,kut as W,hce as X,Nm as Y,$n as Z,ag as _,Rr as a,Plt as a$,Eo as a0,BT as a1,xB as a2,il as a3,_c as a4,HUe as a5,FM as a6,GL as a7,Ey as a8,My as a9,She as aA,Put as aB,Rut as aC,QM as aD,Yl as aE,yde as aF,_ut as aG,yct as aH,IVe as aI,BP as aJ,fut as aK,XT as aL,WT as aM,Dn as aN,Qp as aO,FP as aP,klt as aQ,I9 as aR,Bze as aS,aze as aT,m9e as aU,Rze as aV,Cze as aW,Pze as aX,Lze as aY,HBe as aZ,Nl as a_,Bh as aa,PR as ab,iO as ac,NA as ad,Bct as ae,wct as af,ect as ag,Wy as ah,Tct as ai,Dct as aj,xde as ak,VT as al,Ha as am,IB as an,jct as ao,dut as ap,NVe as aq,lg as ar,wB as as,kpe as at,Vs as au,gut as av,MHe as aw,XUe as ax,Aq as ay,kP as az,lye as b,d9e as b0,Elt as b1,WBe as b2,Ew as b3,wze as b4,Yi as b5,Km as b6,zze as b7,xlt as b8,Kc as b9,pUe as bA,dUe as bB,s9e as bC,fOe as bD,hUe as bE,aUe as bF,uUe as bG,Sue as bH,jtt as bI,Zp as bJ,Rn as bK,qa as bL,LM as ba,tze as bb,fq as bc,nl as bd,wlt as be,Olt as bf,p9e as bg,Cae as bh,Ilt as bi,Eze as bj,uq as bk,Dlt as bl,xze as bm,vze as bn,gze as bo,Dze as bp,u9e as bq,f9e as br,dOe as bs,got as bt,l9e as bu,wc as bv,cUe as bw,oUe as bx,sUe as by,lUe as bz,qP as c,vt as d,to as e,Ll as f,e0e as g,oi as h,Nlt as i,cw as j,a_ as k,xt as l,Uct as m,Up as n,Jt as o,rn as p,Pu as q,pv as r,WVe as s,qVe as t,kO as u,ug as v,Gu as w,YUe as x,Tn as y,bVe as z};
